0.7s 1 ================================================================================
0.7s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.7s 3 Revendications: R5
0.7s 4 ================================================================================
0.7s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.7s 6 Branch: main
5.7s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.7s 8 PyTorch: 2.6.0+cu124
5.7s 9 CUDA available: True
5.7s 10 CUDA device: Tesla P100-PCIE-16GB
5.7s 11 CUDA version: 12.4
5.7s 12 
5.7s 13 [STEP 1/4] Cloning repository from GitHub...
5.7s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
8.4s 15 [OK] Repository cloned successfully
8.4s 16 TRACKING_SUCCESS: Repository cloned
8.4s 17 
8.4s 18 [STEP 2/4] Installing dependencies...
8.4s 19 Installing PyYAML...
12.4s 20 Installing matplotlib...
15.4s 21 Installing pandas...
18.4s 22 Installing scipy...
21.5s 23 Installing numpy...
24.5s 24 Installing gymnasium...
27.5s 25 Installing stable-baselines3...
95.4s 26 [OK] Dependencies installed
95.4s 27 TRACKING_SUCCESS: Dependencies ready
95.4s 28 
95.4s 29 [STEP 3/4] Running validation tests...
95.4s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
95.4s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
95.4s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
95.4s 33 ============================================================
106.8s 34 2025-10-10 10:54:35.653223: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
107.0s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
107.0s 36 E0000 00:00:1760093675.854590      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
107.1s 37 E0000 00:00:1760093675.911871      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
119.3s 38 ================================================================================
119.3s 39 QUICK TEST MODE ENABLED
119.3s 40 - Training: 2 timesteps only
119.3s 41 - Duration: 2 minutes simulated time
119.3s 42 - Scenarios: 1 scenario only
119.3s 43 - Expected runtime: ~5 minutes on GPU
119.3s 44 ================================================================================
119.3s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
119.3s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
119.3s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
119.3s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
119.3s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
119.3s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
119.3s 51 2025-10-10 10:54:48 - INFO - _setup_debug_logging:119 - ================================================================================
119.3s 52 2025-10-10 10:54:48 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
119.3s 53 2025-10-10 10:54:48 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
119.3s 54 2025-10-10 10:54:48 - INFO - _setup_debug_logging:122 - Quick test mode: True
119.3s 55 2025-10-10 10:54:48 - INFO - _setup_debug_logging:123 - ================================================================================
119.3s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
119.3s 57 === Section 7.6: RL Performance Validation ===
119.3s 58 Testing RL agent performance vs baseline controllers...
119.4s 59 [DEVICE] Detected: GPU
119.5s 60 [GPU INFO] Tesla P100-PCIE-16GB
119.5s 61 
119.5s 62 [PHASE 1/2] Training RL agents...
119.5s 63 [QUICK TEST] Training only: traffic_light_control
119.5s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
119.5s 65 2025-10-10 10:54:48 - INFO - train_rl_agent:560 - ================================================================================
119.5s 66 2025-10-10 10:54:48 - INFO - train_rl_agent:561 - Starting train_rl_agent for scenario: traffic_light_control
119.5s 67 2025-10-10 10:54:48 - INFO - train_rl_agent:562 -   - Device: gpu
119.5s 68 2025-10-10 10:54:48 - INFO - train_rl_agent:563 -   - Total timesteps: 100
119.5s 69 2025-10-10 10:54:48 - INFO - train_rl_agent:564 -   - Episode max time: 120.0s
119.5s 70 2025-10-10 10:54:48 - INFO - train_rl_agent:565 -   - Checkpoint frequency: 50
119.5s 71 2025-10-10 10:54:48 - INFO - train_rl_agent:566 - ================================================================================
119.5s 72 
119.5s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
119.5s 74 Device: gpu
119.5s 75 Total timesteps: 100
119.5s 76 Episode max time: 120.0s
119.5s 77 Checkpoint frequency: 50 steps
119.5s 78 2025-10-10 10:54:48 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
119.5s 79 2025-10-10 10:54:48 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
119.5s 80 2025-10-10 10:54:48 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
119.5s 81 2025-10-10 10:54:48 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
119.5s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
119.5s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
119.5s 84 Using device: gpu
119.5s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
119.5s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
119.5s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
119.5s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
119.5s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
119.5s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
119.5s 91 Loading road quality type: uniform
119.5s 92 Uniform road quality value: 2
119.5s 93 Road quality loaded.
119.5s 94 Initial state created.
119.5s 95 Transferring initial state and road quality to GPU...
119.5s 96 GPU data transfer complete.
119.5s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
119.5s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
119.5s 99 warn(NumbaPerformanceWarning(msg))
121.1s 100 Initial boundary conditions applied.
121.1s 101 TrafficSignalEnvDirect initialized:
121.1s 102 Decision interval: 60.0s
121.1s 103 Observation segments: 6
121.1s 104 Observation space: (26,)
121.1s 105 Action space: 2
121.1s 106 Device: gpu
121.1s 107 [INFO] Environment created: obs_space=(26,), action_space=2
121.1s 108 [INFO] Initializing PPO agent from scratch...
121.1s 109 Using cuda device
121.1s 110 Wrapping the env with a `Monitor` wrapper
121.1s 111 Wrapping the env in a DummyVecEnv.
121.1s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
121.1s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
121.1s 114 Info: (n_steps=100 and n_envs=1)
121.1s 115 warnings.warn(
125.9s 116 
125.9s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
125.9s 118 [INFO] Training for 100 timesteps...
125.9s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
125.9s 120 Using device: gpu
126.0s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
126.0s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
126.0s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
126.0s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
126.0s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
126.0s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
126.0s 127 Loading road quality type: uniform
126.0s 128 Uniform road quality value: 2
126.0s 129 Road quality loaded.
126.0s 130 Initial state created.
126.0s 131 Transferring initial state and road quality to GPU...
126.0s 132 GPU data transfer complete.
126.0s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
126.0s 134 Initial boundary conditions applied.
126.0s 135 [BC UPDATE] left → phase 0 (outflow)
126.0s 136 └─ Outflow: zero-order extrapolation
126.0s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
126.0s 138 
126.0s 139 🚀 Training started: 100 total timesteps
126.6s 140 [BC UPDATE] left → phase 1 (inflow)
126.6s 141 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
126.6s 142 Running simulation until t = 60.00 s, outputting every 60.00 s
126.6s 143 
126.7s 144 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.7s 145 warn(NumbaPerformanceWarning(msg))
127.0s 146 [WARNING] Automatic CFL correction applied (count: 1):
127.0s 147 Calculated CFL: 0.800 > Limit: 0.500
127.0s 148 Original dt: 3.228311e-01 s
127.0s 149 Corrected dt: 2.017695e-01 s
127.0s 150 Correction factor: 1.6x
127.0s 151 Max wave speed detected: 24.78 m/s
127.2s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.2s 153 warn(NumbaPerformanceWarning(msg))
127.9s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.9s 155 warn(NumbaPerformanceWarning(msg))
128.0s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.0s 157 warn(NumbaPerformanceWarning(msg))
128.0s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.0s 159 warn(NumbaPerformanceWarning(msg))
128.4s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.4s 161 warn(NumbaPerformanceWarning(msg))
128.5s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.5s 163 warn(NumbaPerformanceWarning(msg))
128.6s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.6s 165 warn(NumbaPerformanceWarning(msg))
128.7s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.7s 167 warn(NumbaPerformanceWarning(msg))
128.8s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.8s 169 warn(NumbaPerformanceWarning(msg))
128.9s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.9s 171 warn(NumbaPerformanceWarning(msg))
128.9s 172 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
128.9s 173 warn(NumbaPerformanceWarning(msg))
129.4s 174 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
129.9s 175 [WARNING] Automatic CFL correction applied (count: 100):
129.9s 176 Calculated CFL: 0.800 > Limit: 0.500
129.9s 177 Original dt: 4.145004e-01 s
129.9s 178 Corrected dt: 2.590627e-01 s
129.9s 179 Correction factor: 1.6x
129.9s 180 Max wave speed detected: 19.30 m/s
129.9s 181 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
130.3s 182 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
130.8s 183 [WARNING] Automatic CFL correction applied (count: 200):
130.8s 184 Calculated CFL: 0.800 > Limit: 0.500
130.8s 185 Original dt: 4.115380e-01 s
130.8s 186 Corrected dt: 2.572113e-01 s
130.8s 187 Correction factor: 1.6x
130.8s 188 Max wave speed detected: 19.44 m/s
130.9s 189 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
131.1s 190 
131.1s 191 [A
131.1s 192 Stored output at t = 60.0000 s (Step 231)
131.1s 193 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.29s/s]
131.1s 194 
131.1s 195 Simulation finished at t = 60.0000 s after 231 steps.
131.1s 196 Total runtime: 4.52 seconds.
131.1s 197 Running simulation until t = 120.00 s, outputting every 60.00 s
131.1s 198 
131.3s 199 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
131.8s 200 [WARNING] Automatic CFL correction applied (count: 300):
131.8s 201 Calculated CFL: 0.800 > Limit: 0.500
131.8s 202 Original dt: 4.114988e-01 s
131.8s 203 Corrected dt: 2.571867e-01 s
131.8s 204 Correction factor: 1.6x
131.8s 205 Max wave speed detected: 19.44 m/s
131.8s 206 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
132.3s 207 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
132.8s 208 [WARNING] Automatic CFL correction applied (count: 400):
132.8s 209 Calculated CFL: 0.800 > Limit: 0.500
132.8s 210 Original dt: 4.114980e-01 s
132.8s 211 Corrected dt: 2.571863e-01 s
132.8s 212 Correction factor: 1.6x
132.8s 213 Max wave speed detected: 19.44 m/s
132.8s 214 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
133.2s 215 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
133.4s 216 Stored output at t = 120.0000 s (Step 465)
133.4s 217 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
133.4s 218 [A
133.4s 219 
133.4s 220 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.88s/s]
133.4s 221 Simulation finished at t = 120.0000 s after 465 steps.
133.4s 222 Total runtime: 2.23 seconds.
133.4s 223 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
133.4s 224 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
133.4s 225 Using device: gpu
133.4s 226 DEBUG PARAMS: Reading K_m_kmh = 10.0
133.4s 227 DEBUG PARAMS: Reading K_c_kmh = 15.0
133.4s 228 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
133.4s 229 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
133.4s 230 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
133.4s 231 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
133.4s 232 Loading road quality type: uniform
133.4s 233 Uniform road quality value: 2
133.4s 234 Road quality loaded.
133.4s 235 Initial state created.
133.4s 236 Transferring initial state and road quality to GPU...
133.4s 237 GPU data transfer complete.
133.4s 238 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
133.4s 239 Initial boundary conditions applied.
133.4s 240 [BC UPDATE] left → phase 0 (outflow)
133.4s 241 └─ Outflow: zero-order extrapolation
133.4s 242 Running simulation until t = 60.00 s, outputting every 60.00 s
133.4s 243 
133.7s 244 [WARNING] Automatic CFL correction applied (count: 500):
133.7s 245 Calculated CFL: 0.800 > Limit: 0.500
133.7s 246 Original dt: 4.758816e-01 s
133.7s 247 Corrected dt: 2.974260e-01 s
133.7s 248 Correction factor: 1.6x
133.7s 249 Max wave speed detected: 16.81 m/s
133.9s 250 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
134.3s 251 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
134.7s 252 [WARNING] Automatic CFL correction applied (count: 600):
134.7s 253 Calculated CFL: 0.800 > Limit: 0.500
134.7s 254 Original dt: 4.121510e-01 s
134.7s 255 Corrected dt: 2.575944e-01 s
134.7s 256 Correction factor: 1.6x
134.7s 257 Max wave speed detected: 19.41 m/s
134.8s 258 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
135.3s 259 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
135.6s 260 Stored output at t = 60.0000 s (Step 231)
135.6s 261 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
135.6s 262 [A
135.6s 263 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s]
135.6s 264 
135.6s 265 Simulation finished at t = 60.0000 s after 231 steps.
135.6s 266 Total runtime: 2.16 seconds.
135.6s 267 Running simulation until t = 120.00 s, outputting every 60.00 s
135.6s 268 
135.6s 269 [WARNING] Automatic CFL correction applied (count: 700):
135.6s 270 Calculated CFL: 0.800 > Limit: 0.500
135.6s 271 Original dt: 4.115082e-01 s
135.6s 272 Corrected dt: 2.571926e-01 s
135.6s 273 Correction factor: 1.6x
135.6s 274 Max wave speed detected: 19.44 m/s
135.8s 275 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
136.2s 276 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
136.6s 277 [WARNING] Automatic CFL correction applied (count: 800):
136.6s 278 Calculated CFL: 0.800 > Limit: 0.500
136.6s 279 Original dt: 4.114982e-01 s
136.6s 280 Corrected dt: 2.571864e-01 s
136.6s 281 Correction factor: 1.6x
136.6s 282 Max wave speed detected: 19.44 m/s
136.7s 283 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
137.2s 284 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
137.5s 285 [WARNING] Automatic CFL correction applied (count: 900):
137.5s 286 Calculated CFL: 0.800 > Limit: 0.500
137.5s 287 Original dt: 4.114980e-01 s
137.5s 288 Corrected dt: 2.571863e-01 s
137.5s 289 Correction factor: 1.6x
137.5s 290 Max wave speed detected: 19.44 m/s
137.7s 291 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
137.8s 292 Stored output at t = 120.0000 s (Step 465)
137.8s 293 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
137.8s 294 [A
137.8s 295 
137.8s 296 Simulation finished at t = 120.0000 s after 465 steps.
137.8s 297 Total runtime: 2.26 seconds.
137.8s 298 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.61s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.60s/s]
137.8s 299 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
137.8s 300 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
137.8s 301 Using device: gpu
137.8s 302 DEBUG PARAMS: Reading K_m_kmh = 10.0
137.8s 303 DEBUG PARAMS: Reading K_c_kmh = 15.0
137.8s 304 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
137.8s 305 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
137.8s 306 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
137.8s 307 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
137.8s 308 Loading road quality type: uniform
137.8s 309 Uniform road quality value: 2
137.8s 310 Road quality loaded.
137.8s 311 Initial state created.
137.8s 312 Transferring initial state and road quality to GPU...
137.8s 313 GPU data transfer complete.
137.8s 314 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
137.8s 315 Initial boundary conditions applied.
137.8s 316 [BC UPDATE] left → phase 0 (outflow)
137.8s 317 └─ Outflow: zero-order extrapolation
137.8s 318 [BC UPDATE] left → phase 1 (inflow)
137.8s 319 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
137.8s 320 Running simulation until t = 60.00 s, outputting every 60.00 s
137.8s 321 
138.3s 322 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
138.5s 323 [WARNING] Automatic CFL correction applied (count: 1000):
138.5s 324 Calculated CFL: 0.800 > Limit: 0.500
138.5s 325 Original dt: 4.225636e-01 s
138.5s 326 Corrected dt: 2.641023e-01 s
138.5s 327 Correction factor: 1.6x
138.5s 328 Max wave speed detected: 18.93 m/s
138.8s 329 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
139.2s 330 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
139.4s 331 [WARNING] Automatic CFL correction applied (count: 1100):
139.4s 332 Calculated CFL: 0.800 > Limit: 0.500
139.4s 333 Original dt: 4.116395e-01 s
139.4s 334 Corrected dt: 2.572747e-01 s
139.4s 335 Correction factor: 1.6x
139.4s 336 Max wave speed detected: 19.43 m/s
139.7s 337 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
140.0s 338 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
140.0s 339 [A
140.0s 340 Stored output at t = 60.0000 s (Step 231)
140.0s 341 
140.0s 342 Simulation finished at t = 60.0000 s after 231 steps.
140.0s 343 Total runtime: 2.20 seconds.
140.0s 344 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.28s/s]
140.0s 345 [BC UPDATE] left → phase 0 (outflow)
140.0s 346 └─ Outflow: zero-order extrapolation
140.0s 347 Running simulation until t = 120.00 s, outputting every 60.00 s
140.1s 348 
140.2s 349 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
140.4s 350 [WARNING] Automatic CFL correction applied (count: 1200):
140.4s 351 Calculated CFL: 0.800 > Limit: 0.500
140.4s 352 Original dt: 4.115005e-01 s
140.4s 353 Corrected dt: 2.571878e-01 s
140.4s 354 Correction factor: 1.6x
140.4s 355 Max wave speed detected: 19.44 m/s
140.7s 356 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
141.2s 357 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
141.4s 358 [WARNING] Automatic CFL correction applied (count: 1300):
141.4s 359 Calculated CFL: 0.800 > Limit: 0.500
141.4s 360 Original dt: 4.114981e-01 s
141.4s 361 Corrected dt: 2.571863e-01 s
141.4s 362 Correction factor: 1.6x
141.4s 363 Max wave speed detected: 19.44 m/s
141.7s 364 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
142.2s 365 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
142.3s 366 Stored output at t = 120.0000 s (Step 465)
142.3s 367 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
142.3s 368 [A
142.3s 369 
142.3s 370 Simulation finished at t = 120.0000 s after 465 steps.
142.3s 371 Total runtime: 2.27 seconds.
142.3s 372 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.48s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.47s/s]
142.3s 373 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
142.3s 374 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
142.3s 375 Using device: gpu
142.3s 376 DEBUG PARAMS: Reading K_m_kmh = 10.0
142.3s 377 DEBUG PARAMS: Reading K_c_kmh = 15.0
142.3s 378 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
142.3s 379 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
142.3s 380 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
142.3s 381 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
142.3s 382 Loading road quality type: uniform
142.3s 383 Uniform road quality value: 2
142.3s 384 Road quality loaded.
142.3s 385 Initial state created.
142.3s 386 Transferring initial state and road quality to GPU...
142.3s 387 GPU data transfer complete.
142.3s 388 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
142.3s 389 Initial boundary conditions applied.
142.3s 390 [BC UPDATE] left → phase 0 (outflow)
142.3s 391 └─ Outflow: zero-order extrapolation
142.3s 392 Running simulation until t = 60.00 s, outputting every 60.00 s
142.3s 393 
142.4s 394 [WARNING] Automatic CFL correction applied (count: 1400):
142.4s 395 Calculated CFL: 0.800 > Limit: 0.500
142.4s 396 Original dt: 3.451280e-01 s
142.4s 397 Corrected dt: 2.157050e-01 s
142.4s 398 Correction factor: 1.6x
142.4s 399 Max wave speed detected: 23.18 m/s
142.8s 400 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
143.3s 401 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
143.3s 402 [WARNING] Automatic CFL correction applied (count: 1500):
143.3s 403 Calculated CFL: 0.800 > Limit: 0.500
143.3s 404 Original dt: 4.139892e-01 s
143.3s 405 Corrected dt: 2.587433e-01 s
143.3s 406 Correction factor: 1.6x
143.3s 407 Max wave speed detected: 19.32 m/s
143.8s 408 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
144.2s 409 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
144.3s 410 [WARNING] Automatic CFL correction applied (count: 1600):
144.3s 411 Calculated CFL: 0.800 > Limit: 0.500
144.3s 412 Original dt: 4.115314e-01 s
144.3s 413 Corrected dt: 2.572071e-01 s
144.3s 414 Correction factor: 1.6x
144.3s 415 Max wave speed detected: 19.44 m/s
144.5s 416 Stored output at t = 60.0000 s (Step 231)
144.5s 417 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
144.5s 418 [A
144.5s 419 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.51s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.51s/s]
144.5s 420 
144.5s 421 Simulation finished at t = 60.0000 s after 231 steps.
144.5s 422 Total runtime: 2.18 seconds.
144.5s 423 [BC UPDATE] left → phase 1 (inflow)
144.5s 424 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
144.5s 425 Running simulation until t = 120.00 s, outputting every 60.00 s
144.5s 426 
144.7s 427 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
145.2s 428 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
145.2s 429 [WARNING] Automatic CFL correction applied (count: 1700):
145.2s 430 Calculated CFL: 0.800 > Limit: 0.500
145.2s 431 Original dt: 4.114986e-01 s
145.2s 432 Corrected dt: 2.571866e-01 s
145.2s 433 Correction factor: 1.6x
145.2s 434 Max wave speed detected: 19.44 m/s
145.7s 435 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
146.1s 436 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
146.2s 437 [WARNING] Automatic CFL correction applied (count: 1800):
146.2s 438 Calculated CFL: 0.800 > Limit: 0.500
146.2s 439 Original dt: 4.114980e-01 s
146.2s 440 Corrected dt: 2.571863e-01 s
146.2s 441 Correction factor: 1.6x
146.2s 442 Max wave speed detected: 19.44 m/s
146.6s 443 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
146.7s 444 Stored output at t = 120.0000 s (Step 465)
146.7s 445 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
146.7s 446 [A
146.7s 447 
146.7s 448 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s]
146.7s 449 Simulation finished at t = 120.0000 s after 465 steps.
146.7s 450 Total runtime: 2.23 seconds.
146.7s 451 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
146.7s 452 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
146.7s 453 Using device: gpu
146.8s 454 DEBUG PARAMS: Reading K_m_kmh = 10.0
146.8s 455 DEBUG PARAMS: Reading K_c_kmh = 15.0
146.8s 456 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
146.8s 457 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
146.8s 458 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
146.8s 459 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
146.8s 460 Loading road quality type: uniform
146.8s 461 Uniform road quality value: 2
146.8s 462 Road quality loaded.
146.8s 463 Initial state created.
146.8s 464 Transferring initial state and road quality to GPU...
146.8s 465 GPU data transfer complete.
146.8s 466 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
146.8s 467 Initial boundary conditions applied.
146.8s 468 [BC UPDATE] left → phase 0 (outflow)
146.8s 469 └─ Outflow: zero-order extrapolation
146.8s 470 Running simulation until t = 60.00 s, outputting every 60.00 s
146.8s 471 
147.1s 472 [WARNING] Automatic CFL correction applied (count: 1900):
147.1s 473 Calculated CFL: 0.800 > Limit: 0.500
147.1s 474 Original dt: 4.583403e-01 s
147.1s 475 Corrected dt: 2.864627e-01 s
147.1s 476 Correction factor: 1.6x
147.1s 477 Max wave speed detected: 17.45 m/s
147.3s 478 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
147.7s 479 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
148.1s 480 [WARNING] Automatic CFL correction applied (count: 2000):
148.1s 481 Calculated CFL: 0.800 > Limit: 0.500
148.1s 482 Original dt: 4.120137e-01 s
148.1s 483 Corrected dt: 2.575085e-01 s
148.1s 484 Correction factor: 1.6x
148.1s 485 Max wave speed detected: 19.42 m/s
148.2s 486 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
148.7s 487 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
149.0s 488 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
149.0s 489 [A
149.0s 490 Stored output at t = 60.0000 s (Step 231)
149.0s 491 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.26s/s]
149.0s 492 
149.0s 493 Simulation finished at t = 60.0000 s after 231 steps.
149.0s 494 Total runtime: 2.20 seconds.
149.0s 495 Running simulation until t = 120.00 s, outputting every 60.00 s
149.0s 496 
149.0s 497 [WARNING] Automatic CFL correction applied (count: 2100):
149.0s 498 Calculated CFL: 0.800 > Limit: 0.500
149.0s 499 Original dt: 4.115064e-01 s
149.0s 500 Corrected dt: 2.571915e-01 s
149.0s 501 Correction factor: 1.6x
149.0s 502 Max wave speed detected: 19.44 m/s
149.1s 503 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
149.6s 504 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
150.0s 505 [WARNING] Automatic CFL correction applied (count: 2200):
150.0s 506 Calculated CFL: 0.800 > Limit: 0.500
150.0s 507 Original dt: 4.114982e-01 s
150.0s 508 Corrected dt: 2.571864e-01 s
150.0s 509 Correction factor: 1.6x
150.0s 510 Max wave speed detected: 19.44 m/s
150.1s 511 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
150.6s 512 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
151.0s 513 [WARNING] Automatic CFL correction applied (count: 2300):
151.0s 514 Calculated CFL: 0.800 > Limit: 0.500
151.0s 515 Original dt: 4.114980e-01 s
151.0s 516 Corrected dt: 2.571863e-01 s
151.0s 517 Correction factor: 1.6x
151.0s 518 Max wave speed detected: 19.44 m/s
151.1s 519 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
151.2s 520 Stored output at t = 120.0000 s (Step 465)
151.2s 521 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
151.2s 522 [A
151.2s 523 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.89s/s]
151.2s 524 
151.2s 525 Simulation finished at t = 120.0000 s after 465 steps.
151.2s 526 Total runtime: 2.23 seconds.
151.2s 527 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
151.2s 528 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
151.2s 529 Using device: gpu
151.2s 530 DEBUG PARAMS: Reading K_m_kmh = 10.0
151.2s 531 DEBUG PARAMS: Reading K_c_kmh = 15.0
151.2s 532 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
151.2s 533 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
151.2s 534 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
151.2s 535 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
151.2s 536 Loading road quality type: uniform
151.2s 537 Uniform road quality value: 2
151.2s 538 Road quality loaded.
151.2s 539 Initial state created.
151.2s 540 Transferring initial state and road quality to GPU...
151.2s 541 GPU data transfer complete.
151.2s 542 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
151.2s 543 Initial boundary conditions applied.
151.2s 544 [BC UPDATE] left → phase 0 (outflow)
151.2s 545 └─ Outflow: zero-order extrapolation
151.2s 546 [BC UPDATE] left → phase 1 (inflow)
151.2s 547 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
151.2s 548 Running simulation until t = 60.00 s, outputting every 60.00 s
151.2s 549 
151.7s 550 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
151.9s 551 [WARNING] Automatic CFL correction applied (count: 2400):
151.9s 552 Calculated CFL: 0.800 > Limit: 0.500
151.9s 553 Original dt: 4.205139e-01 s
151.9s 554 Corrected dt: 2.628212e-01 s
151.9s 555 Correction factor: 1.6x
151.9s 556 Max wave speed detected: 19.02 m/s
152.2s 557 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
152.6s 558 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
152.9s 559 [WARNING] Automatic CFL correction applied (count: 2500):
152.9s 560 Calculated CFL: 0.800 > Limit: 0.500
152.9s 561 Original dt: 4.116141e-01 s
152.9s 562 Corrected dt: 2.572588e-01 s
152.9s 563 Correction factor: 1.6x
152.9s 564 Max wave speed detected: 19.44 m/s
153.1s 565 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
153.4s 566 Stored output at t = 60.0000 s (Step 231)
153.4s 567 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
153.4s 568 [A
153.4s 569 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.57s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.57s/s]
153.4s 570 
153.4s 571 Simulation finished at t = 60.0000 s after 231 steps.
153.4s 572 Total runtime: 2.18 seconds.
153.4s 573 [BC UPDATE] left → phase 0 (outflow)
153.4s 574 └─ Outflow: zero-order extrapolation
153.4s 575 Running simulation until t = 120.00 s, outputting every 60.00 s
153.4s 576 
153.6s 577 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
153.8s 578 [WARNING] Automatic CFL correction applied (count: 2600):
153.8s 579 Calculated CFL: 0.800 > Limit: 0.500
153.8s 580 Original dt: 4.115000e-01 s
153.8s 581 Corrected dt: 2.571875e-01 s
153.8s 582 Correction factor: 1.6x
153.8s 583 Max wave speed detected: 19.44 m/s
154.1s 584 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
154.5s 585 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
154.8s 586 [WARNING] Automatic CFL correction applied (count: 2700):
154.8s 587 Calculated CFL: 0.800 > Limit: 0.500
154.8s 588 Original dt: 4.114981e-01 s
154.8s 589 Corrected dt: 2.571863e-01 s
154.8s 590 Correction factor: 1.6x
154.8s 591 Max wave speed detected: 19.44 m/s
155.0s 592 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
155.5s 593 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
155.6s 594 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
155.6s 595 Stored output at t = 120.0000 s (Step 465)
155.6s 596 [A
155.6s 597 
155.6s 598 Simulation finished at t = 120.0000 s after 465 steps.
155.6s 599 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s]
155.6s 600 Total runtime: 2.23 seconds.
155.6s 601 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
155.6s 602 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
155.6s 603 Using device: gpu
155.6s 604 DEBUG PARAMS: Reading K_m_kmh = 10.0
155.6s 605 DEBUG PARAMS: Reading K_c_kmh = 15.0
155.6s 606 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
155.6s 607 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
155.6s 608 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
155.6s 609 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
155.6s 610 Loading road quality type: uniform
155.6s 611 Uniform road quality value: 2
155.6s 612 Road quality loaded.
155.6s 613 Initial state created.
155.6s 614 Transferring initial state and road quality to GPU...
155.6s 615 GPU data transfer complete.
155.6s 616 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
155.6s 617 Initial boundary conditions applied.
155.6s 618 [BC UPDATE] left → phase 0 (outflow)
155.6s 619 └─ Outflow: zero-order extrapolation
155.6s 620 [BC UPDATE] left → phase 1 (inflow)
155.6s 621 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
155.6s 622 Running simulation until t = 60.00 s, outputting every 60.00 s
155.6s 623 
155.7s 624 [WARNING] Automatic CFL correction applied (count: 2800):
155.7s 625 Calculated CFL: 0.800 > Limit: 0.500
155.7s 626 Original dt: 3.737254e-01 s
155.7s 627 Corrected dt: 2.335784e-01 s
155.7s 628 Correction factor: 1.6x
155.7s 629 Max wave speed detected: 21.41 m/s
156.1s 630 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
156.6s 631 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
156.7s 632 [WARNING] Automatic CFL correction applied (count: 2900):
156.7s 633 Calculated CFL: 0.800 > Limit: 0.500
156.7s 634 Original dt: 4.134305e-01 s
156.7s 635 Corrected dt: 2.583941e-01 s
156.7s 636 Correction factor: 1.6x
156.7s 637 Max wave speed detected: 19.35 m/s
157.0s 638 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
157.5s 639 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
157.6s 640 [WARNING] Automatic CFL correction applied (count: 3000):
157.6s 641 Calculated CFL: 0.800 > Limit: 0.500
157.6s 642 Original dt: 4.115259e-01 s
157.6s 643 Corrected dt: 2.572037e-01 s
157.6s 644 Correction factor: 1.6x
157.6s 645 Max wave speed detected: 19.44 m/s
157.8s 646 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
157.8s 647 [A
157.8s 648 Stored output at t = 60.0000 s (Step 231)
157.8s 649 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.70s/s]
157.8s 650 
157.8s 651 Simulation finished at t = 60.0000 s after 231 steps.
157.8s 652 Total runtime: 2.17 seconds.
157.8s 653 Running simulation until t = 120.00 s, outputting every 60.00 s
157.8s 654 
158.0s 655 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
158.4s 656 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
158.5s 657 [WARNING] Automatic CFL correction applied (count: 3100):
158.5s 658 Calculated CFL: 0.800 > Limit: 0.500
158.5s 659 Original dt: 4.114985e-01 s
158.5s 660 Corrected dt: 2.571866e-01 s
158.5s 661 Correction factor: 1.6x
158.5s 662 Max wave speed detected: 19.44 m/s
158.9s 663 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
159.4s 664 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
159.5s 665 [WARNING] Automatic CFL correction applied (count: 3200):
159.5s 666 Calculated CFL: 0.800 > Limit: 0.500
159.5s 667 Original dt: 4.114980e-01 s
159.5s 668 Corrected dt: 2.571863e-01 s
159.5s 669 Correction factor: 1.6x
159.5s 670 Max wave speed detected: 19.44 m/s
159.9s 671 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
160.0s 672 Stored output at t = 120.0000 s (Step 465)
160.0s 673 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
160.0s 674 [A
160.0s 675 
160.0s 676 Simulation finished at t = 120.0000 s after 465 steps.
160.0s 677 Total runtime: 2.24 seconds.
160.0s 678 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.79s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.79s/s]
160.0s 679 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
160.0s 680 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
160.0s 681 Using device: gpu
160.1s 682 DEBUG PARAMS: Reading K_m_kmh = 10.0
160.1s 683 DEBUG PARAMS: Reading K_c_kmh = 15.0
160.1s 684 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
160.1s 685 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
160.1s 686 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
160.1s 687 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
160.1s 688 Loading road quality type: uniform
160.1s 689 Uniform road quality value: 2
160.1s 690 Road quality loaded.
160.1s 691 Initial state created.
160.1s 692 Transferring initial state and road quality to GPU...
160.1s 693 GPU data transfer complete.
160.1s 694 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
160.1s 695 Initial boundary conditions applied.
160.1s 696 [BC UPDATE] left → phase 0 (outflow)
160.1s 697 └─ Outflow: zero-order extrapolation
160.1s 698 [BC UPDATE] left → phase 1 (inflow)
160.1s 699 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
160.1s 700 Running simulation until t = 60.00 s, outputting every 60.00 s
160.1s 701 
160.5s 702 [WARNING] Automatic CFL correction applied (count: 3300):
160.5s 703 Calculated CFL: 0.800 > Limit: 0.500
160.5s 704 Original dt: 4.470525e-01 s
160.5s 705 Corrected dt: 2.794078e-01 s
160.5s 706 Correction factor: 1.6x
160.5s 707 Max wave speed detected: 17.89 m/s
160.5s 708 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
161.0s 709 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
161.4s 710 [WARNING] Automatic CFL correction applied (count: 3400):
161.4s 711 Calculated CFL: 0.800 > Limit: 0.500
161.4s 712 Original dt: 4.119130e-01 s
161.4s 713 Corrected dt: 2.574456e-01 s
161.4s 714 Correction factor: 1.6x
161.4s 715 Max wave speed detected: 19.42 m/s
161.5s 716 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
162.0s 717 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
162.3s 718 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
162.3s 719 [A
162.3s 720 Stored output at t = 60.0000 s (Step 231)
162.3s 721 
162.3s 722 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.20s/s]
162.3s 723 Simulation finished at t = 60.0000 s after 231 steps.
162.3s 724 Total runtime: 2.21 seconds.
162.3s 725 [BC UPDATE] left → phase 0 (outflow)
162.3s 726 └─ Outflow: zero-order extrapolation
162.3s 727 Running simulation until t = 120.00 s, outputting every 60.00 s
162.3s 728 
162.4s 729 [WARNING] Automatic CFL correction applied (count: 3500):
162.4s 730 Calculated CFL: 0.800 > Limit: 0.500
162.4s 731 Original dt: 4.115046e-01 s
162.4s 732 Corrected dt: 2.571904e-01 s
162.4s 733 Correction factor: 1.6x
162.4s 734 Max wave speed detected: 19.44 m/s
162.4s 735 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
162.9s 736 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
163.3s 737 [WARNING] Automatic CFL correction applied (count: 3600):
163.3s 738 Calculated CFL: 0.800 > Limit: 0.500
163.3s 739 Original dt: 4.114982e-01 s
163.3s 740 Corrected dt: 2.571863e-01 s
163.3s 741 Correction factor: 1.6x
163.3s 742 Max wave speed detected: 19.44 m/s
163.4s 743 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
163.8s 744 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
164.2s 745 [WARNING] Automatic CFL correction applied (count: 3700):
164.2s 746 Calculated CFL: 0.800 > Limit: 0.500
164.2s 747 Original dt: 4.114980e-01 s
164.2s 748 Corrected dt: 2.571863e-01 s
164.2s 749 Correction factor: 1.6x
164.2s 750 Max wave speed detected: 19.44 m/s
164.3s 751 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
164.4s 752 Stored output at t = 120.0000 s (Step 465)
164.4s 753 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
164.4s 754 [A
164.4s 755 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s]
164.4s 756 
164.4s 757 Simulation finished at t = 120.0000 s after 465 steps.
164.4s 758 Total runtime: 2.15 seconds.
164.4s 759 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
164.4s 760 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
164.4s 761 Using device: gpu
164.4s 762 DEBUG PARAMS: Reading K_m_kmh = 10.0
164.4s 763 DEBUG PARAMS: Reading K_c_kmh = 15.0
164.4s 764 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
164.4s 765 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
164.4s 766 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
164.4s 767 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
164.4s 768 Loading road quality type: uniform
164.4s 769 Uniform road quality value: 2
164.4s 770 Road quality loaded.
164.4s 771 Initial state created.
164.4s 772 Transferring initial state and road quality to GPU...
164.4s 773 GPU data transfer complete.
164.4s 774 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
164.4s 775 Initial boundary conditions applied.
164.4s 776 [BC UPDATE] left → phase 0 (outflow)
164.4s 777 └─ Outflow: zero-order extrapolation
164.4s 778 [BC UPDATE] left → phase 1 (inflow)
164.4s 779 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
164.4s 780 Running simulation until t = 60.00 s, outputting every 60.00 s
164.4s 781 
164.9s 782 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
165.2s 783 [WARNING] Automatic CFL correction applied (count: 3800):
165.2s 784 Calculated CFL: 0.800 > Limit: 0.500
165.2s 785 Original dt: 4.190346e-01 s
165.2s 786 Corrected dt: 2.618967e-01 s
165.2s 787 Correction factor: 1.6x
165.2s 788 Max wave speed detected: 19.09 m/s
165.4s 789 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
165.9s 790 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
166.1s 791 [WARNING] Automatic CFL correction applied (count: 3900):
166.1s 792 Calculated CFL: 0.800 > Limit: 0.500
166.1s 793 Original dt: 4.115954e-01 s
166.1s 794 Corrected dt: 2.572472e-01 s
166.1s 795 Correction factor: 1.6x
166.1s 796 Max wave speed detected: 19.44 m/s
166.3s 797 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
166.6s 798 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
166.6s 799 [A
166.6s 800 Stored output at t = 60.0000 s (Step 231)
166.6s 801 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.28s/s]
166.6s 802 
166.6s 803 Simulation finished at t = 60.0000 s after 231 steps.
166.6s 804 Total runtime: 2.20 seconds.
166.6s 805 [BC UPDATE] left → phase 0 (outflow)
166.6s 806 └─ Outflow: zero-order extrapolation
166.6s 807 Running simulation until t = 120.00 s, outputting every 60.00 s
166.6s 808 
166.8s 809 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
167.1s 810 [WARNING] Automatic CFL correction applied (count: 4000):
167.1s 811 Calculated CFL: 0.800 > Limit: 0.500
167.1s 812 Original dt: 4.114996e-01 s
167.1s 813 Corrected dt: 2.571873e-01 s
167.1s 814 Correction factor: 1.6x
167.1s 815 Max wave speed detected: 19.44 m/s
167.3s 816 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
167.7s 817 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
168.0s 818 [WARNING] Automatic CFL correction applied (count: 4100):
168.0s 819 Calculated CFL: 0.800 > Limit: 0.500
168.0s 820 Original dt: 4.114981e-01 s
168.0s 821 Corrected dt: 2.571863e-01 s
168.0s 822 Correction factor: 1.6x
168.0s 823 Max wave speed detected: 19.44 m/s
168.2s 824 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
168.7s 825 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
168.8s 826 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
168.8s 827 [A
168.8s 828 Stored output at t = 120.0000 s (Step 465)
168.8s 829 
168.8s 830 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s]
168.8s 831 Simulation finished at t = 120.0000 s after 465 steps.
168.8s 832 Total runtime: 2.17 seconds.
168.8s 833 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
168.8s 834 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
168.8s 835 Using device: gpu
168.8s 836 DEBUG PARAMS: Reading K_m_kmh = 10.0
168.8s 837 DEBUG PARAMS: Reading K_c_kmh = 15.0
168.8s 838 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
168.8s 839 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
168.8s 840 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
168.8s 841 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
168.8s 842 Loading road quality type: uniform
168.8s 843 Uniform road quality value: 2
168.8s 844 Road quality loaded.
168.8s 845 Initial state created.
168.8s 846 Transferring initial state and road quality to GPU...
168.8s 847 GPU data transfer complete.
168.8s 848 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
168.8s 849 Initial boundary conditions applied.
168.8s 850 [BC UPDATE] left → phase 0 (outflow)
168.8s 851 └─ Outflow: zero-order extrapolation
168.8s 852 [BC UPDATE] left → phase 1 (inflow)
168.8s 853 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
168.8s 854 Running simulation until t = 60.00 s, outputting every 60.00 s
168.8s 855 
169.0s 856 [WARNING] Automatic CFL correction applied (count: 4200):
169.0s 857 Calculated CFL: 0.800 > Limit: 0.500
169.0s 858 Original dt: 4.022422e-01 s
169.0s 859 Corrected dt: 2.514014e-01 s
169.0s 860 Correction factor: 1.6x
169.0s 861 Max wave speed detected: 19.89 m/s
169.3s 862 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
169.8s 863 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
169.9s 864 [WARNING] Automatic CFL correction applied (count: 4300):
169.9s 865 Calculated CFL: 0.800 > Limit: 0.500
169.9s 866 Original dt: 4.130229e-01 s
169.9s 867 Corrected dt: 2.581393e-01 s
169.9s 868 Correction factor: 1.6x
169.9s 869 Max wave speed detected: 19.37 m/s
170.2s 870 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
170.7s 871 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
170.8s 872 [WARNING] Automatic CFL correction applied (count: 4400):
170.8s 873 Calculated CFL: 0.800 > Limit: 0.500
170.8s 874 Original dt: 4.115198e-01 s
170.8s 875 Corrected dt: 2.571999e-01 s
170.8s 876 Correction factor: 1.6x
170.8s 877 Max wave speed detected: 19.44 m/s
171.0s 878 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
171.0s 879 [A
171.0s 880 Stored output at t = 60.0000 s (Step 231)
171.0s 881 
171.0s 882 Simulation finished at t = 60.0000 s after 231 steps.
171.0s 883 Total runtime: 2.18 seconds.
171.0s 884 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.59s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.58s/s]
171.0s 885 
171.0s 886 [BC UPDATE] left → phase 0 (outflow)
171.0s 887 └─ Outflow: zero-order extrapolation
171.0s 888 Running simulation until t = 120.00 s, outputting every 60.00 s
171.2s 889 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
171.7s 890 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
171.8s 891 [WARNING] Automatic CFL correction applied (count: 4500):
171.8s 892 Calculated CFL: 0.800 > Limit: 0.500
171.8s 893 Original dt: 4.114984e-01 s
171.8s 894 Corrected dt: 2.571865e-01 s
171.8s 895 Correction factor: 1.6x
171.8s 896 Max wave speed detected: 19.44 m/s
172.1s 897 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
172.6s 898 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
172.7s 899 [WARNING] Automatic CFL correction applied (count: 4600):
172.7s 900 Calculated CFL: 0.800 > Limit: 0.500
172.7s 901 Original dt: 4.114980e-01 s
172.7s 902 Corrected dt: 2.571863e-01 s
172.7s 903 Correction factor: 1.6x
172.7s 904 Max wave speed detected: 19.44 m/s
173.1s 905 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
173.2s 906 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
173.2s 907 [A
173.2s 908 Stored output at t = 120.0000 s (Step 465)
173.2s 909 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.33s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.33s/s]
173.2s 910 
173.2s 911 Simulation finished at t = 120.0000 s after 465 steps.
173.2s 912 Total runtime: 2.20 seconds.
173.2s 913 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
173.2s 914 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
173.2s 915 Using device: gpu
173.2s 916 DEBUG PARAMS: Reading K_m_kmh = 10.0
173.2s 917 DEBUG PARAMS: Reading K_c_kmh = 15.0
173.2s 918 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
173.2s 919 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
173.2s 920 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
173.2s 921 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
173.2s 922 Loading road quality type: uniform
173.2s 923 Uniform road quality value: 2
173.2s 924 Road quality loaded.
173.2s 925 Initial state created.
173.2s 926 Transferring initial state and road quality to GPU...
173.2s 927 GPU data transfer complete.
173.2s 928 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
173.2s 929 Initial boundary conditions applied.
173.2s 930 [BC UPDATE] left → phase 0 (outflow)
173.2s 931 └─ Outflow: zero-order extrapolation
173.2s 932 [BC UPDATE] left → phase 1 (inflow)
173.2s 933 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
173.2s 934 Running simulation until t = 60.00 s, outputting every 60.00 s
173.2s 935 
173.7s 936 [WARNING] Automatic CFL correction applied (count: 4700):
173.7s 937 Calculated CFL: 0.800 > Limit: 0.500
173.7s 938 Original dt: 4.396418e-01 s
173.7s 939 Corrected dt: 2.747761e-01 s
173.7s 940 Correction factor: 1.6x
173.7s 941 Max wave speed detected: 18.20 m/s
173.7s 942 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
174.1s 943 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
174.6s 944 [WARNING] Automatic CFL correction applied (count: 4800):
174.6s 945 Calculated CFL: 0.800 > Limit: 0.500
174.6s 946 Original dt: 4.118393e-01 s
174.6s 947 Corrected dt: 2.573996e-01 s
174.6s 948 Correction factor: 1.6x
174.6s 949 Max wave speed detected: 19.43 m/s
174.6s 950 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
175.1s 951 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
175.4s 952 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
175.4s 953 [A
175.4s 954 Stored output at t = 60.0000 s (Step 231)
175.4s 955 
175.4s 956 Simulation finished at t = 60.0000 s after 231 steps.
175.4s 957 Total runtime: 2.15 seconds.
175.4s 958 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s]
175.4s 959 Running simulation until t = 120.00 s, outputting every 60.00 s
175.4s 960 
175.5s 961 [WARNING] Automatic CFL correction applied (count: 4900):
175.5s 962 Calculated CFL: 0.800 > Limit: 0.500
175.5s 963 Original dt: 4.115033e-01 s
175.5s 964 Corrected dt: 2.571896e-01 s
175.5s 965 Correction factor: 1.6x
175.5s 966 Max wave speed detected: 19.44 m/s
175.5s 967 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
176.0s 968 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
176.5s 969 [WARNING] Automatic CFL correction applied (count: 5000):
176.5s 970 Calculated CFL: 0.800 > Limit: 0.500
176.5s 971 Original dt: 4.114981e-01 s
176.5s 972 Corrected dt: 2.571863e-01 s
176.5s 973 Correction factor: 1.6x
176.5s 974 Max wave speed detected: 19.44 m/s
176.5s 975 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
177.0s 976 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
177.4s 977 [WARNING] Automatic CFL correction applied (count: 5100):
177.4s 978 Calculated CFL: 0.800 > Limit: 0.500
177.4s 979 Original dt: 4.114980e-01 s
177.4s 980 Corrected dt: 2.571863e-01 s
177.4s 981 Correction factor: 1.6x
177.4s 982 Max wave speed detected: 19.44 m/s
177.4s 983 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
177.6s 984 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
177.6s 985 [A
177.6s 986 Stored output at t = 120.0000 s (Step 465)
177.6s 987 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.37s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.36s/s]
177.6s 988 
177.6s 989 Simulation finished at t = 120.0000 s after 465 steps.
177.6s 990 Total runtime: 2.19 seconds.
177.6s 991 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
177.6s 992 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
177.6s 993 Using device: gpu
177.6s 994 DEBUG PARAMS: Reading K_m_kmh = 10.0
177.6s 995 DEBUG PARAMS: Reading K_c_kmh = 15.0
177.6s 996 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
177.6s 997 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
177.6s 998 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
177.6s 999 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
177.6s 1000 Loading road quality type: uniform
177.6s 1001 Uniform road quality value: 2
177.6s 1002 Road quality loaded.
177.6s 1003 Initial state created.
177.6s 1004 Transferring initial state and road quality to GPU...
177.6s 1005 GPU data transfer complete.
177.6s 1006 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
177.6s 1007 Initial boundary conditions applied.
177.6s 1008 [BC UPDATE] left → phase 0 (outflow)
177.6s 1009 └─ Outflow: zero-order extrapolation
177.6s 1010 [BC UPDATE] left → phase 1 (inflow)
177.6s 1011 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
177.6s 1012 Running simulation until t = 60.00 s, outputting every 60.00 s
177.6s 1013 
178.0s 1014 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
178.4s 1015 [WARNING] Automatic CFL correction applied (count: 5200):
178.4s 1016 Calculated CFL: 0.800 > Limit: 0.500
178.4s 1017 Original dt: 4.173029e-01 s
178.4s 1018 Corrected dt: 2.608143e-01 s
178.4s 1019 Correction factor: 1.6x
178.4s 1020 Max wave speed detected: 19.17 m/s
178.5s 1021 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
179.0s 1022 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
179.3s 1023 [WARNING] Automatic CFL correction applied (count: 5300):
179.3s 1024 Calculated CFL: 0.800 > Limit: 0.500
179.3s 1025 Original dt: 4.115760e-01 s
179.3s 1026 Corrected dt: 2.572350e-01 s
179.3s 1027 Correction factor: 1.6x
179.3s 1028 Max wave speed detected: 19.44 m/s
179.4s 1029 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
179.7s 1030 Stored output at t = 60.0000 s (Step 231)
179.7s 1031 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
179.7s 1032 [A
179.7s 1033 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.83s/s]
179.7s 1034 
179.7s 1035 Simulation finished at t = 60.0000 s after 231 steps.
179.7s 1036 Total runtime: 2.16 seconds.
179.7s 1037 [BC UPDATE] left → phase 0 (outflow)
179.7s 1038 └─ Outflow: zero-order extrapolation
179.7s 1039 Running simulation until t = 120.00 s, outputting every 60.00 s
179.7s 1040 
179.9s 1041 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
180.2s 1042 [WARNING] Automatic CFL correction applied (count: 5400):
180.2s 1043 Calculated CFL: 0.800 > Limit: 0.500
180.2s 1044 Original dt: 4.114993e-01 s
180.2s 1045 Corrected dt: 2.571871e-01 s
180.2s 1046 Correction factor: 1.6x
180.2s 1047 Max wave speed detected: 19.44 m/s
180.4s 1048 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
180.9s 1049 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
181.2s 1050 [WARNING] Automatic CFL correction applied (count: 5500):
181.2s 1051 Calculated CFL: 0.800 > Limit: 0.500
181.2s 1052 Original dt: 4.114981e-01 s
181.2s 1053 Corrected dt: 2.571863e-01 s
181.2s 1054 Correction factor: 1.6x
181.2s 1055 Max wave speed detected: 19.44 m/s
181.3s 1056 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
181.8s 1057 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
182.0s 1058 Stored output at t = 120.0000 s (Step 465)
182.0s 1059 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
182.0s 1060 [A
182.0s 1061 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s]
182.0s 1062 
182.0s 1063 Simulation finished at t = 120.0000 s after 465 steps.
182.0s 1064 Total runtime: 2.22 seconds.
182.0s 1065 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
182.0s 1066 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
182.0s 1067 Using device: gpu
182.0s 1068 DEBUG PARAMS: Reading K_m_kmh = 10.0
182.0s 1069 DEBUG PARAMS: Reading K_c_kmh = 15.0
182.0s 1070 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
182.0s 1071 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
182.0s 1072 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
182.0s 1073 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
182.0s 1074 Loading road quality type: uniform
182.0s 1075 Uniform road quality value: 2
182.0s 1076 Road quality loaded.
182.0s 1077 Initial state created.
182.0s 1078 Transferring initial state and road quality to GPU...
182.0s 1079 GPU data transfer complete.
182.0s 1080 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
182.0s 1081 Initial boundary conditions applied.
182.0s 1082 [BC UPDATE] left → phase 0 (outflow)
182.0s 1083 └─ Outflow: zero-order extrapolation
182.0s 1084 [BC UPDATE] left → phase 1 (inflow)
182.0s 1085 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
182.0s 1086 Running simulation until t = 60.00 s, outputting every 60.00 s
182.0s 1087 
182.2s 1088 [WARNING] Automatic CFL correction applied (count: 5600):
182.2s 1089 Calculated CFL: 0.800 > Limit: 0.500
182.2s 1090 Original dt: 4.295974e-01 s
182.2s 1091 Corrected dt: 2.684983e-01 s
182.2s 1092 Correction factor: 1.6x
182.2s 1093 Max wave speed detected: 18.62 m/s
182.4s 1094 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
182.9s 1095 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
183.1s 1096 [WARNING] Automatic CFL correction applied (count: 5700):
183.1s 1097 Calculated CFL: 0.800 > Limit: 0.500
183.1s 1098 Original dt: 4.127253e-01 s
183.1s 1099 Corrected dt: 2.579533e-01 s
183.1s 1100 Correction factor: 1.6x
183.1s 1101 Max wave speed detected: 19.38 m/s
183.4s 1102 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
183.9s 1103 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
184.1s 1104 [WARNING] Automatic CFL correction applied (count: 5800):
184.1s 1105 Calculated CFL: 0.800 > Limit: 0.500
184.1s 1106 Original dt: 4.115153e-01 s
184.1s 1107 Corrected dt: 2.571971e-01 s
184.1s 1108 Correction factor: 1.6x
184.1s 1109 Max wave speed detected: 19.44 m/s
184.2s 1110 Stored output at t = 60.0000 s (Step 231)
184.2s 1111 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
184.2s 1112 [A
184.2s 1113 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.43s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.43s/s]
184.2s 1114 
184.2s 1115 Simulation finished at t = 60.0000 s after 231 steps.
184.2s 1116 Total runtime: 2.19 seconds.
184.2s 1117 [BC UPDATE] left → phase 0 (outflow)
184.2s 1118 └─ Outflow: zero-order extrapolation
184.2s 1119 Running simulation until t = 120.00 s, outputting every 60.00 s
184.2s 1120 
184.3s 1121 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
184.8s 1122 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
185.0s 1123 [WARNING] Automatic CFL correction applied (count: 5900):
185.0s 1124 Calculated CFL: 0.800 > Limit: 0.500
185.0s 1125 Original dt: 4.114984e-01 s
185.0s 1126 Corrected dt: 2.571865e-01 s
185.0s 1127 Correction factor: 1.6x
185.0s 1128 Max wave speed detected: 19.44 m/s
185.3s 1129 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
185.7s 1130 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
185.9s 1131 [WARNING] Automatic CFL correction applied (count: 6000):
185.9s 1132 Calculated CFL: 0.800 > Limit: 0.500
185.9s 1133 Original dt: 4.114980e-01 s
185.9s 1134 Corrected dt: 2.571863e-01 s
185.9s 1135 Correction factor: 1.6x
185.9s 1136 Max wave speed detected: 19.44 m/s
186.2s 1137 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
186.3s 1138 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
186.3s 1139 [A
186.3s 1140 Stored output at t = 120.0000 s (Step 465)
186.3s 1141 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s]
186.3s 1142 
186.3s 1143 Simulation finished at t = 120.0000 s after 465 steps.
186.3s 1144 Total runtime: 2.18 seconds.
186.4s 1145 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
186.4s 1146 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
186.4s 1147 Using device: gpu
186.4s 1148 DEBUG PARAMS: Reading K_m_kmh = 10.0
186.4s 1149 DEBUG PARAMS: Reading K_c_kmh = 15.0
186.4s 1150 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
186.4s 1151 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
186.4s 1152 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
186.4s 1153 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
186.4s 1154 Loading road quality type: uniform
186.4s 1155 Uniform road quality value: 2
186.4s 1156 Road quality loaded.
186.4s 1157 Initial state created.
186.4s 1158 Transferring initial state and road quality to GPU...
186.4s 1159 GPU data transfer complete.
186.4s 1160 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
186.4s 1161 Initial boundary conditions applied.
186.4s 1162 [BC UPDATE] left → phase 0 (outflow)
186.4s 1163 └─ Outflow: zero-order extrapolation
186.4s 1164 [BC UPDATE] left → phase 1 (inflow)
186.4s 1165 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
186.4s 1166 Running simulation until t = 60.00 s, outputting every 60.00 s
186.4s 1167 
186.8s 1168 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
186.9s 1169 [WARNING] Automatic CFL correction applied (count: 6100):
186.9s 1170 Calculated CFL: 0.800 > Limit: 0.500
186.9s 1171 Original dt: 4.346596e-01 s
186.9s 1172 Corrected dt: 2.716622e-01 s
186.9s 1173 Correction factor: 1.6x
186.9s 1174 Max wave speed detected: 18.41 m/s
187.3s 1175 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
187.7s 1176 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
187.8s 1177 [WARNING] Automatic CFL correction applied (count: 6200):
187.8s 1178 Calculated CFL: 0.800 > Limit: 0.500
187.8s 1179 Original dt: 4.117853e-01 s
187.8s 1180 Corrected dt: 2.573658e-01 s
187.8s 1181 Correction factor: 1.6x
187.8s 1182 Max wave speed detected: 19.43 m/s
188.2s 1183 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
188.5s 1184 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
188.5s 1185 [A
188.5s 1186 Stored output at t = 60.0000 s (Step 231)
188.5s 1187 
188.5s 1188 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.98s/s]
188.5s 1189 Simulation finished at t = 60.0000 s after 231 steps.
188.5s 1190 Total runtime: 2.14 seconds.
188.5s 1191 Running simulation until t = 120.00 s, outputting every 60.00 s
188.5s 1192 
188.7s 1193 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
188.7s 1194 [WARNING] Automatic CFL correction applied (count: 6300):
188.7s 1195 Calculated CFL: 0.800 > Limit: 0.500
188.7s 1196 Original dt: 4.115023e-01 s
188.7s 1197 Corrected dt: 2.571890e-01 s
188.7s 1198 Correction factor: 1.6x
188.7s 1199 Max wave speed detected: 19.44 m/s
189.2s 1200 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
189.6s 1201 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
189.7s 1202 [WARNING] Automatic CFL correction applied (count: 6400):
189.7s 1203 Calculated CFL: 0.800 > Limit: 0.500
189.7s 1204 Original dt: 4.114981e-01 s
189.7s 1205 Corrected dt: 2.571863e-01 s
189.7s 1206 Correction factor: 1.6x
189.7s 1207 Max wave speed detected: 19.44 m/s
190.1s 1208 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
190.6s 1209 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
190.6s 1210 [WARNING] Automatic CFL correction applied (count: 6500):
190.6s 1211 Calculated CFL: 0.800 > Limit: 0.500
190.6s 1212 Original dt: 4.114980e-01 s
190.6s 1213 Corrected dt: 2.571863e-01 s
190.6s 1214 Correction factor: 1.6x
190.6s 1215 Max wave speed detected: 19.44 m/s
190.7s 1216 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
190.7s 1217 [A
190.7s 1218 Stored output at t = 120.0000 s (Step 465)
190.7s 1219 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.00s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.99s/s]
190.7s 1220 
190.7s 1221 Simulation finished at t = 120.0000 s after 465 steps.
190.7s 1222 Total runtime: 2.22 seconds.
190.7s 1223 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
190.7s 1224 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
190.7s 1225 Using device: gpu
190.7s 1226 DEBUG PARAMS: Reading K_m_kmh = 10.0
190.7s 1227 DEBUG PARAMS: Reading K_c_kmh = 15.0
190.7s 1228 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
190.7s 1229 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
190.7s 1230 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
190.7s 1231 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
190.7s 1232 Loading road quality type: uniform
190.7s 1233 Uniform road quality value: 2
190.7s 1234 Road quality loaded.
190.7s 1235 Initial state created.
190.7s 1236 Transferring initial state and road quality to GPU...
190.7s 1237 GPU data transfer complete.
190.7s 1238 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
190.7s 1239 Initial boundary conditions applied.
190.7s 1240 [BC UPDATE] left → phase 0 (outflow)
190.7s 1241 └─ Outflow: zero-order extrapolation
190.8s 1242 [BC UPDATE] left → phase 1 (inflow)
190.8s 1243 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
190.8s 1244 Running simulation until t = 60.00 s, outputting every 60.00 s
190.8s 1245 
191.2s 1246 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
191.6s 1247 [WARNING] Automatic CFL correction applied (count: 6600):
191.6s 1248 Calculated CFL: 0.800 > Limit: 0.500
191.6s 1249 Original dt: 4.160552e-01 s
191.6s 1250 Corrected dt: 2.600345e-01 s
191.6s 1251 Correction factor: 1.6x
191.6s 1252 Max wave speed detected: 19.23 m/s
191.7s 1253 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
192.2s 1254 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
192.6s 1255 [WARNING] Automatic CFL correction applied (count: 6700):
192.6s 1256 Calculated CFL: 0.800 > Limit: 0.500
192.6s 1257 Original dt: 4.115592e-01 s
192.6s 1258 Corrected dt: 2.572245e-01 s
192.6s 1259 Correction factor: 1.6x
192.6s 1260 Max wave speed detected: 19.44 m/s
192.7s 1261 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
193.0s 1262 Stored output at t = 60.0000 s (Step 231)
193.0s 1263 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
193.0s 1264 [A
193.0s 1265 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.98s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.98s/s]
193.0s 1266 
193.0s 1267 Simulation finished at t = 60.0000 s after 231 steps.
193.0s 1268 Total runtime: 2.22 seconds.
193.0s 1269 [BC UPDATE] left → phase 0 (outflow)
193.0s 1270 └─ Outflow: zero-order extrapolation
193.0s 1271 Running simulation until t = 120.00 s, outputting every 60.00 s
193.0s 1272 
193.2s 1273 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
193.5s 1274 [WARNING] Automatic CFL correction applied (count: 6800):
193.5s 1275 Calculated CFL: 0.800 > Limit: 0.500
193.5s 1276 Original dt: 4.114991e-01 s
193.5s 1277 Corrected dt: 2.571870e-01 s
193.5s 1278 Correction factor: 1.6x
193.5s 1279 Max wave speed detected: 19.44 m/s
193.6s 1280 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
194.1s 1281 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
194.4s 1282 [WARNING] Automatic CFL correction applied (count: 6900):
194.4s 1283 Calculated CFL: 0.800 > Limit: 0.500
194.4s 1284 Original dt: 4.114980e-01 s
194.4s 1285 Corrected dt: 2.571863e-01 s
194.4s 1286 Correction factor: 1.6x
194.4s 1287 Max wave speed detected: 19.44 m/s
194.5s 1288 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
195.0s 1289 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
195.1s 1290 Stored output at t = 120.0000 s (Step 465)
195.2s 1291 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
195.2s 1292 [A
195.2s 1293 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.73s/s]
195.2s 1294 
195.2s 1295 Simulation finished at t = 120.0000 s after 465 steps.
195.2s 1296 Total runtime: 2.16 seconds.
195.2s 1297 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
195.2s 1298 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
195.2s 1299 Using device: gpu
195.2s 1300 DEBUG PARAMS: Reading K_m_kmh = 10.0
195.2s 1301 DEBUG PARAMS: Reading K_c_kmh = 15.0
195.2s 1302 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
195.2s 1303 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
195.2s 1304 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
195.2s 1305 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
195.2s 1306 Loading road quality type: uniform
195.2s 1307 Uniform road quality value: 2
195.2s 1308 Road quality loaded.
195.2s 1309 Initial state created.
195.2s 1310 Transferring initial state and road quality to GPU...
195.2s 1311 GPU data transfer complete.
195.2s 1312 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
195.2s 1313 Initial boundary conditions applied.
195.2s 1314 [BC UPDATE] left → phase 0 (outflow)
195.2s 1315 └─ Outflow: zero-order extrapolation
195.2s 1316 [BC UPDATE] left → phase 1 (inflow)
195.2s 1317 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
195.2s 1318 Running simulation until t = 60.00 s, outputting every 60.00 s
195.2s 1319 
195.4s 1320 [WARNING] Automatic CFL correction applied (count: 7000):
195.4s 1321 Calculated CFL: 0.800 > Limit: 0.500
195.4s 1322 Original dt: 4.547467e-01 s
195.4s 1323 Corrected dt: 2.842167e-01 s
195.4s 1324 Correction factor: 1.6x
195.4s 1325 Max wave speed detected: 17.59 m/s
195.6s 1326 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
196.1s 1327 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
196.3s 1328 [WARNING] Automatic CFL correction applied (count: 7100):
196.3s 1329 Calculated CFL: 0.800 > Limit: 0.500
196.3s 1330 Original dt: 4.125079e-01 s
196.3s 1331 Corrected dt: 2.578175e-01 s
196.3s 1332 Correction factor: 1.6x
196.3s 1333 Max wave speed detected: 19.39 m/s
196.6s 1334 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
197.0s 1335 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
197.2s 1336 [WARNING] Automatic CFL correction applied (count: 7200):
197.2s 1337 Calculated CFL: 0.800 > Limit: 0.500
197.2s 1338 Original dt: 4.115121e-01 s
197.2s 1339 Corrected dt: 2.571950e-01 s
197.2s 1340 Correction factor: 1.6x
197.2s 1341 Max wave speed detected: 19.44 m/s
197.3s 1342 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
197.3s 1343 [A
197.3s 1344 Stored output at t = 60.0000 s (Step 231)
197.3s 1345 
197.3s 1346 Simulation finished at t = 60.0000 s after 231 steps.
197.3s 1347 Total runtime: 2.12 seconds.
197.3s 1348 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.25s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.25s/s]
197.3s 1349 Running simulation until t = 120.00 s, outputting every 60.00 s
197.3s 1350 
197.5s 1351 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
197.9s 1352 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
198.2s 1353 [WARNING] Automatic CFL correction applied (count: 7300):
198.2s 1354 Calculated CFL: 0.800 > Limit: 0.500
198.2s 1355 Original dt: 4.114983e-01 s
198.2s 1356 Corrected dt: 2.571865e-01 s
198.2s 1357 Correction factor: 1.6x
198.2s 1358 Max wave speed detected: 19.44 m/s
198.4s 1359 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
198.9s 1360 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
199.1s 1361 [WARNING] Automatic CFL correction applied (count: 7400):
199.1s 1362 Calculated CFL: 0.800 > Limit: 0.500
199.1s 1363 Original dt: 4.114980e-01 s
199.1s 1364 Corrected dt: 2.571863e-01 s
199.1s 1365 Correction factor: 1.6x
199.1s 1366 Max wave speed detected: 19.44 m/s
199.3s 1367 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
199.5s 1368 Stored output at t = 120.0000 s (Step 465)
199.5s 1369 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
199.5s 1370 [A
199.5s 1371 
199.5s 1372 Simulation finished at t = 120.0000 s after 465 steps.
199.5s 1373 Total runtime: 2.17 seconds.
199.5s 1374 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.59s/s]
199.5s 1375 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
199.5s 1376 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
199.5s 1377 Using device: gpu
199.5s 1378 DEBUG PARAMS: Reading K_m_kmh = 10.0
199.5s 1379 DEBUG PARAMS: Reading K_c_kmh = 15.0
199.5s 1380 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
199.5s 1381 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
199.5s 1382 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
199.5s 1383 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
199.5s 1384 Loading road quality type: uniform
199.5s 1385 Uniform road quality value: 2
199.5s 1386 Road quality loaded.
199.5s 1387 Initial state created.
199.5s 1388 Transferring initial state and road quality to GPU...
199.5s 1389 GPU data transfer complete.
199.5s 1390 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
199.5s 1391 Initial boundary conditions applied.
199.5s 1392 [BC UPDATE] left → phase 0 (outflow)
199.5s 1393 └─ Outflow: zero-order extrapolation
199.5s 1394 Running simulation until t = 60.00 s, outputting every 60.00 s
199.5s 1395 
200.0s 1396 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
200.1s 1397 [WARNING] Automatic CFL correction applied (count: 7500):
200.1s 1398 Calculated CFL: 0.800 > Limit: 0.500
200.1s 1399 Original dt: 4.295897e-01 s
200.1s 1400 Corrected dt: 2.684936e-01 s
200.1s 1401 Correction factor: 1.6x
200.1s 1402 Max wave speed detected: 18.62 m/s
200.5s 1403 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
201.1s 1404 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
201.1s 1405 [WARNING] Automatic CFL correction applied (count: 7600):
201.1s 1406 Calculated CFL: 0.800 > Limit: 0.500
201.1s 1407 Original dt: 4.117215e-01 s
201.1s 1408 Corrected dt: 2.573259e-01 s
201.1s 1409 Correction factor: 1.6x
201.1s 1410 Max wave speed detected: 19.43 m/s
201.5s 1411 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
201.8s 1412 Stored output at t = 60.0000 s (Step 231)
201.8s 1413 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
201.8s 1414 [A
201.8s 1415 
201.8s 1416 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.79s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.79s/s]
201.8s 1417 Simulation finished at t = 60.0000 s after 231 steps.
201.8s 1418 Total runtime: 2.33 seconds.
201.8s 1419 Running simulation until t = 120.00 s, outputting every 60.00 s
201.8s 1420 
202.0s 1421 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
202.1s 1422 [WARNING] Automatic CFL correction applied (count: 7700):
202.1s 1423 Calculated CFL: 0.800 > Limit: 0.500
202.1s 1424 Original dt: 4.115016e-01 s
202.1s 1425 Corrected dt: 2.571885e-01 s
202.1s 1426 Correction factor: 1.6x
202.1s 1427 Max wave speed detected: 19.44 m/s
202.5s 1428 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
202.9s 1429 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
203.0s 1430 [WARNING] Automatic CFL correction applied (count: 7800):
203.0s 1431 Calculated CFL: 0.800 > Limit: 0.500
203.0s 1432 Original dt: 4.114981e-01 s
203.0s 1433 Corrected dt: 2.571863e-01 s
203.0s 1434 Correction factor: 1.6x
203.0s 1435 Max wave speed detected: 19.44 m/s
203.4s 1436 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
203.9s 1437 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
203.9s 1438 [WARNING] Automatic CFL correction applied (count: 7900):
203.9s 1439 Calculated CFL: 0.800 > Limit: 0.500
203.9s 1440 Original dt: 4.114980e-01 s
203.9s 1441 Corrected dt: 2.571863e-01 s
203.9s 1442 Correction factor: 1.6x
203.9s 1443 Max wave speed detected: 19.44 m/s
204.0s 1444 Stored output at t = 120.0000 s (Step 465)
204.0s 1445 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
204.0s 1446 [A
204.0s 1447 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.47s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.47s/s]
204.0s 1448 
204.0s 1449 Simulation finished at t = 120.0000 s after 465 steps.
204.0s 1450 Total runtime: 2.18 seconds.
204.0s 1451 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
204.0s 1452 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
204.0s 1453 Using device: gpu
204.0s 1454 DEBUG PARAMS: Reading K_m_kmh = 10.0
204.0s 1455 DEBUG PARAMS: Reading K_c_kmh = 15.0
204.0s 1456 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
204.0s 1457 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
204.0s 1458 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
204.0s 1459 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
204.0s 1460 Loading road quality type: uniform
204.0s 1461 Uniform road quality value: 2
204.0s 1462 Road quality loaded.
204.0s 1463 Initial state created.
204.0s 1464 Transferring initial state and road quality to GPU...
204.0s 1465 GPU data transfer complete.
204.0s 1466 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
204.0s 1467 Initial boundary conditions applied.
204.0s 1468 [BC UPDATE] left → phase 0 (outflow)
204.0s 1469 └─ Outflow: zero-order extrapolation
204.0s 1470 Running simulation until t = 60.00 s, outputting every 60.00 s
204.0s 1471 
204.5s 1472 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
204.9s 1473 [WARNING] Automatic CFL correction applied (count: 8000):
204.9s 1474 Calculated CFL: 0.800 > Limit: 0.500
204.9s 1475 Original dt: 4.151534e-01 s
204.9s 1476 Corrected dt: 2.594709e-01 s
204.9s 1477 Correction factor: 1.6x
204.9s 1478 Max wave speed detected: 19.27 m/s
204.9s 1479 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
205.4s 1480 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
205.8s 1481 [WARNING] Automatic CFL correction applied (count: 8100):
205.8s 1482 Calculated CFL: 0.800 > Limit: 0.500
205.8s 1483 Original dt: 4.115470e-01 s
205.8s 1484 Corrected dt: 2.572169e-01 s
205.8s 1485 Correction factor: 1.6x
205.8s 1486 Max wave speed detected: 19.44 m/s
205.9s 1487 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
206.2s 1488 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
206.2s 1489 [A
206.2s 1490 Stored output at t = 60.0000 s (Step 231)
206.2s 1491 
206.2s 1492 Simulation finished at t = 60.0000 s after 231 steps.
206.2s 1493 Total runtime: 2.14 seconds.
206.2s 1494 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s]
206.2s 1495 Running simulation until t = 120.00 s, outputting every 60.00 s
206.2s 1496 
206.3s 1497 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
206.7s 1498 [WARNING] Automatic CFL correction applied (count: 8200):
206.7s 1499 Calculated CFL: 0.800 > Limit: 0.500
206.7s 1500 Original dt: 4.114990e-01 s
206.7s 1501 Corrected dt: 2.571869e-01 s
206.7s 1502 Correction factor: 1.6x
206.7s 1503 Max wave speed detected: 19.44 m/s
206.8s 1504 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
207.3s 1505 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
207.7s 1506 [WARNING] Automatic CFL correction applied (count: 8300):
207.7s 1507 Calculated CFL: 0.800 > Limit: 0.500
207.7s 1508 Original dt: 4.114980e-01 s
207.7s 1509 Corrected dt: 2.571863e-01 s
207.7s 1510 Correction factor: 1.6x
207.7s 1511 Max wave speed detected: 19.44 m/s
207.7s 1512 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
208.2s 1513 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
208.3s 1514 Stored output at t = 120.0000 s (Step 465)
208.3s 1515 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
208.3s 1516 [A
208.3s 1517 
208.3s 1518 Simulation finished at t = 120.0000 s after 465 steps.
208.3s 1519 Total runtime: 2.17 seconds.
208.3s 1520 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.70s/s]
208.3s 1521 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
208.3s 1522 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
208.3s 1523 Using device: gpu
208.3s 1524 DEBUG PARAMS: Reading K_m_kmh = 10.0
208.3s 1525 DEBUG PARAMS: Reading K_c_kmh = 15.0
208.3s 1526 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
208.3s 1527 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
208.3s 1528 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
208.3s 1529 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
208.3s 1530 Loading road quality type: uniform
208.3s 1531 Uniform road quality value: 2
208.3s 1532 Road quality loaded.
208.3s 1533 Initial state created.
208.3s 1534 Transferring initial state and road quality to GPU...
208.3s 1535 GPU data transfer complete.
208.3s 1536 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
208.3s 1537 Initial boundary conditions applied.
208.3s 1538 [BC UPDATE] left → phase 0 (outflow)
208.3s 1539 └─ Outflow: zero-order extrapolation
208.3s 1540 [BC UPDATE] left → phase 1 (inflow)
208.3s 1541 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
208.3s 1542 Running simulation until t = 60.00 s, outputting every 60.00 s
208.3s 1543 
208.6s 1544 [WARNING] Automatic CFL correction applied (count: 8400):
208.6s 1545 Calculated CFL: 0.800 > Limit: 0.500
208.6s 1546 Original dt: 4.768783e-01 s
208.6s 1547 Corrected dt: 2.980490e-01 s
208.6s 1548 Correction factor: 1.6x
208.6s 1549 Max wave speed detected: 16.78 m/s
208.8s 1550 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
209.3s 1551 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
209.5s 1552 [WARNING] Automatic CFL correction applied (count: 8500):
209.5s 1553 Calculated CFL: 0.800 > Limit: 0.500
209.5s 1554 Original dt: 4.123385e-01 s
209.5s 1555 Corrected dt: 2.577116e-01 s
209.5s 1556 Correction factor: 1.6x
209.5s 1557 Max wave speed detected: 19.40 m/s
209.7s 1558 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
210.2s 1559 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
210.5s 1560 [WARNING] Automatic CFL correction applied (count: 8600):
210.5s 1561 Calculated CFL: 0.800 > Limit: 0.500
210.5s 1562 Original dt: 4.115097e-01 s
210.5s 1563 Corrected dt: 2.571935e-01 s
210.5s 1564 Correction factor: 1.6x
210.5s 1565 Max wave speed detected: 19.44 m/s
210.5s 1566 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
210.5s 1567 Stored output at t = 60.0000 s (Step 231)
210.5s 1568 [A
210.5s 1569 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.00s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.00s/s]
210.5s 1570 
210.5s 1571 Simulation finished at t = 60.0000 s after 231 steps.
210.5s 1572 Total runtime: 2.14 seconds.
210.5s 1573 Running simulation until t = 120.00 s, outputting every 60.00 s
210.5s 1574 
210.7s 1575 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
211.2s 1576 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
211.4s 1577 [WARNING] Automatic CFL correction applied (count: 8700):
211.4s 1578 Calculated CFL: 0.800 > Limit: 0.500
211.4s 1579 Original dt: 4.114983e-01 s
211.4s 1580 Corrected dt: 2.571864e-01 s
211.4s 1581 Correction factor: 1.6x
211.4s 1582 Max wave speed detected: 19.44 m/s
211.6s 1583 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
212.1s 1584 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
212.4s 1585 [WARNING] Automatic CFL correction applied (count: 8800):
212.4s 1586 Calculated CFL: 0.800 > Limit: 0.500
212.4s 1587 Original dt: 4.114980e-01 s
212.4s 1588 Corrected dt: 2.571863e-01 s
212.4s 1589 Correction factor: 1.6x
212.4s 1590 Max wave speed detected: 19.44 m/s
212.6s 1591 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
212.7s 1592 Stored output at t = 120.0000 s (Step 465)
212.7s 1593 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
212.7s 1594 [A
212.7s 1595 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.01s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.01s/s]
212.7s 1596 
212.7s 1597 Simulation finished at t = 120.0000 s after 465 steps.
212.7s 1598 Total runtime: 2.22 seconds.
212.7s 1599 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
212.7s 1600 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
212.7s 1601 Using device: gpu
212.7s 1602 DEBUG PARAMS: Reading K_m_kmh = 10.0
212.7s 1603 DEBUG PARAMS: Reading K_c_kmh = 15.0
212.7s 1604 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
212.7s 1605 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
212.7s 1606 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
212.7s 1607 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
212.7s 1608 Loading road quality type: uniform
212.7s 1609 Uniform road quality value: 2
212.7s 1610 Road quality loaded.
212.7s 1611 Initial state created.
212.7s 1612 Transferring initial state and road quality to GPU...
212.7s 1613 GPU data transfer complete.
212.7s 1614 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
212.7s 1615 Initial boundary conditions applied.
212.7s 1616 [BC UPDATE] left → phase 0 (outflow)
212.7s 1617 └─ Outflow: zero-order extrapolation
212.7s 1618 Running simulation until t = 60.00 s, outputting every 60.00 s
212.7s 1619 
213.2s 1620 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
213.3s 1621 [WARNING] Automatic CFL correction applied (count: 8900):
213.3s 1622 Calculated CFL: 0.800 > Limit: 0.500
213.3s 1623 Original dt: 4.254608e-01 s
213.3s 1624 Corrected dt: 2.659130e-01 s
213.3s 1625 Correction factor: 1.6x
213.3s 1626 Max wave speed detected: 18.80 m/s
213.7s 1627 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
214.1s 1628 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
214.3s 1629 [WARNING] Automatic CFL correction applied (count: 9000):
214.3s 1630 Calculated CFL: 0.800 > Limit: 0.500
214.3s 1631 Original dt: 4.116742e-01 s
214.3s 1632 Corrected dt: 2.572964e-01 s
214.3s 1633 Correction factor: 1.6x
214.3s 1634 Max wave speed detected: 19.43 m/s
214.6s 1635 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
214.9s 1636 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
214.9s 1637 [A
214.9s 1638 Stored output at t = 60.0000 s (Step 231)
214.9s 1639 
214.9s 1640 Simulation finished at t = 60.0000 s after 231 steps.
214.9s 1641 Total runtime: 2.17 seconds.
214.9s 1642 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s]
214.9s 1643 Running simulation until t = 120.00 s, outputting every 60.00 s
214.9s 1644 
215.1s 1645 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
215.2s 1646 [WARNING] Automatic CFL correction applied (count: 9100):
215.2s 1647 Calculated CFL: 0.800 > Limit: 0.500
215.2s 1648 Original dt: 4.115011e-01 s
215.2s 1649 Corrected dt: 2.571882e-01 s
215.2s 1650 Correction factor: 1.6x
215.2s 1651 Max wave speed detected: 19.44 m/s
215.5s 1652 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
216.0s 1653 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
216.1s 1654 [WARNING] Automatic CFL correction applied (count: 9200):
216.1s 1655 Calculated CFL: 0.800 > Limit: 0.500
216.1s 1656 Original dt: 4.114981e-01 s
216.1s 1657 Corrected dt: 2.571863e-01 s
216.1s 1658 Correction factor: 1.6x
216.1s 1659 Max wave speed detected: 19.44 m/s
216.5s 1660 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
216.9s 1661 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
217.1s 1662 [WARNING] Automatic CFL correction applied (count: 9300):
217.1s 1663 Calculated CFL: 0.800 > Limit: 0.500
217.1s 1664 Original dt: 4.114980e-01 s
217.1s 1665 Corrected dt: 2.571863e-01 s
217.1s 1666 Correction factor: 1.6x
217.1s 1667 Max wave speed detected: 19.44 m/s
217.1s 1668 Stored output at t = 120.0000 s (Step 465)
217.1s 1669 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
217.1s 1670 [A
217.1s 1671 
217.1s 1672 Simulation finished at t = 120.0000 s after 465 steps.
217.1s 1673 Total runtime: 2.17 seconds.
217.1s 1674 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.64s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.64s/s]
217.1s 1675 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
217.1s 1676 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
217.1s 1677 Using device: gpu
217.1s 1678 DEBUG PARAMS: Reading K_m_kmh = 10.0
217.1s 1679 DEBUG PARAMS: Reading K_c_kmh = 15.0
217.1s 1680 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
217.1s 1681 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
217.1s 1682 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
217.1s 1683 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
217.1s 1684 Loading road quality type: uniform
217.1s 1685 Uniform road quality value: 2
217.1s 1686 Road quality loaded.
217.1s 1687 Initial state created.
217.1s 1688 Transferring initial state and road quality to GPU...
217.1s 1689 GPU data transfer complete.
217.1s 1690 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
217.1s 1691 Initial boundary conditions applied.
217.1s 1692 [BC UPDATE] left → phase 0 (outflow)
217.1s 1693 └─ Outflow: zero-order extrapolation
217.1s 1694 Running simulation until t = 60.00 s, outputting every 60.00 s
217.1s 1695 
217.6s 1696 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
218.0s 1697 [WARNING] Automatic CFL correction applied (count: 9400):
218.0s 1698 Calculated CFL: 0.800 > Limit: 0.500
218.0s 1699 Original dt: 4.145004e-01 s
218.0s 1700 Corrected dt: 2.590627e-01 s
218.0s 1701 Correction factor: 1.6x
218.0s 1702 Max wave speed detected: 19.30 m/s
218.0s 1703 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
218.5s 1704 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
218.9s 1705 [WARNING] Automatic CFL correction applied (count: 9500):
218.9s 1706 Calculated CFL: 0.800 > Limit: 0.500
218.9s 1707 Original dt: 4.115380e-01 s
218.9s 1708 Corrected dt: 2.572113e-01 s
218.9s 1709 Correction factor: 1.6x
218.9s 1710 Max wave speed detected: 19.44 m/s
219.0s 1711 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
219.3s 1712 Stored output at t = 60.0000 s (Step 231)
219.3s 1713 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
219.3s 1714 [A
219.3s 1715 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.71s/s]
219.3s 1716 
219.3s 1717 Simulation finished at t = 60.0000 s after 231 steps.
219.3s 1718 Total runtime: 2.17 seconds.
219.3s 1719 Running simulation until t = 120.00 s, outputting every 60.00 s
219.3s 1720 
219.4s 1721 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
219.9s 1722 [WARNING] Automatic CFL correction applied (count: 9600):
219.9s 1723 Calculated CFL: 0.800 > Limit: 0.500
219.9s 1724 Original dt: 4.114988e-01 s
219.9s 1725 Corrected dt: 2.571867e-01 s
219.9s 1726 Correction factor: 1.6x
219.9s 1727 Max wave speed detected: 19.44 m/s
219.9s 1728 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
220.4s 1729 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
220.9s 1730 [WARNING] Automatic CFL correction applied (count: 9700):
220.9s 1731 Calculated CFL: 0.800 > Limit: 0.500
220.9s 1732 Original dt: 4.114980e-01 s
220.9s 1733 Corrected dt: 2.571863e-01 s
220.9s 1734 Correction factor: 1.6x
220.9s 1735 Max wave speed detected: 19.44 m/s
220.9s 1736 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
221.4s 1737 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
221.5s 1738 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
221.5s 1739 [A
221.5s 1740 Stored output at t = 120.0000 s (Step 465)
221.5s 1741 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.65s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.65s/s]
221.5s 1742 
221.5s 1743 Simulation finished at t = 120.0000 s after 465 steps.
221.5s 1744 Total runtime: 2.25 seconds.
221.5s 1745 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
221.5s 1746 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
221.5s 1747 Using device: gpu
221.5s 1748 DEBUG PARAMS: Reading K_m_kmh = 10.0
221.5s 1749 DEBUG PARAMS: Reading K_c_kmh = 15.0
221.5s 1750 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
221.5s 1751 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
221.5s 1752 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
221.5s 1753 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
221.5s 1754 Loading road quality type: uniform
221.5s 1755 Uniform road quality value: 2
221.5s 1756 Road quality loaded.
221.5s 1757 Initial state created.
221.5s 1758 Transferring initial state and road quality to GPU...
221.5s 1759 GPU data transfer complete.
221.5s 1760 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
221.5s 1761 Initial boundary conditions applied.
221.5s 1762 [BC UPDATE] left → phase 0 (outflow)
221.5s 1763 └─ Outflow: zero-order extrapolation
221.5s 1764 Running simulation until t = 60.00 s, outputting every 60.00 s
221.5s 1765 
221.8s 1766 [WARNING] Automatic CFL correction applied (count: 9800):
221.8s 1767 Calculated CFL: 0.800 > Limit: 0.500
221.8s 1768 Original dt: 4.758816e-01 s
221.8s 1769 Corrected dt: 2.974260e-01 s
221.8s 1770 Correction factor: 1.6x
221.8s 1771 Max wave speed detected: 16.81 m/s
222.0s 1772 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
222.4s 1773 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
222.8s 1774 [WARNING] Automatic CFL correction applied (count: 9900):
222.8s 1775 Calculated CFL: 0.800 > Limit: 0.500
222.8s 1776 Original dt: 4.121510e-01 s
222.8s 1777 Corrected dt: 2.575944e-01 s
222.8s 1778 Correction factor: 1.6x
222.8s 1779 Max wave speed detected: 19.41 m/s
222.9s 1780 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
223.4s 1781 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
223.6s 1782 Stored output at t = 60.0000 s (Step 231)
223.6s 1783 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
223.6s 1784 [A
223.6s 1785 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.24s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.24s/s]
223.6s 1786 
223.6s 1787 Simulation finished at t = 60.0000 s after 231 steps.
223.6s 1788 Total runtime: 2.13 seconds.
223.7s 1789 Running simulation until t = 120.00 s, outputting every 60.00 s
223.7s 1790 
223.7s 1791 [WARNING] Automatic CFL correction applied (count: 10000):
223.7s 1792 Calculated CFL: 0.800 > Limit: 0.500
223.7s 1793 Original dt: 4.115082e-01 s
223.7s 1794 Corrected dt: 2.571926e-01 s
223.7s 1795 Correction factor: 1.6x
223.7s 1796 Max wave speed detected: 19.44 m/s
223.8s 1797 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
224.3s 1798 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
224.6s 1799 [WARNING] Automatic CFL correction applied (count: 10100):
224.6s 1800 Calculated CFL: 0.800 > Limit: 0.500
224.6s 1801 Original dt: 4.114982e-01 s
224.6s 1802 Corrected dt: 2.571864e-01 s
224.6s 1803 Correction factor: 1.6x
224.6s 1804 Max wave speed detected: 19.44 m/s
224.8s 1805 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
225.3s 1806 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
225.6s 1807 [WARNING] Automatic CFL correction applied (count: 10200):
225.6s 1808 Calculated CFL: 0.800 > Limit: 0.500
225.6s 1809 Original dt: 4.114980e-01 s
225.6s 1810 Corrected dt: 2.571863e-01 s
225.6s 1811 Correction factor: 1.6x
225.6s 1812 Max wave speed detected: 19.44 m/s
225.7s 1813 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
225.9s 1814 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
225.9s 1815 [A
225.9s 1816 Stored output at t = 120.0000 s (Step 465)
225.9s 1817 
225.9s 1818 Simulation finished at t = 120.0000 s after 465 steps.
225.9s 1819 Total runtime: 2.23 seconds.
225.9s 1820 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.89s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.88s/s]
225.9s 1821 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
225.9s 1822 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
225.9s 1823 Using device: gpu
225.9s 1824 DEBUG PARAMS: Reading K_m_kmh = 10.0
225.9s 1825 DEBUG PARAMS: Reading K_c_kmh = 15.0
225.9s 1826 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
225.9s 1827 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
225.9s 1828 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
225.9s 1829 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
225.9s 1830 Loading road quality type: uniform
225.9s 1831 Uniform road quality value: 2
225.9s 1832 Road quality loaded.
225.9s 1833 Initial state created.
225.9s 1834 Transferring initial state and road quality to GPU...
225.9s 1835 GPU data transfer complete.
225.9s 1836 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
225.9s 1837 Initial boundary conditions applied.
225.9s 1838 [BC UPDATE] left → phase 0 (outflow)
225.9s 1839 └─ Outflow: zero-order extrapolation
225.9s 1840 Running simulation until t = 60.00 s, outputting every 60.00 s
225.9s 1841 
226.4s 1842 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
226.5s 1843 [WARNING] Automatic CFL correction applied (count: 10300):
226.5s 1844 Calculated CFL: 0.800 > Limit: 0.500
226.5s 1845 Original dt: 4.225636e-01 s
226.5s 1846 Corrected dt: 2.641023e-01 s
226.5s 1847 Correction factor: 1.6x
226.5s 1848 Max wave speed detected: 18.93 m/s
226.8s 1849 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
227.3s 1850 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
227.5s 1851 [WARNING] Automatic CFL correction applied (count: 10400):
227.5s 1852 Calculated CFL: 0.800 > Limit: 0.500
227.5s 1853 Original dt: 4.116395e-01 s
227.5s 1854 Corrected dt: 2.572747e-01 s
227.5s 1855 Correction factor: 1.6x
227.5s 1856 Max wave speed detected: 19.43 m/s
227.7s 1857 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
228.0s 1858 Stored output at t = 60.0000 s (Step 231)
228.0s 1859 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
228.0s 1860 [A
228.0s 1861 
228.0s 1862 Simulation finished at t = 60.0000 s after 231 steps.
228.0s 1863 Total runtime: 2.13 seconds.
228.0s 1864 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.18s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.18s/s]
228.0s 1865 Running simulation until t = 120.00 s, outputting every 60.00 s
228.0s 1866 
228.2s 1867 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
228.4s 1868 [WARNING] Automatic CFL correction applied (count: 10500):
228.4s 1869 Calculated CFL: 0.800 > Limit: 0.500
228.4s 1870 Original dt: 4.115005e-01 s
228.4s 1871 Corrected dt: 2.571878e-01 s
228.4s 1872 Correction factor: 1.6x
228.4s 1873 Max wave speed detected: 19.44 m/s
228.7s 1874 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
229.1s 1875 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
229.3s 1876 [WARNING] Automatic CFL correction applied (count: 10600):
229.3s 1877 Calculated CFL: 0.800 > Limit: 0.500
229.3s 1878 Original dt: 4.114981e-01 s
229.3s 1879 Corrected dt: 2.571863e-01 s
229.3s 1880 Correction factor: 1.6x
229.3s 1881 Max wave speed detected: 19.44 m/s
229.6s 1882 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
230.1s 1883 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
230.2s 1884 Stored output at t = 120.0000 s (Step 465)
230.2s 1885 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
230.2s 1886 [A
230.2s 1887 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.49s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.48s/s]
230.2s 1888 
230.2s 1889 Simulation finished at t = 120.0000 s after 465 steps.
230.2s 1890 Total runtime: 2.18 seconds.
230.2s 1891 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
230.2s 1892 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
230.2s 1893 Using device: gpu
230.2s 1894 DEBUG PARAMS: Reading K_m_kmh = 10.0
230.2s 1895 DEBUG PARAMS: Reading K_c_kmh = 15.0
230.2s 1896 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
230.2s 1897 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
230.2s 1898 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
230.2s 1899 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
230.2s 1900 Loading road quality type: uniform
230.2s 1901 Uniform road quality value: 2
230.2s 1902 Road quality loaded.
230.2s 1903 Initial state created.
230.2s 1904 Transferring initial state and road quality to GPU...
230.2s 1905 GPU data transfer complete.
230.2s 1906 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
230.2s 1907 Initial boundary conditions applied.
230.2s 1908 [BC UPDATE] left → phase 0 (outflow)
230.2s 1909 └─ Outflow: zero-order extrapolation
230.2s 1910 Running simulation until t = 60.00 s, outputting every 60.00 s
230.2s 1911 
230.3s 1912 [WARNING] Automatic CFL correction applied (count: 10700):
230.3s 1913 Calculated CFL: 0.800 > Limit: 0.500
230.3s 1914 Original dt: 3.451280e-01 s
230.3s 1915 Corrected dt: 2.157050e-01 s
230.3s 1916 Correction factor: 1.6x
230.3s 1917 Max wave speed detected: 23.18 m/s
230.7s 1918 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
231.2s 1919 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
231.2s 1920 [WARNING] Automatic CFL correction applied (count: 10800):
231.2s 1921 Calculated CFL: 0.800 > Limit: 0.500
231.2s 1922 Original dt: 4.139892e-01 s
231.2s 1923 Corrected dt: 2.587433e-01 s
231.2s 1924 Correction factor: 1.6x
231.2s 1925 Max wave speed detected: 19.32 m/s
231.7s 1926 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
232.1s 1927 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
232.2s 1928 [WARNING] Automatic CFL correction applied (count: 10900):
232.2s 1929 Calculated CFL: 0.800 > Limit: 0.500
232.2s 1930 Original dt: 4.115314e-01 s
232.2s 1931 Corrected dt: 2.572071e-01 s
232.2s 1932 Correction factor: 1.6x
232.2s 1933 Max wave speed detected: 19.44 m/s
232.4s 1934 Stored output at t = 60.0000 s (Step 231)
232.4s 1935 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
232.4s 1936 [A
232.4s 1937 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s]
232.4s 1938 
232.4s 1939 Simulation finished at t = 60.0000 s after 231 steps.
232.4s 1940 Total runtime: 2.16 seconds.
232.4s 1941 Running simulation until t = 120.00 s, outputting every 60.00 s
232.4s 1942 
232.6s 1943 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
233.0s 1944 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
233.1s 1945 [WARNING] Automatic CFL correction applied (count: 11000):
233.1s 1946 Calculated CFL: 0.800 > Limit: 0.500
233.1s 1947 Original dt: 4.114986e-01 s
233.1s 1948 Corrected dt: 2.571866e-01 s
233.1s 1949 Correction factor: 1.6x
233.1s 1950 Max wave speed detected: 19.44 m/s
233.5s 1951 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
233.9s 1952 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
234.0s 1953 [WARNING] Automatic CFL correction applied (count: 11100):
234.0s 1954 Calculated CFL: 0.800 > Limit: 0.500
234.0s 1955 Original dt: 4.114980e-01 s
234.0s 1956 Corrected dt: 2.571863e-01 s
234.0s 1957 Correction factor: 1.6x
234.0s 1958 Max wave speed detected: 19.44 m/s
234.4s 1959 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
234.5s 1960 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
234.5s 1961 [A
234.5s 1962 Stored output at t = 120.0000 s (Step 465)
234.5s 1963 
234.5s 1964 Simulation finished at t = 120.0000 s after 465 steps.
234.5s 1965 Total runtime: 2.14 seconds.
234.5s 1966 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
234.5s 1967 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
234.5s 1968 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
234.5s 1969 Using device: gpu
234.5s 1970 DEBUG PARAMS: Reading K_m_kmh = 10.0
234.5s 1971 DEBUG PARAMS: Reading K_c_kmh = 15.0
234.5s 1972 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
234.5s 1973 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
234.5s 1974 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
234.5s 1975 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
234.5s 1976 Loading road quality type: uniform
234.5s 1977 Uniform road quality value: 2
234.5s 1978 Road quality loaded.
234.5s 1979 Initial state created.
234.5s 1980 Transferring initial state and road quality to GPU...
234.5s 1981 GPU data transfer complete.
234.5s 1982 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
234.5s 1983 Initial boundary conditions applied.
234.5s 1984 [BC UPDATE] left → phase 0 (outflow)
234.5s 1985 └─ Outflow: zero-order extrapolation
234.6s 1986 [BC UPDATE] left → phase 1 (inflow)
234.6s 1987 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
234.6s 1988 Running simulation until t = 60.00 s, outputting every 60.00 s
234.6s 1989 
234.9s 1990 [WARNING] Automatic CFL correction applied (count: 11200):
234.9s 1991 Calculated CFL: 0.800 > Limit: 0.500
234.9s 1992 Original dt: 4.583403e-01 s
234.9s 1993 Corrected dt: 2.864627e-01 s
234.9s 1994 Correction factor: 1.6x
234.9s 1995 Max wave speed detected: 17.45 m/s
235.0s 1996 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
235.5s 1997 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
235.9s 1998 [WARNING] Automatic CFL correction applied (count: 11300):
235.9s 1999 Calculated CFL: 0.800 > Limit: 0.500
235.9s 2000 Original dt: 4.120137e-01 s
235.9s 2001 Corrected dt: 2.575085e-01 s
235.9s 2002 Correction factor: 1.6x
235.9s 2003 Max wave speed detected: 19.42 m/s
236.0s 2004 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
236.4s 2005 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
236.8s 2006 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
236.8s 2007 [A
236.8s 2008 Stored output at t = 60.0000 s (Step 231)
236.8s 2009 
236.8s 2010 Simulation finished at t = 60.0000 s after 231 steps.
236.8s 2011 Total runtime: 2.20 seconds.
236.8s 2012 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.24s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.24s/s]
236.8s 2013 [BC UPDATE] left → phase 0 (outflow)
236.8s 2014 └─ Outflow: zero-order extrapolation
236.8s 2015 Running simulation until t = 120.00 s, outputting every 60.00 s
236.8s 2016 
236.8s 2017 [WARNING] Automatic CFL correction applied (count: 11400):
236.8s 2018 Calculated CFL: 0.800 > Limit: 0.500
236.8s 2019 Original dt: 4.115064e-01 s
236.8s 2020 Corrected dt: 2.571915e-01 s
236.8s 2021 Correction factor: 1.6x
236.8s 2022 Max wave speed detected: 19.44 m/s
236.9s 2023 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
237.4s 2024 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
237.8s 2025 [WARNING] Automatic CFL correction applied (count: 11500):
237.8s 2026 Calculated CFL: 0.800 > Limit: 0.500
237.8s 2027 Original dt: 4.114982e-01 s
237.8s 2028 Corrected dt: 2.571864e-01 s
237.8s 2029 Correction factor: 1.6x
237.8s 2030 Max wave speed detected: 19.44 m/s
237.9s 2031 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
238.3s 2032 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
238.7s 2033 [WARNING] Automatic CFL correction applied (count: 11600):
238.7s 2034 Calculated CFL: 0.800 > Limit: 0.500
238.7s 2035 Original dt: 4.114980e-01 s
238.7s 2036 Corrected dt: 2.571863e-01 s
238.7s 2037 Correction factor: 1.6x
238.7s 2038 Max wave speed detected: 19.44 m/s
238.8s 2039 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
238.9s 2040 Stored output at t = 120.0000 s (Step 465)
238.9s 2041 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
238.9s 2042 [A
238.9s 2043 
238.9s 2044 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s]
238.9s 2045 Simulation finished at t = 120.0000 s after 465 steps.
238.9s 2046 Total runtime: 2.17 seconds.
238.9s 2047 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
238.9s 2048 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
238.9s 2049 Using device: gpu
238.9s 2050 DEBUG PARAMS: Reading K_m_kmh = 10.0
238.9s 2051 DEBUG PARAMS: Reading K_c_kmh = 15.0
238.9s 2052 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
238.9s 2053 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
238.9s 2054 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
238.9s 2055 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
238.9s 2056 Loading road quality type: uniform
238.9s 2057 Uniform road quality value: 2
238.9s 2058 Road quality loaded.
238.9s 2059 Initial state created.
238.9s 2060 Transferring initial state and road quality to GPU...
238.9s 2061 GPU data transfer complete.
238.9s 2062 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
238.9s 2063 Initial boundary conditions applied.
238.9s 2064 [BC UPDATE] left → phase 0 (outflow)
238.9s 2065 └─ Outflow: zero-order extrapolation
238.9s 2066 📊 Progress: 50/100 (50.0%) | ETA: 1.9 min | Speed: 0.4 steps/s
239.0s 2067 [BC UPDATE] left → phase 1 (inflow)
239.0s 2068 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
239.0s 2069 Running simulation until t = 60.00 s, outputting every 60.00 s
239.0s 2070 
239.4s 2071 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
239.6s 2072 [WARNING] Automatic CFL correction applied (count: 11700):
239.6s 2073 Calculated CFL: 0.800 > Limit: 0.500
239.6s 2074 Original dt: 4.205139e-01 s
239.6s 2075 Corrected dt: 2.628212e-01 s
239.6s 2076 Correction factor: 1.6x
239.6s 2077 Max wave speed detected: 19.02 m/s
239.9s 2078 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
240.3s 2079 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
240.5s 2080 [WARNING] Automatic CFL correction applied (count: 11800):
240.5s 2081 Calculated CFL: 0.800 > Limit: 0.500
240.5s 2082 Original dt: 4.116141e-01 s
240.5s 2083 Corrected dt: 2.572588e-01 s
240.5s 2084 Correction factor: 1.6x
240.5s 2085 Max wave speed detected: 19.44 m/s
240.8s 2086 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
241.1s 2087 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
241.1s 2088 [A
241.1s 2089 Stored output at t = 60.0000 s (Step 231)
241.1s 2090 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.69s/s]
241.1s 2091 
241.1s 2092 Simulation finished at t = 60.0000 s after 231 steps.
241.1s 2093 Total runtime: 2.17 seconds.
241.1s 2094 
241.1s 2095 Running simulation until t = 120.00 s, outputting every 60.00 s
241.3s 2096 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
241.5s 2097 [WARNING] Automatic CFL correction applied (count: 11900):
241.5s 2098 Calculated CFL: 0.800 > Limit: 0.500
241.5s 2099 Original dt: 4.115000e-01 s
241.5s 2100 Corrected dt: 2.571875e-01 s
241.5s 2101 Correction factor: 1.6x
241.5s 2102 Max wave speed detected: 19.44 m/s
241.8s 2103 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
242.2s 2104 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
242.5s 2105 [WARNING] Automatic CFL correction applied (count: 12000):
242.5s 2106 Calculated CFL: 0.800 > Limit: 0.500
242.5s 2107 Original dt: 4.114981e-01 s
242.5s 2108 Corrected dt: 2.571863e-01 s
242.5s 2109 Correction factor: 1.6x
242.5s 2110 Max wave speed detected: 19.44 m/s
242.7s 2111 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
243.2s 2112 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
243.3s 2113 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
243.3s 2114 [A
243.3s 2115 Stored output at t = 120.0000 s (Step 465)
243.3s 2116 
243.3s 2117 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.49s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.49s/s]
243.3s 2118 Simulation finished at t = 120.0000 s after 465 steps.
243.3s 2119 Total runtime: 2.18 seconds.
243.3s 2120 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
243.3s 2121 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
243.3s 2122 Using device: gpu
243.3s 2123 DEBUG PARAMS: Reading K_m_kmh = 10.0
243.3s 2124 DEBUG PARAMS: Reading K_c_kmh = 15.0
243.3s 2125 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
243.3s 2126 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
243.3s 2127 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
243.3s 2128 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
243.3s 2129 Loading road quality type: uniform
243.3s 2130 Uniform road quality value: 2
243.3s 2131 Road quality loaded.
243.3s 2132 Initial state created.
243.3s 2133 Transferring initial state and road quality to GPU...
243.3s 2134 GPU data transfer complete.
243.3s 2135 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
243.3s 2136 Initial boundary conditions applied.
243.3s 2137 [BC UPDATE] left → phase 0 (outflow)
243.3s 2138 └─ Outflow: zero-order extrapolation
243.3s 2139 Running simulation until t = 60.00 s, outputting every 60.00 s
243.3s 2140 
243.4s 2141 [WARNING] Automatic CFL correction applied (count: 12100):
243.4s 2142 Calculated CFL: 0.800 > Limit: 0.500
243.4s 2143 Original dt: 3.737254e-01 s
243.4s 2144 Corrected dt: 2.335784e-01 s
243.4s 2145 Correction factor: 1.6x
243.4s 2146 Max wave speed detected: 21.41 m/s
243.8s 2147 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
244.3s 2148 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
244.4s 2149 [WARNING] Automatic CFL correction applied (count: 12200):
244.4s 2150 Calculated CFL: 0.800 > Limit: 0.500
244.4s 2151 Original dt: 4.134305e-01 s
244.4s 2152 Corrected dt: 2.583941e-01 s
244.4s 2153 Correction factor: 1.6x
244.4s 2154 Max wave speed detected: 19.35 m/s
244.7s 2155 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
245.2s 2156 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
245.3s 2157 [WARNING] Automatic CFL correction applied (count: 12300):
245.3s 2158 Calculated CFL: 0.800 > Limit: 0.500
245.3s 2159 Original dt: 4.115259e-01 s
245.3s 2160 Corrected dt: 2.572037e-01 s
245.3s 2161 Correction factor: 1.6x
245.3s 2162 Max wave speed detected: 19.44 m/s
245.5s 2163 Stored output at t = 60.0000 s (Step 231)
245.5s 2164 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
245.5s 2165 [A
245.5s 2166 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s]
245.5s 2167 
245.5s 2168 Simulation finished at t = 60.0000 s after 231 steps.
245.5s 2169 Total runtime: 2.17 seconds.
245.5s 2170 [BC UPDATE] left → phase 1 (inflow)
245.5s 2171 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
245.5s 2172 Running simulation until t = 120.00 s, outputting every 60.00 s
245.5s 2173 
245.7s 2174 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
246.1s 2175 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
246.2s 2176 [WARNING] Automatic CFL correction applied (count: 12400):
246.2s 2177 Calculated CFL: 0.800 > Limit: 0.500
246.2s 2178 Original dt: 4.114985e-01 s
246.2s 2179 Corrected dt: 2.571866e-01 s
246.2s 2180 Correction factor: 1.6x
246.2s 2181 Max wave speed detected: 19.44 m/s
246.6s 2182 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
247.0s 2183 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
247.1s 2184 [WARNING] Automatic CFL correction applied (count: 12500):
247.1s 2185 Calculated CFL: 0.800 > Limit: 0.500
247.1s 2186 Original dt: 4.114980e-01 s
247.1s 2187 Corrected dt: 2.571863e-01 s
247.1s 2188 Correction factor: 1.6x
247.1s 2189 Max wave speed detected: 19.44 m/s
247.5s 2190 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
247.6s 2191 Stored output at t = 120.0000 s (Step 465)
247.6s 2192 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
247.6s 2193 [A
247.6s 2194 
247.6s 2195 Simulation finished at t = 120.0000 s after 465 steps.
247.6s 2196 Total runtime: 2.16 seconds.
247.6s 2197 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.85s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.84s/s]
247.6s 2198 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
247.6s 2199 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
247.6s 2200 Using device: gpu
247.7s 2201 DEBUG PARAMS: Reading K_m_kmh = 10.0
247.7s 2202 DEBUG PARAMS: Reading K_c_kmh = 15.0
247.7s 2203 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
247.7s 2204 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
247.7s 2205 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
247.7s 2206 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
247.7s 2207 Loading road quality type: uniform
247.7s 2208 Uniform road quality value: 2
247.7s 2209 Road quality loaded.
247.7s 2210 Initial state created.
247.7s 2211 Transferring initial state and road quality to GPU...
247.7s 2212 GPU data transfer complete.
247.7s 2213 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
247.7s 2214 Initial boundary conditions applied.
247.7s 2215 [BC UPDATE] left → phase 0 (outflow)
247.7s 2216 └─ Outflow: zero-order extrapolation
247.7s 2217 [BC UPDATE] left → phase 1 (inflow)
247.7s 2218 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
247.7s 2219 Running simulation until t = 60.00 s, outputting every 60.00 s
247.7s 2220 
248.1s 2221 [WARNING] Automatic CFL correction applied (count: 12600):
248.1s 2222 Calculated CFL: 0.800 > Limit: 0.500
248.1s 2223 Original dt: 4.470525e-01 s
248.1s 2224 Corrected dt: 2.794078e-01 s
248.1s 2225 Correction factor: 1.6x
248.1s 2226 Max wave speed detected: 17.89 m/s
248.1s 2227 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
248.6s 2228 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
249.0s 2229 [WARNING] Automatic CFL correction applied (count: 12700):
249.0s 2230 Calculated CFL: 0.800 > Limit: 0.500
249.0s 2231 Original dt: 4.119130e-01 s
249.0s 2232 Corrected dt: 2.574456e-01 s
249.0s 2233 Correction factor: 1.6x
249.0s 2234 Max wave speed detected: 19.42 m/s
249.0s 2235 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
249.5s 2236 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
249.8s 2237 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
249.8s 2238 [A
249.8s 2239 Stored output at t = 60.0000 s (Step 231)
249.8s 2240 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.11s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.11s/s]
249.8s 2241 
249.8s 2242 Simulation finished at t = 60.0000 s after 231 steps.
249.8s 2243 Total runtime: 2.13 seconds.
249.8s 2244 Running simulation until t = 120.00 s, outputting every 60.00 s
249.8s 2245 
249.9s 2246 [WARNING] Automatic CFL correction applied (count: 12800):
249.9s 2247 Calculated CFL: 0.800 > Limit: 0.500
249.9s 2248 Original dt: 4.115046e-01 s
249.9s 2249 Corrected dt: 2.571904e-01 s
249.9s 2250 Correction factor: 1.6x
249.9s 2251 Max wave speed detected: 19.44 m/s
250.0s 2252 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
250.4s 2253 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
250.9s 2254 [WARNING] Automatic CFL correction applied (count: 12900):
250.9s 2255 Calculated CFL: 0.800 > Limit: 0.500
250.9s 2256 Original dt: 4.114982e-01 s
250.9s 2257 Corrected dt: 2.571863e-01 s
250.9s 2258 Correction factor: 1.6x
250.9s 2259 Max wave speed detected: 19.44 m/s
250.9s 2260 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
251.4s 2261 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
251.8s 2262 [WARNING] Automatic CFL correction applied (count: 13000):
251.8s 2263 Calculated CFL: 0.800 > Limit: 0.500
251.8s 2264 Original dt: 4.114980e-01 s
251.8s 2265 Corrected dt: 2.571863e-01 s
251.8s 2266 Correction factor: 1.6x
251.8s 2267 Max wave speed detected: 19.44 m/s
251.9s 2268 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
252.0s 2269 Stored output at t = 120.0000 s (Step 465)
252.0s 2270 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
252.0s 2271 [A
252.0s 2272 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.29s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.29s/s]
252.0s 2273 
252.0s 2274 Simulation finished at t = 120.0000 s after 465 steps.
252.0s 2275 Total runtime: 2.20 seconds.
252.0s 2276 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
252.0s 2277 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
252.0s 2278 Using device: gpu
252.0s 2279 DEBUG PARAMS: Reading K_m_kmh = 10.0
252.0s 2280 DEBUG PARAMS: Reading K_c_kmh = 15.0
252.0s 2281 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
252.0s 2282 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
252.0s 2283 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
252.0s 2284 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
252.0s 2285 Loading road quality type: uniform
252.0s 2286 Uniform road quality value: 2
252.0s 2287 Road quality loaded.
252.0s 2288 Initial state created.
252.0s 2289 Transferring initial state and road quality to GPU...
252.0s 2290 GPU data transfer complete.
252.0s 2291 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
252.0s 2292 Initial boundary conditions applied.
252.0s 2293 [BC UPDATE] left → phase 0 (outflow)
252.0s 2294 └─ Outflow: zero-order extrapolation
252.0s 2295 [BC UPDATE] left → phase 1 (inflow)
252.0s 2296 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
252.0s 2297 Running simulation until t = 60.00 s, outputting every 60.00 s
252.0s 2298 
252.5s 2299 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
252.7s 2300 [WARNING] Automatic CFL correction applied (count: 13100):
252.7s 2301 Calculated CFL: 0.800 > Limit: 0.500
252.7s 2302 Original dt: 4.190346e-01 s
252.7s 2303 Corrected dt: 2.618967e-01 s
252.7s 2304 Correction factor: 1.6x
252.7s 2305 Max wave speed detected: 19.09 m/s
252.9s 2306 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
253.4s 2307 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
253.6s 2308 [WARNING] Automatic CFL correction applied (count: 13200):
253.6s 2309 Calculated CFL: 0.800 > Limit: 0.500
253.6s 2310 Original dt: 4.115954e-01 s
253.6s 2311 Corrected dt: 2.572472e-01 s
253.6s 2312 Correction factor: 1.6x
253.6s 2313 Max wave speed detected: 19.44 m/s
253.8s 2314 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
254.1s 2315 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
254.1s 2316 [A
254.1s 2317 Stored output at t = 60.0000 s (Step 231)
254.1s 2318 
254.1s 2319 Simulation finished at t = 60.0000 s after 231 steps.
254.1s 2320 Total runtime: 2.12 seconds.
254.1s 2321 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.32s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.32s/s]
254.1s 2322 [BC UPDATE] left → phase 0 (outflow)
254.1s 2323 └─ Outflow: zero-order extrapolation
254.1s 2324 Running simulation until t = 120.00 s, outputting every 60.00 s
254.1s 2325 
254.3s 2326 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
254.6s 2327 [WARNING] Automatic CFL correction applied (count: 13300):
254.6s 2328 Calculated CFL: 0.800 > Limit: 0.500
254.6s 2329 Original dt: 4.114996e-01 s
254.6s 2330 Corrected dt: 2.571873e-01 s
254.6s 2331 Correction factor: 1.6x
254.6s 2332 Max wave speed detected: 19.44 m/s
254.8s 2333 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
255.2s 2334 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
255.5s 2335 [WARNING] Automatic CFL correction applied (count: 13400):
255.5s 2336 Calculated CFL: 0.800 > Limit: 0.500
255.5s 2337 Original dt: 4.114981e-01 s
255.5s 2338 Corrected dt: 2.571863e-01 s
255.5s 2339 Correction factor: 1.6x
255.5s 2340 Max wave speed detected: 19.44 m/s
255.7s 2341 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
256.2s 2342 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
256.3s 2343 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
256.3s 2344 [A
256.3s 2345 Stored output at t = 120.0000 s (Step 465)
256.3s 2346 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s]
256.3s 2347 
256.3s 2348 Simulation finished at t = 120.0000 s after 465 steps.
256.3s 2349 Total runtime: 2.18 seconds.
256.3s 2350 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
256.3s 2351 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
256.3s 2352 Using device: gpu
256.3s 2353 DEBUG PARAMS: Reading K_m_kmh = 10.0
256.3s 2354 DEBUG PARAMS: Reading K_c_kmh = 15.0
256.3s 2355 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
256.3s 2356 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
256.3s 2357 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
256.3s 2358 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
256.3s 2359 Loading road quality type: uniform
256.3s 2360 Uniform road quality value: 2
256.3s 2361 Road quality loaded.
256.3s 2362 Initial state created.
256.3s 2363 Transferring initial state and road quality to GPU...
256.3s 2364 GPU data transfer complete.
256.3s 2365 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
256.3s 2366 Initial boundary conditions applied.
256.3s 2367 [BC UPDATE] left → phase 0 (outflow)
256.3s 2368 └─ Outflow: zero-order extrapolation
256.3s 2369 [BC UPDATE] left → phase 1 (inflow)
256.3s 2370 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
256.3s 2371 Running simulation until t = 60.00 s, outputting every 60.00 s
256.3s 2372 
256.5s 2373 [WARNING] Automatic CFL correction applied (count: 13500):
256.5s 2374 Calculated CFL: 0.800 > Limit: 0.500
256.5s 2375 Original dt: 4.022422e-01 s
256.5s 2376 Corrected dt: 2.514014e-01 s
256.5s 2377 Correction factor: 1.6x
256.5s 2378 Max wave speed detected: 19.89 m/s
256.8s 2379 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
257.3s 2380 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
257.5s 2381 [WARNING] Automatic CFL correction applied (count: 13600):
257.5s 2382 Calculated CFL: 0.800 > Limit: 0.500
257.5s 2383 Original dt: 4.130229e-01 s
257.5s 2384 Corrected dt: 2.581393e-01 s
257.5s 2385 Correction factor: 1.6x
257.5s 2386 Max wave speed detected: 19.37 m/s
257.8s 2387 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
258.3s 2388 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
258.4s 2389 [WARNING] Automatic CFL correction applied (count: 13700):
258.4s 2390 Calculated CFL: 0.800 > Limit: 0.500
258.4s 2391 Original dt: 4.115198e-01 s
258.4s 2392 Corrected dt: 2.571999e-01 s
258.4s 2393 Correction factor: 1.6x
258.4s 2394 Max wave speed detected: 19.44 m/s
258.5s 2395 Stored output at t = 60.0000 s (Step 231)
258.5s 2396 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
258.5s 2397 [A
258.5s 2398 
258.5s 2399 Simulation finished at t = 60.0000 s after 231 steps.
258.5s 2400 Total runtime: 2.22 seconds.
258.5s 2401 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.04s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.04s/s]
258.6s 2402 [BC UPDATE] left → phase 0 (outflow)
258.6s 2403 └─ Outflow: zero-order extrapolation
258.6s 2404 Running simulation until t = 120.00 s, outputting every 60.00 s
258.6s 2405 
258.7s 2406 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
259.2s 2407 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
259.3s 2408 [WARNING] Automatic CFL correction applied (count: 13800):
259.3s 2409 Calculated CFL: 0.800 > Limit: 0.500
259.3s 2410 Original dt: 4.114984e-01 s
259.3s 2411 Corrected dt: 2.571865e-01 s
259.3s 2412 Correction factor: 1.6x
259.3s 2413 Max wave speed detected: 19.44 m/s
259.7s 2414 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
260.1s 2415 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
260.3s 2416 [WARNING] Automatic CFL correction applied (count: 13900):
260.3s 2417 Calculated CFL: 0.800 > Limit: 0.500
260.3s 2418 Original dt: 4.114980e-01 s
260.3s 2419 Corrected dt: 2.571863e-01 s
260.3s 2420 Correction factor: 1.6x
260.3s 2421 Max wave speed detected: 19.44 m/s
260.6s 2422 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
260.8s 2423 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
260.8s 2424 Stored output at t = 120.0000 s (Step 465)
260.8s 2425 [A
260.8s 2426 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.08s/s]
260.8s 2427 
260.8s 2428 Simulation finished at t = 120.0000 s after 465 steps.
260.8s 2429 Total runtime: 2.22 seconds.
260.8s 2430 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
260.8s 2431 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
260.8s 2432 Using device: gpu
260.8s 2433 DEBUG PARAMS: Reading K_m_kmh = 10.0
260.8s 2434 DEBUG PARAMS: Reading K_c_kmh = 15.0
260.8s 2435 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
260.8s 2436 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
260.8s 2437 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
260.8s 2438 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
260.8s 2439 Loading road quality type: uniform
260.8s 2440 Uniform road quality value: 2
260.8s 2441 Road quality loaded.
260.8s 2442 Initial state created.
260.8s 2443 Transferring initial state and road quality to GPU...
260.8s 2444 GPU data transfer complete.
260.8s 2445 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
260.8s 2446 Initial boundary conditions applied.
260.8s 2447 [BC UPDATE] left → phase 0 (outflow)
260.8s 2448 └─ Outflow: zero-order extrapolation
260.8s 2449 Running simulation until t = 60.00 s, outputting every 60.00 s
260.8s 2450 
261.3s 2451 [WARNING] Automatic CFL correction applied (count: 14000):
261.3s 2452 Calculated CFL: 0.800 > Limit: 0.500
261.3s 2453 Original dt: 4.396418e-01 s
261.3s 2454 Corrected dt: 2.747761e-01 s
261.3s 2455 Correction factor: 1.6x
261.3s 2456 Max wave speed detected: 18.20 m/s
261.3s 2457 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
261.8s 2458 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
262.2s 2459 [WARNING] Automatic CFL correction applied (count: 14100):
262.2s 2460 Calculated CFL: 0.800 > Limit: 0.500
262.2s 2461 Original dt: 4.118393e-01 s
262.2s 2462 Corrected dt: 2.573996e-01 s
262.2s 2463 Correction factor: 1.6x
262.2s 2464 Max wave speed detected: 19.43 m/s
262.2s 2465 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
262.7s 2466 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
263.0s 2467 Stored output at t = 60.0000 s (Step 231)
263.0s 2468 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
263.0s 2469 [A
263.0s 2470 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.11s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.10s/s]
263.0s 2471 
263.0s 2472 Simulation finished at t = 60.0000 s after 231 steps.
263.0s 2473 Total runtime: 2.21 seconds.
263.0s 2474 
263.0s 2475 Running simulation until t = 120.00 s, outputting every 60.00 s
263.2s 2476 [WARNING] Automatic CFL correction applied (count: 14200):
263.2s 2477 Calculated CFL: 0.800 > Limit: 0.500
263.2s 2478 Original dt: 4.115033e-01 s
263.2s 2479 Corrected dt: 2.571896e-01 s
263.2s 2480 Correction factor: 1.6x
263.2s 2481 Max wave speed detected: 19.44 m/s
263.2s 2482 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
263.6s 2483 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
264.1s 2484 [WARNING] Automatic CFL correction applied (count: 14300):
264.1s 2485 Calculated CFL: 0.800 > Limit: 0.500
264.1s 2486 Original dt: 4.114981e-01 s
264.1s 2487 Corrected dt: 2.571863e-01 s
264.1s 2488 Correction factor: 1.6x
264.1s 2489 Max wave speed detected: 19.44 m/s
264.1s 2490 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
264.6s 2491 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
265.0s 2492 [WARNING] Automatic CFL correction applied (count: 14400):
265.0s 2493 Calculated CFL: 0.800 > Limit: 0.500
265.0s 2494 Original dt: 4.114980e-01 s
265.0s 2495 Corrected dt: 2.571863e-01 s
265.0s 2496 Correction factor: 1.6x
265.0s 2497 Max wave speed detected: 19.44 m/s
265.0s 2498 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
265.2s 2499 Stored output at t = 120.0000 s (Step 465)
265.2s 2500 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
265.2s 2501 [A
265.2s 2502 
265.2s 2503 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s]
265.2s 2504 Simulation finished at t = 120.0000 s after 465 steps.
265.2s 2505 Total runtime: 2.15 seconds.
265.2s 2506 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
265.2s 2507 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
265.2s 2508 Using device: gpu
265.2s 2509 DEBUG PARAMS: Reading K_m_kmh = 10.0
265.2s 2510 DEBUG PARAMS: Reading K_c_kmh = 15.0
265.2s 2511 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
265.2s 2512 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
265.2s 2513 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
265.2s 2514 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
265.2s 2515 Loading road quality type: uniform
265.2s 2516 Uniform road quality value: 2
265.2s 2517 Road quality loaded.
265.2s 2518 Initial state created.
265.2s 2519 Transferring initial state and road quality to GPU...
265.2s 2520 GPU data transfer complete.
265.2s 2521 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
265.2s 2522 Initial boundary conditions applied.
265.2s 2523 [BC UPDATE] left → phase 0 (outflow)
265.2s 2524 └─ Outflow: zero-order extrapolation
265.2s 2525 [BC UPDATE] left → phase 1 (inflow)
265.2s 2526 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
265.2s 2527 Running simulation until t = 60.00 s, outputting every 60.00 s
265.2s 2528 
265.6s 2529 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
265.9s 2530 [WARNING] Automatic CFL correction applied (count: 14500):
265.9s 2531 Calculated CFL: 0.800 > Limit: 0.500
265.9s 2532 Original dt: 4.173029e-01 s
265.9s 2533 Corrected dt: 2.608143e-01 s
265.9s 2534 Correction factor: 1.6x
265.9s 2535 Max wave speed detected: 19.17 m/s
266.1s 2536 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
266.5s 2537 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
266.9s 2538 [WARNING] Automatic CFL correction applied (count: 14600):
266.9s 2539 Calculated CFL: 0.800 > Limit: 0.500
266.9s 2540 Original dt: 4.115760e-01 s
266.9s 2541 Corrected dt: 2.572350e-01 s
266.9s 2542 Correction factor: 1.6x
266.9s 2543 Max wave speed detected: 19.44 m/s
267.0s 2544 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
267.3s 2545 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
267.3s 2546 [A
267.3s 2547 Stored output at t = 60.0000 s (Step 231)
267.3s 2548 
267.3s 2549 Simulation finished at t = 60.0000 s after 231 steps.
267.3s 2550 Total runtime: 2.12 seconds.
267.3s 2551 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.28s/s]
267.3s 2552 [BC UPDATE] left → phase 0 (outflow)
267.3s 2553 └─ Outflow: zero-order extrapolation
267.3s 2554 Running simulation until t = 120.00 s, outputting every 60.00 s
267.3s 2555 
267.5s 2556 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
267.8s 2557 [WARNING] Automatic CFL correction applied (count: 14700):
267.8s 2558 Calculated CFL: 0.800 > Limit: 0.500
267.8s 2559 Original dt: 4.114993e-01 s
267.8s 2560 Corrected dt: 2.571871e-01 s
267.8s 2561 Correction factor: 1.6x
267.8s 2562 Max wave speed detected: 19.44 m/s
267.9s 2563 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
268.4s 2564 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
268.7s 2565 [WARNING] Automatic CFL correction applied (count: 14800):
268.7s 2566 Calculated CFL: 0.800 > Limit: 0.500
268.7s 2567 Original dt: 4.114981e-01 s
268.7s 2568 Corrected dt: 2.571863e-01 s
268.7s 2569 Correction factor: 1.6x
268.7s 2570 Max wave speed detected: 19.44 m/s
268.9s 2571 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
269.3s 2572 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
269.5s 2573 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
269.5s 2574 [A
269.5s 2575 Stored output at t = 120.0000 s (Step 465)
269.5s 2576 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s]
269.5s 2577 
269.5s 2578 Simulation finished at t = 120.0000 s after 465 steps.
269.5s 2579 Total runtime: 2.16 seconds.
269.5s 2580 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
269.5s 2581 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
269.5s 2582 Using device: gpu
269.5s 2583 DEBUG PARAMS: Reading K_m_kmh = 10.0
269.5s 2584 DEBUG PARAMS: Reading K_c_kmh = 15.0
269.5s 2585 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
269.5s 2586 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
269.5s 2587 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
269.5s 2588 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
269.5s 2589 Loading road quality type: uniform
269.5s 2590 Uniform road quality value: 2
269.5s 2591 Road quality loaded.
269.5s 2592 Initial state created.
269.5s 2593 Transferring initial state and road quality to GPU...
269.5s 2594 GPU data transfer complete.
269.5s 2595 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
269.5s 2596 Initial boundary conditions applied.
269.5s 2597 [BC UPDATE] left → phase 0 (outflow)
269.5s 2598 └─ Outflow: zero-order extrapolation
269.5s 2599 [BC UPDATE] left → phase 1 (inflow)
269.5s 2600 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
269.5s 2601 Running simulation until t = 60.00 s, outputting every 60.00 s
269.5s 2602 
269.6s 2603 [WARNING] Automatic CFL correction applied (count: 14900):
269.6s 2604 Calculated CFL: 0.800 > Limit: 0.500
269.6s 2605 Original dt: 4.295974e-01 s
269.6s 2606 Corrected dt: 2.684983e-01 s
269.6s 2607 Correction factor: 1.6x
269.6s 2608 Max wave speed detected: 18.62 m/s
269.9s 2609 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
270.4s 2610 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
270.6s 2611 [WARNING] Automatic CFL correction applied (count: 15000):
270.6s 2612 Calculated CFL: 0.800 > Limit: 0.500
270.6s 2613 Original dt: 4.127253e-01 s
270.6s 2614 Corrected dt: 2.579533e-01 s
270.6s 2615 Correction factor: 1.6x
270.6s 2616 Max wave speed detected: 19.38 m/s
270.9s 2617 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
271.3s 2618 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
271.5s 2619 [WARNING] Automatic CFL correction applied (count: 15100):
271.5s 2620 Calculated CFL: 0.800 > Limit: 0.500
271.5s 2621 Original dt: 4.115153e-01 s
271.5s 2622 Corrected dt: 2.571971e-01 s
271.5s 2623 Correction factor: 1.6x
271.5s 2624 Max wave speed detected: 19.44 m/s
271.6s 2625 Stored output at t = 60.0000 s (Step 231)
271.6s 2626 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
271.6s 2627 [A
271.6s 2628 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.08s/s]
271.6s 2629 
271.6s 2630 Simulation finished at t = 60.0000 s after 231 steps.
271.6s 2631 Total runtime: 2.14 seconds.
271.6s 2632 Running simulation until t = 120.00 s, outputting every 60.00 s
271.6s 2633 
271.8s 2634 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
272.2s 2635 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
272.4s 2636 [WARNING] Automatic CFL correction applied (count: 15200):
272.4s 2637 Calculated CFL: 0.800 > Limit: 0.500
272.4s 2638 Original dt: 4.114984e-01 s
272.4s 2639 Corrected dt: 2.571865e-01 s
272.4s 2640 Correction factor: 1.6x
272.4s 2641 Max wave speed detected: 19.44 m/s
272.7s 2642 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
273.2s 2643 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
273.4s 2644 [WARNING] Automatic CFL correction applied (count: 15300):
273.4s 2645 Calculated CFL: 0.800 > Limit: 0.500
273.4s 2646 Original dt: 4.114980e-01 s
273.4s 2647 Corrected dt: 2.571863e-01 s
273.4s 2648 Correction factor: 1.6x
273.4s 2649 Max wave speed detected: 19.44 m/s
273.6s 2650 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
273.8s 2651 Stored output at t = 120.0000 s (Step 465)
273.8s 2652 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
273.8s 2653 [A
273.8s 2654 
273.8s 2655 Simulation finished at t = 120.0000 s after 465 steps.
273.8s 2656 Total runtime: 2.17 seconds.
273.8s 2657 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.70s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.70s/s]
273.8s 2658 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
273.8s 2659 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
273.8s 2660 Using device: gpu
273.8s 2661 DEBUG PARAMS: Reading K_m_kmh = 10.0
273.8s 2662 DEBUG PARAMS: Reading K_c_kmh = 15.0
273.8s 2663 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
273.8s 2664 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
273.8s 2665 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
273.8s 2666 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
273.8s 2667 Loading road quality type: uniform
273.8s 2668 Uniform road quality value: 2
273.8s 2669 Road quality loaded.
273.8s 2670 Initial state created.
273.8s 2671 Transferring initial state and road quality to GPU...
273.8s 2672 GPU data transfer complete.
273.8s 2673 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
273.8s 2674 Initial boundary conditions applied.
273.8s 2675 [BC UPDATE] left → phase 0 (outflow)
273.8s 2676 └─ Outflow: zero-order extrapolation
273.8s 2677 [BC UPDATE] left → phase 1 (inflow)
273.8s 2678 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
273.8s 2679 Running simulation until t = 60.00 s, outputting every 60.00 s
273.8s 2680 
274.3s 2681 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
274.3s 2682 [WARNING] Automatic CFL correction applied (count: 15400):
274.3s 2683 Calculated CFL: 0.800 > Limit: 0.500
274.3s 2684 Original dt: 4.346596e-01 s
274.3s 2685 Corrected dt: 2.716622e-01 s
274.3s 2686 Correction factor: 1.6x
274.3s 2687 Max wave speed detected: 18.41 m/s
274.7s 2688 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
275.2s 2689 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
275.2s 2690 [WARNING] Automatic CFL correction applied (count: 15500):
275.2s 2691 Calculated CFL: 0.800 > Limit: 0.500
275.2s 2692 Original dt: 4.117853e-01 s
275.2s 2693 Corrected dt: 2.573658e-01 s
275.2s 2694 Correction factor: 1.6x
275.2s 2695 Max wave speed detected: 19.43 m/s
275.7s 2696 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
276.0s 2697 Stored output at t = 60.0000 s (Step 231)
276.0s 2698 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
276.0s 2699 [A
276.0s 2700 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.55s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.55s/s]
276.0s 2701 
276.0s 2702 Simulation finished at t = 60.0000 s after 231 steps.
276.0s 2703 Total runtime: 2.18 seconds.
276.0s 2704 [BC UPDATE] left → phase 0 (outflow)
276.0s 2705 └─ Outflow: zero-order extrapolation
276.0s 2706 Running simulation until t = 120.00 s, outputting every 60.00 s
276.0s 2707 
276.2s 2708 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
276.2s 2709 [WARNING] Automatic CFL correction applied (count: 15600):
276.2s 2710 Calculated CFL: 0.800 > Limit: 0.500
276.2s 2711 Original dt: 4.115023e-01 s
276.2s 2712 Corrected dt: 2.571890e-01 s
276.2s 2713 Correction factor: 1.6x
276.2s 2714 Max wave speed detected: 19.44 m/s
276.6s 2715 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
277.1s 2716 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
277.1s 2717 [WARNING] Automatic CFL correction applied (count: 15700):
277.1s 2718 Calculated CFL: 0.800 > Limit: 0.500
277.1s 2719 Original dt: 4.114981e-01 s
277.1s 2720 Corrected dt: 2.571863e-01 s
277.1s 2721 Correction factor: 1.6x
277.1s 2722 Max wave speed detected: 19.44 m/s
277.6s 2723 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
278.0s 2724 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
278.1s 2725 [WARNING] Automatic CFL correction applied (count: 15800):
278.1s 2726 Calculated CFL: 0.800 > Limit: 0.500
278.1s 2727 Original dt: 4.114980e-01 s
278.1s 2728 Corrected dt: 2.571863e-01 s
278.1s 2729 Correction factor: 1.6x
278.1s 2730 Max wave speed detected: 19.44 m/s
278.2s 2731 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
278.2s 2732 [A
278.2s 2733 Stored output at t = 120.0000 s (Step 465)
278.2s 2734 
278.2s 2735 Simulation finished at t = 120.0000 s after 465 steps.
278.2s 2736 Total runtime: 2.19 seconds.
278.2s 2737 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.46s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.45s/s]
278.2s 2738 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
278.2s 2739 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
278.2s 2740 Using device: gpu
278.2s 2741 DEBUG PARAMS: Reading K_m_kmh = 10.0
278.2s 2742 DEBUG PARAMS: Reading K_c_kmh = 15.0
278.2s 2743 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
278.2s 2744 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
278.2s 2745 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
278.2s 2746 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
278.2s 2747 Loading road quality type: uniform
278.2s 2748 Uniform road quality value: 2
278.2s 2749 Road quality loaded.
278.2s 2750 Initial state created.
278.2s 2751 Transferring initial state and road quality to GPU...
278.2s 2752 GPU data transfer complete.
278.2s 2753 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
278.2s 2754 Initial boundary conditions applied.
278.2s 2755 [BC UPDATE] left → phase 0 (outflow)
278.2s 2756 └─ Outflow: zero-order extrapolation
278.2s 2757 Running simulation until t = 60.00 s, outputting every 60.00 s
278.2s 2758 
278.6s 2759 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
279.0s 2760 [WARNING] Automatic CFL correction applied (count: 15900):
279.0s 2761 Calculated CFL: 0.800 > Limit: 0.500
279.0s 2762 Original dt: 4.160552e-01 s
279.0s 2763 Corrected dt: 2.600345e-01 s
279.0s 2764 Correction factor: 1.6x
279.0s 2765 Max wave speed detected: 19.23 m/s
279.1s 2766 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
280.0s 2767 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
280.4s 2768 [WARNING] Automatic CFL correction applied (count: 16000):
280.4s 2769 Calculated CFL: 0.800 > Limit: 0.500
280.4s 2770 Original dt: 4.115592e-01 s
280.4s 2771 Corrected dt: 2.572245e-01 s
280.4s 2772 Correction factor: 1.6x
280.4s 2773 Max wave speed detected: 19.44 m/s
280.5s 2774 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
280.8s 2775 Stored output at t = 60.0000 s (Step 231)
280.8s 2776 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
280.8s 2777 [A
280.8s 2778 
280.8s 2779 Simulation finished at t = 60.0000 s after 231 steps.
280.8s 2780 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 22.55s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 22.54s/s]
280.8s 2781 Total runtime: 2.66 seconds.
280.8s 2782 [BC UPDATE] left → phase 1 (inflow)
280.8s 2783 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
280.8s 2784 Running simulation until t = 120.00 s, outputting every 60.00 s
280.8s 2785 
281.0s 2786 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
281.4s 2787 [WARNING] Automatic CFL correction applied (count: 16100):
281.4s 2788 Calculated CFL: 0.800 > Limit: 0.500
281.4s 2789 Original dt: 4.114991e-01 s
281.4s 2790 Corrected dt: 2.571870e-01 s
281.4s 2791 Correction factor: 1.6x
281.4s 2792 Max wave speed detected: 19.44 m/s
281.5s 2793 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
282.0s 2794 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
282.3s 2795 [WARNING] Automatic CFL correction applied (count: 16200):
282.3s 2796 Calculated CFL: 0.800 > Limit: 0.500
282.3s 2797 Original dt: 4.114980e-01 s
282.3s 2798 Corrected dt: 2.571863e-01 s
282.3s 2799 Correction factor: 1.6x
282.3s 2800 Max wave speed detected: 19.44 m/s
282.4s 2801 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
282.9s 2802 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
283.0s 2803 Stored output at t = 120.0000 s (Step 465)
283.0s 2804 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
283.0s 2805 [A
283.0s 2806 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.16s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.16s/s]
283.0s 2807 
283.0s 2808 Simulation finished at t = 120.0000 s after 465 steps.
283.0s 2809 Total runtime: 2.21 seconds.
283.1s 2810 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
283.1s 2811 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
283.1s 2812 Using device: gpu
283.1s 2813 DEBUG PARAMS: Reading K_m_kmh = 10.0
283.1s 2814 DEBUG PARAMS: Reading K_c_kmh = 15.0
283.1s 2815 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
283.1s 2816 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
283.1s 2817 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
283.1s 2818 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
283.1s 2819 Loading road quality type: uniform
283.1s 2820 Uniform road quality value: 2
283.1s 2821 Road quality loaded.
283.1s 2822 Initial state created.
283.1s 2823 Transferring initial state and road quality to GPU...
283.1s 2824 GPU data transfer complete.
283.1s 2825 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
283.1s 2826 Initial boundary conditions applied.
283.1s 2827 [BC UPDATE] left → phase 0 (outflow)
283.1s 2828 └─ Outflow: zero-order extrapolation
283.1s 2829 Running simulation until t = 60.00 s, outputting every 60.00 s
283.1s 2830 
283.3s 2831 [WARNING] Automatic CFL correction applied (count: 16300):
283.3s 2832 Calculated CFL: 0.800 > Limit: 0.500
283.3s 2833 Original dt: 4.547467e-01 s
283.3s 2834 Corrected dt: 2.842167e-01 s
283.3s 2835 Correction factor: 1.6x
283.3s 2836 Max wave speed detected: 17.59 m/s
283.5s 2837 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
284.0s 2838 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
284.2s 2839 [WARNING] Automatic CFL correction applied (count: 16400):
284.2s 2840 Calculated CFL: 0.800 > Limit: 0.500
284.2s 2841 Original dt: 4.125079e-01 s
284.2s 2842 Corrected dt: 2.578175e-01 s
284.2s 2843 Correction factor: 1.6x
284.2s 2844 Max wave speed detected: 19.39 m/s
284.5s 2845 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
284.9s 2846 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
285.2s 2847 [WARNING] Automatic CFL correction applied (count: 16500):
285.2s 2848 Calculated CFL: 0.800 > Limit: 0.500
285.2s 2849 Original dt: 4.115121e-01 s
285.2s 2850 Corrected dt: 2.571950e-01 s
285.2s 2851 Correction factor: 1.6x
285.2s 2852 Max wave speed detected: 19.44 m/s
285.2s 2853 Stored output at t = 60.0000 s (Step 231)
285.2s 2854 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
285.2s 2855 [A
285.2s 2856 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s]
285.2s 2857 
285.2s 2858 Simulation finished at t = 60.0000 s after 231 steps.
285.2s 2859 Total runtime: 2.16 seconds.
285.2s 2860 Running simulation until t = 120.00 s, outputting every 60.00 s
285.2s 2861 
285.4s 2862 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
285.9s 2863 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
286.1s 2864 [WARNING] Automatic CFL correction applied (count: 16600):
286.1s 2865 Calculated CFL: 0.800 > Limit: 0.500
286.1s 2866 Original dt: 4.114983e-01 s
286.1s 2867 Corrected dt: 2.571865e-01 s
286.1s 2868 Correction factor: 1.6x
286.1s 2869 Max wave speed detected: 19.44 m/s
286.4s 2870 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
286.8s 2871 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
287.0s 2872 [WARNING] Automatic CFL correction applied (count: 16700):
287.0s 2873 Calculated CFL: 0.800 > Limit: 0.500
287.0s 2874 Original dt: 4.114980e-01 s
287.0s 2875 Corrected dt: 2.571863e-01 s
287.0s 2876 Correction factor: 1.6x
287.0s 2877 Max wave speed detected: 19.44 m/s
287.3s 2878 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
287.4s 2879 Stored output at t = 120.0000 s (Step 465)
287.4s 2880 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
287.4s 2881 [A
287.4s 2882 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.32s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.31s/s]
287.4s 2883 
287.4s 2884 Simulation finished at t = 120.0000 s after 465 steps.
287.4s 2885 Total runtime: 2.20 seconds.
287.4s 2886 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
287.4s 2887 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
287.4s 2888 Using device: gpu
287.4s 2889 DEBUG PARAMS: Reading K_m_kmh = 10.0
287.4s 2890 DEBUG PARAMS: Reading K_c_kmh = 15.0
287.4s 2891 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
287.4s 2892 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
287.4s 2893 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
287.4s 2894 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
287.4s 2895 Loading road quality type: uniform
287.4s 2896 Uniform road quality value: 2
287.4s 2897 Road quality loaded.
287.4s 2898 Initial state created.
287.4s 2899 Transferring initial state and road quality to GPU...
287.4s 2900 GPU data transfer complete.
287.4s 2901 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
287.4s 2902 Initial boundary conditions applied.
287.4s 2903 [BC UPDATE] left → phase 0 (outflow)
287.4s 2904 └─ Outflow: zero-order extrapolation
287.4s 2905 [BC UPDATE] left → phase 1 (inflow)
287.4s 2906 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
287.4s 2907 Running simulation until t = 60.00 s, outputting every 60.00 s
287.4s 2908 
287.9s 2909 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
288.0s 2910 [WARNING] Automatic CFL correction applied (count: 16800):
288.0s 2911 Calculated CFL: 0.800 > Limit: 0.500
288.0s 2912 Original dt: 4.295897e-01 s
288.0s 2913 Corrected dt: 2.684936e-01 s
288.0s 2914 Correction factor: 1.6x
288.0s 2915 Max wave speed detected: 18.62 m/s
288.4s 2916 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
288.8s 2917 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
288.9s 2918 [WARNING] Automatic CFL correction applied (count: 16900):
288.9s 2919 Calculated CFL: 0.800 > Limit: 0.500
288.9s 2920 Original dt: 4.117215e-01 s
288.9s 2921 Corrected dt: 2.573259e-01 s
288.9s 2922 Correction factor: 1.6x
288.9s 2923 Max wave speed detected: 19.43 m/s
289.3s 2924 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
289.6s 2925 Stored output at t = 60.0000 s (Step 231)
289.6s 2926 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
289.6s 2927 [A
289.6s 2928 
289.6s 2929 Simulation finished at t = 60.0000 s after 231 steps.
289.6s 2930 Total runtime: 2.15 seconds.
289.6s 2931 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s]
289.6s 2932 [BC UPDATE] left → phase 0 (outflow)
289.6s 2933 └─ Outflow: zero-order extrapolation
289.6s 2934 Running simulation until t = 120.00 s, outputting every 60.00 s
289.6s 2935 
289.8s 2936 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
289.9s 2937 [WARNING] Automatic CFL correction applied (count: 17000):
289.9s 2938 Calculated CFL: 0.800 > Limit: 0.500
289.9s 2939 Original dt: 4.115016e-01 s
289.9s 2940 Corrected dt: 2.571885e-01 s
289.9s 2941 Correction factor: 1.6x
289.9s 2942 Max wave speed detected: 19.44 m/s
290.3s 2943 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
290.8s 2944 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
290.9s 2945 [WARNING] Automatic CFL correction applied (count: 17100):
290.9s 2946 Calculated CFL: 0.800 > Limit: 0.500
290.9s 2947 Original dt: 4.114981e-01 s
290.9s 2948 Corrected dt: 2.571863e-01 s
290.9s 2949 Correction factor: 1.6x
290.9s 2950 Max wave speed detected: 19.44 m/s
291.2s 2951 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
291.7s 2952 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
291.8s 2953 [WARNING] Automatic CFL correction applied (count: 17200):
291.8s 2954 Calculated CFL: 0.800 > Limit: 0.500
291.8s 2955 Original dt: 4.114980e-01 s
291.8s 2956 Corrected dt: 2.571863e-01 s
291.8s 2957 Correction factor: 1.6x
291.8s 2958 Max wave speed detected: 19.44 m/s
291.9s 2959 Stored output at t = 120.0000 s (Step 465)
291.9s 2960 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
291.9s 2961 [A
291.9s 2962 
291.9s 2963 Simulation finished at t = 120.0000 s after 465 steps.
291.9s 2964 Total runtime: 2.26 seconds.
291.9s 2965 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.52s/s]
291.9s 2966 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
291.9s 2967 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
291.9s 2968 Using device: gpu
291.9s 2969 DEBUG PARAMS: Reading K_m_kmh = 10.0
291.9s 2970 DEBUG PARAMS: Reading K_c_kmh = 15.0
291.9s 2971 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
291.9s 2972 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
291.9s 2973 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
291.9s 2974 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
291.9s 2975 Loading road quality type: uniform
291.9s 2976 Uniform road quality value: 2
291.9s 2977 Road quality loaded.
291.9s 2978 Initial state created.
291.9s 2979 Transferring initial state and road quality to GPU...
291.9s 2980 GPU data transfer complete.
291.9s 2981 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
291.9s 2982 Initial boundary conditions applied.
291.9s 2983 [BC UPDATE] left → phase 0 (outflow)
291.9s 2984 └─ Outflow: zero-order extrapolation
291.9s 2985 Running simulation until t = 60.00 s, outputting every 60.00 s
291.9s 2986 
292.3s 2987 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
292.8s 2988 [WARNING] Automatic CFL correction applied (count: 17300):
292.8s 2989 Calculated CFL: 0.800 > Limit: 0.500
292.8s 2990 Original dt: 4.151534e-01 s
292.8s 2991 Corrected dt: 2.594709e-01 s
292.8s 2992 Correction factor: 1.6x
292.8s 2993 Max wave speed detected: 19.27 m/s
292.8s 2994 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
293.3s 2995 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
293.7s 2996 [WARNING] Automatic CFL correction applied (count: 17400):
293.7s 2997 Calculated CFL: 0.800 > Limit: 0.500
293.7s 2998 Original dt: 4.115470e-01 s
293.7s 2999 Corrected dt: 2.572169e-01 s
293.7s 3000 Correction factor: 1.6x
293.7s 3001 Max wave speed detected: 19.44 m/s
293.7s 3002 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
294.0s 3003 Stored output at t = 60.0000 s (Step 231)
294.0s 3004 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
294.0s 3005 [A
294.0s 3006 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s]
294.0s 3007 
294.0s 3008 Simulation finished at t = 60.0000 s after 231 steps.
294.0s 3009 Total runtime: 2.14 seconds.
294.0s 3010 [BC UPDATE] left → phase 1 (inflow)
294.0s 3011 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
294.0s 3012 Running simulation until t = 120.00 s, outputting every 60.00 s
294.0s 3013 
294.2s 3014 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
294.6s 3015 [WARNING] Automatic CFL correction applied (count: 17500):
294.6s 3016 Calculated CFL: 0.800 > Limit: 0.500
294.6s 3017 Original dt: 4.114990e-01 s
294.6s 3018 Corrected dt: 2.571869e-01 s
294.6s 3019 Correction factor: 1.6x
294.6s 3020 Max wave speed detected: 19.44 m/s
294.7s 3021 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
295.1s 3022 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
295.5s 3023 [WARNING] Automatic CFL correction applied (count: 17600):
295.5s 3024 Calculated CFL: 0.800 > Limit: 0.500
295.5s 3025 Original dt: 4.114980e-01 s
295.5s 3026 Corrected dt: 2.571863e-01 s
295.5s 3027 Correction factor: 1.6x
295.5s 3028 Max wave speed detected: 19.44 m/s
295.6s 3029 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
296.1s 3030 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
296.2s 3031 Stored output at t = 120.0000 s (Step 465)
296.2s 3032 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
296.2s 3033 [A
296.2s 3034 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.55s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.55s/s]
296.2s 3035 
296.2s 3036 Simulation finished at t = 120.0000 s after 465 steps.
296.2s 3037 Total runtime: 2.18 seconds.
296.2s 3038 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
296.2s 3039 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
296.2s 3040 Using device: gpu
296.2s 3041 DEBUG PARAMS: Reading K_m_kmh = 10.0
296.2s 3042 DEBUG PARAMS: Reading K_c_kmh = 15.0
296.2s 3043 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
296.2s 3044 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
296.2s 3045 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
296.2s 3046 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
296.2s 3047 Loading road quality type: uniform
296.2s 3048 Uniform road quality value: 2
296.2s 3049 Road quality loaded.
296.2s 3050 Initial state created.
296.2s 3051 Transferring initial state and road quality to GPU...
296.2s 3052 GPU data transfer complete.
296.2s 3053 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
296.2s 3054 Initial boundary conditions applied.
296.2s 3055 [BC UPDATE] left → phase 0 (outflow)
296.2s 3056 └─ Outflow: zero-order extrapolation
296.2s 3057 [BC UPDATE] left → phase 1 (inflow)
296.2s 3058 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
296.2s 3059 Running simulation until t = 60.00 s, outputting every 60.00 s
296.2s 3060 
296.5s 3061 [WARNING] Automatic CFL correction applied (count: 17700):
296.5s 3062 Calculated CFL: 0.800 > Limit: 0.500
296.5s 3063 Original dt: 4.768783e-01 s
296.5s 3064 Corrected dt: 2.980490e-01 s
296.5s 3065 Correction factor: 1.6x
296.5s 3066 Max wave speed detected: 16.78 m/s
296.7s 3067 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
297.2s 3068 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
297.5s 3069 [WARNING] Automatic CFL correction applied (count: 17800):
297.5s 3070 Calculated CFL: 0.800 > Limit: 0.500
297.5s 3071 Original dt: 4.123385e-01 s
297.5s 3072 Corrected dt: 2.577116e-01 s
297.5s 3073 Correction factor: 1.6x
297.5s 3074 Max wave speed detected: 19.40 m/s
297.7s 3075 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
298.1s 3076 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
298.4s 3077 [WARNING] Automatic CFL correction applied (count: 17900):
298.4s 3078 Calculated CFL: 0.800 > Limit: 0.500
298.4s 3079 Original dt: 4.115097e-01 s
298.4s 3080 Corrected dt: 2.571935e-01 s
298.4s 3081 Correction factor: 1.6x
298.4s 3082 Max wave speed detected: 19.44 m/s
298.4s 3083 Stored output at t = 60.0000 s (Step 231)
298.4s 3084 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
298.4s 3085 [A
298.4s 3086 
298.4s 3087 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.29s/s]
298.4s 3088 Simulation finished at t = 60.0000 s after 231 steps.
298.4s 3089 Total runtime: 2.20 seconds.
298.4s 3090 Running simulation until t = 120.00 s, outputting every 60.00 s
298.4s 3091 
298.6s 3092 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
299.1s 3093 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
299.3s 3094 [WARNING] Automatic CFL correction applied (count: 18000):
299.3s 3095 Calculated CFL: 0.800 > Limit: 0.500
299.3s 3096 Original dt: 4.114983e-01 s
299.3s 3097 Corrected dt: 2.571864e-01 s
299.3s 3098 Correction factor: 1.6x
299.3s 3099 Max wave speed detected: 19.44 m/s
299.5s 3100 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
300.0s 3101 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
300.3s 3102 [WARNING] Automatic CFL correction applied (count: 18100):
300.3s 3103 Calculated CFL: 0.800 > Limit: 0.500
300.3s 3104 Original dt: 4.114980e-01 s
300.3s 3105 Corrected dt: 2.571863e-01 s
300.3s 3106 Correction factor: 1.6x
300.3s 3107 Max wave speed detected: 19.44 m/s
300.4s 3108 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
300.6s 3109 Stored output at t = 120.0000 s (Step 465)
300.6s 3110 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
300.6s 3111 [A
300.6s 3112 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s]
300.6s 3113 
300.6s 3114 Simulation finished at t = 120.0000 s after 465 steps.
300.6s 3115 Total runtime: 2.18 seconds.
300.6s 3116 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
300.6s 3117 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
300.6s 3118 Using device: gpu
300.6s 3119 DEBUG PARAMS: Reading K_m_kmh = 10.0
300.6s 3120 DEBUG PARAMS: Reading K_c_kmh = 15.0
300.6s 3121 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
300.6s 3122 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
300.6s 3123 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
300.6s 3124 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
300.6s 3125 Loading road quality type: uniform
300.6s 3126 Uniform road quality value: 2
300.6s 3127 Road quality loaded.
300.6s 3128 Initial state created.
300.6s 3129 Transferring initial state and road quality to GPU...
300.6s 3130 GPU data transfer complete.
300.6s 3131 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
300.6s 3132 Initial boundary conditions applied.
300.6s 3133 [BC UPDATE] left → phase 0 (outflow)
300.6s 3134 └─ Outflow: zero-order extrapolation
300.6s 3135 [BC UPDATE] left → phase 1 (inflow)
300.6s 3136 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
300.6s 3137 Running simulation until t = 60.00 s, outputting every 60.00 s
300.6s 3138 
301.1s 3139 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
301.2s 3140 [WARNING] Automatic CFL correction applied (count: 18200):
301.2s 3141 Calculated CFL: 0.800 > Limit: 0.500
301.2s 3142 Original dt: 4.254608e-01 s
301.2s 3143 Corrected dt: 2.659130e-01 s
301.2s 3144 Correction factor: 1.6x
301.2s 3145 Max wave speed detected: 18.80 m/s
301.6s 3146 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
302.1s 3147 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
302.2s 3148 [WARNING] Automatic CFL correction applied (count: 18300):
302.2s 3149 Calculated CFL: 0.800 > Limit: 0.500
302.2s 3150 Original dt: 4.116742e-01 s
302.2s 3151 Corrected dt: 2.572964e-01 s
302.2s 3152 Correction factor: 1.6x
302.2s 3153 Max wave speed detected: 19.43 m/s
302.5s 3154 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
302.8s 3155 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
302.8s 3156 [A
302.8s 3157 Stored output at t = 60.0000 s (Step 231)
302.8s 3158 
302.8s 3159 Simulation finished at t = 60.0000 s after 231 steps.
302.8s 3160 Total runtime: 2.23 seconds.
302.8s 3161 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.93s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.92s/s]
302.8s 3162 Running simulation until t = 120.00 s, outputting every 60.00 s
302.8s 3163 
303.0s 3164 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
303.2s 3165 [WARNING] Automatic CFL correction applied (count: 18400):
303.2s 3166 Calculated CFL: 0.800 > Limit: 0.500
303.2s 3167 Original dt: 4.115011e-01 s
303.2s 3168 Corrected dt: 2.571882e-01 s
303.2s 3169 Correction factor: 1.6x
303.2s 3170 Max wave speed detected: 19.44 m/s
303.5s 3171 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
304.0s 3172 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
304.1s 3173 [WARNING] Automatic CFL correction applied (count: 18500):
304.1s 3174 Calculated CFL: 0.800 > Limit: 0.500
304.1s 3175 Original dt: 4.114981e-01 s
304.1s 3176 Corrected dt: 2.571863e-01 s
304.1s 3177 Correction factor: 1.6x
304.1s 3178 Max wave speed detected: 19.44 m/s
304.4s 3179 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
304.9s 3180 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
305.1s 3181 [WARNING] Automatic CFL correction applied (count: 18600):
305.1s 3182 Calculated CFL: 0.800 > Limit: 0.500
305.1s 3183 Original dt: 4.114980e-01 s
305.1s 3184 Corrected dt: 2.571863e-01 s
305.1s 3185 Correction factor: 1.6x
305.1s 3186 Max wave speed detected: 19.44 m/s
305.1s 3187 Stored output at t = 120.0000 s (Step 465)
305.1s 3188 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
305.1s 3189 [A
305.1s 3190 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.05s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.04s/s]
305.1s 3191 
305.1s 3192 Simulation finished at t = 120.0000 s after 465 steps.
305.1s 3193 Total runtime: 2.22 seconds.
305.1s 3194 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
305.1s 3195 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
305.1s 3196 Using device: gpu
305.1s 3197 DEBUG PARAMS: Reading K_m_kmh = 10.0
305.1s 3198 DEBUG PARAMS: Reading K_c_kmh = 15.0
305.1s 3199 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
305.1s 3200 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
305.1s 3201 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
305.1s 3202 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
305.1s 3203 Loading road quality type: uniform
305.1s 3204 Uniform road quality value: 2
305.1s 3205 Road quality loaded.
305.1s 3206 Initial state created.
305.1s 3207 Transferring initial state and road quality to GPU...
305.1s 3208 GPU data transfer complete.
305.1s 3209 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
305.1s 3210 Initial boundary conditions applied.
305.1s 3211 [BC UPDATE] left → phase 0 (outflow)
305.1s 3212 └─ Outflow: zero-order extrapolation
305.1s 3213 Running simulation until t = 60.00 s, outputting every 60.00 s
305.1s 3214 
305.6s 3215 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
306.0s 3216 [WARNING] Automatic CFL correction applied (count: 18700):
306.0s 3217 Calculated CFL: 0.800 > Limit: 0.500
306.0s 3218 Original dt: 4.145004e-01 s
306.0s 3219 Corrected dt: 2.590627e-01 s
306.0s 3220 Correction factor: 1.6x
306.0s 3221 Max wave speed detected: 19.30 m/s
306.0s 3222 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
306.5s 3223 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
307.0s 3224 [WARNING] Automatic CFL correction applied (count: 18800):
307.0s 3225 Calculated CFL: 0.800 > Limit: 0.500
307.0s 3226 Original dt: 4.115380e-01 s
307.0s 3227 Corrected dt: 2.572113e-01 s
307.0s 3228 Correction factor: 1.6x
307.0s 3229 Max wave speed detected: 19.44 m/s
307.0s 3230 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
307.2s 3231 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
307.2s 3232 [A
307.2s 3233 Stored output at t = 60.0000 s (Step 231)
307.2s 3234 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.77s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.77s/s]
307.2s 3235 
307.2s 3236 Simulation finished at t = 60.0000 s after 231 steps.
307.2s 3237 Total runtime: 2.16 seconds.
307.2s 3238 Running simulation until t = 120.00 s, outputting every 60.00 s
307.2s 3239 
307.4s 3240 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
307.9s 3241 [WARNING] Automatic CFL correction applied (count: 18900):
307.9s 3242 Calculated CFL: 0.800 > Limit: 0.500
307.9s 3243 Original dt: 4.114988e-01 s
307.9s 3244 Corrected dt: 2.571867e-01 s
307.9s 3245 Correction factor: 1.6x
307.9s 3246 Max wave speed detected: 19.44 m/s
307.9s 3247 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
308.4s 3248 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
308.8s 3249 [WARNING] Automatic CFL correction applied (count: 19000):
308.8s 3250 Calculated CFL: 0.800 > Limit: 0.500
308.8s 3251 Original dt: 4.114980e-01 s
308.8s 3252 Corrected dt: 2.571863e-01 s
308.8s 3253 Correction factor: 1.6x
308.8s 3254 Max wave speed detected: 19.44 m/s
308.8s 3255 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
309.3s 3256 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
309.4s 3257 Stored output at t = 120.0000 s (Step 465)
309.4s 3258 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
309.4s 3259 [A
309.4s 3260 
309.4s 3261 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s]
309.4s 3262 Simulation finished at t = 120.0000 s after 465 steps.
309.4s 3263 Total runtime: 2.16 seconds.
309.4s 3264 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
309.4s 3265 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
309.4s 3266 Using device: gpu
309.4s 3267 DEBUG PARAMS: Reading K_m_kmh = 10.0
309.4s 3268 DEBUG PARAMS: Reading K_c_kmh = 15.0
309.4s 3269 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
309.4s 3270 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
309.4s 3271 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
309.4s 3272 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
309.4s 3273 Loading road quality type: uniform
309.4s 3274 Uniform road quality value: 2
309.4s 3275 Road quality loaded.
309.4s 3276 Initial state created.
309.4s 3277 Transferring initial state and road quality to GPU...
309.4s 3278 GPU data transfer complete.
309.4s 3279 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
309.4s 3280 Initial boundary conditions applied.
309.4s 3281 [BC UPDATE] left → phase 0 (outflow)
309.4s 3282 └─ Outflow: zero-order extrapolation
309.4s 3283 Running simulation until t = 60.00 s, outputting every 60.00 s
309.4s 3284 
309.7s 3285 [WARNING] Automatic CFL correction applied (count: 19100):
309.7s 3286 Calculated CFL: 0.800 > Limit: 0.500
309.7s 3287 Original dt: 4.758816e-01 s
309.7s 3288 Corrected dt: 2.974260e-01 s
309.7s 3289 Correction factor: 1.6x
309.7s 3290 Max wave speed detected: 16.81 m/s
309.9s 3291 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
310.4s 3292 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
310.7s 3293 [WARNING] Automatic CFL correction applied (count: 19200):
310.7s 3294 Calculated CFL: 0.800 > Limit: 0.500
310.7s 3295 Original dt: 4.121510e-01 s
310.7s 3296 Corrected dt: 2.575944e-01 s
310.7s 3297 Correction factor: 1.6x
310.7s 3298 Max wave speed detected: 19.41 m/s
310.9s 3299 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
311.3s 3300 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
311.6s 3301 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
311.6s 3302 [A
311.6s 3303 Stored output at t = 60.0000 s (Step 231)
311.6s 3304 
311.6s 3305 Simulation finished at t = 60.0000 s after 231 steps.
311.6s 3306 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.60s/s]
311.6s 3307 Total runtime: 2.17 seconds.
311.6s 3308 Running simulation until t = 120.00 s, outputting every 60.00 s
311.6s 3309 
311.6s 3310 [WARNING] Automatic CFL correction applied (count: 19300):
311.6s 3311 Calculated CFL: 0.800 > Limit: 0.500
311.6s 3312 Original dt: 4.115082e-01 s
311.6s 3313 Corrected dt: 2.571926e-01 s
311.6s 3314 Correction factor: 1.6x
311.6s 3315 Max wave speed detected: 19.44 m/s
311.8s 3316 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
312.2s 3317 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
312.6s 3318 [WARNING] Automatic CFL correction applied (count: 19400):
312.6s 3319 Calculated CFL: 0.800 > Limit: 0.500
312.6s 3320 Original dt: 4.114982e-01 s
312.6s 3321 Corrected dt: 2.571864e-01 s
312.6s 3322 Correction factor: 1.6x
312.6s 3323 Max wave speed detected: 19.44 m/s
312.7s 3324 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
313.2s 3325 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
313.5s 3326 [WARNING] Automatic CFL correction applied (count: 19500):
313.5s 3327 Calculated CFL: 0.800 > Limit: 0.500
313.5s 3328 Original dt: 4.114980e-01 s
313.5s 3329 Corrected dt: 2.571863e-01 s
313.5s 3330 Correction factor: 1.6x
313.5s 3331 Max wave speed detected: 19.44 m/s
313.6s 3332 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
313.8s 3333 Stored output at t = 120.0000 s (Step 465)
313.8s 3334 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
313.8s 3335 [A
313.8s 3336 
313.8s 3337 Simulation finished at t = 120.0000 s after 465 steps.
313.8s 3338 Total runtime: 2.17 seconds.
313.8s 3339 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.64s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.64s/s]
313.8s 3340 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
313.8s 3341 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
313.8s 3342 Using device: gpu
313.8s 3343 DEBUG PARAMS: Reading K_m_kmh = 10.0
313.8s 3344 DEBUG PARAMS: Reading K_c_kmh = 15.0
313.8s 3345 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
313.8s 3346 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
313.8s 3347 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
313.8s 3348 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
313.8s 3349 Loading road quality type: uniform
313.8s 3350 Uniform road quality value: 2
313.8s 3351 Road quality loaded.
313.8s 3352 Initial state created.
313.8s 3353 Transferring initial state and road quality to GPU...
313.8s 3354 GPU data transfer complete.
313.8s 3355 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
313.8s 3356 Initial boundary conditions applied.
313.8s 3357 [BC UPDATE] left → phase 0 (outflow)
313.8s 3358 └─ Outflow: zero-order extrapolation
313.8s 3359 Running simulation until t = 60.00 s, outputting every 60.00 s
313.8s 3360 
314.3s 3361 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
314.4s 3362 [WARNING] Automatic CFL correction applied (count: 19600):
314.4s 3363 Calculated CFL: 0.800 > Limit: 0.500
314.4s 3364 Original dt: 4.225636e-01 s
314.4s 3365 Corrected dt: 2.641023e-01 s
314.4s 3366 Correction factor: 1.6x
314.4s 3367 Max wave speed detected: 18.93 m/s
314.7s 3368 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
315.2s 3369 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
315.3s 3370 [WARNING] Automatic CFL correction applied (count: 19700):
315.3s 3371 Calculated CFL: 0.800 > Limit: 0.500
315.3s 3372 Original dt: 4.116395e-01 s
315.3s 3373 Corrected dt: 2.572747e-01 s
315.3s 3374 Correction factor: 1.6x
315.3s 3375 Max wave speed detected: 19.43 m/s
315.6s 3376 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
315.9s 3377 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
315.9s 3378 [A
315.9s 3379 Stored output at t = 60.0000 s (Step 231)
315.9s 3380 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.10s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.10s/s]
315.9s 3381 
315.9s 3382 Simulation finished at t = 60.0000 s after 231 steps.
315.9s 3383 Total runtime: 2.14 seconds.
315.9s 3384 Running simulation until t = 120.00 s, outputting every 60.00 s
315.9s 3385 
316.1s 3386 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
316.3s 3387 [WARNING] Automatic CFL correction applied (count: 19800):
316.3s 3388 Calculated CFL: 0.800 > Limit: 0.500
316.3s 3389 Original dt: 4.115005e-01 s
316.3s 3390 Corrected dt: 2.571878e-01 s
316.3s 3391 Correction factor: 1.6x
316.3s 3392 Max wave speed detected: 19.44 m/s
316.6s 3393 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
317.0s 3394 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
317.2s 3395 [WARNING] Automatic CFL correction applied (count: 19900):
317.2s 3396 Calculated CFL: 0.800 > Limit: 0.500
317.2s 3397 Original dt: 4.114981e-01 s
317.2s 3398 Corrected dt: 2.571863e-01 s
317.2s 3399 Correction factor: 1.6x
317.2s 3400 Max wave speed detected: 19.44 m/s
317.5s 3401 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
318.0s 3402 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
318.1s 3403 Stored output at t = 120.0000 s (Step 465)
318.1s 3404 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
318.1s 3405 [A
318.1s 3406 
318.1s 3407 Simulation finished at t = 120.0000 s after 465 steps.
318.1s 3408 Total runtime: 2.18 seconds.
318.1s 3409 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.57s/s]
318.1s 3410 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
318.1s 3411 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
318.1s 3412 Using device: gpu
318.1s 3413 DEBUG PARAMS: Reading K_m_kmh = 10.0
318.1s 3414 DEBUG PARAMS: Reading K_c_kmh = 15.0
318.1s 3415 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
318.1s 3416 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
318.1s 3417 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
318.1s 3418 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
318.1s 3419 Loading road quality type: uniform
318.1s 3420 Uniform road quality value: 2
318.1s 3421 Road quality loaded.
318.1s 3422 Initial state created.
318.1s 3423 Transferring initial state and road quality to GPU...
318.1s 3424 GPU data transfer complete.
318.1s 3425 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
318.1s 3426 Initial boundary conditions applied.
318.1s 3427 [BC UPDATE] left → phase 0 (outflow)
318.1s 3428 └─ Outflow: zero-order extrapolation
318.1s 3429 Running simulation until t = 60.00 s, outputting every 60.00 s
318.1s 3430 
318.2s 3431 [WARNING] Automatic CFL correction applied (count: 20000):
318.2s 3432 Calculated CFL: 0.800 > Limit: 0.500
318.2s 3433 Original dt: 3.451280e-01 s
318.2s 3434 Corrected dt: 2.157050e-01 s
318.2s 3435 Correction factor: 1.6x
318.2s 3436 Max wave speed detected: 23.18 m/s
318.6s 3437 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
319.0s 3438 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
319.1s 3439 [WARNING] Automatic CFL correction applied (count: 20100):
319.1s 3440 Calculated CFL: 0.800 > Limit: 0.500
319.1s 3441 Original dt: 4.139892e-01 s
319.1s 3442 Corrected dt: 2.587433e-01 s
319.1s 3443 Correction factor: 1.6x
319.1s 3444 Max wave speed detected: 19.32 m/s
319.5s 3445 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
320.0s 3446 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
320.0s 3447 [WARNING] Automatic CFL correction applied (count: 20200):
320.0s 3448 Calculated CFL: 0.800 > Limit: 0.500
320.0s 3449 Original dt: 4.115314e-01 s
320.0s 3450 Corrected dt: 2.572071e-01 s
320.0s 3451 Correction factor: 1.6x
320.0s 3452 Max wave speed detected: 19.44 m/s
320.3s 3453 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
320.3s 3454 [A
320.3s 3455 Stored output at t = 60.0000 s (Step 231)
320.3s 3456 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s]
320.3s 3457 
320.3s 3458 Simulation finished at t = 60.0000 s after 231 steps.
320.3s 3459 Total runtime: 2.13 seconds.
320.3s 3460 [BC UPDATE] left → phase 1 (inflow)
320.3s 3461 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
320.3s 3462 Running simulation until t = 120.00 s, outputting every 60.00 s
320.3s 3463 
320.4s 3464 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
320.9s 3465 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
321.0s 3466 [WARNING] Automatic CFL correction applied (count: 20300):
321.0s 3467 Calculated CFL: 0.800 > Limit: 0.500
321.0s 3468 Original dt: 4.114986e-01 s
321.0s 3469 Corrected dt: 2.571866e-01 s
321.0s 3470 Correction factor: 1.6x
321.0s 3471 Max wave speed detected: 19.44 m/s
321.4s 3472 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
321.9s 3473 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
321.9s 3474 [WARNING] Automatic CFL correction applied (count: 20400):
321.9s 3475 Calculated CFL: 0.800 > Limit: 0.500
321.9s 3476 Original dt: 4.114980e-01 s
321.9s 3477 Corrected dt: 2.571863e-01 s
321.9s 3478 Correction factor: 1.6x
321.9s 3479 Max wave speed detected: 19.44 m/s
322.3s 3480 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
322.5s 3481 Stored output at t = 120.0000 s (Step 465)
322.5s 3482 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
322.5s 3483 [A
322.5s 3484 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.03s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.03s/s]
322.5s 3485 
322.5s 3486 Simulation finished at t = 120.0000 s after 465 steps.
322.5s 3487 Total runtime: 2.22 seconds.
322.5s 3488 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
322.5s 3489 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
322.5s 3490 Using device: gpu
322.5s 3491 DEBUG PARAMS: Reading K_m_kmh = 10.0
322.5s 3492 DEBUG PARAMS: Reading K_c_kmh = 15.0
322.5s 3493 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
322.5s 3494 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
322.5s 3495 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
322.5s 3496 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
322.5s 3497 Loading road quality type: uniform
322.5s 3498 Uniform road quality value: 2
322.5s 3499 Road quality loaded.
322.5s 3500 Initial state created.
322.5s 3501 Transferring initial state and road quality to GPU...
322.5s 3502 GPU data transfer complete.
322.5s 3503 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
322.5s 3504 Initial boundary conditions applied.
322.5s 3505 [BC UPDATE] left → phase 0 (outflow)
322.5s 3506 └─ Outflow: zero-order extrapolation
322.5s 3507 Running simulation until t = 60.00 s, outputting every 60.00 s
322.5s 3508 
322.9s 3509 [WARNING] Automatic CFL correction applied (count: 20500):
322.9s 3510 Calculated CFL: 0.800 > Limit: 0.500
322.9s 3511 Original dt: 4.583403e-01 s
322.9s 3512 Corrected dt: 2.864627e-01 s
322.9s 3513 Correction factor: 1.6x
322.9s 3514 Max wave speed detected: 17.45 m/s
323.0s 3515 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
323.4s 3516 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
323.8s 3517 [WARNING] Automatic CFL correction applied (count: 20600):
323.8s 3518 Calculated CFL: 0.800 > Limit: 0.500
323.8s 3519 Original dt: 4.120137e-01 s
323.8s 3520 Corrected dt: 2.575085e-01 s
323.8s 3521 Correction factor: 1.6x
323.8s 3522 Max wave speed detected: 19.42 m/s
323.9s 3523 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
324.4s 3524 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
324.7s 3525 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
324.7s 3526 Stored output at t = 60.0000 s (Step 231)
324.7s 3527 [A
324.7s 3528 
324.7s 3529 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s]
324.7s 3530 Simulation finished at t = 60.0000 s after 231 steps.
324.7s 3531 Total runtime: 2.17 seconds.
324.7s 3532 [BC UPDATE] left → phase 1 (inflow)
324.7s 3533 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
324.7s 3534 Running simulation until t = 120.00 s, outputting every 60.00 s
324.7s 3535 
324.7s 3536 [WARNING] Automatic CFL correction applied (count: 20700):
324.7s 3537 Calculated CFL: 0.800 > Limit: 0.500
324.7s 3538 Original dt: 4.115064e-01 s
324.7s 3539 Corrected dt: 2.571915e-01 s
324.7s 3540 Correction factor: 1.6x
324.7s 3541 Max wave speed detected: 19.44 m/s
324.8s 3542 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
325.3s 3543 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
325.7s 3544 [WARNING] Automatic CFL correction applied (count: 20800):
325.7s 3545 Calculated CFL: 0.800 > Limit: 0.500
325.7s 3546 Original dt: 4.114982e-01 s
325.7s 3547 Corrected dt: 2.571864e-01 s
325.7s 3548 Correction factor: 1.6x
325.7s 3549 Max wave speed detected: 19.44 m/s
325.8s 3550 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
326.3s 3551 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
326.6s 3552 [WARNING] Automatic CFL correction applied (count: 20900):
326.6s 3553 Calculated CFL: 0.800 > Limit: 0.500
326.6s 3554 Original dt: 4.114980e-01 s
326.6s 3555 Corrected dt: 2.571863e-01 s
326.6s 3556 Correction factor: 1.6x
326.6s 3557 Max wave speed detected: 19.44 m/s
326.7s 3558 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
326.9s 3559 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
326.9s 3560 [A
326.9s 3561 Stored output at t = 120.0000 s (Step 465)
326.9s 3562 
326.9s 3563 Simulation finished at t = 120.0000 s after 465 steps.
326.9s 3564 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.24s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.24s/s]
326.9s 3565 Total runtime: 2.20 seconds.
326.9s 3566 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
326.9s 3567 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
326.9s 3568 Using device: gpu
326.9s 3569 DEBUG PARAMS: Reading K_m_kmh = 10.0
326.9s 3570 DEBUG PARAMS: Reading K_c_kmh = 15.0
326.9s 3571 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
326.9s 3572 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
326.9s 3573 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
326.9s 3574 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
326.9s 3575 Loading road quality type: uniform
326.9s 3576 Uniform road quality value: 2
326.9s 3577 Road quality loaded.
326.9s 3578 Initial state created.
326.9s 3579 Transferring initial state and road quality to GPU...
326.9s 3580 GPU data transfer complete.
326.9s 3581 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
326.9s 3582 Initial boundary conditions applied.
326.9s 3583 [BC UPDATE] left → phase 0 (outflow)
326.9s 3584 └─ Outflow: zero-order extrapolation
326.9s 3585 [BC UPDATE] left → phase 1 (inflow)
326.9s 3586 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
326.9s 3587 Running simulation until t = 60.00 s, outputting every 60.00 s
326.9s 3588 
327.4s 3589 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
327.6s 3590 [WARNING] Automatic CFL correction applied (count: 21000):
327.6s 3591 Calculated CFL: 0.800 > Limit: 0.500
327.6s 3592 Original dt: 4.205139e-01 s
327.6s 3593 Corrected dt: 2.628212e-01 s
327.6s 3594 Correction factor: 1.6x
327.6s 3595 Max wave speed detected: 19.02 m/s
327.8s 3596 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
328.3s 3597 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
328.5s 3598 [WARNING] Automatic CFL correction applied (count: 21100):
328.5s 3599 Calculated CFL: 0.800 > Limit: 0.500
328.5s 3600 Original dt: 4.116141e-01 s
328.5s 3601 Corrected dt: 2.572588e-01 s
328.5s 3602 Correction factor: 1.6x
328.5s 3603 Max wave speed detected: 19.44 m/s
328.7s 3604 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
329.0s 3605 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
329.0s 3606 [A
329.0s 3607 Stored output at t = 60.0000 s (Step 231)
329.0s 3608 
329.0s 3609 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s]
329.0s 3610 Simulation finished at t = 60.0000 s after 231 steps.
329.0s 3611 Total runtime: 2.13 seconds.
329.0s 3612 [BC UPDATE] left → phase 0 (outflow)
329.0s 3613 └─ Outflow: zero-order extrapolation
329.0s 3614 Running simulation until t = 120.00 s, outputting every 60.00 s
329.0s 3615 
329.2s 3616 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
329.4s 3617 [WARNING] Automatic CFL correction applied (count: 21200):
329.4s 3618 Calculated CFL: 0.800 > Limit: 0.500
329.4s 3619 Original dt: 4.115000e-01 s
329.4s 3620 Corrected dt: 2.571875e-01 s
329.4s 3621 Correction factor: 1.6x
329.4s 3622 Max wave speed detected: 19.44 m/s
329.7s 3623 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
330.1s 3624 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
330.3s 3625 [WARNING] Automatic CFL correction applied (count: 21300):
330.3s 3626 Calculated CFL: 0.800 > Limit: 0.500
330.3s 3627 Original dt: 4.114981e-01 s
330.3s 3628 Corrected dt: 2.571863e-01 s
330.3s 3629 Correction factor: 1.6x
330.3s 3630 Max wave speed detected: 19.44 m/s
330.6s 3631 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
331.1s 3632 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
331.2s 3633 Stored output at t = 120.0000 s (Step 465)
331.2s 3634 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
331.2s 3635 [A
331.2s 3636 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.42s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.42s/s]
331.2s 3637 
331.2s 3638 Simulation finished at t = 120.0000 s after 465 steps.
331.2s 3639 Total runtime: 2.19 seconds.
331.2s 3640 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
331.2s 3641 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
331.2s 3642 Using device: gpu
331.2s 3643 DEBUG PARAMS: Reading K_m_kmh = 10.0
331.2s 3644 DEBUG PARAMS: Reading K_c_kmh = 15.0
331.2s 3645 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
331.2s 3646 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
331.2s 3647 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
331.2s 3648 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
331.2s 3649 Loading road quality type: uniform
331.2s 3650 Uniform road quality value: 2
331.2s 3651 Road quality loaded.
331.2s 3652 Initial state created.
331.2s 3653 Transferring initial state and road quality to GPU...
331.2s 3654 GPU data transfer complete.
331.2s 3655 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
331.2s 3656 Initial boundary conditions applied.
331.2s 3657 [BC UPDATE] left → phase 0 (outflow)
331.2s 3658 └─ Outflow: zero-order extrapolation
331.2s 3659 [BC UPDATE] left → phase 1 (inflow)
331.2s 3660 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
331.2s 3661 Running simulation until t = 60.00 s, outputting every 60.00 s
331.2s 3662 
331.3s 3663 [WARNING] Automatic CFL correction applied (count: 21400):
331.3s 3664 Calculated CFL: 0.800 > Limit: 0.500
331.3s 3665 Original dt: 3.737254e-01 s
331.3s 3666 Corrected dt: 2.335784e-01 s
331.3s 3667 Correction factor: 1.6x
331.3s 3668 Max wave speed detected: 21.41 m/s
331.7s 3669 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
332.1s 3670 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
332.2s 3671 [WARNING] Automatic CFL correction applied (count: 21500):
332.2s 3672 Calculated CFL: 0.800 > Limit: 0.500
332.2s 3673 Original dt: 4.134305e-01 s
332.2s 3674 Corrected dt: 2.583941e-01 s
332.2s 3675 Correction factor: 1.6x
332.2s 3676 Max wave speed detected: 19.35 m/s
332.6s 3677 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
333.1s 3678 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
333.1s 3679 [WARNING] Automatic CFL correction applied (count: 21600):
333.1s 3680 Calculated CFL: 0.800 > Limit: 0.500
333.1s 3681 Original dt: 4.115259e-01 s
333.1s 3682 Corrected dt: 2.572037e-01 s
333.1s 3683 Correction factor: 1.6x
333.1s 3684 Max wave speed detected: 19.44 m/s
333.4s 3685 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
333.4s 3686 [A
333.4s 3687 Stored output at t = 60.0000 s (Step 231)
333.4s 3688 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.17s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.17s/s]
333.4s 3689 
333.4s 3690 Simulation finished at t = 60.0000 s after 231 steps.
333.4s 3691 Total runtime: 2.13 seconds.
333.4s 3692 [BC UPDATE] left → phase 0 (outflow)
333.4s 3693 └─ Outflow: zero-order extrapolation
333.4s 3694 Running simulation until t = 120.00 s, outputting every 60.00 s
333.4s 3695 
333.5s 3696 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
334.0s 3697 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
334.1s 3698 [WARNING] Automatic CFL correction applied (count: 21700):
334.1s 3699 Calculated CFL: 0.800 > Limit: 0.500
334.1s 3700 Original dt: 4.114985e-01 s
334.1s 3701 Corrected dt: 2.571866e-01 s
334.1s 3702 Correction factor: 1.6x
334.1s 3703 Max wave speed detected: 19.44 m/s
334.5s 3704 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
335.0s 3705 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
335.0s 3706 [WARNING] Automatic CFL correction applied (count: 21800):
335.0s 3707 Calculated CFL: 0.800 > Limit: 0.500
335.0s 3708 Original dt: 4.114980e-01 s
335.0s 3709 Corrected dt: 2.571863e-01 s
335.0s 3710 Correction factor: 1.6x
335.0s 3711 Max wave speed detected: 19.44 m/s
335.4s 3712 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
335.5s 3713 Stored output at t = 120.0000 s (Step 465)
335.5s 3714 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
335.5s 3715 [A
335.5s 3716 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.43s/s]
335.5s 3717 
335.5s 3718 Simulation finished at t = 120.0000 s after 465 steps.
335.5s 3719 Total runtime: 2.19 seconds.
335.5s 3720 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
335.5s 3721 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
335.5s 3722 Using device: gpu
335.6s 3723 DEBUG PARAMS: Reading K_m_kmh = 10.0
335.6s 3724 DEBUG PARAMS: Reading K_c_kmh = 15.0
335.6s 3725 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
335.6s 3726 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
335.6s 3727 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
335.6s 3728 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
335.6s 3729 Loading road quality type: uniform
335.6s 3730 Uniform road quality value: 2
335.6s 3731 Road quality loaded.
335.6s 3732 Initial state created.
335.6s 3733 Transferring initial state and road quality to GPU...
335.6s 3734 GPU data transfer complete.
335.6s 3735 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
335.6s 3736 Initial boundary conditions applied.
335.6s 3737 [BC UPDATE] left → phase 0 (outflow)
335.6s 3738 └─ Outflow: zero-order extrapolation
335.6s 3739 [BC UPDATE] left → phase 1 (inflow)
335.6s 3740 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
335.6s 3741 Running simulation until t = 60.00 s, outputting every 60.00 s
335.6s 3742 
336.0s 3743 [WARNING] Automatic CFL correction applied (count: 21900):
336.0s 3744 Calculated CFL: 0.800 > Limit: 0.500
336.0s 3745 Original dt: 4.470525e-01 s
336.0s 3746 Corrected dt: 2.794078e-01 s
336.0s 3747 Correction factor: 1.6x
336.0s 3748 Max wave speed detected: 17.89 m/s
336.0s 3749 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
336.5s 3750 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
336.9s 3751 [WARNING] Automatic CFL correction applied (count: 22000):
336.9s 3752 Calculated CFL: 0.800 > Limit: 0.500
336.9s 3753 Original dt: 4.119130e-01 s
336.9s 3754 Corrected dt: 2.574456e-01 s
336.9s 3755 Correction factor: 1.6x
336.9s 3756 Max wave speed detected: 19.42 m/s
337.0s 3757 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
337.4s 3758 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
337.7s 3759 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
337.7s 3760 Stored output at t = 60.0000 s (Step 231)
337.7s 3761 [A
337.7s 3762 
337.7s 3763 Simulation finished at t = 60.0000 s after 231 steps.
337.7s 3764 Total runtime: 2.14 seconds.
337.7s 3765 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.08s/s]
337.7s 3766 
337.7s 3767 Running simulation until t = 120.00 s, outputting every 60.00 s
337.8s 3768 [WARNING] Automatic CFL correction applied (count: 22100):
337.8s 3769 Calculated CFL: 0.800 > Limit: 0.500
337.8s 3770 Original dt: 4.115046e-01 s
337.8s 3771 Corrected dt: 2.571904e-01 s
337.8s 3772 Correction factor: 1.6x
337.8s 3773 Max wave speed detected: 19.44 m/s
337.9s 3774 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
338.3s 3775 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
338.7s 3776 [WARNING] Automatic CFL correction applied (count: 22200):
338.7s 3777 Calculated CFL: 0.800 > Limit: 0.500
338.7s 3778 Original dt: 4.114982e-01 s
338.7s 3779 Corrected dt: 2.571863e-01 s
338.7s 3780 Correction factor: 1.6x
338.7s 3781 Max wave speed detected: 19.44 m/s
338.8s 3782 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
339.3s 3783 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
339.7s 3784 [WARNING] Automatic CFL correction applied (count: 22300):
339.7s 3785 Calculated CFL: 0.800 > Limit: 0.500
339.7s 3786 Original dt: 4.114980e-01 s
339.7s 3787 Corrected dt: 2.571863e-01 s
339.7s 3788 Correction factor: 1.6x
339.7s 3789 Max wave speed detected: 19.44 m/s
339.7s 3790 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
339.9s 3791 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
339.9s 3792 [A
339.9s 3793 Stored output at t = 120.0000 s (Step 465)
339.9s 3794 
339.9s 3795 Simulation finished at t = 120.0000 s after 465 steps.
339.9s 3796 Total runtime: 2.18 seconds.
339.9s 3797 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.49s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.49s/s]
339.9s 3798 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
339.9s 3799 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
339.9s 3800 Using device: gpu
339.9s 3801 DEBUG PARAMS: Reading K_m_kmh = 10.0
339.9s 3802 DEBUG PARAMS: Reading K_c_kmh = 15.0
339.9s 3803 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
339.9s 3804 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
339.9s 3805 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
339.9s 3806 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
339.9s 3807 Loading road quality type: uniform
339.9s 3808 Uniform road quality value: 2
339.9s 3809 Road quality loaded.
339.9s 3810 Initial state created.
339.9s 3811 Transferring initial state and road quality to GPU...
339.9s 3812 GPU data transfer complete.
339.9s 3813 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
339.9s 3814 Initial boundary conditions applied.
339.9s 3815 [BC UPDATE] left → phase 0 (outflow)
339.9s 3816 └─ Outflow: zero-order extrapolation
339.9s 3817 [BC UPDATE] left → phase 1 (inflow)
339.9s 3818 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
339.9s 3819 Running simulation until t = 60.00 s, outputting every 60.00 s
339.9s 3820 
340.4s 3821 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
340.7s 3822 [WARNING] Automatic CFL correction applied (count: 22400):
340.7s 3823 Calculated CFL: 0.800 > Limit: 0.500
340.7s 3824 Original dt: 4.190346e-01 s
340.7s 3825 Corrected dt: 2.618967e-01 s
340.7s 3826 Correction factor: 1.6x
340.7s 3827 Max wave speed detected: 19.09 m/s
340.9s 3828 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
341.3s 3829 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
341.6s 3830 [WARNING] Automatic CFL correction applied (count: 22500):
341.6s 3831 Calculated CFL: 0.800 > Limit: 0.500
341.6s 3832 Original dt: 4.115954e-01 s
341.6s 3833 Corrected dt: 2.572472e-01 s
341.6s 3834 Correction factor: 1.6x
341.6s 3835 Max wave speed detected: 19.44 m/s
341.8s 3836 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
342.1s 3837 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
342.1s 3838 [A
342.1s 3839 Stored output at t = 60.0000 s (Step 231)
342.1s 3840 
342.1s 3841 Simulation finished at t = 60.0000 s after 231 steps.
342.1s 3842 Total runtime: 2.19 seconds.
342.1s 3843 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s]
342.1s 3844 Running simulation until t = 120.00 s, outputting every 60.00 s
342.1s 3845 
342.3s 3846 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
342.5s 3847 [WARNING] Automatic CFL correction applied (count: 22600):
342.5s 3848 Calculated CFL: 0.800 > Limit: 0.500
342.5s 3849 Original dt: 4.114996e-01 s
342.5s 3850 Corrected dt: 2.571873e-01 s
342.5s 3851 Correction factor: 1.6x
342.5s 3852 Max wave speed detected: 19.44 m/s
342.7s 3853 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
343.2s 3854 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
343.5s 3855 [WARNING] Automatic CFL correction applied (count: 22700):
343.5s 3856 Calculated CFL: 0.800 > Limit: 0.500
343.5s 3857 Original dt: 4.114981e-01 s
343.5s 3858 Corrected dt: 2.571863e-01 s
343.5s 3859 Correction factor: 1.6x
343.5s 3860 Max wave speed detected: 19.44 m/s
343.7s 3861 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
344.1s 3862 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
344.2s 3863 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
344.2s 3864 [A
344.2s 3865 Stored output at t = 120.0000 s (Step 465)
344.2s 3866 
344.2s 3867 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.84s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.84s/s]
344.2s 3868 Simulation finished at t = 120.0000 s after 465 steps.
344.2s 3869 Total runtime: 2.16 seconds.
344.3s 3870 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
344.3s 3871 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
344.3s 3872 Using device: gpu
344.3s 3873 DEBUG PARAMS: Reading K_m_kmh = 10.0
344.3s 3874 DEBUG PARAMS: Reading K_c_kmh = 15.0
344.3s 3875 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
344.3s 3876 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
344.3s 3877 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
344.3s 3878 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
344.3s 3879 Loading road quality type: uniform
344.3s 3880 Uniform road quality value: 2
344.3s 3881 Road quality loaded.
344.3s 3882 Initial state created.
344.3s 3883 Transferring initial state and road quality to GPU...
344.3s 3884 GPU data transfer complete.
344.3s 3885 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
344.3s 3886 Initial boundary conditions applied.
344.3s 3887 [BC UPDATE] left → phase 0 (outflow)
344.3s 3888 └─ Outflow: zero-order extrapolation
344.3s 3889 Running simulation until t = 60.00 s, outputting every 60.00 s
344.3s 3890 
344.4s 3891 [WARNING] Automatic CFL correction applied (count: 22800):
344.4s 3892 Calculated CFL: 0.800 > Limit: 0.500
344.4s 3893 Original dt: 4.022422e-01 s
344.4s 3894 Corrected dt: 2.514014e-01 s
344.4s 3895 Correction factor: 1.6x
344.4s 3896 Max wave speed detected: 19.89 m/s
344.7s 3897 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
345.2s 3898 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
345.3s 3899 [WARNING] Automatic CFL correction applied (count: 22900):
345.3s 3900 Calculated CFL: 0.800 > Limit: 0.500
345.3s 3901 Original dt: 4.130229e-01 s
345.3s 3902 Corrected dt: 2.581393e-01 s
345.3s 3903 Correction factor: 1.6x
345.3s 3904 Max wave speed detected: 19.37 m/s
345.7s 3905 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
346.1s 3906 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
346.3s 3907 [WARNING] Automatic CFL correction applied (count: 23000):
346.3s 3908 Calculated CFL: 0.800 > Limit: 0.500
346.3s 3909 Original dt: 4.115198e-01 s
346.3s 3910 Corrected dt: 2.571999e-01 s
346.3s 3911 Correction factor: 1.6x
346.3s 3912 Max wave speed detected: 19.44 m/s
346.4s 3913 Stored output at t = 60.0000 s (Step 231)
346.4s 3914 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
346.4s 3915 [A
346.4s 3916 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.92s/s]
346.4s 3917 
346.4s 3918 Simulation finished at t = 60.0000 s after 231 steps.
346.4s 3919 Total runtime: 2.15 seconds.
346.4s 3920 [BC UPDATE] left → phase 1 (inflow)
346.4s 3921 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
346.4s 3922 Running simulation until t = 120.00 s, outputting every 60.00 s
346.4s 3923 
346.6s 3924 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
347.1s 3925 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
347.2s 3926 [WARNING] Automatic CFL correction applied (count: 23100):
347.2s 3927 Calculated CFL: 0.800 > Limit: 0.500
347.2s 3928 Original dt: 4.114984e-01 s
347.2s 3929 Corrected dt: 2.571865e-01 s
347.2s 3930 Correction factor: 1.6x
347.2s 3931 Max wave speed detected: 19.44 m/s
347.5s 3932 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
348.0s 3933 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
348.1s 3934 [WARNING] Automatic CFL correction applied (count: 23200):
348.1s 3935 Calculated CFL: 0.800 > Limit: 0.500
348.1s 3936 Original dt: 4.114980e-01 s
348.1s 3937 Corrected dt: 2.571863e-01 s
348.1s 3938 Correction factor: 1.6x
348.1s 3939 Max wave speed detected: 19.44 m/s
348.4s 3940 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
348.6s 3941 Stored output at t = 120.0000 s (Step 465)
348.6s 3942 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
348.6s 3943 [A
348.6s 3944 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.69s/s]
348.6s 3945 
348.6s 3946 Simulation finished at t = 120.0000 s after 465 steps.
348.6s 3947 Total runtime: 2.17 seconds.
348.6s 3948 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
348.6s 3949 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
348.6s 3950 Using device: gpu
348.6s 3951 DEBUG PARAMS: Reading K_m_kmh = 10.0
348.6s 3952 DEBUG PARAMS: Reading K_c_kmh = 15.0
348.6s 3953 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
348.6s 3954 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
348.6s 3955 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
348.6s 3956 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
348.6s 3957 Loading road quality type: uniform
348.6s 3958 Uniform road quality value: 2
348.6s 3959 Road quality loaded.
348.6s 3960 Initial state created.
348.6s 3961 Transferring initial state and road quality to GPU...
348.6s 3962 GPU data transfer complete.
348.6s 3963 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
348.6s 3964 Initial boundary conditions applied.
348.6s 3965 [BC UPDATE] left → phase 0 (outflow)
348.6s 3966 └─ Outflow: zero-order extrapolation
348.6s 3967 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.4 steps/s
348.6s 3968 ---------------------------------
348.6s 3969 | rollout/           |          |
348.6s 3970 |    ep_len_mean     | 2        |
348.6s 3971 |    ep_rew_mean     | -0.0736  |
348.6s 3972 | time/              |          |
348.6s 3973 |    fps             | 0        |
348.6s 3974 |    iterations      | 1        |
348.6s 3975 |    time_elapsed    | 222      |
348.6s 3976 |    total_timesteps | 100      |
348.6s 3977 ---------------------------------
349.2s 3978 
349.2s 3979 ✅ Training completed in 3.7 minutes (223.2s)
349.2s 3980 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:42 < 0:00:00 , 0 it/s ]
349.2s 3981 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
349.2s 3982 
349.2s 3983 [PHASE 2/2] Running performance comparisons...
349.2s 3984 [QUICK TEST] Testing only: traffic_light_control
349.2s 3985 
349.2s 3986 Testing scenario: traffic_light_control (device=gpu)
349.2s 3987 2025-10-10 10:58:38 - INFO - run_performance_comparison:698 - ================================================================================
349.2s 3988 2025-10-10 10:58:38 - INFO - run_performance_comparison:699 - Starting run_performance_comparison for scenario: traffic_light_control
349.2s 3989 2025-10-10 10:58:38 - INFO - run_performance_comparison:700 - Device: gpu
349.2s 3990 2025-10-10 10:58:38 - INFO - run_performance_comparison:701 - ================================================================================
349.2s 3991 2025-10-10 10:58:38 - INFO - run_performance_comparison:702 - ================================================================================
349.2s 3992 2025-10-10 10:58:38 - INFO - run_performance_comparison:703 - Starting run_performance_comparison for scenario: traffic_light_control
349.2s 3993 2025-10-10 10:58:38 - INFO - run_performance_comparison:704 - Device: gpu
349.2s 3994 2025-10-10 10:58:38 - INFO - run_performance_comparison:705 - ================================================================================
349.2s 3995 2025-10-10 10:58:38 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
349.2s 3996 2025-10-10 10:58:38 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
349.2s 3997 2025-10-10 10:58:38 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
349.2s 3998 2025-10-10 10:58:38 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
349.2s 3999 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
349.2s 4000 Running baseline controller...
349.2s 4001 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
349.2s 4002 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
349.2s 4003 2025-10-10 10:58:38 - INFO - run_control_simulation:286 - ================================================================================
349.2s 4004 2025-10-10 10:58:38 - INFO - run_control_simulation:287 - Starting run_control_simulation:
349.2s 4005 2025-10-10 10:58:38 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
349.2s 4006 2025-10-10 10:58:38 - INFO - run_control_simulation:289 -   - duration: 600.0s
349.2s 4007 2025-10-10 10:58:38 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
349.2s 4008 2025-10-10 10:58:38 - INFO - run_control_simulation:291 -   - device: gpu
349.2s 4009 2025-10-10 10:58:38 - INFO - run_control_simulation:292 -   - controller: BaselineController
349.2s 4010 2025-10-10 10:58:38 - INFO - run_control_simulation:293 -   - max_control_steps: 11
349.2s 4011 2025-10-10 10:58:38 - INFO - run_control_simulation:294 - ================================================================================
349.2s 4012 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
349.2s 4013 2025-10-10 10:58:38 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
349.2s 4014 DEBUG PARAMS: Reading K_m_kmh = 10.0
349.2s 4015 DEBUG PARAMS: Reading K_c_kmh = 15.0
349.2s 4016 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
349.2s 4017 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
349.2s 4018 2025-10-10 10:58:38 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
349.2s 4019 2025-10-10 10:58:38 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
349.2s 4020 [INFO] Calling env.reset()...
349.2s 4021 2025-10-10 10:58:38 - INFO - run_control_simulation:329 - Calling env.reset()...
349.2s 4022 DEBUG PARAMS: Reading K_m_kmh = 10.0
349.2s 4023 DEBUG PARAMS: Reading K_c_kmh = 15.0
349.2s 4024 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
349.2s 4025 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
349.2s 4026 2025-10-10 10:58:38 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
349.2s 4027 2025-10-10 10:58:38 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
349.2s 4028 2025-10-10 10:58:38 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
349.2s 4029 [INFO] Starting simulation loop (max 11 control steps)
349.2s 4030 2025-10-10 10:58:38 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
349.2s 4031 2025-10-10 10:58:38 - INFO - run_control_simulation:366 - ================================================================================
349.2s 4032 2025-10-10 10:58:38 - INFO - run_control_simulation:367 - STEP 0 START:
349.2s 4033 2025-10-10 10:58:38 - INFO - run_control_simulation:368 -   Controller: BaselineController
349.2s 4034 2025-10-10 10:58:38 - INFO - run_control_simulation:369 -   Action: 1.000000
349.2s 4035 2025-10-10 10:58:38 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
349.7s 4036 [WARNING] Automatic CFL correction applied (count: 23300):
349.7s 4037 Calculated CFL: 0.800 > Limit: 0.500
349.7s 4038 Original dt: 4.396418e-01 s
349.7s 4039 Corrected dt: 2.747761e-01 s
349.7s 4040 Correction factor: 1.6x
349.7s 4041 Max wave speed detected: 18.20 m/s
350.6s 4042 [WARNING] Automatic CFL correction applied (count: 23400):
350.6s 4043 Calculated CFL: 0.800 > Limit: 0.500
350.6s 4044 Original dt: 4.118393e-01 s
350.6s 4045 Corrected dt: 2.573996e-01 s
350.6s 4046 Correction factor: 1.6x
350.6s 4047 Max wave speed detected: 19.43 m/s
351.4s 4048 2025-10-10 10:58:40 - INFO - run_control_simulation:382 -   Reward: -0.084799
351.4s 4049 2025-10-10 10:58:40 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
351.4s 4050 2025-10-10 10:58:40 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
351.4s 4051 2025-10-10 10:58:40 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
351.4s 4052 2025-10-10 10:58:40 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
351.4s 4053 2025-10-10 10:58:40 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.036794, rho_c=0.049919
351.4s 4054 2025-10-10 10:58:40 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.406686, w_c=11.325496
351.4s 4055 2025-10-10 10:58:40 - INFO - run_control_simulation:416 -   State hash: 416565544957933046
351.4s 4056 2025-10-10 10:58:40 - INFO - run_control_simulation:418 - ================================================================================
351.4s 4057 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
351.4s 4058 2025-10-10 10:58:40 - INFO - run_control_simulation:366 - ================================================================================
351.4s 4059 2025-10-10 10:58:40 - INFO - run_control_simulation:367 - STEP 1 START:
351.4s 4060 2025-10-10 10:58:40 - INFO - run_control_simulation:368 -   Controller: BaselineController
351.4s 4061 2025-10-10 10:58:40 - INFO - run_control_simulation:369 -   Action: 0.000000
351.4s 4062 2025-10-10 10:58:40 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
351.6s 4063 [WARNING] Automatic CFL correction applied (count: 23500):
351.6s 4064 Calculated CFL: 0.800 > Limit: 0.500
351.6s 4065 Original dt: 4.115033e-01 s
351.6s 4066 Corrected dt: 2.571896e-01 s
351.6s 4067 Correction factor: 1.6x
351.6s 4068 Max wave speed detected: 19.44 m/s
352.5s 4069 [WARNING] Automatic CFL correction applied (count: 23600):
352.5s 4070 Calculated CFL: 0.800 > Limit: 0.500
352.5s 4071 Original dt: 4.114981e-01 s
352.5s 4072 Corrected dt: 2.571863e-01 s
352.5s 4073 Correction factor: 1.6x
352.5s 4074 Max wave speed detected: 19.44 m/s
353.4s 4075 [WARNING] Automatic CFL correction applied (count: 23700):
353.4s 4076 Calculated CFL: 0.800 > Limit: 0.500
353.4s 4077 Original dt: 4.114980e-01 s
353.4s 4078 Corrected dt: 2.571863e-01 s
353.4s 4079 Correction factor: 1.6x
353.4s 4080 Max wave speed detected: 19.44 m/s
353.6s 4081 2025-10-10 10:58:42 - INFO - run_control_simulation:382 -   Reward: 0.015200
353.6s 4082 2025-10-10 10:58:42 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
353.6s 4083 2025-10-10 10:58:42 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
353.6s 4084 2025-10-10 10:58:42 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
353.6s 4085 2025-10-10 10:58:42 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
353.6s 4086 2025-10-10 10:58:42 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.008375, rho_c=0.025617
353.6s 4087 2025-10-10 10:58:42 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.918019, w_c=14.101648
353.6s 4088 2025-10-10 10:58:42 - INFO - run_control_simulation:416 -   State hash: -4332326528203125641
353.6s 4089 2025-10-10 10:58:42 - INFO - run_control_simulation:418 - ================================================================================
353.6s 4090 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
353.6s 4091 2025-10-10 10:58:42 - INFO - run_control_simulation:366 - ================================================================================
353.6s 4092 2025-10-10 10:58:42 - INFO - run_control_simulation:367 - STEP 2 START:
353.6s 4093 2025-10-10 10:58:42 - INFO - run_control_simulation:368 -   Controller: BaselineController
353.6s 4094 2025-10-10 10:58:42 - INFO - run_control_simulation:369 -   Action: 1.000000
353.6s 4095 2025-10-10 10:58:42 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
354.4s 4096 [WARNING] Automatic CFL correction applied (count: 23800):
354.4s 4097 Calculated CFL: 0.800 > Limit: 0.500
354.4s 4098 Original dt: 4.114980e-01 s
354.4s 4099 Corrected dt: 2.571863e-01 s
354.4s 4100 Correction factor: 1.6x
354.4s 4101 Max wave speed detected: 19.44 m/s
355.3s 4102 [WARNING] Automatic CFL correction applied (count: 23900):
355.3s 4103 Calculated CFL: 0.800 > Limit: 0.500
355.3s 4104 Original dt: 4.114980e-01 s
355.3s 4105 Corrected dt: 2.571863e-01 s
355.3s 4106 Correction factor: 1.6x
355.3s 4107 Max wave speed detected: 19.44 m/s
355.8s 4108 2025-10-10 10:58:44 - INFO - run_control_simulation:382 -   Reward: -0.084800
355.8s 4109 2025-10-10 10:58:44 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
355.8s 4110 2025-10-10 10:58:44 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
355.8s 4111 2025-10-10 10:58:44 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
355.8s 4112 2025-10-10 10:58:44 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.189669e+00, max=5.474976e+00, std=1.992888e+00
355.8s 4113 2025-10-10 10:58:44 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
355.8s 4114 2025-10-10 10:58:44 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.270027, w_c=16.374889
355.8s 4115 2025-10-10 10:58:44 - INFO - run_control_simulation:416 -   State hash: 3144209405335163289
355.8s 4116 2025-10-10 10:58:44 - INFO - run_control_simulation:418 - ================================================================================
355.8s 4117 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.189669e+00
355.8s 4118 2025-10-10 10:58:44 - INFO - run_control_simulation:366 - ================================================================================
355.8s 4119 2025-10-10 10:58:44 - INFO - run_control_simulation:367 - STEP 3 START:
355.8s 4120 2025-10-10 10:58:44 - INFO - run_control_simulation:368 -   Controller: BaselineController
355.8s 4121 2025-10-10 10:58:44 - INFO - run_control_simulation:369 -   Action: 0.000000
355.8s 4122 2025-10-10 10:58:44 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
356.2s 4123 [WARNING] Automatic CFL correction applied (count: 24000):
356.2s 4124 Calculated CFL: 0.800 > Limit: 0.500
356.2s 4125 Original dt: 4.114980e-01 s
356.2s 4126 Corrected dt: 2.571863e-01 s
356.2s 4127 Correction factor: 1.6x
356.2s 4128 Max wave speed detected: 19.44 m/s
357.2s 4129 [WARNING] Automatic CFL correction applied (count: 24100):
357.2s 4130 Calculated CFL: 0.800 > Limit: 0.500
357.2s 4131 Original dt: 4.114980e-01 s
357.2s 4132 Corrected dt: 2.571863e-01 s
357.2s 4133 Correction factor: 1.6x
357.2s 4134 Max wave speed detected: 19.44 m/s
358.0s 4135 2025-10-10 10:58:46 - INFO - run_control_simulation:382 -   Reward: 0.015200
358.0s 4136 2025-10-10 10:58:46 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
358.0s 4137 2025-10-10 10:58:46 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
358.0s 4138 2025-10-10 10:58:46 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
358.0s 4139 2025-10-10 10:58:46 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
358.0s 4140 2025-10-10 10:58:46 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
358.0s 4141 2025-10-10 10:58:46 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408449
358.0s 4142 2025-10-10 10:58:46 - INFO - run_control_simulation:416 -   State hash: -4337677262224596191
358.0s 4143 2025-10-10 10:58:46 - INFO - run_control_simulation:418 - ================================================================================
358.0s 4144 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
358.0s 4145 2025-10-10 10:58:46 - INFO - run_control_simulation:366 - ================================================================================
358.0s 4146 2025-10-10 10:58:46 - INFO - run_control_simulation:367 - STEP 4 START:
358.0s 4147 2025-10-10 10:58:46 - INFO - run_control_simulation:368 -   Controller: BaselineController
358.0s 4148 2025-10-10 10:58:46 - INFO - run_control_simulation:369 -   Action: 1.000000
358.0s 4149 2025-10-10 10:58:46 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
358.1s 4150 [WARNING] Automatic CFL correction applied (count: 24200):
358.1s 4151 Calculated CFL: 0.800 > Limit: 0.500
358.1s 4152 Original dt: 4.114980e-01 s
358.1s 4153 Corrected dt: 2.571863e-01 s
358.1s 4154 Correction factor: 1.6x
358.1s 4155 Max wave speed detected: 19.44 m/s
359.0s 4156 [WARNING] Automatic CFL correction applied (count: 24300):
359.0s 4157 Calculated CFL: 0.800 > Limit: 0.500
359.0s 4158 Original dt: 4.114980e-01 s
359.0s 4159 Corrected dt: 2.571863e-01 s
359.0s 4160 Correction factor: 1.6x
359.0s 4161 Max wave speed detected: 19.44 m/s
360.0s 4162 [WARNING] Automatic CFL correction applied (count: 24400):
360.0s 4163 Calculated CFL: 0.800 > Limit: 0.500
360.0s 4164 Original dt: 4.114980e-01 s
360.0s 4165 Corrected dt: 2.571863e-01 s
360.0s 4166 Correction factor: 1.6x
360.0s 4167 Max wave speed detected: 19.44 m/s
360.1s 4168 2025-10-10 10:58:48 - INFO - run_control_simulation:382 -   Reward: -0.084800
360.1s 4169 2025-10-10 10:58:48 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
360.1s 4170 2025-10-10 10:58:48 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
360.1s 4171 2025-10-10 10:58:48 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
360.1s 4172 2025-10-10 10:58:48 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.350430e-02, max=1.980205e+00, std=1.433673e-01
360.1s 4173 2025-10-10 10:58:48 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
360.1s 4174 2025-10-10 10:58:48 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
360.1s 4175 2025-10-10 10:58:48 - INFO - run_control_simulation:416 -   State hash: 5777138979965396012
360.1s 4176 2025-10-10 10:58:48 - INFO - run_control_simulation:418 - ================================================================================
360.1s 4177 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=1.350430e-02
360.1s 4178 2025-10-10 10:58:48 - INFO - run_control_simulation:366 - ================================================================================
360.1s 4179 2025-10-10 10:58:48 - INFO - run_control_simulation:367 - STEP 5 START:
360.1s 4180 2025-10-10 10:58:48 - INFO - run_control_simulation:368 -   Controller: BaselineController
360.1s 4181 2025-10-10 10:58:48 - INFO - run_control_simulation:369 -   Action: 0.000000
360.1s 4182 2025-10-10 10:58:48 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
360.9s 4183 [WARNING] Automatic CFL correction applied (count: 24500):
360.9s 4184 Calculated CFL: 0.800 > Limit: 0.500
360.9s 4185 Original dt: 4.114980e-01 s
360.9s 4186 Corrected dt: 2.571863e-01 s
360.9s 4187 Correction factor: 1.6x
360.9s 4188 Max wave speed detected: 19.44 m/s
361.8s 4189 [WARNING] Automatic CFL correction applied (count: 24600):
361.8s 4190 Calculated CFL: 0.800 > Limit: 0.500
361.8s 4191 Original dt: 4.114980e-01 s
361.8s 4192 Corrected dt: 2.571863e-01 s
361.8s 4193 Correction factor: 1.6x
361.8s 4194 Max wave speed detected: 19.44 m/s
362.3s 4195 2025-10-10 10:58:51 - INFO - run_control_simulation:382 -   Reward: 0.015200
362.3s 4196 2025-10-10 10:58:51 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
362.3s 4197 2025-10-10 10:58:51 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
362.3s 4198 2025-10-10 10:58:51 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
362.3s 4199 2025-10-10 10:58:51 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
362.3s 4200 2025-10-10 10:58:51 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
362.3s 4201 2025-10-10 10:58:51 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
362.3s 4202 2025-10-10 10:58:51 - INFO - run_control_simulation:416 -   State hash: -5671098524002675918
362.3s 4203 2025-10-10 10:58:51 - INFO - run_control_simulation:418 - ================================================================================
362.3s 4204 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
362.3s 4205 2025-10-10 10:58:51 - INFO - run_control_simulation:366 - ================================================================================
362.3s 4206 2025-10-10 10:58:51 - INFO - run_control_simulation:367 - STEP 6 START:
362.3s 4207 2025-10-10 10:58:51 - INFO - run_control_simulation:368 -   Controller: BaselineController
362.3s 4208 2025-10-10 10:58:51 - INFO - run_control_simulation:369 -   Action: 1.000000
362.3s 4209 2025-10-10 10:58:51 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
362.8s 4210 [WARNING] Automatic CFL correction applied (count: 24700):
362.8s 4211 Calculated CFL: 0.800 > Limit: 0.500
362.8s 4212 Original dt: 4.114980e-01 s
362.8s 4213 Corrected dt: 2.571863e-01 s
362.8s 4214 Correction factor: 1.6x
362.8s 4215 Max wave speed detected: 19.44 m/s
363.7s 4216 [WARNING] Automatic CFL correction applied (count: 24800):
363.7s 4217 Calculated CFL: 0.800 > Limit: 0.500
363.7s 4218 Original dt: 4.114980e-01 s
363.7s 4219 Corrected dt: 2.571863e-01 s
363.7s 4220 Correction factor: 1.6x
363.7s 4221 Max wave speed detected: 19.44 m/s
364.5s 4222 2025-10-10 10:58:53 - INFO - run_control_simulation:382 -   Reward: -0.084800
364.5s 4223 2025-10-10 10:58:53 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
364.5s 4224 2025-10-10 10:58:53 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
364.5s 4225 2025-10-10 10:58:53 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
364.5s 4226 2025-10-10 10:58:53 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.349251e-02, max=1.980205e+00, std=1.433684e-01
364.5s 4227 2025-10-10 10:58:53 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
364.5s 4228 2025-10-10 10:58:53 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
364.5s 4229 2025-10-10 10:58:53 - INFO - run_control_simulation:416 -   State hash: 4615119654657698902
364.5s 4230 2025-10-10 10:58:53 - INFO - run_control_simulation:418 - ================================================================================
364.5s 4231 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=1.349251e-02
364.5s 4232 2025-10-10 10:58:53 - INFO - run_control_simulation:366 - ================================================================================
364.5s 4233 2025-10-10 10:58:53 - INFO - run_control_simulation:367 - STEP 7 START:
364.5s 4234 2025-10-10 10:58:53 - INFO - run_control_simulation:368 -   Controller: BaselineController
364.5s 4235 2025-10-10 10:58:53 - INFO - run_control_simulation:369 -   Action: 0.000000
364.5s 4236 2025-10-10 10:58:53 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
364.6s 4237 [WARNING] Automatic CFL correction applied (count: 24900):
364.6s 4238 Calculated CFL: 0.800 > Limit: 0.500
364.6s 4239 Original dt: 4.114980e-01 s
364.6s 4240 Corrected dt: 2.571863e-01 s
364.6s 4241 Correction factor: 1.6x
364.6s 4242 Max wave speed detected: 19.44 m/s
365.6s 4243 [WARNING] Automatic CFL correction applied (count: 25000):
365.6s 4244 Calculated CFL: 0.800 > Limit: 0.500
365.6s 4245 Original dt: 4.114980e-01 s
365.6s 4246 Corrected dt: 2.571863e-01 s
365.6s 4247 Correction factor: 1.6x
365.6s 4248 Max wave speed detected: 19.44 m/s
366.5s 4249 [WARNING] Automatic CFL correction applied (count: 25100):
366.5s 4250 Calculated CFL: 0.800 > Limit: 0.500
366.5s 4251 Original dt: 4.114980e-01 s
366.5s 4252 Corrected dt: 2.571863e-01 s
366.5s 4253 Correction factor: 1.6x
366.5s 4254 Max wave speed detected: 19.44 m/s
366.7s 4255 2025-10-10 10:58:55 - INFO - run_control_simulation:382 -   Reward: 0.015200
366.7s 4256 2025-10-10 10:58:55 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
366.7s 4257 2025-10-10 10:58:55 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
366.7s 4258 2025-10-10 10:58:55 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
366.7s 4259 2025-10-10 10:58:55 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
366.7s 4260 2025-10-10 10:58:55 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
366.7s 4261 2025-10-10 10:58:55 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
366.7s 4262 2025-10-10 10:58:55 - INFO - run_control_simulation:416 -   State hash: 5170874659261337643
366.7s 4263 2025-10-10 10:58:55 - INFO - run_control_simulation:418 - ================================================================================
366.7s 4264 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
366.7s 4265 2025-10-10 10:58:55 - INFO - run_control_simulation:366 - ================================================================================
366.7s 4266 2025-10-10 10:58:55 - INFO - run_control_simulation:367 - STEP 8 START:
366.7s 4267 2025-10-10 10:58:55 - INFO - run_control_simulation:368 -   Controller: BaselineController
366.7s 4268 2025-10-10 10:58:55 - INFO - run_control_simulation:369 -   Action: 1.000000
366.7s 4269 2025-10-10 10:58:55 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
367.4s 4270 [WARNING] Automatic CFL correction applied (count: 25200):
367.4s 4271 Calculated CFL: 0.800 > Limit: 0.500
367.4s 4272 Original dt: 4.114980e-01 s
367.4s 4273 Corrected dt: 2.571863e-01 s
367.4s 4274 Correction factor: 1.6x
367.4s 4275 Max wave speed detected: 19.44 m/s
368.3s 4276 [WARNING] Automatic CFL correction applied (count: 25300):
368.3s 4277 Calculated CFL: 0.800 > Limit: 0.500
368.3s 4278 Original dt: 4.114980e-01 s
368.3s 4279 Corrected dt: 2.571863e-01 s
368.3s 4280 Correction factor: 1.6x
368.3s 4281 Max wave speed detected: 19.44 m/s
368.8s 4282 2025-10-10 10:58:57 - INFO - run_control_simulation:382 -   Reward: -0.084800
368.8s 4283 2025-10-10 10:58:57 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
368.8s 4284 2025-10-10 10:58:57 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
368.8s 4285 2025-10-10 10:58:57 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
368.8s 4286 2025-10-10 10:58:57 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.349251e-02, max=1.980205e+00, std=1.433684e-01
368.8s 4287 2025-10-10 10:58:57 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
368.8s 4288 2025-10-10 10:58:57 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
368.8s 4289 2025-10-10 10:58:57 - INFO - run_control_simulation:416 -   State hash: 3776973576550232237
368.8s 4290 2025-10-10 10:58:57 - INFO - run_control_simulation:418 - ================================================================================
368.8s 4291 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=1.349251e-02
368.8s 4292 2025-10-10 10:58:57 - INFO - run_control_simulation:366 - ================================================================================
368.8s 4293 2025-10-10 10:58:57 - INFO - run_control_simulation:367 - STEP 9 START:
368.8s 4294 2025-10-10 10:58:57 - INFO - run_control_simulation:368 -   Controller: BaselineController
368.8s 4295 2025-10-10 10:58:57 - INFO - run_control_simulation:369 -   Action: 0.000000
368.8s 4296 2025-10-10 10:58:57 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
369.2s 4297 [WARNING] Automatic CFL correction applied (count: 25400):
369.2s 4298 Calculated CFL: 0.800 > Limit: 0.500
369.2s 4299 Original dt: 4.114980e-01 s
369.2s 4300 Corrected dt: 2.571863e-01 s
369.2s 4301 Correction factor: 1.6x
369.2s 4302 Max wave speed detected: 19.44 m/s
370.1s 4303 [WARNING] Automatic CFL correction applied (count: 25500):
370.1s 4304 Calculated CFL: 0.800 > Limit: 0.500
370.1s 4305 Original dt: 4.114980e-01 s
370.1s 4306 Corrected dt: 2.571863e-01 s
370.1s 4307 Correction factor: 1.6x
370.1s 4308 Max wave speed detected: 19.44 m/s
371.0s 4309 2025-10-10 10:58:59 - INFO - run_control_simulation:382 -   Reward: 0.015200
371.0s 4310 2025-10-10 10:58:59 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
371.0s 4311 2025-10-10 10:58:59 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
371.0s 4312 2025-10-10 10:58:59 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
371.0s 4313 2025-10-10 10:58:59 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
371.0s 4314 2025-10-10 10:58:59 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
371.0s 4315 2025-10-10 10:58:59 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
371.0s 4316 2025-10-10 10:58:59 - INFO - run_control_simulation:416 -   State hash: 157986543601466995
371.0s 4317 2025-10-10 10:58:59 - INFO - run_control_simulation:418 - ================================================================================
371.0s 4318 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
371.0s 4319 
371.0s 4320 [SIMULATION COMPLETED] Summary:
371.0s 4321 - Total control steps: 10
371.0s 4322 - Total reward: -0.35
371.0s 4323 - Avg step time: 2.175s (device=gpu)
371.0s 4324 - Simulated time: 600.0s / 600.0s
371.0s 4325 - Wallclock time: 21.8s
371.0s 4326 - Speed ratio: 27.58x real-time
371.0s 4327 
371.0s 4328 2025-10-10 10:58:59 - INFO - run_control_simulation:453 -
371.0s 4329 [SIMULATION COMPLETED] Summary:
371.0s 4330 - Total control steps: 10
371.0s 4331 - Total reward: -0.35
371.0s 4332 - Avg step time: 2.175s (device=gpu)
371.0s 4333 - Simulated time: 600.0s / 600.0s
371.0s 4334 - Wallclock time: 21.8s
371.0s 4335 - Speed ratio: 27.58x real-time
371.0s 4336 
371.0s 4337 2025-10-10 10:58:59 - INFO - run_control_simulation:454 - Returning 10 state snapshots
371.0s 4338 2025-10-10 10:58:59 - INFO - run_performance_comparison:723 - Baseline states copied: 10 snapshots
371.0s 4339 2025-10-10 10:58:59 - INFO - run_performance_comparison:724 - Baseline FIRST state hash: 416565544957933046
371.0s 4340 2025-10-10 10:58:59 - INFO - run_performance_comparison:725 - Baseline LAST state hash: 157986543601466995
371.0s 4341 2025-10-10 10:58:59 - INFO - run_performance_comparison:726 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
371.0s 4342 2.14351577e-05]
371.0s 4343 2025-10-10 10:58:59 - INFO - run_performance_comparison:727 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
371.0s 4344 2.14319923e-05]
371.0s 4345 2025-10-10 10:58:59 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
371.0s 4346 2025-10-10 10:58:59 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=416565544957933046, last=157986543601466995
371.0s 4347 2025-10-10 10:58:59 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
371.0s 4348 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
371.0s 4349 2025-10-10 10:58:59 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
371.0s 4350 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
371.0s 4351 2025-10-10 10:58:59 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
371.0s 4352 Running RL controller...
371.0s 4353 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
371.0s 4354 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
371.0s 4355 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
371.0s 4356 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
371.0s 4357 2025-10-10 10:58:59 - INFO - run_control_simulation:286 - ================================================================================
371.0s 4358 2025-10-10 10:58:59 - INFO - run_control_simulation:287 - Starting run_control_simulation:
371.0s 4359 2025-10-10 10:58:59 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
371.0s 4360 2025-10-10 10:58:59 - INFO - run_control_simulation:289 -   - duration: 600.0s
371.0s 4361 2025-10-10 10:58:59 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
371.0s 4362 2025-10-10 10:58:59 - INFO - run_control_simulation:291 -   - device: gpu
371.0s 4363 2025-10-10 10:58:59 - INFO - run_control_simulation:292 -   - controller: RLController
371.0s 4364 2025-10-10 10:58:59 - INFO - run_control_simulation:293 -   - max_control_steps: 11
371.0s 4365 2025-10-10 10:58:59 - INFO - run_control_simulation:294 - ================================================================================
371.0s 4366 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
371.0s 4367 2025-10-10 10:58:59 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
371.0s 4368 DEBUG PARAMS: Reading K_m_kmh = 10.0
371.0s 4369 DEBUG PARAMS: Reading K_c_kmh = 15.0
371.0s 4370 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
371.0s 4371 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
371.0s 4372 2025-10-10 10:58:59 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
371.0s 4373 2025-10-10 10:58:59 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
371.0s 4374 [INFO] Calling env.reset()...
371.0s 4375 2025-10-10 10:58:59 - INFO - run_control_simulation:329 - Calling env.reset()...
371.0s 4376 DEBUG PARAMS: Reading K_m_kmh = 10.0
371.0s 4377 DEBUG PARAMS: Reading K_c_kmh = 15.0
371.0s 4378 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
371.0s 4379 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
371.0s 4380 2025-10-10 10:58:59 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
371.0s 4381 2025-10-10 10:58:59 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
371.0s 4382 2025-10-10 10:58:59 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
371.0s 4383 [INFO] Starting simulation loop (max 11 control steps)
371.0s 4384 2025-10-10 10:58:59 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
371.0s 4385 2025-10-10 10:58:59 - INFO - run_control_simulation:366 - ================================================================================
371.0s 4386 2025-10-10 10:58:59 - INFO - run_control_simulation:367 - STEP 0 START:
371.0s 4387 2025-10-10 10:58:59 - INFO - run_control_simulation:368 -   Controller: RLController
371.0s 4388 2025-10-10 10:58:59 - INFO - run_control_simulation:369 -   Action: 0.000000
371.0s 4389 2025-10-10 10:58:59 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
371.1s 4390 [WARNING] Automatic CFL correction applied (count: 25600):
371.1s 4391 Calculated CFL: 0.800 > Limit: 0.500
371.1s 4392 Original dt: 3.909130e-01 s
371.1s 4393 Corrected dt: 2.443206e-01 s
371.1s 4394 Correction factor: 1.6x
371.1s 4395 Max wave speed detected: 20.46 m/s
372.0s 4396 [WARNING] Automatic CFL correction applied (count: 25700):
372.0s 4397 Calculated CFL: 0.800 > Limit: 0.500
372.0s 4398 Original dt: 4.131708e-01 s
372.0s 4399 Corrected dt: 2.582317e-01 s
372.0s 4400 Correction factor: 1.6x
372.0s 4401 Max wave speed detected: 19.36 m/s
372.9s 4402 [WARNING] Automatic CFL correction applied (count: 25800):
372.9s 4403 Calculated CFL: 0.800 > Limit: 0.500
372.9s 4404 Original dt: 4.115220e-01 s
372.9s 4405 Corrected dt: 2.572013e-01 s
372.9s 4406 Correction factor: 1.6x
372.9s 4407 Max wave speed detected: 19.44 m/s
373.1s 4408 2025-10-10 10:59:01 - INFO - run_control_simulation:382 -   Reward: 0.015201
373.1s 4409 2025-10-10 10:59:01 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
373.1s 4410 2025-10-10 10:59:01 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
373.1s 4411 2025-10-10 10:59:01 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
373.1s 4412 2025-10-10 10:59:01 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.660497e+00, max=1.233795e+01, std=4.070771e+00
373.1s 4413 2025-10-10 10:59:01 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.034872, rho_c=0.047612
373.1s 4414 2025-10-10 10:59:01 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.395027, w_c=11.287416
373.1s 4415 2025-10-10 10:59:01 - INFO - run_control_simulation:416 -   State hash: 8244144800744263245
373.1s 4416 2025-10-10 10:59:01 - INFO - run_control_simulation:418 - ================================================================================
373.1s 4417 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.660497e+00
373.1s 4418 2025-10-10 10:59:01 - INFO - run_control_simulation:366 - ================================================================================
373.1s 4419 2025-10-10 10:59:01 - INFO - run_control_simulation:367 - STEP 1 START:
373.1s 4420 2025-10-10 10:59:01 - INFO - run_control_simulation:368 -   Controller: RLController
373.1s 4421 2025-10-10 10:59:01 - INFO - run_control_simulation:369 -   Action: 0.000000
373.1s 4422 2025-10-10 10:59:01 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
373.8s 4423 [WARNING] Automatic CFL correction applied (count: 25900):
373.8s 4424 Calculated CFL: 0.800 > Limit: 0.500
373.8s 4425 Original dt: 4.114985e-01 s
373.8s 4426 Corrected dt: 2.571865e-01 s
373.8s 4427 Correction factor: 1.6x
373.8s 4428 Max wave speed detected: 19.44 m/s
374.8s 4429 [WARNING] Automatic CFL correction applied (count: 26000):
374.8s 4430 Calculated CFL: 0.800 > Limit: 0.500
374.8s 4431 Original dt: 4.114980e-01 s
374.8s 4432 Corrected dt: 2.571863e-01 s
374.8s 4433 Correction factor: 1.6x
374.8s 4434 Max wave speed detected: 19.44 m/s
375.3s 4435 2025-10-10 10:59:04 - INFO - run_control_simulation:382 -   Reward: 0.015200
375.3s 4436 2025-10-10 10:59:04 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
375.3s 4437 2025-10-10 10:59:04 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
375.3s 4438 2025-10-10 10:59:04 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
375.3s 4439 2025-10-10 10:59:04 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
375.3s 4440 2025-10-10 10:59:04 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.006453, rho_c=0.023310
375.3s 4441 2025-10-10 10:59:04 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.906360, w_c=14.063567
375.3s 4442 2025-10-10 10:59:04 - INFO - run_control_simulation:416 -   State hash: -6864357441145394378
375.3s 4443 2025-10-10 10:59:04 - INFO - run_control_simulation:418 - ================================================================================
375.3s 4444 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
375.3s 4445 2025-10-10 10:59:04 - INFO - run_control_simulation:366 - ================================================================================
375.3s 4446 2025-10-10 10:59:04 - INFO - run_control_simulation:367 - STEP 2 START:
375.3s 4447 2025-10-10 10:59:04 - INFO - run_control_simulation:368 -   Controller: RLController
375.3s 4448 2025-10-10 10:59:04 - INFO - run_control_simulation:369 -   Action: 0.000000
375.3s 4449 2025-10-10 10:59:04 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
375.7s 4450 [WARNING] Automatic CFL correction applied (count: 26100):
375.7s 4451 Calculated CFL: 0.800 > Limit: 0.500
375.7s 4452 Original dt: 4.114980e-01 s
375.7s 4453 Corrected dt: 2.571863e-01 s
375.7s 4454 Correction factor: 1.6x
375.7s 4455 Max wave speed detected: 19.44 m/s
376.6s 4456 [WARNING] Automatic CFL correction applied (count: 26200):
376.6s 4457 Calculated CFL: 0.800 > Limit: 0.500
376.6s 4458 Original dt: 4.114980e-01 s
376.6s 4459 Corrected dt: 2.571863e-01 s
376.6s 4460 Correction factor: 1.6x
376.6s 4461 Max wave speed detected: 19.44 m/s
377.4s 4462 2025-10-10 10:59:06 - INFO - run_control_simulation:382 -   Reward: 0.015200
377.4s 4463 2025-10-10 10:59:06 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
377.4s 4464 2025-10-10 10:59:06 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
377.4s 4465 2025-10-10 10:59:06 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
377.4s 4466 2025-10-10 10:59:06 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
377.4s 4467 2025-10-10 10:59:06 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
377.4s 4468 2025-10-10 10:59:06 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.270027, w_c=16.374889
377.4s 4469 2025-10-10 10:59:06 - INFO - run_control_simulation:416 -   State hash: 3144209405335163289
377.4s 4470 2025-10-10 10:59:06 - INFO - run_control_simulation:418 - ================================================================================
377.4s 4471 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
377.4s 4472 2025-10-10 10:59:06 - INFO - run_control_simulation:366 - ================================================================================
377.4s 4473 2025-10-10 10:59:06 - INFO - run_control_simulation:367 - STEP 3 START:
377.4s 4474 2025-10-10 10:59:06 - INFO - run_control_simulation:368 -   Controller: RLController
377.4s 4475 2025-10-10 10:59:06 - INFO - run_control_simulation:369 -   Action: 0.000000
377.4s 4476 2025-10-10 10:59:06 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
377.5s 4477 [WARNING] Automatic CFL correction applied (count: 26300):
377.5s 4478 Calculated CFL: 0.800 > Limit: 0.500
377.5s 4479 Original dt: 4.114980e-01 s
377.5s 4480 Corrected dt: 2.571863e-01 s
377.5s 4481 Correction factor: 1.6x
377.5s 4482 Max wave speed detected: 19.44 m/s
378.4s 4483 [WARNING] Automatic CFL correction applied (count: 26400):
378.4s 4484 Calculated CFL: 0.800 > Limit: 0.500
378.4s 4485 Original dt: 4.114980e-01 s
378.4s 4486 Corrected dt: 2.571863e-01 s
378.4s 4487 Correction factor: 1.6x
378.4s 4488 Max wave speed detected: 19.44 m/s
379.3s 4489 [WARNING] Automatic CFL correction applied (count: 26500):
379.3s 4490 Calculated CFL: 0.800 > Limit: 0.500
379.3s 4491 Original dt: 4.114980e-01 s
379.3s 4492 Corrected dt: 2.571863e-01 s
379.3s 4493 Correction factor: 1.6x
379.3s 4494 Max wave speed detected: 19.44 m/s
379.5s 4495 2025-10-10 10:59:08 - INFO - run_control_simulation:382 -   Reward: 0.015200
379.5s 4496 2025-10-10 10:59:08 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
379.5s 4497 2025-10-10 10:59:08 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
379.5s 4498 2025-10-10 10:59:08 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
379.5s 4499 2025-10-10 10:59:08 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
379.5s 4500 2025-10-10 10:59:08 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
379.5s 4501 2025-10-10 10:59:08 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408449
379.5s 4502 2025-10-10 10:59:08 - INFO - run_control_simulation:416 -   State hash: -4337677262224596191
379.5s 4503 2025-10-10 10:59:08 - INFO - run_control_simulation:418 - ================================================================================
379.5s 4504 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
379.5s 4505 2025-10-10 10:59:08 - INFO - run_control_simulation:366 - ================================================================================
379.5s 4506 2025-10-10 10:59:08 - INFO - run_control_simulation:367 - STEP 4 START:
379.5s 4507 2025-10-10 10:59:08 - INFO - run_control_simulation:368 -   Controller: RLController
379.5s 4508 2025-10-10 10:59:08 - INFO - run_control_simulation:369 -   Action: 0.000000
379.5s 4509 2025-10-10 10:59:08 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
380.2s 4510 [WARNING] Automatic CFL correction applied (count: 26600):
380.2s 4511 Calculated CFL: 0.800 > Limit: 0.500
380.2s 4512 Original dt: 4.114980e-01 s
380.2s 4513 Corrected dt: 2.571863e-01 s
380.2s 4514 Correction factor: 1.6x
380.2s 4515 Max wave speed detected: 19.44 m/s
381.2s 4516 [WARNING] Automatic CFL correction applied (count: 26700):
381.2s 4517 Calculated CFL: 0.800 > Limit: 0.500
381.2s 4518 Original dt: 4.114980e-01 s
381.2s 4519 Corrected dt: 2.571863e-01 s
381.2s 4520 Correction factor: 1.6x
381.2s 4521 Max wave speed detected: 19.44 m/s
381.7s 4522 2025-10-10 10:59:10 - INFO - run_control_simulation:382 -   Reward: 0.015200
381.7s 4523 2025-10-10 10:59:10 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
381.7s 4524 2025-10-10 10:59:10 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
381.7s 4525 2025-10-10 10:59:10 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
381.7s 4526 2025-10-10 10:59:10 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
381.7s 4527 2025-10-10 10:59:10 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
381.7s 4528 2025-10-10 10:59:10 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408496
381.7s 4529 2025-10-10 10:59:10 - INFO - run_control_simulation:416 -   State hash: 382880318486915022
381.7s 4530 2025-10-10 10:59:10 - INFO - run_control_simulation:418 - ================================================================================
381.7s 4531 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
381.7s 4532 2025-10-10 10:59:10 - INFO - run_control_simulation:366 - ================================================================================
381.7s 4533 2025-10-10 10:59:10 - INFO - run_control_simulation:367 - STEP 5 START:
381.7s 4534 2025-10-10 10:59:10 - INFO - run_control_simulation:368 -   Controller: RLController
381.7s 4535 2025-10-10 10:59:10 - INFO - run_control_simulation:369 -   Action: 0.000000
381.7s 4536 2025-10-10 10:59:10 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
382.1s 4537 [WARNING] Automatic CFL correction applied (count: 26800):
382.1s 4538 Calculated CFL: 0.800 > Limit: 0.500
382.1s 4539 Original dt: 4.114980e-01 s
382.1s 4540 Corrected dt: 2.571863e-01 s
382.1s 4541 Correction factor: 1.6x
382.1s 4542 Max wave speed detected: 19.44 m/s
383.1s 4543 [WARNING] Automatic CFL correction applied (count: 26900):
383.1s 4544 Calculated CFL: 0.800 > Limit: 0.500
383.1s 4545 Original dt: 4.114980e-01 s
383.1s 4546 Corrected dt: 2.571863e-01 s
383.1s 4547 Correction factor: 1.6x
383.1s 4548 Max wave speed detected: 19.44 m/s
383.9s 4549 2025-10-10 10:59:12 - INFO - run_control_simulation:382 -   Reward: 0.015200
383.9s 4550 2025-10-10 10:59:12 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
383.9s 4551 2025-10-10 10:59:12 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
383.9s 4552 2025-10-10 10:59:12 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
383.9s 4553 2025-10-10 10:59:12 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649701e-08, max=5.259947e-07, std=7.009070e-08
383.9s 4554 2025-10-10 10:59:12 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
383.9s 4555 2025-10-10 10:59:12 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
383.9s 4556 2025-10-10 10:59:12 - INFO - run_control_simulation:416 -   State hash: -8340664590815557243
383.9s 4557 2025-10-10 10:59:12 - INFO - run_control_simulation:418 - ================================================================================
383.9s 4558 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649701e-08
383.9s 4559 2025-10-10 10:59:12 - INFO - run_control_simulation:366 - ================================================================================
383.9s 4560 2025-10-10 10:59:12 - INFO - run_control_simulation:367 - STEP 6 START:
383.9s 4561 2025-10-10 10:59:12 - INFO - run_control_simulation:368 -   Controller: RLController
383.9s 4562 2025-10-10 10:59:12 - INFO - run_control_simulation:369 -   Action: 0.000000
383.9s 4563 2025-10-10 10:59:12 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
384.0s 4564 [WARNING] Automatic CFL correction applied (count: 27000):
384.0s 4565 Calculated CFL: 0.800 > Limit: 0.500
384.0s 4566 Original dt: 4.114980e-01 s
384.0s 4567 Corrected dt: 2.571863e-01 s
384.0s 4568 Correction factor: 1.6x
384.0s 4569 Max wave speed detected: 19.44 m/s
384.9s 4570 [WARNING] Automatic CFL correction applied (count: 27100):
384.9s 4571 Calculated CFL: 0.800 > Limit: 0.500
384.9s 4572 Original dt: 4.114980e-01 s
384.9s 4573 Corrected dt: 2.571863e-01 s
384.9s 4574 Correction factor: 1.6x
384.9s 4575 Max wave speed detected: 19.44 m/s
385.8s 4576 [WARNING] Automatic CFL correction applied (count: 27200):
385.8s 4577 Calculated CFL: 0.800 > Limit: 0.500
385.8s 4578 Original dt: 4.114980e-01 s
385.8s 4579 Corrected dt: 2.571863e-01 s
385.8s 4580 Correction factor: 1.6x
385.8s 4581 Max wave speed detected: 19.44 m/s
386.0s 4582 2025-10-10 10:59:14 - INFO - run_control_simulation:382 -   Reward: 0.015200
386.0s 4583 2025-10-10 10:59:14 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
386.0s 4584 2025-10-10 10:59:14 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
386.0s 4585 2025-10-10 10:59:14 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
386.0s 4586 2025-10-10 10:59:14 - INFO - run_control_simulation:401 -     Diff statistics: mean=2.295406e-11, max=7.384955e-10, std=9.818587e-11
386.0s 4587 2025-10-10 10:59:14 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
386.0s 4588 2025-10-10 10:59:14 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
386.0s 4589 2025-10-10 10:59:14 - INFO - run_control_simulation:416 -   State hash: 4615119654657698902
386.0s 4590 2025-10-10 10:59:14 - INFO - run_control_simulation:418 - ================================================================================
386.0s 4591 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295406e-11
386.0s 4592 2025-10-10 10:59:14 - INFO - run_control_simulation:366 - ================================================================================
386.0s 4593 2025-10-10 10:59:14 - INFO - run_control_simulation:367 - STEP 7 START:
386.0s 4594 2025-10-10 10:59:14 - INFO - run_control_simulation:368 -   Controller: RLController
386.0s 4595 2025-10-10 10:59:14 - INFO - run_control_simulation:369 -   Action: 0.000000
386.0s 4596 2025-10-10 10:59:14 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
386.7s 4597 [WARNING] Automatic CFL correction applied (count: 27300):
386.7s 4598 Calculated CFL: 0.800 > Limit: 0.500
386.7s 4599 Original dt: 4.114980e-01 s
386.7s 4600 Corrected dt: 2.571863e-01 s
386.7s 4601 Correction factor: 1.6x
386.7s 4602 Max wave speed detected: 19.44 m/s
387.6s 4603 [WARNING] Automatic CFL correction applied (count: 27400):
387.6s 4604 Calculated CFL: 0.800 > Limit: 0.500
387.6s 4605 Original dt: 4.114980e-01 s
387.6s 4606 Corrected dt: 2.571863e-01 s
387.6s 4607 Correction factor: 1.6x
387.6s 4608 Max wave speed detected: 19.44 m/s
388.1s 4609 2025-10-10 10:59:16 - INFO - run_control_simulation:382 -   Reward: 0.015200
388.1s 4610 2025-10-10 10:59:16 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
388.1s 4611 2025-10-10 10:59:16 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
388.1s 4612 2025-10-10 10:59:16 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
388.1s 4613 2025-10-10 10:59:16 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
388.1s 4614 2025-10-10 10:59:16 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
388.1s 4615 2025-10-10 10:59:16 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
388.1s 4616 2025-10-10 10:59:16 - INFO - run_control_simulation:416 -   State hash: 5170874659261337643
388.1s 4617 2025-10-10 10:59:16 - INFO - run_control_simulation:418 - ================================================================================
388.1s 4618 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
388.1s 4619 2025-10-10 10:59:16 - INFO - run_control_simulation:366 - ================================================================================
388.1s 4620 2025-10-10 10:59:16 - INFO - run_control_simulation:367 - STEP 8 START:
388.1s 4621 2025-10-10 10:59:16 - INFO - run_control_simulation:368 -   Controller: RLController
388.1s 4622 2025-10-10 10:59:16 - INFO - run_control_simulation:369 -   Action: 0.000000
388.1s 4623 2025-10-10 10:59:16 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
388.5s 4624 [WARNING] Automatic CFL correction applied (count: 27500):
388.5s 4625 Calculated CFL: 0.800 > Limit: 0.500
388.5s 4626 Original dt: 4.114980e-01 s
388.5s 4627 Corrected dt: 2.571863e-01 s
388.5s 4628 Correction factor: 1.6x
388.5s 4629 Max wave speed detected: 19.44 m/s
389.4s 4630 [WARNING] Automatic CFL correction applied (count: 27600):
389.4s 4631 Calculated CFL: 0.800 > Limit: 0.500
389.4s 4632 Original dt: 4.114980e-01 s
389.4s 4633 Corrected dt: 2.571863e-01 s
389.4s 4634 Correction factor: 1.6x
389.4s 4635 Max wave speed detected: 19.44 m/s
390.3s 4636 2025-10-10 10:59:19 - INFO - run_control_simulation:382 -   Reward: 0.015200
390.3s 4637 2025-10-10 10:59:19 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
390.3s 4638 2025-10-10 10:59:19 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
390.3s 4639 2025-10-10 10:59:19 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
390.3s 4640 2025-10-10 10:59:19 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
390.3s 4641 2025-10-10 10:59:19 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
390.3s 4642 2025-10-10 10:59:19 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
390.3s 4643 2025-10-10 10:59:19 - INFO - run_control_simulation:416 -   State hash: -2575495786081034279
390.3s 4644 2025-10-10 10:59:19 - INFO - run_control_simulation:418 - ================================================================================
390.3s 4645 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
390.3s 4646 2025-10-10 10:59:19 - INFO - run_control_simulation:366 - ================================================================================
390.3s 4647 2025-10-10 10:59:19 - INFO - run_control_simulation:367 - STEP 9 START:
390.3s 4648 2025-10-10 10:59:19 - INFO - run_control_simulation:368 -   Controller: RLController
390.3s 4649 2025-10-10 10:59:19 - INFO - run_control_simulation:369 -   Action: 0.000000
390.3s 4650 2025-10-10 10:59:19 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
390.4s 4651 [WARNING] Automatic CFL correction applied (count: 27700):
390.4s 4652 Calculated CFL: 0.800 > Limit: 0.500
390.4s 4653 Original dt: 4.114980e-01 s
390.4s 4654 Corrected dt: 2.571863e-01 s
390.4s 4655 Correction factor: 1.6x
390.4s 4656 Max wave speed detected: 19.44 m/s
391.3s 4657 [WARNING] Automatic CFL correction applied (count: 27800):
391.3s 4658 Calculated CFL: 0.800 > Limit: 0.500
391.3s 4659 Original dt: 4.114980e-01 s
391.3s 4660 Corrected dt: 2.571863e-01 s
391.3s 4661 Correction factor: 1.6x
391.3s 4662 Max wave speed detected: 19.44 m/s
392.2s 4663 [WARNING] Automatic CFL correction applied (count: 27900):
392.2s 4664 Calculated CFL: 0.800 > Limit: 0.500
392.2s 4665 Original dt: 4.114980e-01 s
392.2s 4666 Corrected dt: 2.571863e-01 s
392.2s 4667 Correction factor: 1.6x
392.2s 4668 Max wave speed detected: 19.44 m/s
392.4s 4669 2025-10-10 10:59:21 - INFO - run_control_simulation:382 -   Reward: 0.015200
392.4s 4670 2025-10-10 10:59:21 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
392.4s 4671 2025-10-10 10:59:21 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
392.4s 4672 2025-10-10 10:59:21 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
392.4s 4673 2025-10-10 10:59:21 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
392.4s 4674 2025-10-10 10:59:21 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
392.4s 4675 2025-10-10 10:59:21 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
392.4s 4676 2025-10-10 10:59:21 - INFO - run_control_simulation:416 -   State hash: 6864456640015314433
392.4s 4677 2025-10-10 10:59:21 - INFO - run_control_simulation:418 - ================================================================================
392.4s 4678 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
392.4s 4679 
392.4s 4680 [SIMULATION COMPLETED] Summary:
392.4s 4681 - Total control steps: 10
392.4s 4682 - Total reward: 0.15
392.4s 4683 - Avg step time: 2.142s (device=gpu)
392.4s 4684 - Simulated time: 600.0s / 600.0s
392.4s 4685 - Wallclock time: 21.4s
392.4s 4686 - Speed ratio: 28.01x real-time
392.4s 4687 
392.4s 4688 2025-10-10 10:59:21 - INFO - run_control_simulation:453 -
392.4s 4689 [SIMULATION COMPLETED] Summary:
392.4s 4690 - Total control steps: 10
392.4s 4691 - Total reward: 0.15
392.4s 4692 - Avg step time: 2.142s (device=gpu)
392.4s 4693 - Simulated time: 600.0s / 600.0s
392.4s 4694 - Wallclock time: 21.4s
392.4s 4695 - Speed ratio: 28.01x real-time
392.4s 4696 
392.4s 4697 2025-10-10 10:59:21 - INFO - run_control_simulation:454 - Returning 10 state snapshots
392.4s 4698 2025-10-10 10:59:21 - INFO - run_performance_comparison:760 - RL states copied: 10 snapshots
392.4s 4699 2025-10-10 10:59:21 - INFO - run_performance_comparison:761 - RL FIRST state hash: 8244144800744263245
392.4s 4700 2025-10-10 10:59:21 - INFO - run_performance_comparison:762 - RL LAST state hash: 6864456640015314433
392.4s 4701 2025-10-10 10:59:21 - INFO - run_performance_comparison:763 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
392.4s 4702 2.14351577e-05]
392.4s 4703 2025-10-10 10:59:21 - INFO - run_performance_comparison:764 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
392.4s 4704 2.14319923e-05]
392.4s 4705 2025-10-10 10:59:21 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
392.4s 4706 2025-10-10 10:59:21 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=8244144800744263245, last=6864456640015314433
392.4s 4707 2025-10-10 10:59:21 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
392.4s 4708 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
392.4s 4709 2025-10-10 10:59:21 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
392.4s 4710 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
392.4s 4711 2025-10-10 10:59:21 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
392.4s 4712 2025-10-10 10:59:21 - WARNING - run_performance_comparison:772 - States comparison - Identical: False, baseline_hash=416565544957933046, rl_hash=8244144800744263245
392.4s 4713 2025-10-10 10:59:21 - INFO - run_performance_comparison:781 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
392.4s 4714 2025-10-10 10:59:21 - INFO - run_performance_comparison:782 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
392.4s 4715 2025-10-10 10:59:21 - INFO - run_performance_comparison:790 - Flow improvement: 0.000%
392.4s 4716 2025-10-10 10:59:21 - INFO - run_performance_comparison:791 - Efficiency improvement: 0.000%
392.4s 4717 2025-10-10 10:59:21 - INFO - run_performance_comparison:792 - Delay reduction: -0.000%
392.4s 4718 Flow improvement: 0.0%
392.4s 4719 Efficiency improvement: 0.0%
392.4s 4720 Delay reduction: -0.0%
392.4s 4721 Result: FAILED
392.4s 4722 
392.4s 4723 [FIGURES] Generating RL performance figures...
393.0s 4724 [OK] fig_rl_performance_improvements.png
393.6s 4725 [OK] fig_rl_learning_curve.png
393.6s 4726 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
393.6s 4727 
393.6s 4728 [METRICS] Saving RL performance metrics...
393.6s 4729 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
393.6s 4730 
393.6s 4731 [LATEX] Generating content for Section 7.6...
393.6s 4732 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
393.6s 4733 
393.6s 4734 === RL Performance Validation Summary ===
393.6s 4735 Scenarios passed: 0/1 (0.0%)
393.6s 4736 Average flow improvement: 0.00%
393.6s 4737 Average efficiency improvement: 0.00%
393.6s 4738 Average delay reduction: 0.00%
393.6s 4739 Overall validation: FAILED
393.6s 4740 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
396.5s 4741 [WARNING] Tests returned code: 1
396.5s 4742 
396.5s 4743 [STEP 4/4] Copying artifacts and cleaning up...
396.5s 4744 [ARTIFACTS] Copying results for section_7_6_rl_performance...
396.5s 4745 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
396.5s 4746 [ARTIFACTS] NPZ files: 0
396.5s 4747 [ARTIFACTS] PNG figures: 2
396.5s 4748 [ARTIFACTS] YAML scenarios: 1
396.5s 4749 [ARTIFACTS] TEX files: 1
396.5s 4750 [ARTIFACTS] JSON files: 1
396.5s 4751 [ARTIFACTS] CSV metrics: 1
396.5s 4752 TRACKING_SUCCESS: Artifacts copied
396.5s 4753 [SUCCESS] All artifacts organized and copied
396.5s 4754 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
396.6s 4755 [OK] Cleanup completed - only validation results remain
396.6s 4756 TRACKING_SUCCESS: Cleanup completed
396.6s 4757 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
396.6s 4758 TRACKING_SUCCESS: Session summary created
396.6s 4759 
396.6s 4760 [FINAL] Validation workflow completed
396.6s 4761 Remote logging finalized - ready for download
396.6s 4762 
396.6s 4763 ================================================================================
396.6s 4764 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
396.6s 4765 Output ready at: /kaggle/working/validation_results/
396.6s 4766 ================================================================================
400.1s 4767 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
400.1s 4768 warn(
400.1s 4769 [NbConvertApp] Converting notebook __script__.ipynb to html
400.9s 4770 [NbConvertApp] Writing 321270 bytes to __results__.html