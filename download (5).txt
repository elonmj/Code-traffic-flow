0.4s 1 ================================================================================
0.4s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.4s 3 Revendications: R5
0.4s 4 ================================================================================
0.4s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.4s 6 Branch: main
4.4s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
4.4s 8 PyTorch: 2.6.0+cu124
4.5s 9 CUDA available: True
4.5s 10 CUDA device: Tesla P100-PCIE-16GB
4.5s 11 CUDA version: 12.4
4.5s 12 
4.5s 13 [STEP 1/4] Cloning repository from GitHub...
4.5s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
9.3s 15 [OK] Repository cloned successfully
9.3s 16 TRACKING_SUCCESS: Repository cloned
9.3s 17 
9.3s 18 [STEP 2/4] Installing dependencies...
9.3s 19 Installing PyYAML...
13.6s 20 Installing matplotlib...
16.6s 21 Installing pandas...
19.5s 22 Installing scipy...
22.5s 23 Installing numpy...
25.4s 24 Installing gymnasium...
28.4s 25 Installing stable-baselines3...
95.9s 26 [OK] Dependencies installed
95.9s 27 TRACKING_SUCCESS: Dependencies ready
95.9s 28 
95.9s 29 [STEP 3/4] Running validation tests...
95.9s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
95.9s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
95.9s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
95.9s 33 ============================================================
106.9s 34 2025-10-10 10:20:31.957196: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
107.1s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
107.1s 36 E0000 00:00:1760091632.149335      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
107.1s 37 E0000 00:00:1760091632.202581      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
118.6s 38 ================================================================================
118.6s 39 QUICK TEST MODE ENABLED
118.6s 40 - Training: 2 timesteps only
118.6s 41 - Duration: 2 minutes simulated time
118.6s 42 - Scenarios: 1 scenario only
118.6s 43 - Expected runtime: ~5 minutes on GPU
118.6s 44 ================================================================================
118.6s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
118.6s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
118.6s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
118.6s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
118.6s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
118.6s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
118.6s 51 2025-10-10 10:20:43 - INFO - _setup_debug_logging:119 - ================================================================================
118.6s 52 2025-10-10 10:20:43 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
118.6s 53 2025-10-10 10:20:43 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
118.6s 54 2025-10-10 10:20:43 - INFO - _setup_debug_logging:122 - Quick test mode: True
118.6s 55 2025-10-10 10:20:43 - INFO - _setup_debug_logging:123 - ================================================================================
118.6s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
118.6s 57 === Section 7.6: RL Performance Validation ===
118.6s 58 Testing RL agent performance vs baseline controllers...
118.7s 59 [DEVICE] Detected: GPU
118.8s 60 [GPU INFO] Tesla P100-PCIE-16GB
118.8s 61 
118.8s 62 [PHASE 1/2] Training RL agents...
118.8s 63 [QUICK TEST] Training only: traffic_light_control
118.8s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
118.8s 65 2025-10-10 10:20:43 - INFO - train_rl_agent:560 - ================================================================================
118.8s 66 2025-10-10 10:20:43 - INFO - train_rl_agent:561 - Starting train_rl_agent for scenario: traffic_light_control
118.8s 67 2025-10-10 10:20:43 - INFO - train_rl_agent:562 -   - Device: gpu
118.8s 68 2025-10-10 10:20:43 - INFO - train_rl_agent:563 -   - Total timesteps: 100
118.8s 69 2025-10-10 10:20:43 - INFO - train_rl_agent:564 -   - Episode max time: 120.0s
118.8s 70 2025-10-10 10:20:43 - INFO - train_rl_agent:565 -   - Checkpoint frequency: 50
118.8s 71 2025-10-10 10:20:43 - INFO - train_rl_agent:566 - ================================================================================
118.8s 72 
118.8s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
118.8s 74 Device: gpu
118.8s 75 Total timesteps: 100
118.8s 76 Episode max time: 120.0s
118.8s 77 Checkpoint frequency: 50 steps
118.8s 78 2025-10-10 10:20:43 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
118.8s 79 2025-10-10 10:20:43 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
118.8s 80 2025-10-10 10:20:43 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
118.8s 81 2025-10-10 10:20:43 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
118.8s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
118.8s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
118.8s 84 Using device: gpu
118.8s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
118.8s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
118.8s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
118.8s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
118.8s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
118.8s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
118.8s 91 Loading road quality type: uniform
118.8s 92 Uniform road quality value: 2
118.8s 93 Road quality loaded.
118.8s 94 Initial state created.
118.8s 95 Transferring initial state and road quality to GPU...
118.8s 96 GPU data transfer complete.
118.8s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
118.8s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
118.8s 99 warn(NumbaPerformanceWarning(msg))
120.2s 100 Initial boundary conditions applied.
120.2s 101 TrafficSignalEnvDirect initialized:
120.2s 102 Decision interval: 60.0s
120.2s 103 Observation segments: 6
120.2s 104 Observation space: (26,)
120.2s 105 Action space: 2
120.2s 106 Device: gpu
120.2s 107 [INFO] Environment created: obs_space=(26,), action_space=2
120.2s 108 [INFO] Initializing PPO agent from scratch...
120.3s 109 Using cuda device
120.3s 110 Wrapping the env with a `Monitor` wrapper
120.3s 111 Wrapping the env in a DummyVecEnv.
120.3s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
120.3s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
120.3s 114 Info: (n_steps=100 and n_envs=1)
120.3s 115 warnings.warn(
124.8s 116 
124.8s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
124.8s 118 [INFO] Training for 100 timesteps...
124.8s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
124.8s 120 Using device: gpu
124.8s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
124.8s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
124.8s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
124.8s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
124.8s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
124.8s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
124.8s 127 Loading road quality type: uniform
124.8s 128 Uniform road quality value: 2
124.8s 129 Road quality loaded.
124.8s 130 Initial state created.
124.8s 131 Transferring initial state and road quality to GPU...
124.8s 132 GPU data transfer complete.
124.8s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
124.8s 134 Initial boundary conditions applied.
124.8s 135 [BC UPDATE] left → phase 0 (outflow)
124.8s 136 └─ Outflow: zero-order extrapolation
124.8s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
124.8s 138 
124.8s 139 🚀 Training started: 100 total timesteps
125.4s 140 Running simulation until t = 60.00 s, outputting every 60.00 s
125.4s 141 
125.4s 142 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.4s 143 warn(NumbaPerformanceWarning(msg))
126.2s 144 [WARNING] Automatic CFL correction applied (count: 1):
126.2s 145 Calculated CFL: 0.800 > Limit: 0.500
126.2s 146 Original dt: 3.228311e-01 s
126.2s 147 Corrected dt: 2.017695e-01 s
126.2s 148 Correction factor: 1.6x
126.2s 149 Max wave speed detected: 24.78 m/s
126.4s 150 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.4s 151 warn(NumbaPerformanceWarning(msg))
126.7s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.7s 153 warn(NumbaPerformanceWarning(msg))
126.8s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.8s 155 warn(NumbaPerformanceWarning(msg))
126.8s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.8s 157 warn(NumbaPerformanceWarning(msg))
127.3s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.3s 159 warn(NumbaPerformanceWarning(msg))
127.3s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.3s 161 warn(NumbaPerformanceWarning(msg))
127.4s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.4s 163 warn(NumbaPerformanceWarning(msg))
127.5s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.5s 165 warn(NumbaPerformanceWarning(msg))
127.6s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.6s 167 warn(NumbaPerformanceWarning(msg))
127.7s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.7s 169 warn(NumbaPerformanceWarning(msg))
127.7s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.7s 171 warn(NumbaPerformanceWarning(msg))
128.2s 172 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
128.7s 173 [WARNING] Automatic CFL correction applied (count: 100):
128.7s 174 Calculated CFL: 0.800 > Limit: 0.500
128.7s 175 Original dt: 4.145004e-01 s
128.7s 176 Corrected dt: 2.590627e-01 s
128.7s 177 Correction factor: 1.6x
128.7s 178 Max wave speed detected: 19.30 m/s
128.7s 179 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
129.2s 180 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
129.6s 181 [WARNING] Automatic CFL correction applied (count: 200):
129.6s 182 Calculated CFL: 0.800 > Limit: 0.500
129.6s 183 Original dt: 4.115380e-01 s
129.6s 184 Corrected dt: 2.572113e-01 s
129.6s 185 Correction factor: 1.6x
129.6s 186 Max wave speed detected: 19.44 m/s
129.6s 187 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
129.9s 188 
129.9s 189 [A
129.9s 190 Stored output at t = 60.0000 s (Step 231)
129.9s 191 
129.9s 192 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.12s/s]
129.9s 193 Simulation finished at t = 60.0000 s after 231 steps.
129.9s 194 Total runtime: 4.58 seconds.
129.9s 195 [BC UPDATE] left → phase 1 (inflow)
129.9s 196 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
129.9s 197 Running simulation until t = 120.00 s, outputting every 60.00 s
129.9s 198 
130.1s 199 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
130.6s 200 [WARNING] Automatic CFL correction applied (count: 300):
130.6s 201 Calculated CFL: 0.800 > Limit: 0.500
130.6s 202 Original dt: 4.114988e-01 s
130.6s 203 Corrected dt: 2.571867e-01 s
130.6s 204 Correction factor: 1.6x
130.6s 205 Max wave speed detected: 19.44 m/s
130.6s 206 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
131.1s 207 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
131.5s 208 [WARNING] Automatic CFL correction applied (count: 400):
131.5s 209 Calculated CFL: 0.800 > Limit: 0.500
131.5s 210 Original dt: 4.114980e-01 s
131.5s 211 Corrected dt: 2.571863e-01 s
131.5s 212 Correction factor: 1.6x
131.5s 213 Max wave speed detected: 19.44 m/s
131.5s 214 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
132.0s 215 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
132.2s 216 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
132.2s 217 [A
132.2s 218 Stored output at t = 120.0000 s (Step 465)
132.2s 219 
132.2s 220 Simulation finished at t = 120.0000 s after 465 steps.
132.2s 221 Total runtime: 2.24 seconds.
132.2s 222 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.78s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.77s/s]
132.2s 223 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
132.2s 224 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
132.2s 225 Using device: gpu
132.2s 226 DEBUG PARAMS: Reading K_m_kmh = 10.0
132.2s 227 DEBUG PARAMS: Reading K_c_kmh = 15.0
132.2s 228 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
132.2s 229 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
132.2s 230 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
132.2s 231 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
132.2s 232 Loading road quality type: uniform
132.2s 233 Uniform road quality value: 2
132.2s 234 Road quality loaded.
132.2s 235 Initial state created.
132.2s 236 Transferring initial state and road quality to GPU...
132.2s 237 GPU data transfer complete.
132.2s 238 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
132.2s 239 Initial boundary conditions applied.
132.2s 240 [BC UPDATE] left → phase 0 (outflow)
132.2s 241 └─ Outflow: zero-order extrapolation
132.2s 242 Running simulation until t = 60.00 s, outputting every 60.00 s
132.2s 243 
132.5s 244 [WARNING] Automatic CFL correction applied (count: 500):
132.5s 245 Calculated CFL: 0.800 > Limit: 0.500
132.5s 246 Original dt: 4.758816e-01 s
132.5s 247 Corrected dt: 2.974260e-01 s
132.5s 248 Correction factor: 1.6x
132.5s 249 Max wave speed detected: 16.81 m/s
132.7s 250 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
133.2s 251 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
133.5s 252 [WARNING] Automatic CFL correction applied (count: 600):
133.5s 253 Calculated CFL: 0.800 > Limit: 0.500
133.5s 254 Original dt: 4.121510e-01 s
133.5s 255 Corrected dt: 2.575944e-01 s
133.5s 256 Correction factor: 1.6x
133.5s 257 Max wave speed detected: 19.41 m/s
133.6s 258 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
134.1s 259 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
134.4s 260 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
134.4s 261 [A
134.4s 262 Stored output at t = 60.0000 s (Step 231)
134.4s 263 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s]
134.4s 264 
134.4s 265 Simulation finished at t = 60.0000 s after 231 steps.
134.4s 266 Total runtime: 2.17 seconds.
134.4s 267 Running simulation until t = 120.00 s, outputting every 60.00 s
134.4s 268 
134.4s 269 [WARNING] Automatic CFL correction applied (count: 700):
134.4s 270 Calculated CFL: 0.800 > Limit: 0.500
134.4s 271 Original dt: 4.115082e-01 s
134.4s 272 Corrected dt: 2.571926e-01 s
134.4s 273 Correction factor: 1.6x
134.4s 274 Max wave speed detected: 19.44 m/s
134.6s 275 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
135.0s 276 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
135.3s 277 [WARNING] Automatic CFL correction applied (count: 800):
135.3s 278 Calculated CFL: 0.800 > Limit: 0.500
135.3s 279 Original dt: 4.114982e-01 s
135.3s 280 Corrected dt: 2.571864e-01 s
135.3s 281 Correction factor: 1.6x
135.3s 282 Max wave speed detected: 19.44 m/s
135.5s 283 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
136.0s 284 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
136.3s 285 [WARNING] Automatic CFL correction applied (count: 900):
136.3s 286 Calculated CFL: 0.800 > Limit: 0.500
136.3s 287 Original dt: 4.114980e-01 s
136.3s 288 Corrected dt: 2.571863e-01 s
136.3s 289 Correction factor: 1.6x
136.3s 290 Max wave speed detected: 19.44 m/s
136.4s 291 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
136.6s 292 Stored output at t = 120.0000 s (Step 465)
136.6s 293 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
136.6s 294 [A
136.6s 295 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.22s/s]
136.6s 296 
136.6s 297 Simulation finished at t = 120.0000 s after 465 steps.
136.6s 298 Total runtime: 2.21 seconds.
136.6s 299 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
136.6s 300 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
136.6s 301 Using device: gpu
136.6s 302 DEBUG PARAMS: Reading K_m_kmh = 10.0
136.6s 303 DEBUG PARAMS: Reading K_c_kmh = 15.0
136.6s 304 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
136.6s 305 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
136.6s 306 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
136.6s 307 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
136.6s 308 Loading road quality type: uniform
136.6s 309 Uniform road quality value: 2
136.6s 310 Road quality loaded.
136.6s 311 Initial state created.
136.6s 312 Transferring initial state and road quality to GPU...
136.6s 313 GPU data transfer complete.
136.6s 314 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
136.6s 315 Initial boundary conditions applied.
136.6s 316 [BC UPDATE] left → phase 0 (outflow)
136.6s 317 └─ Outflow: zero-order extrapolation
136.6s 318 [BC UPDATE] left → phase 1 (inflow)
136.6s 319 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
136.6s 320 Running simulation until t = 60.00 s, outputting every 60.00 s
136.6s 321 
137.1s 322 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
137.3s 323 [WARNING] Automatic CFL correction applied (count: 1000):
137.3s 324 Calculated CFL: 0.800 > Limit: 0.500
137.3s 325 Original dt: 4.225636e-01 s
137.3s 326 Corrected dt: 2.641023e-01 s
137.3s 327 Correction factor: 1.6x
137.3s 328 Max wave speed detected: 18.93 m/s
137.5s 329 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
138.0s 330 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
138.2s 331 [WARNING] Automatic CFL correction applied (count: 1100):
138.2s 332 Calculated CFL: 0.800 > Limit: 0.500
138.2s 333 Original dt: 4.116395e-01 s
138.2s 334 Corrected dt: 2.572747e-01 s
138.2s 335 Correction factor: 1.6x
138.2s 336 Max wave speed detected: 19.43 m/s
138.5s 337 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
138.7s 338 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
138.7s 339 [A
138.7s 340 Stored output at t = 60.0000 s (Step 231)
138.7s 341 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s]
138.7s 342 
138.7s 343 Simulation finished at t = 60.0000 s after 231 steps.
138.7s 344 Total runtime: 2.14 seconds.
138.7s 345 Running simulation until t = 120.00 s, outputting every 60.00 s
138.7s 346 
138.9s 347 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
139.1s 348 [WARNING] Automatic CFL correction applied (count: 1200):
139.1s 349 Calculated CFL: 0.800 > Limit: 0.500
139.1s 350 Original dt: 4.115005e-01 s
139.1s 351 Corrected dt: 2.571878e-01 s
139.1s 352 Correction factor: 1.6x
139.1s 353 Max wave speed detected: 19.44 m/s
139.4s 354 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
139.9s 355 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
140.0s 356 [WARNING] Automatic CFL correction applied (count: 1300):
140.0s 357 Calculated CFL: 0.800 > Limit: 0.500
140.0s 358 Original dt: 4.114981e-01 s
140.0s 359 Corrected dt: 2.571863e-01 s
140.0s 360 Correction factor: 1.6x
140.0s 361 Max wave speed detected: 19.44 m/s
140.3s 362 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
140.8s 363 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
140.9s 364 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
140.9s 365 [A
140.9s 366 Stored output at t = 120.0000 s (Step 465)
140.9s 367 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.51s/s]
140.9s 368 
140.9s 369 Simulation finished at t = 120.0000 s after 465 steps.
140.9s 370 Total runtime: 2.18 seconds.
140.9s 371 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
140.9s 372 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
140.9s 373 Using device: gpu
140.9s 374 DEBUG PARAMS: Reading K_m_kmh = 10.0
140.9s 375 DEBUG PARAMS: Reading K_c_kmh = 15.0
140.9s 376 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
140.9s 377 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
140.9s 378 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
140.9s 379 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
140.9s 380 Loading road quality type: uniform
140.9s 381 Uniform road quality value: 2
140.9s 382 Road quality loaded.
140.9s 383 Initial state created.
140.9s 384 Transferring initial state and road quality to GPU...
140.9s 385 GPU data transfer complete.
140.9s 386 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
140.9s 387 Initial boundary conditions applied.
140.9s 388 [BC UPDATE] left → phase 0 (outflow)
140.9s 389 └─ Outflow: zero-order extrapolation
140.9s 390 [BC UPDATE] left → phase 1 (inflow)
140.9s 391 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
140.9s 392 Running simulation until t = 60.00 s, outputting every 60.00 s
140.9s 393 
141.0s 394 [WARNING] Automatic CFL correction applied (count: 1400):
141.0s 395 Calculated CFL: 0.800 > Limit: 0.500
141.0s 396 Original dt: 3.451280e-01 s
141.0s 397 Corrected dt: 2.157050e-01 s
141.0s 398 Correction factor: 1.6x
141.0s 399 Max wave speed detected: 23.18 m/s
141.4s 400 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
141.9s 401 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
142.0s 402 [WARNING] Automatic CFL correction applied (count: 1500):
142.0s 403 Calculated CFL: 0.800 > Limit: 0.500
142.0s 404 Original dt: 4.139892e-01 s
142.0s 405 Corrected dt: 2.587433e-01 s
142.0s 406 Correction factor: 1.6x
142.0s 407 Max wave speed detected: 19.32 m/s
142.5s 408 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
142.9s 409 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
143.0s 410 [WARNING] Automatic CFL correction applied (count: 1600):
143.0s 411 Calculated CFL: 0.800 > Limit: 0.500
143.0s 412 Original dt: 4.115314e-01 s
143.0s 413 Corrected dt: 2.572071e-01 s
143.0s 414 Correction factor: 1.6x
143.0s 415 Max wave speed detected: 19.44 m/s
143.2s 416 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
143.2s 417 [A
143.2s 418 Stored output at t = 60.0000 s (Step 231)
143.2s 419 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.53s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.53s/s]
143.2s 420 
143.2s 421 Simulation finished at t = 60.0000 s after 231 steps.
143.2s 422 Total runtime: 2.26 seconds.
143.2s 423 Running simulation until t = 120.00 s, outputting every 60.00 s
143.2s 424 
143.4s 425 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
143.9s 426 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
143.9s 427 [WARNING] Automatic CFL correction applied (count: 1700):
143.9s 428 Calculated CFL: 0.800 > Limit: 0.500
143.9s 429 Original dt: 4.114986e-01 s
143.9s 430 Corrected dt: 2.571866e-01 s
143.9s 431 Correction factor: 1.6x
143.9s 432 Max wave speed detected: 19.44 m/s
144.3s 433 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
144.8s 434 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
144.8s 435 [WARNING] Automatic CFL correction applied (count: 1800):
144.8s 436 Calculated CFL: 0.800 > Limit: 0.500
144.8s 437 Original dt: 4.114980e-01 s
144.8s 438 Corrected dt: 2.571863e-01 s
144.8s 439 Correction factor: 1.6x
144.8s 440 Max wave speed detected: 19.44 m/s
145.3s 441 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
145.4s 442 Stored output at t = 120.0000 s (Step 465)
145.4s 443 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
145.4s 444 [A
145.4s 445 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s]
145.4s 446 
145.4s 447 Simulation finished at t = 120.0000 s after 465 steps.
145.4s 448 Total runtime: 2.21 seconds.
145.4s 449 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
145.4s 450 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
145.4s 451 Using device: gpu
145.4s 452 DEBUG PARAMS: Reading K_m_kmh = 10.0
145.4s 453 DEBUG PARAMS: Reading K_c_kmh = 15.0
145.4s 454 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
145.4s 455 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
145.4s 456 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
145.4s 457 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
145.4s 458 Loading road quality type: uniform
145.4s 459 Uniform road quality value: 2
145.4s 460 Road quality loaded.
145.4s 461 Initial state created.
145.4s 462 Transferring initial state and road quality to GPU...
145.4s 463 GPU data transfer complete.
145.4s 464 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
145.4s 465 Initial boundary conditions applied.
145.4s 466 [BC UPDATE] left → phase 0 (outflow)
145.4s 467 └─ Outflow: zero-order extrapolation
145.4s 468 Running simulation until t = 60.00 s, outputting every 60.00 s
145.4s 469 
145.8s 470 [WARNING] Automatic CFL correction applied (count: 1900):
145.8s 471 Calculated CFL: 0.800 > Limit: 0.500
145.8s 472 Original dt: 4.583403e-01 s
145.8s 473 Corrected dt: 2.864627e-01 s
145.8s 474 Correction factor: 1.6x
145.8s 475 Max wave speed detected: 17.45 m/s
145.9s 476 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
146.4s 477 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
146.8s 478 [WARNING] Automatic CFL correction applied (count: 2000):
146.8s 479 Calculated CFL: 0.800 > Limit: 0.500
146.8s 480 Original dt: 4.120137e-01 s
146.8s 481 Corrected dt: 2.575085e-01 s
146.8s 482 Correction factor: 1.6x
146.8s 483 Max wave speed detected: 19.42 m/s
146.9s 484 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
147.3s 485 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
147.7s 486 Stored output at t = 60.0000 s (Step 231)
147.7s 487 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
147.7s 488 [A
147.7s 489 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.03s/s]
147.7s 490 
147.7s 491 Simulation finished at t = 60.0000 s after 231 steps.
147.7s 492 Total runtime: 2.22 seconds.
147.7s 493 Running simulation until t = 120.00 s, outputting every 60.00 s
147.7s 494 
147.7s 495 [WARNING] Automatic CFL correction applied (count: 2100):
147.7s 496 Calculated CFL: 0.800 > Limit: 0.500
147.7s 497 Original dt: 4.115064e-01 s
147.7s 498 Corrected dt: 2.571915e-01 s
147.7s 499 Correction factor: 1.6x
147.7s 500 Max wave speed detected: 19.44 m/s
147.8s 501 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
148.3s 502 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
148.7s 503 [WARNING] Automatic CFL correction applied (count: 2200):
148.7s 504 Calculated CFL: 0.800 > Limit: 0.500
148.7s 505 Original dt: 4.114982e-01 s
148.7s 506 Corrected dt: 2.571864e-01 s
148.7s 507 Correction factor: 1.6x
148.7s 508 Max wave speed detected: 19.44 m/s
148.8s 509 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
149.2s 510 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
149.6s 511 [WARNING] Automatic CFL correction applied (count: 2300):
149.6s 512 Calculated CFL: 0.800 > Limit: 0.500
149.6s 513 Original dt: 4.114980e-01 s
149.6s 514 Corrected dt: 2.571863e-01 s
149.6s 515 Correction factor: 1.6x
149.6s 516 Max wave speed detected: 19.44 m/s
149.7s 517 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
149.8s 518 Stored output at t = 120.0000 s (Step 465)
149.8s 519 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
149.8s 520 [A
149.8s 521 
149.8s 522 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s]
149.8s 523 Simulation finished at t = 120.0000 s after 465 steps.
149.8s 524 Total runtime: 2.18 seconds.
149.8s 525 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
149.8s 526 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
149.8s 527 Using device: gpu
149.9s 528 DEBUG PARAMS: Reading K_m_kmh = 10.0
149.9s 529 DEBUG PARAMS: Reading K_c_kmh = 15.0
149.9s 530 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
149.9s 531 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
149.9s 532 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
149.9s 533 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
149.9s 534 Loading road quality type: uniform
149.9s 535 Uniform road quality value: 2
149.9s 536 Road quality loaded.
149.9s 537 Initial state created.
149.9s 538 Transferring initial state and road quality to GPU...
149.9s 539 GPU data transfer complete.
149.9s 540 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
149.9s 541 Initial boundary conditions applied.
149.9s 542 [BC UPDATE] left → phase 0 (outflow)
149.9s 543 └─ Outflow: zero-order extrapolation
149.9s 544 [BC UPDATE] left → phase 1 (inflow)
149.9s 545 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
149.9s 546 Running simulation until t = 60.00 s, outputting every 60.00 s
149.9s 547 
150.3s 548 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
150.6s 549 [WARNING] Automatic CFL correction applied (count: 2400):
150.6s 550 Calculated CFL: 0.800 > Limit: 0.500
150.6s 551 Original dt: 4.205139e-01 s
150.6s 552 Corrected dt: 2.628212e-01 s
150.6s 553 Correction factor: 1.6x
150.6s 554 Max wave speed detected: 19.02 m/s
150.8s 555 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
151.3s 556 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
151.5s 557 [WARNING] Automatic CFL correction applied (count: 2500):
151.5s 558 Calculated CFL: 0.800 > Limit: 0.500
151.5s 559 Original dt: 4.116141e-01 s
151.5s 560 Corrected dt: 2.572588e-01 s
151.5s 561 Correction factor: 1.6x
151.5s 562 Max wave speed detected: 19.44 m/s
151.7s 563 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
152.1s 564 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
152.1s 565 [A
152.1s 566 Stored output at t = 60.0000 s (Step 231)
152.1s 567 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.28s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s]
152.1s 568 
152.1s 569 Simulation finished at t = 60.0000 s after 231 steps.
152.1s 570 Total runtime: 2.20 seconds.
152.1s 571 Running simulation until t = 120.00 s, outputting every 60.00 s
152.1s 572 
152.2s 573 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
152.5s 574 [WARNING] Automatic CFL correction applied (count: 2600):
152.5s 575 Calculated CFL: 0.800 > Limit: 0.500
152.5s 576 Original dt: 4.115000e-01 s
152.5s 577 Corrected dt: 2.571875e-01 s
152.5s 578 Correction factor: 1.6x
152.5s 579 Max wave speed detected: 19.44 m/s
152.7s 580 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
153.2s 581 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
153.4s 582 [WARNING] Automatic CFL correction applied (count: 2700):
153.4s 583 Calculated CFL: 0.800 > Limit: 0.500
153.4s 584 Original dt: 4.114981e-01 s
153.4s 585 Corrected dt: 2.571863e-01 s
153.4s 586 Correction factor: 1.6x
153.4s 587 Max wave speed detected: 19.44 m/s
153.6s 588 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
154.1s 589 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
154.2s 590 Stored output at t = 120.0000 s (Step 465)
154.2s 591 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
154.2s 592 [A
154.2s 593 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s]
154.2s 594 
154.2s 595 Simulation finished at t = 120.0000 s after 465 steps.
154.2s 596 Total runtime: 2.17 seconds.
154.2s 597 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
154.2s 598 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
154.2s 599 Using device: gpu
154.2s 600 DEBUG PARAMS: Reading K_m_kmh = 10.0
154.2s 601 DEBUG PARAMS: Reading K_c_kmh = 15.0
154.2s 602 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
154.2s 603 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
154.2s 604 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
154.2s 605 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
154.2s 606 Loading road quality type: uniform
154.2s 607 Uniform road quality value: 2
154.2s 608 Road quality loaded.
154.2s 609 Initial state created.
154.2s 610 Transferring initial state and road quality to GPU...
154.2s 611 GPU data transfer complete.
154.2s 612 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
154.2s 613 Initial boundary conditions applied.
154.2s 614 [BC UPDATE] left → phase 0 (outflow)
154.2s 615 └─ Outflow: zero-order extrapolation
154.3s 616 Running simulation until t = 60.00 s, outputting every 60.00 s
154.3s 617 
154.3s 618 [WARNING] Automatic CFL correction applied (count: 2800):
154.3s 619 Calculated CFL: 0.800 > Limit: 0.500
154.3s 620 Original dt: 3.737254e-01 s
154.3s 621 Corrected dt: 2.335784e-01 s
154.3s 622 Correction factor: 1.6x
154.3s 623 Max wave speed detected: 21.41 m/s
154.7s 624 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
155.2s 625 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
155.3s 626 [WARNING] Automatic CFL correction applied (count: 2900):
155.3s 627 Calculated CFL: 0.800 > Limit: 0.500
155.3s 628 Original dt: 4.134305e-01 s
155.3s 629 Corrected dt: 2.583941e-01 s
155.3s 630 Correction factor: 1.6x
155.3s 631 Max wave speed detected: 19.35 m/s
155.6s 632 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
156.1s 633 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
156.2s 634 [WARNING] Automatic CFL correction applied (count: 3000):
156.2s 635 Calculated CFL: 0.800 > Limit: 0.500
156.2s 636 Original dt: 4.115259e-01 s
156.2s 637 Corrected dt: 2.572037e-01 s
156.2s 638 Correction factor: 1.6x
156.2s 639 Max wave speed detected: 19.44 m/s
156.4s 640 Stored output at t = 60.0000 s (Step 231)
156.4s 641 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
156.4s 642 [A
156.4s 643 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.96s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.96s/s]
156.4s 644 
156.4s 645 Simulation finished at t = 60.0000 s after 231 steps.
156.4s 646 Total runtime: 2.15 seconds.
156.4s 647 [BC UPDATE] left → phase 1 (inflow)
156.4s 648 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
156.4s 649 Running simulation until t = 120.00 s, outputting every 60.00 s
156.4s 650 
156.6s 651 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
157.0s 652 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
157.1s 653 [WARNING] Automatic CFL correction applied (count: 3100):
157.1s 654 Calculated CFL: 0.800 > Limit: 0.500
157.1s 655 Original dt: 4.114985e-01 s
157.1s 656 Corrected dt: 2.571866e-01 s
157.1s 657 Correction factor: 1.6x
157.1s 658 Max wave speed detected: 19.44 m/s
157.5s 659 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
158.0s 660 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
158.1s 661 [WARNING] Automatic CFL correction applied (count: 3200):
158.1s 662 Calculated CFL: 0.800 > Limit: 0.500
158.1s 663 Original dt: 4.114980e-01 s
158.1s 664 Corrected dt: 2.571863e-01 s
158.1s 665 Correction factor: 1.6x
158.1s 666 Max wave speed detected: 19.44 m/s
158.4s 667 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
158.6s 668 Stored output at t = 120.0000 s (Step 465)
158.6s 669 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
158.6s 670 [A
158.6s 671 
158.6s 672 Simulation finished at t = 120.0000 s after 465 steps.
158.6s 673 Total runtime: 2.18 seconds.
158.6s 674 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.51s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.51s/s]
158.6s 675 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
158.6s 676 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
158.6s 677 Using device: gpu
158.6s 678 DEBUG PARAMS: Reading K_m_kmh = 10.0
158.6s 679 DEBUG PARAMS: Reading K_c_kmh = 15.0
158.6s 680 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
158.6s 681 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
158.6s 682 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
158.6s 683 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
158.6s 684 Loading road quality type: uniform
158.6s 685 Uniform road quality value: 2
158.6s 686 Road quality loaded.
158.6s 687 Initial state created.
158.6s 688 Transferring initial state and road quality to GPU...
158.6s 689 GPU data transfer complete.
158.6s 690 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
158.6s 691 Initial boundary conditions applied.
158.6s 692 [BC UPDATE] left → phase 0 (outflow)
158.6s 693 └─ Outflow: zero-order extrapolation
158.6s 694 Running simulation until t = 60.00 s, outputting every 60.00 s
158.6s 695 
159.0s 696 [WARNING] Automatic CFL correction applied (count: 3300):
159.0s 697 Calculated CFL: 0.800 > Limit: 0.500
159.0s 698 Original dt: 4.470525e-01 s
159.0s 699 Corrected dt: 2.794078e-01 s
159.0s 700 Correction factor: 1.6x
159.0s 701 Max wave speed detected: 17.89 m/s
159.1s 702 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
159.5s 703 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
159.9s 704 [WARNING] Automatic CFL correction applied (count: 3400):
159.9s 705 Calculated CFL: 0.800 > Limit: 0.500
159.9s 706 Original dt: 4.119130e-01 s
159.9s 707 Corrected dt: 2.574456e-01 s
159.9s 708 Correction factor: 1.6x
159.9s 709 Max wave speed detected: 19.42 m/s
160.0s 710 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
160.5s 711 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
160.8s 712 Stored output at t = 60.0000 s (Step 231)
160.8s 713 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
160.8s 714 [A
160.8s 715 
160.8s 716 Simulation finished at t = 60.0000 s after 231 steps.
160.8s 717 Total runtime: 2.16 seconds.
160.8s 718 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s]
160.8s 719 [BC UPDATE] left → phase 1 (inflow)
160.8s 720 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
160.8s 721 Running simulation until t = 120.00 s, outputting every 60.00 s
160.8s 722 
160.9s 723 [WARNING] Automatic CFL correction applied (count: 3500):
160.9s 724 Calculated CFL: 0.800 > Limit: 0.500
160.9s 725 Original dt: 4.115046e-01 s
160.9s 726 Corrected dt: 2.571904e-01 s
160.9s 727 Correction factor: 1.6x
160.9s 728 Max wave speed detected: 19.44 m/s
160.9s 729 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
161.4s 730 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
161.8s 731 [WARNING] Automatic CFL correction applied (count: 3600):
161.8s 732 Calculated CFL: 0.800 > Limit: 0.500
161.8s 733 Original dt: 4.114982e-01 s
161.8s 734 Corrected dt: 2.571863e-01 s
161.8s 735 Correction factor: 1.6x
161.8s 736 Max wave speed detected: 19.44 m/s
161.9s 737 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
162.3s 738 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
162.8s 739 [WARNING] Automatic CFL correction applied (count: 3700):
162.8s 740 Calculated CFL: 0.800 > Limit: 0.500
162.8s 741 Original dt: 4.114980e-01 s
162.8s 742 Corrected dt: 2.571863e-01 s
162.8s 743 Correction factor: 1.6x
162.8s 744 Max wave speed detected: 19.44 m/s
162.8s 745 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
163.0s 746 Stored output at t = 120.0000 s (Step 465)
163.0s 747 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
163.0s 748 [A
163.0s 749 
163.0s 750 Simulation finished at t = 120.0000 s after 465 steps.
163.0s 751 Total runtime: 2.19 seconds.
163.0s 752 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.39s/s]
163.0s 753 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
163.0s 754 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
163.0s 755 Using device: gpu
163.0s 756 DEBUG PARAMS: Reading K_m_kmh = 10.0
163.0s 757 DEBUG PARAMS: Reading K_c_kmh = 15.0
163.0s 758 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
163.0s 759 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
163.0s 760 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
163.0s 761 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
163.0s 762 Loading road quality type: uniform
163.0s 763 Uniform road quality value: 2
163.0s 764 Road quality loaded.
163.0s 765 Initial state created.
163.0s 766 Transferring initial state and road quality to GPU...
163.0s 767 GPU data transfer complete.
163.0s 768 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
163.0s 769 Initial boundary conditions applied.
163.0s 770 [BC UPDATE] left → phase 0 (outflow)
163.0s 771 └─ Outflow: zero-order extrapolation
163.0s 772 [BC UPDATE] left → phase 1 (inflow)
163.0s 773 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
163.0s 774 Running simulation until t = 60.00 s, outputting every 60.00 s
163.0s 775 
163.4s 776 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
163.7s 777 [WARNING] Automatic CFL correction applied (count: 3800):
163.7s 778 Calculated CFL: 0.800 > Limit: 0.500
163.7s 779 Original dt: 4.190346e-01 s
163.7s 780 Corrected dt: 2.618967e-01 s
163.7s 781 Correction factor: 1.6x
163.7s 782 Max wave speed detected: 19.09 m/s
163.9s 783 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
164.4s 784 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
164.6s 785 [WARNING] Automatic CFL correction applied (count: 3900):
164.6s 786 Calculated CFL: 0.800 > Limit: 0.500
164.6s 787 Original dt: 4.115954e-01 s
164.6s 788 Corrected dt: 2.572472e-01 s
164.6s 789 Correction factor: 1.6x
164.6s 790 Max wave speed detected: 19.44 m/s
164.8s 791 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
165.1s 792 Stored output at t = 60.0000 s (Step 231)
165.1s 793 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
165.1s 794 [A
165.1s 795 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.14s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.13s/s]
165.1s 796 
165.1s 797 Simulation finished at t = 60.0000 s after 231 steps.
165.1s 798 Total runtime: 2.13 seconds.
165.1s 799 
165.1s 800 Running simulation until t = 120.00 s, outputting every 60.00 s
165.3s 801 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
165.6s 802 [WARNING] Automatic CFL correction applied (count: 4000):
165.6s 803 Calculated CFL: 0.800 > Limit: 0.500
165.6s 804 Original dt: 4.114996e-01 s
165.6s 805 Corrected dt: 2.571873e-01 s
165.6s 806 Correction factor: 1.6x
165.6s 807 Max wave speed detected: 19.44 m/s
165.7s 808 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
166.2s 809 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
166.5s 810 [WARNING] Automatic CFL correction applied (count: 4100):
166.5s 811 Calculated CFL: 0.800 > Limit: 0.500
166.5s 812 Original dt: 4.114981e-01 s
166.5s 813 Corrected dt: 2.571863e-01 s
166.5s 814 Correction factor: 1.6x
166.5s 815 Max wave speed detected: 19.44 m/s
166.7s 816 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
167.1s 817 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
167.3s 818 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
167.3s 819 [A
167.3s 820 Stored output at t = 120.0000 s (Step 465)
167.3s 821 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s]
167.3s 822 
167.3s 823 Simulation finished at t = 120.0000 s after 465 steps.
167.3s 824 Total runtime: 2.18 seconds.
167.3s 825 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
167.3s 826 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
167.3s 827 Using device: gpu
167.3s 828 DEBUG PARAMS: Reading K_m_kmh = 10.0
167.3s 829 DEBUG PARAMS: Reading K_c_kmh = 15.0
167.3s 830 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
167.3s 831 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
167.3s 832 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
167.3s 833 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
167.3s 834 Loading road quality type: uniform
167.3s 835 Uniform road quality value: 2
167.3s 836 Road quality loaded.
167.3s 837 Initial state created.
167.3s 838 Transferring initial state and road quality to GPU...
167.3s 839 GPU data transfer complete.
167.3s 840 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
167.3s 841 Initial boundary conditions applied.
167.3s 842 [BC UPDATE] left → phase 0 (outflow)
167.3s 843 └─ Outflow: zero-order extrapolation
167.3s 844 Running simulation until t = 60.00 s, outputting every 60.00 s
167.3s 845 
167.4s 846 [WARNING] Automatic CFL correction applied (count: 4200):
167.4s 847 Calculated CFL: 0.800 > Limit: 0.500
167.4s 848 Original dt: 4.022422e-01 s
167.4s 849 Corrected dt: 2.514014e-01 s
167.4s 850 Correction factor: 1.6x
167.4s 851 Max wave speed detected: 19.89 m/s
167.8s 852 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
168.2s 853 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
168.4s 854 [WARNING] Automatic CFL correction applied (count: 4300):
168.4s 855 Calculated CFL: 0.800 > Limit: 0.500
168.4s 856 Original dt: 4.130229e-01 s
168.4s 857 Corrected dt: 2.581393e-01 s
168.4s 858 Correction factor: 1.6x
168.4s 859 Max wave speed detected: 19.37 m/s
168.7s 860 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
169.2s 861 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
169.3s 862 [WARNING] Automatic CFL correction applied (count: 4400):
169.3s 863 Calculated CFL: 0.800 > Limit: 0.500
169.3s 864 Original dt: 4.115198e-01 s
169.3s 865 Corrected dt: 2.571999e-01 s
169.3s 866 Correction factor: 1.6x
169.3s 867 Max wave speed detected: 19.44 m/s
169.5s 868 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
169.5s 869 [A
169.5s 870 Stored output at t = 60.0000 s (Step 231)
169.5s 871 
169.5s 872 Simulation finished at t = 60.0000 s after 231 steps.
169.5s 873 Total runtime: 2.15 seconds.
169.5s 874 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.88s/s]
169.5s 875 [BC UPDATE] left → phase 1 (inflow)
169.5s 876 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
169.5s 877 Running simulation until t = 120.00 s, outputting every 60.00 s
169.5s 878 
169.6s 879 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
170.1s 880 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
170.2s 881 [WARNING] Automatic CFL correction applied (count: 4500):
170.2s 882 Calculated CFL: 0.800 > Limit: 0.500
170.2s 883 Original dt: 4.114984e-01 s
170.2s 884 Corrected dt: 2.571865e-01 s
170.2s 885 Correction factor: 1.6x
170.2s 886 Max wave speed detected: 19.44 m/s
170.5s 887 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
171.0s 888 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
171.1s 889 [WARNING] Automatic CFL correction applied (count: 4600):
171.1s 890 Calculated CFL: 0.800 > Limit: 0.500
171.1s 891 Original dt: 4.114980e-01 s
171.1s 892 Corrected dt: 2.571863e-01 s
171.1s 893 Correction factor: 1.6x
171.1s 894 Max wave speed detected: 19.44 m/s
171.5s 895 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
171.6s 896 Stored output at t = 120.0000 s (Step 465)
171.6s 897 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
171.6s 898 [A
171.6s 899 
171.6s 900 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s]
171.6s 901 Simulation finished at t = 120.0000 s after 465 steps.
171.6s 902 Total runtime: 2.15 seconds.
171.6s 903 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
171.6s 904 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
171.6s 905 Using device: gpu
171.6s 906 DEBUG PARAMS: Reading K_m_kmh = 10.0
171.6s 907 DEBUG PARAMS: Reading K_c_kmh = 15.0
171.6s 908 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
171.6s 909 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
171.6s 910 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
171.6s 911 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
171.6s 912 Loading road quality type: uniform
171.6s 913 Uniform road quality value: 2
171.6s 914 Road quality loaded.
171.6s 915 Initial state created.
171.6s 916 Transferring initial state and road quality to GPU...
171.6s 917 GPU data transfer complete.
171.6s 918 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
171.6s 919 Initial boundary conditions applied.
171.6s 920 [BC UPDATE] left → phase 0 (outflow)
171.6s 921 └─ Outflow: zero-order extrapolation
171.6s 922 [BC UPDATE] left → phase 1 (inflow)
171.6s 923 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
171.6s 924 Running simulation until t = 60.00 s, outputting every 60.00 s
171.6s 925 
172.1s 926 [WARNING] Automatic CFL correction applied (count: 4700):
172.1s 927 Calculated CFL: 0.800 > Limit: 0.500
172.1s 928 Original dt: 4.396418e-01 s
172.1s 929 Corrected dt: 2.747761e-01 s
172.1s 930 Correction factor: 1.6x
172.1s 931 Max wave speed detected: 18.20 m/s
172.1s 932 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
172.6s 933 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
173.0s 934 [WARNING] Automatic CFL correction applied (count: 4800):
173.0s 935 Calculated CFL: 0.800 > Limit: 0.500
173.0s 936 Original dt: 4.118393e-01 s
173.0s 937 Corrected dt: 2.573996e-01 s
173.0s 938 Correction factor: 1.6x
173.0s 939 Max wave speed detected: 19.43 m/s
173.0s 940 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
173.5s 941 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
173.7s 942 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
173.7s 943 [A
173.7s 944 Stored output at t = 60.0000 s (Step 231)
173.7s 945 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.15s/s]
173.7s 946 
173.7s 947 Simulation finished at t = 60.0000 s after 231 steps.
173.7s 948 Total runtime: 2.13 seconds.
173.8s 949 
173.8s 950 Running simulation until t = 120.00 s, outputting every 60.00 s
173.9s 951 [WARNING] Automatic CFL correction applied (count: 4900):
173.9s 952 Calculated CFL: 0.800 > Limit: 0.500
173.9s 953 Original dt: 4.115033e-01 s
173.9s 954 Corrected dt: 2.571896e-01 s
173.9s 955 Correction factor: 1.6x
173.9s 956 Max wave speed detected: 19.44 m/s
173.9s 957 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
174.4s 958 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
174.8s 959 [WARNING] Automatic CFL correction applied (count: 5000):
174.8s 960 Calculated CFL: 0.800 > Limit: 0.500
174.8s 961 Original dt: 4.114981e-01 s
174.8s 962 Corrected dt: 2.571863e-01 s
174.8s 963 Correction factor: 1.6x
174.8s 964 Max wave speed detected: 19.44 m/s
174.8s 965 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
175.3s 966 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
175.8s 967 [WARNING] Automatic CFL correction applied (count: 5100):
175.8s 968 Calculated CFL: 0.800 > Limit: 0.500
175.8s 969 Original dt: 4.114980e-01 s
175.8s 970 Corrected dt: 2.571863e-01 s
175.8s 971 Correction factor: 1.6x
175.8s 972 Max wave speed detected: 19.44 m/s
175.8s 973 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
175.9s 974 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
175.9s 975 [A
175.9s 976 Stored output at t = 120.0000 s (Step 465)
175.9s 977 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.62s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.62s/s]
175.9s 978 
175.9s 979 Simulation finished at t = 120.0000 s after 465 steps.
175.9s 980 Total runtime: 2.17 seconds.
175.9s 981 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
175.9s 982 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
175.9s 983 Using device: gpu
175.9s 984 DEBUG PARAMS: Reading K_m_kmh = 10.0
175.9s 985 DEBUG PARAMS: Reading K_c_kmh = 15.0
175.9s 986 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
175.9s 987 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
175.9s 988 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
175.9s 989 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
175.9s 990 Loading road quality type: uniform
175.9s 991 Uniform road quality value: 2
175.9s 992 Road quality loaded.
175.9s 993 Initial state created.
175.9s 994 Transferring initial state and road quality to GPU...
175.9s 995 GPU data transfer complete.
175.9s 996 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
175.9s 997 Initial boundary conditions applied.
175.9s 998 [BC UPDATE] left → phase 0 (outflow)
175.9s 999 └─ Outflow: zero-order extrapolation
175.9s 1000 [BC UPDATE] left → phase 1 (inflow)
175.9s 1001 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
175.9s 1002 Running simulation until t = 60.00 s, outputting every 60.00 s
175.9s 1003 
176.4s 1004 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
176.7s 1005 [WARNING] Automatic CFL correction applied (count: 5200):
176.7s 1006 Calculated CFL: 0.800 > Limit: 0.500
176.7s 1007 Original dt: 4.173029e-01 s
176.7s 1008 Corrected dt: 2.608143e-01 s
176.7s 1009 Correction factor: 1.6x
176.7s 1010 Max wave speed detected: 19.17 m/s
176.9s 1011 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
177.3s 1012 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
177.7s 1013 [WARNING] Automatic CFL correction applied (count: 5300):
177.7s 1014 Calculated CFL: 0.800 > Limit: 0.500
177.7s 1015 Original dt: 4.115760e-01 s
177.7s 1016 Corrected dt: 2.572350e-01 s
177.7s 1017 Correction factor: 1.6x
177.7s 1018 Max wave speed detected: 19.44 m/s
177.8s 1019 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
178.1s 1020 Stored output at t = 60.0000 s (Step 231)
178.1s 1021 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
178.1s 1022 [A
178.1s 1023 
178.1s 1024 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s]
178.1s 1025 Simulation finished at t = 60.0000 s after 231 steps.
178.1s 1026 Total runtime: 2.15 seconds.
178.1s 1027 [BC UPDATE] left → phase 0 (outflow)
178.1s 1028 └─ Outflow: zero-order extrapolation
178.1s 1029 Running simulation until t = 120.00 s, outputting every 60.00 s
178.1s 1030 
178.3s 1031 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
178.6s 1032 [WARNING] Automatic CFL correction applied (count: 5400):
178.6s 1033 Calculated CFL: 0.800 > Limit: 0.500
178.6s 1034 Original dt: 4.114993e-01 s
178.6s 1035 Corrected dt: 2.571871e-01 s
178.6s 1036 Correction factor: 1.6x
178.6s 1037 Max wave speed detected: 19.44 m/s
178.7s 1038 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
179.2s 1039 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
179.5s 1040 [WARNING] Automatic CFL correction applied (count: 5500):
179.5s 1041 Calculated CFL: 0.800 > Limit: 0.500
179.5s 1042 Original dt: 4.114981e-01 s
179.5s 1043 Corrected dt: 2.571863e-01 s
179.5s 1044 Correction factor: 1.6x
179.5s 1045 Max wave speed detected: 19.44 m/s
179.7s 1046 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
180.1s 1047 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
180.3s 1048 Stored output at t = 120.0000 s (Step 465)
180.3s 1049 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
180.3s 1050 [A
180.3s 1051 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.73s/s]
180.3s 1052 
180.3s 1053 Simulation finished at t = 120.0000 s after 465 steps.
180.3s 1054 Total runtime: 2.16 seconds.
180.3s 1055 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
180.3s 1056 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
180.3s 1057 Using device: gpu
180.3s 1058 DEBUG PARAMS: Reading K_m_kmh = 10.0
180.3s 1059 DEBUG PARAMS: Reading K_c_kmh = 15.0
180.3s 1060 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
180.3s 1061 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
180.3s 1062 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
180.3s 1063 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
180.3s 1064 Loading road quality type: uniform
180.3s 1065 Uniform road quality value: 2
180.3s 1066 Road quality loaded.
180.3s 1067 Initial state created.
180.3s 1068 Transferring initial state and road quality to GPU...
180.3s 1069 GPU data transfer complete.
180.3s 1070 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
180.3s 1071 Initial boundary conditions applied.
180.3s 1072 [BC UPDATE] left → phase 0 (outflow)
180.3s 1073 └─ Outflow: zero-order extrapolation
180.3s 1074 [BC UPDATE] left → phase 1 (inflow)
180.3s 1075 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
180.3s 1076 Running simulation until t = 60.00 s, outputting every 60.00 s
180.3s 1077 
180.5s 1078 [WARNING] Automatic CFL correction applied (count: 5600):
180.5s 1079 Calculated CFL: 0.800 > Limit: 0.500
180.5s 1080 Original dt: 4.295974e-01 s
180.5s 1081 Corrected dt: 2.684983e-01 s
180.5s 1082 Correction factor: 1.6x
180.5s 1083 Max wave speed detected: 18.62 m/s
180.7s 1084 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
181.2s 1085 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
181.4s 1086 [WARNING] Automatic CFL correction applied (count: 5700):
181.4s 1087 Calculated CFL: 0.800 > Limit: 0.500
181.4s 1088 Original dt: 4.127253e-01 s
181.4s 1089 Corrected dt: 2.579533e-01 s
181.4s 1090 Correction factor: 1.6x
181.4s 1091 Max wave speed detected: 19.38 m/s
181.7s 1092 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
182.2s 1093 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
182.3s 1094 [WARNING] Automatic CFL correction applied (count: 5800):
182.3s 1095 Calculated CFL: 0.800 > Limit: 0.500
182.3s 1096 Original dt: 4.115153e-01 s
182.3s 1097 Corrected dt: 2.571971e-01 s
182.3s 1098 Correction factor: 1.6x
182.3s 1099 Max wave speed detected: 19.44 m/s
182.5s 1100 Stored output at t = 60.0000 s (Step 231)
182.5s 1101 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
182.5s 1102 [A
182.5s 1103 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.53s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.53s/s]
182.5s 1104 
182.5s 1105 Simulation finished at t = 60.0000 s after 231 steps.
182.5s 1106 Total runtime: 2.18 seconds.
182.5s 1107 [BC UPDATE] left → phase 0 (outflow)
182.5s 1108 └─ Outflow: zero-order extrapolation
182.5s 1109 Running simulation until t = 120.00 s, outputting every 60.00 s
182.5s 1110 
182.6s 1111 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
183.1s 1112 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
183.3s 1113 [WARNING] Automatic CFL correction applied (count: 5900):
183.3s 1114 Calculated CFL: 0.800 > Limit: 0.500
183.3s 1115 Original dt: 4.114984e-01 s
183.3s 1116 Corrected dt: 2.571865e-01 s
183.3s 1117 Correction factor: 1.6x
183.3s 1118 Max wave speed detected: 19.44 m/s
183.6s 1119 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
184.0s 1120 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
184.2s 1121 [WARNING] Automatic CFL correction applied (count: 6000):
184.2s 1122 Calculated CFL: 0.800 > Limit: 0.500
184.2s 1123 Original dt: 4.114980e-01 s
184.2s 1124 Corrected dt: 2.571863e-01 s
184.2s 1125 Correction factor: 1.6x
184.2s 1126 Max wave speed detected: 19.44 m/s
184.5s 1127 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
184.6s 1128 Stored output at t = 120.0000 s (Step 465)
184.6s 1129 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
184.6s 1130 [A
184.6s 1131 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.81s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.81s/s]
184.6s 1132 
184.6s 1133 Simulation finished at t = 120.0000 s after 465 steps.
184.6s 1134 Total runtime: 2.16 seconds.
184.6s 1135 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
184.6s 1136 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
184.6s 1137 Using device: gpu
184.6s 1138 DEBUG PARAMS: Reading K_m_kmh = 10.0
184.6s 1139 DEBUG PARAMS: Reading K_c_kmh = 15.0
184.6s 1140 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
184.6s 1141 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
184.6s 1142 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
184.6s 1143 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
184.6s 1144 Loading road quality type: uniform
184.6s 1145 Uniform road quality value: 2
184.6s 1146 Road quality loaded.
184.6s 1147 Initial state created.
184.6s 1148 Transferring initial state and road quality to GPU...
184.6s 1149 GPU data transfer complete.
184.6s 1150 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
184.6s 1151 Initial boundary conditions applied.
184.6s 1152 [BC UPDATE] left → phase 0 (outflow)
184.6s 1153 └─ Outflow: zero-order extrapolation
184.6s 1154 Running simulation until t = 60.00 s, outputting every 60.00 s
184.6s 1155 
185.1s 1156 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
185.1s 1157 [WARNING] Automatic CFL correction applied (count: 6100):
185.1s 1158 Calculated CFL: 0.800 > Limit: 0.500
185.1s 1159 Original dt: 4.346596e-01 s
185.1s 1160 Corrected dt: 2.716622e-01 s
185.1s 1161 Correction factor: 1.6x
185.1s 1162 Max wave speed detected: 18.41 m/s
185.6s 1163 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
186.0s 1164 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
186.1s 1165 [WARNING] Automatic CFL correction applied (count: 6200):
186.1s 1166 Calculated CFL: 0.800 > Limit: 0.500
186.1s 1167 Original dt: 4.117853e-01 s
186.1s 1168 Corrected dt: 2.573658e-01 s
186.1s 1169 Correction factor: 1.6x
186.1s 1170 Max wave speed detected: 19.43 m/s
186.5s 1171 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
186.8s 1172 Stored output at t = 60.0000 s (Step 231)
186.8s 1173 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
186.8s 1174 [A
186.8s 1175 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s]
186.8s 1176 
186.8s 1177 Simulation finished at t = 60.0000 s after 231 steps.
186.8s 1178 Total runtime: 2.16 seconds.
186.8s 1179 Running simulation until t = 120.00 s, outputting every 60.00 s
186.8s 1180 
187.0s 1181 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
187.0s 1182 [WARNING] Automatic CFL correction applied (count: 6300):
187.0s 1183 Calculated CFL: 0.800 > Limit: 0.500
187.0s 1184 Original dt: 4.115023e-01 s
187.0s 1185 Corrected dt: 2.571890e-01 s
187.0s 1186 Correction factor: 1.6x
187.0s 1187 Max wave speed detected: 19.44 m/s
187.5s 1188 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
187.9s 1189 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
188.0s 1190 [WARNING] Automatic CFL correction applied (count: 6400):
188.0s 1191 Calculated CFL: 0.800 > Limit: 0.500
188.0s 1192 Original dt: 4.114981e-01 s
188.0s 1193 Corrected dt: 2.571863e-01 s
188.0s 1194 Correction factor: 1.6x
188.0s 1195 Max wave speed detected: 19.44 m/s
188.4s 1196 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
188.9s 1197 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
188.9s 1198 [WARNING] Automatic CFL correction applied (count: 6500):
188.9s 1199 Calculated CFL: 0.800 > Limit: 0.500
188.9s 1200 Original dt: 4.114980e-01 s
188.9s 1201 Corrected dt: 2.571863e-01 s
188.9s 1202 Correction factor: 1.6x
188.9s 1203 Max wave speed detected: 19.44 m/s
189.0s 1204 Stored output at t = 120.0000 s (Step 465)
189.0s 1205 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
189.0s 1206 [A
189.0s 1207 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s]
189.0s 1208 
189.0s 1209 Simulation finished at t = 120.0000 s after 465 steps.
189.0s 1210 Total runtime: 2.22 seconds.
189.0s 1211 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
189.0s 1212 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
189.0s 1213 Using device: gpu
189.0s 1214 DEBUG PARAMS: Reading K_m_kmh = 10.0
189.0s 1215 DEBUG PARAMS: Reading K_c_kmh = 15.0
189.0s 1216 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
189.0s 1217 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
189.0s 1218 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
189.0s 1219 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
189.0s 1220 Loading road quality type: uniform
189.0s 1221 Uniform road quality value: 2
189.0s 1222 Road quality loaded.
189.0s 1223 Initial state created.
189.0s 1224 Transferring initial state and road quality to GPU...
189.0s 1225 GPU data transfer complete.
189.0s 1226 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
189.0s 1227 Initial boundary conditions applied.
189.0s 1228 [BC UPDATE] left → phase 0 (outflow)
189.0s 1229 └─ Outflow: zero-order extrapolation
189.0s 1230 Running simulation until t = 60.00 s, outputting every 60.00 s
189.0s 1231 
189.5s 1232 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
189.9s 1233 [WARNING] Automatic CFL correction applied (count: 6600):
189.9s 1234 Calculated CFL: 0.800 > Limit: 0.500
189.9s 1235 Original dt: 4.160552e-01 s
189.9s 1236 Corrected dt: 2.600345e-01 s
189.9s 1237 Correction factor: 1.6x
189.9s 1238 Max wave speed detected: 19.23 m/s
190.0s 1239 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
190.4s 1240 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
190.8s 1241 [WARNING] Automatic CFL correction applied (count: 6700):
190.8s 1242 Calculated CFL: 0.800 > Limit: 0.500
190.8s 1243 Original dt: 4.115592e-01 s
190.8s 1244 Corrected dt: 2.572245e-01 s
190.8s 1245 Correction factor: 1.6x
190.8s 1246 Max wave speed detected: 19.44 m/s
190.9s 1247 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
191.2s 1248 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
191.2s 1249 [A
191.2s 1250 Stored output at t = 60.0000 s (Step 231)
191.2s 1251 
191.2s 1252 Simulation finished at t = 60.0000 s after 231 steps.
191.2s 1253 Total runtime: 2.14 seconds.
191.2s 1254 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.10s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.10s/s]
191.2s 1255 [BC UPDATE] left → phase 1 (inflow)
191.2s 1256 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
191.2s 1257 Running simulation until t = 120.00 s, outputting every 60.00 s
191.2s 1258 
191.4s 1259 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
191.7s 1260 [WARNING] Automatic CFL correction applied (count: 6800):
191.7s 1261 Calculated CFL: 0.800 > Limit: 0.500
191.7s 1262 Original dt: 4.114991e-01 s
191.7s 1263 Corrected dt: 2.571870e-01 s
191.7s 1264 Correction factor: 1.6x
191.7s 1265 Max wave speed detected: 19.44 m/s
191.8s 1266 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
192.3s 1267 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
192.7s 1268 [WARNING] Automatic CFL correction applied (count: 6900):
192.7s 1269 Calculated CFL: 0.800 > Limit: 0.500
192.7s 1270 Original dt: 4.114980e-01 s
192.7s 1271 Corrected dt: 2.571863e-01 s
192.7s 1272 Correction factor: 1.6x
192.7s 1273 Max wave speed detected: 19.44 m/s
192.8s 1274 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
193.2s 1275 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
193.4s 1276 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
193.4s 1277 [A
193.4s 1278 Stored output at t = 120.0000 s (Step 465)
193.4s 1279 
193.4s 1280 Simulation finished at t = 120.0000 s after 465 steps.
193.4s 1281 Total runtime: 2.19 seconds.
193.4s 1282 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.44s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.44s/s]
193.4s 1283 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
193.4s 1284 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
193.4s 1285 Using device: gpu
193.4s 1286 DEBUG PARAMS: Reading K_m_kmh = 10.0
193.4s 1287 DEBUG PARAMS: Reading K_c_kmh = 15.0
193.4s 1288 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
193.4s 1289 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
193.4s 1290 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
193.4s 1291 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
193.4s 1292 Loading road quality type: uniform
193.4s 1293 Uniform road quality value: 2
193.4s 1294 Road quality loaded.
193.4s 1295 Initial state created.
193.4s 1296 Transferring initial state and road quality to GPU...
193.4s 1297 GPU data transfer complete.
193.4s 1298 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
193.4s 1299 Initial boundary conditions applied.
193.4s 1300 [BC UPDATE] left → phase 0 (outflow)
193.4s 1301 └─ Outflow: zero-order extrapolation
193.4s 1302 Running simulation until t = 60.00 s, outputting every 60.00 s
193.4s 1303 
193.6s 1304 [WARNING] Automatic CFL correction applied (count: 7000):
193.6s 1305 Calculated CFL: 0.800 > Limit: 0.500
193.6s 1306 Original dt: 4.547467e-01 s
193.6s 1307 Corrected dt: 2.842167e-01 s
193.6s 1308 Correction factor: 1.6x
193.6s 1309 Max wave speed detected: 17.59 m/s
193.8s 1310 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
194.3s 1311 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
194.5s 1312 [WARNING] Automatic CFL correction applied (count: 7100):
194.5s 1313 Calculated CFL: 0.800 > Limit: 0.500
194.5s 1314 Original dt: 4.125079e-01 s
194.5s 1315 Corrected dt: 2.578175e-01 s
194.5s 1316 Correction factor: 1.6x
194.5s 1317 Max wave speed detected: 19.39 m/s
194.8s 1318 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
195.2s 1319 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
195.4s 1320 [WARNING] Automatic CFL correction applied (count: 7200):
195.4s 1321 Calculated CFL: 0.800 > Limit: 0.500
195.4s 1322 Original dt: 4.115121e-01 s
195.4s 1323 Corrected dt: 2.571950e-01 s
195.4s 1324 Correction factor: 1.6x
195.4s 1325 Max wave speed detected: 19.44 m/s
195.5s 1326 Stored output at t = 60.0000 s (Step 231)
195.5s 1327 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
195.5s 1328 [A
195.5s 1329 
195.5s 1330 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.13s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.13s/s]
195.5s 1331 Simulation finished at t = 60.0000 s after 231 steps.
195.5s 1332 Total runtime: 2.13 seconds.
195.5s 1333 [BC UPDATE] left → phase 1 (inflow)
195.5s 1334 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
195.5s 1335 Running simulation until t = 120.00 s, outputting every 60.00 s
195.5s 1336 
195.7s 1337 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
196.2s 1338 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
196.4s 1339 [WARNING] Automatic CFL correction applied (count: 7300):
196.4s 1340 Calculated CFL: 0.800 > Limit: 0.500
196.4s 1341 Original dt: 4.114983e-01 s
196.4s 1342 Corrected dt: 2.571865e-01 s
196.4s 1343 Correction factor: 1.6x
196.4s 1344 Max wave speed detected: 19.44 m/s
196.6s 1345 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
197.1s 1346 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
197.3s 1347 [WARNING] Automatic CFL correction applied (count: 7400):
197.3s 1348 Calculated CFL: 0.800 > Limit: 0.500
197.3s 1349 Original dt: 4.114980e-01 s
197.3s 1350 Corrected dt: 2.571863e-01 s
197.3s 1351 Correction factor: 1.6x
197.3s 1352 Max wave speed detected: 19.44 m/s
197.6s 1353 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
197.7s 1354 Stored output at t = 120.0000 s (Step 465)
197.7s 1355 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
197.7s 1356 [A
197.7s 1357 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.18s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.18s/s]
197.7s 1358 
197.7s 1359 Simulation finished at t = 120.0000 s after 465 steps.
197.7s 1360 Total runtime: 2.21 seconds.
197.7s 1361 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
197.7s 1362 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
197.7s 1363 Using device: gpu
197.7s 1364 DEBUG PARAMS: Reading K_m_kmh = 10.0
197.7s 1365 DEBUG PARAMS: Reading K_c_kmh = 15.0
197.7s 1366 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
197.7s 1367 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
197.7s 1368 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
197.7s 1369 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
197.7s 1370 Loading road quality type: uniform
197.7s 1371 Uniform road quality value: 2
197.7s 1372 Road quality loaded.
197.7s 1373 Initial state created.
197.7s 1374 Transferring initial state and road quality to GPU...
197.7s 1375 GPU data transfer complete.
197.7s 1376 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
197.7s 1377 Initial boundary conditions applied.
197.7s 1378 [BC UPDATE] left → phase 0 (outflow)
197.7s 1379 └─ Outflow: zero-order extrapolation
197.7s 1380 [BC UPDATE] left → phase 1 (inflow)
197.7s 1381 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
197.7s 1382 Running simulation until t = 60.00 s, outputting every 60.00 s
197.7s 1383 
198.2s 1384 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
198.3s 1385 [WARNING] Automatic CFL correction applied (count: 7500):
198.3s 1386 Calculated CFL: 0.800 > Limit: 0.500
198.3s 1387 Original dt: 4.295897e-01 s
198.3s 1388 Corrected dt: 2.684936e-01 s
198.3s 1389 Correction factor: 1.6x
198.3s 1390 Max wave speed detected: 18.62 m/s
198.7s 1391 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
199.2s 1392 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
199.3s 1393 [WARNING] Automatic CFL correction applied (count: 7600):
199.3s 1394 Calculated CFL: 0.800 > Limit: 0.500
199.3s 1395 Original dt: 4.117215e-01 s
199.3s 1396 Corrected dt: 2.573259e-01 s
199.3s 1397 Correction factor: 1.6x
199.3s 1398 Max wave speed detected: 19.43 m/s
199.6s 1399 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
199.9s 1400 Stored output at t = 60.0000 s (Step 231)
199.9s 1401 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
199.9s 1402 [A
199.9s 1403 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.16s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.16s/s]
199.9s 1404 
199.9s 1405 Simulation finished at t = 60.0000 s after 231 steps.
199.9s 1406 Total runtime: 2.21 seconds.
200.0s 1407 Running simulation until t = 120.00 s, outputting every 60.00 s
200.0s 1408 
200.1s 1409 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
200.2s 1410 [WARNING] Automatic CFL correction applied (count: 7700):
200.2s 1411 Calculated CFL: 0.800 > Limit: 0.500
200.2s 1412 Original dt: 4.115016e-01 s
200.2s 1413 Corrected dt: 2.571885e-01 s
200.2s 1414 Correction factor: 1.6x
200.2s 1415 Max wave speed detected: 19.44 m/s
200.6s 1416 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
201.1s 1417 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
201.2s 1418 [WARNING] Automatic CFL correction applied (count: 7800):
201.2s 1419 Calculated CFL: 0.800 > Limit: 0.500
201.2s 1420 Original dt: 4.114981e-01 s
201.2s 1421 Corrected dt: 2.571863e-01 s
201.2s 1422 Correction factor: 1.6x
201.2s 1423 Max wave speed detected: 19.44 m/s
201.6s 1424 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
202.1s 1425 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
202.2s 1426 [WARNING] Automatic CFL correction applied (count: 7900):
202.2s 1427 Calculated CFL: 0.800 > Limit: 0.500
202.2s 1428 Original dt: 4.114980e-01 s
202.2s 1429 Corrected dt: 2.571863e-01 s
202.2s 1430 Correction factor: 1.6x
202.2s 1431 Max wave speed detected: 19.44 m/s
202.2s 1432 Stored output at t = 120.0000 s (Step 465)
202.2s 1433 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
202.2s 1434 [A
202.2s 1435 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.61s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.61s/s]
202.2s 1436 
202.2s 1437 Simulation finished at t = 120.0000 s after 465 steps.
202.2s 1438 Total runtime: 2.26 seconds.
202.2s 1439 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
202.2s 1440 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
202.2s 1441 Using device: gpu
202.2s 1442 DEBUG PARAMS: Reading K_m_kmh = 10.0
202.2s 1443 DEBUG PARAMS: Reading K_c_kmh = 15.0
202.2s 1444 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
202.2s 1445 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
202.2s 1446 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
202.2s 1447 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
202.2s 1448 Loading road quality type: uniform
202.2s 1449 Uniform road quality value: 2
202.2s 1450 Road quality loaded.
202.2s 1451 Initial state created.
202.2s 1452 Transferring initial state and road quality to GPU...
202.2s 1453 GPU data transfer complete.
202.2s 1454 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
202.2s 1455 Initial boundary conditions applied.
202.2s 1456 [BC UPDATE] left → phase 0 (outflow)
202.2s 1457 └─ Outflow: zero-order extrapolation
202.2s 1458 Running simulation until t = 60.00 s, outputting every 60.00 s
202.2s 1459 
202.7s 1460 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
203.1s 1461 [WARNING] Automatic CFL correction applied (count: 8000):
203.1s 1462 Calculated CFL: 0.800 > Limit: 0.500
203.1s 1463 Original dt: 4.151534e-01 s
203.1s 1464 Corrected dt: 2.594709e-01 s
203.1s 1465 Correction factor: 1.6x
203.1s 1466 Max wave speed detected: 19.27 m/s
203.1s 1467 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
203.6s 1468 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
204.0s 1469 [WARNING] Automatic CFL correction applied (count: 8100):
204.0s 1470 Calculated CFL: 0.800 > Limit: 0.500
204.0s 1471 Original dt: 4.115470e-01 s
204.0s 1472 Corrected dt: 2.572169e-01 s
204.0s 1473 Correction factor: 1.6x
204.0s 1474 Max wave speed detected: 19.44 m/s
204.1s 1475 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
204.4s 1476 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
204.4s 1477 [A
204.4s 1478 Stored output at t = 60.0000 s (Step 231)
204.4s 1479 
204.4s 1480 Simulation finished at t = 60.0000 s after 231 steps.
204.4s 1481 Total runtime: 2.14 seconds.
204.4s 1482 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.07s/s]
204.4s 1483 Running simulation until t = 120.00 s, outputting every 60.00 s
204.4s 1484 
204.5s 1485 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
205.0s 1486 [WARNING] Automatic CFL correction applied (count: 8200):
205.0s 1487 Calculated CFL: 0.800 > Limit: 0.500
205.0s 1488 Original dt: 4.114990e-01 s
205.0s 1489 Corrected dt: 2.571869e-01 s
205.0s 1490 Correction factor: 1.6x
205.0s 1491 Max wave speed detected: 19.44 m/s
205.0s 1492 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
205.5s 1493 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
205.9s 1494 [WARNING] Automatic CFL correction applied (count: 8300):
205.9s 1495 Calculated CFL: 0.800 > Limit: 0.500
205.9s 1496 Original dt: 4.114980e-01 s
205.9s 1497 Corrected dt: 2.571863e-01 s
205.9s 1498 Correction factor: 1.6x
205.9s 1499 Max wave speed detected: 19.44 m/s
205.9s 1500 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
206.4s 1501 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
206.6s 1502 Stored output at t = 120.0000 s (Step 465)
206.6s 1503 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
206.6s 1504 [A
206.6s 1505 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s]
206.6s 1506 
206.6s 1507 Simulation finished at t = 120.0000 s after 465 steps.
206.6s 1508 Total runtime: 2.19 seconds.
206.6s 1509 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
206.6s 1510 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
206.6s 1511 Using device: gpu
206.6s 1512 DEBUG PARAMS: Reading K_m_kmh = 10.0
206.6s 1513 DEBUG PARAMS: Reading K_c_kmh = 15.0
206.6s 1514 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
206.6s 1515 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
206.6s 1516 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
206.6s 1517 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
206.6s 1518 Loading road quality type: uniform
206.6s 1519 Uniform road quality value: 2
206.6s 1520 Road quality loaded.
206.6s 1521 Initial state created.
206.6s 1522 Transferring initial state and road quality to GPU...
206.6s 1523 GPU data transfer complete.
206.6s 1524 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
206.6s 1525 Initial boundary conditions applied.
206.6s 1526 [BC UPDATE] left → phase 0 (outflow)
206.6s 1527 └─ Outflow: zero-order extrapolation
206.6s 1528 [BC UPDATE] left → phase 1 (inflow)
206.6s 1529 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
206.6s 1530 Running simulation until t = 60.00 s, outputting every 60.00 s
206.6s 1531 
206.8s 1532 [WARNING] Automatic CFL correction applied (count: 8400):
206.8s 1533 Calculated CFL: 0.800 > Limit: 0.500
206.8s 1534 Original dt: 4.768783e-01 s
206.8s 1535 Corrected dt: 2.980490e-01 s
206.8s 1536 Correction factor: 1.6x
206.8s 1537 Max wave speed detected: 16.78 m/s
207.0s 1538 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
207.5s 1539 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
207.8s 1540 [WARNING] Automatic CFL correction applied (count: 8500):
207.8s 1541 Calculated CFL: 0.800 > Limit: 0.500
207.8s 1542 Original dt: 4.123385e-01 s
207.8s 1543 Corrected dt: 2.577116e-01 s
207.8s 1544 Correction factor: 1.6x
207.8s 1545 Max wave speed detected: 19.40 m/s
208.0s 1546 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
208.4s 1547 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
208.7s 1548 [WARNING] Automatic CFL correction applied (count: 8600):
208.7s 1549 Calculated CFL: 0.800 > Limit: 0.500
208.7s 1550 Original dt: 4.115097e-01 s
208.7s 1551 Corrected dt: 2.571935e-01 s
208.7s 1552 Correction factor: 1.6x
208.7s 1553 Max wave speed detected: 19.44 m/s
208.7s 1554 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
208.7s 1555 [A
208.7s 1556 Stored output at t = 60.0000 s (Step 231)
208.7s 1557 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.93s/s]
208.7s 1558 
208.7s 1559 Simulation finished at t = 60.0000 s after 231 steps.
208.7s 1560 Total runtime: 2.15 seconds.
208.7s 1561 Running simulation until t = 120.00 s, outputting every 60.00 s
208.7s 1562 
208.9s 1563 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
209.4s 1564 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
209.6s 1565 [WARNING] Automatic CFL correction applied (count: 8700):
209.6s 1566 Calculated CFL: 0.800 > Limit: 0.500
209.6s 1567 Original dt: 4.114983e-01 s
209.6s 1568 Corrected dt: 2.571864e-01 s
209.6s 1569 Correction factor: 1.6x
209.6s 1570 Max wave speed detected: 19.44 m/s
209.8s 1571 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
210.3s 1572 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
210.6s 1573 [WARNING] Automatic CFL correction applied (count: 8800):
210.6s 1574 Calculated CFL: 0.800 > Limit: 0.500
210.6s 1575 Original dt: 4.114980e-01 s
210.6s 1576 Corrected dt: 2.571863e-01 s
210.6s 1577 Correction factor: 1.6x
210.6s 1578 Max wave speed detected: 19.44 m/s
210.8s 1579 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
210.9s 1580 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
210.9s 1581 [A
210.9s 1582 Stored output at t = 120.0000 s (Step 465)
210.9s 1583 
210.9s 1584 Simulation finished at t = 120.0000 s after 465 steps.
210.9s 1585 Total runtime: 2.20 seconds.
210.9s 1586 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s]
210.9s 1587 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
210.9s 1588 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
210.9s 1589 Using device: gpu
210.9s 1590 DEBUG PARAMS: Reading K_m_kmh = 10.0
210.9s 1591 DEBUG PARAMS: Reading K_c_kmh = 15.0
210.9s 1592 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
210.9s 1593 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
210.9s 1594 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
210.9s 1595 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
210.9s 1596 Loading road quality type: uniform
210.9s 1597 Uniform road quality value: 2
210.9s 1598 Road quality loaded.
210.9s 1599 Initial state created.
210.9s 1600 Transferring initial state and road quality to GPU...
210.9s 1601 GPU data transfer complete.
210.9s 1602 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
210.9s 1603 Initial boundary conditions applied.
210.9s 1604 [BC UPDATE] left → phase 0 (outflow)
210.9s 1605 └─ Outflow: zero-order extrapolation
210.9s 1606 Running simulation until t = 60.00 s, outputting every 60.00 s
210.9s 1607 
211.4s 1608 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
211.5s 1609 [WARNING] Automatic CFL correction applied (count: 8900):
211.5s 1610 Calculated CFL: 0.800 > Limit: 0.500
211.5s 1611 Original dt: 4.254608e-01 s
211.5s 1612 Corrected dt: 2.659130e-01 s
211.5s 1613 Correction factor: 1.6x
211.5s 1614 Max wave speed detected: 18.80 m/s
211.9s 1615 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
212.4s 1616 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
212.5s 1617 [WARNING] Automatic CFL correction applied (count: 9000):
212.5s 1618 Calculated CFL: 0.800 > Limit: 0.500
212.5s 1619 Original dt: 4.116742e-01 s
212.5s 1620 Corrected dt: 2.572964e-01 s
212.5s 1621 Correction factor: 1.6x
212.5s 1622 Max wave speed detected: 19.43 m/s
212.8s 1623 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
213.1s 1624 Stored output at t = 60.0000 s (Step 231)
213.1s 1625 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
213.1s 1626 [A
213.1s 1627 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.46s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.46s/s]
213.1s 1628 
213.1s 1629 Simulation finished at t = 60.0000 s after 231 steps.
213.1s 1630 Total runtime: 2.19 seconds.
213.1s 1631 Running simulation until t = 120.00 s, outputting every 60.00 s
213.1s 1632 
213.3s 1633 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
213.4s 1634 [WARNING] Automatic CFL correction applied (count: 9100):
213.4s 1635 Calculated CFL: 0.800 > Limit: 0.500
213.4s 1636 Original dt: 4.115011e-01 s
213.4s 1637 Corrected dt: 2.571882e-01 s
213.4s 1638 Correction factor: 1.6x
213.4s 1639 Max wave speed detected: 19.44 m/s
213.8s 1640 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
214.2s 1641 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
214.4s 1642 [WARNING] Automatic CFL correction applied (count: 9200):
214.4s 1643 Calculated CFL: 0.800 > Limit: 0.500
214.4s 1644 Original dt: 4.114981e-01 s
214.4s 1645 Corrected dt: 2.571863e-01 s
214.4s 1646 Correction factor: 1.6x
214.4s 1647 Max wave speed detected: 19.44 m/s
214.7s 1648 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
215.2s 1649 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
215.3s 1650 [WARNING] Automatic CFL correction applied (count: 9300):
215.3s 1651 Calculated CFL: 0.800 > Limit: 0.500
215.3s 1652 Original dt: 4.114980e-01 s
215.3s 1653 Corrected dt: 2.571863e-01 s
215.3s 1654 Correction factor: 1.6x
215.3s 1655 Max wave speed detected: 19.44 m/s
215.3s 1656 Stored output at t = 120.0000 s (Step 465)
215.3s 1657 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
215.3s 1658 [A
215.3s 1659 
215.3s 1660 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.34s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.34s/s]
215.3s 1661 Simulation finished at t = 120.0000 s after 465 steps.
215.3s 1662 Total runtime: 2.20 seconds.
215.3s 1663 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
215.3s 1664 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
215.3s 1665 Using device: gpu
215.3s 1666 DEBUG PARAMS: Reading K_m_kmh = 10.0
215.3s 1667 DEBUG PARAMS: Reading K_c_kmh = 15.0
215.3s 1668 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
215.3s 1669 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
215.3s 1670 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
215.3s 1671 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
215.3s 1672 Loading road quality type: uniform
215.3s 1673 Uniform road quality value: 2
215.3s 1674 Road quality loaded.
215.3s 1675 Initial state created.
215.3s 1676 Transferring initial state and road quality to GPU...
215.3s 1677 GPU data transfer complete.
215.3s 1678 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
215.3s 1679 Initial boundary conditions applied.
215.3s 1680 [BC UPDATE] left → phase 0 (outflow)
215.3s 1681 └─ Outflow: zero-order extrapolation
215.3s 1682 [BC UPDATE] left → phase 1 (inflow)
215.3s 1683 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
215.3s 1684 Running simulation until t = 60.00 s, outputting every 60.00 s
215.3s 1685 
215.8s 1686 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
216.3s 1687 [WARNING] Automatic CFL correction applied (count: 9400):
216.3s 1688 Calculated CFL: 0.800 > Limit: 0.500
216.3s 1689 Original dt: 4.145004e-01 s
216.3s 1690 Corrected dt: 2.590627e-01 s
216.3s 1691 Correction factor: 1.6x
216.3s 1692 Max wave speed detected: 19.30 m/s
216.3s 1693 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
216.8s 1694 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
217.2s 1695 [WARNING] Automatic CFL correction applied (count: 9500):
217.2s 1696 Calculated CFL: 0.800 > Limit: 0.500
217.2s 1697 Original dt: 4.115380e-01 s
217.2s 1698 Corrected dt: 2.572113e-01 s
217.2s 1699 Correction factor: 1.6x
217.2s 1700 Max wave speed detected: 19.44 m/s
217.2s 1701 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
217.5s 1702 Stored output at t = 60.0000 s (Step 231)
217.5s 1703 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
217.5s 1704 [A
217.5s 1705 
217.5s 1706 Simulation finished at t = 60.0000 s after 231 steps.
217.5s 1707 Total runtime: 2.19 seconds.
217.5s 1708 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.47s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.46s/s]
217.5s 1709 Running simulation until t = 120.00 s, outputting every 60.00 s
217.5s 1710 
217.7s 1711 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
218.2s 1712 [WARNING] Automatic CFL correction applied (count: 9600):
218.2s 1713 Calculated CFL: 0.800 > Limit: 0.500
218.2s 1714 Original dt: 4.114988e-01 s
218.2s 1715 Corrected dt: 2.571867e-01 s
218.2s 1716 Correction factor: 1.6x
218.2s 1717 Max wave speed detected: 19.44 m/s
218.2s 1718 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
218.6s 1719 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
219.1s 1720 [WARNING] Automatic CFL correction applied (count: 9700):
219.1s 1721 Calculated CFL: 0.800 > Limit: 0.500
219.1s 1722 Original dt: 4.114980e-01 s
219.1s 1723 Corrected dt: 2.571863e-01 s
219.1s 1724 Correction factor: 1.6x
219.1s 1725 Max wave speed detected: 19.44 m/s
219.1s 1726 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
219.6s 1727 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
219.7s 1728 Stored output at t = 120.0000 s (Step 465)
219.7s 1729 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
219.7s 1730 [A
219.7s 1731 
219.7s 1732 Simulation finished at t = 120.0000 s after 465 steps.
219.7s 1733 Total runtime: 2.19 seconds.
219.7s 1734 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.39s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.39s/s]
219.7s 1735 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
219.7s 1736 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
219.7s 1737 Using device: gpu
219.7s 1738 DEBUG PARAMS: Reading K_m_kmh = 10.0
219.7s 1739 DEBUG PARAMS: Reading K_c_kmh = 15.0
219.7s 1740 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
219.7s 1741 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
219.7s 1742 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
219.7s 1743 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
219.7s 1744 Loading road quality type: uniform
219.7s 1745 Uniform road quality value: 2
219.7s 1746 Road quality loaded.
219.7s 1747 Initial state created.
219.7s 1748 Transferring initial state and road quality to GPU...
219.7s 1749 GPU data transfer complete.
219.7s 1750 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
219.7s 1751 Initial boundary conditions applied.
219.7s 1752 [BC UPDATE] left → phase 0 (outflow)
219.7s 1753 └─ Outflow: zero-order extrapolation
219.7s 1754 [BC UPDATE] left → phase 1 (inflow)
219.7s 1755 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
219.7s 1756 Running simulation until t = 60.00 s, outputting every 60.00 s
219.7s 1757 
220.0s 1758 [WARNING] Automatic CFL correction applied (count: 9800):
220.0s 1759 Calculated CFL: 0.800 > Limit: 0.500
220.0s 1760 Original dt: 4.758816e-01 s
220.0s 1761 Corrected dt: 2.974260e-01 s
220.0s 1762 Correction factor: 1.6x
220.0s 1763 Max wave speed detected: 16.81 m/s
220.2s 1764 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
220.7s 1765 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
221.0s 1766 [WARNING] Automatic CFL correction applied (count: 9900):
221.0s 1767 Calculated CFL: 0.800 > Limit: 0.500
221.0s 1768 Original dt: 4.121510e-01 s
221.0s 1769 Corrected dt: 2.575944e-01 s
221.0s 1770 Correction factor: 1.6x
221.0s 1771 Max wave speed detected: 19.41 m/s
221.1s 1772 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
221.6s 1773 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
221.9s 1774 Stored output at t = 60.0000 s (Step 231)
221.9s 1775 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
221.9s 1776 [A
221.9s 1777 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s]
221.9s 1778 
221.9s 1779 Simulation finished at t = 60.0000 s after 231 steps.
221.9s 1780 Total runtime: 2.14 seconds.
221.9s 1781 Running simulation until t = 120.00 s, outputting every 60.00 s
221.9s 1782 
221.9s 1783 [WARNING] Automatic CFL correction applied (count: 10000):
221.9s 1784 Calculated CFL: 0.800 > Limit: 0.500
221.9s 1785 Original dt: 4.115082e-01 s
221.9s 1786 Corrected dt: 2.571926e-01 s
221.9s 1787 Correction factor: 1.6x
221.9s 1788 Max wave speed detected: 19.44 m/s
222.1s 1789 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
222.5s 1790 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
222.9s 1791 [WARNING] Automatic CFL correction applied (count: 10100):
222.9s 1792 Calculated CFL: 0.800 > Limit: 0.500
222.9s 1793 Original dt: 4.114982e-01 s
222.9s 1794 Corrected dt: 2.571864e-01 s
222.9s 1795 Correction factor: 1.6x
222.9s 1796 Max wave speed detected: 19.44 m/s
223.0s 1797 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
223.5s 1798 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
223.8s 1799 [WARNING] Automatic CFL correction applied (count: 10200):
223.8s 1800 Calculated CFL: 0.800 > Limit: 0.500
223.8s 1801 Original dt: 4.114980e-01 s
223.8s 1802 Corrected dt: 2.571863e-01 s
223.8s 1803 Correction factor: 1.6x
223.8s 1804 Max wave speed detected: 19.44 m/s
223.9s 1805 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
224.1s 1806 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
224.1s 1807 [A
224.1s 1808 Stored output at t = 120.0000 s (Step 465)
224.1s 1809 
224.1s 1810 Simulation finished at t = 120.0000 s after 465 steps.
224.1s 1811 Total runtime: 2.19 seconds.
224.1s 1812 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.36s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.36s/s]
224.1s 1813 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
224.1s 1814 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
224.1s 1815 Using device: gpu
224.1s 1816 DEBUG PARAMS: Reading K_m_kmh = 10.0
224.1s 1817 DEBUG PARAMS: Reading K_c_kmh = 15.0
224.1s 1818 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
224.1s 1819 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
224.1s 1820 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
224.1s 1821 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
224.1s 1822 Loading road quality type: uniform
224.1s 1823 Uniform road quality value: 2
224.1s 1824 Road quality loaded.
224.1s 1825 Initial state created.
224.1s 1826 Transferring initial state and road quality to GPU...
224.1s 1827 GPU data transfer complete.
224.1s 1828 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
224.1s 1829 Initial boundary conditions applied.
224.1s 1830 [BC UPDATE] left → phase 0 (outflow)
224.1s 1831 └─ Outflow: zero-order extrapolation
224.1s 1832 [BC UPDATE] left → phase 1 (inflow)
224.1s 1833 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
224.1s 1834 Running simulation until t = 60.00 s, outputting every 60.00 s
224.1s 1835 
224.5s 1836 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
224.7s 1837 [WARNING] Automatic CFL correction applied (count: 10300):
224.7s 1838 Calculated CFL: 0.800 > Limit: 0.500
224.7s 1839 Original dt: 4.225636e-01 s
224.7s 1840 Corrected dt: 2.641023e-01 s
224.7s 1841 Correction factor: 1.6x
224.7s 1842 Max wave speed detected: 18.93 m/s
225.0s 1843 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
225.5s 1844 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
225.6s 1845 [WARNING] Automatic CFL correction applied (count: 10400):
225.6s 1846 Calculated CFL: 0.800 > Limit: 0.500
225.6s 1847 Original dt: 4.116395e-01 s
225.6s 1848 Corrected dt: 2.572747e-01 s
225.6s 1849 Correction factor: 1.6x
225.6s 1850 Max wave speed detected: 19.43 m/s
225.9s 1851 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
226.2s 1852 Stored output at t = 60.0000 s (Step 231)
226.2s 1853 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
226.2s 1854 [A
226.2s 1855 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s]
226.2s 1856 
226.2s 1857 Simulation finished at t = 60.0000 s after 231 steps.
226.2s 1858 Total runtime: 2.13 seconds.
226.2s 1859 [BC UPDATE] left → phase 0 (outflow)
226.2s 1860 └─ Outflow: zero-order extrapolation
226.2s 1861 Running simulation until t = 120.00 s, outputting every 60.00 s
226.2s 1862 
226.4s 1863 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
226.6s 1864 [WARNING] Automatic CFL correction applied (count: 10500):
226.6s 1865 Calculated CFL: 0.800 > Limit: 0.500
226.6s 1866 Original dt: 4.115005e-01 s
226.6s 1867 Corrected dt: 2.571878e-01 s
226.6s 1868 Correction factor: 1.6x
226.6s 1869 Max wave speed detected: 19.44 m/s
226.9s 1870 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
227.3s 1871 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
227.5s 1872 [WARNING] Automatic CFL correction applied (count: 10600):
227.5s 1873 Calculated CFL: 0.800 > Limit: 0.500
227.5s 1874 Original dt: 4.114981e-01 s
227.5s 1875 Corrected dt: 2.571863e-01 s
227.5s 1876 Correction factor: 1.6x
227.5s 1877 Max wave speed detected: 19.44 m/s
227.8s 1878 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
228.3s 1879 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
228.4s 1880 Stored output at t = 120.0000 s (Step 465)
228.4s 1881 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
228.4s 1882 [A
228.4s 1883 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.40s/s]
228.4s 1884 
228.4s 1885 Simulation finished at t = 120.0000 s after 465 steps.
228.4s 1886 Total runtime: 2.19 seconds.
228.4s 1887 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
228.4s 1888 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
228.4s 1889 Using device: gpu
228.4s 1890 DEBUG PARAMS: Reading K_m_kmh = 10.0
228.4s 1891 DEBUG PARAMS: Reading K_c_kmh = 15.0
228.4s 1892 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
228.4s 1893 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
228.4s 1894 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
228.4s 1895 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
228.4s 1896 Loading road quality type: uniform
228.4s 1897 Uniform road quality value: 2
228.4s 1898 Road quality loaded.
228.4s 1899 Initial state created.
228.4s 1900 Transferring initial state and road quality to GPU...
228.4s 1901 GPU data transfer complete.
228.4s 1902 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
228.4s 1903 Initial boundary conditions applied.
228.4s 1904 [BC UPDATE] left → phase 0 (outflow)
228.4s 1905 └─ Outflow: zero-order extrapolation
228.4s 1906 Running simulation until t = 60.00 s, outputting every 60.00 s
228.4s 1907 
228.5s 1908 [WARNING] Automatic CFL correction applied (count: 10700):
228.5s 1909 Calculated CFL: 0.800 > Limit: 0.500
228.5s 1910 Original dt: 3.451280e-01 s
228.5s 1911 Corrected dt: 2.157050e-01 s
228.5s 1912 Correction factor: 1.6x
228.5s 1913 Max wave speed detected: 23.18 m/s
228.9s 1914 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
229.4s 1915 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
229.4s 1916 [WARNING] Automatic CFL correction applied (count: 10800):
229.4s 1917 Calculated CFL: 0.800 > Limit: 0.500
229.4s 1918 Original dt: 4.139892e-01 s
229.4s 1919 Corrected dt: 2.587433e-01 s
229.4s 1920 Correction factor: 1.6x
229.4s 1921 Max wave speed detected: 19.32 m/s
229.8s 1922 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
230.3s 1923 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
230.3s 1924 [WARNING] Automatic CFL correction applied (count: 10900):
230.3s 1925 Calculated CFL: 0.800 > Limit: 0.500
230.3s 1926 Original dt: 4.115314e-01 s
230.3s 1927 Corrected dt: 2.572071e-01 s
230.3s 1928 Correction factor: 1.6x
230.3s 1929 Max wave speed detected: 19.44 m/s
230.6s 1930 Stored output at t = 60.0000 s (Step 231)
230.6s 1931 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
230.6s 1932 [A
230.6s 1933 
230.6s 1934 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.49s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.49s/s]
230.6s 1935 Simulation finished at t = 60.0000 s after 231 steps.
230.6s 1936 Total runtime: 2.18 seconds.
230.6s 1937 [BC UPDATE] left → phase 1 (inflow)
230.6s 1938 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
230.6s 1939 Running simulation until t = 120.00 s, outputting every 60.00 s
230.6s 1940 
230.8s 1941 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
231.2s 1942 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
231.3s 1943 [WARNING] Automatic CFL correction applied (count: 11000):
231.3s 1944 Calculated CFL: 0.800 > Limit: 0.500
231.3s 1945 Original dt: 4.114986e-01 s
231.3s 1946 Corrected dt: 2.571866e-01 s
231.3s 1947 Correction factor: 1.6x
231.3s 1948 Max wave speed detected: 19.44 m/s
231.7s 1949 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
232.2s 1950 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
232.2s 1951 [WARNING] Automatic CFL correction applied (count: 11100):
232.2s 1952 Calculated CFL: 0.800 > Limit: 0.500
232.2s 1953 Original dt: 4.114980e-01 s
232.2s 1954 Corrected dt: 2.571863e-01 s
232.2s 1955 Correction factor: 1.6x
232.2s 1956 Max wave speed detected: 19.44 m/s
232.7s 1957 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
232.8s 1958 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
232.8s 1959 [A
232.8s 1960 Stored output at t = 120.0000 s (Step 465)
232.8s 1961 
232.8s 1962 Simulation finished at t = 120.0000 s after 465 steps.
232.8s 1963 Total runtime: 2.20 seconds.
232.8s 1964 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s]
232.8s 1965 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
232.8s 1966 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
232.8s 1967 Using device: gpu
232.8s 1968 DEBUG PARAMS: Reading K_m_kmh = 10.0
232.8s 1969 DEBUG PARAMS: Reading K_c_kmh = 15.0
232.8s 1970 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
232.8s 1971 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
232.8s 1972 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
232.8s 1973 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
232.8s 1974 Loading road quality type: uniform
232.8s 1975 Uniform road quality value: 2
232.8s 1976 Road quality loaded.
232.8s 1977 Initial state created.
232.8s 1978 Transferring initial state and road quality to GPU...
232.8s 1979 GPU data transfer complete.
232.8s 1980 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
232.8s 1981 Initial boundary conditions applied.
232.8s 1982 [BC UPDATE] left → phase 0 (outflow)
232.8s 1983 └─ Outflow: zero-order extrapolation
232.8s 1984 [BC UPDATE] left → phase 1 (inflow)
232.8s 1985 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
232.8s 1986 Running simulation until t = 60.00 s, outputting every 60.00 s
232.8s 1987 
233.2s 1988 [WARNING] Automatic CFL correction applied (count: 11200):
233.2s 1989 Calculated CFL: 0.800 > Limit: 0.500
233.2s 1990 Original dt: 4.583403e-01 s
233.2s 1991 Corrected dt: 2.864627e-01 s
233.2s 1992 Correction factor: 1.6x
233.2s 1993 Max wave speed detected: 17.45 m/s
233.3s 1994 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
233.7s 1995 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
234.1s 1996 [WARNING] Automatic CFL correction applied (count: 11300):
234.1s 1997 Calculated CFL: 0.800 > Limit: 0.500
234.1s 1998 Original dt: 4.120137e-01 s
234.1s 1999 Corrected dt: 2.575085e-01 s
234.1s 2000 Correction factor: 1.6x
234.1s 2001 Max wave speed detected: 19.42 m/s
234.2s 2002 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
234.7s 2003 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
235.0s 2004 Stored output at t = 60.0000 s (Step 231)
235.0s 2005 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
235.0s 2006 [A
235.0s 2007 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.98s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.98s/s]
235.0s 2008 
235.0s 2009 Simulation finished at t = 60.0000 s after 231 steps.
235.0s 2010 Total runtime: 2.14 seconds.
235.0s 2011 [BC UPDATE] left → phase 0 (outflow)
235.0s 2012 └─ Outflow: zero-order extrapolation
235.0s 2013 Running simulation until t = 120.00 s, outputting every 60.00 s
235.0s 2014 
235.0s 2015 [WARNING] Automatic CFL correction applied (count: 11400):
235.0s 2016 Calculated CFL: 0.800 > Limit: 0.500
235.0s 2017 Original dt: 4.115064e-01 s
235.0s 2018 Corrected dt: 2.571915e-01 s
235.0s 2019 Correction factor: 1.6x
235.0s 2020 Max wave speed detected: 19.44 m/s
235.1s 2021 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
235.6s 2022 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
236.0s 2023 [WARNING] Automatic CFL correction applied (count: 11500):
236.0s 2024 Calculated CFL: 0.800 > Limit: 0.500
236.0s 2025 Original dt: 4.114982e-01 s
236.0s 2026 Corrected dt: 2.571864e-01 s
236.0s 2027 Correction factor: 1.6x
236.0s 2028 Max wave speed detected: 19.44 m/s
236.1s 2029 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
236.5s 2030 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
236.9s 2031 [WARNING] Automatic CFL correction applied (count: 11600):
236.9s 2032 Calculated CFL: 0.800 > Limit: 0.500
236.9s 2033 Original dt: 4.114980e-01 s
236.9s 2034 Corrected dt: 2.571863e-01 s
236.9s 2035 Correction factor: 1.6x
236.9s 2036 Max wave speed detected: 19.44 m/s
237.0s 2037 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
237.1s 2038 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
237.1s 2039 [A
237.1s 2040 Stored output at t = 120.0000 s (Step 465)
237.1s 2041 
237.1s 2042 Simulation finished at t = 120.0000 s after 465 steps.
237.1s 2043 Total runtime: 2.15 seconds.
237.1s 2044 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s]
237.1s 2045 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
237.1s 2046 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
237.1s 2047 Using device: gpu
237.1s 2048 DEBUG PARAMS: Reading K_m_kmh = 10.0
237.1s 2049 DEBUG PARAMS: Reading K_c_kmh = 15.0
237.1s 2050 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
237.1s 2051 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
237.1s 2052 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
237.1s 2053 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
237.1s 2054 Loading road quality type: uniform
237.1s 2055 Uniform road quality value: 2
237.1s 2056 Road quality loaded.
237.1s 2057 Initial state created.
237.1s 2058 Transferring initial state and road quality to GPU...
237.1s 2059 GPU data transfer complete.
237.1s 2060 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
237.1s 2061 Initial boundary conditions applied.
237.1s 2062 [BC UPDATE] left → phase 0 (outflow)
237.1s 2063 └─ Outflow: zero-order extrapolation
237.1s 2064 📊 Progress: 50/100 (50.0%) | ETA: 1.9 min | Speed: 0.4 steps/s
237.1s 2065 [BC UPDATE] left → phase 1 (inflow)
237.1s 2066 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
237.1s 2067 Running simulation until t = 60.00 s, outputting every 60.00 s
237.1s 2068 
237.6s 2069 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
237.8s 2070 [WARNING] Automatic CFL correction applied (count: 11700):
237.8s 2071 Calculated CFL: 0.800 > Limit: 0.500
237.8s 2072 Original dt: 4.205139e-01 s
237.8s 2073 Corrected dt: 2.628212e-01 s
237.8s 2074 Correction factor: 1.6x
237.8s 2075 Max wave speed detected: 19.02 m/s
238.1s 2076 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
238.5s 2077 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
238.7s 2078 [WARNING] Automatic CFL correction applied (count: 11800):
238.7s 2079 Calculated CFL: 0.800 > Limit: 0.500
238.7s 2080 Original dt: 4.116141e-01 s
238.7s 2081 Corrected dt: 2.572588e-01 s
238.7s 2082 Correction factor: 1.6x
238.7s 2083 Max wave speed detected: 19.44 m/s
239.0s 2084 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
239.3s 2085 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
239.3s 2086 Stored output at t = 60.0000 s (Step 231)
239.3s 2087 [A
239.3s 2088 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.23s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.23s/s]
239.3s 2089 
239.3s 2090 Simulation finished at t = 60.0000 s after 231 steps.
239.3s 2091 Total runtime: 2.13 seconds.
239.3s 2092 Running simulation until t = 120.00 s, outputting every 60.00 s
239.3s 2093 
239.4s 2094 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
239.7s 2095 [WARNING] Automatic CFL correction applied (count: 11900):
239.7s 2096 Calculated CFL: 0.800 > Limit: 0.500
239.7s 2097 Original dt: 4.115000e-01 s
239.7s 2098 Corrected dt: 2.571875e-01 s
239.7s 2099 Correction factor: 1.6x
239.7s 2100 Max wave speed detected: 19.44 m/s
239.9s 2101 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
240.4s 2102 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
240.6s 2103 [WARNING] Automatic CFL correction applied (count: 12000):
240.6s 2104 Calculated CFL: 0.800 > Limit: 0.500
240.6s 2105 Original dt: 4.114981e-01 s
240.6s 2106 Corrected dt: 2.571863e-01 s
240.6s 2107 Correction factor: 1.6x
240.6s 2108 Max wave speed detected: 19.44 m/s
240.8s 2109 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
241.3s 2110 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
241.4s 2111 Stored output at t = 120.0000 s (Step 465)
241.4s 2112 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
241.4s 2113 [A
241.4s 2114 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.59s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.59s/s]
241.4s 2115 
241.4s 2116 Simulation finished at t = 120.0000 s after 465 steps.
241.4s 2117 Total runtime: 2.18 seconds.
241.4s 2118 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
241.4s 2119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
241.4s 2120 Using device: gpu
241.5s 2121 DEBUG PARAMS: Reading K_m_kmh = 10.0
241.5s 2122 DEBUG PARAMS: Reading K_c_kmh = 15.0
241.5s 2123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
241.5s 2124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
241.5s 2125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
241.5s 2126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
241.5s 2127 Loading road quality type: uniform
241.5s 2128 Uniform road quality value: 2
241.5s 2129 Road quality loaded.
241.5s 2130 Initial state created.
241.5s 2131 Transferring initial state and road quality to GPU...
241.5s 2132 GPU data transfer complete.
241.5s 2133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
241.5s 2134 Initial boundary conditions applied.
241.5s 2135 [BC UPDATE] left → phase 0 (outflow)
241.5s 2136 └─ Outflow: zero-order extrapolation
241.5s 2137 [BC UPDATE] left → phase 1 (inflow)
241.5s 2138 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
241.5s 2139 Running simulation until t = 60.00 s, outputting every 60.00 s
241.5s 2140 
241.5s 2141 [WARNING] Automatic CFL correction applied (count: 12100):
241.5s 2142 Calculated CFL: 0.800 > Limit: 0.500
241.5s 2143 Original dt: 3.737254e-01 s
241.5s 2144 Corrected dt: 2.335784e-01 s
241.5s 2145 Correction factor: 1.6x
241.5s 2146 Max wave speed detected: 21.41 m/s
241.9s 2147 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
242.4s 2148 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
242.5s 2149 [WARNING] Automatic CFL correction applied (count: 12200):
242.5s 2150 Calculated CFL: 0.800 > Limit: 0.500
242.5s 2151 Original dt: 4.134305e-01 s
242.5s 2152 Corrected dt: 2.583941e-01 s
242.5s 2153 Correction factor: 1.6x
242.5s 2154 Max wave speed detected: 19.35 m/s
242.9s 2155 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
243.3s 2156 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
243.4s 2157 [WARNING] Automatic CFL correction applied (count: 12300):
243.4s 2158 Calculated CFL: 0.800 > Limit: 0.500
243.4s 2159 Original dt: 4.115259e-01 s
243.4s 2160 Corrected dt: 2.572037e-01 s
243.4s 2161 Correction factor: 1.6x
243.4s 2162 Max wave speed detected: 19.44 m/s
243.6s 2163 Stored output at t = 60.0000 s (Step 231)
243.6s 2164 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
243.6s 2165 [A
243.6s 2166 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.92s/s]
243.6s 2167 
243.6s 2168 Simulation finished at t = 60.0000 s after 231 steps.
243.6s 2169 Total runtime: 2.15 seconds.
243.6s 2170 Running simulation until t = 120.00 s, outputting every 60.00 s
243.6s 2171 
243.8s 2172 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
244.2s 2173 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
244.3s 2174 [WARNING] Automatic CFL correction applied (count: 12400):
244.3s 2175 Calculated CFL: 0.800 > Limit: 0.500
244.3s 2176 Original dt: 4.114985e-01 s
244.3s 2177 Corrected dt: 2.571866e-01 s
244.3s 2178 Correction factor: 1.6x
244.3s 2179 Max wave speed detected: 19.44 m/s
244.7s 2180 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
245.2s 2181 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
245.3s 2182 [WARNING] Automatic CFL correction applied (count: 12500):
245.3s 2183 Calculated CFL: 0.800 > Limit: 0.500
245.3s 2184 Original dt: 4.114980e-01 s
245.3s 2185 Corrected dt: 2.571863e-01 s
245.3s 2186 Correction factor: 1.6x
245.3s 2187 Max wave speed detected: 19.44 m/s
245.6s 2188 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
245.8s 2189 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
245.8s 2190 [A
245.8s 2191 Stored output at t = 120.0000 s (Step 465)
245.8s 2192 
245.8s 2193 Simulation finished at t = 120.0000 s after 465 steps.
245.8s 2194 Total runtime: 2.15 seconds.
245.8s 2195 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s]
245.8s 2196 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
245.8s 2197 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
245.8s 2198 Using device: gpu
245.8s 2199 DEBUG PARAMS: Reading K_m_kmh = 10.0
245.8s 2200 DEBUG PARAMS: Reading K_c_kmh = 15.0
245.8s 2201 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
245.8s 2202 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
245.8s 2203 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
245.8s 2204 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
245.8s 2205 Loading road quality type: uniform
245.8s 2206 Uniform road quality value: 2
245.8s 2207 Road quality loaded.
245.8s 2208 Initial state created.
245.8s 2209 Transferring initial state and road quality to GPU...
245.8s 2210 GPU data transfer complete.
245.8s 2211 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
245.8s 2212 Initial boundary conditions applied.
245.8s 2213 [BC UPDATE] left → phase 0 (outflow)
245.8s 2214 └─ Outflow: zero-order extrapolation
245.8s 2215 [BC UPDATE] left → phase 1 (inflow)
245.8s 2216 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
245.8s 2217 Running simulation until t = 60.00 s, outputting every 60.00 s
245.8s 2218 
246.2s 2219 [WARNING] Automatic CFL correction applied (count: 12600):
246.2s 2220 Calculated CFL: 0.800 > Limit: 0.500
246.2s 2221 Original dt: 4.470525e-01 s
246.2s 2222 Corrected dt: 2.794078e-01 s
246.2s 2223 Correction factor: 1.6x
246.2s 2224 Max wave speed detected: 17.89 m/s
246.2s 2225 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
246.7s 2226 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
247.2s 2227 [WARNING] Automatic CFL correction applied (count: 12700):
247.2s 2228 Calculated CFL: 0.800 > Limit: 0.500
247.2s 2229 Original dt: 4.119130e-01 s
247.2s 2230 Corrected dt: 2.574456e-01 s
247.2s 2231 Correction factor: 1.6x
247.2s 2232 Max wave speed detected: 19.42 m/s
247.2s 2233 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
247.7s 2234 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
248.0s 2235 Stored output at t = 60.0000 s (Step 231)
248.0s 2236 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
248.0s 2237 [A
248.0s 2238 
248.0s 2239 Simulation finished at t = 60.0000 s after 231 steps.
248.0s 2240 Total runtime: 2.19 seconds.
248.0s 2241 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.46s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.46s/s]
248.0s 2242 Running simulation until t = 120.00 s, outputting every 60.00 s
248.0s 2243 
248.1s 2244 [WARNING] Automatic CFL correction applied (count: 12800):
248.1s 2245 Calculated CFL: 0.800 > Limit: 0.500
248.1s 2246 Original dt: 4.115046e-01 s
248.1s 2247 Corrected dt: 2.571904e-01 s
248.1s 2248 Correction factor: 1.6x
248.1s 2249 Max wave speed detected: 19.44 m/s
248.1s 2250 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
248.6s 2251 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
249.0s 2252 [WARNING] Automatic CFL correction applied (count: 12900):
249.0s 2253 Calculated CFL: 0.800 > Limit: 0.500
249.0s 2254 Original dt: 4.114982e-01 s
249.0s 2255 Corrected dt: 2.571863e-01 s
249.0s 2256 Correction factor: 1.6x
249.0s 2257 Max wave speed detected: 19.44 m/s
249.1s 2258 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
249.6s 2259 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
250.0s 2260 [WARNING] Automatic CFL correction applied (count: 13000):
250.0s 2261 Calculated CFL: 0.800 > Limit: 0.500
250.0s 2262 Original dt: 4.114980e-01 s
250.0s 2263 Corrected dt: 2.571863e-01 s
250.0s 2264 Correction factor: 1.6x
250.0s 2265 Max wave speed detected: 19.44 m/s
250.1s 2266 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
250.2s 2267 Stored output at t = 120.0000 s (Step 465)
250.2s 2268 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
250.2s 2269 [A
250.2s 2270 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.70s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.70s/s]
250.2s 2271 
250.2s 2272 Simulation finished at t = 120.0000 s after 465 steps.
250.2s 2273 Total runtime: 2.25 seconds.
250.2s 2274 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
250.2s 2275 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
250.2s 2276 Using device: gpu
250.2s 2277 DEBUG PARAMS: Reading K_m_kmh = 10.0
250.2s 2278 DEBUG PARAMS: Reading K_c_kmh = 15.0
250.2s 2279 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
250.2s 2280 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
250.2s 2281 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
250.2s 2282 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
250.2s 2283 Loading road quality type: uniform
250.2s 2284 Uniform road quality value: 2
250.2s 2285 Road quality loaded.
250.2s 2286 Initial state created.
250.2s 2287 Transferring initial state and road quality to GPU...
250.2s 2288 GPU data transfer complete.
250.2s 2289 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
250.2s 2290 Initial boundary conditions applied.
250.2s 2291 [BC UPDATE] left → phase 0 (outflow)
250.2s 2292 └─ Outflow: zero-order extrapolation
250.2s 2293 Running simulation until t = 60.00 s, outputting every 60.00 s
250.2s 2294 
250.7s 2295 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
251.0s 2296 [WARNING] Automatic CFL correction applied (count: 13100):
251.0s 2297 Calculated CFL: 0.800 > Limit: 0.500
251.0s 2298 Original dt: 4.190346e-01 s
251.0s 2299 Corrected dt: 2.618967e-01 s
251.0s 2300 Correction factor: 1.6x
251.0s 2301 Max wave speed detected: 19.09 m/s
251.2s 2302 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
251.7s 2303 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
251.9s 2304 [WARNING] Automatic CFL correction applied (count: 13200):
251.9s 2305 Calculated CFL: 0.800 > Limit: 0.500
251.9s 2306 Original dt: 4.115954e-01 s
251.9s 2307 Corrected dt: 2.572472e-01 s
251.9s 2308 Correction factor: 1.6x
251.9s 2309 Max wave speed detected: 19.44 m/s
252.2s 2310 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
252.5s 2311 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
252.5s 2312 [A
252.5s 2313 Stored output at t = 60.0000 s (Step 231)
252.5s 2314 
252.5s 2315 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.02s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.02s/s]
252.5s 2316 Simulation finished at t = 60.0000 s after 231 steps.
252.5s 2317 Total runtime: 2.22 seconds.
252.5s 2318 [BC UPDATE] left → phase 1 (inflow)
252.5s 2319 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
252.5s 2320 Running simulation until t = 120.00 s, outputting every 60.00 s
252.5s 2321 
252.6s 2322 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
252.9s 2323 [WARNING] Automatic CFL correction applied (count: 13300):
252.9s 2324 Calculated CFL: 0.800 > Limit: 0.500
252.9s 2325 Original dt: 4.114996e-01 s
252.9s 2326 Corrected dt: 2.571873e-01 s
252.9s 2327 Correction factor: 1.6x
252.9s 2328 Max wave speed detected: 19.44 m/s
253.1s 2329 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
253.6s 2330 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
253.8s 2331 [WARNING] Automatic CFL correction applied (count: 13400):
253.8s 2332 Calculated CFL: 0.800 > Limit: 0.500
253.8s 2333 Original dt: 4.114981e-01 s
253.8s 2334 Corrected dt: 2.571863e-01 s
253.8s 2335 Correction factor: 1.6x
253.8s 2336 Max wave speed detected: 19.44 m/s
254.0s 2337 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
254.5s 2338 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
254.6s 2339 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
254.6s 2340 Stored output at t = 120.0000 s (Step 465)
254.6s 2341 [A
254.6s 2342 
254.6s 2343 Simulation finished at t = 120.0000 s after 465 steps.
254.6s 2344 Total runtime: 2.17 seconds.
254.6s 2345 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.67s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.66s/s]
254.6s 2346 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
254.6s 2347 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
254.6s 2348 Using device: gpu
254.6s 2349 DEBUG PARAMS: Reading K_m_kmh = 10.0
254.6s 2350 DEBUG PARAMS: Reading K_c_kmh = 15.0
254.6s 2351 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
254.6s 2352 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
254.6s 2353 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
254.6s 2354 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
254.6s 2355 Loading road quality type: uniform
254.6s 2356 Uniform road quality value: 2
254.6s 2357 Road quality loaded.
254.6s 2358 Initial state created.
254.6s 2359 Transferring initial state and road quality to GPU...
254.6s 2360 GPU data transfer complete.
254.6s 2361 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
254.6s 2362 Initial boundary conditions applied.
254.6s 2363 [BC UPDATE] left → phase 0 (outflow)
254.6s 2364 └─ Outflow: zero-order extrapolation
254.6s 2365 Running simulation until t = 60.00 s, outputting every 60.00 s
254.6s 2366 
254.8s 2367 [WARNING] Automatic CFL correction applied (count: 13500):
254.8s 2368 Calculated CFL: 0.800 > Limit: 0.500
254.8s 2369 Original dt: 4.022422e-01 s
254.8s 2370 Corrected dt: 2.514014e-01 s
254.8s 2371 Correction factor: 1.6x
254.8s 2372 Max wave speed detected: 19.89 m/s
255.1s 2373 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
255.6s 2374 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
255.7s 2375 [WARNING] Automatic CFL correction applied (count: 13600):
255.7s 2376 Calculated CFL: 0.800 > Limit: 0.500
255.7s 2377 Original dt: 4.130229e-01 s
255.7s 2378 Corrected dt: 2.581393e-01 s
255.7s 2379 Correction factor: 1.6x
255.7s 2380 Max wave speed detected: 19.37 m/s
256.5s 2381 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
256.9s 2382 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
257.1s 2383 [WARNING] Automatic CFL correction applied (count: 13700):
257.1s 2384 Calculated CFL: 0.800 > Limit: 0.500
257.1s 2385 Original dt: 4.115198e-01 s
257.1s 2386 Corrected dt: 2.571999e-01 s
257.1s 2387 Correction factor: 1.6x
257.1s 2388 Max wave speed detected: 19.44 m/s
257.2s 2389 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
257.2s 2390 [A
257.2s 2391 Stored output at t = 60.0000 s (Step 231)
257.2s 2392 
257.2s 2393 Simulation finished at t = 60.0000 s after 231 steps.
257.2s 2394 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.34s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.34s/s]
257.2s 2395 Total runtime: 2.57 seconds.
257.2s 2396 [BC UPDATE] left → phase 1 (inflow)
257.2s 2397 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
257.2s 2398 Running simulation until t = 120.00 s, outputting every 60.00 s
257.2s 2399 
257.4s 2400 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
257.9s 2401 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
258.0s 2402 [WARNING] Automatic CFL correction applied (count: 13800):
258.0s 2403 Calculated CFL: 0.800 > Limit: 0.500
258.0s 2404 Original dt: 4.114984e-01 s
258.0s 2405 Corrected dt: 2.571865e-01 s
258.0s 2406 Correction factor: 1.6x
258.0s 2407 Max wave speed detected: 19.44 m/s
258.3s 2408 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
258.8s 2409 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
258.9s 2410 [WARNING] Automatic CFL correction applied (count: 13900):
258.9s 2411 Calculated CFL: 0.800 > Limit: 0.500
258.9s 2412 Original dt: 4.114980e-01 s
258.9s 2413 Corrected dt: 2.571863e-01 s
258.9s 2414 Correction factor: 1.6x
258.9s 2415 Max wave speed detected: 19.44 m/s
259.3s 2416 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
259.4s 2417 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
259.4s 2418 [A
259.4s 2419 Stored output at t = 120.0000 s (Step 465)
259.4s 2420 
259.4s 2421 Simulation finished at t = 120.0000 s after 465 steps.
259.4s 2422 Total runtime: 2.19 seconds.
259.4s 2423 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.37s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.37s/s]
259.4s 2424 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
259.4s 2425 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
259.4s 2426 Using device: gpu
259.4s 2427 DEBUG PARAMS: Reading K_m_kmh = 10.0
259.4s 2428 DEBUG PARAMS: Reading K_c_kmh = 15.0
259.4s 2429 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
259.4s 2430 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
259.4s 2431 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
259.4s 2432 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
259.4s 2433 Loading road quality type: uniform
259.4s 2434 Uniform road quality value: 2
259.4s 2435 Road quality loaded.
259.4s 2436 Initial state created.
259.4s 2437 Transferring initial state and road quality to GPU...
259.4s 2438 GPU data transfer complete.
259.4s 2439 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
259.4s 2440 Initial boundary conditions applied.
259.4s 2441 [BC UPDATE] left → phase 0 (outflow)
259.4s 2442 └─ Outflow: zero-order extrapolation
259.4s 2443 Running simulation until t = 60.00 s, outputting every 60.00 s
259.4s 2444 
259.9s 2445 [WARNING] Automatic CFL correction applied (count: 14000):
259.9s 2446 Calculated CFL: 0.800 > Limit: 0.500
259.9s 2447 Original dt: 4.396418e-01 s
259.9s 2448 Corrected dt: 2.747761e-01 s
259.9s 2449 Correction factor: 1.6x
259.9s 2450 Max wave speed detected: 18.20 m/s
259.9s 2451 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
260.4s 2452 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
260.8s 2453 [WARNING] Automatic CFL correction applied (count: 14100):
260.8s 2454 Calculated CFL: 0.800 > Limit: 0.500
260.8s 2455 Original dt: 4.118393e-01 s
260.8s 2456 Corrected dt: 2.573996e-01 s
260.8s 2457 Correction factor: 1.6x
260.8s 2458 Max wave speed detected: 19.43 m/s
260.8s 2459 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
261.3s 2460 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
261.6s 2461 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
261.6s 2462 [A
261.6s 2463 Stored output at t = 60.0000 s (Step 231)
261.6s 2464 
261.6s 2465 Simulation finished at t = 60.0000 s after 231 steps.
261.6s 2466 Total runtime: 2.17 seconds.
261.6s 2467 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.65s/s]
261.6s 2468 [BC UPDATE] left → phase 1 (inflow)
261.6s 2469 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
261.6s 2470 Running simulation until t = 120.00 s, outputting every 60.00 s
261.6s 2471 
261.8s 2472 [WARNING] Automatic CFL correction applied (count: 14200):
261.8s 2473 Calculated CFL: 0.800 > Limit: 0.500
261.8s 2474 Original dt: 4.115033e-01 s
261.8s 2475 Corrected dt: 2.571896e-01 s
261.8s 2476 Correction factor: 1.6x
261.8s 2477 Max wave speed detected: 19.44 m/s
261.8s 2478 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
262.3s 2479 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
262.7s 2480 [WARNING] Automatic CFL correction applied (count: 14300):
262.7s 2481 Calculated CFL: 0.800 > Limit: 0.500
262.7s 2482 Original dt: 4.114981e-01 s
262.7s 2483 Corrected dt: 2.571863e-01 s
262.7s 2484 Correction factor: 1.6x
262.7s 2485 Max wave speed detected: 19.44 m/s
262.7s 2486 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
263.2s 2487 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
263.7s 2488 [WARNING] Automatic CFL correction applied (count: 14400):
263.7s 2489 Calculated CFL: 0.800 > Limit: 0.500
263.7s 2490 Original dt: 4.114980e-01 s
263.7s 2491 Corrected dt: 2.571863e-01 s
263.7s 2492 Correction factor: 1.6x
263.7s 2493 Max wave speed detected: 19.44 m/s
263.7s 2494 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
263.8s 2495 Stored output at t = 120.0000 s (Step 465)
263.8s 2496 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
263.8s 2497 [A
263.8s 2498 
263.8s 2499 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s]
263.8s 2500 Simulation finished at t = 120.0000 s after 465 steps.
263.8s 2501 Total runtime: 2.20 seconds.
263.8s 2502 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
263.8s 2503 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
263.8s 2504 Using device: gpu
263.8s 2505 DEBUG PARAMS: Reading K_m_kmh = 10.0
263.8s 2506 DEBUG PARAMS: Reading K_c_kmh = 15.0
263.8s 2507 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
263.8s 2508 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
263.8s 2509 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
263.8s 2510 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
263.8s 2511 Loading road quality type: uniform
263.8s 2512 Uniform road quality value: 2
263.8s 2513 Road quality loaded.
263.8s 2514 Initial state created.
263.8s 2515 Transferring initial state and road quality to GPU...
263.8s 2516 GPU data transfer complete.
263.8s 2517 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
263.8s 2518 Initial boundary conditions applied.
263.8s 2519 [BC UPDATE] left → phase 0 (outflow)
263.8s 2520 └─ Outflow: zero-order extrapolation
263.8s 2521 [BC UPDATE] left → phase 1 (inflow)
263.8s 2522 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
263.8s 2523 Running simulation until t = 60.00 s, outputting every 60.00 s
263.8s 2524 
264.3s 2525 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
264.6s 2526 [WARNING] Automatic CFL correction applied (count: 14500):
264.6s 2527 Calculated CFL: 0.800 > Limit: 0.500
264.6s 2528 Original dt: 4.173029e-01 s
264.6s 2529 Corrected dt: 2.608143e-01 s
264.6s 2530 Correction factor: 1.6x
264.6s 2531 Max wave speed detected: 19.17 m/s
264.8s 2532 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
265.2s 2533 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
265.5s 2534 [WARNING] Automatic CFL correction applied (count: 14600):
265.5s 2535 Calculated CFL: 0.800 > Limit: 0.500
265.5s 2536 Original dt: 4.115760e-01 s
265.5s 2537 Corrected dt: 2.572350e-01 s
265.5s 2538 Correction factor: 1.6x
265.5s 2539 Max wave speed detected: 19.44 m/s
265.7s 2540 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
266.0s 2541 Stored output at t = 60.0000 s (Step 231)
266.0s 2542 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
266.0s 2543 [A
266.0s 2544 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s]
266.0s 2545 
266.0s 2546 Simulation finished at t = 60.0000 s after 231 steps.
266.0s 2547 Total runtime: 2.16 seconds.
266.0s 2548 Running simulation until t = 120.00 s, outputting every 60.00 s
266.0s 2549 
266.2s 2550 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
266.5s 2551 [WARNING] Automatic CFL correction applied (count: 14700):
266.5s 2552 Calculated CFL: 0.800 > Limit: 0.500
266.5s 2553 Original dt: 4.114993e-01 s
266.5s 2554 Corrected dt: 2.571871e-01 s
266.5s 2555 Correction factor: 1.6x
266.5s 2556 Max wave speed detected: 19.44 m/s
266.6s 2557 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
267.1s 2558 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
267.4s 2559 [WARNING] Automatic CFL correction applied (count: 14800):
267.4s 2560 Calculated CFL: 0.800 > Limit: 0.500
267.4s 2561 Original dt: 4.114981e-01 s
267.4s 2562 Corrected dt: 2.571863e-01 s
267.4s 2563 Correction factor: 1.6x
267.4s 2564 Max wave speed detected: 19.44 m/s
267.6s 2565 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
268.1s 2566 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
268.2s 2567 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
268.2s 2568 [A
268.2s 2569 Stored output at t = 120.0000 s (Step 465)
268.2s 2570 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.06s/s]
268.2s 2571 
268.2s 2572 Simulation finished at t = 120.0000 s after 465 steps.
268.2s 2573 Total runtime: 2.22 seconds.
268.2s 2574 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
268.2s 2575 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
268.2s 2576 Using device: gpu
268.2s 2577 DEBUG PARAMS: Reading K_m_kmh = 10.0
268.2s 2578 DEBUG PARAMS: Reading K_c_kmh = 15.0
268.2s 2579 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
268.2s 2580 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
268.2s 2581 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
268.2s 2582 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
268.2s 2583 Loading road quality type: uniform
268.2s 2584 Uniform road quality value: 2
268.2s 2585 Road quality loaded.
268.2s 2586 Initial state created.
268.2s 2587 Transferring initial state and road quality to GPU...
268.2s 2588 GPU data transfer complete.
268.2s 2589 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
268.2s 2590 Initial boundary conditions applied.
268.2s 2591 [BC UPDATE] left → phase 0 (outflow)
268.2s 2592 └─ Outflow: zero-order extrapolation
268.2s 2593 Running simulation until t = 60.00 s, outputting every 60.00 s
268.2s 2594 
268.4s 2595 [WARNING] Automatic CFL correction applied (count: 14900):
268.4s 2596 Calculated CFL: 0.800 > Limit: 0.500
268.4s 2597 Original dt: 4.295974e-01 s
268.4s 2598 Corrected dt: 2.684983e-01 s
268.4s 2599 Correction factor: 1.6x
268.4s 2600 Max wave speed detected: 18.62 m/s
268.7s 2601 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
269.2s 2602 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
269.3s 2603 [WARNING] Automatic CFL correction applied (count: 15000):
269.3s 2604 Calculated CFL: 0.800 > Limit: 0.500
269.3s 2605 Original dt: 4.127253e-01 s
269.3s 2606 Corrected dt: 2.579533e-01 s
269.3s 2607 Correction factor: 1.6x
269.3s 2608 Max wave speed detected: 19.38 m/s
269.6s 2609 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
270.1s 2610 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
270.3s 2611 [WARNING] Automatic CFL correction applied (count: 15100):
270.3s 2612 Calculated CFL: 0.800 > Limit: 0.500
270.3s 2613 Original dt: 4.115153e-01 s
270.3s 2614 Corrected dt: 2.571971e-01 s
270.3s 2615 Correction factor: 1.6x
270.3s 2616 Max wave speed detected: 19.44 m/s
270.4s 2617 Stored output at t = 60.0000 s (Step 231)
270.4s 2618 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
270.4s 2619 [A
270.4s 2620 
270.4s 2621 Simulation finished at t = 60.0000 s after 231 steps.
270.4s 2622 Total runtime: 2.19 seconds.
270.4s 2623 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.37s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.37s/s]
270.4s 2624 Running simulation until t = 120.00 s, outputting every 60.00 s
270.4s 2625 
270.6s 2626 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
271.1s 2627 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
271.2s 2628 [WARNING] Automatic CFL correction applied (count: 15200):
271.2s 2629 Calculated CFL: 0.800 > Limit: 0.500
271.2s 2630 Original dt: 4.114984e-01 s
271.2s 2631 Corrected dt: 2.571865e-01 s
271.2s 2632 Correction factor: 1.6x
271.2s 2633 Max wave speed detected: 19.44 m/s
271.5s 2634 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
272.0s 2635 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
272.2s 2636 [WARNING] Automatic CFL correction applied (count: 15300):
272.2s 2637 Calculated CFL: 0.800 > Limit: 0.500
272.2s 2638 Original dt: 4.114980e-01 s
272.2s 2639 Corrected dt: 2.571863e-01 s
272.2s 2640 Correction factor: 1.6x
272.2s 2641 Max wave speed detected: 19.44 m/s
272.5s 2642 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
272.6s 2643 Stored output at t = 120.0000 s (Step 465)
272.6s 2644 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
272.6s 2645 [A
272.6s 2646 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.02s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.02s/s]
272.6s 2647 
272.6s 2648 Simulation finished at t = 120.0000 s after 465 steps.
272.6s 2649 Total runtime: 2.22 seconds.
272.6s 2650 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
272.6s 2651 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
272.6s 2652 Using device: gpu
272.6s 2653 DEBUG PARAMS: Reading K_m_kmh = 10.0
272.6s 2654 DEBUG PARAMS: Reading K_c_kmh = 15.0
272.6s 2655 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
272.6s 2656 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
272.6s 2657 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
272.6s 2658 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
272.6s 2659 Loading road quality type: uniform
272.6s 2660 Uniform road quality value: 2
272.6s 2661 Road quality loaded.
272.6s 2662 Initial state created.
272.6s 2663 Transferring initial state and road quality to GPU...
272.6s 2664 GPU data transfer complete.
272.6s 2665 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
272.6s 2666 Initial boundary conditions applied.
272.6s 2667 [BC UPDATE] left → phase 0 (outflow)
272.6s 2668 └─ Outflow: zero-order extrapolation
272.6s 2669 [BC UPDATE] left → phase 1 (inflow)
272.6s 2670 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
272.6s 2671 Running simulation until t = 60.00 s, outputting every 60.00 s
272.6s 2672 
273.1s 2673 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
273.1s 2674 [WARNING] Automatic CFL correction applied (count: 15400):
273.1s 2675 Calculated CFL: 0.800 > Limit: 0.500
273.1s 2676 Original dt: 4.346596e-01 s
273.1s 2677 Corrected dt: 2.716622e-01 s
273.1s 2678 Correction factor: 1.6x
273.1s 2679 Max wave speed detected: 18.41 m/s
273.6s 2680 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
274.0s 2681 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
274.1s 2682 [WARNING] Automatic CFL correction applied (count: 15500):
274.1s 2683 Calculated CFL: 0.800 > Limit: 0.500
274.1s 2684 Original dt: 4.117853e-01 s
274.1s 2685 Corrected dt: 2.573658e-01 s
274.1s 2686 Correction factor: 1.6x
274.1s 2687 Max wave speed detected: 19.43 m/s
274.5s 2688 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
274.8s 2689 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
274.8s 2690 [A
274.8s 2691 Stored output at t = 60.0000 s (Step 231)
274.8s 2692 
274.8s 2693 Simulation finished at t = 60.0000 s after 231 steps.
274.8s 2694 Total runtime: 2.16 seconds.
274.8s 2695 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.80s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.80s/s]
274.8s 2696 Running simulation until t = 120.00 s, outputting every 60.00 s
274.8s 2697 
275.0s 2698 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
275.0s 2699 [WARNING] Automatic CFL correction applied (count: 15600):
275.0s 2700 Calculated CFL: 0.800 > Limit: 0.500
275.0s 2701 Original dt: 4.115023e-01 s
275.0s 2702 Corrected dt: 2.571890e-01 s
275.0s 2703 Correction factor: 1.6x
275.0s 2704 Max wave speed detected: 19.44 m/s
275.5s 2705 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
275.9s 2706 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
276.0s 2707 [WARNING] Automatic CFL correction applied (count: 15700):
276.0s 2708 Calculated CFL: 0.800 > Limit: 0.500
276.0s 2709 Original dt: 4.114981e-01 s
276.0s 2710 Corrected dt: 2.571863e-01 s
276.0s 2711 Correction factor: 1.6x
276.0s 2712 Max wave speed detected: 19.44 m/s
276.4s 2713 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
276.9s 2714 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
276.9s 2715 [WARNING] Automatic CFL correction applied (count: 15800):
276.9s 2716 Calculated CFL: 0.800 > Limit: 0.500
276.9s 2717 Original dt: 4.114980e-01 s
276.9s 2718 Corrected dt: 2.571863e-01 s
276.9s 2719 Correction factor: 1.6x
276.9s 2720 Max wave speed detected: 19.44 m/s
277.0s 2721 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
277.0s 2722 [A
277.0s 2723 Stored output at t = 120.0000 s (Step 465)
277.0s 2724 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.97s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.96s/s]
277.0s 2725 
277.0s 2726 Simulation finished at t = 120.0000 s after 465 steps.
277.0s 2727 Total runtime: 2.23 seconds.
277.0s 2728 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
277.0s 2729 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
277.0s 2730 Using device: gpu
277.0s 2731 DEBUG PARAMS: Reading K_m_kmh = 10.0
277.0s 2732 DEBUG PARAMS: Reading K_c_kmh = 15.0
277.0s 2733 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
277.0s 2734 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
277.0s 2735 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
277.0s 2736 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
277.0s 2737 Loading road quality type: uniform
277.0s 2738 Uniform road quality value: 2
277.0s 2739 Road quality loaded.
277.0s 2740 Initial state created.
277.0s 2741 Transferring initial state and road quality to GPU...
277.0s 2742 GPU data transfer complete.
277.0s 2743 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
277.0s 2744 Initial boundary conditions applied.
277.0s 2745 [BC UPDATE] left → phase 0 (outflow)
277.0s 2746 └─ Outflow: zero-order extrapolation
277.0s 2747 [BC UPDATE] left → phase 1 (inflow)
277.0s 2748 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
277.0s 2749 Running simulation until t = 60.00 s, outputting every 60.00 s
277.0s 2750 
277.5s 2751 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
277.9s 2752 [WARNING] Automatic CFL correction applied (count: 15900):
277.9s 2753 Calculated CFL: 0.800 > Limit: 0.500
277.9s 2754 Original dt: 4.160552e-01 s
277.9s 2755 Corrected dt: 2.600345e-01 s
277.9s 2756 Correction factor: 1.6x
277.9s 2757 Max wave speed detected: 19.23 m/s
278.0s 2758 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
278.4s 2759 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
278.8s 2760 [WARNING] Automatic CFL correction applied (count: 16000):
278.8s 2761 Calculated CFL: 0.800 > Limit: 0.500
278.8s 2762 Original dt: 4.115592e-01 s
278.8s 2763 Corrected dt: 2.572245e-01 s
278.8s 2764 Correction factor: 1.6x
278.8s 2765 Max wave speed detected: 19.44 m/s
278.9s 2766 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
279.2s 2767 Stored output at t = 60.0000 s (Step 231)
279.2s 2768 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
279.2s 2769 [A
279.2s 2770 
279.2s 2771 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s]
279.2s 2772 Simulation finished at t = 60.0000 s after 231 steps.
279.2s 2773 Total runtime: 2.16 seconds.
279.2s 2774 [BC UPDATE] left → phase 0 (outflow)
279.2s 2775 └─ Outflow: zero-order extrapolation
279.2s 2776 Running simulation until t = 120.00 s, outputting every 60.00 s
279.2s 2777 
279.4s 2778 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
279.8s 2779 [WARNING] Automatic CFL correction applied (count: 16100):
279.8s 2780 Calculated CFL: 0.800 > Limit: 0.500
279.8s 2781 Original dt: 4.114991e-01 s
279.8s 2782 Corrected dt: 2.571870e-01 s
279.8s 2783 Correction factor: 1.6x
279.8s 2784 Max wave speed detected: 19.44 m/s
279.9s 2785 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
280.3s 2786 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
280.7s 2787 [WARNING] Automatic CFL correction applied (count: 16200):
280.7s 2788 Calculated CFL: 0.800 > Limit: 0.500
280.7s 2789 Original dt: 4.114980e-01 s
280.7s 2790 Corrected dt: 2.571863e-01 s
280.7s 2791 Correction factor: 1.6x
280.7s 2792 Max wave speed detected: 19.44 m/s
280.8s 2793 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
281.3s 2794 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
281.4s 2795 Stored output at t = 120.0000 s (Step 465)
281.4s 2796 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
281.4s 2797 [A
281.4s 2798 
281.4s 2799 Simulation finished at t = 120.0000 s after 465 steps.
281.4s 2800 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.42s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s]
281.4s 2801 Total runtime: 2.19 seconds.
281.4s 2802 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
281.4s 2803 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
281.4s 2804 Using device: gpu
281.4s 2805 DEBUG PARAMS: Reading K_m_kmh = 10.0
281.4s 2806 DEBUG PARAMS: Reading K_c_kmh = 15.0
281.4s 2807 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
281.4s 2808 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
281.4s 2809 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
281.4s 2810 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
281.4s 2811 Loading road quality type: uniform
281.4s 2812 Uniform road quality value: 2
281.4s 2813 Road quality loaded.
281.4s 2814 Initial state created.
281.4s 2815 Transferring initial state and road quality to GPU...
281.4s 2816 GPU data transfer complete.
281.4s 2817 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
281.4s 2818 Initial boundary conditions applied.
281.4s 2819 [BC UPDATE] left → phase 0 (outflow)
281.4s 2820 └─ Outflow: zero-order extrapolation
281.4s 2821 [BC UPDATE] left → phase 1 (inflow)
281.4s 2822 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
281.4s 2823 Running simulation until t = 60.00 s, outputting every 60.00 s
281.4s 2824 
281.6s 2825 [WARNING] Automatic CFL correction applied (count: 16300):
281.6s 2826 Calculated CFL: 0.800 > Limit: 0.500
281.6s 2827 Original dt: 4.547467e-01 s
281.6s 2828 Corrected dt: 2.842167e-01 s
281.6s 2829 Correction factor: 1.6x
281.6s 2830 Max wave speed detected: 17.59 m/s
281.9s 2831 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
282.4s 2832 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
282.6s 2833 [WARNING] Automatic CFL correction applied (count: 16400):
282.6s 2834 Calculated CFL: 0.800 > Limit: 0.500
282.6s 2835 Original dt: 4.125079e-01 s
282.6s 2836 Corrected dt: 2.578175e-01 s
282.6s 2837 Correction factor: 1.6x
282.6s 2838 Max wave speed detected: 19.39 m/s
282.8s 2839 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
283.3s 2840 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
283.5s 2841 [WARNING] Automatic CFL correction applied (count: 16500):
283.5s 2842 Calculated CFL: 0.800 > Limit: 0.500
283.5s 2843 Original dt: 4.115121e-01 s
283.5s 2844 Corrected dt: 2.571950e-01 s
283.5s 2845 Correction factor: 1.6x
283.5s 2846 Max wave speed detected: 19.44 m/s
283.6s 2847 Stored output at t = 60.0000 s (Step 231)
283.6s 2848 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
283.6s 2849 [A
283.6s 2850 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s]
283.6s 2851 
283.6s 2852 Simulation finished at t = 60.0000 s after 231 steps.
283.6s 2853 Total runtime: 2.18 seconds.
283.6s 2854 Running simulation until t = 120.00 s, outputting every 60.00 s
283.6s 2855 
283.8s 2856 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
284.2s 2857 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
284.5s 2858 [WARNING] Automatic CFL correction applied (count: 16600):
284.5s 2859 Calculated CFL: 0.800 > Limit: 0.500
284.5s 2860 Original dt: 4.114983e-01 s
284.5s 2861 Corrected dt: 2.571865e-01 s
284.5s 2862 Correction factor: 1.6x
284.5s 2863 Max wave speed detected: 19.44 m/s
284.7s 2864 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
285.2s 2865 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
285.4s 2866 [WARNING] Automatic CFL correction applied (count: 16700):
285.4s 2867 Calculated CFL: 0.800 > Limit: 0.500
285.4s 2868 Original dt: 4.114980e-01 s
285.4s 2869 Corrected dt: 2.571863e-01 s
285.4s 2870 Correction factor: 1.6x
285.4s 2871 Max wave speed detected: 19.44 m/s
285.6s 2872 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
285.8s 2873 Stored output at t = 120.0000 s (Step 465)
285.8s 2874 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
285.8s 2875 [A
285.8s 2876 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s]
285.8s 2877 
285.8s 2878 Simulation finished at t = 120.0000 s after 465 steps.
285.8s 2879 Total runtime: 2.15 seconds.
285.8s 2880 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
285.8s 2881 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
285.8s 2882 Using device: gpu
285.8s 2883 DEBUG PARAMS: Reading K_m_kmh = 10.0
285.8s 2884 DEBUG PARAMS: Reading K_c_kmh = 15.0
285.8s 2885 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
285.8s 2886 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
285.8s 2887 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
285.8s 2888 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
285.8s 2889 Loading road quality type: uniform
285.8s 2890 Uniform road quality value: 2
285.8s 2891 Road quality loaded.
285.8s 2892 Initial state created.
285.8s 2893 Transferring initial state and road quality to GPU...
285.8s 2894 GPU data transfer complete.
285.8s 2895 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
285.8s 2896 Initial boundary conditions applied.
285.8s 2897 [BC UPDATE] left → phase 0 (outflow)
285.8s 2898 └─ Outflow: zero-order extrapolation
285.8s 2899 [BC UPDATE] left → phase 1 (inflow)
285.8s 2900 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
285.8s 2901 Running simulation until t = 60.00 s, outputting every 60.00 s
285.8s 2902 
286.2s 2903 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
286.3s 2904 [WARNING] Automatic CFL correction applied (count: 16800):
286.3s 2905 Calculated CFL: 0.800 > Limit: 0.500
286.3s 2906 Original dt: 4.295897e-01 s
286.3s 2907 Corrected dt: 2.684936e-01 s
286.3s 2908 Correction factor: 1.6x
286.3s 2909 Max wave speed detected: 18.62 m/s
286.7s 2910 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
287.2s 2911 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
287.3s 2912 [WARNING] Automatic CFL correction applied (count: 16900):
287.3s 2913 Calculated CFL: 0.800 > Limit: 0.500
287.3s 2914 Original dt: 4.117215e-01 s
287.3s 2915 Corrected dt: 2.573259e-01 s
287.3s 2916 Correction factor: 1.6x
287.3s 2917 Max wave speed detected: 19.43 m/s
287.6s 2918 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
287.9s 2919 Stored output at t = 60.0000 s (Step 231)
287.9s 2920 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
287.9s 2921 [A
287.9s 2922 
287.9s 2923 Simulation finished at t = 60.0000 s after 231 steps.
287.9s 2924 Total runtime: 2.15 seconds.
287.9s 2925 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.97s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.97s/s]
287.9s 2926 Running simulation until t = 120.00 s, outputting every 60.00 s
287.9s 2927 
288.1s 2928 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
288.2s 2929 [WARNING] Automatic CFL correction applied (count: 17000):
288.2s 2930 Calculated CFL: 0.800 > Limit: 0.500
288.2s 2931 Original dt: 4.115016e-01 s
288.2s 2932 Corrected dt: 2.571885e-01 s
288.2s 2933 Correction factor: 1.6x
288.2s 2934 Max wave speed detected: 19.44 m/s
288.6s 2935 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
289.0s 2936 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
289.1s 2937 [WARNING] Automatic CFL correction applied (count: 17100):
289.1s 2938 Calculated CFL: 0.800 > Limit: 0.500
289.1s 2939 Original dt: 4.114981e-01 s
289.1s 2940 Corrected dt: 2.571863e-01 s
289.1s 2941 Correction factor: 1.6x
289.1s 2942 Max wave speed detected: 19.44 m/s
289.5s 2943 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
289.9s 2944 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
290.0s 2945 [WARNING] Automatic CFL correction applied (count: 17200):
290.0s 2946 Calculated CFL: 0.800 > Limit: 0.500
290.0s 2947 Original dt: 4.114980e-01 s
290.0s 2948 Corrected dt: 2.571863e-01 s
290.0s 2949 Correction factor: 1.6x
290.0s 2950 Max wave speed detected: 19.44 m/s
290.1s 2951 Stored output at t = 120.0000 s (Step 465)
290.1s 2952 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
290.1s 2953 [A
290.1s 2954 
290.1s 2955 Simulation finished at t = 120.0000 s after 465 steps.
290.1s 2956 Total runtime: 2.16 seconds.
290.1s 2957 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.76s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.75s/s]
290.1s 2958 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
290.1s 2959 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
290.1s 2960 Using device: gpu
290.1s 2961 DEBUG PARAMS: Reading K_m_kmh = 10.0
290.1s 2962 DEBUG PARAMS: Reading K_c_kmh = 15.0
290.1s 2963 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
290.1s 2964 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
290.1s 2965 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
290.1s 2966 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
290.1s 2967 Loading road quality type: uniform
290.1s 2968 Uniform road quality value: 2
290.1s 2969 Road quality loaded.
290.1s 2970 Initial state created.
290.1s 2971 Transferring initial state and road quality to GPU...
290.1s 2972 GPU data transfer complete.
290.1s 2973 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
290.1s 2974 Initial boundary conditions applied.
290.1s 2975 [BC UPDATE] left → phase 0 (outflow)
290.1s 2976 └─ Outflow: zero-order extrapolation
290.1s 2977 Running simulation until t = 60.00 s, outputting every 60.00 s
290.1s 2978 
290.6s 2979 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
291.0s 2980 [WARNING] Automatic CFL correction applied (count: 17300):
291.0s 2981 Calculated CFL: 0.800 > Limit: 0.500
291.0s 2982 Original dt: 4.151534e-01 s
291.0s 2983 Corrected dt: 2.594709e-01 s
291.0s 2984 Correction factor: 1.6x
291.0s 2985 Max wave speed detected: 19.27 m/s
291.0s 2986 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
291.5s 2987 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
291.9s 2988 [WARNING] Automatic CFL correction applied (count: 17400):
291.9s 2989 Calculated CFL: 0.800 > Limit: 0.500
291.9s 2990 Original dt: 4.115470e-01 s
291.9s 2991 Corrected dt: 2.572169e-01 s
291.9s 2992 Correction factor: 1.6x
291.9s 2993 Max wave speed detected: 19.44 m/s
291.9s 2994 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
292.2s 2995 Stored output at t = 60.0000 s (Step 231)
292.2s 2996 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
292.2s 2997 [A
292.2s 2998 
292.2s 2999 Simulation finished at t = 60.0000 s after 231 steps.
292.2s 3000 Total runtime: 2.15 seconds.
292.2s 3001 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.91s/s]
292.2s 3002 
292.2s 3003 [BC UPDATE] left → phase 1 (inflow)
292.2s 3004 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
292.2s 3005 Running simulation until t = 120.00 s, outputting every 60.00 s
292.4s 3006 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
292.8s 3007 [WARNING] Automatic CFL correction applied (count: 17500):
292.8s 3008 Calculated CFL: 0.800 > Limit: 0.500
292.8s 3009 Original dt: 4.114990e-01 s
292.8s 3010 Corrected dt: 2.571869e-01 s
292.8s 3011 Correction factor: 1.6x
292.8s 3012 Max wave speed detected: 19.44 m/s
292.9s 3013 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
293.3s 3014 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
293.7s 3015 [WARNING] Automatic CFL correction applied (count: 17600):
293.7s 3016 Calculated CFL: 0.800 > Limit: 0.500
293.7s 3017 Original dt: 4.114980e-01 s
293.7s 3018 Corrected dt: 2.571863e-01 s
293.7s 3019 Correction factor: 1.6x
293.7s 3020 Max wave speed detected: 19.44 m/s
293.8s 3021 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
294.3s 3022 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
294.4s 3023 Stored output at t = 120.0000 s (Step 465)
294.4s 3024 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
294.4s 3025 [A
294.4s 3026 
294.4s 3027 Simulation finished at t = 120.0000 s after 465 steps.
294.4s 3028 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.99s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.99s/s]
294.4s 3029 Total runtime: 2.14 seconds.
294.4s 3030 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
294.4s 3031 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
294.4s 3032 Using device: gpu
294.4s 3033 DEBUG PARAMS: Reading K_m_kmh = 10.0
294.4s 3034 DEBUG PARAMS: Reading K_c_kmh = 15.0
294.4s 3035 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
294.4s 3036 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
294.4s 3037 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
294.4s 3038 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
294.4s 3039 Loading road quality type: uniform
294.4s 3040 Uniform road quality value: 2
294.4s 3041 Road quality loaded.
294.4s 3042 Initial state created.
294.4s 3043 Transferring initial state and road quality to GPU...
294.4s 3044 GPU data transfer complete.
294.4s 3045 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
294.4s 3046 Initial boundary conditions applied.
294.4s 3047 [BC UPDATE] left → phase 0 (outflow)
294.4s 3048 └─ Outflow: zero-order extrapolation
294.4s 3049 Running simulation until t = 60.00 s, outputting every 60.00 s
294.4s 3050 
294.7s 3051 [WARNING] Automatic CFL correction applied (count: 17700):
294.7s 3052 Calculated CFL: 0.800 > Limit: 0.500
294.7s 3053 Original dt: 4.768783e-01 s
294.7s 3054 Corrected dt: 2.980490e-01 s
294.7s 3055 Correction factor: 1.6x
294.7s 3056 Max wave speed detected: 16.78 m/s
294.9s 3057 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
295.3s 3058 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
295.6s 3059 [WARNING] Automatic CFL correction applied (count: 17800):
295.6s 3060 Calculated CFL: 0.800 > Limit: 0.500
295.6s 3061 Original dt: 4.123385e-01 s
295.6s 3062 Corrected dt: 2.577116e-01 s
295.6s 3063 Correction factor: 1.6x
295.6s 3064 Max wave speed detected: 19.40 m/s
295.8s 3065 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
296.3s 3066 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
296.5s 3067 [WARNING] Automatic CFL correction applied (count: 17900):
296.5s 3068 Calculated CFL: 0.800 > Limit: 0.500
296.5s 3069 Original dt: 4.115097e-01 s
296.5s 3070 Corrected dt: 2.571935e-01 s
296.5s 3071 Correction factor: 1.6x
296.5s 3072 Max wave speed detected: 19.44 m/s
296.6s 3073 Stored output at t = 60.0000 s (Step 231)
296.6s 3074 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
296.6s 3075 [A
296.6s 3076 
296.6s 3077 Simulation finished at t = 60.0000 s after 231 steps.
296.6s 3078 Total runtime: 2.14 seconds.
296.6s 3079 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.98s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.98s/s]
296.6s 3080 
296.6s 3081 Running simulation until t = 120.00 s, outputting every 60.00 s
296.7s 3082 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
297.2s 3083 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
297.5s 3084 [WARNING] Automatic CFL correction applied (count: 18000):
297.5s 3085 Calculated CFL: 0.800 > Limit: 0.500
297.5s 3086 Original dt: 4.114983e-01 s
297.5s 3087 Corrected dt: 2.571864e-01 s
297.5s 3088 Correction factor: 1.6x
297.5s 3089 Max wave speed detected: 19.44 m/s
297.7s 3090 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
298.1s 3091 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
298.4s 3092 [WARNING] Automatic CFL correction applied (count: 18100):
298.4s 3093 Calculated CFL: 0.800 > Limit: 0.500
298.4s 3094 Original dt: 4.114980e-01 s
298.4s 3095 Corrected dt: 2.571863e-01 s
298.4s 3096 Correction factor: 1.6x
298.4s 3097 Max wave speed detected: 19.44 m/s
298.6s 3098 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
298.7s 3099 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
298.7s 3100 [A
298.7s 3101 Stored output at t = 120.0000 s (Step 465)
298.7s 3102 
298.7s 3103 Simulation finished at t = 120.0000 s after 465 steps.
298.7s 3104 Total runtime: 2.18 seconds.
298.7s 3105 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s]
298.7s 3106 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
298.7s 3107 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
298.7s 3108 Using device: gpu
298.7s 3109 DEBUG PARAMS: Reading K_m_kmh = 10.0
298.7s 3110 DEBUG PARAMS: Reading K_c_kmh = 15.0
298.7s 3111 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
298.7s 3112 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
298.7s 3113 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
298.7s 3114 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
298.7s 3115 Loading road quality type: uniform
298.7s 3116 Uniform road quality value: 2
298.7s 3117 Road quality loaded.
298.7s 3118 Initial state created.
298.7s 3119 Transferring initial state and road quality to GPU...
298.7s 3120 GPU data transfer complete.
298.7s 3121 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
298.7s 3122 Initial boundary conditions applied.
298.7s 3123 [BC UPDATE] left → phase 0 (outflow)
298.7s 3124 └─ Outflow: zero-order extrapolation
298.7s 3125 Running simulation until t = 60.00 s, outputting every 60.00 s
298.7s 3126 
299.2s 3127 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
299.3s 3128 [WARNING] Automatic CFL correction applied (count: 18200):
299.3s 3129 Calculated CFL: 0.800 > Limit: 0.500
299.3s 3130 Original dt: 4.254608e-01 s
299.3s 3131 Corrected dt: 2.659130e-01 s
299.3s 3132 Correction factor: 1.6x
299.3s 3133 Max wave speed detected: 18.80 m/s
299.7s 3134 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
300.1s 3135 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
300.3s 3136 [WARNING] Automatic CFL correction applied (count: 18300):
300.3s 3137 Calculated CFL: 0.800 > Limit: 0.500
300.3s 3138 Original dt: 4.116742e-01 s
300.3s 3139 Corrected dt: 2.572964e-01 s
300.3s 3140 Correction factor: 1.6x
300.3s 3141 Max wave speed detected: 19.43 m/s
300.6s 3142 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
300.9s 3143 Stored output at t = 60.0000 s (Step 231)
300.9s 3144 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
300.9s 3145 [A
300.9s 3146 
300.9s 3147 Simulation finished at t = 60.0000 s after 231 steps.
300.9s 3148 Total runtime: 2.15 seconds.
300.9s 3149 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s]
300.9s 3150 [BC UPDATE] left → phase 1 (inflow)
300.9s 3151 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
300.9s 3152 Running simulation until t = 120.00 s, outputting every 60.00 s
300.9s 3153 
301.1s 3154 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
301.2s 3155 [WARNING] Automatic CFL correction applied (count: 18400):
301.2s 3156 Calculated CFL: 0.800 > Limit: 0.500
301.2s 3157 Original dt: 4.115011e-01 s
301.2s 3158 Corrected dt: 2.571882e-01 s
301.2s 3159 Correction factor: 1.6x
301.2s 3160 Max wave speed detected: 19.44 m/s
301.5s 3161 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
302.0s 3162 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
302.2s 3163 [WARNING] Automatic CFL correction applied (count: 18500):
302.2s 3164 Calculated CFL: 0.800 > Limit: 0.500
302.2s 3165 Original dt: 4.114981e-01 s
302.2s 3166 Corrected dt: 2.571863e-01 s
302.2s 3167 Correction factor: 1.6x
302.2s 3168 Max wave speed detected: 19.44 m/s
302.5s 3169 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
303.0s 3170 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
303.1s 3171 [WARNING] Automatic CFL correction applied (count: 18600):
303.1s 3172 Calculated CFL: 0.800 > Limit: 0.500
303.1s 3173 Original dt: 4.114980e-01 s
303.1s 3174 Corrected dt: 2.571863e-01 s
303.1s 3175 Correction factor: 1.6x
303.1s 3176 Max wave speed detected: 19.44 m/s
303.1s 3177 Stored output at t = 120.0000 s (Step 465)
303.1s 3178 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
303.1s 3179 [A
303.1s 3180 
303.1s 3181 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s]
303.1s 3182 Simulation finished at t = 120.0000 s after 465 steps.
303.1s 3183 Total runtime: 2.19 seconds.
303.1s 3184 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
303.1s 3185 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
303.1s 3186 Using device: gpu
303.1s 3187 DEBUG PARAMS: Reading K_m_kmh = 10.0
303.1s 3188 DEBUG PARAMS: Reading K_c_kmh = 15.0
303.1s 3189 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
303.1s 3190 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
303.1s 3191 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
303.1s 3192 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
303.1s 3193 Loading road quality type: uniform
303.1s 3194 Uniform road quality value: 2
303.1s 3195 Road quality loaded.
303.1s 3196 Initial state created.
303.1s 3197 Transferring initial state and road quality to GPU...
303.1s 3198 GPU data transfer complete.
303.1s 3199 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
303.1s 3200 Initial boundary conditions applied.
303.1s 3201 [BC UPDATE] left → phase 0 (outflow)
303.1s 3202 └─ Outflow: zero-order extrapolation
303.1s 3203 [BC UPDATE] left → phase 1 (inflow)
303.1s 3204 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
303.1s 3205 Running simulation until t = 60.00 s, outputting every 60.00 s
303.1s 3206 
303.6s 3207 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
304.0s 3208 [WARNING] Automatic CFL correction applied (count: 18700):
304.0s 3209 Calculated CFL: 0.800 > Limit: 0.500
304.0s 3210 Original dt: 4.145004e-01 s
304.0s 3211 Corrected dt: 2.590627e-01 s
304.0s 3212 Correction factor: 1.6x
304.0s 3213 Max wave speed detected: 19.30 m/s
304.0s 3214 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
304.5s 3215 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
305.0s 3216 [WARNING] Automatic CFL correction applied (count: 18800):
305.0s 3217 Calculated CFL: 0.800 > Limit: 0.500
305.0s 3218 Original dt: 4.115380e-01 s
305.0s 3219 Corrected dt: 2.572113e-01 s
305.0s 3220 Correction factor: 1.6x
305.0s 3221 Max wave speed detected: 19.44 m/s
305.0s 3222 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
305.3s 3223 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
305.3s 3224 [A
305.3s 3225 Stored output at t = 60.0000 s (Step 231)
305.3s 3226 
305.3s 3227 Simulation finished at t = 60.0000 s after 231 steps.
305.3s 3228 Total runtime: 2.17 seconds.
305.3s 3229 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.65s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.65s/s]
305.3s 3230 [BC UPDATE] left → phase 0 (outflow)
305.3s 3231 └─ Outflow: zero-order extrapolation
305.3s 3232 Running simulation until t = 120.00 s, outputting every 60.00 s
305.3s 3233 
305.5s 3234 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
305.9s 3235 [WARNING] Automatic CFL correction applied (count: 18900):
305.9s 3236 Calculated CFL: 0.800 > Limit: 0.500
305.9s 3237 Original dt: 4.114988e-01 s
305.9s 3238 Corrected dt: 2.571867e-01 s
305.9s 3239 Correction factor: 1.6x
305.9s 3240 Max wave speed detected: 19.44 m/s
305.9s 3241 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
306.4s 3242 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
306.8s 3243 [WARNING] Automatic CFL correction applied (count: 19000):
306.8s 3244 Calculated CFL: 0.800 > Limit: 0.500
306.8s 3245 Original dt: 4.114980e-01 s
306.8s 3246 Corrected dt: 2.571863e-01 s
306.8s 3247 Correction factor: 1.6x
306.8s 3248 Max wave speed detected: 19.44 m/s
306.9s 3249 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
307.4s 3250 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
307.5s 3251 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
307.5s 3252 [A
307.5s 3253 Stored output at t = 120.0000 s (Step 465)
307.5s 3254 
307.5s 3255 Simulation finished at t = 120.0000 s after 465 steps.
307.5s 3256 Total runtime: 2.23 seconds.
307.5s 3257 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.94s/s]
307.5s 3258 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
307.5s 3259 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
307.5s 3260 Using device: gpu
307.5s 3261 DEBUG PARAMS: Reading K_m_kmh = 10.0
307.5s 3262 DEBUG PARAMS: Reading K_c_kmh = 15.0
307.5s 3263 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
307.5s 3264 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
307.5s 3265 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
307.5s 3266 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
307.5s 3267 Loading road quality type: uniform
307.5s 3268 Uniform road quality value: 2
307.5s 3269 Road quality loaded.
307.5s 3270 Initial state created.
307.5s 3271 Transferring initial state and road quality to GPU...
307.5s 3272 GPU data transfer complete.
307.5s 3273 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
307.5s 3274 Initial boundary conditions applied.
307.5s 3275 [BC UPDATE] left → phase 0 (outflow)
307.5s 3276 └─ Outflow: zero-order extrapolation
307.5s 3277 [BC UPDATE] left → phase 1 (inflow)
307.5s 3278 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
307.5s 3279 Running simulation until t = 60.00 s, outputting every 60.00 s
307.5s 3280 
307.8s 3281 [WARNING] Automatic CFL correction applied (count: 19100):
307.8s 3282 Calculated CFL: 0.800 > Limit: 0.500
307.8s 3283 Original dt: 4.758816e-01 s
307.8s 3284 Corrected dt: 2.974260e-01 s
307.8s 3285 Correction factor: 1.6x
307.8s 3286 Max wave speed detected: 16.81 m/s
308.0s 3287 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
308.4s 3288 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
308.8s 3289 [WARNING] Automatic CFL correction applied (count: 19200):
308.8s 3290 Calculated CFL: 0.800 > Limit: 0.500
308.8s 3291 Original dt: 4.121510e-01 s
308.8s 3292 Corrected dt: 2.575944e-01 s
308.8s 3293 Correction factor: 1.6x
308.8s 3294 Max wave speed detected: 19.41 m/s
308.9s 3295 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
309.4s 3296 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
309.7s 3297 Stored output at t = 60.0000 s (Step 231)
309.7s 3298 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
309.7s 3299 [A
309.7s 3300 
309.7s 3301 Simulation finished at t = 60.0000 s after 231 steps.
309.7s 3302 Total runtime: 2.15 seconds.
309.7s 3303 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.95s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.95s/s]
309.7s 3304 Running simulation until t = 120.00 s, outputting every 60.00 s
309.7s 3305 
309.7s 3306 [WARNING] Automatic CFL correction applied (count: 19300):
309.7s 3307 Calculated CFL: 0.800 > Limit: 0.500
309.7s 3308 Original dt: 4.115082e-01 s
309.7s 3309 Corrected dt: 2.571926e-01 s
309.7s 3310 Correction factor: 1.6x
309.7s 3311 Max wave speed detected: 19.44 m/s
309.8s 3312 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
310.3s 3313 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
310.6s 3314 [WARNING] Automatic CFL correction applied (count: 19400):
310.6s 3315 Calculated CFL: 0.800 > Limit: 0.500
310.6s 3316 Original dt: 4.114982e-01 s
310.6s 3317 Corrected dt: 2.571864e-01 s
310.6s 3318 Correction factor: 1.6x
310.6s 3319 Max wave speed detected: 19.44 m/s
310.8s 3320 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
311.2s 3321 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
311.6s 3322 [WARNING] Automatic CFL correction applied (count: 19500):
311.6s 3323 Calculated CFL: 0.800 > Limit: 0.500
311.6s 3324 Original dt: 4.114980e-01 s
311.6s 3325 Corrected dt: 2.571863e-01 s
311.6s 3326 Correction factor: 1.6x
311.6s 3327 Max wave speed detected: 19.44 m/s
311.7s 3328 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
311.9s 3329 Stored output at t = 120.0000 s (Step 465)
311.9s 3330 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
311.9s 3331 [A
311.9s 3332 
311.9s 3333 Simulation finished at t = 120.0000 s after 465 steps.
311.9s 3334 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.42s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.42s/s]
311.9s 3335 Total runtime: 2.19 seconds.
311.9s 3336 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
311.9s 3337 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
311.9s 3338 Using device: gpu
311.9s 3339 DEBUG PARAMS: Reading K_m_kmh = 10.0
311.9s 3340 DEBUG PARAMS: Reading K_c_kmh = 15.0
311.9s 3341 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
311.9s 3342 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
311.9s 3343 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
311.9s 3344 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
311.9s 3345 Loading road quality type: uniform
311.9s 3346 Uniform road quality value: 2
311.9s 3347 Road quality loaded.
311.9s 3348 Initial state created.
311.9s 3349 Transferring initial state and road quality to GPU...
311.9s 3350 GPU data transfer complete.
311.9s 3351 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
311.9s 3352 Initial boundary conditions applied.
311.9s 3353 [BC UPDATE] left → phase 0 (outflow)
311.9s 3354 └─ Outflow: zero-order extrapolation
311.9s 3355 [BC UPDATE] left → phase 1 (inflow)
311.9s 3356 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
311.9s 3357 Running simulation until t = 60.00 s, outputting every 60.00 s
311.9s 3358 
312.4s 3359 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
312.5s 3360 [WARNING] Automatic CFL correction applied (count: 19600):
312.5s 3361 Calculated CFL: 0.800 > Limit: 0.500
312.5s 3362 Original dt: 4.225636e-01 s
312.5s 3363 Corrected dt: 2.641023e-01 s
312.5s 3364 Correction factor: 1.6x
312.5s 3365 Max wave speed detected: 18.93 m/s
312.8s 3366 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
313.3s 3367 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
313.5s 3368 [WARNING] Automatic CFL correction applied (count: 19700):
313.5s 3369 Calculated CFL: 0.800 > Limit: 0.500
313.5s 3370 Original dt: 4.116395e-01 s
313.5s 3371 Corrected dt: 2.572747e-01 s
313.5s 3372 Correction factor: 1.6x
313.5s 3373 Max wave speed detected: 19.43 m/s
313.8s 3374 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
314.0s 3375 Stored output at t = 60.0000 s (Step 231)
314.0s 3376 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
314.0s 3377 [A
314.0s 3378 
314.0s 3379 Simulation finished at t = 60.0000 s after 231 steps.
314.0s 3380 Total runtime: 2.16 seconds.
314.0s 3381 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s]
314.0s 3382 Running simulation until t = 120.00 s, outputting every 60.00 s
314.0s 3383 
314.2s 3384 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
314.4s 3385 [WARNING] Automatic CFL correction applied (count: 19800):
314.4s 3386 Calculated CFL: 0.800 > Limit: 0.500
314.4s 3387 Original dt: 4.115005e-01 s
314.4s 3388 Corrected dt: 2.571878e-01 s
314.4s 3389 Correction factor: 1.6x
314.4s 3390 Max wave speed detected: 19.44 m/s
314.7s 3391 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
315.1s 3392 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
315.3s 3393 [WARNING] Automatic CFL correction applied (count: 19900):
315.3s 3394 Calculated CFL: 0.800 > Limit: 0.500
315.3s 3395 Original dt: 4.114981e-01 s
315.3s 3396 Corrected dt: 2.571863e-01 s
315.3s 3397 Correction factor: 1.6x
315.3s 3398 Max wave speed detected: 19.44 m/s
315.6s 3399 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
316.1s 3400 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
316.2s 3401 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
316.2s 3402 [A
316.2s 3403 Stored output at t = 120.0000 s (Step 465)
316.2s 3404 
316.2s 3405 Simulation finished at t = 120.0000 s after 465 steps.
316.2s 3406 Total runtime: 2.16 seconds.
316.2s 3407 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s]
316.2s 3408 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
316.2s 3409 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
316.2s 3410 Using device: gpu
316.2s 3411 DEBUG PARAMS: Reading K_m_kmh = 10.0
316.2s 3412 DEBUG PARAMS: Reading K_c_kmh = 15.0
316.2s 3413 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
316.2s 3414 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
316.2s 3415 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
316.2s 3416 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
316.2s 3417 Loading road quality type: uniform
316.2s 3418 Uniform road quality value: 2
316.2s 3419 Road quality loaded.
316.2s 3420 Initial state created.
316.2s 3421 Transferring initial state and road quality to GPU...
316.2s 3422 GPU data transfer complete.
316.2s 3423 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
316.2s 3424 Initial boundary conditions applied.
316.2s 3425 [BC UPDATE] left → phase 0 (outflow)
316.2s 3426 └─ Outflow: zero-order extrapolation
316.2s 3427 [BC UPDATE] left → phase 1 (inflow)
316.2s 3428 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
316.2s 3429 Running simulation until t = 60.00 s, outputting every 60.00 s
316.2s 3430 
316.3s 3431 [WARNING] Automatic CFL correction applied (count: 20000):
316.3s 3432 Calculated CFL: 0.800 > Limit: 0.500
316.3s 3433 Original dt: 3.451280e-01 s
316.3s 3434 Corrected dt: 2.157050e-01 s
316.3s 3435 Correction factor: 1.6x
316.3s 3436 Max wave speed detected: 23.18 m/s
316.7s 3437 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
317.1s 3438 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
317.2s 3439 [WARNING] Automatic CFL correction applied (count: 20100):
317.2s 3440 Calculated CFL: 0.800 > Limit: 0.500
317.2s 3441 Original dt: 4.139892e-01 s
317.2s 3442 Corrected dt: 2.587433e-01 s
317.2s 3443 Correction factor: 1.6x
317.2s 3444 Max wave speed detected: 19.32 m/s
317.6s 3445 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
318.1s 3446 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
318.1s 3447 [WARNING] Automatic CFL correction applied (count: 20200):
318.1s 3448 Calculated CFL: 0.800 > Limit: 0.500
318.1s 3449 Original dt: 4.115314e-01 s
318.1s 3450 Corrected dt: 2.572071e-01 s
318.1s 3451 Correction factor: 1.6x
318.1s 3452 Max wave speed detected: 19.44 m/s
318.3s 3453 Stored output at t = 60.0000 s (Step 231)
318.3s 3454 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
318.3s 3455 [A
318.3s 3456 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.28s/s]
318.3s 3457 
318.3s 3458 Simulation finished at t = 60.0000 s after 231 steps.
318.3s 3459 Total runtime: 2.12 seconds.
318.3s 3460 Running simulation until t = 120.00 s, outputting every 60.00 s
318.3s 3461 
318.5s 3462 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
319.0s 3463 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
319.0s 3464 [WARNING] Automatic CFL correction applied (count: 20300):
319.0s 3465 Calculated CFL: 0.800 > Limit: 0.500
319.0s 3466 Original dt: 4.114986e-01 s
319.0s 3467 Corrected dt: 2.571866e-01 s
319.0s 3468 Correction factor: 1.6x
319.0s 3469 Max wave speed detected: 19.44 m/s
319.4s 3470 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
319.9s 3471 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
319.9s 3472 [WARNING] Automatic CFL correction applied (count: 20400):
319.9s 3473 Calculated CFL: 0.800 > Limit: 0.500
319.9s 3474 Original dt: 4.114980e-01 s
319.9s 3475 Corrected dt: 2.571863e-01 s
319.9s 3476 Correction factor: 1.6x
319.9s 3477 Max wave speed detected: 19.44 m/s
320.4s 3478 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
320.5s 3479 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
320.5s 3480 [A
320.5s 3481 Stored output at t = 120.0000 s (Step 465)
320.5s 3482 
320.5s 3483 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.77s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.77s/s]
320.5s 3484 Simulation finished at t = 120.0000 s after 465 steps.
320.5s 3485 Total runtime: 2.16 seconds.
320.5s 3486 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
320.5s 3487 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
320.5s 3488 Using device: gpu
320.5s 3489 DEBUG PARAMS: Reading K_m_kmh = 10.0
320.5s 3490 DEBUG PARAMS: Reading K_c_kmh = 15.0
320.5s 3491 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
320.5s 3492 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
320.5s 3493 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
320.5s 3494 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
320.5s 3495 Loading road quality type: uniform
320.5s 3496 Uniform road quality value: 2
320.5s 3497 Road quality loaded.
320.5s 3498 Initial state created.
320.5s 3499 Transferring initial state and road quality to GPU...
320.5s 3500 GPU data transfer complete.
320.5s 3501 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
320.5s 3502 Initial boundary conditions applied.
320.5s 3503 [BC UPDATE] left → phase 0 (outflow)
320.5s 3504 └─ Outflow: zero-order extrapolation
320.5s 3505 [BC UPDATE] left → phase 1 (inflow)
320.5s 3506 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
320.5s 3507 Running simulation until t = 60.00 s, outputting every 60.00 s
320.5s 3508 
320.9s 3509 [WARNING] Automatic CFL correction applied (count: 20500):
320.9s 3510 Calculated CFL: 0.800 > Limit: 0.500
320.9s 3511 Original dt: 4.583403e-01 s
320.9s 3512 Corrected dt: 2.864627e-01 s
320.9s 3513 Correction factor: 1.6x
320.9s 3514 Max wave speed detected: 17.45 m/s
321.0s 3515 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
321.5s 3516 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
321.8s 3517 [WARNING] Automatic CFL correction applied (count: 20600):
321.8s 3518 Calculated CFL: 0.800 > Limit: 0.500
321.8s 3519 Original dt: 4.120137e-01 s
321.8s 3520 Corrected dt: 2.575085e-01 s
321.8s 3521 Correction factor: 1.6x
321.8s 3522 Max wave speed detected: 19.42 m/s
321.9s 3523 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
322.4s 3524 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
322.7s 3525 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
322.7s 3526 [A
322.7s 3527 Stored output at t = 60.0000 s (Step 231)
322.7s 3528 
322.7s 3529 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.15s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.14s/s]
322.7s 3530 Simulation finished at t = 60.0000 s after 231 steps.
322.7s 3531 Total runtime: 2.21 seconds.
322.7s 3532 Running simulation until t = 120.00 s, outputting every 60.00 s
322.7s 3533 
322.8s 3534 [WARNING] Automatic CFL correction applied (count: 20700):
322.8s 3535 Calculated CFL: 0.800 > Limit: 0.500
322.8s 3536 Original dt: 4.115064e-01 s
322.8s 3537 Corrected dt: 2.571915e-01 s
322.8s 3538 Correction factor: 1.6x
322.8s 3539 Max wave speed detected: 19.44 m/s
322.9s 3540 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
323.4s 3541 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
323.7s 3542 [WARNING] Automatic CFL correction applied (count: 20800):
323.7s 3543 Calculated CFL: 0.800 > Limit: 0.500
323.7s 3544 Original dt: 4.114982e-01 s
323.7s 3545 Corrected dt: 2.571864e-01 s
323.7s 3546 Correction factor: 1.6x
323.7s 3547 Max wave speed detected: 19.44 m/s
323.8s 3548 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
324.3s 3549 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
324.7s 3550 [WARNING] Automatic CFL correction applied (count: 20900):
324.7s 3551 Calculated CFL: 0.800 > Limit: 0.500
324.7s 3552 Original dt: 4.114980e-01 s
324.7s 3553 Corrected dt: 2.571863e-01 s
324.7s 3554 Correction factor: 1.6x
324.7s 3555 Max wave speed detected: 19.44 m/s
324.8s 3556 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
324.9s 3557 Stored output at t = 120.0000 s (Step 465)
324.9s 3558 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
324.9s 3559 [A
324.9s 3560 
324.9s 3561 Simulation finished at t = 120.0000 s after 465 steps.
324.9s 3562 Total runtime: 2.16 seconds.
324.9s 3563 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.83s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.83s/s]
324.9s 3564 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
324.9s 3565 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
324.9s 3566 Using device: gpu
324.9s 3567 DEBUG PARAMS: Reading K_m_kmh = 10.0
324.9s 3568 DEBUG PARAMS: Reading K_c_kmh = 15.0
324.9s 3569 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
324.9s 3570 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
324.9s 3571 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
324.9s 3572 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
324.9s 3573 Loading road quality type: uniform
324.9s 3574 Uniform road quality value: 2
324.9s 3575 Road quality loaded.
324.9s 3576 Initial state created.
324.9s 3577 Transferring initial state and road quality to GPU...
324.9s 3578 GPU data transfer complete.
324.9s 3579 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
324.9s 3580 Initial boundary conditions applied.
324.9s 3581 [BC UPDATE] left → phase 0 (outflow)
324.9s 3582 └─ Outflow: zero-order extrapolation
324.9s 3583 [BC UPDATE] left → phase 1 (inflow)
324.9s 3584 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
324.9s 3585 Running simulation until t = 60.00 s, outputting every 60.00 s
324.9s 3586 
325.4s 3587 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
325.6s 3588 [WARNING] Automatic CFL correction applied (count: 21000):
325.6s 3589 Calculated CFL: 0.800 > Limit: 0.500
325.6s 3590 Original dt: 4.205139e-01 s
325.6s 3591 Corrected dt: 2.628212e-01 s
325.6s 3592 Correction factor: 1.6x
325.6s 3593 Max wave speed detected: 19.02 m/s
325.8s 3594 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
326.3s 3595 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
326.5s 3596 [WARNING] Automatic CFL correction applied (count: 21100):
326.5s 3597 Calculated CFL: 0.800 > Limit: 0.500
326.5s 3598 Original dt: 4.116141e-01 s
326.5s 3599 Corrected dt: 2.572588e-01 s
326.5s 3600 Correction factor: 1.6x
326.5s 3601 Max wave speed detected: 19.44 m/s
326.8s 3602 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
327.1s 3603 Stored output at t = 60.0000 s (Step 231)
327.1s 3604 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
327.1s 3605 [A
327.1s 3606 
327.1s 3607 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.91s/s]
327.1s 3608 Simulation finished at t = 60.0000 s after 231 steps.
327.1s 3609 Total runtime: 2.15 seconds.
327.1s 3610 Running simulation until t = 120.00 s, outputting every 60.00 s
327.1s 3611 
327.2s 3612 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
327.5s 3613 [WARNING] Automatic CFL correction applied (count: 21200):
327.5s 3614 Calculated CFL: 0.800 > Limit: 0.500
327.5s 3615 Original dt: 4.115000e-01 s
327.5s 3616 Corrected dt: 2.571875e-01 s
327.5s 3617 Correction factor: 1.6x
327.5s 3618 Max wave speed detected: 19.44 m/s
327.7s 3619 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
328.1s 3620 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
328.4s 3621 [WARNING] Automatic CFL correction applied (count: 21300):
328.4s 3622 Calculated CFL: 0.800 > Limit: 0.500
328.4s 3623 Original dt: 4.114981e-01 s
328.4s 3624 Corrected dt: 2.571863e-01 s
328.4s 3625 Correction factor: 1.6x
328.4s 3626 Max wave speed detected: 19.44 m/s
328.6s 3627 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
329.1s 3628 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
329.2s 3629 Stored output at t = 120.0000 s (Step 465)
329.2s 3630 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
329.2s 3631 [A
329.2s 3632 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.94s/s]
329.2s 3633 
329.2s 3634 Simulation finished at t = 120.0000 s after 465 steps.
329.2s 3635 Total runtime: 2.15 seconds.
329.2s 3636 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
329.2s 3637 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
329.2s 3638 Using device: gpu
329.2s 3639 DEBUG PARAMS: Reading K_m_kmh = 10.0
329.2s 3640 DEBUG PARAMS: Reading K_c_kmh = 15.0
329.2s 3641 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
329.2s 3642 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
329.2s 3643 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
329.2s 3644 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
329.2s 3645 Loading road quality type: uniform
329.2s 3646 Uniform road quality value: 2
329.2s 3647 Road quality loaded.
329.2s 3648 Initial state created.
329.2s 3649 Transferring initial state and road quality to GPU...
329.2s 3650 GPU data transfer complete.
329.2s 3651 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
329.2s 3652 Initial boundary conditions applied.
329.2s 3653 [BC UPDATE] left → phase 0 (outflow)
329.2s 3654 └─ Outflow: zero-order extrapolation
329.2s 3655 Running simulation until t = 60.00 s, outputting every 60.00 s
329.2s 3656 
329.3s 3657 [WARNING] Automatic CFL correction applied (count: 21400):
329.3s 3658 Calculated CFL: 0.800 > Limit: 0.500
329.3s 3659 Original dt: 3.737254e-01 s
329.3s 3660 Corrected dt: 2.335784e-01 s
329.3s 3661 Correction factor: 1.6x
329.3s 3662 Max wave speed detected: 21.41 m/s
329.7s 3663 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
330.1s 3664 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
330.2s 3665 [WARNING] Automatic CFL correction applied (count: 21500):
330.2s 3666 Calculated CFL: 0.800 > Limit: 0.500
330.2s 3667 Original dt: 4.134305e-01 s
330.2s 3668 Corrected dt: 2.583941e-01 s
330.2s 3669 Correction factor: 1.6x
330.2s 3670 Max wave speed detected: 19.35 m/s
330.6s 3671 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
331.1s 3672 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
331.2s 3673 [WARNING] Automatic CFL correction applied (count: 21600):
331.2s 3674 Calculated CFL: 0.800 > Limit: 0.500
331.2s 3675 Original dt: 4.115259e-01 s
331.2s 3676 Corrected dt: 2.572037e-01 s
331.2s 3677 Correction factor: 1.6x
331.2s 3678 Max wave speed detected: 19.44 m/s
331.4s 3679 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
331.4s 3680 [A
331.4s 3681 Stored output at t = 60.0000 s (Step 231)
331.4s 3682 
331.4s 3683 Simulation finished at t = 60.0000 s after 231 steps.
331.4s 3684 Total runtime: 2.16 seconds.
331.4s 3685 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.76s/s]
331.4s 3686 [BC UPDATE] left → phase 1 (inflow)
331.4s 3687 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
331.4s 3688 Running simulation until t = 120.00 s, outputting every 60.00 s
331.4s 3689 
331.6s 3690 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
332.1s 3691 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
332.2s 3692 [WARNING] Automatic CFL correction applied (count: 21700):
332.2s 3693 Calculated CFL: 0.800 > Limit: 0.500
332.2s 3694 Original dt: 4.114985e-01 s
332.2s 3695 Corrected dt: 2.571866e-01 s
332.2s 3696 Correction factor: 1.6x
332.2s 3697 Max wave speed detected: 19.44 m/s
332.5s 3698 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
333.0s 3699 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
333.1s 3700 [WARNING] Automatic CFL correction applied (count: 21800):
333.1s 3701 Calculated CFL: 0.800 > Limit: 0.500
333.1s 3702 Original dt: 4.114980e-01 s
333.1s 3703 Corrected dt: 2.571863e-01 s
333.1s 3704 Correction factor: 1.6x
333.1s 3705 Max wave speed detected: 19.44 m/s
333.5s 3706 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
333.6s 3707 Stored output at t = 120.0000 s (Step 465)
333.6s 3708 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
333.6s 3709 [A
333.6s 3710 
333.6s 3711 Simulation finished at t = 120.0000 s after 465 steps.
333.6s 3712 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.06s/s]
333.6s 3713 Total runtime: 2.22 seconds.
333.6s 3714 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
333.6s 3715 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
333.6s 3716 Using device: gpu
333.6s 3717 DEBUG PARAMS: Reading K_m_kmh = 10.0
333.6s 3718 DEBUG PARAMS: Reading K_c_kmh = 15.0
333.6s 3719 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
333.6s 3720 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
333.6s 3721 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
333.6s 3722 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
333.6s 3723 Loading road quality type: uniform
333.6s 3724 Uniform road quality value: 2
333.6s 3725 Road quality loaded.
333.6s 3726 Initial state created.
333.6s 3727 Transferring initial state and road quality to GPU...
333.6s 3728 GPU data transfer complete.
333.6s 3729 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
333.6s 3730 Initial boundary conditions applied.
333.6s 3731 [BC UPDATE] left → phase 0 (outflow)
333.6s 3732 └─ Outflow: zero-order extrapolation
333.6s 3733 [BC UPDATE] left → phase 1 (inflow)
333.6s 3734 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
333.6s 3735 Running simulation until t = 60.00 s, outputting every 60.00 s
333.6s 3736 
334.0s 3737 [WARNING] Automatic CFL correction applied (count: 21900):
334.0s 3738 Calculated CFL: 0.800 > Limit: 0.500
334.0s 3739 Original dt: 4.470525e-01 s
334.0s 3740 Corrected dt: 2.794078e-01 s
334.0s 3741 Correction factor: 1.6x
334.0s 3742 Max wave speed detected: 17.89 m/s
334.1s 3743 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
334.5s 3744 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
334.9s 3745 [WARNING] Automatic CFL correction applied (count: 22000):
334.9s 3746 Calculated CFL: 0.800 > Limit: 0.500
334.9s 3747 Original dt: 4.119130e-01 s
334.9s 3748 Corrected dt: 2.574456e-01 s
334.9s 3749 Correction factor: 1.6x
334.9s 3750 Max wave speed detected: 19.42 m/s
335.0s 3751 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
335.5s 3752 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
335.7s 3753 Stored output at t = 60.0000 s (Step 231)
335.7s 3754 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
335.7s 3755 [A
335.7s 3756 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.18s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.18s/s]
335.7s 3757 
335.7s 3758 Simulation finished at t = 60.0000 s after 231 steps.
335.7s 3759 Total runtime: 2.13 seconds.
335.8s 3760 Running simulation until t = 120.00 s, outputting every 60.00 s
335.8s 3761 
335.9s 3762 [WARNING] Automatic CFL correction applied (count: 22100):
335.9s 3763 Calculated CFL: 0.800 > Limit: 0.500
335.9s 3764 Original dt: 4.115046e-01 s
335.9s 3765 Corrected dt: 2.571904e-01 s
335.9s 3766 Correction factor: 1.6x
335.9s 3767 Max wave speed detected: 19.44 m/s
335.9s 3768 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
336.4s 3769 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
336.8s 3770 [WARNING] Automatic CFL correction applied (count: 22200):
336.8s 3771 Calculated CFL: 0.800 > Limit: 0.500
336.8s 3772 Original dt: 4.114982e-01 s
336.8s 3773 Corrected dt: 2.571863e-01 s
336.8s 3774 Correction factor: 1.6x
336.8s 3775 Max wave speed detected: 19.44 m/s
336.8s 3776 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
337.3s 3777 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
337.7s 3778 [WARNING] Automatic CFL correction applied (count: 22300):
337.7s 3779 Calculated CFL: 0.800 > Limit: 0.500
337.7s 3780 Original dt: 4.114980e-01 s
337.7s 3781 Corrected dt: 2.571863e-01 s
337.7s 3782 Correction factor: 1.6x
337.7s 3783 Max wave speed detected: 19.44 m/s
337.8s 3784 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
337.9s 3785 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
337.9s 3786 [A
337.9s 3787 Stored output at t = 120.0000 s (Step 465)
337.9s 3788 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.86s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.86s/s]
337.9s 3789 
337.9s 3790 Simulation finished at t = 120.0000 s after 465 steps.
337.9s 3791 Total runtime: 2.15 seconds.
337.9s 3792 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
337.9s 3793 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
337.9s 3794 Using device: gpu
337.9s 3795 DEBUG PARAMS: Reading K_m_kmh = 10.0
337.9s 3796 DEBUG PARAMS: Reading K_c_kmh = 15.0
337.9s 3797 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
337.9s 3798 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
337.9s 3799 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
337.9s 3800 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
337.9s 3801 Loading road quality type: uniform
337.9s 3802 Uniform road quality value: 2
337.9s 3803 Road quality loaded.
337.9s 3804 Initial state created.
337.9s 3805 Transferring initial state and road quality to GPU...
337.9s 3806 GPU data transfer complete.
337.9s 3807 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
337.9s 3808 Initial boundary conditions applied.
337.9s 3809 [BC UPDATE] left → phase 0 (outflow)
337.9s 3810 └─ Outflow: zero-order extrapolation
337.9s 3811 Running simulation until t = 60.00 s, outputting every 60.00 s
337.9s 3812 
338.4s 3813 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
338.6s 3814 [WARNING] Automatic CFL correction applied (count: 22400):
338.6s 3815 Calculated CFL: 0.800 > Limit: 0.500
338.6s 3816 Original dt: 4.190346e-01 s
338.6s 3817 Corrected dt: 2.618967e-01 s
338.6s 3818 Correction factor: 1.6x
338.6s 3819 Max wave speed detected: 19.09 m/s
338.8s 3820 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
339.3s 3821 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
339.6s 3822 [WARNING] Automatic CFL correction applied (count: 22500):
339.6s 3823 Calculated CFL: 0.800 > Limit: 0.500
339.6s 3824 Original dt: 4.115954e-01 s
339.6s 3825 Corrected dt: 2.572472e-01 s
339.6s 3826 Correction factor: 1.6x
339.6s 3827 Max wave speed detected: 19.44 m/s
339.8s 3828 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
340.1s 3829 Stored output at t = 60.0000 s (Step 231)
340.1s 3830 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
340.1s 3831 [A
340.1s 3832 
340.1s 3833 Simulation finished at t = 60.0000 s after 231 steps.
340.1s 3834 Total runtime: 2.13 seconds.
340.1s 3835 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.12s/s]
340.1s 3836 [BC UPDATE] left → phase 1 (inflow)
340.1s 3837 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
340.1s 3838 Running simulation until t = 120.00 s, outputting every 60.00 s
340.1s 3839 
340.2s 3840 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
340.5s 3841 [WARNING] Automatic CFL correction applied (count: 22600):
340.5s 3842 Calculated CFL: 0.800 > Limit: 0.500
340.5s 3843 Original dt: 4.114996e-01 s
340.5s 3844 Corrected dt: 2.571873e-01 s
340.5s 3845 Correction factor: 1.6x
340.5s 3846 Max wave speed detected: 19.44 m/s
340.7s 3847 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
341.2s 3848 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
341.4s 3849 [WARNING] Automatic CFL correction applied (count: 22700):
341.4s 3850 Calculated CFL: 0.800 > Limit: 0.500
341.4s 3851 Original dt: 4.114981e-01 s
341.4s 3852 Corrected dt: 2.571863e-01 s
341.4s 3853 Correction factor: 1.6x
341.4s 3854 Max wave speed detected: 19.44 m/s
341.6s 3855 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
342.1s 3856 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
342.3s 3857 Stored output at t = 120.0000 s (Step 465)
342.3s 3858 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
342.3s 3859 [A
342.3s 3860 
342.3s 3861 Simulation finished at t = 120.0000 s after 465 steps.
342.3s 3862 Total runtime: 2.21 seconds.
342.3s 3863 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.20s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.20s/s]
342.3s 3864 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
342.3s 3865 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
342.3s 3866 Using device: gpu
342.3s 3867 DEBUG PARAMS: Reading K_m_kmh = 10.0
342.3s 3868 DEBUG PARAMS: Reading K_c_kmh = 15.0
342.3s 3869 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
342.3s 3870 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
342.3s 3871 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
342.3s 3872 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
342.3s 3873 Loading road quality type: uniform
342.3s 3874 Uniform road quality value: 2
342.3s 3875 Road quality loaded.
342.3s 3876 Initial state created.
342.3s 3877 Transferring initial state and road quality to GPU...
342.3s 3878 GPU data transfer complete.
342.3s 3879 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
342.3s 3880 Initial boundary conditions applied.
342.3s 3881 [BC UPDATE] left → phase 0 (outflow)
342.3s 3882 └─ Outflow: zero-order extrapolation
342.3s 3883 [BC UPDATE] left → phase 1 (inflow)
342.3s 3884 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
342.3s 3885 Running simulation until t = 60.00 s, outputting every 60.00 s
342.3s 3886 
342.4s 3887 [WARNING] Automatic CFL correction applied (count: 22800):
342.4s 3888 Calculated CFL: 0.800 > Limit: 0.500
342.4s 3889 Original dt: 4.022422e-01 s
342.4s 3890 Corrected dt: 2.514014e-01 s
342.4s 3891 Correction factor: 1.6x
342.4s 3892 Max wave speed detected: 19.89 m/s
342.7s 3893 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
343.2s 3894 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
343.3s 3895 [WARNING] Automatic CFL correction applied (count: 22900):
343.3s 3896 Calculated CFL: 0.800 > Limit: 0.500
343.3s 3897 Original dt: 4.130229e-01 s
343.3s 3898 Corrected dt: 2.581393e-01 s
343.3s 3899 Correction factor: 1.6x
343.3s 3900 Max wave speed detected: 19.37 m/s
343.7s 3901 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
344.1s 3902 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
344.2s 3903 [WARNING] Automatic CFL correction applied (count: 23000):
344.2s 3904 Calculated CFL: 0.800 > Limit: 0.500
344.2s 3905 Original dt: 4.115198e-01 s
344.2s 3906 Corrected dt: 2.571999e-01 s
344.2s 3907 Correction factor: 1.6x
344.2s 3908 Max wave speed detected: 19.44 m/s
344.4s 3909 Stored output at t = 60.0000 s (Step 231)
344.4s 3910 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
344.4s 3911 [A
344.4s 3912 
344.4s 3913 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s]
344.4s 3914 Simulation finished at t = 60.0000 s after 231 steps.
344.4s 3915 Total runtime: 2.13 seconds.
344.4s 3916 Running simulation until t = 120.00 s, outputting every 60.00 s
344.4s 3917 
344.6s 3918 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
345.0s 3919 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
345.2s 3920 [WARNING] Automatic CFL correction applied (count: 23100):
345.2s 3921 Calculated CFL: 0.800 > Limit: 0.500
345.2s 3922 Original dt: 4.114984e-01 s
345.2s 3923 Corrected dt: 2.571865e-01 s
345.2s 3924 Correction factor: 1.6x
345.2s 3925 Max wave speed detected: 19.44 m/s
345.5s 3926 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
346.0s 3927 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
346.1s 3928 [WARNING] Automatic CFL correction applied (count: 23200):
346.1s 3929 Calculated CFL: 0.800 > Limit: 0.500
346.1s 3930 Original dt: 4.114980e-01 s
346.1s 3931 Corrected dt: 2.571863e-01 s
346.1s 3932 Correction factor: 1.6x
346.1s 3933 Max wave speed detected: 19.44 m/s
346.4s 3934 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
346.6s 3935 Stored output at t = 120.0000 s (Step 465)
346.6s 3936 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
346.6s 3937 [A
346.6s 3938 
346.6s 3939 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s]
346.6s 3940 Simulation finished at t = 120.0000 s after 465 steps.
346.6s 3941 Total runtime: 2.16 seconds.
346.6s 3942 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
346.6s 3943 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.6s 3944 Using device: gpu
346.6s 3945 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.6s 3946 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.6s 3947 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.6s 3948 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.6s 3949 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.6s 3950 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.6s 3951 Loading road quality type: uniform
346.6s 3952 Uniform road quality value: 2
346.6s 3953 Road quality loaded.
346.6s 3954 Initial state created.
346.6s 3955 Transferring initial state and road quality to GPU...
346.6s 3956 GPU data transfer complete.
346.6s 3957 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.6s 3958 Initial boundary conditions applied.
346.6s 3959 [BC UPDATE] left → phase 0 (outflow)
346.6s 3960 └─ Outflow: zero-order extrapolation
346.6s 3961 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.5 steps/s
346.6s 3962 ---------------------------------
346.6s 3963 | rollout/           |          |
346.6s 3964 |    ep_len_mean     | 2        |
346.6s 3965 |    ep_rew_mean     | -0.0676  |
346.6s 3966 | time/              |          |
346.6s 3967 |    fps             | 0        |
346.6s 3968 |    iterations      | 1        |
346.6s 3969 |    time_elapsed    | 221      |
346.6s 3970 |    total_timesteps | 100      |
346.6s 3971 ---------------------------------
347.1s 3972 
347.1s 3973 ✅ Training completed in 3.7 minutes (222.3s)
347.1s 3974 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:41 < 0:00:00 , 0 it/s ]
347.1s 3975 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
347.1s 3976 
347.1s 3977 [PHASE 2/2] Running performance comparisons...
347.1s 3978 [QUICK TEST] Testing only: traffic_light_control
347.1s 3979 
347.1s 3980 Testing scenario: traffic_light_control (device=gpu)
347.1s 3981 2025-10-10 10:24:32 - INFO - run_performance_comparison:698 - ================================================================================
347.1s 3982 2025-10-10 10:24:32 - INFO - run_performance_comparison:699 - Starting run_performance_comparison for scenario: traffic_light_control
347.1s 3983 2025-10-10 10:24:32 - INFO - run_performance_comparison:700 - Device: gpu
347.1s 3984 2025-10-10 10:24:32 - INFO - run_performance_comparison:701 - ================================================================================
347.1s 3985 2025-10-10 10:24:32 - INFO - run_performance_comparison:702 - ================================================================================
347.1s 3986 2025-10-10 10:24:32 - INFO - run_performance_comparison:703 - Starting run_performance_comparison for scenario: traffic_light_control
347.1s 3987 2025-10-10 10:24:32 - INFO - run_performance_comparison:704 - Device: gpu
347.1s 3988 2025-10-10 10:24:32 - INFO - run_performance_comparison:705 - ================================================================================
347.1s 3989 2025-10-10 10:24:32 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
347.1s 3990 2025-10-10 10:24:32 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
347.1s 3991 2025-10-10 10:24:32 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
347.1s 3992 2025-10-10 10:24:32 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
347.1s 3993 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
347.1s 3994 Running baseline controller...
347.1s 3995 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
347.1s 3996 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
347.1s 3997 2025-10-10 10:24:32 - INFO - run_control_simulation:286 - ================================================================================
347.1s 3998 2025-10-10 10:24:32 - INFO - run_control_simulation:287 - Starting run_control_simulation:
347.1s 3999 2025-10-10 10:24:32 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
347.1s 4000 2025-10-10 10:24:32 - INFO - run_control_simulation:289 -   - duration: 600.0s
347.1s 4001 2025-10-10 10:24:32 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
347.1s 4002 2025-10-10 10:24:32 - INFO - run_control_simulation:291 -   - device: gpu
347.1s 4003 2025-10-10 10:24:32 - INFO - run_control_simulation:292 -   - controller: BaselineController
347.1s 4004 2025-10-10 10:24:32 - INFO - run_control_simulation:293 -   - max_control_steps: 11
347.1s 4005 2025-10-10 10:24:32 - INFO - run_control_simulation:294 - ================================================================================
347.1s 4006 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
347.1s 4007 2025-10-10 10:24:32 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
347.2s 4008 DEBUG PARAMS: Reading K_m_kmh = 10.0
347.2s 4009 DEBUG PARAMS: Reading K_c_kmh = 15.0
347.2s 4010 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
347.2s 4011 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
347.2s 4012 2025-10-10 10:24:32 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
347.2s 4013 2025-10-10 10:24:32 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
347.2s 4014 [INFO] Calling env.reset()...
347.2s 4015 2025-10-10 10:24:32 - INFO - run_control_simulation:329 - Calling env.reset()...
347.2s 4016 DEBUG PARAMS: Reading K_m_kmh = 10.0
347.2s 4017 DEBUG PARAMS: Reading K_c_kmh = 15.0
347.2s 4018 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
347.2s 4019 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
347.2s 4020 2025-10-10 10:24:32 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
347.2s 4021 2025-10-10 10:24:32 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
347.2s 4022 2025-10-10 10:24:32 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
347.2s 4023 [INFO] Starting simulation loop (max 11 control steps)
347.2s 4024 2025-10-10 10:24:32 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
347.2s 4025 2025-10-10 10:24:32 - INFO - run_control_simulation:366 - ================================================================================
347.2s 4026 2025-10-10 10:24:32 - INFO - run_control_simulation:367 - STEP 0 START:
347.2s 4027 2025-10-10 10:24:32 - INFO - run_control_simulation:368 -   Controller: BaselineController
347.2s 4028 2025-10-10 10:24:32 - INFO - run_control_simulation:369 -   Action: 1.000000
347.2s 4029 2025-10-10 10:24:32 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
347.6s 4030 [WARNING] Automatic CFL correction applied (count: 23300):
347.6s 4031 Calculated CFL: 0.800 > Limit: 0.500
347.6s 4032 Original dt: 4.396418e-01 s
347.6s 4033 Corrected dt: 2.747761e-01 s
347.6s 4034 Correction factor: 1.6x
347.6s 4035 Max wave speed detected: 18.20 m/s
348.5s 4036 [WARNING] Automatic CFL correction applied (count: 23400):
348.5s 4037 Calculated CFL: 0.800 > Limit: 0.500
348.5s 4038 Original dt: 4.118393e-01 s
348.5s 4039 Corrected dt: 2.573996e-01 s
348.5s 4040 Correction factor: 1.6x
348.5s 4041 Max wave speed detected: 19.43 m/s
349.3s 4042 2025-10-10 10:24:34 - INFO - run_control_simulation:382 -   Reward: -0.084799
349.3s 4043 2025-10-10 10:24:34 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
349.3s 4044 2025-10-10 10:24:34 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
349.3s 4045 2025-10-10 10:24:34 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
349.3s 4046 2025-10-10 10:24:34 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
349.3s 4047 2025-10-10 10:24:34 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.036794, rho_c=0.049919
349.3s 4048 2025-10-10 10:24:34 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.406686, w_c=11.325496
349.3s 4049 2025-10-10 10:24:34 - INFO - run_control_simulation:416 -   State hash: 8901619324973113869
349.3s 4050 2025-10-10 10:24:34 - INFO - run_control_simulation:418 - ================================================================================
349.3s 4051 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
349.3s 4052 2025-10-10 10:24:34 - INFO - run_control_simulation:366 - ================================================================================
349.3s 4053 2025-10-10 10:24:34 - INFO - run_control_simulation:367 - STEP 1 START:
349.3s 4054 2025-10-10 10:24:34 - INFO - run_control_simulation:368 -   Controller: BaselineController
349.3s 4055 2025-10-10 10:24:34 - INFO - run_control_simulation:369 -   Action: 0.000000
349.3s 4056 2025-10-10 10:24:34 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
349.5s 4057 [WARNING] Automatic CFL correction applied (count: 23500):
349.5s 4058 Calculated CFL: 0.800 > Limit: 0.500
349.5s 4059 Original dt: 4.115033e-01 s
349.5s 4060 Corrected dt: 2.571896e-01 s
349.5s 4061 Correction factor: 1.6x
349.5s 4062 Max wave speed detected: 19.44 m/s
350.4s 4063 [WARNING] Automatic CFL correction applied (count: 23600):
350.4s 4064 Calculated CFL: 0.800 > Limit: 0.500
350.4s 4065 Original dt: 4.114981e-01 s
350.4s 4066 Corrected dt: 2.571863e-01 s
350.4s 4067 Correction factor: 1.6x
350.4s 4068 Max wave speed detected: 19.44 m/s
351.3s 4069 [WARNING] Automatic CFL correction applied (count: 23700):
351.3s 4070 Calculated CFL: 0.800 > Limit: 0.500
351.3s 4071 Original dt: 4.114980e-01 s
351.3s 4072 Corrected dt: 2.571863e-01 s
351.3s 4073 Correction factor: 1.6x
351.3s 4074 Max wave speed detected: 19.44 m/s
351.5s 4075 2025-10-10 10:24:36 - INFO - run_control_simulation:382 -   Reward: 0.015200
351.5s 4076 2025-10-10 10:24:36 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
351.5s 4077 2025-10-10 10:24:36 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
351.5s 4078 2025-10-10 10:24:36 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
351.5s 4079 2025-10-10 10:24:36 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
351.5s 4080 2025-10-10 10:24:36 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.008375, rho_c=0.025617
351.5s 4081 2025-10-10 10:24:36 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.918019, w_c=14.101648
351.5s 4082 2025-10-10 10:24:36 - INFO - run_control_simulation:416 -   State hash: 710426559787868481
351.5s 4083 2025-10-10 10:24:36 - INFO - run_control_simulation:418 - ================================================================================
351.5s 4084 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
351.5s 4085 2025-10-10 10:24:36 - INFO - run_control_simulation:366 - ================================================================================
351.5s 4086 2025-10-10 10:24:36 - INFO - run_control_simulation:367 - STEP 2 START:
351.5s 4087 2025-10-10 10:24:36 - INFO - run_control_simulation:368 -   Controller: BaselineController
351.5s 4088 2025-10-10 10:24:36 - INFO - run_control_simulation:369 -   Action: 1.000000
351.5s 4089 2025-10-10 10:24:36 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
352.3s 4090 [WARNING] Automatic CFL correction applied (count: 23800):
352.3s 4091 Calculated CFL: 0.800 > Limit: 0.500
352.3s 4092 Original dt: 4.114980e-01 s
352.3s 4093 Corrected dt: 2.571863e-01 s
352.3s 4094 Correction factor: 1.6x
352.3s 4095 Max wave speed detected: 19.44 m/s
353.2s 4096 [WARNING] Automatic CFL correction applied (count: 23900):
353.2s 4097 Calculated CFL: 0.800 > Limit: 0.500
353.2s 4098 Original dt: 4.114980e-01 s
353.2s 4099 Corrected dt: 2.571863e-01 s
353.2s 4100 Correction factor: 1.6x
353.2s 4101 Max wave speed detected: 19.44 m/s
353.7s 4102 2025-10-10 10:24:38 - INFO - run_control_simulation:382 -   Reward: -0.084800
353.7s 4103 2025-10-10 10:24:38 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
353.7s 4104 2025-10-10 10:24:38 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
353.7s 4105 2025-10-10 10:24:38 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
353.7s 4106 2025-10-10 10:24:38 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.189669e+00, max=5.474976e+00, std=1.992888e+00
353.7s 4107 2025-10-10 10:24:38 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
353.7s 4108 2025-10-10 10:24:38 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.270027, w_c=16.374889
353.7s 4109 2025-10-10 10:24:38 - INFO - run_control_simulation:416 -   State hash: -2815691635716835851
353.7s 4110 2025-10-10 10:24:38 - INFO - run_control_simulation:418 - ================================================================================
353.7s 4111 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.189669e+00
353.7s 4112 2025-10-10 10:24:38 - INFO - run_control_simulation:366 - ================================================================================
353.7s 4113 2025-10-10 10:24:38 - INFO - run_control_simulation:367 - STEP 3 START:
353.7s 4114 2025-10-10 10:24:38 - INFO - run_control_simulation:368 -   Controller: BaselineController
353.7s 4115 2025-10-10 10:24:38 - INFO - run_control_simulation:369 -   Action: 0.000000
353.7s 4116 2025-10-10 10:24:38 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
354.1s 4117 [WARNING] Automatic CFL correction applied (count: 24000):
354.1s 4118 Calculated CFL: 0.800 > Limit: 0.500
354.1s 4119 Original dt: 4.114980e-01 s
354.1s 4120 Corrected dt: 2.571863e-01 s
354.1s 4121 Correction factor: 1.6x
354.1s 4122 Max wave speed detected: 19.44 m/s
355.0s 4123 [WARNING] Automatic CFL correction applied (count: 24100):
355.0s 4124 Calculated CFL: 0.800 > Limit: 0.500
355.0s 4125 Original dt: 4.114980e-01 s
355.0s 4126 Corrected dt: 2.571863e-01 s
355.0s 4127 Correction factor: 1.6x
355.0s 4128 Max wave speed detected: 19.44 m/s
355.8s 4129 2025-10-10 10:24:40 - INFO - run_control_simulation:382 -   Reward: 0.015200
355.8s 4130 2025-10-10 10:24:40 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
355.8s 4131 2025-10-10 10:24:40 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
355.8s 4132 2025-10-10 10:24:40 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
355.8s 4133 2025-10-10 10:24:40 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
355.8s 4134 2025-10-10 10:24:40 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
355.8s 4135 2025-10-10 10:24:40 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408449
355.8s 4136 2025-10-10 10:24:40 - INFO - run_control_simulation:416 -   State hash: -8768069832435770563
355.8s 4137 2025-10-10 10:24:40 - INFO - run_control_simulation:418 - ================================================================================
355.8s 4138 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
355.8s 4139 2025-10-10 10:24:40 - INFO - run_control_simulation:366 - ================================================================================
355.8s 4140 2025-10-10 10:24:40 - INFO - run_control_simulation:367 - STEP 4 START:
355.8s 4141 2025-10-10 10:24:40 - INFO - run_control_simulation:368 -   Controller: BaselineController
355.8s 4142 2025-10-10 10:24:40 - INFO - run_control_simulation:369 -   Action: 1.000000
355.8s 4143 2025-10-10 10:24:40 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
356.0s 4144 [WARNING] Automatic CFL correction applied (count: 24200):
356.0s 4145 Calculated CFL: 0.800 > Limit: 0.500
356.0s 4146 Original dt: 4.114980e-01 s
356.0s 4147 Corrected dt: 2.571863e-01 s
356.0s 4148 Correction factor: 1.6x
356.0s 4149 Max wave speed detected: 19.44 m/s
356.9s 4150 [WARNING] Automatic CFL correction applied (count: 24300):
356.9s 4151 Calculated CFL: 0.800 > Limit: 0.500
356.9s 4152 Original dt: 4.114980e-01 s
356.9s 4153 Corrected dt: 2.571863e-01 s
356.9s 4154 Correction factor: 1.6x
356.9s 4155 Max wave speed detected: 19.44 m/s
357.8s 4156 [WARNING] Automatic CFL correction applied (count: 24400):
357.8s 4157 Calculated CFL: 0.800 > Limit: 0.500
357.8s 4158 Original dt: 4.114980e-01 s
357.8s 4159 Corrected dt: 2.571863e-01 s
357.8s 4160 Correction factor: 1.6x
357.8s 4161 Max wave speed detected: 19.44 m/s
358.0s 4162 2025-10-10 10:24:43 - INFO - run_control_simulation:382 -   Reward: -0.084800
358.0s 4163 2025-10-10 10:24:43 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
358.0s 4164 2025-10-10 10:24:43 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
358.0s 4165 2025-10-10 10:24:43 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
358.0s 4166 2025-10-10 10:24:43 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.350430e-02, max=1.980205e+00, std=1.433673e-01
358.0s 4167 2025-10-10 10:24:43 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
358.0s 4168 2025-10-10 10:24:43 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
358.0s 4169 2025-10-10 10:24:43 - INFO - run_control_simulation:416 -   State hash: 486162903463244930
358.0s 4170 2025-10-10 10:24:43 - INFO - run_control_simulation:418 - ================================================================================
358.0s 4171 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=1.350430e-02
358.0s 4172 2025-10-10 10:24:43 - INFO - run_control_simulation:366 - ================================================================================
358.0s 4173 2025-10-10 10:24:43 - INFO - run_control_simulation:367 - STEP 5 START:
358.0s 4174 2025-10-10 10:24:43 - INFO - run_control_simulation:368 -   Controller: BaselineController
358.0s 4175 2025-10-10 10:24:43 - INFO - run_control_simulation:369 -   Action: 0.000000
358.0s 4176 2025-10-10 10:24:43 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
358.7s 4177 [WARNING] Automatic CFL correction applied (count: 24500):
358.7s 4178 Calculated CFL: 0.800 > Limit: 0.500
358.7s 4179 Original dt: 4.114980e-01 s
358.7s 4180 Corrected dt: 2.571863e-01 s
358.7s 4181 Correction factor: 1.6x
358.7s 4182 Max wave speed detected: 19.44 m/s
359.6s 4183 [WARNING] Automatic CFL correction applied (count: 24600):
359.6s 4184 Calculated CFL: 0.800 > Limit: 0.500
359.6s 4185 Original dt: 4.114980e-01 s
359.6s 4186 Corrected dt: 2.571863e-01 s
359.6s 4187 Correction factor: 1.6x
359.6s 4188 Max wave speed detected: 19.44 m/s
360.1s 4189 2025-10-10 10:24:45 - INFO - run_control_simulation:382 -   Reward: 0.015200
360.1s 4190 2025-10-10 10:24:45 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
360.1s 4191 2025-10-10 10:24:45 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
360.1s 4192 2025-10-10 10:24:45 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
360.1s 4193 2025-10-10 10:24:45 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
360.1s 4194 2025-10-10 10:24:45 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
360.1s 4195 2025-10-10 10:24:45 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
360.1s 4196 2025-10-10 10:24:45 - INFO - run_control_simulation:416 -   State hash: -5519875114531519719
360.1s 4197 2025-10-10 10:24:45 - INFO - run_control_simulation:418 - ================================================================================
360.1s 4198 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
360.1s 4199 2025-10-10 10:24:45 - INFO - run_control_simulation:366 - ================================================================================
360.1s 4200 2025-10-10 10:24:45 - INFO - run_control_simulation:367 - STEP 6 START:
360.1s 4201 2025-10-10 10:24:45 - INFO - run_control_simulation:368 -   Controller: BaselineController
360.1s 4202 2025-10-10 10:24:45 - INFO - run_control_simulation:369 -   Action: 1.000000
360.1s 4203 2025-10-10 10:24:45 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
360.6s 4204 [WARNING] Automatic CFL correction applied (count: 24700):
360.6s 4205 Calculated CFL: 0.800 > Limit: 0.500
360.6s 4206 Original dt: 4.114980e-01 s
360.6s 4207 Corrected dt: 2.571863e-01 s
360.6s 4208 Correction factor: 1.6x
360.6s 4209 Max wave speed detected: 19.44 m/s
361.5s 4210 [WARNING] Automatic CFL correction applied (count: 24800):
361.5s 4211 Calculated CFL: 0.800 > Limit: 0.500
361.5s 4212 Original dt: 4.114980e-01 s
361.5s 4213 Corrected dt: 2.571863e-01 s
361.5s 4214 Correction factor: 1.6x
361.5s 4215 Max wave speed detected: 19.44 m/s
362.3s 4216 2025-10-10 10:24:47 - INFO - run_control_simulation:382 -   Reward: -0.084800
362.3s 4217 2025-10-10 10:24:47 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
362.3s 4218 2025-10-10 10:24:47 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
362.3s 4219 2025-10-10 10:24:47 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
362.3s 4220 2025-10-10 10:24:47 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.349251e-02, max=1.980205e+00, std=1.433684e-01
362.3s 4221 2025-10-10 10:24:47 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
362.3s 4222 2025-10-10 10:24:47 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
362.3s 4223 2025-10-10 10:24:47 - INFO - run_control_simulation:416 -   State hash: -8407842355104553110
362.3s 4224 2025-10-10 10:24:47 - INFO - run_control_simulation:418 - ================================================================================
362.3s 4225 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=1.349251e-02
362.3s 4226 2025-10-10 10:24:47 - INFO - run_control_simulation:366 - ================================================================================
362.3s 4227 2025-10-10 10:24:47 - INFO - run_control_simulation:367 - STEP 7 START:
362.3s 4228 2025-10-10 10:24:47 - INFO - run_control_simulation:368 -   Controller: BaselineController
362.3s 4229 2025-10-10 10:24:47 - INFO - run_control_simulation:369 -   Action: 0.000000
362.3s 4230 2025-10-10 10:24:47 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
362.4s 4231 [WARNING] Automatic CFL correction applied (count: 24900):
362.4s 4232 Calculated CFL: 0.800 > Limit: 0.500
362.4s 4233 Original dt: 4.114980e-01 s
362.4s 4234 Corrected dt: 2.571863e-01 s
362.4s 4235 Correction factor: 1.6x
362.4s 4236 Max wave speed detected: 19.44 m/s
363.3s 4237 [WARNING] Automatic CFL correction applied (count: 25000):
363.3s 4238 Calculated CFL: 0.800 > Limit: 0.500
363.3s 4239 Original dt: 4.114980e-01 s
363.3s 4240 Corrected dt: 2.571863e-01 s
363.3s 4241 Correction factor: 1.6x
363.3s 4242 Max wave speed detected: 19.44 m/s
364.3s 4243 [WARNING] Automatic CFL correction applied (count: 25100):
364.3s 4244 Calculated CFL: 0.800 > Limit: 0.500
364.3s 4245 Original dt: 4.114980e-01 s
364.3s 4246 Corrected dt: 2.571863e-01 s
364.3s 4247 Correction factor: 1.6x
364.3s 4248 Max wave speed detected: 19.44 m/s
364.5s 4249 2025-10-10 10:24:49 - INFO - run_control_simulation:382 -   Reward: 0.015200
364.5s 4250 2025-10-10 10:24:49 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
364.5s 4251 2025-10-10 10:24:49 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
364.5s 4252 2025-10-10 10:24:49 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
364.5s 4253 2025-10-10 10:24:49 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
364.5s 4254 2025-10-10 10:24:49 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
364.5s 4255 2025-10-10 10:24:49 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
364.5s 4256 2025-10-10 10:24:49 - INFO - run_control_simulation:416 -   State hash: 3030279367285992548
364.5s 4257 2025-10-10 10:24:49 - INFO - run_control_simulation:418 - ================================================================================
364.5s 4258 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
364.5s 4259 2025-10-10 10:24:49 - INFO - run_control_simulation:366 - ================================================================================
364.5s 4260 2025-10-10 10:24:49 - INFO - run_control_simulation:367 - STEP 8 START:
364.5s 4261 2025-10-10 10:24:49 - INFO - run_control_simulation:368 -   Controller: BaselineController
364.5s 4262 2025-10-10 10:24:49 - INFO - run_control_simulation:369 -   Action: 1.000000
364.5s 4263 2025-10-10 10:24:49 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
365.2s 4264 [WARNING] Automatic CFL correction applied (count: 25200):
365.2s 4265 Calculated CFL: 0.800 > Limit: 0.500
365.2s 4266 Original dt: 4.114980e-01 s
365.2s 4267 Corrected dt: 2.571863e-01 s
365.2s 4268 Correction factor: 1.6x
365.2s 4269 Max wave speed detected: 19.44 m/s
366.1s 4270 [WARNING] Automatic CFL correction applied (count: 25300):
366.1s 4271 Calculated CFL: 0.800 > Limit: 0.500
366.1s 4272 Original dt: 4.114980e-01 s
366.1s 4273 Corrected dt: 2.571863e-01 s
366.1s 4274 Correction factor: 1.6x
366.1s 4275 Max wave speed detected: 19.44 m/s
366.6s 4276 2025-10-10 10:24:51 - INFO - run_control_simulation:382 -   Reward: -0.084800
366.6s 4277 2025-10-10 10:24:51 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
366.6s 4278 2025-10-10 10:24:51 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
366.6s 4279 2025-10-10 10:24:51 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
366.6s 4280 2025-10-10 10:24:51 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.349251e-02, max=1.980205e+00, std=1.433684e-01
366.6s 4281 2025-10-10 10:24:51 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
366.6s 4282 2025-10-10 10:24:51 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
366.6s 4283 2025-10-10 10:24:51 - INFO - run_control_simulation:416 -   State hash: 3301892107236678359
366.6s 4284 2025-10-10 10:24:51 - INFO - run_control_simulation:418 - ================================================================================
366.6s 4285 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=1.349251e-02
366.6s 4286 2025-10-10 10:24:51 - INFO - run_control_simulation:366 - ================================================================================
366.6s 4287 2025-10-10 10:24:51 - INFO - run_control_simulation:367 - STEP 9 START:
366.6s 4288 2025-10-10 10:24:51 - INFO - run_control_simulation:368 -   Controller: BaselineController
366.6s 4289 2025-10-10 10:24:51 - INFO - run_control_simulation:369 -   Action: 0.000000
366.6s 4290 2025-10-10 10:24:51 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
367.1s 4291 [WARNING] Automatic CFL correction applied (count: 25400):
367.1s 4292 Calculated CFL: 0.800 > Limit: 0.500
367.1s 4293 Original dt: 4.114980e-01 s
367.1s 4294 Corrected dt: 2.571863e-01 s
367.1s 4295 Correction factor: 1.6x
367.1s 4296 Max wave speed detected: 19.44 m/s
368.0s 4297 [WARNING] Automatic CFL correction applied (count: 25500):
368.0s 4298 Calculated CFL: 0.800 > Limit: 0.500
368.0s 4299 Original dt: 4.114980e-01 s
368.0s 4300 Corrected dt: 2.571863e-01 s
368.0s 4301 Correction factor: 1.6x
368.0s 4302 Max wave speed detected: 19.44 m/s
368.9s 4303 2025-10-10 10:24:53 - INFO - run_control_simulation:382 -   Reward: 0.015200
368.9s 4304 2025-10-10 10:24:53 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
368.9s 4305 2025-10-10 10:24:53 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
368.9s 4306 2025-10-10 10:24:53 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
368.9s 4307 2025-10-10 10:24:53 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
368.9s 4308 2025-10-10 10:24:53 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
368.9s 4309 2025-10-10 10:24:53 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
368.9s 4310 2025-10-10 10:24:53 - INFO - run_control_simulation:416 -   State hash: 5985207236181571537
368.9s 4311 2025-10-10 10:24:53 - INFO - run_control_simulation:418 - ================================================================================
368.9s 4312 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
368.9s 4313 
368.9s 4314 [SIMULATION COMPLETED] Summary:
368.9s 4315 - Total control steps: 10
368.9s 4316 - Total reward: -0.35
368.9s 4317 - Avg step time: 2.169s (device=gpu)
368.9s 4318 - Simulated time: 600.0s / 600.0s
368.9s 4319 - Wallclock time: 21.7s
368.9s 4320 - Speed ratio: 27.66x real-time
368.9s 4321 
368.9s 4322 2025-10-10 10:24:53 - INFO - run_control_simulation:453 -
368.9s 4323 [SIMULATION COMPLETED] Summary:
368.9s 4324 - Total control steps: 10
368.9s 4325 - Total reward: -0.35
368.9s 4326 - Avg step time: 2.169s (device=gpu)
368.9s 4327 - Simulated time: 600.0s / 600.0s
368.9s 4328 - Wallclock time: 21.7s
368.9s 4329 - Speed ratio: 27.66x real-time
368.9s 4330 
368.9s 4331 2025-10-10 10:24:53 - INFO - run_control_simulation:454 - Returning 10 state snapshots
368.9s 4332 2025-10-10 10:24:53 - INFO - run_performance_comparison:723 - Baseline states copied: 10 snapshots
368.9s 4333 2025-10-10 10:24:53 - INFO - run_performance_comparison:724 - Baseline FIRST state hash: 8901619324973113869
368.9s 4334 2025-10-10 10:24:53 - INFO - run_performance_comparison:725 - Baseline LAST state hash: 5985207236181571537
368.9s 4335 2025-10-10 10:24:53 - INFO - run_performance_comparison:726 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
368.9s 4336 2.14351577e-05]
368.9s 4337 2025-10-10 10:24:53 - INFO - run_performance_comparison:727 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
368.9s 4338 2.14319923e-05]
368.9s 4339 2025-10-10 10:24:53 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
368.9s 4340 2025-10-10 10:24:53 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=8901619324973113869, last=5985207236181571537
368.9s 4341 2025-10-10 10:24:53 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
368.9s 4342 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
368.9s 4343 2025-10-10 10:24:53 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
368.9s 4344 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
368.9s 4345 2025-10-10 10:24:53 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
368.9s 4346 Running RL controller...
368.9s 4347 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
368.9s 4348 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
368.9s 4349 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
368.9s 4350 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
368.9s 4351 2025-10-10 10:24:53 - INFO - run_control_simulation:286 - ================================================================================
368.9s 4352 2025-10-10 10:24:53 - INFO - run_control_simulation:287 - Starting run_control_simulation:
368.9s 4353 2025-10-10 10:24:53 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
368.9s 4354 2025-10-10 10:24:53 - INFO - run_control_simulation:289 -   - duration: 600.0s
368.9s 4355 2025-10-10 10:24:53 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
368.9s 4356 2025-10-10 10:24:53 - INFO - run_control_simulation:291 -   - device: gpu
368.9s 4357 2025-10-10 10:24:53 - INFO - run_control_simulation:292 -   - controller: RLController
368.9s 4358 2025-10-10 10:24:53 - INFO - run_control_simulation:293 -   - max_control_steps: 11
368.9s 4359 2025-10-10 10:24:53 - INFO - run_control_simulation:294 - ================================================================================
368.9s 4360 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
368.9s 4361 2025-10-10 10:24:53 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
368.9s 4362 DEBUG PARAMS: Reading K_m_kmh = 10.0
368.9s 4363 DEBUG PARAMS: Reading K_c_kmh = 15.0
368.9s 4364 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
368.9s 4365 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
368.9s 4366 2025-10-10 10:24:53 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
368.9s 4367 2025-10-10 10:24:53 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
368.9s 4368 [INFO] Calling env.reset()...
368.9s 4369 2025-10-10 10:24:53 - INFO - run_control_simulation:329 - Calling env.reset()...
368.9s 4370 DEBUG PARAMS: Reading K_m_kmh = 10.0
368.9s 4371 DEBUG PARAMS: Reading K_c_kmh = 15.0
368.9s 4372 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
368.9s 4373 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
368.9s 4374 2025-10-10 10:24:53 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
368.9s 4375 2025-10-10 10:24:53 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
368.9s 4376 2025-10-10 10:24:53 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
368.9s 4377 [INFO] Starting simulation loop (max 11 control steps)
368.9s 4378 2025-10-10 10:24:53 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
368.9s 4379 2025-10-10 10:24:53 - INFO - run_control_simulation:366 - ================================================================================
368.9s 4380 2025-10-10 10:24:53 - INFO - run_control_simulation:367 - STEP 0 START:
368.9s 4381 2025-10-10 10:24:53 - INFO - run_control_simulation:368 -   Controller: RLController
368.9s 4382 2025-10-10 10:24:53 - INFO - run_control_simulation:369 -   Action: 0.000000
368.9s 4383 2025-10-10 10:24:53 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
369.0s 4384 [WARNING] Automatic CFL correction applied (count: 25600):
369.0s 4385 Calculated CFL: 0.800 > Limit: 0.500
369.0s 4386 Original dt: 3.909130e-01 s
369.0s 4387 Corrected dt: 2.443206e-01 s
369.0s 4388 Correction factor: 1.6x
369.0s 4389 Max wave speed detected: 20.46 m/s
370.0s 4390 [WARNING] Automatic CFL correction applied (count: 25700):
370.0s 4391 Calculated CFL: 0.800 > Limit: 0.500
370.0s 4392 Original dt: 4.131708e-01 s
370.0s 4393 Corrected dt: 2.582317e-01 s
370.0s 4394 Correction factor: 1.6x
370.0s 4395 Max wave speed detected: 19.36 m/s
370.9s 4396 [WARNING] Automatic CFL correction applied (count: 25800):
370.9s 4397 Calculated CFL: 0.800 > Limit: 0.500
370.9s 4398 Original dt: 4.115220e-01 s
370.9s 4399 Corrected dt: 2.572013e-01 s
370.9s 4400 Correction factor: 1.6x
370.9s 4401 Max wave speed detected: 19.44 m/s
371.1s 4402 2025-10-10 10:24:56 - INFO - run_control_simulation:382 -   Reward: 0.015201
371.1s 4403 2025-10-10 10:24:56 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
371.1s 4404 2025-10-10 10:24:56 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
371.1s 4405 2025-10-10 10:24:56 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
371.1s 4406 2025-10-10 10:24:56 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.660497e+00, max=1.233795e+01, std=4.070771e+00
371.1s 4407 2025-10-10 10:24:56 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.034872, rho_c=0.047612
371.1s 4408 2025-10-10 10:24:56 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.395027, w_c=11.287416
371.1s 4409 2025-10-10 10:24:56 - INFO - run_control_simulation:416 -   State hash: 307714344387089582
371.1s 4410 2025-10-10 10:24:56 - INFO - run_control_simulation:418 - ================================================================================
371.1s 4411 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.660497e+00
371.1s 4412 2025-10-10 10:24:56 - INFO - run_control_simulation:366 - ================================================================================
371.1s 4413 2025-10-10 10:24:56 - INFO - run_control_simulation:367 - STEP 1 START:
371.1s 4414 2025-10-10 10:24:56 - INFO - run_control_simulation:368 -   Controller: RLController
371.1s 4415 2025-10-10 10:24:56 - INFO - run_control_simulation:369 -   Action: 0.000000
371.1s 4416 2025-10-10 10:24:56 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
371.9s 4417 [WARNING] Automatic CFL correction applied (count: 25900):
371.9s 4418 Calculated CFL: 0.800 > Limit: 0.500
371.9s 4419 Original dt: 4.114985e-01 s
371.9s 4420 Corrected dt: 2.571865e-01 s
371.9s 4421 Correction factor: 1.6x
371.9s 4422 Max wave speed detected: 19.44 m/s
372.9s 4423 [WARNING] Automatic CFL correction applied (count: 26000):
372.9s 4424 Calculated CFL: 0.800 > Limit: 0.500
372.9s 4425 Original dt: 4.114980e-01 s
372.9s 4426 Corrected dt: 2.571863e-01 s
372.9s 4427 Correction factor: 1.6x
372.9s 4428 Max wave speed detected: 19.44 m/s
373.4s 4429 2025-10-10 10:24:58 - INFO - run_control_simulation:382 -   Reward: 0.015200
373.4s 4430 2025-10-10 10:24:58 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
373.4s 4431 2025-10-10 10:24:58 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
373.4s 4432 2025-10-10 10:24:58 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
373.4s 4433 2025-10-10 10:24:58 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
373.4s 4434 2025-10-10 10:24:58 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.006453, rho_c=0.023310
373.4s 4435 2025-10-10 10:24:58 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.906360, w_c=14.063567
373.4s 4436 2025-10-10 10:24:58 - INFO - run_control_simulation:416 -   State hash: 5532959948344856089
373.4s 4437 2025-10-10 10:24:58 - INFO - run_control_simulation:418 - ================================================================================
373.4s 4438 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
373.4s 4439 2025-10-10 10:24:58 - INFO - run_control_simulation:366 - ================================================================================
373.4s 4440 2025-10-10 10:24:58 - INFO - run_control_simulation:367 - STEP 2 START:
373.4s 4441 2025-10-10 10:24:58 - INFO - run_control_simulation:368 -   Controller: RLController
373.4s 4442 2025-10-10 10:24:58 - INFO - run_control_simulation:369 -   Action: 0.000000
373.4s 4443 2025-10-10 10:24:58 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
373.8s 4444 [WARNING] Automatic CFL correction applied (count: 26100):
373.8s 4445 Calculated CFL: 0.800 > Limit: 0.500
373.8s 4446 Original dt: 4.114980e-01 s
373.8s 4447 Corrected dt: 2.571863e-01 s
373.8s 4448 Correction factor: 1.6x
373.8s 4449 Max wave speed detected: 19.44 m/s
374.7s 4450 [WARNING] Automatic CFL correction applied (count: 26200):
374.7s 4451 Calculated CFL: 0.800 > Limit: 0.500
374.7s 4452 Original dt: 4.114980e-01 s
374.7s 4453 Corrected dt: 2.571863e-01 s
374.7s 4454 Correction factor: 1.6x
374.7s 4455 Max wave speed detected: 19.44 m/s
375.5s 4456 2025-10-10 10:25:00 - INFO - run_control_simulation:382 -   Reward: 0.015200
375.5s 4457 2025-10-10 10:25:00 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
375.5s 4458 2025-10-10 10:25:00 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
375.5s 4459 2025-10-10 10:25:00 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
375.5s 4460 2025-10-10 10:25:00 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
375.5s 4461 2025-10-10 10:25:00 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
375.5s 4462 2025-10-10 10:25:00 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.270027, w_c=16.374889
375.5s 4463 2025-10-10 10:25:00 - INFO - run_control_simulation:416 -   State hash: -2815691635716835851
375.5s 4464 2025-10-10 10:25:00 - INFO - run_control_simulation:418 - ================================================================================
375.5s 4465 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
375.5s 4466 2025-10-10 10:25:00 - INFO - run_control_simulation:366 - ================================================================================
375.5s 4467 2025-10-10 10:25:00 - INFO - run_control_simulation:367 - STEP 3 START:
375.5s 4468 2025-10-10 10:25:00 - INFO - run_control_simulation:368 -   Controller: RLController
375.5s 4469 2025-10-10 10:25:00 - INFO - run_control_simulation:369 -   Action: 0.000000
375.5s 4470 2025-10-10 10:25:00 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
375.7s 4471 [WARNING] Automatic CFL correction applied (count: 26300):
375.7s 4472 Calculated CFL: 0.800 > Limit: 0.500
375.7s 4473 Original dt: 4.114980e-01 s
375.7s 4474 Corrected dt: 2.571863e-01 s
375.7s 4475 Correction factor: 1.6x
375.7s 4476 Max wave speed detected: 19.44 m/s
376.6s 4477 [WARNING] Automatic CFL correction applied (count: 26400):
376.6s 4478 Calculated CFL: 0.800 > Limit: 0.500
376.6s 4479 Original dt: 4.114980e-01 s
376.6s 4480 Corrected dt: 2.571863e-01 s
376.6s 4481 Correction factor: 1.6x
376.6s 4482 Max wave speed detected: 19.44 m/s
377.5s 4483 [WARNING] Automatic CFL correction applied (count: 26500):
377.5s 4484 Calculated CFL: 0.800 > Limit: 0.500
377.5s 4485 Original dt: 4.114980e-01 s
377.5s 4486 Corrected dt: 2.571863e-01 s
377.5s 4487 Correction factor: 1.6x
377.5s 4488 Max wave speed detected: 19.44 m/s
377.7s 4489 2025-10-10 10:25:02 - INFO - run_control_simulation:382 -   Reward: 0.015200
377.7s 4490 2025-10-10 10:25:02 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
377.7s 4491 2025-10-10 10:25:02 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
377.7s 4492 2025-10-10 10:25:02 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
377.7s 4493 2025-10-10 10:25:02 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
377.7s 4494 2025-10-10 10:25:02 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
377.7s 4495 2025-10-10 10:25:02 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408449
377.7s 4496 2025-10-10 10:25:02 - INFO - run_control_simulation:416 -   State hash: -8768069832435770563
377.7s 4497 2025-10-10 10:25:02 - INFO - run_control_simulation:418 - ================================================================================
377.7s 4498 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
377.7s 4499 2025-10-10 10:25:02 - INFO - run_control_simulation:366 - ================================================================================
377.7s 4500 2025-10-10 10:25:02 - INFO - run_control_simulation:367 - STEP 4 START:
377.7s 4501 2025-10-10 10:25:02 - INFO - run_control_simulation:368 -   Controller: RLController
377.7s 4502 2025-10-10 10:25:02 - INFO - run_control_simulation:369 -   Action: 0.000000
377.7s 4503 2025-10-10 10:25:02 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
378.5s 4504 [WARNING] Automatic CFL correction applied (count: 26600):
378.5s 4505 Calculated CFL: 0.800 > Limit: 0.500
378.5s 4506 Original dt: 4.114980e-01 s
378.5s 4507 Corrected dt: 2.571863e-01 s
378.5s 4508 Correction factor: 1.6x
378.5s 4509 Max wave speed detected: 19.44 m/s
379.4s 4510 [WARNING] Automatic CFL correction applied (count: 26700):
379.4s 4511 Calculated CFL: 0.800 > Limit: 0.500
379.4s 4512 Original dt: 4.114980e-01 s
379.4s 4513 Corrected dt: 2.571863e-01 s
379.4s 4514 Correction factor: 1.6x
379.4s 4515 Max wave speed detected: 19.44 m/s
379.9s 4516 2025-10-10 10:25:05 - INFO - run_control_simulation:382 -   Reward: 0.015200
379.9s 4517 2025-10-10 10:25:05 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
379.9s 4518 2025-10-10 10:25:05 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
379.9s 4519 2025-10-10 10:25:05 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
379.9s 4520 2025-10-10 10:25:05 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
379.9s 4521 2025-10-10 10:25:05 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
379.9s 4522 2025-10-10 10:25:05 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408496
379.9s 4523 2025-10-10 10:25:05 - INFO - run_control_simulation:416 -   State hash: 8137734836848639043
379.9s 4524 2025-10-10 10:25:05 - INFO - run_control_simulation:418 - ================================================================================
379.9s 4525 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
379.9s 4526 2025-10-10 10:25:05 - INFO - run_control_simulation:366 - ================================================================================
379.9s 4527 2025-10-10 10:25:05 - INFO - run_control_simulation:367 - STEP 5 START:
379.9s 4528 2025-10-10 10:25:05 - INFO - run_control_simulation:368 -   Controller: RLController
379.9s 4529 2025-10-10 10:25:05 - INFO - run_control_simulation:369 -   Action: 0.000000
379.9s 4530 2025-10-10 10:25:05 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
380.4s 4531 [WARNING] Automatic CFL correction applied (count: 26800):
380.4s 4532 Calculated CFL: 0.800 > Limit: 0.500
380.4s 4533 Original dt: 4.114980e-01 s
380.4s 4534 Corrected dt: 2.571863e-01 s
380.4s 4535 Correction factor: 1.6x
380.4s 4536 Max wave speed detected: 19.44 m/s
381.3s 4537 [WARNING] Automatic CFL correction applied (count: 26900):
381.3s 4538 Calculated CFL: 0.800 > Limit: 0.500
381.3s 4539 Original dt: 4.114980e-01 s
381.3s 4540 Corrected dt: 2.571863e-01 s
381.3s 4541 Correction factor: 1.6x
381.3s 4542 Max wave speed detected: 19.44 m/s
382.1s 4543 2025-10-10 10:25:07 - INFO - run_control_simulation:382 -   Reward: 0.015200
382.1s 4544 2025-10-10 10:25:07 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
382.1s 4545 2025-10-10 10:25:07 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
382.1s 4546 2025-10-10 10:25:07 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
382.1s 4547 2025-10-10 10:25:07 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649701e-08, max=5.259947e-07, std=7.009070e-08
382.1s 4548 2025-10-10 10:25:07 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
382.1s 4549 2025-10-10 10:25:07 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
382.1s 4550 2025-10-10 10:25:07 - INFO - run_control_simulation:416 -   State hash: -79274607907826371
382.1s 4551 2025-10-10 10:25:07 - INFO - run_control_simulation:418 - ================================================================================
382.1s 4552 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649701e-08
382.2s 4553 2025-10-10 10:25:07 - INFO - run_control_simulation:366 - ================================================================================
382.2s 4554 2025-10-10 10:25:07 - INFO - run_control_simulation:367 - STEP 6 START:
382.2s 4555 2025-10-10 10:25:07 - INFO - run_control_simulation:368 -   Controller: RLController
382.2s 4556 2025-10-10 10:25:07 - INFO - run_control_simulation:369 -   Action: 0.000000
382.2s 4557 2025-10-10 10:25:07 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
382.3s 4558 [WARNING] Automatic CFL correction applied (count: 27000):
382.3s 4559 Calculated CFL: 0.800 > Limit: 0.500
382.3s 4560 Original dt: 4.114980e-01 s
382.3s 4561 Corrected dt: 2.571863e-01 s
382.3s 4562 Correction factor: 1.6x
382.3s 4563 Max wave speed detected: 19.44 m/s
383.2s 4564 [WARNING] Automatic CFL correction applied (count: 27100):
383.2s 4565 Calculated CFL: 0.800 > Limit: 0.500
383.2s 4566 Original dt: 4.114980e-01 s
383.2s 4567 Corrected dt: 2.571863e-01 s
383.2s 4568 Correction factor: 1.6x
383.2s 4569 Max wave speed detected: 19.44 m/s
384.1s 4570 [WARNING] Automatic CFL correction applied (count: 27200):
384.1s 4571 Calculated CFL: 0.800 > Limit: 0.500
384.1s 4572 Original dt: 4.114980e-01 s
384.1s 4573 Corrected dt: 2.571863e-01 s
384.1s 4574 Correction factor: 1.6x
384.1s 4575 Max wave speed detected: 19.44 m/s
384.3s 4576 2025-10-10 10:25:09 - INFO - run_control_simulation:382 -   Reward: 0.015200
384.3s 4577 2025-10-10 10:25:09 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
384.3s 4578 2025-10-10 10:25:09 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
384.3s 4579 2025-10-10 10:25:09 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
384.3s 4580 2025-10-10 10:25:09 - INFO - run_control_simulation:401 -     Diff statistics: mean=2.295406e-11, max=7.384955e-10, std=9.818587e-11
384.3s 4581 2025-10-10 10:25:09 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
384.3s 4582 2025-10-10 10:25:09 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
384.3s 4583 2025-10-10 10:25:09 - INFO - run_control_simulation:416 -   State hash: -8407842355104553110
384.3s 4584 2025-10-10 10:25:09 - INFO - run_control_simulation:418 - ================================================================================
384.3s 4585 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295406e-11
384.3s 4586 2025-10-10 10:25:09 - INFO - run_control_simulation:366 - ================================================================================
384.3s 4587 2025-10-10 10:25:09 - INFO - run_control_simulation:367 - STEP 7 START:
384.3s 4588 2025-10-10 10:25:09 - INFO - run_control_simulation:368 -   Controller: RLController
384.3s 4589 2025-10-10 10:25:09 - INFO - run_control_simulation:369 -   Action: 0.000000
384.3s 4590 2025-10-10 10:25:09 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
385.0s 4591 [WARNING] Automatic CFL correction applied (count: 27300):
385.0s 4592 Calculated CFL: 0.800 > Limit: 0.500
385.0s 4593 Original dt: 4.114980e-01 s
385.0s 4594 Corrected dt: 2.571863e-01 s
385.0s 4595 Correction factor: 1.6x
385.0s 4596 Max wave speed detected: 19.44 m/s
385.9s 4597 [WARNING] Automatic CFL correction applied (count: 27400):
385.9s 4598 Calculated CFL: 0.800 > Limit: 0.500
385.9s 4599 Original dt: 4.114980e-01 s
385.9s 4600 Corrected dt: 2.571863e-01 s
385.9s 4601 Correction factor: 1.6x
385.9s 4602 Max wave speed detected: 19.44 m/s
386.4s 4603 2025-10-10 10:25:11 - INFO - run_control_simulation:382 -   Reward: 0.015200
386.4s 4604 2025-10-10 10:25:11 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
386.4s 4605 2025-10-10 10:25:11 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
386.4s 4606 2025-10-10 10:25:11 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
386.4s 4607 2025-10-10 10:25:11 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
386.4s 4608 2025-10-10 10:25:11 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
386.4s 4609 2025-10-10 10:25:11 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
386.4s 4610 2025-10-10 10:25:11 - INFO - run_control_simulation:416 -   State hash: 3030279367285992548
386.4s 4611 2025-10-10 10:25:11 - INFO - run_control_simulation:418 - ================================================================================
386.4s 4612 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
386.4s 4613 2025-10-10 10:25:11 - INFO - run_control_simulation:366 - ================================================================================
386.4s 4614 2025-10-10 10:25:11 - INFO - run_control_simulation:367 - STEP 8 START:
386.4s 4615 2025-10-10 10:25:11 - INFO - run_control_simulation:368 -   Controller: RLController
386.4s 4616 2025-10-10 10:25:11 - INFO - run_control_simulation:369 -   Action: 0.000000
386.4s 4617 2025-10-10 10:25:11 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
386.8s 4618 [WARNING] Automatic CFL correction applied (count: 27500):
386.8s 4619 Calculated CFL: 0.800 > Limit: 0.500
386.8s 4620 Original dt: 4.114980e-01 s
386.8s 4621 Corrected dt: 2.571863e-01 s
386.8s 4622 Correction factor: 1.6x
386.8s 4623 Max wave speed detected: 19.44 m/s
387.8s 4624 [WARNING] Automatic CFL correction applied (count: 27600):
387.8s 4625 Calculated CFL: 0.800 > Limit: 0.500
387.8s 4626 Original dt: 4.114980e-01 s
387.8s 4627 Corrected dt: 2.571863e-01 s
387.8s 4628 Correction factor: 1.6x
387.8s 4629 Max wave speed detected: 19.44 m/s
388.6s 4630 2025-10-10 10:25:13 - INFO - run_control_simulation:382 -   Reward: 0.015200
388.6s 4631 2025-10-10 10:25:13 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
388.6s 4632 2025-10-10 10:25:13 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
388.6s 4633 2025-10-10 10:25:13 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
388.6s 4634 2025-10-10 10:25:13 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
388.6s 4635 2025-10-10 10:25:13 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
388.6s 4636 2025-10-10 10:25:13 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
388.6s 4637 2025-10-10 10:25:13 - INFO - run_control_simulation:416 -   State hash: 1323412209553471567
388.6s 4638 2025-10-10 10:25:13 - INFO - run_control_simulation:418 - ================================================================================
388.6s 4639 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
388.6s 4640 2025-10-10 10:25:13 - INFO - run_control_simulation:366 - ================================================================================
388.6s 4641 2025-10-10 10:25:13 - INFO - run_control_simulation:367 - STEP 9 START:
388.6s 4642 2025-10-10 10:25:13 - INFO - run_control_simulation:368 -   Controller: RLController
388.6s 4643 2025-10-10 10:25:13 - INFO - run_control_simulation:369 -   Action: 0.000000
388.6s 4644 2025-10-10 10:25:13 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
388.7s 4645 [WARNING] Automatic CFL correction applied (count: 27700):
388.7s 4646 Calculated CFL: 0.800 > Limit: 0.500
388.7s 4647 Original dt: 4.114980e-01 s
388.7s 4648 Corrected dt: 2.571863e-01 s
388.7s 4649 Correction factor: 1.6x
388.7s 4650 Max wave speed detected: 19.44 m/s
389.6s 4651 [WARNING] Automatic CFL correction applied (count: 27800):
389.6s 4652 Calculated CFL: 0.800 > Limit: 0.500
389.6s 4653 Original dt: 4.114980e-01 s
389.6s 4654 Corrected dt: 2.571863e-01 s
389.6s 4655 Correction factor: 1.6x
389.6s 4656 Max wave speed detected: 19.44 m/s
390.5s 4657 [WARNING] Automatic CFL correction applied (count: 27900):
390.5s 4658 Calculated CFL: 0.800 > Limit: 0.500
390.5s 4659 Original dt: 4.114980e-01 s
390.5s 4660 Corrected dt: 2.571863e-01 s
390.5s 4661 Correction factor: 1.6x
390.5s 4662 Max wave speed detected: 19.44 m/s
390.8s 4663 2025-10-10 10:25:15 - INFO - run_control_simulation:382 -   Reward: 0.015200
390.8s 4664 2025-10-10 10:25:15 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
390.8s 4665 2025-10-10 10:25:15 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
390.8s 4666 2025-10-10 10:25:15 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
390.8s 4667 2025-10-10 10:25:15 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
390.8s 4668 2025-10-10 10:25:15 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.000022, rho_c=0.000025
390.8s 4669 2025-10-10 10:25:15 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.271585, w_c=16.408497
390.8s 4670 2025-10-10 10:25:15 - INFO - run_control_simulation:416 -   State hash: 4581751893297325247
390.8s 4671 2025-10-10 10:25:15 - INFO - run_control_simulation:418 - ================================================================================
390.8s 4672 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
390.8s 4673 
390.8s 4674 [SIMULATION COMPLETED] Summary:
390.8s 4675 - Total control steps: 10
390.8s 4676 - Total reward: 0.15
390.8s 4677 - Avg step time: 2.187s (device=gpu)
390.8s 4678 - Simulated time: 600.0s / 600.0s
390.8s 4679 - Wallclock time: 21.9s
390.8s 4680 - Speed ratio: 27.44x real-time
390.8s 4681 
390.8s 4682 2025-10-10 10:25:15 - INFO - run_control_simulation:453 -
390.8s 4683 [SIMULATION COMPLETED] Summary:
390.8s 4684 - Total control steps: 10
390.8s 4685 - Total reward: 0.15
390.8s 4686 - Avg step time: 2.187s (device=gpu)
390.8s 4687 - Simulated time: 600.0s / 600.0s
390.8s 4688 - Wallclock time: 21.9s
390.8s 4689 - Speed ratio: 27.44x real-time
390.8s 4690 
390.8s 4691 2025-10-10 10:25:15 - INFO - run_control_simulation:454 - Returning 10 state snapshots
390.8s 4692 2025-10-10 10:25:15 - INFO - run_performance_comparison:760 - RL states copied: 10 snapshots
390.8s 4693 2025-10-10 10:25:15 - INFO - run_performance_comparison:761 - RL FIRST state hash: 307714344387089582
390.8s 4694 2025-10-10 10:25:15 - INFO - run_performance_comparison:762 - RL LAST state hash: 4581751893297325247
390.8s 4695 2025-10-10 10:25:15 - INFO - run_performance_comparison:763 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
390.8s 4696 2.14351577e-05]
390.8s 4697 2025-10-10 10:25:15 - INFO - run_performance_comparison:764 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
390.8s 4698 2.14319923e-05]
390.8s 4699 2025-10-10 10:25:15 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
390.8s 4700 2025-10-10 10:25:15 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=307714344387089582, last=4581751893297325247
390.8s 4701 2025-10-10 10:25:15 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
390.8s 4702 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
390.8s 4703 2025-10-10 10:25:15 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
390.8s 4704 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
390.8s 4705 2025-10-10 10:25:15 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
390.8s 4706 2025-10-10 10:25:15 - WARNING - run_performance_comparison:772 - States comparison - Identical: False, baseline_hash=8901619324973113869, rl_hash=307714344387089582
390.8s 4707 2025-10-10 10:25:15 - INFO - run_performance_comparison:781 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
390.8s 4708 2025-10-10 10:25:15 - INFO - run_performance_comparison:782 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
390.8s 4709 2025-10-10 10:25:15 - INFO - run_performance_comparison:790 - Flow improvement: 0.000%
390.8s 4710 2025-10-10 10:25:15 - INFO - run_performance_comparison:791 - Efficiency improvement: 0.000%
390.8s 4711 2025-10-10 10:25:15 - INFO - run_performance_comparison:792 - Delay reduction: -0.000%
390.8s 4712 Flow improvement: 0.0%
390.8s 4713 Efficiency improvement: 0.0%
390.8s 4714 Delay reduction: -0.0%
390.8s 4715 Result: FAILED
390.8s 4716 
390.8s 4717 [FIGURES] Generating RL performance figures...
391.4s 4718 [OK] fig_rl_performance_improvements.png
391.9s 4719 [OK] fig_rl_learning_curve.png
391.9s 4720 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
391.9s 4721 
391.9s 4722 [METRICS] Saving RL performance metrics...
391.9s 4723 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
391.9s 4724 
391.9s 4725 [LATEX] Generating content for Section 7.6...
391.9s 4726 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
391.9s 4727 
391.9s 4728 === RL Performance Validation Summary ===
391.9s 4729 Scenarios passed: 0/1 (0.0%)
391.9s 4730 Average flow improvement: 0.00%
391.9s 4731 Average efficiency improvement: 0.00%
391.9s 4732 Average delay reduction: 0.00%
391.9s 4733 Overall validation: FAILED
391.9s 4734 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
394.6s 4735 [WARNING] Tests returned code: 1
394.6s 4736 
394.6s 4737 [STEP 4/4] Copying artifacts and cleaning up...
394.6s 4738 [ARTIFACTS] Copying results for section_7_6_rl_performance...
394.6s 4739 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
394.6s 4740 [ARTIFACTS] NPZ files: 0
394.6s 4741 [ARTIFACTS] PNG figures: 2
394.6s 4742 [ARTIFACTS] YAML scenarios: 1
394.6s 4743 [ARTIFACTS] TEX files: 1
394.6s 4744 [ARTIFACTS] JSON files: 1
394.6s 4745 [ARTIFACTS] CSV metrics: 1
394.6s 4746 TRACKING_SUCCESS: Artifacts copied
394.6s 4747 [SUCCESS] All artifacts organized and copied
394.6s 4748 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
394.6s 4749 [OK] Cleanup completed - only validation results remain
394.6s 4750 TRACKING_SUCCESS: Cleanup completed
394.6s 4751 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
394.6s 4752 TRACKING_SUCCESS: Session summary created
394.6s 4753 
394.6s 4754 [FINAL] Validation workflow completed
394.6s 4755 Remote logging finalized - ready for download
394.6s 4756 
394.6s 4757 ================================================================================
394.6s 4758 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
394.6s 4759 Output ready at: /kaggle/working/validation_results/
394.6s 4760 ================================================================================
398.1s 4761 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
398.1s 4762 warn(
398.1s 4763 [NbConvertApp] Converting notebook __script__.ipynb to html
398.8s 4764 [NbConvertApp] Writing 321270 bytes to __results__.html