0.6s 1 ================================================================================
0.6s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.6s 3 Revendications: R5
0.6s 4 ================================================================================
0.6s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.6s 6 Branch: main
5.6s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.6s 8 PyTorch: 2.6.0+cu124
5.7s 9 CUDA available: True
5.7s 10 CUDA device: Tesla P100-PCIE-16GB
5.7s 11 CUDA version: 12.4
5.7s 12 
5.7s 13 [STEP 1/4] Cloning repository from GitHub...
5.7s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
10.5s 15 [OK] Repository cloned successfully
10.5s 16 TRACKING_SUCCESS: Repository cloned
10.5s 17 
10.5s 18 [STEP 2/4] Installing dependencies...
10.5s 19 Installing PyYAML...
14.5s 20 Installing matplotlib...
17.4s 21 Installing pandas...
20.4s 22 Installing scipy...
23.4s 23 Installing numpy...
26.3s 24 Installing gymnasium...
29.2s 25 Installing stable-baselines3...
107.5s 26 [OK] Dependencies installed
107.5s 27 TRACKING_SUCCESS: Dependencies ready
107.5s 28 
107.5s 29 [STEP 3/4] Running validation tests...
107.5s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
107.5s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
107.5s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
107.5s 33 ============================================================
119.8s 34 2025-10-10 15:34:02.289407: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
120.0s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
120.0s 36 E0000 00:00:1760110442.493360      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
120.1s 37 E0000 00:00:1760110442.549219      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
131.5s 38 ================================================================================
131.5s 39 QUICK TEST MODE ENABLED
131.5s 40 - Training: 2 timesteps only
131.5s 41 - Duration: 2 minutes simulated time
131.5s 42 - Scenarios: 1 scenario only
131.5s 43 - Expected runtime: ~5 minutes on GPU
131.5s 44 ================================================================================
131.5s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
131.5s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
131.5s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
131.5s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
131.5s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
131.5s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
131.5s 51 2025-10-10 15:34:13 - INFO - _setup_debug_logging:119 - ================================================================================
131.5s 52 2025-10-10 15:34:13 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
131.5s 53 2025-10-10 15:34:13 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
131.5s 54 2025-10-10 15:34:13 - INFO - _setup_debug_logging:122 - Quick test mode: True
131.5s 55 2025-10-10 15:34:13 - INFO - _setup_debug_logging:123 - ================================================================================
131.5s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
131.5s 57 === Section 7.6: RL Performance Validation ===
131.5s 58 Testing RL agent performance vs baseline controllers...
131.6s 59 [DEVICE] Detected: GPU
131.7s 60 [GPU INFO] Tesla P100-PCIE-16GB
131.7s 61 
131.7s 62 [PHASE 1/2] Training RL agents...
131.7s 63 [QUICK TEST] Training only: traffic_light_control
131.7s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
131.7s 65 2025-10-10 15:34:14 - INFO - train_rl_agent:562 - ================================================================================
131.7s 66 2025-10-10 15:34:14 - INFO - train_rl_agent:563 - Starting train_rl_agent for scenario: traffic_light_control
131.7s 67 2025-10-10 15:34:14 - INFO - train_rl_agent:564 -   - Device: gpu
131.7s 68 2025-10-10 15:34:14 - INFO - train_rl_agent:565 -   - Total timesteps: 100
131.7s 69 2025-10-10 15:34:14 - INFO - train_rl_agent:566 -   - Episode max time: 120.0s
131.7s 70 2025-10-10 15:34:14 - INFO - train_rl_agent:567 -   - Checkpoint frequency: 50
131.7s 71 2025-10-10 15:34:14 - INFO - train_rl_agent:568 - ================================================================================
131.7s 72 
131.7s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
131.7s 74 Device: gpu
131.7s 75 Total timesteps: 100
131.7s 76 Episode max time: 120.0s
131.7s 77 Checkpoint frequency: 50 steps
131.7s 78 2025-10-10 15:34:14 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
131.7s 79 2025-10-10 15:34:14 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
131.7s 80 2025-10-10 15:34:14 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
131.7s 81 2025-10-10 15:34:14 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
131.7s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
131.7s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
131.7s 84 Using device: gpu
131.7s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
131.7s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
131.7s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
131.7s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
131.7s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
131.7s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
131.7s 91 Loading road quality type: uniform
131.7s 92 Uniform road quality value: 2
131.7s 93 Road quality loaded.
131.7s 94 Initial state created.
131.7s 95 Transferring initial state and road quality to GPU...
131.7s 96 GPU data transfer complete.
131.7s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
131.7s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
131.7s 99 warn(NumbaPerformanceWarning(msg))
133.1s 100 Initial boundary conditions applied.
133.1s 101 TrafficSignalEnvDirect initialized:
133.1s 102 Decision interval: 60.0s
133.1s 103 Observation segments: 6
133.1s 104 Observation space: (26,)
133.1s 105 Action space: 2
133.1s 106 Device: gpu
133.1s 107 [INFO] Environment created: obs_space=(26,), action_space=2
133.1s 108 [INFO] Initializing PPO agent from scratch...
133.1s 109 Using cuda device
133.1s 110 Wrapping the env with a `Monitor` wrapper
133.1s 111 Wrapping the env in a DummyVecEnv.
133.1s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
133.1s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
133.1s 114 Info: (n_steps=100 and n_envs=1)
133.1s 115 warnings.warn(
137.5s 116 
137.5s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
137.5s 118 [INFO] Training for 100 timesteps...
137.5s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
137.5s 120 Using device: gpu
137.5s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
137.5s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
137.5s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
137.5s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
137.5s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
137.5s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
137.5s 127 Loading road quality type: uniform
137.5s 128 Uniform road quality value: 2
137.5s 129 Road quality loaded.
137.5s 130 Initial state created.
137.5s 131 Transferring initial state and road quality to GPU...
137.5s 132 GPU data transfer complete.
137.5s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
137.5s 134 Initial boundary conditions applied.
137.5s 135 [BC UPDATE] left → phase 0 RED (reduced inflow)
137.5s 136 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
137.5s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
137.5s 138 
137.5s 139 🚀 Training started: 100 total timesteps
138.1s 140 [BC UPDATE] left → phase 0 RED (reduced inflow)
138.1s 141 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
138.1s 142 Running simulation until t = 60.00 s, outputting every 60.00 s
138.1s 143 
138.1s 144 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
138.1s 145 warn(NumbaPerformanceWarning(msg))
138.5s 146 [WARNING] Automatic CFL correction applied (count: 1):
138.5s 147 Calculated CFL: 0.800 > Limit: 0.500
138.5s 148 Original dt: 3.228311e-01 s
138.5s 149 Corrected dt: 2.017695e-01 s
138.5s 150 Correction factor: 1.6x
138.5s 151 Max wave speed detected: 24.78 m/s
139.0s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.0s 153 warn(NumbaPerformanceWarning(msg))
139.3s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.3s 155 warn(NumbaPerformanceWarning(msg))
139.3s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.3s 157 warn(NumbaPerformanceWarning(msg))
139.4s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.4s 159 warn(NumbaPerformanceWarning(msg))
139.8s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.8s 161 warn(NumbaPerformanceWarning(msg))
139.9s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.9s 163 warn(NumbaPerformanceWarning(msg))
140.0s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.0s 165 warn(NumbaPerformanceWarning(msg))
140.1s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.1s 167 warn(NumbaPerformanceWarning(msg))
140.2s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.2s 169 warn(NumbaPerformanceWarning(msg))
140.2s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.2s 171 warn(NumbaPerformanceWarning(msg))
140.3s 172 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.3s 173 warn(NumbaPerformanceWarning(msg))
140.7s 174 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
141.1s 175 [WARNING] Automatic CFL correction applied (count: 100):
141.1s 176 Calculated CFL: 0.800 > Limit: 0.500
141.1s 177 Original dt: 4.145004e-01 s
141.1s 178 Corrected dt: 2.590627e-01 s
141.1s 179 Correction factor: 1.6x
141.1s 180 Max wave speed detected: 19.30 m/s
141.1s 181 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
141.6s 182 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
142.1s 183 [WARNING] Automatic CFL correction applied (count: 200):
142.1s 184 Calculated CFL: 0.800 > Limit: 0.500
142.1s 185 Original dt: 4.115380e-01 s
142.1s 186 Corrected dt: 2.572113e-01 s
142.1s 187 Correction factor: 1.6x
142.1s 188 Max wave speed detected: 19.44 m/s
142.1s 189 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
142.3s 190 Stored output at t = 60.0000 s (Step 231)
142.3s 191 
142.3s 192 [A
142.3s 193 
142.3s 194 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 14.09s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 14.09s/s]
142.3s 195 Simulation finished at t = 60.0000 s after 231 steps.
142.3s 196 Total runtime: 4.26 seconds.
142.4s 197 [BC UPDATE] left → phase 0 RED (reduced inflow)
142.4s 198 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
142.4s 199 Running simulation until t = 120.00 s, outputting every 60.00 s
142.4s 200 
142.5s 201 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
143.0s 202 [WARNING] Automatic CFL correction applied (count: 300):
143.0s 203 Calculated CFL: 0.800 > Limit: 0.500
143.0s 204 Original dt: 4.114988e-01 s
143.0s 205 Corrected dt: 2.571867e-01 s
143.0s 206 Correction factor: 1.6x
143.0s 207 Max wave speed detected: 19.44 m/s
143.0s 208 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
143.4s 209 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
143.9s 210 [WARNING] Automatic CFL correction applied (count: 400):
143.9s 211 Calculated CFL: 0.800 > Limit: 0.500
143.9s 212 Original dt: 4.114980e-01 s
143.9s 213 Corrected dt: 2.571863e-01 s
143.9s 214 Correction factor: 1.6x
143.9s 215 Max wave speed detected: 19.44 m/s
143.9s 216 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
144.3s 217 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
144.5s 218 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
144.5s 219 Stored output at t = 120.0000 s (Step 465)
144.5s 220 [A
144.5s 221 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.54s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.53s/s]
144.5s 222 
144.5s 223 Simulation finished at t = 120.0000 s after 465 steps.
144.5s 224 Total runtime: 2.10 seconds.
144.5s 225 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
144.5s 226 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
144.5s 227 Using device: gpu
144.5s 228 DEBUG PARAMS: Reading K_m_kmh = 10.0
144.5s 229 DEBUG PARAMS: Reading K_c_kmh = 15.0
144.5s 230 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
144.5s 231 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
144.5s 232 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
144.5s 233 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
144.5s 234 Loading road quality type: uniform
144.5s 235 Uniform road quality value: 2
144.5s 236 Road quality loaded.
144.5s 237 Initial state created.
144.5s 238 Transferring initial state and road quality to GPU...
144.5s 239 GPU data transfer complete.
144.5s 240 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
144.5s 241 Initial boundary conditions applied.
144.5s 242 [BC UPDATE] left → phase 0 RED (reduced inflow)
144.5s 243 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
144.5s 244 [BC UPDATE] left → phase 1 GREEN (normal inflow)
144.5s 245 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
144.5s 246 Running simulation until t = 60.00 s, outputting every 60.00 s
144.5s 247 
144.8s 248 [WARNING] Automatic CFL correction applied (count: 500):
144.8s 249 Calculated CFL: 0.800 > Limit: 0.500
144.8s 250 Original dt: 4.758816e-01 s
144.8s 251 Corrected dt: 2.974260e-01 s
144.8s 252 Correction factor: 1.6x
144.8s 253 Max wave speed detected: 16.81 m/s
144.9s 254 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
145.4s 255 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
145.7s 256 [WARNING] Automatic CFL correction applied (count: 600):
145.7s 257 Calculated CFL: 0.800 > Limit: 0.500
145.7s 258 Original dt: 4.121510e-01 s
145.7s 259 Corrected dt: 2.575944e-01 s
145.7s 260 Correction factor: 1.6x
145.7s 261 Max wave speed detected: 19.41 m/s
145.8s 262 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
146.3s 263 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
146.6s 264 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
146.6s 265 [A
146.6s 266 Stored output at t = 60.0000 s (Step 231)
146.6s 267 
146.6s 268 Simulation finished at t = 60.0000 s after 231 steps.
146.6s 269 Total runtime: 2.10 seconds.
146.6s 270 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.60s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.60s/s]
146.6s 271 [BC UPDATE] left → phase 1 GREEN (normal inflow)
146.6s 272 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
146.6s 273 Running simulation until t = 120.00 s, outputting every 60.00 s
146.6s 274 
146.6s 275 [WARNING] Automatic CFL correction applied (count: 700):
146.6s 276 Calculated CFL: 0.800 > Limit: 0.500
146.6s 277 Original dt: 4.115082e-01 s
146.6s 278 Corrected dt: 2.571926e-01 s
146.6s 279 Correction factor: 1.6x
146.6s 280 Max wave speed detected: 19.44 m/s
146.8s 281 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
147.3s 282 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
147.6s 283 [WARNING] Automatic CFL correction applied (count: 800):
147.6s 284 Calculated CFL: 0.800 > Limit: 0.500
147.6s 285 Original dt: 4.114982e-01 s
147.6s 286 Corrected dt: 2.571864e-01 s
147.6s 287 Correction factor: 1.6x
147.6s 288 Max wave speed detected: 19.44 m/s
147.7s 289 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
148.2s 290 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
148.5s 291 [WARNING] Automatic CFL correction applied (count: 900):
148.5s 292 Calculated CFL: 0.800 > Limit: 0.500
148.5s 293 Original dt: 4.114980e-01 s
148.5s 294 Corrected dt: 2.571863e-01 s
148.5s 295 Correction factor: 1.6x
148.5s 296 Max wave speed detected: 19.44 m/s
148.6s 297 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
148.8s 298 Stored output at t = 120.0000 s (Step 465)
148.8s 299 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
148.8s 300 [A
148.8s 301 
148.8s 302 Simulation finished at t = 120.0000 s after 465 steps.
148.8s 303 Total runtime: 2.18 seconds.
148.8s 304 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.54s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.53s/s]
148.8s 305 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
148.8s 306 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
148.8s 307 Using device: gpu
148.8s 308 DEBUG PARAMS: Reading K_m_kmh = 10.0
148.8s 309 DEBUG PARAMS: Reading K_c_kmh = 15.0
148.8s 310 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
148.8s 311 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
148.8s 312 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
148.8s 313 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
148.8s 314 Loading road quality type: uniform
148.8s 315 Uniform road quality value: 2
148.8s 316 Road quality loaded.
148.8s 317 Initial state created.
148.8s 318 Transferring initial state and road quality to GPU...
148.8s 319 GPU data transfer complete.
148.8s 320 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
148.8s 321 Initial boundary conditions applied.
148.8s 322 [BC UPDATE] left → phase 0 RED (reduced inflow)
148.8s 323 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
148.8s 324 [BC UPDATE] left → phase 1 GREEN (normal inflow)
148.8s 325 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
148.8s 326 Running simulation until t = 60.00 s, outputting every 60.00 s
148.8s 327 
149.3s 328 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
149.4s 329 [WARNING] Automatic CFL correction applied (count: 1000):
149.4s 330 Calculated CFL: 0.800 > Limit: 0.500
149.4s 331 Original dt: 4.225636e-01 s
149.4s 332 Corrected dt: 2.641023e-01 s
149.4s 333 Correction factor: 1.6x
149.4s 334 Max wave speed detected: 18.93 m/s
149.7s 335 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
150.2s 336 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
150.3s 337 [WARNING] Automatic CFL correction applied (count: 1100):
150.3s 338 Calculated CFL: 0.800 > Limit: 0.500
150.3s 339 Original dt: 4.116395e-01 s
150.3s 340 Corrected dt: 2.572747e-01 s
150.3s 341 Correction factor: 1.6x
150.3s 342 Max wave speed detected: 19.43 m/s
150.6s 343 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
150.9s 344 Stored output at t = 60.0000 s (Step 231)
150.9s 345 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
150.9s 346 [A
150.9s 347 
150.9s 348 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.71s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.70s/s]
150.9s 349 Simulation finished at t = 60.0000 s after 231 steps.
150.9s 350 Total runtime: 2.09 seconds.
150.9s 351 [BC UPDATE] left → phase 0 RED (reduced inflow)
150.9s 352 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
150.9s 353 Running simulation until t = 120.00 s, outputting every 60.00 s
150.9s 354 
151.0s 355 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
151.2s 356 [WARNING] Automatic CFL correction applied (count: 1200):
151.2s 357 Calculated CFL: 0.800 > Limit: 0.500
151.2s 358 Original dt: 4.115005e-01 s
151.2s 359 Corrected dt: 2.571878e-01 s
151.2s 360 Correction factor: 1.6x
151.2s 361 Max wave speed detected: 19.44 m/s
151.5s 362 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
152.0s 363 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
152.1s 364 [WARNING] Automatic CFL correction applied (count: 1300):
152.1s 365 Calculated CFL: 0.800 > Limit: 0.500
152.1s 366 Original dt: 4.114981e-01 s
152.1s 367 Corrected dt: 2.571863e-01 s
152.1s 368 Correction factor: 1.6x
152.1s 369 Max wave speed detected: 19.44 m/s
152.4s 370 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
152.9s 371 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
153.0s 372 Stored output at t = 120.0000 s (Step 465)
153.0s 373 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
153.0s 374 [A
153.0s 375 
153.0s 376 Simulation finished at t = 120.0000 s after 465 steps.
153.0s 377 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.00s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.00s/s]
153.0s 378 Total runtime: 2.14 seconds.
153.0s 379 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
153.0s 380 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
153.0s 381 Using device: gpu
153.0s 382 DEBUG PARAMS: Reading K_m_kmh = 10.0
153.0s 383 DEBUG PARAMS: Reading K_c_kmh = 15.0
153.0s 384 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
153.0s 385 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
153.0s 386 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
153.0s 387 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
153.0s 388 Loading road quality type: uniform
153.0s 389 Uniform road quality value: 2
153.0s 390 Road quality loaded.
153.0s 391 Initial state created.
153.0s 392 Transferring initial state and road quality to GPU...
153.0s 393 GPU data transfer complete.
153.0s 394 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
153.0s 395 Initial boundary conditions applied.
153.0s 396 [BC UPDATE] left → phase 0 RED (reduced inflow)
153.0s 397 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
153.0s 398 [BC UPDATE] left → phase 1 GREEN (normal inflow)
153.0s 399 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
153.0s 400 Running simulation until t = 60.00 s, outputting every 60.00 s
153.0s 401 
153.1s 402 [WARNING] Automatic CFL correction applied (count: 1400):
153.1s 403 Calculated CFL: 0.800 > Limit: 0.500
153.1s 404 Original dt: 3.451280e-01 s
153.1s 405 Corrected dt: 2.157050e-01 s
153.1s 406 Correction factor: 1.6x
153.1s 407 Max wave speed detected: 23.18 m/s
153.5s 408 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
153.9s 409 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
154.0s 410 [WARNING] Automatic CFL correction applied (count: 1500):
154.0s 411 Calculated CFL: 0.800 > Limit: 0.500
154.0s 412 Original dt: 4.139892e-01 s
154.0s 413 Corrected dt: 2.587433e-01 s
154.0s 414 Correction factor: 1.6x
154.0s 415 Max wave speed detected: 19.32 m/s
154.4s 416 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
154.8s 417 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
154.8s 418 [WARNING] Automatic CFL correction applied (count: 1600):
154.8s 419 Calculated CFL: 0.800 > Limit: 0.500
154.8s 420 Original dt: 4.115314e-01 s
154.8s 421 Corrected dt: 2.572071e-01 s
154.8s 422 Correction factor: 1.6x
154.8s 423 Max wave speed detected: 19.44 m/s
155.1s 424 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
155.1s 425 Stored output at t = 60.0000 s (Step 231)
155.1s 426 [A
155.1s 427 
155.1s 428 Simulation finished at t = 60.0000 s after 231 steps.
155.1s 429 Total runtime: 2.04 seconds.
155.1s 430 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.49s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.48s/s]
155.1s 431 [BC UPDATE] left → phase 1 GREEN (normal inflow)
155.1s 432 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
155.1s 433 Running simulation until t = 120.00 s, outputting every 60.00 s
155.1s 434 
155.2s 435 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
155.7s 436 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
155.7s 437 [WARNING] Automatic CFL correction applied (count: 1700):
155.7s 438 Calculated CFL: 0.800 > Limit: 0.500
155.7s 439 Original dt: 4.114986e-01 s
155.7s 440 Corrected dt: 2.571866e-01 s
155.7s 441 Correction factor: 1.6x
155.7s 442 Max wave speed detected: 19.44 m/s
156.1s 443 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
156.6s 444 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
156.6s 445 [WARNING] Automatic CFL correction applied (count: 1800):
156.6s 446 Calculated CFL: 0.800 > Limit: 0.500
156.6s 447 Original dt: 4.114980e-01 s
156.6s 448 Corrected dt: 2.571863e-01 s
156.6s 449 Correction factor: 1.6x
156.6s 450 Max wave speed detected: 19.44 m/s
157.0s 451 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
157.1s 452 Stored output at t = 120.0000 s (Step 465)
157.1s 453 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
157.1s 454 [A
157.1s 455 
157.1s 456 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.11s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.11s/s]
157.1s 457 Simulation finished at t = 120.0000 s after 465 steps.
157.1s 458 Total runtime: 2.06 seconds.
157.1s 459 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
157.1s 460 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
157.1s 461 Using device: gpu
157.1s 462 DEBUG PARAMS: Reading K_m_kmh = 10.0
157.1s 463 DEBUG PARAMS: Reading K_c_kmh = 15.0
157.1s 464 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
157.1s 465 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
157.1s 466 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
157.1s 467 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
157.1s 468 Loading road quality type: uniform
157.1s 469 Uniform road quality value: 2
157.1s 470 Road quality loaded.
157.1s 471 Initial state created.
157.1s 472 Transferring initial state and road quality to GPU...
157.1s 473 GPU data transfer complete.
157.1s 474 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
157.2s 475 Initial boundary conditions applied.
157.2s 476 [BC UPDATE] left → phase 0 RED (reduced inflow)
157.2s 477 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
157.2s 478 [BC UPDATE] left → phase 1 GREEN (normal inflow)
157.2s 479 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
157.2s 480 Running simulation until t = 60.00 s, outputting every 60.00 s
157.2s 481 
157.5s 482 [WARNING] Automatic CFL correction applied (count: 1900):
157.5s 483 Calculated CFL: 0.800 > Limit: 0.500
157.5s 484 Original dt: 4.583403e-01 s
157.5s 485 Corrected dt: 2.864627e-01 s
157.5s 486 Correction factor: 1.6x
157.5s 487 Max wave speed detected: 17.45 m/s
157.6s 488 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
158.0s 489 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
158.4s 490 [WARNING] Automatic CFL correction applied (count: 2000):
158.4s 491 Calculated CFL: 0.800 > Limit: 0.500
158.4s 492 Original dt: 4.120137e-01 s
158.4s 493 Corrected dt: 2.575085e-01 s
158.4s 494 Correction factor: 1.6x
158.4s 495 Max wave speed detected: 19.42 m/s
158.5s 496 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
158.9s 497 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
159.2s 498 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
159.2s 499 [A
159.2s 500 Stored output at t = 60.0000 s (Step 231)
159.2s 501 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.50s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.50s/s]
159.2s 502 
159.2s 503 Simulation finished at t = 60.0000 s after 231 steps.
159.2s 504 Total runtime: 2.03 seconds.
159.2s 505 [BC UPDATE] left → phase 0 RED (reduced inflow)
159.2s 506 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
159.2s 507 Running simulation until t = 120.00 s, outputting every 60.00 s
159.2s 508 
159.3s 509 [WARNING] Automatic CFL correction applied (count: 2100):
159.3s 510 Calculated CFL: 0.800 > Limit: 0.500
159.3s 511 Original dt: 4.115064e-01 s
159.3s 512 Corrected dt: 2.571915e-01 s
159.3s 513 Correction factor: 1.6x
159.3s 514 Max wave speed detected: 19.44 m/s
159.4s 515 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
159.8s 516 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
160.2s 517 [WARNING] Automatic CFL correction applied (count: 2200):
160.2s 518 Calculated CFL: 0.800 > Limit: 0.500
160.2s 519 Original dt: 4.114982e-01 s
160.2s 520 Corrected dt: 2.571864e-01 s
160.2s 521 Correction factor: 1.6x
160.2s 522 Max wave speed detected: 19.44 m/s
160.3s 523 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
160.7s 524 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
161.0s 525 [WARNING] Automatic CFL correction applied (count: 2300):
161.0s 526 Calculated CFL: 0.800 > Limit: 0.500
161.0s 527 Original dt: 4.114980e-01 s
161.0s 528 Corrected dt: 2.571863e-01 s
161.0s 529 Correction factor: 1.6x
161.0s 530 Max wave speed detected: 19.44 m/s
161.1s 531 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
161.3s 532 Stored output at t = 120.0000 s (Step 465)
161.3s 533 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
161.3s 534 [A
161.3s 535 
161.3s 536 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.81s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.81s/s]
161.3s 537 Simulation finished at t = 120.0000 s after 465 steps.
161.3s 538 Total runtime: 2.08 seconds.
161.3s 539 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
161.3s 540 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
161.3s 541 Using device: gpu
161.3s 542 DEBUG PARAMS: Reading K_m_kmh = 10.0
161.3s 543 DEBUG PARAMS: Reading K_c_kmh = 15.0
161.3s 544 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
161.3s 545 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
161.3s 546 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
161.3s 547 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
161.3s 548 Loading road quality type: uniform
161.3s 549 Uniform road quality value: 2
161.3s 550 Road quality loaded.
161.3s 551 Initial state created.
161.3s 552 Transferring initial state and road quality to GPU...
161.3s 553 GPU data transfer complete.
161.3s 554 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
161.3s 555 Initial boundary conditions applied.
161.3s 556 [BC UPDATE] left → phase 0 RED (reduced inflow)
161.3s 557 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
161.3s 558 [BC UPDATE] left → phase 0 RED (reduced inflow)
161.3s 559 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
161.3s 560 Running simulation until t = 60.00 s, outputting every 60.00 s
161.3s 561 
161.7s 562 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
162.0s 563 [WARNING] Automatic CFL correction applied (count: 2400):
162.0s 564 Calculated CFL: 0.800 > Limit: 0.500
162.0s 565 Original dt: 4.205139e-01 s
162.0s 566 Corrected dt: 2.628212e-01 s
162.0s 567 Correction factor: 1.6x
162.0s 568 Max wave speed detected: 19.02 m/s
162.2s 569 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
162.6s 570 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
162.9s 571 [WARNING] Automatic CFL correction applied (count: 2500):
162.9s 572 Calculated CFL: 0.800 > Limit: 0.500
162.9s 573 Original dt: 4.116141e-01 s
162.9s 574 Corrected dt: 2.572588e-01 s
162.9s 575 Correction factor: 1.6x
162.9s 576 Max wave speed detected: 19.44 m/s
163.1s 577 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
163.4s 578 Stored output at t = 60.0000 s (Step 231)
163.4s 579 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
163.4s 580 [A
163.4s 581 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.04s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.03s/s]
163.4s 582 
163.4s 583 Simulation finished at t = 60.0000 s after 231 steps.
163.4s 584 Total runtime: 2.07 seconds.
163.4s 585 [BC UPDATE] left → phase 0 RED (reduced inflow)
163.4s 586 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
163.4s 587 Running simulation until t = 120.00 s, outputting every 60.00 s
163.4s 588 
163.5s 589 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
163.8s 590 [WARNING] Automatic CFL correction applied (count: 2600):
163.8s 591 Calculated CFL: 0.800 > Limit: 0.500
163.8s 592 Original dt: 4.115000e-01 s
163.8s 593 Corrected dt: 2.571875e-01 s
163.8s 594 Correction factor: 1.6x
163.8s 595 Max wave speed detected: 19.44 m/s
164.0s 596 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
164.4s 597 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
164.7s 598 [WARNING] Automatic CFL correction applied (count: 2700):
164.7s 599 Calculated CFL: 0.800 > Limit: 0.500
164.7s 600 Original dt: 4.114981e-01 s
164.7s 601 Corrected dt: 2.571863e-01 s
164.7s 602 Correction factor: 1.6x
164.7s 603 Max wave speed detected: 19.44 m/s
164.9s 604 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
165.3s 605 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
165.5s 606 Stored output at t = 120.0000 s (Step 465)
165.5s 607 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
165.5s 608 [A
165.5s 609 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.59s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.59s/s]
165.5s 610 
165.5s 611 Simulation finished at t = 120.0000 s after 465 steps.
165.5s 612 Total runtime: 2.10 seconds.
165.5s 613 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
165.5s 614 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
165.5s 615 Using device: gpu
165.5s 616 DEBUG PARAMS: Reading K_m_kmh = 10.0
165.5s 617 DEBUG PARAMS: Reading K_c_kmh = 15.0
165.5s 618 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
165.5s 619 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
165.5s 620 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
165.5s 621 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
165.5s 622 Loading road quality type: uniform
165.5s 623 Uniform road quality value: 2
165.5s 624 Road quality loaded.
165.5s 625 Initial state created.
165.5s 626 Transferring initial state and road quality to GPU...
165.5s 627 GPU data transfer complete.
165.5s 628 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
165.5s 629 Initial boundary conditions applied.
165.5s 630 [BC UPDATE] left → phase 0 RED (reduced inflow)
165.5s 631 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
165.5s 632 [BC UPDATE] left → phase 1 GREEN (normal inflow)
165.5s 633 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
165.5s 634 Running simulation until t = 60.00 s, outputting every 60.00 s
165.5s 635 
165.6s 636 [WARNING] Automatic CFL correction applied (count: 2800):
165.6s 637 Calculated CFL: 0.800 > Limit: 0.500
165.6s 638 Original dt: 3.737254e-01 s
165.6s 639 Corrected dt: 2.335784e-01 s
165.6s 640 Correction factor: 1.6x
165.6s 641 Max wave speed detected: 21.41 m/s
165.9s 642 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
166.4s 643 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
166.5s 644 [WARNING] Automatic CFL correction applied (count: 2900):
166.5s 645 Calculated CFL: 0.800 > Limit: 0.500
166.5s 646 Original dt: 4.134305e-01 s
166.5s 647 Corrected dt: 2.583941e-01 s
166.5s 648 Correction factor: 1.6x
166.5s 649 Max wave speed detected: 19.35 m/s
166.8s 650 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
167.3s 651 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
167.4s 652 [WARNING] Automatic CFL correction applied (count: 3000):
167.4s 653 Calculated CFL: 0.800 > Limit: 0.500
167.4s 654 Original dt: 4.115259e-01 s
167.4s 655 Corrected dt: 2.572037e-01 s
167.4s 656 Correction factor: 1.6x
167.4s 657 Max wave speed detected: 19.44 m/s
167.6s 658 Stored output at t = 60.0000 s (Step 231)
167.6s 659 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
167.6s 660 [A
167.6s 661 
167.6s 662 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.53s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.53s/s]
167.6s 663 Simulation finished at t = 60.0000 s after 231 steps.
167.6s 664 Total runtime: 2.10 seconds.
167.6s 665 [BC UPDATE] left → phase 0 RED (reduced inflow)
167.6s 666 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
167.6s 667 Running simulation until t = 120.00 s, outputting every 60.00 s
167.6s 668 
167.7s 669 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
168.2s 670 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
168.3s 671 [WARNING] Automatic CFL correction applied (count: 3100):
168.3s 672 Calculated CFL: 0.800 > Limit: 0.500
168.3s 673 Original dt: 4.114985e-01 s
168.3s 674 Corrected dt: 2.571866e-01 s
168.3s 675 Correction factor: 1.6x
168.3s 676 Max wave speed detected: 19.44 m/s
168.7s 677 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
169.2s 678 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
169.3s 679 [WARNING] Automatic CFL correction applied (count: 3200):
169.3s 680 Calculated CFL: 0.800 > Limit: 0.500
169.3s 681 Original dt: 4.114980e-01 s
169.3s 682 Corrected dt: 2.571863e-01 s
169.3s 683 Correction factor: 1.6x
169.3s 684 Max wave speed detected: 19.44 m/s
169.7s 685 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
169.8s 686 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
169.8s 687 [A
169.8s 688 Stored output at t = 120.0000 s (Step 465)
169.8s 689 
169.8s 690 Simulation finished at t = 120.0000 s after 465 steps.
169.8s 691 Total runtime: 2.22 seconds.
169.8s 692 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.03s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.03s/s]
169.8s 693 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
169.8s 694 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
169.8s 695 Using device: gpu
169.8s 696 DEBUG PARAMS: Reading K_m_kmh = 10.0
169.8s 697 DEBUG PARAMS: Reading K_c_kmh = 15.0
169.8s 698 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
169.8s 699 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
169.8s 700 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
169.8s 701 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
169.8s 702 Loading road quality type: uniform
169.8s 703 Uniform road quality value: 2
169.8s 704 Road quality loaded.
169.8s 705 Initial state created.
169.8s 706 Transferring initial state and road quality to GPU...
169.8s 707 GPU data transfer complete.
169.8s 708 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
169.8s 709 Initial boundary conditions applied.
169.8s 710 [BC UPDATE] left → phase 0 RED (reduced inflow)
169.8s 711 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
169.8s 712 [BC UPDATE] left → phase 1 GREEN (normal inflow)
169.8s 713 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
169.8s 714 Running simulation until t = 60.00 s, outputting every 60.00 s
169.8s 715 
170.2s 716 [WARNING] Automatic CFL correction applied (count: 3300):
170.2s 717 Calculated CFL: 0.800 > Limit: 0.500
170.2s 718 Original dt: 4.470525e-01 s
170.2s 719 Corrected dt: 2.794078e-01 s
170.2s 720 Correction factor: 1.6x
170.2s 721 Max wave speed detected: 17.89 m/s
170.3s 722 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
170.7s 723 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
171.1s 724 [WARNING] Automatic CFL correction applied (count: 3400):
171.1s 725 Calculated CFL: 0.800 > Limit: 0.500
171.1s 726 Original dt: 4.119130e-01 s
171.1s 727 Corrected dt: 2.574456e-01 s
171.1s 728 Correction factor: 1.6x
171.1s 729 Max wave speed detected: 19.42 m/s
171.2s 730 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
171.6s 731 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
171.9s 732 Stored output at t = 60.0000 s (Step 231)
171.9s 733 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
171.9s 734 [A
171.9s 735 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s]
171.9s 736 
171.9s 737 Simulation finished at t = 60.0000 s after 231 steps.
171.9s 738 Total runtime: 2.13 seconds.
171.9s 739 [BC UPDATE] left → phase 1 GREEN (normal inflow)
171.9s 740 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
171.9s 741 Running simulation until t = 120.00 s, outputting every 60.00 s
171.9s 742 
172.1s 743 [WARNING] Automatic CFL correction applied (count: 3500):
172.1s 744 Calculated CFL: 0.800 > Limit: 0.500
172.1s 745 Original dt: 4.115046e-01 s
172.1s 746 Corrected dt: 2.571904e-01 s
172.1s 747 Correction factor: 1.6x
172.1s 748 Max wave speed detected: 19.44 m/s
172.1s 749 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
172.6s 750 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
173.0s 751 [WARNING] Automatic CFL correction applied (count: 3600):
173.0s 752 Calculated CFL: 0.800 > Limit: 0.500
173.0s 753 Original dt: 4.114982e-01 s
173.0s 754 Corrected dt: 2.571863e-01 s
173.0s 755 Correction factor: 1.6x
173.0s 756 Max wave speed detected: 19.44 m/s
173.0s 757 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
173.5s 758 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
173.9s 759 [WARNING] Automatic CFL correction applied (count: 3700):
173.9s 760 Calculated CFL: 0.800 > Limit: 0.500
173.9s 761 Original dt: 4.114980e-01 s
173.9s 762 Corrected dt: 2.571863e-01 s
173.9s 763 Correction factor: 1.6x
173.9s 764 Max wave speed detected: 19.44 m/s
174.0s 765 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
174.1s 766 Stored output at t = 120.0000 s (Step 465)
174.1s 767 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
174.1s 768 [A
174.1s 769 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s]
174.1s 770 
174.1s 771 Simulation finished at t = 120.0000 s after 465 steps.
174.1s 772 Total runtime: 2.15 seconds.
174.1s 773 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
174.1s 774 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
174.1s 775 Using device: gpu
174.1s 776 DEBUG PARAMS: Reading K_m_kmh = 10.0
174.1s 777 DEBUG PARAMS: Reading K_c_kmh = 15.0
174.1s 778 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
174.1s 779 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
174.1s 780 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
174.1s 781 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
174.1s 782 Loading road quality type: uniform
174.1s 783 Uniform road quality value: 2
174.1s 784 Road quality loaded.
174.1s 785 Initial state created.
174.1s 786 Transferring initial state and road quality to GPU...
174.1s 787 GPU data transfer complete.
174.1s 788 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
174.1s 789 Initial boundary conditions applied.
174.1s 790 [BC UPDATE] left → phase 0 RED (reduced inflow)
174.1s 791 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
174.1s 792 [BC UPDATE] left → phase 1 GREEN (normal inflow)
174.1s 793 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
174.1s 794 Running simulation until t = 60.00 s, outputting every 60.00 s
174.1s 795 
174.6s 796 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
174.9s 797 [WARNING] Automatic CFL correction applied (count: 3800):
174.9s 798 Calculated CFL: 0.800 > Limit: 0.500
174.9s 799 Original dt: 4.190346e-01 s
174.9s 800 Corrected dt: 2.618967e-01 s
174.9s 801 Correction factor: 1.6x
174.9s 802 Max wave speed detected: 19.09 m/s
175.0s 803 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
175.5s 804 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
175.8s 805 [WARNING] Automatic CFL correction applied (count: 3900):
175.8s 806 Calculated CFL: 0.800 > Limit: 0.500
175.8s 807 Original dt: 4.115954e-01 s
175.8s 808 Corrected dt: 2.572472e-01 s
175.8s 809 Correction factor: 1.6x
175.8s 810 Max wave speed detected: 19.44 m/s
176.0s 811 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
176.3s 812 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
176.3s 813 [A
176.3s 814 Stored output at t = 60.0000 s (Step 231)
176.3s 815 
176.3s 816 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.83s/s]
176.3s 817 Simulation finished at t = 60.0000 s after 231 steps.
176.3s 818 Total runtime: 2.16 seconds.
176.3s 819 [BC UPDATE] left → phase 0 RED (reduced inflow)
176.3s 820 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
176.3s 821 Running simulation until t = 120.00 s, outputting every 60.00 s
176.3s 822 
176.4s 823 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
176.7s 824 [WARNING] Automatic CFL correction applied (count: 4000):
176.7s 825 Calculated CFL: 0.800 > Limit: 0.500
176.7s 826 Original dt: 4.114996e-01 s
176.7s 827 Corrected dt: 2.571873e-01 s
176.7s 828 Correction factor: 1.6x
176.7s 829 Max wave speed detected: 19.44 m/s
176.9s 830 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
177.4s 831 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
177.6s 832 [WARNING] Automatic CFL correction applied (count: 4100):
177.6s 833 Calculated CFL: 0.800 > Limit: 0.500
177.6s 834 Original dt: 4.114981e-01 s
177.6s 835 Corrected dt: 2.571863e-01 s
177.6s 836 Correction factor: 1.6x
177.6s 837 Max wave speed detected: 19.44 m/s
177.8s 838 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
178.3s 839 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
178.4s 840 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
178.4s 841 [A
178.4s 842 Stored output at t = 120.0000 s (Step 465)
178.4s 843 
178.4s 844 Simulation finished at t = 120.0000 s after 465 steps.
178.4s 845 Total runtime: 2.14 seconds.
178.4s 846 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.07s/s]
178.4s 847 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
178.4s 848 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
178.4s 849 Using device: gpu
178.4s 850 DEBUG PARAMS: Reading K_m_kmh = 10.0
178.4s 851 DEBUG PARAMS: Reading K_c_kmh = 15.0
178.4s 852 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
178.4s 853 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
178.4s 854 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
178.4s 855 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
178.4s 856 Loading road quality type: uniform
178.4s 857 Uniform road quality value: 2
178.4s 858 Road quality loaded.
178.4s 859 Initial state created.
178.4s 860 Transferring initial state and road quality to GPU...
178.4s 861 GPU data transfer complete.
178.4s 862 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
178.4s 863 Initial boundary conditions applied.
178.4s 864 [BC UPDATE] left → phase 0 RED (reduced inflow)
178.4s 865 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
178.4s 866 [BC UPDATE] left → phase 1 GREEN (normal inflow)
178.4s 867 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
178.4s 868 Running simulation until t = 60.00 s, outputting every 60.00 s
178.4s 869 
178.6s 870 [WARNING] Automatic CFL correction applied (count: 4200):
178.6s 871 Calculated CFL: 0.800 > Limit: 0.500
178.6s 872 Original dt: 4.022422e-01 s
178.6s 873 Corrected dt: 2.514014e-01 s
178.6s 874 Correction factor: 1.6x
178.6s 875 Max wave speed detected: 19.89 m/s
178.9s 876 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
179.4s 877 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
179.6s 878 [WARNING] Automatic CFL correction applied (count: 4300):
179.6s 879 Calculated CFL: 0.800 > Limit: 0.500
179.6s 880 Original dt: 4.130229e-01 s
179.6s 881 Corrected dt: 2.581393e-01 s
179.6s 882 Correction factor: 1.6x
179.6s 883 Max wave speed detected: 19.37 m/s
179.9s 884 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
180.3s 885 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
180.5s 886 [WARNING] Automatic CFL correction applied (count: 4400):
180.5s 887 Calculated CFL: 0.800 > Limit: 0.500
180.5s 888 Original dt: 4.115198e-01 s
180.5s 889 Corrected dt: 2.571999e-01 s
180.5s 890 Correction factor: 1.6x
180.5s 891 Max wave speed detected: 19.44 m/s
180.6s 892 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
180.6s 893 [A
180.6s 894 Stored output at t = 60.0000 s (Step 231)
180.6s 895 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.07s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.07s/s]
180.6s 896 
180.6s 897 Simulation finished at t = 60.0000 s after 231 steps.
180.6s 898 Total runtime: 2.22 seconds.
180.7s 899 [BC UPDATE] left → phase 1 GREEN (normal inflow)
180.7s 900 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
180.7s 901 Running simulation until t = 120.00 s, outputting every 60.00 s
180.7s 902 
180.8s 903 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
181.3s 904 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
181.4s 905 [WARNING] Automatic CFL correction applied (count: 4500):
181.4s 906 Calculated CFL: 0.800 > Limit: 0.500
181.4s 907 Original dt: 4.114984e-01 s
181.4s 908 Corrected dt: 2.571865e-01 s
181.4s 909 Correction factor: 1.6x
181.4s 910 Max wave speed detected: 19.44 m/s
181.8s 911 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
182.2s 912 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
182.4s 913 [WARNING] Automatic CFL correction applied (count: 4600):
182.4s 914 Calculated CFL: 0.800 > Limit: 0.500
182.4s 915 Original dt: 4.114980e-01 s
182.4s 916 Corrected dt: 2.571863e-01 s
182.4s 917 Correction factor: 1.6x
182.4s 918 Max wave speed detected: 19.44 m/s
182.7s 919 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
182.8s 920 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
182.8s 921 [A
182.8s 922 Stored output at t = 120.0000 s (Step 465)
182.8s 923 
182.8s 924 Simulation finished at t = 120.0000 s after 465 steps.
182.8s 925 Total runtime: 2.17 seconds.
182.8s 926 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.63s/s]
182.8s 927 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
182.8s 928 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
182.8s 929 Using device: gpu
182.8s 930 DEBUG PARAMS: Reading K_m_kmh = 10.0
182.8s 931 DEBUG PARAMS: Reading K_c_kmh = 15.0
182.8s 932 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
182.8s 933 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
182.8s 934 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
182.8s 935 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
182.8s 936 Loading road quality type: uniform
182.8s 937 Uniform road quality value: 2
182.8s 938 Road quality loaded.
182.8s 939 Initial state created.
182.8s 940 Transferring initial state and road quality to GPU...
182.8s 941 GPU data transfer complete.
182.8s 942 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
182.8s 943 Initial boundary conditions applied.
182.8s 944 [BC UPDATE] left → phase 0 RED (reduced inflow)
182.8s 945 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
182.8s 946 [BC UPDATE] left → phase 0 RED (reduced inflow)
182.8s 947 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
182.8s 948 Running simulation until t = 60.00 s, outputting every 60.00 s
182.8s 949 
183.3s 950 [WARNING] Automatic CFL correction applied (count: 4700):
183.3s 951 Calculated CFL: 0.800 > Limit: 0.500
183.3s 952 Original dt: 4.396418e-01 s
183.3s 953 Corrected dt: 2.747761e-01 s
183.3s 954 Correction factor: 1.6x
183.3s 955 Max wave speed detected: 18.20 m/s
183.3s 956 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
183.7s 957 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
184.2s 958 [WARNING] Automatic CFL correction applied (count: 4800):
184.2s 959 Calculated CFL: 0.800 > Limit: 0.500
184.2s 960 Original dt: 4.118393e-01 s
184.2s 961 Corrected dt: 2.573996e-01 s
184.2s 962 Correction factor: 1.6x
184.2s 963 Max wave speed detected: 19.43 m/s
184.2s 964 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
184.6s 965 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
184.9s 966 Stored output at t = 60.0000 s (Step 231)
184.9s 967 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
184.9s 968 [A
184.9s 969 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.46s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.45s/s]
184.9s 970 
184.9s 971 Simulation finished at t = 60.0000 s after 231 steps.
184.9s 972 Total runtime: 2.04 seconds.
184.9s 973 [BC UPDATE] left → phase 1 GREEN (normal inflow)
184.9s 974 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
184.9s 975 Running simulation until t = 120.00 s, outputting every 60.00 s
184.9s 976 
185.0s 977 [WARNING] Automatic CFL correction applied (count: 4900):
185.0s 978 Calculated CFL: 0.800 > Limit: 0.500
185.0s 979 Original dt: 4.115033e-01 s
185.0s 980 Corrected dt: 2.571896e-01 s
185.0s 981 Correction factor: 1.6x
185.0s 982 Max wave speed detected: 19.44 m/s
185.0s 983 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
185.5s 984 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
185.9s 985 [WARNING] Automatic CFL correction applied (count: 5000):
185.9s 986 Calculated CFL: 0.800 > Limit: 0.500
185.9s 987 Original dt: 4.114981e-01 s
185.9s 988 Corrected dt: 2.571863e-01 s
185.9s 989 Correction factor: 1.6x
185.9s 990 Max wave speed detected: 19.44 m/s
185.9s 991 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
186.4s 992 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
186.8s 993 [WARNING] Automatic CFL correction applied (count: 5100):
186.8s 994 Calculated CFL: 0.800 > Limit: 0.500
186.8s 995 Original dt: 4.114980e-01 s
186.8s 996 Corrected dt: 2.571863e-01 s
186.8s 997 Correction factor: 1.6x
186.8s 998 Max wave speed detected: 19.44 m/s
186.8s 999 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
186.9s 1000 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
186.9s 1001 [A
186.9s 1002 Stored output at t = 120.0000 s (Step 465)
186.9s 1003 
186.9s 1004 Simulation finished at t = 120.0000 s after 465 steps.
186.9s 1005 Total runtime: 2.05 seconds.
186.9s 1006 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.31s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.31s/s]
186.9s 1007 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
186.9s 1008 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
186.9s 1009 Using device: gpu
186.9s 1010 DEBUG PARAMS: Reading K_m_kmh = 10.0
186.9s 1011 DEBUG PARAMS: Reading K_c_kmh = 15.0
186.9s 1012 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
186.9s 1013 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
186.9s 1014 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
186.9s 1015 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
186.9s 1016 Loading road quality type: uniform
186.9s 1017 Uniform road quality value: 2
186.9s 1018 Road quality loaded.
186.9s 1019 Initial state created.
186.9s 1020 Transferring initial state and road quality to GPU...
186.9s 1021 GPU data transfer complete.
186.9s 1022 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
186.9s 1023 Initial boundary conditions applied.
186.9s 1024 [BC UPDATE] left → phase 0 RED (reduced inflow)
186.9s 1025 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
186.9s 1026 [BC UPDATE] left → phase 0 RED (reduced inflow)
186.9s 1027 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
186.9s 1028 Running simulation until t = 60.00 s, outputting every 60.00 s
186.9s 1029 
187.4s 1030 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
187.7s 1031 [WARNING] Automatic CFL correction applied (count: 5200):
187.7s 1032 Calculated CFL: 0.800 > Limit: 0.500
187.7s 1033 Original dt: 4.173029e-01 s
187.7s 1034 Corrected dt: 2.608143e-01 s
187.7s 1035 Correction factor: 1.6x
187.7s 1036 Max wave speed detected: 19.17 m/s
187.8s 1037 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
188.3s 1038 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
188.6s 1039 [WARNING] Automatic CFL correction applied (count: 5300):
188.6s 1040 Calculated CFL: 0.800 > Limit: 0.500
188.6s 1041 Original dt: 4.115760e-01 s
188.6s 1042 Corrected dt: 2.572350e-01 s
188.6s 1043 Correction factor: 1.6x
188.6s 1044 Max wave speed detected: 19.44 m/s
188.7s 1045 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
189.0s 1046 Stored output at t = 60.0000 s (Step 231)
189.0s 1047 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
189.0s 1048 [A
189.0s 1049 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.46s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.46s/s]
189.0s 1050 
189.0s 1051 Simulation finished at t = 60.0000 s after 231 steps.
189.0s 1052 Total runtime: 2.04 seconds.
189.0s 1053 [BC UPDATE] left → phase 0 RED (reduced inflow)
189.0s 1054 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
189.0s 1055 Running simulation until t = 120.00 s, outputting every 60.00 s
189.0s 1056 
189.1s 1057 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
189.5s 1058 [WARNING] Automatic CFL correction applied (count: 5400):
189.5s 1059 Calculated CFL: 0.800 > Limit: 0.500
189.5s 1060 Original dt: 4.114993e-01 s
189.5s 1061 Corrected dt: 2.571871e-01 s
189.5s 1062 Correction factor: 1.6x
189.5s 1063 Max wave speed detected: 19.44 m/s
189.6s 1064 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
190.0s 1065 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
190.3s 1066 [WARNING] Automatic CFL correction applied (count: 5500):
190.3s 1067 Calculated CFL: 0.800 > Limit: 0.500
190.3s 1068 Original dt: 4.114981e-01 s
190.3s 1069 Corrected dt: 2.571863e-01 s
190.3s 1070 Correction factor: 1.6x
190.3s 1071 Max wave speed detected: 19.44 m/s
190.5s 1072 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
190.9s 1073 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
191.1s 1074 Stored output at t = 120.0000 s (Step 465)
191.1s 1075 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
191.1s 1076 [A
191.1s 1077 
191.1s 1078 Simulation finished at t = 120.0000 s after 465 steps.
191.1s 1079 Total runtime: 2.08 seconds.
191.1s 1080 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.80s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.80s/s]
191.1s 1081 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
191.1s 1082 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
191.1s 1083 Using device: gpu
191.1s 1084 DEBUG PARAMS: Reading K_m_kmh = 10.0
191.1s 1085 DEBUG PARAMS: Reading K_c_kmh = 15.0
191.1s 1086 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
191.1s 1087 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
191.1s 1088 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
191.1s 1089 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
191.1s 1090 Loading road quality type: uniform
191.1s 1091 Uniform road quality value: 2
191.1s 1092 Road quality loaded.
191.1s 1093 Initial state created.
191.1s 1094 Transferring initial state and road quality to GPU...
191.1s 1095 GPU data transfer complete.
191.1s 1096 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
191.1s 1097 Initial boundary conditions applied.
191.1s 1098 [BC UPDATE] left → phase 0 RED (reduced inflow)
191.1s 1099 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
191.1s 1100 [BC UPDATE] left → phase 0 RED (reduced inflow)
191.1s 1101 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
191.1s 1102 Running simulation until t = 60.00 s, outputting every 60.00 s
191.1s 1103 
191.3s 1104 [WARNING] Automatic CFL correction applied (count: 5600):
191.3s 1105 Calculated CFL: 0.800 > Limit: 0.500
191.3s 1106 Original dt: 4.295974e-01 s
191.3s 1107 Corrected dt: 2.684983e-01 s
191.3s 1108 Correction factor: 1.6x
191.3s 1109 Max wave speed detected: 18.62 m/s
191.5s 1110 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
192.0s 1111 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
192.1s 1112 [WARNING] Automatic CFL correction applied (count: 5700):
192.1s 1113 Calculated CFL: 0.800 > Limit: 0.500
192.1s 1114 Original dt: 4.127253e-01 s
192.1s 1115 Corrected dt: 2.579533e-01 s
192.1s 1116 Correction factor: 1.6x
192.1s 1117 Max wave speed detected: 19.38 m/s
192.4s 1118 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
192.9s 1119 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
193.0s 1120 [WARNING] Automatic CFL correction applied (count: 5800):
193.0s 1121 Calculated CFL: 0.800 > Limit: 0.500
193.0s 1122 Original dt: 4.115153e-01 s
193.0s 1123 Corrected dt: 2.571971e-01 s
193.0s 1124 Correction factor: 1.6x
193.0s 1125 Max wave speed detected: 19.44 m/s
193.1s 1126 Stored output at t = 60.0000 s (Step 231)
193.1s 1127 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
193.1s 1128 [A
193.1s 1129 
193.1s 1130 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.23s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.22s/s]
193.1s 1131 Simulation finished at t = 60.0000 s after 231 steps.
193.1s 1132 Total runtime: 2.05 seconds.
193.1s 1133 [BC UPDATE] left → phase 0 RED (reduced inflow)
193.1s 1134 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
193.1s 1135 Running simulation until t = 120.00 s, outputting every 60.00 s
193.1s 1136 
193.3s 1137 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
193.7s 1138 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
193.9s 1139 [WARNING] Automatic CFL correction applied (count: 5900):
193.9s 1140 Calculated CFL: 0.800 > Limit: 0.500
193.9s 1141 Original dt: 4.114984e-01 s
193.9s 1142 Corrected dt: 2.571865e-01 s
193.9s 1143 Correction factor: 1.6x
193.9s 1144 Max wave speed detected: 19.44 m/s
194.2s 1145 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
194.6s 1146 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
194.8s 1147 [WARNING] Automatic CFL correction applied (count: 6000):
194.8s 1148 Calculated CFL: 0.800 > Limit: 0.500
194.8s 1149 Original dt: 4.114980e-01 s
194.8s 1150 Corrected dt: 2.571863e-01 s
194.8s 1151 Correction factor: 1.6x
194.8s 1152 Max wave speed detected: 19.44 m/s
195.1s 1153 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
195.2s 1154 Stored output at t = 120.0000 s (Step 465)
195.2s 1155 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
195.2s 1156 [A
195.2s 1157 
195.2s 1158 Simulation finished at t = 120.0000 s after 465 steps.
195.2s 1159 Total runtime: 2.06 seconds.
195.2s 1160 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.17s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.17s/s]
195.2s 1161 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
195.2s 1162 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
195.2s 1163 Using device: gpu
195.2s 1164 DEBUG PARAMS: Reading K_m_kmh = 10.0
195.2s 1165 DEBUG PARAMS: Reading K_c_kmh = 15.0
195.2s 1166 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
195.2s 1167 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
195.2s 1168 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
195.2s 1169 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
195.2s 1170 Loading road quality type: uniform
195.2s 1171 Uniform road quality value: 2
195.2s 1172 Road quality loaded.
195.2s 1173 Initial state created.
195.2s 1174 Transferring initial state and road quality to GPU...
195.2s 1175 GPU data transfer complete.
195.2s 1176 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
195.2s 1177 Initial boundary conditions applied.
195.2s 1178 [BC UPDATE] left → phase 0 RED (reduced inflow)
195.2s 1179 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
195.2s 1180 [BC UPDATE] left → phase 1 GREEN (normal inflow)
195.2s 1181 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
195.2s 1182 Running simulation until t = 60.00 s, outputting every 60.00 s
195.2s 1183 
195.6s 1184 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
195.7s 1185 [WARNING] Automatic CFL correction applied (count: 6100):
195.7s 1186 Calculated CFL: 0.800 > Limit: 0.500
195.7s 1187 Original dt: 4.346596e-01 s
195.7s 1188 Corrected dt: 2.716622e-01 s
195.7s 1189 Correction factor: 1.6x
195.7s 1190 Max wave speed detected: 18.41 m/s
196.1s 1191 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
196.5s 1192 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
196.6s 1193 [WARNING] Automatic CFL correction applied (count: 6200):
196.6s 1194 Calculated CFL: 0.800 > Limit: 0.500
196.6s 1195 Original dt: 4.117853e-01 s
196.6s 1196 Corrected dt: 2.573658e-01 s
196.6s 1197 Correction factor: 1.6x
196.6s 1198 Max wave speed detected: 19.43 m/s
197.0s 1199 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
197.2s 1200 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
197.2s 1201 [A
197.2s 1202 Stored output at t = 60.0000 s (Step 231)
197.2s 1203 
197.2s 1204 Simulation finished at t = 60.0000 s after 231 steps.
197.2s 1205 Total runtime: 2.03 seconds.
197.2s 1206 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.56s/s]
197.2s 1207 [BC UPDATE] left → phase 0 RED (reduced inflow)
197.2s 1208 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
197.2s 1209 Running simulation until t = 120.00 s, outputting every 60.00 s
197.2s 1210 
197.4s 1211 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
197.4s 1212 [WARNING] Automatic CFL correction applied (count: 6300):
197.4s 1213 Calculated CFL: 0.800 > Limit: 0.500
197.4s 1214 Original dt: 4.115023e-01 s
197.4s 1215 Corrected dt: 2.571890e-01 s
197.4s 1216 Correction factor: 1.6x
197.4s 1217 Max wave speed detected: 19.44 m/s
197.9s 1218 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
198.3s 1219 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
198.3s 1220 [WARNING] Automatic CFL correction applied (count: 6400):
198.3s 1221 Calculated CFL: 0.800 > Limit: 0.500
198.3s 1222 Original dt: 4.114981e-01 s
198.3s 1223 Corrected dt: 2.571863e-01 s
198.3s 1224 Correction factor: 1.6x
198.3s 1225 Max wave speed detected: 19.44 m/s
198.7s 1226 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
199.2s 1227 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
199.2s 1228 [WARNING] Automatic CFL correction applied (count: 6500):
199.2s 1229 Calculated CFL: 0.800 > Limit: 0.500
199.2s 1230 Original dt: 4.114980e-01 s
199.2s 1231 Corrected dt: 2.571863e-01 s
199.2s 1232 Correction factor: 1.6x
199.2s 1233 Max wave speed detected: 19.44 m/s
199.3s 1234 Stored output at t = 120.0000 s (Step 465)
199.3s 1235 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
199.3s 1236 [A
199.3s 1237 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.10s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.09s/s]
199.3s 1238 
199.3s 1239 Simulation finished at t = 120.0000 s after 465 steps.
199.3s 1240 Total runtime: 2.06 seconds.
199.3s 1241 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
199.3s 1242 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
199.3s 1243 Using device: gpu
199.3s 1244 DEBUG PARAMS: Reading K_m_kmh = 10.0
199.3s 1245 DEBUG PARAMS: Reading K_c_kmh = 15.0
199.3s 1246 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
199.3s 1247 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
199.3s 1248 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
199.3s 1249 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
199.3s 1250 Loading road quality type: uniform
199.3s 1251 Uniform road quality value: 2
199.3s 1252 Road quality loaded.
199.3s 1253 Initial state created.
199.3s 1254 Transferring initial state and road quality to GPU...
199.3s 1255 GPU data transfer complete.
199.3s 1256 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
199.3s 1257 Initial boundary conditions applied.
199.3s 1258 [BC UPDATE] left → phase 0 RED (reduced inflow)
199.3s 1259 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
199.3s 1260 [BC UPDATE] left → phase 0 RED (reduced inflow)
199.3s 1261 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
199.3s 1262 Running simulation until t = 60.00 s, outputting every 60.00 s
199.3s 1263 
199.8s 1264 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
200.1s 1265 [WARNING] Automatic CFL correction applied (count: 6600):
200.1s 1266 Calculated CFL: 0.800 > Limit: 0.500
200.1s 1267 Original dt: 4.160552e-01 s
200.1s 1268 Corrected dt: 2.600345e-01 s
200.1s 1269 Correction factor: 1.6x
200.1s 1270 Max wave speed detected: 19.23 m/s
200.2s 1271 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
200.7s 1272 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
201.0s 1273 [WARNING] Automatic CFL correction applied (count: 6700):
201.0s 1274 Calculated CFL: 0.800 > Limit: 0.500
201.0s 1275 Original dt: 4.115592e-01 s
201.0s 1276 Corrected dt: 2.572245e-01 s
201.0s 1277 Correction factor: 1.6x
201.0s 1278 Max wave speed detected: 19.44 m/s
201.1s 1279 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
201.4s 1280 Stored output at t = 60.0000 s (Step 231)
201.4s 1281 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
201.4s 1282 [A
201.4s 1283 
201.4s 1284 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.32s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.32s/s]
201.4s 1285 Simulation finished at t = 60.0000 s after 231 steps.
201.4s 1286 Total runtime: 2.05 seconds.
201.4s 1287 [BC UPDATE] left → phase 1 GREEN (normal inflow)
201.4s 1288 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
201.4s 1289 Running simulation until t = 120.00 s, outputting every 60.00 s
201.4s 1290 
201.5s 1291 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
201.9s 1292 [WARNING] Automatic CFL correction applied (count: 6800):
201.9s 1293 Calculated CFL: 0.800 > Limit: 0.500
201.9s 1294 Original dt: 4.114991e-01 s
201.9s 1295 Corrected dt: 2.571870e-01 s
201.9s 1296 Correction factor: 1.6x
201.9s 1297 Max wave speed detected: 19.44 m/s
202.0s 1298 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
202.4s 1299 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
202.8s 1300 [WARNING] Automatic CFL correction applied (count: 6900):
202.8s 1301 Calculated CFL: 0.800 > Limit: 0.500
202.8s 1302 Original dt: 4.114980e-01 s
202.8s 1303 Corrected dt: 2.571863e-01 s
202.8s 1304 Correction factor: 1.6x
202.8s 1305 Max wave speed detected: 19.44 m/s
202.9s 1306 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
203.3s 1307 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
203.5s 1308 Stored output at t = 120.0000 s (Step 465)
203.5s 1309 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
203.5s 1310 [A
203.5s 1311 
203.5s 1312 Simulation finished at t = 120.0000 s after 465 steps.
203.5s 1313 Total runtime: 2.09 seconds.
203.5s 1314 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.70s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.70s/s]
203.5s 1315 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
203.5s 1316 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
203.5s 1317 Using device: gpu
203.5s 1318 DEBUG PARAMS: Reading K_m_kmh = 10.0
203.5s 1319 DEBUG PARAMS: Reading K_c_kmh = 15.0
203.5s 1320 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
203.5s 1321 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
203.5s 1322 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
203.5s 1323 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
203.5s 1324 Loading road quality type: uniform
203.5s 1325 Uniform road quality value: 2
203.5s 1326 Road quality loaded.
203.5s 1327 Initial state created.
203.5s 1328 Transferring initial state and road quality to GPU...
203.5s 1329 GPU data transfer complete.
203.5s 1330 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
203.5s 1331 Initial boundary conditions applied.
203.5s 1332 [BC UPDATE] left → phase 0 RED (reduced inflow)
203.5s 1333 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
203.5s 1334 [BC UPDATE] left → phase 0 RED (reduced inflow)
203.5s 1335 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
203.5s 1336 Running simulation until t = 60.00 s, outputting every 60.00 s
203.5s 1337 
203.7s 1338 [WARNING] Automatic CFL correction applied (count: 7000):
203.7s 1339 Calculated CFL: 0.800 > Limit: 0.500
203.7s 1340 Original dt: 4.547467e-01 s
203.7s 1341 Corrected dt: 2.842167e-01 s
203.7s 1342 Correction factor: 1.6x
203.7s 1343 Max wave speed detected: 17.59 m/s
203.9s 1344 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
204.3s 1345 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
204.6s 1346 [WARNING] Automatic CFL correction applied (count: 7100):
204.6s 1347 Calculated CFL: 0.800 > Limit: 0.500
204.6s 1348 Original dt: 4.125079e-01 s
204.6s 1349 Corrected dt: 2.578175e-01 s
204.6s 1350 Correction factor: 1.6x
204.6s 1351 Max wave speed detected: 19.39 m/s
204.8s 1352 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
205.2s 1353 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
205.4s 1354 [WARNING] Automatic CFL correction applied (count: 7200):
205.4s 1355 Calculated CFL: 0.800 > Limit: 0.500
205.4s 1356 Original dt: 4.115121e-01 s
205.4s 1357 Corrected dt: 2.571950e-01 s
205.4s 1358 Correction factor: 1.6x
205.4s 1359 Max wave speed detected: 19.44 m/s
205.5s 1360 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
205.5s 1361 [A
205.5s 1362 Stored output at t = 60.0000 s (Step 231)
205.5s 1363 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.71s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s]
205.5s 1364 
205.5s 1365 Simulation finished at t = 60.0000 s after 231 steps.
205.5s 1366 Total runtime: 2.02 seconds.
205.5s 1367 [BC UPDATE] left → phase 1 GREEN (normal inflow)
205.5s 1368 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
205.5s 1369 Running simulation until t = 120.00 s, outputting every 60.00 s
205.5s 1370 
205.7s 1371 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
206.1s 1372 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
206.3s 1373 [WARNING] Automatic CFL correction applied (count: 7300):
206.3s 1374 Calculated CFL: 0.800 > Limit: 0.500
206.3s 1375 Original dt: 4.114983e-01 s
206.3s 1376 Corrected dt: 2.571865e-01 s
206.3s 1377 Correction factor: 1.6x
206.3s 1378 Max wave speed detected: 19.44 m/s
206.5s 1379 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
207.0s 1380 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
207.2s 1381 [WARNING] Automatic CFL correction applied (count: 7400):
207.2s 1382 Calculated CFL: 0.800 > Limit: 0.500
207.2s 1383 Original dt: 4.114980e-01 s
207.2s 1384 Corrected dt: 2.571863e-01 s
207.2s 1385 Correction factor: 1.6x
207.2s 1386 Max wave speed detected: 19.44 m/s
207.4s 1387 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
207.5s 1388 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
207.5s 1389 [A
207.5s 1390 Stored output at t = 120.0000 s (Step 465)
207.5s 1391 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.21s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.21s/s]
207.5s 1392 
207.5s 1393 Simulation finished at t = 120.0000 s after 465 steps.
207.5s 1394 Total runtime: 2.05 seconds.
207.6s 1395 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
207.6s 1396 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
207.6s 1397 Using device: gpu
207.6s 1398 DEBUG PARAMS: Reading K_m_kmh = 10.0
207.6s 1399 DEBUG PARAMS: Reading K_c_kmh = 15.0
207.6s 1400 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
207.6s 1401 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
207.6s 1402 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
207.6s 1403 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
207.6s 1404 Loading road quality type: uniform
207.6s 1405 Uniform road quality value: 2
207.6s 1406 Road quality loaded.
207.6s 1407 Initial state created.
207.6s 1408 Transferring initial state and road quality to GPU...
207.6s 1409 GPU data transfer complete.
207.6s 1410 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
207.6s 1411 Initial boundary conditions applied.
207.6s 1412 [BC UPDATE] left → phase 0 RED (reduced inflow)
207.6s 1413 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
207.6s 1414 [BC UPDATE] left → phase 0 RED (reduced inflow)
207.6s 1415 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
207.6s 1416 Running simulation until t = 60.00 s, outputting every 60.00 s
207.6s 1417 
208.0s 1418 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
208.1s 1419 [WARNING] Automatic CFL correction applied (count: 7500):
208.1s 1420 Calculated CFL: 0.800 > Limit: 0.500
208.1s 1421 Original dt: 4.295897e-01 s
208.1s 1422 Corrected dt: 2.684936e-01 s
208.1s 1423 Correction factor: 1.6x
208.1s 1424 Max wave speed detected: 18.62 m/s
208.4s 1425 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
208.9s 1426 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
209.0s 1427 [WARNING] Automatic CFL correction applied (count: 7600):
209.0s 1428 Calculated CFL: 0.800 > Limit: 0.500
209.0s 1429 Original dt: 4.117215e-01 s
209.0s 1430 Corrected dt: 2.573259e-01 s
209.0s 1431 Correction factor: 1.6x
209.0s 1432 Max wave speed detected: 19.43 m/s
209.3s 1433 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
209.6s 1434 Stored output at t = 60.0000 s (Step 231)
209.6s 1435 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
209.6s 1436 [A
209.6s 1437 
209.6s 1438 Simulation finished at t = 60.0000 s after 231 steps.
209.6s 1439 Total runtime: 2.04 seconds.
209.6s 1440 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.42s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.42s/s]
209.6s 1441 [BC UPDATE] left → phase 1 GREEN (normal inflow)
209.6s 1442 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
209.6s 1443 Running simulation until t = 120.00 s, outputting every 60.00 s
209.6s 1444 
209.8s 1445 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
209.9s 1446 [WARNING] Automatic CFL correction applied (count: 7700):
209.9s 1447 Calculated CFL: 0.800 > Limit: 0.500
209.9s 1448 Original dt: 4.115016e-01 s
209.9s 1449 Corrected dt: 2.571885e-01 s
209.9s 1450 Correction factor: 1.6x
209.9s 1451 Max wave speed detected: 19.44 m/s
210.2s 1452 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
210.7s 1453 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
210.7s 1454 [WARNING] Automatic CFL correction applied (count: 7800):
210.7s 1455 Calculated CFL: 0.800 > Limit: 0.500
210.7s 1456 Original dt: 4.114981e-01 s
210.7s 1457 Corrected dt: 2.571863e-01 s
210.7s 1458 Correction factor: 1.6x
210.7s 1459 Max wave speed detected: 19.44 m/s
211.1s 1460 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
211.5s 1461 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
211.6s 1462 [WARNING] Automatic CFL correction applied (count: 7900):
211.6s 1463 Calculated CFL: 0.800 > Limit: 0.500
211.6s 1464 Original dt: 4.114980e-01 s
211.6s 1465 Corrected dt: 2.571863e-01 s
211.6s 1466 Correction factor: 1.6x
211.6s 1467 Max wave speed detected: 19.44 m/s
211.7s 1468 Stored output at t = 120.0000 s (Step 465)
211.7s 1469 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
211.7s 1470 [A
211.7s 1471 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.23s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.23s/s]
211.7s 1472 
211.7s 1473 Simulation finished at t = 120.0000 s after 465 steps.
211.7s 1474 Total runtime: 2.05 seconds.
211.7s 1475 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
211.7s 1476 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
211.7s 1477 Using device: gpu
211.7s 1478 DEBUG PARAMS: Reading K_m_kmh = 10.0
211.7s 1479 DEBUG PARAMS: Reading K_c_kmh = 15.0
211.7s 1480 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
211.7s 1481 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
211.7s 1482 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
211.7s 1483 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
211.7s 1484 Loading road quality type: uniform
211.7s 1485 Uniform road quality value: 2
211.7s 1486 Road quality loaded.
211.7s 1487 Initial state created.
211.7s 1488 Transferring initial state and road quality to GPU...
211.7s 1489 GPU data transfer complete.
211.7s 1490 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
211.7s 1491 Initial boundary conditions applied.
211.7s 1492 [BC UPDATE] left → phase 0 RED (reduced inflow)
211.7s 1493 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
211.7s 1494 [BC UPDATE] left → phase 0 RED (reduced inflow)
211.7s 1495 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
211.7s 1496 Running simulation until t = 60.00 s, outputting every 60.00 s
211.7s 1497 
212.1s 1498 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
212.5s 1499 [WARNING] Automatic CFL correction applied (count: 8000):
212.5s 1500 Calculated CFL: 0.800 > Limit: 0.500
212.5s 1501 Original dt: 4.151534e-01 s
212.5s 1502 Corrected dt: 2.594709e-01 s
212.5s 1503 Correction factor: 1.6x
212.5s 1504 Max wave speed detected: 19.27 m/s
212.6s 1505 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
213.0s 1506 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
213.4s 1507 [WARNING] Automatic CFL correction applied (count: 8100):
213.4s 1508 Calculated CFL: 0.800 > Limit: 0.500
213.4s 1509 Original dt: 4.115470e-01 s
213.4s 1510 Corrected dt: 2.572169e-01 s
213.4s 1511 Correction factor: 1.6x
213.4s 1512 Max wave speed detected: 19.44 m/s
213.5s 1513 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
213.8s 1514 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
213.8s 1515 [A
213.8s 1516 Stored output at t = 60.0000 s (Step 231)
213.8s 1517 
213.8s 1518 Simulation finished at t = 60.0000 s after 231 steps.
213.8s 1519 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.76s/s]
213.8s 1520 Total runtime: 2.09 seconds.
213.8s 1521 [BC UPDATE] left → phase 1 GREEN (normal inflow)
213.8s 1522 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
213.8s 1523 Running simulation until t = 120.00 s, outputting every 60.00 s
213.8s 1524 
213.9s 1525 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
214.3s 1526 [WARNING] Automatic CFL correction applied (count: 8200):
214.3s 1527 Calculated CFL: 0.800 > Limit: 0.500
214.3s 1528 Original dt: 4.114990e-01 s
214.3s 1529 Corrected dt: 2.571869e-01 s
214.3s 1530 Correction factor: 1.6x
214.3s 1531 Max wave speed detected: 19.44 m/s
214.4s 1532 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
214.8s 1533 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
215.2s 1534 [WARNING] Automatic CFL correction applied (count: 8300):
215.2s 1535 Calculated CFL: 0.800 > Limit: 0.500
215.2s 1536 Original dt: 4.114980e-01 s
215.2s 1537 Corrected dt: 2.571863e-01 s
215.2s 1538 Correction factor: 1.6x
215.2s 1539 Max wave speed detected: 19.44 m/s
215.3s 1540 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
215.7s 1541 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
215.8s 1542 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
215.8s 1543 [A
215.8s 1544 Stored output at t = 120.0000 s (Step 465)
215.8s 1545 
215.8s 1546 Simulation finished at t = 120.0000 s after 465 steps.
215.8s 1547 Total runtime: 2.07 seconds.
215.8s 1548 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.05s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.05s/s]
215.8s 1549 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
215.8s 1550 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
215.8s 1551 Using device: gpu
215.8s 1552 DEBUG PARAMS: Reading K_m_kmh = 10.0
215.8s 1553 DEBUG PARAMS: Reading K_c_kmh = 15.0
215.8s 1554 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
215.8s 1555 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
215.8s 1556 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
215.8s 1557 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
215.8s 1558 Loading road quality type: uniform
215.8s 1559 Uniform road quality value: 2
215.8s 1560 Road quality loaded.
215.8s 1561 Initial state created.
215.8s 1562 Transferring initial state and road quality to GPU...
215.8s 1563 GPU data transfer complete.
215.8s 1564 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
215.8s 1565 Initial boundary conditions applied.
215.8s 1566 [BC UPDATE] left → phase 0 RED (reduced inflow)
215.8s 1567 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
215.8s 1568 [BC UPDATE] left → phase 0 RED (reduced inflow)
215.8s 1569 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
215.8s 1570 Running simulation until t = 60.00 s, outputting every 60.00 s
215.8s 1571 
216.1s 1572 [WARNING] Automatic CFL correction applied (count: 8400):
216.1s 1573 Calculated CFL: 0.800 > Limit: 0.500
216.1s 1574 Original dt: 4.768783e-01 s
216.1s 1575 Corrected dt: 2.980490e-01 s
216.1s 1576 Correction factor: 1.6x
216.1s 1577 Max wave speed detected: 16.78 m/s
216.3s 1578 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
216.7s 1579 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
217.0s 1580 [WARNING] Automatic CFL correction applied (count: 8500):
217.0s 1581 Calculated CFL: 0.800 > Limit: 0.500
217.0s 1582 Original dt: 4.123385e-01 s
217.0s 1583 Corrected dt: 2.577116e-01 s
217.0s 1584 Correction factor: 1.6x
217.0s 1585 Max wave speed detected: 19.40 m/s
217.2s 1586 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
217.6s 1587 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
217.8s 1588 [WARNING] Automatic CFL correction applied (count: 8600):
217.8s 1589 Calculated CFL: 0.800 > Limit: 0.500
217.8s 1590 Original dt: 4.115097e-01 s
217.8s 1591 Corrected dt: 2.571935e-01 s
217.8s 1592 Correction factor: 1.6x
217.8s 1593 Max wave speed detected: 19.44 m/s
217.9s 1594 Stored output at t = 60.0000 s (Step 231)
217.9s 1595 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
217.9s 1596 [A
217.9s 1597 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.69s/s]
217.9s 1598 
217.9s 1599 Simulation finished at t = 60.0000 s after 231 steps.
217.9s 1600 Total runtime: 2.02 seconds.
217.9s 1601 [BC UPDATE] left → phase 0 RED (reduced inflow)
217.9s 1602 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
217.9s 1603 Running simulation until t = 120.00 s, outputting every 60.00 s
217.9s 1604 
218.0s 1605 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
218.5s 1606 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
218.7s 1607 [WARNING] Automatic CFL correction applied (count: 8700):
218.7s 1608 Calculated CFL: 0.800 > Limit: 0.500
218.7s 1609 Original dt: 4.114983e-01 s
218.7s 1610 Corrected dt: 2.571864e-01 s
218.7s 1611 Correction factor: 1.6x
218.7s 1612 Max wave speed detected: 19.44 m/s
218.9s 1613 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
219.3s 1614 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
219.6s 1615 [WARNING] Automatic CFL correction applied (count: 8800):
219.6s 1616 Calculated CFL: 0.800 > Limit: 0.500
219.6s 1617 Original dt: 4.114980e-01 s
219.6s 1618 Corrected dt: 2.571863e-01 s
219.6s 1619 Correction factor: 1.6x
219.6s 1620 Max wave speed detected: 19.44 m/s
219.8s 1621 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
219.9s 1622 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
219.9s 1623 [A
219.9s 1624 Stored output at t = 120.0000 s (Step 465)
219.9s 1625 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.41s/s]
219.9s 1626 
219.9s 1627 Simulation finished at t = 120.0000 s after 465 steps.
219.9s 1628 Total runtime: 2.04 seconds.
219.9s 1629 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
219.9s 1630 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
219.9s 1631 Using device: gpu
219.9s 1632 DEBUG PARAMS: Reading K_m_kmh = 10.0
219.9s 1633 DEBUG PARAMS: Reading K_c_kmh = 15.0
219.9s 1634 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
219.9s 1635 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
219.9s 1636 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
219.9s 1637 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
219.9s 1638 Loading road quality type: uniform
219.9s 1639 Uniform road quality value: 2
219.9s 1640 Road quality loaded.
219.9s 1641 Initial state created.
219.9s 1642 Transferring initial state and road quality to GPU...
219.9s 1643 GPU data transfer complete.
219.9s 1644 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
219.9s 1645 Initial boundary conditions applied.
219.9s 1646 [BC UPDATE] left → phase 0 RED (reduced inflow)
219.9s 1647 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
219.9s 1648 [BC UPDATE] left → phase 1 GREEN (normal inflow)
219.9s 1649 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
219.9s 1650 Running simulation until t = 60.00 s, outputting every 60.00 s
219.9s 1651 
220.4s 1652 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
220.5s 1653 [WARNING] Automatic CFL correction applied (count: 8900):
220.5s 1654 Calculated CFL: 0.800 > Limit: 0.500
220.5s 1655 Original dt: 4.254608e-01 s
220.5s 1656 Corrected dt: 2.659130e-01 s
220.5s 1657 Correction factor: 1.6x
220.5s 1658 Max wave speed detected: 18.80 m/s
220.8s 1659 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
221.3s 1660 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
221.4s 1661 [WARNING] Automatic CFL correction applied (count: 9000):
221.4s 1662 Calculated CFL: 0.800 > Limit: 0.500
221.4s 1663 Original dt: 4.116742e-01 s
221.4s 1664 Corrected dt: 2.572964e-01 s
221.4s 1665 Correction factor: 1.6x
221.4s 1666 Max wave speed detected: 19.43 m/s
221.7s 1667 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
222.0s 1668 Stored output at t = 60.0000 s (Step 231)
222.0s 1669 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
222.0s 1670 [A
222.0s 1671 
222.0s 1672 Simulation finished at t = 60.0000 s after 231 steps.
222.0s 1673 Total runtime: 2.06 seconds.
222.0s 1674 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.12s/s]
222.0s 1675 [BC UPDATE] left → phase 1 GREEN (normal inflow)
222.0s 1676 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
222.0s 1677 Running simulation until t = 120.00 s, outputting every 60.00 s
222.0s 1678 
222.2s 1679 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
222.3s 1680 [WARNING] Automatic CFL correction applied (count: 9100):
222.3s 1681 Calculated CFL: 0.800 > Limit: 0.500
222.3s 1682 Original dt: 4.115011e-01 s
222.3s 1683 Corrected dt: 2.571882e-01 s
222.3s 1684 Correction factor: 1.6x
222.3s 1685 Max wave speed detected: 19.44 m/s
222.6s 1686 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
223.0s 1687 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
223.2s 1688 [WARNING] Automatic CFL correction applied (count: 9200):
223.2s 1689 Calculated CFL: 0.800 > Limit: 0.500
223.2s 1690 Original dt: 4.114981e-01 s
223.2s 1691 Corrected dt: 2.571863e-01 s
223.2s 1692 Correction factor: 1.6x
223.2s 1693 Max wave speed detected: 19.44 m/s
223.5s 1694 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
223.9s 1695 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
224.0s 1696 [WARNING] Automatic CFL correction applied (count: 9300):
224.0s 1697 Calculated CFL: 0.800 > Limit: 0.500
224.0s 1698 Original dt: 4.114980e-01 s
224.0s 1699 Corrected dt: 2.571863e-01 s
224.0s 1700 Correction factor: 1.6x
224.0s 1701 Max wave speed detected: 19.44 m/s
224.0s 1702 Stored output at t = 120.0000 s (Step 465)
224.0s 1703 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
224.0s 1704 [A
224.0s 1705 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.28s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.28s/s]
224.0s 1706 
224.0s 1707 Simulation finished at t = 120.0000 s after 465 steps.
224.0s 1708 Total runtime: 2.05 seconds.
224.0s 1709 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
224.0s 1710 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
224.0s 1711 Using device: gpu
224.0s 1712 DEBUG PARAMS: Reading K_m_kmh = 10.0
224.0s 1713 DEBUG PARAMS: Reading K_c_kmh = 15.0
224.0s 1714 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
224.0s 1715 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
224.0s 1716 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
224.0s 1717 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
224.0s 1718 Loading road quality type: uniform
224.0s 1719 Uniform road quality value: 2
224.0s 1720 Road quality loaded.
224.0s 1721 Initial state created.
224.0s 1722 Transferring initial state and road quality to GPU...
224.0s 1723 GPU data transfer complete.
224.0s 1724 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
224.0s 1725 Initial boundary conditions applied.
224.0s 1726 [BC UPDATE] left → phase 0 RED (reduced inflow)
224.0s 1727 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
224.1s 1728 [BC UPDATE] left → phase 1 GREEN (normal inflow)
224.1s 1729 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
224.1s 1730 Running simulation until t = 60.00 s, outputting every 60.00 s
224.1s 1731 
224.5s 1732 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
224.9s 1733 [WARNING] Automatic CFL correction applied (count: 9400):
224.9s 1734 Calculated CFL: 0.800 > Limit: 0.500
224.9s 1735 Original dt: 4.145004e-01 s
224.9s 1736 Corrected dt: 2.590627e-01 s
224.9s 1737 Correction factor: 1.6x
224.9s 1738 Max wave speed detected: 19.30 m/s
224.9s 1739 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
225.4s 1740 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
225.8s 1741 [WARNING] Automatic CFL correction applied (count: 9500):
225.8s 1742 Calculated CFL: 0.800 > Limit: 0.500
225.8s 1743 Original dt: 4.115380e-01 s
225.8s 1744 Corrected dt: 2.572113e-01 s
225.8s 1745 Correction factor: 1.6x
225.8s 1746 Max wave speed detected: 19.44 m/s
225.8s 1747 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
226.1s 1748 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
226.1s 1749 [A
226.1s 1750 Stored output at t = 60.0000 s (Step 231)
226.1s 1751 
226.1s 1752 Simulation finished at t = 60.0000 s after 231 steps.
226.1s 1753 Total runtime: 2.02 seconds.
226.1s 1754 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s]
226.1s 1755 [BC UPDATE] left → phase 1 GREEN (normal inflow)
226.1s 1756 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
226.1s 1757 Running simulation until t = 120.00 s, outputting every 60.00 s
226.1s 1758 
226.2s 1759 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
226.7s 1760 [WARNING] Automatic CFL correction applied (count: 9600):
226.7s 1761 Calculated CFL: 0.800 > Limit: 0.500
226.7s 1762 Original dt: 4.114988e-01 s
226.7s 1763 Corrected dt: 2.571867e-01 s
226.7s 1764 Correction factor: 1.6x
226.7s 1765 Max wave speed detected: 19.44 m/s
226.7s 1766 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
227.1s 1767 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
227.5s 1768 [WARNING] Automatic CFL correction applied (count: 9700):
227.5s 1769 Calculated CFL: 0.800 > Limit: 0.500
227.5s 1770 Original dt: 4.114980e-01 s
227.5s 1771 Corrected dt: 2.571863e-01 s
227.5s 1772 Correction factor: 1.6x
227.5s 1773 Max wave speed detected: 19.44 m/s
227.5s 1774 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
228.0s 1775 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
228.1s 1776 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
228.1s 1777 [A
228.1s 1778 Stored output at t = 120.0000 s (Step 465)
228.1s 1779 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.02s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.01s/s]
228.1s 1780 
228.1s 1781 Simulation finished at t = 120.0000 s after 465 steps.
228.1s 1782 Total runtime: 2.07 seconds.
228.1s 1783 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
228.1s 1784 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
228.1s 1785 Using device: gpu
228.2s 1786 DEBUG PARAMS: Reading K_m_kmh = 10.0
228.2s 1787 DEBUG PARAMS: Reading K_c_kmh = 15.0
228.2s 1788 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
228.2s 1789 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
228.2s 1790 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
228.2s 1791 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
228.2s 1792 Loading road quality type: uniform
228.2s 1793 Uniform road quality value: 2
228.2s 1794 Road quality loaded.
228.2s 1795 Initial state created.
228.2s 1796 Transferring initial state and road quality to GPU...
228.2s 1797 GPU data transfer complete.
228.2s 1798 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
228.2s 1799 Initial boundary conditions applied.
228.2s 1800 [BC UPDATE] left → phase 0 RED (reduced inflow)
228.2s 1801 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
228.2s 1802 
228.2s 1803 [BC UPDATE] left → phase 1 GREEN (normal inflow)
228.2s 1804 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
228.2s 1805 Running simulation until t = 60.00 s, outputting every 60.00 s
228.5s 1806 [WARNING] Automatic CFL correction applied (count: 9800):
228.5s 1807 Calculated CFL: 0.800 > Limit: 0.500
228.5s 1808 Original dt: 4.758816e-01 s
228.5s 1809 Corrected dt: 2.974260e-01 s
228.5s 1810 Correction factor: 1.6x
228.5s 1811 Max wave speed detected: 16.81 m/s
228.6s 1812 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
229.0s 1813 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
229.3s 1814 [WARNING] Automatic CFL correction applied (count: 9900):
229.3s 1815 Calculated CFL: 0.800 > Limit: 0.500
229.3s 1816 Original dt: 4.121510e-01 s
229.3s 1817 Corrected dt: 2.575944e-01 s
229.3s 1818 Correction factor: 1.6x
229.3s 1819 Max wave speed detected: 19.41 m/s
229.5s 1820 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
229.9s 1821 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
230.2s 1822 Stored output at t = 60.0000 s (Step 231)
230.2s 1823 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
230.2s 1824 [A
230.2s 1825 
230.2s 1826 Simulation finished at t = 60.0000 s after 231 steps.
230.2s 1827 Total runtime: 2.03 seconds.
230.2s 1828 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.57s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.56s/s]
230.2s 1829 [BC UPDATE] left → phase 1 GREEN (normal inflow)
230.2s 1830 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
230.2s 1831 Running simulation until t = 120.00 s, outputting every 60.00 s
230.2s 1832 
230.2s 1833 [WARNING] Automatic CFL correction applied (count: 10000):
230.2s 1834 Calculated CFL: 0.800 > Limit: 0.500
230.2s 1835 Original dt: 4.115082e-01 s
230.2s 1836 Corrected dt: 2.571926e-01 s
230.2s 1837 Correction factor: 1.6x
230.2s 1838 Max wave speed detected: 19.44 m/s
230.4s 1839 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
230.8s 1840 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
231.1s 1841 [WARNING] Automatic CFL correction applied (count: 10100):
231.1s 1842 Calculated CFL: 0.800 > Limit: 0.500
231.1s 1843 Original dt: 4.114982e-01 s
231.1s 1844 Corrected dt: 2.571864e-01 s
231.1s 1845 Correction factor: 1.6x
231.1s 1846 Max wave speed detected: 19.44 m/s
231.2s 1847 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
231.7s 1848 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
232.0s 1849 [WARNING] Automatic CFL correction applied (count: 10200):
232.0s 1850 Calculated CFL: 0.800 > Limit: 0.500
232.0s 1851 Original dt: 4.114980e-01 s
232.0s 1852 Corrected dt: 2.571863e-01 s
232.0s 1853 Correction factor: 1.6x
232.0s 1854 Max wave speed detected: 19.44 m/s
232.1s 1855 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
232.3s 1856 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
232.3s 1857 [A
232.3s 1858 Stored output at t = 120.0000 s (Step 465)
232.3s 1859 
232.3s 1860 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.80s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.80s/s]
232.3s 1861 Simulation finished at t = 120.0000 s after 465 steps.
232.3s 1862 Total runtime: 2.08 seconds.
232.3s 1863 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
232.3s 1864 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
232.3s 1865 Using device: gpu
232.3s 1866 DEBUG PARAMS: Reading K_m_kmh = 10.0
232.3s 1867 DEBUG PARAMS: Reading K_c_kmh = 15.0
232.3s 1868 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
232.3s 1869 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
232.3s 1870 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
232.3s 1871 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
232.3s 1872 Loading road quality type: uniform
232.3s 1873 Uniform road quality value: 2
232.3s 1874 Road quality loaded.
232.3s 1875 Initial state created.
232.3s 1876 Transferring initial state and road quality to GPU...
232.3s 1877 GPU data transfer complete.
232.3s 1878 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
232.3s 1879 Initial boundary conditions applied.
232.3s 1880 [BC UPDATE] left → phase 0 RED (reduced inflow)
232.3s 1881 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
232.3s 1882 [BC UPDATE] left → phase 0 RED (reduced inflow)
232.3s 1883 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
232.3s 1884 Running simulation until t = 60.00 s, outputting every 60.00 s
232.3s 1885 
232.7s 1886 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
232.9s 1887 [WARNING] Automatic CFL correction applied (count: 10300):
232.9s 1888 Calculated CFL: 0.800 > Limit: 0.500
232.9s 1889 Original dt: 4.225636e-01 s
232.9s 1890 Corrected dt: 2.641023e-01 s
232.9s 1891 Correction factor: 1.6x
232.9s 1892 Max wave speed detected: 18.93 m/s
233.2s 1893 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
233.6s 1894 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
233.8s 1895 [WARNING] Automatic CFL correction applied (count: 10400):
233.8s 1896 Calculated CFL: 0.800 > Limit: 0.500
233.8s 1897 Original dt: 4.116395e-01 s
233.8s 1898 Corrected dt: 2.572747e-01 s
233.8s 1899 Correction factor: 1.6x
233.8s 1900 Max wave speed detected: 19.43 m/s
234.1s 1901 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
234.3s 1902 Stored output at t = 60.0000 s (Step 231)
234.3s 1903 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
234.3s 1904 [A
234.3s 1905 
234.3s 1906 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.31s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.30s/s]
234.3s 1907 Simulation finished at t = 60.0000 s after 231 steps.
234.3s 1908 Total runtime: 2.05 seconds.
234.3s 1909 [BC UPDATE] left → phase 0 RED (reduced inflow)
234.3s 1910 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
234.3s 1911 Running simulation until t = 120.00 s, outputting every 60.00 s
234.3s 1912 
234.5s 1913 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
234.7s 1914 [WARNING] Automatic CFL correction applied (count: 10500):
234.7s 1915 Calculated CFL: 0.800 > Limit: 0.500
234.7s 1916 Original dt: 4.115005e-01 s
234.7s 1917 Corrected dt: 2.571878e-01 s
234.7s 1918 Correction factor: 1.6x
234.7s 1919 Max wave speed detected: 19.44 m/s
234.9s 1920 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
235.4s 1921 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
235.5s 1922 [WARNING] Automatic CFL correction applied (count: 10600):
235.5s 1923 Calculated CFL: 0.800 > Limit: 0.500
235.5s 1924 Original dt: 4.114981e-01 s
235.5s 1925 Corrected dt: 2.571863e-01 s
235.5s 1926 Correction factor: 1.6x
235.5s 1927 Max wave speed detected: 19.44 m/s
235.8s 1928 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
236.2s 1929 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
236.4s 1930 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
236.4s 1931 [A
236.4s 1932 Stored output at t = 120.0000 s (Step 465)
236.4s 1933 
236.4s 1934 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.50s/s]
236.4s 1935 Simulation finished at t = 120.0000 s after 465 steps.
236.4s 1936 Total runtime: 2.03 seconds.
236.4s 1937 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
236.4s 1938 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
236.4s 1939 Using device: gpu
236.4s 1940 DEBUG PARAMS: Reading K_m_kmh = 10.0
236.4s 1941 DEBUG PARAMS: Reading K_c_kmh = 15.0
236.4s 1942 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
236.4s 1943 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
236.4s 1944 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
236.4s 1945 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
236.4s 1946 Loading road quality type: uniform
236.4s 1947 Uniform road quality value: 2
236.4s 1948 Road quality loaded.
236.4s 1949 Initial state created.
236.4s 1950 Transferring initial state and road quality to GPU...
236.4s 1951 GPU data transfer complete.
236.4s 1952 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
236.4s 1953 Initial boundary conditions applied.
236.4s 1954 [BC UPDATE] left → phase 0 RED (reduced inflow)
236.4s 1955 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
236.4s 1956 [BC UPDATE] left → phase 1 GREEN (normal inflow)
236.4s 1957 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
236.4s 1958 Running simulation until t = 60.00 s, outputting every 60.00 s
236.4s 1959 
236.4s 1960 [WARNING] Automatic CFL correction applied (count: 10700):
236.4s 1961 Calculated CFL: 0.800 > Limit: 0.500
236.4s 1962 Original dt: 3.451280e-01 s
236.4s 1963 Corrected dt: 2.157050e-01 s
236.4s 1964 Correction factor: 1.6x
236.4s 1965 Max wave speed detected: 23.18 m/s
236.8s 1966 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
237.3s 1967 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
237.3s 1968 [WARNING] Automatic CFL correction applied (count: 10800):
237.3s 1969 Calculated CFL: 0.800 > Limit: 0.500
237.3s 1970 Original dt: 4.139892e-01 s
237.3s 1971 Corrected dt: 2.587433e-01 s
237.3s 1972 Correction factor: 1.6x
237.3s 1973 Max wave speed detected: 19.32 m/s
237.7s 1974 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
238.2s 1975 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
238.2s 1976 [WARNING] Automatic CFL correction applied (count: 10900):
238.2s 1977 Calculated CFL: 0.800 > Limit: 0.500
238.2s 1978 Original dt: 4.115314e-01 s
238.2s 1979 Corrected dt: 2.572071e-01 s
238.2s 1980 Correction factor: 1.6x
238.2s 1981 Max wave speed detected: 19.44 m/s
238.4s 1982 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
238.4s 1983 [A
238.4s 1984 Stored output at t = 60.0000 s (Step 231)
238.4s 1985 
238.4s 1986 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.20s/s]
238.4s 1987 Simulation finished at t = 60.0000 s after 231 steps.
238.4s 1988 Total runtime: 2.06 seconds.
238.4s 1989 [BC UPDATE] left → phase 0 RED (reduced inflow)
238.4s 1990 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
238.4s 1991 Running simulation until t = 120.00 s, outputting every 60.00 s
238.4s 1992 
238.6s 1993 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
239.1s 1994 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
239.1s 1995 [WARNING] Automatic CFL correction applied (count: 11000):
239.1s 1996 Calculated CFL: 0.800 > Limit: 0.500
239.1s 1997 Original dt: 4.114986e-01 s
239.1s 1998 Corrected dt: 2.571866e-01 s
239.1s 1999 Correction factor: 1.6x
239.1s 2000 Max wave speed detected: 19.44 m/s
239.5s 2001 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
239.9s 2002 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
240.0s 2003 [WARNING] Automatic CFL correction applied (count: 11100):
240.0s 2004 Calculated CFL: 0.800 > Limit: 0.500
240.0s 2005 Original dt: 4.114980e-01 s
240.0s 2006 Corrected dt: 2.571863e-01 s
240.0s 2007 Correction factor: 1.6x
240.0s 2008 Max wave speed detected: 19.44 m/s
240.4s 2009 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
240.5s 2010 Stored output at t = 120.0000 s (Step 465)
240.5s 2011 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
240.5s 2012 [A
240.5s 2013 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.40s/s]
240.5s 2014 
240.5s 2015 Simulation finished at t = 120.0000 s after 465 steps.
240.5s 2016 Total runtime: 2.04 seconds.
240.5s 2017 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
240.5s 2018 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
240.5s 2019 Using device: gpu
240.5s 2020 DEBUG PARAMS: Reading K_m_kmh = 10.0
240.5s 2021 DEBUG PARAMS: Reading K_c_kmh = 15.0
240.5s 2022 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
240.5s 2023 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
240.5s 2024 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
240.5s 2025 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
240.5s 2026 Loading road quality type: uniform
240.5s 2027 Uniform road quality value: 2
240.5s 2028 Road quality loaded.
240.5s 2029 Initial state created.
240.5s 2030 Transferring initial state and road quality to GPU...
240.5s 2031 GPU data transfer complete.
240.5s 2032 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
240.5s 2033 Initial boundary conditions applied.
240.5s 2034 [BC UPDATE] left → phase 0 RED (reduced inflow)
240.5s 2035 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
240.5s 2036 [BC UPDATE] left → phase 0 RED (reduced inflow)
240.5s 2037 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
240.5s 2038 Running simulation until t = 60.00 s, outputting every 60.00 s
240.5s 2039 
240.8s 2040 [WARNING] Automatic CFL correction applied (count: 11200):
240.8s 2041 Calculated CFL: 0.800 > Limit: 0.500
240.8s 2042 Original dt: 4.583403e-01 s
240.8s 2043 Corrected dt: 2.864627e-01 s
240.8s 2044 Correction factor: 1.6x
240.8s 2045 Max wave speed detected: 17.45 m/s
240.9s 2046 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
241.4s 2047 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
241.7s 2048 [WARNING] Automatic CFL correction applied (count: 11300):
241.7s 2049 Calculated CFL: 0.800 > Limit: 0.500
241.7s 2050 Original dt: 4.120137e-01 s
241.7s 2051 Corrected dt: 2.575085e-01 s
241.7s 2052 Correction factor: 1.6x
241.7s 2053 Max wave speed detected: 19.42 m/s
241.8s 2054 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
242.3s 2055 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
242.5s 2056 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
242.5s 2057 [A
242.5s 2058 Stored output at t = 60.0000 s (Step 231)
242.5s 2059 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.47s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.46s/s]
242.5s 2060 
242.5s 2061 Simulation finished at t = 60.0000 s after 231 steps.
242.5s 2062 Total runtime: 2.04 seconds.
242.5s 2063 [BC UPDATE] left → phase 1 GREEN (normal inflow)
242.5s 2064 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
242.5s 2065 Running simulation until t = 120.00 s, outputting every 60.00 s
242.5s 2066 
242.6s 2067 [WARNING] Automatic CFL correction applied (count: 11400):
242.6s 2068 Calculated CFL: 0.800 > Limit: 0.500
242.6s 2069 Original dt: 4.115064e-01 s
242.6s 2070 Corrected dt: 2.571915e-01 s
242.6s 2071 Correction factor: 1.6x
242.6s 2072 Max wave speed detected: 19.44 m/s
242.7s 2073 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
243.2s 2074 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
243.5s 2075 [WARNING] Automatic CFL correction applied (count: 11500):
243.5s 2076 Calculated CFL: 0.800 > Limit: 0.500
243.5s 2077 Original dt: 4.114982e-01 s
243.5s 2078 Corrected dt: 2.571864e-01 s
243.5s 2079 Correction factor: 1.6x
243.5s 2080 Max wave speed detected: 19.44 m/s
243.6s 2081 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
244.0s 2082 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
244.4s 2083 [WARNING] Automatic CFL correction applied (count: 11600):
244.4s 2084 Calculated CFL: 0.800 > Limit: 0.500
244.4s 2085 Original dt: 4.114980e-01 s
244.4s 2086 Corrected dt: 2.571863e-01 s
244.4s 2087 Correction factor: 1.6x
244.4s 2088 Max wave speed detected: 19.44 m/s
244.5s 2089 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
244.6s 2090 Stored output at t = 120.0000 s (Step 465)
244.6s 2091 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
244.6s 2092 [A
244.6s 2093 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.67s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.66s/s]
244.6s 2094 
244.6s 2095 Simulation finished at t = 120.0000 s after 465 steps.
244.6s 2096 Total runtime: 2.09 seconds.
244.6s 2097 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
244.6s 2098 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
244.6s 2099 Using device: gpu
244.6s 2100 DEBUG PARAMS: Reading K_m_kmh = 10.0
244.6s 2101 DEBUG PARAMS: Reading K_c_kmh = 15.0
244.6s 2102 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
244.6s 2103 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
244.6s 2104 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
244.6s 2105 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
244.6s 2106 Loading road quality type: uniform
244.6s 2107 Uniform road quality value: 2
244.6s 2108 Road quality loaded.
244.6s 2109 Initial state created.
244.6s 2110 Transferring initial state and road quality to GPU...
244.6s 2111 GPU data transfer complete.
244.6s 2112 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
244.6s 2113 Initial boundary conditions applied.
244.6s 2114 [BC UPDATE] left → phase 0 RED (reduced inflow)
244.6s 2115 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
244.7s 2116 📊 Progress: 50/100 (50.0%) | ETA: 1.8 min | Speed: 0.5 steps/s
244.7s 2117 [BC UPDATE] left → phase 0 RED (reduced inflow)
244.7s 2118 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
244.7s 2119 Running simulation until t = 60.00 s, outputting every 60.00 s
244.7s 2120 
245.1s 2121 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
245.3s 2122 [WARNING] Automatic CFL correction applied (count: 11700):
245.3s 2123 Calculated CFL: 0.800 > Limit: 0.500
245.3s 2124 Original dt: 4.205139e-01 s
245.3s 2125 Corrected dt: 2.628212e-01 s
245.3s 2126 Correction factor: 1.6x
245.3s 2127 Max wave speed detected: 19.02 m/s
245.6s 2128 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
246.0s 2129 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
246.2s 2130 [WARNING] Automatic CFL correction applied (count: 11800):
246.2s 2131 Calculated CFL: 0.800 > Limit: 0.500
246.2s 2132 Original dt: 4.116141e-01 s
246.2s 2133 Corrected dt: 2.572588e-01 s
246.2s 2134 Correction factor: 1.6x
246.2s 2135 Max wave speed detected: 19.44 m/s
246.4s 2136 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
246.7s 2137 Stored output at t = 60.0000 s (Step 231)
246.7s 2138 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
246.7s 2139 [A
246.7s 2140 
246.7s 2141 Simulation finished at t = 60.0000 s after 231 steps.
246.7s 2142 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.08s/s]
246.7s 2143 Total runtime: 2.06 seconds.
246.7s 2144 [BC UPDATE] left → phase 1 GREEN (normal inflow)
246.7s 2145 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
246.7s 2146 Running simulation until t = 120.00 s, outputting every 60.00 s
246.7s 2147 
246.9s 2148 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
247.1s 2149 [WARNING] Automatic CFL correction applied (count: 11900):
247.1s 2150 Calculated CFL: 0.800 > Limit: 0.500
247.1s 2151 Original dt: 4.115000e-01 s
247.1s 2152 Corrected dt: 2.571875e-01 s
247.1s 2153 Correction factor: 1.6x
247.1s 2154 Max wave speed detected: 19.44 m/s
247.4s 2155 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
247.9s 2156 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
248.1s 2157 [WARNING] Automatic CFL correction applied (count: 12000):
248.1s 2158 Calculated CFL: 0.800 > Limit: 0.500
248.1s 2159 Original dt: 4.114981e-01 s
248.1s 2160 Corrected dt: 2.571863e-01 s
248.1s 2161 Correction factor: 1.6x
248.1s 2162 Max wave speed detected: 19.44 m/s
248.4s 2163 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
249.0s 2164 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
249.1s 2165 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
249.1s 2166 Stored output at t = 120.0000 s (Step 465)
249.1s 2167 [A
249.1s 2168 
249.1s 2169 Simulation finished at t = 120.0000 s after 465 steps.
249.1s 2170 Total runtime: 2.40 seconds.
249.1s 2171 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 24.99s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 24.99s/s]
249.1s 2172 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
249.1s 2173 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
249.1s 2174 Using device: gpu
249.1s 2175 DEBUG PARAMS: Reading K_m_kmh = 10.0
249.1s 2176 DEBUG PARAMS: Reading K_c_kmh = 15.0
249.1s 2177 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
249.1s 2178 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
249.1s 2179 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
249.1s 2180 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
249.1s 2181 Loading road quality type: uniform
249.1s 2182 Uniform road quality value: 2
249.1s 2183 Road quality loaded.
249.1s 2184 Initial state created.
249.1s 2185 Transferring initial state and road quality to GPU...
249.1s 2186 GPU data transfer complete.
249.1s 2187 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
249.1s 2188 Initial boundary conditions applied.
249.1s 2189 [BC UPDATE] left → phase 0 RED (reduced inflow)
249.1s 2190 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
249.1s 2191 [BC UPDATE] left → phase 0 RED (reduced inflow)
249.1s 2192 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
249.1s 2193 Running simulation until t = 60.00 s, outputting every 60.00 s
249.1s 2194 
249.2s 2195 [WARNING] Automatic CFL correction applied (count: 12100):
249.2s 2196 Calculated CFL: 0.800 > Limit: 0.500
249.2s 2197 Original dt: 3.737254e-01 s
249.2s 2198 Corrected dt: 2.335784e-01 s
249.2s 2199 Correction factor: 1.6x
249.2s 2200 Max wave speed detected: 21.41 m/s
249.6s 2201 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
250.1s 2202 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
250.2s 2203 [WARNING] Automatic CFL correction applied (count: 12200):
250.2s 2204 Calculated CFL: 0.800 > Limit: 0.500
250.2s 2205 Original dt: 4.134305e-01 s
250.2s 2206 Corrected dt: 2.583941e-01 s
250.2s 2207 Correction factor: 1.6x
250.2s 2208 Max wave speed detected: 19.35 m/s
250.6s 2209 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
251.1s 2210 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
251.2s 2211 [WARNING] Automatic CFL correction applied (count: 12300):
251.2s 2212 Calculated CFL: 0.800 > Limit: 0.500
251.2s 2213 Original dt: 4.115259e-01 s
251.2s 2214 Corrected dt: 2.572037e-01 s
251.2s 2215 Correction factor: 1.6x
251.2s 2216 Max wave speed detected: 19.44 m/s
251.4s 2217 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
251.4s 2218 [A
251.4s 2219 Stored output at t = 60.0000 s (Step 231)
251.4s 2220 
251.4s 2221 Simulation finished at t = 60.0000 s after 231 steps.
251.4s 2222 Total runtime: 2.24 seconds.
251.4s 2223 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.81s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.81s/s]
251.4s 2224 [BC UPDATE] left → phase 1 GREEN (normal inflow)
251.4s 2225 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
251.4s 2226 Running simulation until t = 120.00 s, outputting every 60.00 s
251.4s 2227 
251.6s 2228 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
252.1s 2229 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
252.2s 2230 [WARNING] Automatic CFL correction applied (count: 12400):
252.2s 2231 Calculated CFL: 0.800 > Limit: 0.500
252.2s 2232 Original dt: 4.114985e-01 s
252.2s 2233 Corrected dt: 2.571866e-01 s
252.2s 2234 Correction factor: 1.6x
252.2s 2235 Max wave speed detected: 19.44 m/s
252.5s 2236 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
253.0s 2237 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
253.1s 2238 [WARNING] Automatic CFL correction applied (count: 12500):
253.1s 2239 Calculated CFL: 0.800 > Limit: 0.500
253.1s 2240 Original dt: 4.114980e-01 s
253.1s 2241 Corrected dt: 2.571863e-01 s
253.1s 2242 Correction factor: 1.6x
253.1s 2243 Max wave speed detected: 19.44 m/s
253.4s 2244 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
253.6s 2245 Stored output at t = 120.0000 s (Step 465)
253.6s 2246 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
253.6s 2247 [A
253.6s 2248 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.57s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.56s/s]
253.6s 2249 
253.6s 2250 Simulation finished at t = 120.0000 s after 465 steps.
253.6s 2251 Total runtime: 2.18 seconds.
253.6s 2252 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
253.6s 2253 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
253.6s 2254 Using device: gpu
253.6s 2255 DEBUG PARAMS: Reading K_m_kmh = 10.0
253.6s 2256 DEBUG PARAMS: Reading K_c_kmh = 15.0
253.6s 2257 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
253.6s 2258 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
253.6s 2259 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
253.6s 2260 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
253.6s 2261 Loading road quality type: uniform
253.6s 2262 Uniform road quality value: 2
253.6s 2263 Road quality loaded.
253.6s 2264 Initial state created.
253.6s 2265 Transferring initial state and road quality to GPU...
253.6s 2266 GPU data transfer complete.
253.6s 2267 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
253.6s 2268 Initial boundary conditions applied.
253.6s 2269 [BC UPDATE] left → phase 0 RED (reduced inflow)
253.6s 2270 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
253.6s 2271 [BC UPDATE] left → phase 1 GREEN (normal inflow)
253.6s 2272 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
253.6s 2273 Running simulation until t = 60.00 s, outputting every 60.00 s
253.6s 2274 
254.0s 2275 [WARNING] Automatic CFL correction applied (count: 12600):
254.0s 2276 Calculated CFL: 0.800 > Limit: 0.500
254.0s 2277 Original dt: 4.470525e-01 s
254.0s 2278 Corrected dt: 2.794078e-01 s
254.0s 2279 Correction factor: 1.6x
254.0s 2280 Max wave speed detected: 17.89 m/s
254.0s 2281 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
254.4s 2282 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
254.8s 2283 [WARNING] Automatic CFL correction applied (count: 12700):
254.8s 2284 Calculated CFL: 0.800 > Limit: 0.500
254.8s 2285 Original dt: 4.119130e-01 s
254.8s 2286 Corrected dt: 2.574456e-01 s
254.8s 2287 Correction factor: 1.6x
254.8s 2288 Max wave speed detected: 19.42 m/s
254.9s 2289 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
255.3s 2290 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
255.6s 2291 Stored output at t = 60.0000 s (Step 231)
255.6s 2292 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
255.6s 2293 [A
255.6s 2294 
255.6s 2295 Simulation finished at t = 60.0000 s after 231 steps.
255.6s 2296 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.27s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.27s/s]
255.6s 2297 Total runtime: 2.05 seconds.
255.6s 2298 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.6s 2299 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
255.6s 2300 Running simulation until t = 120.00 s, outputting every 60.00 s
255.6s 2301 
255.7s 2302 [WARNING] Automatic CFL correction applied (count: 12800):
255.7s 2303 Calculated CFL: 0.800 > Limit: 0.500
255.7s 2304 Original dt: 4.115046e-01 s
255.7s 2305 Corrected dt: 2.571904e-01 s
255.7s 2306 Correction factor: 1.6x
255.7s 2307 Max wave speed detected: 19.44 m/s
255.8s 2308 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
256.3s 2309 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
256.7s 2310 [WARNING] Automatic CFL correction applied (count: 12900):
256.7s 2311 Calculated CFL: 0.800 > Limit: 0.500
256.7s 2312 Original dt: 4.114982e-01 s
256.7s 2313 Corrected dt: 2.571863e-01 s
256.7s 2314 Correction factor: 1.6x
256.7s 2315 Max wave speed detected: 19.44 m/s
256.7s 2316 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
257.2s 2317 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
257.6s 2318 [WARNING] Automatic CFL correction applied (count: 13000):
257.6s 2319 Calculated CFL: 0.800 > Limit: 0.500
257.6s 2320 Original dt: 4.114980e-01 s
257.6s 2321 Corrected dt: 2.571863e-01 s
257.6s 2322 Correction factor: 1.6x
257.6s 2323 Max wave speed detected: 19.44 m/s
257.6s 2324 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
257.8s 2325 Stored output at t = 120.0000 s (Step 465)
257.8s 2326 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
257.8s 2327 [A
257.8s 2328 
257.8s 2329 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.83s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.83s/s]
257.8s 2330 Simulation finished at t = 120.0000 s after 465 steps.
257.8s 2331 Total runtime: 2.16 seconds.
257.8s 2332 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
257.8s 2333 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
257.8s 2334 Using device: gpu
257.8s 2335 DEBUG PARAMS: Reading K_m_kmh = 10.0
257.8s 2336 DEBUG PARAMS: Reading K_c_kmh = 15.0
257.8s 2337 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
257.8s 2338 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
257.8s 2339 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
257.8s 2340 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
257.8s 2341 Loading road quality type: uniform
257.8s 2342 Uniform road quality value: 2
257.8s 2343 Road quality loaded.
257.8s 2344 Initial state created.
257.8s 2345 Transferring initial state and road quality to GPU...
257.8s 2346 GPU data transfer complete.
257.8s 2347 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
257.8s 2348 Initial boundary conditions applied.
257.8s 2349 [BC UPDATE] left → phase 0 RED (reduced inflow)
257.8s 2350 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
257.8s 2351 [BC UPDATE] left → phase 0 RED (reduced inflow)
257.8s 2352 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
257.8s 2353 Running simulation until t = 60.00 s, outputting every 60.00 s
257.8s 2354 
258.3s 2355 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
258.5s 2356 [WARNING] Automatic CFL correction applied (count: 13100):
258.5s 2357 Calculated CFL: 0.800 > Limit: 0.500
258.5s 2358 Original dt: 4.190346e-01 s
258.5s 2359 Corrected dt: 2.618967e-01 s
258.5s 2360 Correction factor: 1.6x
258.5s 2361 Max wave speed detected: 19.09 m/s
258.7s 2362 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
259.2s 2363 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
259.5s 2364 [WARNING] Automatic CFL correction applied (count: 13200):
259.5s 2365 Calculated CFL: 0.800 > Limit: 0.500
259.5s 2366 Original dt: 4.115954e-01 s
259.5s 2367 Corrected dt: 2.572472e-01 s
259.5s 2368 Correction factor: 1.6x
259.5s 2369 Max wave speed detected: 19.44 m/s
259.6s 2370 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
259.9s 2371 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
259.9s 2372 [A
259.9s 2373 Stored output at t = 60.0000 s (Step 231)
259.9s 2374 
259.9s 2375 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.19s/s]
259.9s 2376 Simulation finished at t = 60.0000 s after 231 steps.
259.9s 2377 Total runtime: 2.13 seconds.
259.9s 2378 [BC UPDATE] left → phase 0 RED (reduced inflow)
259.9s 2379 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
259.9s 2380 Running simulation until t = 120.00 s, outputting every 60.00 s
259.9s 2381 
260.1s 2382 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
260.4s 2383 [WARNING] Automatic CFL correction applied (count: 13300):
260.4s 2384 Calculated CFL: 0.800 > Limit: 0.500
260.4s 2385 Original dt: 4.114996e-01 s
260.4s 2386 Corrected dt: 2.571873e-01 s
260.4s 2387 Correction factor: 1.6x
260.4s 2388 Max wave speed detected: 19.44 m/s
260.6s 2389 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
261.1s 2390 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
261.3s 2391 [WARNING] Automatic CFL correction applied (count: 13400):
261.3s 2392 Calculated CFL: 0.800 > Limit: 0.500
261.3s 2393 Original dt: 4.114981e-01 s
261.3s 2394 Corrected dt: 2.571863e-01 s
261.3s 2395 Correction factor: 1.6x
261.3s 2396 Max wave speed detected: 19.44 m/s
261.5s 2397 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
262.0s 2398 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
262.2s 2399 Stored output at t = 120.0000 s (Step 465)
262.2s 2400 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
262.2s 2401 [A
262.2s 2402 
262.2s 2403 Simulation finished at t = 120.0000 s after 465 steps.
262.2s 2404 Total runtime: 2.25 seconds.
262.2s 2405 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.67s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.67s/s]
262.2s 2406 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
262.2s 2407 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
262.2s 2408 Using device: gpu
262.2s 2409 DEBUG PARAMS: Reading K_m_kmh = 10.0
262.2s 2410 DEBUG PARAMS: Reading K_c_kmh = 15.0
262.2s 2411 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
262.2s 2412 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
262.2s 2413 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
262.2s 2414 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
262.2s 2415 Loading road quality type: uniform
262.2s 2416 Uniform road quality value: 2
262.2s 2417 Road quality loaded.
262.2s 2418 Initial state created.
262.2s 2419 Transferring initial state and road quality to GPU...
262.2s 2420 GPU data transfer complete.
262.2s 2421 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
262.2s 2422 Initial boundary conditions applied.
262.2s 2423 [BC UPDATE] left → phase 0 RED (reduced inflow)
262.2s 2424 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
262.2s 2425 [BC UPDATE] left → phase 0 RED (reduced inflow)
262.2s 2426 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
262.2s 2427 Running simulation until t = 60.00 s, outputting every 60.00 s
262.2s 2428 
262.3s 2429 [WARNING] Automatic CFL correction applied (count: 13500):
262.3s 2430 Calculated CFL: 0.800 > Limit: 0.500
262.3s 2431 Original dt: 4.022422e-01 s
262.3s 2432 Corrected dt: 2.514014e-01 s
262.3s 2433 Correction factor: 1.6x
262.3s 2434 Max wave speed detected: 19.89 m/s
262.7s 2435 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
263.1s 2436 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
263.2s 2437 [WARNING] Automatic CFL correction applied (count: 13600):
263.2s 2438 Calculated CFL: 0.800 > Limit: 0.500
263.2s 2439 Original dt: 4.130229e-01 s
263.2s 2440 Corrected dt: 2.581393e-01 s
263.2s 2441 Correction factor: 1.6x
263.2s 2442 Max wave speed detected: 19.37 m/s
263.6s 2443 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
264.2s 2444 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
264.4s 2445 [WARNING] Automatic CFL correction applied (count: 13700):
264.4s 2446 Calculated CFL: 0.800 > Limit: 0.500
264.4s 2447 Original dt: 4.115198e-01 s
264.4s 2448 Corrected dt: 2.571999e-01 s
264.4s 2449 Correction factor: 1.6x
264.4s 2450 Max wave speed detected: 19.44 m/s
264.6s 2451 Stored output at t = 60.0000 s (Step 231)
264.6s 2452 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
264.6s 2453 [A
264.6s 2454 
264.6s 2455 Simulation finished at t = 60.0000 s after 231 steps.
264.6s 2456 Total runtime: 2.37 seconds.
264.6s 2457 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.35s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.35s/s]
264.6s 2458 [BC UPDATE] left → phase 1 GREEN (normal inflow)
264.6s 2459 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
264.6s 2460 Running simulation until t = 120.00 s, outputting every 60.00 s
264.6s 2461 
264.7s 2462 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
265.2s 2463 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
265.3s 2464 [WARNING] Automatic CFL correction applied (count: 13800):
265.3s 2465 Calculated CFL: 0.800 > Limit: 0.500
265.3s 2466 Original dt: 4.114984e-01 s
265.3s 2467 Corrected dt: 2.571865e-01 s
265.3s 2468 Correction factor: 1.6x
265.3s 2469 Max wave speed detected: 19.44 m/s
265.6s 2470 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
266.1s 2471 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
266.2s 2472 [WARNING] Automatic CFL correction applied (count: 13900):
266.2s 2473 Calculated CFL: 0.800 > Limit: 0.500
266.2s 2474 Original dt: 4.114980e-01 s
266.2s 2475 Corrected dt: 2.571863e-01 s
266.2s 2476 Correction factor: 1.6x
266.2s 2477 Max wave speed detected: 19.44 m/s
266.5s 2478 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
266.7s 2479 Stored output at t = 120.0000 s (Step 465)
266.7s 2480 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
266.7s 2481 [A
266.7s 2482 
266.7s 2483 Simulation finished at t = 120.0000 s after 465 steps.
266.7s 2484 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.75s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.75s/s]
266.7s 2485 Total runtime: 2.09 seconds.
266.7s 2486 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
266.7s 2487 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
266.7s 2488 Using device: gpu
266.7s 2489 DEBUG PARAMS: Reading K_m_kmh = 10.0
266.7s 2490 DEBUG PARAMS: Reading K_c_kmh = 15.0
266.7s 2491 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
266.7s 2492 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
266.7s 2493 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
266.7s 2494 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
266.7s 2495 Loading road quality type: uniform
266.7s 2496 Uniform road quality value: 2
266.7s 2497 Road quality loaded.
266.7s 2498 Initial state created.
266.7s 2499 Transferring initial state and road quality to GPU...
266.7s 2500 GPU data transfer complete.
266.7s 2501 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
266.7s 2502 Initial boundary conditions applied.
266.7s 2503 [BC UPDATE] left → phase 0 RED (reduced inflow)
266.7s 2504 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
266.7s 2505 [BC UPDATE] left → phase 0 RED (reduced inflow)
266.7s 2506 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
266.7s 2507 Running simulation until t = 60.00 s, outputting every 60.00 s
266.7s 2508 
267.1s 2509 [WARNING] Automatic CFL correction applied (count: 14000):
267.1s 2510 Calculated CFL: 0.800 > Limit: 0.500
267.1s 2511 Original dt: 4.396418e-01 s
267.1s 2512 Corrected dt: 2.747761e-01 s
267.1s 2513 Correction factor: 1.6x
267.1s 2514 Max wave speed detected: 18.20 m/s
267.1s 2515 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
267.6s 2516 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
268.0s 2517 [WARNING] Automatic CFL correction applied (count: 14100):
268.0s 2518 Calculated CFL: 0.800 > Limit: 0.500
268.0s 2519 Original dt: 4.118393e-01 s
268.0s 2520 Corrected dt: 2.573996e-01 s
268.0s 2521 Correction factor: 1.6x
268.0s 2522 Max wave speed detected: 19.43 m/s
268.0s 2523 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
268.4s 2524 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
268.7s 2525 Stored output at t = 60.0000 s (Step 231)
268.7s 2526 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
268.7s 2527 [A
268.7s 2528 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.43s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.43s/s]
268.7s 2529 
268.7s 2530 Simulation finished at t = 60.0000 s after 231 steps.
268.7s 2531 Total runtime: 2.04 seconds.
268.7s 2532 [BC UPDATE] left → phase 1 GREEN (normal inflow)
268.7s 2533 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
268.7s 2534 Running simulation until t = 120.00 s, outputting every 60.00 s
268.7s 2535 
268.9s 2536 [WARNING] Automatic CFL correction applied (count: 14200):
268.9s 2537 Calculated CFL: 0.800 > Limit: 0.500
268.9s 2538 Original dt: 4.115033e-01 s
268.9s 2539 Corrected dt: 2.571896e-01 s
268.9s 2540 Correction factor: 1.6x
268.9s 2541 Max wave speed detected: 19.44 m/s
268.9s 2542 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
269.3s 2543 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
269.8s 2544 [WARNING] Automatic CFL correction applied (count: 14300):
269.8s 2545 Calculated CFL: 0.800 > Limit: 0.500
269.8s 2546 Original dt: 4.114981e-01 s
269.8s 2547 Corrected dt: 2.571863e-01 s
269.8s 2548 Correction factor: 1.6x
269.8s 2549 Max wave speed detected: 19.44 m/s
269.8s 2550 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
270.2s 2551 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
270.7s 2552 [WARNING] Automatic CFL correction applied (count: 14400):
270.7s 2553 Calculated CFL: 0.800 > Limit: 0.500
270.7s 2554 Original dt: 4.114980e-01 s
270.7s 2555 Corrected dt: 2.571863e-01 s
270.7s 2556 Correction factor: 1.6x
270.7s 2557 Max wave speed detected: 19.44 m/s
270.7s 2558 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
270.8s 2559 Stored output at t = 120.0000 s (Step 465)
270.8s 2560 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
270.8s 2561 [A
270.8s 2562 
270.8s 2563 Simulation finished at t = 120.0000 s after 465 steps.
270.8s 2564 Total runtime: 2.12 seconds.
270.8s 2565 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.37s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.37s/s]
270.8s 2566 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
270.8s 2567 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
270.8s 2568 Using device: gpu
270.8s 2569 DEBUG PARAMS: Reading K_m_kmh = 10.0
270.8s 2570 DEBUG PARAMS: Reading K_c_kmh = 15.0
270.8s 2571 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
270.8s 2572 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
270.8s 2573 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
270.8s 2574 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
270.8s 2575 Loading road quality type: uniform
270.8s 2576 Uniform road quality value: 2
270.8s 2577 Road quality loaded.
270.8s 2578 Initial state created.
270.8s 2579 Transferring initial state and road quality to GPU...
270.8s 2580 GPU data transfer complete.
270.8s 2581 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
270.8s 2582 Initial boundary conditions applied.
270.8s 2583 [BC UPDATE] left → phase 0 RED (reduced inflow)
270.8s 2584 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
270.8s 2585 [BC UPDATE] left → phase 0 RED (reduced inflow)
270.8s 2586 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
270.8s 2587 Running simulation until t = 60.00 s, outputting every 60.00 s
270.8s 2588 
271.3s 2589 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
271.6s 2590 [WARNING] Automatic CFL correction applied (count: 14500):
271.6s 2591 Calculated CFL: 0.800 > Limit: 0.500
271.6s 2592 Original dt: 4.173029e-01 s
271.6s 2593 Corrected dt: 2.608143e-01 s
271.6s 2594 Correction factor: 1.6x
271.6s 2595 Max wave speed detected: 19.17 m/s
271.7s 2596 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
272.2s 2597 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
272.5s 2598 [WARNING] Automatic CFL correction applied (count: 14600):
272.5s 2599 Calculated CFL: 0.800 > Limit: 0.500
272.5s 2600 Original dt: 4.115760e-01 s
272.5s 2601 Corrected dt: 2.572350e-01 s
272.5s 2602 Correction factor: 1.6x
272.5s 2603 Max wave speed detected: 19.44 m/s
272.7s 2604 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
272.9s 2605 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
272.9s 2606 [A
272.9s 2607 Stored output at t = 60.0000 s (Step 231)
272.9s 2608 
272.9s 2609 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.63s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.63s/s]
272.9s 2610 Simulation finished at t = 60.0000 s after 231 steps.
272.9s 2611 Total runtime: 2.10 seconds.
272.9s 2612 [BC UPDATE] left → phase 1 GREEN (normal inflow)
272.9s 2613 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
272.9s 2614 Running simulation until t = 120.00 s, outputting every 60.00 s
272.9s 2615 
273.1s 2616 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
273.4s 2617 [WARNING] Automatic CFL correction applied (count: 14700):
273.4s 2618 Calculated CFL: 0.800 > Limit: 0.500
273.4s 2619 Original dt: 4.114993e-01 s
273.4s 2620 Corrected dt: 2.571871e-01 s
273.4s 2621 Correction factor: 1.6x
273.4s 2622 Max wave speed detected: 19.44 m/s
273.6s 2623 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
274.0s 2624 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
274.3s 2625 [WARNING] Automatic CFL correction applied (count: 14800):
274.3s 2626 Calculated CFL: 0.800 > Limit: 0.500
274.3s 2627 Original dt: 4.114981e-01 s
274.3s 2628 Corrected dt: 2.571863e-01 s
274.3s 2629 Correction factor: 1.6x
274.3s 2630 Max wave speed detected: 19.44 m/s
274.5s 2631 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
274.9s 2632 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
275.0s 2633 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
275.0s 2634 [A
275.0s 2635 Stored output at t = 120.0000 s (Step 465)
275.0s 2636 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.55s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.54s/s]
275.0s 2637 
275.0s 2638 Simulation finished at t = 120.0000 s after 465 steps.
275.0s 2639 Total runtime: 2.10 seconds.
275.0s 2640 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
275.0s 2641 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
275.0s 2642 Using device: gpu
275.1s 2643 DEBUG PARAMS: Reading K_m_kmh = 10.0
275.1s 2644 DEBUG PARAMS: Reading K_c_kmh = 15.0
275.1s 2645 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
275.1s 2646 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
275.1s 2647 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
275.1s 2648 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
275.1s 2649 Loading road quality type: uniform
275.1s 2650 Uniform road quality value: 2
275.1s 2651 Road quality loaded.
275.1s 2652 Initial state created.
275.1s 2653 Transferring initial state and road quality to GPU...
275.1s 2654 GPU data transfer complete.
275.1s 2655 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
275.1s 2656 Initial boundary conditions applied.
275.1s 2657 [BC UPDATE] left → phase 0 RED (reduced inflow)
275.1s 2658 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
275.1s 2659 [BC UPDATE] left → phase 0 RED (reduced inflow)
275.1s 2660 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
275.1s 2661 Running simulation until t = 60.00 s, outputting every 60.00 s
275.1s 2662 
275.2s 2663 [WARNING] Automatic CFL correction applied (count: 14900):
275.2s 2664 Calculated CFL: 0.800 > Limit: 0.500
275.2s 2665 Original dt: 4.295974e-01 s
275.2s 2666 Corrected dt: 2.684983e-01 s
275.2s 2667 Correction factor: 1.6x
275.2s 2668 Max wave speed detected: 18.62 m/s
275.5s 2669 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
276.0s 2670 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
276.1s 2671 [WARNING] Automatic CFL correction applied (count: 15000):
276.1s 2672 Calculated CFL: 0.800 > Limit: 0.500
276.1s 2673 Original dt: 4.127253e-01 s
276.1s 2674 Corrected dt: 2.579533e-01 s
276.1s 2675 Correction factor: 1.6x
276.1s 2676 Max wave speed detected: 19.38 m/s
276.4s 2677 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
276.9s 2678 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
277.0s 2679 [WARNING] Automatic CFL correction applied (count: 15100):
277.0s 2680 Calculated CFL: 0.800 > Limit: 0.500
277.0s 2681 Original dt: 4.115153e-01 s
277.0s 2682 Corrected dt: 2.571971e-01 s
277.0s 2683 Correction factor: 1.6x
277.0s 2684 Max wave speed detected: 19.44 m/s
277.1s 2685 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
277.1s 2686 [A
277.1s 2687 Stored output at t = 60.0000 s (Step 231)
277.2s 2688 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.68s/s]
277.2s 2689 
277.2s 2690 Simulation finished at t = 60.0000 s after 231 steps.
277.2s 2691 Total runtime: 2.09 seconds.
277.2s 2692 [BC UPDATE] left → phase 1 GREEN (normal inflow)
277.2s 2693 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
277.2s 2694 Running simulation until t = 120.00 s, outputting every 60.00 s
277.2s 2695 
277.3s 2696 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
277.8s 2697 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
278.0s 2698 [WARNING] Automatic CFL correction applied (count: 15200):
278.0s 2699 Calculated CFL: 0.800 > Limit: 0.500
278.0s 2700 Original dt: 4.114984e-01 s
278.0s 2701 Corrected dt: 2.571865e-01 s
278.0s 2702 Correction factor: 1.6x
278.0s 2703 Max wave speed detected: 19.44 m/s
278.2s 2704 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
278.7s 2705 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
278.9s 2706 [WARNING] Automatic CFL correction applied (count: 15300):
278.9s 2707 Calculated CFL: 0.800 > Limit: 0.500
278.9s 2708 Original dt: 4.114980e-01 s
278.9s 2709 Corrected dt: 2.571863e-01 s
278.9s 2710 Correction factor: 1.6x
278.9s 2711 Max wave speed detected: 19.44 m/s
279.1s 2712 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
279.3s 2713 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
279.3s 2714 [A
279.3s 2715 Stored output at t = 120.0000 s (Step 465)
279.3s 2716 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.33s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.33s/s]
279.3s 2717 
279.3s 2718 Simulation finished at t = 120.0000 s after 465 steps.
279.3s 2719 Total runtime: 2.12 seconds.
279.3s 2720 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
279.3s 2721 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
279.3s 2722 Using device: gpu
279.3s 2723 DEBUG PARAMS: Reading K_m_kmh = 10.0
279.3s 2724 DEBUG PARAMS: Reading K_c_kmh = 15.0
279.3s 2725 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
279.3s 2726 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
279.3s 2727 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
279.3s 2728 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
279.3s 2729 Loading road quality type: uniform
279.3s 2730 Uniform road quality value: 2
279.3s 2731 Road quality loaded.
279.3s 2732 Initial state created.
279.3s 2733 Transferring initial state and road quality to GPU...
279.3s 2734 GPU data transfer complete.
279.3s 2735 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
279.3s 2736 Initial boundary conditions applied.
279.3s 2737 [BC UPDATE] left → phase 0 RED (reduced inflow)
279.3s 2738 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
279.3s 2739 [BC UPDATE] left → phase 0 RED (reduced inflow)
279.3s 2740 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
279.3s 2741 Running simulation until t = 60.00 s, outputting every 60.00 s
279.3s 2742 
279.7s 2743 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
279.8s 2744 [WARNING] Automatic CFL correction applied (count: 15400):
279.8s 2745 Calculated CFL: 0.800 > Limit: 0.500
279.8s 2746 Original dt: 4.346596e-01 s
279.8s 2747 Corrected dt: 2.716622e-01 s
279.8s 2748 Correction factor: 1.6x
279.8s 2749 Max wave speed detected: 18.41 m/s
280.2s 2750 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
281.1s 2751 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
281.1s 2752 [WARNING] Automatic CFL correction applied (count: 15500):
281.1s 2753 Calculated CFL: 0.800 > Limit: 0.500
281.1s 2754 Original dt: 4.117853e-01 s
281.1s 2755 Corrected dt: 2.573658e-01 s
281.1s 2756 Correction factor: 1.6x
281.1s 2757 Max wave speed detected: 19.43 m/s
281.5s 2758 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
281.8s 2759 Stored output at t = 60.0000 s (Step 231)
281.8s 2760 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
281.8s 2761 [A
281.8s 2762 
281.8s 2763 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.85s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.85s/s]
281.8s 2764 Simulation finished at t = 60.0000 s after 231 steps.
281.8s 2765 Total runtime: 2.52 seconds.
281.8s 2766 [BC UPDATE] left → phase 1 GREEN (normal inflow)
281.8s 2767 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
281.8s 2768 Running simulation until t = 120.00 s, outputting every 60.00 s
281.8s 2769 
282.0s 2770 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
282.0s 2771 [WARNING] Automatic CFL correction applied (count: 15600):
282.0s 2772 Calculated CFL: 0.800 > Limit: 0.500
282.0s 2773 Original dt: 4.115023e-01 s
282.0s 2774 Corrected dt: 2.571890e-01 s
282.0s 2775 Correction factor: 1.6x
282.0s 2776 Max wave speed detected: 19.44 m/s
282.4s 2777 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
282.9s 2778 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
282.9s 2779 [WARNING] Automatic CFL correction applied (count: 15700):
282.9s 2780 Calculated CFL: 0.800 > Limit: 0.500
282.9s 2781 Original dt: 4.114981e-01 s
282.9s 2782 Corrected dt: 2.571863e-01 s
282.9s 2783 Correction factor: 1.6x
282.9s 2784 Max wave speed detected: 19.44 m/s
283.3s 2785 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
283.8s 2786 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
283.8s 2787 [WARNING] Automatic CFL correction applied (count: 15800):
283.8s 2788 Calculated CFL: 0.800 > Limit: 0.500
283.8s 2789 Original dt: 4.114980e-01 s
283.8s 2790 Corrected dt: 2.571863e-01 s
283.8s 2791 Correction factor: 1.6x
283.8s 2792 Max wave speed detected: 19.44 m/s
283.9s 2793 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
283.9s 2794 [A
283.9s 2795 Stored output at t = 120.0000 s (Step 465)
283.9s 2796 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.46s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.46s/s]
283.9s 2797 
283.9s 2798 Simulation finished at t = 120.0000 s after 465 steps.
283.9s 2799 Total runtime: 2.11 seconds.
283.9s 2800 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
283.9s 2801 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
283.9s 2802 Using device: gpu
283.9s 2803 DEBUG PARAMS: Reading K_m_kmh = 10.0
283.9s 2804 DEBUG PARAMS: Reading K_c_kmh = 15.0
283.9s 2805 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
283.9s 2806 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
283.9s 2807 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
283.9s 2808 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
283.9s 2809 Loading road quality type: uniform
283.9s 2810 Uniform road quality value: 2
283.9s 2811 Road quality loaded.
283.9s 2812 Initial state created.
283.9s 2813 Transferring initial state and road quality to GPU...
283.9s 2814 GPU data transfer complete.
283.9s 2815 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
283.9s 2816 Initial boundary conditions applied.
283.9s 2817 [BC UPDATE] left → phase 0 RED (reduced inflow)
283.9s 2818 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
283.9s 2819 [BC UPDATE] left → phase 1 GREEN (normal inflow)
283.9s 2820 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
283.9s 2821 Running simulation until t = 60.00 s, outputting every 60.00 s
283.9s 2822 
284.4s 2823 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
284.7s 2824 [WARNING] Automatic CFL correction applied (count: 15900):
284.7s 2825 Calculated CFL: 0.800 > Limit: 0.500
284.7s 2826 Original dt: 4.160552e-01 s
284.7s 2827 Corrected dt: 2.600345e-01 s
284.7s 2828 Correction factor: 1.6x
284.7s 2829 Max wave speed detected: 19.23 m/s
284.8s 2830 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
285.3s 2831 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
285.6s 2832 [WARNING] Automatic CFL correction applied (count: 16000):
285.6s 2833 Calculated CFL: 0.800 > Limit: 0.500
285.6s 2834 Original dt: 4.115592e-01 s
285.6s 2835 Corrected dt: 2.572245e-01 s
285.6s 2836 Correction factor: 1.6x
285.6s 2837 Max wave speed detected: 19.44 m/s
285.7s 2838 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
286.0s 2839 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
286.0s 2840 [A
286.0s 2841 Stored output at t = 60.0000 s (Step 231)
286.0s 2842 
286.0s 2843 Simulation finished at t = 60.0000 s after 231 steps.
286.0s 2844 Total runtime: 2.06 seconds.
286.0s 2845 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.18s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.18s/s]
286.0s 2846 [BC UPDATE] left → phase 0 RED (reduced inflow)
286.0s 2847 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
286.0s 2848 Running simulation until t = 120.00 s, outputting every 60.00 s
286.0s 2849 
286.2s 2850 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
286.5s 2851 [WARNING] Automatic CFL correction applied (count: 16100):
286.5s 2852 Calculated CFL: 0.800 > Limit: 0.500
286.5s 2853 Original dt: 4.114991e-01 s
286.5s 2854 Corrected dt: 2.571870e-01 s
286.5s 2855 Correction factor: 1.6x
286.5s 2856 Max wave speed detected: 19.44 m/s
286.6s 2857 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
287.0s 2858 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
287.4s 2859 [WARNING] Automatic CFL correction applied (count: 16200):
287.4s 2860 Calculated CFL: 0.800 > Limit: 0.500
287.4s 2861 Original dt: 4.114980e-01 s
287.4s 2862 Corrected dt: 2.571863e-01 s
287.4s 2863 Correction factor: 1.6x
287.4s 2864 Max wave speed detected: 19.44 m/s
287.5s 2865 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
287.9s 2866 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
288.1s 2867 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
288.1s 2868 [A
288.1s 2869 Stored output at t = 120.0000 s (Step 465)
288.1s 2870 
288.1s 2871 Simulation finished at t = 120.0000 s after 465 steps.
288.1s 2872 Total runtime: 2.08 seconds.
288.1s 2873 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.79s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.79s/s]
288.1s 2874 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
288.1s 2875 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
288.1s 2876 Using device: gpu
288.1s 2877 DEBUG PARAMS: Reading K_m_kmh = 10.0
288.1s 2878 DEBUG PARAMS: Reading K_c_kmh = 15.0
288.1s 2879 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
288.1s 2880 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
288.1s 2881 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
288.1s 2882 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
288.1s 2883 Loading road quality type: uniform
288.1s 2884 Uniform road quality value: 2
288.1s 2885 Road quality loaded.
288.1s 2886 Initial state created.
288.1s 2887 Transferring initial state and road quality to GPU...
288.1s 2888 GPU data transfer complete.
288.1s 2889 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
288.1s 2890 Initial boundary conditions applied.
288.1s 2891 [BC UPDATE] left → phase 0 RED (reduced inflow)
288.1s 2892 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
288.1s 2893 [BC UPDATE] left → phase 1 GREEN (normal inflow)
288.1s 2894 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
288.1s 2895 Running simulation until t = 60.00 s, outputting every 60.00 s
288.1s 2896 
288.3s 2897 [WARNING] Automatic CFL correction applied (count: 16300):
288.3s 2898 Calculated CFL: 0.800 > Limit: 0.500
288.3s 2899 Original dt: 4.547467e-01 s
288.3s 2900 Corrected dt: 2.842167e-01 s
288.3s 2901 Correction factor: 1.6x
288.3s 2902 Max wave speed detected: 17.59 m/s
288.5s 2903 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
289.0s 2904 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
289.2s 2905 [WARNING] Automatic CFL correction applied (count: 16400):
289.2s 2906 Calculated CFL: 0.800 > Limit: 0.500
289.2s 2907 Original dt: 4.125079e-01 s
289.2s 2908 Corrected dt: 2.578175e-01 s
289.2s 2909 Correction factor: 1.6x
289.2s 2910 Max wave speed detected: 19.39 m/s
289.4s 2911 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
289.9s 2912 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
290.1s 2913 [WARNING] Automatic CFL correction applied (count: 16500):
290.1s 2914 Calculated CFL: 0.800 > Limit: 0.500
290.1s 2915 Original dt: 4.115121e-01 s
290.1s 2916 Corrected dt: 2.571950e-01 s
290.1s 2917 Correction factor: 1.6x
290.1s 2918 Max wave speed detected: 19.44 m/s
290.1s 2919 Stored output at t = 60.0000 s (Step 231)
290.1s 2920 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
290.1s 2921 [A
290.1s 2922 
290.1s 2923 Simulation finished at t = 60.0000 s after 231 steps.
290.1s 2924 Total runtime: 2.06 seconds.
290.1s 2925 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.14s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.14s/s]
290.1s 2926 [BC UPDATE] left → phase 0 RED (reduced inflow)
290.1s 2927 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
290.1s 2928 Running simulation until t = 120.00 s, outputting every 60.00 s
290.1s 2929 
290.3s 2930 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
290.8s 2931 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
291.0s 2932 [WARNING] Automatic CFL correction applied (count: 16600):
291.0s 2933 Calculated CFL: 0.800 > Limit: 0.500
291.0s 2934 Original dt: 4.114983e-01 s
291.0s 2935 Corrected dt: 2.571865e-01 s
291.0s 2936 Correction factor: 1.6x
291.0s 2937 Max wave speed detected: 19.44 m/s
291.2s 2938 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
291.7s 2939 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
292.0s 2940 [WARNING] Automatic CFL correction applied (count: 16700):
292.0s 2941 Calculated CFL: 0.800 > Limit: 0.500
292.0s 2942 Original dt: 4.114980e-01 s
292.0s 2943 Corrected dt: 2.571863e-01 s
292.0s 2944 Correction factor: 1.6x
292.0s 2945 Max wave speed detected: 19.44 m/s
292.2s 2946 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
292.4s 2947 Stored output at t = 120.0000 s (Step 465)
292.4s 2948 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
292.4s 2949 [A
292.4s 2950 
292.4s 2951 Simulation finished at t = 120.0000 s after 465 steps.
292.4s 2952 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s]
292.4s 2953 Total runtime: 2.21 seconds.
292.4s 2954 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
292.4s 2955 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
292.4s 2956 Using device: gpu
292.4s 2957 DEBUG PARAMS: Reading K_m_kmh = 10.0
292.4s 2958 DEBUG PARAMS: Reading K_c_kmh = 15.0
292.4s 2959 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
292.4s 2960 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
292.4s 2961 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
292.4s 2962 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
292.4s 2963 Loading road quality type: uniform
292.4s 2964 Uniform road quality value: 2
292.4s 2965 Road quality loaded.
292.4s 2966 Initial state created.
292.4s 2967 Transferring initial state and road quality to GPU...
292.4s 2968 GPU data transfer complete.
292.4s 2969 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
292.4s 2970 Initial boundary conditions applied.
292.4s 2971 [BC UPDATE] left → phase 0 RED (reduced inflow)
292.4s 2972 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
292.4s 2973 [BC UPDATE] left → phase 1 GREEN (normal inflow)
292.4s 2974 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
292.4s 2975 Running simulation until t = 60.00 s, outputting every 60.00 s
292.4s 2976 
292.8s 2977 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
292.9s 2978 [WARNING] Automatic CFL correction applied (count: 16800):
292.9s 2979 Calculated CFL: 0.800 > Limit: 0.500
292.9s 2980 Original dt: 4.295897e-01 s
292.9s 2981 Corrected dt: 2.684936e-01 s
292.9s 2982 Correction factor: 1.6x
292.9s 2983 Max wave speed detected: 18.62 m/s
293.3s 2984 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
293.7s 2985 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
293.8s 2986 [WARNING] Automatic CFL correction applied (count: 16900):
293.8s 2987 Calculated CFL: 0.800 > Limit: 0.500
293.8s 2988 Original dt: 4.117215e-01 s
293.8s 2989 Corrected dt: 2.573259e-01 s
293.8s 2990 Correction factor: 1.6x
293.8s 2991 Max wave speed detected: 19.43 m/s
294.1s 2992 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
294.4s 2993 Stored output at t = 60.0000 s (Step 231)
294.4s 2994 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
294.4s 2995 [A
294.4s 2996 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.32s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.32s/s]
294.4s 2997 
294.4s 2998 Simulation finished at t = 60.0000 s after 231 steps.
294.4s 2999 Total runtime: 2.05 seconds.
294.4s 3000 [BC UPDATE] left → phase 0 RED (reduced inflow)
294.4s 3001 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
294.4s 3002 Running simulation until t = 120.00 s, outputting every 60.00 s
294.4s 3003 
294.6s 3004 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
294.7s 3005 [WARNING] Automatic CFL correction applied (count: 17000):
294.7s 3006 Calculated CFL: 0.800 > Limit: 0.500
294.7s 3007 Original dt: 4.115016e-01 s
294.7s 3008 Corrected dt: 2.571885e-01 s
294.7s 3009 Correction factor: 1.6x
294.7s 3010 Max wave speed detected: 19.44 m/s
295.0s 3011 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
295.5s 3012 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
295.6s 3013 [WARNING] Automatic CFL correction applied (count: 17100):
295.6s 3014 Calculated CFL: 0.800 > Limit: 0.500
295.6s 3015 Original dt: 4.114981e-01 s
295.6s 3016 Corrected dt: 2.571863e-01 s
295.6s 3017 Correction factor: 1.6x
295.6s 3018 Max wave speed detected: 19.44 m/s
295.9s 3019 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
296.4s 3020 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
296.4s 3021 [WARNING] Automatic CFL correction applied (count: 17200):
296.4s 3022 Calculated CFL: 0.800 > Limit: 0.500
296.4s 3023 Original dt: 4.114980e-01 s
296.4s 3024 Corrected dt: 2.571863e-01 s
296.4s 3025 Correction factor: 1.6x
296.4s 3026 Max wave speed detected: 19.44 m/s
296.5s 3027 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
296.5s 3028 [A
296.5s 3029 Stored output at t = 120.0000 s (Step 465)
296.5s 3030 
296.5s 3031 Simulation finished at t = 120.0000 s after 465 steps.
296.5s 3032 Total runtime: 2.06 seconds.
296.5s 3033 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.08s/s]
296.5s 3034 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
296.5s 3035 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
296.5s 3036 Using device: gpu
296.5s 3037 DEBUG PARAMS: Reading K_m_kmh = 10.0
296.5s 3038 DEBUG PARAMS: Reading K_c_kmh = 15.0
296.5s 3039 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
296.5s 3040 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
296.5s 3041 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
296.5s 3042 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
296.5s 3043 Loading road quality type: uniform
296.5s 3044 Uniform road quality value: 2
296.5s 3045 Road quality loaded.
296.5s 3046 Initial state created.
296.5s 3047 Transferring initial state and road quality to GPU...
296.5s 3048 GPU data transfer complete.
296.5s 3049 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
296.5s 3050 Initial boundary conditions applied.
296.5s 3051 [BC UPDATE] left → phase 0 RED (reduced inflow)
296.5s 3052 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
296.5s 3053 [BC UPDATE] left → phase 1 GREEN (normal inflow)
296.5s 3054 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
296.5s 3055 Running simulation until t = 60.00 s, outputting every 60.00 s
296.5s 3056 
297.0s 3057 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
297.4s 3058 [WARNING] Automatic CFL correction applied (count: 17300):
297.4s 3059 Calculated CFL: 0.800 > Limit: 0.500
297.4s 3060 Original dt: 4.151534e-01 s
297.4s 3061 Corrected dt: 2.594709e-01 s
297.4s 3062 Correction factor: 1.6x
297.4s 3063 Max wave speed detected: 19.27 m/s
297.4s 3064 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
297.9s 3065 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
298.3s 3066 [WARNING] Automatic CFL correction applied (count: 17400):
298.3s 3067 Calculated CFL: 0.800 > Limit: 0.500
298.3s 3068 Original dt: 4.115470e-01 s
298.3s 3069 Corrected dt: 2.572169e-01 s
298.3s 3070 Correction factor: 1.6x
298.3s 3071 Max wave speed detected: 19.44 m/s
298.3s 3072 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
298.6s 3073 Stored output at t = 60.0000 s (Step 231)
298.6s 3074 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
298.6s 3075 [A
298.6s 3076 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.82s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.82s/s]
298.6s 3077 
298.6s 3078 Simulation finished at t = 60.0000 s after 231 steps.
298.6s 3079 Total runtime: 2.08 seconds.
298.6s 3080 [BC UPDATE] left → phase 1 GREEN (normal inflow)
298.6s 3081 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
298.6s 3082 Running simulation until t = 120.00 s, outputting every 60.00 s
298.6s 3083 
298.8s 3084 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
299.1s 3085 [WARNING] Automatic CFL correction applied (count: 17500):
299.1s 3086 Calculated CFL: 0.800 > Limit: 0.500
299.1s 3087 Original dt: 4.114990e-01 s
299.1s 3088 Corrected dt: 2.571869e-01 s
299.1s 3089 Correction factor: 1.6x
299.1s 3090 Max wave speed detected: 19.44 m/s
299.2s 3091 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
299.6s 3092 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
300.0s 3093 [WARNING] Automatic CFL correction applied (count: 17600):
300.0s 3094 Calculated CFL: 0.800 > Limit: 0.500
300.0s 3095 Original dt: 4.114980e-01 s
300.0s 3096 Corrected dt: 2.571863e-01 s
300.0s 3097 Correction factor: 1.6x
300.0s 3098 Max wave speed detected: 19.44 m/s
300.1s 3099 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
300.5s 3100 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
300.7s 3101 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
300.7s 3102 [A
300.7s 3103 Stored output at t = 120.0000 s (Step 465)
300.7s 3104 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.98s/s]
300.7s 3105 
300.7s 3106 Simulation finished at t = 120.0000 s after 465 steps.
300.7s 3107 Total runtime: 2.07 seconds.
300.7s 3108 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
300.7s 3109 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
300.7s 3110 Using device: gpu
300.7s 3111 DEBUG PARAMS: Reading K_m_kmh = 10.0
300.7s 3112 DEBUG PARAMS: Reading K_c_kmh = 15.0
300.7s 3113 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
300.7s 3114 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
300.7s 3115 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
300.7s 3116 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
300.7s 3117 Loading road quality type: uniform
300.7s 3118 Uniform road quality value: 2
300.7s 3119 Road quality loaded.
300.7s 3120 Initial state created.
300.7s 3121 Transferring initial state and road quality to GPU...
300.7s 3122 GPU data transfer complete.
300.7s 3123 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
300.7s 3124 Initial boundary conditions applied.
300.7s 3125 [BC UPDATE] left → phase 0 RED (reduced inflow)
300.7s 3126 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
300.7s 3127 [BC UPDATE] left → phase 0 RED (reduced inflow)
300.7s 3128 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
300.7s 3129 Running simulation until t = 60.00 s, outputting every 60.00 s
300.7s 3130 
300.9s 3131 [WARNING] Automatic CFL correction applied (count: 17700):
300.9s 3132 Calculated CFL: 0.800 > Limit: 0.500
300.9s 3133 Original dt: 4.768783e-01 s
300.9s 3134 Corrected dt: 2.980490e-01 s
300.9s 3135 Correction factor: 1.6x
300.9s 3136 Max wave speed detected: 16.78 m/s
301.1s 3137 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
301.6s 3138 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
301.8s 3139 [WARNING] Automatic CFL correction applied (count: 17800):
301.8s 3140 Calculated CFL: 0.800 > Limit: 0.500
301.8s 3141 Original dt: 4.123385e-01 s
301.8s 3142 Corrected dt: 2.577116e-01 s
301.8s 3143 Correction factor: 1.6x
301.8s 3144 Max wave speed detected: 19.40 m/s
302.0s 3145 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
302.5s 3146 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
302.7s 3147 [WARNING] Automatic CFL correction applied (count: 17900):
302.7s 3148 Calculated CFL: 0.800 > Limit: 0.500
302.7s 3149 Original dt: 4.115097e-01 s
302.7s 3150 Corrected dt: 2.571935e-01 s
302.7s 3151 Correction factor: 1.6x
302.7s 3152 Max wave speed detected: 19.44 m/s
302.7s 3153 Stored output at t = 60.0000 s (Step 231)
302.7s 3154 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
302.7s 3155 [A
302.7s 3156 
302.7s 3157 Simulation finished at t = 60.0000 s after 231 steps.
302.7s 3158 Total runtime: 2.06 seconds.
302.7s 3159 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.07s/s]
302.7s 3160 [BC UPDATE] left → phase 0 RED (reduced inflow)
302.7s 3161 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
302.7s 3162 Running simulation until t = 120.00 s, outputting every 60.00 s
302.7s 3163 
302.9s 3164 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
303.4s 3165 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
303.6s 3166 [WARNING] Automatic CFL correction applied (count: 18000):
303.6s 3167 Calculated CFL: 0.800 > Limit: 0.500
303.6s 3168 Original dt: 4.114983e-01 s
303.6s 3169 Corrected dt: 2.571864e-01 s
303.6s 3170 Correction factor: 1.6x
303.6s 3171 Max wave speed detected: 19.44 m/s
303.8s 3172 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
304.2s 3173 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
304.5s 3174 [WARNING] Automatic CFL correction applied (count: 18100):
304.5s 3175 Calculated CFL: 0.800 > Limit: 0.500
304.5s 3176 Original dt: 4.114980e-01 s
304.5s 3177 Corrected dt: 2.571863e-01 s
304.5s 3178 Correction factor: 1.6x
304.5s 3179 Max wave speed detected: 19.44 m/s
304.7s 3180 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
304.8s 3181 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
304.8s 3182 [A
304.8s 3183 Stored output at t = 120.0000 s (Step 465)
304.8s 3184 
304.8s 3185 Simulation finished at t = 120.0000 s after 465 steps.
304.8s 3186 Total runtime: 2.08 seconds.
304.8s 3187 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.87s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.87s/s]
304.8s 3188 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
304.8s 3189 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
304.8s 3190 Using device: gpu
304.8s 3191 DEBUG PARAMS: Reading K_m_kmh = 10.0
304.8s 3192 DEBUG PARAMS: Reading K_c_kmh = 15.0
304.8s 3193 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
304.8s 3194 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
304.8s 3195 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
304.8s 3196 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
304.8s 3197 Loading road quality type: uniform
304.8s 3198 Uniform road quality value: 2
304.8s 3199 Road quality loaded.
304.8s 3200 Initial state created.
304.8s 3201 Transferring initial state and road quality to GPU...
304.8s 3202 GPU data transfer complete.
304.8s 3203 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
304.8s 3204 Initial boundary conditions applied.
304.8s 3205 [BC UPDATE] left → phase 0 RED (reduced inflow)
304.8s 3206 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
304.8s 3207 [BC UPDATE] left → phase 1 GREEN (normal inflow)
304.8s 3208 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
304.8s 3209 Running simulation until t = 60.00 s, outputting every 60.00 s
304.8s 3210 
305.3s 3211 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
305.4s 3212 [WARNING] Automatic CFL correction applied (count: 18200):
305.4s 3213 Calculated CFL: 0.800 > Limit: 0.500
305.4s 3214 Original dt: 4.254608e-01 s
305.4s 3215 Corrected dt: 2.659130e-01 s
305.4s 3216 Correction factor: 1.6x
305.4s 3217 Max wave speed detected: 18.80 m/s
305.7s 3218 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
306.2s 3219 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
306.3s 3220 [WARNING] Automatic CFL correction applied (count: 18300):
306.3s 3221 Calculated CFL: 0.800 > Limit: 0.500
306.3s 3222 Original dt: 4.116742e-01 s
306.3s 3223 Corrected dt: 2.572964e-01 s
306.3s 3224 Correction factor: 1.6x
306.3s 3225 Max wave speed detected: 19.43 m/s
306.6s 3226 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
306.9s 3227 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
306.9s 3228 [A
306.9s 3229 Stored output at t = 60.0000 s (Step 231)
306.9s 3230 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.19s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.19s/s]
306.9s 3231 
306.9s 3232 Simulation finished at t = 60.0000 s after 231 steps.
306.9s 3233 Total runtime: 2.06 seconds.
306.9s 3234 [BC UPDATE] left → phase 1 GREEN (normal inflow)
306.9s 3235 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
306.9s 3236 Running simulation until t = 120.00 s, outputting every 60.00 s
306.9s 3237 
307.1s 3238 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
307.2s 3239 [WARNING] Automatic CFL correction applied (count: 18400):
307.2s 3240 Calculated CFL: 0.800 > Limit: 0.500
307.2s 3241 Original dt: 4.115011e-01 s
307.2s 3242 Corrected dt: 2.571882e-01 s
307.2s 3243 Correction factor: 1.6x
307.2s 3244 Max wave speed detected: 19.44 m/s
307.5s 3245 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
308.0s 3246 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
308.1s 3247 [WARNING] Automatic CFL correction applied (count: 18500):
308.1s 3248 Calculated CFL: 0.800 > Limit: 0.500
308.1s 3249 Original dt: 4.114981e-01 s
308.1s 3250 Corrected dt: 2.571863e-01 s
308.1s 3251 Correction factor: 1.6x
308.1s 3252 Max wave speed detected: 19.44 m/s
308.4s 3253 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
308.9s 3254 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
309.0s 3255 [WARNING] Automatic CFL correction applied (count: 18600):
309.0s 3256 Calculated CFL: 0.800 > Limit: 0.500
309.0s 3257 Original dt: 4.114980e-01 s
309.0s 3258 Corrected dt: 2.571863e-01 s
309.0s 3259 Correction factor: 1.6x
309.0s 3260 Max wave speed detected: 19.44 m/s
309.0s 3261 Stored output at t = 120.0000 s (Step 465)
309.0s 3262 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
309.0s 3263 [A
309.0s 3264 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.68s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.67s/s]
309.0s 3265 
309.0s 3266 Simulation finished at t = 120.0000 s after 465 steps.
309.0s 3267 Total runtime: 2.09 seconds.
309.0s 3268 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
309.0s 3269 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
309.0s 3270 Using device: gpu
309.0s 3271 DEBUG PARAMS: Reading K_m_kmh = 10.0
309.0s 3272 DEBUG PARAMS: Reading K_c_kmh = 15.0
309.0s 3273 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
309.0s 3274 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
309.0s 3275 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
309.0s 3276 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
309.0s 3277 Loading road quality type: uniform
309.0s 3278 Uniform road quality value: 2
309.0s 3279 Road quality loaded.
309.0s 3280 Initial state created.
309.0s 3281 Transferring initial state and road quality to GPU...
309.0s 3282 GPU data transfer complete.
309.0s 3283 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
309.0s 3284 Initial boundary conditions applied.
309.0s 3285 [BC UPDATE] left → phase 0 RED (reduced inflow)
309.0s 3286 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
309.0s 3287 [BC UPDATE] left → phase 1 GREEN (normal inflow)
309.0s 3288 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
309.0s 3289 Running simulation until t = 60.00 s, outputting every 60.00 s
309.0s 3290 
309.5s 3291 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
309.9s 3292 [WARNING] Automatic CFL correction applied (count: 18700):
309.9s 3293 Calculated CFL: 0.800 > Limit: 0.500
309.9s 3294 Original dt: 4.145004e-01 s
309.9s 3295 Corrected dt: 2.590627e-01 s
309.9s 3296 Correction factor: 1.6x
309.9s 3297 Max wave speed detected: 19.30 m/s
309.9s 3298 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
310.4s 3299 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
310.8s 3300 [WARNING] Automatic CFL correction applied (count: 18800):
310.8s 3301 Calculated CFL: 0.800 > Limit: 0.500
310.8s 3302 Original dt: 4.115380e-01 s
310.8s 3303 Corrected dt: 2.572113e-01 s
310.8s 3304 Correction factor: 1.6x
310.8s 3305 Max wave speed detected: 19.44 m/s
310.8s 3306 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
311.1s 3307 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
311.1s 3308 [A
311.1s 3309 Stored output at t = 60.0000 s (Step 231)
311.1s 3310 
311.1s 3311 Simulation finished at t = 60.0000 s after 231 steps.
311.1s 3312 Total runtime: 2.12 seconds.
311.1s 3313 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.33s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.33s/s]
311.1s 3314 [BC UPDATE] left → phase 1 GREEN (normal inflow)
311.1s 3315 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
311.1s 3316 Running simulation until t = 120.00 s, outputting every 60.00 s
311.1s 3317 
311.3s 3318 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
311.7s 3319 [WARNING] Automatic CFL correction applied (count: 18900):
311.7s 3320 Calculated CFL: 0.800 > Limit: 0.500
311.7s 3321 Original dt: 4.114988e-01 s
311.7s 3322 Corrected dt: 2.571867e-01 s
311.7s 3323 Correction factor: 1.6x
311.7s 3324 Max wave speed detected: 19.44 m/s
311.7s 3325 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
312.2s 3326 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
312.7s 3327 [WARNING] Automatic CFL correction applied (count: 19000):
312.7s 3328 Calculated CFL: 0.800 > Limit: 0.500
312.7s 3329 Original dt: 4.114980e-01 s
312.7s 3330 Corrected dt: 2.571863e-01 s
312.7s 3331 Correction factor: 1.6x
312.7s 3332 Max wave speed detected: 19.44 m/s
312.7s 3333 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
313.2s 3334 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
313.3s 3335 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
313.3s 3336 [A
313.3s 3337 Stored output at t = 120.0000 s (Step 465)
313.3s 3338 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.68s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.68s/s]
313.3s 3339 
313.3s 3340 Simulation finished at t = 120.0000 s after 465 steps.
313.3s 3341 Total runtime: 2.17 seconds.
313.3s 3342 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
313.3s 3343 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
313.3s 3344 Using device: gpu
313.3s 3345 DEBUG PARAMS: Reading K_m_kmh = 10.0
313.3s 3346 DEBUG PARAMS: Reading K_c_kmh = 15.0
313.3s 3347 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
313.3s 3348 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
313.3s 3349 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
313.3s 3350 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
313.3s 3351 Loading road quality type: uniform
313.3s 3352 Uniform road quality value: 2
313.3s 3353 Road quality loaded.
313.3s 3354 Initial state created.
313.3s 3355 Transferring initial state and road quality to GPU...
313.3s 3356 GPU data transfer complete.
313.3s 3357 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
313.3s 3358 Initial boundary conditions applied.
313.3s 3359 [BC UPDATE] left → phase 0 RED (reduced inflow)
313.3s 3360 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
313.3s 3361 [BC UPDATE] left → phase 1 GREEN (normal inflow)
313.3s 3362 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
313.3s 3363 Running simulation until t = 60.00 s, outputting every 60.00 s
313.3s 3364 
313.6s 3365 [WARNING] Automatic CFL correction applied (count: 19100):
313.6s 3366 Calculated CFL: 0.800 > Limit: 0.500
313.6s 3367 Original dt: 4.758816e-01 s
313.6s 3368 Corrected dt: 2.974260e-01 s
313.6s 3369 Correction factor: 1.6x
313.6s 3370 Max wave speed detected: 16.81 m/s
313.8s 3371 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
314.2s 3372 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
314.5s 3373 [WARNING] Automatic CFL correction applied (count: 19200):
314.5s 3374 Calculated CFL: 0.800 > Limit: 0.500
314.5s 3375 Original dt: 4.121510e-01 s
314.5s 3376 Corrected dt: 2.575944e-01 s
314.5s 3377 Correction factor: 1.6x
314.5s 3378 Max wave speed detected: 19.41 m/s
314.7s 3379 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
315.1s 3380 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
315.4s 3381 Stored output at t = 60.0000 s (Step 231)
315.4s 3382 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
315.4s 3383 [A
315.4s 3384 
315.4s 3385 Simulation finished at t = 60.0000 s after 231 steps.
315.4s 3386 Total runtime: 2.12 seconds.
315.4s 3387 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.29s/s]
315.4s 3388 [BC UPDATE] left → phase 0 RED (reduced inflow)
315.4s 3389 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
315.4s 3390 Running simulation until t = 120.00 s, outputting every 60.00 s
315.4s 3391 
315.5s 3392 [WARNING] Automatic CFL correction applied (count: 19300):
315.5s 3393 Calculated CFL: 0.800 > Limit: 0.500
315.5s 3394 Original dt: 4.115082e-01 s
315.5s 3395 Corrected dt: 2.571926e-01 s
315.5s 3396 Correction factor: 1.6x
315.5s 3397 Max wave speed detected: 19.44 m/s
315.6s 3398 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
316.1s 3399 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
316.4s 3400 [WARNING] Automatic CFL correction applied (count: 19400):
316.4s 3401 Calculated CFL: 0.800 > Limit: 0.500
316.4s 3402 Original dt: 4.114982e-01 s
316.4s 3403 Corrected dt: 2.571864e-01 s
316.4s 3404 Correction factor: 1.6x
316.4s 3405 Max wave speed detected: 19.44 m/s
316.5s 3406 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
317.0s 3407 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
317.3s 3408 [WARNING] Automatic CFL correction applied (count: 19500):
317.3s 3409 Calculated CFL: 0.800 > Limit: 0.500
317.3s 3410 Original dt: 4.114980e-01 s
317.3s 3411 Corrected dt: 2.571863e-01 s
317.3s 3412 Correction factor: 1.6x
317.3s 3413 Max wave speed detected: 19.44 m/s
317.4s 3414 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
317.6s 3415 Stored output at t = 120.0000 s (Step 465)
317.6s 3416 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
317.6s 3417 [A
317.6s 3418 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.27s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.26s/s]
317.6s 3419 
317.6s 3420 Simulation finished at t = 120.0000 s after 465 steps.
317.6s 3421 Total runtime: 2.12 seconds.
317.6s 3422 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
317.6s 3423 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
317.6s 3424 Using device: gpu
317.6s 3425 DEBUG PARAMS: Reading K_m_kmh = 10.0
317.6s 3426 DEBUG PARAMS: Reading K_c_kmh = 15.0
317.6s 3427 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
317.6s 3428 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
317.6s 3429 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
317.6s 3430 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
317.6s 3431 Loading road quality type: uniform
317.6s 3432 Uniform road quality value: 2
317.6s 3433 Road quality loaded.
317.6s 3434 Initial state created.
317.6s 3435 Transferring initial state and road quality to GPU...
317.6s 3436 GPU data transfer complete.
317.6s 3437 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
317.6s 3438 Initial boundary conditions applied.
317.6s 3439 [BC UPDATE] left → phase 0 RED (reduced inflow)
317.6s 3440 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
317.6s 3441 [BC UPDATE] left → phase 0 RED (reduced inflow)
317.6s 3442 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
317.6s 3443 Running simulation until t = 60.00 s, outputting every 60.00 s
317.6s 3444 
318.0s 3445 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
318.2s 3446 [WARNING] Automatic CFL correction applied (count: 19600):
318.2s 3447 Calculated CFL: 0.800 > Limit: 0.500
318.2s 3448 Original dt: 4.225636e-01 s
318.2s 3449 Corrected dt: 2.641023e-01 s
318.2s 3450 Correction factor: 1.6x
318.2s 3451 Max wave speed detected: 18.93 m/s
318.5s 3452 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
318.9s 3453 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
319.1s 3454 [WARNING] Automatic CFL correction applied (count: 19700):
319.1s 3455 Calculated CFL: 0.800 > Limit: 0.500
319.1s 3456 Original dt: 4.116395e-01 s
319.1s 3457 Corrected dt: 2.572747e-01 s
319.1s 3458 Correction factor: 1.6x
319.1s 3459 Max wave speed detected: 19.43 m/s
319.4s 3460 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
319.7s 3461 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
319.7s 3462 [A
319.7s 3463 Stored output at t = 60.0000 s (Step 231)
319.7s 3464 
319.7s 3465 Simulation finished at t = 60.0000 s after 231 steps.
319.7s 3466 Total runtime: 2.13 seconds.
319.7s 3467 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.14s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.14s/s]
319.7s 3468 [BC UPDATE] left → phase 1 GREEN (normal inflow)
319.7s 3469 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
319.7s 3470 Running simulation until t = 120.00 s, outputting every 60.00 s
319.7s 3471 
319.9s 3472 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
320.1s 3473 [WARNING] Automatic CFL correction applied (count: 19800):
320.1s 3474 Calculated CFL: 0.800 > Limit: 0.500
320.1s 3475 Original dt: 4.115005e-01 s
320.1s 3476 Corrected dt: 2.571878e-01 s
320.1s 3477 Correction factor: 1.6x
320.1s 3478 Max wave speed detected: 19.44 m/s
320.3s 3479 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
320.8s 3480 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
321.0s 3481 [WARNING] Automatic CFL correction applied (count: 19900):
321.0s 3482 Calculated CFL: 0.800 > Limit: 0.500
321.0s 3483 Original dt: 4.114981e-01 s
321.0s 3484 Corrected dt: 2.571863e-01 s
321.0s 3485 Correction factor: 1.6x
321.0s 3486 Max wave speed detected: 19.44 m/s
321.3s 3487 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
321.7s 3488 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
321.8s 3489 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
321.8s 3490 [A
321.8s 3491 Stored output at t = 120.0000 s (Step 465)
321.8s 3492 
321.8s 3493 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.07s/s]
321.8s 3494 Simulation finished at t = 120.0000 s after 465 steps.
321.8s 3495 Total runtime: 2.14 seconds.
321.8s 3496 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
321.8s 3497 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
321.8s 3498 Using device: gpu
321.9s 3499 DEBUG PARAMS: Reading K_m_kmh = 10.0
321.9s 3500 DEBUG PARAMS: Reading K_c_kmh = 15.0
321.9s 3501 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
321.9s 3502 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
321.9s 3503 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
321.9s 3504 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
321.9s 3505 Loading road quality type: uniform
321.9s 3506 Uniform road quality value: 2
321.9s 3507 Road quality loaded.
321.9s 3508 Initial state created.
321.9s 3509 Transferring initial state and road quality to GPU...
321.9s 3510 GPU data transfer complete.
321.9s 3511 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
321.9s 3512 Initial boundary conditions applied.
321.9s 3513 [BC UPDATE] left → phase 0 RED (reduced inflow)
321.9s 3514 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
321.9s 3515 [BC UPDATE] left → phase 1 GREEN (normal inflow)
321.9s 3516 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
321.9s 3517 Running simulation until t = 60.00 s, outputting every 60.00 s
321.9s 3518 
321.9s 3519 [WARNING] Automatic CFL correction applied (count: 20000):
321.9s 3520 Calculated CFL: 0.800 > Limit: 0.500
321.9s 3521 Original dt: 3.451280e-01 s
321.9s 3522 Corrected dt: 2.157050e-01 s
321.9s 3523 Correction factor: 1.6x
321.9s 3524 Max wave speed detected: 23.18 m/s
322.3s 3525 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
322.8s 3526 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
322.8s 3527 [WARNING] Automatic CFL correction applied (count: 20100):
322.8s 3528 Calculated CFL: 0.800 > Limit: 0.500
322.8s 3529 Original dt: 4.139892e-01 s
322.8s 3530 Corrected dt: 2.587433e-01 s
322.8s 3531 Correction factor: 1.6x
322.8s 3532 Max wave speed detected: 19.32 m/s
323.2s 3533 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
323.7s 3534 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
323.7s 3535 [WARNING] Automatic CFL correction applied (count: 20200):
323.7s 3536 Calculated CFL: 0.800 > Limit: 0.500
323.7s 3537 Original dt: 4.115314e-01 s
323.7s 3538 Corrected dt: 2.572071e-01 s
323.7s 3539 Correction factor: 1.6x
323.7s 3540 Max wave speed detected: 19.44 m/s
324.0s 3541 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
324.0s 3542 [A
324.0s 3543 Stored output at t = 60.0000 s (Step 231)
324.0s 3544 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.31s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.31s/s]
324.0s 3545 
324.0s 3546 Simulation finished at t = 60.0000 s after 231 steps.
324.0s 3547 Total runtime: 2.12 seconds.
324.0s 3548 [BC UPDATE] left → phase 0 RED (reduced inflow)
324.0s 3549 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
324.0s 3550 Running simulation until t = 120.00 s, outputting every 60.00 s
324.0s 3551 
324.2s 3552 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
324.6s 3553 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
324.6s 3554 [WARNING] Automatic CFL correction applied (count: 20300):
324.6s 3555 Calculated CFL: 0.800 > Limit: 0.500
324.6s 3556 Original dt: 4.114986e-01 s
324.6s 3557 Corrected dt: 2.571866e-01 s
324.6s 3558 Correction factor: 1.6x
324.6s 3559 Max wave speed detected: 19.44 m/s
325.0s 3560 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
325.5s 3561 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
325.5s 3562 [WARNING] Automatic CFL correction applied (count: 20400):
325.5s 3563 Calculated CFL: 0.800 > Limit: 0.500
325.5s 3564 Original dt: 4.114980e-01 s
325.5s 3565 Corrected dt: 2.571863e-01 s
325.5s 3566 Correction factor: 1.6x
325.5s 3567 Max wave speed detected: 19.44 m/s
325.9s 3568 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
326.1s 3569 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
326.1s 3570 Stored output at t = 120.0000 s (Step 465)
326.1s 3571 [A
326.1s 3572 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.72s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.72s/s]
326.1s 3573 
326.1s 3574 Simulation finished at t = 120.0000 s after 465 steps.
326.1s 3575 Total runtime: 2.09 seconds.
326.1s 3576 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
326.1s 3577 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
326.1s 3578 Using device: gpu
326.1s 3579 DEBUG PARAMS: Reading K_m_kmh = 10.0
326.1s 3580 DEBUG PARAMS: Reading K_c_kmh = 15.0
326.1s 3581 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
326.1s 3582 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
326.1s 3583 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
326.1s 3584 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
326.1s 3585 Loading road quality type: uniform
326.1s 3586 Uniform road quality value: 2
326.1s 3587 Road quality loaded.
326.1s 3588 Initial state created.
326.1s 3589 Transferring initial state and road quality to GPU...
326.1s 3590 GPU data transfer complete.
326.1s 3591 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
326.1s 3592 Initial boundary conditions applied.
326.1s 3593 [BC UPDATE] left → phase 0 RED (reduced inflow)
326.1s 3594 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
326.1s 3595 [BC UPDATE] left → phase 0 RED (reduced inflow)
326.1s 3596 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
326.1s 3597 Running simulation until t = 60.00 s, outputting every 60.00 s
326.1s 3598 
326.4s 3599 [WARNING] Automatic CFL correction applied (count: 20500):
326.4s 3600 Calculated CFL: 0.800 > Limit: 0.500
326.4s 3601 Original dt: 4.583403e-01 s
326.4s 3602 Corrected dt: 2.864627e-01 s
326.4s 3603 Correction factor: 1.6x
326.4s 3604 Max wave speed detected: 17.45 m/s
326.5s 3605 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
327.0s 3606 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
327.3s 3607 [WARNING] Automatic CFL correction applied (count: 20600):
327.3s 3608 Calculated CFL: 0.800 > Limit: 0.500
327.3s 3609 Original dt: 4.120137e-01 s
327.3s 3610 Corrected dt: 2.575085e-01 s
327.3s 3611 Correction factor: 1.6x
327.3s 3612 Max wave speed detected: 19.42 m/s
327.4s 3613 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
327.9s 3614 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
328.1s 3615 Stored output at t = 60.0000 s (Step 231)
328.1s 3616 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
328.1s 3617 [A
328.1s 3618 
328.1s 3619 Simulation finished at t = 60.0000 s after 231 steps.
328.1s 3620 Total runtime: 2.05 seconds.
328.1s 3621 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.29s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.29s/s]
328.1s 3622 [BC UPDATE] left → phase 1 GREEN (normal inflow)
328.1s 3623 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
328.1s 3624 Running simulation until t = 120.00 s, outputting every 60.00 s
328.1s 3625 
328.2s 3626 [WARNING] Automatic CFL correction applied (count: 20700):
328.2s 3627 Calculated CFL: 0.800 > Limit: 0.500
328.2s 3628 Original dt: 4.115064e-01 s
328.2s 3629 Corrected dt: 2.571915e-01 s
328.2s 3630 Correction factor: 1.6x
328.2s 3631 Max wave speed detected: 19.44 m/s
328.3s 3632 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
328.8s 3633 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
329.1s 3634 [WARNING] Automatic CFL correction applied (count: 20800):
329.1s 3635 Calculated CFL: 0.800 > Limit: 0.500
329.1s 3636 Original dt: 4.114982e-01 s
329.1s 3637 Corrected dt: 2.571864e-01 s
329.1s 3638 Correction factor: 1.6x
329.1s 3639 Max wave speed detected: 19.44 m/s
329.2s 3640 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
329.6s 3641 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
330.0s 3642 [WARNING] Automatic CFL correction applied (count: 20900):
330.0s 3643 Calculated CFL: 0.800 > Limit: 0.500
330.0s 3644 Original dt: 4.114980e-01 s
330.0s 3645 Corrected dt: 2.571863e-01 s
330.0s 3646 Correction factor: 1.6x
330.0s 3647 Max wave speed detected: 19.44 m/s
330.1s 3648 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
330.2s 3649 Stored output at t = 120.0000 s (Step 465)
330.2s 3650 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
330.2s 3651 [A
330.2s 3652 
330.2s 3653 Simulation finished at t = 120.0000 s after 465 steps.
330.2s 3654 Total runtime: 2.07 seconds.
330.2s 3655 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.94s/s]
330.2s 3656 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
330.2s 3657 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
330.2s 3658 Using device: gpu
330.2s 3659 DEBUG PARAMS: Reading K_m_kmh = 10.0
330.2s 3660 DEBUG PARAMS: Reading K_c_kmh = 15.0
330.2s 3661 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
330.2s 3662 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
330.2s 3663 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
330.2s 3664 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
330.2s 3665 Loading road quality type: uniform
330.2s 3666 Uniform road quality value: 2
330.2s 3667 Road quality loaded.
330.2s 3668 Initial state created.
330.2s 3669 Transferring initial state and road quality to GPU...
330.2s 3670 GPU data transfer complete.
330.2s 3671 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
330.2s 3672 Initial boundary conditions applied.
330.2s 3673 [BC UPDATE] left → phase 0 RED (reduced inflow)
330.2s 3674 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
330.2s 3675 [BC UPDATE] left → phase 1 GREEN (normal inflow)
330.2s 3676 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
330.2s 3677 Running simulation until t = 60.00 s, outputting every 60.00 s
330.2s 3678 
330.7s 3679 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
330.9s 3680 [WARNING] Automatic CFL correction applied (count: 21000):
330.9s 3681 Calculated CFL: 0.800 > Limit: 0.500
330.9s 3682 Original dt: 4.205139e-01 s
330.9s 3683 Corrected dt: 2.628212e-01 s
330.9s 3684 Correction factor: 1.6x
330.9s 3685 Max wave speed detected: 19.02 m/s
331.1s 3686 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
331.6s 3687 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
331.8s 3688 [WARNING] Automatic CFL correction applied (count: 21100):
331.8s 3689 Calculated CFL: 0.800 > Limit: 0.500
331.8s 3690 Original dt: 4.116141e-01 s
331.8s 3691 Corrected dt: 2.572588e-01 s
331.8s 3692 Correction factor: 1.6x
331.8s 3693 Max wave speed detected: 19.44 m/s
332.0s 3694 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
332.3s 3695 Stored output at t = 60.0000 s (Step 231)
332.3s 3696 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
332.3s 3697 [A
332.3s 3698 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.60s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.60s/s]
332.3s 3699 
332.3s 3700 Simulation finished at t = 60.0000 s after 231 steps.
332.3s 3701 Total runtime: 2.10 seconds.
332.3s 3702 [BC UPDATE] left → phase 0 RED (reduced inflow)
332.3s 3703 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
332.3s 3704 Running simulation until t = 120.00 s, outputting every 60.00 s
332.3s 3705 
332.5s 3706 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
332.7s 3707 [WARNING] Automatic CFL correction applied (count: 21200):
332.7s 3708 Calculated CFL: 0.800 > Limit: 0.500
332.7s 3709 Original dt: 4.115000e-01 s
332.7s 3710 Corrected dt: 2.571875e-01 s
332.7s 3711 Correction factor: 1.6x
332.7s 3712 Max wave speed detected: 19.44 m/s
333.0s 3713 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
333.4s 3714 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
333.6s 3715 [WARNING] Automatic CFL correction applied (count: 21300):
333.6s 3716 Calculated CFL: 0.800 > Limit: 0.500
333.6s 3717 Original dt: 4.114981e-01 s
333.6s 3718 Corrected dt: 2.571863e-01 s
333.6s 3719 Correction factor: 1.6x
333.6s 3720 Max wave speed detected: 19.44 m/s
333.9s 3721 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
334.3s 3722 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
334.4s 3723 Stored output at t = 120.0000 s (Step 465)
334.4s 3724 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
334.4s 3725 [A
334.4s 3726 
334.4s 3727 Simulation finished at t = 120.0000 s after 465 steps.
334.4s 3728 Total runtime: 2.11 seconds.
334.4s 3729 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s]
334.4s 3730 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
334.4s 3731 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.4s 3732 Using device: gpu
334.4s 3733 DEBUG PARAMS: Reading K_m_kmh = 10.0
334.4s 3734 DEBUG PARAMS: Reading K_c_kmh = 15.0
334.4s 3735 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
334.4s 3736 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
334.4s 3737 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
334.4s 3738 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
334.4s 3739 Loading road quality type: uniform
334.4s 3740 Uniform road quality value: 2
334.4s 3741 Road quality loaded.
334.4s 3742 Initial state created.
334.4s 3743 Transferring initial state and road quality to GPU...
334.4s 3744 GPU data transfer complete.
334.4s 3745 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
334.4s 3746 Initial boundary conditions applied.
334.4s 3747 [BC UPDATE] left → phase 0 RED (reduced inflow)
334.4s 3748 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
334.4s 3749 [BC UPDATE] left → phase 1 GREEN (normal inflow)
334.4s 3750 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
334.4s 3751 Running simulation until t = 60.00 s, outputting every 60.00 s
334.4s 3752 
334.5s 3753 [WARNING] Automatic CFL correction applied (count: 21400):
334.5s 3754 Calculated CFL: 0.800 > Limit: 0.500
334.5s 3755 Original dt: 3.737254e-01 s
334.5s 3756 Corrected dt: 2.335784e-01 s
334.5s 3757 Correction factor: 1.6x
334.5s 3758 Max wave speed detected: 21.41 m/s
334.9s 3759 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
335.3s 3760 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
335.4s 3761 [WARNING] Automatic CFL correction applied (count: 21500):
335.4s 3762 Calculated CFL: 0.800 > Limit: 0.500
335.4s 3763 Original dt: 4.134305e-01 s
335.4s 3764 Corrected dt: 2.583941e-01 s
335.4s 3765 Correction factor: 1.6x
335.4s 3766 Max wave speed detected: 19.35 m/s
335.8s 3767 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
336.2s 3768 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
336.3s 3769 [WARNING] Automatic CFL correction applied (count: 21600):
336.3s 3770 Calculated CFL: 0.800 > Limit: 0.500
336.3s 3771 Original dt: 4.115259e-01 s
336.3s 3772 Corrected dt: 2.572037e-01 s
336.3s 3773 Correction factor: 1.6x
336.3s 3774 Max wave speed detected: 19.44 m/s
336.5s 3775 Stored output at t = 60.0000 s (Step 231)
336.5s 3776 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
336.5s 3777 [A
336.5s 3778 
336.5s 3779 Simulation finished at t = 60.0000 s after 231 steps.
336.5s 3780 Total runtime: 2.02 seconds.
336.5s 3781 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.68s/s]
336.5s 3782 [BC UPDATE] left → phase 1 GREEN (normal inflow)
336.5s 3783 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
336.5s 3784 Running simulation until t = 120.00 s, outputting every 60.00 s
336.5s 3785 
336.6s 3786 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
337.1s 3787 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
337.2s 3788 [WARNING] Automatic CFL correction applied (count: 21700):
337.2s 3789 Calculated CFL: 0.800 > Limit: 0.500
337.2s 3790 Original dt: 4.114985e-01 s
337.2s 3791 Corrected dt: 2.571866e-01 s
337.2s 3792 Correction factor: 1.6x
337.2s 3793 Max wave speed detected: 19.44 m/s
337.5s 3794 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
337.9s 3795 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
338.0s 3796 [WARNING] Automatic CFL correction applied (count: 21800):
338.0s 3797 Calculated CFL: 0.800 > Limit: 0.500
338.0s 3798 Original dt: 4.114980e-01 s
338.0s 3799 Corrected dt: 2.571863e-01 s
338.0s 3800 Correction factor: 1.6x
338.0s 3801 Max wave speed detected: 19.44 m/s
338.4s 3802 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
338.5s 3803 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
338.5s 3804 [A
338.5s 3805 Stored output at t = 120.0000 s (Step 465)
338.5s 3806 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 29.43s/s]
338.5s 3807 
338.5s 3808 Simulation finished at t = 120.0000 s after 465 steps.
338.5s 3809 Total runtime: 2.04 seconds.
338.5s 3810 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
338.5s 3811 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
338.5s 3812 Using device: gpu
338.5s 3813 DEBUG PARAMS: Reading K_m_kmh = 10.0
338.5s 3814 DEBUG PARAMS: Reading K_c_kmh = 15.0
338.5s 3815 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
338.5s 3816 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
338.5s 3817 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
338.5s 3818 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
338.5s 3819 Loading road quality type: uniform
338.5s 3820 Uniform road quality value: 2
338.5s 3821 Road quality loaded.
338.5s 3822 Initial state created.
338.5s 3823 Transferring initial state and road quality to GPU...
338.5s 3824 GPU data transfer complete.
338.5s 3825 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
338.5s 3826 Initial boundary conditions applied.
338.5s 3827 [BC UPDATE] left → phase 0 RED (reduced inflow)
338.5s 3828 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
338.5s 3829 [BC UPDATE] left → phase 0 RED (reduced inflow)
338.5s 3830 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
338.5s 3831 Running simulation until t = 60.00 s, outputting every 60.00 s
338.5s 3832 
338.9s 3833 [WARNING] Automatic CFL correction applied (count: 21900):
338.9s 3834 Calculated CFL: 0.800 > Limit: 0.500
338.9s 3835 Original dt: 4.470525e-01 s
338.9s 3836 Corrected dt: 2.794078e-01 s
338.9s 3837 Correction factor: 1.6x
338.9s 3838 Max wave speed detected: 17.89 m/s
339.0s 3839 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
339.4s 3840 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
339.8s 3841 [WARNING] Automatic CFL correction applied (count: 22000):
339.8s 3842 Calculated CFL: 0.800 > Limit: 0.500
339.8s 3843 Original dt: 4.119130e-01 s
339.8s 3844 Corrected dt: 2.574456e-01 s
339.8s 3845 Correction factor: 1.6x
339.8s 3846 Max wave speed detected: 19.42 m/s
339.8s 3847 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
340.3s 3848 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
340.6s 3849 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
340.6s 3850 Stored output at t = 60.0000 s (Step 231)
340.6s 3851 [A
340.6s 3852 
340.6s 3853 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.60s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.60s/s]
340.6s 3854 Simulation finished at t = 60.0000 s after 231 steps.
340.6s 3855 Total runtime: 2.03 seconds.
340.6s 3856 [BC UPDATE] left → phase 0 RED (reduced inflow)
340.6s 3857 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
340.6s 3858 Running simulation until t = 120.00 s, outputting every 60.00 s
340.6s 3859 
340.7s 3860 [WARNING] Automatic CFL correction applied (count: 22100):
340.7s 3861 Calculated CFL: 0.800 > Limit: 0.500
340.7s 3862 Original dt: 4.115046e-01 s
340.7s 3863 Corrected dt: 2.571904e-01 s
340.7s 3864 Correction factor: 1.6x
340.7s 3865 Max wave speed detected: 19.44 m/s
340.7s 3866 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
341.2s 3867 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
341.5s 3868 [WARNING] Automatic CFL correction applied (count: 22200):
341.5s 3869 Calculated CFL: 0.800 > Limit: 0.500
341.5s 3870 Original dt: 4.114982e-01 s
341.5s 3871 Corrected dt: 2.571863e-01 s
341.6s 3872 Correction factor: 1.6x
341.6s 3873 Max wave speed detected: 19.44 m/s
341.6s 3874 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
342.1s 3875 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
342.5s 3876 [WARNING] Automatic CFL correction applied (count: 22300):
342.5s 3877 Calculated CFL: 0.800 > Limit: 0.500
342.5s 3878 Original dt: 4.114980e-01 s
342.5s 3879 Corrected dt: 2.571863e-01 s
342.5s 3880 Correction factor: 1.6x
342.5s 3881 Max wave speed detected: 19.44 m/s
342.5s 3882 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
342.6s 3883 Stored output at t = 120.0000 s (Step 465)
342.6s 3884 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
342.6s 3885 [A
342.6s 3886 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.88s/s]
342.6s 3887 
342.6s 3888 Simulation finished at t = 120.0000 s after 465 steps.
342.6s 3889 Total runtime: 2.08 seconds.
342.6s 3890 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
342.6s 3891 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
342.6s 3892 Using device: gpu
342.6s 3893 DEBUG PARAMS: Reading K_m_kmh = 10.0
342.6s 3894 DEBUG PARAMS: Reading K_c_kmh = 15.0
342.6s 3895 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
342.6s 3896 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
342.6s 3897 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
342.6s 3898 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
342.6s 3899 Loading road quality type: uniform
342.6s 3900 Uniform road quality value: 2
342.6s 3901 Road quality loaded.
342.6s 3902 Initial state created.
342.6s 3903 Transferring initial state and road quality to GPU...
342.6s 3904 GPU data transfer complete.
342.6s 3905 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
342.6s 3906 Initial boundary conditions applied.
342.6s 3907 [BC UPDATE] left → phase 0 RED (reduced inflow)
342.6s 3908 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
342.7s 3909 [BC UPDATE] left → phase 1 GREEN (normal inflow)
342.7s 3910 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
342.7s 3911 Running simulation until t = 60.00 s, outputting every 60.00 s
342.7s 3912 
343.1s 3913 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
343.4s 3914 [WARNING] Automatic CFL correction applied (count: 22400):
343.4s 3915 Calculated CFL: 0.800 > Limit: 0.500
343.4s 3916 Original dt: 4.190346e-01 s
343.4s 3917 Corrected dt: 2.618967e-01 s
343.4s 3918 Correction factor: 1.6x
343.4s 3919 Max wave speed detected: 19.09 m/s
343.5s 3920 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
344.0s 3921 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
344.2s 3922 [WARNING] Automatic CFL correction applied (count: 22500):
344.2s 3923 Calculated CFL: 0.800 > Limit: 0.500
344.2s 3924 Original dt: 4.115954e-01 s
344.2s 3925 Corrected dt: 2.572472e-01 s
344.2s 3926 Correction factor: 1.6x
344.2s 3927 Max wave speed detected: 19.44 m/s
344.4s 3928 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
344.7s 3929 Stored output at t = 60.0000 s (Step 231)
344.7s 3930 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
344.7s 3931 [A
344.7s 3932 
344.7s 3933 Simulation finished at t = 60.0000 s after 231 steps.
344.7s 3934 Total runtime: 2.06 seconds.
344.7s 3935 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.17s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.17s/s]
344.7s 3936 [BC UPDATE] left → phase 0 RED (reduced inflow)
344.7s 3937 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
344.7s 3938 Running simulation until t = 120.00 s, outputting every 60.00 s
344.7s 3939 
344.9s 3940 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
345.1s 3941 [WARNING] Automatic CFL correction applied (count: 22600):
345.1s 3942 Calculated CFL: 0.800 > Limit: 0.500
345.1s 3943 Original dt: 4.114996e-01 s
345.1s 3944 Corrected dt: 2.571873e-01 s
345.1s 3945 Correction factor: 1.6x
345.1s 3946 Max wave speed detected: 19.44 m/s
345.3s 3947 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
345.8s 3948 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
346.0s 3949 [WARNING] Automatic CFL correction applied (count: 22700):
346.0s 3950 Calculated CFL: 0.800 > Limit: 0.500
346.0s 3951 Original dt: 4.114981e-01 s
346.0s 3952 Corrected dt: 2.571863e-01 s
346.0s 3953 Correction factor: 1.6x
346.0s 3954 Max wave speed detected: 19.44 m/s
346.2s 3955 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
346.7s 3956 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
346.8s 3957 Stored output at t = 120.0000 s (Step 465)
346.8s 3958 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
346.8s 3959 [A
346.8s 3960 
346.8s 3961 Simulation finished at t = 120.0000 s after 465 steps.
346.8s 3962 Total runtime: 2.10 seconds.
346.8s 3963 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.58s/s]
346.8s 3964 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
346.8s 3965 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.8s 3966 Using device: gpu
346.8s 3967 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.8s 3968 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.8s 3969 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.8s 3970 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.8s 3971 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.8s 3972 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.8s 3973 Loading road quality type: uniform
346.8s 3974 Uniform road quality value: 2
346.8s 3975 Road quality loaded.
346.8s 3976 Initial state created.
346.8s 3977 Transferring initial state and road quality to GPU...
346.8s 3978 GPU data transfer complete.
346.8s 3979 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.8s 3980 Initial boundary conditions applied.
346.8s 3981 [BC UPDATE] left → phase 0 RED (reduced inflow)
346.8s 3982 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
346.8s 3983 [BC UPDATE] left → phase 0 RED (reduced inflow)
346.8s 3984 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
346.8s 3985 Running simulation until t = 60.00 s, outputting every 60.00 s
346.8s 3986 
347.0s 3987 [WARNING] Automatic CFL correction applied (count: 22800):
347.0s 3988 Calculated CFL: 0.800 > Limit: 0.500
347.0s 3989 Original dt: 4.022422e-01 s
347.0s 3990 Corrected dt: 2.514014e-01 s
347.0s 3991 Correction factor: 1.6x
347.0s 3992 Max wave speed detected: 19.89 m/s
347.3s 3993 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
347.7s 3994 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
347.9s 3995 [WARNING] Automatic CFL correction applied (count: 22900):
347.9s 3996 Calculated CFL: 0.800 > Limit: 0.500
347.9s 3997 Original dt: 4.130229e-01 s
347.9s 3998 Corrected dt: 2.581393e-01 s
347.9s 3999 Correction factor: 1.6x
347.9s 4000 Max wave speed detected: 19.37 m/s
348.2s 4001 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
348.6s 4002 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
348.8s 4003 [WARNING] Automatic CFL correction applied (count: 23000):
348.8s 4004 Calculated CFL: 0.800 > Limit: 0.500
348.8s 4005 Original dt: 4.115198e-01 s
348.8s 4006 Corrected dt: 2.571999e-01 s
348.8s 4007 Correction factor: 1.6x
348.8s 4008 Max wave speed detected: 19.44 m/s
348.9s 4009 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
348.9s 4010 [A
348.9s 4011 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.91s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.91s/s]
348.9s 4012 Stored output at t = 60.0000 s (Step 231)
348.9s 4013 
348.9s 4014 Simulation finished at t = 60.0000 s after 231 steps.
348.9s 4015 Total runtime: 2.08 seconds.
348.9s 4016 [BC UPDATE] left → phase 1 GREEN (normal inflow)
348.9s 4017 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
348.9s 4018 Running simulation until t = 120.00 s, outputting every 60.00 s
348.9s 4019 
349.1s 4020 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
349.5s 4021 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
349.6s 4022 [WARNING] Automatic CFL correction applied (count: 23100):
349.6s 4023 Calculated CFL: 0.800 > Limit: 0.500
349.6s 4024 Original dt: 4.114984e-01 s
349.6s 4025 Corrected dt: 2.571865e-01 s
349.6s 4026 Correction factor: 1.6x
349.6s 4027 Max wave speed detected: 19.44 m/s
350.0s 4028 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
350.4s 4029 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
350.5s 4030 [WARNING] Automatic CFL correction applied (count: 23200):
350.5s 4031 Calculated CFL: 0.800 > Limit: 0.500
350.5s 4032 Original dt: 4.114980e-01 s
350.5s 4033 Corrected dt: 2.571863e-01 s
350.5s 4034 Correction factor: 1.6x
350.5s 4035 Max wave speed detected: 19.44 m/s
350.9s 4036 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
351.0s 4037 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
351.0s 4038 [A
351.0s 4039 Stored output at t = 120.0000 s (Step 465)
351.0s 4040 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.65s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.65s/s]
351.0s 4041 
351.0s 4042 Simulation finished at t = 120.0000 s after 465 steps.
351.0s 4043 Total runtime: 2.09 seconds.
351.0s 4044 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
351.0s 4045 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
351.0s 4046 Using device: gpu
351.0s 4047 DEBUG PARAMS: Reading K_m_kmh = 10.0
351.0s 4048 DEBUG PARAMS: Reading K_c_kmh = 15.0
351.0s 4049 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
351.0s 4050 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
351.0s 4051 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
351.0s 4052 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
351.0s 4053 Loading road quality type: uniform
351.0s 4054 Uniform road quality value: 2
351.0s 4055 Road quality loaded.
351.0s 4056 Initial state created.
351.0s 4057 Transferring initial state and road quality to GPU...
351.0s 4058 GPU data transfer complete.
351.0s 4059 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
351.0s 4060 Initial boundary conditions applied.
351.0s 4061 [BC UPDATE] left → phase 0 RED (reduced inflow)
351.0s 4062 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
351.0s 4063 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.5 steps/s
351.0s 4064 ---------------------------------
351.0s 4065 | rollout/           |          |
351.0s 4066 |    ep_len_mean     | 2        |
351.0s 4067 |    ep_rew_mean     | -0.0736  |
351.0s 4068 | time/              |          |
351.0s 4069 |    fps             | 0        |
351.0s 4070 |    iterations      | 1        |
351.0s 4071 |    time_elapsed    | 213      |
351.0s 4072 |    total_timesteps | 100      |
351.0s 4073 ---------------------------------
351.6s 4074 
351.6s 4075 ✅ Training completed in 3.6 minutes (214.1s)
351.6s 4076 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:33 < 0:00:00 , 0 it/s ]
351.6s 4077 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
351.6s 4078 
351.6s 4079 [PHASE 2/2] Running performance comparisons...
351.6s 4080 [QUICK TEST] Testing only: traffic_light_control
351.6s 4081 
351.6s 4082 Testing scenario: traffic_light_control (device=gpu)
351.6s 4083 2025-10-10 15:37:54 - INFO - run_performance_comparison:700 - ================================================================================
351.6s 4084 2025-10-10 15:37:54 - INFO - run_performance_comparison:701 - Starting run_performance_comparison for scenario: traffic_light_control
351.6s 4085 2025-10-10 15:37:54 - INFO - run_performance_comparison:702 - Device: gpu
351.6s 4086 2025-10-10 15:37:54 - INFO - run_performance_comparison:703 - ================================================================================
351.6s 4087 2025-10-10 15:37:54 - INFO - run_performance_comparison:704 - ================================================================================
351.6s 4088 2025-10-10 15:37:54 - INFO - run_performance_comparison:705 - Starting run_performance_comparison for scenario: traffic_light_control
351.6s 4089 2025-10-10 15:37:54 - INFO - run_performance_comparison:706 - Device: gpu
351.6s 4090 2025-10-10 15:37:54 - INFO - run_performance_comparison:707 - ================================================================================
351.6s 4091 2025-10-10 15:37:54 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
351.6s 4092 2025-10-10 15:37:54 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
351.6s 4093 2025-10-10 15:37:54 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
351.6s 4094 2025-10-10 15:37:54 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
351.6s 4095 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
351.6s 4096 Running baseline controller...
351.6s 4097 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
351.6s 4098 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
351.6s 4099 2025-10-10 15:37:54 - INFO - run_control_simulation:286 - ================================================================================
351.6s 4100 2025-10-10 15:37:54 - INFO - run_control_simulation:287 - Starting run_control_simulation:
351.6s 4101 2025-10-10 15:37:54 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
351.6s 4102 2025-10-10 15:37:54 - INFO - run_control_simulation:289 -   - duration: 600.0s
351.6s 4103 2025-10-10 15:37:54 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
351.6s 4104 2025-10-10 15:37:54 - INFO - run_control_simulation:291 -   - device: gpu
351.6s 4105 2025-10-10 15:37:54 - INFO - run_control_simulation:292 -   - controller: BaselineController
351.6s 4106 2025-10-10 15:37:54 - INFO - run_control_simulation:293 -   - max_control_steps: 11
351.6s 4107 2025-10-10 15:37:54 - INFO - run_control_simulation:294 - ================================================================================
351.6s 4108 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
351.6s 4109 2025-10-10 15:37:54 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
351.6s 4110 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
351.6s 4111 Using device: gpu
351.6s 4112 DEBUG PARAMS: Reading K_m_kmh = 10.0
351.6s 4113 DEBUG PARAMS: Reading K_c_kmh = 15.0
351.6s 4114 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
351.6s 4115 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
351.6s 4116 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
351.6s 4117 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
351.6s 4118 Loading road quality type: uniform
351.6s 4119 Uniform road quality value: 2
351.6s 4120 Road quality loaded.
351.6s 4121 Initial state created.
351.6s 4122 Transferring initial state and road quality to GPU...
351.6s 4123 GPU data transfer complete.
351.6s 4124 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
351.6s 4125 Initial boundary conditions applied.
351.6s 4126 TrafficSignalEnvDirect initialized:
351.6s 4127 Decision interval: 60.0s
351.6s 4128 Observation segments: 6
351.6s 4129 Observation space: (26,)
351.6s 4130 Action space: 2
351.6s 4131 Device: gpu
351.6s 4132 2025-10-10 15:37:54 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
351.6s 4133 2025-10-10 15:37:54 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
351.6s 4134 [INFO] Calling env.reset()...
351.6s 4135 2025-10-10 15:37:54 - INFO - run_control_simulation:331 - Calling env.reset()...
351.6s 4136 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
351.6s 4137 Using device: gpu
351.6s 4138 DEBUG PARAMS: Reading K_m_kmh = 10.0
351.6s 4139 DEBUG PARAMS: Reading K_c_kmh = 15.0
351.6s 4140 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
351.6s 4141 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
351.6s 4142 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
351.6s 4143 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
351.6s 4144 Loading road quality type: uniform
351.6s 4145 Uniform road quality value: 2
351.6s 4146 Road quality loaded.
351.6s 4147 Initial state created.
351.6s 4148 Transferring initial state and road quality to GPU...
351.6s 4149 GPU data transfer complete.
351.6s 4150 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
351.6s 4151 Initial boundary conditions applied.
351.6s 4152 [BC UPDATE] left → phase 0 RED (reduced inflow)
351.6s 4153 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
351.6s 4154 2025-10-10 15:37:54 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
351.6s 4155 2025-10-10 15:37:54 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
351.6s 4156 2025-10-10 15:37:54 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
351.6s 4157 [INFO] Starting simulation loop (max 11 control steps)
351.6s 4158 2025-10-10 15:37:54 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
351.6s 4159 2025-10-10 15:37:54 - INFO - run_control_simulation:368 - ================================================================================
351.6s 4160 2025-10-10 15:37:54 - INFO - run_control_simulation:369 - STEP 0 START:
351.6s 4161 2025-10-10 15:37:54 - INFO - run_control_simulation:370 -   Controller: BaselineController
351.6s 4162 2025-10-10 15:37:54 - INFO - run_control_simulation:371 -   Action: 1.000000
351.6s 4163 2025-10-10 15:37:54 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
351.6s 4164 [BC UPDATE] left → phase 1 GREEN (normal inflow)
351.6s 4165 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
351.6s 4166 Running simulation until t = 60.00 s, outputting every 60.00 s
352.1s 4167 [WARNING] Automatic CFL correction applied (count: 23300):
352.1s 4168 Calculated CFL: 0.800 > Limit: 0.500
352.1s 4169 Original dt: 4.396418e-01 s
352.1s 4170 Corrected dt: 2.747761e-01 s
352.1s 4171 Correction factor: 1.6x
352.1s 4172 Max wave speed detected: 18.20 m/s
352.1s 4173 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
352.5s 4174 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
353.0s 4175 [WARNING] Automatic CFL correction applied (count: 23400):
353.0s 4176 Calculated CFL: 0.800 > Limit: 0.500
353.0s 4177 Original dt: 4.118393e-01 s
353.0s 4178 Corrected dt: 2.573996e-01 s
353.0s 4179 Correction factor: 1.6x
353.0s 4180 Max wave speed detected: 19.43 m/s
353.0s 4181 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
353.4s 4182 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
353.7s 4183 Stored output at t = 60.0000 s (Step 231)
353.7s 4184 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.07s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.07s/s]
353.7s 4185 
353.7s 4186 Simulation finished at t = 60.0000 s after 231 steps.
353.7s 4187 Total runtime: 2.06 seconds.
353.7s 4188 2025-10-10 15:37:56 - INFO - run_control_simulation:384 -   Reward: -0.084799
353.7s 4189 2025-10-10 15:37:56 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
353.7s 4190 2025-10-10 15:37:56 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
353.7s 4191 2025-10-10 15:37:56 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
353.7s 4192 2025-10-10 15:37:56 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
353.7s 4193 2025-10-10 15:37:56 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
353.7s 4194 2025-10-10 15:37:56 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.406686, w_c=11.325496
353.7s 4195 2025-10-10 15:37:56 - INFO - run_control_simulation:418 -   State hash: -8204528842174014379
353.7s 4196 2025-10-10 15:37:56 - INFO - run_control_simulation:420 - ================================================================================
353.7s 4197 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
353.7s 4198 2025-10-10 15:37:56 - INFO - run_control_simulation:368 - ================================================================================
353.7s 4199 2025-10-10 15:37:56 - INFO - run_control_simulation:369 - STEP 1 START:
353.7s 4200 2025-10-10 15:37:56 - INFO - run_control_simulation:370 -   Controller: BaselineController
353.7s 4201 2025-10-10 15:37:56 - INFO - run_control_simulation:371 -   Action: 0.000000
353.7s 4202 2025-10-10 15:37:56 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
353.7s 4203 [BC UPDATE] left → phase 0 RED (reduced inflow)
353.7s 4204 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
353.7s 4205 Running simulation until t = 120.00 s, outputting every 60.00 s
353.9s 4206 [WARNING] Automatic CFL correction applied (count: 23500):
353.9s 4207 Calculated CFL: 0.800 > Limit: 0.500
353.9s 4208 Original dt: 4.115033e-01 s
353.9s 4209 Corrected dt: 2.571896e-01 s
353.9s 4210 Correction factor: 1.6x
353.9s 4211 Max wave speed detected: 19.44 m/s
353.9s 4212 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
354.3s 4213 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
354.8s 4214 [WARNING] Automatic CFL correction applied (count: 23600):
354.8s 4215 Calculated CFL: 0.800 > Limit: 0.500
354.8s 4216 Original dt: 4.114981e-01 s
354.8s 4217 Corrected dt: 2.571863e-01 s
354.8s 4218 Correction factor: 1.6x
354.8s 4219 Max wave speed detected: 19.44 m/s
354.8s 4220 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
355.2s 4221 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
355.6s 4222 [WARNING] Automatic CFL correction applied (count: 23700):
355.6s 4223 Calculated CFL: 0.800 > Limit: 0.500
355.6s 4224 Original dt: 4.114980e-01 s
355.6s 4225 Corrected dt: 2.571863e-01 s
355.6s 4226 Correction factor: 1.6x
355.6s 4227 Max wave speed detected: 19.44 m/s
355.6s 4228 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
355.8s 4229 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.77s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.77s/s]
355.8s 4230 Stored output at t = 120.0000 s (Step 465)
355.8s 4231 
355.8s 4232 Simulation finished at t = 120.0000 s after 465 steps.
355.8s 4233 Total runtime: 2.09 seconds.
355.8s 4234 2025-10-10 15:37:58 - INFO - run_control_simulation:384 -   Reward: 0.015200
355.8s 4235 2025-10-10 15:37:58 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
355.8s 4236 2025-10-10 15:37:58 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
355.8s 4237 2025-10-10 15:37:58 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
355.8s 4238 2025-10-10 15:37:58 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.922491e+00, max=1.460993e+01, std=3.899078e+00
355.8s 4239 2025-10-10 15:37:58 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
355.8s 4240 2025-10-10 15:37:58 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.773789, w_c=13.986264
355.8s 4241 2025-10-10 15:37:58 - INFO - run_control_simulation:418 -   State hash: -851592242138840727
355.8s 4242 2025-10-10 15:37:58 - INFO - run_control_simulation:420 - ================================================================================
355.8s 4243 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.922491e+00
355.8s 4244 2025-10-10 15:37:58 - INFO - run_control_simulation:368 - ================================================================================
355.8s 4245 2025-10-10 15:37:58 - INFO - run_control_simulation:369 - STEP 2 START:
355.8s 4246 2025-10-10 15:37:58 - INFO - run_control_simulation:370 -   Controller: BaselineController
355.8s 4247 2025-10-10 15:37:58 - INFO - run_control_simulation:371 -   Action: 1.000000
355.8s 4248 2025-10-10 15:37:58 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
355.8s 4249 [BC UPDATE] left → phase 1 GREEN (normal inflow)
355.8s 4250 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
355.8s 4251 Running simulation until t = 180.00 s, outputting every 60.00 s
356.1s 4252 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
356.5s 4253 [WARNING] Automatic CFL correction applied (count: 23800):
356.5s 4254 Calculated CFL: 0.800 > Limit: 0.500
356.5s 4255 Original dt: 4.114980e-01 s
356.5s 4256 Corrected dt: 2.571863e-01 s
356.5s 4257 Correction factor: 1.6x
356.5s 4258 Max wave speed detected: 19.44 m/s
356.5s 4259 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
357.0s 4260 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
357.4s 4261 [WARNING] Automatic CFL correction applied (count: 23900):
357.4s 4262 Calculated CFL: 0.800 > Limit: 0.500
357.4s 4263 Original dt: 4.114980e-01 s
357.4s 4264 Corrected dt: 2.571863e-01 s
357.4s 4265 Correction factor: 1.6x
357.4s 4266 Max wave speed detected: 19.44 m/s
357.4s 4267 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
357.8s 4268 Stored output at t = 180.0000 s (Step 699)
357.8s 4269 
357.8s 4270 Simulation finished at t = 180.0000 s after 699 steps.
357.8s 4271 Total runtime: 2.06 seconds.
357.8s 4272 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 29.15s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 29.15s/s]
357.8s 4273 2025-10-10 15:38:00 - INFO - run_control_simulation:384 -   Reward: -0.084800
357.8s 4274 2025-10-10 15:38:00 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
357.8s 4275 2025-10-10 15:38:00 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
357.8s 4276 2025-10-10 15:38:00 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
357.8s 4277 2025-10-10 15:38:00 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.241080e+00, max=7.500000e+00, std=2.066254e+00
357.8s 4278 2025-10-10 15:38:00 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
357.8s 4279 2025-10-10 15:38:00 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.281686, w_c=16.412970
357.8s 4280 2025-10-10 15:38:00 - INFO - run_control_simulation:418 -   State hash: -1231381334395200493
357.8s 4281 2025-10-10 15:38:00 - INFO - run_control_simulation:420 - ================================================================================
357.8s 4282 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.241080e+00
357.8s 4283 2025-10-10 15:38:00 - INFO - run_control_simulation:368 - ================================================================================
357.8s 4284 2025-10-10 15:38:00 - INFO - run_control_simulation:369 - STEP 3 START:
357.8s 4285 2025-10-10 15:38:00 - INFO - run_control_simulation:370 -   Controller: BaselineController
357.8s 4286 2025-10-10 15:38:00 - INFO - run_control_simulation:371 -   Action: 0.000000
357.8s 4287 2025-10-10 15:38:00 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
357.8s 4288 [BC UPDATE] left → phase 0 RED (reduced inflow)
357.8s 4289 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
357.8s 4290 Running simulation until t = 240.00 s, outputting every 60.00 s
357.9s 4291 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
358.3s 4292 [WARNING] Automatic CFL correction applied (count: 24000):
358.3s 4293 Calculated CFL: 0.800 > Limit: 0.500
358.3s 4294 Original dt: 4.114980e-01 s
358.3s 4295 Corrected dt: 2.571863e-01 s
358.3s 4296 Correction factor: 1.6x
358.3s 4297 Max wave speed detected: 19.44 m/s
358.3s 4298 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
358.7s 4299 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
359.2s 4300 [WARNING] Automatic CFL correction applied (count: 24100):
359.2s 4301 Calculated CFL: 0.800 > Limit: 0.500
359.2s 4302 Original dt: 4.114980e-01 s
359.2s 4303 Corrected dt: 2.571863e-01 s
359.2s 4304 Correction factor: 1.6x
359.2s 4305 Max wave speed detected: 19.44 m/s
359.2s 4306 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
359.7s 4307 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
360.0s 4308 Stored output at t = 240.0000 s (Step 933)
360.0s 4309 
360.0s 4310 Simulation finished at t = 240.0000 s after 933 steps.
360.0s 4311 Total runtime: 2.10 seconds.
360.0s 4312 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.54s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.54s/s]
360.0s 4313 2025-10-10 15:38:02 - INFO - run_control_simulation:384 -   Reward: 0.015200
360.0s 4314 2025-10-10 15:38:02 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
360.0s 4315 2025-10-10 15:38:02 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
360.0s 4316 2025-10-10 15:38:02 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
360.0s 4317 2025-10-10 15:38:02 - INFO - run_control_simulation:403 -     Diff statistics: mean=7.368367e-02, max=7.500000e+00, std=6.628745e-01
360.0s 4318 2025-10-10 15:38:02 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
360.0s 4319 2025-10-10 15:38:02 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
360.0s 4320 2025-10-10 15:38:02 - INFO - run_control_simulation:418 -   State hash: -1289862524979765567
360.0s 4321 2025-10-10 15:38:02 - INFO - run_control_simulation:420 - ================================================================================
360.0s 4322 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=7.368367e-02
360.0s 4323 2025-10-10 15:38:02 - INFO - run_control_simulation:368 - ================================================================================
360.0s 4324 2025-10-10 15:38:02 - INFO - run_control_simulation:369 - STEP 4 START:
360.0s 4325 2025-10-10 15:38:02 - INFO - run_control_simulation:370 -   Controller: BaselineController
360.0s 4326 2025-10-10 15:38:02 - INFO - run_control_simulation:371 -   Action: 1.000000
360.0s 4327 2025-10-10 15:38:02 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
360.0s 4328 [BC UPDATE] left → phase 1 GREEN (normal inflow)
360.0s 4329 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
360.0s 4330 Running simulation until t = 300.00 s, outputting every 60.00 s
360.1s 4331 [WARNING] Automatic CFL correction applied (count: 24200):
360.1s 4332 Calculated CFL: 0.800 > Limit: 0.500
360.1s 4333 Original dt: 4.114980e-01 s
360.1s 4334 Corrected dt: 2.571863e-01 s
360.1s 4335 Correction factor: 1.6x
360.1s 4336 Max wave speed detected: 19.44 m/s
360.1s 4337 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
360.5s 4338 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
361.0s 4339 [WARNING] Automatic CFL correction applied (count: 24300):
361.0s 4340 Calculated CFL: 0.800 > Limit: 0.500
361.0s 4341 Original dt: 4.114980e-01 s
361.0s 4342 Corrected dt: 2.571863e-01 s
361.0s 4343 Correction factor: 1.6x
361.0s 4344 Max wave speed detected: 19.44 m/s
361.0s 4345 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
361.4s 4346 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
361.9s 4347 [WARNING] Automatic CFL correction applied (count: 24400):
361.9s 4348 Calculated CFL: 0.800 > Limit: 0.500
361.9s 4349 Original dt: 4.114980e-01 s
361.9s 4350 Corrected dt: 2.571863e-01 s
361.9s 4351 Correction factor: 1.6x
361.9s 4352 Max wave speed detected: 19.44 m/s
361.9s 4353 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
362.0s 4354 Stored output at t = 300.0000 s (Step 1167)
362.0s 4355 
362.0s 4356 Simulation finished at t = 300.0000 s after 1167 steps.
362.0s 4357 Total runtime: 2.09 seconds.
362.0s 4358 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.75s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.75s/s]
362.0s 4359 2025-10-10 15:38:04 - INFO - run_control_simulation:384 -   Reward: -0.084800
362.0s 4360 2025-10-10 15:38:04 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
362.0s 4361 2025-10-10 15:38:04 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
362.0s 4362 2025-10-10 15:38:04 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
362.0s 4363 2025-10-10 15:38:04 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.491564e-02, max=7.500000e+00, std=6.627938e-01
362.0s 4364 2025-10-10 15:38:04 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
362.0s 4365 2025-10-10 15:38:04 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
362.0s 4366 2025-10-10 15:38:04 - INFO - run_control_simulation:418 -   State hash: 7207725450448882797
362.0s 4367 2025-10-10 15:38:04 - INFO - run_control_simulation:420 - ================================================================================
362.0s 4368 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=6.491564e-02
362.0s 4369 2025-10-10 15:38:04 - INFO - run_control_simulation:368 - ================================================================================
362.0s 4370 2025-10-10 15:38:04 - INFO - run_control_simulation:369 - STEP 5 START:
362.0s 4371 2025-10-10 15:38:04 - INFO - run_control_simulation:370 -   Controller: BaselineController
362.0s 4372 2025-10-10 15:38:04 - INFO - run_control_simulation:371 -   Action: 0.000000
362.0s 4373 2025-10-10 15:38:04 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
362.0s 4374 [BC UPDATE] left → phase 0 RED (reduced inflow)
362.0s 4375 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
362.0s 4376 Running simulation until t = 360.00 s, outputting every 60.00 s
362.3s 4377 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
362.8s 4378 [WARNING] Automatic CFL correction applied (count: 24500):
362.8s 4379 Calculated CFL: 0.800 > Limit: 0.500
362.8s 4380 Original dt: 4.114980e-01 s
362.8s 4381 Corrected dt: 2.571863e-01 s
362.8s 4382 Correction factor: 1.6x
362.8s 4383 Max wave speed detected: 19.44 m/s
362.8s 4384 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
363.2s 4385 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
363.7s 4386 [WARNING] Automatic CFL correction applied (count: 24600):
363.7s 4387 Calculated CFL: 0.800 > Limit: 0.500
363.7s 4388 Original dt: 4.114980e-01 s
363.7s 4389 Corrected dt: 2.571863e-01 s
363.7s 4390 Correction factor: 1.6x
363.7s 4391 Max wave speed detected: 19.44 m/s
363.7s 4392 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
364.1s 4393 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
364.1s 4394 Stored output at t = 360.0000 s (Step 1401)
364.1s 4395 
364.1s 4396 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.72s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.71s/s]
364.1s 4397 Simulation finished at t = 360.0000 s after 1401 steps.
364.1s 4398 Total runtime: 2.09 seconds.
364.1s 4399 2025-10-10 15:38:06 - INFO - run_control_simulation:384 -   Reward: 0.015200
364.1s 4400 2025-10-10 15:38:06 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
364.1s 4401 2025-10-10 15:38:06 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
364.1s 4402 2025-10-10 15:38:06 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
364.1s 4403 2025-10-10 15:38:06 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490386e-02, max=7.500000e+00, std=6.627949e-01
364.1s 4404 2025-10-10 15:38:06 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
364.1s 4405 2025-10-10 15:38:06 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
364.1s 4406 2025-10-10 15:38:06 - INFO - run_control_simulation:418 -   State hash: 1196415630927523208
364.1s 4407 2025-10-10 15:38:06 - INFO - run_control_simulation:420 - ================================================================================
364.1s 4408 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=6.490386e-02
364.1s 4409 2025-10-10 15:38:06 - INFO - run_control_simulation:368 - ================================================================================
364.1s 4410 2025-10-10 15:38:06 - INFO - run_control_simulation:369 - STEP 6 START:
364.1s 4411 2025-10-10 15:38:06 - INFO - run_control_simulation:370 -   Controller: BaselineController
364.1s 4412 2025-10-10 15:38:06 - INFO - run_control_simulation:371 -   Action: 1.000000
364.1s 4413 2025-10-10 15:38:06 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
364.1s 4414 [BC UPDATE] left → phase 1 GREEN (normal inflow)
364.1s 4415 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
364.1s 4416 Running simulation until t = 420.00 s, outputting every 60.00 s
364.6s 4417 [WARNING] Automatic CFL correction applied (count: 24700):
364.6s 4418 Calculated CFL: 0.800 > Limit: 0.500
364.6s 4419 Original dt: 4.114980e-01 s
364.6s 4420 Corrected dt: 2.571863e-01 s
364.6s 4421 Correction factor: 1.6x
364.6s 4422 Max wave speed detected: 19.44 m/s
364.6s 4423 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
365.0s 4424 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
365.4s 4425 [WARNING] Automatic CFL correction applied (count: 24800):
365.4s 4426 Calculated CFL: 0.800 > Limit: 0.500
365.4s 4427 Original dt: 4.114980e-01 s
365.4s 4428 Corrected dt: 2.571863e-01 s
365.4s 4429 Correction factor: 1.6x
365.4s 4430 Max wave speed detected: 19.44 m/s
365.5s 4431 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
365.9s 4432 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
366.2s 4433 Stored output at t = 420.0000 s (Step 1635)
366.2s 4434 
366.2s 4435 Simulation finished at t = 420.0000 s after 1635 steps.
366.2s 4436 Total runtime: 2.07 seconds.
366.2s 4437 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 29.02s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 29.02s/s]
366.2s 4438 2025-10-10 15:38:08 - INFO - run_control_simulation:384 -   Reward: -0.084800
366.2s 4439 2025-10-10 15:38:08 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
366.2s 4440 2025-10-10 15:38:08 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
366.2s 4441 2025-10-10 15:38:08 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
366.2s 4442 2025-10-10 15:38:08 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
366.2s 4443 2025-10-10 15:38:08 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
366.2s 4444 2025-10-10 15:38:08 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
366.2s 4445 2025-10-10 15:38:08 - INFO - run_control_simulation:418 -   State hash: 520437653656443529
366.2s 4446 2025-10-10 15:38:08 - INFO - run_control_simulation:420 - ================================================================================
366.2s 4447 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=6.490385e-02
366.2s 4448 2025-10-10 15:38:08 - INFO - run_control_simulation:368 - ================================================================================
366.2s 4449 2025-10-10 15:38:08 - INFO - run_control_simulation:369 - STEP 7 START:
366.2s 4450 2025-10-10 15:38:08 - INFO - run_control_simulation:370 -   Controller: BaselineController
366.2s 4451 2025-10-10 15:38:08 - INFO - run_control_simulation:371 -   Action: 0.000000
366.2s 4452 2025-10-10 15:38:08 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
366.2s 4453 [BC UPDATE] left → phase 0 RED (reduced inflow)
366.2s 4454 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
366.2s 4455 Running simulation until t = 480.00 s, outputting every 60.00 s
366.3s 4456 [WARNING] Automatic CFL correction applied (count: 24900):
366.3s 4457 Calculated CFL: 0.800 > Limit: 0.500
366.3s 4458 Original dt: 4.114980e-01 s
366.3s 4459 Corrected dt: 2.571863e-01 s
366.3s 4460 Correction factor: 1.6x
366.3s 4461 Max wave speed detected: 19.44 m/s
366.3s 4462 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
366.8s 4463 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
367.2s 4464 [WARNING] Automatic CFL correction applied (count: 25000):
367.2s 4465 Calculated CFL: 0.800 > Limit: 0.500
367.2s 4466 Original dt: 4.114980e-01 s
367.2s 4467 Corrected dt: 2.571863e-01 s
367.2s 4468 Correction factor: 1.6x
367.2s 4469 Max wave speed detected: 19.44 m/s
367.2s 4470 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
367.7s 4471 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
368.1s 4472 [WARNING] Automatic CFL correction applied (count: 25100):
368.1s 4473 Calculated CFL: 0.800 > Limit: 0.500
368.1s 4474 Original dt: 4.114980e-01 s
368.1s 4475 Corrected dt: 2.571863e-01 s
368.1s 4476 Correction factor: 1.6x
368.1s 4477 Max wave speed detected: 19.44 m/s
368.1s 4478 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
368.3s 4479 Stored output at t = 480.0000 s (Step 1869)
368.3s 4480 
368.3s 4481 Simulation finished at t = 480.0000 s after 1869 steps.
368.3s 4482 Total runtime: 2.08 seconds.
368.3s 4483 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.85s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.85s/s]
368.3s 4484 2025-10-10 15:38:10 - INFO - run_control_simulation:384 -   Reward: 0.015200
368.3s 4485 2025-10-10 15:38:10 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
368.3s 4486 2025-10-10 15:38:10 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
368.3s 4487 2025-10-10 15:38:10 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
368.3s 4488 2025-10-10 15:38:10 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
368.3s 4489 2025-10-10 15:38:10 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
368.3s 4490 2025-10-10 15:38:10 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
368.3s 4491 2025-10-10 15:38:10 - INFO - run_control_simulation:418 -   State hash: 8623129180136888675
368.3s 4492 2025-10-10 15:38:10 - INFO - run_control_simulation:420 - ================================================================================
368.3s 4493 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=6.490385e-02
368.3s 4494 2025-10-10 15:38:10 - INFO - run_control_simulation:368 - ================================================================================
368.3s 4495 2025-10-10 15:38:10 - INFO - run_control_simulation:369 - STEP 8 START:
368.3s 4496 2025-10-10 15:38:10 - INFO - run_control_simulation:370 -   Controller: BaselineController
368.3s 4497 2025-10-10 15:38:10 - INFO - run_control_simulation:371 -   Action: 1.000000
368.3s 4498 2025-10-10 15:38:10 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
368.3s 4499 [BC UPDATE] left → phase 1 GREEN (normal inflow)
368.3s 4500 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
368.3s 4501 Running simulation until t = 540.00 s, outputting every 60.00 s
368.6s 4502 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
369.0s 4503 [WARNING] Automatic CFL correction applied (count: 25200):
369.0s 4504 Calculated CFL: 0.800 > Limit: 0.500
369.0s 4505 Original dt: 4.114980e-01 s
369.0s 4506 Corrected dt: 2.571863e-01 s
369.0s 4507 Correction factor: 1.6x
369.0s 4508 Max wave speed detected: 19.44 m/s
369.0s 4509 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
369.5s 4510 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
369.9s 4511 [WARNING] Automatic CFL correction applied (count: 25300):
369.9s 4512 Calculated CFL: 0.800 > Limit: 0.500
369.9s 4513 Original dt: 4.114980e-01 s
369.9s 4514 Corrected dt: 2.571863e-01 s
369.9s 4515 Correction factor: 1.6x
369.9s 4516 Max wave speed detected: 19.44 m/s
370.0s 4517 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
370.4s 4518 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
370.4s 4519 Stored output at t = 540.0000 s (Step 2103)
370.4s 4520 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.27s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.27s/s]
370.4s 4521 
370.4s 4522 Simulation finished at t = 540.0000 s after 2103 steps.
370.4s 4523 Total runtime: 2.12 seconds.
370.4s 4524 2025-10-10 15:38:12 - INFO - run_control_simulation:384 -   Reward: -0.084800
370.4s 4525 2025-10-10 15:38:12 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
370.4s 4526 2025-10-10 15:38:12 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
370.4s 4527 2025-10-10 15:38:12 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
370.4s 4528 2025-10-10 15:38:12 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
370.4s 4529 2025-10-10 15:38:12 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
370.4s 4530 2025-10-10 15:38:12 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
370.4s 4531 2025-10-10 15:38:12 - INFO - run_control_simulation:418 -   State hash: 2211501012166747443
370.4s 4532 2025-10-10 15:38:12 - INFO - run_control_simulation:420 - ================================================================================
370.4s 4533 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=6.490385e-02
370.4s 4534 2025-10-10 15:38:12 - INFO - run_control_simulation:368 - ================================================================================
370.4s 4535 2025-10-10 15:38:12 - INFO - run_control_simulation:369 - STEP 9 START:
370.4s 4536 2025-10-10 15:38:12 - INFO - run_control_simulation:370 -   Controller: BaselineController
370.4s 4537 2025-10-10 15:38:12 - INFO - run_control_simulation:371 -   Action: 0.000000
370.4s 4538 2025-10-10 15:38:12 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
370.4s 4539 [BC UPDATE] left → phase 0 RED (reduced inflow)
370.4s 4540 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
370.4s 4541 Running simulation until t = 600.00 s, outputting every 60.00 s
370.8s 4542 [WARNING] Automatic CFL correction applied (count: 25400):
370.8s 4543 Calculated CFL: 0.800 > Limit: 0.500
370.8s 4544 Original dt: 4.114980e-01 s
370.8s 4545 Corrected dt: 2.571863e-01 s
370.8s 4546 Correction factor: 1.6x
370.8s 4547 Max wave speed detected: 19.44 m/s
370.8s 4548 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
371.3s 4549 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
371.7s 4550 [WARNING] Automatic CFL correction applied (count: 25500):
371.7s 4551 Calculated CFL: 0.800 > Limit: 0.500
371.7s 4552 Original dt: 4.114980e-01 s
371.7s 4553 Corrected dt: 2.571863e-01 s
371.7s 4554 Correction factor: 1.6x
371.7s 4555 Max wave speed detected: 19.44 m/s
371.7s 4556 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
372.2s 4557 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
372.5s 4558 Stored output at t = 600.0000 s (Step 2337)
372.5s 4559 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.71s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.71s/s]
372.5s 4560 
372.5s 4561 Simulation finished at t = 600.0000 s after 2337 steps.
372.5s 4562 Total runtime: 2.09 seconds.
372.5s 4563 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
372.5s 4564 2025-10-10 15:38:14 - INFO - run_control_simulation:384 -   Reward: 0.015200
372.5s 4565 2025-10-10 15:38:14 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
372.5s 4566 2025-10-10 15:38:14 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
372.5s 4567 2025-10-10 15:38:14 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
372.5s 4568 2025-10-10 15:38:14 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
372.5s 4569 2025-10-10 15:38:14 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
372.5s 4570 2025-10-10 15:38:14 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
372.5s 4571 2025-10-10 15:38:14 - INFO - run_control_simulation:418 -   State hash: 5866636032397366687
372.5s 4572 2025-10-10 15:38:14 - INFO - run_control_simulation:420 - ================================================================================
372.5s 4573 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.490385e-02
372.5s 4574 
372.5s 4575 [SIMULATION COMPLETED] Summary:
372.5s 4576 - Total control steps: 10
372.5s 4577 - Total reward: -0.35
372.5s 4578 - Avg step time: 2.089s (device=gpu)
372.5s 4579 - Simulated time: 600.0s / 600.0s
372.5s 4580 - Wallclock time: 20.9s
372.5s 4581 - Speed ratio: 28.73x real-time
372.5s 4582 
372.5s 4583 2025-10-10 15:38:14 - INFO - run_control_simulation:455 -
372.5s 4584 [SIMULATION COMPLETED] Summary:
372.5s 4585 - Total control steps: 10
372.5s 4586 - Total reward: -0.35
372.5s 4587 - Avg step time: 2.089s (device=gpu)
372.5s 4588 - Simulated time: 600.0s / 600.0s
372.5s 4589 - Wallclock time: 20.9s
372.5s 4590 - Speed ratio: 28.73x real-time
372.5s 4591 
372.5s 4592 2025-10-10 15:38:14 - INFO - run_control_simulation:456 - Returning 10 state snapshots
372.5s 4593 2025-10-10 15:38:14 - INFO - run_performance_comparison:725 - Baseline states copied: 10 snapshots
372.5s 4594 2025-10-10 15:38:14 - INFO - run_performance_comparison:726 - Baseline FIRST state hash: -8204528842174014379
372.5s 4595 2025-10-10 15:38:14 - INFO - run_performance_comparison:727 - Baseline LAST state hash: 5866636032397366687
372.5s 4596 2025-10-10 15:38:14 - INFO - run_performance_comparison:728 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
372.5s 4597 2.14351577e-05]
372.5s 4598 2025-10-10 15:38:14 - INFO - run_performance_comparison:729 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
372.5s 4599 2.14319923e-05]
372.5s 4600 2025-10-10 15:38:14 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
372.5s 4601 2025-10-10 15:38:14 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=-8204528842174014379, last=5866636032397366687
372.5s 4602 2025-10-10 15:38:14 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
372.5s 4603 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
372.5s 4604 2025-10-10 15:38:14 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
372.5s 4605 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
372.5s 4606 2025-10-10 15:38:14 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
372.5s 4607 Running RL controller...
372.5s 4608 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
372.5s 4609 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
372.5s 4610 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
372.5s 4611 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
372.5s 4612 2025-10-10 15:38:14 - INFO - run_control_simulation:286 - ================================================================================
372.5s 4613 2025-10-10 15:38:14 - INFO - run_control_simulation:287 - Starting run_control_simulation:
372.5s 4614 2025-10-10 15:38:14 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
372.5s 4615 2025-10-10 15:38:14 - INFO - run_control_simulation:289 -   - duration: 600.0s
372.5s 4616 2025-10-10 15:38:14 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
372.5s 4617 2025-10-10 15:38:14 - INFO - run_control_simulation:291 -   - device: gpu
372.5s 4618 2025-10-10 15:38:14 - INFO - run_control_simulation:292 -   - controller: RLController
372.5s 4619 2025-10-10 15:38:14 - INFO - run_control_simulation:293 -   - max_control_steps: 11
372.5s 4620 2025-10-10 15:38:14 - INFO - run_control_simulation:294 - ================================================================================
372.5s 4621 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
372.5s 4622 2025-10-10 15:38:14 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
372.5s 4623 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
372.5s 4624 Using device: gpu
372.5s 4625 DEBUG PARAMS: Reading K_m_kmh = 10.0
372.5s 4626 DEBUG PARAMS: Reading K_c_kmh = 15.0
372.5s 4627 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
372.5s 4628 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
372.5s 4629 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
372.5s 4630 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
372.5s 4631 Loading road quality type: uniform
372.5s 4632 Uniform road quality value: 2
372.5s 4633 Road quality loaded.
372.5s 4634 Initial state created.
372.5s 4635 Transferring initial state and road quality to GPU...
372.5s 4636 GPU data transfer complete.
372.5s 4637 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
372.5s 4638 Initial boundary conditions applied.
372.5s 4639 TrafficSignalEnvDirect initialized:
372.5s 4640 Decision interval: 60.0s
372.5s 4641 Observation segments: 6
372.5s 4642 Observation space: (26,)
372.5s 4643 Action space: 2
372.5s 4644 Device: gpu
372.5s 4645 2025-10-10 15:38:15 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
372.5s 4646 2025-10-10 15:38:15 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
372.5s 4647 [INFO] Calling env.reset()...
372.5s 4648 2025-10-10 15:38:15 - INFO - run_control_simulation:331 - Calling env.reset()...
372.5s 4649 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
372.5s 4650 Using device: gpu
372.6s 4651 DEBUG PARAMS: Reading K_m_kmh = 10.0
372.6s 4652 DEBUG PARAMS: Reading K_c_kmh = 15.0
372.6s 4653 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
372.6s 4654 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
372.6s 4655 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
372.6s 4656 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
372.6s 4657 Loading road quality type: uniform
372.6s 4658 Uniform road quality value: 2
372.6s 4659 Road quality loaded.
372.6s 4660 Initial state created.
372.6s 4661 Transferring initial state and road quality to GPU...
372.6s 4662 GPU data transfer complete.
372.6s 4663 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
372.6s 4664 Initial boundary conditions applied.
372.6s 4665 [BC UPDATE] left → phase 0 RED (reduced inflow)
372.6s 4666 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
372.6s 4667 2025-10-10 15:38:15 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
372.6s 4668 2025-10-10 15:38:15 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
372.6s 4669 2025-10-10 15:38:15 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
372.6s 4670 [INFO] Starting simulation loop (max 11 control steps)
372.6s 4671 2025-10-10 15:38:15 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
372.6s 4672 2025-10-10 15:38:15 - INFO - run_control_simulation:368 - ================================================================================
372.6s 4673 2025-10-10 15:38:15 - INFO - run_control_simulation:369 - STEP 0 START:
372.6s 4674 2025-10-10 15:38:15 - INFO - run_control_simulation:370 -   Controller: RLController
372.6s 4675 2025-10-10 15:38:15 - INFO - run_control_simulation:371 -   Action: 0.000000
372.6s 4676 2025-10-10 15:38:15 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
372.6s 4677 [BC UPDATE] left → phase 0 RED (reduced inflow)
372.6s 4678 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
372.6s 4679 Running simulation until t = 60.00 s, outputting every 60.00 s
372.7s 4680 [WARNING] Automatic CFL correction applied (count: 25600):
372.7s 4681 Calculated CFL: 0.800 > Limit: 0.500
372.7s 4682 Original dt: 3.909130e-01 s
372.7s 4683 Corrected dt: 2.443206e-01 s
372.7s 4684 Correction factor: 1.6x
372.7s 4685 Max wave speed detected: 20.46 m/s
373.0s 4686 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
373.4s 4687 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
373.6s 4688 [WARNING] Automatic CFL correction applied (count: 25700):
373.6s 4689 Calculated CFL: 0.800 > Limit: 0.500
373.6s 4690 Original dt: 4.131708e-01 s
373.6s 4691 Corrected dt: 2.582317e-01 s
373.6s 4692 Correction factor: 1.6x
373.6s 4693 Max wave speed detected: 19.36 m/s
373.9s 4694 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
374.3s 4695 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
374.5s 4696 [WARNING] Automatic CFL correction applied (count: 25800):
374.5s 4697 Calculated CFL: 0.800 > Limit: 0.500
374.5s 4698 Original dt: 4.115220e-01 s
374.5s 4699 Corrected dt: 2.572013e-01 s
374.5s 4700 Correction factor: 1.6x
374.5s 4701 Max wave speed detected: 19.44 m/s
374.6s 4702 Stored output at t = 60.0000 s (Step 231)
374.6s 4703 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.12s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.12s/s]
374.6s 4704 
374.6s 4705 Simulation finished at t = 60.0000 s after 231 steps.
374.6s 4706 Total runtime: 2.06 seconds.
374.6s 4707 2025-10-10 15:38:17 - INFO - run_control_simulation:384 -   Reward: 0.015201
374.6s 4708 2025-10-10 15:38:17 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
374.6s 4709 2025-10-10 15:38:17 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
374.6s 4710 2025-10-10 15:38:17 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
374.6s 4711 2025-10-10 15:38:17 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.609084e+00, max=1.233795e+01, std=4.039166e+00
374.6s 4712 2025-10-10 15:38:17 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
374.6s 4713 2025-10-10 15:38:17 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.262455, w_c=11.210112
374.6s 4714 2025-10-10 15:38:17 - INFO - run_control_simulation:418 -   State hash: 2285101618595884452
374.6s 4715 2025-10-10 15:38:17 - INFO - run_control_simulation:420 - ================================================================================
374.6s 4716 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.609084e+00
374.6s 4717 2025-10-10 15:38:17 - INFO - run_control_simulation:368 - ================================================================================
374.6s 4718 2025-10-10 15:38:17 - INFO - run_control_simulation:369 - STEP 1 START:
374.6s 4719 2025-10-10 15:38:17 - INFO - run_control_simulation:370 -   Controller: RLController
374.6s 4720 2025-10-10 15:38:17 - INFO - run_control_simulation:371 -   Action: 0.000000
374.6s 4721 2025-10-10 15:38:17 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
374.6s 4722 [BC UPDATE] left → phase 0 RED (reduced inflow)
374.6s 4723 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
374.6s 4724 Running simulation until t = 120.00 s, outputting every 60.00 s
374.8s 4725 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
375.2s 4726 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
375.3s 4727 [WARNING] Automatic CFL correction applied (count: 25900):
375.3s 4728 Calculated CFL: 0.800 > Limit: 0.500
375.3s 4729 Original dt: 4.114985e-01 s
375.3s 4730 Corrected dt: 2.571865e-01 s
375.3s 4731 Correction factor: 1.6x
375.3s 4732 Max wave speed detected: 19.44 m/s
375.7s 4733 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
376.1s 4734 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
376.2s 4735 [WARNING] Automatic CFL correction applied (count: 26000):
376.2s 4736 Calculated CFL: 0.800 > Limit: 0.500
376.2s 4737 Original dt: 4.114980e-01 s
376.2s 4738 Corrected dt: 2.571863e-01 s
376.2s 4739 Correction factor: 1.6x
376.2s 4740 Max wave speed detected: 19.44 m/s
376.6s 4741 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
376.7s 4742 Stored output at t = 120.0000 s (Step 465)
376.7s 4743 
376.7s 4744 Simulation finished at t = 120.0000 s after 465 steps.
376.7s 4745 Total runtime: 2.09 seconds.
376.7s 4746 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.75s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.75s/s]
376.7s 4747 2025-10-10 15:38:19 - INFO - run_control_simulation:384 -   Reward: 0.015200
376.7s 4748 2025-10-10 15:38:19 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
376.7s 4749 2025-10-10 15:38:19 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
376.7s 4750 2025-10-10 15:38:19 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
376.7s 4751 2025-10-10 15:38:19 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
376.7s 4752 2025-10-10 15:38:19 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
376.7s 4753 2025-10-10 15:38:19 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.773789, w_c=13.986264
376.7s 4754 2025-10-10 15:38:19 - INFO - run_control_simulation:418 -   State hash: -851592242138840727
376.7s 4755 2025-10-10 15:38:19 - INFO - run_control_simulation:420 - ================================================================================
376.7s 4756 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
376.7s 4757 2025-10-10 15:38:19 - INFO - run_control_simulation:368 - ================================================================================
376.7s 4758 2025-10-10 15:38:19 - INFO - run_control_simulation:369 - STEP 2 START:
376.7s 4759 2025-10-10 15:38:19 - INFO - run_control_simulation:370 -   Controller: RLController
376.7s 4760 2025-10-10 15:38:19 - INFO - run_control_simulation:371 -   Action: 0.000000
376.7s 4761 2025-10-10 15:38:19 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
376.7s 4762 [BC UPDATE] left → phase 0 RED (reduced inflow)
376.7s 4763 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
376.7s 4764 Running simulation until t = 180.00 s, outputting every 60.00 s
377.0s 4765 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
377.1s 4766 [WARNING] Automatic CFL correction applied (count: 26100):
377.1s 4767 Calculated CFL: 0.800 > Limit: 0.500
377.1s 4768 Original dt: 4.114980e-01 s
377.1s 4769 Corrected dt: 2.571863e-01 s
377.1s 4770 Correction factor: 1.6x
377.1s 4771 Max wave speed detected: 19.44 m/s
377.5s 4772 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
377.9s 4773 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
378.0s 4774 [WARNING] Automatic CFL correction applied (count: 26200):
378.0s 4775 Calculated CFL: 0.800 > Limit: 0.500
378.0s 4776 Original dt: 4.114980e-01 s
378.0s 4777 Corrected dt: 2.571863e-01 s
378.0s 4778 Correction factor: 1.6x
378.0s 4779 Max wave speed detected: 19.44 m/s
378.3s 4780 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
378.8s 4781 Stored output at t = 180.0000 s (Step 699)
378.8s 4782 
378.8s 4783 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 29.23s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 29.22s/s]
378.8s 4784 Simulation finished at t = 180.0000 s after 699 steps.
378.8s 4785 Total runtime: 2.05 seconds.
378.8s 4786 2025-10-10 15:38:21 - INFO - run_control_simulation:384 -   Reward: 0.015200
378.8s 4787 2025-10-10 15:38:21 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
378.8s 4788 2025-10-10 15:38:21 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
378.8s 4789 2025-10-10 15:38:21 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
378.8s 4790 2025-10-10 15:38:21 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
378.8s 4791 2025-10-10 15:38:21 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
378.8s 4792 2025-10-10 15:38:21 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
378.8s 4793 2025-10-10 15:38:21 - INFO - run_control_simulation:418 -   State hash: -7460023198100560537
378.8s 4794 2025-10-10 15:38:21 - INFO - run_control_simulation:420 - ================================================================================
378.8s 4795 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
378.8s 4796 2025-10-10 15:38:21 - INFO - run_control_simulation:368 - ================================================================================
378.8s 4797 2025-10-10 15:38:21 - INFO - run_control_simulation:369 - STEP 3 START:
378.8s 4798 2025-10-10 15:38:21 - INFO - run_control_simulation:370 -   Controller: RLController
378.8s 4799 2025-10-10 15:38:21 - INFO - run_control_simulation:371 -   Action: 0.000000
378.8s 4800 2025-10-10 15:38:21 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
378.8s 4801 [BC UPDATE] left → phase 0 RED (reduced inflow)
378.8s 4802 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
378.8s 4803 Running simulation until t = 240.00 s, outputting every 60.00 s
378.8s 4804 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
378.9s 4805 [WARNING] Automatic CFL correction applied (count: 26300):
378.9s 4806 Calculated CFL: 0.800 > Limit: 0.500
378.9s 4807 Original dt: 4.114980e-01 s
378.9s 4808 Corrected dt: 2.571863e-01 s
378.9s 4809 Correction factor: 1.6x
378.9s 4810 Max wave speed detected: 19.44 m/s
379.2s 4811 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
379.7s 4812 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
379.8s 4813 [WARNING] Automatic CFL correction applied (count: 26400):
379.8s 4814 Calculated CFL: 0.800 > Limit: 0.500
379.8s 4815 Original dt: 4.114980e-01 s
379.8s 4816 Corrected dt: 2.571863e-01 s
379.8s 4817 Correction factor: 1.6x
379.8s 4818 Max wave speed detected: 19.44 m/s
380.1s 4819 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
380.6s 4820 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
380.7s 4821 [WARNING] Automatic CFL correction applied (count: 26500):
380.7s 4822 Calculated CFL: 0.800 > Limit: 0.500
380.7s 4823 Original dt: 4.114980e-01 s
380.7s 4824 Corrected dt: 2.571863e-01 s
380.7s 4825 Correction factor: 1.6x
380.7s 4826 Max wave speed detected: 19.44 m/s
380.9s 4827 Stored output at t = 240.0000 s (Step 933)
380.9s 4828 
380.9s 4829 Simulation finished at t = 240.0000 s after 933 steps.
380.9s 4830 Total runtime: 2.09 seconds.
380.9s 4831 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.65s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.65s/s]
380.9s 4832 2025-10-10 15:38:23 - INFO - run_control_simulation:384 -   Reward: 0.015200
380.9s 4833 2025-10-10 15:38:23 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
380.9s 4834 2025-10-10 15:38:23 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
380.9s 4835 2025-10-10 15:38:23 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
380.9s 4836 2025-10-10 15:38:23 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
380.9s 4837 2025-10-10 15:38:23 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
380.9s 4838 2025-10-10 15:38:23 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
380.9s 4839 2025-10-10 15:38:23 - INFO - run_control_simulation:418 -   State hash: -1289862524979765567
380.9s 4840 2025-10-10 15:38:23 - INFO - run_control_simulation:420 - ================================================================================
380.9s 4841 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
380.9s 4842 2025-10-10 15:38:23 - INFO - run_control_simulation:368 - ================================================================================
380.9s 4843 2025-10-10 15:38:23 - INFO - run_control_simulation:369 - STEP 4 START:
380.9s 4844 2025-10-10 15:38:23 - INFO - run_control_simulation:370 -   Controller: RLController
380.9s 4845 2025-10-10 15:38:23 - INFO - run_control_simulation:371 -   Action: 0.000000
380.9s 4846 2025-10-10 15:38:23 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
380.9s 4847 [BC UPDATE] left → phase 0 RED (reduced inflow)
380.9s 4848 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
380.9s 4849 Running simulation until t = 300.00 s, outputting every 60.00 s
381.0s 4850 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
381.5s 4851 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
381.6s 4852 [WARNING] Automatic CFL correction applied (count: 26600):
381.6s 4853 Calculated CFL: 0.800 > Limit: 0.500
381.6s 4854 Original dt: 4.114980e-01 s
381.6s 4855 Corrected dt: 2.571863e-01 s
381.6s 4856 Correction factor: 1.6x
381.6s 4857 Max wave speed detected: 19.44 m/s
381.9s 4858 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
382.4s 4859 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
382.5s 4860 [WARNING] Automatic CFL correction applied (count: 26700):
382.5s 4861 Calculated CFL: 0.800 > Limit: 0.500
382.5s 4862 Original dt: 4.114980e-01 s
382.5s 4863 Corrected dt: 2.571863e-01 s
382.5s 4864 Correction factor: 1.6x
382.5s 4865 Max wave speed detected: 19.44 m/s
382.8s 4866 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
383.0s 4867 Stored output at t = 300.0000 s (Step 1167)
383.0s 4868 
383.0s 4869 Simulation finished at t = 300.0000 s after 1167 steps.
383.0s 4870 Total runtime: 2.08 seconds.
383.0s 4871 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.82s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.81s/s]
383.0s 4872 2025-10-10 15:38:25 - INFO - run_control_simulation:384 -   Reward: 0.015200
383.0s 4873 2025-10-10 15:38:25 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
383.0s 4874 2025-10-10 15:38:25 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
383.0s 4875 2025-10-10 15:38:25 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
383.0s 4876 2025-10-10 15:38:25 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
383.0s 4877 2025-10-10 15:38:25 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
383.0s 4878 2025-10-10 15:38:25 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
383.0s 4879 2025-10-10 15:38:25 - INFO - run_control_simulation:418 -   State hash: 7123124193051364506
383.0s 4880 2025-10-10 15:38:25 - INFO - run_control_simulation:420 - ================================================================================
383.0s 4881 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
383.0s 4882 2025-10-10 15:38:25 - INFO - run_control_simulation:368 - ================================================================================
383.0s 4883 2025-10-10 15:38:25 - INFO - run_control_simulation:369 - STEP 5 START:
383.0s 4884 2025-10-10 15:38:25 - INFO - run_control_simulation:370 -   Controller: RLController
383.0s 4885 2025-10-10 15:38:25 - INFO - run_control_simulation:371 -   Action: 0.000000
383.0s 4886 2025-10-10 15:38:25 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
383.0s 4887 [BC UPDATE] left → phase 0 RED (reduced inflow)
383.0s 4888 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
383.0s 4889 Running simulation until t = 360.00 s, outputting every 60.00 s
383.3s 4890 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
383.4s 4891 [WARNING] Automatic CFL correction applied (count: 26800):
383.4s 4892 Calculated CFL: 0.800 > Limit: 0.500
383.4s 4893 Original dt: 4.114980e-01 s
383.4s 4894 Corrected dt: 2.571863e-01 s
383.4s 4895 Correction factor: 1.6x
383.4s 4896 Max wave speed detected: 19.44 m/s
383.7s 4897 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
384.1s 4898 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
384.2s 4899 [WARNING] Automatic CFL correction applied (count: 26900):
384.2s 4900 Calculated CFL: 0.800 > Limit: 0.500
384.2s 4901 Original dt: 4.114980e-01 s
384.2s 4902 Corrected dt: 2.571863e-01 s
384.2s 4903 Correction factor: 1.6x
384.2s 4904 Max wave speed detected: 19.44 m/s
384.6s 4905 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
385.0s 4906 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
385.0s 4907 Stored output at t = 360.0000 s (Step 1401)
385.0s 4908 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 29.31s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 29.30s/s]
385.0s 4909 
385.0s 4910 Simulation finished at t = 360.0000 s after 1401 steps.
385.0s 4911 Total runtime: 2.05 seconds.
385.0s 4912 2025-10-10 15:38:27 - INFO - run_control_simulation:384 -   Reward: 0.015200
385.0s 4913 2025-10-10 15:38:27 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
385.0s 4914 2025-10-10 15:38:27 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
385.0s 4915 2025-10-10 15:38:27 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
385.0s 4916 2025-10-10 15:38:27 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
385.0s 4917 2025-10-10 15:38:27 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
385.0s 4918 2025-10-10 15:38:27 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
385.0s 4919 2025-10-10 15:38:27 - INFO - run_control_simulation:418 -   State hash: 1196415630927523208
385.0s 4920 2025-10-10 15:38:27 - INFO - run_control_simulation:420 - ================================================================================
385.0s 4921 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
385.0s 4922 2025-10-10 15:38:27 - INFO - run_control_simulation:368 - ================================================================================
385.0s 4923 2025-10-10 15:38:27 - INFO - run_control_simulation:369 - STEP 6 START:
385.0s 4924 2025-10-10 15:38:27 - INFO - run_control_simulation:370 -   Controller: RLController
385.0s 4925 2025-10-10 15:38:27 - INFO - run_control_simulation:371 -   Action: 0.000000
385.0s 4926 2025-10-10 15:38:27 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
385.0s 4927 [BC UPDATE] left → phase 0 RED (reduced inflow)
385.0s 4928 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
385.0s 4929 Running simulation until t = 420.00 s, outputting every 60.00 s
385.1s 4930 [WARNING] Automatic CFL correction applied (count: 27000):
385.1s 4931 Calculated CFL: 0.800 > Limit: 0.500
385.1s 4932 Original dt: 4.114980e-01 s
385.1s 4933 Corrected dt: 2.571863e-01 s
385.1s 4934 Correction factor: 1.6x
385.1s 4935 Max wave speed detected: 19.44 m/s
385.4s 4936 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
385.9s 4937 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
386.0s 4938 [WARNING] Automatic CFL correction applied (count: 27100):
386.0s 4939 Calculated CFL: 0.800 > Limit: 0.500
386.0s 4940 Original dt: 4.114980e-01 s
386.0s 4941 Corrected dt: 2.571863e-01 s
386.0s 4942 Correction factor: 1.6x
386.0s 4943 Max wave speed detected: 19.44 m/s
386.3s 4944 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
386.8s 4945 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
386.9s 4946 [WARNING] Automatic CFL correction applied (count: 27200):
386.9s 4947 Calculated CFL: 0.800 > Limit: 0.500
386.9s 4948 Original dt: 4.114980e-01 s
386.9s 4949 Corrected dt: 2.571863e-01 s
386.9s 4950 Correction factor: 1.6x
386.9s 4951 Max wave speed detected: 19.44 m/s
387.1s 4952 Stored output at t = 420.0000 s (Step 1635)
387.1s 4953 
387.1s 4954 Simulation finished at t = 420.0000 s after 1635 steps.
387.1s 4955 Total runtime: 2.04 seconds.
387.1s 4956 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 29.35s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 29.35s/s]
387.1s 4957 2025-10-10 15:38:29 - INFO - run_control_simulation:384 -   Reward: 0.015200
387.1s 4958 2025-10-10 15:38:29 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
387.1s 4959 2025-10-10 15:38:29 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
387.1s 4960 2025-10-10 15:38:29 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
387.1s 4961 2025-10-10 15:38:29 - INFO - run_control_simulation:403 -     Diff statistics: mean=2.295402e-11, max=7.384955e-10, std=9.818588e-11
387.1s 4962 2025-10-10 15:38:29 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
387.1s 4963 2025-10-10 15:38:29 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
387.1s 4964 2025-10-10 15:38:29 - INFO - run_control_simulation:418 -   State hash: 525272542244267254
387.1s 4965 2025-10-10 15:38:29 - INFO - run_control_simulation:420 - ================================================================================
387.1s 4966 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295402e-11
387.1s 4967 2025-10-10 15:38:29 - INFO - run_control_simulation:368 - ================================================================================
387.1s 4968 2025-10-10 15:38:29 - INFO - run_control_simulation:369 - STEP 7 START:
387.1s 4969 2025-10-10 15:38:29 - INFO - run_control_simulation:370 -   Controller: RLController
387.1s 4970 2025-10-10 15:38:29 - INFO - run_control_simulation:371 -   Action: 0.000000
387.1s 4971 2025-10-10 15:38:29 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
387.1s 4972 [BC UPDATE] left → phase 0 RED (reduced inflow)
387.1s 4973 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
387.1s 4974 Running simulation until t = 480.00 s, outputting every 60.00 s
387.2s 4975 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
387.6s 4976 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
387.7s 4977 [WARNING] Automatic CFL correction applied (count: 27300):
387.7s 4978 Calculated CFL: 0.800 > Limit: 0.500
387.7s 4979 Original dt: 4.114980e-01 s
387.7s 4980 Corrected dt: 2.571863e-01 s
387.7s 4981 Correction factor: 1.6x
387.7s 4982 Max wave speed detected: 19.44 m/s
388.1s 4983 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
388.5s 4984 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
388.6s 4985 [WARNING] Automatic CFL correction applied (count: 27400):
388.6s 4986 Calculated CFL: 0.800 > Limit: 0.500
388.6s 4987 Original dt: 4.114980e-01 s
388.6s 4988 Corrected dt: 2.571863e-01 s
388.6s 4989 Correction factor: 1.6x
388.6s 4990 Max wave speed detected: 19.44 m/s
388.9s 4991 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
389.1s 4992 Stored output at t = 480.0000 s (Step 1869)
389.1s 4993 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 29.33s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 29.33s/s]
389.1s 4994 
389.1s 4995 Simulation finished at t = 480.0000 s after 1869 steps.
389.1s 4996 Total runtime: 2.05 seconds.
389.1s 4997 2025-10-10 15:38:31 - INFO - run_control_simulation:384 -   Reward: 0.015200
389.1s 4998 2025-10-10 15:38:31 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
389.1s 4999 2025-10-10 15:38:31 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
389.1s 5000 2025-10-10 15:38:31 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
389.1s 5001 2025-10-10 15:38:31 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
389.1s 5002 2025-10-10 15:38:31 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
389.1s 5003 2025-10-10 15:38:31 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
389.1s 5004 2025-10-10 15:38:31 - INFO - run_control_simulation:418 -   State hash: 8623129180136888675
389.1s 5005 2025-10-10 15:38:31 - INFO - run_control_simulation:420 - ================================================================================
389.1s 5006 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
389.1s 5007 2025-10-10 15:38:31 - INFO - run_control_simulation:368 - ================================================================================
389.1s 5008 2025-10-10 15:38:31 - INFO - run_control_simulation:369 - STEP 8 START:
389.1s 5009 2025-10-10 15:38:31 - INFO - run_control_simulation:370 -   Controller: RLController
389.1s 5010 2025-10-10 15:38:31 - INFO - run_control_simulation:371 -   Action: 0.000000
389.1s 5011 2025-10-10 15:38:31 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
389.1s 5012 [BC UPDATE] left → phase 0 RED (reduced inflow)
389.1s 5013 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
389.1s 5014 Running simulation until t = 540.00 s, outputting every 60.00 s
389.4s 5015 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
389.5s 5016 [WARNING] Automatic CFL correction applied (count: 27500):
389.5s 5017 Calculated CFL: 0.800 > Limit: 0.500
389.5s 5018 Original dt: 4.114980e-01 s
389.5s 5019 Corrected dt: 2.571863e-01 s
389.5s 5020 Correction factor: 1.6x
389.5s 5021 Max wave speed detected: 19.44 m/s
389.8s 5022 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
390.3s 5023 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
390.4s 5024 [WARNING] Automatic CFL correction applied (count: 27600):
390.4s 5025 Calculated CFL: 0.800 > Limit: 0.500
390.4s 5026 Original dt: 4.114980e-01 s
390.4s 5027 Corrected dt: 2.571863e-01 s
390.4s 5028 Correction factor: 1.6x
390.4s 5029 Max wave speed detected: 19.44 m/s
390.7s 5030 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
391.1s 5031 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
391.2s 5032 Stored output at t = 540.0000 s (Step 2103)
391.2s 5033 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 29.35s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 29.35s/s]
391.2s 5034 
391.2s 5035 Simulation finished at t = 540.0000 s after 2103 steps.
391.2s 5036 Total runtime: 2.04 seconds.
391.2s 5037 2025-10-10 15:38:33 - INFO - run_control_simulation:384 -   Reward: 0.015200
391.2s 5038 2025-10-10 15:38:33 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
391.2s 5039 2025-10-10 15:38:33 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
391.2s 5040 2025-10-10 15:38:33 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
391.2s 5041 2025-10-10 15:38:33 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
391.2s 5042 2025-10-10 15:38:33 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
391.2s 5043 2025-10-10 15:38:33 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
391.2s 5044 2025-10-10 15:38:33 - INFO - run_control_simulation:418 -   State hash: 6646382753316253049
391.2s 5045 2025-10-10 15:38:33 - INFO - run_control_simulation:420 - ================================================================================
391.2s 5046 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
391.2s 5047 2025-10-10 15:38:33 - INFO - run_control_simulation:368 - ================================================================================
391.2s 5048 2025-10-10 15:38:33 - INFO - run_control_simulation:369 - STEP 9 START:
391.2s 5049 2025-10-10 15:38:33 - INFO - run_control_simulation:370 -   Controller: RLController
391.2s 5050 2025-10-10 15:38:33 - INFO - run_control_simulation:371 -   Action: 0.000000
391.2s 5051 2025-10-10 15:38:33 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
391.2s 5052 [BC UPDATE] left → phase 0 RED (reduced inflow)
391.2s 5053 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
391.2s 5054 Running simulation until t = 600.00 s, outputting every 60.00 s
391.2s 5055 [WARNING] Automatic CFL correction applied (count: 27700):
391.2s 5056 Calculated CFL: 0.800 > Limit: 0.500
391.2s 5057 Original dt: 4.114980e-01 s
391.2s 5058 Corrected dt: 2.571863e-01 s
391.2s 5059 Correction factor: 1.6x
391.2s 5060 Max wave speed detected: 19.44 m/s
391.6s 5061 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
392.0s 5062 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
392.1s 5063 [WARNING] Automatic CFL correction applied (count: 27800):
392.1s 5064 Calculated CFL: 0.800 > Limit: 0.500
392.1s 5065 Original dt: 4.114980e-01 s
392.1s 5066 Corrected dt: 2.571863e-01 s
392.1s 5067 Correction factor: 1.6x
392.1s 5068 Max wave speed detected: 19.44 m/s
392.5s 5069 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
392.9s 5070 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
393.0s 5071 [WARNING] Automatic CFL correction applied (count: 27900):
393.0s 5072 Calculated CFL: 0.800 > Limit: 0.500
393.0s 5073 Original dt: 4.114980e-01 s
393.0s 5074 Corrected dt: 2.571863e-01 s
393.0s 5075 Correction factor: 1.6x
393.0s 5076 Max wave speed detected: 19.44 m/s
393.2s 5077 Stored output at t = 600.0000 s (Step 2337)
393.2s 5078 
393.2s 5079 Simulation finished at t = 600.0000 s after 2337 steps.
393.2s 5080 Total runtime: 2.07 seconds.
393.2s 5081 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 29.02s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 29.02s/s]
393.2s 5082 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
393.2s 5083 2025-10-10 15:38:35 - INFO - run_control_simulation:384 -   Reward: 0.015200
393.2s 5084 2025-10-10 15:38:35 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
393.2s 5085 2025-10-10 15:38:35 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
393.2s 5086 2025-10-10 15:38:35 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
393.2s 5087 2025-10-10 15:38:35 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
393.2s 5088 2025-10-10 15:38:35 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
393.2s 5089 2025-10-10 15:38:35 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
393.2s 5090 2025-10-10 15:38:35 - INFO - run_control_simulation:418 -   State hash: 5866636032397366687
393.2s 5091 2025-10-10 15:38:35 - INFO - run_control_simulation:420 - ================================================================================
393.2s 5092 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
393.2s 5093 
393.2s 5094 [SIMULATION COMPLETED] Summary:
393.2s 5095 - Total control steps: 10
393.2s 5096 - Total reward: 0.15
393.2s 5097 - Avg step time: 2.068s (device=gpu)
393.2s 5098 - Simulated time: 600.0s / 600.0s
393.2s 5099 - Wallclock time: 20.7s
393.2s 5100 - Speed ratio: 29.02x real-time
393.2s 5101 
393.2s 5102 2025-10-10 15:38:35 - INFO - run_control_simulation:455 -
393.2s 5103 [SIMULATION COMPLETED] Summary:
393.2s 5104 - Total control steps: 10
393.2s 5105 - Total reward: 0.15
393.2s 5106 - Avg step time: 2.068s (device=gpu)
393.2s 5107 - Simulated time: 600.0s / 600.0s
393.2s 5108 - Wallclock time: 20.7s
393.2s 5109 - Speed ratio: 29.02x real-time
393.2s 5110 
393.2s 5111 2025-10-10 15:38:35 - INFO - run_control_simulation:456 - Returning 10 state snapshots
393.2s 5112 2025-10-10 15:38:35 - INFO - run_performance_comparison:762 - RL states copied: 10 snapshots
393.2s 5113 2025-10-10 15:38:35 - INFO - run_performance_comparison:763 - RL FIRST state hash: 2285101618595884452
393.2s 5114 2025-10-10 15:38:35 - INFO - run_performance_comparison:764 - RL LAST state hash: 5866636032397366687
393.2s 5115 2025-10-10 15:38:35 - INFO - run_performance_comparison:765 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
393.2s 5116 2.14351577e-05]
393.2s 5117 2025-10-10 15:38:35 - INFO - run_performance_comparison:766 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
393.2s 5118 2.14319923e-05]
393.2s 5119 2025-10-10 15:38:35 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
393.2s 5120 2025-10-10 15:38:35 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=2285101618595884452, last=5866636032397366687
393.2s 5121 2025-10-10 15:38:35 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
393.2s 5122 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
393.2s 5123 2025-10-10 15:38:35 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
393.2s 5124 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
393.2s 5125 2025-10-10 15:38:35 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
393.2s 5126 2025-10-10 15:38:35 - WARNING - run_performance_comparison:774 - States comparison - Identical: False, baseline_hash=-8204528842174014379, rl_hash=2285101618595884452
393.2s 5127 2025-10-10 15:38:35 - INFO - run_performance_comparison:783 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
393.2s 5128 2025-10-10 15:38:35 - INFO - run_performance_comparison:784 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
393.2s 5129 2025-10-10 15:38:35 - INFO - run_performance_comparison:792 - Flow improvement: 0.000%
393.2s 5130 2025-10-10 15:38:35 - INFO - run_performance_comparison:793 - Efficiency improvement: 0.000%
393.2s 5131 2025-10-10 15:38:35 - INFO - run_performance_comparison:794 - Delay reduction: -0.000%
393.2s 5132 Flow improvement: 0.0%
393.2s 5133 Efficiency improvement: 0.0%
393.2s 5134 Delay reduction: -0.0%
393.2s 5135 Result: FAILED
393.2s 5136 
393.2s 5137 [FIGURES] Generating RL performance figures...
393.8s 5138 [OK] fig_rl_performance_improvements.png
394.3s 5139 [OK] fig_rl_learning_curve.png
394.3s 5140 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
394.3s 5141 
394.3s 5142 [METRICS] Saving RL performance metrics...
394.3s 5143 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
394.3s 5144 
394.3s 5145 [LATEX] Generating content for Section 7.6...
394.3s 5146 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
394.3s 5147 
394.3s 5148 === RL Performance Validation Summary ===
394.3s 5149 Scenarios passed: 0/1 (0.0%)
394.3s 5150 Average flow improvement: 0.00%
394.3s 5151 Average efficiency improvement: 0.00%
394.3s 5152 Average delay reduction: 0.00%
394.3s 5153 Overall validation: FAILED
394.3s 5154 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
396.9s 5155 [WARNING] Tests returned code: 1
396.9s 5156 
396.9s 5157 [STEP 4/4] Copying artifacts and cleaning up...
396.9s 5158 [ARTIFACTS] Copying results for section_7_6_rl_performance...
396.9s 5159 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
396.9s 5160 [ARTIFACTS] NPZ files: 0
396.9s 5161 [ARTIFACTS] PNG figures: 2
396.9s 5162 [ARTIFACTS] YAML scenarios: 1
396.9s 5163 [ARTIFACTS] TEX files: 1
396.9s 5164 [ARTIFACTS] JSON files: 1
396.9s 5165 [ARTIFACTS] CSV metrics: 1
396.9s 5166 TRACKING_SUCCESS: Artifacts copied
396.9s 5167 [SUCCESS] All artifacts organized and copied
396.9s 5168 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
396.9s 5169 [OK] Cleanup completed - only validation results remain
396.9s 5170 TRACKING_SUCCESS: Cleanup completed
396.9s 5171 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
396.9s 5172 TRACKING_SUCCESS: Session summary created
396.9s 5173 
396.9s 5174 [FINAL] Validation workflow completed
396.9s 5175 Remote logging finalized - ready for download
396.9s 5176 
396.9s 5177 ================================================================================
396.9s 5178 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
396.9s 5179 Output ready at: /kaggle/working/validation_results/
396.9s 5180 ================================================================================
400.3s 5181 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
400.3s 5182 warn(
400.4s 5183 [NbConvertApp] Converting notebook __script__.ipynb to html
401.1s 5184 [NbConvertApp] Writing 321270 bytes to __results__.html