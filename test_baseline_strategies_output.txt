
================================================================================
CRITICAL TEST: BASELINE METRICS RESPONSIVENESS
================================================================================

Objective: Verify that flow metrics CHANGE when using different control strategies
Expected: RED_ONLY flow << GREEN_ONLY flow

If results are identical → Results are HARDCODED
If results differ → Results are REAL

STEP 1: CLEANING CACHE
--------------------------------------------------------------------------------
✅ Cache removed

STEP 2: GENERATING TEST SCENARIO
--------------------------------------------------------------------------------
Generating scenario...
[LAGOS CONFIG] Saved NetworkConfig:
  - Network: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
  - Traffic: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network_traffic_control.yml
✅ Generated D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml

STEP 3: INITIALIZING TEST INFRASTRUCTURE
--------------------------------------------------------------------------------
[ARCHITECTURE] Structure créée: validation_output\results\local_test\section_7_6_rl_performance
  - Figures:   validation_output\results\local_test\section_7_6_rl_performance\figures
  - NPZ:       validation_output\results\local_test\section_7_6_rl_performance\data\npz
  - Scenarios: validation_output\results\local_test\section_7_6_rl_performance\data\scenarios
  - Metrics:   validation_output\results\local_test\section_7_6_rl_performance\data\metrics
  - LaTeX:     validation_output\results\local_test\section_7_6_rl_performance\latex
2025-10-24 11:50:00 - INFO - _setup_debug_logging:155 - ================================================================================
2025-10-24 11:50:00 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED
2025-10-24 11:50:00 - INFO - _setup_debug_logging:157 - Log file: validation_output\results\local_test\section_7_6_rl_performance\debug.log
2025-10-24 11:50:00 - INFO - _setup_debug_logging:158 - Quick test mode: True
2025-10-24 11:50:00 - INFO - _setup_debug_logging:159 - ================================================================================
[QUICK TEST MODE] Minimal training timesteps for setup validation
2025-10-24 11:50:00 - INFO - test_baseline_strategies:68 - Starting baseline strategy comparison

STEP 4: TESTING BASELINE STRATEGIES
--------------------------------------------------------------------------------

▶️  Testing strategy: red_only
   ══════════════════════════════════════════════════════════════════════
   Running simulation (test_baseline_strategies_network.yml)...
  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)
2025-10-24 11:50:00 - INFO - run_control_simulation:779 - ================================================================================
2025-10-24 11:50:00 - INFO - run_control_simulation:780 - Starting run_control_simulation:
2025-10-24 11:50:00 - INFO - run_control_simulation:781 -   - scenario_path: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
2025-10-24 11:50:00 - INFO - run_control_simulation:782 -   - duration: 600.0s
2025-10-24 11:50:00 - INFO - run_control_simulation:783 -   - control_interval: 15.0s
2025-10-24 11:50:00 - INFO - run_control_simulation:784 -   - device: cpu
2025-10-24 11:50:00 - INFO - run_control_simulation:785 -   - controller: BaselineController
2025-10-24 11:50:00 - INFO - run_control_simulation:786 -   - max_control_steps: 41
2025-10-24 11:50:00 - INFO - run_control_simulation:787 - ================================================================================
  [INFO] Initializing TrafficSignalEnvDirect with device=cpu
2025-10-24 11:50:00 - INFO - run_control_simulation:792 - Creating TrafficSignalEnvDirect instance...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
TrafficSignalEnvDirect initialized:
  Decision interval: 15.0s
  Observation segments: 6
  Observation space: (26,)
  Action space: 2
  Device: cpu
2025-10-24 11:50:00 - INFO - run_control_simulation:807 - TrafficSignalEnvDirect created successfully
2025-10-24 11:50:00 - INFO - run_control_simulation:808 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
  [INFO] Calling env.reset()...
2025-10-24 11:50:00 - INFO - run_control_simulation:824 - Calling env.reset()...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
2025-10-24 11:50:00 - INFO - run_control_simulation:826 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-24 11:50:00 - INFO - run_control_simulation:845 - INITIAL STATE shape: (4, 104), dtype: float64
  [INFO] Starting simulation loop (max 41 control steps)
2025-10-24 11:50:00 - INFO - run_control_simulation:865 - Starting simulation loop - max 41 control steps
    [BASELINE red_only] step=0, time_step=0, action=0.0
2025-10-24 11:50:00 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:50:00 - INFO - run_control_simulation:880 - STEP 0 START:
2025-10-24 11:50:00 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:50:00 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:50:00 - INFO - run_control_simulation:883 -   Simulation time: 0.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 15.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 1.604278e+00 s
  Corrected dt: 1.002674e+00 s
  Correction factor: 1.6x
  Max wave speed detected: 9.97 m/s
  Stored output at t = 15.0000 s (Step 27)

Simulation finished at t = 15.0000 s after 27 steps.
Total runtime: 28.66 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:50:29 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:50:29 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:50:29 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:50:29 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:50:29 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.557357e+00, max=1.127916e+01, std=4.806579e+00
2025-10-24 11:50:29 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:50:29 - INFO - run_control_simulation:928 -     Mean velocities: w_m=20.986987, w_c=16.917454
2025-10-24 11:50:29 - INFO - run_control_simulation:932 -   State hash: 2786916451300288077
2025-10-24 11:50:29 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=4.557357e+00
    [BASELINE red_only] step=1, time_step=15.0, action=0.0
2025-10-24 11:50:29 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:50:29 - INFO - run_control_simulation:880 - STEP 1 START:
2025-10-24 11:50:29 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:50:29 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:50:29 - INFO - run_control_simulation:883 -   Simulation time: 15.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 30.00 s, outputting every 15.00 s
[PROGRESS] Step 50: t=25.66/30.00s (85.5%) | dt=0.4596s
  Stored output at t = 30.0000 s (Step 60)

Simulation finished at t = 30.0000 s after 60 steps.
Total runtime: 8.27 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:50:37 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:50:37 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:50:37 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:50:37 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:50:37 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.311467e-01, max=1.593601e+00, std=6.471279e-01
2025-10-24 11:50:37 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:50:37 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.530152, w_c=18.477127
2025-10-24 11:50:37 - INFO - run_control_simulation:932 -   State hash: 5197493074624841708
2025-10-24 11:50:37 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 2/41] action=0.0000, reward=0.0000, t=30.0s, state_diff=5.311467e-01
    [BASELINE red_only] step=2, time_step=30.0, action=0.0
2025-10-24 11:50:37 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:50:37 - INFO - run_control_simulation:880 - STEP 2 START:
2025-10-24 11:50:37 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:50:37 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:50:37 - INFO - run_control_simulation:883 -   Simulation time: 30.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 45.00 s, outputting every 15.00 s
  Stored output at t = 45.0000 s (Step 93)

Simulation finished at t = 45.0000 s after 93 steps.
Total runtime: 7.73 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:50:45 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:50:45 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:50:45 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:50:45 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:50:45 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.685001e-02, max=4.079666e-01, std=1.508739e-01
2025-10-24 11:50:45 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:50:45 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.565418, w_c=18.829261
2025-10-24 11:50:45 - INFO - run_control_simulation:932 -   State hash: 7724109815632925875
2025-10-24 11:50:45 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 3/41] action=0.0000, reward=0.0000, t=45.0s, state_diff=9.685001e-02
2025-10-24 11:50:45 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:50:45 - INFO - run_control_simulation:880 - STEP 3 START:
2025-10-24 11:50:45 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:50:45 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:50:45 - INFO - run_control_simulation:883 -   Simulation time: 45.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 60.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328528e-01 s
  Corrected dt: 4.580330e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 100: t=48.21/60.00s (80.3%) | dt=0.4580s
  Stored output at t = 60.0000 s (Step 126)

Simulation finished at t = 60.0000 s after 126 steps.
Total runtime: 8.77 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:50:54 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:50:54 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:50:54 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:50:54 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:50:54 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.993301e-02, max=7.934071e-02, std=3.389557e-02
2025-10-24 11:50:54 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:50:54 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567167, w_c=18.907243
2025-10-24 11:50:54 - INFO - run_control_simulation:932 -   State hash: 5081217733249600050
2025-10-24 11:50:54 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 4/41] action=0.0000, reward=0.0000, t=60.0s, state_diff=1.993301e-02
2025-10-24 11:50:54 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:50:54 - INFO - run_control_simulation:880 - STEP 4 START:
2025-10-24 11:50:54 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:50:54 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:50:54 - INFO - run_control_simulation:883 -   Simulation time: 60.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 75.00 s, outputting every 15.00 s
[PROGRESS] Step 150: t=70.99/75.00s (94.7%) | dt=0.4580s
  Stored output at t = 75.0000 s (Step 159)

Simulation finished at t = 75.0000 s after 159 steps.
Total runtime: 7.47 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:01 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.364572e-03, max=1.770331e-02, std=7.602786e-03
2025-10-24 11:51:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567254, w_c=18.924614
2025-10-24 11:51:01 - INFO - run_control_simulation:932 -   State hash: 74215504437367117
2025-10-24 11:51:01 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 5/41] action=0.0000, reward=0.0000, t=75.0s, state_diff=4.364572e-03
2025-10-24 11:51:01 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:01 - INFO - run_control_simulation:880 - STEP 5 START:
2025-10-24 11:51:01 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:01 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:01 - INFO - run_control_simulation:883 -   Simulation time: 75.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 90.00 s, outputting every 15.00 s
  Stored output at t = 90.0000 s (Step 192)

Simulation finished at t = 90.0000 s after 192 steps.
Total runtime: 6.70 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:08 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:08 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:08 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:08 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:08 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.697321e-04, max=3.950142e-03, std=1.698683e-03
2025-10-24 11:51:08 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:08 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.928489
2025-10-24 11:51:08 - INFO - run_control_simulation:932 -   State hash: -1145486910556497778
2025-10-24 11:51:08 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 6/41] action=0.0000, reward=0.0000, t=90.0s, state_diff=9.697321e-04
2025-10-24 11:51:08 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:08 - INFO - run_control_simulation:880 - STEP 6 START:
2025-10-24 11:51:08 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:08 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:08 - INFO - run_control_simulation:883 -   Simulation time: 90.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 105.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 200: t=93.66/105.00s (89.2%) | dt=0.4580s
  Stored output at t = 105.0000 s (Step 225)

Simulation finished at t = 105.0000 s after 225 steps.
Total runtime: 8.10 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:16 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:16 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:16 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:16 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:16 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.161706e-04, max=8.813957e-04, std=3.791438e-04
2025-10-24 11:51:16 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:16 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929353
2025-10-24 11:51:16 - INFO - run_control_simulation:932 -   State hash: 2409355811117625282
2025-10-24 11:51:16 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 7/41] action=0.0000, reward=0.0000, t=105.0s, state_diff=2.161706e-04
2025-10-24 11:51:16 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:16 - INFO - run_control_simulation:880 - STEP 7 START:
2025-10-24 11:51:16 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:16 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:16 - INFO - run_control_simulation:883 -   Simulation time: 105.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 120.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #1000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 250: t=116.45/120.00s (97.0%) | dt=0.4580s
  Stored output at t = 120.0000 s (Step 258)

Simulation finished at t = 120.0000 s after 258 steps.
Total runtime: 9.83 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:26 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:26 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:26 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:26 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:26 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.822393e-05, max=1.966660e-04, std=8.460425e-05
2025-10-24 11:51:26 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:26 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929546
2025-10-24 11:51:26 - INFO - run_control_simulation:932 -   State hash: 8713571399350348644
2025-10-24 11:51:26 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 8/41] action=0.0000, reward=0.0000, t=120.0s, state_diff=4.822393e-05
2025-10-24 11:51:26 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:26 - INFO - run_control_simulation:880 - STEP 8 START:
2025-10-24 11:51:26 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:26 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:26 - INFO - run_control_simulation:883 -   Simulation time: 120.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 135.00 s, outputting every 15.00 s
  Stored output at t = 135.0000 s (Step 291)

Simulation finished at t = 135.0000 s after 291 steps.
Total runtime: 5.59 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=9 t=135.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:32 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:32 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:32 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:32 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:32 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.075970e-05, max=4.388211e-05, std=1.887805e-05
2025-10-24 11:51:32 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:32 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929589
2025-10-24 11:51:32 - INFO - run_control_simulation:932 -   State hash: -725711382956208778
2025-10-24 11:51:32 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 9/41] action=0.0000, reward=0.0000, t=135.0s, state_diff=1.075970e-05
2025-10-24 11:51:32 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:32 - INFO - run_control_simulation:880 - STEP 9 START:
2025-10-24 11:51:32 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:32 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:32 - INFO - run_control_simulation:883 -   Simulation time: 135.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 150.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 300):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 300: t=139.12/150.00s (92.7%) | dt=0.4580s
  Stored output at t = 150.0000 s (Step 324)

Simulation finished at t = 150.0000 s after 324 steps.
Total runtime: 6.61 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=10 t=150.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   10] t=  150.0s | phase=0 | reward=   0.00 | total_reward=    0.00
2025-10-24 11:51:38 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:38 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:38 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:38 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:38 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.400789e-06, max=9.791422e-06, std=4.212277e-06
2025-10-24 11:51:38 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:38 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929599
2025-10-24 11:51:38 - INFO - run_control_simulation:932 -   State hash: 6972796354172783252
2025-10-24 11:51:38 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 10/41] action=0.0000, reward=0.0000, t=150.0s, state_diff=2.400789e-06
2025-10-24 11:51:38 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:38 - INFO - run_control_simulation:880 - STEP 10 START:
2025-10-24 11:51:38 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:38 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:38 - INFO - run_control_simulation:883 -   Simulation time: 150.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 165.00 s, outputting every 15.00 s
[PROGRESS] Step 350: t=161.91/165.00s (98.1%) | dt=0.4580s
  Stored output at t = 165.0000 s (Step 357)

Simulation finished at t = 165.0000 s after 357 steps.
Total runtime: 8.58 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:47 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:47 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:47 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:47 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:47 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.356871e-07, max=2.184762e-06, std=9.398867e-07
2025-10-24 11:51:47 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:47 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:51:47 - INFO - run_control_simulation:932 -   State hash: 2471570877607922135
2025-10-24 11:51:47 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 11/41] action=0.0000, reward=0.0000, t=165.0s, state_diff=5.356871e-07
2025-10-24 11:51:47 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:47 - INFO - run_control_simulation:880 - STEP 11 START:
2025-10-24 11:51:47 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:47 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:47 - INFO - run_control_simulation:883 -   Simulation time: 165.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 180.00 s, outputting every 15.00 s
  Stored output at t = 180.0000 s (Step 390)

Simulation finished at t = 180.0000 s after 390 steps.
Total runtime: 9.07 seconds.
[REWARD_MICROSCOPE] step=12 t=180.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:51:56 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:51:56 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:51:56 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:51:56 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:51:56 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.195279e-07, max=4.874862e-07, std=2.097171e-07
2025-10-24 11:51:56 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:51:56 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:51:56 - INFO - run_control_simulation:932 -   State hash: -2170827314389954674
2025-10-24 11:51:56 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 12/41] action=0.0000, reward=0.0000, t=180.0s, state_diff=1.195279e-07
2025-10-24 11:51:56 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:51:56 - INFO - run_control_simulation:880 - STEP 12 START:
2025-10-24 11:51:56 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:51:56 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:51:56 - INFO - run_control_simulation:883 -   Simulation time: 180.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 195.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 400):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 400: t=184.58/195.00s (94.7%) | dt=0.4580s
  Stored output at t = 195.0000 s (Step 423)

Simulation finished at t = 195.0000 s after 423 steps.
Total runtime: 6.34 seconds.
[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:52:02 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:52:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:52:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:52:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:52:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.667027e-08, max=1.087729e-07, std=4.679422e-08
2025-10-24 11:52:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:52:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:52:02 - INFO - run_control_simulation:932 -   State hash: -2086172978144158605
2025-10-24 11:52:02 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 13/41] action=0.0000, reward=0.0000, t=195.0s, state_diff=2.667027e-08
2025-10-24 11:52:02 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:52:02 - INFO - run_control_simulation:880 - STEP 13 START:
2025-10-24 11:52:02 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:52:02 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:52:02 - INFO - run_control_simulation:883 -   Simulation time: 195.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 210.00 s, outputting every 15.00 s
[PROGRESS] Step 450: t=207.37/210.00s (98.7%) | dt=0.4580s
  Stored output at t = 210.0000 s (Step 456)

Simulation finished at t = 210.0000 s after 456 steps.
Total runtime: 6.34 seconds.
[REWARD_MICROSCOPE] step=14 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:52:09 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:52:09 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:52:09 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:52:09 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:52:09 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.950943e-09, max=2.427051e-08, std=1.044120e-08
2025-10-24 11:52:09 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:52:09 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:52:09 - INFO - run_control_simulation:932 -   State hash: 824607402811820465
2025-10-24 11:52:09 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 14/41] action=0.0000, reward=0.0000, t=210.0s, state_diff=5.950943e-09
2025-10-24 11:52:09 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:52:09 - INFO - run_control_simulation:880 - STEP 14 START:
2025-10-24 11:52:09 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:52:09 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:52:09 - INFO - run_control_simulation:883 -   Simulation time: 210.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 225.00 s, outputting every 15.00 s
  Stored output at t = 225.0000 s (Step 489)

Simulation finished at t = 225.0000 s after 489 steps.
Total runtime: 24.17 seconds.
[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:52:33 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:52:33 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:52:33 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:52:33 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:52:33 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.327837e-09, max=5.415490e-09, std=2.329750e-09
2025-10-24 11:52:33 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:52:33 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:52:33 - INFO - run_control_simulation:932 -   State hash: 9035102458559200309
2025-10-24 11:52:33 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 15/41] action=0.0000, reward=0.0000, t=225.0s, state_diff=1.327837e-09
2025-10-24 11:52:33 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:52:33 - INFO - run_control_simulation:880 - STEP 15 START:
2025-10-24 11:52:33 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:52:33 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:52:33 - INFO - run_control_simulation:883 -   Simulation time: 225.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 240.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 500):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PERIODIC:1000] BC_DISPATCHER [Call #2000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 500: t=230.04/240.00s (95.8%) | dt=0.4580s
  Stored output at t = 240.0000 s (Step 522)

Simulation finished at t = 240.0000 s after 522 steps.
Total runtime: 31.82 seconds.
[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:53:05 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:53:05 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:53:05 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:53:05 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:53:05 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.962770e-10, max=1.208345e-09, std=5.198316e-10
2025-10-24 11:53:05 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:53:05 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:53:05 - INFO - run_control_simulation:932 -   State hash: -8908314830744208168
2025-10-24 11:53:05 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 16/41] action=0.0000, reward=0.0000, t=240.0s, state_diff=2.962770e-10
2025-10-24 11:53:05 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:53:05 - INFO - run_control_simulation:880 - STEP 16 START:
2025-10-24 11:53:05 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:53:05 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:53:05 - INFO - run_control_simulation:883 -   Simulation time: 240.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 255.00 s, outputting every 15.00 s
[PROGRESS] Step 550: t=252.82/255.00s (99.1%) | dt=0.4580s
  Stored output at t = 255.0000 s (Step 555)

Simulation finished at t = 255.0000 s after 555 steps.
Total runtime: 37.26 seconds.
[REWARD_MICROSCOPE] step=17 t=255.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:53:42 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:53:42 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:53:42 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:53:42 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:53:42 - INFO - run_control_simulation:917 -     Diff statistics: mean=6.610242e-11, max=2.695977e-10, std=1.159797e-10
2025-10-24 11:53:42 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:53:42 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:53:42 - INFO - run_control_simulation:932 -   State hash: -9183442076627116535
2025-10-24 11:53:42 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 17/41] action=0.0000, reward=0.0000, t=255.0s, state_diff=6.610242e-11
2025-10-24 11:53:42 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:53:42 - INFO - run_control_simulation:880 - STEP 17 START:
2025-10-24 11:53:42 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:53:42 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:53:42 - INFO - run_control_simulation:883 -   Simulation time: 255.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 270.00 s, outputting every 15.00 s
  Stored output at t = 270.0000 s (Step 588)

Simulation finished at t = 270.0000 s after 588 steps.
Total runtime: 19.23 seconds.
[REWARD_MICROSCOPE] step=18 t=270.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:54:01 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:54:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:54:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:54:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:54:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.477319e-11, max=6.017586e-11, std=2.587795e-11
2025-10-24 11:54:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:54:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:54:01 - INFO - run_control_simulation:932 -   State hash: 5200697356402176763
2025-10-24 11:54:01 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 18/41] action=0.0000, reward=0.0000, t=270.0s, state_diff=1.477319e-11
2025-10-24 11:54:01 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:54:01 - INFO - run_control_simulation:880 - STEP 18 START:
2025-10-24 11:54:01 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:54:01 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:54:01 - INFO - run_control_simulation:883 -   Simulation time: 270.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 285.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 600):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 600: t=275.50/285.00s (96.7%) | dt=0.4580s
  Stored output at t = 285.0000 s (Step 621)

Simulation finished at t = 285.0000 s after 621 steps.
Total runtime: 11.20 seconds.
[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:54:12 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:54:12 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:54:12 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:54:12 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:54:12 - INFO - run_control_simulation:917 -     Diff statistics: mean=3.284386e-12, max=1.339018e-11, std=5.759753e-12
2025-10-24 11:54:12 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:54:12 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:54:12 - INFO - run_control_simulation:932 -   State hash: 2478646317153558212
2025-10-24 11:54:12 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 19/41] action=0.0000, reward=0.0000, t=285.0s, state_diff=3.284386e-12
2025-10-24 11:54:12 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:54:12 - INFO - run_control_simulation:880 - STEP 19 START:
2025-10-24 11:54:12 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:54:12 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:54:12 - INFO - run_control_simulation:883 -   Simulation time: 285.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 300.00 s, outputting every 15.00 s
[PROGRESS] Step 650: t=298.28/300.00s (99.4%) | dt=0.4580s
  Stored output at t = 300.0000 s (Step 654)

Simulation finished at t = 300.0000 s after 654 steps.
Total runtime: 10.13 seconds.
[REWARD_MICROSCOPE] step=20 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   20] t=  300.0s | phase=0 | reward=   0.00 | total_reward=    0.00
2025-10-24 11:54:23 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:54:23 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:54:23 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:54:23 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:54:23 - INFO - run_control_simulation:917 -     Diff statistics: mean=7.386912e-13, max=3.012701e-12, std=1.296068e-12
2025-10-24 11:54:23 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:54:23 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:54:23 - INFO - run_control_simulation:932 -   State hash: -7637879236890586558
2025-10-24 11:54:23 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 20/41] action=0.0000, reward=0.0000, t=300.0s, state_diff=7.386912e-13
2025-10-24 11:54:23 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:54:23 - INFO - run_control_simulation:880 - STEP 20 START:
2025-10-24 11:54:23 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:54:23 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:54:23 - INFO - run_control_simulation:883 -   Simulation time: 300.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 315.00 s, outputting every 15.00 s
  Stored output at t = 315.0000 s (Step 687)

Simulation finished at t = 315.0000 s after 687 steps.
Total runtime: 12.93 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:54:36 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:54:36 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:54:36 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:54:36 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:54:36 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.681219e-13, max=6.856737e-13, std=2.949776e-13
2025-10-24 11:54:36 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:54:36 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:54:36 - INFO - run_control_simulation:932 -   State hash: -5971944840833728321
2025-10-24 11:54:36 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 21/41] action=0.0000, reward=0.0000, t=315.0s, state_diff=1.681219e-13
2025-10-24 11:54:36 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:54:36 - INFO - run_control_simulation:880 - STEP 21 START:
2025-10-24 11:54:36 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:54:36 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:54:36 - INFO - run_control_simulation:883 -   Simulation time: 315.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 330.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 700):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 700: t=320.95/330.00s (97.3%) | dt=0.4580s
  Stored output at t = 330.0000 s (Step 720)

Simulation finished at t = 330.0000 s after 720 steps.
Total runtime: 16.21 seconds.
[REWARD_MICROSCOPE] step=22 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:54:52 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:54:52 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:54:52 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:54:52 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:54:52 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.655086e-14, max=6.750156e-14, std=2.903925e-14
2025-10-24 11:54:52 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:54:52 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:54:52 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:54:52 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 22/41] action=0.0000, reward=0.0000, t=330.0s, state_diff=1.655086e-14
2025-10-24 11:54:52 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:54:52 - INFO - run_control_simulation:880 - STEP 22 START:
2025-10-24 11:54:52 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:54:52 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:54:52 - INFO - run_control_simulation:883 -   Simulation time: 330.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 345.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #3000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 750: t=343.74/345.00s (99.6%) | dt=0.4580s
  Stored output at t = 345.0000 s (Step 753)

Simulation finished at t = 345.0000 s after 753 steps.
Total runtime: 21.61 seconds.
[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:55:13 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:55:13 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:55:13 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:55:13 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:55:13 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:55:13 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:55:13 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:55:13 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:55:13 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 23/41] action=0.0000, reward=0.0000, t=345.0s, state_diff=0.000000e+00
2025-10-24 11:55:13 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:55:13 - INFO - run_control_simulation:880 - STEP 23 START:
2025-10-24 11:55:13 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:55:13 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:55:13 - INFO - run_control_simulation:883 -   Simulation time: 345.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 360.00 s, outputting every 15.00 s
  Stored output at t = 360.0000 s (Step 786)

Simulation finished at t = 360.0000 s after 786 steps.
Total runtime: 21.03 seconds.
[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:55:34 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:55:34 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:55:34 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:55:34 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:55:34 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:55:34 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:55:34 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:55:34 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:55:34 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 24/41] action=0.0000, reward=0.0000, t=360.0s, state_diff=0.000000e+00
2025-10-24 11:55:34 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:55:34 - INFO - run_control_simulation:880 - STEP 24 START:
2025-10-24 11:55:34 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:55:34 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:55:34 - INFO - run_control_simulation:883 -   Simulation time: 360.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 375.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 800):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 800: t=366.41/375.00s (97.7%) | dt=0.4580s
  Stored output at t = 375.0000 s (Step 819)

Simulation finished at t = 375.0000 s after 819 steps.
Total runtime: 16.36 seconds.
[REWARD_MICROSCOPE] step=25 t=375.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:55:51 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:55:51 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:55:51 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:55:51 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:55:51 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:55:51 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:55:51 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:55:51 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:55:51 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 25/41] action=0.0000, reward=0.0000, t=375.0s, state_diff=0.000000e+00
2025-10-24 11:55:51 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:55:51 - INFO - run_control_simulation:880 - STEP 25 START:
2025-10-24 11:55:51 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:55:51 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:55:51 - INFO - run_control_simulation:883 -   Simulation time: 375.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 390.00 s, outputting every 15.00 s
[PROGRESS] Step 850: t=389.20/390.00s (99.8%) | dt=0.4580s
  Stored output at t = 390.0000 s (Step 852)

Simulation finished at t = 390.0000 s after 852 steps.
Total runtime: 13.80 seconds.
[REWARD_MICROSCOPE] step=26 t=390.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:56:05 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:05 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:05 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:05 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:05 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:05 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:05 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:05 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:05 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 26/41] action=0.0000, reward=0.0000, t=390.0s, state_diff=0.000000e+00
2025-10-24 11:56:05 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:05 - INFO - run_control_simulation:880 - STEP 26 START:
2025-10-24 11:56:05 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:05 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:05 - INFO - run_control_simulation:883 -   Simulation time: 390.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 405.00 s, outputting every 15.00 s
  Stored output at t = 405.0000 s (Step 885)

Simulation finished at t = 405.0000 s after 885 steps.
Total runtime: 10.73 seconds.
[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:56:15 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:15 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:15 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:15 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:15 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:15 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:15 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:15 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:15 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 27/41] action=0.0000, reward=0.0000, t=405.0s, state_diff=0.000000e+00
2025-10-24 11:56:15 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:15 - INFO - run_control_simulation:880 - STEP 27 START:
2025-10-24 11:56:15 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:15 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:15 - INFO - run_control_simulation:883 -   Simulation time: 405.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 420.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 900):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 900: t=411.87/420.00s (98.1%) | dt=0.4580s
  Stored output at t = 420.0000 s (Step 918)

Simulation finished at t = 420.0000 s after 918 steps.
Total runtime: 9.94 seconds.
[REWARD_MICROSCOPE] step=28 t=420.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:56:25 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:25 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:25 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:25 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:25 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:25 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:25 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:25 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:25 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 28/41] action=0.0000, reward=0.0000, t=420.0s, state_diff=0.000000e+00
2025-10-24 11:56:25 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:25 - INFO - run_control_simulation:880 - STEP 28 START:
2025-10-24 11:56:25 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:25 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:25 - INFO - run_control_simulation:883 -   Simulation time: 420.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 435.00 s, outputting every 15.00 s
[PROGRESS] Step 950: t=434.66/435.00s (99.9%) | dt=0.4580s
  Stored output at t = 435.0000 s (Step 951)

Simulation finished at t = 435.0000 s after 951 steps.
Total runtime: 8.77 seconds.
[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:56:34 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:34 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:34 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:34 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:34 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:34 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:34 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:34 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:34 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 29/41] action=0.0000, reward=0.0000, t=435.0s, state_diff=0.000000e+00
2025-10-24 11:56:34 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:34 - INFO - run_control_simulation:880 - STEP 29 START:
2025-10-24 11:56:34 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:34 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:34 - INFO - run_control_simulation:883 -   Simulation time: 435.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 450.00 s, outputting every 15.00 s
  Stored output at t = 450.0000 s (Step 984)

Simulation finished at t = 450.0000 s after 984 steps.
Total runtime: 9.94 seconds.
[REWARD_MICROSCOPE] step=30 t=450.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   30] t=  450.0s | phase=0 | reward=   0.00 | total_reward=    0.00
2025-10-24 11:56:44 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:44 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:44 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:44 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:44 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:44 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:44 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:44 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:44 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 30/41] action=0.0000, reward=0.0000, t=450.0s, state_diff=0.000000e+00
2025-10-24 11:56:44 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:44 - INFO - run_control_simulation:880 - STEP 30 START:
2025-10-24 11:56:44 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:44 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:44 - INFO - run_control_simulation:883 -   Simulation time: 450.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 465.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1000):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PERIODIC:1000] BC_DISPATCHER [Call #4000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 1000: t=457.33/465.00s (98.4%) | dt=0.4580s
  Stored output at t = 465.0000 s (Step 1017)

Simulation finished at t = 465.0000 s after 1017 steps.
Total runtime: 11.36 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:56:55 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:56:55 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:56:55 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:56:55 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:56:55 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:56:55 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:56:55 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:56:55 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:56:55 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 31/41] action=0.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00
2025-10-24 11:56:55 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:56:55 - INFO - run_control_simulation:880 - STEP 31 START:
2025-10-24 11:56:55 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:56:55 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:56:55 - INFO - run_control_simulation:883 -   Simulation time: 465.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 480.00 s, outputting every 15.00 s
[PROGRESS] Step 1050: t=480.00/480.00s (100.0%) | dt=0.3435s
  Stored output at t = 480.0000 s (Step 1050)

Simulation finished at t = 480.0000 s after 1050 steps.
Total runtime: 10.92 seconds.
[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:06 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:06 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:06 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:06 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:06 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:06 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:06 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:06 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:06 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 32/41] action=0.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00
2025-10-24 11:57:06 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:06 - INFO - run_control_simulation:880 - STEP 32 START:
2025-10-24 11:57:06 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:06 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:06 - INFO - run_control_simulation:883 -   Simulation time: 480.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 495.00 s, outputting every 15.00 s
  Stored output at t = 495.0000 s (Step 1083)

Simulation finished at t = 495.0000 s after 1083 steps.
Total runtime: 9.46 seconds.
[REWARD_MICROSCOPE] step=33 t=495.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:16 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:16 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:16 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:16 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:16 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:16 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:16 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:16 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:16 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 33/41] action=0.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00
2025-10-24 11:57:16 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:16 - INFO - run_control_simulation:880 - STEP 33 START:
2025-10-24 11:57:16 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:16 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:16 - INFO - run_control_simulation:883 -   Simulation time: 495.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 510.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1100: t=502.79/510.00s (98.6%) | dt=0.4580s
  Stored output at t = 510.0000 s (Step 1116)

Simulation finished at t = 510.0000 s after 1116 steps.
Total runtime: 10.59 seconds.
[REWARD_MICROSCOPE] step=34 t=510.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:26 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:26 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:26 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:26 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:26 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:26 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:26 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:26 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:26 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 34/41] action=0.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00
2025-10-24 11:57:26 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:26 - INFO - run_control_simulation:880 - STEP 34 START:
2025-10-24 11:57:26 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:26 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:26 - INFO - run_control_simulation:883 -   Simulation time: 510.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 525.00 s, outputting every 15.00 s
  Stored output at t = 525.0000 s (Step 1149)

Simulation finished at t = 525.0000 s after 1149 steps.
Total runtime: 11.59 seconds.
[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:38 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:38 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:38 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:38 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:38 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:38 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:38 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:38 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:38 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 35/41] action=0.0000, reward=0.0000, t=525.0s, state_diff=0.000000e+00
2025-10-24 11:57:38 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:38 - INFO - run_control_simulation:880 - STEP 35 START:
2025-10-24 11:57:38 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:38 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:38 - INFO - run_control_simulation:883 -   Simulation time: 525.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 540.00 s, outputting every 15.00 s
[PROGRESS] Step 1150: t=525.46/540.00s (97.3%) | dt=0.4580s
  Stored output at t = 540.0000 s (Step 1182)

Simulation finished at t = 540.0000 s after 1182 steps.
Total runtime: 9.65 seconds.
[REWARD_MICROSCOPE] step=36 t=540.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:48 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:48 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:48 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:48 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:48 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:48 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:48 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:48 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:48 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 36/41] action=0.0000, reward=0.0000, t=540.0s, state_diff=0.000000e+00
2025-10-24 11:57:48 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:48 - INFO - run_control_simulation:880 - STEP 36 START:
2025-10-24 11:57:48 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:48 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:48 - INFO - run_control_simulation:883 -   Simulation time: 540.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 555.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1200: t=548.24/555.00s (98.8%) | dt=0.4580s
  Stored output at t = 555.0000 s (Step 1215)

Simulation finished at t = 555.0000 s after 1215 steps.
Total runtime: 10.49 seconds.
[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:57:58 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:57:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:57:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:57:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:57:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:57:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:57:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:57:58 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:57:58 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 37/41] action=0.0000, reward=0.0000, t=555.0s, state_diff=0.000000e+00
2025-10-24 11:57:58 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:57:58 - INFO - run_control_simulation:880 - STEP 37 START:
2025-10-24 11:57:58 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:57:58 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:57:58 - INFO - run_control_simulation:883 -   Simulation time: 555.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 570.00 s, outputting every 15.00 s
  Stored output at t = 570.0000 s (Step 1248)

Simulation finished at t = 570.0000 s after 1248 steps.
Total runtime: 11.80 seconds.
[REWARD_MICROSCOPE] step=38 t=570.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:58:10 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:58:10 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:10 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:10 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:10 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:58:10 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:10 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:58:10 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:58:10 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 38/41] action=0.0000, reward=0.0000, t=570.0s, state_diff=0.000000e+00
2025-10-24 11:58:10 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:10 - INFO - run_control_simulation:880 - STEP 38 START:
2025-10-24 11:58:10 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:10 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:58:10 - INFO - run_control_simulation:883 -   Simulation time: 570.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 585.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #5000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 1250: t=570.92/585.00s (97.6%) | dt=0.4580s
  Stored output at t = 585.0000 s (Step 1281)

Simulation finished at t = 585.0000 s after 1281 steps.
Total runtime: 10.88 seconds.
[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:58:21 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:58:21 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:21 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:21 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:21 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:58:21 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:21 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:58:21 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:58:21 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 39/41] action=0.0000, reward=0.0000, t=585.0s, state_diff=0.000000e+00
2025-10-24 11:58:21 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:21 - INFO - run_control_simulation:880 - STEP 39 START:
2025-10-24 11:58:21 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:21 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:58:21 - INFO - run_control_simulation:883 -   Simulation time: 585.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 600.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1300):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1300: t=593.70/600.00s (99.0%) | dt=0.4580s
  Stored output at t = 600.0000 s (Step 1314)

Simulation finished at t = 600.0000 s after 1314 steps.
Total runtime: 11.20 seconds.
[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   40] t=  600.0s | phase=0 | reward=   0.00 | total_reward=    0.00
DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
2025-10-24 11:58:32 - INFO - run_control_simulation:898 -   [BASELINE_RED_ONLY] Reward: 0.000000
2025-10-24 11:58:32 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: True
2025-10-24 11:58:32 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:32 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:32 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 11:58:32 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:32 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:58:32 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 11:58:32 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_RED_ONLY] [STEP 40/41] action=0.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00

  [BASELINE_RED_ONLY] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_RED_ONLY
    - Total control steps: 40
    - Total reward: 0.00
    - Avg step time: 12.790s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 511.6s
    - Speed ratio: 1.17x real-time

2025-10-24 11:58:32 - INFO - run_control_simulation:974 - 
  [BASELINE_RED_ONLY] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_RED_ONLY
    - Total control steps: 40
    - Total reward: 0.00
    - Avg step time: 12.790s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 511.6s
    - Speed ratio: 1.17x real-time

2025-10-24 11:58:32 - INFO - run_control_simulation:975 - Returning 40 state snapshots
   ✅ Simulation complete (511.7s, 40 states)
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 2000.0m
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 40 state snapshots (domain_length=2000.0m)
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=2786916451300288077, last=2207370342618067592
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1027 - First state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.2791648 21.2791648 21.2791648 21.2791648 21.2791648]
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1029 - Last state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.8701445 21.8701445 21.8701445 21.8701445 21.8701445]
2025-10-24 11:58:32 - INFO - evaluate_traffic_performance:1083 - Calculated metrics: flow=40.981917, efficiency=6.557107, delay=-177.42s
   📊 METRICS:
      Flow: 40.981917
      Efficiency: 6.557107
      Delay: -177.42s
      Speed: 2049.10 m/s

▶️  Testing strategy: alternating
   ══════════════════════════════════════════════════════════════════════
   Running simulation (test_baseline_strategies_network.yml)...
  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)
2025-10-24 11:58:32 - INFO - run_control_simulation:779 - ================================================================================
2025-10-24 11:58:32 - INFO - run_control_simulation:780 - Starting run_control_simulation:
2025-10-24 11:58:32 - INFO - run_control_simulation:781 -   - scenario_path: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
2025-10-24 11:58:32 - INFO - run_control_simulation:782 -   - duration: 600.0s
2025-10-24 11:58:32 - INFO - run_control_simulation:783 -   - control_interval: 15.0s
2025-10-24 11:58:32 - INFO - run_control_simulation:784 -   - device: cpu
2025-10-24 11:58:32 - INFO - run_control_simulation:785 -   - controller: BaselineController
2025-10-24 11:58:32 - INFO - run_control_simulation:786 -   - max_control_steps: 41
2025-10-24 11:58:32 - INFO - run_control_simulation:787 - ================================================================================
  [INFO] Initializing TrafficSignalEnvDirect with device=cpu
2025-10-24 11:58:32 - INFO - run_control_simulation:792 - Creating TrafficSignalEnvDirect instance...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
TrafficSignalEnvDirect initialized:
  Decision interval: 15.0s
  Observation segments: 6
  Observation space: (26,)
  Action space: 2
  Device: cpu
2025-10-24 11:58:33 - INFO - run_control_simulation:807 - TrafficSignalEnvDirect created successfully
2025-10-24 11:58:33 - INFO - run_control_simulation:808 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
  [INFO] Calling env.reset()...
2025-10-24 11:58:33 - INFO - run_control_simulation:824 - Calling env.reset()...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
2025-10-24 11:58:33 - INFO - run_control_simulation:826 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-24 11:58:33 - INFO - run_control_simulation:845 - INITIAL STATE shape: (4, 104), dtype: float64
  [INFO] Starting simulation loop (max 41 control steps)
2025-10-24 11:58:33 - INFO - run_control_simulation:865 - Starting simulation loop - max 41 control steps
    [BASELINE alternating] step=0, time_step=0, action=1.0
2025-10-24 11:58:33 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:33 - INFO - run_control_simulation:880 - STEP 0 START:
2025-10-24 11:58:33 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:33 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:58:33 - INFO - run_control_simulation:883 -   Simulation time: 0.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 15.00 s, outputting every 15.00 s
  Stored output at t = 15.0000 s (Step 27)

Simulation finished at t = 15.0000 s after 27 steps.
Total runtime: 6.34 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100
2025-10-24 11:58:39 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: -0.010000
2025-10-24 11:58:39 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:39 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:39 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:39 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.521853e+00, max=1.127916e+01, std=4.822472e+00
2025-10-24 11:58:39 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:39 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.076952, w_c=17.010462
2025-10-24 11:58:39 - INFO - run_control_simulation:932 -   State hash: 4649503212455588760
2025-10-24 11:58:39 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=4.521853e+00
    [BASELINE alternating] step=1, time_step=15.0, action=1.0
2025-10-24 11:58:39 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:39 - INFO - run_control_simulation:880 - STEP 1 START:
2025-10-24 11:58:39 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:39 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:58:39 - INFO - run_control_simulation:883 -   Simulation time: 15.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 30.00 s, outputting every 15.00 s
[PROGRESS] Step 50: t=25.66/30.00s (85.5%) | dt=0.4596s
  Stored output at t = 30.0000 s (Step 60)

Simulation finished at t = 30.0000 s after 60 steps.
Total runtime: 5.65 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:58:45 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.000000
2025-10-24 11:58:45 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:45 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:45 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:45 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.302951e-01, max=1.593601e+00, std=6.474710e-01
2025-10-24 11:58:45 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:45 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.622366, w_c=18.571291
2025-10-24 11:58:45 - INFO - run_control_simulation:932 -   State hash: -2141492190258917154
2025-10-24 11:58:45 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=5.302951e-01
    [BASELINE alternating] step=2, time_step=30.0, action=0.0
2025-10-24 11:58:45 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:45 - INFO - run_control_simulation:880 - STEP 2 START:
2025-10-24 11:58:45 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:45 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:58:45 - INFO - run_control_simulation:883 -   Simulation time: 30.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 45.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1400):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.329243e-01 s
  Corrected dt: 4.580777e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 45.0000 s (Step 93)

Simulation finished at t = 45.0000 s after 93 steps.
Total runtime: 5.60 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100
2025-10-24 11:58:50 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: -0.010000
2025-10-24 11:58:50 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:50 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:50 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:50 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.378261e-01, max=4.720153e+00, std=4.602697e-01
2025-10-24 11:58:50 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:50 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.565418, w_c=18.829261
2025-10-24 11:58:50 - INFO - run_control_simulation:932 -   State hash: 7724109815632925875
2025-10-24 11:58:50 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 3/41] action=0.0000, reward=-0.0100, t=45.0s, state_diff=1.378261e-01
2025-10-24 11:58:50 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:50 - INFO - run_control_simulation:880 - STEP 3 START:
2025-10-24 11:58:50 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:50 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:58:50 - INFO - run_control_simulation:883 -   Simulation time: 45.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 60.00 s, outputting every 15.00 s
[PROGRESS] Step 100: t=48.21/60.00s (80.3%) | dt=0.4580s
  Stored output at t = 60.0000 s (Step 126)

Simulation finished at t = 60.0000 s after 126 steps.
Total runtime: 5.10 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 11:58:55 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.000000
2025-10-24 11:58:55 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:58:55 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:58:55 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:58:55 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.993301e-02, max=7.934071e-02, std=3.389557e-02
2025-10-24 11:58:55 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:58:55 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567167, w_c=18.907243
2025-10-24 11:58:55 - INFO - run_control_simulation:932 -   State hash: 5081217733249600050
2025-10-24 11:58:55 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 4/41] action=0.0000, reward=0.0000, t=60.0s, state_diff=1.993301e-02
2025-10-24 11:58:55 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:58:55 - INFO - run_control_simulation:880 - STEP 4 START:
2025-10-24 11:58:55 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:58:55 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:58:55 - INFO - run_control_simulation:883 -   Simulation time: 60.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 75.00 s, outputting every 15.00 s
[PROGRESS] Step 150: t=70.99/75.00s (94.7%) | dt=0.4580s
  Stored output at t = 75.0000 s (Step 159)

Simulation finished at t = 75.0000 s after 159 steps.
Total runtime: 4.94 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:00 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.003384e-02, max=4.831602e+00, std=4.632635e-01
2025-10-24 11:59:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657024, w_c=19.017521
2025-10-24 11:59:00 - INFO - run_control_simulation:932 -   State hash: 41866111936383643
2025-10-24 11:59:00 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 5/41] action=1.0000, reward=0.0100, t=75.0s, state_diff=5.003384e-02
2025-10-24 11:59:00 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:00 - INFO - run_control_simulation:880 - STEP 5 START:
2025-10-24 11:59:00 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:00 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:00 - INFO - run_control_simulation:883 -   Simulation time: 75.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 90.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #6000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 1500):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 90.0000 s (Step 192)

Simulation finished at t = 90.0000 s after 192 steps.
Total runtime: 3.37 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 11:59:04 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:04 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:04 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:04 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:04 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.696250e-04, max=3.950142e-03, std=1.698742e-03
2025-10-24 11:59:04 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:04 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657028, w_c=19.021396
2025-10-24 11:59:04 - INFO - run_control_simulation:932 -   State hash: -5118208850799323634
2025-10-24 11:59:04 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 6/41] action=1.0000, reward=0.0200, t=90.0s, state_diff=9.696250e-04
2025-10-24 11:59:04 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:04 - INFO - run_control_simulation:880 - STEP 6 START:
2025-10-24 11:59:04 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:04 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:04 - INFO - run_control_simulation:883 -   Simulation time: 90.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 105.00 s, outputting every 15.00 s
[PROGRESS] Step 200: t=93.66/105.00s (89.2%) | dt=0.4580s
  Stored output at t = 105.0000 s (Step 225)

Simulation finished at t = 105.0000 s after 225 steps.
Total runtime: 3.63 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:07 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:07 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:07 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:07 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:07 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.588529e-02, max=4.831160e+00, std=4.635390e-01
2025-10-24 11:59:07 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:07 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929353
2025-10-24 11:59:07 - INFO - run_control_simulation:932 -   State hash: 2409355811117625282
2025-10-24 11:59:07 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 7/41] action=0.0000, reward=0.0100, t=105.0s, state_diff=4.588529e-02
2025-10-24 11:59:07 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:07 - INFO - run_control_simulation:880 - STEP 7 START:
2025-10-24 11:59:07 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:07 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:07 - INFO - run_control_simulation:883 -   Simulation time: 105.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 120.00 s, outputting every 15.00 s
[PROGRESS] Step 250: t=116.45/120.00s (97.0%) | dt=0.4580s
  Stored output at t = 120.0000 s (Step 258)

Simulation finished at t = 120.0000 s after 258 steps.
Total runtime: 3.50 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 11:59:11 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:11 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:11 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:11 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:11 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.822393e-05, max=1.966660e-04, std=8.460425e-05
2025-10-24 11:59:11 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:11 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929546
2025-10-24 11:59:11 - INFO - run_control_simulation:932 -   State hash: 8713571399350348644
2025-10-24 11:59:11 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 8/41] action=0.0000, reward=0.0200, t=120.0s, state_diff=4.822393e-05
2025-10-24 11:59:11 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:11 - INFO - run_control_simulation:880 - STEP 8 START:
2025-10-24 11:59:11 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:11 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:11 - INFO - run_control_simulation:883 -   Simulation time: 120.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 135.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1600):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 135.0000 s (Step 291)

Simulation finished at t = 135.0000 s after 291 steps.
Total runtime: 3.72 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:15 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:15 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:15 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:15 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:15 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.567991e-02, max=4.831161e+00, std=4.635592e-01
2025-10-24 11:59:15 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:15 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022496
2025-10-24 11:59:15 - INFO - run_control_simulation:932 -   State hash: -5683777811226310184
2025-10-24 11:59:15 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 9/41] action=1.0000, reward=0.0100, t=135.0s, state_diff=4.567991e-02
2025-10-24 11:59:15 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:15 - INFO - run_control_simulation:880 - STEP 9 START:
2025-10-24 11:59:15 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:15 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:15 - INFO - run_control_simulation:883 -   Simulation time: 135.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 150.00 s, outputting every 15.00 s
[PROGRESS] Step 300: t=139.12/150.00s (92.7%) | dt=0.4580s
  Stored output at t = 150.0000 s (Step 324)

Simulation finished at t = 150.0000 s after 324 steps.
Total runtime: 3.63 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   10] t=  150.0s | phase=1 | reward=   0.02 | total_reward=    0.07
2025-10-24 11:59:18 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:18 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:18 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:18 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:18 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.400788e-06, max=9.791422e-06, std=4.212277e-06
2025-10-24 11:59:18 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:18 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022506
2025-10-24 11:59:18 - INFO - run_control_simulation:932 -   State hash: -2032030098634609172
2025-10-24 11:59:18 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 10/41] action=1.0000, reward=0.0200, t=150.0s, state_diff=2.400788e-06
2025-10-24 11:59:18 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:18 - INFO - run_control_simulation:880 - STEP 10 START:
2025-10-24 11:59:18 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:18 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:18 - INFO - run_control_simulation:883 -   Simulation time: 150.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 165.00 s, outputting every 15.00 s
[PROGRESS] Step 350: t=161.91/165.00s (98.1%) | dt=0.4580s
  Stored output at t = 165.0000 s (Step 357)

Simulation finished at t = 165.0000 s after 357 steps.
Total runtime: 3.74 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:22 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:22 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:22 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:22 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:22 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566969e-02, max=4.831161e+00, std=4.635602e-01
2025-10-24 11:59:22 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:22 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:59:22 - INFO - run_control_simulation:932 -   State hash: 2471570877607922135
2025-10-24 11:59:22 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 11/41] action=0.0000, reward=0.0100, t=165.0s, state_diff=4.566969e-02
2025-10-24 11:59:22 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:22 - INFO - run_control_simulation:880 - STEP 11 START:
2025-10-24 11:59:22 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:22 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:22 - INFO - run_control_simulation:883 -   Simulation time: 165.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 180.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1700):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 180.0000 s (Step 390)

Simulation finished at t = 180.0000 s after 390 steps.
Total runtime: 3.33 seconds.
[REWARD_MICROSCOPE] step=12 t=180.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 11:59:25 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:25 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:25 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:25 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:25 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.195279e-07, max=4.874862e-07, std=2.097171e-07
2025-10-24 11:59:25 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:25 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 11:59:25 - INFO - run_control_simulation:932 -   State hash: -2170827314389954674
2025-10-24 11:59:25 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 12/41] action=0.0000, reward=0.0200, t=180.0s, state_diff=1.195279e-07
2025-10-24 11:59:25 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:25 - INFO - run_control_simulation:880 - STEP 12 START:
2025-10-24 11:59:25 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:25 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:25 - INFO - run_control_simulation:883 -   Simulation time: 180.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 195.00 s, outputting every 15.00 s
[PROGRESS] Step 400: t=184.58/195.00s (94.7%) | dt=0.4580s
  Stored output at t = 195.0000 s (Step 423)

Simulation finished at t = 195.0000 s after 423 steps.
Total runtime: 3.31 seconds.
[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:29 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:29 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:29 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:29 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:29 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566918e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 11:59:29 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:29 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 11:59:29 - INFO - run_control_simulation:932 -   State hash: -670951465243056800
2025-10-24 11:59:29 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 13/41] action=1.0000, reward=0.0100, t=195.0s, state_diff=4.566918e-02
2025-10-24 11:59:29 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:29 - INFO - run_control_simulation:880 - STEP 13 START:
2025-10-24 11:59:29 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:29 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:29 - INFO - run_control_simulation:883 -   Simulation time: 195.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 210.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #7000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 450: t=207.37/210.00s (98.7%) | dt=0.4580s
  Stored output at t = 210.0000 s (Step 456)

Simulation finished at t = 210.0000 s after 456 steps.
Total runtime: 3.25 seconds.
[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 11:59:32 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:32 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:32 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:32 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:32 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.950943e-09, max=2.427051e-08, std=1.044120e-08
2025-10-24 11:59:32 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:32 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 11:59:32 - INFO - run_control_simulation:932 -   State hash: 5948388895721221017
2025-10-24 11:59:32 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 14/41] action=1.0000, reward=0.0200, t=210.0s, state_diff=5.950943e-09
2025-10-24 11:59:32 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:32 - INFO - run_control_simulation:880 - STEP 14 START:
2025-10-24 11:59:32 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:32 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:32 - INFO - run_control_simulation:883 -   Simulation time: 210.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 225.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1800):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 225.0000 s (Step 489)

Simulation finished at t = 225.0000 s after 489 steps.
Total runtime: 6.93 seconds.
[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:39 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:39 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:39 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:39 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:39 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 11:59:39 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:39 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:59:39 - INFO - run_control_simulation:932 -   State hash: 9035102458559200309
2025-10-24 11:59:39 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 15/41] action=0.0000, reward=0.0100, t=225.0s, state_diff=4.566915e-02
2025-10-24 11:59:39 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:39 - INFO - run_control_simulation:880 - STEP 15 START:
2025-10-24 11:59:39 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:39 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 11:59:39 - INFO - run_control_simulation:883 -   Simulation time: 225.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 240.00 s, outputting every 15.00 s
[PROGRESS] Step 500: t=230.04/240.00s (95.8%) | dt=0.4580s
  Stored output at t = 240.0000 s (Step 522)

Simulation finished at t = 240.0000 s after 522 steps.
Total runtime: 9.80 seconds.
[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 11:59:49 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 11:59:49 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:49 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:49 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:49 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.962770e-10, max=1.208345e-09, std=5.198316e-10
2025-10-24 11:59:49 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:49 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 11:59:49 - INFO - run_control_simulation:932 -   State hash: -8908314830744208168
2025-10-24 11:59:49 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 16/41] action=0.0000, reward=0.0200, t=240.0s, state_diff=2.962770e-10
2025-10-24 11:59:49 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:49 - INFO - run_control_simulation:880 - STEP 16 START:
2025-10-24 11:59:49 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:49 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:49 - INFO - run_control_simulation:883 -   Simulation time: 240.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 255.00 s, outputting every 15.00 s
[PROGRESS] Step 550: t=252.82/255.00s (99.1%) | dt=0.4580s
  Stored output at t = 255.0000 s (Step 555)

Simulation finished at t = 255.0000 s after 555 steps.
Total runtime: 9.70 seconds.
[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 11:59:58 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 11:59:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 11:59:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 11:59:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 11:59:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 11:59:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 11:59:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 11:59:58 - INFO - run_control_simulation:932 -   State hash: 2941018457220896671
2025-10-24 11:59:58 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 17/41] action=1.0000, reward=0.0100, t=255.0s, state_diff=4.566915e-02
2025-10-24 11:59:58 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 11:59:58 - INFO - run_control_simulation:880 - STEP 17 START:
2025-10-24 11:59:58 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 11:59:58 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 11:59:58 - INFO - run_control_simulation:883 -   Simulation time: 255.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 270.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 1900):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 270.0000 s (Step 588)

Simulation finished at t = 270.0000 s after 588 steps.
Total runtime: 10.08 seconds.
[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:00:08 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:00:08 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:08 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:08 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:08 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.476739e-11, max=6.017586e-11, std=2.588085e-11
2025-10-24 12:00:08 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:08 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:00:08 - INFO - run_control_simulation:932 -   State hash: -7380750715549063623
2025-10-24 12:00:08 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 18/41] action=1.0000, reward=0.0200, t=270.0s, state_diff=1.476739e-11
2025-10-24 12:00:08 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:08 - INFO - run_control_simulation:880 - STEP 18 START:
2025-10-24 12:00:08 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:08 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:00:08 - INFO - run_control_simulation:883 -   Simulation time: 270.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 285.00 s, outputting every 15.00 s
[PROGRESS] Step 600: t=275.50/285.00s (96.7%) | dt=0.4580s
  Stored output at t = 285.0000 s (Step 621)

Simulation finished at t = 285.0000 s after 621 steps.
Total runtime: 10.70 seconds.
[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:00:19 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:00:19 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:19 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:19 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:19 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:00:19 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:19 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:00:19 - INFO - run_control_simulation:932 -   State hash: 2478646317153558212
2025-10-24 12:00:19 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 19/41] action=0.0000, reward=0.0100, t=285.0s, state_diff=4.566915e-02
2025-10-24 12:00:19 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:19 - INFO - run_control_simulation:880 - STEP 19 START:
2025-10-24 12:00:19 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:19 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:00:19 - INFO - run_control_simulation:883 -   Simulation time: 285.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 300.00 s, outputting every 15.00 s
[PROGRESS] Step 650: t=298.28/300.00s (99.4%) | dt=0.4580s
  Stored output at t = 300.0000 s (Step 654)

Simulation finished at t = 300.0000 s after 654 steps.
Total runtime: 9.55 seconds.
[REWARD_MICROSCOPE] step=20 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   20] t=  300.0s | phase=0 | reward=   0.02 | total_reward=    0.22
2025-10-24 12:00:29 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:00:29 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:29 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:29 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:29 - INFO - run_control_simulation:917 -     Diff statistics: mean=7.386912e-13, max=3.012701e-12, std=1.296068e-12
2025-10-24 12:00:29 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:29 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:00:29 - INFO - run_control_simulation:932 -   State hash: -7637879236890586558
2025-10-24 12:00:29 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 20/41] action=0.0000, reward=0.0200, t=300.0s, state_diff=7.386912e-13
2025-10-24 12:00:29 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:29 - INFO - run_control_simulation:880 - STEP 20 START:
2025-10-24 12:00:29 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:29 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:00:29 - INFO - run_control_simulation:883 -   Simulation time: 300.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 315.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #8000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 2000):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 315.0000 s (Step 687)

Simulation finished at t = 315.0000 s after 687 steps.
Total runtime: 9.69 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:00:38 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:00:38 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:38 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:38 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:38 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:00:38 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:38 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:00:38 - INFO - run_control_simulation:932 -   State hash: 8575030684565602785
2025-10-24 12:00:38 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 21/41] action=1.0000, reward=0.0100, t=315.0s, state_diff=4.566915e-02
2025-10-24 12:00:38 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:38 - INFO - run_control_simulation:880 - STEP 21 START:
2025-10-24 12:00:38 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:38 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:00:38 - INFO - run_control_simulation:883 -   Simulation time: 315.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 330.00 s, outputting every 15.00 s
[PROGRESS] Step 700: t=320.95/330.00s (97.3%) | dt=0.4580s
  Stored output at t = 330.0000 s (Step 720)

Simulation finished at t = 330.0000 s after 720 steps.
Total runtime: 9.63 seconds.
[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:00:48 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:00:48 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:48 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:48 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:48 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.655086e-14, max=6.750156e-14, std=2.903925e-14
2025-10-24 12:00:48 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:48 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:00:48 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:00:48 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 22/41] action=1.0000, reward=0.0200, t=330.0s, state_diff=1.655086e-14
2025-10-24 12:00:48 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:48 - INFO - run_control_simulation:880 - STEP 22 START:
2025-10-24 12:00:48 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:48 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:00:48 - INFO - run_control_simulation:883 -   Simulation time: 330.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 345.00 s, outputting every 15.00 s
[PROGRESS] Step 750: t=343.74/345.00s (99.6%) | dt=0.4580s
  Stored output at t = 345.0000 s (Step 753)

Simulation finished at t = 345.0000 s after 753 steps.
Total runtime: 9.36 seconds.
[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:00:57 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:00:57 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:00:57 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:00:57 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:00:57 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:00:57 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:00:57 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:00:57 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:00:57 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 23/41] action=0.0000, reward=0.0100, t=345.0s, state_diff=4.566915e-02
2025-10-24 12:00:57 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:00:57 - INFO - run_control_simulation:880 - STEP 23 START:
2025-10-24 12:00:57 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:00:57 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:00:57 - INFO - run_control_simulation:883 -   Simulation time: 345.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 360.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 360.0000 s (Step 786)

Simulation finished at t = 360.0000 s after 786 steps.
Total runtime: 9.43 seconds.
[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:01:07 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:01:07 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:07 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:07 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:07 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:01:07 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:07 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:01:07 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:01:07 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 24/41] action=0.0000, reward=0.0200, t=360.0s, state_diff=0.000000e+00
2025-10-24 12:01:07 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:07 - INFO - run_control_simulation:880 - STEP 24 START:
2025-10-24 12:01:07 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:07 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:01:07 - INFO - run_control_simulation:883 -   Simulation time: 360.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 375.00 s, outputting every 15.00 s
[PROGRESS] Step 800: t=366.41/375.00s (97.7%) | dt=0.4580s
  Stored output at t = 375.0000 s (Step 819)

Simulation finished at t = 375.0000 s after 819 steps.
Total runtime: 9.26 seconds.
[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:01:16 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:01:16 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:16 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:16 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:16 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:01:16 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:16 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:01:16 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:01:16 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 25/41] action=1.0000, reward=0.0100, t=375.0s, state_diff=4.566915e-02
2025-10-24 12:01:16 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:16 - INFO - run_control_simulation:880 - STEP 25 START:
2025-10-24 12:01:16 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:16 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:01:16 - INFO - run_control_simulation:883 -   Simulation time: 375.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 390.00 s, outputting every 15.00 s
[PROGRESS] Step 850: t=389.20/390.00s (99.8%) | dt=0.4580s
  Stored output at t = 390.0000 s (Step 852)

Simulation finished at t = 390.0000 s after 852 steps.
Total runtime: 9.27 seconds.
[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:01:25 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:01:25 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:25 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:25 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:25 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:01:25 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:25 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:01:25 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:01:25 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 26/41] action=1.0000, reward=0.0200, t=390.0s, state_diff=0.000000e+00
2025-10-24 12:01:25 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:25 - INFO - run_control_simulation:880 - STEP 26 START:
2025-10-24 12:01:25 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:25 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:01:25 - INFO - run_control_simulation:883 -   Simulation time: 390.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 405.00 s, outputting every 15.00 s
  Stored output at t = 405.0000 s (Step 885)

Simulation finished at t = 405.0000 s after 885 steps.
Total runtime: 9.78 seconds.
[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:01:35 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:01:35 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:35 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:35 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:35 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:01:35 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:35 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:01:35 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:01:35 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 27/41] action=0.0000, reward=0.0100, t=405.0s, state_diff=4.566915e-02
2025-10-24 12:01:35 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:35 - INFO - run_control_simulation:880 - STEP 27 START:
2025-10-24 12:01:35 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:35 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:01:35 - INFO - run_control_simulation:883 -   Simulation time: 405.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 420.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 900: t=411.87/420.00s (98.1%) | dt=0.4580s
  Stored output at t = 420.0000 s (Step 918)

Simulation finished at t = 420.0000 s after 918 steps.
Total runtime: 10.24 seconds.
[REWARD_MICROSCOPE] step=28 t=420.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:01:45 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:01:45 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:45 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:45 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:45 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:01:45 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:45 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:01:45 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:01:45 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 28/41] action=0.0000, reward=0.0200, t=420.0s, state_diff=0.000000e+00
2025-10-24 12:01:45 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:45 - INFO - run_control_simulation:880 - STEP 28 START:
2025-10-24 12:01:45 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:45 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:01:45 - INFO - run_control_simulation:883 -   Simulation time: 420.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 435.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #9000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[PROGRESS] Step 950: t=434.66/435.00s (99.9%) | dt=0.4580s
  Stored output at t = 435.0000 s (Step 951)

Simulation finished at t = 435.0000 s after 951 steps.
Total runtime: 10.26 seconds.
[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:01:56 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:01:56 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:01:56 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:01:56 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:01:56 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:01:56 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:01:56 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:01:56 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:01:56 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 29/41] action=1.0000, reward=0.0100, t=435.0s, state_diff=4.566915e-02
2025-10-24 12:01:56 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:01:56 - INFO - run_control_simulation:880 - STEP 29 START:
2025-10-24 12:01:56 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:01:56 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:01:56 - INFO - run_control_simulation:883 -   Simulation time: 435.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 450.00 s, outputting every 15.00 s
  Stored output at t = 450.0000 s (Step 984)

Simulation finished at t = 450.0000 s after 984 steps.
Total runtime: 8.54 seconds.
[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   30] t=  450.0s | phase=1 | reward=   0.02 | total_reward=    0.37
2025-10-24 12:02:04 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:02:04 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:04 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:04 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:04 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:02:04 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:04 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:02:04 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:02:04 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 30/41] action=1.0000, reward=0.0200, t=450.0s, state_diff=0.000000e+00
2025-10-24 12:02:04 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:04 - INFO - run_control_simulation:880 - STEP 30 START:
2025-10-24 12:02:04 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:04 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:02:04 - INFO - run_control_simulation:883 -   Simulation time: 450.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 465.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2300):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1000: t=457.33/465.00s (98.4%) | dt=0.4580s
  Stored output at t = 465.0000 s (Step 1017)

Simulation finished at t = 465.0000 s after 1017 steps.
Total runtime: 9.32 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:02:13 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:02:13 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:13 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:13 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:13 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:02:13 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:13 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:02:13 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:02:13 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 31/41] action=0.0000, reward=0.0100, t=465.0s, state_diff=4.566915e-02
2025-10-24 12:02:13 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:13 - INFO - run_control_simulation:880 - STEP 31 START:
2025-10-24 12:02:13 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:13 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:02:13 - INFO - run_control_simulation:883 -   Simulation time: 465.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 480.00 s, outputting every 15.00 s
[PROGRESS] Step 1050: t=480.00/480.00s (100.0%) | dt=0.3435s
  Stored output at t = 480.0000 s (Step 1050)

Simulation finished at t = 480.0000 s after 1050 steps.
Total runtime: 8.04 seconds.
[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:02:22 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:02:22 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:22 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:22 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:22 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:02:22 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:22 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:02:22 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:02:22 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 32/41] action=0.0000, reward=0.0200, t=480.0s, state_diff=0.000000e+00
2025-10-24 12:02:22 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:22 - INFO - run_control_simulation:880 - STEP 32 START:
2025-10-24 12:02:22 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:22 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:02:22 - INFO - run_control_simulation:883 -   Simulation time: 480.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 495.00 s, outputting every 15.00 s
  Stored output at t = 495.0000 s (Step 1083)

Simulation finished at t = 495.0000 s after 1083 steps.
Total runtime: 8.22 seconds.
[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:02:30 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:02:30 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:30 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:30 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:30 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:02:30 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:30 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:02:30 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:02:30 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 33/41] action=1.0000, reward=0.0100, t=495.0s, state_diff=4.566915e-02
2025-10-24 12:02:30 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:30 - INFO - run_control_simulation:880 - STEP 33 START:
2025-10-24 12:02:30 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:30 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:02:30 - INFO - run_control_simulation:883 -   Simulation time: 495.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 510.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2400):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1100: t=502.79/510.00s (98.6%) | dt=0.4580s
  Stored output at t = 510.0000 s (Step 1116)

Simulation finished at t = 510.0000 s after 1116 steps.
Total runtime: 8.74 seconds.
[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:02:39 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:02:39 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:39 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:39 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:39 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:02:39 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:39 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:02:39 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:02:39 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 34/41] action=1.0000, reward=0.0200, t=510.0s, state_diff=0.000000e+00
2025-10-24 12:02:39 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:39 - INFO - run_control_simulation:880 - STEP 34 START:
2025-10-24 12:02:39 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:39 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:02:39 - INFO - run_control_simulation:883 -   Simulation time: 510.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 525.00 s, outputting every 15.00 s
  Stored output at t = 525.0000 s (Step 1149)

Simulation finished at t = 525.0000 s after 1149 steps.
Total runtime: 10.09 seconds.
[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:02:49 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:02:49 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:49 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:49 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:49 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:02:49 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:49 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:02:49 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:02:49 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 35/41] action=0.0000, reward=0.0100, t=525.0s, state_diff=4.566915e-02
2025-10-24 12:02:49 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:49 - INFO - run_control_simulation:880 - STEP 35 START:
2025-10-24 12:02:49 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:49 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:02:49 - INFO - run_control_simulation:883 -   Simulation time: 525.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 540.00 s, outputting every 15.00 s
[PROGRESS] Step 1150: t=525.46/540.00s (97.3%) | dt=0.4580s
  Stored output at t = 540.0000 s (Step 1182)

Simulation finished at t = 540.0000 s after 1182 steps.
Total runtime: 8.92 seconds.
[REWARD_MICROSCOPE] step=36 t=540.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:02:58 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:02:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:02:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:02:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:02:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:02:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:02:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:02:58 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:02:58 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 36/41] action=0.0000, reward=0.0200, t=540.0s, state_diff=0.000000e+00
2025-10-24 12:02:58 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:02:58 - INFO - run_control_simulation:880 - STEP 36 START:
2025-10-24 12:02:58 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:02:58 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:02:58 - INFO - run_control_simulation:883 -   Simulation time: 540.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 555.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #10000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 2500):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1200: t=548.24/555.00s (98.8%) | dt=0.4580s
  Stored output at t = 555.0000 s (Step 1215)

Simulation finished at t = 555.0000 s after 1215 steps.
Total runtime: 8.89 seconds.
[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:03:06 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:03:06 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:06 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:06 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:06 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:03:06 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:06 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:03:06 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:03:06 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 37/41] action=1.0000, reward=0.0100, t=555.0s, state_diff=4.566915e-02
2025-10-24 12:03:06 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:06 - INFO - run_control_simulation:880 - STEP 37 START:
2025-10-24 12:03:06 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:06 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:03:06 - INFO - run_control_simulation:883 -   Simulation time: 555.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 570.00 s, outputting every 15.00 s
  Stored output at t = 570.0000 s (Step 1248)

Simulation finished at t = 570.0000 s after 1248 steps.
Total runtime: 8.89 seconds.
[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:03:15 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:03:15 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:15 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:15 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:15 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:03:15 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:15 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:03:15 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:03:15 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 38/41] action=1.0000, reward=0.0200, t=570.0s, state_diff=0.000000e+00
2025-10-24 12:03:15 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:15 - INFO - run_control_simulation:880 - STEP 38 START:
2025-10-24 12:03:15 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:15 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:03:15 - INFO - run_control_simulation:883 -   Simulation time: 570.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 585.00 s, outputting every 15.00 s
[PROGRESS] Step 1250: t=570.92/585.00s (97.6%) | dt=0.4580s
  Stored output at t = 585.0000 s (Step 1281)

Simulation finished at t = 585.0000 s after 1281 steps.
Total runtime: 8.84 seconds.
[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:03:24 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.010000
2025-10-24 12:03:24 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:24 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:24 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:24 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:03:24 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:24 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:03:24 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:03:24 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 39/41] action=0.0000, reward=0.0100, t=585.0s, state_diff=4.566915e-02
2025-10-24 12:03:24 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:24 - INFO - run_control_simulation:880 - STEP 39 START:
2025-10-24 12:03:24 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:24 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:03:24 - INFO - run_control_simulation:883 -   Simulation time: 585.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 600.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2600):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
[PROGRESS] Step 1300: t=593.70/600.00s (99.0%) | dt=0.4580s
  Stored output at t = 600.0000 s (Step 1314)

Simulation finished at t = 600.0000 s after 1314 steps.
Total runtime: 8.74 seconds.
[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   40] t=  600.0s | phase=0 | reward=   0.02 | total_reward=    0.52
DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
2025-10-24 12:03:33 - INFO - run_control_simulation:898 -   [BASELINE_ALTERNATING] Reward: 0.020000
2025-10-24 12:03:33 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: True
2025-10-24 12:03:33 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:33 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:33 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:03:33 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:33 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:03:33 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:03:33 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_ALTERNATING] [STEP 40/41] action=0.0000, reward=0.0200, t=600.0s, state_diff=0.000000e+00

  [BASELINE_ALTERNATING] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_ALTERNATING
    - Total control steps: 40
    - Total reward: 0.52
    - Avg step time: 7.508s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 300.3s
    - Speed ratio: 2.00x real-time

2025-10-24 12:03:33 - INFO - run_control_simulation:974 - 
  [BASELINE_ALTERNATING] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_ALTERNATING
    - Total control steps: 40
    - Total reward: 0.52
    - Avg step time: 7.508s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 300.3s
    - Speed ratio: 2.00x real-time

2025-10-24 12:03:33 - INFO - run_control_simulation:975 - Returning 40 state snapshots
   ✅ Simulation complete (300.7s, 40 states)
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 2000.0m
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 40 state snapshots (domain_length=2000.0m)
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=4649503212455588760, last=2207370342618067592
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1027 - First state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.2791648 21.2791648 21.2791648 21.2791648 21.2791648]
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1029 - Last state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.8701445 21.8701445 21.8701445 21.8701445 21.8701445]
2025-10-24 12:03:33 - INFO - evaluate_traffic_performance:1083 - Calculated metrics: flow=40.981917, efficiency=6.557107, delay=-177.42s
   📊 METRICS:
      Flow: 40.981917
      Efficiency: 6.557107
      Delay: -177.42s
      Speed: 2049.10 m/s

▶️  Testing strategy: fixed_time_optimal
   ══════════════════════════════════════════════════════════════════════
   Running simulation (test_baseline_strategies_network.yml)...
  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)
2025-10-24 12:03:33 - INFO - run_control_simulation:779 - ================================================================================
2025-10-24 12:03:33 - INFO - run_control_simulation:780 - Starting run_control_simulation:
2025-10-24 12:03:33 - INFO - run_control_simulation:781 -   - scenario_path: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
2025-10-24 12:03:33 - INFO - run_control_simulation:782 -   - duration: 600.0s
2025-10-24 12:03:33 - INFO - run_control_simulation:783 -   - control_interval: 15.0s
2025-10-24 12:03:33 - INFO - run_control_simulation:784 -   - device: cpu
2025-10-24 12:03:33 - INFO - run_control_simulation:785 -   - controller: BaselineController
2025-10-24 12:03:33 - INFO - run_control_simulation:786 -   - max_control_steps: 41
2025-10-24 12:03:33 - INFO - run_control_simulation:787 - ================================================================================
  [INFO] Initializing TrafficSignalEnvDirect with device=cpu
2025-10-24 12:03:33 - INFO - run_control_simulation:792 - Creating TrafficSignalEnvDirect instance...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
TrafficSignalEnvDirect initialized:
  Decision interval: 15.0s
  Observation segments: 6
  Observation space: (26,)
  Action space: 2
  Device: cpu
2025-10-24 12:03:33 - INFO - run_control_simulation:807 - TrafficSignalEnvDirect created successfully
2025-10-24 12:03:33 - INFO - run_control_simulation:808 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
  [INFO] Calling env.reset()...
2025-10-24 12:03:33 - INFO - run_control_simulation:824 - Calling env.reset()...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
2025-10-24 12:03:33 - INFO - run_control_simulation:826 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-24 12:03:33 - INFO - run_control_simulation:845 - INITIAL STATE shape: (4, 104), dtype: float64
  [INFO] Starting simulation loop (max 41 control steps)
2025-10-24 12:03:33 - INFO - run_control_simulation:865 - Starting simulation loop - max 41 control steps
    [BASELINE fixed_time_optimal] step=0, time_step=0, action=1.0
2025-10-24 12:03:33 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:33 - INFO - run_control_simulation:880 - STEP 0 START:
2025-10-24 12:03:33 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:33 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:03:33 - INFO - run_control_simulation:883 -   Simulation time: 0.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 15.00 s, outputting every 15.00 s
  Stored output at t = 15.0000 s (Step 27)

Simulation finished at t = 15.0000 s after 27 steps.
Total runtime: 4.40 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100
2025-10-24 12:03:37 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: -0.010000
2025-10-24 12:03:37 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:37 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:37 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:37 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.521853e+00, max=1.127916e+01, std=4.822472e+00
2025-10-24 12:03:37 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:37 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.076952, w_c=17.010462
2025-10-24 12:03:37 - INFO - run_control_simulation:932 -   State hash: 4649503212455588760
2025-10-24 12:03:37 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=4.521853e+00
    [BASELINE fixed_time_optimal] step=1, time_step=15.0, action=1.0
2025-10-24 12:03:37 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:37 - INFO - run_control_simulation:880 - STEP 1 START:
2025-10-24 12:03:37 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:37 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:03:37 - INFO - run_control_simulation:883 -   Simulation time: 15.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 30.00 s, outputting every 15.00 s
[PROGRESS] Step 50: t=25.66/30.00s (85.5%) | dt=0.4596s
  Stored output at t = 30.0000 s (Step 60)

Simulation finished at t = 30.0000 s after 60 steps.
Total runtime: 4.95 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:03:42 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.000000
2025-10-24 12:03:42 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:42 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:42 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:42 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.302951e-01, max=1.593601e+00, std=6.474710e-01
2025-10-24 12:03:42 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:42 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.622366, w_c=18.571291
2025-10-24 12:03:42 - INFO - run_control_simulation:932 -   State hash: -2141492190258917154
2025-10-24 12:03:42 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=5.302951e-01
    [BASELINE fixed_time_optimal] step=2, time_step=30.0, action=1.0
2025-10-24 12:03:42 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:42 - INFO - run_control_simulation:880 - STEP 2 START:
2025-10-24 12:03:42 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:42 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:03:42 - INFO - run_control_simulation:883 -   Simulation time: 30.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 45.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2700):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.331848e-01 s
  Corrected dt: 4.582405e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.82 m/s
  Stored output at t = 45.0000 s (Step 93)

Simulation finished at t = 45.0000 s after 93 steps.
Total runtime: 4.47 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:03:47 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.000000
2025-10-24 12:03:47 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:47 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:47 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:47 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.596999e-02, max=3.555804e-01, std=1.498058e-01
2025-10-24 12:03:47 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:47 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.655307, w_c=18.922230
2025-10-24 12:03:47 - INFO - run_control_simulation:932 -   State hash: 3331263232835421568
2025-10-24 12:03:47 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=9.596999e-02
2025-10-24 12:03:47 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:47 - INFO - run_control_simulation:880 - STEP 3 START:
2025-10-24 12:03:47 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:47 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:03:47 - INFO - run_control_simulation:883 -   Simulation time: 45.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 60.00 s, outputting every 15.00 s
[PROGRESS] Step 100: t=48.21/60.00s (80.3%) | dt=0.4580s
[PERIODIC:1000] BC_DISPATCHER [Call #11000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 60.0000 s (Step 126)

Simulation finished at t = 60.0000 s after 126 steps.
Total runtime: 5.12 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:03:52 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.000000
2025-10-24 12:03:52 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:52 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:52 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:52 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.988978e-02, max=7.934071e-02, std=3.390353e-02
2025-10-24 12:03:52 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:52 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.656943, w_c=19.000153
2025-10-24 12:03:52 - INFO - run_control_simulation:932 -   State hash: 382029719189084058
2025-10-24 12:03:52 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=1.988978e-02
2025-10-24 12:03:52 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:52 - INFO - run_control_simulation:880 - STEP 4 START:
2025-10-24 12:03:52 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:52 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:03:52 - INFO - run_control_simulation:883 -   Simulation time: 60.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 75.00 s, outputting every 15.00 s
[PROGRESS] Step 150: t=70.99/75.00s (94.7%) | dt=0.4580s
  Stored output at t = 75.0000 s (Step 159)

Simulation finished at t = 75.0000 s after 159 steps.
Total runtime: 4.52 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:03:56 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:03:56 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:03:56 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:03:56 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:03:56 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.002226e-02, max=4.830888e+00, std=4.631469e-01
2025-10-24 12:03:56 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:03:56 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567254, w_c=18.924614
2025-10-24 12:03:56 - INFO - run_control_simulation:932 -   State hash: 74215504437367117
2025-10-24 12:03:57 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 5/41] action=0.0000, reward=0.0100, t=75.0s, state_diff=5.002226e-02
2025-10-24 12:03:57 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:03:57 - INFO - run_control_simulation:880 - STEP 5 START:
2025-10-24 12:03:57 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:03:57 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:03:57 - INFO - run_control_simulation:883 -   Simulation time: 75.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 90.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2800):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328245e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 90.0000 s (Step 192)

Simulation finished at t = 90.0000 s after 192 steps.
Total runtime: 3.17 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:00 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.697321e-04, max=3.950142e-03, std=1.698683e-03
2025-10-24 12:04:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.928489
2025-10-24 12:04:00 - INFO - run_control_simulation:932 -   State hash: -1145486910556497778
2025-10-24 12:04:00 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 6/41] action=0.0000, reward=0.0200, t=90.0s, state_diff=9.697321e-04
2025-10-24 12:04:00 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:00 - INFO - run_control_simulation:880 - STEP 6 START:
2025-10-24 12:04:00 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:00 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:00 - INFO - run_control_simulation:883 -   Simulation time: 90.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 105.00 s, outputting every 15.00 s
[PROGRESS] Step 200: t=93.66/105.00s (89.2%) | dt=0.4580s
  Stored output at t = 105.0000 s (Step 225)

Simulation finished at t = 105.0000 s after 225 steps.
Total runtime: 3.65 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:03 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:03 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:03 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:03 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:03 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.161706e-04, max=8.813957e-04, std=3.791438e-04
2025-10-24 12:04:03 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:03 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929353
2025-10-24 12:04:03 - INFO - run_control_simulation:932 -   State hash: 2409355811117625282
2025-10-24 12:04:03 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 7/41] action=0.0000, reward=0.0200, t=105.0s, state_diff=2.161706e-04
2025-10-24 12:04:03 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:03 - INFO - run_control_simulation:880 - STEP 7 START:
2025-10-24 12:04:03 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:03 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:03 - INFO - run_control_simulation:883 -   Simulation time: 105.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 120.00 s, outputting every 15.00 s
[PROGRESS] Step 250: t=116.45/120.00s (97.0%) | dt=0.4580s
  Stored output at t = 120.0000 s (Step 258)

Simulation finished at t = 120.0000 s after 258 steps.
Total runtime: 3.19 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:07 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:07 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:07 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:07 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:07 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.822393e-05, max=1.966660e-04, std=8.460425e-05
2025-10-24 12:04:07 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:07 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929546
2025-10-24 12:04:07 - INFO - run_control_simulation:932 -   State hash: 8713571399350348644
2025-10-24 12:04:07 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 8/41] action=0.0000, reward=0.0200, t=120.0s, state_diff=4.822393e-05
2025-10-24 12:04:07 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:07 - INFO - run_control_simulation:880 - STEP 8 START:
2025-10-24 12:04:07 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:07 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:07 - INFO - run_control_simulation:883 -   Simulation time: 120.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 135.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 2900):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 135.0000 s (Step 291)

Simulation finished at t = 135.0000 s after 291 steps.
Total runtime: 3.59 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:04:10 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:04:10 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:10 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:10 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:10 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.567991e-02, max=4.831161e+00, std=4.635592e-01
2025-10-24 12:04:10 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:10 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022496
2025-10-24 12:04:10 - INFO - run_control_simulation:932 -   State hash: -5683777811226310184
2025-10-24 12:04:10 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 9/41] action=1.0000, reward=0.0100, t=135.0s, state_diff=4.567991e-02
2025-10-24 12:04:10 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:10 - INFO - run_control_simulation:880 - STEP 9 START:
2025-10-24 12:04:10 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:10 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:10 - INFO - run_control_simulation:883 -   Simulation time: 135.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 150.00 s, outputting every 15.00 s
[PROGRESS] Step 300: t=139.12/150.00s (92.7%) | dt=0.4580s
  Stored output at t = 150.0000 s (Step 324)

Simulation finished at t = 150.0000 s after 324 steps.
Total runtime: 3.17 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   10] t=  150.0s | phase=1 | reward=   0.02 | total_reward=    0.09
2025-10-24 12:04:13 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:13 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:13 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:13 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:13 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.400788e-06, max=9.791422e-06, std=4.212277e-06
2025-10-24 12:04:13 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:13 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022506
2025-10-24 12:04:13 - INFO - run_control_simulation:932 -   State hash: -2032030098634609172
2025-10-24 12:04:13 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 10/41] action=1.0000, reward=0.0200, t=150.0s, state_diff=2.400788e-06
2025-10-24 12:04:13 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:13 - INFO - run_control_simulation:880 - STEP 10 START:
2025-10-24 12:04:13 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:13 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:13 - INFO - run_control_simulation:883 -   Simulation time: 150.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 165.00 s, outputting every 15.00 s
[PROGRESS] Step 350: t=161.91/165.00s (98.1%) | dt=0.4580s
  Stored output at t = 165.0000 s (Step 357)

Simulation finished at t = 165.0000 s after 357 steps.
Total runtime: 3.45 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:17 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:17 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:17 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:17 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:17 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.356871e-07, max=2.184762e-06, std=9.398868e-07
2025-10-24 12:04:17 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:17 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:04:17 - INFO - run_control_simulation:932 -   State hash: 8844846229614531648
2025-10-24 12:04:17 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 11/41] action=1.0000, reward=0.0200, t=165.0s, state_diff=5.356871e-07
2025-10-24 12:04:17 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:17 - INFO - run_control_simulation:880 - STEP 11 START:
2025-10-24 12:04:17 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:17 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:17 - INFO - run_control_simulation:883 -   Simulation time: 165.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 180.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #12000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 3000):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 180.0000 s (Step 390)

Simulation finished at t = 180.0000 s after 390 steps.
Total runtime: 3.20 seconds.
[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:20 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:20 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:20 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:20 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:20 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.195279e-07, max=4.874862e-07, std=2.097171e-07
2025-10-24 12:04:20 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:20 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:04:20 - INFO - run_control_simulation:932 -   State hash: -3244151014718415603
2025-10-24 12:04:20 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 12/41] action=1.0000, reward=0.0200, t=180.0s, state_diff=1.195279e-07
2025-10-24 12:04:20 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:20 - INFO - run_control_simulation:880 - STEP 12 START:
2025-10-24 12:04:20 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:20 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:20 - INFO - run_control_simulation:883 -   Simulation time: 180.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 195.00 s, outputting every 15.00 s
[PROGRESS] Step 400: t=184.58/195.00s (94.7%) | dt=0.4580s
  Stored output at t = 195.0000 s (Step 423)

Simulation finished at t = 195.0000 s after 423 steps.
Total runtime: 3.64 seconds.
[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:04:24 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:04:24 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:24 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:24 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:24 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566918e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:04:24 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:24 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 12:04:24 - INFO - run_control_simulation:932 -   State hash: -2086172978144158605
2025-10-24 12:04:24 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 13/41] action=0.0000, reward=0.0100, t=195.0s, state_diff=4.566918e-02
2025-10-24 12:04:24 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:24 - INFO - run_control_simulation:880 - STEP 13 START:
2025-10-24 12:04:24 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:24 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:24 - INFO - run_control_simulation:883 -   Simulation time: 195.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 210.00 s, outputting every 15.00 s
[PROGRESS] Step 450: t=207.37/210.00s (98.7%) | dt=0.4580s
  Stored output at t = 210.0000 s (Step 456)

Simulation finished at t = 210.0000 s after 456 steps.
Total runtime: 3.12 seconds.
[REWARD_MICROSCOPE] step=14 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:27 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:27 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:27 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:27 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:27 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.950943e-09, max=2.427051e-08, std=1.044120e-08
2025-10-24 12:04:27 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:27 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929601
2025-10-24 12:04:27 - INFO - run_control_simulation:932 -   State hash: 824607402811820465
2025-10-24 12:04:27 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 14/41] action=0.0000, reward=0.0200, t=210.0s, state_diff=5.950943e-09
2025-10-24 12:04:27 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:27 - INFO - run_control_simulation:880 - STEP 14 START:
2025-10-24 12:04:27 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:27 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:27 - INFO - run_control_simulation:883 -   Simulation time: 210.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 225.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 225.0000 s (Step 489)

Simulation finished at t = 225.0000 s after 489 steps.
Total runtime: 6.69 seconds.
[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:33 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:33 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:33 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:33 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:33 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.327837e-09, max=5.415490e-09, std=2.329750e-09
2025-10-24 12:04:33 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:33 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:04:33 - INFO - run_control_simulation:932 -   State hash: 9035102458559200309
2025-10-24 12:04:33 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 15/41] action=0.0000, reward=0.0200, t=225.0s, state_diff=1.327837e-09
2025-10-24 12:04:33 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:33 - INFO - run_control_simulation:880 - STEP 15 START:
2025-10-24 12:04:33 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:33 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:04:33 - INFO - run_control_simulation:883 -   Simulation time: 225.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 240.00 s, outputting every 15.00 s
[PROGRESS] Step 500: t=230.04/240.00s (95.8%) | dt=0.4580s
  Stored output at t = 240.0000 s (Step 522)

Simulation finished at t = 240.0000 s after 522 steps.
Total runtime: 8.62 seconds.
[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:04:42 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:04:42 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:42 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:42 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:42 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.962770e-10, max=1.208345e-09, std=5.198316e-10
2025-10-24 12:04:42 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:42 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:04:42 - INFO - run_control_simulation:932 -   State hash: -8908314830744208168
2025-10-24 12:04:42 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 16/41] action=0.0000, reward=0.0200, t=240.0s, state_diff=2.962770e-10
2025-10-24 12:04:42 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:42 - INFO - run_control_simulation:880 - STEP 16 START:
2025-10-24 12:04:42 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:42 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:42 - INFO - run_control_simulation:883 -   Simulation time: 240.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 255.00 s, outputting every 15.00 s
[PROGRESS] Step 550: t=252.82/255.00s (99.1%) | dt=0.4580s
  Stored output at t = 255.0000 s (Step 555)

Simulation finished at t = 255.0000 s after 555 steps.
Total runtime: 8.54 seconds.
[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:04:51 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:04:51 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:04:51 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:04:51 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:04:51 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:04:51 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:04:51 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:04:51 - INFO - run_control_simulation:932 -   State hash: 2941018457220896671
2025-10-24 12:04:51 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 17/41] action=1.0000, reward=0.0100, t=255.0s, state_diff=4.566915e-02
2025-10-24 12:04:51 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:04:51 - INFO - run_control_simulation:880 - STEP 17 START:
2025-10-24 12:04:51 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:04:51 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:04:51 - INFO - run_control_simulation:883 -   Simulation time: 255.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 270.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 270.0000 s (Step 588)

Simulation finished at t = 270.0000 s after 588 steps.
Total runtime: 9.89 seconds.
[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:05:01 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.476739e-11, max=6.017586e-11, std=2.588085e-11
2025-10-24 12:05:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:05:01 - INFO - run_control_simulation:932 -   State hash: -7380750715549063623
2025-10-24 12:05:01 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 18/41] action=1.0000, reward=0.0200, t=270.0s, state_diff=1.476739e-11
2025-10-24 12:05:01 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:01 - INFO - run_control_simulation:880 - STEP 18 START:
2025-10-24 12:05:01 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:01 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:05:01 - INFO - run_control_simulation:883 -   Simulation time: 270.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 285.00 s, outputting every 15.00 s
[PROGRESS] Step 600: t=275.50/285.00s (96.7%) | dt=0.4580s
[PERIODIC:1000] BC_DISPATCHER [Call #13000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 285.0000 s (Step 621)

Simulation finished at t = 285.0000 s after 621 steps.
Total runtime: 9.63 seconds.
[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:05:10 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:10 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:10 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:10 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:10 - INFO - run_control_simulation:917 -     Diff statistics: mean=3.283997e-12, max=1.339018e-11, std=5.759966e-12
2025-10-24 12:05:10 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:10 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:05:10 - INFO - run_control_simulation:932 -   State hash: -7988195351050537352
2025-10-24 12:05:10 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 19/41] action=1.0000, reward=0.0200, t=285.0s, state_diff=3.283997e-12
2025-10-24 12:05:10 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:10 - INFO - run_control_simulation:880 - STEP 19 START:
2025-10-24 12:05:10 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:10 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:05:10 - INFO - run_control_simulation:883 -   Simulation time: 285.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 300.00 s, outputting every 15.00 s
[PROGRESS] Step 650: t=298.28/300.00s (99.4%) | dt=0.4580s
  Stored output at t = 300.0000 s (Step 654)

Simulation finished at t = 300.0000 s after 654 steps.
Total runtime: 9.34 seconds.
[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   20] t=  300.0s | phase=1 | reward=   0.02 | total_reward=    0.27
2025-10-24 12:05:20 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:20 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:20 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:20 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:20 - INFO - run_control_simulation:917 -     Diff statistics: mean=7.386912e-13, max=3.012701e-12, std=1.296068e-12
2025-10-24 12:05:20 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:20 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:05:20 - INFO - run_control_simulation:932 -   State hash: 870855710520549094
2025-10-24 12:05:20 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 20/41] action=1.0000, reward=0.0200, t=300.0s, state_diff=7.386912e-13
2025-10-24 12:05:20 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:20 - INFO - run_control_simulation:880 - STEP 20 START:
2025-10-24 12:05:20 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:20 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:05:20 - INFO - run_control_simulation:883 -   Simulation time: 300.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 315.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3300):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 315.0000 s (Step 687)

Simulation finished at t = 315.0000 s after 687 steps.
Total runtime: 9.25 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:05:29 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:05:29 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:29 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:29 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:29 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:05:29 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:29 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:05:29 - INFO - run_control_simulation:932 -   State hash: -5971944840833728321
2025-10-24 12:05:29 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 21/41] action=0.0000, reward=0.0100, t=315.0s, state_diff=4.566915e-02
2025-10-24 12:05:29 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:29 - INFO - run_control_simulation:880 - STEP 21 START:
2025-10-24 12:05:29 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:29 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:05:29 - INFO - run_control_simulation:883 -   Simulation time: 315.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 330.00 s, outputting every 15.00 s
[PROGRESS] Step 700: t=320.95/330.00s (97.3%) | dt=0.4580s
  Stored output at t = 330.0000 s (Step 720)

Simulation finished at t = 330.0000 s after 720 steps.
Total runtime: 8.72 seconds.
[REWARD_MICROSCOPE] step=22 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:05:37 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:37 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:37 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:37 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:37 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.655086e-14, max=6.750156e-14, std=2.903925e-14
2025-10-24 12:05:37 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:37 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:05:37 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:05:37 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 22/41] action=0.0000, reward=0.0200, t=330.0s, state_diff=1.655086e-14
2025-10-24 12:05:37 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:37 - INFO - run_control_simulation:880 - STEP 22 START:
2025-10-24 12:05:37 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:37 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:05:37 - INFO - run_control_simulation:883 -   Simulation time: 330.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 345.00 s, outputting every 15.00 s
[PROGRESS] Step 750: t=343.74/345.00s (99.6%) | dt=0.4580s
  Stored output at t = 345.0000 s (Step 753)

Simulation finished at t = 345.0000 s after 753 steps.
Total runtime: 8.53 seconds.
[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:05:46 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:46 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:46 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:46 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:46 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:05:46 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:46 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:05:46 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:05:46 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 23/41] action=0.0000, reward=0.0200, t=345.0s, state_diff=0.000000e+00
2025-10-24 12:05:46 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:46 - INFO - run_control_simulation:880 - STEP 23 START:
2025-10-24 12:05:46 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:46 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:05:46 - INFO - run_control_simulation:883 -   Simulation time: 345.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 360.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3400):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 360.0000 s (Step 786)

Simulation finished at t = 360.0000 s after 786 steps.
Total runtime: 10.21 seconds.
[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:05:56 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:05:56 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:05:56 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:05:56 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:05:56 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:05:56 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:05:56 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:05:56 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:05:56 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 24/41] action=0.0000, reward=0.0200, t=360.0s, state_diff=0.000000e+00
2025-10-24 12:05:56 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:05:56 - INFO - run_control_simulation:880 - STEP 24 START:
2025-10-24 12:05:56 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:05:56 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:05:56 - INFO - run_control_simulation:883 -   Simulation time: 360.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 375.00 s, outputting every 15.00 s
[PROGRESS] Step 800: t=366.41/375.00s (97.7%) | dt=0.4580s
  Stored output at t = 375.0000 s (Step 819)

Simulation finished at t = 375.0000 s after 819 steps.
Total runtime: 9.35 seconds.
[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:06:06 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:06:06 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:06 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:06 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:06 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:06:06 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:06 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:06:06 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:06:06 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 25/41] action=1.0000, reward=0.0100, t=375.0s, state_diff=4.566915e-02
2025-10-24 12:06:06 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:06 - INFO - run_control_simulation:880 - STEP 25 START:
2025-10-24 12:06:06 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:06 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:06:06 - INFO - run_control_simulation:883 -   Simulation time: 375.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 390.00 s, outputting every 15.00 s
[PROGRESS] Step 850: t=389.20/390.00s (99.8%) | dt=0.4580s
  Stored output at t = 390.0000 s (Step 852)

Simulation finished at t = 390.0000 s after 852 steps.
Total runtime: 10.17 seconds.
[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:06:16 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:06:16 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:16 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:16 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:16 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:06:16 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:16 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:06:16 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:06:16 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 26/41] action=1.0000, reward=0.0200, t=390.0s, state_diff=0.000000e+00
2025-10-24 12:06:16 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:16 - INFO - run_control_simulation:880 - STEP 26 START:
2025-10-24 12:06:16 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:16 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:06:16 - INFO - run_control_simulation:883 -   Simulation time: 390.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 405.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #14000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 3500):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 405.0000 s (Step 885)

Simulation finished at t = 405.0000 s after 885 steps.
Total runtime: 8.91 seconds.
[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:06:25 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:06:25 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:25 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:25 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:25 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:06:25 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:25 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:06:25 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:06:25 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 27/41] action=1.0000, reward=0.0200, t=405.0s, state_diff=0.000000e+00
2025-10-24 12:06:25 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:25 - INFO - run_control_simulation:880 - STEP 27 START:
2025-10-24 12:06:25 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:25 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:06:25 - INFO - run_control_simulation:883 -   Simulation time: 405.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 420.00 s, outputting every 15.00 s
[PROGRESS] Step 900: t=411.87/420.00s (98.1%) | dt=0.4580s
  Stored output at t = 420.0000 s (Step 918)

Simulation finished at t = 420.0000 s after 918 steps.
Total runtime: 8.90 seconds.
[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:06:34 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:06:34 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:34 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:34 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:34 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:06:34 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:34 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:06:34 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:06:34 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 28/41] action=1.0000, reward=0.0200, t=420.0s, state_diff=0.000000e+00
2025-10-24 12:06:34 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:34 - INFO - run_control_simulation:880 - STEP 28 START:
2025-10-24 12:06:34 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:34 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:06:34 - INFO - run_control_simulation:883 -   Simulation time: 420.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 435.00 s, outputting every 15.00 s
[PROGRESS] Step 950: t=434.66/435.00s (99.9%) | dt=0.4580s
  Stored output at t = 435.0000 s (Step 951)

Simulation finished at t = 435.0000 s after 951 steps.
Total runtime: 9.87 seconds.
[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:06:43 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:06:43 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:43 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:43 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:43 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:06:43 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:43 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:06:43 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:06:43 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 29/41] action=0.0000, reward=0.0100, t=435.0s, state_diff=4.566915e-02
2025-10-24 12:06:43 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:43 - INFO - run_control_simulation:880 - STEP 29 START:
2025-10-24 12:06:43 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:43 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:06:43 - INFO - run_control_simulation:883 -   Simulation time: 435.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 450.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3600):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 450.0000 s (Step 984)

Simulation finished at t = 450.0000 s after 984 steps.
Total runtime: 9.79 seconds.
[REWARD_MICROSCOPE] step=30 t=450.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   30] t=  450.0s | phase=0 | reward=   0.02 | total_reward=    0.44
2025-10-24 12:06:53 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:06:53 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:06:53 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:06:53 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:06:53 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:06:53 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:06:53 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:06:53 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:06:53 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 30/41] action=0.0000, reward=0.0200, t=450.0s, state_diff=0.000000e+00
2025-10-24 12:06:53 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:06:53 - INFO - run_control_simulation:880 - STEP 30 START:
2025-10-24 12:06:53 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:06:53 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:06:53 - INFO - run_control_simulation:883 -   Simulation time: 450.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 465.00 s, outputting every 15.00 s
[PROGRESS] Step 1000: t=457.33/465.00s (98.4%) | dt=0.4580s
  Stored output at t = 465.0000 s (Step 1017)

Simulation finished at t = 465.0000 s after 1017 steps.
Total runtime: 9.20 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:07:02 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:07:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:07:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:07:02 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:07:02 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 31/41] action=0.0000, reward=0.0200, t=465.0s, state_diff=0.000000e+00
2025-10-24 12:07:02 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:02 - INFO - run_control_simulation:880 - STEP 31 START:
2025-10-24 12:07:02 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:02 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:07:02 - INFO - run_control_simulation:883 -   Simulation time: 465.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 480.00 s, outputting every 15.00 s
[PROGRESS] Step 1050: t=480.00/480.00s (100.0%) | dt=0.3435s
  Stored output at t = 480.0000 s (Step 1050)

Simulation finished at t = 480.0000 s after 1050 steps.
Total runtime: 8.75 seconds.
[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:07:11 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:07:11 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:11 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:11 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:11 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:07:11 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:11 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:07:11 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:07:11 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 32/41] action=0.0000, reward=0.0200, t=480.0s, state_diff=0.000000e+00
2025-10-24 12:07:11 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:11 - INFO - run_control_simulation:880 - STEP 32 START:
2025-10-24 12:07:11 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:11 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:07:11 - INFO - run_control_simulation:883 -   Simulation time: 480.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 495.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 3700):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 495.0000 s (Step 1083)

Simulation finished at t = 495.0000 s after 1083 steps.
Total runtime: 9.06 seconds.
[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:07:20 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:07:20 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:20 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:20 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:20 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:07:20 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:20 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:07:20 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:07:20 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 33/41] action=1.0000, reward=0.0100, t=495.0s, state_diff=4.566915e-02
2025-10-24 12:07:20 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:20 - INFO - run_control_simulation:880 - STEP 33 START:
2025-10-24 12:07:20 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:20 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:07:20 - INFO - run_control_simulation:883 -   Simulation time: 495.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 510.00 s, outputting every 15.00 s
[PROGRESS] Step 1100: t=502.79/510.00s (98.6%) | dt=0.4580s
  Stored output at t = 510.0000 s (Step 1116)

Simulation finished at t = 510.0000 s after 1116 steps.
Total runtime: 9.48 seconds.
[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:07:30 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:07:30 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:30 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:30 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:30 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:07:30 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:30 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:07:30 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:07:30 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 34/41] action=1.0000, reward=0.0200, t=510.0s, state_diff=0.000000e+00
2025-10-24 12:07:30 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:30 - INFO - run_control_simulation:880 - STEP 34 START:
2025-10-24 12:07:30 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:30 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:07:30 - INFO - run_control_simulation:883 -   Simulation time: 510.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 525.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #15000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 525.0000 s (Step 1149)

Simulation finished at t = 525.0000 s after 1149 steps.
Total runtime: 8.98 seconds.
[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:07:39 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:07:39 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:39 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:39 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:39 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:07:39 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:39 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:07:39 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:07:39 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 35/41] action=1.0000, reward=0.0200, t=525.0s, state_diff=0.000000e+00
2025-10-24 12:07:39 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:39 - INFO - run_control_simulation:880 - STEP 35 START:
2025-10-24 12:07:39 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:39 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:07:39 - INFO - run_control_simulation:883 -   Simulation time: 525.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 540.00 s, outputting every 15.00 s
[PROGRESS] Step 1150: t=525.46/540.00s (97.3%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 3800):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 540.0000 s (Step 1182)

Simulation finished at t = 540.0000 s after 1182 steps.
Total runtime: 8.87 seconds.
[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:07:48 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:07:48 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:48 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:48 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:48 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:07:48 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:48 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:07:48 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:07:48 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 36/41] action=1.0000, reward=0.0200, t=540.0s, state_diff=0.000000e+00
2025-10-24 12:07:48 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:48 - INFO - run_control_simulation:880 - STEP 36 START:
2025-10-24 12:07:48 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:48 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:07:48 - INFO - run_control_simulation:883 -   Simulation time: 540.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 555.00 s, outputting every 15.00 s
[PROGRESS] Step 1200: t=548.24/555.00s (98.8%) | dt=0.4580s
  Stored output at t = 555.0000 s (Step 1215)

Simulation finished at t = 555.0000 s after 1215 steps.
Total runtime: 9.19 seconds.
[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
2025-10-24 12:07:57 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.010000
2025-10-24 12:07:57 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:07:57 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:07:57 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:07:57 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.566915e-02, max=4.831161e+00, std=4.635603e-01
2025-10-24 12:07:57 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:07:57 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:07:57 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:07:57 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 37/41] action=0.0000, reward=0.0100, t=555.0s, state_diff=4.566915e-02
2025-10-24 12:07:57 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:07:57 - INFO - run_control_simulation:880 - STEP 37 START:
2025-10-24 12:07:57 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:07:57 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:07:57 - INFO - run_control_simulation:883 -   Simulation time: 555.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 570.00 s, outputting every 15.00 s
  Stored output at t = 570.0000 s (Step 1248)

Simulation finished at t = 570.0000 s after 1248 steps.
Total runtime: 10.03 seconds.
[REWARD_MICROSCOPE] step=38 t=570.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:08:07 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:08:07 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:07 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:07 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:07 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:08:07 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:07 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:08:07 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:08:07 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 38/41] action=0.0000, reward=0.0200, t=570.0s, state_diff=0.000000e+00
2025-10-24 12:08:07 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:07 - INFO - run_control_simulation:880 - STEP 38 START:
2025-10-24 12:08:07 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:07 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:08:07 - INFO - run_control_simulation:883 -   Simulation time: 570.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 585.00 s, outputting every 15.00 s
[PROGRESS] Step 1250: t=570.92/585.00s (97.6%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 3900):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 585.0000 s (Step 1281)

Simulation finished at t = 585.0000 s after 1281 steps.
Total runtime: 9.42 seconds.
[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
2025-10-24 12:08:16 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:08:16 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:16 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:16 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:16 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:08:16 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:16 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:08:16 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:08:16 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 39/41] action=0.0000, reward=0.0200, t=585.0s, state_diff=0.000000e+00
2025-10-24 12:08:16 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:16 - INFO - run_control_simulation:880 - STEP 39 START:
2025-10-24 12:08:16 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:16 - INFO - run_control_simulation:882 -   Action: 0.000000
2025-10-24 12:08:16 - INFO - run_control_simulation:883 -   Simulation time: 585.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
Running simulation until t = 600.00 s, outputting every 15.00 s
[PROGRESS] Step 1300: t=593.70/600.00s (99.0%) | dt=0.4580s
  Stored output at t = 600.0000 s (Step 1314)

Simulation finished at t = 600.0000 s after 1314 steps.
Total runtime: 8.94 seconds.
[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
[STEP   40] t=  600.0s | phase=0 | reward=   0.02 | total_reward=    0.62
DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
2025-10-24 12:08:25 - INFO - run_control_simulation:898 -   [BASELINE_FIXED_TIME_OPTIMAL] Reward: 0.020000
2025-10-24 12:08:25 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: True
2025-10-24 12:08:25 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:25 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:25 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:08:25 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:25 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.567259, w_c=18.929602
2025-10-24 12:08:25 - INFO - run_control_simulation:932 -   State hash: 2207370342618067592
2025-10-24 12:08:25 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_FIXED_TIME_OPTIMAL] [STEP 40/41] action=0.0000, reward=0.0200, t=600.0s, state_diff=0.000000e+00

  [BASELINE_FIXED_TIME_OPTIMAL] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_FIXED_TIME_OPTIMAL
    - Total control steps: 40
    - Total reward: 0.62
    - Avg step time: 7.307s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 292.3s
    - Speed ratio: 2.05x real-time

2025-10-24 12:08:25 - INFO - run_control_simulation:974 - 
  [BASELINE_FIXED_TIME_OPTIMAL] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_FIXED_TIME_OPTIMAL
    - Total control steps: 40
    - Total reward: 0.62
    - Avg step time: 7.307s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 292.3s
    - Speed ratio: 2.05x real-time

2025-10-24 12:08:25 - INFO - run_control_simulation:975 - Returning 40 state snapshots
   ✅ Simulation complete (292.3s, 40 states)
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 2000.0m
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 40 state snapshots (domain_length=2000.0m)
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=4649503212455588760, last=2207370342618067592
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1027 - First state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.2791648 21.2791648 21.2791648 21.2791648 21.2791648]
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1029 - Last state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.8701445 21.8701445 21.8701445 21.8701445 21.8701445]
2025-10-24 12:08:25 - INFO - evaluate_traffic_performance:1083 - Calculated metrics: flow=40.981917, efficiency=6.557107, delay=-177.42s
   📊 METRICS:
      Flow: 40.981917
      Efficiency: 6.557107
      Delay: -177.42s
      Speed: 2049.10 m/s

▶️  Testing strategy: green_only
   ══════════════════════════════════════════════════════════════════════
   Running simulation (test_baseline_strategies_network.yml)...
  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)
2025-10-24 12:08:25 - INFO - run_control_simulation:779 - ================================================================================
2025-10-24 12:08:25 - INFO - run_control_simulation:780 - Starting run_control_simulation:
2025-10-24 12:08:25 - INFO - run_control_simulation:781 -   - scenario_path: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
2025-10-24 12:08:25 - INFO - run_control_simulation:782 -   - duration: 600.0s
2025-10-24 12:08:25 - INFO - run_control_simulation:783 -   - control_interval: 15.0s
2025-10-24 12:08:25 - INFO - run_control_simulation:784 -   - device: cpu
2025-10-24 12:08:25 - INFO - run_control_simulation:785 -   - controller: BaselineController
2025-10-24 12:08:25 - INFO - run_control_simulation:786 -   - max_control_steps: 41
2025-10-24 12:08:25 - INFO - run_control_simulation:787 - ================================================================================
  [INFO] Initializing TrafficSignalEnvDirect with device=cpu
2025-10-24 12:08:25 - INFO - run_control_simulation:792 - Creating TrafficSignalEnvDirect instance...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
TrafficSignalEnvDirect initialized:
  Decision interval: 15.0s
  Observation segments: 6
  Observation space: (26,)
  Action space: 2
  Device: cpu
2025-10-24 12:08:25 - INFO - run_control_simulation:807 - TrafficSignalEnvDirect created successfully
2025-10-24 12:08:25 - INFO - run_control_simulation:808 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
  [INFO] Calling env.reset()...
2025-10-24 12:08:25 - INFO - run_control_simulation:824 - Calling env.reset()...
Initializing simulation from scenario: D:\Projets\Alibi\Code project\validation_ch7\scenarios\rl_scenarios\test_baseline_strategies_network.yml
Using device: cpu
DEBUG PARAMS: Reading K_m_kmh = 10.0
DEBUG PARAMS: Reading K_c_kmh = 15.0
DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
Parameters loaded for scenario: test_baseline_strategies_network
Grid initialized: Grid1D(N=100, xmin=0.0, xmax=2000.0, dx=20.0000, ghost=2, N_total=104, R loaded=No)
  Loading road quality type: uniform
  Uniform road quality value: 1
Road quality loaded.
Initial state created.
  DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
Initial boundary conditions applied.
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 0 RED (reduced inflow)
  └─ Inflow state: rho_m=0.0100, w_m=5.0, rho_c=0.0100, w_c=5.0
2025-10-24 12:08:25 - INFO - run_control_simulation:826 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-24 12:08:25 - INFO - run_control_simulation:845 - INITIAL STATE shape: (4, 104), dtype: float64
  [INFO] Starting simulation loop (max 41 control steps)
2025-10-24 12:08:25 - INFO - run_control_simulation:865 - Starting simulation loop - max 41 control steps
    [BASELINE green_only] step=0, time_step=0, action=1.0
2025-10-24 12:08:25 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:25 - INFO - run_control_simulation:880 - STEP 0 START:
2025-10-24 12:08:25 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:25 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:25 - INFO - run_control_simulation:883 -   Simulation time: 0.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 15.00 s, outputting every 15.00 s
  Stored output at t = 15.0000 s (Step 27)

Simulation finished at t = 15.0000 s after 27 steps.
Total runtime: 4.34 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100
2025-10-24 12:08:30 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: -0.010000
2025-10-24 12:08:30 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:30 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:30 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:30 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.521853e+00, max=1.127916e+01, std=4.822472e+00
2025-10-24 12:08:30 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:30 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.076952, w_c=17.010462
2025-10-24 12:08:30 - INFO - run_control_simulation:932 -   State hash: 4649503212455588760
2025-10-24 12:08:30 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=4.521853e+00
    [BASELINE green_only] step=1, time_step=15.0, action=1.0
2025-10-24 12:08:30 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:30 - INFO - run_control_simulation:880 - STEP 1 START:
2025-10-24 12:08:30 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:30 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:30 - INFO - run_control_simulation:883 -   Simulation time: 15.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 30.00 s, outputting every 15.00 s
[PROGRESS] Step 50: t=25.66/30.00s (85.5%) | dt=0.4596s
[PERIODIC:1000] BC_DISPATCHER [Call #16000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 4000):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.340637e-01 s
  Corrected dt: 4.587898e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.80 m/s
  Stored output at t = 30.0000 s (Step 60)

Simulation finished at t = 30.0000 s after 60 steps.
Total runtime: 4.90 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:35 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:35 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:35 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:35 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:35 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.302951e-01, max=1.593601e+00, std=6.474710e-01
2025-10-24 12:08:35 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:35 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.622366, w_c=18.571291
2025-10-24 12:08:35 - INFO - run_control_simulation:932 -   State hash: -2141492190258917154
2025-10-24 12:08:35 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=5.302951e-01
    [BASELINE green_only] step=2, time_step=30.0, action=1.0
2025-10-24 12:08:35 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:35 - INFO - run_control_simulation:880 - STEP 2 START:
2025-10-24 12:08:35 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:35 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:35 - INFO - run_control_simulation:883 -   Simulation time: 30.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 45.00 s, outputting every 15.00 s
  Stored output at t = 45.0000 s (Step 93)

Simulation finished at t = 45.0000 s after 93 steps.
Total runtime: 4.78 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:39 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:39 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:39 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:39 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:39 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.596999e-02, max=3.555804e-01, std=1.498058e-01
2025-10-24 12:08:39 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:39 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.655307, w_c=18.922230
2025-10-24 12:08:39 - INFO - run_control_simulation:932 -   State hash: 3331263232835421568
2025-10-24 12:08:39 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=9.596999e-02
2025-10-24 12:08:39 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:39 - INFO - run_control_simulation:880 - STEP 3 START:
2025-10-24 12:08:39 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:39 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:39 - INFO - run_control_simulation:883 -   Simulation time: 45.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 60.00 s, outputting every 15.00 s
[PROGRESS] Step 100: t=48.21/60.00s (80.3%) | dt=0.4580s
  Stored output at t = 60.0000 s (Step 126)

Simulation finished at t = 60.0000 s after 126 steps.
Total runtime: 4.80 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:44 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:44 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:44 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:44 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:44 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.988978e-02, max=7.934071e-02, std=3.390353e-02
2025-10-24 12:08:44 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:44 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.656943, w_c=19.000153
2025-10-24 12:08:44 - INFO - run_control_simulation:932 -   State hash: 382029719189084058
2025-10-24 12:08:44 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=1.988978e-02
2025-10-24 12:08:44 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:44 - INFO - run_control_simulation:880 - STEP 4 START:
2025-10-24 12:08:44 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:44 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:44 - INFO - run_control_simulation:883 -   Simulation time: 60.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 75.00 s, outputting every 15.00 s
[PROGRESS] Step 150: t=70.99/75.00s (94.7%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 4100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328246e-01 s
  Corrected dt: 4.580154e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 75.0000 s (Step 159)

Simulation finished at t = 75.0000 s after 159 steps.
Total runtime: 5.37 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:50 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:50 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:50 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:50 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:50 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.362421e-03, max=1.770331e-02, std=7.603828e-03
2025-10-24 12:08:50 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:50 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657024, w_c=19.017521
2025-10-24 12:08:50 - INFO - run_control_simulation:932 -   State hash: 41866111936383643
2025-10-24 12:08:50 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=4.362421e-03
2025-10-24 12:08:50 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:50 - INFO - run_control_simulation:880 - STEP 5 START:
2025-10-24 12:08:50 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:50 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:50 - INFO - run_control_simulation:883 -   Simulation time: 75.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 90.00 s, outputting every 15.00 s
  Stored output at t = 90.0000 s (Step 192)

Simulation finished at t = 90.0000 s after 192 steps.
Total runtime: 3.52 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:53 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:53 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:53 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:53 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:53 - INFO - run_control_simulation:917 -     Diff statistics: mean=9.696250e-04, max=3.950142e-03, std=1.698742e-03
2025-10-24 12:08:53 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:53 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657028, w_c=19.021396
2025-10-24 12:08:53 - INFO - run_control_simulation:932 -   State hash: -5118208850799323634
2025-10-24 12:08:53 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=9.696250e-04
2025-10-24 12:08:53 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:53 - INFO - run_control_simulation:880 - STEP 6 START:
2025-10-24 12:08:53 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:53 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:53 - INFO - run_control_simulation:883 -   Simulation time: 90.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 105.00 s, outputting every 15.00 s
[PROGRESS] Step 200: t=93.66/105.00s (89.2%) | dt=0.4580s
  Stored output at t = 105.0000 s (Step 225)

Simulation finished at t = 105.0000 s after 225 steps.
Total runtime: 4.38 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:08:57 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:08:57 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:08:57 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:08:57 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:08:57 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.161653e-04, max=8.813957e-04, std=3.791468e-04
2025-10-24 12:08:57 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:08:57 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022260
2025-10-24 12:08:57 - INFO - run_control_simulation:932 -   State hash: 1100210561383821129
2025-10-24 12:08:57 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.161653e-04
2025-10-24 12:08:57 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:08:57 - INFO - run_control_simulation:880 - STEP 7 START:
2025-10-24 12:08:57 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:08:57 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:08:57 - INFO - run_control_simulation:883 -   Simulation time: 105.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 120.00 s, outputting every 15.00 s
[PROGRESS] Step 250: t=116.45/120.00s (97.0%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 4200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 120.0000 s (Step 258)

Simulation finished at t = 120.0000 s after 258 steps.
Total runtime: 3.29 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:01 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=4.822366e-05, max=1.966660e-04, std=8.460440e-05
2025-10-24 12:09:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022453
2025-10-24 12:09:01 - INFO - run_control_simulation:932 -   State hash: 7415637918425590438
2025-10-24 12:09:01 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=4.822366e-05
2025-10-24 12:09:01 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:01 - INFO - run_control_simulation:880 - STEP 8 START:
2025-10-24 12:09:01 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:01 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:01 - INFO - run_control_simulation:883 -   Simulation time: 120.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 135.00 s, outputting every 15.00 s
  Stored output at t = 135.0000 s (Step 291)

Simulation finished at t = 135.0000 s after 291 steps.
Total runtime: 3.22 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:04 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:04 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:04 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:04 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:04 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.075969e-05, max=4.388211e-05, std=1.887806e-05
2025-10-24 12:09:04 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:04 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022496
2025-10-24 12:09:04 - INFO - run_control_simulation:932 -   State hash: -5683777811226310184
2025-10-24 12:09:04 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.075969e-05
2025-10-24 12:09:04 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:04 - INFO - run_control_simulation:880 - STEP 9 START:
2025-10-24 12:09:04 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:04 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:04 - INFO - run_control_simulation:883 -   Simulation time: 135.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 150.00 s, outputting every 15.00 s
[PROGRESS] Step 300: t=139.12/150.00s (92.7%) | dt=0.4580s
[PERIODIC:1000] BC_DISPATCHER [Call #17000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 150.0000 s (Step 324)

Simulation finished at t = 150.0000 s after 324 steps.
Total runtime: 3.45 seconds.
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01
2025-10-24 12:09:07 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:07 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:07 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:07 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:07 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.400788e-06, max=9.791422e-06, std=4.212277e-06
2025-10-24 12:09:07 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:07 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022506
2025-10-24 12:09:07 - INFO - run_control_simulation:932 -   State hash: -2032030098634609172
2025-10-24 12:09:07 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=2.400788e-06
2025-10-24 12:09:07 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:07 - INFO - run_control_simulation:880 - STEP 10 START:
2025-10-24 12:09:07 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:07 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:07 - INFO - run_control_simulation:883 -   Simulation time: 150.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 165.00 s, outputting every 15.00 s
[PROGRESS] Step 350: t=161.91/165.00s (98.1%) | dt=0.4580s
  Stored output at t = 165.0000 s (Step 357)

Simulation finished at t = 165.0000 s after 357 steps.
Total runtime: 3.52 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:11 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:11 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:11 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:11 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:11 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.356871e-07, max=2.184762e-06, std=9.398868e-07
2025-10-24 12:09:11 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:11 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:11 - INFO - run_control_simulation:932 -   State hash: 8844846229614531648
2025-10-24 12:09:11 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=5.356871e-07
2025-10-24 12:09:11 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:11 - INFO - run_control_simulation:880 - STEP 11 START:
2025-10-24 12:09:11 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:11 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:11 - INFO - run_control_simulation:883 -   Simulation time: 165.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 180.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4300):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 180.0000 s (Step 390)

Simulation finished at t = 180.0000 s after 390 steps.
Total runtime: 3.32 seconds.
[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:14 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:14 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:14 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:14 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:14 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.195279e-07, max=4.874862e-07, std=2.097171e-07
2025-10-24 12:09:14 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:14 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:14 - INFO - run_control_simulation:932 -   State hash: -3244151014718415603
2025-10-24 12:09:14 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.195279e-07
2025-10-24 12:09:14 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:14 - INFO - run_control_simulation:880 - STEP 12 START:
2025-10-24 12:09:14 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:14 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:14 - INFO - run_control_simulation:883 -   Simulation time: 180.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 195.00 s, outputting every 15.00 s
[PROGRESS] Step 400: t=184.58/195.00s (94.7%) | dt=0.4580s
  Stored output at t = 195.0000 s (Step 423)

Simulation finished at t = 195.0000 s after 423 steps.
Total runtime: 3.18 seconds.
[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:17 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:17 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:17 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:17 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:17 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.667027e-08, max=1.087729e-07, std=4.679422e-08
2025-10-24 12:09:17 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:17 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:17 - INFO - run_control_simulation:932 -   State hash: -670951465243056800
2025-10-24 12:09:17 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=2.667027e-08
2025-10-24 12:09:17 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:17 - INFO - run_control_simulation:880 - STEP 13 START:
2025-10-24 12:09:17 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:17 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:17 - INFO - run_control_simulation:883 -   Simulation time: 195.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 210.00 s, outputting every 15.00 s
[PROGRESS] Step 450: t=207.37/210.00s (98.7%) | dt=0.4580s
  Stored output at t = 210.0000 s (Step 456)

Simulation finished at t = 210.0000 s after 456 steps.
Total runtime: 3.22 seconds.
[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:21 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:21 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:21 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:21 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:21 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.950943e-09, max=2.427051e-08, std=1.044120e-08
2025-10-24 12:09:21 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:21 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:21 - INFO - run_control_simulation:932 -   State hash: 5948388895721221017
2025-10-24 12:09:21 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=5.950943e-09
2025-10-24 12:09:21 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:21 - INFO - run_control_simulation:880 - STEP 14 START:
2025-10-24 12:09:21 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:21 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:21 - INFO - run_control_simulation:883 -   Simulation time: 210.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 225.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4400):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 225.0000 s (Step 489)

Simulation finished at t = 225.0000 s after 489 steps.
Total runtime: 8.22 seconds.
[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:29 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:29 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:29 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:29 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:29 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.327837e-09, max=5.415490e-09, std=2.329750e-09
2025-10-24 12:09:29 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:29 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:29 - INFO - run_control_simulation:932 -   State hash: -4748069411139360848
2025-10-24 12:09:29 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.327837e-09
2025-10-24 12:09:29 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:29 - INFO - run_control_simulation:880 - STEP 15 START:
2025-10-24 12:09:29 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:29 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:29 - INFO - run_control_simulation:883 -   Simulation time: 225.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 240.00 s, outputting every 15.00 s
[PROGRESS] Step 500: t=230.04/240.00s (95.8%) | dt=0.4580s
  Stored output at t = 240.0000 s (Step 522)

Simulation finished at t = 240.0000 s after 522 steps.
Total runtime: 9.35 seconds.
[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:38 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:38 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:38 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:38 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:38 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.962770e-10, max=1.208345e-09, std=5.198316e-10
2025-10-24 12:09:38 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:38 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:38 - INFO - run_control_simulation:932 -   State hash: -4580383215529743096
2025-10-24 12:09:38 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=2.962770e-10
2025-10-24 12:09:38 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:38 - INFO - run_control_simulation:880 - STEP 16 START:
2025-10-24 12:09:38 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:38 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:38 - INFO - run_control_simulation:883 -   Simulation time: 240.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 255.00 s, outputting every 15.00 s
[PROGRESS] Step 550: t=252.82/255.00s (99.1%) | dt=0.4580s
  Stored output at t = 255.0000 s (Step 555)

Simulation finished at t = 255.0000 s after 555 steps.
Total runtime: 9.69 seconds.
[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:48 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:48 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:48 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:48 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:48 - INFO - run_control_simulation:917 -     Diff statistics: mean=6.610242e-11, max=2.695977e-10, std=1.159797e-10
2025-10-24 12:09:48 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:48 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:48 - INFO - run_control_simulation:932 -   State hash: 2941018457220896671
2025-10-24 12:09:48 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=6.610242e-11
2025-10-24 12:09:48 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:48 - INFO - run_control_simulation:880 - STEP 17 START:
2025-10-24 12:09:48 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:48 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:48 - INFO - run_control_simulation:883 -   Simulation time: 255.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 270.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #18000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 4500):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 270.0000 s (Step 588)

Simulation finished at t = 270.0000 s after 588 steps.
Total runtime: 8.63 seconds.
[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:09:57 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:09:57 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:09:57 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:09:57 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:09:57 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.476739e-11, max=6.017586e-11, std=2.588085e-11
2025-10-24 12:09:57 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:09:57 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:09:57 - INFO - run_control_simulation:932 -   State hash: -7380750715549063623
2025-10-24 12:09:57 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.476739e-11
2025-10-24 12:09:57 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:09:57 - INFO - run_control_simulation:880 - STEP 18 START:
2025-10-24 12:09:57 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:09:57 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:09:57 - INFO - run_control_simulation:883 -   Simulation time: 270.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 285.00 s, outputting every 15.00 s
[PROGRESS] Step 600: t=275.50/285.00s (96.7%) | dt=0.4580s
  Stored output at t = 285.0000 s (Step 621)

Simulation finished at t = 285.0000 s after 621 steps.
Total runtime: 8.09 seconds.
[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:05 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:05 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:05 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:05 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:05 - INFO - run_control_simulation:917 -     Diff statistics: mean=3.283997e-12, max=1.339018e-11, std=5.759966e-12
2025-10-24 12:10:05 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:05 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:05 - INFO - run_control_simulation:932 -   State hash: -7988195351050537352
2025-10-24 12:10:05 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=3.283997e-12
2025-10-24 12:10:05 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:05 - INFO - run_control_simulation:880 - STEP 19 START:
2025-10-24 12:10:05 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:05 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:05 - INFO - run_control_simulation:883 -   Simulation time: 285.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 300.00 s, outputting every 15.00 s
[PROGRESS] Step 650: t=298.28/300.00s (99.4%) | dt=0.4580s
  Stored output at t = 300.0000 s (Step 654)

Simulation finished at t = 300.0000 s after 654 steps.
Total runtime: 7.89 seconds.
[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01
2025-10-24 12:10:13 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:13 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:13 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:13 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:13 - INFO - run_control_simulation:917 -     Diff statistics: mean=7.386912e-13, max=3.012701e-12, std=1.296068e-12
2025-10-24 12:10:13 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:13 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:13 - INFO - run_control_simulation:932 -   State hash: 870855710520549094
2025-10-24 12:10:13 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=7.386912e-13
2025-10-24 12:10:13 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:13 - INFO - run_control_simulation:880 - STEP 20 START:
2025-10-24 12:10:13 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:13 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:13 - INFO - run_control_simulation:883 -   Simulation time: 300.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 315.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4600):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 315.0000 s (Step 687)

Simulation finished at t = 315.0000 s after 687 steps.
Total runtime: 7.92 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:21 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:21 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:21 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:21 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:21 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.681219e-13, max=6.856737e-13, std=2.949776e-13
2025-10-24 12:10:21 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:21 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:21 - INFO - run_control_simulation:932 -   State hash: 8575030684565602785
2025-10-24 12:10:21 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=1.681219e-13
2025-10-24 12:10:21 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:21 - INFO - run_control_simulation:880 - STEP 21 START:
2025-10-24 12:10:21 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:21 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:21 - INFO - run_control_simulation:883 -   Simulation time: 315.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 330.00 s, outputting every 15.00 s
[PROGRESS] Step 700: t=320.95/330.00s (97.3%) | dt=0.4580s
  Stored output at t = 330.0000 s (Step 720)

Simulation finished at t = 330.0000 s after 720 steps.
Total runtime: 7.95 seconds.
[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:28 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:28 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:28 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:28 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:28 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.655086e-14, max=6.750156e-14, std=2.903925e-14
2025-10-24 12:10:28 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:28 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:28 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:10:28 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=1.655086e-14
2025-10-24 12:10:28 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:28 - INFO - run_control_simulation:880 - STEP 22 START:
2025-10-24 12:10:28 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:28 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:28 - INFO - run_control_simulation:883 -   Simulation time: 330.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 345.00 s, outputting every 15.00 s
[PROGRESS] Step 750: t=343.74/345.00s (99.6%) | dt=0.4580s
  Stored output at t = 345.0000 s (Step 753)

Simulation finished at t = 345.0000 s after 753 steps.
Total runtime: 7.95 seconds.
[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:36 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:36 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:36 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:36 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:36 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:10:36 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:36 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:36 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:10:36 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=0.000000e+00
2025-10-24 12:10:36 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:36 - INFO - run_control_simulation:880 - STEP 23 START:
2025-10-24 12:10:36 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:36 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:36 - INFO - run_control_simulation:883 -   Simulation time: 345.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 360.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4700):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 360.0000 s (Step 786)

Simulation finished at t = 360.0000 s after 786 steps.
Total runtime: 7.85 seconds.
[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:44 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:44 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:44 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:44 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:44 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:10:44 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:44 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:44 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:10:44 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=0.000000e+00
2025-10-24 12:10:44 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:44 - INFO - run_control_simulation:880 - STEP 24 START:
2025-10-24 12:10:44 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:44 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:44 - INFO - run_control_simulation:883 -   Simulation time: 360.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 375.00 s, outputting every 15.00 s
[PROGRESS] Step 800: t=366.41/375.00s (97.7%) | dt=0.4580s
[PERIODIC:1000] BC_DISPATCHER [Call #19000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 375.0000 s (Step 819)

Simulation finished at t = 375.0000 s after 819 steps.
Total runtime: 8.19 seconds.
[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:10:53 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:10:53 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:10:53 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:10:53 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:10:53 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:10:53 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:10:53 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:10:53 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:10:53 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=0.000000e+00
2025-10-24 12:10:53 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:10:53 - INFO - run_control_simulation:880 - STEP 25 START:
2025-10-24 12:10:53 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:10:53 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:10:53 - INFO - run_control_simulation:883 -   Simulation time: 375.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 390.00 s, outputting every 15.00 s
[PROGRESS] Step 850: t=389.20/390.00s (99.8%) | dt=0.4580s
  Stored output at t = 390.0000 s (Step 852)

Simulation finished at t = 390.0000 s after 852 steps.
Total runtime: 8.46 seconds.
[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:01 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:01 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:01 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=0.000000e+00
2025-10-24 12:11:01 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:01 - INFO - run_control_simulation:880 - STEP 26 START:
2025-10-24 12:11:01 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:01 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:01 - INFO - run_control_simulation:883 -   Simulation time: 390.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 405.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4800):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 405.0000 s (Step 885)

Simulation finished at t = 405.0000 s after 885 steps.
Total runtime: 8.89 seconds.
[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:10 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:10 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:10 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:10 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:10 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:10 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:10 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:10 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:10 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=0.000000e+00
2025-10-24 12:11:10 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:10 - INFO - run_control_simulation:880 - STEP 27 START:
2025-10-24 12:11:10 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:10 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:10 - INFO - run_control_simulation:883 -   Simulation time: 405.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 420.00 s, outputting every 15.00 s
[PROGRESS] Step 900: t=411.87/420.00s (98.1%) | dt=0.4580s
  Stored output at t = 420.0000 s (Step 918)

Simulation finished at t = 420.0000 s after 918 steps.
Total runtime: 8.88 seconds.
[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:19 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:19 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:19 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:19 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:19 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:19 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:19 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:19 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:19 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=0.000000e+00
2025-10-24 12:11:19 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:19 - INFO - run_control_simulation:880 - STEP 28 START:
2025-10-24 12:11:19 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:19 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:19 - INFO - run_control_simulation:883 -   Simulation time: 420.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 435.00 s, outputting every 15.00 s
[PROGRESS] Step 950: t=434.66/435.00s (99.9%) | dt=0.4580s
  Stored output at t = 435.0000 s (Step 951)

Simulation finished at t = 435.0000 s after 951 steps.
Total runtime: 9.09 seconds.
[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:28 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:28 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:28 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:28 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:28 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:28 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:28 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:28 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:28 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=0.000000e+00
2025-10-24 12:11:28 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:28 - INFO - run_control_simulation:880 - STEP 29 START:
2025-10-24 12:11:28 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:28 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:28 - INFO - run_control_simulation:883 -   Simulation time: 435.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 450.00 s, outputting every 15.00 s
[WARNING] Automatic CFL correction applied (count: 4900):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 450.0000 s (Step 984)

Simulation finished at t = 450.0000 s after 984 steps.
Total runtime: 8.80 seconds.
[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01
2025-10-24 12:11:37 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:37 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:37 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:37 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:37 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:37 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:37 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:37 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:37 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=0.000000e+00
2025-10-24 12:11:37 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:37 - INFO - run_control_simulation:880 - STEP 30 START:
2025-10-24 12:11:37 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:37 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:37 - INFO - run_control_simulation:883 -   Simulation time: 450.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 465.00 s, outputting every 15.00 s
[PROGRESS] Step 1000: t=457.33/465.00s (98.4%) | dt=0.4580s
  Stored output at t = 465.0000 s (Step 1017)

Simulation finished at t = 465.0000 s after 1017 steps.
Total runtime: 9.49 seconds.
[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.03333334 1.         0.06666667 1.        ] (rho_m, v_m, rho_c, v_c)
[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11
[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]
[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]
[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.01 0.01 0.01 0.01 0.01 0.01]
[QUEUE_DIAGNOSTIC] Threshold: 10.625 m/s
[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
[QUEUE_DIAGNOSTIC] dx=20.00m, queue_length=0.00 vehicles
[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:46 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:46 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:46 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:46 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:46 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:46 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:46 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:46 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:46 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00
2025-10-24 12:11:46 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:46 - INFO - run_control_simulation:880 - STEP 31 START:
2025-10-24 12:11:46 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:46 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:46 - INFO - run_control_simulation:883 -   Simulation time: 465.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 480.00 s, outputting every 15.00 s
[PROGRESS] Step 1050: t=480.00/480.00s (100.0%) | dt=0.3435s
  Stored output at t = 480.0000 s (Step 1050)

Simulation finished at t = 480.0000 s after 1050 steps.
Total runtime: 13.29 seconds.
[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:11:59 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:11:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:11:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:11:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:11:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:11:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:11:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:11:59 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:11:59 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00
2025-10-24 12:11:59 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:11:59 - INFO - run_control_simulation:880 - STEP 32 START:
2025-10-24 12:11:59 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:11:59 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:11:59 - INFO - run_control_simulation:883 -   Simulation time: 480.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 495.00 s, outputting every 15.00 s
[PERIODIC:1000] BC_DISPATCHER [Call #20000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
[WARNING] Automatic CFL correction applied (count: 5000):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 495.0000 s (Step 1083)

Simulation finished at t = 495.0000 s after 1083 steps.
Total runtime: 9.72 seconds.
[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:12:09 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:12:09 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:12:09 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:12:09 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:12:09 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:12:09 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:12:09 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:12:09 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:12:09 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00
2025-10-24 12:12:09 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:12:09 - INFO - run_control_simulation:880 - STEP 33 START:
2025-10-24 12:12:09 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:12:09 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:12:09 - INFO - run_control_simulation:883 -   Simulation time: 495.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 510.00 s, outputting every 15.00 s
[PROGRESS] Step 1100: t=502.79/510.00s (98.6%) | dt=0.4580s
  Stored output at t = 510.0000 s (Step 1116)

Simulation finished at t = 510.0000 s after 1116 steps.
Total runtime: 10.38 seconds.
[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:12:20 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:12:20 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:12:20 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:12:20 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:12:20 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:12:20 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:12:20 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:12:20 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:12:20 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00
2025-10-24 12:12:20 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:12:20 - INFO - run_control_simulation:880 - STEP 34 START:
2025-10-24 12:12:20 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:12:20 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:12:20 - INFO - run_control_simulation:883 -   Simulation time: 510.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 525.00 s, outputting every 15.00 s
  Stored output at t = 525.0000 s (Step 1149)

Simulation finished at t = 525.0000 s after 1149 steps.
Total runtime: 11.29 seconds.
[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:12:31 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:12:31 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:12:31 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:12:31 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:12:31 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:12:31 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:12:31 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:12:31 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:12:31 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=0.000000e+00
2025-10-24 12:12:31 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:12:31 - INFO - run_control_simulation:880 - STEP 35 START:
2025-10-24 12:12:31 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:12:31 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:12:31 - INFO - run_control_simulation:883 -   Simulation time: 525.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 540.00 s, outputting every 15.00 s
[PROGRESS] Step 1150: t=525.46/540.00s (97.3%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 5100):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 540.0000 s (Step 1182)

Simulation finished at t = 540.0000 s after 1182 steps.
Total runtime: 10.37 seconds.
[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:12:41 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:12:41 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:12:41 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:12:41 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:12:41 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:12:41 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:12:41 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:12:41 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:12:41 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=0.000000e+00
2025-10-24 12:12:41 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:12:41 - INFO - run_control_simulation:880 - STEP 36 START:
2025-10-24 12:12:41 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:12:41 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:12:41 - INFO - run_control_simulation:883 -   Simulation time: 540.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 555.00 s, outputting every 15.00 s
[PROGRESS] Step 1200: t=548.24/555.00s (98.8%) | dt=0.4580s
  Stored output at t = 555.0000 s (Step 1215)

Simulation finished at t = 555.0000 s after 1215 steps.
Total runtime: 9.46 seconds.
[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:12:51 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:12:51 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:12:51 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:12:51 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:12:51 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:12:51 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:12:51 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:12:51 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:12:51 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=0.000000e+00
2025-10-24 12:12:51 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:12:51 - INFO - run_control_simulation:880 - STEP 37 START:
2025-10-24 12:12:51 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:12:51 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:12:51 - INFO - run_control_simulation:883 -   Simulation time: 555.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 570.00 s, outputting every 15.00 s
  Stored output at t = 570.0000 s (Step 1248)

Simulation finished at t = 570.0000 s after 1248 steps.
Total runtime: 9.36 seconds.
[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:13:00 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:13:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:13:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:13:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:13:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:13:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:13:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:13:00 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:13:00 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=0.000000e+00
2025-10-24 12:13:00 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:13:00 - INFO - run_control_simulation:880 - STEP 38 START:
2025-10-24 12:13:00 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:13:00 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:13:00 - INFO - run_control_simulation:883 -   Simulation time: 570.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 585.00 s, outputting every 15.00 s
[PROGRESS] Step 1250: t=570.92/585.00s (97.6%) | dt=0.4580s
[WARNING] Automatic CFL correction applied (count: 5200):
  Calculated CFL: 0.800 > Limit: 0.500
  Original dt: 7.328244e-01 s
  Corrected dt: 4.580153e-01 s
  Correction factor: 1.6x
  Max wave speed detected: 21.83 m/s
  Stored output at t = 585.0000 s (Step 1281)

Simulation finished at t = 585.0000 s after 1281 steps.
Total runtime: 9.66 seconds.
[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
2025-10-24 12:13:10 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:13:10 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False
2025-10-24 12:13:10 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:13:10 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:13:10 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:13:10 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:13:10 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:13:10 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:13:10 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=0.000000e+00
2025-10-24 12:13:10 - INFO - run_control_simulation:879 - ================================================================================
2025-10-24 12:13:10 - INFO - run_control_simulation:880 - STEP 39 START:
2025-10-24 12:13:10 - INFO - run_control_simulation:881 -   Controller: BaselineController
2025-10-24 12:13:10 - INFO - run_control_simulation:882 -   Action: 1.000000
2025-10-24 12:13:10 - INFO - run_control_simulation:883 -   Simulation time: 585.00s
  DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
[BC UPDATE] left à phase 1 GREEN (normal inflow)
  └─ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
Running simulation until t = 600.00 s, outputting every 15.00 s
[PROGRESS] Step 1300: t=593.70/600.00s (99.0%) | dt=0.4580s
[PERIODIC:1000] BC_DISPATCHER [Call #21000] current_bc_params: <class 'NoneType'>
[PERIODIC:1000] BC_DISPATCHER Using params.boundary_conditions (static)
  Stored output at t = 600.0000 s (Step 1314)

Simulation finished at t = 600.0000 s after 1314 steps.
Total runtime: 9.30 seconds.
[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01
DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
2025-10-24 12:13:19 - INFO - run_control_simulation:898 -   [BASELINE_GREEN_ONLY] Reward: 0.000000
2025-10-24 12:13:19 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: True
2025-10-24 12:13:19 - INFO - run_control_simulation:915 -   STATE EVOLUTION:
2025-10-24 12:13:19 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-24 12:13:19 - INFO - run_control_simulation:917 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-24 12:13:19 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.010000, rho_c=0.010000
2025-10-24 12:13:19 - INFO - run_control_simulation:928 -     Mean velocities: w_m=21.657029, w_c=19.022508
2025-10-24 12:13:19 - INFO - run_control_simulation:932 -   State hash: -387010048663008174
2025-10-24 12:13:19 - INFO - run_control_simulation:934 - ================================================================================
    [BASELINE_GREEN_ONLY] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00

  [BASELINE_GREEN_ONLY] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_GREEN_ONLY
    - Total control steps: 40
    - Total reward: -0.01
    - Avg step time: 7.343s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 293.7s
    - Speed ratio: 2.04x real-time

2025-10-24 12:13:19 - INFO - run_control_simulation:974 - 
  [BASELINE_GREEN_ONLY] [SIMULATION COMPLETED] Summary:
    - Controller type: BASELINE_GREEN_ONLY
    - Total control steps: 40
    - Total reward: -0.01
    - Avg step time: 7.343s (device=cpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 293.7s
    - Speed ratio: 2.04x real-time

2025-10-24 12:13:19 - INFO - run_control_simulation:975 - Returning 40 state snapshots
   ✅ Simulation complete (293.8s, 40 states)
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 2000.0m
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 40 state snapshots (domain_length=2000.0m)
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=4649503212455588760, last=-387010048663008174
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1027 - First state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.2791648 21.2791648 21.2791648 21.2791648 21.2791648]
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1029 - Last state sample - rho_m[10:15]=[0.01 0.01 0.01 0.01 0.01], w_m[10:15]=[21.8701445 21.8701445 21.8701445 21.8701445 21.8701445]
2025-10-24 12:13:19 - INFO - evaluate_traffic_performance:1083 - Calculated metrics: flow=40.981917, efficiency=6.557107, delay=-177.42s
   📊 METRICS:
      Flow: 40.981917
      Efficiency: 6.557107
      Delay: -177.42s
      Speed: 2049.10 m/s


STEP 5: COMPARATIVE ANALYSIS
================================================================================

📊 TOTAL FLOW:
   red_only            : 40.981917
   alternating         : 40.981917
   fixed_time_optimal  : 40.981917
   green_only          : 40.981917

   Range: 0.000000
   Variance: 0.000000e+00

📊 EFFICIENCY:
   red_only            : 6.557107
   alternating         : 6.557107
   fixed_time_optimal  : 6.557107
   green_only          : 6.557107

   Range: 0.000000
   Variance: 0.000000e+00

📊 AVERAGE SPEED:
   red_only            : 2049.10 m/s (7376.7 km/h)
   alternating         : 2049.10 m/s (7376.7 km/h)
   fixed_time_optimal  : 2049.10 m/s (7376.7 km/h)
   green_only          : 2049.10 m/s (7376.7 km/h)

   Range: 0.00 m/s
   Variance: 0.000000e+00

================================================================================
VERDICT:
================================================================================
🚨 CRITICAL: All metrics are IDENTICAL across strategies!
   → Results are HARDCODED
   → Simulation is NOT actually running with different controls
================================================================================

