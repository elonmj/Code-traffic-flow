29936.5s 1 
29936.5s 2 Simulation finished at t = 1350.0000 s after 6362 steps.
29936.5s 3 Total runtime: 0.62 seconds.
29936.5s 4 [REWARD_MICROSCOPE] step=13770 t=1350.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29936.5s 5 [STEP   90] t= 1350.0s | phase=1 | reward=   0.01 | total_reward=    0.89
29936.5s 6 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29936.5s 7 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29936.5s 8 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29936.5s 9 Running simulation until t = 1365.00 s, outputting every 15.00 s
29936.5s 10 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.13s/s]
29936.5s 11 
29936.8s 12 [PROGRESS] Step 6400: t=1358.09/1365.00s (99.5%) | dt=0.2132s
29936.8s 13 [PERIODIC:1000] BC_DISPATCHER [Call #13175000] current_bc_params: <class 'dict'>
29936.8s 14 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29936.8s 15 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29936.8s 16 [PERIODIC:1000] BC_GPU [Call #13175000] About to launch kernel
29936.8s 17 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29936.8s 18 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29936.8s 19 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29937.1s 20 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
29937.1s 21 [A
29937.1s 22 Stored output at t = 1365.0000 s (Step 6433)
29937.1s 23 
29937.1s 24 Simulation finished at t = 1365.0000 s after 6433 steps.
29937.1s 25 Total runtime: 0.62 seconds.
29937.1s 26 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.03s/s]
29937.1s 27 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
29937.1s 28 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29937.1s 29 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29937.1s 30 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29937.1s 31 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29937.1s 32 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29937.1s 33 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29937.1s 34 1.6692446e-05]
29937.1s 35 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29937.1s 36 2.3782164e-05]
29937.1s 37 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29937.1s 38 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29937.1s 39 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29937.1s 40 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29937.1s 41 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29937.1s 42 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29937.1s 43 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29937.1s 44 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29937.1s 45 [REWARD_MICROSCOPE] step=13771 t=1365.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29937.1s 46 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29937.1s 47 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29937.1s 48 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29937.1s 49 Running simulation until t = 1380.00 s, outputting every 15.00 s
29937.1s 50 
29937.3s 51 [PROGRESS] Step 6450: t=1368.61/1380.00s (99.2%) | dt=0.2124s
29937.3s 52 [WARNING] Automatic CFL correction applied (count: 3293700):
29937.3s 53 Calculated CFL: 0.800 > Limit: 0.500
29937.3s 54 Original dt: 3.398585e-01 s
29937.3s 55 Corrected dt: 2.124115e-01 s
29937.3s 56 Correction factor: 1.6x
29937.3s 57 Max wave speed detected: 23.54 m/s
29937.7s 58 [PROGRESS] Step 6500: t=1379.24/1380.00s (99.9%) | dt=0.2128s
29937.7s 59 Stored output at t = 1380.0000 s (Step 6504)
29937.7s 60 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
29937.7s 61 [A
29937.7s 62 
29937.7s 63 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.36s/s]
29937.7s 64 Simulation finished at t = 1380.0000 s after 6504 steps.
29937.7s 65 Total runtime: 0.62 seconds.
29937.7s 66 [REWARD_MICROSCOPE] step=13772 t=1380.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29937.7s 67 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29937.7s 68 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29937.7s 69 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29937.7s 70 Running simulation until t = 1395.00 s, outputting every 15.00 s
29937.7s 71 
29938.1s 72 [PROGRESS] Step 6550: t=1389.80/1395.00s (99.6%) | dt=0.2132s
29938.2s 73 [WARNING] Automatic CFL correction applied (count: 3293800):
29938.2s 74 Calculated CFL: 0.800 > Limit: 0.500
29938.2s 75 Original dt: 3.412422e-01 s
29938.2s 76 Corrected dt: 2.132764e-01 s
29938.2s 77 Correction factor: 1.6x
29938.2s 78 Max wave speed detected: 23.44 m/s
29938.4s 79 Stored output at t = 1395.0000 s (Step 6575)
29938.4s 80 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
29938.4s 81 [A
29938.4s 82 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.08s/s]
29938.4s 83 
29938.4s 84 Simulation finished at t = 1395.0000 s after 6575 steps.
29938.4s 85 Total runtime: 0.62 seconds.
29938.4s 86 [REWARD_MICROSCOPE] step=13773 t=1395.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29938.4s 87 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29938.4s 88 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29938.4s 89 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29938.4s 90 Running simulation until t = 1410.00 s, outputting every 15.00 s
29938.4s 91 
29938.6s 92 [PROGRESS] Step 6600: t=1400.31/1410.00s (99.3%) | dt=0.2124s
29939.0s 93 Stored output at t = 1410.0000 s (Step 6646)
29939.0s 94 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
29939.0s 95 [A
29939.0s 96 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.32s/s]
29939.0s 97 
29939.0s 98 Simulation finished at t = 1410.0000 s after 6646 steps.
29939.0s 99 Total runtime: 0.62 seconds.
29939.0s 100 [REWARD_MICROSCOPE] step=13774 t=1410.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29939.0s 101 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29939.0s 102 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29939.0s 103 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29939.0s 104 Running simulation until t = 1425.00 s, outputting every 15.00 s
29939.0s 105 
29939.0s 106 [PROGRESS] Step 6650: t=1410.85/1425.00s (99.0%) | dt=0.2129s
29939.0s 107 [PERIODIC:1000] BC_DISPATCHER [Call #13176000] current_bc_params: <class 'dict'>
29939.0s 108 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29939.0s 109 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29939.0s 110 [PERIODIC:1000] BC_GPU [Call #13176000] About to launch kernel
29939.0s 111 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29939.0s 112 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29939.0s 113 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29939.1s 114 [WARNING] Automatic CFL correction applied (count: 3293900):
29939.1s 115 Calculated CFL: 0.800 > Limit: 0.500
29939.1s 116 Original dt: 3.406657e-01 s
29939.1s 117 Corrected dt: 2.129161e-01 s
29939.1s 118 Correction factor: 1.6x
29939.1s 119 Max wave speed detected: 23.48 m/s
29939.5s 120 [PROGRESS] Step 6700: t=1421.51/1425.00s (99.8%) | dt=0.2133s
29939.6s 121 Stored output at t = 1425.0000 s (Step 6717)
29939.6s 122 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
29939.6s 123 [A
29939.6s 124 
29939.6s 125 Simulation finished at t = 1425.0000 s after 6717 steps.
29939.6s 126 Total runtime: 0.62 seconds.
29939.6s 127 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.25s/s]
29939.6s 128 [REWARD_MICROSCOPE] step=13775 t=1425.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29939.6s 129 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29939.6s 130 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29939.6s 131 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29939.6s 132 Running simulation until t = 1440.00 s, outputting every 15.00 s
29939.6s 133 
29939.9s 134 [PROGRESS] Step 6750: t=1432.01/1440.00s (99.4%) | dt=0.2125s
29939.9s 135 [WARNING] Automatic CFL correction applied (count: 3294000):
29939.9s 136 Calculated CFL: 0.800 > Limit: 0.500
29939.9s 137 Original dt: 3.400921e-01 s
29939.9s 138 Corrected dt: 2.125575e-01 s
29939.9s 139 Correction factor: 1.6x
29939.9s 140 Max wave speed detected: 23.52 m/s
29940.2s 141 Stored output at t = 1440.0000 s (Step 6788)
29940.2s 142 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
29940.2s 143 [A
29940.2s 144 
29940.2s 145 Simulation finished at t = 1440.0000 s after 6788 steps.
29940.2s 146 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.04s/s]
29940.2s 147 Total runtime: 0.62 seconds.
29940.2s 148 [REWARD_MICROSCOPE] step=13776 t=1440.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29940.2s 149 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29940.2s 150 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29940.2s 151 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29940.2s 152 Running simulation until t = 1455.00 s, outputting every 15.00 s
29940.2s 153 
29940.3s 154 [PROGRESS] Step 6800: t=1442.55/1455.00s (99.1%) | dt=0.2129s
29940.8s 155 [PROGRESS] Step 6850: t=1453.21/1455.00s (99.9%) | dt=0.2129s
29940.9s 156 [WARNING] Automatic CFL correction applied (count: 3294100):
29940.9s 157 Calculated CFL: 0.800 > Limit: 0.500
29940.9s 158 Original dt: 3.402189e-01 s
29940.9s 159 Corrected dt: 2.126368e-01 s
29940.9s 160 Correction factor: 1.6x
29940.9s 161 Max wave speed detected: 23.51 m/s
29940.9s 162 Stored output at t = 1455.0000 s (Step 6859)
29940.9s 163 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
29940.9s 164 [A
29940.9s 165 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.20s/s]
29940.9s 166 
29940.9s 167 Simulation finished at t = 1455.0000 s after 6859 steps.
29940.9s 168 Total runtime: 0.65 seconds.
29940.9s 169 [REWARD_MICROSCOPE] step=13777 t=1455.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29940.9s 170 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29940.9s 171 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29940.9s 172 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29940.9s 173 Running simulation until t = 1470.00 s, outputting every 15.00 s
29940.9s 174 
29941.2s 175 [PROGRESS] Step 6900: t=1463.71/1470.00s (99.6%) | dt=0.2126s
29941.3s 176 [PERIODIC:1000] BC_DISPATCHER [Call #13177000] current_bc_params: <class 'dict'>
29941.3s 177 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29941.3s 178 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29941.3s 179 [PERIODIC:1000] BC_GPU [Call #13177000] About to launch kernel
29941.3s 180 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29941.3s 181 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29941.3s 182 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29941.5s 183 Stored output at t = 1470.0000 s (Step 6930)
29941.5s 184 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
29941.5s 185 [A
29941.5s 186 
29941.5s 187 Simulation finished at t = 1470.0000 s after 6930 steps.
29941.5s 188 Total runtime: 0.62 seconds.
29941.5s 189 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.18s/s]
29941.5s 190 [REWARD_MICROSCOPE] step=13778 t=1470.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29941.5s 191 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29941.5s 192 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29941.5s 193 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29941.5s 194 Running simulation until t = 1485.00 s, outputting every 15.00 s
29941.5s 195 
29941.7s 196 [PROGRESS] Step 6950: t=1474.26/1485.00s (99.3%) | dt=0.2130s
29941.7s 197 [WARNING] Automatic CFL correction applied (count: 3294200):
29941.7s 198 Calculated CFL: 0.800 > Limit: 0.500
29941.7s 199 Original dt: 3.408895e-01 s
29941.7s 200 Corrected dt: 2.130559e-01 s
29941.7s 201 Correction factor: 1.6x
29941.7s 202 Max wave speed detected: 23.47 m/s
29942.1s 203 [PROGRESS] Step 7000: t=1484.91/1485.00s (100.0%) | dt=0.2126s
29942.1s 204 Stored output at t = 1485.0000 s (Step 7001)
29942.1s 205 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
29942.1s 206 [A
29942.1s 207 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.35s/s]
29942.1s 208 
29942.1s 209 Simulation finished at t = 1485.0000 s after 7001 steps.
29942.1s 210 Total runtime: 0.62 seconds.
29942.1s 211 [REWARD_MICROSCOPE] step=13779 t=1485.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29942.1s 212 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29942.1s 213 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29942.1s 214 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29942.1s 215 Running simulation until t = 1500.00 s, outputting every 15.00 s
29942.1s 216 
29942.6s 217 [PROGRESS] Step 7050: t=1495.41/1500.00s (99.7%) | dt=0.2126s
29942.6s 218 [WARNING] Automatic CFL correction applied (count: 3294300):
29942.6s 219 Calculated CFL: 0.800 > Limit: 0.500
29942.6s 220 Original dt: 3.403151e-01 s
29942.6s 221 Corrected dt: 2.126969e-01 s
29942.6s 222 Correction factor: 1.6x
29942.6s 223 Max wave speed detected: 23.51 m/s
29942.8s 224 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
29942.8s 225 [A
29942.8s 226 Stored output at t = 1500.0000 s (Step 7072)
29942.8s 227 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.82s/s]
29942.8s 228 
29942.8s 229 Simulation finished at t = 1500.0000 s after 7072 steps.
29942.8s 230 Total runtime: 0.63 seconds.
29942.8s 231 [REWARD_MICROSCOPE] step=13780 t=1500.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29942.8s 232 [STEP  100] t= 1500.0s | phase=1 | reward=   0.01 | total_reward=    0.99
29942.8s 233 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29942.8s 234 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29942.8s 235 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29942.8s 236 Running simulation until t = 1515.00 s, outputting every 15.00 s
29942.8s 237 
29943.0s 238 [PROGRESS] Step 7100: t=1505.96/1515.00s (99.4%) | dt=0.2131s
29943.4s 239 Stored output at t = 1515.0000 s (Step 7143)
29943.4s 240 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
29943.4s 241 [A
29943.4s 242 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.53s/s]
29943.4s 243 
29943.4s 244 Simulation finished at t = 1515.0000 s after 7143 steps.
29943.4s 245 Total runtime: 0.61 seconds.
29943.4s 246 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
29943.4s 247 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29943.4s 248 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29943.4s 249 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29943.4s 250 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29943.4s 251 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29943.4s 252 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29943.4s 253 1.6692446e-05]
29943.4s 254 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29943.4s 255 2.3782164e-05]
29943.4s 256 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29943.4s 257 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29943.4s 258 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29943.4s 259 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29943.4s 260 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29943.4s 261 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29943.4s 262 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29943.4s 263 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29943.4s 264 [REWARD_MICROSCOPE] step=13781 t=1515.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29943.4s 265 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29943.4s 266 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29943.4s 267 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29943.4s 268 Running simulation until t = 1530.00 s, outputting every 15.00 s
29943.4s 269 
29943.4s 270 [PROGRESS] Step 7150: t=1516.49/1530.00s (99.1%) | dt=0.2124s
29943.4s 271 [PERIODIC:1000] BC_DISPATCHER [Call #13178000] current_bc_params: <class 'dict'>
29943.4s 272 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29943.4s 273 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29943.4s 274 [PERIODIC:1000] BC_GPU [Call #13178000] About to launch kernel
29943.4s 275 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29943.4s 276 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29943.4s 277 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29943.5s 278 [WARNING] Automatic CFL correction applied (count: 3294400):
29943.5s 279 Calculated CFL: 0.800 > Limit: 0.500
29943.5s 280 Original dt: 3.397193e-01 s
29943.5s 281 Corrected dt: 2.123245e-01 s
29943.5s 282 Correction factor: 1.6x
29943.5s 283 Max wave speed detected: 23.55 m/s
29943.9s 284 [PROGRESS] Step 7200: t=1527.11/1530.00s (99.8%) | dt=0.2127s
29944.0s 285 Stored output at t = 1530.0000 s (Step 7214)
29944.0s 286 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
29944.0s 287 [A
29944.0s 288 
29944.0s 289 Simulation finished at t = 1530.0000 s after 7214 steps.
29944.0s 290 Total runtime: 0.61 seconds.
29944.0s 291 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.55s/s]
29944.0s 292 [REWARD_MICROSCOPE] step=13782 t=1530.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29944.0s 293 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29944.0s 294 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29944.0s 295 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29944.0s 296 Running simulation until t = 1545.00 s, outputting every 15.00 s
29944.0s 297 
29944.3s 298 [PROGRESS] Step 7250: t=1537.67/1545.00s (99.5%) | dt=0.2131s
29944.4s 299 [WARNING] Automatic CFL correction applied (count: 3294500):
29944.4s 300 Calculated CFL: 0.800 > Limit: 0.500
29944.4s 301 Original dt: 3.411064e-01 s
29944.4s 302 Corrected dt: 2.131915e-01 s
29944.4s 303 Correction factor: 1.6x
29944.4s 304 Max wave speed detected: 23.45 m/s
29944.6s 305 Stored output at t = 1545.0000 s (Step 7285)
29944.6s 306 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
29944.6s 307 [A
29944.6s 308 
29944.6s 309 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 24.32s/s]
29944.6s 310 Simulation finished at t = 1545.0000 s after 7285 steps.
29944.6s 311 Total runtime: 0.62 seconds.
29944.6s 312 [REWARD_MICROSCOPE] step=13783 t=1545.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29944.6s 313 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29944.6s 314 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29944.6s 315 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29944.6s 316 Running simulation until t = 1560.00 s, outputting every 15.00 s
29944.6s 317 
29944.7s 318 [PROGRESS] Step 7300: t=1548.19/1560.00s (99.2%) | dt=0.2123s
29945.2s 319 [PROGRESS] Step 7350: t=1558.81/1560.00s (99.9%) | dt=0.2128s
29945.2s 320 [WARNING] Automatic CFL correction applied (count: 3294600):
29945.2s 321 Calculated CFL: 0.800 > Limit: 0.500
29945.2s 322 Original dt: 3.405361e-01 s
29945.2s 323 Corrected dt: 2.128351e-01 s
29945.2s 324 Correction factor: 1.6x
29945.2s 325 Max wave speed detected: 23.49 m/s
29945.2s 326 Stored output at t = 1560.0000 s (Step 7356)
29945.2s 327 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
29945.2s 328 [A
29945.2s 329 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.04s/s]
29945.2s 330 
29945.2s 331 Simulation finished at t = 1560.0000 s after 7356 steps.
29945.2s 332 Total runtime: 0.62 seconds.
29945.2s 333 [REWARD_MICROSCOPE] step=13784 t=1560.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29945.2s 334 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29945.2s 335 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29945.2s 336 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29945.2s 337 Running simulation until t = 1575.00 s, outputting every 15.00 s
29945.2s 338 
29945.6s 339 [PROGRESS] Step 7400: t=1569.37/1575.00s (99.6%) | dt=0.2132s
29945.6s 340 [PERIODIC:1000] BC_DISPATCHER [Call #13179000] current_bc_params: <class 'dict'>
29945.6s 341 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29945.6s 342 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29945.6s 343 [PERIODIC:1000] BC_GPU [Call #13179000] About to launch kernel
29945.6s 344 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29945.6s 345 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29945.6s 346 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29945.9s 347 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
29945.9s 348 [A
29945.9s 349 Stored output at t = 1575.0000 s (Step 7427)
29945.9s 350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.34s/s]
29945.9s 351 
29945.9s 352 Simulation finished at t = 1575.0000 s after 7427 steps.
29945.9s 353 Total runtime: 0.62 seconds.
29945.9s 354 [REWARD_MICROSCOPE] step=13785 t=1575.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29945.9s 355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29945.9s 356 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29945.9s 357 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29945.9s 358 Running simulation until t = 1590.00 s, outputting every 15.00 s
29945.9s 359 
29946.1s 360 [PROGRESS] Step 7450: t=1579.88/1590.00s (99.4%) | dt=0.2124s
29946.1s 361 [WARNING] Automatic CFL correction applied (count: 3294700):
29946.1s 362 Calculated CFL: 0.800 > Limit: 0.500
29946.1s 363 Original dt: 3.399493e-01 s
29946.1s 364 Corrected dt: 2.124683e-01 s
29946.1s 365 Correction factor: 1.6x
29946.1s 366 Max wave speed detected: 23.53 m/s
29946.5s 367 Stored output at t = 1590.0000 s (Step 7498)
29946.5s 368 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
29946.5s 369 [A
29946.5s 370 
29946.5s 371 Simulation finished at t = 1590.0000 s after 7498 steps.
29946.5s 372 Total runtime: 0.61 seconds.
29946.5s 373 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.45s/s]
29946.5s 374 [REWARD_MICROSCOPE] step=13786 t=1590.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29946.5s 375 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29946.5s 376 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29946.5s 377 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29946.5s 378 Running simulation until t = 1605.00 s, outputting every 15.00 s
29946.5s 379 
29946.5s 380 [PROGRESS] Step 7500: t=1590.43/1605.00s (99.1%) | dt=0.2128s
29946.9s 381 [PROGRESS] Step 7550: t=1601.08/1605.00s (99.8%) | dt=0.2133s
29947.0s 382 [WARNING] Automatic CFL correction applied (count: 3294800):
29947.0s 383 Calculated CFL: 0.800 > Limit: 0.500
29947.0s 384 Original dt: 3.409227e-01 s
29947.0s 385 Corrected dt: 2.130767e-01 s
29947.0s 386 Correction factor: 1.6x
29947.0s 387 Max wave speed detected: 23.47 m/s
29947.1s 388 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
29947.1s 389 Stored output at t = 1605.0000 s (Step 7569)
29947.1s 390 [A
29947.1s 391 
29947.1s 392 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.39s/s]
29947.1s 393 Simulation finished at t = 1605.0000 s after 7569 steps.
29947.1s 394 Total runtime: 0.62 seconds.
29947.1s 395 [REWARD_MICROSCOPE] step=13787 t=1605.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29947.1s 396 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29947.1s 397 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29947.1s 398 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29947.1s 399 Running simulation until t = 1620.00 s, outputting every 15.00 s
29947.1s 400 
29947.4s 401 [PROGRESS] Step 7600: t=1611.58/1620.00s (99.5%) | dt=0.2125s
29947.7s 402 Stored output at t = 1620.0000 s (Step 7640)
29947.7s 403 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
29947.7s 404 [A
29947.7s 405 
29947.7s 406 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.39s/s]
29947.7s 407 Simulation finished at t = 1620.0000 s after 7640 steps.
29947.7s 408 Total runtime: 0.62 seconds.
29947.7s 409 [REWARD_MICROSCOPE] step=13788 t=1620.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29947.7s 410 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29947.7s 411 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29947.7s 412 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29947.7s 413 Running simulation until t = 1635.00 s, outputting every 15.00 s
29947.7s 414 
29947.8s 415 [PROGRESS] Step 7650: t=1622.13/1635.00s (99.2%) | dt=0.2129s
29947.8s 416 [PERIODIC:1000] BC_DISPATCHER [Call #13180000] current_bc_params: <class 'dict'>
29947.8s 417 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29947.8s 418 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29947.8s 419 [PERIODIC:1000] BC_GPU [Call #13180000] About to launch kernel
29947.8s 420 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29947.8s 421 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29947.8s 422 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29947.8s 423 [WARNING] Automatic CFL correction applied (count: 3294900):
29947.8s 424 Calculated CFL: 0.800 > Limit: 0.500
29947.8s 425 Original dt: 3.407491e-01 s
29947.8s 426 Corrected dt: 2.129682e-01 s
29947.8s 427 Correction factor: 1.6x
29947.8s 428 Max wave speed detected: 23.48 m/s
29948.2s 429 [PROGRESS] Step 7700: t=1632.79/1635.00s (99.9%) | dt=0.2133s
29948.3s 430 Stored output at t = 1635.0000 s (Step 7711)
29948.3s 431 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
29948.3s 432 [A
29948.3s 433 
29948.3s 434 Simulation finished at t = 1635.0000 s after 7711 steps.
29948.3s 435 Total runtime: 0.62 seconds.
29948.3s 436 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.10s/s]
29948.3s 437 [REWARD_MICROSCOPE] step=13789 t=1635.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29948.3s 438 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29948.3s 439 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29948.3s 440 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29948.3s 441 Running simulation until t = 1650.00 s, outputting every 15.00 s
29948.3s 442 
29948.7s 443 [PROGRESS] Step 7750: t=1643.33/1650.00s (99.6%) | dt=0.2137s
29948.7s 444 [WARNING] Automatic CFL correction applied (count: 3295000):
29948.7s 445 Calculated CFL: 0.800 > Limit: 0.500
29948.7s 446 Original dt: 3.420660e-01 s
29948.7s 447 Corrected dt: 2.137912e-01 s
29948.7s 448 Correction factor: 1.6x
29948.7s 449 Max wave speed detected: 23.39 m/s
29949.0s 450 Stored output at t = 1650.0000 s (Step 7782)
29949.0s 451 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
29949.0s 452 [A
29949.0s 453 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.28s/s]
29949.0s 454 
29949.0s 455 Simulation finished at t = 1650.0000 s after 7782 steps.
29949.0s 456 Total runtime: 0.62 seconds.
29949.0s 457 [REWARD_MICROSCOPE] step=13790 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29949.0s 458 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    1.10
29949.0s 459 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29949.0s 460 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29949.0s 461 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29949.0s 462 Running simulation until t = 1665.00 s, outputting every 15.00 s
29949.0s 463 
29949.1s 464 [PROGRESS] Step 7800: t=1653.82/1665.00s (99.3%) | dt=0.2124s
29949.6s 465 [PROGRESS] Step 7850: t=1664.45/1665.00s (100.0%) | dt=0.2129s
29949.6s 466 Stored output at t = 1665.0000 s (Step 7853)
29949.6s 467 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
29949.6s 468 [A
29949.6s 469 
29949.6s 470 Simulation finished at t = 1665.0000 s after 7853 steps.
29949.6s 471 Total runtime: 0.61 seconds.
29949.6s 472 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.41s/s]
29949.6s 473 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
29949.6s 474 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29949.6s 475 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568689 1.         0.03926192 1.        ] (rho_m, v_m, rho_c, v_c)
29949.6s 476 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29949.6s 477 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29949.6s 478 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29949.6s 479 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470607 0.00449094 0.00441423 0.00438314 0.0043693  0.00436211]
29949.6s 480 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00588929 0.00546676 0.0052301  0.00509614 0.00502496 0.00498911]
29949.6s 481 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29949.6s 482 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29949.6s 483 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29949.6s 484 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29949.6s 485 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29949.6s 486 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29949.6s 487 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29949.6s 488 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29949.6s 489 [REWARD_MICROSCOPE] step=13791 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29949.6s 490 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29949.6s 491 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29949.6s 492 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29949.6s 493 Running simulation until t = 1680.00 s, outputting every 15.00 s
29949.6s 494 
29949.6s 495 [WARNING] Automatic CFL correction applied (count: 3295100):
29949.6s 496 Calculated CFL: 0.800 > Limit: 0.500
29949.6s 497 Original dt: 3.406472e-01 s
29949.6s 498 Corrected dt: 2.129045e-01 s
29949.6s 499 Correction factor: 1.6x
29949.6s 500 Max wave speed detected: 23.48 m/s
29950.0s 501 [PROGRESS] Step 7900: t=1675.02/1680.00s (99.7%) | dt=0.2133s
29950.0s 502 [PERIODIC:1000] BC_DISPATCHER [Call #13181000] current_bc_params: <class 'dict'>
29950.0s 503 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29950.0s 504 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29950.0s 505 [PERIODIC:1000] BC_GPU [Call #13181000] About to launch kernel
29950.0s 506 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29950.0s 507 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29950.0s 508 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29950.2s 509 Stored output at t = 1680.0000 s (Step 7924)
29950.2s 510 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
29950.2s 511 [A
29950.2s 512 
29950.2s 513 Simulation finished at t = 1680.0000 s after 7924 steps.
29950.2s 514 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.56s/s]
29950.2s 515 Total runtime: 0.61 seconds.
29950.2s 516 [REWARD_MICROSCOPE] step=13792 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29950.2s 517 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29950.2s 518 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29950.2s 519 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29950.2s 520 Running simulation until t = 1695.00 s, outputting every 15.00 s
29950.2s 521 
29950.4s 522 [PROGRESS] Step 7950: t=1685.52/1695.00s (99.4%) | dt=0.2124s
29950.5s 523 [WARNING] Automatic CFL correction applied (count: 3295200):
29950.5s 524 Calculated CFL: 0.800 > Limit: 0.500
29950.5s 525 Original dt: 3.399888e-01 s
29950.5s 526 Corrected dt: 2.124930e-01 s
29950.5s 527 Correction factor: 1.6x
29950.5s 528 Max wave speed detected: 23.53 m/s
29950.8s 529 Stored output at t = 1695.0000 s (Step 7995)
29950.8s 530 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
29950.8s 531 [A
29950.8s 532 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.35s/s]
29950.8s 533 
29950.8s 534 Simulation finished at t = 1695.0000 s after 7995 steps.
29950.8s 535 Total runtime: 0.64 seconds.
29950.8s 536 [REWARD_MICROSCOPE] step=13793 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29950.8s 537 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29950.8s 538 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29950.8s 539 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29950.8s 540 Running simulation until t = 1710.00 s, outputting every 15.00 s
29950.8s 541 
29950.9s 542 [PROGRESS] Step 8000: t=1696.06/1710.00s (99.2%) | dt=0.2129s
29951.3s 543 [PROGRESS] Step 8050: t=1706.72/1710.00s (99.8%) | dt=0.2133s
29951.4s 544 [WARNING] Automatic CFL correction applied (count: 3295300):
29951.4s 545 Calculated CFL: 0.800 > Limit: 0.500
29951.4s 546 Original dt: 3.406767e-01 s
29951.4s 547 Corrected dt: 2.129230e-01 s
29951.4s 548 Correction factor: 1.6x
29951.4s 549 Max wave speed detected: 23.48 m/s
29951.5s 550 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
29951.5s 551 [A
29951.5s 552 Stored output at t = 1710.0000 s (Step 8066)
29951.5s 553 
29951.5s 554 Simulation finished at t = 1710.0000 s after 8066 steps.
29951.5s 555 Total runtime: 0.62 seconds.
29951.5s 556 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.29s/s]
29951.5s 557 [REWARD_MICROSCOPE] step=13794 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29951.5s 558 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29951.5s 559 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29951.5s 560 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29951.5s 561 Running simulation until t = 1725.00 s, outputting every 15.00 s
29951.5s 562 
29951.8s 563 [PROGRESS] Step 8100: t=1717.22/1725.00s (99.5%) | dt=0.2125s
29952.1s 564 Stored output at t = 1725.0000 s (Step 8137)
29952.1s 565 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
29952.1s 566 [A
29952.1s 567 
29952.1s 568 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.11s/s]
29952.1s 569 Simulation finished at t = 1725.0000 s after 8137 steps.
29952.1s 570 Total runtime: 0.62 seconds.
29952.1s 571 [REWARD_MICROSCOPE] step=13795 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29952.1s 572 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29952.1s 573 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29952.1s 574 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29952.1s 575 Running simulation until t = 1740.00 s, outputting every 15.00 s
29952.1s 576 
29952.2s 577 [PROGRESS] Step 8150: t=1727.77/1740.00s (99.3%) | dt=0.2129s
29952.2s 578 [PERIODIC:1000] BC_DISPATCHER [Call #13182000] current_bc_params: <class 'dict'>
29952.2s 579 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29952.2s 580 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29952.2s 581 [PERIODIC:1000] BC_GPU [Call #13182000] About to launch kernel
29952.2s 582 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29952.2s 583 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29952.2s 584 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29952.2s 585 [WARNING] Automatic CFL correction applied (count: 3295400):
29952.2s 586 Calculated CFL: 0.800 > Limit: 0.500
29952.2s 587 Original dt: 3.407917e-01 s
29952.2s 588 Corrected dt: 2.129948e-01 s
29952.2s 589 Correction factor: 1.6x
29952.2s 590 Max wave speed detected: 23.47 m/s
29952.6s 591 [PROGRESS] Step 8200: t=1738.42/1740.00s (99.9%) | dt=0.2128s
29952.7s 592 Stored output at t = 1740.0000 s (Step 8208)
29952.7s 593 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
29952.7s 594 [A
29952.7s 595 
29952.7s 596 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.52s/s]
29952.7s 597 Simulation finished at t = 1740.0000 s after 8208 steps.
29952.7s 598 Total runtime: 0.61 seconds.
29952.7s 599 [REWARD_MICROSCOPE] step=13796 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29952.7s 600 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29952.7s 601 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29952.7s 602 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29952.7s 603 Running simulation until t = 1755.00 s, outputting every 15.00 s
29952.7s 604 
29953.1s 605 [PROGRESS] Step 8250: t=1748.92/1755.00s (99.7%) | dt=0.2126s
29953.1s 606 [WARNING] Automatic CFL correction applied (count: 3295500):
29953.1s 607 Calculated CFL: 0.800 > Limit: 0.500
29953.1s 608 Original dt: 3.402142e-01 s
29953.1s 609 Corrected dt: 2.126339e-01 s
29953.1s 610 Correction factor: 1.6x
29953.1s 611 Max wave speed detected: 23.51 m/s
29953.3s 612 Stored output at t = 1755.0000 s (Step 8279)
29953.3s 613 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
29953.3s 614 [A
29953.3s 615 
29953.3s 616 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.69s/s]
29953.3s 617 Simulation finished at t = 1755.0000 s after 8279 steps.
29953.3s 618 Total runtime: 0.61 seconds.
29953.3s 619 [REWARD_MICROSCOPE] step=13797 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29953.3s 620 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29953.3s 621 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29953.3s 622 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29953.3s 623 Running simulation until t = 1770.00 s, outputting every 15.00 s
29953.3s 624 
29953.5s 625 [PROGRESS] Step 8300: t=1759.47/1770.00s (99.4%) | dt=0.2130s
29953.9s 626 [PROGRESS] Step 8350: t=1770.00/1770.00s (100.0%) | dt=0.0883s
29953.9s 627 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
29953.9s 628 [A
29953.9s 629 Stored output at t = 1770.0000 s (Step 8350)
29953.9s 630 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.21s/s]
29953.9s 631 
29953.9s 632 Simulation finished at t = 1770.0000 s after 8350 steps.
29953.9s 633 Total runtime: 0.62 seconds.
29953.9s 634 [REWARD_MICROSCOPE] step=13798 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29953.9s 635 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29953.9s 636 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29953.9s 637 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29953.9s 638 Running simulation until t = 1785.00 s, outputting every 15.00 s
29953.9s 639 
29954.0s 640 [WARNING] Automatic CFL correction applied (count: 3295600):
29954.0s 641 Calculated CFL: 0.800 > Limit: 0.500
29954.0s 642 Original dt: 3.398316e-01 s
29954.0s 643 Corrected dt: 2.123948e-01 s
29954.0s 644 Correction factor: 1.6x
29954.0s 645 Max wave speed detected: 23.54 m/s
29954.4s 646 [PROGRESS] Step 8400: t=1780.61/1785.00s (99.8%) | dt=0.2119s
29954.4s 647 [PERIODIC:1000] BC_DISPATCHER [Call #13183000] current_bc_params: <class 'dict'>
29954.4s 648 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29954.4s 649 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29954.4s 650 [PERIODIC:1000] BC_GPU [Call #13183000] About to launch kernel
29954.4s 651 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29954.4s 652 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29954.4s 653 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29954.6s 654 Stored output at t = 1785.0000 s (Step 8421)
29954.6s 655 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
29954.6s 656 [A
29954.6s 657 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.37s/s]
29954.6s 658 
29954.6s 659 Simulation finished at t = 1785.0000 s after 8421 steps.
29954.6s 660 Total runtime: 0.62 seconds.
29954.6s 661 [REWARD_MICROSCOPE] step=13799 t=1785.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29954.6s 662 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29954.6s 663 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29954.6s 664 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29954.6s 665 Running simulation until t = 1800.00 s, outputting every 15.00 s
29954.6s 666 
29954.8s 667 [PROGRESS] Step 8450: t=1791.14/1800.00s (99.5%) | dt=0.2118s
29954.9s 668 [WARNING] Automatic CFL correction applied (count: 3295700):
29954.9s 669 Calculated CFL: 0.800 > Limit: 0.500
29954.9s 670 Original dt: 3.389575e-01 s
29954.9s 671 Corrected dt: 2.118484e-01 s
29954.9s 672 Correction factor: 1.6x
29954.9s 673 Max wave speed detected: 23.60 m/s
29955.2s 674 Stored output at t = 1800.0000 s (Step 8492)
29955.2s 675 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
29955.2s 676 [A
29955.2s 677 
29955.2s 678 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.24s/s]
29955.2s 679 Simulation finished at t = 1800.0000 s after 8492 steps.
29955.2s 680 Total runtime: 0.62 seconds.
29955.2s 681 [REWARD_MICROSCOPE] step=13800 t=1800.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29955.2s 682 [STEP  120] t= 1800.0s | phase=1 | reward=   0.01 | total_reward=    1.21
29955.2s 683 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29955.2s 684 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29955.2s 685 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29955.2s 686 Running simulation until t = 1815.00 s, outputting every 15.00 s
29955.2s 687 
29955.3s 688 [PROGRESS] Step 8500: t=1801.70/1815.00s (99.3%) | dt=0.2119s
29955.7s 689 [PROGRESS] Step 8550: t=1812.29/1815.00s (99.9%) | dt=0.2120s
29955.7s 690 [WARNING] Automatic CFL correction applied (count: 3295800):
29955.7s 691 Calculated CFL: 0.800 > Limit: 0.500
29955.7s 692 Original dt: 3.391853e-01 s
29955.7s 693 Corrected dt: 2.119908e-01 s
29955.7s 694 Correction factor: 1.6x
29955.7s 695 Max wave speed detected: 23.59 m/s
29955.8s 696 Stored output at t = 1815.0000 s (Step 8563)
29955.8s 697 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
29955.8s 698 [A
29955.8s 699 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.56s/s]
29955.8s 700 
29955.8s 701 Simulation finished at t = 1815.0000 s after 8563 steps.
29955.8s 702 Total runtime: 0.61 seconds.
29955.8s 703 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
29955.8s 704 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29955.8s 705 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2406565e-05 1.0000000e+00 2.0517371e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29955.8s 706 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29955.8s 707 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29955.8s 708 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29955.8s 709 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8721970e-05 1.7252729e-05 1.6842898e-05 1.6725062e-05 1.6695152e-05
29955.8s 710 1.6692624e-05]
29955.8s 711 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0776057e-05 2.6366857e-05 2.4803081e-05 2.4185061e-05 2.3916147e-05
29955.8s 712 2.3791756e-05]
29955.8s 713 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29955.8s 714 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29955.8s 715 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29955.8s 716 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29955.8s 717 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29955.8s 718 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29955.8s 719 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29955.8s 720 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29955.8s 721 [REWARD_MICROSCOPE] step=13801 t=1815.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29955.8s 722 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29955.8s 723 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29955.8s 724 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29955.8s 725 Running simulation until t = 1830.00 s, outputting every 15.00 s
29955.8s 726 
29956.1s 727 [PROGRESS] Step 8600: t=1822.85/1830.00s (99.6%) | dt=0.2121s
29956.4s 728 Stored output at t = 1830.0000 s (Step 8634)
29956.4s 729 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
29956.4s 730 [A
29956.4s 731 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.51s/s]
29956.4s 732 
29956.4s 733 Simulation finished at t = 1830.0000 s after 8634 steps.
29956.4s 734 Total runtime: 0.61 seconds.
29956.4s 735 [REWARD_MICROSCOPE] step=13802 t=1830.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29956.4s 736 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29956.4s 737 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29956.4s 738 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29956.4s 739 Running simulation until t = 1845.00 s, outputting every 15.00 s
29956.4s 740 
29956.6s 741 [PROGRESS] Step 8650: t=1833.41/1845.00s (99.4%) | dt=0.2130s
29956.6s 742 [PERIODIC:1000] BC_DISPATCHER [Call #13184000] current_bc_params: <class 'dict'>
29956.6s 743 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29956.6s 744 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29956.6s 745 [PERIODIC:1000] BC_GPU [Call #13184000] About to launch kernel
29956.6s 746 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29956.6s 747 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29956.6s 748 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29956.6s 749 [WARNING] Automatic CFL correction applied (count: 3295900):
29956.6s 750 Calculated CFL: 0.800 > Limit: 0.500
29956.6s 751 Original dt: 3.408242e-01 s
29956.6s 752 Corrected dt: 2.130152e-01 s
29956.6s 753 Correction factor: 1.6x
29956.6s 754 Max wave speed detected: 23.47 m/s
29957.0s 755 [PROGRESS] Step 8700: t=1844.06/1845.00s (99.9%) | dt=0.2127s
29957.0s 756 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
29957.0s 757 [A
29957.0s 758 Stored output at t = 1845.0000 s (Step 8705)
29957.0s 759 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.17s/s]
29957.0s 760 
29957.0s 761 Simulation finished at t = 1845.0000 s after 8705 steps.
29957.0s 762 Total runtime: 0.62 seconds.
29957.0s 763 [REWARD_MICROSCOPE] step=13803 t=1845.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29957.0s 764 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29957.0s 765 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29957.0s 766 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29957.0s 767 Running simulation until t = 1860.00 s, outputting every 15.00 s
29957.0s 768 
29957.5s 769 [PROGRESS] Step 8750: t=1854.56/1860.00s (99.7%) | dt=0.2126s
29957.5s 770 [WARNING] Automatic CFL correction applied (count: 3296000):
29957.5s 771 Calculated CFL: 0.800 > Limit: 0.500
29957.5s 772 Original dt: 3.402591e-01 s
29957.5s 773 Corrected dt: 2.126619e-01 s
29957.5s 774 Correction factor: 1.6x
29957.5s 775 Max wave speed detected: 23.51 m/s
29957.7s 776 Stored output at t = 1860.0000 s (Step 8776)
29957.7s 777 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A
29957.7s 778 [A
29957.7s 779 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 22.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 22.90s/s]
29957.7s 780 
29957.7s 781 Simulation finished at t = 1860.0000 s after 8776 steps.
29957.7s 782 Total runtime: 0.66 seconds.
29957.7s 783 [REWARD_MICROSCOPE] step=13804 t=1860.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29957.7s 784 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29957.7s 785 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29957.7s 786 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29957.7s 787 Running simulation until t = 1875.00 s, outputting every 15.00 s
29957.7s 788 
29957.9s 789 [PROGRESS] Step 8800: t=1865.11/1875.00s (99.5%) | dt=0.2130s
29958.4s 790 Stored output at t = 1875.0000 s (Step 8847)
29958.4s 791 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1860.0/1875.0 [00:00<?, ?s/s][A
29958.4s 792 [A
29958.4s 793 
29958.4s 794 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 22.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 22.86s/s]
29958.4s 795 Simulation finished at t = 1875.0000 s after 8847 steps.
29958.4s 796 Total runtime: 0.66 seconds.
29958.4s 797 [REWARD_MICROSCOPE] step=13805 t=1875.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29958.4s 798 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29958.4s 799 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29958.4s 800 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29958.4s 801 Running simulation until t = 1890.00 s, outputting every 15.00 s
29958.4s 802 
29958.4s 803 [PROGRESS] Step 8850: t=1875.64/1890.00s (99.2%) | dt=0.2125s
29958.4s 804 [WARNING] Automatic CFL correction applied (count: 3296100):
29958.4s 805 Calculated CFL: 0.800 > Limit: 0.500
29958.4s 806 Original dt: 3.397413e-01 s
29958.4s 807 Corrected dt: 2.123383e-01 s
29958.4s 808 Correction factor: 1.6x
29958.4s 809 Max wave speed detected: 23.55 m/s
29958.8s 810 [PROGRESS] Step 8900: t=1886.26/1890.00s (99.8%) | dt=0.2127s
29958.8s 811 [PERIODIC:1000] BC_DISPATCHER [Call #13185000] current_bc_params: <class 'dict'>
29958.8s 812 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29958.8s 813 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29958.8s 814 [PERIODIC:1000] BC_GPU [Call #13185000] About to launch kernel
29958.8s 815 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29958.8s 816 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29958.8s 817 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29959.0s 818 Stored output at t = 1890.0000 s (Step 8918)
29959.0s 819 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1875.0/1890.0 [00:00<?, ?s/s][A
29959.0s 820 [A
29959.0s 821 
29959.0s 822 Simulation finished at t = 1890.0000 s after 8918 steps.
29959.0s 823 Total runtime: 0.63 seconds.
29959.0s 824 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 23.93s/s]
29959.0s 825 [REWARD_MICROSCOPE] step=13806 t=1890.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29959.0s 826 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29959.0s 827 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29959.0s 828 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29959.0s 829 Running simulation until t = 1905.00 s, outputting every 15.00 s
29959.0s 830 
29959.3s 831 [PROGRESS] Step 8950: t=1896.82/1905.00s (99.6%) | dt=0.2131s
29959.3s 832 [WARNING] Automatic CFL correction applied (count: 3296200):
29959.3s 833 Calculated CFL: 0.800 > Limit: 0.500
29959.3s 834 Original dt: 3.410527e-01 s
29959.3s 835 Corrected dt: 2.131579e-01 s
29959.3s 836 Correction factor: 1.6x
29959.3s 837 Max wave speed detected: 23.46 m/s
29959.6s 838 Stored output at t = 1905.0000 s (Step 8989)
29959.6s 839 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1890.0/1905.0 [00:00<?, ?s/s][A
29959.6s 840 [A
29959.6s 841 
29959.6s 842 Simulation finished at t = 1905.0000 s after 8989 steps.
29959.6s 843 Total runtime: 0.63 seconds.
29959.6s 844 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 23.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 23.91s/s]
29959.6s 845 [REWARD_MICROSCOPE] step=13807 t=1905.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29959.6s 846 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29959.6s 847 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29959.6s 848 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29959.6s 849 Running simulation until t = 1920.00 s, outputting every 15.00 s
29959.6s 850 
29959.7s 851 [PROGRESS] Step 9000: t=1907.34/1920.00s (99.3%) | dt=0.2123s
29960.1s 852 [PROGRESS] Step 9050: t=1917.96/1920.00s (99.9%) | dt=0.2127s
29960.2s 853 [WARNING] Automatic CFL correction applied (count: 3296300):
29960.2s 854 Calculated CFL: 0.800 > Limit: 0.500
29960.2s 855 Original dt: 3.404818e-01 s
29960.2s 856 Corrected dt: 2.128011e-01 s
29960.2s 857 Correction factor: 1.6x
29960.2s 858 Max wave speed detected: 23.50 m/s
29960.2s 859 Stored output at t = 1920.0000 s (Step 9060)
29960.2s 860 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1905.0/1920.0 [00:00<?, ?s/s][A
29960.2s 861 [A
29960.2s 862 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.40s/s]
29960.2s 863 
29960.2s 864 Simulation finished at t = 1920.0000 s after 9060 steps.
29960.2s 865 Total runtime: 0.62 seconds.
29960.2s 866 [REWARD_MICROSCOPE] step=13808 t=1920.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29960.2s 867 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29960.2s 868 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29960.2s 869 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29960.2s 870 Running simulation until t = 1935.00 s, outputting every 15.00 s
29960.2s 871 
29960.6s 872 [PROGRESS] Step 9100: t=1928.52/1935.00s (99.7%) | dt=0.2132s
29960.9s 873 Stored output at t = 1935.0000 s (Step 9131)
29960.9s 874 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1920.0/1935.0 [00:00<?, ?s/s][A
29960.9s 875 [A
29960.9s 876 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 22.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 22.99s/s]
29960.9s 877 
29960.9s 878 Simulation finished at t = 1935.0000 s after 9131 steps.
29960.9s 879 Total runtime: 0.65 seconds.
29960.9s 880 [REWARD_MICROSCOPE] step=13809 t=1935.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29960.9s 881 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29960.9s 882 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29960.9s 883 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29960.9s 884 Running simulation until t = 1950.00 s, outputting every 15.00 s
29960.9s 885 
29961.1s 886 [PROGRESS] Step 9150: t=1939.04/1950.00s (99.4%) | dt=0.2124s
29961.1s 887 [PERIODIC:1000] BC_DISPATCHER [Call #13186000] current_bc_params: <class 'dict'>
29961.1s 888 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29961.1s 889 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29961.1s 890 [PERIODIC:1000] BC_GPU [Call #13186000] About to launch kernel
29961.1s 891 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29961.1s 892 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29961.1s 893 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29961.1s 894 [WARNING] Automatic CFL correction applied (count: 3296400):
29961.1s 895 Calculated CFL: 0.800 > Limit: 0.500
29961.1s 896 Original dt: 3.398890e-01 s
29961.1s 897 Corrected dt: 2.124306e-01 s
29961.1s 898 Correction factor: 1.6x
29961.1s 899 Max wave speed detected: 23.54 m/s
29961.5s 900 [PROGRESS] Step 9200: t=1949.67/1950.00s (100.0%) | dt=0.2128s
29961.5s 901 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1935.0/1950.0 [00:00<?, ?s/s][A
29961.5s 902 Stored output at t = 1950.0000 s (Step 9202)
29961.5s 903 [A
29961.5s 904 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.59s/s]
29961.5s 905 
29961.5s 906 Simulation finished at t = 1950.0000 s after 9202 steps.
29961.5s 907 Total runtime: 0.64 seconds.
29961.5s 908 [REWARD_MICROSCOPE] step=13810 t=1950.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29961.5s 909 [STEP  130] t= 1950.0s | phase=1 | reward=   0.01 | total_reward=    1.31
29961.5s 910 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29961.5s 911 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29961.5s 912 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29961.5s 913 Running simulation until t = 1965.00 s, outputting every 15.00 s
29961.5s 914 
29962.0s 915 [PROGRESS] Step 9250: t=1960.23/1965.00s (99.8%) | dt=0.2132s
29962.0s 916 [WARNING] Automatic CFL correction applied (count: 3296500):
29962.0s 917 Calculated CFL: 0.800 > Limit: 0.500
29962.0s 918 Original dt: 3.412697e-01 s
29962.0s 919 Corrected dt: 2.132935e-01 s
29962.0s 920 Correction factor: 1.6x
29962.0s 921 Max wave speed detected: 23.44 m/s
29962.2s 922 Stored output at t = 1965.0000 s (Step 9273)
29962.2s 923 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1950.0/1965.0 [00:00<?, ?s/s][A
29962.2s 924 [A
29962.2s 925 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.11s/s]
29962.2s 926 
29962.2s 927 Simulation finished at t = 1965.0000 s after 9273 steps.
29962.2s 928 Total runtime: 0.62 seconds.
29962.2s 929 [QUEUE_DIAGNOSTIC] ===== Step 130 t=1965.0s =====
29962.2s 930 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29962.2s 931 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29962.2s 932 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29962.2s 933 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29962.2s 934 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29962.2s 935 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29962.2s 936 1.6692446e-05]
29962.2s 937 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29962.2s 938 2.3782164e-05]
29962.2s 939 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29962.2s 940 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29962.2s 941 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29962.2s 942 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29962.2s 943 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29962.2s 944 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29962.2s 945 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29962.2s 946 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29962.2s 947 [REWARD_MICROSCOPE] step=13811 t=1965.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29962.2s 948 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29962.2s 949 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29962.2s 950 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29962.2s 951 Running simulation until t = 1980.00 s, outputting every 15.00 s
29962.2s 952 
29962.4s 953 [PROGRESS] Step 9300: t=1970.73/1980.00s (99.5%) | dt=0.2124s
29962.8s 954 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1965.0/1980.0 [00:00<?, ?s/s][A
29962.8s 955 [A
29962.8s 956 Stored output at t = 1980.0000 s (Step 9344)
29962.8s 957 
29962.8s 958 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 23.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 23.41s/s]
29962.8s 959 Simulation finished at t = 1980.0000 s after 9344 steps.
29962.8s 960 Total runtime: 0.64 seconds.
29962.8s 961 [REWARD_MICROSCOPE] step=13812 t=1980.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29962.8s 962 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29962.8s 963 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29962.8s 964 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29962.8s 965 Running simulation until t = 1995.00 s, outputting every 15.00 s
29962.8s 966 
29962.9s 967 [PROGRESS] Step 9350: t=1981.28/1995.00s (99.3%) | dt=0.2129s
29962.9s 968 [WARNING] Automatic CFL correction applied (count: 3296600):
29962.9s 969 Calculated CFL: 0.800 > Limit: 0.500
29962.9s 970 Original dt: 3.406934e-01 s
29962.9s 971 Corrected dt: 2.129334e-01 s
29962.9s 972 Correction factor: 1.6x
29962.9s 973 Max wave speed detected: 23.48 m/s
29963.3s 974 [PROGRESS] Step 9400: t=1991.93/1995.00s (99.8%) | dt=0.2132s
29963.3s 975 [PERIODIC:1000] BC_DISPATCHER [Call #13187000] current_bc_params: <class 'dict'>
29963.3s 976 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29963.3s 977 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29963.3s 978 [PERIODIC:1000] BC_GPU [Call #13187000] About to launch kernel
29963.3s 979 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29963.3s 980 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29963.3s 981 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29963.4s 982 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1980.0/1995.0 [00:00<?, ?s/s][A
29963.4s 983 [A
29963.4s 984 Stored output at t = 1995.0000 s (Step 9415)
29963.4s 985 
29963.4s 986 Simulation finished at t = 1995.0000 s after 9415 steps.
29963.4s 987 Total runtime: 0.62 seconds.
29963.4s 988 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.38s/s]
29963.4s 989 [REWARD_MICROSCOPE] step=13813 t=1995.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29963.4s 990 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29963.4s 991 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29963.4s 992 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29963.4s 993 Running simulation until t = 2010.00 s, outputting every 15.00 s
29963.4s 994 
29963.7s 995 [PROGRESS] Step 9450: t=2002.43/2010.00s (99.6%) | dt=0.2125s
29963.8s 996 [WARNING] Automatic CFL correction applied (count: 3296700):
29963.8s 997 Calculated CFL: 0.800 > Limit: 0.500
29963.8s 998 Original dt: 3.401199e-01 s
29963.8s 999 Corrected dt: 2.125749e-01 s
29963.8s 1000 Correction factor: 1.6x
29963.8s 1001 Max wave speed detected: 23.52 m/s
29964.1s 1002 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1995.0/2010.0 [00:00<?, ?s/s][A
29964.1s 1003 [A
29964.1s 1004 Stored output at t = 2010.0000 s (Step 9486)
29964.1s 1005 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 23.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 23.26s/s]
29964.1s 1006 
29964.1s 1007 Simulation finished at t = 2010.0000 s after 9486 steps.
29964.1s 1008 Total runtime: 0.65 seconds.
29964.1s 1009 [REWARD_MICROSCOPE] step=13814 t=2010.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29964.1s 1010 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29964.1s 1011 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29964.1s 1012 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29964.1s 1013 Running simulation until t = 2025.00 s, outputting every 15.00 s
29964.1s 1014 
29964.2s 1015 [PROGRESS] Step 9500: t=2012.98/2025.00s (99.4%) | dt=0.2130s
29964.6s 1016 [PROGRESS] Step 9550: t=2023.64/2025.00s (99.9%) | dt=0.2128s
29964.7s 1017 [WARNING] Automatic CFL correction applied (count: 3296800):
29964.7s 1018 Calculated CFL: 0.800 > Limit: 0.500
29964.7s 1019 Original dt: 3.401129e-01 s
29964.7s 1020 Corrected dt: 2.125705e-01 s
29964.7s 1021 Correction factor: 1.6x
29964.7s 1022 Max wave speed detected: 23.52 m/s
29964.7s 1023 Stored output at t = 2025.0000 s (Step 9557)
29964.7s 1024 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2010.0/2025.0 [00:00<?, ?s/s][A
29964.7s 1025 [A
29964.7s 1026 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.24s/s]
29964.7s 1027 
29964.7s 1028 Simulation finished at t = 2025.0000 s after 9557 steps.
29964.7s 1029 Total runtime: 0.62 seconds.
29964.7s 1030 [REWARD_MICROSCOPE] step=13815 t=2025.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29964.7s 1031 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29964.7s 1032 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29964.7s 1033 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29964.7s 1034 Running simulation until t = 2040.00 s, outputting every 15.00 s
29964.7s 1035 
29965.1s 1036 [PROGRESS] Step 9600: t=2034.13/2040.00s (99.7%) | dt=0.2126s
29965.3s 1037 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2025.0/2040.0 [00:00<?, ?s/s][A
29965.3s 1038 [A
29965.3s 1039 Stored output at t = 2040.0000 s (Step 9628)
29965.3s 1040 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 23.78s/s]
29965.3s 1041 
29965.3s 1042 Simulation finished at t = 2040.0000 s after 9628 steps.
29965.3s 1043 Total runtime: 0.63 seconds.
29965.3s 1044 [REWARD_MICROSCOPE] step=13816 t=2040.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29965.3s 1045 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29965.3s 1046 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29965.3s 1047 
29965.3s 1048 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29965.3s 1049 Running simulation until t = 2055.00 s, outputting every 15.00 s
29965.5s 1050 [PROGRESS] Step 9650: t=2044.68/2055.00s (99.5%) | dt=0.2130s
29965.5s 1051 [PERIODIC:1000] BC_DISPATCHER [Call #13188000] current_bc_params: <class 'dict'>
29965.5s 1052 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29965.5s 1053 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29965.5s 1054 [PERIODIC:1000] BC_GPU [Call #13188000] About to launch kernel
29965.5s 1055 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29965.5s 1056 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29965.5s 1057 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29965.6s 1058 [WARNING] Automatic CFL correction applied (count: 3296900):
29965.6s 1059 Calculated CFL: 0.800 > Limit: 0.500
29965.6s 1060 Original dt: 3.409178e-01 s
29965.6s 1061 Corrected dt: 2.130736e-01 s
29965.6s 1062 Correction factor: 1.6x
29965.6s 1063 Max wave speed detected: 23.47 m/s
29966.0s 1064 Stored output at t = 2055.0000 s (Step 9699)
29966.0s 1065 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2040.0/2055.0 [00:00<?, ?s/s][A
29966.0s 1066 [A
29966.0s 1067 
29966.0s 1068 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 23.96s/s]
29966.0s 1069 Simulation finished at t = 2055.0000 s after 9699 steps.
29966.0s 1070 Total runtime: 0.63 seconds.
29966.0s 1071 [REWARD_MICROSCOPE] step=13817 t=2055.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29966.0s 1072 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29966.0s 1073 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29966.0s 1074 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29966.0s 1075 Running simulation until t = 2070.00 s, outputting every 15.00 s
29966.0s 1076 
29966.0s 1077 [PROGRESS] Step 9700: t=2055.21/2070.00s (99.3%) | dt=0.2125s
29966.4s 1078 [PROGRESS] Step 9750: t=2065.84/2070.00s (99.8%) | dt=0.2127s
29966.4s 1079 [WARNING] Automatic CFL correction applied (count: 3297000):
29966.4s 1080 Calculated CFL: 0.800 > Limit: 0.500
29966.4s 1081 Original dt: 3.403431e-01 s
29966.4s 1082 Corrected dt: 2.127144e-01 s
29966.4s 1083 Correction factor: 1.6x
29966.4s 1084 Max wave speed detected: 23.51 m/s
29966.6s 1085 Stored output at t = 2070.0000 s (Step 9770)
29966.6s 1086 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2055.0/2070.0 [00:00<?, ?s/s][A
29966.6s 1087 [A
29966.6s 1088 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.37s/s]
29966.6s 1089 
29966.6s 1090 Simulation finished at t = 2070.0000 s after 9770 steps.
29966.6s 1091 Total runtime: 0.62 seconds.
29966.6s 1092 [REWARD_MICROSCOPE] step=13818 t=2070.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29966.6s 1093 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29966.6s 1094 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29966.6s 1095 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29966.6s 1096 Running simulation until t = 2085.00 s, outputting every 15.00 s
29966.6s 1097 
29966.8s 1098 [PROGRESS] Step 9800: t=2076.39/2085.00s (99.6%) | dt=0.2131s
29967.2s 1099 Stored output at t = 2085.0000 s (Step 9841)
29967.2s 1100 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2070.0/2085.0 [00:00<?, ?s/s][A
29967.2s 1101 [A
29967.2s 1102 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 23.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 23.60s/s]
29967.2s 1103 
29967.2s 1104 Simulation finished at t = 2085.0000 s after 9841 steps.
29967.2s 1105 Total runtime: 0.64 seconds.
29967.2s 1106 [REWARD_MICROSCOPE] step=13819 t=2085.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29967.2s 1107 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29967.2s 1108 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29967.2s 1109 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29967.2s 1110 Running simulation until t = 2100.00 s, outputting every 15.00 s
29967.2s 1111 
29967.3s 1112 [PROGRESS] Step 9850: t=2086.91/2100.00s (99.4%) | dt=0.2123s
29967.3s 1113 [WARNING] Automatic CFL correction applied (count: 3297100):
29967.3s 1114 Calculated CFL: 0.800 > Limit: 0.500
29967.3s 1115 Original dt: 3.397401e-01 s
29967.3s 1116 Corrected dt: 2.123376e-01 s
29967.3s 1117 Correction factor: 1.6x
29967.3s 1118 Max wave speed detected: 23.55 m/s
29967.7s 1119 [PROGRESS] Step 9900: t=2097.54/2100.00s (99.9%) | dt=0.2127s
29967.7s 1120 [PERIODIC:1000] BC_DISPATCHER [Call #13189000] current_bc_params: <class 'dict'>
29967.7s 1121 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29967.7s 1122 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29967.7s 1123 [PERIODIC:1000] BC_GPU [Call #13189000] About to launch kernel
29967.7s 1124 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29967.7s 1125 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29967.7s 1126 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29967.8s 1127 Stored output at t = 2100.0000 s (Step 9912)
29967.8s 1128 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2085.0/2100.0 [00:00<?, ?s/s][A
29967.8s 1129 [A
29967.8s 1130 
29967.8s 1131 Simulation finished at t = 2100.0000 s after 9912 steps.
29967.8s 1132 Total runtime: 0.63 seconds.
29967.8s 1133 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.01s/s]
29967.8s 1134 [REWARD_MICROSCOPE] step=13820 t=2100.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29967.8s 1135 [STEP  140] t= 2100.0s | phase=1 | reward=   0.01 | total_reward=    1.41
29967.8s 1136 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29967.8s 1137 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29967.8s 1138 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29967.8s 1139 Running simulation until t = 2115.00 s, outputting every 15.00 s
29967.8s 1140 
29968.2s 1141 [PROGRESS] Step 9950: t=2108.09/2115.00s (99.7%) | dt=0.2132s
29968.2s 1142 [WARNING] Automatic CFL correction applied (count: 3297200):
29968.2s 1143 Calculated CFL: 0.800 > Limit: 0.500
29968.2s 1144 Original dt: 3.411334e-01 s
29968.2s 1145 Corrected dt: 2.132084e-01 s
29968.2s 1146 Correction factor: 1.6x
29968.2s 1147 Max wave speed detected: 23.45 m/s
29968.5s 1148 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2100.0/2115.0 [00:00<?, ?s/s][A
29968.5s 1149 [A
29968.5s 1150 Stored output at t = 2115.0000 s (Step 9983)
29968.5s 1151 
29968.5s 1152 Simulation finished at t = 2115.0000 s after 9983 steps.
29968.5s 1153 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.42s/s]
29968.5s 1154 Total runtime: 0.61 seconds.
29968.5s 1155 [QUEUE_DIAGNOSTIC] ===== Step 140 t=2115.0s =====
29968.5s 1156 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29968.5s 1157 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29968.5s 1158 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29968.5s 1159 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29968.5s 1160 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29968.5s 1161 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29968.5s 1162 1.6692446e-05]
29968.5s 1163 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29968.5s 1164 2.3782164e-05]
29968.5s 1165 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29968.5s 1166 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29968.5s 1167 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29968.5s 1168 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29968.5s 1169 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29968.5s 1170 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29968.5s 1171 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29968.5s 1172 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29968.5s 1173 [REWARD_MICROSCOPE] step=13821 t=2115.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29968.5s 1174 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29968.5s 1175 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29968.5s 1176 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29968.5s 1177 Running simulation until t = 2130.00 s, outputting every 15.00 s
29968.5s 1178 
29968.6s 1179 [PROGRESS] Step 10000: t=2118.61/2130.00s (99.5%) | dt=0.2124s
29969.1s 1180 [PROGRESS] Step 10050: t=2129.24/2130.00s (100.0%) | dt=0.2128s
29969.1s 1181 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2115.0/2130.0 [00:00<?, ?s/s][A
29969.1s 1182 [A
29969.1s 1183 Stored output at t = 2130.0000 s (Step 10054)
29969.1s 1184 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 22.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 22.03s/s]
29969.1s 1185 
29969.1s 1186 Simulation finished at t = 2130.0000 s after 10054 steps.
29969.1s 1187 Total runtime: 0.68 seconds.
29969.1s 1188 [REWARD_MICROSCOPE] step=13822 t=2130.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29969.2s 1189 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29969.2s 1190 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29969.2s 1191 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29969.2s 1192 Running simulation until t = 2145.00 s, outputting every 15.00 s
29969.2s 1193 
29969.2s 1194 [WARNING] Automatic CFL correction applied (count: 3297300):
29969.2s 1195 Calculated CFL: 0.800 > Limit: 0.500
29969.2s 1196 Original dt: 3.405553e-01 s
29969.2s 1197 Corrected dt: 2.128470e-01 s
29969.2s 1198 Correction factor: 1.6x
29969.2s 1199 Max wave speed detected: 23.49 m/s
29969.6s 1200 [PROGRESS] Step 10100: t=2139.80/2145.00s (99.8%) | dt=0.2132s
29969.8s 1201 Stored output at t = 2145.0000 s (Step 10125)
29969.8s 1202 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2130.0/2145.0 [00:00<?, ?s/s][A
29969.8s 1203 [A
29969.8s 1204 
29969.8s 1205 Simulation finished at t = 2145.0000 s after 10125 steps.
29969.8s 1206 Total runtime: 0.63 seconds.
29969.8s 1207 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.88s/s]
29969.8s 1208 [REWARD_MICROSCOPE] step=13823 t=2145.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29969.8s 1209 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29969.8s 1210 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29969.8s 1211 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29969.8s 1212 Running simulation until t = 2160.00 s, outputting every 15.00 s
29969.8s 1213 
29970.0s 1214 [PROGRESS] Step 10150: t=2150.31/2160.00s (99.6%) | dt=0.2124s
29970.0s 1215 [PERIODIC:1000] BC_DISPATCHER [Call #13190000] current_bc_params: <class 'dict'>
29970.0s 1216 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29970.0s 1217 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29970.0s 1218 [PERIODIC:1000] BC_GPU [Call #13190000] About to launch kernel
29970.0s 1219 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29970.0s 1220 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29970.0s 1221 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29970.0s 1222 [WARNING] Automatic CFL correction applied (count: 3297400):
29970.0s 1223 Calculated CFL: 0.800 > Limit: 0.500
29970.0s 1224 Original dt: 3.399790e-01 s
29970.0s 1225 Corrected dt: 2.124869e-01 s
29970.0s 1226 Correction factor: 1.6x
29970.0s 1227 Max wave speed detected: 23.53 m/s
29970.4s 1228 Stored output at t = 2160.0000 s (Step 10196)
29970.4s 1229 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2145.0/2160.0 [00:00<?, ?s/s][A
29970.4s 1230 [A
29970.4s 1231 
29970.4s 1232 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.34s/s]
29970.4s 1233 Simulation finished at t = 2160.0000 s after 10196 steps.
29970.4s 1234 Total runtime: 0.62 seconds.
29970.4s 1235 [REWARD_MICROSCOPE] step=13824 t=2160.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29970.4s 1236 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29970.4s 1237 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29970.4s 1238 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29970.4s 1239 Running simulation until t = 2175.00 s, outputting every 15.00 s
29970.4s 1240 
29970.4s 1241 [PROGRESS] Step 10200: t=2160.85/2175.00s (99.3%) | dt=0.2129s
29970.9s 1242 [PROGRESS] Step 10250: t=2171.51/2175.00s (99.8%) | dt=0.2133s
29970.9s 1243 [WARNING] Automatic CFL correction applied (count: 3297500):
29970.9s 1244 Calculated CFL: 0.800 > Limit: 0.500
29970.9s 1245 Original dt: 3.407550e-01 s
29970.9s 1246 Corrected dt: 2.129719e-01 s
29970.9s 1247 Correction factor: 1.6x
29970.9s 1248 Max wave speed detected: 23.48 m/s
29971.0s 1249 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2160.0/2175.0 [00:00<?, ?s/s][A
29971.0s 1250 [A
29971.0s 1251 Stored output at t = 2175.0000 s (Step 10267)
29971.0s 1252 
29971.0s 1253 Simulation finished at t = 2175.0000 s after 10267 steps.
29971.0s 1254 Total runtime: 0.64 seconds.
29971.0s 1255 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.43s/s]
29971.0s 1256 [REWARD_MICROSCOPE] step=13825 t=2175.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29971.0s 1257 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29971.0s 1258 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29971.0s 1259 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29971.0s 1260 Running simulation until t = 2190.00 s, outputting every 15.00 s
29971.0s 1261 
29971.3s 1262 [PROGRESS] Step 10300: t=2182.01/2190.00s (99.6%) | dt=0.2125s
29971.7s 1263 Stored output at t = 2190.0000 s (Step 10338)
29971.7s 1264 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2175.0/2190.0 [00:00<?, ?s/s][A
29971.7s 1265 [A
29971.7s 1266 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.18s/s]
29971.7s 1267 
29971.7s 1268 Simulation finished at t = 2190.0000 s after 10338 steps.
29971.7s 1269 Total runtime: 0.62 seconds.
29971.7s 1270 [REWARD_MICROSCOPE] step=13826 t=2190.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29971.7s 1271 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29971.7s 1272 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29971.7s 1273 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29971.7s 1274 Running simulation until t = 2205.00 s, outputting every 15.00 s
29971.7s 1275 
29971.8s 1276 [PROGRESS] Step 10350: t=2192.55/2205.00s (99.4%) | dt=0.2129s
29971.8s 1277 [WARNING] Automatic CFL correction applied (count: 3297600):
29971.8s 1278 Calculated CFL: 0.800 > Limit: 0.500
29971.8s 1279 Original dt: 3.407770e-01 s
29971.8s 1280 Corrected dt: 2.129856e-01 s
29971.8s 1281 Correction factor: 1.6x
29971.8s 1282 Max wave speed detected: 23.48 m/s
29972.2s 1283 [PROGRESS] Step 10400: t=2203.21/2205.00s (99.9%) | dt=0.2134s
29972.2s 1284 [PERIODIC:1000] BC_DISPATCHER [Call #13191000] current_bc_params: <class 'dict'>
29972.2s 1285 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29972.2s 1286 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29972.2s 1287 [PERIODIC:1000] BC_GPU [Call #13191000] About to launch kernel
29972.2s 1288 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29972.2s 1289 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29972.2s 1290 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29972.3s 1291 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2190.0/2205.0 [00:00<?, ?s/s][A
29972.3s 1292 [A
29972.3s 1293 Stored output at t = 2205.0000 s (Step 10409)
29972.3s 1294 
29972.3s 1295 Simulation finished at t = 2205.0000 s after 10409 steps.
29972.3s 1296 Total runtime: 0.61 seconds.
29972.3s 1297 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.48s/s]
29972.3s 1298 [REWARD_MICROSCOPE] step=13827 t=2205.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29972.3s 1299 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29972.3s 1300 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29972.3s 1301 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29972.3s 1302 Running simulation until t = 2220.00 s, outputting every 15.00 s
29972.3s 1303 
29972.6s 1304 [PROGRESS] Step 10450: t=2213.76/2220.00s (99.7%) | dt=0.2138s
29972.7s 1305 [WARNING] Automatic CFL correction applied (count: 3297700):
29972.7s 1306 Calculated CFL: 0.800 > Limit: 0.500
29972.7s 1307 Original dt: 3.420901e-01 s
29972.7s 1308 Corrected dt: 2.138063e-01 s
29972.7s 1309 Correction factor: 1.6x
29972.7s 1310 Max wave speed detected: 23.39 m/s
29972.9s 1311 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2205.0/2220.0 [00:00<?, ?s/s][A
29972.9s 1312 [A
29972.9s 1313 Stored output at t = 2220.0000 s (Step 10480)
29972.9s 1314 
29972.9s 1315 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.04s/s]
29972.9s 1316 Simulation finished at t = 2220.0000 s after 10480 steps.
29972.9s 1317 Total runtime: 0.62 seconds.
29972.9s 1318 [REWARD_MICROSCOPE] step=13828 t=2220.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29972.9s 1319 
29972.9s 1320 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29972.9s 1321 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29972.9s 1322 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29972.9s 1323 Running simulation until t = 2235.00 s, outputting every 15.00 s
29973.1s 1324 [PROGRESS] Step 10500: t=2224.25/2235.00s (99.5%) | dt=0.2124s
29973.5s 1325 [PROGRESS] Step 10550: t=2234.88/2235.00s (100.0%) | dt=0.2129s
29973.5s 1326 Stored output at t = 2235.0000 s (Step 10551)
29973.5s 1327 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2220.0/2235.0 [00:00<?, ?s/s][A
29973.5s 1328 [A
29973.5s 1329 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.47s/s]
29973.5s 1330 
29973.5s 1331 Simulation finished at t = 2235.0000 s after 10551 steps.
29973.5s 1332 Total runtime: 0.61 seconds.
29973.5s 1333 [REWARD_MICROSCOPE] step=13829 t=2235.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29973.5s 1334 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29973.5s 1335 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29973.5s 1336 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29973.5s 1337 Running simulation until t = 2250.00 s, outputting every 15.00 s
29973.5s 1338 
29973.6s 1339 [WARNING] Automatic CFL correction applied (count: 3297800):
29973.6s 1340 Calculated CFL: 0.800 > Limit: 0.500
29973.6s 1341 Original dt: 3.406759e-01 s
29973.6s 1342 Corrected dt: 2.129224e-01 s
29973.6s 1343 Correction factor: 1.6x
29973.6s 1344 Max wave speed detected: 23.48 m/s
29974.0s 1345 [PROGRESS] Step 10600: t=2245.44/2250.00s (99.8%) | dt=0.2133s
29974.1s 1346 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2235.0/2250.0 [00:00<?, ?s/s][A
29974.1s 1347 [A
29974.1s 1348 Stored output at t = 2250.0000 s (Step 10622)
29974.1s 1349 
29974.1s 1350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.51s/s]
29974.1s 1351 Simulation finished at t = 2250.0000 s after 10622 steps.
29974.1s 1352 Total runtime: 0.61 seconds.
29974.1s 1353 [REWARD_MICROSCOPE] step=13830 t=2250.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29974.1s 1354 [STEP  150] t= 2250.0s | phase=0 | reward=   0.01 | total_reward=    1.52
29974.1s 1355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29974.1s 1356 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29974.1s 1357 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29974.1s 1358 Running simulation until t = 2265.00 s, outputting every 15.00 s
29974.1s 1359 
29974.4s 1360 [PROGRESS] Step 10650: t=2255.95/2265.00s (99.6%) | dt=0.2125s
29974.4s 1361 [PERIODIC:1000] BC_DISPATCHER [Call #13192000] current_bc_params: <class 'dict'>
29974.4s 1362 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29974.4s 1363 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29974.4s 1364 [PERIODIC:1000] BC_GPU [Call #13192000] About to launch kernel
29974.4s 1365 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29974.4s 1366 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29974.4s 1367 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29974.4s 1368 [WARNING] Automatic CFL correction applied (count: 3297900):
29974.4s 1369 Calculated CFL: 0.800 > Limit: 0.500
29974.4s 1370 Original dt: 3.400174e-01 s
29974.4s 1371 Corrected dt: 2.125109e-01 s
29974.4s 1372 Correction factor: 1.6x
29974.4s 1373 Max wave speed detected: 23.53 m/s
29974.8s 1374 Stored output at t = 2265.0000 s (Step 10693)
29974.8s 1375 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2250.0/2265.0 [00:00<?, ?s/s][A
29974.8s 1376 [A
29974.8s 1377 
29974.8s 1378 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.41s/s]
29974.8s 1379 Simulation finished at t = 2265.0000 s after 10693 steps.
29974.8s 1380 Total runtime: 0.62 seconds.
29974.8s 1381 [QUEUE_DIAGNOSTIC] ===== Step 150 t=2265.0s =====
29974.8s 1382 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29974.8s 1383 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926911 1.        ] (rho_m, v_m, rho_c, v_c)
29974.8s 1384 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29974.8s 1385 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29974.8s 1386 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29974.8s 1387 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438326 0.0043694  0.00436217]
29974.8s 1388 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546897 0.00523327 0.00509964 0.00502801 0.0049912 ]
29974.8s 1389 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29974.8s 1390 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29974.8s 1391 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29974.8s 1392 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29974.8s 1393 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29974.8s 1394 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29974.8s 1395 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29974.8s 1396 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29974.8s 1397 [REWARD_MICROSCOPE] step=13831 t=2265.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29974.8s 1398 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29974.8s 1399 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29974.8s 1400 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29974.8s 1401 Running simulation until t = 2280.00 s, outputting every 15.00 s
29974.8s 1402 
29974.8s 1403 [PROGRESS] Step 10700: t=2266.49/2280.00s (99.4%) | dt=0.2129s
29975.3s 1404 [PROGRESS] Step 10750: t=2277.15/2280.00s (99.9%) | dt=0.2131s
29975.3s 1405 [WARNING] Automatic CFL correction applied (count: 3298000):
29975.3s 1406 Calculated CFL: 0.800 > Limit: 0.500
29975.3s 1407 Original dt: 3.405306e-01 s
29975.3s 1408 Corrected dt: 2.128316e-01 s
29975.3s 1409 Correction factor: 1.6x
29975.3s 1410 Max wave speed detected: 23.49 m/s
29975.4s 1411 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2265.0/2280.0 [00:00<?, ?s/s][A
29975.4s 1412 [A
29975.4s 1413 Stored output at t = 2280.0000 s (Step 10764)
29975.4s 1414 
29975.4s 1415 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.51s/s]
29975.4s 1416 Simulation finished at t = 2280.0000 s after 10764 steps.
29975.4s 1417 Total runtime: 0.61 seconds.
29975.4s 1418 [REWARD_MICROSCOPE] step=13832 t=2280.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29975.4s 1419 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29975.4s 1420 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29975.4s 1421 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29975.4s 1422 Running simulation until t = 2295.00 s, outputting every 15.00 s
29975.4s 1423 
29975.7s 1424 [PROGRESS] Step 10800: t=2287.65/2295.00s (99.7%) | dt=0.2125s
29976.0s 1425 Stored output at t = 2295.0000 s (Step 10835)
29976.0s 1426 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2280.0/2295.0 [00:00<?, ?s/s][A
29976.0s 1427 [A
29976.0s 1428 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.46s/s]
29976.0s 1429 
29976.0s 1430 Simulation finished at t = 2295.0000 s after 10835 steps.
29976.0s 1431 Total runtime: 0.61 seconds.
29976.0s 1432 [REWARD_MICROSCOPE] step=13833 t=2295.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29976.0s 1433 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29976.0s 1434 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29976.0s 1435 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29976.0s 1436 Running simulation until t = 2310.00 s, outputting every 15.00 s
29976.0s 1437 
29976.1s 1438 [PROGRESS] Step 10850: t=2298.19/2310.00s (99.5%) | dt=0.2130s
29976.2s 1439 [WARNING] Automatic CFL correction applied (count: 3298100):
29976.2s 1440 Calculated CFL: 0.800 > Limit: 0.500
29976.2s 1441 Original dt: 3.408188e-01 s
29976.2s 1442 Corrected dt: 2.130118e-01 s
29976.2s 1443 Correction factor: 1.6x
29976.2s 1444 Max wave speed detected: 23.47 m/s
29976.6s 1445 [PROGRESS] Step 10900: t=2308.85/2310.00s (100.0%) | dt=0.2127s
29976.6s 1446 [PERIODIC:1000] BC_DISPATCHER [Call #13193000] current_bc_params: <class 'dict'>
29976.6s 1447 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29976.6s 1448 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29976.6s 1449 [PERIODIC:1000] BC_GPU [Call #13193000] About to launch kernel
29976.6s 1450 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29976.6s 1451 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29976.6s 1452 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29976.6s 1453 Stored output at t = 2310.0000 s (Step 10906)
29976.6s 1454 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295.0/2310.0 [00:00<?, ?s/s][A
29976.6s 1455 [A
29976.6s 1456 
29976.6s 1457 Simulation finished at t = 2310.0000 s after 10906 steps.
29976.6s 1458 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.03s/s]
29976.6s 1459 Total runtime: 0.62 seconds.
29976.6s 1460 [REWARD_MICROSCOPE] step=13834 t=2310.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29976.6s 1461 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29976.6s 1462 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29976.6s 1463 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29976.6s 1464 Running simulation until t = 2325.00 s, outputting every 15.00 s
29976.6s 1465 
29977.0s 1466 [PROGRESS] Step 10950: t=2319.35/2325.00s (99.8%) | dt=0.2126s
29977.1s 1467 [WARNING] Automatic CFL correction applied (count: 3298200):
29977.1s 1468 Calculated CFL: 0.800 > Limit: 0.500
29977.1s 1469 Original dt: 3.402420e-01 s
29977.1s 1470 Corrected dt: 2.126513e-01 s
29977.1s 1471 Correction factor: 1.6x
29977.1s 1472 Max wave speed detected: 23.51 m/s
29977.3s 1473 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310.0/2325.0 [00:00<?, ?s/s][A
29977.3s 1474 [A
29977.3s 1475 Stored output at t = 2325.0000 s (Step 10977)
29977.3s 1476 
29977.3s 1477 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.96s/s]
29977.3s 1478 Simulation finished at t = 2325.0000 s after 10977 steps.
29977.3s 1479 Total runtime: 0.63 seconds.
29977.3s 1480 [REWARD_MICROSCOPE] step=13835 t=2325.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29977.3s 1481 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29977.3s 1482 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29977.3s 1483 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29977.3s 1484 Running simulation until t = 2340.00 s, outputting every 15.00 s
29977.3s 1485 
29977.5s 1486 [PROGRESS] Step 11000: t=2329.90/2340.00s (99.6%) | dt=0.2130s
29977.9s 1487 Stored output at t = 2340.0000 s (Step 11048)
29977.9s 1488 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2325.0/2340.0 [00:00<?, ?s/s][A
29977.9s 1489 [A
29977.9s 1490 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.56s/s]
29977.9s 1491 
29977.9s 1492 Simulation finished at t = 2340.0000 s after 11048 steps.
29977.9s 1493 Total runtime: 0.61 seconds.
29977.9s 1494 [REWARD_MICROSCOPE] step=13836 t=2340.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29977.9s 1495 
29977.9s 1496 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29977.9s 1497 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29977.9s 1498 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29977.9s 1499 Running simulation until t = 2355.00 s, outputting every 15.00 s
29977.9s 1500 [PROGRESS] Step 11050: t=2340.43/2355.00s (99.4%) | dt=0.2125s
29977.9s 1501 [WARNING] Automatic CFL correction applied (count: 3298300):
29977.9s 1502 Calculated CFL: 0.800 > Limit: 0.500
29977.9s 1503 Original dt: 3.397694e-01 s
29977.9s 1504 Corrected dt: 2.123559e-01 s
29977.9s 1505 Correction factor: 1.6x
29977.9s 1506 Max wave speed detected: 23.55 m/s
29978.3s 1507 [PROGRESS] Step 11100: t=2351.05/2355.00s (99.8%) | dt=0.2127s
29978.5s 1508 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2340.0/2355.0 [00:00<?, ?s/s][A
29978.5s 1509 [A
29978.5s 1510 Stored output at t = 2355.0000 s (Step 11119)
29978.5s 1511 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.35s/s]
29978.5s 1512 
29978.5s 1513 Simulation finished at t = 2355.0000 s after 11119 steps.
29978.5s 1514 Total runtime: 0.62 seconds.
29978.5s 1515 [REWARD_MICROSCOPE] step=13837 t=2355.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29978.5s 1516 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29978.5s 1517 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29978.5s 1518 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29978.5s 1519 Running simulation until t = 2370.00 s, outputting every 15.00 s
29978.5s 1520 
29978.8s 1521 [PROGRESS] Step 11150: t=2361.60/2370.00s (99.6%) | dt=0.2131s
29978.8s 1522 [PERIODIC:1000] BC_DISPATCHER [Call #13194000] current_bc_params: <class 'dict'>
29978.8s 1523 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29978.8s 1524 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29978.8s 1525 [PERIODIC:1000] BC_GPU [Call #13194000] About to launch kernel
29978.8s 1526 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29978.8s 1527 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29978.8s 1528 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29978.8s 1529 [WARNING] Automatic CFL correction applied (count: 3298400):
29978.8s 1530 Calculated CFL: 0.800 > Limit: 0.500
29978.8s 1531 Original dt: 3.410383e-01 s
29978.8s 1532 Corrected dt: 2.131490e-01 s
29978.8s 1533 Correction factor: 1.6x
29978.8s 1534 Max wave speed detected: 23.46 m/s
29979.1s 1535 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2355.0/2370.0 [00:00<?, ?s/s][A
29979.1s 1536 [A
29979.1s 1537 Stored output at t = 2370.0000 s (Step 11190)
29979.1s 1538 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.63s/s]
29979.1s 1539 
29979.1s 1540 Simulation finished at t = 2370.0000 s after 11190 steps.
29979.1s 1541 Total runtime: 0.64 seconds.
29979.1s 1542 [REWARD_MICROSCOPE] step=13838 t=2370.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29979.1s 1543 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29979.1s 1544 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29979.1s 1545 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29979.1s 1546 Running simulation until t = 2385.00 s, outputting every 15.00 s
29979.1s 1547 
29979.2s 1548 [PROGRESS] Step 11200: t=2372.13/2385.00s (99.5%) | dt=0.2135s
29979.7s 1549 [PROGRESS] Step 11250: t=2382.82/2385.00s (99.9%) | dt=0.2139s
29979.7s 1550 [WARNING] Automatic CFL correction applied (count: 3298500):
29979.7s 1551 Calculated CFL: 0.800 > Limit: 0.500
29979.7s 1552 Original dt: 3.423646e-01 s
29979.7s 1553 Corrected dt: 2.139779e-01 s
29979.7s 1554 Correction factor: 1.6x
29979.7s 1555 Max wave speed detected: 23.37 m/s
29979.8s 1556 Stored output at t = 2385.0000 s (Step 11261)
29979.8s 1557 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2370.0/2385.0 [00:00<?, ?s/s][A
29979.8s 1558 [A
29979.8s 1559 
29979.8s 1560 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.10s/s]
29979.8s 1561 Simulation finished at t = 2385.0000 s after 11261 steps.
29979.8s 1562 Total runtime: 0.62 seconds.
29979.8s 1563 [REWARD_MICROSCOPE] step=13839 t=2385.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29979.8s 1564 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29979.8s 1565 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29979.8s 1566 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29979.8s 1567 Running simulation until t = 2400.00 s, outputting every 15.00 s
29979.8s 1568 
29980.1s 1569 [PROGRESS] Step 11300: t=2393.39/2400.00s (99.7%) | dt=0.2165s
29980.4s 1570 Stored output at t = 2400.0000 s (Step 11331)
29980.4s 1571 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2385.0/2400.0 [00:00<?, ?s/s][A
29980.4s 1572 [A
29980.4s 1573 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.65s/s]
29980.4s 1574 
29980.4s 1575 Simulation finished at t = 2400.0000 s after 11331 steps.
29980.4s 1576 Total runtime: 0.61 seconds.
29980.4s 1577 [REWARD_MICROSCOPE] step=13840 t=2400.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
29980.4s 1578 [STEP  160] t= 2400.0s | phase=1 | reward=   0.02 | total_reward=    1.65
29980.4s 1579 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29980.4s 1580 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29980.4s 1581 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29980.4s 1582 Running simulation until t = 2415.00 s, outputting every 15.00 s
29980.4s 1583 
29980.5s 1584 [PROGRESS] Step 11350: t=2404.15/2415.00s (99.6%) | dt=0.2180s
29980.6s 1585 [WARNING] Automatic CFL correction applied (count: 3298600):
29980.6s 1586 Calculated CFL: 0.800 > Limit: 0.500
29980.6s 1587 Original dt: 3.468196e-01 s
29980.6s 1588 Corrected dt: 2.167623e-01 s
29980.6s 1589 Correction factor: 1.6x
29980.6s 1590 Max wave speed detected: 23.07 m/s
29981.0s 1591 [PROGRESS] Step 11400: t=2414.87/2415.00s (100.0%) | dt=0.2126s
29981.0s 1592 [PERIODIC:1000] BC_DISPATCHER [Call #13195000] current_bc_params: <class 'dict'>
29981.0s 1593 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29981.0s 1594 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29981.0s 1595 [PERIODIC:1000] BC_GPU [Call #13195000] About to launch kernel
29981.0s 1596 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29981.0s 1597 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29981.0s 1598 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29981.0s 1599 Stored output at t = 2415.0000 s (Step 11401)
29981.0s 1600 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2400.0/2415.0 [00:00<?, ?s/s][A
29981.0s 1601 [A
29981.0s 1602 
29981.0s 1603 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 22.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 22.93s/s]
29981.0s 1604 Simulation finished at t = 2415.0000 s after 11401 steps.
29981.0s 1605 Total runtime: 0.65 seconds.
29981.0s 1606 [QUEUE_DIAGNOSTIC] ===== Step 160 t=2415.0s =====
29981.0s 1607 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29981.0s 1608 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.240048e-05 1.000000e+00 2.045273e-04 1.000000e+00] (rho_m, v_m, rho_c, v_c)
29981.0s 1609 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29981.0s 1610 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29981.0s 1611 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29981.0s 1612 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8720146e-05 1.7249720e-05 1.6839613e-05 1.6722703e-05 1.6693837e-05
29981.0s 1613 1.6692353e-05]
29981.0s 1614 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0679097e-05 2.6242651e-05 2.4674262e-05 2.4076349e-05 2.3841023e-05
29981.0s 1615 2.3750295e-05]
29981.0s 1616 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29981.0s 1617 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29981.0s 1618 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29981.0s 1619 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29981.0s 1620 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29981.0s 1621 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29981.0s 1622 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29981.0s 1623 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29981.0s 1624 [REWARD_MICROSCOPE] step=13841 t=2415.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29981.0s 1625 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29981.0s 1626 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29981.0s 1627 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29981.0s 1628 Running simulation until t = 2430.00 s, outputting every 15.00 s
29981.0s 1629 
29981.5s 1630 [PROGRESS] Step 11450: t=2425.41/2430.00s (99.8%) | dt=0.2127s
29981.5s 1631 [WARNING] Automatic CFL correction applied (count: 3298700):
29981.5s 1632 Calculated CFL: 0.800 > Limit: 0.500
29981.5s 1633 Original dt: 3.403809e-01 s
29981.5s 1634 Corrected dt: 2.127380e-01 s
29981.5s 1635 Correction factor: 1.6x
29981.5s 1636 Max wave speed detected: 23.50 m/s
29981.7s 1637 Stored output at t = 2430.0000 s (Step 11472)
29981.7s 1638 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2415.0/2430.0 [00:00<?, ?s/s][A
29981.7s 1639 [A
29981.7s 1640 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 23.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 23.71s/s]
29981.7s 1641 
29981.7s 1642 Simulation finished at t = 2430.0000 s after 11472 steps.
29981.7s 1643 Total runtime: 0.63 seconds.
29981.7s 1644 [REWARD_MICROSCOPE] step=13842 t=2430.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29981.7s 1645 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29981.7s 1646 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29981.7s 1647 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29981.7s 1648 Running simulation until t = 2445.00 s, outputting every 15.00 s
29981.7s 1649 
29981.9s 1650 [PROGRESS] Step 11500: t=2435.96/2445.00s (99.6%) | dt=0.2131s
29982.3s 1651 Stored output at t = 2445.0000 s (Step 11543)
29982.3s 1652 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2430.0/2445.0 [00:00<?, ?s/s][A
29982.3s 1653 [A
29982.3s 1654 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 24.21s/s]
29982.3s 1655 
29982.3s 1656 Simulation finished at t = 2445.0000 s after 11543 steps.
29982.3s 1657 Total runtime: 0.62 seconds.
29982.3s 1658 [REWARD_MICROSCOPE] step=13843 t=2445.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29982.3s 1659 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29982.3s 1660 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29982.3s 1661 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29982.3s 1662 Running simulation until t = 2460.00 s, outputting every 15.00 s
29982.3s 1663 
29982.4s 1664 [PROGRESS] Step 11550: t=2446.49/2460.00s (99.5%) | dt=0.2124s
29982.4s 1665 [WARNING] Automatic CFL correction applied (count: 3298800):
29982.4s 1666 Calculated CFL: 0.800 > Limit: 0.500
29982.4s 1667 Original dt: 3.397189e-01 s
29982.4s 1668 Corrected dt: 2.123243e-01 s
29982.4s 1669 Correction factor: 1.6x
29982.4s 1670 Max wave speed detected: 23.55 m/s
29982.8s 1671 [PROGRESS] Step 11600: t=2457.11/2460.00s (99.9%) | dt=0.2127s
29982.9s 1672 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2445.0/2460.0 [00:00<?, ?s/s][A
29982.9s 1673 [A
29982.9s 1674 Stored output at t = 2460.0000 s (Step 11614)
29982.9s 1675 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 24.20s/s]
29982.9s 1676 
29982.9s 1677 Simulation finished at t = 2460.0000 s after 11614 steps.
29982.9s 1678 Total runtime: 0.62 seconds.
29982.9s 1679 [REWARD_MICROSCOPE] step=13844 t=2460.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29982.9s 1680 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29982.9s 1681 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29982.9s 1682 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29982.9s 1683 Running simulation until t = 2475.00 s, outputting every 15.00 s
29982.9s 1684 
29983.2s 1685 [PROGRESS] Step 11650: t=2467.67/2475.00s (99.7%) | dt=0.2131s
29983.2s 1686 [PERIODIC:1000] BC_DISPATCHER [Call #13196000] current_bc_params: <class 'dict'>
29983.2s 1687 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29983.2s 1688 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29983.2s 1689 [PERIODIC:1000] BC_GPU [Call #13196000] About to launch kernel
29983.2s 1690 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29983.2s 1691 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29983.2s 1692 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29983.3s 1693 [WARNING] Automatic CFL correction applied (count: 3298900):
29983.3s 1694 Calculated CFL: 0.800 > Limit: 0.500
29983.3s 1695 Original dt: 3.411089e-01 s
29983.3s 1696 Corrected dt: 2.131930e-01 s
29983.3s 1697 Correction factor: 1.6x
29983.3s 1698 Max wave speed detected: 23.45 m/s
29983.5s 1699 Stored output at t = 2475.0000 s (Step 11685)
29983.5s 1700 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2460.0/2475.0 [00:00<?, ?s/s][A
29983.5s 1701 [A
29983.5s 1702 
29983.5s 1703 Simulation finished at t = 2475.0000 s after 11685 steps.
29983.5s 1704 Total runtime: 0.62 seconds.
29983.5s 1705 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 24.17s/s]
29983.5s 1706 [REWARD_MICROSCOPE] step=13845 t=2475.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29983.5s 1707 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29983.5s 1708 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29983.5s 1709 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29983.5s 1710 Running simulation until t = 2490.00 s, outputting every 15.00 s
29983.5s 1711 
29983.7s 1712 [PROGRESS] Step 11700: t=2478.19/2490.00s (99.5%) | dt=0.2123s
29984.1s 1713 [PROGRESS] Step 11750: t=2488.81/2490.00s (100.0%) | dt=0.2128s
29984.1s 1714 [WARNING] Automatic CFL correction applied (count: 3299000):
29984.1s 1715 Calculated CFL: 0.800 > Limit: 0.500
29984.1s 1716 Original dt: 3.405362e-01 s
29984.1s 1717 Corrected dt: 2.128351e-01 s
29984.1s 1718 Correction factor: 1.6x
29984.1s 1719 Max wave speed detected: 23.49 m/s
29984.2s 1720 Stored output at t = 2490.0000 s (Step 11756)
29984.2s 1721 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2475.0/2490.0 [00:00<?, ?s/s][A
29984.2s 1722 [A
29984.2s 1723 
29984.2s 1724 Simulation finished at t = 2490.0000 s after 11756 steps.
29984.2s 1725 Total runtime: 0.61 seconds.
29984.2s 1726 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 24.42s/s]
29984.2s 1727 [REWARD_MICROSCOPE] step=13846 t=2490.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29984.2s 1728 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29984.2s 1729 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29984.2s 1730 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29984.2s 1731 Running simulation until t = 2505.00 s, outputting every 15.00 s
29984.2s 1732 
29984.5s 1733 [PROGRESS] Step 11800: t=2499.37/2505.00s (99.8%) | dt=0.2132s
29984.8s 1734 Stored output at t = 2505.0000 s (Step 11827)
29984.8s 1735 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2490.0/2505.0 [00:00<?, ?s/s][A
29984.8s 1736 [A
29984.8s 1737 
29984.8s 1738 Simulation finished at t = 2505.0000 s after 11827 steps.
29984.8s 1739 Total runtime: 0.64 seconds.
29984.8s 1740 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 23.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 23.41s/s]
29984.8s 1741 [REWARD_MICROSCOPE] step=13847 t=2505.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29984.8s 1742 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29984.8s 1743 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29984.8s 1744 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29984.8s 1745 Running simulation until t = 2520.00 s, outputting every 15.00 s
29984.8s 1746 
29985.0s 1747 [PROGRESS] Step 11850: t=2509.88/2520.00s (99.6%) | dt=0.2124s
29985.0s 1748 [WARNING] Automatic CFL correction applied (count: 3299100):
29985.0s 1749 Calculated CFL: 0.800 > Limit: 0.500
29985.0s 1750 Original dt: 3.399493e-01 s
29985.0s 1751 Corrected dt: 2.124683e-01 s
29985.0s 1752 Correction factor: 1.6x
29985.0s 1753 Max wave speed detected: 23.53 m/s
29985.4s 1754 Stored output at t = 2520.0000 s (Step 11898)
29985.4s 1755 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2505.0/2520.0 [00:00<?, ?s/s][A
29985.4s 1756 [A
29985.4s 1757 
29985.4s 1758 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.03s/s]
29985.4s 1759 Simulation finished at t = 2520.0000 s after 11898 steps.
29985.4s 1760 Total runtime: 0.62 seconds.
29985.4s 1761 [REWARD_MICROSCOPE] step=13848 t=2520.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29985.4s 1762 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29985.4s 1763 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29985.4s 1764 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29985.4s 1765 Running simulation until t = 2535.00 s, outputting every 15.00 s
29985.4s 1766 
29985.4s 1767 [PROGRESS] Step 11900: t=2520.43/2535.00s (99.4%) | dt=0.2128s
29985.5s 1768 [PERIODIC:1000] BC_DISPATCHER [Call #13197000] current_bc_params: <class 'dict'>
29985.5s 1769 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29985.5s 1770 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29985.5s 1771 [PERIODIC:1000] BC_GPU [Call #13197000] About to launch kernel
29985.5s 1772 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29985.5s 1773 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29985.5s 1774 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29985.9s 1775 [PROGRESS] Step 11950: t=2531.08/2535.00s (99.8%) | dt=0.2133s
29985.9s 1776 [WARNING] Automatic CFL correction applied (count: 3299200):
29985.9s 1777 Calculated CFL: 0.800 > Limit: 0.500
29985.9s 1778 Original dt: 3.409227e-01 s
29985.9s 1779 Corrected dt: 2.130767e-01 s
29985.9s 1780 Correction factor: 1.6x
29985.9s 1781 Max wave speed detected: 23.47 m/s
29986.0s 1782 Stored output at t = 2535.0000 s (Step 11969)
29986.0s 1783 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2520.0/2535.0 [00:00<?, ?s/s][A
29986.0s 1784 [A
29986.0s 1785 
29986.0s 1786 Simulation finished at t = 2535.0000 s after 11969 steps.
29986.0s 1787 Total runtime: 0.62 seconds.
29986.0s 1788 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 24.21s/s]
29986.1s 1789 [REWARD_MICROSCOPE] step=13849 t=2535.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29986.1s 1790 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29986.1s 1791 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29986.1s 1792 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29986.1s 1793 Running simulation until t = 2550.00 s, outputting every 15.00 s
29986.1s 1794 
29986.3s 1795 [PROGRESS] Step 12000: t=2541.58/2550.00s (99.7%) | dt=0.2125s
29986.7s 1796 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2535.0/2550.0 [00:00<?, ?s/s][A
29986.7s 1797 [A
29986.7s 1798 Stored output at t = 2550.0000 s (Step 12040)
29986.7s 1799 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.17s/s]
29986.7s 1800 
29986.7s 1801 Simulation finished at t = 2550.0000 s after 12040 steps.
29986.7s 1802 Total runtime: 0.62 seconds.
29986.7s 1803 [REWARD_MICROSCOPE] step=13850 t=2550.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29986.7s 1804 [STEP  170] t= 2550.0s | phase=1 | reward=   0.01 | total_reward=    1.75
29986.7s 1805 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29986.7s 1806 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29986.7s 1807 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29986.7s 1808 Running simulation until t = 2565.00 s, outputting every 15.00 s
29986.7s 1809 
29986.8s 1810 [PROGRESS] Step 12050: t=2552.13/2565.00s (99.5%) | dt=0.2129s
29986.8s 1811 [WARNING] Automatic CFL correction applied (count: 3299300):
29986.8s 1812 Calculated CFL: 0.800 > Limit: 0.500
29986.8s 1813 Original dt: 3.407491e-01 s
29986.8s 1814 Corrected dt: 2.129682e-01 s
29986.8s 1815 Correction factor: 1.6x
29986.8s 1816 Max wave speed detected: 23.48 m/s
29987.2s 1817 [PROGRESS] Step 12100: t=2562.78/2565.00s (99.9%) | dt=0.2130s
29987.3s 1818 Stored output at t = 2565.0000 s (Step 12111)
29987.3s 1819 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2550.0/2565.0 [00:00<?, ?s/s][A
29987.3s 1820 [A
29987.3s 1821 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 24.15s/s]
29987.3s 1822 
29987.3s 1823 Simulation finished at t = 2565.0000 s after 12111 steps.
29987.3s 1824 Total runtime: 0.62 seconds.
29987.3s 1825 [QUEUE_DIAGNOSTIC] ===== Step 170 t=2565.0s =====
29987.3s 1826 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29987.3s 1827 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29987.3s 1828 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29987.3s 1829 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29987.3s 1830 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29987.3s 1831 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29987.3s 1832 1.6692446e-05]
29987.3s 1833 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29987.3s 1834 2.3782164e-05]
29987.3s 1835 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29987.3s 1836 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29987.3s 1837 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29987.3s 1838 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29987.3s 1839 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29987.3s 1840 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29987.3s 1841 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29987.3s 1842 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29987.3s 1843 [REWARD_MICROSCOPE] step=13851 t=2565.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29987.3s 1844 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29987.3s 1845 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29987.3s 1846 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29987.3s 1847 Running simulation until t = 2580.00 s, outputting every 15.00 s
29987.3s 1848 
29987.6s 1849 [PROGRESS] Step 12150: t=2573.28/2580.00s (99.7%) | dt=0.2126s
29987.7s 1850 [PERIODIC:1000] BC_DISPATCHER [Call #13198000] current_bc_params: <class 'dict'>
29987.7s 1851 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29987.7s 1852 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29987.7s 1853 [PERIODIC:1000] BC_GPU [Call #13198000] About to launch kernel
29987.7s 1854 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29987.7s 1855 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29987.7s 1856 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29987.7s 1857 [WARNING] Automatic CFL correction applied (count: 3299400):
29987.7s 1858 Calculated CFL: 0.800 > Limit: 0.500
29987.7s 1859 Original dt: 3.401756e-01 s
29987.7s 1860 Corrected dt: 2.126097e-01 s
29987.7s 1861 Correction factor: 1.6x
29987.7s 1862 Max wave speed detected: 23.52 m/s
29987.9s 1863 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2565.0/2580.0 [00:00<?, ?s/s][A
29987.9s 1864 [A
29987.9s 1865 Stored output at t = 2580.0000 s (Step 12182)
29987.9s 1866 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.21s/s]
29987.9s 1867 
29987.9s 1868 Simulation finished at t = 2580.0000 s after 12182 steps.
29987.9s 1869 Total runtime: 0.62 seconds.
29987.9s 1870 [REWARD_MICROSCOPE] step=13852 t=2580.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29987.9s 1871 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29987.9s 1872 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29987.9s 1873 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29987.9s 1874 Running simulation until t = 2595.00 s, outputting every 15.00 s
29987.9s 1875 
29988.1s 1876 [PROGRESS] Step 12200: t=2583.83/2595.00s (99.6%) | dt=0.2130s
29988.5s 1877 [PROGRESS] Step 12250: t=2594.49/2595.00s (100.0%) | dt=0.2126s
29988.5s 1878 Stored output at t = 2595.0000 s (Step 12253)
29988.5s 1879 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2580.0/2595.0 [00:00<?, ?s/s][A
29988.5s 1880 [A
29988.5s 1881 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.44s/s]
29988.5s 1882 
29988.5s 1883 Simulation finished at t = 2595.0000 s after 12253 steps.
29988.5s 1884 Total runtime: 0.61 seconds.
29988.5s 1885 [REWARD_MICROSCOPE] step=13853 t=2595.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29988.5s 1886 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29988.5s 1887 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29988.5s 1888 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29988.5s 1889 Running simulation until t = 2610.00 s, outputting every 15.00 s
29988.5s 1890 
29988.6s 1891 [WARNING] Automatic CFL correction applied (count: 3299500):
29988.6s 1892 Calculated CFL: 0.800 > Limit: 0.500
29988.6s 1893 Original dt: 3.399530e-01 s
29988.6s 1894 Corrected dt: 2.124706e-01 s
29988.6s 1895 Correction factor: 1.6x
29988.6s 1896 Max wave speed detected: 23.53 m/s
29989.0s 1897 [PROGRESS] Step 12300: t=2604.99/2610.00s (99.8%) | dt=0.2126s
29989.2s 1898 Stored output at t = 2610.0000 s (Step 12324)
29989.2s 1899 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2595.0/2610.0 [00:00<?, ?s/s][A
29989.2s 1900 [A
29989.2s 1901 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 24.31s/s]
29989.2s 1902 
29989.2s 1903 Simulation finished at t = 2610.0000 s after 12324 steps.
29989.2s 1904 Total runtime: 0.62 seconds.
29989.2s 1905 [REWARD_MICROSCOPE] step=13854 t=2610.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29989.2s 1906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29989.2s 1907 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29989.2s 1908 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29989.2s 1909 Running simulation until t = 2625.00 s, outputting every 15.00 s
29989.2s 1910 
29989.4s 1911 [PROGRESS] Step 12350: t=2615.54/2625.00s (99.6%) | dt=0.2131s
29989.4s 1912 [WARNING] Automatic CFL correction applied (count: 3299600):
29989.4s 1913 Calculated CFL: 0.800 > Limit: 0.500
29989.4s 1914 Original dt: 3.409728e-01 s
29989.4s 1915 Corrected dt: 2.131080e-01 s
29989.4s 1916 Correction factor: 1.6x
29989.4s 1917 Max wave speed detected: 23.46 m/s
29989.8s 1918 Stored output at t = 2625.0000 s (Step 12395)
29989.8s 1919 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2610.0/2625.0 [00:00<?, ?s/s][A
29989.8s 1920 [A
29989.8s 1921 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 23.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 23.32s/s]
29989.8s 1922 
29989.8s 1923 Simulation finished at t = 2625.0000 s after 12395 steps.
29989.8s 1924 Total runtime: 0.64 seconds.
29989.8s 1925 [REWARD_MICROSCOPE] step=13855 t=2625.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29989.8s 1926 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29989.8s 1927 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29989.8s 1928 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29989.8s 1929 Running simulation until t = 2640.00 s, outputting every 15.00 s
29989.8s 1930 
29989.9s 1931 [PROGRESS] Step 12400: t=2626.06/2640.00s (99.5%) | dt=0.2124s
29989.9s 1932 [PERIODIC:1000] BC_DISPATCHER [Call #13199000] current_bc_params: <class 'dict'>
29989.9s 1933 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29989.9s 1934 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29989.9s 1935 [PERIODIC:1000] BC_GPU [Call #13199000] About to launch kernel
29989.9s 1936 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29989.9s 1937 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29989.9s 1938 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29990.3s 1939 [PROGRESS] Step 12450: t=2636.69/2640.00s (99.9%) | dt=0.2127s
29990.3s 1940 [WARNING] Automatic CFL correction applied (count: 3299700):
29990.3s 1941 Calculated CFL: 0.800 > Limit: 0.500
29990.3s 1942 Original dt: 3.403992e-01 s
29990.3s 1943 Corrected dt: 2.127495e-01 s
29990.3s 1944 Correction factor: 1.6x
29990.3s 1945 Max wave speed detected: 23.50 m/s
29990.4s 1946 Stored output at t = 2640.0000 s (Step 12466)
29990.4s 1947 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2625.0/2640.0 [00:00<?, ?s/s][A
29990.4s 1948 [A
29990.4s 1949 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.65s/s]
29990.4s 1950 
29990.4s 1951 Simulation finished at t = 2640.0000 s after 12466 steps.
29990.4s 1952 Total runtime: 0.63 seconds.
29990.4s 1953 [REWARD_MICROSCOPE] step=13856 t=2640.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29990.4s 1954 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29990.4s 1955 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29990.4s 1956 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29990.4s 1957 Running simulation until t = 2655.00 s, outputting every 15.00 s
29990.4s 1958 
29990.8s 1959 [PROGRESS] Step 12500: t=2647.24/2655.00s (99.7%) | dt=0.2131s
29991.1s 1960 Stored output at t = 2655.0000 s (Step 12537)
29991.1s 1961 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2640.0/2655.0 [00:00<?, ?s/s][A
29991.1s 1962 [A
29991.1s 1963 
29991.1s 1964 Simulation finished at t = 2655.0000 s after 12537 steps.
29991.1s 1965 Total runtime: 0.65 seconds.
29991.1s 1966 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.24s/s]
29991.1s 1967 [REWARD_MICROSCOPE] step=13857 t=2655.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29991.1s 1968 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29991.1s 1969 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29991.1s 1970 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29991.1s 1971 Running simulation until t = 2670.00 s, outputting every 15.00 s
29991.1s 1972 
29991.2s 1973 [PROGRESS] Step 12550: t=2657.76/2670.00s (99.5%) | dt=0.2123s
29991.3s 1974 [WARNING] Automatic CFL correction applied (count: 3299800):
29991.3s 1975 Calculated CFL: 0.800 > Limit: 0.500
29991.3s 1976 Original dt: 3.397973e-01 s
29991.3s 1977 Corrected dt: 2.123733e-01 s
29991.3s 1978 Correction factor: 1.6x
29991.3s 1979 Max wave speed detected: 23.54 m/s
29991.7s 1980 [PROGRESS] Step 12600: t=2668.39/2670.00s (99.9%) | dt=0.2128s
29991.7s 1981 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2655.0/2670.0 [00:00<?, ?s/s][A
29991.7s 1982 [A
29991.7s 1983 Stored output at t = 2670.0000 s (Step 12608)
29991.7s 1984 
29991.7s 1985 Simulation finished at t = 2670.0000 s after 12608 steps.
29991.7s 1986 Total runtime: 0.64 seconds.
29991.7s 1987 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 23.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 23.58s/s]
29991.7s 1988 [REWARD_MICROSCOPE] step=13858 t=2670.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29991.7s 1989 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29991.7s 1990 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29991.7s 1991 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29991.7s 1992 Running simulation until t = 2685.00 s, outputting every 15.00 s
29991.7s 1993 
29992.1s 1994 [PROGRESS] Step 12650: t=2678.95/2685.00s (99.8%) | dt=0.2132s
29992.1s 1995 [PERIODIC:1000] BC_DISPATCHER [Call #13200000] current_bc_params: <class 'dict'>
29992.1s 1996 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29992.1s 1997 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29992.1s 1998 [PERIODIC:1000] BC_GPU [Call #13200000] About to launch kernel
29992.1s 1999 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29992.1s 2000 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29992.1s 2001 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29992.2s 2002 [WARNING] Automatic CFL correction applied (count: 3299900):
29992.2s 2003 Calculated CFL: 0.800 > Limit: 0.500
29992.2s 2004 Original dt: 3.411876e-01 s
29992.2s 2005 Corrected dt: 2.132423e-01 s
29992.2s 2006 Correction factor: 1.6x
29992.2s 2007 Max wave speed detected: 23.45 m/s
29992.4s 2008 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2670.0/2685.0 [00:00<?, ?s/s][A
29992.4s 2009 [A
29992.4s 2010 Stored output at t = 2685.0000 s (Step 12679)
29992.4s 2011 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.29s/s]
29992.4s 2012 
29992.4s 2013 Simulation finished at t = 2685.0000 s after 12679 steps.
29992.4s 2014 Total runtime: 0.62 seconds.
29992.4s 2015 [REWARD_MICROSCOPE] step=13859 t=2685.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29992.4s 2016 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29992.4s 2017 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29992.4s 2018 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29992.4s 2019 Running simulation until t = 2700.00 s, outputting every 15.00 s
29992.4s 2020 
29992.5s 2021 [PROGRESS] Step 12700: t=2689.46/2700.00s (99.6%) | dt=0.2124s
29993.0s 2022 [PROGRESS] Step 12750: t=2700.00/2700.00s (100.0%) | dt=0.1218s
29993.0s 2023 Stored output at t = 2700.0000 s (Step 12750)
29993.0s 2024 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2685.0/2700.0 [00:00<?, ?s/s][A
29993.0s 2025 [A
29993.0s 2026 
29993.0s 2027 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.39s/s]
29993.0s 2028 Simulation finished at t = 2700.0000 s after 12750 steps.
29993.0s 2029 Total runtime: 0.62 seconds.
29993.0s 2030 [REWARD_MICROSCOPE] step=13860 t=2700.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29993.0s 2031 [STEP  180] t= 2700.0s | phase=1 | reward=   0.01 | total_reward=    1.85
29993.0s 2032 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29993.0s 2033 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29993.0s 2034 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29993.0s 2035 Running simulation until t = 2715.00 s, outputting every 15.00 s
29993.0s 2036 
29993.0s 2037 [WARNING] Automatic CFL correction applied (count: 3300000):
29993.0s 2038 Calculated CFL: 0.800 > Limit: 0.500
29993.0s 2039 Original dt: 3.406104e-01 s
29993.0s 2040 Corrected dt: 2.128815e-01 s
29993.0s 2041 Correction factor: 1.6x
29993.0s 2042 Max wave speed detected: 23.49 m/s
29993.4s 2043 [PROGRESS] Step 12800: t=2710.65/2715.00s (99.8%) | dt=0.2133s
29993.6s 2044 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2700.0/2715.0 [00:00<?, ?s/s][A
29993.6s 2045 [A
29993.6s 2046 Stored output at t = 2715.0000 s (Step 12821)
29993.6s 2047 
29993.6s 2048 Simulation finished at t = 2715.0000 s after 12821 steps.
29993.6s 2049 Total runtime: 0.62 seconds.
29993.6s 2050 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.29s/s]
29993.6s 2051 [QUEUE_DIAGNOSTIC] ===== Step 180 t=2715.0s =====
29993.6s 2052 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29993.6s 2053 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29993.6s 2054 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29993.6s 2055 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29993.6s 2056 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29993.6s 2057 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29993.6s 2058 1.6692446e-05]
29993.6s 2059 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29993.6s 2060 2.3782164e-05]
29993.6s 2061 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29993.6s 2062 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29993.6s 2063 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29993.6s 2064 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29993.6s 2065 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29993.6s 2066 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29993.6s 2067 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29993.6s 2068 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29993.6s 2069 [REWARD_MICROSCOPE] step=13861 t=2715.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29993.6s 2070 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29993.6s 2071 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29993.6s 2072 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29993.6s 2073 Running simulation until t = 2730.00 s, outputting every 15.00 s
29993.6s 2074 
29993.9s 2075 [PROGRESS] Step 12850: t=2721.16/2730.00s (99.7%) | dt=0.2125s
29993.9s 2076 [WARNING] Automatic CFL correction applied (count: 3300100):
29993.9s 2077 Calculated CFL: 0.800 > Limit: 0.500
29993.9s 2078 Original dt: 3.400365e-01 s
29993.9s 2079 Corrected dt: 2.125228e-01 s
29993.9s 2080 Correction factor: 1.6x
29993.9s 2081 Max wave speed detected: 23.53 m/s
29994.2s 2082 Stored output at t = 2730.0000 s (Step 12892)
29994.2s 2083 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2715.0/2730.0 [00:00<?, ?s/s][A
29994.2s 2084 [A
29994.2s 2085 
29994.2s 2086 Simulation finished at t = 2730.0000 s after 12892 steps.
29994.2s 2087 Total runtime: 0.62 seconds.
29994.2s 2088 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 24.04s/s]
29994.2s 2089 [REWARD_MICROSCOPE] step=13862 t=2730.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29994.2s 2090 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29994.2s 2091 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29994.2s 2092 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29994.2s 2093 Running simulation until t = 2745.00 s, outputting every 15.00 s
29994.2s 2094 
29994.3s 2095 [PROGRESS] Step 12900: t=2731.70/2745.00s (99.5%) | dt=0.2129s
29994.3s 2096 [PERIODIC:1000] BC_DISPATCHER [Call #13201000] current_bc_params: <class 'dict'>
29994.3s 2097 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29994.3s 2098 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29994.3s 2099 [PERIODIC:1000] BC_GPU [Call #13201000] About to launch kernel
29994.3s 2100 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
29994.3s 2101 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29994.3s 2102 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29994.7s 2103 [PROGRESS] Step 12950: t=2742.36/2745.00s (99.9%) | dt=0.2131s
29994.8s 2104 [WARNING] Automatic CFL correction applied (count: 3300200):
29994.8s 2105 Calculated CFL: 0.800 > Limit: 0.500
29994.8s 2106 Original dt: 3.404624e-01 s
29994.8s 2107 Corrected dt: 2.127890e-01 s
29994.8s 2108 Correction factor: 1.6x
29994.8s 2109 Max wave speed detected: 23.50 m/s
29994.9s 2110 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2730.0/2745.0 [00:00<?, ?s/s][A
29994.9s 2111 [A
29994.9s 2112 Stored output at t = 2745.0000 s (Step 12963)
29994.9s 2113 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.75s/s]
29994.9s 2114 
29994.9s 2115 Simulation finished at t = 2745.0000 s after 12963 steps.
29994.9s 2116 Total runtime: 0.63 seconds.
29994.9s 2117 [REWARD_MICROSCOPE] step=13863 t=2745.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29994.9s 2118 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29994.9s 2119 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29994.9s 2120 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29994.9s 2121 Running simulation until t = 2760.00 s, outputting every 15.00 s
29994.9s 2122 
29995.2s 2123 [PROGRESS] Step 13000: t=2752.86/2760.00s (99.7%) | dt=0.2125s
29995.5s 2124 Stored output at t = 2760.0000 s (Step 13034)
29995.5s 2125 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2745.0/2760.0 [00:00<?, ?s/s][A
29995.5s 2126 [A
29995.5s 2127 
29995.5s 2128 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.48s/s]
29995.5s 2129 Simulation finished at t = 2760.0000 s after 13034 steps.
29995.5s 2130 Total runtime: 0.61 seconds.
29995.5s 2131 [REWARD_MICROSCOPE] step=13864 t=2760.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29995.5s 2132 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29995.5s 2133 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29995.5s 2134 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29995.5s 2135 Running simulation until t = 2775.00 s, outputting every 15.00 s
29995.5s 2136 
29995.6s 2137 [PROGRESS] Step 13050: t=2763.41/2775.00s (99.6%) | dt=0.2130s
29995.7s 2138 [WARNING] Automatic CFL correction applied (count: 3300300):
29995.7s 2139 Calculated CFL: 0.800 > Limit: 0.500
29995.7s 2140 Original dt: 3.408331e-01 s
29995.7s 2141 Corrected dt: 2.130207e-01 s
29995.7s 2142 Correction factor: 1.6x
29995.7s 2143 Max wave speed detected: 23.47 m/s
29996.1s 2144 [PROGRESS] Step 13100: t=2774.06/2775.00s (100.0%) | dt=0.2127s
29996.1s 2145 Stored output at t = 2775.0000 s (Step 13105)
29996.1s 2146 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2760.0/2775.0 [00:00<?, ?s/s][A
29996.1s 2147 [A
29996.1s 2148 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.41s/s]
29996.1s 2149 
29996.1s 2150 Simulation finished at t = 2775.0000 s after 13105 steps.
29996.1s 2151 Total runtime: 0.61 seconds.
29996.1s 2152 [REWARD_MICROSCOPE] step=13865 t=2775.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29996.1s 2153 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29996.1s 2154 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29996.1s 2155 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29996.1s 2156 Running simulation until t = 2790.00 s, outputting every 15.00 s
29996.1s 2157 
29996.5s 2158 [PROGRESS] Step 13150: t=2784.56/2790.00s (99.8%) | dt=0.2126s
29996.5s 2159 [PERIODIC:1000] BC_DISPATCHER [Call #13202000] current_bc_params: <class 'dict'>
29996.5s 2160 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29996.5s 2161 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29996.5s 2162 [PERIODIC:1000] BC_GPU [Call #13202000] About to launch kernel
29996.5s 2163 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29996.5s 2164 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29996.5s 2165 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29996.5s 2166 [WARNING] Automatic CFL correction applied (count: 3300400):
29996.5s 2167 Calculated CFL: 0.800 > Limit: 0.500
29996.5s 2168 Original dt: 3.402592e-01 s
29996.5s 2169 Corrected dt: 2.126620e-01 s
29996.5s 2170 Correction factor: 1.6x
29996.5s 2171 Max wave speed detected: 23.51 m/s
29996.7s 2172 Stored output at t = 2790.0000 s (Step 13176)
29996.7s 2173 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2775.0/2790.0 [00:00<?, ?s/s][A
29996.7s 2174 [A
29996.7s 2175 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.01s/s]
29996.7s 2176 
29996.7s 2177 Simulation finished at t = 2790.0000 s after 13176 steps.
29996.7s 2178 Total runtime: 0.63 seconds.
29996.7s 2179 [REWARD_MICROSCOPE] step=13866 t=2790.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29996.7s 2180 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29996.7s 2181 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29996.7s 2182 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29996.7s 2183 Running simulation until t = 2805.00 s, outputting every 15.00 s
29996.7s 2184 
29996.9s 2185 [PROGRESS] Step 13200: t=2795.11/2805.00s (99.6%) | dt=0.2130s
29997.4s 2186 Stored output at t = 2805.0000 s (Step 13247)
29997.4s 2187 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2790.0/2805.0 [00:00<?, ?s/s][A
29997.4s 2188 [A
29997.4s 2189 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.21s/s]
29997.4s 2190 
29997.4s 2191 Simulation finished at t = 2805.0000 s after 13247 steps.
29997.4s 2192 Total runtime: 0.65 seconds.
29997.4s 2193 [REWARD_MICROSCOPE] step=13867 t=2805.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29997.4s 2194 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29997.4s 2195 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29997.4s 2196 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29997.4s 2197 Running simulation until t = 2820.00 s, outputting every 15.00 s
29997.4s 2198 
29997.4s 2199 [PROGRESS] Step 13250: t=2805.64/2820.00s (99.5%) | dt=0.2125s
29997.4s 2200 [WARNING] Automatic CFL correction applied (count: 3300500):
29997.4s 2201 Calculated CFL: 0.800 > Limit: 0.500
29997.4s 2202 Original dt: 3.397413e-01 s
29997.4s 2203 Corrected dt: 2.123383e-01 s
29997.4s 2204 Correction factor: 1.6x
29997.4s 2205 Max wave speed detected: 23.55 m/s
29997.8s 2206 [PROGRESS] Step 13300: t=2816.26/2820.00s (99.9%) | dt=0.2127s
29998.0s 2207 Stored output at t = 2820.0000 s (Step 13318)
29998.0s 2208 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2805.0/2820.0 [00:00<?, ?s/s][A
29998.0s 2209 [A
29998.0s 2210 
29998.0s 2211 Simulation finished at t = 2820.0000 s after 13318 steps.
29998.0s 2212 Total runtime: 0.63 seconds.
29998.0s 2213 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 23.97s/s]
29998.0s 2214 [REWARD_MICROSCOPE] step=13868 t=2820.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29998.0s 2215 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29998.0s 2216 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29998.0s 2217 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29998.0s 2218 Running simulation until t = 2835.00 s, outputting every 15.00 s
29998.0s 2219 
29998.3s 2220 [PROGRESS] Step 13350: t=2826.82/2835.00s (99.7%) | dt=0.2131s
29998.3s 2221 [WARNING] Automatic CFL correction applied (count: 3300600):
29998.3s 2222 Calculated CFL: 0.800 > Limit: 0.500
29998.3s 2223 Original dt: 3.410527e-01 s
29998.3s 2224 Corrected dt: 2.131579e-01 s
29998.3s 2225 Correction factor: 1.6x
29998.3s 2226 Max wave speed detected: 23.46 m/s
29998.6s 2227 Stored output at t = 2835.0000 s (Step 13389)
29998.6s 2228 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2820.0/2835.0 [00:00<?, ?s/s][A
29998.6s 2229 [A
29998.6s 2230 
29998.6s 2231 Simulation finished at t = 2835.0000 s after 13389 steps.
29998.6s 2232 Total runtime: 0.62 seconds.
29998.6s 2233 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.09s/s]
29998.6s 2234 [REWARD_MICROSCOPE] step=13869 t=2835.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29998.6s 2235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29998.6s 2236 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29998.6s 2237 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29998.6s 2238 Running simulation until t = 2850.00 s, outputting every 15.00 s
29998.6s 2239 
29998.7s 2240 [PROGRESS] Step 13400: t=2837.34/2850.00s (99.6%) | dt=0.2123s
29998.7s 2241 [PERIODIC:1000] BC_DISPATCHER [Call #13203000] current_bc_params: <class 'dict'>
29998.7s 2242 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
29998.7s 2243 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
29998.7s 2244 [PERIODIC:1000] BC_GPU [Call #13203000] About to launch kernel
29998.7s 2245 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
29998.7s 2246 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
29998.7s 2247 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
29999.2s 2248 [PROGRESS] Step 13450: t=2847.96/2850.00s (99.9%) | dt=0.2127s
29999.2s 2249 [WARNING] Automatic CFL correction applied (count: 3300700):
29999.2s 2250 Calculated CFL: 0.800 > Limit: 0.500
29999.2s 2251 Original dt: 3.404818e-01 s
29999.2s 2252 Corrected dt: 2.128011e-01 s
29999.2s 2253 Correction factor: 1.6x
29999.2s 2254 Max wave speed detected: 23.50 m/s
29999.3s 2255 Stored output at t = 2850.0000 s (Step 13460)
29999.3s 2256 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2835.0/2850.0 [00:00<?, ?s/s][A
29999.3s 2257 [A
29999.3s 2258 
29999.3s 2259 Simulation finished at t = 2850.0000 s after 13460 steps.
29999.3s 2260 Total runtime: 0.62 seconds.
29999.3s 2261 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 24.16s/s]
29999.3s 2262 [REWARD_MICROSCOPE] step=13870 t=2850.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29999.3s 2263 [STEP  190] t= 2850.0s | phase=1 | reward=   0.01 | total_reward=    1.95
29999.3s 2264 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29999.3s 2265 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
29999.3s 2266 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
29999.3s 2267 Running simulation until t = 2865.00 s, outputting every 15.00 s
29999.3s 2268 
29999.6s 2269 [PROGRESS] Step 13500: t=2858.52/2865.00s (99.8%) | dt=0.2132s
29999.9s 2270 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2850.0/2865.0 [00:00<?, ?s/s][A
29999.9s 2271 [A
29999.9s 2272 Stored output at t = 2865.0000 s (Step 13531)
29999.9s 2273 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 23.75s/s]
29999.9s 2274 
29999.9s 2275 Simulation finished at t = 2865.0000 s after 13531 steps.
29999.9s 2276 Total runtime: 0.63 seconds.
29999.9s 2277 [QUEUE_DIAGNOSTIC] ===== Step 190 t=2865.0s =====
29999.9s 2278 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
29999.9s 2279 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
29999.9s 2280 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
29999.9s 2281 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29999.9s 2282 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
29999.9s 2283 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
29999.9s 2284 1.6692446e-05]
29999.9s 2285 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
29999.9s 2286 2.3782164e-05]
29999.9s 2287 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
29999.9s 2288 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
29999.9s 2289 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
29999.9s 2290 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
29999.9s 2291 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
29999.9s 2292 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
29999.9s 2293 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
29999.9s 2294 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
29999.9s 2295 [REWARD_MICROSCOPE] step=13871 t=2865.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
29999.9s 2296 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
29999.9s 2297 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
29999.9s 2298 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
29999.9s 2299 Running simulation until t = 2880.00 s, outputting every 15.00 s
29999.9s 2300 
30000.1s 2301 [PROGRESS] Step 13550: t=2869.04/2880.00s (99.6%) | dt=0.2124s
30000.1s 2302 [WARNING] Automatic CFL correction applied (count: 3300800):
30000.1s 2303 Calculated CFL: 0.800 > Limit: 0.500
30000.1s 2304 Original dt: 3.398890e-01 s
30000.1s 2305 Corrected dt: 2.124306e-01 s
30000.1s 2306 Correction factor: 1.6x
30000.1s 2307 Max wave speed detected: 23.54 m/s
30000.5s 2308 [PROGRESS] Step 13600: t=2879.67/2880.00s (100.0%) | dt=0.2128s
30000.5s 2309 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2865.0/2880.0 [00:00<?, ?s/s][A
30000.5s 2310 [A
30000.5s 2311 Stored output at t = 2880.0000 s (Step 13602)
30000.5s 2312 
30000.5s 2313 Simulation finished at t = 2880.0000 s after 13602 steps.
30000.5s 2314 Total runtime: 0.64 seconds.
30000.5s 2315 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.43s/s]
30000.5s 2316 [REWARD_MICROSCOPE] step=13872 t=2880.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30000.5s 2317 
30000.5s 2318 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30000.5s 2319 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30000.5s 2320 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30000.5s 2321 Running simulation until t = 2895.00 s, outputting every 15.00 s
30001.0s 2322 [PROGRESS] Step 13650: t=2890.23/2895.00s (99.8%) | dt=0.2132s
30001.0s 2323 [PERIODIC:1000] BC_DISPATCHER [Call #13204000] current_bc_params: <class 'dict'>
30001.0s 2324 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30001.0s 2325 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30001.0s 2326 [PERIODIC:1000] BC_GPU [Call #13204000] About to launch kernel
30001.0s 2327 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30001.0s 2328 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30001.0s 2329 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30001.0s 2330 [WARNING] Automatic CFL correction applied (count: 3300900):
30001.0s 2331 Calculated CFL: 0.800 > Limit: 0.500
30001.0s 2332 Original dt: 3.412697e-01 s
30001.0s 2333 Corrected dt: 2.132935e-01 s
30001.0s 2334 Correction factor: 1.6x
30001.0s 2335 Max wave speed detected: 23.44 m/s
30001.2s 2336 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2880.0/2895.0 [00:00<?, ?s/s][A
30001.2s 2337 [A
30001.2s 2338 Stored output at t = 2895.0000 s (Step 13673)
30001.2s 2339 
30001.2s 2340 Simulation finished at t = 2895.0000 s after 13673 steps.
30001.2s 2341 Total runtime: 0.66 seconds.
30001.2s 2342 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.83s/s]
30001.2s 2343 [REWARD_MICROSCOPE] step=13873 t=2895.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30001.2s 2344 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30001.2s 2345 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30001.2s 2346 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30001.2s 2347 Running simulation until t = 2910.00 s, outputting every 15.00 s
30001.2s 2348 
30001.4s 2349 [PROGRESS] Step 13700: t=2900.77/2910.00s (99.7%) | dt=0.2136s
30001.8s 2350 Stored output at t = 2910.0000 s (Step 13744)
30001.8s 2351 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2895.0/2910.0 [00:00<?, ?s/s][A
30001.8s 2352 [A
30001.8s 2353 
30001.8s 2354 Simulation finished at t = 2910.0000 s after 13744 steps.
30001.8s 2355 Total runtime: 0.62 seconds.
30001.8s 2356 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.20s/s]
30001.8s 2357 [REWARD_MICROSCOPE] step=13874 t=2910.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30001.8s 2358 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30001.8s 2359 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30001.8s 2360 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30001.8s 2361 Running simulation until t = 2925.00 s, outputting every 15.00 s
30001.8s 2362 
30001.9s 2363 [PROGRESS] Step 13750: t=2911.27/2925.00s (99.5%) | dt=0.2124s
30001.9s 2364 [WARNING] Automatic CFL correction applied (count: 3301000):
30001.9s 2365 Calculated CFL: 0.800 > Limit: 0.500
30001.9s 2366 Original dt: 3.397493e-01 s
30001.9s 2367 Corrected dt: 2.123433e-01 s
30001.9s 2368 Correction factor: 1.6x
30001.9s 2369 Max wave speed detected: 23.55 m/s
30002.3s 2370 [PROGRESS] Step 13800: t=2921.90/2925.00s (99.9%) | dt=0.2127s
30002.4s 2371 Stored output at t = 2925.0000 s (Step 13815)
30002.4s 2372 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2910.0/2925.0 [00:00<?, ?s/s][A
30002.4s 2373 [A
30002.4s 2374 
30002.4s 2375 Simulation finished at t = 2925.0000 s after 13815 steps.
30002.4s 2376 Total runtime: 0.62 seconds.
30002.4s 2377 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 24.19s/s]
30002.4s 2378 [REWARD_MICROSCOPE] step=13875 t=2925.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30002.4s 2379 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30002.4s 2380 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30002.4s 2381 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30002.4s 2382 Running simulation until t = 2940.00 s, outputting every 15.00 s
30002.4s 2383 
30002.7s 2384 [PROGRESS] Step 13850: t=2932.46/2940.00s (99.7%) | dt=0.2132s
30002.8s 2385 [WARNING] Automatic CFL correction applied (count: 3301100):
30002.8s 2386 Calculated CFL: 0.800 > Limit: 0.500
30002.8s 2387 Original dt: 3.412035e-01 s
30002.8s 2388 Corrected dt: 2.132522e-01 s
30002.8s 2389 Correction factor: 1.6x
30002.8s 2390 Max wave speed detected: 23.45 m/s
30003.1s 2391 Stored output at t = 2940.0000 s (Step 13886)
30003.1s 2392 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2925.0/2940.0 [00:00<?, ?s/s][A
30003.1s 2393 [A
30003.1s 2394 
30003.1s 2395 Simulation finished at t = 2940.0000 s after 13886 steps.
30003.1s 2396 Total runtime: 0.62 seconds.
30003.1s 2397 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.29s/s]
30003.1s 2398 [REWARD_MICROSCOPE] step=13876 t=2940.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30003.1s 2399 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30003.1s 2400 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30003.1s 2401 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30003.1s 2402 Running simulation until t = 2955.00 s, outputting every 15.00 s
30003.1s 2403 
30003.2s 2404 [PROGRESS] Step 13900: t=2942.99/2955.00s (99.6%) | dt=0.2136s
30003.2s 2405 [PERIODIC:1000] BC_DISPATCHER [Call #13205000] current_bc_params: <class 'dict'>
30003.2s 2406 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30003.2s 2407 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30003.2s 2408 [PERIODIC:1000] BC_GPU [Call #13205000] About to launch kernel
30003.2s 2409 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30003.2s 2410 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30003.2s 2411 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30003.6s 2412 [PROGRESS] Step 13950: t=2953.67/2955.00s (100.0%) | dt=0.2128s
30003.7s 2413 [WARNING] Automatic CFL correction applied (count: 3301200):
30003.7s 2414 Calculated CFL: 0.800 > Limit: 0.500
30003.7s 2415 Original dt: 3.401312e-01 s
30003.7s 2416 Corrected dt: 2.125820e-01 s
30003.7s 2417 Correction factor: 1.6x
30003.7s 2418 Max wave speed detected: 23.52 m/s
30003.7s 2419 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2940.0/2955.0 [00:00<?, ?s/s][A
30003.7s 2420 [A
30003.7s 2421 Stored output at t = 2955.0000 s (Step 13957)
30003.7s 2422 
30003.7s 2423 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 24.38s/s]
30003.7s 2424 Simulation finished at t = 2955.0000 s after 13957 steps.
30003.7s 2425 Total runtime: 0.62 seconds.
30003.7s 2426 [REWARD_MICROSCOPE] step=13877 t=2955.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30003.7s 2427 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30003.7s 2428 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30003.7s 2429 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30003.7s 2430 Running simulation until t = 2970.00 s, outputting every 15.00 s
30003.7s 2431 
30004.1s 2432 [PROGRESS] Step 14000: t=2964.14/2970.00s (99.8%) | dt=0.2126s
30004.3s 2433 Stored output at t = 2970.0000 s (Step 14028)
30004.3s 2434 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2955.0/2970.0 [00:00<?, ?s/s][A
30004.3s 2435 [A
30004.3s 2436 
30004.3s 2437 Simulation finished at t = 2970.0000 s after 14028 steps.
30004.3s 2438 Total runtime: 0.62 seconds.
30004.3s 2439 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 24.38s/s]
30004.3s 2440 [REWARD_MICROSCOPE] step=13878 t=2970.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30004.3s 2441 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30004.3s 2442 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30004.3s 2443 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30004.3s 2444 Running simulation until t = 2985.00 s, outputting every 15.00 s
30004.3s 2445 
30004.5s 2446 [PROGRESS] Step 14050: t=2974.69/2985.00s (99.7%) | dt=0.2131s
30004.5s 2447 [WARNING] Automatic CFL correction applied (count: 3301300):
30004.5s 2448 Calculated CFL: 0.800 > Limit: 0.500
30004.5s 2449 Original dt: 3.410128e-01 s
30004.5s 2450 Corrected dt: 2.131330e-01 s
30004.5s 2451 Correction factor: 1.6x
30004.5s 2452 Max wave speed detected: 23.46 m/s
30004.9s 2453 Stored output at t = 2985.0000 s (Step 14099)
30004.9s 2454 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2970.0/2985.0 [00:00<?, ?s/s][A
30004.9s 2455 [A
30004.9s 2456 
30004.9s 2457 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.04s/s]
30004.9s 2458 Simulation finished at t = 2985.0000 s after 14099 steps.
30004.9s 2459 Total runtime: 0.62 seconds.
30004.9s 2460 [REWARD_MICROSCOPE] step=13879 t=2985.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30004.9s 2461 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30004.9s 2462 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30004.9s 2463 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30004.9s 2464 Running simulation until t = 3000.00 s, outputting every 15.00 s
30004.9s 2465 
30004.9s 2466 [PROGRESS] Step 14100: t=2985.21/3000.00s (99.5%) | dt=0.2125s
30005.4s 2467 [PROGRESS] Step 14150: t=2995.84/3000.00s (99.9%) | dt=0.2127s
30005.4s 2468 [PERIODIC:1000] BC_DISPATCHER [Call #13206000] current_bc_params: <class 'dict'>
30005.4s 2469 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30005.4s 2470 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30005.4s 2471 [PERIODIC:1000] BC_GPU [Call #13206000] About to launch kernel
30005.4s 2472 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30005.4s 2473 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30005.4s 2474 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30005.4s 2475 [WARNING] Automatic CFL correction applied (count: 3301400):
30005.4s 2476 Calculated CFL: 0.800 > Limit: 0.500
30005.4s 2477 Original dt: 3.403438e-01 s
30005.4s 2478 Corrected dt: 2.127149e-01 s
30005.4s 2479 Correction factor: 1.6x
30005.4s 2480 Max wave speed detected: 23.51 m/s
30005.6s 2481 Stored output at t = 3000.0000 s (Step 14170)
30005.6s 2482 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2985.0/3000.0 [00:00<?, ?s/s][A
30005.6s 2483 [A
30005.6s 2484 
30005.6s 2485 Simulation finished at t = 3000.0000 s after 14170 steps.
30005.6s 2486 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.76s/s]
30005.6s 2487 Total runtime: 0.63 seconds.
30005.6s 2488 [REWARD_MICROSCOPE] step=13880 t=3000.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30005.6s 2489 [STEP  200] t= 3000.0s | phase=1 | reward=   0.01 | total_reward=    2.07
30005.6s 2490 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30005.6s 2491 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30005.6s 2492 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30005.6s 2493 Running simulation until t = 3015.00 s, outputting every 15.00 s
30005.6s 2494 
30005.8s 2495 [PROGRESS] Step 14200: t=3006.39/3015.00s (99.7%) | dt=0.2131s
30006.2s 2496 Stored output at t = 3015.0000 s (Step 14241)
30006.2s 2497 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3000.0/3015.0 [00:00<?, ?s/s][A
30006.2s 2498 [A
30006.2s 2499 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.24s/s]
30006.2s 2500 
30006.2s 2501 Simulation finished at t = 3015.0000 s after 14241 steps.
30006.2s 2502 Total runtime: 0.62 seconds.
30006.2s 2503 [QUEUE_DIAGNOSTIC] ===== Step 200 t=3015.0s =====
30006.2s 2504 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30006.2s 2505 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.240832e-05 1.000000e+00 2.051389e-04 1.000000e+00] (rho_m, v_m, rho_c, v_c)
30006.2s 2506 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30006.2s 2507 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30006.2s 2508 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30006.2s 2509 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30006.2s 2510 1.6692444e-05]
30006.2s 2511 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770836e-05 2.6356691e-05 2.4789349e-05 2.4169874e-05 2.3902570e-05
30006.2s 2512 2.3782084e-05]
30006.2s 2513 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30006.2s 2514 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30006.2s 2515 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30006.2s 2516 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30006.2s 2517 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30006.2s 2518 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30006.2s 2519 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30006.2s 2520 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30006.2s 2521 [REWARD_MICROSCOPE] step=13881 t=3015.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30006.2s 2522 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30006.2s 2523 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30006.2s 2524 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30006.2s 2525 Running simulation until t = 3030.00 s, outputting every 15.00 s
30006.2s 2526 
30006.3s 2527 [PROGRESS] Step 14250: t=3016.91/3030.00s (99.6%) | dt=0.2123s
30006.3s 2528 [WARNING] Automatic CFL correction applied (count: 3301500):
30006.3s 2529 Calculated CFL: 0.800 > Limit: 0.500
30006.3s 2530 Original dt: 3.397401e-01 s
30006.3s 2531 Corrected dt: 2.123376e-01 s
30006.3s 2532 Correction factor: 1.6x
30006.3s 2533 Max wave speed detected: 23.55 m/s
30006.7s 2534 [PROGRESS] Step 14300: t=3027.54/3030.00s (99.9%) | dt=0.2127s
30006.8s 2535 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3015.0/3030.0 [00:00<?, ?s/s][A
30006.8s 2536 [A
30006.8s 2537 Stored output at t = 3030.0000 s (Step 14312)
30006.8s 2538 
30006.8s 2539 Simulation finished at t = 3030.0000 s after 14312 steps.
30006.8s 2540 Total runtime: 0.62 seconds.
30006.8s 2541 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.27s/s]
30006.8s 2542 [REWARD_MICROSCOPE] step=13882 t=3030.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30006.8s 2543 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30006.8s 2544 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30006.8s 2545 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30006.8s 2546 Running simulation until t = 3045.00 s, outputting every 15.00 s
30006.8s 2547 
30007.1s 2548 [PROGRESS] Step 14350: t=3038.09/3045.00s (99.8%) | dt=0.2132s
30007.2s 2549 [WARNING] Automatic CFL correction applied (count: 3301600):
30007.2s 2550 Calculated CFL: 0.800 > Limit: 0.500
30007.2s 2551 Original dt: 3.411335e-01 s
30007.2s 2552 Corrected dt: 2.132084e-01 s
30007.2s 2553 Correction factor: 1.6x
30007.2s 2554 Max wave speed detected: 23.45 m/s
30007.4s 2555 Stored output at t = 3045.0000 s (Step 14383)
30007.4s 2556 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3030.0/3045.0 [00:00<?, ?s/s][A
30007.4s 2557 [A
30007.4s 2558 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.24s/s]
30007.4s 2559 
30007.4s 2560 Simulation finished at t = 3045.0000 s after 14383 steps.
30007.4s 2561 Total runtime: 0.62 seconds.
30007.4s 2562 [REWARD_MICROSCOPE] step=13883 t=3045.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30007.4s 2563 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30007.4s 2564 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30007.4s 2565 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30007.4s 2566 Running simulation until t = 3060.00 s, outputting every 15.00 s
30007.4s 2567 
30007.6s 2568 [PROGRESS] Step 14400: t=3048.61/3060.00s (99.6%) | dt=0.2124s
30007.6s 2569 [PERIODIC:1000] BC_DISPATCHER [Call #13207000] current_bc_params: <class 'dict'>
30007.6s 2570 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30007.6s 2571 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30007.6s 2572 [PERIODIC:1000] BC_GPU [Call #13207000] About to launch kernel
30007.6s 2573 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30007.6s 2574 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30007.6s 2575 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30008.1s 2576 [PROGRESS] Step 14450: t=3059.24/3060.00s (100.0%) | dt=0.2128s
30008.1s 2577 Stored output at t = 3060.0000 s (Step 14454)
30008.1s 2578 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3045.0/3060.0 [00:00<?, ?s/s][A
30008.1s 2579 [A
30008.1s 2580 
30008.1s 2581 Simulation finished at t = 3060.0000 s after 14454 steps.
30008.1s 2582 Total runtime: 0.67 seconds.
30008.1s 2583 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 22.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 22.27s/s]
30008.1s 2584 [REWARD_MICROSCOPE] step=13884 t=3060.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30008.1s 2585 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30008.1s 2586 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30008.1s 2587 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30008.1s 2588 Running simulation until t = 3075.00 s, outputting every 15.00 s
30008.1s 2589 
30008.1s 2590 [WARNING] Automatic CFL correction applied (count: 3301700):
30008.1s 2591 Calculated CFL: 0.800 > Limit: 0.500
30008.1s 2592 Original dt: 3.405553e-01 s
30008.1s 2593 Corrected dt: 2.128470e-01 s
30008.1s 2594 Correction factor: 1.6x
30008.1s 2595 Max wave speed detected: 23.49 m/s
30008.5s 2596 [PROGRESS] Step 14500: t=3069.80/3075.00s (99.8%) | dt=0.2132s
30008.7s 2597 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3060.0/3075.0 [00:00<?, ?s/s][A
30008.7s 2598 [A
30008.7s 2599 Stored output at t = 3075.0000 s (Step 14525)
30008.7s 2600 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.08s/s]
30008.7s 2601 
30008.7s 2602 Simulation finished at t = 3075.0000 s after 14525 steps.
30008.7s 2603 Total runtime: 0.62 seconds.
30008.7s 2604 [REWARD_MICROSCOPE] step=13885 t=3075.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30008.7s 2605 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30008.7s 2606 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30008.7s 2607 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30008.7s 2608 Running simulation until t = 3090.00 s, outputting every 15.00 s
30008.7s 2609 
30009.0s 2610 [PROGRESS] Step 14550: t=3080.31/3090.00s (99.7%) | dt=0.2124s
30009.0s 2611 [WARNING] Automatic CFL correction applied (count: 3301800):
30009.0s 2612 Calculated CFL: 0.800 > Limit: 0.500
30009.0s 2613 Original dt: 3.399790e-01 s
30009.0s 2614 Corrected dt: 2.124869e-01 s
30009.0s 2615 Correction factor: 1.6x
30009.0s 2616 Max wave speed detected: 23.53 m/s
30009.4s 2617 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3075.0/3090.0 [00:00<?, ?s/s][A
30009.4s 2618 [A
30009.4s 2619 Stored output at t = 3090.0000 s (Step 14596)
30009.4s 2620 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.02s/s]
30009.4s 2621 
30009.4s 2622 Simulation finished at t = 3090.0000 s after 14596 steps.
30009.4s 2623 Total runtime: 0.62 seconds.
30009.4s 2624 [REWARD_MICROSCOPE] step=13886 t=3090.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30009.4s 2625 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30009.4s 2626 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30009.4s 2627 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30009.4s 2628 Running simulation until t = 3105.00 s, outputting every 15.00 s
30009.4s 2629 
30009.4s 2630 [PROGRESS] Step 14600: t=3090.85/3105.00s (99.5%) | dt=0.2129s
30009.8s 2631 [PROGRESS] Step 14650: t=3101.51/3105.00s (99.9%) | dt=0.2133s
30009.8s 2632 [PERIODIC:1000] BC_DISPATCHER [Call #13208000] current_bc_params: <class 'dict'>
30009.8s 2633 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30009.8s 2634 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30009.8s 2635 [PERIODIC:1000] BC_GPU [Call #13208000] About to launch kernel
30009.8s 2636 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30009.8s 2637 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30009.8s 2638 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30009.9s 2639 [WARNING] Automatic CFL correction applied (count: 3301900):
30009.9s 2640 Calculated CFL: 0.800 > Limit: 0.500
30009.9s 2641 Original dt: 3.407550e-01 s
30009.9s 2642 Corrected dt: 2.129719e-01 s
30009.9s 2643 Correction factor: 1.6x
30009.9s 2644 Max wave speed detected: 23.48 m/s
30010.0s 2645 Stored output at t = 3105.0000 s (Step 14667)
30010.0s 2646 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3090.0/3105.0 [00:00<?, ?s/s][A
30010.0s 2647 [A
30010.0s 2648 
30010.0s 2649 Simulation finished at t = 3105.0000 s after 14667 steps.
30010.0s 2650 Total runtime: 0.63 seconds.
30010.0s 2651 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 23.95s/s]
30010.0s 2652 [REWARD_MICROSCOPE] step=13887 t=3105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30010.0s 2653 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30010.0s 2654 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30010.0s 2655 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30010.0s 2656 Running simulation until t = 3120.00 s, outputting every 15.00 s
30010.0s 2657 
30010.3s 2658 [PROGRESS] Step 14700: t=3112.01/3120.00s (99.7%) | dt=0.2125s
30010.6s 2659 Stored output at t = 3120.0000 s (Step 14738)
30010.6s 2660 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3105.0/3120.0 [00:00<?, ?s/s][A
30010.6s 2661 [A
30010.6s 2662 
30010.6s 2663 Simulation finished at t = 3120.0000 s after 14738 steps.
30010.6s 2664 Total runtime: 0.61 seconds.
30010.6s 2665 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.48s/s]
30010.6s 2666 [REWARD_MICROSCOPE] step=13888 t=3120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30010.6s 2667 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30010.6s 2668 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30010.6s 2669 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30010.6s 2670 Running simulation until t = 3135.00 s, outputting every 15.00 s
30010.6s 2671 
30010.7s 2672 [PROGRESS] Step 14750: t=3122.55/3135.00s (99.6%) | dt=0.2129s
30010.8s 2673 [WARNING] Automatic CFL correction applied (count: 3302000):
30010.8s 2674 Calculated CFL: 0.800 > Limit: 0.500
30010.8s 2675 Original dt: 3.407770e-01 s
30010.8s 2676 Corrected dt: 2.129856e-01 s
30010.8s 2677 Correction factor: 1.6x
30010.8s 2678 Max wave speed detected: 23.48 m/s
30011.2s 2679 [PROGRESS] Step 14800: t=3133.21/3135.00s (99.9%) | dt=0.2129s
30011.2s 2680 Stored output at t = 3135.0000 s (Step 14809)
30011.2s 2681 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3120.0/3135.0 [00:00<?, ?s/s][A
30011.2s 2682 [A
30011.2s 2683 
30011.2s 2684 Simulation finished at t = 3135.0000 s after 14809 steps.
30011.2s 2685 Total runtime: 0.63 seconds.
30011.2s 2686 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.68s/s]
30011.2s 2687 [REWARD_MICROSCOPE] step=13889 t=3135.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30011.2s 2688 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30011.2s 2689 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30011.2s 2690 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30011.2s 2691 Running simulation until t = 3150.00 s, outputting every 15.00 s
30011.2s 2692 
30011.6s 2693 [PROGRESS] Step 14850: t=3143.71/3150.00s (99.8%) | dt=0.2126s
30011.7s 2694 [WARNING] Automatic CFL correction applied (count: 3302100):
30011.7s 2695 Calculated CFL: 0.800 > Limit: 0.500
30011.7s 2696 Original dt: 3.402034e-01 s
30011.7s 2697 Corrected dt: 2.126271e-01 s
30011.7s 2698 Correction factor: 1.6x
30011.7s 2699 Max wave speed detected: 23.52 m/s
30011.9s 2700 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3135.0/3150.0 [00:00<?, ?s/s][A
30011.9s 2701 [A
30011.9s 2702 Stored output at t = 3150.0000 s (Step 14880)
30011.9s 2703 
30011.9s 2704 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.28s/s]
30011.9s 2705 Simulation finished at t = 3150.0000 s after 14880 steps.
30011.9s 2706 Total runtime: 0.62 seconds.
30011.9s 2707 [REWARD_MICROSCOPE] step=13890 t=3150.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30011.9s 2708 [STEP  210] t= 3150.0s | phase=1 | reward=   0.01 | total_reward=    2.17
30011.9s 2709 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30011.9s 2710 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30011.9s 2711 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30011.9s 2712 Running simulation until t = 3165.00 s, outputting every 15.00 s
30011.9s 2713 
30012.0s 2714 [PROGRESS] Step 14900: t=3154.26/3165.00s (99.7%) | dt=0.2130s
30012.1s 2715 [PERIODIC:1000] BC_DISPATCHER [Call #13209000] current_bc_params: <class 'dict'>
30012.1s 2716 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30012.1s 2717 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30012.1s 2718 [PERIODIC:1000] BC_GPU [Call #13209000] About to launch kernel
30012.1s 2719 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30012.1s 2720 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30012.1s 2721 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30012.5s 2722 [PROGRESS] Step 14950: t=3164.91/3165.00s (100.0%) | dt=0.2126s
30012.5s 2723 Stored output at t = 3165.0000 s (Step 14951)
30012.5s 2724 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3150.0/3165.0 [00:00<?, ?s/s][A
30012.5s 2725 [A
30012.5s 2726 
30012.5s 2727 Simulation finished at t = 3165.0000 s after 14951 steps.
30012.5s 2728 Total runtime: 0.61 seconds.
30012.5s 2729 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.54s/s]
30012.5s 2730 [QUEUE_DIAGNOSTIC] ===== Step 210 t=3165.0s =====
30012.5s 2731 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30012.5s 2732 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30012.5s 2733 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30012.5s 2734 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30012.5s 2735 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30012.5s 2736 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30012.5s 2737 1.6692446e-05]
30012.5s 2738 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30012.5s 2739 2.3782164e-05]
30012.5s 2740 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30012.5s 2741 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30012.5s 2742 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30012.5s 2743 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30012.5s 2744 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30012.5s 2745 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30012.5s 2746 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30012.5s 2747 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30012.5s 2748 [REWARD_MICROSCOPE] step=13891 t=3165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30012.5s 2749 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30012.5s 2750 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30012.5s 2751 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30012.5s 2752 Running simulation until t = 3180.00 s, outputting every 15.00 s
30012.5s 2753 
30012.5s 2754 [WARNING] Automatic CFL correction applied (count: 3302200):
30012.5s 2755 Calculated CFL: 0.800 > Limit: 0.500
30012.5s 2756 Original dt: 3.398708e-01 s
30012.5s 2757 Corrected dt: 2.124193e-01 s
30012.5s 2758 Correction factor: 1.6x
30012.5s 2759 Max wave speed detected: 23.54 m/s
30012.9s 2760 [PROGRESS] Step 15000: t=3175.41/3180.00s (99.9%) | dt=0.2126s
30013.1s 2761 Stored output at t = 3180.0000 s (Step 15022)
30013.1s 2762 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3165.0/3180.0 [00:00<?, ?s/s][A
30013.1s 2763 [A
30013.1s 2764 
30013.1s 2765 Simulation finished at t = 3180.0000 s after 15022 steps.
30013.1s 2766 Total runtime: 0.63 seconds.
30013.1s 2767 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 23.75s/s]
30013.1s 2768 [REWARD_MICROSCOPE] step=13892 t=3180.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30013.1s 2769 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30013.1s 2770 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30013.1s 2771 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30013.1s 2772 Running simulation until t = 3195.00 s, outputting every 15.00 s
30013.1s 2773 
30013.4s 2774 [PROGRESS] Step 15050: t=3185.96/3195.00s (99.7%) | dt=0.2131s
30013.4s 2775 [WARNING] Automatic CFL correction applied (count: 3302300):
30013.4s 2776 Calculated CFL: 0.800 > Limit: 0.500
30013.4s 2777 Original dt: 3.409993e-01 s
30013.4s 2778 Corrected dt: 2.131246e-01 s
30013.4s 2779 Correction factor: 1.6x
30013.4s 2780 Max wave speed detected: 23.46 m/s
30013.8s 2781 Stored output at t = 3195.0000 s (Step 15093)
30013.8s 2782 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3180.0/3195.0 [00:00<?, ?s/s][A
30013.8s 2783 [A
30013.8s 2784 
30013.8s 2785 Simulation finished at t = 3195.0000 s after 15093 steps.
30013.8s 2786 Total runtime: 0.65 seconds.
30013.8s 2787 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.05s/s]
30013.8s 2788 [REWARD_MICROSCOPE] step=13893 t=3195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30013.8s 2789 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30013.8s 2790 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30013.8s 2791 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30013.8s 2792 Running simulation until t = 3210.00 s, outputting every 15.00 s
30013.8s 2793 
30013.8s 2794 [PROGRESS] Step 15100: t=3196.49/3210.00s (99.6%) | dt=0.2124s
30014.3s 2795 [PROGRESS] Step 15150: t=3207.11/3210.00s (99.9%) | dt=0.2127s
30014.3s 2796 [PERIODIC:1000] BC_DISPATCHER [Call #13210000] current_bc_params: <class 'dict'>
30014.3s 2797 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30014.3s 2798 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30014.3s 2799 [PERIODIC:1000] BC_GPU [Call #13210000] About to launch kernel
30014.3s 2800 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30014.3s 2801 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30014.3s 2802 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30014.3s 2803 [WARNING] Automatic CFL correction applied (count: 3302400):
30014.3s 2804 Calculated CFL: 0.800 > Limit: 0.500
30014.3s 2805 Original dt: 3.404274e-01 s
30014.3s 2806 Corrected dt: 2.127671e-01 s
30014.3s 2807 Correction factor: 1.6x
30014.3s 2808 Max wave speed detected: 23.50 m/s
30014.4s 2809 Stored output at t = 3210.0000 s (Step 15164)
30014.4s 2810 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3195.0/3210.0 [00:00<?, ?s/s][A
30014.4s 2811 [A
30014.4s 2812 
30014.4s 2813 Simulation finished at t = 3210.0000 s after 15164 steps.
30014.4s 2814 Total runtime: 0.61 seconds.
30014.4s 2815 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 24.50s/s]
30014.4s 2816 [REWARD_MICROSCOPE] step=13894 t=3210.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30014.4s 2817 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30014.4s 2818 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30014.4s 2819 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30014.4s 2820 Running simulation until t = 3225.00 s, outputting every 15.00 s
30014.4s 2821 
30014.7s 2822 [PROGRESS] Step 15200: t=3217.67/3225.00s (99.8%) | dt=0.2131s
30015.0s 2823 Stored output at t = 3225.0000 s (Step 15235)
30015.0s 2824 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3210.0/3225.0 [00:00<?, ?s/s][A
30015.0s 2825 [A
30015.0s 2826 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.28s/s]
30015.0s 2827 
30015.0s 2828 Simulation finished at t = 3225.0000 s after 15235 steps.
30015.0s 2829 Total runtime: 0.62 seconds.
30015.0s 2830 [REWARD_MICROSCOPE] step=13895 t=3225.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30015.0s 2831 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30015.0s 2832 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30015.0s 2833 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30015.0s 2834 Running simulation until t = 3240.00 s, outputting every 15.00 s
30015.0s 2835 
30015.1s 2836 [PROGRESS] Step 15250: t=3228.19/3240.00s (99.6%) | dt=0.2123s
30015.2s 2837 [WARNING] Automatic CFL correction applied (count: 3302500):
30015.2s 2838 Calculated CFL: 0.800 > Limit: 0.500
30015.2s 2839 Original dt: 3.398278e-01 s
30015.2s 2840 Corrected dt: 2.123924e-01 s
30015.2s 2841 Correction factor: 1.6x
30015.2s 2842 Max wave speed detected: 23.54 m/s
30015.6s 2843 [PROGRESS] Step 15300: t=3238.81/3240.00s (100.0%) | dt=0.2128s
30015.6s 2844 Stored output at t = 3240.0000 s (Step 15306)
30015.6s 2845 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3225.0/3240.0 [00:00<?, ?s/s][A
30015.6s 2846 [A
30015.6s 2847 
30015.6s 2848 Simulation finished at t = 3240.0000 s after 15306 steps.
30015.6s 2849 Total runtime: 0.61 seconds.
30015.6s 2850 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.45s/s]
30015.6s 2851 [REWARD_MICROSCOPE] step=13896 t=3240.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30015.6s 2852 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30015.6s 2853 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30015.6s 2854 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30015.6s 2855 Running simulation until t = 3255.00 s, outputting every 15.00 s
30015.6s 2856 
30016.0s 2857 [PROGRESS] Step 15350: t=3249.37/3255.00s (99.8%) | dt=0.2132s
30016.1s 2858 [WARNING] Automatic CFL correction applied (count: 3302600):
30016.1s 2859 Calculated CFL: 0.800 > Limit: 0.500
30016.1s 2860 Original dt: 3.412149e-01 s
30016.1s 2861 Corrected dt: 2.132593e-01 s
30016.1s 2862 Correction factor: 1.6x
30016.1s 2863 Max wave speed detected: 23.45 m/s
30016.2s 2864 Stored output at t = 3255.0000 s (Step 15377)
30016.2s 2865 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3240.0/3255.0 [00:00<?, ?s/s][A
30016.2s 2866 [A
30016.2s 2867 
30016.2s 2868 Simulation finished at t = 3255.0000 s after 15377 steps.
30016.2s 2869 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.44s/s]
30016.2s 2870 Total runtime: 0.61 seconds.
30016.3s 2871 [REWARD_MICROSCOPE] step=13897 t=3255.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30016.3s 2872 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30016.3s 2873 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30016.3s 2874 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30016.3s 2875 Running simulation until t = 3270.00 s, outputting every 15.00 s
30016.3s 2876 
30016.5s 2877 [PROGRESS] Step 15400: t=3259.88/3270.00s (99.7%) | dt=0.2124s
30016.5s 2878 [PERIODIC:1000] BC_DISPATCHER [Call #13211000] current_bc_params: <class 'dict'>
30016.5s 2879 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30016.5s 2880 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30016.5s 2881 [PERIODIC:1000] BC_GPU [Call #13211000] About to launch kernel
30016.5s 2882 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30016.5s 2883 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30016.5s 2884 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30016.9s 2885 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3255.0/3270.0 [00:00<?, ?s/s][A
30016.9s 2886 Stored output at t = 3270.0000 s (Step 15448)
30016.9s 2887 [A
30016.9s 2888 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.27s/s]
30016.9s 2889 
30016.9s 2890 Simulation finished at t = 3270.0000 s after 15448 steps.
30016.9s 2891 Total runtime: 0.62 seconds.
30016.9s 2892 [REWARD_MICROSCOPE] step=13898 t=3270.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30016.9s 2893 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30016.9s 2894 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30016.9s 2895 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30016.9s 2896 Running simulation until t = 3285.00 s, outputting every 15.00 s
30016.9s 2897 
30016.9s 2898 [PROGRESS] Step 15450: t=3270.43/3285.00s (99.6%) | dt=0.2128s
30016.9s 2899 [WARNING] Automatic CFL correction applied (count: 3302700):
30016.9s 2900 Calculated CFL: 0.800 > Limit: 0.500
30016.9s 2901 Original dt: 3.406380e-01 s
30016.9s 2902 Corrected dt: 2.128988e-01 s
30016.9s 2903 Correction factor: 1.6x
30016.9s 2904 Max wave speed detected: 23.49 m/s
30017.3s 2905 [PROGRESS] Step 15500: t=3281.08/3285.00s (99.9%) | dt=0.2133s
30017.5s 2906 Stored output at t = 3285.0000 s (Step 15519)
30017.5s 2907 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3270.0/3285.0 [00:00<?, ?s/s][A
30017.5s 2908 [A
30017.5s 2909 
30017.5s 2910 Simulation finished at t = 3285.0000 s after 15519 steps.
30017.5s 2911 Total runtime: 0.63 seconds.
30017.5s 2912 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 23.93s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 23.92s/s]
30017.5s 2913 [REWARD_MICROSCOPE] step=13899 t=3285.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30017.5s 2914 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30017.5s 2915 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30017.5s 2916 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30017.5s 2917 Running simulation until t = 3300.00 s, outputting every 15.00 s
30017.5s 2918 
30017.8s 2919 [PROGRESS] Step 15550: t=3291.58/3300.00s (99.7%) | dt=0.2125s
30017.8s 2920 [WARNING] Automatic CFL correction applied (count: 3302800):
30017.8s 2921 Calculated CFL: 0.800 > Limit: 0.500
30017.8s 2922 Original dt: 3.400643e-01 s
30017.8s 2923 Corrected dt: 2.125402e-01 s
30017.8s 2924 Correction factor: 1.6x
30017.8s 2925 Max wave speed detected: 23.52 m/s
30018.1s 2926 Stored output at t = 3300.0000 s (Step 15590)
30018.1s 2927 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3285.0/3300.0 [00:00<?, ?s/s][A
30018.1s 2928 [A
30018.1s 2929 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.56s/s]
30018.1s 2930 
30018.1s 2931 Simulation finished at t = 3300.0000 s after 15590 steps.
30018.1s 2932 Total runtime: 0.61 seconds.
30018.1s 2933 [REWARD_MICROSCOPE] step=13900 t=3300.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30018.1s 2934 [STEP  220] t= 3300.0s | phase=1 | reward=   0.01 | total_reward=    2.27
30018.1s 2935 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30018.1s 2936 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30018.1s 2937 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30018.1s 2938 Running simulation until t = 3315.00 s, outputting every 15.00 s
30018.1s 2939 
30018.2s 2940 [PROGRESS] Step 15600: t=3302.13/3315.00s (99.6%) | dt=0.2129s
30018.6s 2941 [PROGRESS] Step 15650: t=3312.78/3315.00s (99.9%) | dt=0.2130s
30018.6s 2942 [PERIODIC:1000] BC_DISPATCHER [Call #13212000] current_bc_params: <class 'dict'>
30018.6s 2943 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30018.6s 2944 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30018.6s 2945 [PERIODIC:1000] BC_GPU [Call #13212000] About to launch kernel
30018.6s 2946 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30018.6s 2947 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30018.6s 2948 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30018.7s 2949 [WARNING] Automatic CFL correction applied (count: 3302900):
30018.7s 2950 Calculated CFL: 0.800 > Limit: 0.500
30018.7s 2951 Original dt: 3.403351e-01 s
30018.7s 2952 Corrected dt: 2.127094e-01 s
30018.7s 2953 Correction factor: 1.6x
30018.7s 2954 Max wave speed detected: 23.51 m/s
30018.7s 2955 Stored output at t = 3315.0000 s (Step 15661)
30018.7s 2956 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3300.0/3315.0 [00:00<?, ?s/s][A
30018.7s 2957 [A
30018.7s 2958 
30018.7s 2959 Simulation finished at t = 3315.0000 s after 15661 steps.
30018.7s 2960 Total runtime: 0.61 seconds.
30018.7s 2961 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.63s/s]
30018.7s 2962 [QUEUE_DIAGNOSTIC] ===== Step 220 t=3315.0s =====
30018.7s 2963 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30018.7s 2964 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30018.7s 2965 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30018.7s 2966 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30018.7s 2967 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30018.7s 2968 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30018.7s 2969 1.6692446e-05]
30018.7s 2970 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30018.7s 2971 2.3782164e-05]
30018.7s 2972 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30018.7s 2973 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30018.7s 2974 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30018.7s 2975 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30018.7s 2976 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30018.7s 2977 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30018.7s 2978 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30018.7s 2979 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30018.7s 2980 [REWARD_MICROSCOPE] step=13901 t=3315.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30018.7s 2981 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30018.7s 2982 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30018.7s 2983 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30018.7s 2984 Running simulation until t = 3330.00 s, outputting every 15.00 s
30018.7s 2985 
30019.1s 2986 [PROGRESS] Step 15700: t=3323.28/3330.00s (99.8%) | dt=0.2126s
30019.4s 2987 Stored output at t = 3330.0000 s (Step 15732)
30019.4s 2988 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3315.0/3330.0 [00:00<?, ?s/s][A
30019.4s 2989 [A
30019.4s 2990 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.88s/s]
30019.4s 2991 
30019.4s 2992 Simulation finished at t = 3330.0000 s after 15732 steps.
30019.4s 2993 Total runtime: 0.63 seconds.
30019.4s 2994 [REWARD_MICROSCOPE] step=13902 t=3330.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30019.4s 2995 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30019.4s 2996 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30019.4s 2997 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30019.4s 2998 Running simulation until t = 3345.00 s, outputting every 15.00 s
30019.4s 2999 
30019.6s 3000 [PROGRESS] Step 15750: t=3333.83/3345.00s (99.7%) | dt=0.2130s
30019.6s 3001 [WARNING] Automatic CFL correction applied (count: 3303000):
30019.6s 3002 Calculated CFL: 0.800 > Limit: 0.500
30019.6s 3003 Original dt: 3.408612e-01 s
30019.6s 3004 Corrected dt: 2.130383e-01 s
30019.6s 3005 Correction factor: 1.6x
30019.6s 3006 Max wave speed detected: 23.47 m/s
30020.0s 3007 [PROGRESS] Step 15800: t=3344.49/3345.00s (100.0%) | dt=0.2126s
30020.0s 3008 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3330.0/3345.0 [00:00<?, ?s/s][A
30020.0s 3009 Stored output at t = 3345.0000 s (Step 15803)
30020.0s 3010 [A
30020.0s 3011 
30020.0s 3012 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 22.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 22.17s/s]
30020.0s 3013 Simulation finished at t = 3345.0000 s after 15803 steps.
30020.0s 3014 Total runtime: 0.68 seconds.
30020.0s 3015 [REWARD_MICROSCOPE] step=13903 t=3345.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30020.0s 3016 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30020.0s 3017 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30020.0s 3018 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30020.0s 3019 Running simulation until t = 3360.00 s, outputting every 15.00 s
30020.0s 3020 
30020.4s 3021 [PROGRESS] Step 15850: t=3354.99/3360.00s (99.9%) | dt=0.2126s
30020.5s 3022 [WARNING] Automatic CFL correction applied (count: 3303100):
30020.5s 3023 Calculated CFL: 0.800 > Limit: 0.500
30020.5s 3024 Original dt: 3.402871e-01 s
30020.5s 3025 Corrected dt: 2.126795e-01 s
30020.5s 3026 Correction factor: 1.6x
30020.5s 3027 Max wave speed detected: 23.51 m/s
30020.7s 3028 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3345.0/3360.0 [00:00<?, ?s/s][A
30020.7s 3029 [A
30020.7s 3030 Stored output at t = 3360.0000 s (Step 15874)
30020.7s 3031 
30020.7s 3032 Simulation finished at t = 3360.0000 s after 15874 steps.
30020.7s 3033 Total runtime: 0.62 seconds.
30020.7s 3034 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 24.18s/s]
30020.7s 3035 [REWARD_MICROSCOPE] step=13904 t=3360.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30020.7s 3036 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30020.7s 3037 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30020.7s 3038 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30020.7s 3039 Running simulation until t = 3375.00 s, outputting every 15.00 s
30020.7s 3040 
30020.9s 3041 [PROGRESS] Step 15900: t=3365.54/3375.00s (99.7%) | dt=0.2131s
30020.9s 3042 [PERIODIC:1000] BC_DISPATCHER [Call #13213000] current_bc_params: <class 'dict'>
30020.9s 3043 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30020.9s 3044 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30020.9s 3045 [PERIODIC:1000] BC_GPU [Call #13213000] About to launch kernel
30020.9s 3046 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30020.9s 3047 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30020.9s 3048 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30021.3s 3049 Stored output at t = 3375.0000 s (Step 15945)
30021.3s 3050 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3360.0/3375.0 [00:00<?, ?s/s][A
30021.3s 3051 [A
30021.3s 3052 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.35s/s]
30021.3s 3053 
30021.3s 3054 Simulation finished at t = 3375.0000 s after 15945 steps.
30021.3s 3055 Total runtime: 0.64 seconds.
30021.3s 3056 [REWARD_MICROSCOPE] step=13905 t=3375.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30021.3s 3057 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30021.3s 3058 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30021.3s 3059 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30021.3s 3060 Running simulation until t = 3390.00 s, outputting every 15.00 s
30021.3s 3061 
30021.4s 3062 [PROGRESS] Step 15950: t=3376.06/3390.00s (99.6%) | dt=0.2124s
30021.4s 3063 [WARNING] Automatic CFL correction applied (count: 3303200):
30021.4s 3064 Calculated CFL: 0.800 > Limit: 0.500
30021.4s 3065 Original dt: 3.397169e-01 s
30021.4s 3066 Corrected dt: 2.123230e-01 s
30021.4s 3067 Correction factor: 1.6x
30021.4s 3068 Max wave speed detected: 23.55 m/s
30021.8s 3069 [PROGRESS] Step 16000: t=3386.69/3390.00s (99.9%) | dt=0.2127s
30021.9s 3070 Stored output at t = 3390.0000 s (Step 16016)
30021.9s 3071 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3375.0/3390.0 [00:00<?, ?s/s][A
30021.9s 3072 [A
30021.9s 3073 
30021.9s 3074 Simulation finished at t = 3390.0000 s after 16016 steps.
30021.9s 3075 Total runtime: 0.61 seconds.
30021.9s 3076 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.55s/s]
30021.9s 3077 [REWARD_MICROSCOPE] step=13906 t=3390.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30021.9s 3078 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30021.9s 3079 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30021.9s 3080 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30021.9s 3081 Running simulation until t = 3405.00 s, outputting every 15.00 s
30021.9s 3082 
30022.2s 3083 [PROGRESS] Step 16050: t=3397.24/3405.00s (99.8%) | dt=0.2131s
30022.3s 3084 [WARNING] Automatic CFL correction applied (count: 3303300):
30022.3s 3085 Calculated CFL: 0.800 > Limit: 0.500
30022.3s 3086 Original dt: 3.410795e-01 s
30022.3s 3087 Corrected dt: 2.131747e-01 s
30022.3s 3088 Correction factor: 1.6x
30022.3s 3089 Max wave speed detected: 23.45 m/s
30022.5s 3090 Stored output at t = 3405.0000 s (Step 16087)
30022.5s 3091 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3390.0/3405.0 [00:00<?, ?s/s][A
30022.5s 3092 [A
30022.5s 3093 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.57s/s]
30022.5s 3094 
30022.5s 3095 Simulation finished at t = 3405.0000 s after 16087 steps.
30022.5s 3096 Total runtime: 0.61 seconds.
30022.5s 3097 [REWARD_MICROSCOPE] step=13907 t=3405.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30022.5s 3098 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30022.5s 3099 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30022.5s 3100 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30022.5s 3101 Running simulation until t = 3420.00 s, outputting every 15.00 s
30022.5s 3102 
30022.7s 3103 [PROGRESS] Step 16100: t=3407.76/3420.00s (99.6%) | dt=0.2123s
30023.1s 3104 [PROGRESS] Step 16150: t=3418.39/3420.00s (100.0%) | dt=0.2128s
30023.1s 3105 [PERIODIC:1000] BC_DISPATCHER [Call #13214000] current_bc_params: <class 'dict'>
30023.1s 3106 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30023.1s 3107 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30023.1s 3108 [PERIODIC:1000] BC_GPU [Call #13214000] About to launch kernel
30023.1s 3109 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30023.1s 3110 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30023.1s 3111 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30023.1s 3112 [WARNING] Automatic CFL correction applied (count: 3303400):
30023.1s 3113 Calculated CFL: 0.800 > Limit: 0.500
30023.1s 3114 Original dt: 3.405090e-01 s
30023.1s 3115 Corrected dt: 2.128181e-01 s
30023.1s 3116 Correction factor: 1.6x
30023.1s 3117 Max wave speed detected: 23.49 m/s
30023.2s 3118 Stored output at t = 3420.0000 s (Step 16158)
30023.2s 3119 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3405.0/3420.0 [00:00<?, ?s/s][A
30023.2s 3120 [A
30023.2s 3121 
30023.2s 3122 Simulation finished at t = 3420.0000 s after 16158 steps.
30023.2s 3123 Total runtime: 0.63 seconds.
30023.2s 3124 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 23.98s/s]
30023.2s 3125 [REWARD_MICROSCOPE] step=13908 t=3420.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30023.2s 3126 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30023.2s 3127 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30023.2s 3128 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30023.2s 3129 Running simulation until t = 3435.00 s, outputting every 15.00 s
30023.2s 3130 
30023.5s 3131 [PROGRESS] Step 16200: t=3428.95/3435.00s (99.8%) | dt=0.2132s
30023.8s 3132 Stored output at t = 3435.0000 s (Step 16229)
30023.8s 3133 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3420.0/3435.0 [00:00<?, ?s/s][A
30023.8s 3134 [A
30023.8s 3135 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.68s/s]
30023.8s 3136 
30023.8s 3137 Simulation finished at t = 3435.0000 s after 16229 steps.
30023.8s 3138 Total runtime: 0.61 seconds.
30023.8s 3139 [REWARD_MICROSCOPE] step=13909 t=3435.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30023.8s 3140 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30023.8s 3141 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30023.8s 3142 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30023.8s 3143 Running simulation until t = 3450.00 s, outputting every 15.00 s
30023.8s 3144 
30024.0s 3145 [PROGRESS] Step 16250: t=3439.46/3450.00s (99.7%) | dt=0.2124s
30024.0s 3146 [WARNING] Automatic CFL correction applied (count: 3303500):
30024.0s 3147 Calculated CFL: 0.800 > Limit: 0.500
30024.0s 3148 Original dt: 3.399193e-01 s
30024.0s 3149 Corrected dt: 2.124495e-01 s
30024.0s 3150 Correction factor: 1.6x
30024.0s 3151 Max wave speed detected: 23.53 m/s
30024.4s 3152 [PROGRESS] Step 16300: t=3450.00/3450.00s (100.0%) | dt=0.1218s
30024.4s 3153 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3435.0/3450.0 [00:00<?, ?s/s][A
30024.4s 3154 [A
30024.4s 3155 Stored output at t = 3450.0000 s (Step 16300)
30024.4s 3156 
30024.4s 3157 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 24.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 24.81s/s]
30024.4s 3158 Simulation finished at t = 3450.0000 s after 16300 steps.
30024.4s 3159 Total runtime: 0.61 seconds.
30024.4s 3160 [REWARD_MICROSCOPE] step=13910 t=3450.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30024.4s 3161 [STEP  230] t= 3450.0s | phase=1 | reward=   0.01 | total_reward=    2.37
30024.4s 3162 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30024.4s 3163 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30024.4s 3164 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30024.4s 3165 Running simulation until t = 3465.00 s, outputting every 15.00 s
30024.4s 3166 
30024.8s 3167 [PROGRESS] Step 16350: t=3460.65/3465.00s (99.9%) | dt=0.2133s
30024.9s 3168 [WARNING] Automatic CFL correction applied (count: 3303600):
30024.9s 3169 Calculated CFL: 0.800 > Limit: 0.500
30024.9s 3170 Original dt: 3.411066e-01 s
30024.9s 3171 Corrected dt: 2.131916e-01 s
30024.9s 3172 Correction factor: 1.6x
30024.9s 3173 Max wave speed detected: 23.45 m/s
30025.0s 3174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3450.0/3465.0 [00:00<?, ?s/s][A
30025.0s 3175 [A
30025.0s 3176 Stored output at t = 3465.0000 s (Step 16371)
30025.0s 3177 
30025.0s 3178 Simulation finished at t = 3465.0000 s after 16371 steps.
30025.0s 3179 Total runtime: 0.62 seconds.
30025.0s 3180 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.26s/s]
30025.0s 3181 [QUEUE_DIAGNOSTIC] ===== Step 230 t=3465.0s =====
30025.0s 3182 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30025.0s 3183 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30025.0s 3184 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30025.0s 3185 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30025.0s 3186 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30025.0s 3187 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30025.0s 3188 1.6692446e-05]
30025.0s 3189 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30025.0s 3190 2.3782164e-05]
30025.0s 3191 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30025.0s 3192 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30025.0s 3193 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30025.0s 3194 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30025.0s 3195 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30025.0s 3196 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30025.0s 3197 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30025.0s 3198 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30025.0s 3199 [REWARD_MICROSCOPE] step=13911 t=3465.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30025.0s 3200 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30025.0s 3201 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30025.0s 3202 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30025.0s 3203 Running simulation until t = 3480.00 s, outputting every 15.00 s
30025.0s 3204 
30025.3s 3205 [PROGRESS] Step 16400: t=3471.16/3480.00s (99.7%) | dt=0.2125s
30025.3s 3206 [PERIODIC:1000] BC_DISPATCHER [Call #13215000] current_bc_params: <class 'dict'>
30025.3s 3207 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30025.3s 3208 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30025.3s 3209 [PERIODIC:1000] BC_GPU [Call #13215000] About to launch kernel
30025.3s 3210 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30025.3s 3211 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30025.3s 3212 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30025.6s 3213 Stored output at t = 3480.0000 s (Step 16442)
30025.6s 3214 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3465.0/3480.0 [00:00<?, ?s/s][A
30025.6s 3215 [A
30025.6s 3216 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.53s/s]
30025.6s 3217 
30025.6s 3218 Simulation finished at t = 3480.0000 s after 16442 steps.
30025.6s 3219 Total runtime: 0.61 seconds.
30025.6s 3220 [REWARD_MICROSCOPE] step=13912 t=3480.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30025.6s 3221 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30025.6s 3222 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30025.6s 3223 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30025.6s 3224 Running simulation until t = 3495.00 s, outputting every 15.00 s
30025.6s 3225 
30025.7s 3226 [PROGRESS] Step 16450: t=3481.70/3495.00s (99.6%) | dt=0.2129s
30025.7s 3227 [WARNING] Automatic CFL correction applied (count: 3303700):
30025.7s 3228 Calculated CFL: 0.800 > Limit: 0.500
30025.7s 3229 Original dt: 3.407212e-01 s
30025.7s 3230 Corrected dt: 2.129508e-01 s
30025.7s 3231 Correction factor: 1.6x
30025.7s 3232 Max wave speed detected: 23.48 m/s
30026.1s 3233 [PROGRESS] Step 16500: t=3492.36/3495.00s (99.9%) | dt=0.2133s
30026.2s 3234 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3480.0/3495.0 [00:00<?, ?s/s][A
30026.2s 3235 [A
30026.2s 3236 Stored output at t = 3495.0000 s (Step 16513)
30026.2s 3237 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.34s/s]
30026.2s 3238 
30026.2s 3239 Simulation finished at t = 3495.0000 s after 16513 steps.
30026.2s 3240 Total runtime: 0.62 seconds.
30026.3s 3241 [REWARD_MICROSCOPE] step=13913 t=3495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30026.3s 3242 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30026.3s 3243 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30026.3s 3244 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30026.3s 3245 Running simulation until t = 3510.00 s, outputting every 15.00 s
30026.3s 3246 
30026.6s 3247 [PROGRESS] Step 16550: t=3502.90/3510.00s (99.8%) | dt=0.2137s
30026.6s 3248 [WARNING] Automatic CFL correction applied (count: 3303800):
30026.6s 3249 Calculated CFL: 0.800 > Limit: 0.500
30026.6s 3250 Original dt: 3.420419e-01 s
30026.6s 3251 Corrected dt: 2.137762e-01 s
30026.6s 3252 Correction factor: 1.6x
30026.6s 3253 Max wave speed detected: 23.39 m/s
30026.9s 3254 Stored output at t = 3510.0000 s (Step 16584)
30026.9s 3255 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3495.0/3510.0 [00:00<?, ?s/s][A
30026.9s 3256 [A
30026.9s 3257 
30026.9s 3258 Simulation finished at t = 3510.0000 s after 16584 steps.
30026.9s 3259 Total runtime: 0.61 seconds.
30026.9s 3260 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.55s/s]
30026.9s 3261 [REWARD_MICROSCOPE] step=13914 t=3510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30026.9s 3262 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30026.9s 3263 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30026.9s 3264 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30026.9s 3265 Running simulation until t = 3525.00 s, outputting every 15.00 s
30026.9s 3266 
30027.0s 3267 [PROGRESS] Step 16600: t=3513.43/3525.00s (99.7%) | dt=0.2149s
30027.4s 3268 [PROGRESS] Step 16650: t=3524.26/3525.00s (100.0%) | dt=0.2181s
30027.4s 3269 [PERIODIC:1000] BC_DISPATCHER [Call #13216000] current_bc_params: <class 'dict'>
30027.4s 3270 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30027.4s 3271 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30027.4s 3272 [PERIODIC:1000] BC_GPU [Call #13216000] About to launch kernel
30027.4s 3273 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30027.4s 3274 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30027.4s 3275 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30027.5s 3276 Stored output at t = 3525.0000 s (Step 16654)
30027.5s 3277 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3510.0/3525.0 [00:00<?, ?s/s][A
30027.5s 3278 [A
30027.5s 3279 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.76s/s]
30027.5s 3280 
30027.5s 3281 Simulation finished at t = 3525.0000 s after 16654 steps.
30027.5s 3282 Total runtime: 0.61 seconds.
30027.5s 3283 [REWARD_MICROSCOPE] step=13915 t=3525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30027.5s 3284 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30027.5s 3285 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30027.5s 3286 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30027.5s 3287 Running simulation until t = 3540.00 s, outputting every 15.00 s
30027.5s 3288 
30027.5s 3289 [WARNING] Automatic CFL correction applied (count: 3303900):
30027.5s 3290 Calculated CFL: 0.800 > Limit: 0.500
30027.5s 3291 Original dt: 3.492739e-01 s
30027.5s 3292 Corrected dt: 2.182962e-01 s
30027.5s 3293 Correction factor: 1.6x
30027.5s 3294 Max wave speed detected: 22.90 m/s
30027.9s 3295 [PROGRESS] Step 16700: t=3535.07/3540.00s (99.9%) | dt=0.2192s
30028.1s 3296 Stored output at t = 3540.0000 s (Step 16723)
30028.1s 3297 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3525.0/3540.0 [00:00<?, ?s/s][A
30028.1s 3298 [A
30028.1s 3299 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.81s/s]
30028.1s 3300 
30028.1s 3301 Simulation finished at t = 3540.0000 s after 16723 steps.
30028.1s 3302 Total runtime: 0.60 seconds.
30028.1s 3303 [REWARD_MICROSCOPE] step=13916 t=3540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30028.1s 3304 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30028.1s 3305 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30028.1s 3306 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30028.1s 3307 Running simulation until t = 3555.00 s, outputting every 15.00 s
30028.1s 3308 
30028.3s 3309 [PROGRESS] Step 16750: t=3545.92/3555.00s (99.7%) | dt=0.2194s
30028.4s 3310 [WARNING] Automatic CFL correction applied (count: 3304000):
30028.4s 3311 Calculated CFL: 0.800 > Limit: 0.500
30028.4s 3312 Original dt: 3.510669e-01 s
30028.4s 3313 Corrected dt: 2.194168e-01 s
30028.4s 3314 Correction factor: 1.6x
30028.4s 3315 Max wave speed detected: 22.79 m/s
30028.7s 3316 Stored output at t = 3555.0000 s (Step 16792)
30028.7s 3317 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3540.0/3555.0 [00:00<?, ?s/s][A
30028.7s 3318 [A
30028.7s 3319 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 25.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 25.34s/s]
30028.7s 3320 
30028.7s 3321 Simulation finished at t = 3555.0000 s after 16792 steps.
30028.7s 3322 Total runtime: 0.59 seconds.
30028.7s 3323 [REWARD_MICROSCOPE] step=13917 t=3555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30028.7s 3324 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30028.7s 3325 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30028.7s 3326 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30028.7s 3327 Running simulation until t = 3570.00 s, outputting every 15.00 s
30028.7s 3328 
30028.7s 3329 [PROGRESS] Step 16800: t=3556.76/3570.00s (99.6%) | dt=0.2195s
30029.2s 3330 [PROGRESS] Step 16850: t=3567.73/3570.00s (99.9%) | dt=0.2195s
30029.2s 3331 [WARNING] Automatic CFL correction applied (count: 3304100):
30029.2s 3332 Calculated CFL: 0.800 > Limit: 0.500
30029.2s 3333 Original dt: 3.511690e-01 s
30029.2s 3334 Corrected dt: 2.194806e-01 s
30029.2s 3335 Correction factor: 1.6x
30029.2s 3336 Max wave speed detected: 22.78 m/s
30029.3s 3337 Stored output at t = 3570.0000 s (Step 16861)
30029.3s 3338 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3555.0/3570.0 [00:00<?, ?s/s][A
30029.3s 3339 [A
30029.3s 3340 
30029.3s 3341 Simulation finished at t = 3570.0000 s after 16861 steps.
30029.3s 3342 Total runtime: 0.61 seconds.
30029.3s 3343 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.54s/s]
30029.3s 3344 [REWARD_MICROSCOPE] step=13918 t=3570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30029.3s 3345 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30029.3s 3346 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30029.3s 3347 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30029.3s 3348 Running simulation until t = 3585.00 s, outputting every 15.00 s
30029.3s 3349 
30029.6s 3350 [PROGRESS] Step 16900: t=3578.56/3585.00s (99.8%) | dt=0.2195s
30029.6s 3351 [PERIODIC:1000] BC_DISPATCHER [Call #13217000] current_bc_params: <class 'dict'>
30029.6s 3352 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30029.6s 3353 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30029.6s 3354 [PERIODIC:1000] BC_GPU [Call #13217000] About to launch kernel
30029.6s 3355 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30029.6s 3356 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30029.6s 3357 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30029.9s 3358 Stored output at t = 3585.0000 s (Step 16930)
30029.9s 3359 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3570.0/3585.0 [00:00<?, ?s/s][A
30029.9s 3360 [A
30029.9s 3361 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.62s/s]
30029.9s 3362 
30029.9s 3363 Simulation finished at t = 3585.0000 s after 16930 steps.
30029.9s 3364 Total runtime: 0.64 seconds.
30029.9s 3365 [REWARD_MICROSCOPE] step=13919 t=3585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30029.9s 3366 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30029.9s 3367 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30029.9s 3368 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30029.9s 3369 Running simulation until t = 3600.00 s, outputting every 15.00 s
30029.9s 3370 
30030.1s 3371 [PROGRESS] Step 16950: t=3589.39/3600.00s (99.7%) | dt=0.2195s
30030.2s 3372 [WARNING] Automatic CFL correction applied (count: 3304200):
30030.2s 3373 Calculated CFL: 0.800 > Limit: 0.500
30030.2s 3374 Original dt: 3.511794e-01 s
30030.2s 3375 Corrected dt: 2.194871e-01 s
30030.2s 3376 Correction factor: 1.6x
30030.2s 3377 Max wave speed detected: 22.78 m/s
30030.5s 3378 Stored output at t = 3600.0000 s (Step 16999)
30030.5s 3379 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3585.0/3600.0 [00:00<?, ?s/s][A
30030.5s 3380 [A
30030.5s 3381 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.60s/s]
30030.5s 3382 
30030.5s 3383 Simulation finished at t = 3600.0000 s after 16999 steps.
30030.5s 3384 Total runtime: 0.61 seconds.
30030.5s 3385 [REWARD_MICROSCOPE] step=13920 t=3600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30030.5s 3386 [STEP  240] t= 3600.0s | phase=1 | reward=   0.00 | total_reward=    2.45
30030.5s 3387 DEBUG: Truncation - runner.t=3600.0, episode_max_time=3600.0
30030.5s 3388 
30030.5s 3389 ================================================================================
30030.5s 3390 [EPISODE END] Steps: 240 | Duration: 3600.0s | Total Reward: 2.45 | Avg Reward/Step: 0.010
30030.5s 3391 ================================================================================
30030.5s 3392 
30030.5s 3393 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30030.5s 3394 Using device: gpu
30030.6s 3395 DEBUG PARAMS: Reading K_m_kmh = 10.0
30030.6s 3396 DEBUG PARAMS: Reading K_c_kmh = 15.0
30030.6s 3397 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30030.6s 3398 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30030.6s 3399 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30030.6s 3400 V0_m = 13.333 m/s (48.0 km/h)
30030.6s 3401 V0_c = 11.667 m/s (42.0 km/h)
30030.6s 3402 Parameters loaded for scenario: adaptive_speed_control
30030.6s 3403 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30030.6s 3404 Loading road quality type: uniform
30030.6s 3405 Uniform road quality value: 1
30030.6s 3406 Road quality loaded.
30030.6s 3407 Initial state created.
30030.6s 3408 Transferring initial state and road quality to GPU...
30030.6s 3409 GPU data transfer complete.
30030.6s 3410 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30030.6s 3411 Initial boundary conditions applied.
30030.6s 3412 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30030.6s 3413 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30030.6s 3414 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30030.6s 3415 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30030.6s 3416 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30030.6s 3417 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30030.6s 3418 Running simulation until t = 15.00 s, outputting every 15.00 s
30030.6s 3419 
30031.0s 3420 [PROGRESS] Step 50: t=13.88/15.00s (92.6%) | dt=0.2304s
30031.1s 3421 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30031.1s 3422 [A
30031.1s 3423 Stored output at t = 15.0000 s (Step 55)
30031.1s 3424 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 29.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 29.53s/s]
30031.1s 3425 
30031.1s 3426 Simulation finished at t = 15.0000 s after 55 steps.
30031.1s 3427 Total runtime: 0.51 seconds.
30031.1s 3428 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30031.1s 3429 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30031.1s 3430 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01592309 1.         0.04031418 1.        ] (rho_m, v_m, rho_c, v_c)
30031.1s 3431 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30031.1s 3432 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30031.1s 3433 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30031.1s 3434 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00477693 0.00461974 0.0045987  0.00461509 0.00464349 0.00467782]
30031.1s 3435 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00604713 0.0058468  0.0058367  0.00589007 0.00596703 0.00605711]
30031.1s 3436 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30031.1s 3437 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30031.1s 3438 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30031.1s 3439 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30031.1s 3440 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30031.1s 3441 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30031.1s 3442 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30031.1s 3443 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30031.1s 3444 [REWARD_MICROSCOPE] step=13921 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=-0.0100
30031.1s 3445 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30031.1s 3446 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30031.1s 3447 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30031.1s 3448 Running simulation until t = 30.00 s, outputting every 15.00 s
30031.1s 3449 
30031.1s 3450 [WARNING] Automatic CFL correction applied (count: 3304300):
30031.1s 3451 Calculated CFL: 0.800 > Limit: 0.500
30031.1s 3452 Original dt: 3.642366e-01 s
30031.1s 3453 Corrected dt: 2.276479e-01 s
30031.1s 3454 Correction factor: 1.6x
30031.1s 3455 Max wave speed detected: 21.96 m/s
30031.5s 3456 [PROGRESS] Step 100: t=25.06/30.00s (83.5%) | dt=0.2211s
30031.7s 3457 Stored output at t = 30.0000 s (Step 123)
30031.7s 3458 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30031.7s 3459 [A
30031.7s 3460 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 25.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 25.37s/s]
30031.7s 3461 
30031.7s 3462 Simulation finished at t = 30.0000 s after 123 steps.
30031.7s 3463 Total runtime: 0.59 seconds.
30031.7s 3464 [REWARD_MICROSCOPE] step=13922 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30031.7s 3465 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30031.7s 3466 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30031.7s 3467 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30031.7s 3468 Running simulation until t = 45.00 s, outputting every 15.00 s
30031.7s 3469 
30031.9s 3470 [PROGRESS] Step 150: t=35.94/45.00s (79.9%) | dt=0.2198s
30031.9s 3471 [PERIODIC:1000] BC_DISPATCHER [Call #13218000] current_bc_params: <class 'dict'>
30031.9s 3472 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30031.9s 3473 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30031.9s 3474 [PERIODIC:1000] BC_GPU [Call #13218000] About to launch kernel
30031.9s 3475 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30031.9s 3476 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30031.9s 3477 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30032.0s 3478 [WARNING] Automatic CFL correction applied (count: 3304400):
30032.0s 3479 Calculated CFL: 0.800 > Limit: 0.500
30032.0s 3480 Original dt: 3.516074e-01 s
30032.0s 3481 Corrected dt: 2.197546e-01 s
30032.0s 3482 Correction factor: 1.6x
30032.0s 3483 Max wave speed detected: 22.75 m/s
30032.3s 3484 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30032.3s 3485 Stored output at t = 45.0000 s (Step 192)
30032.3s 3486 [A
30032.3s 3487 
30032.3s 3488 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.83s/s]
30032.3s 3489 Simulation finished at t = 45.0000 s after 192 steps.
30032.3s 3490 Total runtime: 0.60 seconds.
30032.3s 3491 [REWARD_MICROSCOPE] step=13923 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30032.3s 3492 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30032.3s 3493 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30032.3s 3494 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30032.3s 3495 Running simulation until t = 60.00 s, outputting every 15.00 s
30032.3s 3496 
30032.3s 3497 [PROGRESS] Step 200: t=46.76/60.00s (77.9%) | dt=0.2196s
30032.8s 3498 [PROGRESS] Step 250: t=57.73/60.00s (96.2%) | dt=0.2195s
30032.8s 3499 [WARNING] Automatic CFL correction applied (count: 3304500):
30032.8s 3500 Calculated CFL: 0.800 > Limit: 0.500
30032.8s 3501 Original dt: 3.512166e-01 s
30032.8s 3502 Corrected dt: 2.195104e-01 s
30032.8s 3503 Correction factor: 1.6x
30032.8s 3504 Max wave speed detected: 22.78 m/s
30032.9s 3505 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30032.9s 3506 [A
30032.9s 3507 Stored output at t = 60.0000 s (Step 261)
30032.9s 3508 
30032.9s 3509 Simulation finished at t = 60.0000 s after 261 steps.
30032.9s 3510 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.89s/s]
30032.9s 3511 Total runtime: 0.60 seconds.
30032.9s 3512 [REWARD_MICROSCOPE] step=13924 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30032.9s 3513 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30032.9s 3514 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30032.9s 3515 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30032.9s 3516 Running simulation until t = 75.00 s, outputting every 15.00 s
30032.9s 3517 
30033.2s 3518 [PROGRESS] Step 300: t=68.56/75.00s (91.4%) | dt=0.2195s
30033.5s 3519 Stored output at t = 75.0000 s (Step 330)
30033.5s 3520 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30033.5s 3521 [A
30033.5s 3522 
30033.5s 3523 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.38s/s]
30033.5s 3524 Simulation finished at t = 75.0000 s after 330 steps.
30033.5s 3525 Total runtime: 0.62 seconds.
30033.5s 3526 [REWARD_MICROSCOPE] step=13925 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30033.5s 3527 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30033.5s 3528 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30033.5s 3529 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30033.5s 3530 Running simulation until t = 90.00 s, outputting every 15.00 s
30033.5s 3531 
30033.7s 3532 [PROGRESS] Step 350: t=79.39/90.00s (88.2%) | dt=0.2195s
30033.7s 3533 [WARNING] Automatic CFL correction applied (count: 3304600):
30033.7s 3534 Calculated CFL: 0.800 > Limit: 0.500
30033.7s 3535 Original dt: 3.511851e-01 s
30033.7s 3536 Corrected dt: 2.194907e-01 s
30033.7s 3537 Correction factor: 1.6x
30033.7s 3538 Max wave speed detected: 22.78 m/s
30034.1s 3539 Stored output at t = 90.0000 s (Step 399)
30034.1s 3540 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30034.1s 3541 [A
30034.1s 3542 
30034.1s 3543 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.77s/s]
30034.1s 3544 Simulation finished at t = 90.0000 s after 399 steps.
30034.1s 3545 Total runtime: 0.61 seconds.
30034.1s 3546 [REWARD_MICROSCOPE] step=13926 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30034.1s 3547 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30034.1s 3548 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30034.1s 3549 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30034.1s 3550 Running simulation until t = 105.00 s, outputting every 15.00 s
30034.1s 3551 
30034.1s 3552 [PROGRESS] Step 400: t=90.22/105.00s (85.9%) | dt=0.2195s
30034.1s 3553 [PERIODIC:1000] BC_DISPATCHER [Call #13219000] current_bc_params: <class 'dict'>
30034.1s 3554 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30034.1s 3555 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30034.1s 3556 [PERIODIC:1000] BC_GPU [Call #13219000] About to launch kernel
30034.1s 3557 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30034.1s 3558 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30034.1s 3559 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30034.6s 3560 [PROGRESS] Step 450: t=101.19/105.00s (96.4%) | dt=0.2195s
30034.6s 3561 [WARNING] Automatic CFL correction applied (count: 3304700):
30034.6s 3562 Calculated CFL: 0.800 > Limit: 0.500
30034.6s 3563 Original dt: 3.511813e-01 s
30034.6s 3564 Corrected dt: 2.194883e-01 s
30034.6s 3565 Correction factor: 1.6x
30034.6s 3566 Max wave speed detected: 22.78 m/s
30034.7s 3567 Stored output at t = 105.0000 s (Step 468)
30034.7s 3568 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30034.7s 3569 [A
30034.7s 3570 
30034.7s 3571 Simulation finished at t = 105.0000 s after 468 steps.
30034.7s 3572 Total runtime: 0.61 seconds.
30034.7s 3573 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.76s/s]
30034.7s 3574 [REWARD_MICROSCOPE] step=13927 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30034.7s 3575 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30034.7s 3576 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30034.7s 3577 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30034.7s 3578 Running simulation until t = 120.00 s, outputting every 15.00 s
30034.7s 3579 
30035.0s 3580 [PROGRESS] Step 500: t=112.02/120.00s (93.4%) | dt=0.2195s
30035.3s 3581 Stored output at t = 120.0000 s (Step 537)
30035.3s 3582 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30035.3s 3583 [A
30035.3s 3584 
30035.3s 3585 Simulation finished at t = 120.0000 s after 537 steps.
30035.3s 3586 Total runtime: 0.61 seconds.
30035.3s 3587 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.49s/s]
30035.3s 3588 [REWARD_MICROSCOPE] step=13928 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30035.3s 3589 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30035.3s 3590 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30035.3s 3591 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30035.3s 3592 Running simulation until t = 135.00 s, outputting every 15.00 s
30035.3s 3593 
30035.5s 3594 [PROGRESS] Step 550: t=122.85/135.00s (91.0%) | dt=0.2192s
30035.5s 3595 [WARNING] Automatic CFL correction applied (count: 3304800):
30035.5s 3596 Calculated CFL: 0.800 > Limit: 0.500
30035.5s 3597 Original dt: 3.484923e-01 s
30035.5s 3598 Corrected dt: 2.178077e-01 s
30035.5s 3599 Correction factor: 1.6x
30035.5s 3600 Max wave speed detected: 22.96 m/s
30035.9s 3601 [PROGRESS] Step 600: t=133.61/135.00s (99.0%) | dt=0.2128s
30035.9s 3602 Stored output at t = 135.0000 s (Step 607)
30035.9s 3603 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30035.9s 3604 [A
30035.9s 3605 
30035.9s 3606 Simulation finished at t = 135.0000 s after 607 steps.
30035.9s 3607 Total runtime: 0.61 seconds.
30035.9s 3608 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.78s/s]
30035.9s 3609 [REWARD_MICROSCOPE] step=13929 t=135.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30035.9s 3610 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30035.9s 3611 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30035.9s 3612 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30035.9s 3613 Running simulation until t = 150.00 s, outputting every 15.00 s
30035.9s 3614 
30036.3s 3615 [PROGRESS] Step 650: t=144.14/150.00s (96.1%) | dt=0.2126s
30036.3s 3616 [PERIODIC:1000] BC_DISPATCHER [Call #13220000] current_bc_params: <class 'dict'>
30036.3s 3617 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30036.3s 3618 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30036.3s 3619 [PERIODIC:1000] BC_GPU [Call #13220000] About to launch kernel
30036.3s 3620 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30036.3s 3621 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30036.3s 3622 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30036.4s 3623 [WARNING] Automatic CFL correction applied (count: 3304900):
30036.4s 3624 Calculated CFL: 0.800 > Limit: 0.500
30036.4s 3625 Original dt: 3.403036e-01 s
30036.4s 3626 Corrected dt: 2.126897e-01 s
30036.4s 3627 Correction factor: 1.6x
30036.4s 3628 Max wave speed detected: 23.51 m/s
30036.6s 3629 Stored output at t = 150.0000 s (Step 678)
30036.6s 3630 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30036.6s 3631 [A
30036.6s 3632 
30036.6s 3633 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.60s/s]
30036.6s 3634 Simulation finished at t = 150.0000 s after 678 steps.
30036.6s 3635 Total runtime: 0.61 seconds.
30036.6s 3636 [REWARD_MICROSCOPE] step=13930 t=150.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30036.6s 3637 [STEP   10] t=  150.0s | phase=1 | reward=   0.01 | total_reward=    0.01
30036.6s 3638 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30036.6s 3639 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30036.6s 3640 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30036.6s 3641 Running simulation until t = 165.00 s, outputting every 15.00 s
30036.6s 3642 
30036.8s 3643 [PROGRESS] Step 700: t=154.69/165.00s (93.7%) | dt=0.2131s
30037.2s 3644 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30037.2s 3645 [A
30037.2s 3646 Stored output at t = 165.0000 s (Step 749)
30037.2s 3647 
30037.2s 3648 Simulation finished at t = 165.0000 s after 749 steps.
30037.2s 3649 Total runtime: 0.62 seconds.
30037.2s 3650 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.05s/s]
30037.2s 3651 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30037.2s 3652 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30037.2s 3653 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.240823e-05 1.000000e+00 2.051358e-04 1.000000e+00] (rho_m, v_m, rho_c, v_c)
30037.2s 3654 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30037.2s 3655 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30037.2s 3656 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30037.2s 3657 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722470e-05 1.7252056e-05 1.6842589e-05 1.6724847e-05 1.6694894e-05
30037.2s 3658 1.6692395e-05]
30037.2s 3659 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770370e-05 2.6355670e-05 2.4787523e-05 2.4167104e-05 2.3899143e-05
30037.2s 3660 2.3778544e-05]
30037.2s 3661 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30037.2s 3662 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30037.2s 3663 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30037.2s 3664 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30037.2s 3665 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30037.2s 3666 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30037.2s 3667 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30037.2s 3668 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30037.2s 3669 [REWARD_MICROSCOPE] step=13931 t=165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30037.2s 3670 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30037.2s 3671 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30037.2s 3672 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30037.2s 3673 Running simulation until t = 180.00 s, outputting every 15.00 s
30037.2s 3674 
30037.2s 3675 [PROGRESS] Step 750: t=165.21/180.00s (91.8%) | dt=0.2125s
30037.3s 3676 [WARNING] Automatic CFL correction applied (count: 3305000):
30037.3s 3677 Calculated CFL: 0.800 > Limit: 0.500
30037.3s 3678 Original dt: 3.397690e-01 s
30037.3s 3679 Corrected dt: 2.123556e-01 s
30037.3s 3680 Correction factor: 1.6x
30037.3s 3681 Max wave speed detected: 23.55 m/s
30037.6s 3682 [PROGRESS] Step 800: t=175.84/180.00s (97.7%) | dt=0.2127s
30037.8s 3683 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30037.8s 3684 [A
30037.8s 3685 Stored output at t = 180.0000 s (Step 820)
30037.8s 3686 
30037.8s 3687 Simulation finished at t = 180.0000 s after 820 steps.
30037.8s 3688 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 23.97s/s]
30037.8s 3689 Total runtime: 0.63 seconds.
30037.8s 3690 [REWARD_MICROSCOPE] step=13932 t=180.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30037.8s 3691 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30037.8s 3692 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30037.8s 3693 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30037.8s 3694 Running simulation until t = 195.00 s, outputting every 15.00 s
30037.8s 3695 
30038.1s 3696 [PROGRESS] Step 850: t=186.39/195.00s (95.6%) | dt=0.2131s
30038.1s 3697 [WARNING] Automatic CFL correction applied (count: 3305100):
30038.1s 3698 Calculated CFL: 0.800 > Limit: 0.500
30038.1s 3699 Original dt: 3.410408e-01 s
30038.1s 3700 Corrected dt: 2.131505e-01 s
30038.1s 3701 Correction factor: 1.6x
30038.1s 3702 Max wave speed detected: 23.46 m/s
30038.4s 3703 Stored output at t = 195.0000 s (Step 891)
30038.4s 3704 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30038.4s 3705 [A
30038.4s 3706 
30038.4s 3707 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.44s/s]
30038.4s 3708 Simulation finished at t = 195.0000 s after 891 steps.
30038.4s 3709 Total runtime: 0.61 seconds.
30038.4s 3710 [REWARD_MICROSCOPE] step=13933 t=195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30038.4s 3711 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30038.4s 3712 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30038.4s 3713 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30038.4s 3714 Running simulation until t = 210.00 s, outputting every 15.00 s
30038.4s 3715 
30038.5s 3716 [PROGRESS] Step 900: t=196.91/210.00s (93.8%) | dt=0.2123s
30038.5s 3717 [PERIODIC:1000] BC_DISPATCHER [Call #13221000] current_bc_params: <class 'dict'>
30038.5s 3718 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30038.5s 3719 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30038.5s 3720 [PERIODIC:1000] BC_GPU [Call #13221000] About to launch kernel
30038.5s 3721 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30038.5s 3722 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30038.5s 3723 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30038.9s 3724 [PROGRESS] Step 950: t=207.51/210.00s (98.8%) | dt=0.2119s
30039.0s 3725 [WARNING] Automatic CFL correction applied (count: 3305200):
30039.0s 3726 Calculated CFL: 0.800 > Limit: 0.500
30039.0s 3727 Original dt: 3.389562e-01 s
30039.0s 3728 Corrected dt: 2.118477e-01 s
30039.0s 3729 Correction factor: 1.6x
30039.0s 3730 Max wave speed detected: 23.60 m/s
30039.1s 3731 Stored output at t = 210.0000 s (Step 962)
30039.1s 3732 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30039.1s 3733 [A
30039.1s 3734 
30039.1s 3735 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.36s/s]
30039.1s 3736 Simulation finished at t = 210.0000 s after 962 steps.
30039.1s 3737 Total runtime: 0.62 seconds.
30039.1s 3738 [REWARD_MICROSCOPE] step=13934 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30039.1s 3739 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30039.1s 3740 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30039.1s 3741 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30039.1s 3742 Running simulation until t = 225.00 s, outputting every 15.00 s
30039.1s 3743 
30039.4s 3744 [PROGRESS] Step 1000: t=218.05/225.00s (96.9%) | dt=0.2118s
30039.7s 3745 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30039.7s 3746 [A
30039.7s 3747 Stored output at t = 225.0000 s (Step 1033)
30039.7s 3748 
30039.7s 3749 Simulation finished at t = 225.0000 s after 1033 steps.
30039.7s 3750 Total runtime: 0.61 seconds.
30039.7s 3751 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.49s/s]
30039.7s 3752 [REWARD_MICROSCOPE] step=13935 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30039.7s 3753 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30039.7s 3754 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30039.7s 3755 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30039.7s 3756 Running simulation until t = 240.00 s, outputting every 15.00 s
30039.7s 3757 
30039.8s 3758 [PROGRESS] Step 1050: t=228.60/240.00s (95.3%) | dt=0.2118s
30039.9s 3759 [WARNING] Automatic CFL correction applied (count: 3305300):
30039.9s 3760 Calculated CFL: 0.800 > Limit: 0.500
30039.9s 3761 Original dt: 3.388763e-01 s
30039.9s 3762 Corrected dt: 2.117977e-01 s
30039.9s 3763 Correction factor: 1.6x
30039.9s 3764 Max wave speed detected: 23.61 m/s
30040.3s 3765 [PROGRESS] Step 1100: t=239.19/240.00s (99.7%) | dt=0.2118s
30040.3s 3766 Stored output at t = 240.0000 s (Step 1104)
30040.3s 3767 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30040.3s 3768 [A
30040.3s 3769 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.27s/s]
30040.3s 3770 
30040.3s 3771 Simulation finished at t = 240.0000 s after 1104 steps.
30040.3s 3772 Total runtime: 0.62 seconds.
30040.3s 3773 [REWARD_MICROSCOPE] step=13936 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30040.3s 3774 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30040.3s 3775 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30040.3s 3776 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30040.3s 3777 Running simulation until t = 255.00 s, outputting every 15.00 s
30040.3s 3778 
30040.7s 3779 [PROGRESS] Step 1150: t=249.74/255.00s (97.9%) | dt=0.2118s
30040.7s 3780 [PERIODIC:1000] BC_DISPATCHER [Call #13222000] current_bc_params: <class 'dict'>
30040.7s 3781 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30040.7s 3782 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30040.7s 3783 [PERIODIC:1000] BC_GPU [Call #13222000] About to launch kernel
30040.7s 3784 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30040.7s 3785 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30040.7s 3786 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30040.8s 3787 [WARNING] Automatic CFL correction applied (count: 3305400):
30040.8s 3788 Calculated CFL: 0.800 > Limit: 0.500
30040.8s 3789 Original dt: 3.388750e-01 s
30040.8s 3790 Corrected dt: 2.117969e-01 s
30040.8s 3791 Correction factor: 1.6x
30040.8s 3792 Max wave speed detected: 23.61 m/s
30040.9s 3793 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30040.9s 3794 [A
30040.9s 3795 Stored output at t = 255.0000 s (Step 1175)
30040.9s 3796 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.31s/s]
30040.9s 3797 
30040.9s 3798 Simulation finished at t = 255.0000 s after 1175 steps.
30040.9s 3799 Total runtime: 0.64 seconds.
30040.9s 3800 [REWARD_MICROSCOPE] step=13937 t=255.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30040.9s 3801 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30040.9s 3802 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30040.9s 3803 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30040.9s 3804 Running simulation until t = 270.00 s, outputting every 15.00 s
30040.9s 3805 
30041.2s 3806 [PROGRESS] Step 1200: t=260.29/270.00s (96.4%) | dt=0.2118s
30041.6s 3807 Stored output at t = 270.0000 s (Step 1246)
30041.6s 3808 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30041.6s 3809 [A
30041.6s 3810 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.25s/s]
30041.6s 3811 
30041.6s 3812 Simulation finished at t = 270.0000 s after 1246 steps.
30041.6s 3813 Total runtime: 0.62 seconds.
30041.6s 3814 [REWARD_MICROSCOPE] step=13938 t=270.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30041.6s 3815 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30041.6s 3816 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30041.6s 3817 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30041.6s 3818 Running simulation until t = 285.00 s, outputting every 15.00 s
30041.6s 3819 
30041.6s 3820 [PROGRESS] Step 1250: t=270.85/285.00s (95.0%) | dt=0.2118s
30041.7s 3821 [WARNING] Automatic CFL correction applied (count: 3305500):
30041.7s 3822 Calculated CFL: 0.800 > Limit: 0.500
30041.7s 3823 Original dt: 3.388749e-01 s
30041.7s 3824 Corrected dt: 2.117968e-01 s
30041.7s 3825 Correction factor: 1.6x
30041.7s 3826 Max wave speed detected: 23.61 m/s
30042.0s 3827 [PROGRESS] Step 1300: t=281.44/285.00s (98.7%) | dt=0.2118s
30042.2s 3828 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30042.2s 3829 [A
30042.2s 3830 Stored output at t = 285.0000 s (Step 1317)
30042.2s 3831 
30042.2s 3832 Simulation finished at t = 285.0000 s after 1317 steps.
30042.2s 3833 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.32s/s]
30042.2s 3834 Total runtime: 0.62 seconds.
30042.2s 3835 [REWARD_MICROSCOPE] step=13939 t=285.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30042.2s 3836 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30042.2s 3837 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30042.2s 3838 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30042.2s 3839 Running simulation until t = 300.00 s, outputting every 15.00 s
30042.2s 3840 
30042.5s 3841 [PROGRESS] Step 1350: t=291.99/300.00s (97.3%) | dt=0.2118s
30042.5s 3842 [WARNING] Automatic CFL correction applied (count: 3305600):
30042.5s 3843 Calculated CFL: 0.800 > Limit: 0.500
30042.5s 3844 Original dt: 3.388749e-01 s
30042.5s 3845 Corrected dt: 2.117968e-01 s
30042.5s 3846 Correction factor: 1.6x
30042.5s 3847 Max wave speed detected: 23.61 m/s
30042.8s 3848 Stored output at t = 300.0000 s (Step 1388)
30042.8s 3849 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30042.8s 3850 [A
30042.8s 3851 
30042.8s 3852 Simulation finished at t = 300.0000 s after 1388 steps.
30042.8s 3853 Total runtime: 0.63 seconds.
30042.8s 3854 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 23.73s/s]
30042.8s 3855 [REWARD_MICROSCOPE] step=13940 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30042.8s 3856 [STEP   20] t=  300.0s | phase=0 | reward=   0.00 | total_reward=    0.10
30042.8s 3857 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30042.8s 3858 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30042.8s 3859 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30042.8s 3860 Running simulation until t = 315.00 s, outputting every 15.00 s
30042.8s 3861 
30042.9s 3862 [PROGRESS] Step 1400: t=302.54/315.00s (96.0%) | dt=0.2118s
30042.9s 3863 [PERIODIC:1000] BC_DISPATCHER [Call #13223000] current_bc_params: <class 'dict'>
30042.9s 3864 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30042.9s 3865 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30042.9s 3866 [PERIODIC:1000] BC_GPU [Call #13223000] About to launch kernel
30042.9s 3867 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30042.9s 3868 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30042.9s 3869 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30043.4s 3870 [PROGRESS] Step 1450: t=313.13/315.00s (99.4%) | dt=0.2118s
30043.4s 3871 [WARNING] Automatic CFL correction applied (count: 3305700):
30043.4s 3872 Calculated CFL: 0.800 > Limit: 0.500
30043.4s 3873 Original dt: 3.388749e-01 s
30043.4s 3874 Corrected dt: 2.117968e-01 s
30043.4s 3875 Correction factor: 1.6x
30043.4s 3876 Max wave speed detected: 23.61 m/s
30043.5s 3877 Stored output at t = 315.0000 s (Step 1459)
30043.5s 3878 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30043.5s 3879 [A
30043.5s 3880 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.29s/s]
30043.5s 3881 
30043.5s 3882 Simulation finished at t = 315.0000 s after 1459 steps.
30043.5s 3883 Total runtime: 0.64 seconds.
30043.5s 3884 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30043.5s 3885 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30043.5s 3886 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2574574e-05 1.0000000e+00 2.1185164e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30043.5s 3887 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30043.5s 3888 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30043.5s 3889 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30043.5s 3890 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8772373e-05 1.7284074e-05 1.6848557e-05 1.6708431e-05 1.6662414e-05
30043.5s 3891 1.6647302e-05]
30043.5s 3892 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.1777749e-05 2.7109350e-05 2.5263538e-05 2.4433120e-05 2.4038995e-05
30043.5s 3893 2.3847178e-05]
30043.5s 3894 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30043.5s 3895 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30043.5s 3896 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30043.5s 3897 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30043.5s 3898 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30043.5s 3899 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30043.5s 3900 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30043.5s 3901 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30043.5s 3902 [REWARD_MICROSCOPE] step=13941 t=315.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30043.5s 3903 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30043.5s 3904 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30043.5s 3905 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30043.5s 3906 Running simulation until t = 330.00 s, outputting every 15.00 s
30043.5s 3907 
30043.8s 3908 [PROGRESS] Step 1500: t=323.68/330.00s (98.1%) | dt=0.2118s
30044.1s 3909 Stored output at t = 330.0000 s (Step 1530)
30044.1s 3910 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30044.1s 3911 [A
30044.1s 3912 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.04s/s]
30044.1s 3913 
30044.1s 3914 Simulation finished at t = 330.0000 s after 1530 steps.
30044.1s 3915 Total runtime: 0.62 seconds.
30044.1s 3916 [REWARD_MICROSCOPE] step=13942 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30044.1s 3917 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30044.1s 3918 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30044.1s 3919 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30044.1s 3920 Running simulation until t = 345.00 s, outputting every 15.00 s
30044.1s 3921 
30044.3s 3922 [PROGRESS] Step 1550: t=334.24/345.00s (96.9%) | dt=0.2118s
30044.3s 3923 [WARNING] Automatic CFL correction applied (count: 3305800):
30044.3s 3924 Calculated CFL: 0.800 > Limit: 0.500
30044.3s 3925 Original dt: 3.388749e-01 s
30044.3s 3926 Corrected dt: 2.117968e-01 s
30044.3s 3927 Correction factor: 1.6x
30044.3s 3928 Max wave speed detected: 23.61 m/s
30044.7s 3929 [PROGRESS] Step 1600: t=344.83/345.00s (99.9%) | dt=0.2118s
30044.7s 3930 Stored output at t = 345.0000 s (Step 1601)
30044.7s 3931 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30044.7s 3932 [A
30044.7s 3933 
30044.7s 3934 Simulation finished at t = 345.0000 s after 1601 steps.
30044.7s 3935 Total runtime: 0.63 seconds.
30044.7s 3936 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.00s/s]
30044.7s 3937 [REWARD_MICROSCOPE] step=13943 t=345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30044.7s 3938 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30044.7s 3939 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30044.7s 3940 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30044.7s 3941 Running simulation until t = 360.00 s, outputting every 15.00 s
30044.7s 3942 
30045.1s 3943 [PROGRESS] Step 1650: t=355.38/360.00s (98.7%) | dt=0.2118s
30045.2s 3944 [PERIODIC:1000] BC_DISPATCHER [Call #13224000] current_bc_params: <class 'dict'>
30045.2s 3945 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30045.2s 3946 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30045.2s 3947 [PERIODIC:1000] BC_GPU [Call #13224000] About to launch kernel
30045.2s 3948 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30045.2s 3949 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30045.2s 3950 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30045.2s 3951 [WARNING] Automatic CFL correction applied (count: 3305900):
30045.2s 3952 Calculated CFL: 0.800 > Limit: 0.500
30045.2s 3953 Original dt: 3.388749e-01 s
30045.2s 3954 Corrected dt: 2.117968e-01 s
30045.2s 3955 Correction factor: 1.6x
30045.2s 3956 Max wave speed detected: 23.61 m/s
30045.3s 3957 Stored output at t = 360.0000 s (Step 1672)
30045.3s 3958 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30045.3s 3959 [A
30045.3s 3960 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 24.28s/s]
30045.3s 3961 
30045.3s 3962 Simulation finished at t = 360.0000 s after 1672 steps.
30045.3s 3963 Total runtime: 0.62 seconds.
30045.3s 3964 [REWARD_MICROSCOPE] step=13944 t=360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30045.3s 3965 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30045.3s 3966 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30045.3s 3967 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30045.3s 3968 Running simulation until t = 375.00 s, outputting every 15.00 s
30045.3s 3969 
30045.6s 3970 [PROGRESS] Step 1700: t=365.93/375.00s (97.6%) | dt=0.2118s
30046.0s 3971 Stored output at t = 375.0000 s (Step 1743)
30046.0s 3972 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30046.0s 3973 [A
30046.0s 3974 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.07s/s]
30046.0s 3975 
30046.0s 3976 Simulation finished at t = 375.0000 s after 1743 steps.
30046.0s 3977 Total runtime: 0.62 seconds.
30046.0s 3978 [REWARD_MICROSCOPE] step=13945 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30046.0s 3979 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30046.0s 3980 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30046.0s 3981 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30046.0s 3982 Running simulation until t = 390.00 s, outputting every 15.00 s
30046.0s 3983 
30046.0s 3984 [PROGRESS] Step 1750: t=376.49/390.00s (96.5%) | dt=0.2129s
30046.1s 3985 [WARNING] Automatic CFL correction applied (count: 3306000):
30046.1s 3986 Calculated CFL: 0.800 > Limit: 0.500
30046.1s 3987 Original dt: 3.407121e-01 s
30046.1s 3988 Corrected dt: 2.129451e-01 s
30046.1s 3989 Correction factor: 1.6x
30046.1s 3990 Max wave speed detected: 23.48 m/s
30046.5s 3991 [PROGRESS] Step 1800: t=387.14/390.00s (99.3%) | dt=0.2131s
30046.6s 3992 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30046.6s 3993 [A
30046.6s 3994 Stored output at t = 390.0000 s (Step 1814)
30046.6s 3995 
30046.6s 3996 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.57s/s]
30046.6s 3997 Simulation finished at t = 390.0000 s after 1814 steps.
30046.6s 3998 Total runtime: 0.61 seconds.
30046.6s 3999 [REWARD_MICROSCOPE] step=13946 t=390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30046.6s 4000 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30046.6s 4001 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30046.6s 4002 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30046.6s 4003 Running simulation until t = 405.00 s, outputting every 15.00 s
30046.6s 4004 
30046.9s 4005 [PROGRESS] Step 1850: t=397.65/405.00s (98.2%) | dt=0.2125s
30047.0s 4006 [WARNING] Automatic CFL correction applied (count: 3306100):
30047.0s 4007 Calculated CFL: 0.800 > Limit: 0.500
30047.0s 4008 Original dt: 3.401476e-01 s
30047.0s 4009 Corrected dt: 2.125923e-01 s
30047.0s 4010 Correction factor: 1.6x
30047.0s 4011 Max wave speed detected: 23.52 m/s
30047.2s 4012 Stored output at t = 405.0000 s (Step 1885)
30047.2s 4013 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30047.2s 4014 [A
30047.2s 4015 
30047.2s 4016 Simulation finished at t = 405.0000 s after 1885 steps.
30047.2s 4017 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.73s/s]
30047.2s 4018 Total runtime: 0.63 seconds.
30047.2s 4019 [REWARD_MICROSCOPE] step=13947 t=405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30047.2s 4020 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30047.2s 4021 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30047.2s 4022 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30047.2s 4023 Running simulation until t = 420.00 s, outputting every 15.00 s
30047.2s 4024 
30047.4s 4025 [PROGRESS] Step 1900: t=408.19/420.00s (97.2%) | dt=0.2130s
30047.4s 4026 [PERIODIC:1000] BC_DISPATCHER [Call #13225000] current_bc_params: <class 'dict'>
30047.4s 4027 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30047.4s 4028 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30047.4s 4029 [PERIODIC:1000] BC_GPU [Call #13225000] About to launch kernel
30047.4s 4030 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30047.4s 4031 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30047.4s 4032 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30047.8s 4033 [PROGRESS] Step 1950: t=418.85/420.00s (99.7%) | dt=0.2127s
30047.9s 4034 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30047.9s 4035 [A
30047.9s 4036 Stored output at t = 420.0000 s (Step 1956)
30047.9s 4037 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 23.89s/s]
30047.9s 4038 
30047.9s 4039 Simulation finished at t = 420.0000 s after 1956 steps.
30047.9s 4040 Total runtime: 0.63 seconds.
30047.9s 4041 [REWARD_MICROSCOPE] step=13948 t=420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30047.9s 4042 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30047.9s 4043 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30047.9s 4044 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30047.9s 4045 Running simulation until t = 435.00 s, outputting every 15.00 s
30047.9s 4046 
30047.9s 4047 [WARNING] Automatic CFL correction applied (count: 3306200):
30047.9s 4048 Calculated CFL: 0.800 > Limit: 0.500
30047.9s 4049 Original dt: 3.400436e-01 s
30047.9s 4050 Corrected dt: 2.125273e-01 s
30047.9s 4051 Correction factor: 1.6x
30047.9s 4052 Max wave speed detected: 23.53 m/s
30048.2s 4053 [PROGRESS] Step 2000: t=429.35/435.00s (98.7%) | dt=0.2126s
30048.5s 4054 Stored output at t = 435.0000 s (Step 2027)
30048.5s 4055 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30048.5s 4056 [A
30048.5s 4057 
30048.5s 4058 Simulation finished at t = 435.0000 s after 2027 steps.
30048.5s 4059 Total runtime: 0.62 seconds.
30048.5s 4060 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.09s/s]
30048.5s 4061 [REWARD_MICROSCOPE] step=13949 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30048.5s 4062 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30048.5s 4063 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30048.5s 4064 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30048.5s 4065 Running simulation until t = 450.00 s, outputting every 15.00 s
30048.5s 4066 
30048.7s 4067 [PROGRESS] Step 2050: t=439.90/450.00s (97.8%) | dt=0.2130s
30048.8s 4068 [WARNING] Automatic CFL correction applied (count: 3306300):
30048.8s 4069 Calculated CFL: 0.800 > Limit: 0.500
30048.8s 4070 Original dt: 3.409462e-01 s
30048.8s 4071 Corrected dt: 2.130914e-01 s
30048.8s 4072 Correction factor: 1.6x
30048.8s 4073 Max wave speed detected: 23.46 m/s
30049.1s 4074 Stored output at t = 450.0000 s (Step 2098)
30049.1s 4075 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30049.1s 4076 [A
30049.1s 4077 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.10s/s]
30049.1s 4078 
30049.1s 4079 Simulation finished at t = 450.0000 s after 2098 steps.
30049.1s 4080 Total runtime: 0.65 seconds.
30049.1s 4081 [REWARD_MICROSCOPE] step=13950 t=450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30049.1s 4082 [STEP   30] t=  450.0s | phase=0 | reward=   0.01 | total_reward=    0.18
30049.1s 4083 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30049.1s 4084 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30049.1s 4085 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30049.1s 4086 Running simulation until t = 465.00 s, outputting every 15.00 s
30049.1s 4087 
30049.2s 4088 [PROGRESS] Step 2100: t=450.43/465.00s (96.9%) | dt=0.2125s
30049.6s 4089 [PROGRESS] Step 2150: t=461.05/465.00s (99.2%) | dt=0.2127s
30049.6s 4090 [PERIODIC:1000] BC_DISPATCHER [Call #13226000] current_bc_params: <class 'dict'>
30049.6s 4091 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30049.6s 4092 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30049.6s 4093 [PERIODIC:1000] BC_GPU [Call #13226000] About to launch kernel
30049.6s 4094 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30049.6s 4095 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30049.6s 4096 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30049.6s 4097 [WARNING] Automatic CFL correction applied (count: 3306400):
30049.6s 4098 Calculated CFL: 0.800 > Limit: 0.500
30049.6s 4099 Original dt: 3.403711e-01 s
30049.6s 4100 Corrected dt: 2.127320e-01 s
30049.6s 4101 Correction factor: 1.6x
30049.6s 4102 Max wave speed detected: 23.50 m/s
30049.8s 4103 Stored output at t = 465.0000 s (Step 2169)
30049.8s 4104 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30049.8s 4105 [A
30049.8s 4106 
30049.8s 4107 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.00s/s]
30049.8s 4108 Simulation finished at t = 465.0000 s after 2169 steps.
30049.8s 4109 Total runtime: 0.63 seconds.
30049.8s 4110 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30049.8s 4111 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30049.8s 4112 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30049.8s 4113 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30049.8s 4114 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30049.8s 4115 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30049.8s 4116 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30049.8s 4117 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30049.8s 4118 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30049.8s 4119 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30049.8s 4120 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30049.8s 4121 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30049.8s 4122 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30049.8s 4123 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30049.8s 4124 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30049.8s 4125 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30049.8s 4126 [REWARD_MICROSCOPE] step=13951 t=465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30049.8s 4127 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30049.8s 4128 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30049.8s 4129 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30049.8s 4130 Running simulation until t = 480.00 s, outputting every 15.00 s
30049.8s 4131 
30050.0s 4132 [PROGRESS] Step 2200: t=471.60/480.00s (98.3%) | dt=0.2131s
30050.4s 4133 Stored output at t = 480.0000 s (Step 2240)
30050.4s 4134 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30050.4s 4135 [A
30050.4s 4136 
30050.4s 4137 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.16s/s]
30050.4s 4138 Simulation finished at t = 480.0000 s after 2240 steps.
30050.4s 4139 Total runtime: 0.62 seconds.
30050.4s 4140 [REWARD_MICROSCOPE] step=13952 t=480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30050.4s 4141 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30050.4s 4142 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30050.4s 4143 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30050.4s 4144 Running simulation until t = 495.00 s, outputting every 15.00 s
30050.4s 4145 
30050.5s 4146 [PROGRESS] Step 2250: t=482.12/495.00s (97.4%) | dt=0.2123s
30050.5s 4147 [WARNING] Automatic CFL correction applied (count: 3306500):
30050.5s 4148 Calculated CFL: 0.800 > Limit: 0.500
30050.5s 4149 Original dt: 3.397675e-01 s
30050.5s 4150 Corrected dt: 2.123547e-01 s
30050.5s 4151 Correction factor: 1.6x
30050.5s 4152 Max wave speed detected: 23.55 m/s
30050.9s 4153 [PROGRESS] Step 2300: t=492.75/495.00s (99.5%) | dt=0.2127s
30051.0s 4154 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30051.0s 4155 Stored output at t = 495.0000 s (Step 2311)
30051.0s 4156 [A
30051.0s 4157 
30051.0s 4158 Simulation finished at t = 495.0000 s after 2311 steps.
30051.0s 4159 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.28s/s]
30051.0s 4160 Total runtime: 0.64 seconds.
30051.0s 4161 [REWARD_MICROSCOPE] step=13953 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30051.0s 4162 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30051.0s 4163 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30051.0s 4164 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30051.0s 4165 Running simulation until t = 510.00 s, outputting every 15.00 s
30051.0s 4166 
30051.4s 4167 [PROGRESS] Step 2350: t=503.31/510.00s (98.7%) | dt=0.2132s
30051.4s 4168 [WARNING] Automatic CFL correction applied (count: 3306600):
30051.4s 4169 Calculated CFL: 0.800 > Limit: 0.500
30051.4s 4170 Original dt: 3.411605e-01 s
30051.4s 4171 Corrected dt: 2.132253e-01 s
30051.4s 4172 Correction factor: 1.6x
30051.4s 4173 Max wave speed detected: 23.45 m/s
30051.6s 4174 Stored output at t = 510.0000 s (Step 2382)
30051.6s 4175 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30051.6s 4176 [A
30051.6s 4177 
30051.6s 4178 Simulation finished at t = 510.0000 s after 2382 steps.
30051.6s 4179 Total runtime: 0.61 seconds.
30051.6s 4180 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.55s/s]
30051.7s 4181 [REWARD_MICROSCOPE] step=13954 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30051.7s 4182 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30051.7s 4183 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30051.7s 4184 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30051.7s 4185 Running simulation until t = 525.00 s, outputting every 15.00 s
30051.7s 4186 
30051.8s 4187 [PROGRESS] Step 2400: t=513.84/525.00s (97.9%) | dt=0.2136s
30051.8s 4188 [PERIODIC:1000] BC_DISPATCHER [Call #13227000] current_bc_params: <class 'dict'>
30051.8s 4189 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30051.8s 4190 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30051.8s 4191 [PERIODIC:1000] BC_GPU [Call #13227000] About to launch kernel
30051.8s 4192 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30051.8s 4193 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30051.8s 4194 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30052.3s 4195 [PROGRESS] Step 2450: t=524.53/525.00s (99.9%) | dt=0.2140s
30052.3s 4196 Stored output at t = 525.0000 s (Step 2453)
30052.3s 4197 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30052.3s 4198 [A
30052.3s 4199 
30052.3s 4200 Simulation finished at t = 525.0000 s after 2453 steps.
30052.3s 4201 Total runtime: 0.63 seconds.
30052.3s 4202 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.76s/s]
30052.3s 4203 [REWARD_MICROSCOPE] step=13955 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30052.3s 4204 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30052.3s 4205 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30052.3s 4206 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30052.3s 4207 Running simulation until t = 540.00 s, outputting every 15.00 s
30052.3s 4208 
30052.3s 4209 [WARNING] Automatic CFL correction applied (count: 3306700):
30052.3s 4210 Calculated CFL: 0.800 > Limit: 0.500
30052.3s 4211 Original dt: 3.427840e-01 s
30052.3s 4212 Corrected dt: 2.142400e-01 s
30052.3s 4213 Correction factor: 1.6x
30052.3s 4214 Max wave speed detected: 23.34 m/s
30052.7s 4215 [PROGRESS] Step 2500: t=535.13/540.00s (99.1%) | dt=0.2171s
30052.9s 4216 Stored output at t = 540.0000 s (Step 2523)
30052.9s 4217 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30052.9s 4218 [A
30052.9s 4219 
30052.9s 4220 Simulation finished at t = 540.0000 s after 2523 steps.
30052.9s 4221 Total runtime: 0.61 seconds.
30052.9s 4222 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.67s/s]
30052.9s 4223 [REWARD_MICROSCOPE] step=13956 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30052.9s 4224 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30052.9s 4225 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30052.9s 4226 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30052.9s 4227 Running simulation until t = 555.00 s, outputting every 15.00 s
30052.9s 4228 
30053.1s 4229 [PROGRESS] Step 2550: t=545.90/555.00s (98.4%) | dt=0.2189s
30053.2s 4230 [WARNING] Automatic CFL correction applied (count: 3306800):
30053.2s 4231 Calculated CFL: 0.800 > Limit: 0.500
30053.2s 4232 Original dt: 3.504731e-01 s
30053.2s 4233 Corrected dt: 2.190457e-01 s
30053.2s 4234 Correction factor: 1.6x
30053.2s 4235 Max wave speed detected: 22.83 m/s
30053.5s 4236 Stored output at t = 555.0000 s (Step 2592)
30053.5s 4237 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30053.5s 4238 [A
30053.5s 4239 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.88s/s]
30053.5s 4240 
30053.5s 4241 Simulation finished at t = 555.0000 s after 2592 steps.
30053.5s 4242 Total runtime: 0.60 seconds.
30053.5s 4243 [REWARD_MICROSCOPE] step=13957 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30053.5s 4244 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30053.5s 4245 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30053.5s 4246 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30053.5s 4247 Running simulation until t = 570.00 s, outputting every 15.00 s
30053.5s 4248 
30053.6s 4249 [PROGRESS] Step 2600: t=556.75/570.00s (97.7%) | dt=0.2194s
30054.0s 4250 [PROGRESS] Step 2650: t=567.73/570.00s (99.6%) | dt=0.2194s
30054.0s 4251 [PERIODIC:1000] BC_DISPATCHER [Call #13228000] current_bc_params: <class 'dict'>
30054.0s 4252 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30054.0s 4253 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30054.0s 4254 [PERIODIC:1000] BC_GPU [Call #13228000] About to launch kernel
30054.0s 4255 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30054.0s 4256 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30054.0s 4257 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30054.1s 4258 [WARNING] Automatic CFL correction applied (count: 3306900):
30054.1s 4259 Calculated CFL: 0.800 > Limit: 0.500
30054.1s 4260 Original dt: 3.511275e-01 s
30054.1s 4261 Corrected dt: 2.194547e-01 s
30054.1s 4262 Correction factor: 1.6x
30054.1s 4263 Max wave speed detected: 22.78 m/s
30054.1s 4264 Stored output at t = 570.0000 s (Step 2661)
30054.1s 4265 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30054.1s 4266 [A
30054.1s 4267 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.80s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.79s/s]
30054.1s 4268 
30054.1s 4269 Simulation finished at t = 570.0000 s after 2661 steps.
30054.1s 4270 Total runtime: 0.61 seconds.
30054.1s 4271 [REWARD_MICROSCOPE] step=13958 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30054.1s 4272 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30054.1s 4273 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30054.1s 4274 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30054.1s 4275 Running simulation until t = 585.00 s, outputting every 15.00 s
30054.1s 4276 
30054.5s 4277 [PROGRESS] Step 2700: t=578.48/585.00s (98.9%) | dt=0.2146s
30054.7s 4278 Stored output at t = 585.0000 s (Step 2731)
30054.7s 4279 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30054.7s 4280 [A
30054.7s 4281 
30054.7s 4282 Simulation finished at t = 585.0000 s after 2731 steps.
30054.7s 4283 Total runtime: 0.61 seconds.
30054.7s 4284 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.60s/s]
30054.7s 4285 [REWARD_MICROSCOPE] step=13959 t=585.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30054.7s 4286 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30054.7s 4287 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30054.7s 4288 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30054.7s 4289 Running simulation until t = 600.00 s, outputting every 15.00 s
30054.7s 4290 
30054.9s 4291 [PROGRESS] Step 2750: t=589.04/600.00s (98.2%) | dt=0.2124s
30054.9s 4292 [WARNING] Automatic CFL correction applied (count: 3307000):
30054.9s 4293 Calculated CFL: 0.800 > Limit: 0.500
30054.9s 4294 Original dt: 3.399439e-01 s
30054.9s 4295 Corrected dt: 2.124650e-01 s
30054.9s 4296 Correction factor: 1.6x
30054.9s 4297 Max wave speed detected: 23.53 m/s
30055.3s 4298 [PROGRESS] Step 2800: t=599.67/600.00s (99.9%) | dt=0.2129s
30055.3s 4299 Stored output at t = 600.0000 s (Step 2802)
30055.3s 4300 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30055.3s 4301 [A
30055.3s 4302 
30055.3s 4303 Simulation finished at t = 600.0000 s after 2802 steps.
30055.3s 4304 Total runtime: 0.62 seconds.
30055.3s 4305 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.10s/s]
30055.4s 4306 [REWARD_MICROSCOPE] step=13960 t=600.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30055.4s 4307 [STEP   40] t=  600.0s | phase=1 | reward=   0.01 | total_reward=    0.29
30055.4s 4308 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30055.4s 4309 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30055.4s 4310 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30055.4s 4311 Running simulation until t = 615.00 s, outputting every 15.00 s
30055.4s 4312 
30055.8s 4313 [PROGRESS] Step 2850: t=610.23/615.00s (99.2%) | dt=0.2133s
30055.8s 4314 [WARNING] Automatic CFL correction applied (count: 3307100):
30055.8s 4315 Calculated CFL: 0.800 > Limit: 0.500
30055.8s 4316 Original dt: 3.414265e-01 s
30055.8s 4317 Corrected dt: 2.133916e-01 s
30055.8s 4318 Correction factor: 1.6x
30055.8s 4319 Max wave speed detected: 23.43 m/s
30056.0s 4320 Stored output at t = 615.0000 s (Step 2873)
30056.0s 4321 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 600.0/615.0 [00:00<?, ?s/s][A
30056.0s 4322 [A
30056.0s 4323 
30056.0s 4324 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 24.37s/s]
30056.0s 4325 Simulation finished at t = 615.0000 s after 2873 steps.
30056.0s 4326 Total runtime: 0.62 seconds.
30056.0s 4327 [QUEUE_DIAGNOSTIC] ===== Step 40 t=615.0s =====
30056.0s 4328 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30056.0s 4329 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01562276 1.         0.0382043  1.        ] (rho_m, v_m, rho_c, v_c)
30056.0s 4330 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30056.0s 4331 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30056.0s 4332 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30056.0s 4333 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00468683 0.00447818 0.00441108 0.00438767 0.00437898 0.00437553]
30056.0s 4334 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00573064 0.00534498 0.00516742 0.00507682 0.00502717 0.00499917]
30056.0s 4335 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30056.0s 4336 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30056.0s 4337 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30056.0s 4338 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30056.0s 4339 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30056.0s 4340 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30056.0s 4341 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30056.0s 4342 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30056.0s 4343 [REWARD_MICROSCOPE] step=13961 t=615.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30056.0s 4344 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30056.0s 4345 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30056.0s 4346 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30056.0s 4347 Running simulation until t = 630.00 s, outputting every 15.00 s
30056.0s 4348 
30056.2s 4349 [PROGRESS] Step 2900: t=620.77/630.00s (98.5%) | dt=0.2138s
30056.2s 4350 [PERIODIC:1000] BC_DISPATCHER [Call #13229000] current_bc_params: <class 'dict'>
30056.2s 4351 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30056.2s 4352 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30056.2s 4353 [PERIODIC:1000] BC_GPU [Call #13229000] About to launch kernel
30056.2s 4354 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30056.2s 4355 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30056.2s 4356 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30056.6s 4357 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 615.0/630.0 [00:00<?, ?s/s][A
30056.6s 4358 [A
30056.6s 4359 Stored output at t = 630.0000 s (Step 2944)
30056.6s 4360 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.54s/s]
30056.6s 4361 
30056.6s 4362 Simulation finished at t = 630.0000 s after 2944 steps.
30056.6s 4363 Total runtime: 0.61 seconds.
30056.6s 4364 [REWARD_MICROSCOPE] step=13962 t=630.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30056.6s 4365 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30056.6s 4366 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30056.6s 4367 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30056.6s 4368 Running simulation until t = 645.00 s, outputting every 15.00 s
30056.6s 4369 
30056.6s 4370 [PROGRESS] Step 2950: t=631.29/645.00s (97.9%) | dt=0.2144s
30056.7s 4371 [WARNING] Automatic CFL correction applied (count: 3307200):
30056.7s 4372 Calculated CFL: 0.800 > Limit: 0.500
30056.7s 4373 Original dt: 3.436322e-01 s
30056.7s 4374 Corrected dt: 2.147701e-01 s
30056.7s 4375 Correction factor: 1.6x
30056.7s 4376 Max wave speed detected: 23.28 m/s
30057.1s 4377 [PROGRESS] Step 3000: t=642.09/645.00s (99.5%) | dt=0.2176s
30057.2s 4378 Stored output at t = 645.0000 s (Step 3014)
30057.2s 4379 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 630.0/645.0 [00:00<?, ?s/s][A
30057.2s 4380 [A
30057.2s 4381 
30057.2s 4382 Simulation finished at t = 645.0000 s after 3014 steps.
30057.2s 4383 Total runtime: 0.63 seconds.
30057.2s 4384 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 23.88s/s]
30057.2s 4385 [REWARD_MICROSCOPE] step=13963 t=645.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30057.2s 4386 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30057.2s 4387 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30057.2s 4388 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30057.2s 4389 Running simulation until t = 660.00 s, outputting every 15.00 s
30057.2s 4390 
30057.5s 4391 [PROGRESS] Step 3050: t=652.87/660.00s (98.9%) | dt=0.2191s
30057.6s 4392 [WARNING] Automatic CFL correction applied (count: 3307300):
30057.6s 4393 Calculated CFL: 0.800 > Limit: 0.500
30057.6s 4394 Original dt: 3.506507e-01 s
30057.6s 4395 Corrected dt: 2.191567e-01 s
30057.6s 4396 Correction factor: 1.6x
30057.6s 4397 Max wave speed detected: 22.81 m/s
30057.8s 4398 Stored output at t = 660.0000 s (Step 3083)
30057.8s 4399 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 645.0/660.0 [00:00<?, ?s/s][A
30057.8s 4400 [A
30057.8s 4401 
30057.8s 4402 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 25.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 25.08s/s]
30057.8s 4403 Simulation finished at t = 660.0000 s after 3083 steps.
30057.8s 4404 Total runtime: 0.60 seconds.
30057.8s 4405 [REWARD_MICROSCOPE] step=13964 t=660.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30057.8s 4406 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30057.8s 4407 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30057.8s 4408 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30057.8s 4409 Running simulation until t = 675.00 s, outputting every 15.00 s
30057.8s 4410 
30058.0s 4411 [PROGRESS] Step 3100: t=663.73/675.00s (98.3%) | dt=0.2194s
30058.4s 4412 [PROGRESS] Step 3150: t=674.70/675.00s (100.0%) | dt=0.2195s
30058.4s 4413 [PERIODIC:1000] BC_DISPATCHER [Call #13230000] current_bc_params: <class 'dict'>
30058.4s 4414 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30058.4s 4415 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30058.4s 4416 [PERIODIC:1000] BC_GPU [Call #13230000] About to launch kernel
30058.4s 4417 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30058.4s 4418 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30058.4s 4419 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30058.4s 4420 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 660.0/675.0 [00:00<?, ?s/s][A
30058.4s 4421 [A
30058.4s 4422 Stored output at t = 675.0000 s (Step 3152)
30058.4s 4423 
30058.4s 4424 Simulation finished at t = 675.0000 s after 3152 steps.
30058.4s 4425 Total runtime: 0.61 seconds.
30058.4s 4426 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.80s/s]
30058.4s 4427 [REWARD_MICROSCOPE] step=13965 t=675.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30058.4s 4428 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30058.4s 4429 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30058.4s 4430 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30058.4s 4431 Running simulation until t = 690.00 s, outputting every 15.00 s
30058.4s 4432 
30058.5s 4433 [WARNING] Automatic CFL correction applied (count: 3307400):
30058.5s 4434 Calculated CFL: 0.800 > Limit: 0.500
30058.5s 4435 Original dt: 3.511386e-01 s
30058.5s 4436 Corrected dt: 2.194616e-01 s
30058.5s 4437 Correction factor: 1.6x
30058.5s 4438 Max wave speed detected: 22.78 m/s
30058.9s 4439 [PROGRESS] Step 3200: t=685.53/690.00s (99.4%) | dt=0.2195s
30059.0s 4440 Stored output at t = 690.0000 s (Step 3221)
30059.0s 4441 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 675.0/690.0 [00:00<?, ?s/s][A
30059.0s 4442 [A
30059.0s 4443 
30059.0s 4444 Simulation finished at t = 690.0000 s after 3221 steps.
30059.0s 4445 Total runtime: 0.61 seconds.
30059.0s 4446 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.58s/s]
30059.0s 4447 [REWARD_MICROSCOPE] step=13966 t=690.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30059.0s 4448 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30059.0s 4449 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30059.0s 4450 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30059.0s 4451 Running simulation until t = 705.00 s, outputting every 15.00 s
30059.0s 4452 
30059.3s 4453 [PROGRESS] Step 3250: t=696.37/705.00s (98.8%) | dt=0.2195s
30059.3s 4454 [WARNING] Automatic CFL correction applied (count: 3307500):
30059.3s 4455 Calculated CFL: 0.800 > Limit: 0.500
30059.3s 4456 Original dt: 3.511761e-01 s
30059.3s 4457 Corrected dt: 2.194851e-01 s
30059.3s 4458 Correction factor: 1.6x
30059.3s 4459 Max wave speed detected: 22.78 m/s
30059.6s 4460 Stored output at t = 705.0000 s (Step 3290)
30059.6s 4461 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 690.0/705.0 [00:00<?, ?s/s][A
30059.6s 4462 [A
30059.6s 4463 
30059.6s 4464 Simulation finished at t = 705.0000 s after 3290 steps.
30059.6s 4465 Total runtime: 0.60 seconds.
30059.6s 4466 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 25.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 25.10s/s]
30059.6s 4467 [REWARD_MICROSCOPE] step=13967 t=705.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30059.6s 4468 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30059.6s 4469 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30059.6s 4470 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30059.6s 4471 Running simulation until t = 720.00 s, outputting every 15.00 s
30059.6s 4472 
30059.7s 4473 [PROGRESS] Step 3300: t=707.19/720.00s (98.2%) | dt=0.2195s
30060.2s 4474 [PROGRESS] Step 3350: t=718.17/720.00s (99.7%) | dt=0.2195s
30060.2s 4475 [WARNING] Automatic CFL correction applied (count: 3307600):
30060.2s 4476 Calculated CFL: 0.800 > Limit: 0.500
30060.2s 4477 Original dt: 3.511802e-01 s
30060.2s 4478 Corrected dt: 2.194877e-01 s
30060.2s 4479 Correction factor: 1.6x
30060.2s 4480 Max wave speed detected: 22.78 m/s
30060.2s 4481 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 705.0/720.0 [00:00<?, ?s/s][A
30060.2s 4482 [A
30060.2s 4483 Stored output at t = 720.0000 s (Step 3359)
30060.2s 4484 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 24.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 24.98s/s]
30060.2s 4485 
30060.2s 4486 Simulation finished at t = 720.0000 s after 3359 steps.
30060.2s 4487 Total runtime: 0.60 seconds.
30060.2s 4488 [REWARD_MICROSCOPE] step=13968 t=720.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30060.3s 4489 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30060.3s 4490 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30060.3s 4491 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30060.3s 4492 Running simulation until t = 735.00 s, outputting every 15.00 s
30060.3s 4493 
30060.6s 4494 [PROGRESS] Step 3400: t=729.00/735.00s (99.2%) | dt=0.2195s
30060.6s 4495 [PERIODIC:1000] BC_DISPATCHER [Call #13231000] current_bc_params: <class 'dict'>
30060.6s 4496 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30060.6s 4497 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30060.6s 4498 [PERIODIC:1000] BC_GPU [Call #13231000] About to launch kernel
30060.6s 4499 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30060.6s 4500 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30060.6s 4501 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30060.9s 4502 Stored output at t = 735.0000 s (Step 3428)
30060.9s 4503 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 720.0/735.0 [00:00<?, ?s/s][A
30060.9s 4504 [A
30060.9s 4505 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 23.62s/s]
30060.9s 4506 
30060.9s 4507 Simulation finished at t = 735.0000 s after 3428 steps.
30060.9s 4508 Total runtime: 0.64 seconds.
30060.9s 4509 [REWARD_MICROSCOPE] step=13969 t=735.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30060.9s 4510 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30060.9s 4511 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30060.9s 4512 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30060.9s 4513 Running simulation until t = 750.00 s, outputting every 15.00 s
30060.9s 4514 
30061.1s 4515 [PROGRESS] Step 3450: t=739.83/750.00s (98.6%) | dt=0.2195s
30061.1s 4516 [WARNING] Automatic CFL correction applied (count: 3307700):
30061.1s 4517 Calculated CFL: 0.800 > Limit: 0.500
30061.1s 4518 Original dt: 3.511807e-01 s
30061.1s 4519 Corrected dt: 2.194879e-01 s
30061.1s 4520 Correction factor: 1.6x
30061.1s 4521 Max wave speed detected: 22.78 m/s
30061.5s 4522 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 735.0/750.0 [00:00<?, ?s/s][A
30061.5s 4523 [A
30061.5s 4524 Stored output at t = 750.0000 s (Step 3497)
30061.5s 4525 
30061.5s 4526 Simulation finished at t = 750.0000 s after 3497 steps.
30061.5s 4527 Total runtime: 0.60 seconds.
30061.5s 4528 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 24.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 24.97s/s]
30061.5s 4529 [REWARD_MICROSCOPE] step=13970 t=750.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30061.5s 4530 [STEP   50] t=  750.0s | phase=1 | reward=   0.00 | total_reward=    0.35
30061.5s 4531 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30061.5s 4532 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30061.5s 4533 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30061.5s 4534 Running simulation until t = 765.00 s, outputting every 15.00 s
30061.5s 4535 
30061.5s 4536 [PROGRESS] Step 3500: t=750.66/765.00s (98.1%) | dt=0.2195s
30062.0s 4537 [PROGRESS] Step 3550: t=761.63/765.00s (99.6%) | dt=0.2195s
30062.0s 4538 [WARNING] Automatic CFL correction applied (count: 3307800):
30062.0s 4539 Calculated CFL: 0.800 > Limit: 0.500
30062.0s 4540 Original dt: 3.511808e-01 s
30062.0s 4541 Corrected dt: 2.194880e-01 s
30062.0s 4542 Correction factor: 1.6x
30062.0s 4543 Max wave speed detected: 22.78 m/s
30062.1s 4544 Stored output at t = 765.0000 s (Step 3566)
30062.1s 4545 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 750.0/765.0 [00:00<?, ?s/s][A
30062.1s 4546 [A
30062.1s 4547 
30062.1s 4548 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 25.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 25.16s/s]
30062.1s 4549 Simulation finished at t = 765.0000 s after 3566 steps.
30062.1s 4550 Total runtime: 0.60 seconds.
30062.1s 4551 [QUEUE_DIAGNOSTIC] ===== Step 50 t=765.0s =====
30062.1s 4552 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30062.1s 4553 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01561897 1.         0.03809813 1.        ] (rho_m, v_m, rho_c, v_c)
30062.1s 4554 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30062.1s 4555 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30062.1s 4556 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30062.1s 4557 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00468569 0.00447661 0.0044096  0.00438658 0.00437841 0.00437545]
30062.1s 4558 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00571472 0.00532194 0.00514344 0.00505765 0.0050154  0.00499436]
30062.1s 4559 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30062.1s 4560 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30062.1s 4561 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30062.1s 4562 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30062.1s 4563 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30062.1s 4564 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30062.1s 4565 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30062.1s 4566 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30062.1s 4567 [REWARD_MICROSCOPE] step=13971 t=765.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30062.1s 4568 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30062.1s 4569 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30062.1s 4570 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30062.1s 4571 Running simulation until t = 780.00 s, outputting every 15.00 s
30062.1s 4572 
30062.4s 4573 [PROGRESS] Step 3600: t=772.46/780.00s (99.0%) | dt=0.2195s
30062.7s 4574 Stored output at t = 780.0000 s (Step 3635)
30062.7s 4575 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 765.0/780.0 [00:00<?, ?s/s][A
30062.7s 4576 [A
30062.7s 4577 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 25.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 25.02s/s]
30062.7s 4578 
30062.7s 4579 Simulation finished at t = 780.0000 s after 3635 steps.
30062.7s 4580 Total runtime: 0.60 seconds.
30062.7s 4581 [REWARD_MICROSCOPE] step=13972 t=780.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30062.7s 4582 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30062.7s 4583 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30062.7s 4584 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30062.7s 4585 Running simulation until t = 795.00 s, outputting every 15.00 s
30062.7s 4586 
30062.8s 4587 [PROGRESS] Step 3650: t=783.29/795.00s (98.5%) | dt=0.2195s
30062.9s 4588 [PERIODIC:1000] BC_DISPATCHER [Call #13232000] current_bc_params: <class 'dict'>
30062.9s 4589 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30062.9s 4590 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30062.9s 4591 [PERIODIC:1000] BC_GPU [Call #13232000] About to launch kernel
30062.9s 4592 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30062.9s 4593 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30062.9s 4594 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30062.9s 4595 [WARNING] Automatic CFL correction applied (count: 3307900):
30062.9s 4596 Calculated CFL: 0.800 > Limit: 0.500
30062.9s 4597 Original dt: 3.511808e-01 s
30062.9s 4598 Corrected dt: 2.194880e-01 s
30062.9s 4599 Correction factor: 1.6x
30062.9s 4600 Max wave speed detected: 22.78 m/s
30063.3s 4601 [PROGRESS] Step 3700: t=794.27/795.00s (99.9%) | dt=0.2195s
30063.3s 4602 Stored output at t = 795.0000 s (Step 3704)
30063.3s 4603 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 780.0/795.0 [00:00<?, ?s/s][A
30063.3s 4604 [A
30063.3s 4605 
30063.3s 4606 Simulation finished at t = 795.0000 s after 3704 steps.
30063.3s 4607 Total runtime: 0.62 seconds.
30063.3s 4608 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.15s/s]
30063.3s 4609 [REWARD_MICROSCOPE] step=13973 t=795.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30063.3s 4610 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30063.3s 4611 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30063.3s 4612 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30063.3s 4613 Running simulation until t = 810.00 s, outputting every 15.00 s
30063.3s 4614 
30063.7s 4615 [PROGRESS] Step 3750: t=805.10/810.00s (99.4%) | dt=0.2195s
30063.8s 4616 [WARNING] Automatic CFL correction applied (count: 3308000):
30063.8s 4617 Calculated CFL: 0.800 > Limit: 0.500
30063.8s 4618 Original dt: 3.511808e-01 s
30063.8s 4619 Corrected dt: 2.194880e-01 s
30063.8s 4620 Correction factor: 1.6x
30063.8s 4621 Max wave speed detected: 22.78 m/s
30063.9s 4622 Stored output at t = 810.0000 s (Step 3773)
30063.9s 4623 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 795.0/810.0 [00:00<?, ?s/s][A
30063.9s 4624 [A
30063.9s 4625 
30063.9s 4626 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 24.41s/s]
30063.9s 4627 Simulation finished at t = 810.0000 s after 3773 steps.
30063.9s 4628 Total runtime: 0.61 seconds.
30063.9s 4629 [REWARD_MICROSCOPE] step=13974 t=810.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30063.9s 4630 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30063.9s 4631 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30063.9s 4632 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30063.9s 4633 Running simulation until t = 825.00 s, outputting every 15.00 s
30063.9s 4634 
30064.2s 4635 [PROGRESS] Step 3800: t=815.93/825.00s (98.9%) | dt=0.2195s
30064.5s 4636 Stored output at t = 825.0000 s (Step 3842)
30064.5s 4637 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 810.0/825.0 [00:00<?, ?s/s][A
30064.5s 4638 [A
30064.5s 4639 
30064.5s 4640 Simulation finished at t = 825.0000 s after 3842 steps.
30064.5s 4641 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.88s/s]
30064.5s 4642 Total runtime: 0.60 seconds.
30064.5s 4643 [REWARD_MICROSCOPE] step=13975 t=825.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30064.5s 4644 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30064.5s 4645 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30064.5s 4646 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30064.5s 4647 Running simulation until t = 840.00 s, outputting every 15.00 s
30064.5s 4648 
30064.6s 4649 [PROGRESS] Step 3850: t=826.76/840.00s (98.4%) | dt=0.2195s
30064.7s 4650 [WARNING] Automatic CFL correction applied (count: 3308100):
30064.7s 4651 Calculated CFL: 0.800 > Limit: 0.500
30064.7s 4652 Original dt: 3.511808e-01 s
30064.7s 4653 Corrected dt: 2.194880e-01 s
30064.7s 4654 Correction factor: 1.6x
30064.7s 4655 Max wave speed detected: 22.78 m/s
30065.0s 4656 [PROGRESS] Step 3900: t=837.73/840.00s (99.7%) | dt=0.2195s
30065.1s 4657 [PERIODIC:1000] BC_DISPATCHER [Call #13233000] current_bc_params: <class 'dict'>
30065.1s 4658 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30065.1s 4659 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30065.1s 4660 [PERIODIC:1000] BC_GPU [Call #13233000] About to launch kernel
30065.1s 4661 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30065.1s 4662 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30065.1s 4663 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30065.1s 4664 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 825.0/840.0 [00:00<?, ?s/s][A
30065.1s 4665 [A
30065.1s 4666 Stored output at t = 840.0000 s (Step 3911)
30065.1s 4667 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 25.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 25.04s/s]
30065.1s 4668 
30065.1s 4669 Simulation finished at t = 840.0000 s after 3911 steps.
30065.1s 4670 Total runtime: 0.60 seconds.
30065.1s 4671 [REWARD_MICROSCOPE] step=13976 t=840.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30065.2s 4672 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30065.2s 4673 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30065.2s 4674 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30065.2s 4675 Running simulation until t = 855.00 s, outputting every 15.00 s
30065.2s 4676 
30065.5s 4677 [PROGRESS] Step 3950: t=848.56/855.00s (99.2%) | dt=0.2195s
30065.5s 4678 [WARNING] Automatic CFL correction applied (count: 3308200):
30065.5s 4679 Calculated CFL: 0.800 > Limit: 0.500
30065.5s 4680 Original dt: 3.511808e-01 s
30065.5s 4681 Corrected dt: 2.194880e-01 s
30065.5s 4682 Correction factor: 1.6x
30065.5s 4683 Max wave speed detected: 22.78 m/s
30065.8s 4684 Stored output at t = 855.0000 s (Step 3980)
30065.8s 4685 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 840.0/855.0 [00:00<?, ?s/s][A
30065.8s 4686 [A
30065.8s 4687 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.60s/s]
30065.8s 4688 
30065.8s 4689 Simulation finished at t = 855.0000 s after 3980 steps.
30065.8s 4690 Total runtime: 0.61 seconds.
30065.8s 4691 [REWARD_MICROSCOPE] step=13977 t=855.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30065.8s 4692 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30065.8s 4693 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30065.8s 4694 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30065.8s 4695 Running simulation until t = 870.00 s, outputting every 15.00 s
30065.8s 4696 
30065.9s 4697 [PROGRESS] Step 4000: t=859.38/870.00s (98.8%) | dt=0.2178s
30066.4s 4698 [PROGRESS] Step 4050: t=870.00/870.00s (100.0%) | dt=0.1150s
30066.4s 4699 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 855.0/870.0 [00:00<?, ?s/s][A
30066.4s 4700 [A
30066.4s 4701 Stored output at t = 870.0000 s (Step 4050)
30066.4s 4702 
30066.4s 4703 Simulation finished at t = 870.0000 s after 4050 steps.
30066.4s 4704 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 24.03s/s]
30066.4s 4705 Total runtime: 0.62 seconds.
30066.4s 4706 [REWARD_MICROSCOPE] step=13978 t=870.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30066.4s 4707 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30066.4s 4708 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30066.4s 4709 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30066.4s 4710 Running simulation until t = 885.00 s, outputting every 15.00 s
30066.4s 4711 
30066.4s 4712 [WARNING] Automatic CFL correction applied (count: 3308300):
30066.4s 4713 Calculated CFL: 0.800 > Limit: 0.500
30066.4s 4714 Original dt: 3.398174e-01 s
30066.4s 4715 Corrected dt: 2.123859e-01 s
30066.4s 4716 Correction factor: 1.6x
30066.4s 4717 Max wave speed detected: 23.54 m/s
30066.8s 4718 [PROGRESS] Step 4100: t=880.62/885.00s (99.5%) | dt=0.2127s
30067.0s 4719 Stored output at t = 885.0000 s (Step 4121)
30067.0s 4720 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 870.0/885.0 [00:00<?, ?s/s][A
30067.0s 4721 [A
30067.0s 4722 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 23.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 23.54s/s]
30067.0s 4723 
30067.0s 4724 Simulation finished at t = 885.0000 s after 4121 steps.
30067.0s 4725 Total runtime: 0.64 seconds.
30067.0s 4726 [REWARD_MICROSCOPE] step=13979 t=885.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30067.0s 4727 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30067.0s 4728 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30067.0s 4729 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30067.0s 4730 Running simulation until t = 900.00 s, outputting every 15.00 s
30067.0s 4731 
30067.3s 4732 [PROGRESS] Step 4150: t=891.18/900.00s (99.0%) | dt=0.2132s
30067.3s 4733 [PERIODIC:1000] BC_DISPATCHER [Call #13234000] current_bc_params: <class 'dict'>
30067.3s 4734 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30067.3s 4735 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30067.3s 4736 [PERIODIC:1000] BC_GPU [Call #13234000] About to launch kernel
30067.3s 4737 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30067.3s 4738 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30067.3s 4739 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30067.3s 4740 [WARNING] Automatic CFL correction applied (count: 3308400):
30067.3s 4741 Calculated CFL: 0.800 > Limit: 0.500
30067.3s 4742 Original dt: 3.411447e-01 s
30067.3s 4743 Corrected dt: 2.132155e-01 s
30067.3s 4744 Correction factor: 1.6x
30067.3s 4745 Max wave speed detected: 23.45 m/s
30067.7s 4746 Stored output at t = 900.0000 s (Step 4192)
30067.7s 4747 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 885.0/900.0 [00:00<?, ?s/s][A
30067.7s 4748 [A
30067.7s 4749 
30067.7s 4750 Simulation finished at t = 900.0000 s after 4192 steps.
30067.7s 4751 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 24.09s/s]
30067.7s 4752 Total runtime: 0.62 seconds.
30067.7s 4753 [REWARD_MICROSCOPE] step=13980 t=900.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30067.7s 4754 [STEP   60] t=  900.0s | phase=0 | reward=   0.01 | total_reward=    0.38
30067.7s 4755 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30067.7s 4756 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30067.7s 4757 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30067.7s 4758 Running simulation until t = 915.00 s, outputting every 15.00 s
30067.7s 4759 
30067.7s 4760 [PROGRESS] Step 4200: t=901.70/915.00s (98.5%) | dt=0.2124s
30068.2s 4761 [PROGRESS] Step 4250: t=912.32/915.00s (99.7%) | dt=0.2127s
30068.2s 4762 [WARNING] Automatic CFL correction applied (count: 3308500):
30068.2s 4763 Calculated CFL: 0.800 > Limit: 0.500
30068.2s 4764 Original dt: 3.404556e-01 s
30068.2s 4765 Corrected dt: 2.127848e-01 s
30068.2s 4766 Correction factor: 1.6x
30068.2s 4767 Max wave speed detected: 23.50 m/s
30068.3s 4768 Stored output at t = 915.0000 s (Step 4263)
30068.3s 4769 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 900.0/915.0 [00:00<?, ?s/s][A
30068.3s 4770 [A
30068.3s 4771 
30068.3s 4772 Simulation finished at t = 915.0000 s after 4263 steps.
30068.3s 4773 Total runtime: 0.62 seconds.
30068.3s 4774 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 24.36s/s]
30068.3s 4775 [QUEUE_DIAGNOSTIC] ===== Step 60 t=915.0s =====
30068.3s 4776 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30068.3s 4777 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.0392691  1.        ] (rho_m, v_m, rho_c, v_c)
30068.3s 4778 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30068.3s 4779 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30068.3s 4780 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30068.3s 4781 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438326 0.0043694  0.00436217]
30068.3s 4782 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546897 0.00523327 0.00509963 0.00502799 0.00499117]
30068.3s 4783 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30068.3s 4784 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30068.3s 4785 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30068.3s 4786 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30068.3s 4787 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30068.3s 4788 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30068.3s 4789 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30068.3s 4790 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30068.3s 4791 [REWARD_MICROSCOPE] step=13981 t=915.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30068.3s 4792 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30068.3s 4793 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30068.3s 4794 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30068.3s 4795 Running simulation until t = 930.00 s, outputting every 15.00 s
30068.3s 4796 
30068.6s 4797 [PROGRESS] Step 4300: t=922.88/930.00s (99.2%) | dt=0.2132s
30068.9s 4798 Stored output at t = 930.0000 s (Step 4334)
30068.9s 4799 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 915.0/930.0 [00:00<?, ?s/s][A
30068.9s 4800 [A
30068.9s 4801 
30068.9s 4802 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.55s/s]
30068.9s 4803 Simulation finished at t = 930.0000 s after 4334 steps.
30068.9s 4804 Total runtime: 0.64 seconds.
30068.9s 4805 [REWARD_MICROSCOPE] step=13982 t=930.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30068.9s 4806 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30068.9s 4807 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30068.9s 4808 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30068.9s 4809 Running simulation until t = 945.00 s, outputting every 15.00 s
30068.9s 4810 
30069.1s 4811 [PROGRESS] Step 4350: t=933.40/945.00s (98.8%) | dt=0.2123s
30069.1s 4812 [WARNING] Automatic CFL correction applied (count: 3308600):
30069.1s 4813 Calculated CFL: 0.800 > Limit: 0.500
30069.1s 4814 Original dt: 3.398585e-01 s
30069.1s 4815 Corrected dt: 2.124115e-01 s
30069.1s 4816 Correction factor: 1.6x
30069.1s 4817 Max wave speed detected: 23.54 m/s
30069.5s 4818 [PROGRESS] Step 4400: t=944.03/945.00s (99.9%) | dt=0.2128s
30069.5s 4819 [PERIODIC:1000] BC_DISPATCHER [Call #13235000] current_bc_params: <class 'dict'>
30069.5s 4820 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30069.5s 4821 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30069.5s 4822 [PERIODIC:1000] BC_GPU [Call #13235000] About to launch kernel
30069.5s 4823 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30069.5s 4824 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30069.5s 4825 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30069.5s 4826 Stored output at t = 945.0000 s (Step 4405)
30069.5s 4827 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 930.0/945.0 [00:00<?, ?s/s][A
30069.5s 4828 [A
30069.5s 4829 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.06s/s]
30069.5s 4830 
30069.5s 4831 Simulation finished at t = 945.0000 s after 4405 steps.
30069.5s 4832 Total runtime: 0.62 seconds.
30069.5s 4833 [REWARD_MICROSCOPE] step=13983 t=945.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30069.5s 4834 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30069.5s 4835 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30069.5s 4836 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30069.5s 4837 Running simulation until t = 960.00 s, outputting every 15.00 s
30069.5s 4838 
30069.9s 4839 [PROGRESS] Step 4450: t=954.59/960.00s (99.4%) | dt=0.2132s
30070.0s 4840 [WARNING] Automatic CFL correction applied (count: 3308700):
30070.0s 4841 Calculated CFL: 0.800 > Limit: 0.500
30070.0s 4842 Original dt: 3.412423e-01 s
30070.0s 4843 Corrected dt: 2.132765e-01 s
30070.0s 4844 Correction factor: 1.6x
30070.0s 4845 Max wave speed detected: 23.44 m/s
30070.2s 4846 Stored output at t = 960.0000 s (Step 4476)
30070.2s 4847 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 945.0/960.0 [00:00<?, ?s/s][A
30070.2s 4848 [A
30070.2s 4849 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 24.30s/s]
30070.2s 4850 
30070.2s 4851 Simulation finished at t = 960.0000 s after 4476 steps.
30070.2s 4852 Total runtime: 0.62 seconds.
30070.2s 4853 [REWARD_MICROSCOPE] step=13984 t=960.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30070.2s 4854 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30070.2s 4855 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30070.2s 4856 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30070.2s 4857 Running simulation until t = 975.00 s, outputting every 15.00 s
30070.2s 4858 
30070.4s 4859 [PROGRESS] Step 4500: t=965.09/975.00s (99.0%) | dt=0.2121s
30070.9s 4860 Stored output at t = 975.0000 s (Step 4547)
30070.9s 4861 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 960.0/975.0 [00:00<?, ?s/s][A
30070.9s 4862 [A
30070.9s 4863 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 21.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 21.97s/s]
30070.9s 4864 
30070.9s 4865 Simulation finished at t = 975.0000 s after 4547 steps.
30070.9s 4866 Total runtime: 0.68 seconds.
30070.9s 4867 [REWARD_MICROSCOPE] step=13985 t=975.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30070.9s 4868 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30070.9s 4869 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30070.9s 4870 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30070.9s 4871 Running simulation until t = 990.00 s, outputting every 15.00 s
30070.9s 4872 
30070.9s 4873 [PROGRESS] Step 4550: t=975.64/990.00s (98.5%) | dt=0.2118s
30070.9s 4874 [WARNING] Automatic CFL correction applied (count: 3308800):
30070.9s 4875 Calculated CFL: 0.800 > Limit: 0.500
30070.9s 4876 Original dt: 3.389193e-01 s
30070.9s 4877 Corrected dt: 2.118245e-01 s
30070.9s 4878 Correction factor: 1.6x
30070.9s 4879 Max wave speed detected: 23.60 m/s
30071.3s 4880 [PROGRESS] Step 4600: t=986.23/990.00s (99.6%) | dt=0.2118s
30071.5s 4881 Stored output at t = 990.0000 s (Step 4618)
30071.5s 4882 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975.0/990.0 [00:00<?, ?s/s][A
30071.5s 4883 [A
30071.5s 4884 
30071.5s 4885 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.07s/s]
30071.5s 4886 Simulation finished at t = 990.0000 s after 4618 steps.
30071.5s 4887 Total runtime: 0.62 seconds.
30071.5s 4888 [REWARD_MICROSCOPE] step=13986 t=990.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30071.5s 4889 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30071.5s 4890 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30071.5s 4891 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30071.5s 4892 Running simulation until t = 1005.00 s, outputting every 15.00 s
30071.5s 4893 
30071.8s 4894 [PROGRESS] Step 4650: t=996.78/1005.00s (99.2%) | dt=0.2118s
30071.8s 4895 [PERIODIC:1000] BC_DISPATCHER [Call #13236000] current_bc_params: <class 'dict'>
30071.8s 4896 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30071.8s 4897 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30071.8s 4898 [PERIODIC:1000] BC_GPU [Call #13236000] About to launch kernel
30071.8s 4899 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30071.8s 4900 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30071.8s 4901 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30071.8s 4902 [WARNING] Automatic CFL correction applied (count: 3308900):
30071.8s 4903 Calculated CFL: 0.800 > Limit: 0.500
30071.8s 4904 Original dt: 3.388757e-01 s
30071.8s 4905 Corrected dt: 2.117973e-01 s
30071.8s 4906 Correction factor: 1.6x
30071.8s 4907 Max wave speed detected: 23.61 m/s
30072.1s 4908 Stored output at t = 1005.0000 s (Step 4689)
30072.1s 4909 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 990.0/1005.0 [00:00<?, ?s/s][A
30072.1s 4910 [A
30072.1s 4911 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.01s/s]
30072.1s 4912 
30072.1s 4913 Simulation finished at t = 1005.0000 s after 4689 steps.
30072.1s 4914 Total runtime: 0.63 seconds.
30072.1s 4915 [REWARD_MICROSCOPE] step=13987 t=1005.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30072.1s 4916 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30072.1s 4917 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30072.1s 4918 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30072.1s 4919 Running simulation until t = 1020.00 s, outputting every 15.00 s
30072.1s 4920 
30072.2s 4921 [PROGRESS] Step 4700: t=1007.33/1020.00s (98.8%) | dt=0.2118s
30072.6s 4922 [PROGRESS] Step 4750: t=1017.92/1020.00s (99.8%) | dt=0.2118s
30072.7s 4923 [WARNING] Automatic CFL correction applied (count: 3309000):
30072.7s 4924 Calculated CFL: 0.800 > Limit: 0.500
30072.7s 4925 Original dt: 3.388750e-01 s
30072.7s 4926 Corrected dt: 2.117968e-01 s
30072.7s 4927 Correction factor: 1.6x
30072.7s 4928 Max wave speed detected: 23.61 m/s
30072.7s 4929 Stored output at t = 1020.0000 s (Step 4760)
30072.7s 4930 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1005.0/1020.0 [00:00<?, ?s/s][A
30072.7s 4931 [A
30072.7s 4932 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.23s/s]
30072.7s 4933 
30072.7s 4934 Simulation finished at t = 1020.0000 s after 4760 steps.
30072.7s 4935 Total runtime: 0.62 seconds.
30072.7s 4936 [REWARD_MICROSCOPE] step=13988 t=1020.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30072.7s 4937 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30072.7s 4938 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30072.7s 4939 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30072.7s 4940 Running simulation until t = 1035.00 s, outputting every 15.00 s
30072.7s 4941 
30073.1s 4942 [PROGRESS] Step 4800: t=1028.47/1035.00s (99.4%) | dt=0.2118s
30073.4s 4943 Stored output at t = 1035.0000 s (Step 4831)
30073.4s 4944 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1020.0/1035.0 [00:00<?, ?s/s][A
30073.4s 4945 [A
30073.4s 4946 
30073.4s 4947 Simulation finished at t = 1035.0000 s after 4831 steps.
30073.4s 4948 Total runtime: 0.62 seconds.
30073.4s 4949 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.21s/s]
30073.4s 4950 [REWARD_MICROSCOPE] step=13989 t=1035.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30073.4s 4951 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30073.4s 4952 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30073.4s 4953 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30073.4s 4954 Running simulation until t = 1050.00 s, outputting every 15.00 s
30073.4s 4955 
30073.5s 4956 [PROGRESS] Step 4850: t=1039.02/1050.00s (99.0%) | dt=0.2118s
30073.6s 4957 [WARNING] Automatic CFL correction applied (count: 3309100):
30073.6s 4958 Calculated CFL: 0.800 > Limit: 0.500
30073.6s 4959 Original dt: 3.388751e-01 s
30073.6s 4960 Corrected dt: 2.117969e-01 s
30073.6s 4961 Correction factor: 1.6x
30073.6s 4962 Max wave speed detected: 23.61 m/s
30074.0s 4963 [PROGRESS] Step 4900: t=1049.61/1050.00s (100.0%) | dt=0.2118s
30074.0s 4964 [PERIODIC:1000] BC_DISPATCHER [Call #13237000] current_bc_params: <class 'dict'>
30074.0s 4965 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30074.0s 4966 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30074.0s 4967 [PERIODIC:1000] BC_GPU [Call #13237000] About to launch kernel
30074.0s 4968 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30074.0s 4969 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30074.0s 4970 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30074.0s 4971 Stored output at t = 1050.0000 s (Step 4902)
30074.0s 4972 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1035.0/1050.0 [00:00<?, ?s/s][A
30074.0s 4973 [A
30074.0s 4974 
30074.0s 4975 Simulation finished at t = 1050.0000 s after 4902 steps.
30074.0s 4976 Total runtime: 0.64 seconds.
30074.0s 4977 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 23.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 23.32s/s]
30074.0s 4978 [REWARD_MICROSCOPE] step=13990 t=1050.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30074.0s 4979 [STEP   70] t= 1050.0s | phase=0 | reward=   0.01 | total_reward=    0.50
30074.0s 4980 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30074.0s 4981 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30074.0s 4982 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30074.0s 4983 Running simulation until t = 1065.00 s, outputting every 15.00 s
30074.0s 4984 
30074.4s 4985 [PROGRESS] Step 4950: t=1060.17/1065.00s (99.5%) | dt=0.2121s
30074.5s 4986 [WARNING] Automatic CFL correction applied (count: 3309200):
30074.5s 4987 Calculated CFL: 0.800 > Limit: 0.500
30074.5s 4988 Original dt: 3.398060e-01 s
30074.5s 4989 Corrected dt: 2.123787e-01 s
30074.5s 4990 Correction factor: 1.6x
30074.5s 4991 Max wave speed detected: 23.54 m/s
30074.6s 4992 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1050.0/1065.0 [00:00<?, ?s/s][A
30074.6s 4993 [A
30074.6s 4994 Stored output at t = 1065.0000 s (Step 4973)
30074.6s 4995 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.33s/s]
30074.6s 4996 
30074.6s 4997 Simulation finished at t = 1065.0000 s after 4973 steps.
30074.6s 4998 Total runtime: 0.62 seconds.
30074.6s 4999 [QUEUE_DIAGNOSTIC] ===== Step 70 t=1065.0s =====
30074.6s 5000 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30074.6s 5001 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568692 1.         0.03926951 1.        ] (rho_m, v_m, rho_c, v_c)
30074.6s 5002 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30074.6s 5003 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30074.6s 5004 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30074.6s 5005 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470608 0.00449104 0.00441438 0.00438329 0.00436943 0.00436219]
30074.6s 5006 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589043 0.00546918 0.00523369 0.00510026 0.00502879 0.00499201]
30074.6s 5007 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30074.6s 5008 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30074.6s 5009 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30074.6s 5010 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30074.6s 5011 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30074.6s 5012 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30074.6s 5013 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30074.6s 5014 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30074.6s 5015 [REWARD_MICROSCOPE] step=13991 t=1065.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30074.6s 5016 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30074.6s 5017 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30074.6s 5018 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30074.6s 5019 Running simulation until t = 1080.00 s, outputting every 15.00 s
30074.6s 5020 
30074.9s 5021 [PROGRESS] Step 5000: t=1070.75/1080.00s (99.1%) | dt=0.2131s
30075.2s 5022 Stored output at t = 1080.0000 s (Step 5044)
30075.2s 5023 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1065.0/1080.0 [00:00<?, ?s/s][A
30075.2s 5024 [A
30075.2s 5025 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.35s/s]
30075.2s 5026 
30075.2s 5027 Simulation finished at t = 1080.0000 s after 5044 steps.
30075.2s 5028 Total runtime: 0.62 seconds.
30075.2s 5029 [REWARD_MICROSCOPE] step=13992 t=1080.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30075.2s 5030 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30075.2s 5031 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30075.2s 5032 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30075.2s 5033 Running simulation until t = 1095.00 s, outputting every 15.00 s
30075.2s 5034 
30075.3s 5035 [PROGRESS] Step 5050: t=1081.27/1095.00s (98.7%) | dt=0.2124s
30075.4s 5036 [WARNING] Automatic CFL correction applied (count: 3309300):
30075.4s 5037 Calculated CFL: 0.800 > Limit: 0.500
30075.4s 5038 Original dt: 3.397193e-01 s
30075.4s 5039 Corrected dt: 2.123246e-01 s
30075.4s 5040 Correction factor: 1.6x
30075.4s 5041 Max wave speed detected: 23.55 m/s
30075.7s 5042 [PROGRESS] Step 5100: t=1091.90/1095.00s (99.7%) | dt=0.2127s
30075.9s 5043 Stored output at t = 1095.0000 s (Step 5115)
30075.9s 5044 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1080.0/1095.0 [00:00<?, ?s/s][A
30075.9s 5045 [A
30075.9s 5046 
30075.9s 5047 Simulation finished at t = 1095.0000 s after 5115 steps.
30075.9s 5048 Total runtime: 0.61 seconds.
30075.9s 5049 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.43s/s]
30075.9s 5050 [REWARD_MICROSCOPE] step=13993 t=1095.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30075.9s 5051 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30075.9s 5052 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30075.9s 5053 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30075.9s 5054 Running simulation until t = 1110.00 s, outputting every 15.00 s
30075.9s 5055 
30076.5s 5056 [PROGRESS] Step 5150: t=1102.45/1110.00s (99.3%) | dt=0.2131s
30076.6s 5057 [PERIODIC:1000] BC_DISPATCHER [Call #13238000] current_bc_params: <class 'dict'>
30076.6s 5058 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30076.6s 5059 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30076.6s 5060 [PERIODIC:1000] BC_GPU [Call #13238000] About to launch kernel
30076.6s 5061 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30076.6s 5062 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30076.6s 5063 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30076.6s 5064 [WARNING] Automatic CFL correction applied (count: 3309400):
30076.6s 5065 Calculated CFL: 0.800 > Limit: 0.500
30076.6s 5066 Original dt: 3.411059e-01 s
30076.6s 5067 Corrected dt: 2.131912e-01 s
30076.6s 5068 Correction factor: 1.6x
30076.6s 5069 Max wave speed detected: 23.45 m/s
30076.9s 5070 Stored output at t = 1110.0000 s (Step 5186)
30076.9s 5071 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1095.0/1110.0 [00:00<?, ?s/s][A
30076.9s 5072 [A
30076.9s 5073 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:01<00:00, 14.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:01<00:00, 14.88s/s]
30076.9s 5074 
30076.9s 5075 Simulation finished at t = 1110.0000 s after 5186 steps.
30076.9s 5076 Total runtime: 1.01 seconds.
30076.9s 5077 [REWARD_MICROSCOPE] step=13994 t=1110.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30076.9s 5078 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30076.9s 5079 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30076.9s 5080 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30076.9s 5081 Running simulation until t = 1125.00 s, outputting every 15.00 s
30076.9s 5082 
30077.0s 5083 [PROGRESS] Step 5200: t=1112.97/1125.00s (98.9%) | dt=0.2123s
30077.4s 5084 [PROGRESS] Step 5250: t=1123.60/1125.00s (99.9%) | dt=0.2128s
30077.5s 5085 [WARNING] Automatic CFL correction applied (count: 3309500):
30077.5s 5086 Calculated CFL: 0.800 > Limit: 0.500
30077.5s 5087 Original dt: 3.405361e-01 s
30077.5s 5088 Corrected dt: 2.128351e-01 s
30077.5s 5089 Correction factor: 1.6x
30077.5s 5090 Max wave speed detected: 23.49 m/s
30077.5s 5091 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1110.0/1125.0 [00:00<?, ?s/s][A
30077.5s 5092 Stored output at t = 1125.0000 s (Step 5257)
30077.5s 5093 [A
30077.5s 5094 
30077.5s 5095 Simulation finished at t = 1125.0000 s after 5257 steps.
30077.5s 5096 Total runtime: 0.63 seconds.
30077.5s 5097 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 23.95s/s]
30077.5s 5098 [REWARD_MICROSCOPE] step=13995 t=1125.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30077.5s 5099 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30077.5s 5100 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30077.5s 5101 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30077.5s 5102 Running simulation until t = 1140.00 s, outputting every 15.00 s
30077.5s 5103 
30077.9s 5104 [PROGRESS] Step 5300: t=1134.16/1140.00s (99.5%) | dt=0.2132s
30078.1s 5105 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1125.0/1140.0 [00:00<?, ?s/s][A
30078.1s 5106 [A
30078.1s 5107 Stored output at t = 1140.0000 s (Step 5328)
30078.1s 5108 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.30s/s]
30078.1s 5109 
30078.1s 5110 Simulation finished at t = 1140.0000 s after 5328 steps.
30078.1s 5111 Total runtime: 0.62 seconds.
30078.1s 5112 [REWARD_MICROSCOPE] step=13996 t=1140.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30078.1s 5113 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30078.1s 5114 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30078.1s 5115 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30078.1s 5116 Running simulation until t = 1155.00 s, outputting every 15.00 s
30078.1s 5117 
30078.3s 5118 [PROGRESS] Step 5350: t=1144.67/1155.00s (99.1%) | dt=0.2124s
30078.4s 5119 [WARNING] Automatic CFL correction applied (count: 3309600):
30078.4s 5120 Calculated CFL: 0.800 > Limit: 0.500
30078.4s 5121 Original dt: 3.399493e-01 s
30078.4s 5122 Corrected dt: 2.124683e-01 s
30078.4s 5123 Correction factor: 1.6x
30078.4s 5124 Max wave speed detected: 23.53 m/s
30078.7s 5125 Stored output at t = 1155.0000 s (Step 5399)
30078.7s 5126 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1140.0/1155.0 [00:00<?, ?s/s][A
30078.7s 5127 [A
30078.7s 5128 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.56s/s]
30078.7s 5129 
30078.7s 5130 Simulation finished at t = 1155.0000 s after 5399 steps.
30078.7s 5131 Total runtime: 0.61 seconds.
30078.7s 5132 [REWARD_MICROSCOPE] step=13997 t=1155.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30078.7s 5133 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30078.7s 5134 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30078.7s 5135 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30078.7s 5136 Running simulation until t = 1170.00 s, outputting every 15.00 s
30078.7s 5137 
30078.7s 5138 [PROGRESS] Step 5400: t=1155.21/1170.00s (98.7%) | dt=0.2128s
30078.8s 5139 [PERIODIC:1000] BC_DISPATCHER [Call #13239000] current_bc_params: <class 'dict'>
30078.8s 5140 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30078.8s 5141 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30078.8s 5142 [PERIODIC:1000] BC_GPU [Call #13239000] About to launch kernel
30078.8s 5143 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30078.8s 5144 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30078.8s 5145 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30079.2s 5146 [PROGRESS] Step 5450: t=1165.87/1170.00s (99.6%) | dt=0.2133s
30079.2s 5147 [WARNING] Automatic CFL correction applied (count: 3309700):
30079.2s 5148 Calculated CFL: 0.800 > Limit: 0.500
30079.2s 5149 Original dt: 3.409227e-01 s
30079.2s 5150 Corrected dt: 2.130767e-01 s
30079.2s 5151 Correction factor: 1.6x
30079.2s 5152 Max wave speed detected: 23.47 m/s
30079.4s 5153 Stored output at t = 1170.0000 s (Step 5470)
30079.4s 5154 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1155.0/1170.0 [00:00<?, ?s/s][A
30079.4s 5155 [A
30079.4s 5156 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.04s/s]
30079.4s 5157 
30079.4s 5158 Simulation finished at t = 1170.0000 s after 5470 steps.
30079.4s 5159 Total runtime: 0.62 seconds.
30079.4s 5160 [REWARD_MICROSCOPE] step=13998 t=1170.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30079.4s 5161 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30079.4s 5162 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30079.4s 5163 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30079.4s 5164 Running simulation until t = 1185.00 s, outputting every 15.00 s
30079.4s 5165 
30079.6s 5166 [PROGRESS] Step 5500: t=1176.37/1185.00s (99.3%) | dt=0.2125s
30080.0s 5167 Stored output at t = 1185.0000 s (Step 5541)
30080.0s 5168 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1170.0/1185.0 [00:00<?, ?s/s][A
30080.0s 5169 [A
30080.0s 5170 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.28s/s]
30080.0s 5171 
30080.0s 5172 Simulation finished at t = 1185.0000 s after 5541 steps.
30080.0s 5173 Total runtime: 0.62 seconds.
30080.0s 5174 [REWARD_MICROSCOPE] step=13999 t=1185.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30080.0s 5175 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30080.0s 5176 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30080.0s 5177 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30080.0s 5178 Running simulation until t = 1200.00 s, outputting every 15.00 s
30080.0s 5179 
30080.1s 5180 [PROGRESS] Step 5550: t=1186.92/1200.00s (98.9%) | dt=0.2129s
30080.1s 5181 [WARNING] Automatic CFL correction applied (count: 3309800):
30080.1s 5182 Calculated CFL: 0.800 > Limit: 0.500
30080.1s 5183 Original dt: 3.407491e-01 s
30080.1s 5184 Corrected dt: 2.129682e-01 s
30080.1s 5185 Correction factor: 1.6x
30080.1s 5186 Max wave speed detected: 23.48 m/s
30080.5s 5187 [PROGRESS] Step 5600: t=1197.57/1200.00s (99.8%) | dt=0.2130s
30080.6s 5188 Stored output at t = 1200.0000 s (Step 5612)
30080.6s 5189 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1185.0/1200.0 [00:00<?, ?s/s][A
30080.6s 5190 [A
30080.6s 5191 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 24.26s/s]
30080.6s 5192 
30080.6s 5193 Simulation finished at t = 1200.0000 s after 5612 steps.
30080.6s 5194 Total runtime: 0.62 seconds.
30080.6s 5195 [REWARD_MICROSCOPE] step=14000 t=1200.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30080.6s 5196 [STEP   80] t= 1200.0s | phase=0 | reward=   0.01 | total_reward=    0.60
30080.6s 5197 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30080.6s 5198 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30080.6s 5199 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30080.6s 5200 Running simulation until t = 1215.00 s, outputting every 15.00 s
30080.6s 5201 
30081.0s 5202 [PROGRESS] Step 5650: t=1208.07/1215.00s (99.4%) | dt=0.2125s
30081.0s 5203 [PERIODIC:1000] BC_DISPATCHER [Call #13240000] current_bc_params: <class 'dict'>
30081.0s 5204 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30081.0s 5205 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30081.0s 5206 [PERIODIC:1000] BC_GPU [Call #13240000] About to launch kernel
30081.0s 5207 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30081.0s 5208 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30081.0s 5209 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30081.0s 5210 [WARNING] Automatic CFL correction applied (count: 3309900):
30081.0s 5211 Calculated CFL: 0.800 > Limit: 0.500
30081.0s 5212 Original dt: 3.401756e-01 s
30081.0s 5213 Corrected dt: 2.126097e-01 s
30081.0s 5214 Correction factor: 1.6x
30081.0s 5215 Max wave speed detected: 23.52 m/s
30081.3s 5216 Stored output at t = 1215.0000 s (Step 5683)
30081.3s 5217 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1200.0/1215.0 [00:00<?, ?s/s][A
30081.3s 5218 [A
30081.3s 5219 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 22.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 22.98s/s]
30081.3s 5220 
30081.3s 5221 Simulation finished at t = 1215.0000 s after 5683 steps.
30081.3s 5222 Total runtime: 0.65 seconds.
30081.3s 5223 [QUEUE_DIAGNOSTIC] ===== Step 80 t=1215.0s =====
30081.3s 5224 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30081.3s 5225 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30081.3s 5226 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30081.3s 5227 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30081.3s 5228 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30081.3s 5229 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30081.3s 5230 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30081.3s 5231 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30081.3s 5232 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30081.3s 5233 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30081.3s 5234 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30081.3s 5235 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30081.3s 5236 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30081.3s 5237 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30081.3s 5238 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30081.3s 5239 [REWARD_MICROSCOPE] step=14001 t=1215.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30081.3s 5240 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30081.3s 5241 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30081.3s 5242 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30081.3s 5243 Running simulation until t = 1230.00 s, outputting every 15.00 s
30081.3s 5244 
30081.4s 5245 [PROGRESS] Step 5700: t=1218.62/1230.00s (99.1%) | dt=0.2130s
30081.9s 5246 [PROGRESS] Step 5750: t=1229.27/1230.00s (99.9%) | dt=0.2127s
30082.0s 5247 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1215.0/1230.0 [00:00<?, ?s/s][A
30082.0s 5248 [A
30082.0s 5249 Stored output at t = 1230.0000 s (Step 5754)
30082.0s 5250 
30082.0s 5251 Simulation finished at t = 1230.0000 s after 5754 steps.
30082.0s 5252 Total runtime: 0.70 seconds.
30082.0s 5253 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 21.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 21.51s/s]
30082.0s 5254 [REWARD_MICROSCOPE] step=14002 t=1230.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30082.0s 5255 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30082.0s 5256 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30082.0s 5257 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30082.0s 5258 Running simulation until t = 1245.00 s, outputting every 15.00 s
30082.0s 5259 
30082.0s 5260 [WARNING] Automatic CFL correction applied (count: 3310000):
30082.0s 5261 Calculated CFL: 0.800 > Limit: 0.500
30082.0s 5262 Original dt: 3.399530e-01 s
30082.0s 5263 Corrected dt: 2.124706e-01 s
30082.0s 5264 Correction factor: 1.6x
30082.0s 5265 Max wave speed detected: 23.53 m/s
30082.4s 5266 [PROGRESS] Step 5800: t=1239.77/1245.00s (99.6%) | dt=0.2126s
30082.6s 5267 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1230.0/1245.0 [00:00<?, ?s/s][A
30082.6s 5268 Stored output at t = 1245.0000 s (Step 5825)
30082.6s 5269 [A
30082.6s 5270 
30082.6s 5271 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.65s/s]
30082.6s 5272 Simulation finished at t = 1245.0000 s after 5825 steps.
30082.6s 5273 Total runtime: 0.63 seconds.
30082.6s 5274 [REWARD_MICROSCOPE] step=14003 t=1245.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30082.6s 5275 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30082.6s 5276 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30082.6s 5277 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30082.6s 5278 Running simulation until t = 1260.00 s, outputting every 15.00 s
30082.6s 5279 
30082.8s 5280 [PROGRESS] Step 5850: t=1250.32/1260.00s (99.2%) | dt=0.2130s
30082.9s 5281 [WARNING] Automatic CFL correction applied (count: 3310100):
30082.9s 5282 Calculated CFL: 0.800 > Limit: 0.500
30082.9s 5283 Original dt: 3.409728e-01 s
30082.9s 5284 Corrected dt: 2.131080e-01 s
30082.9s 5285 Correction factor: 1.6x
30082.9s 5286 Max wave speed detected: 23.46 m/s
30083.2s 5287 Stored output at t = 1260.0000 s (Step 5896)
30083.2s 5288 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1245.0/1260.0 [00:00<?, ?s/s][A
30083.2s 5289 [A
30083.2s 5290 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 23.94s/s]
30083.2s 5291 
30083.2s 5292 Simulation finished at t = 1260.0000 s after 5896 steps.
30083.2s 5293 Total runtime: 0.63 seconds.
30083.2s 5294 [REWARD_MICROSCOPE] step=14004 t=1260.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30083.2s 5295 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30083.2s 5296 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30083.2s 5297 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30083.2s 5298 Running simulation until t = 1275.00 s, outputting every 15.00 s
30083.2s 5299 
30083.3s 5300 [PROGRESS] Step 5900: t=1260.85/1275.00s (98.9%) | dt=0.2124s
30083.3s 5301 [PERIODIC:1000] BC_DISPATCHER [Call #13241000] current_bc_params: <class 'dict'>
30083.3s 5302 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30083.3s 5303 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30083.3s 5304 [PERIODIC:1000] BC_GPU [Call #13241000] About to launch kernel
30083.3s 5305 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30083.3s 5306 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30083.3s 5307 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30083.8s 5308 [PROGRESS] Step 5950: t=1271.47/1275.00s (99.7%) | dt=0.2127s
30083.8s 5309 [WARNING] Automatic CFL correction applied (count: 3310200):
30083.8s 5310 Calculated CFL: 0.800 > Limit: 0.500
30083.8s 5311 Original dt: 3.403992e-01 s
30083.8s 5312 Corrected dt: 2.127495e-01 s
30083.8s 5313 Correction factor: 1.6x
30083.8s 5314 Max wave speed detected: 23.50 m/s
30083.9s 5315 Stored output at t = 1275.0000 s (Step 5967)
30083.9s 5316 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1260.0/1275.0 [00:00<?, ?s/s][A
30083.9s 5317 [A
30083.9s 5318 
30083.9s 5319 Simulation finished at t = 1275.0000 s after 5967 steps.
30083.9s 5320 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 22.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 22.56s/s]
30083.9s 5321 Total runtime: 0.67 seconds.
30083.9s 5322 [REWARD_MICROSCOPE] step=14005 t=1275.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30083.9s 5323 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30083.9s 5324 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30083.9s 5325 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30083.9s 5326 Running simulation until t = 1290.00 s, outputting every 15.00 s
30083.9s 5327 
30084.2s 5328 [PROGRESS] Step 6000: t=1282.03/1290.00s (99.4%) | dt=0.2131s
30084.5s 5329 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1275.0/1290.0 [00:00<?, ?s/s][A
30084.5s 5330 [A
30084.5s 5331 Stored output at t = 1290.0000 s (Step 6038)
30084.5s 5332 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.40s/s]
30084.5s 5333 
30084.5s 5334 Simulation finished at t = 1290.0000 s after 6038 steps.
30084.5s 5335 Total runtime: 0.62 seconds.
30084.5s 5336 [REWARD_MICROSCOPE] step=14006 t=1290.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30084.5s 5337 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30084.5s 5338 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30084.5s 5339 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30084.5s 5340 Running simulation until t = 1305.00 s, outputting every 15.00 s
30084.5s 5341 
30084.6s 5342 [PROGRESS] Step 6050: t=1292.55/1305.00s (99.0%) | dt=0.2123s
30084.7s 5343 [WARNING] Automatic CFL correction applied (count: 3310300):
30084.7s 5344 Calculated CFL: 0.800 > Limit: 0.500
30084.7s 5345 Original dt: 3.397973e-01 s
30084.7s 5346 Corrected dt: 2.123733e-01 s
30084.7s 5347 Correction factor: 1.6x
30084.7s 5348 Max wave speed detected: 23.54 m/s
30085.1s 5349 [PROGRESS] Step 6100: t=1303.18/1305.00s (99.9%) | dt=0.2128s
30085.1s 5350 Stored output at t = 1305.0000 s (Step 6109)
30085.1s 5351 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1290.0/1305.0 [00:00<?, ?s/s][A
30085.1s 5352 [A
30085.1s 5353 
30085.1s 5354 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.05s/s]
30085.1s 5355 Simulation finished at t = 1305.0000 s after 6109 steps.
30085.1s 5356 Total runtime: 0.62 seconds.
30085.2s 5357 [REWARD_MICROSCOPE] step=14007 t=1305.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30085.2s 5358 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30085.2s 5359 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30085.2s 5360 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30085.2s 5361 Running simulation until t = 1320.00 s, outputting every 15.00 s
30085.2s 5362 
30085.5s 5363 [PROGRESS] Step 6150: t=1313.73/1320.00s (99.5%) | dt=0.2132s
30085.5s 5364 [PERIODIC:1000] BC_DISPATCHER [Call #13242000] current_bc_params: <class 'dict'>
30085.5s 5365 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30085.5s 5366 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30085.5s 5367 [PERIODIC:1000] BC_GPU [Call #13242000] About to launch kernel
30085.5s 5368 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30085.5s 5369 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30085.5s 5370 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30085.6s 5371 [WARNING] Automatic CFL correction applied (count: 3310400):
30085.6s 5372 Calculated CFL: 0.800 > Limit: 0.500
30085.6s 5373 Original dt: 3.411876e-01 s
30085.6s 5374 Corrected dt: 2.132423e-01 s
30085.6s 5375 Correction factor: 1.6x
30085.6s 5376 Max wave speed detected: 23.45 m/s
30085.8s 5377 Stored output at t = 1320.0000 s (Step 6180)
30085.8s 5378 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1305.0/1320.0 [00:00<?, ?s/s][A
30085.8s 5379 [A
30085.8s 5380 
30085.8s 5381 Simulation finished at t = 1320.0000 s after 6180 steps.
30085.8s 5382 Total runtime: 0.61 seconds.
30085.8s 5383 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 24.56s/s]
30085.8s 5384 [REWARD_MICROSCOPE] step=14008 t=1320.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30085.8s 5385 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30085.8s 5386 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30085.8s 5387 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30085.8s 5388 Running simulation until t = 1335.00 s, outputting every 15.00 s
30085.8s 5389 
30085.9s 5390 [PROGRESS] Step 6200: t=1324.25/1335.00s (99.2%) | dt=0.2124s
30086.4s 5391 [PROGRESS] Step 6250: t=1334.88/1335.00s (100.0%) | dt=0.2128s
30086.4s 5392 Stored output at t = 1335.0000 s (Step 6251)
30086.4s 5393 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1320.0/1335.0 [00:00<?, ?s/s][A
30086.4s 5394 [A
30086.4s 5395 
30086.4s 5396 Simulation finished at t = 1335.0000 s after 6251 steps.
30086.4s 5397 Total runtime: 0.61 seconds.
30086.4s 5398 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 24.45s/s]
30086.4s 5399 [REWARD_MICROSCOPE] step=14009 t=1335.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30086.4s 5400 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30086.4s 5401 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30086.4s 5402 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30086.4s 5403 Running simulation until t = 1350.00 s, outputting every 15.00 s
30086.4s 5404 
30086.4s 5405 [WARNING] Automatic CFL correction applied (count: 3310500):
30086.4s 5406 Calculated CFL: 0.800 > Limit: 0.500
30086.4s 5407 Original dt: 3.406104e-01 s
30086.4s 5408 Corrected dt: 2.128815e-01 s
30086.4s 5409 Correction factor: 1.6x
30086.4s 5410 Max wave speed detected: 23.49 m/s
30086.8s 5411 [PROGRESS] Step 6300: t=1345.44/1350.00s (99.7%) | dt=0.2133s
30087.0s 5412 Stored output at t = 1350.0000 s (Step 6322)
30087.0s 5413 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1335.0/1350.0 [00:00<?, ?s/s][A
30087.0s 5414 [A
30087.0s 5415 
30087.0s 5416 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.07s/s]
30087.0s 5417 Simulation finished at t = 1350.0000 s after 6322 steps.
30087.0s 5418 Total runtime: 0.62 seconds.
30087.0s 5419 [REWARD_MICROSCOPE] step=14010 t=1350.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30087.0s 5420 [STEP   90] t= 1350.0s | phase=0 | reward=   0.01 | total_reward=    0.70
30087.0s 5421 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30087.0s 5422 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30087.0s 5423 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30087.0s 5424 Running simulation until t = 1365.00 s, outputting every 15.00 s
30087.0s 5425 
30087.3s 5426 [PROGRESS] Step 6350: t=1355.95/1365.00s (99.3%) | dt=0.2125s
30087.3s 5427 [WARNING] Automatic CFL correction applied (count: 3310600):
30087.3s 5428 Calculated CFL: 0.800 > Limit: 0.500
30087.3s 5429 Original dt: 3.400365e-01 s
30087.3s 5430 Corrected dt: 2.125228e-01 s
30087.3s 5431 Correction factor: 1.6x
30087.3s 5432 Max wave speed detected: 23.53 m/s
30087.6s 5433 Stored output at t = 1365.0000 s (Step 6393)
30087.6s 5434 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
30087.6s 5435 [A
30087.6s 5436 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.48s/s]
30087.6s 5437 
30087.6s 5438 Simulation finished at t = 1365.0000 s after 6393 steps.
30087.6s 5439 Total runtime: 0.61 seconds.
30087.6s 5440 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
30087.6s 5441 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30087.6s 5442 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30087.6s 5443 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30087.6s 5444 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30087.6s 5445 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30087.6s 5446 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30087.6s 5447 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30087.6s 5448 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30087.6s 5449 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30087.6s 5450 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30087.6s 5451 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30087.6s 5452 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30087.6s 5453 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30087.6s 5454 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30087.6s 5455 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30087.6s 5456 [REWARD_MICROSCOPE] step=14011 t=1365.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30087.6s 5457 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30087.6s 5458 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30087.6s 5459 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30087.6s 5460 Running simulation until t = 1380.00 s, outputting every 15.00 s
30087.6s 5461 
30087.7s 5462 [PROGRESS] Step 6400: t=1366.49/1380.00s (99.0%) | dt=0.2129s
30087.7s 5463 [PERIODIC:1000] BC_DISPATCHER [Call #13243000] current_bc_params: <class 'dict'>
30087.7s 5464 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30087.7s 5465 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30087.7s 5466 [PERIODIC:1000] BC_GPU [Call #13243000] About to launch kernel
30087.7s 5467 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30087.7s 5468 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30087.7s 5469 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30088.1s 5470 [PROGRESS] Step 6450: t=1377.15/1380.00s (99.8%) | dt=0.2131s
30088.2s 5471 [WARNING] Automatic CFL correction applied (count: 3310700):
30088.2s 5472 Calculated CFL: 0.800 > Limit: 0.500
30088.2s 5473 Original dt: 3.404624e-01 s
30088.2s 5474 Corrected dt: 2.127890e-01 s
30088.2s 5475 Correction factor: 1.6x
30088.2s 5476 Max wave speed detected: 23.50 m/s
30088.2s 5477 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
30088.2s 5478 [A
30088.2s 5479 Stored output at t = 1380.0000 s (Step 6464)
30088.2s 5480 
30088.2s 5481 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.51s/s]
30088.2s 5482 Simulation finished at t = 1380.0000 s after 6464 steps.
30088.2s 5483 Total runtime: 0.61 seconds.
30088.2s 5484 [REWARD_MICROSCOPE] step=14012 t=1380.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30088.2s 5485 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30088.2s 5486 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30088.2s 5487 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30088.2s 5488 Running simulation until t = 1395.00 s, outputting every 15.00 s
30088.2s 5489 
30088.6s 5490 [PROGRESS] Step 6500: t=1387.65/1395.00s (99.5%) | dt=0.2125s
30088.9s 5491 Stored output at t = 1395.0000 s (Step 6535)
30088.9s 5492 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
30088.9s 5493 [A
30088.9s 5494 
30088.9s 5495 Simulation finished at t = 1395.0000 s after 6535 steps.
30088.9s 5496 Total runtime: 0.62 seconds.
30088.9s 5497 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.25s/s]
30088.9s 5498 [REWARD_MICROSCOPE] step=14013 t=1395.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30088.9s 5499 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30088.9s 5500 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30088.9s 5501 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30088.9s 5502 Running simulation until t = 1410.00 s, outputting every 15.00 s
30088.9s 5503 
30089.0s 5504 [PROGRESS] Step 6550: t=1398.19/1410.00s (99.2%) | dt=0.2130s
30089.1s 5505 [WARNING] Automatic CFL correction applied (count: 3310800):
30089.1s 5506 Calculated CFL: 0.800 > Limit: 0.500
30089.1s 5507 Original dt: 3.408331e-01 s
30089.1s 5508 Corrected dt: 2.130207e-01 s
30089.1s 5509 Correction factor: 1.6x
30089.1s 5510 Max wave speed detected: 23.47 m/s
30089.4s 5511 [PROGRESS] Step 6600: t=1408.85/1410.00s (99.9%) | dt=0.2127s
30089.5s 5512 Stored output at t = 1410.0000 s (Step 6606)
30089.5s 5513 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
30089.5s 5514 [A
30089.5s 5515 
30089.5s 5516 Simulation finished at t = 1410.0000 s after 6606 steps.
30089.5s 5517 Total runtime: 0.61 seconds.
30089.5s 5518 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.54s/s]
30089.5s 5519 [REWARD_MICROSCOPE] step=14014 t=1410.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30089.5s 5520 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30089.5s 5521 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30089.5s 5522 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30089.5s 5523 Running simulation until t = 1425.00 s, outputting every 15.00 s
30089.5s 5524 
30089.9s 5525 [PROGRESS] Step 6650: t=1419.35/1425.00s (99.6%) | dt=0.2126s
30089.9s 5526 [PERIODIC:1000] BC_DISPATCHER [Call #13244000] current_bc_params: <class 'dict'>
30089.9s 5527 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30089.9s 5528 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30089.9s 5529 [PERIODIC:1000] BC_GPU [Call #13244000] About to launch kernel
30089.9s 5530 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30089.9s 5531 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30089.9s 5532 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30089.9s 5533 [WARNING] Automatic CFL correction applied (count: 3310900):
30089.9s 5534 Calculated CFL: 0.800 > Limit: 0.500
30089.9s 5535 Original dt: 3.402592e-01 s
30089.9s 5536 Corrected dt: 2.126620e-01 s
30089.9s 5537 Correction factor: 1.6x
30089.9s 5538 Max wave speed detected: 23.51 m/s
30090.1s 5539 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
30090.1s 5540 [A
30090.1s 5541 Stored output at t = 1425.0000 s (Step 6677)
30090.1s 5542 
30090.1s 5543 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.33s/s]
30090.1s 5544 Simulation finished at t = 1425.0000 s after 6677 steps.
30090.1s 5545 Total runtime: 0.62 seconds.
30090.1s 5546 [REWARD_MICROSCOPE] step=14015 t=1425.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30090.1s 5547 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30090.1s 5548 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30090.1s 5549 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30090.1s 5550 Running simulation until t = 1440.00 s, outputting every 15.00 s
30090.1s 5551 
30090.3s 5552 [PROGRESS] Step 6700: t=1429.90/1440.00s (99.3%) | dt=0.2130s
30090.7s 5553 Stored output at t = 1440.0000 s (Step 6748)
30090.7s 5554 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
30090.7s 5555 [A
30090.7s 5556 
30090.7s 5557 Simulation finished at t = 1440.0000 s after 6748 steps.
30090.7s 5558 Total runtime: 0.62 seconds.
30090.7s 5559 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.34s/s]
30090.7s 5560 [REWARD_MICROSCOPE] step=14016 t=1440.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30090.7s 5561 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30090.7s 5562 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30090.7s 5563 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30090.7s 5564 Running simulation until t = 1455.00 s, outputting every 15.00 s
30090.7s 5565 
30090.7s 5566 [PROGRESS] Step 6750: t=1440.43/1455.00s (99.0%) | dt=0.2125s
30090.8s 5567 [WARNING] Automatic CFL correction applied (count: 3311000):
30090.8s 5568 Calculated CFL: 0.800 > Limit: 0.500
30090.8s 5569 Original dt: 3.397413e-01 s
30090.8s 5570 Corrected dt: 2.123383e-01 s
30090.8s 5571 Correction factor: 1.6x
30090.8s 5572 Max wave speed detected: 23.55 m/s
30091.2s 5573 [PROGRESS] Step 6800: t=1451.05/1455.00s (99.7%) | dt=0.2127s
30091.4s 5574 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
30091.4s 5575 [A
30091.4s 5576 Stored output at t = 1455.0000 s (Step 6819)
30091.4s 5577 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.50s/s]
30091.4s 5578 
30091.4s 5579 Simulation finished at t = 1455.0000 s after 6819 steps.
30091.4s 5580 Total runtime: 0.64 seconds.
30091.4s 5581 [REWARD_MICROSCOPE] step=14017 t=1455.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30091.4s 5582 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30091.4s 5583 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30091.4s 5584 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30091.4s 5585 Running simulation until t = 1470.00 s, outputting every 15.00 s
30091.4s 5586 
30091.6s 5587 [PROGRESS] Step 6850: t=1461.60/1470.00s (99.4%) | dt=0.2131s
30091.7s 5588 [WARNING] Automatic CFL correction applied (count: 3311100):
30091.7s 5589 Calculated CFL: 0.800 > Limit: 0.500
30091.7s 5590 Original dt: 3.410527e-01 s
30091.7s 5591 Corrected dt: 2.131579e-01 s
30091.7s 5592 Correction factor: 1.6x
30091.7s 5593 Max wave speed detected: 23.46 m/s
30092.0s 5594 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
30092.0s 5595 [A
30092.0s 5596 Stored output at t = 1470.0000 s (Step 6890)
30092.0s 5597 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 23.96s/s]
30092.0s 5598 
30092.0s 5599 Simulation finished at t = 1470.0000 s after 6890 steps.
30092.0s 5600 Total runtime: 0.63 seconds.
30092.0s 5601 [REWARD_MICROSCOPE] step=14018 t=1470.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30092.0s 5602 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30092.0s 5603 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30092.0s 5604 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30092.0s 5605 Running simulation until t = 1485.00 s, outputting every 15.00 s
30092.0s 5606 
30092.1s 5607 [PROGRESS] Step 6900: t=1472.12/1485.00s (99.1%) | dt=0.2123s
30092.1s 5608 [PERIODIC:1000] BC_DISPATCHER [Call #13245000] current_bc_params: <class 'dict'>
30092.1s 5609 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30092.1s 5610 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30092.1s 5611 [PERIODIC:1000] BC_GPU [Call #13245000] About to launch kernel
30092.1s 5612 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30092.1s 5613 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30092.1s 5614 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30092.5s 5615 [PROGRESS] Step 6950: t=1482.75/1485.00s (99.8%) | dt=0.2127s
30092.6s 5616 [WARNING] Automatic CFL correction applied (count: 3311200):
30092.6s 5617 Calculated CFL: 0.800 > Limit: 0.500
30092.6s 5618 Original dt: 3.404818e-01 s
30092.6s 5619 Corrected dt: 2.128011e-01 s
30092.6s 5620 Correction factor: 1.6x
30092.6s 5621 Max wave speed detected: 23.50 m/s
30092.6s 5622 Stored output at t = 1485.0000 s (Step 6961)
30092.6s 5623 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
30092.6s 5624 [A
30092.6s 5625 
30092.6s 5626 Simulation finished at t = 1485.0000 s after 6961 steps.
30092.6s 5627 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.53s/s]
30092.6s 5628 Total runtime: 0.61 seconds.
30092.6s 5629 [REWARD_MICROSCOPE] step=14019 t=1485.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30092.6s 5630 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30092.6s 5631 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30092.6s 5632 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30092.6s 5633 Running simulation until t = 1500.00 s, outputting every 15.00 s
30092.6s 5634 
30092.9s 5635 [PROGRESS] Step 7000: t=1493.31/1500.00s (99.6%) | dt=0.2132s
30093.2s 5636 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
30093.2s 5637 [A
30093.2s 5638 Stored output at t = 1500.0000 s (Step 7032)
30093.2s 5639 
30093.2s 5640 Simulation finished at t = 1500.0000 s after 7032 steps.
30093.2s 5641 Total runtime: 0.62 seconds.
30093.2s 5642 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.16s/s]
30093.2s 5643 [REWARD_MICROSCOPE] step=14020 t=1500.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30093.2s 5644 [STEP  100] t= 1500.0s | phase=0 | reward=   0.01 | total_reward=    0.80
30093.2s 5645 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30093.2s 5646 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30093.2s 5647 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30093.2s 5648 Running simulation until t = 1515.00 s, outputting every 15.00 s
30093.2s 5649 
30093.4s 5650 [PROGRESS] Step 7050: t=1503.82/1515.00s (99.3%) | dt=0.2124s
30093.4s 5651 [WARNING] Automatic CFL correction applied (count: 3311300):
30093.4s 5652 Calculated CFL: 0.800 > Limit: 0.500
30093.4s 5653 Original dt: 3.398890e-01 s
30093.4s 5654 Corrected dt: 2.124306e-01 s
30093.4s 5655 Correction factor: 1.6x
30093.4s 5656 Max wave speed detected: 23.54 m/s
30093.8s 5657 [PROGRESS] Step 7100: t=1514.45/1515.00s (100.0%) | dt=0.2128s
30093.9s 5658 Stored output at t = 1515.0000 s (Step 7103)
30093.9s 5659 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
30093.9s 5660 [A
30093.9s 5661 
30093.9s 5662 Simulation finished at t = 1515.0000 s after 7103 steps.
30093.9s 5663 Total runtime: 0.62 seconds.
30093.9s 5664 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.07s/s]
30093.9s 5665 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
30093.9s 5666 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30093.9s 5667 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30093.9s 5668 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30093.9s 5669 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30093.9s 5670 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30093.9s 5671 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30093.9s 5672 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30093.9s 5673 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30093.9s 5674 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30093.9s 5675 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30093.9s 5676 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30093.9s 5677 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30093.9s 5678 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30093.9s 5679 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30093.9s 5680 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30093.9s 5681 [REWARD_MICROSCOPE] step=14021 t=1515.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30093.9s 5682 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30093.9s 5683 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30093.9s 5684 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30093.9s 5685 Running simulation until t = 1530.00 s, outputting every 15.00 s
30093.9s 5686 
30094.3s 5687 [PROGRESS] Step 7150: t=1525.01/1530.00s (99.7%) | dt=0.2132s
30094.3s 5688 [PERIODIC:1000] BC_DISPATCHER [Call #13246000] current_bc_params: <class 'dict'>
30094.3s 5689 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30094.3s 5690 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30094.3s 5691 [PERIODIC:1000] BC_GPU [Call #13246000] About to launch kernel
30094.3s 5692 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30094.3s 5693 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30094.3s 5694 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30094.3s 5695 [WARNING] Automatic CFL correction applied (count: 3311400):
30094.3s 5696 Calculated CFL: 0.800 > Limit: 0.500
30094.3s 5697 Original dt: 3.412697e-01 s
30094.3s 5698 Corrected dt: 2.132935e-01 s
30094.3s 5699 Correction factor: 1.6x
30094.3s 5700 Max wave speed detected: 23.44 m/s
30094.5s 5701 Stored output at t = 1530.0000 s (Step 7174)
30094.5s 5702 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
30094.5s 5703 [A
30094.5s 5704 
30094.5s 5705 Simulation finished at t = 1530.0000 s after 7174 steps.
30094.5s 5706 Total runtime: 0.63 seconds.
30094.5s 5707 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 23.94s/s]
30094.5s 5708 [REWARD_MICROSCOPE] step=14022 t=1530.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30094.5s 5709 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30094.5s 5710 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30094.5s 5711 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30094.5s 5712 Running simulation until t = 1545.00 s, outputting every 15.00 s
30094.5s 5713 
30094.7s 5714 [PROGRESS] Step 7200: t=1535.52/1545.00s (99.4%) | dt=0.2124s
30095.1s 5715 Stored output at t = 1545.0000 s (Step 7245)
30095.1s 5716 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
30095.1s 5717 [A
30095.1s 5718 
30095.1s 5719 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 24.27s/s]
30095.1s 5720 Simulation finished at t = 1545.0000 s after 7245 steps.
30095.1s 5721 Total runtime: 0.62 seconds.
30095.1s 5722 [REWARD_MICROSCOPE] step=14023 t=1545.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30095.1s 5723 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30095.1s 5724 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30095.1s 5725 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30095.1s 5726 Running simulation until t = 1560.00 s, outputting every 15.00 s
30095.1s 5727 
30095.2s 5728 [PROGRESS] Step 7250: t=1546.06/1560.00s (99.1%) | dt=0.2129s
30095.2s 5729 [WARNING] Automatic CFL correction applied (count: 3311500):
30095.2s 5730 Calculated CFL: 0.800 > Limit: 0.500
30095.2s 5731 Original dt: 3.406934e-01 s
30095.2s 5732 Corrected dt: 2.129334e-01 s
30095.2s 5733 Correction factor: 1.6x
30095.2s 5734 Max wave speed detected: 23.48 m/s
30095.6s 5735 [PROGRESS] Step 7300: t=1556.72/1560.00s (99.8%) | dt=0.2133s
30095.7s 5736 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
30095.7s 5737 [A
30095.7s 5738 Stored output at t = 1560.0000 s (Step 7316)
30095.7s 5739 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 23.82s/s]
30095.7s 5740 
30095.7s 5741 Simulation finished at t = 1560.0000 s after 7316 steps.
30095.7s 5742 Total runtime: 0.63 seconds.
30095.7s 5743 [REWARD_MICROSCOPE] step=14024 t=1560.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30095.7s 5744 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30095.7s 5745 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30095.7s 5746 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30095.7s 5747 Running simulation until t = 1575.00 s, outputting every 15.00 s
30095.7s 5748 
30096.1s 5749 [PROGRESS] Step 7350: t=1567.22/1575.00s (99.5%) | dt=0.2125s
30096.1s 5750 [WARNING] Automatic CFL correction applied (count: 3311600):
30096.1s 5751 Calculated CFL: 0.800 > Limit: 0.500
30096.1s 5752 Original dt: 3.401199e-01 s
30096.1s 5753 Corrected dt: 2.125749e-01 s
30096.1s 5754 Correction factor: 1.6x
30096.1s 5755 Max wave speed detected: 23.52 m/s
30096.4s 5756 Stored output at t = 1575.0000 s (Step 7387)
30096.4s 5757 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
30096.4s 5758 [A
30096.4s 5759 
30096.4s 5760 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.22s/s]
30096.4s 5761 Simulation finished at t = 1575.0000 s after 7387 steps.
30096.4s 5762 Total runtime: 0.65 seconds.
30096.4s 5763 [REWARD_MICROSCOPE] step=14025 t=1575.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30096.4s 5764 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30096.4s 5765 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30096.4s 5766 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30096.4s 5767 Running simulation until t = 1590.00 s, outputting every 15.00 s
30096.4s 5768 
30096.5s 5769 [PROGRESS] Step 7400: t=1577.77/1590.00s (99.2%) | dt=0.2129s
30096.5s 5770 [PERIODIC:1000] BC_DISPATCHER [Call #13247000] current_bc_params: <class 'dict'>
30096.5s 5771 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30096.5s 5772 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30096.5s 5773 [PERIODIC:1000] BC_GPU [Call #13247000] About to launch kernel
30096.5s 5774 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30096.5s 5775 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30096.5s 5776 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30096.9s 5777 [PROGRESS] Step 7450: t=1588.42/1590.00s (99.9%) | dt=0.2128s
30097.0s 5778 [WARNING] Automatic CFL correction applied (count: 3311700):
30097.0s 5779 Calculated CFL: 0.800 > Limit: 0.500
30097.0s 5780 Original dt: 3.401129e-01 s
30097.0s 5781 Corrected dt: 2.125705e-01 s
30097.0s 5782 Correction factor: 1.6x
30097.0s 5783 Max wave speed detected: 23.52 m/s
30097.0s 5784 Stored output at t = 1590.0000 s (Step 7458)
30097.0s 5785 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
30097.0s 5786 [A
30097.0s 5787 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.12s/s]
30097.0s 5788 
30097.0s 5789 Simulation finished at t = 1590.0000 s after 7458 steps.
30097.0s 5790 Total runtime: 0.62 seconds.
30097.0s 5791 [REWARD_MICROSCOPE] step=14026 t=1590.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30097.0s 5792 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30097.0s 5793 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30097.0s 5794 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30097.0s 5795 Running simulation until t = 1605.00 s, outputting every 15.00 s
30097.0s 5796 
30097.4s 5797 [PROGRESS] Step 7500: t=1598.92/1605.00s (99.6%) | dt=0.2126s
30097.7s 5798 Stored output at t = 1605.0000 s (Step 7529)
30097.7s 5799 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
30097.7s 5800 [A
30097.7s 5801 
30097.7s 5802 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 23.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 23.46s/s]
30097.7s 5803 Simulation finished at t = 1605.0000 s after 7529 steps.
30097.7s 5804 Total runtime: 0.64 seconds.
30097.7s 5805 [REWARD_MICROSCOPE] step=14027 t=1605.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30097.7s 5806 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30097.7s 5807 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30097.7s 5808 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30097.7s 5809 Running simulation until t = 1620.00 s, outputting every 15.00 s
30097.7s 5810 
30097.9s 5811 [PROGRESS] Step 7550: t=1609.47/1620.00s (99.4%) | dt=0.2130s
30097.9s 5812 [WARNING] Automatic CFL correction applied (count: 3311800):
30097.9s 5813 Calculated CFL: 0.800 > Limit: 0.500
30097.9s 5814 Original dt: 3.409178e-01 s
30097.9s 5815 Corrected dt: 2.130736e-01 s
30097.9s 5816 Correction factor: 1.6x
30097.9s 5817 Max wave speed detected: 23.47 m/s
30098.3s 5818 [PROGRESS] Step 7600: t=1620.00/1620.00s (100.0%) | dt=0.0883s
30098.3s 5819 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
30098.3s 5820 [A
30098.3s 5821 Stored output at t = 1620.0000 s (Step 7600)
30098.3s 5822 
30098.3s 5823 Simulation finished at t = 1620.0000 s after 7600 steps.
30098.3s 5824 Total runtime: 0.62 seconds.
30098.3s 5825 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.06s/s]
30098.3s 5826 [REWARD_MICROSCOPE] step=14028 t=1620.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30098.3s 5827 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30098.3s 5828 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30098.3s 5829 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30098.3s 5830 Running simulation until t = 1635.00 s, outputting every 15.00 s
30098.3s 5831 
30098.7s 5832 [PROGRESS] Step 7650: t=1630.62/1635.00s (99.7%) | dt=0.2127s
30098.7s 5833 [PERIODIC:1000] BC_DISPATCHER [Call #13248000] current_bc_params: <class 'dict'>
30098.7s 5834 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30098.7s 5835 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30098.7s 5836 [PERIODIC:1000] BC_GPU [Call #13248000] About to launch kernel
30098.7s 5837 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30098.7s 5838 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30098.7s 5839 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30098.8s 5840 [WARNING] Automatic CFL correction applied (count: 3311900):
30098.8s 5841 Calculated CFL: 0.800 > Limit: 0.500
30098.8s 5842 Original dt: 3.403431e-01 s
30098.8s 5843 Corrected dt: 2.127144e-01 s
30098.8s 5844 Correction factor: 1.6x
30098.8s 5845 Max wave speed detected: 23.51 m/s
30098.9s 5846 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
30098.9s 5847 [A
30098.9s 5848 Stored output at t = 1635.0000 s (Step 7671)
30098.9s 5849 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.18s/s]
30098.9s 5850 
30098.9s 5851 Simulation finished at t = 1635.0000 s after 7671 steps.
30098.9s 5852 Total runtime: 0.62 seconds.
30098.9s 5853 [REWARD_MICROSCOPE] step=14029 t=1635.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30098.9s 5854 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30098.9s 5855 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30098.9s 5856 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30098.9s 5857 Running simulation until t = 1650.00 s, outputting every 15.00 s
30098.9s 5858 
30099.2s 5859 [PROGRESS] Step 7700: t=1641.18/1650.00s (99.5%) | dt=0.2131s
30099.5s 5860 Stored output at t = 1650.0000 s (Step 7742)
30099.5s 5861 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
30099.5s 5862 [A
30099.5s 5863 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.28s/s]
30099.5s 5864 
30099.5s 5865 Simulation finished at t = 1650.0000 s after 7742 steps.
30099.5s 5866 Total runtime: 0.62 seconds.
30099.5s 5867 [REWARD_MICROSCOPE] step=14030 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30099.5s 5868 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    0.90
30099.5s 5869 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30099.5s 5870 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30099.5s 5871 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30099.5s 5872 Running simulation until t = 1665.00 s, outputting every 15.00 s
30099.5s 5873 
30099.6s 5874 [PROGRESS] Step 7750: t=1651.70/1665.00s (99.2%) | dt=0.2124s
30099.7s 5875 [WARNING] Automatic CFL correction applied (count: 3312000):
30099.7s 5876 Calculated CFL: 0.800 > Limit: 0.500
30099.7s 5877 Original dt: 3.397401e-01 s
30099.7s 5878 Corrected dt: 2.123376e-01 s
30099.7s 5879 Correction factor: 1.6x
30099.7s 5880 Max wave speed detected: 23.55 m/s
30100.1s 5881 [PROGRESS] Step 7800: t=1662.32/1665.00s (99.8%) | dt=0.2127s
30100.2s 5882 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
30100.2s 5883 [A
30100.2s 5884 Stored output at t = 1665.0000 s (Step 7813)
30100.2s 5885 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 23.88s/s]
30100.2s 5886 
30100.2s 5887 Simulation finished at t = 1665.0000 s after 7813 steps.
30100.2s 5888 Total runtime: 0.63 seconds.
30100.2s 5889 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
30100.2s 5890 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30100.2s 5891 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30100.2s 5892 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30100.2s 5893 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30100.2s 5894 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30100.2s 5895 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30100.2s 5896 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30100.2s 5897 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30100.2s 5898 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30100.2s 5899 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30100.2s 5900 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30100.2s 5901 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30100.2s 5902 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30100.2s 5903 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30100.2s 5904 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30100.2s 5905 [REWARD_MICROSCOPE] step=14031 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30100.2s 5906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30100.2s 5907 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30100.2s 5908 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30100.2s 5909 Running simulation until t = 1680.00 s, outputting every 15.00 s
30100.2s 5910 
30100.5s 5911 [PROGRESS] Step 7850: t=1672.88/1680.00s (99.6%) | dt=0.2131s
30100.5s 5912 [WARNING] Automatic CFL correction applied (count: 3312100):
30100.5s 5913 Calculated CFL: 0.800 > Limit: 0.500
30100.5s 5914 Original dt: 3.411334e-01 s
30100.5s 5915 Corrected dt: 2.132084e-01 s
30100.5s 5916 Correction factor: 1.6x
30100.5s 5917 Max wave speed detected: 23.45 m/s
30100.8s 5918 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
30100.8s 5919 [A
30100.8s 5920 Stored output at t = 1680.0000 s (Step 7884)
30100.8s 5921 
30100.8s 5922 Simulation finished at t = 1680.0000 s after 7884 steps.
30100.8s 5923 Total runtime: 0.64 seconds.
30100.8s 5924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.59s/s]
30100.8s 5925 [REWARD_MICROSCOPE] step=14032 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30100.8s 5926 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30100.8s 5927 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30100.8s 5928 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30100.8s 5929 Running simulation until t = 1695.00 s, outputting every 15.00 s
30100.8s 5930 
30101.0s 5931 [PROGRESS] Step 7900: t=1683.40/1695.00s (99.3%) | dt=0.2123s
30101.0s 5932 [PERIODIC:1000] BC_DISPATCHER [Call #13249000] current_bc_params: <class 'dict'>
30101.0s 5933 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30101.0s 5934 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30101.0s 5935 [PERIODIC:1000] BC_GPU [Call #13249000] About to launch kernel
30101.0s 5936 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30101.0s 5937 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30101.0s 5938 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30101.4s 5939 [PROGRESS] Step 7950: t=1694.03/1695.00s (99.9%) | dt=0.2128s
30101.4s 5940 Stored output at t = 1695.0000 s (Step 7955)
30101.4s 5941 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
30101.4s 5942 [A
30101.4s 5943 
30101.4s 5944 Simulation finished at t = 1695.0000 s after 7955 steps.
30101.4s 5945 Total runtime: 0.62 seconds.
30101.4s 5946 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.23s/s]
30101.4s 5947 [REWARD_MICROSCOPE] step=14033 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30101.4s 5948 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30101.4s 5949 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30101.4s 5950 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30101.4s 5951 Running simulation until t = 1710.00 s, outputting every 15.00 s
30101.4s 5952 
30101.5s 5953 [WARNING] Automatic CFL correction applied (count: 3312200):
30101.5s 5954 Calculated CFL: 0.800 > Limit: 0.500
30101.5s 5955 Original dt: 3.405553e-01 s
30101.5s 5956 Corrected dt: 2.128470e-01 s
30101.5s 5957 Correction factor: 1.6x
30101.5s 5958 Max wave speed detected: 23.49 m/s
30101.8s 5959 [PROGRESS] Step 8000: t=1704.59/1710.00s (99.7%) | dt=0.2132s
30102.1s 5960 Stored output at t = 1710.0000 s (Step 8026)
30102.1s 5961 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
30102.1s 5962 [A
30102.1s 5963 
30102.1s 5964 Simulation finished at t = 1710.0000 s after 8026 steps.
30102.1s 5965 Total runtime: 0.63 seconds.
30102.1s 5966 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 23.82s/s]
30102.1s 5967 [REWARD_MICROSCOPE] step=14034 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30102.1s 5968 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30102.1s 5969 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30102.1s 5970 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30102.1s 5971 Running simulation until t = 1725.00 s, outputting every 15.00 s
30102.1s 5972 
30102.3s 5973 [PROGRESS] Step 8050: t=1715.10/1725.00s (99.4%) | dt=0.2124s
30102.3s 5974 [WARNING] Automatic CFL correction applied (count: 3312300):
30102.3s 5975 Calculated CFL: 0.800 > Limit: 0.500
30102.3s 5976 Original dt: 3.399790e-01 s
30102.3s 5977 Corrected dt: 2.124869e-01 s
30102.3s 5978 Correction factor: 1.6x
30102.3s 5979 Max wave speed detected: 23.53 m/s
30102.7s 5980 Stored output at t = 1725.0000 s (Step 8097)
30102.7s 5981 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
30102.7s 5982 [A
30102.7s 5983 
30102.7s 5984 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.61s/s]
30102.7s 5985 Simulation finished at t = 1725.0000 s after 8097 steps.
30102.7s 5986 Total runtime: 0.61 seconds.
30102.7s 5987 [REWARD_MICROSCOPE] step=14035 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30102.7s 5988 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30102.7s 5989 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30102.7s 5990 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30102.7s 5991 Running simulation until t = 1740.00 s, outputting every 15.00 s
30102.7s 5992 
30102.7s 5993 [PROGRESS] Step 8100: t=1725.64/1740.00s (99.2%) | dt=0.2129s
30103.1s 5994 [PROGRESS] Step 8150: t=1736.29/1740.00s (99.8%) | dt=0.2133s
30103.2s 5995 [PERIODIC:1000] BC_DISPATCHER [Call #13250000] current_bc_params: <class 'dict'>
30103.2s 5996 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30103.2s 5997 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30103.2s 5998 [PERIODIC:1000] BC_GPU [Call #13250000] About to launch kernel
30103.2s 5999 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30103.2s 6000 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30103.2s 6001 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30103.2s 6002 [WARNING] Automatic CFL correction applied (count: 3312400):
30103.2s 6003 Calculated CFL: 0.800 > Limit: 0.500
30103.2s 6004 Original dt: 3.407550e-01 s
30103.2s 6005 Corrected dt: 2.129719e-01 s
30103.2s 6006 Correction factor: 1.6x
30103.2s 6007 Max wave speed detected: 23.48 m/s
30103.3s 6008 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
30103.3s 6009 [A
30103.3s 6010 Stored output at t = 1740.0000 s (Step 8168)
30103.3s 6011 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.30s/s]
30103.3s 6012 
30103.3s 6013 Simulation finished at t = 1740.0000 s after 8168 steps.
30103.3s 6014 Total runtime: 0.62 seconds.
30103.3s 6015 [REWARD_MICROSCOPE] step=14036 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30103.3s 6016 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30103.3s 6017 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30103.3s 6018 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30103.3s 6019 Running simulation until t = 1755.00 s, outputting every 15.00 s
30103.3s 6020 
30103.6s 6021 [PROGRESS] Step 8200: t=1746.80/1755.00s (99.5%) | dt=0.2125s
30103.9s 6022 Stored output at t = 1755.0000 s (Step 8239)
30103.9s 6023 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
30103.9s 6024 [A
30103.9s 6025 
30103.9s 6026 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.50s/s]
30103.9s 6027 Simulation finished at t = 1755.0000 s after 8239 steps.
30103.9s 6028 Total runtime: 0.61 seconds.
30103.9s 6029 [REWARD_MICROSCOPE] step=14037 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30103.9s 6030 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30103.9s 6031 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30103.9s 6032 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30103.9s 6033 Running simulation until t = 1770.00 s, outputting every 15.00 s
30103.9s 6034 
30104.0s 6035 [PROGRESS] Step 8250: t=1757.34/1770.00s (99.3%) | dt=0.2129s
30104.1s 6036 [WARNING] Automatic CFL correction applied (count: 3312500):
30104.1s 6037 Calculated CFL: 0.800 > Limit: 0.500
30104.1s 6038 Original dt: 3.407770e-01 s
30104.1s 6039 Corrected dt: 2.129856e-01 s
30104.1s 6040 Correction factor: 1.6x
30104.1s 6041 Max wave speed detected: 23.48 m/s
30104.5s 6042 [PROGRESS] Step 8300: t=1768.00/1770.00s (99.9%) | dt=0.2129s
30104.5s 6043 Stored output at t = 1770.0000 s (Step 8310)
30104.5s 6044 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
30104.5s 6045 [A
30104.5s 6046 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.97s/s]
30104.5s 6047 
30104.5s 6048 Simulation finished at t = 1770.0000 s after 8310 steps.
30104.5s 6049 Total runtime: 0.63 seconds.
30104.6s 6050 [REWARD_MICROSCOPE] step=14038 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30104.6s 6051 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30104.6s 6052 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30104.6s 6053 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30104.6s 6054 Running simulation until t = 1785.00 s, outputting every 15.00 s
30104.6s 6055 
30104.9s 6056 [PROGRESS] Step 8350: t=1778.50/1785.00s (99.6%) | dt=0.2126s
30105.0s 6057 [WARNING] Automatic CFL correction applied (count: 3312600):
30105.0s 6058 Calculated CFL: 0.800 > Limit: 0.500
30105.0s 6059 Original dt: 3.402034e-01 s
30105.0s 6060 Corrected dt: 2.126271e-01 s
30105.0s 6061 Correction factor: 1.6x
30105.0s 6062 Max wave speed detected: 23.52 m/s
30105.2s 6063 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
30105.2s 6064 [A
30105.2s 6065 Stored output at t = 1785.0000 s (Step 8381)
30105.2s 6066 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.40s/s]
30105.2s 6067 
30105.2s 6068 Simulation finished at t = 1785.0000 s after 8381 steps.
30105.2s 6069 Total runtime: 0.62 seconds.
30105.2s 6070 [REWARD_MICROSCOPE] step=14039 t=1785.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30105.2s 6071 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30105.2s 6072 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30105.2s 6073 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30105.2s 6074 Running simulation until t = 1800.00 s, outputting every 15.00 s
30105.2s 6075 
30105.3s 6076 [PROGRESS] Step 8400: t=1789.05/1800.00s (99.4%) | dt=0.2130s
30105.3s 6077 [PERIODIC:1000] BC_DISPATCHER [Call #13251000] current_bc_params: <class 'dict'>
30105.3s 6078 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30105.3s 6079 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30105.3s 6080 [PERIODIC:1000] BC_GPU [Call #13251000] About to launch kernel
30105.3s 6081 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30105.3s 6082 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30105.3s 6083 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30105.8s 6084 [PROGRESS] Step 8450: t=1799.70/1800.00s (100.0%) | dt=0.2126s
30105.8s 6085 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
30105.8s 6086 [A
30105.8s 6087 Stored output at t = 1800.0000 s (Step 8452)
30105.8s 6088 
30105.8s 6089 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.24s/s]
30105.8s 6090 Simulation finished at t = 1800.0000 s after 8452 steps.
30105.8s 6091 Total runtime: 0.62 seconds.
30105.8s 6092 [REWARD_MICROSCOPE] step=14040 t=1800.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30105.8s 6093 [STEP  120] t= 1800.0s | phase=0 | reward=   0.01 | total_reward=    1.00
30105.8s 6094 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30105.8s 6095 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30105.8s 6096 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30105.8s 6097 Running simulation until t = 1815.00 s, outputting every 15.00 s
30105.8s 6098 
30105.8s 6099 [WARNING] Automatic CFL correction applied (count: 3312700):
30105.8s 6100 Calculated CFL: 0.800 > Limit: 0.500
30105.8s 6101 Original dt: 3.398708e-01 s
30105.8s 6102 Corrected dt: 2.124193e-01 s
30105.8s 6103 Correction factor: 1.6x
30105.8s 6104 Max wave speed detected: 23.54 m/s
30106.2s 6105 [PROGRESS] Step 8500: t=1810.20/1815.00s (99.7%) | dt=0.2126s
30106.4s 6106 Stored output at t = 1815.0000 s (Step 8523)
30106.4s 6107 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
30106.4s 6108 [A
30106.4s 6109 
30106.4s 6110 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.52s/s]
30106.4s 6111 Simulation finished at t = 1815.0000 s after 8523 steps.
30106.4s 6112 Total runtime: 0.61 seconds.
30106.4s 6113 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
30106.4s 6114 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30106.4s 6115 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30106.4s 6116 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30106.4s 6117 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30106.4s 6118 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30106.4s 6119 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30106.4s 6120 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30106.4s 6121 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30106.4s 6122 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30106.4s 6123 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30106.4s 6124 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30106.4s 6125 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30106.4s 6126 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30106.4s 6127 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30106.4s 6128 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30106.4s 6129 [REWARD_MICROSCOPE] step=14041 t=1815.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30106.4s 6130 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30106.4s 6131 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30106.4s 6132 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30106.4s 6133 Running simulation until t = 1830.00 s, outputting every 15.00 s
30106.4s 6134 
30106.6s 6135 [PROGRESS] Step 8550: t=1820.75/1830.00s (99.5%) | dt=0.2131s
30106.7s 6136 [WARNING] Automatic CFL correction applied (count: 3312800):
30106.7s 6137 Calculated CFL: 0.800 > Limit: 0.500
30106.7s 6138 Original dt: 3.409993e-01 s
30106.7s 6139 Corrected dt: 2.131246e-01 s
30106.7s 6140 Correction factor: 1.6x
30106.7s 6141 Max wave speed detected: 23.46 m/s
30107.0s 6142 Stored output at t = 1830.0000 s (Step 8594)
30107.0s 6143 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
30107.0s 6144 [A
30107.0s 6145 
30107.0s 6146 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.21s/s]
30107.0s 6147 Simulation finished at t = 1830.0000 s after 8594 steps.
30107.0s 6148 Total runtime: 0.62 seconds.
30107.0s 6149 [REWARD_MICROSCOPE] step=14042 t=1830.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30107.0s 6150 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30107.0s 6151 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30107.0s 6152 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30107.0s 6153 Running simulation until t = 1845.00 s, outputting every 15.00 s
30107.0s 6154 
30107.1s 6155 [PROGRESS] Step 8600: t=1831.27/1845.00s (99.3%) | dt=0.2124s
30107.5s 6156 [PROGRESS] Step 8650: t=1841.90/1845.00s (99.8%) | dt=0.2127s
30107.5s 6157 [PERIODIC:1000] BC_DISPATCHER [Call #13252000] current_bc_params: <class 'dict'>
30107.5s 6158 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30107.5s 6159 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30107.5s 6160 [PERIODIC:1000] BC_GPU [Call #13252000] About to launch kernel
30107.5s 6161 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30107.5s 6162 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30107.5s 6163 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30107.6s 6164 [WARNING] Automatic CFL correction applied (count: 3312900):
30107.6s 6165 Calculated CFL: 0.800 > Limit: 0.500
30107.6s 6166 Original dt: 3.404274e-01 s
30107.6s 6167 Corrected dt: 2.127671e-01 s
30107.6s 6168 Correction factor: 1.6x
30107.6s 6169 Max wave speed detected: 23.50 m/s
30107.7s 6170 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
30107.7s 6171 [A
30107.7s 6172 Stored output at t = 1845.0000 s (Step 8665)
30107.7s 6173 
30107.7s 6174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 23.98s/s]
30107.7s 6175 Simulation finished at t = 1845.0000 s after 8665 steps.
30107.7s 6176 Total runtime: 0.63 seconds.
30107.7s 6177 [REWARD_MICROSCOPE] step=14043 t=1845.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30107.7s 6178 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30107.7s 6179 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30107.7s 6180 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30107.7s 6181 Running simulation until t = 1860.00 s, outputting every 15.00 s
30107.7s 6182 
30108.0s 6183 [PROGRESS] Step 8700: t=1852.45/1860.00s (99.6%) | dt=0.2131s
30108.3s 6184 Stored output at t = 1860.0000 s (Step 8736)
30108.3s 6185 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A
30108.3s 6186 [A
30108.3s 6187 
30108.3s 6188 Simulation finished at t = 1860.0000 s after 8736 steps.
30108.3s 6189 Total runtime: 0.62 seconds.
30108.3s 6190 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.22s/s]
30108.3s 6191 [REWARD_MICROSCOPE] step=14044 t=1860.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30108.3s 6192 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30108.3s 6193 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30108.3s 6194 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30108.3s 6195 Running simulation until t = 1875.00 s, outputting every 15.00 s
30108.3s 6196 
30108.4s 6197 [PROGRESS] Step 8750: t=1862.97/1875.00s (99.4%) | dt=0.2123s
30108.5s 6198 [WARNING] Automatic CFL correction applied (count: 3313000):
30108.5s 6199 Calculated CFL: 0.800 > Limit: 0.500
30108.5s 6200 Original dt: 3.398278e-01 s
30108.5s 6201 Corrected dt: 2.123924e-01 s
30108.5s 6202 Correction factor: 1.6x
30108.5s 6203 Max wave speed detected: 23.54 m/s
30108.8s 6204 [PROGRESS] Step 8800: t=1873.60/1875.00s (99.9%) | dt=0.2128s
30108.9s 6205 Stored output at t = 1875.0000 s (Step 8807)
30108.9s 6206 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1860.0/1875.0 [00:00<?, ?s/s][A
30108.9s 6207 [A
30108.9s 6208 
30108.9s 6209 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.32s/s]
30108.9s 6210 Simulation finished at t = 1875.0000 s after 8807 steps.
30108.9s 6211 Total runtime: 0.62 seconds.
30108.9s 6212 [REWARD_MICROSCOPE] step=14045 t=1875.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30108.9s 6213 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30108.9s 6214 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30108.9s 6215 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30108.9s 6216 Running simulation until t = 1890.00 s, outputting every 15.00 s
30108.9s 6217 
30109.3s 6218 [PROGRESS] Step 8850: t=1884.16/1890.00s (99.7%) | dt=0.2132s
30109.3s 6219 [WARNING] Automatic CFL correction applied (count: 3313100):
30109.3s 6220 Calculated CFL: 0.800 > Limit: 0.500
30109.3s 6221 Original dt: 3.412149e-01 s
30109.3s 6222 Corrected dt: 2.132593e-01 s
30109.3s 6223 Correction factor: 1.6x
30109.3s 6224 Max wave speed detected: 23.45 m/s
30109.5s 6225 Stored output at t = 1890.0000 s (Step 8878)
30109.5s 6226 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1875.0/1890.0 [00:00<?, ?s/s][A
30109.5s 6227 [A
30109.5s 6228 
30109.5s 6229 Simulation finished at t = 1890.0000 s after 8878 steps.
30109.5s 6230 Total runtime: 0.63 seconds.
30109.5s 6231 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 23.68s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 23.67s/s]
30109.5s 6232 [REWARD_MICROSCOPE] step=14046 t=1890.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30109.5s 6233 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30109.5s 6234 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30109.5s 6235 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30109.5s 6236 Running simulation until t = 1905.00 s, outputting every 15.00 s
30109.5s 6237 
30109.7s 6238 [PROGRESS] Step 8900: t=1894.67/1905.00s (99.5%) | dt=0.2124s
30109.7s 6239 [PERIODIC:1000] BC_DISPATCHER [Call #13253000] current_bc_params: <class 'dict'>
30109.7s 6240 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30109.7s 6241 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30109.7s 6242 [PERIODIC:1000] BC_GPU [Call #13253000] About to launch kernel
30109.7s 6243 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30109.7s 6244 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30109.7s 6245 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30110.2s 6246 Stored output at t = 1905.0000 s (Step 8949)
30110.2s 6247 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1890.0/1905.0 [00:00<?, ?s/s][A
30110.2s 6248 [A
30110.2s 6249 
30110.2s 6250 Simulation finished at t = 1905.0000 s after 8949 steps.
30110.2s 6251 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.24s/s]
30110.2s 6252 Total runtime: 0.62 seconds.
30110.2s 6253 [REWARD_MICROSCOPE] step=14047 t=1905.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30110.2s 6254 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30110.2s 6255 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30110.2s 6256 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30110.2s 6257 Running simulation until t = 1920.00 s, outputting every 15.00 s
30110.2s 6258 
30110.2s 6259 [PROGRESS] Step 8950: t=1905.21/1920.00s (99.2%) | dt=0.2128s
30110.2s 6260 [WARNING] Automatic CFL correction applied (count: 3313200):
30110.2s 6261 Calculated CFL: 0.800 > Limit: 0.500
30110.2s 6262 Original dt: 3.406380e-01 s
30110.2s 6263 Corrected dt: 2.128988e-01 s
30110.2s 6264 Correction factor: 1.6x
30110.2s 6265 Max wave speed detected: 23.49 m/s
30110.6s 6266 [PROGRESS] Step 9000: t=1915.87/1920.00s (99.8%) | dt=0.2133s
30110.8s 6267 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1905.0/1920.0 [00:00<?, ?s/s][A
30110.8s 6268 [A
30110.8s 6269 Stored output at t = 1920.0000 s (Step 9020)
30110.8s 6270 
30110.8s 6271 Simulation finished at t = 1920.0000 s after 9020 steps.
30110.8s 6272 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 23.87s/s]
30110.8s 6273 Total runtime: 0.63 seconds.
30110.8s 6274 [REWARD_MICROSCOPE] step=14048 t=1920.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30110.8s 6275 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30110.8s 6276 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30110.8s 6277 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30110.8s 6278 Running simulation until t = 1935.00 s, outputting every 15.00 s
30110.8s 6279 
30111.1s 6280 [PROGRESS] Step 9050: t=1926.37/1935.00s (99.6%) | dt=0.2125s
30111.1s 6281 [WARNING] Automatic CFL correction applied (count: 3313300):
30111.1s 6282 Calculated CFL: 0.800 > Limit: 0.500
30111.1s 6283 Original dt: 3.400643e-01 s
30111.1s 6284 Corrected dt: 2.125402e-01 s
30111.1s 6285 Correction factor: 1.6x
30111.1s 6286 Max wave speed detected: 23.52 m/s
30111.4s 6287 Stored output at t = 1935.0000 s (Step 9091)
30111.4s 6288 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1920.0/1935.0 [00:00<?, ?s/s][A
30111.4s 6289 [A
30111.4s 6290 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.12s/s]
30111.4s 6291 
30111.4s 6292 Simulation finished at t = 1935.0000 s after 9091 steps.
30111.4s 6293 Total runtime: 0.62 seconds.
30111.4s 6294 [REWARD_MICROSCOPE] step=14049 t=1935.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30111.4s 6295 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30111.4s 6296 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30111.4s 6297 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30111.4s 6298 Running simulation until t = 1950.00 s, outputting every 15.00 s
30111.4s 6299 
30111.5s 6300 [PROGRESS] Step 9100: t=1936.92/1950.00s (99.3%) | dt=0.2129s
30112.0s 6301 [PROGRESS] Step 9150: t=1947.57/1950.00s (99.9%) | dt=0.2130s
30112.0s 6302 [PERIODIC:1000] BC_DISPATCHER [Call #13254000] current_bc_params: <class 'dict'>
30112.0s 6303 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30112.0s 6304 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30112.0s 6305 [PERIODIC:1000] BC_GPU [Call #13254000] About to launch kernel
30112.0s 6306 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30112.0s 6307 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30112.0s 6308 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30112.0s 6309 [WARNING] Automatic CFL correction applied (count: 3313400):
30112.0s 6310 Calculated CFL: 0.800 > Limit: 0.500
30112.0s 6311 Original dt: 3.403351e-01 s
30112.0s 6312 Corrected dt: 2.127094e-01 s
30112.0s 6313 Correction factor: 1.6x
30112.0s 6314 Max wave speed detected: 23.51 m/s
30112.1s 6315 Stored output at t = 1950.0000 s (Step 9162)
30112.1s 6316 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1935.0/1950.0 [00:00<?, ?s/s][A
30112.1s 6317 [A
30112.1s 6318 
30112.1s 6319 Simulation finished at t = 1950.0000 s after 9162 steps.
30112.1s 6320 Total runtime: 0.64 seconds.
30112.1s 6321 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.59s/s]
30112.1s 6322 [REWARD_MICROSCOPE] step=14050 t=1950.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30112.1s 6323 [STEP  130] t= 1950.0s | phase=0 | reward=   0.01 | total_reward=    1.10
30112.1s 6324 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30112.1s 6325 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30112.1s 6326 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30112.1s 6327 Running simulation until t = 1965.00 s, outputting every 15.00 s
30112.1s 6328 
30112.4s 6329 [PROGRESS] Step 9200: t=1958.07/1965.00s (99.6%) | dt=0.2125s
30112.7s 6330 Stored output at t = 1965.0000 s (Step 9233)
30112.7s 6331 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1950.0/1965.0 [00:00<?, ?s/s][A
30112.7s 6332 [A
30112.7s 6333 
30112.7s 6334 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 23.98s/s]
30112.7s 6335 Simulation finished at t = 1965.0000 s after 9233 steps.
30112.7s 6336 Total runtime: 0.63 seconds.
30112.7s 6337 [QUEUE_DIAGNOSTIC] ===== Step 130 t=1965.0s =====
30112.7s 6338 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30112.7s 6339 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30112.7s 6340 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30112.7s 6341 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30112.7s 6342 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30112.7s 6343 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30112.7s 6344 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30112.7s 6345 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30112.7s 6346 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30112.7s 6347 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30112.7s 6348 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30112.7s 6349 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30112.7s 6350 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30112.7s 6351 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30112.7s 6352 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30112.7s 6353 [REWARD_MICROSCOPE] step=14051 t=1965.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30112.7s 6354 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30112.7s 6355 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30112.7s 6356 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30112.7s 6357 Running simulation until t = 1980.00 s, outputting every 15.00 s
30112.7s 6358 
30112.8s 6359 [PROGRESS] Step 9250: t=1968.62/1980.00s (99.4%) | dt=0.2130s
30112.9s 6360 [WARNING] Automatic CFL correction applied (count: 3313500):
30112.9s 6361 Calculated CFL: 0.800 > Limit: 0.500
30112.9s 6362 Original dt: 3.408612e-01 s
30112.9s 6363 Corrected dt: 2.130383e-01 s
30112.9s 6364 Correction factor: 1.6x
30112.9s 6365 Max wave speed detected: 23.47 m/s
30113.3s 6366 [PROGRESS] Step 9300: t=1979.27/1980.00s (100.0%) | dt=0.2127s
30113.3s 6367 Stored output at t = 1980.0000 s (Step 9304)
30113.3s 6368 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1965.0/1980.0 [00:00<?, ?s/s][A
30113.3s 6369 [A
30113.3s 6370 
30113.3s 6371 Simulation finished at t = 1980.0000 s after 9304 steps.
30113.3s 6372 Total runtime: 0.62 seconds.
30113.3s 6373 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.35s/s]
30113.3s 6374 [REWARD_MICROSCOPE] step=14052 t=1980.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30113.3s 6375 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30113.3s 6376 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30113.3s 6377 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30113.3s 6378 Running simulation until t = 1995.00 s, outputting every 15.00 s
30113.3s 6379 
30113.7s 6380 [PROGRESS] Step 9350: t=1989.77/1995.00s (99.7%) | dt=0.2126s
30113.8s 6381 [WARNING] Automatic CFL correction applied (count: 3313600):
30113.8s 6382 Calculated CFL: 0.800 > Limit: 0.500
30113.8s 6383 Original dt: 3.402871e-01 s
30113.8s 6384 Corrected dt: 2.126795e-01 s
30113.8s 6385 Correction factor: 1.6x
30113.8s 6386 Max wave speed detected: 23.51 m/s
30113.9s 6387 Stored output at t = 1995.0000 s (Step 9375)
30113.9s 6388 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1980.0/1995.0 [00:00<?, ?s/s][A
30113.9s 6389 [A
30113.9s 6390 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.47s/s]
30113.9s 6391 
30113.9s 6392 Simulation finished at t = 1995.0000 s after 9375 steps.
30113.9s 6393 Total runtime: 0.61 seconds.
30113.9s 6394 [REWARD_MICROSCOPE] step=14053 t=1995.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30113.9s 6395 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30113.9s 6396 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30113.9s 6397 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30113.9s 6398 Running simulation until t = 2010.00 s, outputting every 15.00 s
30113.9s 6399 
30114.2s 6400 [PROGRESS] Step 9400: t=2000.32/2010.00s (99.5%) | dt=0.2130s
30114.2s 6401 [PERIODIC:1000] BC_DISPATCHER [Call #13255000] current_bc_params: <class 'dict'>
30114.2s 6402 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30114.2s 6403 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30114.2s 6404 [PERIODIC:1000] BC_GPU [Call #13255000] About to launch kernel
30114.2s 6405 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30114.2s 6406 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30114.2s 6407 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30114.6s 6408 Stored output at t = 2010.0000 s (Step 9446)
30114.6s 6409 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1995.0/2010.0 [00:00<?, ?s/s][A
30114.6s 6410 [A
30114.6s 6411 
30114.6s 6412 Simulation finished at t = 2010.0000 s after 9446 steps.
30114.6s 6413 Total runtime: 0.63 seconds.
30114.6s 6414 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.01s/s]
30114.6s 6415 [REWARD_MICROSCOPE] step=14054 t=2010.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30114.6s 6416 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30114.6s 6417 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30114.6s 6418 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30114.6s 6419 Running simulation until t = 2025.00 s, outputting every 15.00 s
30114.6s 6420 
30114.6s 6421 [PROGRESS] Step 9450: t=2010.85/2025.00s (99.3%) | dt=0.2124s
30114.6s 6422 [WARNING] Automatic CFL correction applied (count: 3313700):
30114.6s 6423 Calculated CFL: 0.800 > Limit: 0.500
30114.6s 6424 Original dt: 3.397169e-01 s
30114.6s 6425 Corrected dt: 2.123230e-01 s
30114.6s 6426 Correction factor: 1.6x
30114.6s 6427 Max wave speed detected: 23.55 m/s
30115.0s 6428 [PROGRESS] Step 9500: t=2021.47/2025.00s (99.8%) | dt=0.2127s
30115.2s 6429 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2010.0/2025.0 [00:00<?, ?s/s][A
30115.2s 6430 [A
30115.2s 6431 Stored output at t = 2025.0000 s (Step 9517)
30115.2s 6432 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 23.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 23.91s/s]
30115.2s 6433 
30115.2s 6434 Simulation finished at t = 2025.0000 s after 9517 steps.
30115.2s 6435 Total runtime: 0.63 seconds.
30115.2s 6436 [REWARD_MICROSCOPE] step=14055 t=2025.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30115.2s 6437 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30115.2s 6438 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30115.2s 6439 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30115.2s 6440 Running simulation until t = 2040.00 s, outputting every 15.00 s
30115.2s 6441 
30115.5s 6442 [PROGRESS] Step 9550: t=2032.03/2040.00s (99.6%) | dt=0.2131s
30115.5s 6443 [WARNING] Automatic CFL correction applied (count: 3313800):
30115.5s 6444 Calculated CFL: 0.800 > Limit: 0.500
30115.5s 6445 Original dt: 3.410795e-01 s
30115.5s 6446 Corrected dt: 2.131747e-01 s
30115.5s 6447 Correction factor: 1.6x
30115.5s 6448 Max wave speed detected: 23.45 m/s
30115.8s 6449 Stored output at t = 2040.0000 s (Step 9588)
30115.8s 6450 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2025.0/2040.0 [00:00<?, ?s/s][A
30115.8s 6451 [A
30115.8s 6452 
30115.8s 6453 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.13s/s]
30115.8s 6454 Simulation finished at t = 2040.0000 s after 9588 steps.
30115.8s 6455 Total runtime: 0.62 seconds.
30115.8s 6456 [REWARD_MICROSCOPE] step=14056 t=2040.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30115.8s 6457 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30115.8s 6458 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30115.8s 6459 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30115.8s 6460 Running simulation until t = 2055.00 s, outputting every 15.00 s
30115.8s 6461 
30115.9s 6462 [PROGRESS] Step 9600: t=2042.55/2055.00s (99.4%) | dt=0.2123s
30116.4s 6463 [PROGRESS] Step 9650: t=2053.18/2055.00s (99.9%) | dt=0.2128s
30116.4s 6464 [PERIODIC:1000] BC_DISPATCHER [Call #13256000] current_bc_params: <class 'dict'>
30116.4s 6465 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30116.4s 6466 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30116.4s 6467 [PERIODIC:1000] BC_GPU [Call #13256000] About to launch kernel
30116.4s 6468 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30116.4s 6469 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30116.4s 6470 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30116.4s 6471 [WARNING] Automatic CFL correction applied (count: 3313900):
30116.4s 6472 Calculated CFL: 0.800 > Limit: 0.500
30116.4s 6473 Original dt: 3.405090e-01 s
30116.4s 6474 Corrected dt: 2.128181e-01 s
30116.4s 6475 Correction factor: 1.6x
30116.4s 6476 Max wave speed detected: 23.49 m/s
30116.4s 6477 Stored output at t = 2055.0000 s (Step 9659)
30116.4s 6478 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2040.0/2055.0 [00:00<?, ?s/s][A
30116.4s 6479 [A
30116.4s 6480 
30116.4s 6481 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.30s/s]
30116.4s 6482 Simulation finished at t = 2055.0000 s after 9659 steps.
30116.4s 6483 Total runtime: 0.62 seconds.
30116.4s 6484 [REWARD_MICROSCOPE] step=14057 t=2055.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30116.4s 6485 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30116.4s 6486 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30116.4s 6487 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30116.4s 6488 Running simulation until t = 2070.00 s, outputting every 15.00 s
30116.4s 6489 
30116.8s 6490 [PROGRESS] Step 9700: t=2063.73/2070.00s (99.7%) | dt=0.2132s
30117.1s 6491 Stored output at t = 2070.0000 s (Step 9730)
30117.1s 6492 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2055.0/2070.0 [00:00<?, ?s/s][A
30117.1s 6493 [A
30117.1s 6494 
30117.1s 6495 Simulation finished at t = 2070.0000 s after 9730 steps.
30117.1s 6496 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 23.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 23.38s/s]
30117.1s 6497 Total runtime: 0.64 seconds.
30117.1s 6498 [REWARD_MICROSCOPE] step=14058 t=2070.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30117.1s 6499 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30117.1s 6500 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30117.1s 6501 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30117.1s 6502 Running simulation until t = 2085.00 s, outputting every 15.00 s
30117.1s 6503 
30117.3s 6504 [PROGRESS] Step 9750: t=2074.25/2085.00s (99.5%) | dt=0.2124s
30117.3s 6505 [WARNING] Automatic CFL correction applied (count: 3314000):
30117.3s 6506 Calculated CFL: 0.800 > Limit: 0.500
30117.3s 6507 Original dt: 3.399193e-01 s
30117.3s 6508 Corrected dt: 2.124495e-01 s
30117.3s 6509 Correction factor: 1.6x
30117.3s 6510 Max wave speed detected: 23.53 m/s
30117.7s 6511 [PROGRESS] Step 9800: t=2084.88/2085.00s (100.0%) | dt=0.2128s
30117.7s 6512 Stored output at t = 2085.0000 s (Step 9801)
30117.7s 6513 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2070.0/2085.0 [00:00<?, ?s/s][A
30117.7s 6514 [A
30117.7s 6515 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.58s/s]
30117.7s 6516 
30117.7s 6517 Simulation finished at t = 2085.0000 s after 9801 steps.
30117.7s 6518 Total runtime: 0.61 seconds.
30117.7s 6519 [REWARD_MICROSCOPE] step=14059 t=2085.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30117.7s 6520 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30117.7s 6521 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30117.7s 6522 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30117.7s 6523 Running simulation until t = 2100.00 s, outputting every 15.00 s
30117.7s 6524 
30118.1s 6525 [PROGRESS] Step 9850: t=2095.44/2100.00s (99.8%) | dt=0.2133s
30118.2s 6526 [WARNING] Automatic CFL correction applied (count: 3314100):
30118.2s 6527 Calculated CFL: 0.800 > Limit: 0.500
30118.2s 6528 Original dt: 3.411066e-01 s
30118.2s 6529 Corrected dt: 2.131916e-01 s
30118.2s 6530 Correction factor: 1.6x
30118.2s 6531 Max wave speed detected: 23.45 m/s
30118.3s 6532 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2085.0/2100.0 [00:00<?, ?s/s][A
30118.3s 6533 [A
30118.3s 6534 Stored output at t = 2100.0000 s (Step 9872)
30118.3s 6535 
30118.3s 6536 Simulation finished at t = 2100.0000 s after 9872 steps.
30118.3s 6537 Total runtime: 0.63 seconds.
30118.3s 6538 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 23.86s/s]
30118.3s 6539 [REWARD_MICROSCOPE] step=14060 t=2100.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30118.3s 6540 [STEP  140] t= 2100.0s | phase=0 | reward=   0.01 | total_reward=    1.20
30118.3s 6541 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30118.3s 6542 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30118.3s 6543 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30118.3s 6544 Running simulation until t = 2115.00 s, outputting every 15.00 s
30118.3s 6545 
30118.6s 6546 [PROGRESS] Step 9900: t=2105.95/2115.00s (99.6%) | dt=0.2125s
30118.6s 6547 [PERIODIC:1000] BC_DISPATCHER [Call #13257000] current_bc_params: <class 'dict'>
30118.6s 6548 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30118.6s 6549 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30118.6s 6550 [PERIODIC:1000] BC_GPU [Call #13257000] About to launch kernel
30118.6s 6551 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30118.6s 6552 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30118.6s 6553 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30118.9s 6554 Stored output at t = 2115.0000 s (Step 9943)
30118.9s 6555 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2100.0/2115.0 [00:00<?, ?s/s][A
30118.9s 6556 [A
30118.9s 6557 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.28s/s]
30118.9s 6558 
30118.9s 6559 Simulation finished at t = 2115.0000 s after 9943 steps.
30118.9s 6560 Total runtime: 0.62 seconds.
30118.9s 6561 [QUEUE_DIAGNOSTIC] ===== Step 140 t=2115.0s =====
30118.9s 6562 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30118.9s 6563 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30118.9s 6564 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30119.0s 6565 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30119.0s 6566 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30119.0s 6567 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30119.0s 6568 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30119.0s 6569 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30119.0s 6570 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30119.0s 6571 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30119.0s 6572 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30119.0s 6573 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30119.0s 6574 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30119.0s 6575 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30119.0s 6576 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30119.0s 6577 [REWARD_MICROSCOPE] step=14061 t=2115.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30119.0s 6578 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30119.0s 6579 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30119.0s 6580 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30119.0s 6581 Running simulation until t = 2130.00 s, outputting every 15.00 s
30119.0s 6582 
30119.0s 6583 [PROGRESS] Step 9950: t=2116.49/2130.00s (99.4%) | dt=0.2129s
30119.1s 6584 [WARNING] Automatic CFL correction applied (count: 3314200):
30119.1s 6585 Calculated CFL: 0.800 > Limit: 0.500
30119.1s 6586 Original dt: 3.407212e-01 s
30119.1s 6587 Corrected dt: 2.129508e-01 s
30119.1s 6588 Correction factor: 1.6x
30119.1s 6589 Max wave speed detected: 23.48 m/s
30119.4s 6590 [PROGRESS] Step 10000: t=2127.15/2130.00s (99.9%) | dt=0.2131s
30119.6s 6591 Stored output at t = 2130.0000 s (Step 10014)
30119.6s 6592 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2115.0/2130.0 [00:00<?, ?s/s][A
30119.6s 6593 [A
30119.6s 6594 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.50s/s]
30119.6s 6595 
30119.6s 6596 Simulation finished at t = 2130.0000 s after 10014 steps.
30119.6s 6597 Total runtime: 0.61 seconds.
30119.6s 6598 [REWARD_MICROSCOPE] step=14062 t=2130.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30119.6s 6599 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30119.6s 6600 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30119.6s 6601 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30119.6s 6602 Running simulation until t = 2145.00 s, outputting every 15.00 s
30119.6s 6603 
30119.9s 6604 [PROGRESS] Step 10050: t=2137.65/2145.00s (99.7%) | dt=0.2125s
30119.9s 6605 [WARNING] Automatic CFL correction applied (count: 3314300):
30119.9s 6606 Calculated CFL: 0.800 > Limit: 0.500
30119.9s 6607 Original dt: 3.401477e-01 s
30119.9s 6608 Corrected dt: 2.125923e-01 s
30119.9s 6609 Correction factor: 1.6x
30119.9s 6610 Max wave speed detected: 23.52 m/s
30120.2s 6611 Stored output at t = 2145.0000 s (Step 10085)
30120.2s 6612 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2130.0/2145.0 [00:00<?, ?s/s][A
30120.2s 6613 [A
30120.2s 6614 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 24.04s/s]
30120.2s 6615 
30120.2s 6616 Simulation finished at t = 2145.0000 s after 10085 steps.
30120.2s 6617 Total runtime: 0.62 seconds.
30120.2s 6618 [REWARD_MICROSCOPE] step=14063 t=2145.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30120.2s 6619 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30120.2s 6620 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30120.2s 6621 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30120.2s 6622 Running simulation until t = 2160.00 s, outputting every 15.00 s
30120.2s 6623 
30120.3s 6624 [PROGRESS] Step 10100: t=2148.19/2160.00s (99.5%) | dt=0.2130s
30120.8s 6625 [PROGRESS] Step 10150: t=2158.85/2160.00s (99.9%) | dt=0.2127s
30120.8s 6626 [PERIODIC:1000] BC_DISPATCHER [Call #13258000] current_bc_params: <class 'dict'>
30120.8s 6627 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30120.8s 6628 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30120.8s 6629 [PERIODIC:1000] BC_GPU [Call #13258000] About to launch kernel
30120.8s 6630 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30120.8s 6631 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30120.8s 6632 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30120.9s 6633 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2145.0/2160.0 [00:00<?, ?s/s][A
30120.9s 6634 [A
30120.9s 6635 Stored output at t = 2160.0000 s (Step 10156)
30120.9s 6636 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 22.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 22.81s/s]
30120.9s 6637 
30120.9s 6638 Simulation finished at t = 2160.0000 s after 10156 steps.
30120.9s 6639 Total runtime: 0.66 seconds.
30120.9s 6640 [REWARD_MICROSCOPE] step=14064 t=2160.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30120.9s 6641 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30120.9s 6642 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30120.9s 6643 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30120.9s 6644 
30120.9s 6645 Running simulation until t = 2175.00 s, outputting every 15.00 s
30120.9s 6646 [WARNING] Automatic CFL correction applied (count: 3314400):
30120.9s 6647 Calculated CFL: 0.800 > Limit: 0.500
30120.9s 6648 Original dt: 3.400436e-01 s
30120.9s 6649 Corrected dt: 2.125273e-01 s
30120.9s 6650 Correction factor: 1.6x
30120.9s 6651 Max wave speed detected: 23.53 m/s
30121.2s 6652 [PROGRESS] Step 10200: t=2169.35/2175.00s (99.7%) | dt=0.2126s
30121.5s 6653 Stored output at t = 2175.0000 s (Step 10227)
30121.5s 6654 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2160.0/2175.0 [00:00<?, ?s/s][A
30121.5s 6655 [A
30121.5s 6656 
30121.5s 6657 Simulation finished at t = 2175.0000 s after 10227 steps.
30121.5s 6658 Total runtime: 0.62 seconds.
30121.5s 6659 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 24.11s/s]
30121.5s 6660 [REWARD_MICROSCOPE] step=14065 t=2175.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30121.5s 6661 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30121.5s 6662 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30121.5s 6663 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30121.5s 6664 Running simulation until t = 2190.00 s, outputting every 15.00 s
30121.5s 6665 
30121.7s 6666 [PROGRESS] Step 10250: t=2179.90/2190.00s (99.5%) | dt=0.2130s
30121.7s 6667 [WARNING] Automatic CFL correction applied (count: 3314500):
30121.7s 6668 Calculated CFL: 0.800 > Limit: 0.500
30121.7s 6669 Original dt: 3.409462e-01 s
30121.7s 6670 Corrected dt: 2.130914e-01 s
30121.7s 6671 Correction factor: 1.6x
30121.7s 6672 Max wave speed detected: 23.46 m/s
30122.1s 6673 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2175.0/2190.0 [00:00<?, ?s/s][A
30122.1s 6674 [A
30122.1s 6675 Stored output at t = 2190.0000 s (Step 10298)
30122.1s 6676 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.18s/s]
30122.1s 6677 
30122.1s 6678 Simulation finished at t = 2190.0000 s after 10298 steps.
30122.1s 6679 Total runtime: 0.62 seconds.
30122.1s 6680 [REWARD_MICROSCOPE] step=14066 t=2190.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30122.1s 6681 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30122.1s 6682 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30122.1s 6683 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30122.1s 6684 Running simulation until t = 2205.00 s, outputting every 15.00 s
30122.1s 6685 
30122.1s 6686 [PROGRESS] Step 10300: t=2190.43/2205.00s (99.3%) | dt=0.2125s
30122.6s 6687 [PROGRESS] Step 10350: t=2201.05/2205.00s (99.8%) | dt=0.2127s
30122.6s 6688 [WARNING] Automatic CFL correction applied (count: 3314600):
30122.6s 6689 Calculated CFL: 0.800 > Limit: 0.500
30122.6s 6690 Original dt: 3.403711e-01 s
30122.6s 6691 Corrected dt: 2.127320e-01 s
30122.6s 6692 Correction factor: 1.6x
30122.6s 6693 Max wave speed detected: 23.50 m/s
30122.7s 6694 Stored output at t = 2205.0000 s (Step 10369)
30122.7s 6695 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2190.0/2205.0 [00:00<?, ?s/s][A
30122.7s 6696 [A
30122.7s 6697 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.62s/s]
30122.7s 6698 
30122.7s 6699 Simulation finished at t = 2205.0000 s after 10369 steps.
30122.7s 6700 Total runtime: 0.61 seconds.
30122.7s 6701 [REWARD_MICROSCOPE] step=14067 t=2205.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30122.7s 6702 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30122.7s 6703 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30122.7s 6704 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30122.7s 6705 Running simulation until t = 2220.00 s, outputting every 15.00 s
30122.7s 6706 
30123.0s 6707 [PROGRESS] Step 10400: t=2211.60/2220.00s (99.6%) | dt=0.2131s
30123.0s 6708 [PERIODIC:1000] BC_DISPATCHER [Call #13259000] current_bc_params: <class 'dict'>
30123.0s 6709 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30123.0s 6710 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30123.0s 6711 [PERIODIC:1000] BC_GPU [Call #13259000] About to launch kernel
30123.0s 6712 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30123.0s 6713 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30123.0s 6714 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30123.3s 6715 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2205.0/2220.0 [00:00<?, ?s/s][A
30123.3s 6716 [A
30123.3s 6717 Stored output at t = 2220.0000 s (Step 10440)
30123.3s 6718 
30123.3s 6719 Simulation finished at t = 2220.0000 s after 10440 steps.
30123.3s 6720 Total runtime: 0.63 seconds.
30123.3s 6721 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 23.86s/s]
30123.3s 6722 [REWARD_MICROSCOPE] step=14068 t=2220.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30123.4s 6723 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30123.4s 6724 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30123.4s 6725 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30123.4s 6726 Running simulation until t = 2235.00 s, outputting every 15.00 s
30123.4s 6727 
30123.4s 6728 [PROGRESS] Step 10450: t=2222.12/2235.00s (99.4%) | dt=0.2123s
30123.5s 6729 [WARNING] Automatic CFL correction applied (count: 3314700):
30123.5s 6730 Calculated CFL: 0.800 > Limit: 0.500
30123.5s 6731 Original dt: 3.397675e-01 s
30123.5s 6732 Corrected dt: 2.123547e-01 s
30123.5s 6733 Correction factor: 1.6x
30123.5s 6734 Max wave speed detected: 23.55 m/s
30123.9s 6735 [PROGRESS] Step 10500: t=2232.75/2235.00s (99.9%) | dt=0.2127s
30124.0s 6736 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2220.0/2235.0 [00:00<?, ?s/s][A
30124.0s 6737 Stored output at t = 2235.0000 s (Step 10511)
30124.0s 6738 [A
30124.0s 6739 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.46s/s]
30124.0s 6740 
30124.0s 6741 Simulation finished at t = 2235.0000 s after 10511 steps.
30124.0s 6742 Total runtime: 0.61 seconds.
30124.0s 6743 [REWARD_MICROSCOPE] step=14069 t=2235.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30124.0s 6744 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30124.0s 6745 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30124.0s 6746 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30124.0s 6747 Running simulation until t = 2250.00 s, outputting every 15.00 s
30124.0s 6748 
30124.3s 6749 [PROGRESS] Step 10550: t=2243.31/2250.00s (99.7%) | dt=0.2132s
30124.4s 6750 [WARNING] Automatic CFL correction applied (count: 3314800):
30124.4s 6751 Calculated CFL: 0.800 > Limit: 0.500
30124.4s 6752 Original dt: 3.411605e-01 s
30124.4s 6753 Corrected dt: 2.132253e-01 s
30124.4s 6754 Correction factor: 1.6x
30124.4s 6755 Max wave speed detected: 23.45 m/s
30124.6s 6756 Stored output at t = 2250.0000 s (Step 10582)
30124.6s 6757 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2235.0/2250.0 [00:00<?, ?s/s][A
30124.6s 6758 [A
30124.6s 6759 
30124.6s 6760 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.17s/s]
30124.6s 6761 Simulation finished at t = 2250.0000 s after 10582 steps.
30124.6s 6762 Total runtime: 0.62 seconds.
30124.6s 6763 [REWARD_MICROSCOPE] step=14070 t=2250.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30124.6s 6764 [STEP  150] t= 2250.0s | phase=0 | reward=   0.01 | total_reward=    1.30
30124.6s 6765 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30124.6s 6766 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30124.6s 6767 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30124.6s 6768 Running simulation until t = 2265.00 s, outputting every 15.00 s
30124.6s 6769 
30124.7s 6770 [PROGRESS] Step 10600: t=2253.82/2265.00s (99.5%) | dt=0.2124s
30125.2s 6771 [PROGRESS] Step 10650: t=2264.45/2265.00s (100.0%) | dt=0.2128s
30125.2s 6772 [PERIODIC:1000] BC_DISPATCHER [Call #13260000] current_bc_params: <class 'dict'>
30125.2s 6773 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30125.2s 6774 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30125.2s 6775 [PERIODIC:1000] BC_GPU [Call #13260000] About to launch kernel
30125.2s 6776 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30125.2s 6777 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30125.2s 6778 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30125.2s 6779 Stored output at t = 2265.0000 s (Step 10653)
30125.2s 6780 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2250.0/2265.0 [00:00<?, ?s/s][A
30125.2s 6781 [A
30125.2s 6782 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.03s/s]
30125.2s 6783 
30125.2s 6784 Simulation finished at t = 2265.0000 s after 10653 steps.
30125.2s 6785 Total runtime: 0.62 seconds.
30125.2s 6786 [QUEUE_DIAGNOSTIC] ===== Step 150 t=2265.0s =====
30125.2s 6787 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30125.2s 6788 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30125.2s 6789 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30125.2s 6790 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30125.2s 6791 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30125.2s 6792 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30125.2s 6793 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30125.2s 6794 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30125.2s 6795 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30125.2s 6796 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30125.2s 6797 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30125.2s 6798 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30125.2s 6799 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30125.2s 6800 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30125.2s 6801 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30125.2s 6802 [REWARD_MICROSCOPE] step=14071 t=2265.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30125.2s 6803 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30125.2s 6804 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30125.2s 6805 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30125.2s 6806 Running simulation until t = 2280.00 s, outputting every 15.00 s
30125.2s 6807 
30125.3s 6808 [WARNING] Automatic CFL correction applied (count: 3314900):
30125.3s 6809 Calculated CFL: 0.800 > Limit: 0.500
30125.3s 6810 Original dt: 3.405828e-01 s
30125.3s 6811 Corrected dt: 2.128643e-01 s
30125.3s 6812 Correction factor: 1.6x
30125.3s 6813 Max wave speed detected: 23.49 m/s
30125.6s 6814 [PROGRESS] Step 10700: t=2275.01/2280.00s (99.8%) | dt=0.2132s
30125.8s 6815 Stored output at t = 2280.0000 s (Step 10724)
30125.8s 6816 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2265.0/2280.0 [00:00<?, ?s/s][A
30125.8s 6817 [A
30125.8s 6818 
30125.8s 6819 Simulation finished at t = 2280.0000 s after 10724 steps.
30125.8s 6820 Total runtime: 0.62 seconds.
30125.8s 6821 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.13s/s]
30125.8s 6822 [REWARD_MICROSCOPE] step=14072 t=2280.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30125.8s 6823 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30125.8s 6824 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30125.8s 6825 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30125.8s 6826 Running simulation until t = 2295.00 s, outputting every 15.00 s
30125.8s 6827 
30126.1s 6828 [PROGRESS] Step 10750: t=2285.52/2295.00s (99.6%) | dt=0.2124s
30126.1s 6829 [WARNING] Automatic CFL correction applied (count: 3315000):
30126.1s 6830 Calculated CFL: 0.800 > Limit: 0.500
30126.1s 6831 Original dt: 3.400085e-01 s
30126.1s 6832 Corrected dt: 2.125053e-01 s
30126.1s 6833 Correction factor: 1.6x
30126.1s 6834 Max wave speed detected: 23.53 m/s
30126.5s 6835 Stored output at t = 2295.0000 s (Step 10795)
30126.5s 6836 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2280.0/2295.0 [00:00<?, ?s/s][A
30126.5s 6837 [A
30126.5s 6838 
30126.5s 6839 Simulation finished at t = 2295.0000 s after 10795 steps.
30126.5s 6840 Total runtime: 0.62 seconds.
30126.5s 6841 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.17s/s]
30126.5s 6842 [REWARD_MICROSCOPE] step=14073 t=2295.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30126.5s 6843 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30126.5s 6844 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30126.5s 6845 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30126.5s 6846 Running simulation until t = 2310.00 s, outputting every 15.00 s
30126.5s 6847 
30126.5s 6848 [PROGRESS] Step 10800: t=2296.06/2310.00s (99.4%) | dt=0.2129s
30127.0s 6849 [PROGRESS] Step 10850: t=2306.72/2310.00s (99.9%) | dt=0.2133s
30127.0s 6850 [WARNING] Automatic CFL correction applied (count: 3315100):
30127.0s 6851 Calculated CFL: 0.800 > Limit: 0.500
30127.0s 6852 Original dt: 3.406020e-01 s
30127.0s 6853 Corrected dt: 2.128763e-01 s
30127.0s 6854 Correction factor: 1.6x
30127.0s 6855 Max wave speed detected: 23.49 m/s
30127.1s 6856 Stored output at t = 2310.0000 s (Step 10866)
30127.1s 6857 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295.0/2310.0 [00:00<?, ?s/s][A
30127.1s 6858 [A
30127.1s 6859 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.18s/s]
30127.1s 6860 
30127.1s 6861 Simulation finished at t = 2310.0000 s after 10866 steps.
30127.1s 6862 Total runtime: 0.62 seconds.
30127.1s 6863 [REWARD_MICROSCOPE] step=14074 t=2310.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30127.1s 6864 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30127.1s 6865 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30127.1s 6866 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30127.1s 6867 Running simulation until t = 2325.00 s, outputting every 15.00 s
30127.1s 6868 
30127.4s 6869 [PROGRESS] Step 10900: t=2317.22/2325.00s (99.7%) | dt=0.2125s
30127.4s 6870 [PERIODIC:1000] BC_DISPATCHER [Call #13261000] current_bc_params: <class 'dict'>
30127.4s 6871 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30127.4s 6872 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30127.4s 6873 [PERIODIC:1000] BC_GPU [Call #13261000] About to launch kernel
30127.4s 6874 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30127.4s 6875 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30127.4s 6876 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30127.7s 6877 Stored output at t = 2325.0000 s (Step 10937)
30127.7s 6878 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310.0/2325.0 [00:00<?, ?s/s][A
30127.7s 6879 [A
30127.7s 6880 
30127.7s 6881 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 24.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 24.74s/s]
30127.7s 6882 Simulation finished at t = 2325.0000 s after 10937 steps.
30127.7s 6883 Total runtime: 0.61 seconds.
30127.7s 6884 [REWARD_MICROSCOPE] step=14075 t=2325.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30127.7s 6885 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30127.7s 6886 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30127.7s 6887 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30127.7s 6888 Running simulation until t = 2340.00 s, outputting every 15.00 s
30127.7s 6889 
30127.8s 6890 [PROGRESS] Step 10950: t=2327.77/2340.00s (99.5%) | dt=0.2129s
30127.9s 6891 [WARNING] Automatic CFL correction applied (count: 3315200):
30127.9s 6892 Calculated CFL: 0.800 > Limit: 0.500
30127.9s 6893 Original dt: 3.408050e-01 s
30127.9s 6894 Corrected dt: 2.130031e-01 s
30127.9s 6895 Correction factor: 1.6x
30127.9s 6896 Max wave speed detected: 23.47 m/s
30128.3s 6897 [PROGRESS] Step 11000: t=2338.42/2340.00s (99.9%) | dt=0.2128s
30128.3s 6898 Stored output at t = 2340.0000 s (Step 11008)
30128.3s 6899 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2325.0/2340.0 [00:00<?, ?s/s][A
30128.3s 6900 [A
30128.3s 6901 
30128.3s 6902 Simulation finished at t = 2340.0000 s after 11008 steps.
30128.3s 6903 Total runtime: 0.62 seconds.
30128.3s 6904 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.24s/s]
30128.3s 6905 [REWARD_MICROSCOPE] step=14076 t=2340.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30128.3s 6906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30128.3s 6907 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30128.3s 6908 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30128.3s 6909 Running simulation until t = 2355.00 s, outputting every 15.00 s
30128.3s 6910 
30128.7s 6911 [PROGRESS] Step 11050: t=2348.92/2355.00s (99.7%) | dt=0.2126s
30128.7s 6912 [WARNING] Automatic CFL correction applied (count: 3315300):
30128.7s 6913 Calculated CFL: 0.800 > Limit: 0.500
30128.7s 6914 Original dt: 3.402313e-01 s
30128.7s 6915 Corrected dt: 2.126446e-01 s
30128.7s 6916 Correction factor: 1.6x
30128.7s 6917 Max wave speed detected: 23.51 m/s
30129.0s 6918 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2340.0/2355.0 [00:00<?, ?s/s][A
30129.0s 6919 [A
30129.0s 6920 Stored output at t = 2355.0000 s (Step 11079)
30129.0s 6921 
30129.0s 6922 Simulation finished at t = 2355.0000 s after 11079 steps.
30129.0s 6923 Total runtime: 0.64 seconds.
30129.0s 6924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 23.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 23.49s/s]
30129.0s 6925 [REWARD_MICROSCOPE] step=14077 t=2355.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30129.0s 6926 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30129.0s 6927 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30129.0s 6928 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30129.0s 6929 Running simulation until t = 2370.00 s, outputting every 15.00 s
30129.0s 6930 
30129.2s 6931 [PROGRESS] Step 11100: t=2359.47/2370.00s (99.6%) | dt=0.2130s
30129.6s 6932 [PROGRESS] Step 11150: t=2370.00/2370.00s (100.0%) | dt=0.0883s
30129.6s 6933 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2355.0/2370.0 [00:00<?, ?s/s][A
30129.6s 6934 [A
30129.6s 6935 Stored output at t = 2370.0000 s (Step 11150)
30129.6s 6936 
30129.6s 6937 Simulation finished at t = 2370.0000 s after 11150 steps.
30129.6s 6938 Total runtime: 0.63 seconds.
30129.6s 6939 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.67s/s]
30129.6s 6940 [REWARD_MICROSCOPE] step=14078 t=2370.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30129.6s 6941 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30129.6s 6942 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30129.6s 6943 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30129.6s 6944 Running simulation until t = 2385.00 s, outputting every 15.00 s
30129.6s 6945 
30129.6s 6946 [PERIODIC:1000] BC_DISPATCHER [Call #13262000] current_bc_params: <class 'dict'>
30129.6s 6947 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30129.6s 6948 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30129.6s 6949 [PERIODIC:1000] BC_GPU [Call #13262000] About to launch kernel
30129.6s 6950 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30129.6s 6951 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30129.6s 6952 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30129.7s 6953 [WARNING] Automatic CFL correction applied (count: 3315400):
30129.7s 6954 Calculated CFL: 0.800 > Limit: 0.500
30129.7s 6955 Original dt: 3.398030e-01 s
30129.7s 6956 Corrected dt: 2.123769e-01 s
30129.7s 6957 Correction factor: 1.6x
30129.7s 6958 Max wave speed detected: 23.54 m/s
30130.1s 6959 [PROGRESS] Step 11200: t=2380.62/2385.00s (99.8%) | dt=0.2127s
30130.2s 6960 Stored output at t = 2385.0000 s (Step 11221)
30130.2s 6961 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2370.0/2385.0 [00:00<?, ?s/s][A
30130.2s 6962 [A
30130.2s 6963 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.01s/s]
30130.2s 6964 
30130.2s 6965 Simulation finished at t = 2385.0000 s after 11221 steps.
30130.2s 6966 Total runtime: 0.63 seconds.
30130.2s 6967 [REWARD_MICROSCOPE] step=14079 t=2385.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30130.2s 6968 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30130.2s 6969 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30130.2s 6970 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30130.2s 6971 Running simulation until t = 2400.00 s, outputting every 15.00 s
30130.2s 6972 
30130.5s 6973 [PROGRESS] Step 11250: t=2391.18/2400.00s (99.6%) | dt=0.2131s
30130.6s 6974 [WARNING] Automatic CFL correction applied (count: 3315500):
30130.6s 6975 Calculated CFL: 0.800 > Limit: 0.500
30130.6s 6976 Original dt: 3.410260e-01 s
30130.6s 6977 Corrected dt: 2.131412e-01 s
30130.6s 6978 Correction factor: 1.6x
30130.6s 6979 Max wave speed detected: 23.46 m/s
30131.0s 6980 Stored output at t = 2400.0000 s (Step 11292)
30131.0s 6981 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2385.0/2400.0 [00:00<?, ?s/s][A
30131.0s 6982 [A
30131.0s 6983 
30131.0s 6984 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 20.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 20.46s/s]
30131.0s 6985 Simulation finished at t = 2400.0000 s after 11292 steps.
30131.0s 6986 Total runtime: 0.73 seconds.
30131.0s 6987 [REWARD_MICROSCOPE] step=14080 t=2400.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30131.0s 6988 [STEP  160] t= 2400.0s | phase=0 | reward=   0.01 | total_reward=    1.40
30131.0s 6989 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30131.0s 6990 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30131.0s 6991 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30131.0s 6992 Running simulation until t = 2415.00 s, outputting every 15.00 s
30131.0s 6993 
30131.1s 6994 [PROGRESS] Step 11300: t=2401.70/2415.00s (99.4%) | dt=0.2124s
30131.5s 6995 [PROGRESS] Step 11350: t=2412.32/2415.00s (99.9%) | dt=0.2127s
30131.6s 6996 [WARNING] Automatic CFL correction applied (count: 3315600):
30131.6s 6997 Calculated CFL: 0.800 > Limit: 0.500
30131.6s 6998 Original dt: 3.404547e-01 s
30131.6s 6999 Corrected dt: 2.127842e-01 s
30131.6s 7000 Correction factor: 1.6x
30131.6s 7001 Max wave speed detected: 23.50 m/s
30131.6s 7002 Stored output at t = 2415.0000 s (Step 11363)
30131.6s 7003 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2400.0/2415.0 [00:00<?, ?s/s][A
30131.6s 7004 [A
30131.6s 7005 
30131.6s 7006 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 22.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 22.65s/s]
30131.6s 7007 Simulation finished at t = 2415.0000 s after 11363 steps.
30131.6s 7008 Total runtime: 0.66 seconds.
30131.6s 7009 [QUEUE_DIAGNOSTIC] ===== Step 160 t=2415.0s =====
30131.6s 7010 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30131.6s 7011 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30131.6s 7012 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30131.6s 7013 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30131.6s 7014 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30131.6s 7015 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30131.6s 7016 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30131.6s 7017 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30131.6s 7018 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30131.6s 7019 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30131.6s 7020 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30131.6s 7021 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30131.6s 7022 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30131.6s 7023 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30131.6s 7024 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30131.6s 7025 [REWARD_MICROSCOPE] step=14081 t=2415.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30131.6s 7026 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30131.6s 7027 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30131.6s 7028 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30131.6s 7029 Running simulation until t = 2430.00 s, outputting every 15.00 s
30131.6s 7030 
30132.0s 7031 [PROGRESS] Step 11400: t=2422.88/2430.00s (99.7%) | dt=0.2131s
30132.0s 7032 [PERIODIC:1000] BC_DISPATCHER [Call #13263000] current_bc_params: <class 'dict'>
30132.0s 7033 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30132.0s 7034 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30132.0s 7035 [PERIODIC:1000] BC_GPU [Call #13263000] About to launch kernel
30132.0s 7036 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30132.0s 7037 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30132.0s 7038 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30132.3s 7039 Stored output at t = 2430.0000 s (Step 11434)
30132.3s 7040 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2415.0/2430.0 [00:00<?, ?s/s][A
30132.3s 7041 [A
30132.3s 7042 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.39s/s]
30132.3s 7043 
30132.3s 7044 Simulation finished at t = 2430.0000 s after 11434 steps.
30132.3s 7045 Total runtime: 0.62 seconds.
30132.3s 7046 [REWARD_MICROSCOPE] step=14082 t=2430.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30132.3s 7047 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30132.3s 7048 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30132.3s 7049 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30132.3s 7050 Running simulation until t = 2445.00 s, outputting every 15.00 s
30132.3s 7051 
30132.4s 7052 [PROGRESS] Step 11450: t=2433.40/2445.00s (99.5%) | dt=0.2123s
30132.5s 7053 [WARNING] Automatic CFL correction applied (count: 3315700):
30132.5s 7054 Calculated CFL: 0.800 > Limit: 0.500
30132.5s 7055 Original dt: 3.398585e-01 s
30132.5s 7056 Corrected dt: 2.124115e-01 s
30132.5s 7057 Correction factor: 1.6x
30132.5s 7058 Max wave speed detected: 23.54 m/s
30132.9s 7059 [PROGRESS] Step 11500: t=2444.03/2445.00s (100.0%) | dt=0.2128s
30132.9s 7060 Stored output at t = 2445.0000 s (Step 11505)
30132.9s 7061 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2430.0/2445.0 [00:00<?, ?s/s][A
30132.9s 7062 [A
30132.9s 7063 
30132.9s 7064 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.55s/s]
30132.9s 7065 Simulation finished at t = 2445.0000 s after 11505 steps.
30132.9s 7066 Total runtime: 0.64 seconds.
30132.9s 7067 [REWARD_MICROSCOPE] step=14083 t=2445.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30132.9s 7068 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30132.9s 7069 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30132.9s 7070 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30132.9s 7071 Running simulation until t = 2460.00 s, outputting every 15.00 s
30132.9s 7072 
30133.3s 7073 [PROGRESS] Step 11550: t=2454.59/2460.00s (99.8%) | dt=0.2132s
30133.4s 7074 [WARNING] Automatic CFL correction applied (count: 3315800):
30133.4s 7075 Calculated CFL: 0.800 > Limit: 0.500
30133.4s 7076 Original dt: 3.412422e-01 s
30133.4s 7077 Corrected dt: 2.132764e-01 s
30133.4s 7078 Correction factor: 1.6x
30133.4s 7079 Max wave speed detected: 23.44 m/s
30133.5s 7080 Stored output at t = 2460.0000 s (Step 11576)
30133.5s 7081 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2445.0/2460.0 [00:00<?, ?s/s][A
30133.5s 7082 [A
30133.5s 7083 
30133.5s 7084 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 23.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 23.77s/s]
30133.5s 7085 Simulation finished at t = 2460.0000 s after 11576 steps.
30133.5s 7086 Total runtime: 0.63 seconds.
30133.5s 7087 [REWARD_MICROSCOPE] step=14084 t=2460.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30133.5s 7088 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30133.5s 7089 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30133.5s 7090 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30133.5s 7091 Running simulation until t = 2475.00 s, outputting every 15.00 s
30133.5s 7092 
30133.7s 7093 [PROGRESS] Step 11600: t=2465.10/2475.00s (99.6%) | dt=0.2124s
30134.2s 7094 Stored output at t = 2475.0000 s (Step 11647)
30134.2s 7095 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2460.0/2475.0 [00:00<?, ?s/s][A
30134.2s 7096 [A
30134.2s 7097 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.83s/s]
30134.2s 7098 
30134.2s 7099 Simulation finished at t = 2475.0000 s after 11647 steps.
30134.2s 7100 Total runtime: 0.63 seconds.
30134.2s 7101 [REWARD_MICROSCOPE] step=14085 t=2475.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30134.2s 7102 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30134.2s 7103 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30134.2s 7104 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30134.2s 7105 Running simulation until t = 2490.00 s, outputting every 15.00 s
30134.2s 7106 
30134.2s 7107 [PROGRESS] Step 11650: t=2475.64/2490.00s (99.4%) | dt=0.2129s
30134.2s 7108 [PERIODIC:1000] BC_DISPATCHER [Call #13264000] current_bc_params: <class 'dict'>
30134.2s 7109 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30134.2s 7110 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30134.2s 7111 [PERIODIC:1000] BC_GPU [Call #13264000] About to launch kernel
30134.2s 7112 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30134.2s 7113 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30134.2s 7114 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30134.2s 7115 [WARNING] Automatic CFL correction applied (count: 3315900):
30134.3s 7116 Calculated CFL: 0.800 > Limit: 0.500
30134.3s 7117 Original dt: 3.406657e-01 s
30134.3s 7118 Corrected dt: 2.129161e-01 s
30134.3s 7119 Correction factor: 1.6x
30134.3s 7120 Max wave speed detected: 23.48 m/s
30134.6s 7121 [PROGRESS] Step 11700: t=2486.29/2490.00s (99.9%) | dt=0.2133s
30134.8s 7122 Stored output at t = 2490.0000 s (Step 11718)
30134.8s 7123 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2475.0/2490.0 [00:00<?, ?s/s][A
30134.8s 7124 [A
30134.8s 7125 
30134.8s 7126 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.74s/s]
30134.8s 7127 Simulation finished at t = 2490.0000 s after 11718 steps.
30134.8s 7128 Total runtime: 0.63 seconds.
30134.8s 7129 [REWARD_MICROSCOPE] step=14086 t=2490.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30134.8s 7130 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30134.8s 7131 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30134.8s 7132 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30134.8s 7133 Running simulation until t = 2505.00 s, outputting every 15.00 s
30134.8s 7134 
30135.1s 7135 [PROGRESS] Step 11750: t=2496.80/2505.00s (99.7%) | dt=0.2125s
30135.1s 7136 [WARNING] Automatic CFL correction applied (count: 3316000):
30135.1s 7137 Calculated CFL: 0.800 > Limit: 0.500
30135.1s 7138 Original dt: 3.400921e-01 s
30135.1s 7139 Corrected dt: 2.125575e-01 s
30135.1s 7140 Correction factor: 1.6x
30135.1s 7141 Max wave speed detected: 23.52 m/s
30135.4s 7142 Stored output at t = 2505.0000 s (Step 11789)
30135.4s 7143 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2490.0/2505.0 [00:00<?, ?s/s][A
30135.4s 7144 [A
30135.4s 7145 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 23.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 23.61s/s]
30135.4s 7146 
30135.4s 7147 Simulation finished at t = 2505.0000 s after 11789 steps.
30135.4s 7148 Total runtime: 0.64 seconds.
30135.4s 7149 [REWARD_MICROSCOPE] step=14087 t=2505.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30135.4s 7150 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30135.4s 7151 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30135.4s 7152 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30135.4s 7153 Running simulation until t = 2520.00 s, outputting every 15.00 s
30135.4s 7154 
30135.5s 7155 [PROGRESS] Step 11800: t=2507.34/2520.00s (99.5%) | dt=0.2129s
30136.0s 7156 [PROGRESS] Step 11850: t=2518.00/2520.00s (99.9%) | dt=0.2129s
30136.0s 7157 [WARNING] Automatic CFL correction applied (count: 3316100):
30136.0s 7158 Calculated CFL: 0.800 > Limit: 0.500
30136.0s 7159 Original dt: 3.402189e-01 s
30136.0s 7160 Corrected dt: 2.126368e-01 s
30136.0s 7161 Correction factor: 1.6x
30136.0s 7162 Max wave speed detected: 23.51 m/s
30136.1s 7163 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2505.0/2520.0 [00:00<?, ?s/s][A
30136.1s 7164 [A
30136.1s 7165 Stored output at t = 2520.0000 s (Step 11860)
30136.1s 7166 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.25s/s]
30136.1s 7167 
30136.1s 7168 Simulation finished at t = 2520.0000 s after 11860 steps.
30136.1s 7169 Total runtime: 0.62 seconds.
30136.1s 7170 [REWARD_MICROSCOPE] step=14088 t=2520.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30136.1s 7171 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30136.1s 7172 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30136.1s 7173 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30136.1s 7174 Running simulation until t = 2535.00 s, outputting every 15.00 s
30136.1s 7175 
30136.4s 7176 [PROGRESS] Step 11900: t=2528.50/2535.00s (99.7%) | dt=0.2126s
30136.4s 7177 [PERIODIC:1000] BC_DISPATCHER [Call #13265000] current_bc_params: <class 'dict'>
30136.4s 7178 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30136.4s 7179 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30136.4s 7180 [PERIODIC:1000] BC_GPU [Call #13265000] About to launch kernel
30136.4s 7181 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30136.4s 7182 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30136.4s 7183 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30136.7s 7184 Stored output at t = 2535.0000 s (Step 11931)
30136.7s 7185 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2520.0/2535.0 [00:00<?, ?s/s][A
30136.7s 7186 [A
30136.7s 7187 
30136.7s 7188 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 24.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 24.61s/s]
30136.7s 7189 Simulation finished at t = 2535.0000 s after 11931 steps.
30136.7s 7190 Total runtime: 0.61 seconds.
30136.7s 7191 [REWARD_MICROSCOPE] step=14089 t=2535.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30136.7s 7192 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30136.7s 7193 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30136.7s 7194 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30136.7s 7195 Running simulation until t = 2550.00 s, outputting every 15.00 s
30136.7s 7196 
30136.8s 7197 [PROGRESS] Step 11950: t=2539.05/2550.00s (99.6%) | dt=0.2130s
30136.9s 7198 [WARNING] Automatic CFL correction applied (count: 3316200):
30136.9s 7199 Calculated CFL: 0.800 > Limit: 0.500
30136.9s 7200 Original dt: 3.408895e-01 s
30136.9s 7201 Corrected dt: 2.130559e-01 s
30136.9s 7202 Correction factor: 1.6x
30136.9s 7203 Max wave speed detected: 23.47 m/s
30137.3s 7204 [PROGRESS] Step 12000: t=2549.70/2550.00s (100.0%) | dt=0.2126s
30137.3s 7205 Stored output at t = 2550.0000 s (Step 12002)
30137.3s 7206 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2535.0/2550.0 [00:00<?, ?s/s][A
30137.3s 7207 [A
30137.3s 7208 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.33s/s]
30137.3s 7209 
30137.3s 7210 Simulation finished at t = 2550.0000 s after 12002 steps.
30137.3s 7211 Total runtime: 0.62 seconds.
30137.3s 7212 [REWARD_MICROSCOPE] step=14090 t=2550.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30137.3s 7213 [STEP  170] t= 2550.0s | phase=0 | reward=   0.01 | total_reward=    1.50
30137.3s 7214 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30137.3s 7215 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30137.3s 7216 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30137.3s 7217 Running simulation until t = 2565.00 s, outputting every 15.00 s
30137.3s 7218 
30137.7s 7219 [PROGRESS] Step 12050: t=2560.20/2565.00s (99.8%) | dt=0.2126s
30137.8s 7220 [WARNING] Automatic CFL correction applied (count: 3316300):
30137.8s 7221 Calculated CFL: 0.800 > Limit: 0.500
30137.8s 7222 Original dt: 3.403151e-01 s
30137.8s 7223 Corrected dt: 2.126969e-01 s
30137.8s 7224 Correction factor: 1.6x
30137.8s 7225 Max wave speed detected: 23.51 m/s
30137.9s 7226 Stored output at t = 2565.0000 s (Step 12073)
30137.9s 7227 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2550.0/2565.0 [00:00<?, ?s/s][A
30137.9s 7228 [A
30137.9s 7229 
30137.9s 7230 Simulation finished at t = 2565.0000 s after 12073 steps.
30137.9s 7231 Total runtime: 0.61 seconds.
30137.9s 7232 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 24.54s/s]
30137.9s 7233 [QUEUE_DIAGNOSTIC] ===== Step 170 t=2565.0s =====
30137.9s 7234 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30137.9s 7235 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30137.9s 7236 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30137.9s 7237 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30137.9s 7238 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30137.9s 7239 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30137.9s 7240 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30137.9s 7241 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30137.9s 7242 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30137.9s 7243 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30137.9s 7244 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30137.9s 7245 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30137.9s 7246 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30137.9s 7247 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30137.9s 7248 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30137.9s 7249 [REWARD_MICROSCOPE] step=14091 t=2565.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30137.9s 7250 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30137.9s 7251 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30137.9s 7252 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30137.9s 7253 Running simulation until t = 2580.00 s, outputting every 15.00 s
30137.9s 7254 
30138.1s 7255 [PROGRESS] Step 12100: t=2570.75/2580.00s (99.6%) | dt=0.2131s
30138.5s 7256 Stored output at t = 2580.0000 s (Step 12144)
30138.5s 7257 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2565.0/2580.0 [00:00<?, ?s/s][A
30138.5s 7258 [A
30138.5s 7259 
30138.5s 7260 Simulation finished at t = 2580.0000 s after 12144 steps.
30138.5s 7261 Total runtime: 0.61 seconds.
30138.5s 7262 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.52s/s]
30138.5s 7263 [REWARD_MICROSCOPE] step=14092 t=2580.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30138.5s 7264 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30138.5s 7265 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30138.5s 7266 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30138.5s 7267 Running simulation until t = 2595.00 s, outputting every 15.00 s
30138.5s 7268 
30138.6s 7269 [PROGRESS] Step 12150: t=2581.27/2595.00s (99.5%) | dt=0.2124s
30138.6s 7270 [PERIODIC:1000] BC_DISPATCHER [Call #13266000] current_bc_params: <class 'dict'>
30138.6s 7271 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30138.6s 7272 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30138.6s 7273 [PERIODIC:1000] BC_GPU [Call #13266000] About to launch kernel
30138.6s 7274 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30138.6s 7275 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30138.6s 7276 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30138.6s 7277 [WARNING] Automatic CFL correction applied (count: 3316400):
30138.6s 7278 Calculated CFL: 0.800 > Limit: 0.500
30138.6s 7279 Original dt: 3.395915e-01 s
30138.6s 7280 Corrected dt: 2.122447e-01 s
30138.6s 7281 Correction factor: 1.6x
30138.6s 7282 Max wave speed detected: 23.56 m/s
30139.0s 7283 [PROGRESS] Step 12200: t=2591.88/2595.00s (99.9%) | dt=0.2119s
30139.2s 7284 Stored output at t = 2595.0000 s (Step 12215)
30139.2s 7285 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2580.0/2595.0 [00:00<?, ?s/s][A
30139.2s 7286 [A
30139.2s 7287 
30139.2s 7288 Simulation finished at t = 2595.0000 s after 12215 steps.
30139.2s 7289 Total runtime: 0.62 seconds.
30139.2s 7290 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.15s/s]
30139.2s 7291 [REWARD_MICROSCOPE] step=14093 t=2595.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30139.2s 7292 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30139.2s 7293 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30139.2s 7294 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30139.2s 7295 Running simulation until t = 2610.00 s, outputting every 15.00 s
30139.2s 7296 
30139.5s 7297 [PROGRESS] Step 12250: t=2602.41/2610.00s (99.7%) | dt=0.2118s
30139.5s 7298 [WARNING] Automatic CFL correction applied (count: 3316500):
30139.5s 7299 Calculated CFL: 0.800 > Limit: 0.500
30139.5s 7300 Original dt: 3.388870e-01 s
30139.5s 7301 Corrected dt: 2.118044e-01 s
30139.5s 7302 Correction factor: 1.6x
30139.5s 7303 Max wave speed detected: 23.61 m/s
30139.8s 7304 Stored output at t = 2610.0000 s (Step 12286)
30139.8s 7305 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2595.0/2610.0 [00:00<?, ?s/s][A
30139.8s 7306 [A
30139.8s 7307 
30139.8s 7308 Simulation finished at t = 2610.0000 s after 12286 steps.
30139.8s 7309 Total runtime: 0.64 seconds.
30139.8s 7310 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.55s/s]
30139.8s 7311 [REWARD_MICROSCOPE] step=14094 t=2610.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30139.8s 7312 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30139.8s 7313 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30139.8s 7314 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30139.8s 7315 Running simulation until t = 2625.00 s, outputting every 15.00 s
30139.8s 7316 
30139.9s 7317 [PROGRESS] Step 12300: t=2612.97/2625.00s (99.5%) | dt=0.2118s
30140.4s 7318 [PROGRESS] Step 12350: t=2623.56/2625.00s (99.9%) | dt=0.2118s
30140.4s 7319 [WARNING] Automatic CFL correction applied (count: 3316600):
30140.4s 7320 Calculated CFL: 0.800 > Limit: 0.500
30140.4s 7321 Original dt: 3.388751e-01 s
30140.4s 7322 Corrected dt: 2.117970e-01 s
30140.4s 7323 Correction factor: 1.6x
30140.4s 7324 Max wave speed detected: 23.61 m/s
30140.4s 7325 Stored output at t = 2625.0000 s (Step 12357)
30140.4s 7326 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2610.0/2625.0 [00:00<?, ?s/s][A
30140.4s 7327 [A
30140.4s 7328 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.26s/s]
30140.4s 7329 
30140.4s 7330 Simulation finished at t = 2625.0000 s after 12357 steps.
30140.4s 7331 Total runtime: 0.62 seconds.
30140.4s 7332 [REWARD_MICROSCOPE] step=14095 t=2625.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30140.4s 7333 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30140.4s 7334 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30140.4s 7335 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30140.4s 7336 Running simulation until t = 2640.00 s, outputting every 15.00 s
30140.4s 7337 
30140.8s 7338 [PROGRESS] Step 12400: t=2634.11/2640.00s (99.8%) | dt=0.2118s
30140.8s 7339 [PERIODIC:1000] BC_DISPATCHER [Call #13267000] current_bc_params: <class 'dict'>
30140.8s 7340 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30140.8s 7341 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30140.8s 7342 [PERIODIC:1000] BC_GPU [Call #13267000] About to launch kernel
30140.8s 7343 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30140.8s 7344 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30140.8s 7345 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30141.1s 7346 Stored output at t = 2640.0000 s (Step 12428)
30141.1s 7347 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2625.0/2640.0 [00:00<?, ?s/s][A
30141.1s 7348 [A
30141.1s 7349 
30141.1s 7350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.10s/s]
30141.1s 7351 Simulation finished at t = 2640.0000 s after 12428 steps.
30141.1s 7352 Total runtime: 0.65 seconds.
30141.1s 7353 [REWARD_MICROSCOPE] step=14096 t=2640.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30141.1s 7354 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30141.1s 7355 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30141.1s 7356 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30141.1s 7357 Running simulation until t = 2655.00 s, outputting every 15.00 s
30141.1s 7358 
30141.3s 7359 [PROGRESS] Step 12450: t=2644.66/2655.00s (99.6%) | dt=0.2118s
30141.3s 7360 [WARNING] Automatic CFL correction applied (count: 3316700):
30141.3s 7361 Calculated CFL: 0.800 > Limit: 0.500
30141.3s 7362 Original dt: 3.388750e-01 s
30141.3s 7363 Corrected dt: 2.117969e-01 s
30141.3s 7364 Correction factor: 1.6x
30141.3s 7365 Max wave speed detected: 23.61 m/s
30141.7s 7366 Stored output at t = 2655.0000 s (Step 12499)
30141.7s 7367 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2640.0/2655.0 [00:00<?, ?s/s][A
30141.7s 7368 [A
30141.7s 7369 
30141.7s 7370 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.85s/s]
30141.7s 7371 Simulation finished at t = 2655.0000 s after 12499 steps.
30141.7s 7372 Total runtime: 0.63 seconds.
30141.7s 7373 [REWARD_MICROSCOPE] step=14097 t=2655.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30141.7s 7374 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30141.7s 7375 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30141.7s 7376 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30141.7s 7377 Running simulation until t = 2670.00 s, outputting every 15.00 s
30141.7s 7378 
30141.7s 7379 [PROGRESS] Step 12500: t=2655.21/2670.00s (99.4%) | dt=0.2118s
30142.2s 7380 [PROGRESS] Step 12550: t=2665.80/2670.00s (99.8%) | dt=0.2118s
30142.2s 7381 [WARNING] Automatic CFL correction applied (count: 3316800):
30142.2s 7382 Calculated CFL: 0.800 > Limit: 0.500
30142.2s 7383 Original dt: 3.388751e-01 s
30142.2s 7384 Corrected dt: 2.117970e-01 s
30142.2s 7385 Correction factor: 1.6x
30142.2s 7386 Max wave speed detected: 23.61 m/s
30142.3s 7387 Stored output at t = 2670.0000 s (Step 12570)
30142.3s 7388 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2655.0/2670.0 [00:00<?, ?s/s][A
30142.3s 7389 [A
30142.3s 7390 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.19s/s]
30142.3s 7391 
30142.3s 7392 Simulation finished at t = 2670.0000 s after 12570 steps.
30142.3s 7393 Total runtime: 0.62 seconds.
30142.3s 7394 [REWARD_MICROSCOPE] step=14098 t=2670.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30142.3s 7395 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30142.3s 7396 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30142.3s 7397 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30142.3s 7398 Running simulation until t = 2685.00 s, outputting every 15.00 s
30142.3s 7399 
30142.6s 7400 [PROGRESS] Step 12600: t=2676.35/2685.00s (99.7%) | dt=0.2118s
30143.0s 7401 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2670.0/2685.0 [00:00<?, ?s/s][A
30143.0s 7402 [A
30143.0s 7403 Stored output at t = 2685.0000 s (Step 12641)
30143.0s 7404 
30143.0s 7405 Simulation finished at t = 2685.0000 s after 12641 steps.
30143.0s 7406 Total runtime: 0.68 seconds.
30143.0s 7407 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 21.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 21.93s/s]
30143.0s 7408 [REWARD_MICROSCOPE] step=14099 t=2685.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30143.0s 7409 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30143.0s 7410 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30143.0s 7411 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30143.0s 7412 Running simulation until t = 2700.00 s, outputting every 15.00 s
30143.0s 7413 
30143.1s 7414 [PROGRESS] Step 12650: t=2686.92/2700.00s (99.5%) | dt=0.2129s
30143.1s 7415 [PERIODIC:1000] BC_DISPATCHER [Call #13268000] current_bc_params: <class 'dict'>
30143.1s 7416 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30143.1s 7417 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30143.1s 7418 [PERIODIC:1000] BC_GPU [Call #13268000] About to launch kernel
30143.1s 7419 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30143.1s 7420 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30143.1s 7421 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30143.2s 7422 [WARNING] Automatic CFL correction applied (count: 3316900):
30143.2s 7423 Calculated CFL: 0.800 > Limit: 0.500
30143.2s 7424 Original dt: 3.407397e-01 s
30143.2s 7425 Corrected dt: 2.129623e-01 s
30143.2s 7426 Correction factor: 1.6x
30143.2s 7427 Max wave speed detected: 23.48 m/s
30143.5s 7428 [PROGRESS] Step 12700: t=2697.57/2700.00s (99.9%) | dt=0.2130s
30143.7s 7429 Stored output at t = 2700.0000 s (Step 12712)
30143.7s 7430 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2685.0/2700.0 [00:00<?, ?s/s][A
30143.7s 7431 [A
30143.7s 7432 
30143.7s 7433 Simulation finished at t = 2700.0000 s after 12712 steps.
30143.7s 7434 Total runtime: 0.64 seconds.
30143.7s 7435 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 23.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 23.57s/s]
30143.7s 7436 [REWARD_MICROSCOPE] step=14100 t=2700.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30143.7s 7437 [STEP  180] t= 2700.0s | phase=0 | reward=   0.01 | total_reward=    1.62
30143.7s 7438 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30143.7s 7439 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30143.7s 7440 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30143.7s 7441 Running simulation until t = 2715.00 s, outputting every 15.00 s
30143.7s 7442 
30144.0s 7443 [PROGRESS] Step 12750: t=2708.07/2715.00s (99.7%) | dt=0.2125s
30144.1s 7444 [WARNING] Automatic CFL correction applied (count: 3317000):
30144.1s 7445 Calculated CFL: 0.800 > Limit: 0.500
30144.1s 7446 Original dt: 3.401755e-01 s
30144.1s 7447 Corrected dt: 2.126097e-01 s
30144.1s 7448 Correction factor: 1.6x
30144.1s 7449 Max wave speed detected: 23.52 m/s
30144.3s 7450 Stored output at t = 2715.0000 s (Step 12783)
30144.3s 7451 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2700.0/2715.0 [00:00<?, ?s/s][A
30144.3s 7452 [A
30144.3s 7453 
30144.3s 7454 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 23.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 23.59s/s]
30144.3s 7455 Simulation finished at t = 2715.0000 s after 12783 steps.
30144.3s 7456 Total runtime: 0.64 seconds.
30144.3s 7457 [QUEUE_DIAGNOSTIC] ===== Step 180 t=2715.0s =====
30144.3s 7458 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30144.3s 7459 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30144.3s 7460 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30144.3s 7461 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30144.3s 7462 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30144.3s 7463 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30144.3s 7464 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.00509971 0.00502811 0.00499133]
30144.3s 7465 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30144.3s 7466 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30144.3s 7467 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30144.3s 7468 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30144.3s 7469 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30144.3s 7470 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30144.3s 7471 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30144.3s 7472 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30144.3s 7473 [REWARD_MICROSCOPE] step=14101 t=2715.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30144.3s 7474 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30144.3s 7475 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30144.3s 7476 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30144.3s 7477 Running simulation until t = 2730.00 s, outputting every 15.00 s
30144.3s 7478 
30144.5s 7479 [PROGRESS] Step 12800: t=2718.62/2730.00s (99.6%) | dt=0.2130s
30144.9s 7480 [PROGRESS] Step 12850: t=2729.27/2730.00s (100.0%) | dt=0.2127s
30144.9s 7481 Stored output at t = 2730.0000 s (Step 12854)
30144.9s 7482 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2715.0/2730.0 [00:00<?, ?s/s][A
30144.9s 7483 [A
30144.9s 7484 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.87s/s]
30144.9s 7485 
30144.9s 7486 Simulation finished at t = 2730.0000 s after 12854 steps.
30144.9s 7487 Total runtime: 0.63 seconds.
30144.9s 7488 [REWARD_MICROSCOPE] step=14102 t=2730.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30144.9s 7489 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30144.9s 7490 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30144.9s 7491 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30144.9s 7492 Running simulation until t = 2745.00 s, outputting every 15.00 s
30144.9s 7493 
30145.0s 7494 [WARNING] Automatic CFL correction applied (count: 3317100):
30145.0s 7495 Calculated CFL: 0.800 > Limit: 0.500
30145.0s 7496 Original dt: 3.399530e-01 s
30145.0s 7497 Corrected dt: 2.124706e-01 s
30145.0s 7498 Correction factor: 1.6x
30145.0s 7499 Max wave speed detected: 23.53 m/s
30145.3s 7500 [PROGRESS] Step 12900: t=2739.77/2745.00s (99.8%) | dt=0.2126s
30145.4s 7501 [PERIODIC:1000] BC_DISPATCHER [Call #13269000] current_bc_params: <class 'dict'>
30145.4s 7502 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30145.4s 7503 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30145.4s 7504 [PERIODIC:1000] BC_GPU [Call #13269000] About to launch kernel
30145.4s 7505 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30145.4s 7506 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30145.4s 7507 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30145.6s 7508 Stored output at t = 2745.0000 s (Step 12925)
30145.6s 7509 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2730.0/2745.0 [00:00<?, ?s/s][A
30145.6s 7510 [A
30145.6s 7511 
30145.6s 7512 Simulation finished at t = 2745.0000 s after 12925 steps.
30145.6s 7513 Total runtime: 0.62 seconds.
30145.6s 7514 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 24.06s/s]
30145.6s 7515 [REWARD_MICROSCOPE] step=14103 t=2745.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30145.6s 7516 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30145.6s 7517 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30145.6s 7518 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30145.6s 7519 Running simulation until t = 2760.00 s, outputting every 15.00 s
30145.6s 7520 
30145.8s 7521 [PROGRESS] Step 12950: t=2750.32/2760.00s (99.6%) | dt=0.2130s
30145.8s 7522 [WARNING] Automatic CFL correction applied (count: 3317200):
30145.8s 7523 Calculated CFL: 0.800 > Limit: 0.500
30145.8s 7524 Original dt: 3.409728e-01 s
30145.8s 7525 Corrected dt: 2.131080e-01 s
30145.8s 7526 Correction factor: 1.6x
30145.8s 7527 Max wave speed detected: 23.46 m/s
30146.2s 7528 Stored output at t = 2760.0000 s (Step 12996)
30146.2s 7529 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2745.0/2760.0 [00:00<?, ?s/s][A
30146.2s 7530 [A
30146.2s 7531 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.39s/s]
30146.2s 7532 
30146.2s 7533 Simulation finished at t = 2760.0000 s after 12996 steps.
30146.2s 7534 Total runtime: 0.62 seconds.
30146.2s 7535 [REWARD_MICROSCOPE] step=14104 t=2760.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30146.2s 7536 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30146.2s 7537 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30146.2s 7538 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30146.2s 7539 Running simulation until t = 2775.00 s, outputting every 15.00 s
30146.2s 7540 
30146.2s 7541 [PROGRESS] Step 13000: t=2760.85/2775.00s (99.5%) | dt=0.2124s
30146.6s 7542 [PROGRESS] Step 13050: t=2771.47/2775.00s (99.9%) | dt=0.2127s
30146.7s 7543 [WARNING] Automatic CFL correction applied (count: 3317300):
30146.7s 7544 Calculated CFL: 0.800 > Limit: 0.500
30146.7s 7545 Original dt: 3.403992e-01 s
30146.7s 7546 Corrected dt: 2.127495e-01 s
30146.7s 7547 Correction factor: 1.6x
30146.7s 7548 Max wave speed detected: 23.50 m/s
30146.8s 7549 Stored output at t = 2775.0000 s (Step 13067)
30146.8s 7550 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2760.0/2775.0 [00:00<?, ?s/s][A
30146.8s 7551 [A
30146.8s 7552 
30146.8s 7553 Simulation finished at t = 2775.0000 s after 13067 steps.
30146.8s 7554 Total runtime: 0.62 seconds.
30146.8s 7555 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.09s/s]
30146.8s 7556 [REWARD_MICROSCOPE] step=14105 t=2775.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30146.8s 7557 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30146.8s 7558 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30146.8s 7559 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30146.8s 7560 Running simulation until t = 2790.00 s, outputting every 15.00 s
30146.8s 7561 
30147.1s 7562 [PROGRESS] Step 13100: t=2782.03/2790.00s (99.7%) | dt=0.2131s
30147.4s 7563 Stored output at t = 2790.0000 s (Step 13138)
30147.4s 7564 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2775.0/2790.0 [00:00<?, ?s/s][A
30147.4s 7565 [A
30147.4s 7566 
30147.4s 7567 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 23.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 23.80s/s]
30147.4s 7568 Simulation finished at t = 2790.0000 s after 13138 steps.
30147.4s 7569 Total runtime: 0.63 seconds.
30147.4s 7570 [REWARD_MICROSCOPE] step=14106 t=2790.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30147.4s 7571 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30147.4s 7572 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30147.4s 7573 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30147.4s 7574 Running simulation until t = 2805.00 s, outputting every 15.00 s
30147.4s 7575 
30147.5s 7576 [PROGRESS] Step 13150: t=2792.55/2805.00s (99.6%) | dt=0.2123s
30147.6s 7577 [PERIODIC:1000] BC_DISPATCHER [Call #13270000] current_bc_params: <class 'dict'>
30147.6s 7578 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30147.6s 7579 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30147.6s 7580 [PERIODIC:1000] BC_GPU [Call #13270000] About to launch kernel
30147.6s 7581 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30147.6s 7582 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30147.6s 7583 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30147.6s 7584 [WARNING] Automatic CFL correction applied (count: 3317400):
30147.6s 7585 Calculated CFL: 0.800 > Limit: 0.500
30147.6s 7586 Original dt: 3.397973e-01 s
30147.6s 7587 Corrected dt: 2.123733e-01 s
30147.6s 7588 Correction factor: 1.6x
30147.6s 7589 Max wave speed detected: 23.54 m/s
30148.0s 7590 [PROGRESS] Step 13200: t=2803.18/2805.00s (99.9%) | dt=0.2128s
30148.1s 7591 Stored output at t = 2805.0000 s (Step 13209)
30148.1s 7592 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2790.0/2805.0 [00:00<?, ?s/s][A
30148.1s 7593 [A
30148.1s 7594 
30148.1s 7595 Simulation finished at t = 2805.0000 s after 13209 steps.
30148.1s 7596 Total runtime: 0.62 seconds.
30148.1s 7597 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 24.32s/s]
30148.1s 7598 [REWARD_MICROSCOPE] step=14107 t=2805.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30148.1s 7599 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30148.1s 7600 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30148.1s 7601 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30148.1s 7602 Running simulation until t = 2820.00 s, outputting every 15.00 s
30148.1s 7603 
30148.4s 7604 [PROGRESS] Step 13250: t=2813.73/2820.00s (99.8%) | dt=0.2132s
30148.5s 7605 [WARNING] Automatic CFL correction applied (count: 3317500):
30148.5s 7606 Calculated CFL: 0.800 > Limit: 0.500
30148.5s 7607 Original dt: 3.411876e-01 s
30148.5s 7608 Corrected dt: 2.132423e-01 s
30148.5s 7609 Correction factor: 1.6x
30148.5s 7610 Max wave speed detected: 23.45 m/s
30148.7s 7611 Stored output at t = 2820.0000 s (Step 13280)
30148.7s 7612 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2805.0/2820.0 [00:00<?, ?s/s][A
30148.7s 7613 [A
30148.7s 7614 
30148.7s 7615 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.36s/s]
30148.7s 7616 Simulation finished at t = 2820.0000 s after 13280 steps.
30148.7s 7617 Total runtime: 0.62 seconds.
30148.7s 7618 [REWARD_MICROSCOPE] step=14108 t=2820.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30148.7s 7619 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30148.7s 7620 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30148.7s 7621 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30148.7s 7622 Running simulation until t = 2835.00 s, outputting every 15.00 s
30148.7s 7623 
30148.9s 7624 [PROGRESS] Step 13300: t=2824.25/2835.00s (99.6%) | dt=0.2124s
30149.3s 7625 [PROGRESS] Step 13350: t=2834.88/2835.00s (100.0%) | dt=0.2128s
30149.3s 7626 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2820.0/2835.0 [00:00<?, ?s/s][A
30149.3s 7627 [A
30149.3s 7628 Stored output at t = 2835.0000 s (Step 13351)
30149.3s 7629 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 23.81s/s]
30149.3s 7630 
30149.3s 7631 Simulation finished at t = 2835.0000 s after 13351 steps.
30149.3s 7632 Total runtime: 0.63 seconds.
30149.3s 7633 [REWARD_MICROSCOPE] step=14109 t=2835.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30149.3s 7634 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30149.3s 7635 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30149.3s 7636 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30149.3s 7637 Running simulation until t = 2850.00 s, outputting every 15.00 s
30149.3s 7638 
30149.4s 7639 [WARNING] Automatic CFL correction applied (count: 3317600):
30149.4s 7640 Calculated CFL: 0.800 > Limit: 0.500
30149.4s 7641 Original dt: 3.406104e-01 s
30149.4s 7642 Corrected dt: 2.128815e-01 s
30149.4s 7643 Correction factor: 1.6x
30149.4s 7644 Max wave speed detected: 23.49 m/s
30149.8s 7645 [PROGRESS] Step 13400: t=2845.44/2850.00s (99.8%) | dt=0.2133s
30149.8s 7646 [PERIODIC:1000] BC_DISPATCHER [Call #13271000] current_bc_params: <class 'dict'>
30149.8s 7647 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30149.8s 7648 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30149.8s 7649 [PERIODIC:1000] BC_GPU [Call #13271000] About to launch kernel
30149.8s 7650 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30149.8s 7651 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30149.8s 7652 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30150.0s 7653 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2835.0/2850.0 [00:00<?, ?s/s][A
30150.0s 7654 [A
30150.0s 7655 Stored output at t = 2850.0000 s (Step 13422)
30150.0s 7656 
30150.0s 7657 Simulation finished at t = 2850.0000 s after 13422 steps.
30150.0s 7658 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 22.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 22.31s/s]
30150.0s 7659 Total runtime: 0.67 seconds.
30150.0s 7660 [REWARD_MICROSCOPE] step=14110 t=2850.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30150.0s 7661 [STEP  190] t= 2850.0s | phase=0 | reward=   0.01 | total_reward=    1.72
30150.0s 7662 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30150.0s 7663 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30150.0s 7664 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30150.0s 7665 Running simulation until t = 2865.00 s, outputting every 15.00 s
30150.0s 7666 
30150.2s 7667 [PROGRESS] Step 13450: t=2855.94/2865.00s (99.7%) | dt=0.2120s
30150.3s 7668 [WARNING] Automatic CFL correction applied (count: 3317700):
30150.3s 7669 Calculated CFL: 0.800 > Limit: 0.500
30150.3s 7670 Original dt: 3.391669e-01 s
30150.3s 7671 Corrected dt: 2.119793e-01 s
30150.3s 7672 Correction factor: 1.6x
30150.3s 7673 Max wave speed detected: 23.59 m/s
30150.6s 7674 Stored output at t = 2865.0000 s (Step 13493)
30150.6s 7675 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2850.0/2865.0 [00:00<?, ?s/s][A
30150.6s 7676 [A
30150.6s 7677 
30150.6s 7678 Simulation finished at t = 2865.0000 s after 13493 steps.
30150.6s 7679 Total runtime: 0.62 seconds.
30150.6s 7680 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 24.17s/s]
30150.6s 7681 [QUEUE_DIAGNOSTIC] ===== Step 190 t=2865.0s =====
30150.6s 7682 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30150.6s 7683 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2572341e-05 1.0000000e+00 2.1128832e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30150.6s 7684 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30150.6s 7685 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30150.6s 7686 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30150.6s 7687 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8771703e-05 1.7283031e-05 1.6847269e-05 1.6708020e-05 1.6662907e-05
30150.6s 7688 1.6648646e-05]
30150.6s 7689 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.1693249e-05 2.7002547e-05 2.5156640e-05 2.4347206e-05 2.3983126e-05
30150.6s 7690 2.3819335e-05]
30150.6s 7691 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30150.6s 7692 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30150.6s 7693 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30150.6s 7694 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30150.6s 7695 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30150.6s 7696 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30150.6s 7697 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30150.6s 7698 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30150.6s 7699 [REWARD_MICROSCOPE] step=14111 t=2865.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30150.6s 7700 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30150.6s 7701 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30150.6s 7702 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30150.6s 7703 Running simulation until t = 2880.00 s, outputting every 15.00 s
30150.6s 7704 
30150.7s 7705 [PROGRESS] Step 13500: t=2866.48/2880.00s (99.5%) | dt=0.2118s
30151.1s 7706 [PROGRESS] Step 13550: t=2877.08/2880.00s (99.9%) | dt=0.2119s
30151.2s 7707 [WARNING] Automatic CFL correction applied (count: 3317800):
30151.2s 7708 Calculated CFL: 0.800 > Limit: 0.500
30151.2s 7709 Original dt: 3.390091e-01 s
30151.2s 7710 Corrected dt: 2.118807e-01 s
30151.2s 7711 Correction factor: 1.6x
30151.2s 7712 Max wave speed detected: 23.60 m/s
30151.3s 7713 Stored output at t = 2880.0000 s (Step 13564)
30151.3s 7714 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2865.0/2880.0 [00:00<?, ?s/s][A
30151.3s 7715 [A
30151.3s 7716 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.13s/s]
30151.3s 7717 
30151.3s 7718 Simulation finished at t = 2880.0000 s after 13564 steps.
30151.3s 7719 Total runtime: 0.65 seconds.
30151.3s 7720 [REWARD_MICROSCOPE] step=14112 t=2880.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30151.3s 7721 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30151.3s 7722 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30151.3s 7723 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30151.3s 7724 Running simulation until t = 2895.00 s, outputting every 15.00 s
30151.3s 7725 
30151.6s 7726 [PROGRESS] Step 13600: t=2887.63/2895.00s (99.7%) | dt=0.2119s
30151.9s 7727 Stored output at t = 2895.0000 s (Step 13635)
30151.9s 7728 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2880.0/2895.0 [00:00<?, ?s/s][A
30151.9s 7729 [A
30151.9s 7730 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.56s/s]
30151.9s 7731 
30151.9s 7732 Simulation finished at t = 2895.0000 s after 13635 steps.
30151.9s 7733 Total runtime: 0.67 seconds.
30151.9s 7734 [REWARD_MICROSCOPE] step=14113 t=2895.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30151.9s 7735 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30151.9s 7736 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30151.9s 7737 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30151.9s 7738 Running simulation until t = 2910.00 s, outputting every 15.00 s
30151.9s 7739 
30152.1s 7740 [PROGRESS] Step 13650: t=2898.18/2910.00s (99.6%) | dt=0.2120s
30152.1s 7741 [PERIODIC:1000] BC_DISPATCHER [Call #13272000] current_bc_params: <class 'dict'>
30152.1s 7742 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30152.1s 7743 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30152.1s 7744 [PERIODIC:1000] BC_GPU [Call #13272000] About to launch kernel
30152.1s 7745 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30152.1s 7746 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30152.1s 7747 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30152.1s 7748 [WARNING] Automatic CFL correction applied (count: 3317900):
30152.1s 7749 Calculated CFL: 0.800 > Limit: 0.500
30152.1s 7750 Original dt: 3.392824e-01 s
30152.1s 7751 Corrected dt: 2.120515e-01 s
30152.1s 7752 Correction factor: 1.6x
30152.1s 7753 Max wave speed detected: 23.58 m/s
30152.5s 7754 [PROGRESS] Step 13700: t=2908.79/2910.00s (100.0%) | dt=0.2129s
30152.5s 7755 Stored output at t = 2910.0000 s (Step 13706)
30152.5s 7756 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2895.0/2910.0 [00:00<?, ?s/s][A
30152.5s 7757 [A
30152.5s 7758 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.40s/s]
30152.5s 7759 
30152.5s 7760 Simulation finished at t = 2910.0000 s after 13706 steps.
30152.5s 7761 Total runtime: 0.62 seconds.
30152.6s 7762 [REWARD_MICROSCOPE] step=14114 t=2910.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30152.6s 7763 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30152.6s 7764 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30152.6s 7765 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30152.6s 7766 Running simulation until t = 2925.00 s, outputting every 15.00 s
30152.6s 7767 
30152.9s 7768 [PROGRESS] Step 13750: t=2919.46/2925.00s (99.8%) | dt=0.2167s
30153.0s 7769 [WARNING] Automatic CFL correction applied (count: 3318000):
30153.0s 7770 Calculated CFL: 0.800 > Limit: 0.500
30153.0s 7771 Original dt: 3.475264e-01 s
30153.0s 7772 Corrected dt: 2.172040e-01 s
30153.0s 7773 Correction factor: 1.6x
30153.0s 7774 Max wave speed detected: 23.02 m/s
30153.2s 7775 Stored output at t = 2925.0000 s (Step 13776)
30153.2s 7776 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2910.0/2925.0 [00:00<?, ?s/s][A
30153.2s 7777 [A
30153.2s 7778 
30153.2s 7779 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 24.47s/s]
30153.2s 7780 Simulation finished at t = 2925.0000 s after 13776 steps.
30153.2s 7781 Total runtime: 0.61 seconds.
30153.2s 7782 [REWARD_MICROSCOPE] step=14115 t=2925.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30153.2s 7783 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30153.2s 7784 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30153.2s 7785 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30153.2s 7786 Running simulation until t = 2940.00 s, outputting every 15.00 s
30153.2s 7787 
30153.4s 7788 [PROGRESS] Step 13800: t=2930.25/2940.00s (99.7%) | dt=0.2188s
30153.8s 7789 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2925.0/2940.0 [00:00<?, ?s/s][A
30153.8s 7790 [A
30153.8s 7791 Stored output at t = 2940.0000 s (Step 13845)
30153.8s 7792 
30153.8s 7793 Simulation finished at t = 2940.0000 s after 13845 steps.
30153.8s 7794 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 25.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 25.19s/s]
30153.8s 7795 Total runtime: 0.60 seconds.
30153.8s 7796 [REWARD_MICROSCOPE] step=14116 t=2940.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30153.8s 7797 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30153.8s 7798 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30153.8s 7799 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30153.8s 7800 Running simulation until t = 2955.00 s, outputting every 15.00 s
30153.8s 7801 
30153.8s 7802 [PROGRESS] Step 13850: t=2941.10/2955.00s (99.5%) | dt=0.2193s
30153.9s 7803 [WARNING] Automatic CFL correction applied (count: 3318100):
30153.9s 7804 Calculated CFL: 0.800 > Limit: 0.500
30153.9s 7805 Original dt: 3.509631e-01 s
30153.9s 7806 Corrected dt: 2.193519e-01 s
30153.9s 7807 Correction factor: 1.6x
30153.9s 7808 Max wave speed detected: 22.79 m/s
30154.3s 7809 [PROGRESS] Step 13900: t=2951.90/2955.00s (99.9%) | dt=0.2132s
30154.3s 7810 [PERIODIC:1000] BC_DISPATCHER [Call #13273000] current_bc_params: <class 'dict'>
30154.3s 7811 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30154.3s 7812 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30154.3s 7813 [PERIODIC:1000] BC_GPU [Call #13273000] About to launch kernel
30154.3s 7814 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30154.3s 7815 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30154.3s 7816 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30154.4s 7817 Stored output at t = 2955.0000 s (Step 13915)
30154.4s 7818 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2940.0/2955.0 [00:00<?, ?s/s][A
30154.4s 7819 [A
30154.4s 7820 
30154.4s 7821 Simulation finished at t = 2955.0000 s after 13915 steps.
30154.4s 7822 Total runtime: 0.63 seconds.
30154.4s 7823 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.73s/s]
30154.4s 7824 [REWARD_MICROSCOPE] step=14117 t=2955.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30154.4s 7825 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30154.4s 7826 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30154.4s 7827 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30154.4s 7828 Running simulation until t = 2970.00 s, outputting every 15.00 s
30154.4s 7829 
30154.7s 7830 [PROGRESS] Step 13950: t=2962.44/2970.00s (99.7%) | dt=0.2126s
30154.8s 7831 [WARNING] Automatic CFL correction applied (count: 3318200):
30154.8s 7832 Calculated CFL: 0.800 > Limit: 0.500
30154.8s 7833 Original dt: 3.401845e-01 s
30154.8s 7834 Corrected dt: 2.126153e-01 s
30154.8s 7835 Correction factor: 1.6x
30154.8s 7836 Max wave speed detected: 23.52 m/s
30155.0s 7837 Stored output at t = 2970.0000 s (Step 13986)
30155.0s 7838 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2955.0/2970.0 [00:00<?, ?s/s][A
30155.0s 7839 [A
30155.0s 7840 
30155.0s 7841 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 24.21s/s]
30155.0s 7842 Simulation finished at t = 2970.0000 s after 13986 steps.
30155.0s 7843 Total runtime: 0.62 seconds.
30155.0s 7844 [REWARD_MICROSCOPE] step=14118 t=2970.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30155.0s 7845 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30155.0s 7846 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30155.0s 7847 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30155.0s 7848 Running simulation until t = 2985.00 s, outputting every 15.00 s
30155.0s 7849 
30155.1s 7850 [PROGRESS] Step 14000: t=2972.98/2985.00s (99.6%) | dt=0.2130s
30155.6s 7851 [PROGRESS] Step 14050: t=2983.64/2985.00s (100.0%) | dt=0.2128s
30155.6s 7852 [WARNING] Automatic CFL correction applied (count: 3318300):
30155.6s 7853 Calculated CFL: 0.800 > Limit: 0.500
30155.6s 7854 Original dt: 3.400618e-01 s
30155.6s 7855 Corrected dt: 2.125387e-01 s
30155.6s 7856 Correction factor: 1.6x
30155.6s 7857 Max wave speed detected: 23.53 m/s
30155.6s 7858 Stored output at t = 2985.0000 s (Step 14057)
30155.6s 7859 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2970.0/2985.0 [00:00<?, ?s/s][A
30155.6s 7860 [A
30155.6s 7861 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.57s/s]
30155.6s 7862 
30155.6s 7863 Simulation finished at t = 2985.0000 s after 14057 steps.
30155.6s 7864 Total runtime: 0.61 seconds.
30155.6s 7865 [REWARD_MICROSCOPE] step=14119 t=2985.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30155.6s 7866 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30155.6s 7867 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30155.6s 7868 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30155.6s 7869 Running simulation until t = 3000.00 s, outputting every 15.00 s
30155.6s 7870 
30156.0s 7871 [PROGRESS] Step 14100: t=2994.13/3000.00s (99.8%) | dt=0.2126s
30156.3s 7872 Stored output at t = 3000.0000 s (Step 14128)
30156.3s 7873 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2985.0/3000.0 [00:00<?, ?s/s][A
30156.3s 7874 [A
30156.3s 7875 
30156.3s 7876 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 22.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 22.96s/s]
30156.3s 7877 Simulation finished at t = 3000.0000 s after 14128 steps.
30156.3s 7878 Total runtime: 0.65 seconds.
30156.3s 7879 [REWARD_MICROSCOPE] step=14120 t=3000.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30156.3s 7880 [STEP  200] t= 3000.0s | phase=1 | reward=   0.01 | total_reward=    1.85
30156.3s 7881 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30156.3s 7882 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30156.3s 7883 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30156.3s 7884 Running simulation until t = 3015.00 s, outputting every 15.00 s
30156.3s 7885 
30156.5s 7886 [PROGRESS] Step 14150: t=3004.68/3015.00s (99.7%) | dt=0.2130s
30156.5s 7887 [PERIODIC:1000] BC_DISPATCHER [Call #13274000] current_bc_params: <class 'dict'>
30156.5s 7888 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30156.5s 7889 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30156.5s 7890 [PERIODIC:1000] BC_GPU [Call #13274000] About to launch kernel
30156.5s 7891 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30156.5s 7892 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30156.5s 7893 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30156.5s 7894 [WARNING] Automatic CFL correction applied (count: 3318400):
30156.5s 7895 Calculated CFL: 0.800 > Limit: 0.500
30156.5s 7896 Original dt: 3.409300e-01 s
30156.5s 7897 Corrected dt: 2.130812e-01 s
30156.5s 7898 Correction factor: 1.6x
30156.5s 7899 Max wave speed detected: 23.47 m/s
30156.9s 7900 Stored output at t = 3015.0000 s (Step 14199)
30156.9s 7901 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3000.0/3015.0 [00:00<?, ?s/s][A
30156.9s 7902 [A
30156.9s 7903 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.14s/s]
30156.9s 7904 
30156.9s 7905 Simulation finished at t = 3015.0000 s after 14199 steps.
30156.9s 7906 Total runtime: 0.62 seconds.
30156.9s 7907 [QUEUE_DIAGNOSTIC] ===== Step 200 t=3015.0s =====
30156.9s 7908 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30156.9s 7909 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.240832e-05 1.000000e+00 2.051389e-04 1.000000e+00] (rho_m, v_m, rho_c, v_c)
30156.9s 7910 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30156.9s 7911 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30156.9s 7912 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30156.9s 7913 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842583e-05 1.6724875e-05 1.6694938e-05
30156.9s 7914 1.6692444e-05]
30156.9s 7915 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770836e-05 2.6356691e-05 2.4789349e-05 2.4169871e-05 2.3902563e-05
30156.9s 7916 2.3782073e-05]
30156.9s 7917 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30156.9s 7918 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30156.9s 7919 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30156.9s 7920 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30156.9s 7921 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30156.9s 7922 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30156.9s 7923 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30156.9s 7924 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30156.9s 7925 [REWARD_MICROSCOPE] step=14121 t=3015.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30156.9s 7926 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30156.9s 7927 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30156.9s 7928 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30156.9s 7929 Running simulation until t = 3030.00 s, outputting every 15.00 s
30156.9s 7930 
30156.9s 7931 [PROGRESS] Step 14200: t=3015.21/3030.00s (99.5%) | dt=0.2125s
30157.4s 7932 [PROGRESS] Step 14250: t=3025.84/3030.00s (99.9%) | dt=0.2127s
30157.4s 7933 [WARNING] Automatic CFL correction applied (count: 3318500):
30157.4s 7934 Calculated CFL: 0.800 > Limit: 0.500
30157.4s 7935 Original dt: 3.403531e-01 s
30157.4s 7936 Corrected dt: 2.127207e-01 s
30157.4s 7937 Correction factor: 1.6x
30157.4s 7938 Max wave speed detected: 23.51 m/s
30157.5s 7939 Stored output at t = 3030.0000 s (Step 14270)
30157.5s 7940 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3015.0/3030.0 [00:00<?, ?s/s][A
30157.5s 7941 [A
30157.5s 7942 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.23s/s]
30157.5s 7943 
30157.5s 7944 Simulation finished at t = 3030.0000 s after 14270 steps.
30157.5s 7945 Total runtime: 0.62 seconds.
30157.5s 7946 [REWARD_MICROSCOPE] step=14122 t=3030.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30157.5s 7947 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30157.5s 7948 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30157.5s 7949 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30157.5s 7950 Running simulation until t = 3045.00 s, outputting every 15.00 s
30157.5s 7951 
30157.8s 7952 [PROGRESS] Step 14300: t=3036.39/3045.00s (99.7%) | dt=0.2131s
30158.2s 7953 Stored output at t = 3045.0000 s (Step 14341)
30158.2s 7954 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3030.0/3045.0 [00:00<?, ?s/s][A
30158.2s 7955 [A
30158.2s 7956 
30158.2s 7957 Simulation finished at t = 3045.0000 s after 14341 steps.
30158.2s 7958 Total runtime: 0.62 seconds.
30158.2s 7959 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.24s/s]
30158.2s 7960 [REWARD_MICROSCOPE] step=14123 t=3045.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30158.2s 7961 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30158.2s 7962 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30158.2s 7963 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30158.2s 7964 Running simulation until t = 3060.00 s, outputting every 15.00 s
30158.2s 7965 
30158.2s 7966 [PROGRESS] Step 14350: t=3046.91/3060.00s (99.6%) | dt=0.2123s
30158.3s 7967 [WARNING] Automatic CFL correction applied (count: 3318600):
30158.3s 7968 Calculated CFL: 0.800 > Limit: 0.500
30158.3s 7969 Original dt: 3.397591e-01 s
30158.3s 7970 Corrected dt: 2.123495e-01 s
30158.3s 7971 Correction factor: 1.6x
30158.3s 7972 Max wave speed detected: 23.55 m/s
30158.7s 7973 [PROGRESS] Step 14400: t=3057.54/3060.00s (99.9%) | dt=0.2127s
30158.7s 7974 [PERIODIC:1000] BC_DISPATCHER [Call #13275000] current_bc_params: <class 'dict'>
30158.7s 7975 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30158.7s 7976 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30158.7s 7977 [PERIODIC:1000] BC_GPU [Call #13275000] About to launch kernel
30158.7s 7978 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30158.7s 7979 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30158.7s 7980 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30158.8s 7981 Stored output at t = 3060.0000 s (Step 14412)
30158.8s 7982 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3045.0/3060.0 [00:00<?, ?s/s][A
30158.8s 7983 [A
30158.8s 7984 
30158.8s 7985 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 23.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 23.81s/s]
30158.8s 7986 Simulation finished at t = 3060.0000 s after 14412 steps.
30158.8s 7987 Total runtime: 0.63 seconds.
30158.8s 7988 [REWARD_MICROSCOPE] step=14124 t=3060.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30158.8s 7989 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30158.8s 7990 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30158.8s 7991 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30158.8s 7992 Running simulation until t = 3075.00 s, outputting every 15.00 s
30158.8s 7993 
30159.1s 7994 [PROGRESS] Step 14450: t=3068.09/3075.00s (99.8%) | dt=0.2132s
30159.2s 7995 [WARNING] Automatic CFL correction applied (count: 3318700):
30159.2s 7996 Calculated CFL: 0.800 > Limit: 0.500
30159.2s 7997 Original dt: 3.411502e-01 s
30159.2s 7998 Corrected dt: 2.132189e-01 s
30159.2s 7999 Correction factor: 1.6x
30159.2s 8000 Max wave speed detected: 23.45 m/s
30159.4s 8001 Stored output at t = 3075.0000 s (Step 14483)
30159.4s 8002 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3060.0/3075.0 [00:00<?, ?s/s][A
30159.4s 8003 [A
30159.4s 8004 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.49s/s]
30159.4s 8005 
30159.4s 8006 Simulation finished at t = 3075.0000 s after 14483 steps.
30159.4s 8007 Total runtime: 0.61 seconds.
30159.4s 8008 [REWARD_MICROSCOPE] step=14125 t=3075.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30159.4s 8009 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30159.4s 8010 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30159.4s 8011 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30159.4s 8012 Running simulation until t = 3090.00 s, outputting every 15.00 s
30159.4s 8013 
30159.6s 8014 [PROGRESS] Step 14500: t=3078.61/3090.00s (99.6%) | dt=0.2124s
30160.0s 8015 [PROGRESS] Step 14550: t=3089.24/3090.00s (100.0%) | dt=0.2128s
30160.0s 8016 Stored output at t = 3090.0000 s (Step 14554)
30160.0s 8017 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3075.0/3090.0 [00:00<?, ?s/s][A
30160.0s 8018 [A
30160.0s 8019 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.18s/s]
30160.0s 8020 
30160.0s 8021 Simulation finished at t = 3090.0000 s after 14554 steps.
30160.0s 8022 Total runtime: 0.62 seconds.
30160.0s 8023 [REWARD_MICROSCOPE] step=14126 t=3090.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30160.0s 8024 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30160.0s 8025 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30160.0s 8026 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30160.0s 8027 Running simulation until t = 3105.00 s, outputting every 15.00 s
30160.0s 8028 
30160.1s 8029 [WARNING] Automatic CFL correction applied (count: 3318800):
30160.1s 8030 Calculated CFL: 0.800 > Limit: 0.500
30160.1s 8031 Original dt: 3.405715e-01 s
30160.1s 8032 Corrected dt: 2.128572e-01 s
30160.1s 8033 Correction factor: 1.6x
30160.1s 8034 Max wave speed detected: 23.49 m/s
30160.4s 8035 [PROGRESS] Step 14600: t=3099.80/3105.00s (99.8%) | dt=0.2132s
30160.7s 8036 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3090.0/3105.0 [00:00<?, ?s/s][A
30160.7s 8037 [A
30160.7s 8038 Stored output at t = 3105.0000 s (Step 14625)
30160.7s 8039 
30160.7s 8040 Simulation finished at t = 3105.0000 s after 14625 steps.
30160.7s 8041 Total runtime: 0.62 seconds.
30160.7s 8042 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.35s/s]
30160.7s 8043 [REWARD_MICROSCOPE] step=14127 t=3105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30160.7s 8044 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30160.7s 8045 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30160.7s 8046 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30160.7s 8047 Running simulation until t = 3120.00 s, outputting every 15.00 s
30160.7s 8048 
30160.9s 8049 [PROGRESS] Step 14650: t=3110.31/3120.00s (99.7%) | dt=0.2124s
30160.9s 8050 [PERIODIC:1000] BC_DISPATCHER [Call #13276000] current_bc_params: <class 'dict'>
30160.9s 8051 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30160.9s 8052 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30160.9s 8053 [PERIODIC:1000] BC_GPU [Call #13276000] About to launch kernel
30160.9s 8054 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30160.9s 8055 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30160.9s 8056 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30161.0s 8057 [WARNING] Automatic CFL correction applied (count: 3318900):
30161.0s 8058 Calculated CFL: 0.800 > Limit: 0.500
30161.0s 8059 Original dt: 3.399886e-01 s
30161.0s 8060 Corrected dt: 2.124929e-01 s
30161.0s 8061 Correction factor: 1.6x
30161.0s 8062 Max wave speed detected: 23.53 m/s
30161.3s 8063 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3105.0/3120.0 [00:00<?, ?s/s][A
30161.3s 8064 [A
30161.3s 8065 Stored output at t = 3120.0000 s (Step 14696)
30161.3s 8066 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 23.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 23.09s/s]
30161.3s 8067 
30161.3s 8068 Simulation finished at t = 3120.0000 s after 14696 steps.
30161.3s 8069 Total runtime: 0.65 seconds.
30161.3s 8070 [REWARD_MICROSCOPE] step=14128 t=3120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30161.3s 8071 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30161.3s 8072 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30161.3s 8073 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30161.3s 8074 Running simulation until t = 3135.00 s, outputting every 15.00 s
30161.3s 8075 
30161.4s 8076 [PROGRESS] Step 14700: t=3120.85/3135.00s (99.5%) | dt=0.2129s
30161.8s 8077 [PROGRESS] Step 14750: t=3131.51/3135.00s (99.9%) | dt=0.2133s
30161.8s 8078 [WARNING] Automatic CFL correction applied (count: 3319000):
30161.8s 8079 Calculated CFL: 0.800 > Limit: 0.500
30161.8s 8080 Original dt: 3.406768e-01 s
30161.8s 8081 Corrected dt: 2.129230e-01 s
30161.8s 8082 Correction factor: 1.6x
30161.8s 8083 Max wave speed detected: 23.48 m/s
30161.9s 8084 Stored output at t = 3135.0000 s (Step 14767)
30161.9s 8085 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3120.0/3135.0 [00:00<?, ?s/s][A
30161.9s 8086 [A
30161.9s 8087 
30161.9s 8088 Simulation finished at t = 3135.0000 s after 14767 steps.
30161.9s 8089 Total runtime: 0.63 seconds.
30161.9s 8090 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.84s/s]
30161.9s 8091 [REWARD_MICROSCOPE] step=14129 t=3135.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30162.0s 8092 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30162.0s 8093 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30162.0s 8094 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30162.0s 8095 Running simulation until t = 3150.00 s, outputting every 15.00 s
30162.0s 8096 
30162.3s 8097 [PROGRESS] Step 14800: t=3142.01/3150.00s (99.7%) | dt=0.2125s
30162.6s 8098 Stored output at t = 3150.0000 s (Step 14838)
30162.6s 8099 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3135.0/3150.0 [00:00<?, ?s/s][A
30162.6s 8100 [A
30162.6s 8101 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 23.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 23.45s/s]
30162.6s 8102 
30162.6s 8103 Simulation finished at t = 3150.0000 s after 14838 steps.
30162.6s 8104 Total runtime: 0.64 seconds.
30162.6s 8105 [REWARD_MICROSCOPE] step=14130 t=3150.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30162.6s 8106 [STEP  210] t= 3150.0s | phase=1 | reward=   0.01 | total_reward=    1.95
30162.6s 8107 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30162.6s 8108 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30162.6s 8109 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30162.6s 8110 Running simulation until t = 3165.00 s, outputting every 15.00 s
30162.6s 8111 
30162.7s 8112 [PROGRESS] Step 14850: t=3152.55/3165.00s (99.6%) | dt=0.2129s
30162.8s 8113 [WARNING] Automatic CFL correction applied (count: 3319100):
30162.8s 8114 Calculated CFL: 0.800 > Limit: 0.500
30162.8s 8115 Original dt: 3.407917e-01 s
30162.8s 8116 Corrected dt: 2.129948e-01 s
30162.8s 8117 Correction factor: 1.6x
30162.8s 8118 Max wave speed detected: 23.47 m/s
30163.1s 8119 [PROGRESS] Step 14900: t=3163.21/3165.00s (99.9%) | dt=0.2129s
30163.2s 8120 [PERIODIC:1000] BC_DISPATCHER [Call #13277000] current_bc_params: <class 'dict'>
30163.2s 8121 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30163.2s 8122 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30163.2s 8123 [PERIODIC:1000] BC_GPU [Call #13277000] About to launch kernel
30163.2s 8124 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30163.2s 8125 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30163.2s 8126 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30163.2s 8127 Stored output at t = 3165.0000 s (Step 14909)
30163.2s 8128 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3150.0/3165.0 [00:00<?, ?s/s][A
30163.2s 8129 [A
30163.2s 8130 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 23.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 23.68s/s]
30163.2s 8131 
30163.2s 8132 Simulation finished at t = 3165.0000 s after 14909 steps.
30163.2s 8133 Total runtime: 0.63 seconds.
30163.2s 8134 [QUEUE_DIAGNOSTIC] ===== Step 210 t=3165.0s =====
30163.2s 8135 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30163.2s 8136 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30163.2s 8137 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30163.2s 8138 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30163.2s 8139 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30163.2s 8140 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30163.2s 8141 1.6692446e-05]
30163.2s 8142 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30163.2s 8143 2.3782164e-05]
30163.2s 8144 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30163.2s 8145 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30163.2s 8146 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30163.2s 8147 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30163.2s 8148 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30163.2s 8149 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30163.2s 8150 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30163.2s 8151 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30163.2s 8152 [REWARD_MICROSCOPE] step=14131 t=3165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30163.2s 8153 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30163.2s 8154 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30163.2s 8155 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30163.2s 8156 Running simulation until t = 3180.00 s, outputting every 15.00 s
30163.2s 8157 
30163.6s 8158 [PROGRESS] Step 14950: t=3173.71/3180.00s (99.8%) | dt=0.2126s
30163.6s 8159 [WARNING] Automatic CFL correction applied (count: 3319200):
30163.6s 8160 Calculated CFL: 0.800 > Limit: 0.500
30163.6s 8161 Original dt: 3.402142e-01 s
30163.6s 8162 Corrected dt: 2.126339e-01 s
30163.6s 8163 Correction factor: 1.6x
30163.6s 8164 Max wave speed detected: 23.51 m/s
30163.8s 8165 Stored output at t = 3180.0000 s (Step 14980)
30163.8s 8166 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3165.0/3180.0 [00:00<?, ?s/s][A
30163.8s 8167 [A
30163.8s 8168 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.42s/s]
30163.8s 8169 
30163.8s 8170 Simulation finished at t = 3180.0000 s after 14980 steps.
30163.8s 8171 Total runtime: 0.61 seconds.
30163.8s 8172 [REWARD_MICROSCOPE] step=14132 t=3180.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30163.9s 8173 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30163.9s 8174 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30163.9s 8175 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30163.9s 8176 Running simulation until t = 3195.00 s, outputting every 15.00 s
30163.9s 8177 
30164.0s 8178 [PROGRESS] Step 15000: t=3184.26/3195.00s (99.7%) | dt=0.2130s
30164.5s 8179 [PROGRESS] Step 15050: t=3194.91/3195.00s (100.0%) | dt=0.2126s
30164.5s 8180 Stored output at t = 3195.0000 s (Step 15051)
30164.5s 8181 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3180.0/3195.0 [00:00<?, ?s/s][A
30164.5s 8182 [A
30164.5s 8183 
30164.5s 8184 Simulation finished at t = 3195.0000 s after 15051 steps.
30164.5s 8185 Total runtime: 0.62 seconds.
30164.5s 8186 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 24.10s/s]
30164.5s 8187 [REWARD_MICROSCOPE] step=14133 t=3195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30164.5s 8188 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30164.5s 8189 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30164.5s 8190 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30164.5s 8191 Running simulation until t = 3210.00 s, outputting every 15.00 s
30164.5s 8192 
30164.5s 8193 [WARNING] Automatic CFL correction applied (count: 3319300):
30164.5s 8194 Calculated CFL: 0.800 > Limit: 0.500
30164.5s 8195 Original dt: 3.398343e-01 s
30164.5s 8196 Corrected dt: 2.123964e-01 s
30164.5s 8197 Correction factor: 1.6x
30164.5s 8198 Max wave speed detected: 23.54 m/s
30164.9s 8199 [PROGRESS] Step 15100: t=3205.41/3210.00s (99.9%) | dt=0.2126s
30165.1s 8200 Stored output at t = 3210.0000 s (Step 15122)
30165.1s 8201 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3195.0/3210.0 [00:00<?, ?s/s][A
30165.1s 8202 [A
30165.1s 8203 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.47s/s]
30165.1s 8204 
30165.1s 8205 Simulation finished at t = 3210.0000 s after 15122 steps.
30165.1s 8206 Total runtime: 0.64 seconds.
30165.1s 8207 [REWARD_MICROSCOPE] step=14134 t=3210.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30165.1s 8208 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30165.1s 8209 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30165.1s 8210 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30165.1s 8211 Running simulation until t = 3225.00 s, outputting every 15.00 s
30165.1s 8212 
30165.4s 8213 [PROGRESS] Step 15150: t=3215.96/3225.00s (99.7%) | dt=0.2131s
30165.4s 8214 [PERIODIC:1000] BC_DISPATCHER [Call #13278000] current_bc_params: <class 'dict'>
30165.4s 8215 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30165.4s 8216 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30165.4s 8217 [PERIODIC:1000] BC_GPU [Call #13278000] About to launch kernel
30165.4s 8218 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30165.4s 8219 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30165.4s 8220 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30165.4s 8221 [WARNING] Automatic CFL correction applied (count: 3319400):
30165.4s 8222 Calculated CFL: 0.800 > Limit: 0.500
30165.4s 8223 Original dt: 3.410106e-01 s
30165.4s 8224 Corrected dt: 2.131316e-01 s
30165.4s 8225 Correction factor: 1.6x
30165.4s 8226 Max wave speed detected: 23.46 m/s
30165.7s 8227 Stored output at t = 3225.0000 s (Step 15193)
30165.7s 8228 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3210.0/3225.0 [00:00<?, ?s/s][A
30165.7s 8229 [A
30165.7s 8230 
30165.7s 8231 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 23.88s/s]
30165.7s 8232 Simulation finished at t = 3225.0000 s after 15193 steps.
30165.7s 8233 Total runtime: 0.63 seconds.
30165.7s 8234 [REWARD_MICROSCOPE] step=14135 t=3225.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30165.8s 8235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30165.8s 8236 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30165.8s 8237 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30165.8s 8238 Running simulation until t = 3240.00 s, outputting every 15.00 s
30165.8s 8239 
30165.8s 8240 [PROGRESS] Step 15200: t=3226.49/3240.00s (99.6%) | dt=0.2124s
30166.2s 8241 [PROGRESS] Step 15250: t=3237.11/3240.00s (99.9%) | dt=0.2127s
30166.3s 8242 [WARNING] Automatic CFL correction applied (count: 3319500):
30166.3s 8243 Calculated CFL: 0.800 > Limit: 0.500
30166.3s 8244 Original dt: 3.404362e-01 s
30166.3s 8245 Corrected dt: 2.127726e-01 s
30166.3s 8246 Correction factor: 1.6x
30166.3s 8247 Max wave speed detected: 23.50 m/s
30166.4s 8248 Stored output at t = 3240.0000 s (Step 15264)
30166.4s 8249 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3225.0/3240.0 [00:00<?, ?s/s][A
30166.4s 8250 [A
30166.4s 8251 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.46s/s]
30166.4s 8252 
30166.4s 8253 Simulation finished at t = 3240.0000 s after 15264 steps.
30166.4s 8254 Total runtime: 0.61 seconds.
30166.4s 8255 [REWARD_MICROSCOPE] step=14136 t=3240.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30166.4s 8256 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30166.4s 8257 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30166.4s 8258 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30166.4s 8259 Running simulation until t = 3255.00 s, outputting every 15.00 s
30166.4s 8260 
30166.7s 8261 [PROGRESS] Step 15300: t=3247.67/3255.00s (99.8%) | dt=0.2131s
30167.0s 8262 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3240.0/3255.0 [00:00<?, ?s/s][A
30167.0s 8263 [A
30167.0s 8264 Stored output at t = 3255.0000 s (Step 15335)
30167.0s 8265 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.49s/s]
30167.0s 8266 
30167.0s 8267 Simulation finished at t = 3255.0000 s after 15335 steps.
30167.0s 8268 Total runtime: 0.61 seconds.
30167.0s 8269 [REWARD_MICROSCOPE] step=14137 t=3255.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30167.0s 8270 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30167.0s 8271 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30167.0s 8272 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30167.0s 8273 Running simulation until t = 3270.00 s, outputting every 15.00 s
30167.0s 8274 
30167.1s 8275 [PROGRESS] Step 15350: t=3258.19/3270.00s (99.6%) | dt=0.2123s
30167.2s 8276 [WARNING] Automatic CFL correction applied (count: 3319600):
30167.2s 8277 Calculated CFL: 0.800 > Limit: 0.500
30167.2s 8278 Original dt: 3.398447e-01 s
30167.2s 8279 Corrected dt: 2.124030e-01 s
30167.2s 8280 Correction factor: 1.6x
30167.2s 8281 Max wave speed detected: 23.54 m/s
30167.5s 8282 [PROGRESS] Step 15400: t=3268.81/3270.00s (100.0%) | dt=0.2128s
30167.6s 8283 [PERIODIC:1000] BC_DISPATCHER [Call #13279000] current_bc_params: <class 'dict'>
30167.6s 8284 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30167.6s 8285 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30167.6s 8286 [PERIODIC:1000] BC_GPU [Call #13279000] About to launch kernel
30167.6s 8287 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30167.6s 8288 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30167.6s 8289 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30167.6s 8290 Stored output at t = 3270.0000 s (Step 15406)
30167.6s 8291 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3255.0/3270.0 [00:00<?, ?s/s][A
30167.6s 8292 [A
30167.6s 8293 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.57s/s]
30167.6s 8294 
30167.6s 8295 Simulation finished at t = 3270.0000 s after 15406 steps.
30167.6s 8296 Total runtime: 0.61 seconds.
30167.6s 8297 [REWARD_MICROSCOPE] step=14138 t=3270.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30167.6s 8298 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30167.6s 8299 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30167.6s 8300 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30167.6s 8301 Running simulation until t = 3285.00 s, outputting every 15.00 s
30167.6s 8302 
30168.0s 8303 [PROGRESS] Step 15450: t=3279.37/3285.00s (99.8%) | dt=0.2132s
30168.0s 8304 [WARNING] Automatic CFL correction applied (count: 3319700):
30168.0s 8305 Calculated CFL: 0.800 > Limit: 0.500
30168.0s 8306 Original dt: 3.412307e-01 s
30168.0s 8307 Corrected dt: 2.132692e-01 s
30168.0s 8308 Correction factor: 1.6x
30168.0s 8309 Max wave speed detected: 23.44 m/s
30168.2s 8310 Stored output at t = 3285.0000 s (Step 15477)
30168.2s 8311 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3270.0/3285.0 [00:00<?, ?s/s][A
30168.2s 8312 [A
30168.2s 8313 
30168.2s 8314 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.52s/s]
30168.2s 8315 Simulation finished at t = 3285.0000 s after 15477 steps.
30168.2s 8316 Total runtime: 0.61 seconds.
30168.2s 8317 [REWARD_MICROSCOPE] step=14139 t=3285.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30168.2s 8318 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30168.2s 8319 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30168.2s 8320 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30168.2s 8321 Running simulation until t = 3300.00 s, outputting every 15.00 s
30168.2s 8322 
30168.4s 8323 [PROGRESS] Step 15500: t=3289.88/3300.00s (99.7%) | dt=0.2124s
30168.8s 8324 Stored output at t = 3300.0000 s (Step 15548)
30168.8s 8325 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3285.0/3300.0 [00:00<?, ?s/s][A
30168.8s 8326 [A
30168.8s 8327 
30168.8s 8328 Simulation finished at t = 3300.0000 s after 15548 steps.
30168.8s 8329 Total runtime: 0.61 seconds.
30168.8s 8330 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.54s/s]
30168.8s 8331 [REWARD_MICROSCOPE] step=14140 t=3300.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30168.8s 8332 [STEP  220] t= 3300.0s | phase=1 | reward=   0.01 | total_reward=    2.05
30168.8s 8333 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30168.8s 8334 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30168.8s 8335 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30168.8s 8336 Running simulation until t = 3315.00 s, outputting every 15.00 s
30168.8s 8337 
30168.9s 8338 [PROGRESS] Step 15550: t=3300.43/3315.00s (99.6%) | dt=0.2128s
30168.9s 8339 [WARNING] Automatic CFL correction applied (count: 3319800):
30168.9s 8340 Calculated CFL: 0.800 > Limit: 0.500
30168.9s 8341 Original dt: 3.406566e-01 s
30168.9s 8342 Corrected dt: 2.129103e-01 s
30168.9s 8343 Correction factor: 1.6x
30168.9s 8344 Max wave speed detected: 23.48 m/s
30169.3s 8345 [PROGRESS] Step 15600: t=3311.08/3315.00s (99.9%) | dt=0.2133s
30169.4s 8346 Stored output at t = 3315.0000 s (Step 15619)
30169.4s 8347 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3300.0/3315.0 [00:00<?, ?s/s][A
30169.4s 8348 [A
30169.4s 8349 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.33s/s]
30169.4s 8350 
30169.4s 8351 Simulation finished at t = 3315.0000 s after 15619 steps.
30169.4s 8352 Total runtime: 0.62 seconds.
30169.5s 8353 [QUEUE_DIAGNOSTIC] ===== Step 220 t=3315.0s =====
30169.5s 8354 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30169.5s 8355 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30169.5s 8356 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30169.5s 8357 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30169.5s 8358 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30169.5s 8359 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30169.5s 8360 1.6692446e-05]
30169.5s 8361 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30169.5s 8362 2.3782164e-05]
30169.5s 8363 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30169.5s 8364 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30169.5s 8365 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30169.5s 8366 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30169.5s 8367 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30169.5s 8368 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30169.5s 8369 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30169.5s 8370 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30169.5s 8371 [REWARD_MICROSCOPE] step=14141 t=3315.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30169.5s 8372 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30169.5s 8373 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30169.5s 8374 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30169.5s 8375 Running simulation until t = 3330.00 s, outputting every 15.00 s
30169.5s 8376 
30169.7s 8377 [PROGRESS] Step 15650: t=3321.58/3330.00s (99.7%) | dt=0.2125s
30169.7s 8378 [PERIODIC:1000] BC_DISPATCHER [Call #13280000] current_bc_params: <class 'dict'>
30169.7s 8379 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30169.7s 8380 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30169.7s 8381 [PERIODIC:1000] BC_GPU [Call #13280000] About to launch kernel
30169.7s 8382 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30169.7s 8383 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30169.7s 8384 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30169.8s 8385 [WARNING] Automatic CFL correction applied (count: 3319900):
30169.8s 8386 Calculated CFL: 0.800 > Limit: 0.500
30169.8s 8387 Original dt: 3.400739e-01 s
30169.8s 8388 Corrected dt: 2.125462e-01 s
30169.8s 8389 Correction factor: 1.6x
30169.8s 8390 Max wave speed detected: 23.52 m/s
30170.1s 8391 Stored output at t = 3330.0000 s (Step 15690)
30170.1s 8392 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3315.0/3330.0 [00:00<?, ?s/s][A
30170.1s 8393 [A
30170.1s 8394 
30170.1s 8395 Simulation finished at t = 3330.0000 s after 15690 steps.
30170.1s 8396 Total runtime: 0.63 seconds.
30170.1s 8397 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.85s/s]
30170.1s 8398 [REWARD_MICROSCOPE] step=14142 t=3330.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30170.1s 8399 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30170.1s 8400 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30170.1s 8401 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30170.1s 8402 Running simulation until t = 3345.00 s, outputting every 15.00 s
30170.1s 8403 
30170.2s 8404 [PROGRESS] Step 15700: t=3332.13/3345.00s (99.6%) | dt=0.2129s
30170.6s 8405 [PROGRESS] Step 15750: t=3342.78/3345.00s (99.9%) | dt=0.2130s
30170.7s 8406 [WARNING] Automatic CFL correction applied (count: 3320000):
30170.7s 8407 Calculated CFL: 0.800 > Limit: 0.500
30170.7s 8408 Original dt: 3.402756e-01 s
30170.7s 8409 Corrected dt: 2.126723e-01 s
30170.7s 8410 Correction factor: 1.6x
30170.7s 8411 Max wave speed detected: 23.51 m/s
30170.8s 8412 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3330.0/3345.0 [00:00<?, ?s/s][A
30170.8s 8413 [A
30170.8s 8414 Stored output at t = 3345.0000 s (Step 15761)
30170.8s 8415 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 22.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 22.51s/s]
30170.8s 8416 
30170.8s 8417 Simulation finished at t = 3345.0000 s after 15761 steps.
30170.8s 8418 Total runtime: 0.67 seconds.
30170.8s 8419 [REWARD_MICROSCOPE] step=14143 t=3345.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30170.8s 8420 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30170.8s 8421 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30170.8s 8422 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30170.8s 8423 Running simulation until t = 3360.00 s, outputting every 15.00 s
30170.8s 8424 
30171.1s 8425 [PROGRESS] Step 15800: t=3353.28/3360.00s (99.8%) | dt=0.2126s
30171.4s 8426 Stored output at t = 3360.0000 s (Step 15832)
30171.4s 8427 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3345.0/3360.0 [00:00<?, ?s/s][A
30171.4s 8428 [A
30171.4s 8429 
30171.4s 8430 Simulation finished at t = 3360.0000 s after 15832 steps.
30171.4s 8431 Total runtime: 0.66 seconds.
30171.4s 8432 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 22.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 22.83s/s]
30171.4s 8433 [REWARD_MICROSCOPE] step=14144 t=3360.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30171.4s 8434 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30171.4s 8435 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30171.4s 8436 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30171.4s 8437 Running simulation until t = 3375.00 s, outputting every 15.00 s
30171.4s 8438 
30171.6s 8439 [PROGRESS] Step 15850: t=3363.83/3375.00s (99.7%) | dt=0.2130s
30171.6s 8440 [WARNING] Automatic CFL correction applied (count: 3320100):
30171.6s 8441 Calculated CFL: 0.800 > Limit: 0.500
30171.6s 8442 Original dt: 3.408732e-01 s
30171.6s 8443 Corrected dt: 2.130457e-01 s
30171.6s 8444 Correction factor: 1.6x
30171.6s 8445 Max wave speed detected: 23.47 m/s
30172.0s 8446 [PROGRESS] Step 15900: t=3374.49/3375.00s (100.0%) | dt=0.2134s
30172.0s 8447 [PERIODIC:1000] BC_DISPATCHER [Call #13281000] current_bc_params: <class 'dict'>
30172.0s 8448 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30172.0s 8449 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30172.0s 8450 [PERIODIC:1000] BC_GPU [Call #13281000] About to launch kernel
30172.0s 8451 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30172.0s 8452 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30172.0s 8453 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30172.0s 8454 Stored output at t = 3375.0000 s (Step 15903)
30172.0s 8455 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3360.0/3375.0 [00:00<?, ?s/s][A
30172.0s 8456 [A
30172.0s 8457 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.90s/s]
30172.0s 8458 
30172.0s 8459 Simulation finished at t = 3375.0000 s after 15903 steps.
30172.0s 8460 Total runtime: 0.63 seconds.
30172.0s 8461 [REWARD_MICROSCOPE] step=14145 t=3375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30172.0s 8462 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30172.0s 8463 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30172.0s 8464 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30172.0s 8465 Running simulation until t = 3390.00 s, outputting every 15.00 s
30172.0s 8466 
30172.5s 8467 [PROGRESS] Step 15950: t=3385.04/3390.00s (99.9%) | dt=0.2138s
30172.5s 8468 [WARNING] Automatic CFL correction applied (count: 3320200):
30172.5s 8469 Calculated CFL: 0.800 > Limit: 0.500
30172.5s 8470 Original dt: 3.421774e-01 s
30172.5s 8471 Corrected dt: 2.138609e-01 s
30172.5s 8472 Correction factor: 1.6x
30172.5s 8473 Max wave speed detected: 23.38 m/s
30172.7s 8474 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3375.0/3390.0 [00:00<?, ?s/s][A
30172.7s 8475 [A
30172.7s 8476 Stored output at t = 3390.0000 s (Step 15974)
30172.7s 8477 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.33s/s]
30172.7s 8478 
30172.7s 8479 Simulation finished at t = 3390.0000 s after 15974 steps.
30172.7s 8480 Total runtime: 0.62 seconds.
30172.7s 8481 [REWARD_MICROSCOPE] step=14146 t=3390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30172.7s 8482 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30172.7s 8483 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30172.7s 8484 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30172.7s 8485 Running simulation until t = 3405.00 s, outputting every 15.00 s
30172.7s 8486 
30172.9s 8487 [PROGRESS] Step 16000: t=3395.58/3405.00s (99.7%) | dt=0.2156s
30173.3s 8488 Stored output at t = 3405.0000 s (Step 16044)
30173.3s 8489 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3390.0/3405.0 [00:00<?, ?s/s][A
30173.3s 8490 [A
30173.3s 8491 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.39s/s]
30173.3s 8492 
30173.3s 8493 Simulation finished at t = 3405.0000 s after 16044 steps.
30173.3s 8494 Total runtime: 0.62 seconds.
30173.3s 8495 [REWARD_MICROSCOPE] step=14147 t=3405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30173.3s 8496 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30173.3s 8497 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30173.3s 8498 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30173.3s 8499 Running simulation until t = 3420.00 s, outputting every 15.00 s
30173.3s 8500 
30173.3s 8501 [PROGRESS] Step 16050: t=3406.31/3420.00s (99.6%) | dt=0.2184s
30173.4s 8502 [WARNING] Automatic CFL correction applied (count: 3320300):
30173.4s 8503 Calculated CFL: 0.800 > Limit: 0.500
30173.4s 8504 Original dt: 3.498276e-01 s
30173.4s 8505 Corrected dt: 2.186423e-01 s
30173.4s 8506 Correction factor: 1.6x
30173.4s 8507 Max wave speed detected: 22.87 m/s
30173.8s 8508 [PROGRESS] Step 16100: t=3417.26/3420.00s (99.9%) | dt=0.2193s
30173.9s 8509 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3405.0/3420.0 [00:00<?, ?s/s][A
30173.9s 8510 [A
30173.9s 8511 Stored output at t = 3420.0000 s (Step 16113)
30173.9s 8512 
30173.9s 8513 Simulation finished at t = 3420.0000 s after 16113 steps.
30173.9s 8514 Total runtime: 0.59 seconds.
30173.9s 8515 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 25.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 25.37s/s]
30173.9s 8516 [REWARD_MICROSCOPE] step=14148 t=3420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30173.9s 8517 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30173.9s 8518 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30173.9s 8519 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30173.9s 8520 Running simulation until t = 3435.00 s, outputting every 15.00 s
30173.9s 8521 
30174.2s 8522 [PROGRESS] Step 16150: t=3428.12/3435.00s (99.8%) | dt=0.2194s
30174.2s 8523 [PERIODIC:1000] BC_DISPATCHER [Call #13282000] current_bc_params: <class 'dict'>
30174.2s 8524 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30174.2s 8525 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30174.2s 8526 [PERIODIC:1000] BC_GPU [Call #13282000] About to launch kernel
30174.2s 8527 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30174.2s 8528 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30174.2s 8529 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30174.3s 8530 [WARNING] Automatic CFL correction applied (count: 3320400):
30174.3s 8531 Calculated CFL: 0.800 > Limit: 0.500
30174.3s 8532 Original dt: 3.510935e-01 s
30174.3s 8533 Corrected dt: 2.194335e-01 s
30174.3s 8534 Correction factor: 1.6x
30174.3s 8535 Max wave speed detected: 22.79 m/s
30174.5s 8536 Stored output at t = 3435.0000 s (Step 16182)
30174.5s 8537 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3420.0/3435.0 [00:00<?, ?s/s][A
30174.5s 8538 [A
30174.5s 8539 
30174.5s 8540 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 25.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 25.16s/s]
30174.5s 8541 Simulation finished at t = 3435.0000 s after 16182 steps.
30174.5s 8542 Total runtime: 0.60 seconds.
30174.5s 8543 [REWARD_MICROSCOPE] step=14149 t=3435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30174.5s 8544 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30174.5s 8545 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30174.5s 8546 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30174.5s 8547 Running simulation until t = 3450.00 s, outputting every 15.00 s
30174.5s 8548 
30174.6s 8549 [PROGRESS] Step 16200: t=3438.95/3450.00s (99.7%) | dt=0.2195s
30175.1s 8550 [PROGRESS] Step 16250: t=3449.92/3450.00s (100.0%) | dt=0.2195s
30175.1s 8551 Stored output at t = 3450.0000 s (Step 16251)
30175.1s 8552 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3435.0/3450.0 [00:00<?, ?s/s][A
30175.1s 8553 [A
30175.1s 8554 
30175.1s 8555 Simulation finished at t = 3450.0000 s after 16251 steps.
30175.1s 8556 Total runtime: 0.60 seconds.
30175.1s 8557 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 25.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 25.02s/s]
30175.1s 8558 [REWARD_MICROSCOPE] step=14150 t=3450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30175.1s 8559 [STEP  230] t= 3450.0s | phase=1 | reward=   0.00 | total_reward=    2.15
30175.1s 8560 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30175.1s 8561 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30175.1s 8562 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30175.1s 8563 Running simulation until t = 3465.00 s, outputting every 15.00 s
30175.1s 8564 
30175.1s 8565 [WARNING] Automatic CFL correction applied (count: 3320500):
30175.1s 8566 Calculated CFL: 0.800 > Limit: 0.500
30175.1s 8567 Original dt: 3.511714e-01 s
30175.1s 8568 Corrected dt: 2.194821e-01 s
30175.1s 8569 Correction factor: 1.6x
30175.1s 8570 Max wave speed detected: 22.78 m/s
30175.5s 8571 [PROGRESS] Step 16300: t=3460.75/3465.00s (99.9%) | dt=0.2195s
30175.7s 8572 Stored output at t = 3465.0000 s (Step 16320)
30175.7s 8573 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3450.0/3465.0 [00:00<?, ?s/s][A
30175.7s 8574 [A
30175.7s 8575 
30175.7s 8576 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 25.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 25.10s/s]
30175.7s 8577 Simulation finished at t = 3465.0000 s after 16320 steps.
30175.7s 8578 Total runtime: 0.60 seconds.
30175.7s 8579 [QUEUE_DIAGNOSTIC] ===== Step 230 t=3465.0s =====
30175.7s 8580 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30175.7s 8581 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01561897 1.         0.03809814 1.        ] (rho_m, v_m, rho_c, v_c)
30175.7s 8582 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30175.7s 8583 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30175.7s 8584 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30175.7s 8585 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00468569 0.00447661 0.0044096  0.00438658 0.00437841 0.00437545]
30175.7s 8586 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00571472 0.00532194 0.00514344 0.00505765 0.00501541 0.00499436]
30175.7s 8587 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30175.7s 8588 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30175.7s 8589 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30175.7s 8590 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30175.7s 8591 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30175.7s 8592 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30175.7s 8593 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30175.7s 8594 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30175.7s 8595 [REWARD_MICROSCOPE] step=14151 t=3465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30175.7s 8596 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30175.7s 8597 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30175.7s 8598 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30175.7s 8599 Running simulation until t = 3480.00 s, outputting every 15.00 s
30175.7s 8600 
30175.9s 8601 [PROGRESS] Step 16350: t=3471.58/3480.00s (99.8%) | dt=0.2195s
30176.0s 8602 [WARNING] Automatic CFL correction applied (count: 3320600):
30176.0s 8603 Calculated CFL: 0.800 > Limit: 0.500
30176.0s 8604 Original dt: 3.511797e-01 s
30176.0s 8605 Corrected dt: 2.194873e-01 s
30176.0s 8606 Correction factor: 1.6x
30176.0s 8607 Max wave speed detected: 22.78 m/s
30176.3s 8608 Stored output at t = 3480.0000 s (Step 16389)
30176.3s 8609 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3465.0/3480.0 [00:00<?, ?s/s][A
30176.3s 8610 [A
30176.3s 8611 
30176.3s 8612 Simulation finished at t = 3480.0000 s after 16389 steps.
30176.3s 8613 Total runtime: 0.61 seconds.
30176.3s 8614 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.80s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.79s/s]
30176.3s 8615 [REWARD_MICROSCOPE] step=14152 t=3480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30176.3s 8616 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30176.3s 8617 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30176.3s 8618 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30176.3s 8619 Running simulation until t = 3495.00 s, outputting every 15.00 s
30176.3s 8620 
30176.4s 8621 [PROGRESS] Step 16400: t=3482.41/3495.00s (99.6%) | dt=0.2194s
30176.4s 8622 [PERIODIC:1000] BC_DISPATCHER [Call #13283000] current_bc_params: <class 'dict'>
30176.4s 8623 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30176.4s 8624 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30176.4s 8625 [PERIODIC:1000] BC_GPU [Call #13283000] About to launch kernel
30176.4s 8626 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30176.4s 8627 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30176.4s 8628 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30176.8s 8629 [PROGRESS] Step 16450: t=3493.18/3495.00s (99.9%) | dt=0.2129s
30176.9s 8630 [WARNING] Automatic CFL correction applied (count: 3320700):
30176.9s 8631 Calculated CFL: 0.800 > Limit: 0.500
30176.9s 8632 Original dt: 3.401962e-01 s
30176.9s 8633 Corrected dt: 2.126226e-01 s
30176.9s 8634 Correction factor: 1.6x
30176.9s 8635 Max wave speed detected: 23.52 m/s
30176.9s 8636 Stored output at t = 3495.0000 s (Step 16459)
30176.9s 8637 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3480.0/3495.0 [00:00<?, ?s/s][A
30176.9s 8638 [A
30176.9s 8639 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.31s/s]
30176.9s 8640 
30176.9s 8641 Simulation finished at t = 3495.0000 s after 16459 steps.
30176.9s 8642 Total runtime: 0.62 seconds.
30176.9s 8643 [REWARD_MICROSCOPE] step=14153 t=3495.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30176.9s 8644 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30176.9s 8645 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30176.9s 8646 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30176.9s 8647 Running simulation until t = 3510.00 s, outputting every 15.00 s
30176.9s 8648 
30177.3s 8649 [PROGRESS] Step 16500: t=3503.71/3510.00s (99.8%) | dt=0.2126s
30177.5s 8650 Stored output at t = 3510.0000 s (Step 16530)
30177.5s 8651 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3495.0/3510.0 [00:00<?, ?s/s][A
30177.5s 8652 [A
30177.5s 8653 
30177.5s 8654 Simulation finished at t = 3510.0000 s after 16530 steps.
30177.5s 8655 Total runtime: 0.62 seconds.
30177.5s 8656 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.33s/s]
30177.5s 8657 [REWARD_MICROSCOPE] step=14154 t=3510.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30177.5s 8658 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30177.5s 8659 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30177.5s 8660 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30177.5s 8661 Running simulation until t = 3525.00 s, outputting every 15.00 s
30177.5s 8662 
30177.7s 8663 [PROGRESS] Step 16550: t=3514.26/3525.00s (99.7%) | dt=0.2131s
30177.8s 8664 [WARNING] Automatic CFL correction applied (count: 3320800):
30177.8s 8665 Calculated CFL: 0.800 > Limit: 0.500
30177.8s 8666 Original dt: 3.410122e-01 s
30177.8s 8667 Corrected dt: 2.131326e-01 s
30177.8s 8668 Correction factor: 1.6x
30177.8s 8669 Max wave speed detected: 23.46 m/s
30178.2s 8670 [PROGRESS] Step 16600: t=3524.92/3525.00s (100.0%) | dt=0.2126s
30178.2s 8671 Stored output at t = 3525.0000 s (Step 16601)
30178.2s 8672 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3510.0/3525.0 [00:00<?, ?s/s][A
30178.2s 8673 [A
30178.2s 8674 
30178.2s 8675 Simulation finished at t = 3525.0000 s after 16601 steps.
30178.2s 8676 Total runtime: 0.64 seconds.
30178.2s 8677 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 23.63s/s]
30178.2s 8678 [REWARD_MICROSCOPE] step=14155 t=3525.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30178.2s 8679 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30178.2s 8680 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30178.2s 8681 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30178.2s 8682 Running simulation until t = 3540.00 s, outputting every 15.00 s
30178.2s 8683 
30178.6s 8684 [PROGRESS] Step 16650: t=3535.41/3540.00s (99.9%) | dt=0.2126s
30178.6s 8685 [PERIODIC:1000] BC_DISPATCHER [Call #13284000] current_bc_params: <class 'dict'>
30178.6s 8686 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30178.6s 8687 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30178.6s 8688 [PERIODIC:1000] BC_GPU [Call #13284000] About to launch kernel
30178.6s 8689 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30178.6s 8690 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30178.6s 8691 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30178.7s 8692 [WARNING] Automatic CFL correction applied (count: 3320900):
30178.7s 8693 Calculated CFL: 0.800 > Limit: 0.500
30178.7s 8694 Original dt: 3.403261e-01 s
30178.7s 8695 Corrected dt: 2.127038e-01 s
30178.7s 8696 Correction factor: 1.6x
30178.7s 8697 Max wave speed detected: 23.51 m/s
30178.8s 8698 Stored output at t = 3540.0000 s (Step 16672)
30178.8s 8699 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3525.0/3540.0 [00:00<?, ?s/s][A
30178.8s 8700 [A
30178.8s 8701 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.43s/s]
30178.8s 8702 
30178.8s 8703 Simulation finished at t = 3540.0000 s after 16672 steps.
30178.8s 8704 Total runtime: 0.61 seconds.
30178.8s 8705 [REWARD_MICROSCOPE] step=14156 t=3540.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30178.8s 8706 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30178.8s 8707 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30178.8s 8708 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30178.8s 8709 Running simulation until t = 3555.00 s, outputting every 15.00 s
30178.8s 8710 
30179.0s 8711 [PROGRESS] Step 16700: t=3545.96/3555.00s (99.7%) | dt=0.2131s
30179.4s 8712 Stored output at t = 3555.0000 s (Step 16743)
30179.4s 8713 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3540.0/3555.0 [00:00<?, ?s/s][A
30179.4s 8714 [A
30179.4s 8715 
30179.4s 8716 Simulation finished at t = 3555.0000 s after 16743 steps.
30179.4s 8717 Total runtime: 0.61 seconds.
30179.4s 8718 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 24.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 24.58s/s]
30179.4s 8719 [REWARD_MICROSCOPE] step=14157 t=3555.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30179.4s 8720 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30179.4s 8721 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30179.4s 8722 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30179.4s 8723 Running simulation until t = 3570.00 s, outputting every 15.00 s
30179.4s 8724 
30179.5s 8725 [PROGRESS] Step 16750: t=3556.49/3570.00s (99.6%) | dt=0.2124s
30179.5s 8726 [WARNING] Automatic CFL correction applied (count: 3321000):
30179.5s 8727 Calculated CFL: 0.800 > Limit: 0.500
30179.5s 8728 Original dt: 3.397345e-01 s
30179.5s 8729 Corrected dt: 2.123340e-01 s
30179.5s 8730 Correction factor: 1.6x
30179.5s 8731 Max wave speed detected: 23.55 m/s
30179.9s 8732 [PROGRESS] Step 16800: t=3567.11/3570.00s (99.9%) | dt=0.2127s
30180.0s 8733 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3555.0/3570.0 [00:00<?, ?s/s][A
30180.0s 8734 [A
30180.0s 8735 Stored output at t = 3570.0000 s (Step 16814)
30180.0s 8736 
30180.0s 8737 Simulation finished at t = 3570.0000 s after 16814 steps.
30180.0s 8738 Total runtime: 0.61 seconds.
30180.0s 8739 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.55s/s]
30180.0s 8740 [REWARD_MICROSCOPE] step=14158 t=3570.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30180.0s 8741 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30180.0s 8742 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30180.0s 8743 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30180.0s 8744 Running simulation until t = 3585.00 s, outputting every 15.00 s
30180.0s 8745 
30180.3s 8746 [PROGRESS] Step 16850: t=3577.67/3585.00s (99.8%) | dt=0.2131s
30180.4s 8747 [WARNING] Automatic CFL correction applied (count: 3321100):
30180.4s 8748 Calculated CFL: 0.800 > Limit: 0.500
30180.4s 8749 Original dt: 3.411222e-01 s
30180.4s 8750 Corrected dt: 2.132014e-01 s
30180.4s 8751 Correction factor: 1.6x
30180.4s 8752 Max wave speed detected: 23.45 m/s
30180.6s 8753 Stored output at t = 3585.0000 s (Step 16885)
30180.6s 8754 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3570.0/3585.0 [00:00<?, ?s/s][A
30180.6s 8755 [A
30180.6s 8756 
30180.6s 8757 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 24.08s/s]
30180.6s 8758 Simulation finished at t = 3585.0000 s after 16885 steps.
30180.6s 8759 Total runtime: 0.62 seconds.
30180.6s 8760 [REWARD_MICROSCOPE] step=14159 t=3585.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30180.6s 8761 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30180.6s 8762 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30180.6s 8763 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30180.6s 8764 Running simulation until t = 3600.00 s, outputting every 15.00 s
30180.6s 8765 
30180.8s 8766 [PROGRESS] Step 16900: t=3588.19/3600.00s (99.7%) | dt=0.2123s
30180.8s 8767 [PERIODIC:1000] BC_DISPATCHER [Call #13285000] current_bc_params: <class 'dict'>
30180.8s 8768 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30180.8s 8769 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30180.8s 8770 [PERIODIC:1000] BC_GPU [Call #13285000] About to launch kernel
30180.8s 8771 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30180.8s 8772 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30180.8s 8773 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30181.3s 8774 [PROGRESS] Step 16950: t=3598.81/3600.00s (100.0%) | dt=0.2128s
30181.3s 8775 Stored output at t = 3600.0000 s (Step 16956)
30181.3s 8776 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3585.0/3600.0 [00:00<?, ?s/s][A
30181.3s 8777 [A
30181.3s 8778 
30181.3s 8779 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 22.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 22.51s/s]
30181.3s 8780 Simulation finished at t = 3600.0000 s after 16956 steps.
30181.3s 8781 Total runtime: 0.67 seconds.
30181.3s 8782 [REWARD_MICROSCOPE] step=14160 t=3600.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30181.3s 8783 [STEP  240] t= 3600.0s | phase=1 | reward=   0.01 | total_reward=    2.23
30181.3s 8784 DEBUG: Truncation - runner.t=3600.0, episode_max_time=3600.0
30181.3s 8785 
30181.3s 8786 ================================================================================
30181.3s 8787 [EPISODE END] Steps: 240 | Duration: 3600.0s | Total Reward: 2.23 | Avg Reward/Step: 0.009
30181.3s 8788 ================================================================================
30181.3s 8789 
30181.3s 8790 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30181.3s 8791 Using device: gpu
30181.3s 8792 DEBUG PARAMS: Reading K_m_kmh = 10.0
30181.3s 8793 DEBUG PARAMS: Reading K_c_kmh = 15.0
30181.3s 8794 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30181.3s 8795 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30181.3s 8796 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30181.3s 8797 V0_m = 13.333 m/s (48.0 km/h)
30181.3s 8798 V0_c = 11.667 m/s (42.0 km/h)
30181.3s 8799 Parameters loaded for scenario: adaptive_speed_control
30181.3s 8800 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30181.3s 8801 Loading road quality type: uniform
30181.3s 8802 Uniform road quality value: 1
30181.3s 8803 Road quality loaded.
30181.3s 8804 Initial state created.
30181.3s 8805 Transferring initial state and road quality to GPU...
30181.3s 8806 GPU data transfer complete.
30181.3s 8807 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30181.3s 8808 Initial boundary conditions applied.
30181.3s 8809 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30181.3s 8810 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30181.3s 8811 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30181.3s 8812 ----------------------------------
30181.3s 8813 | rollout/            |          |
30181.3s 8814 |    ep_len_mean      | 249      |
30181.3s 8815 |    ep_rew_mean      | 1.99     |
30181.3s 8816 |    exploration_rate | 0.05     |
30181.3s 8817 | time/               |          |
30181.3s 8818 |    episodes         | 28       |
30181.3s 8819 |    fps              | 0        |
30181.3s 8820 |    time_elapsed     | 9065     |
30181.3s 8821 |    total_timesteps  | 6960     |
30181.3s 8822 | train/              |          |
30181.3s 8823 |    learning_rate    | 0.001    |
30181.3s 8824 |    loss             | 2.18e-05 |
30181.3s 8825 |    n_updates        | 1489     |
30181.3s 8826 ----------------------------------
30181.3s 8827 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30181.3s 8828 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30181.3s 8829 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30181.3s 8830 Running simulation until t = 15.00 s, outputting every 15.00 s
30181.3s 8831 
30181.3s 8832 [WARNING] Automatic CFL correction applied (count: 3321200):
30181.3s 8833 Calculated CFL: 0.800 > Limit: 0.500
30181.3s 8834 Original dt: 8.021390e-01 s
30181.3s 8835 Corrected dt: 5.013369e-01 s
30181.3s 8836 Correction factor: 1.6x
30181.3s 8837 Max wave speed detected: 9.97 m/s
30181.8s 8838 [PROGRESS] Step 50: t=13.54/15.00s (90.2%) | dt=0.2218s
30181.8s 8839 Stored output at t = 15.0000 s (Step 57)
30181.8s 8840 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30181.8s 8841 [A
30181.8s 8842 
30181.8s 8843 Simulation finished at t = 15.0000 s after 57 steps.
30181.8s 8844 Total runtime: 0.50 seconds.
30181.8s 8845 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 30.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 30.28s/s]
30181.8s 8846 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30181.8s 8847 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30181.8s 8848 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.3385851e-05 1.0000000e+00 2.1694007e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30181.8s 8849 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30181.8s 8850 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30181.8s 8851 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30181.8s 8852 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.9015755e-05 1.7692651e-05 1.7420234e-05 1.7426888e-05 1.7518192e-05
30181.8s 8853 1.7647317e-05]
30181.8s 8854 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.2541011e-05 2.8764263e-05 2.7852753e-05 2.7888356e-05 2.8342256e-05
30181.8s 8855 2.9237935e-05]
30181.8s 8856 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30181.8s 8857 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30181.8s 8858 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30181.8s 8859 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30181.8s 8860 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30181.8s 8861 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30181.8s 8862 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30181.8s 8863 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30181.8s 8864 [REWARD_MICROSCOPE] step=14161 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30181.8s 8865 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30181.8s 8866 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30181.8s 8867 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30181.8s 8868 Running simulation until t = 30.00 s, outputting every 15.00 s
30181.8s 8869 
30182.2s 8870 [PROGRESS] Step 100: t=24.29/30.00s (81.0%) | dt=0.2150s
30182.2s 8871 [WARNING] Automatic CFL correction applied (count: 3321300):
30182.2s 8872 Calculated CFL: 0.800 > Limit: 0.500
30182.2s 8873 Original dt: 3.440747e-01 s
30182.2s 8874 Corrected dt: 2.150467e-01 s
30182.2s 8875 Correction factor: 1.6x
30182.2s 8876 Max wave speed detected: 23.25 m/s
30182.5s 8877 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30182.5s 8878 Stored output at t = 30.0000 s (Step 127)
30182.5s 8879 [A
30182.5s 8880 
30182.5s 8881 Simulation finished at t = 30.0000 s after 127 steps.
30182.5s 8882 Total runtime: 0.61 seconds.
30182.5s 8883 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.53s/s]
30182.5s 8884 [REWARD_MICROSCOPE] step=14162 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30182.5s 8885 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30182.5s 8886 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30182.5s 8887 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30182.5s 8888 Running simulation until t = 45.00 s, outputting every 15.00 s
30182.5s 8889 
30182.7s 8890 [PROGRESS] Step 150: t=34.95/45.00s (77.7%) | dt=0.2155s
30183.0s 8891 [PERIODIC:1000] BC_DISPATCHER [Call #13286000] current_bc_params: <class 'dict'>
30183.0s 8892 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30183.0s 8893 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30183.0s 8894 [PERIODIC:1000] BC_GPU [Call #13286000] About to launch kernel
30183.0s 8895 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30183.0s 8896 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30183.0s 8897 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30183.1s 8898 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30183.1s 8899 [A
30183.1s 8900 Stored output at t = 45.0000 s (Step 197)
30183.1s 8901 
30183.1s 8902 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.57s/s]
30183.1s 8903 Simulation finished at t = 45.0000 s after 197 steps.
30183.1s 8904 Total runtime: 0.61 seconds.
30183.1s 8905 [REWARD_MICROSCOPE] step=14163 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30183.1s 8906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30183.1s 8907 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30183.1s 8908 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30183.1s 8909 Running simulation until t = 60.00 s, outputting every 15.00 s
30183.1s 8910 
30183.1s 8911 [PROGRESS] Step 200: t=45.64/60.00s (76.1%) | dt=0.2125s
30183.1s 8912 [WARNING] Automatic CFL correction applied (count: 3321400):
30183.1s 8913 Calculated CFL: 0.800 > Limit: 0.500
30183.1s 8914 Original dt: 3.399429e-01 s
30183.1s 8915 Corrected dt: 2.124643e-01 s
30183.1s 8916 Correction factor: 1.6x
30183.1s 8917 Max wave speed detected: 23.53 m/s
30183.5s 8918 [PROGRESS] Step 250: t=56.26/60.00s (93.8%) | dt=0.2127s
30183.7s 8919 Stored output at t = 60.0000 s (Step 268)
30183.7s 8920 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30183.7s 8921 [A
30183.7s 8922 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.49s/s]
30183.7s 8923 
30183.7s 8924 Simulation finished at t = 60.0000 s after 268 steps.
30183.7s 8925 Total runtime: 0.61 seconds.
30183.7s 8926 [REWARD_MICROSCOPE] step=14164 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30183.7s 8927 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30183.7s 8928 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30183.7s 8929 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30183.7s 8930 Running simulation until t = 75.00 s, outputting every 15.00 s
30183.7s 8931 
30184.0s 8932 [PROGRESS] Step 300: t=66.82/75.00s (89.1%) | dt=0.2132s
30184.0s 8933 [WARNING] Automatic CFL correction applied (count: 3321500):
30184.0s 8934 Calculated CFL: 0.800 > Limit: 0.500
30184.0s 8935 Original dt: 3.410961e-01 s
30184.0s 8936 Corrected dt: 2.131850e-01 s
30184.0s 8937 Correction factor: 1.6x
30184.0s 8938 Max wave speed detected: 23.45 m/s
30184.3s 8939 Stored output at t = 75.0000 s (Step 339)
30184.3s 8940 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30184.3s 8941 [A
30184.3s 8942 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.02s/s]
30184.3s 8943 
30184.3s 8944 Simulation finished at t = 75.0000 s after 339 steps.
30184.3s 8945 Total runtime: 0.62 seconds.
30184.3s 8946 [REWARD_MICROSCOPE] step=14165 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30184.3s 8947 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30184.3s 8948 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30184.3s 8949 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30184.3s 8950 Running simulation until t = 90.00 s, outputting every 15.00 s
30184.3s 8951 
30184.4s 8952 [PROGRESS] Step 350: t=77.34/90.00s (85.9%) | dt=0.2123s
30184.8s 8953 [PROGRESS] Step 400: t=87.96/90.00s (97.7%) | dt=0.2128s
30184.8s 8954 [WARNING] Automatic CFL correction applied (count: 3321600):
30184.8s 8955 Calculated CFL: 0.800 > Limit: 0.500
30184.8s 8956 Original dt: 3.404109e-01 s
30184.8s 8957 Corrected dt: 2.127568e-01 s
30184.8s 8958 Correction factor: 1.6x
30184.8s 8959 Max wave speed detected: 23.50 m/s
30184.9s 8960 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30184.9s 8961 Stored output at t = 90.0000 s (Step 410)
30184.9s 8962 [A
30184.9s 8963 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.22s/s]
30184.9s 8964 
30184.9s 8965 Simulation finished at t = 90.0000 s after 410 steps.
30184.9s 8966 Total runtime: 0.62 seconds.
30184.9s 8967 [REWARD_MICROSCOPE] step=14166 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30184.9s 8968 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30184.9s 8969 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30184.9s 8970 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30184.9s 8971 Running simulation until t = 105.00 s, outputting every 15.00 s
30184.9s 8972 
30185.2s 8973 [PERIODIC:1000] BC_DISPATCHER [Call #13287000] current_bc_params: <class 'dict'>
30185.2s 8974 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30185.2s 8975 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30185.2s 8976 [PERIODIC:1000] BC_GPU [Call #13287000] About to launch kernel
30185.2s 8977 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30185.2s 8978 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30185.2s 8979 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30185.3s 8980 [PROGRESS] Step 450: t=98.52/105.00s (93.8%) | dt=0.2132s
30185.5s 8981 Stored output at t = 105.0000 s (Step 481)
30185.5s 8982 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30185.5s 8983 [A
30185.6s 8984 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.41s/s]
30185.6s 8985 
30185.6s 8986 Simulation finished at t = 105.0000 s after 481 steps.
30185.6s 8987 Total runtime: 0.61 seconds.
30185.6s 8988 [REWARD_MICROSCOPE] step=14167 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30185.6s 8989 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30185.6s 8990 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30185.6s 8991 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30185.6s 8992 Running simulation until t = 120.00 s, outputting every 15.00 s
30185.6s 8993 
30185.7s 8994 [PROGRESS] Step 500: t=109.04/120.00s (90.9%) | dt=0.2124s
30185.7s 8995 [WARNING] Automatic CFL correction applied (count: 3321700):
30185.7s 8996 Calculated CFL: 0.800 > Limit: 0.500
30185.7s 8997 Original dt: 3.398162e-01 s
30185.7s 8998 Corrected dt: 2.123851e-01 s
30185.7s 8999 Correction factor: 1.6x
30185.7s 9000 Max wave speed detected: 23.54 m/s
30186.1s 9001 [PROGRESS] Step 550: t=119.67/120.00s (99.7%) | dt=0.2128s
30186.2s 9002 Stored output at t = 120.0000 s (Step 552)
30186.2s 9003 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30186.2s 9004 [A
30186.2s 9005 
30186.2s 9006 Simulation finished at t = 120.0000 s after 552 steps.
30186.2s 9007 Total runtime: 0.62 seconds.
30186.2s 9008 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.38s/s]
30186.2s 9009 [REWARD_MICROSCOPE] step=14168 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30186.2s 9010 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30186.2s 9011 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30186.2s 9012 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30186.2s 9013 Running simulation until t = 135.00 s, outputting every 15.00 s
30186.2s 9014 
30186.6s 9015 [PROGRESS] Step 600: t=130.23/135.00s (96.5%) | dt=0.2132s
30186.6s 9016 [WARNING] Automatic CFL correction applied (count: 3321800):
30186.6s 9017 Calculated CFL: 0.800 > Limit: 0.500
30186.6s 9018 Original dt: 3.412047e-01 s
30186.6s 9019 Corrected dt: 2.132530e-01 s
30186.6s 9020 Correction factor: 1.6x
30186.6s 9021 Max wave speed detected: 23.45 m/s
30186.8s 9022 Stored output at t = 135.0000 s (Step 623)
30186.8s 9023 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30186.8s 9024 [A
30186.8s 9025 
30186.8s 9026 Simulation finished at t = 135.0000 s after 623 steps.
30186.8s 9027 Total runtime: 0.62 seconds.
30186.8s 9028 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.38s/s]
30186.8s 9029 [REWARD_MICROSCOPE] step=14169 t=135.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30186.8s 9030 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30186.8s 9031 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30186.8s 9032 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30186.8s 9033 Running simulation until t = 150.00 s, outputting every 15.00 s
30186.8s 9034 
30187.0s 9035 [PROGRESS] Step 650: t=140.73/150.00s (93.8%) | dt=0.2124s
30187.4s 9036 Stored output at t = 150.0000 s (Step 694)
30187.4s 9037 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30187.4s 9038 [A
30187.4s 9039 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.21s/s]
30187.4s 9040 
30187.4s 9041 Simulation finished at t = 150.0000 s after 694 steps.
30187.4s 9042 Total runtime: 0.62 seconds.
30187.4s 9043 [REWARD_MICROSCOPE] step=14170 t=150.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30187.4s 9044 [STEP   10] t=  150.0s | phase=1 | reward=   0.01 | total_reward=    0.11
30187.4s 9045 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30187.4s 9046 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30187.4s 9047 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30187.4s 9048 Running simulation until t = 165.00 s, outputting every 15.00 s
30187.4s 9049 
30187.4s 9050 [PERIODIC:1000] BC_DISPATCHER [Call #13288000] current_bc_params: <class 'dict'>
30187.4s 9051 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30187.4s 9052 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30187.4s 9053 [PERIODIC:1000] BC_GPU [Call #13288000] About to launch kernel
30187.4s 9054 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30187.4s 9055 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30187.4s 9056 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30187.5s 9057 [PROGRESS] Step 700: t=151.28/165.00s (91.7%) | dt=0.2129s
30187.5s 9058 [WARNING] Automatic CFL correction applied (count: 3321900):
30187.5s 9059 Calculated CFL: 0.800 > Limit: 0.500
30187.5s 9060 Original dt: 3.406282e-01 s
30187.5s 9061 Corrected dt: 2.128926e-01 s
30187.5s 9062 Correction factor: 1.6x
30187.5s 9063 Max wave speed detected: 23.49 m/s
30187.9s 9064 [PROGRESS] Step 750: t=161.93/165.00s (98.1%) | dt=0.2132s
30188.0s 9065 Stored output at t = 165.0000 s (Step 765)
30188.0s 9066 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30188.0s 9067 [A
30188.0s 9068 
30188.0s 9069 Simulation finished at t = 165.0000 s after 765 steps.
30188.0s 9070 Total runtime: 0.62 seconds.
30188.0s 9071 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.31s/s]
30188.0s 9072 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30188.0s 9073 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30188.0s 9074 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30188.0s 9075 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30188.0s 9076 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30188.0s 9077 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30188.0s 9078 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30188.0s 9079 1.6692446e-05]
30188.0s 9080 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30188.0s 9081 2.3782164e-05]
30188.0s 9082 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30188.0s 9083 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30188.0s 9084 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30188.0s 9085 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30188.0s 9086 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30188.0s 9087 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30188.0s 9088 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30188.0s 9089 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30188.0s 9090 [REWARD_MICROSCOPE] step=14171 t=165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30188.0s 9091 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30188.0s 9092 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30188.0s 9093 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30188.0s 9094 Running simulation until t = 180.00 s, outputting every 15.00 s
30188.0s 9095 
30188.3s 9096 [PROGRESS] Step 800: t=172.43/180.00s (95.8%) | dt=0.2125s
30188.3s 9097 [WARNING] Automatic CFL correction applied (count: 3322000):
30188.3s 9098 Calculated CFL: 0.800 > Limit: 0.500
30188.3s 9099 Original dt: 3.400456e-01 s
30188.3s 9100 Corrected dt: 2.125285e-01 s
30188.3s 9101 Correction factor: 1.6x
30188.3s 9102 Max wave speed detected: 23.53 m/s
30188.7s 9103 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30188.7s 9104 [A
30188.7s 9105 Stored output at t = 180.0000 s (Step 836)
30188.7s 9106 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.43s/s]
30188.7s 9107 
30188.7s 9108 Simulation finished at t = 180.0000 s after 836 steps.
30188.7s 9109 Total runtime: 0.61 seconds.
30188.7s 9110 [REWARD_MICROSCOPE] step=14172 t=180.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30188.7s 9111 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30188.7s 9112 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30188.7s 9113 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30188.7s 9114 Running simulation until t = 195.00 s, outputting every 15.00 s
30188.7s 9115 
30188.8s 9116 [PROGRESS] Step 850: t=182.98/195.00s (93.8%) | dt=0.2130s
30189.2s 9117 [PROGRESS] Step 900: t=193.64/195.00s (99.3%) | dt=0.2128s
30189.2s 9118 [WARNING] Automatic CFL correction applied (count: 3322100):
30189.2s 9119 Calculated CFL: 0.800 > Limit: 0.500
30189.2s 9120 Original dt: 3.403973e-01 s
30189.2s 9121 Corrected dt: 2.127483e-01 s
30189.2s 9122 Correction factor: 1.6x
30189.2s 9123 Max wave speed detected: 23.50 m/s
30189.3s 9124 Stored output at t = 195.0000 s (Step 907)
30189.3s 9125 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30189.3s 9126 [A
30189.3s 9127 
30189.3s 9128 Simulation finished at t = 195.0000 s after 907 steps.
30189.3s 9129 Total runtime: 0.63 seconds.
30189.3s 9130 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 23.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 23.64s/s]
30189.3s 9131 [REWARD_MICROSCOPE] step=14173 t=195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30189.3s 9132 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30189.3s 9133 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30189.3s 9134 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30189.3s 9135 Running simulation until t = 210.00 s, outputting every 15.00 s
30189.3s 9136 
30189.6s 9137 [PERIODIC:1000] BC_DISPATCHER [Call #13289000] current_bc_params: <class 'dict'>
30189.6s 9138 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30189.6s 9139 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30189.6s 9140 [PERIODIC:1000] BC_GPU [Call #13289000] About to launch kernel
30189.6s 9141 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30189.6s 9142 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30189.6s 9143 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30189.7s 9144 [PROGRESS] Step 950: t=204.13/210.00s (97.2%) | dt=0.2126s
30189.9s 9145 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30189.9s 9146 Stored output at t = 210.0000 s (Step 978)
30189.9s 9147 [A
30189.9s 9148 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.17s/s]
30189.9s 9149 
30189.9s 9150 Simulation finished at t = 210.0000 s after 978 steps.
30189.9s 9151 Total runtime: 0.62 seconds.
30189.9s 9152 [REWARD_MICROSCOPE] step=14174 t=210.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30189.9s 9153 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30189.9s 9154 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30189.9s 9155 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30189.9s 9156 Running simulation until t = 225.00 s, outputting every 15.00 s
30189.9s 9157 
30190.1s 9158 [PROGRESS] Step 1000: t=214.68/225.00s (95.4%) | dt=0.2130s
30190.1s 9159 [WARNING] Automatic CFL correction applied (count: 3322200):
30190.1s 9160 Calculated CFL: 0.800 > Limit: 0.500
30190.1s 9161 Original dt: 3.408459e-01 s
30190.1s 9162 Corrected dt: 2.130287e-01 s
30190.1s 9163 Correction factor: 1.6x
30190.1s 9164 Max wave speed detected: 23.47 m/s
30190.5s 9165 Stored output at t = 225.0000 s (Step 1049)
30190.5s 9166 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30190.5s 9167 [A
30190.5s 9168 
30190.5s 9169 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.43s/s]
30190.5s 9170 Simulation finished at t = 225.0000 s after 1049 steps.
30190.5s 9171 Total runtime: 0.61 seconds.
30190.5s 9172 [REWARD_MICROSCOPE] step=14175 t=225.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30190.5s 9173 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30190.5s 9174 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30190.5s 9175 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30190.5s 9176 Running simulation until t = 240.00 s, outputting every 15.00 s
30190.5s 9177 
30190.5s 9178 [PROGRESS] Step 1050: t=225.21/240.00s (93.8%) | dt=0.2125s
30191.0s 9179 [PROGRESS] Step 1100: t=235.84/240.00s (98.3%) | dt=0.2127s
30191.0s 9180 [WARNING] Automatic CFL correction applied (count: 3322300):
30191.0s 9181 Calculated CFL: 0.800 > Limit: 0.500
30191.0s 9182 Original dt: 3.402698e-01 s
30191.0s 9183 Corrected dt: 2.126687e-01 s
30191.0s 9184 Correction factor: 1.6x
30191.0s 9185 Max wave speed detected: 23.51 m/s
30191.2s 9186 Stored output at t = 240.0000 s (Step 1120)
30191.2s 9187 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30191.2s 9188 [A
30191.2s 9189 
30191.2s 9190 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 23.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 23.08s/s]
30191.2s 9191 Simulation finished at t = 240.0000 s after 1120 steps.
30191.2s 9192 Total runtime: 0.65 seconds.
30191.2s 9193 [REWARD_MICROSCOPE] step=14176 t=240.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30191.2s 9194 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30191.2s 9195 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30191.2s 9196 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30191.2s 9197 Running simulation until t = 255.00 s, outputting every 15.00 s
30191.2s 9198 
30191.5s 9199 [PROGRESS] Step 1150: t=246.39/255.00s (96.6%) | dt=0.2131s
30191.8s 9200 Stored output at t = 255.0000 s (Step 1191)
30191.8s 9201 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30191.8s 9202 
30191.8s 9203 Simulation finished at t = 255.0000 s after 1191 steps.
30191.8s 9204 Total runtime: 0.62 seconds.
30191.8s 9205 [A
30191.8s 9206 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 24.04s/s]
30191.8s 9207 [REWARD_MICROSCOPE] step=14177 t=255.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30191.8s 9208 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30191.8s 9209 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30191.8s 9210 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30191.8s 9211 Running simulation until t = 270.00 s, outputting every 15.00 s
30191.8s 9212 
30191.9s 9213 [PERIODIC:1000] BC_DISPATCHER [Call #13290000] current_bc_params: <class 'dict'>
30191.9s 9214 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30191.9s 9215 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30191.9s 9216 [PERIODIC:1000] BC_GPU [Call #13290000] About to launch kernel
30191.9s 9217 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30191.9s 9218 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30191.9s 9219 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30191.9s 9220 [PROGRESS] Step 1200: t=256.91/270.00s (95.2%) | dt=0.2123s
30191.9s 9221 [WARNING] Automatic CFL correction applied (count: 3322400):
30191.9s 9222 Calculated CFL: 0.800 > Limit: 0.500
30191.9s 9223 Original dt: 3.397227e-01 s
30191.9s 9224 Corrected dt: 2.123267e-01 s
30191.9s 9225 Correction factor: 1.6x
30191.9s 9226 Max wave speed detected: 23.55 m/s
30192.3s 9227 [PROGRESS] Step 1250: t=267.54/270.00s (99.1%) | dt=0.2127s
30192.4s 9228 Stored output at t = 270.0000 s (Step 1262)
30192.4s 9229 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30192.4s 9230 [A
30192.4s 9231 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.21s/s]
30192.4s 9232 
30192.4s 9233 Simulation finished at t = 270.0000 s after 1262 steps.
30192.4s 9234 Total runtime: 0.62 seconds.
30192.4s 9235 [REWARD_MICROSCOPE] step=14178 t=270.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30192.4s 9236 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30192.4s 9237 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30192.4s 9238 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30192.4s 9239 Running simulation until t = 285.00 s, outputting every 15.00 s
30192.4s 9240 
30192.8s 9241 [PROGRESS] Step 1300: t=278.09/285.00s (97.6%) | dt=0.2132s
30192.8s 9242 [WARNING] Automatic CFL correction applied (count: 3322500):
30192.8s 9243 Calculated CFL: 0.800 > Limit: 0.500
30192.8s 9244 Original dt: 3.410662e-01 s
30192.8s 9245 Corrected dt: 2.131664e-01 s
30192.8s 9246 Correction factor: 1.6x
30192.8s 9247 Max wave speed detected: 23.46 m/s
30193.1s 9248 Stored output at t = 285.0000 s (Step 1333)
30193.1s 9249 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30193.1s 9250 [A
30193.1s 9251 
30193.1s 9252 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.39s/s]
30193.1s 9253 Simulation finished at t = 285.0000 s after 1333 steps.
30193.1s 9254 Total runtime: 0.62 seconds.
30193.1s 9255 [REWARD_MICROSCOPE] step=14179 t=285.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30193.1s 9256 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30193.1s 9257 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30193.1s 9258 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30193.1s 9259 Running simulation until t = 300.00 s, outputting every 15.00 s
30193.1s 9260 
30193.2s 9261 [PROGRESS] Step 1350: t=288.61/300.00s (96.2%) | dt=0.2124s
30193.6s 9262 [PROGRESS] Step 1400: t=299.24/300.00s (99.7%) | dt=0.2128s
30193.6s 9263 [WARNING] Automatic CFL correction applied (count: 3322600):
30193.6s 9264 Calculated CFL: 0.800 > Limit: 0.500
30193.6s 9265 Original dt: 3.404917e-01 s
30193.6s 9266 Corrected dt: 2.128073e-01 s
30193.6s 9267 Correction factor: 1.6x
30193.6s 9268 Max wave speed detected: 23.50 m/s
30193.7s 9269 Stored output at t = 300.0000 s (Step 1404)
30193.7s 9270 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30193.7s 9271 [A
30193.7s 9272 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.48s/s]
30193.7s 9273 
30193.7s 9274 Simulation finished at t = 300.0000 s after 1404 steps.
30193.7s 9275 Total runtime: 0.61 seconds.
30193.7s 9276 [REWARD_MICROSCOPE] step=14180 t=300.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30193.7s 9277 [STEP   20] t=  300.0s | phase=1 | reward=   0.01 | total_reward=    0.21
30193.7s 9278 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30193.7s 9279 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30193.7s 9280 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30193.7s 9281 Running simulation until t = 315.00 s, outputting every 15.00 s
30193.7s 9282 
30194.0s 9283 [PERIODIC:1000] BC_DISPATCHER [Call #13291000] current_bc_params: <class 'dict'>
30194.0s 9284 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30194.0s 9285 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30194.0s 9286 [PERIODIC:1000] BC_GPU [Call #13291000] About to launch kernel
30194.0s 9287 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30194.0s 9288 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30194.0s 9289 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30194.1s 9290 [PROGRESS] Step 1450: t=309.80/315.00s (98.3%) | dt=0.2132s
30194.3s 9291 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30194.3s 9292 Stored output at t = 315.0000 s (Step 1475)
30194.3s 9293 [A
30194.3s 9294 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.80s/s]
30194.3s 9295 
30194.3s 9296 Simulation finished at t = 315.0000 s after 1475 steps.
30194.3s 9297 Total runtime: 0.63 seconds.
30194.3s 9298 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30194.3s 9299 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30194.3s 9300 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [6.2408319e-05 1.0000000e+00 2.0513892e-04 1.0000000e+00] (rho_m, v_m, rho_c, v_c)
30194.3s 9301 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30194.3s 9302 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30194.3s 9303 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30194.3s 9304 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [1.8722496e-05 1.7252123e-05 1.6842581e-05 1.6724875e-05 1.6694938e-05
30194.3s 9305 1.6692446e-05]
30194.3s 9306 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [3.0770840e-05 2.6356696e-05 2.4789362e-05 2.4169904e-05 2.3902621e-05
30194.3s 9307 2.3782164e-05]
30194.3s 9308 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30194.3s 9309 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30194.3s 9310 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30194.3s 9311 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30194.3s 9312 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30194.3s 9313 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30194.3s 9314 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30194.3s 9315 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30194.3s 9316 [REWARD_MICROSCOPE] step=14181 t=315.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30194.3s 9317 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30194.3s 9318 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30194.3s 9319 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30194.3s 9320 Running simulation until t = 330.00 s, outputting every 15.00 s
30194.3s 9321 
30194.5s 9322 [PROGRESS] Step 1500: t=320.31/330.00s (97.1%) | dt=0.2124s
30194.5s 9323 [WARNING] Automatic CFL correction applied (count: 3322700):
30194.5s 9324 Calculated CFL: 0.800 > Limit: 0.500
30194.5s 9325 Original dt: 3.399024e-01 s
30194.5s 9326 Corrected dt: 2.124390e-01 s
30194.5s 9327 Correction factor: 1.6x
30194.5s 9328 Max wave speed detected: 23.54 m/s
30194.9s 9329 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30194.9s 9330 [A
30194.9s 9331 Stored output at t = 330.0000 s (Step 1546)
30194.9s 9332 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 23.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 23.62s/s]
30194.9s 9333 
30194.9s 9334 Simulation finished at t = 330.0000 s after 1546 steps.
30194.9s 9335 Total runtime: 0.64 seconds.
30194.9s 9336 [REWARD_MICROSCOPE] step=14182 t=330.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30194.9s 9337 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30194.9s 9338 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30194.9s 9339 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30194.9s 9340 Running simulation until t = 345.00 s, outputting every 15.00 s
30194.9s 9341 
30195.0s 9342 [PROGRESS] Step 1550: t=330.85/345.00s (95.9%) | dt=0.2129s
30195.4s 9343 [PROGRESS] Step 1600: t=341.51/345.00s (99.0%) | dt=0.2133s
30195.4s 9344 [WARNING] Automatic CFL correction applied (count: 3322800):
30195.4s 9345 Calculated CFL: 0.800 > Limit: 0.500
30195.4s 9346 Original dt: 3.412050e-01 s
30195.4s 9347 Corrected dt: 2.132531e-01 s
30195.4s 9348 Correction factor: 1.6x
30195.4s 9349 Max wave speed detected: 23.45 m/s
30195.6s 9350 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30195.6s 9351 Stored output at t = 345.0000 s (Step 1617)
30195.6s 9352 [A
30195.6s 9353 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.17s/s]
30195.6s 9354 
30195.6s 9355 Simulation finished at t = 345.0000 s after 1617 steps.
30195.6s 9356 Total runtime: 0.62 seconds.
30195.6s 9357 [REWARD_MICROSCOPE] step=14183 t=345.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30195.6s 9358 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30195.6s 9359 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30195.6s 9360 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30195.6s 9361 Running simulation until t = 360.00 s, outputting every 15.00 s
30195.6s 9362 
30195.9s 9363 [PROGRESS] Step 1650: t=352.01/360.00s (97.8%) | dt=0.2125s
30196.2s 9364 Stored output at t = 360.0000 s (Step 1688)
30196.2s 9365 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30196.2s 9366 [A
30196.2s 9367 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 22.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 22.92s/s]
30196.2s 9368 
30196.2s 9369 Simulation finished at t = 360.0000 s after 1688 steps.
30196.2s 9370 Total runtime: 0.65 seconds.
30196.2s 9371 [REWARD_MICROSCOPE] step=14184 t=360.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30196.2s 9372 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30196.2s 9373 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30196.2s 9374 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30196.2s 9375 Running simulation until t = 375.00 s, outputting every 15.00 s
30196.2s 9376 
30196.3s 9377 [PERIODIC:1000] BC_DISPATCHER [Call #13292000] current_bc_params: <class 'dict'>
30196.3s 9378 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30196.3s 9379 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30196.3s 9380 [PERIODIC:1000] BC_GPU [Call #13292000] About to launch kernel
30196.3s 9381 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30196.3s 9382 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30196.3s 9383 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30196.3s 9384 [PROGRESS] Step 1700: t=362.55/375.00s (96.7%) | dt=0.2129s
30196.3s 9385 [WARNING] Automatic CFL correction applied (count: 3322900):
30196.3s 9386 Calculated CFL: 0.800 > Limit: 0.500
30196.3s 9387 Original dt: 3.407107e-01 s
30196.3s 9388 Corrected dt: 2.129442e-01 s
30196.3s 9389 Correction factor: 1.6x
30196.3s 9390 Max wave speed detected: 23.48 m/s
30196.8s 9391 [PROGRESS] Step 1750: t=373.21/375.00s (99.5%) | dt=0.2129s
30196.9s 9392 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30196.9s 9393 [A
30196.9s 9394 Stored output at t = 375.0000 s (Step 1759)
30196.9s 9395 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.18s/s]
30196.9s 9396 
30196.9s 9397 Simulation finished at t = 375.0000 s after 1759 steps.
30196.9s 9398 Total runtime: 0.62 seconds.
30196.9s 9399 [REWARD_MICROSCOPE] step=14185 t=375.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30196.9s 9400 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30196.9s 9401 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30196.9s 9402 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30196.9s 9403 Running simulation until t = 390.00 s, outputting every 15.00 s
30196.9s 9404 
30197.2s 9405 [PROGRESS] Step 1800: t=383.71/390.00s (98.4%) | dt=0.2126s
30197.2s 9406 [WARNING] Automatic CFL correction applied (count: 3323000):
30197.2s 9407 Calculated CFL: 0.800 > Limit: 0.500
30197.2s 9408 Original dt: 3.401303e-01 s
30197.2s 9409 Corrected dt: 2.125814e-01 s
30197.2s 9410 Correction factor: 1.6x
30197.2s 9411 Max wave speed detected: 23.52 m/s
30197.5s 9412 Stored output at t = 390.0000 s (Step 1830)
30197.5s 9413 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30197.5s 9414 [A
30197.5s 9415 
30197.5s 9416 Simulation finished at t = 390.0000 s after 1830 steps.
30197.5s 9417 Total runtime: 0.61 seconds.
30197.5s 9418 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.43s/s]
30197.5s 9419 [REWARD_MICROSCOPE] step=14186 t=390.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30197.5s 9420 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30197.5s 9421 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30197.5s 9422 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30197.5s 9423 Running simulation until t = 405.00 s, outputting every 15.00 s
30197.5s 9424 
30197.6s 9425 [PROGRESS] Step 1850: t=394.26/405.00s (97.3%) | dt=0.2130s
30198.1s 9426 [PROGRESS] Step 1900: t=404.91/405.00s (100.0%) | dt=0.2126s
30198.1s 9427 [WARNING] Automatic CFL correction applied (count: 3323100):
30198.1s 9428 Calculated CFL: 0.800 > Limit: 0.500
30198.1s 9429 Original dt: 3.400634e-01 s
30198.1s 9430 Corrected dt: 2.125396e-01 s
30198.1s 9431 Correction factor: 1.6x
30198.1s 9432 Max wave speed detected: 23.53 m/s
30198.1s 9433 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30198.1s 9434 [A
30198.1s 9435 Stored output at t = 405.0000 s (Step 1901)
30198.1s 9436 
30198.1s 9437 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 24.30s/s]
30198.1s 9438 Simulation finished at t = 405.0000 s after 1901 steps.
30198.1s 9439 Total runtime: 0.62 seconds.
30198.1s 9440 [REWARD_MICROSCOPE] step=14187 t=405.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30198.1s 9441 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30198.1s 9442 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30198.1s 9443 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30198.1s 9444 Running simulation until t = 420.00 s, outputting every 15.00 s
30198.1s 9445 
30198.5s 9446 [PERIODIC:1000] BC_DISPATCHER [Call #13293000] current_bc_params: <class 'dict'>
30198.5s 9447 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30198.5s 9448 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30198.5s 9449 [PERIODIC:1000] BC_GPU [Call #13293000] About to launch kernel
30198.5s 9450 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30198.5s 9451 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30198.5s 9452 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30198.5s 9453 [PROGRESS] Step 1950: t=415.41/420.00s (98.9%) | dt=0.2126s
30198.7s 9454 Stored output at t = 420.0000 s (Step 1972)
30198.7s 9455 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30198.7s 9456 [A
30198.7s 9457 
30198.7s 9458 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.50s/s]
30198.7s 9459 Simulation finished at t = 420.0000 s after 1972 steps.
30198.7s 9460 Total runtime: 0.61 seconds.
30198.7s 9461 [REWARD_MICROSCOPE] step=14188 t=420.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30198.7s 9462 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30198.7s 9463 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30198.7s 9464 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30198.7s 9465 Running simulation until t = 435.00 s, outputting every 15.00 s
30198.7s 9466 
30199.0s 9467 [PROGRESS] Step 2000: t=425.96/435.00s (97.9%) | dt=0.2131s
30199.0s 9468 [WARNING] Automatic CFL correction applied (count: 3323200):
30199.0s 9469 Calculated CFL: 0.800 > Limit: 0.500
30199.0s 9470 Original dt: 3.409279e-01 s
30199.0s 9471 Corrected dt: 2.130799e-01 s
30199.0s 9472 Correction factor: 1.6x
30199.0s 9473 Max wave speed detected: 23.47 m/s
30199.3s 9474 Stored output at t = 435.0000 s (Step 2043)
30199.3s 9475 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30199.3s 9476 [A
30199.3s 9477 
30199.3s 9478 Simulation finished at t = 435.0000 s after 2043 steps.
30199.3s 9479 Total runtime: 0.63 seconds.
30199.3s 9480 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 23.97s/s]
30199.3s 9481 [REWARD_MICROSCOPE] step=14189 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30199.3s 9482 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30199.3s 9483 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30199.3s 9484 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30199.3s 9485 Running simulation until t = 450.00 s, outputting every 15.00 s
30199.3s 9486 
30199.4s 9487 [PROGRESS] Step 2050: t=436.49/450.00s (97.0%) | dt=0.2135s
30199.8s 9488 [PROGRESS] Step 2100: t=447.18/450.00s (99.4%) | dt=0.2139s
30199.8s 9489 [WARNING] Automatic CFL correction applied (count: 3323300):
30199.8s 9490 Calculated CFL: 0.800 > Limit: 0.500
30199.8s 9491 Original dt: 3.422244e-01 s
30199.8s 9492 Corrected dt: 2.138902e-01 s
30199.8s 9493 Correction factor: 1.6x
30199.8s 9494 Max wave speed detected: 23.38 m/s
30200.0s 9495 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30200.0s 9496 Stored output at t = 450.0000 s (Step 2114)
30200.0s 9497 [A
30200.0s 9498 
30200.0s 9499 Simulation finished at t = 450.0000 s after 2114 steps.
30200.0s 9500 Total runtime: 0.62 seconds.
30200.0s 9501 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.40s/s]
30200.0s 9502 [REWARD_MICROSCOPE] step=14190 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30200.0s 9503 [STEP   30] t=  450.0s | phase=1 | reward=   0.02 | total_reward=    0.33
30200.0s 9504 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30200.0s 9505 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30200.0s 9506 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30200.0s 9507 Running simulation until t = 465.00 s, outputting every 15.00 s
30200.0s 9508 
30200.3s 9509 [PROGRESS] Step 2150: t=457.74/465.00s (98.4%) | dt=0.2163s
30200.6s 9510 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30200.6s 9511 [A
30200.6s 9512 Stored output at t = 465.0000 s (Step 2184)
30200.6s 9513 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.24s/s]
30200.6s 9514 
30200.6s 9515 Simulation finished at t = 465.0000 s after 2184 steps.
30200.6s 9516 Total runtime: 0.62 seconds.
30200.6s 9517 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30200.6s 9518 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30200.6s 9519 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01561917 1.         0.03809915 1.        ] (rho_m, v_m, rho_c, v_c)
30200.6s 9520 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30200.6s 9521 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30200.6s 9522 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30200.6s 9523 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00468575 0.00447669 0.00440964 0.00438662 0.00437846 0.0043755 ]
30200.6s 9524 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00571487 0.00532223 0.00514391 0.00505834 0.00501624 0.00499522]
30200.6s 9525 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30200.6s 9526 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30200.6s 9527 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30200.6s 9528 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30200.6s 9529 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30200.6s 9530 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30200.6s 9531 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30200.6s 9532 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30200.6s 9533 [REWARD_MICROSCOPE] step=14191 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200
30200.6s 9534 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30200.6s 9535 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30200.6s 9536 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30200.6s 9537 Running simulation until t = 480.00 s, outputting every 15.00 s
30200.6s 9538 
30200.7s 9539 [PERIODIC:1000] BC_DISPATCHER [Call #13294000] current_bc_params: <class 'dict'>
30200.7s 9540 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30200.7s 9541 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30200.7s 9542 [PERIODIC:1000] BC_GPU [Call #13294000] About to launch kernel
30200.7s 9543 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30200.7s 9544 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30200.7s 9545 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30200.7s 9546 [PROGRESS] Step 2200: t=468.50/480.00s (97.6%) | dt=0.2187s
30200.7s 9547 [WARNING] Automatic CFL correction applied (count: 3323400):
30200.7s 9548 Calculated CFL: 0.800 > Limit: 0.500
30200.7s 9549 Original dt: 3.499867e-01 s
30200.7s 9550 Corrected dt: 2.187417e-01 s
30200.7s 9551 Correction factor: 1.6x
30200.7s 9552 Max wave speed detected: 22.86 m/s
30201.2s 9553 [PROGRESS] Step 2250: t=479.45/480.00s (99.9%) | dt=0.2193s
30201.2s 9554 Stored output at t = 480.0000 s (Step 2253)
30201.2s 9555 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30201.2s 9556 [A
30201.2s 9557 
30201.2s 9558 Simulation finished at t = 480.0000 s after 2253 steps.
30201.2s 9559 Total runtime: 0.64 seconds.
30201.2s 9560 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.35s/s]
30201.2s 9561 [REWARD_MICROSCOPE] step=14192 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30201.2s 9562 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30201.2s 9563 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30201.2s 9564 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30201.2s 9565 Running simulation until t = 495.00 s, outputting every 15.00 s
30201.2s 9566 
30201.6s 9567 [PROGRESS] Step 2300: t=490.31/495.00s (99.1%) | dt=0.2194s
30201.6s 9568 [WARNING] Automatic CFL correction applied (count: 3323500):
30201.6s 9569 Calculated CFL: 0.800 > Limit: 0.500
30201.6s 9570 Original dt: 3.511015e-01 s
30201.6s 9571 Corrected dt: 2.194384e-01 s
30201.6s 9572 Correction factor: 1.6x
30201.6s 9573 Max wave speed detected: 22.79 m/s
30201.8s 9574 Stored output at t = 495.0000 s (Step 2322)
30201.8s 9575 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30201.8s 9576 [A
30201.8s 9577 
30201.8s 9578 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.73s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.72s/s]
30201.8s 9579 Simulation finished at t = 495.0000 s after 2322 steps.
30201.8s 9580 Total runtime: 0.61 seconds.
30201.8s 9581 [REWARD_MICROSCOPE] step=14193 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30201.8s 9582 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30201.8s 9583 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30201.8s 9584 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30201.8s 9585 Running simulation until t = 510.00 s, outputting every 15.00 s
30201.8s 9586 
30202.1s 9587 [PROGRESS] Step 2350: t=501.15/510.00s (98.3%) | dt=0.2195s
30202.5s 9588 Stored output at t = 510.0000 s (Step 2391)
30202.5s 9589 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30202.5s 9590 [A
30202.5s 9591 
30202.5s 9592 Simulation finished at t = 510.0000 s after 2391 steps.
30202.5s 9593 Total runtime: 0.63 seconds.
30202.5s 9594 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 23.83s/s]
30202.5s 9595 [REWARD_MICROSCOPE] step=14194 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30202.5s 9596 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30202.5s 9597 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30202.5s 9598 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30202.5s 9599 Running simulation until t = 525.00 s, outputting every 15.00 s
30202.5s 9600 
30202.6s 9601 [PROGRESS] Step 2400: t=511.98/525.00s (97.5%) | dt=0.2195s
30202.6s 9602 [WARNING] Automatic CFL correction applied (count: 3323600):
30202.6s 9603 Calculated CFL: 0.800 > Limit: 0.500
30202.6s 9604 Original dt: 3.511722e-01 s
30202.6s 9605 Corrected dt: 2.194826e-01 s
30202.6s 9606 Correction factor: 1.6x
30202.6s 9607 Max wave speed detected: 22.78 m/s
30203.0s 9608 [PERIODIC:1000] BC_DISPATCHER [Call #13295000] current_bc_params: <class 'dict'>
30203.0s 9609 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30203.0s 9610 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30203.0s 9611 [PERIODIC:1000] BC_GPU [Call #13295000] About to launch kernel
30203.0s 9612 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30203.0s 9613 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30203.0s 9614 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30203.0s 9615 [PROGRESS] Step 2450: t=522.95/525.00s (99.6%) | dt=0.2195s
30203.1s 9616 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30203.1s 9617 [A
30203.1s 9618 Stored output at t = 525.0000 s (Step 2460)
30203.1s 9619 
30203.1s 9620 Simulation finished at t = 525.0000 s after 2460 steps.
30203.1s 9621 Total runtime: 0.61 seconds.
30203.1s 9622 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 24.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 24.65s/s]
30203.1s 9623 [REWARD_MICROSCOPE] step=14195 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30203.1s 9624 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30203.1s 9625 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30203.1s 9626 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30203.1s 9627 Running simulation until t = 540.00 s, outputting every 15.00 s
30203.1s 9628 
30203.4s 9629 [PROGRESS] Step 2500: t=533.78/540.00s (98.8%) | dt=0.2195s
30203.4s 9630 [WARNING] Automatic CFL correction applied (count: 3323700):
30203.4s 9631 Calculated CFL: 0.800 > Limit: 0.500
30203.4s 9632 Original dt: 3.511798e-01 s
30203.4s 9633 Corrected dt: 2.194874e-01 s
30203.4s 9634 Correction factor: 1.6x
30203.4s 9635 Max wave speed detected: 22.78 m/s
30203.7s 9636 Stored output at t = 540.0000 s (Step 2529)
30203.7s 9637 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30203.7s 9638 [A
30203.7s 9639 
30203.7s 9640 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 25.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 25.18s/s]
30203.7s 9641 Simulation finished at t = 540.0000 s after 2529 steps.
30203.7s 9642 Total runtime: 0.60 seconds.
30203.7s 9643 [REWARD_MICROSCOPE] step=14196 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000
30203.7s 9644 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30203.7s 9645 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30203.7s 9646 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30203.7s 9647 Running simulation until t = 555.00 s, outputting every 15.00 s
30203.7s 9648 
30203.9s 9649 [PROGRESS] Step 2550: t=544.60/555.00s (98.1%) | dt=0.2176s
30204.3s 9650 Stored output at t = 555.0000 s (Step 2599)
30204.3s 9651 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30204.3s 9652 [A
30204.3s 9653 
30204.3s 9654 Simulation finished at t = 555.0000 s after 2599 steps.
30204.3s 9655 Total runtime: 0.61 seconds.
30204.3s 9656 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.74s/s]
30204.3s 9657 [REWARD_MICROSCOPE] step=14197 t=555.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30204.3s 9658 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30204.3s 9659 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30204.3s 9660 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30204.3s 9661 Running simulation until t = 570.00 s, outputting every 15.00 s
30204.3s 9662 
30204.3s 9663 [PROGRESS] Step 2600: t=555.21/570.00s (97.4%) | dt=0.2125s
30204.3s 9664 [WARNING] Automatic CFL correction applied (count: 3323800):
30204.3s 9665 Calculated CFL: 0.800 > Limit: 0.500
30204.3s 9666 Original dt: 3.400172e-01 s
30204.3s 9667 Corrected dt: 2.125107e-01 s
30204.3s 9668 Correction factor: 1.6x
30204.3s 9669 Max wave speed detected: 23.53 m/s
30204.8s 9670 [PROGRESS] Step 2650: t=565.84/570.00s (99.3%) | dt=0.2127s
30204.9s 9671 Stored output at t = 570.0000 s (Step 2670)
30204.9s 9672 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30204.9s 9673 [A
30204.9s 9674 
30204.9s 9675 Simulation finished at t = 570.0000 s after 2670 steps.
30204.9s 9676 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.08s/s]
30204.9s 9677 Total runtime: 0.65 seconds.
30204.9s 9678 [REWARD_MICROSCOPE] step=14198 t=570.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30204.9s 9679 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30204.9s 9680 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30204.9s 9681 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30204.9s 9682 Running simulation until t = 585.00 s, outputting every 15.00 s
30205.0s 9683 
30205.2s 9684 [PERIODIC:1000] BC_DISPATCHER [Call #13296000] current_bc_params: <class 'dict'>
30205.2s 9685 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30205.2s 9686 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30205.2s 9687 [PERIODIC:1000] BC_GPU [Call #13296000] About to launch kernel
30205.2s 9688 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30205.2s 9689 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30205.2s 9690 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30205.2s 9691 [PROGRESS] Step 2700: t=576.39/585.00s (98.5%) | dt=0.2132s
30205.2s 9692 [WARNING] Automatic CFL correction applied (count: 3323900):
30205.2s 9693 Calculated CFL: 0.800 > Limit: 0.500
30205.2s 9694 Original dt: 3.410733e-01 s
30205.2s 9695 Corrected dt: 2.131708e-01 s
30205.2s 9696 Correction factor: 1.6x
30205.2s 9697 Max wave speed detected: 23.46 m/s
30205.6s 9698 Stored output at t = 585.0000 s (Step 2741)
30205.6s 9699 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30205.6s 9700 [A
30205.6s 9701 
30205.6s 9702 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.35s/s]
30205.6s 9703 Simulation finished at t = 585.0000 s after 2741 steps.
30205.6s 9704 Total runtime: 0.62 seconds.
30205.6s 9705 [REWARD_MICROSCOPE] step=14199 t=585.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30205.6s 9706 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30205.6s 9707 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30205.6s 9708 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30205.6s 9709 Running simulation until t = 600.00 s, outputting every 15.00 s
30205.6s 9710 
30205.6s 9711 [PROGRESS] Step 2750: t=586.91/600.00s (97.8%) | dt=0.2123s
30206.1s 9712 [PROGRESS] Step 2800: t=597.54/600.00s (99.6%) | dt=0.2127s
30206.1s 9713 [WARNING] Automatic CFL correction applied (count: 3324000):
30206.1s 9714 Calculated CFL: 0.800 > Limit: 0.500
30206.1s 9715 Original dt: 3.403816e-01 s
30206.1s 9716 Corrected dt: 2.127385e-01 s
30206.1s 9717 Correction factor: 1.6x
30206.1s 9718 Max wave speed detected: 23.50 m/s
30206.2s 9719 Stored output at t = 600.0000 s (Step 2812)
30206.2s 9720 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30206.2s 9721 [A
30206.2s 9722 
30206.2s 9723 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.14s/s]
30206.2s 9724 Simulation finished at t = 600.0000 s after 2812 steps.
30206.2s 9725 Total runtime: 0.62 seconds.
30206.2s 9726 [REWARD_MICROSCOPE] step=14200 t=600.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30206.2s 9727 [STEP   40] t=  600.0s | phase=1 | reward=   0.01 | total_reward=    0.39
30206.2s 9728 ðŸ—‘ï¸  Deleted old checkpoint: adaptive_speed_control_checkpoint_6b298a56_5500_steps.zip
30206.2s 9729 ðŸ“Š Progress: 7,000/10,000 (70.0%) | ETA: 64.9 min | Speed: 0.8 steps/s
30206.2s 9730 
30206.2s 9731 ================================================================================
30206.2s 9732 [EPISODE END] Steps: 40 | Duration: 600.0s | Total Reward: 0.39 | Avg Reward/Step: 0.010
30206.2s 9733 ================================================================================
30206.2s 9734 
30206.2s 9735 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30206.2s 9736 Using device: gpu
30206.2s 9737 DEBUG PARAMS: Reading K_m_kmh = 10.0
30206.2s 9738 DEBUG PARAMS: Reading K_c_kmh = 15.0
30206.2s 9739 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30206.2s 9740 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30206.2s 9741 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30206.2s 9742 V0_m = 13.333 m/s (48.0 km/h)
30206.2s 9743 V0_c = 11.667 m/s (42.0 km/h)
30206.2s 9744 Parameters loaded for scenario: adaptive_speed_control
30206.2s 9745 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30206.2s 9746 Loading road quality type: uniform
30206.2s 9747 Uniform road quality value: 1
30206.2s 9748 Road quality loaded.
30206.2s 9749 Initial state created.
30206.2s 9750 Transferring initial state and road quality to GPU...
30206.2s 9751 GPU data transfer complete.
30206.2s 9752 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30206.2s 9753 Initial boundary conditions applied.
30206.2s 9754 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30206.2s 9755 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30206.2s 9756 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30206.2s 9757 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30206.2s 9758 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30206.2s 9759 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30206.2s 9760 Running simulation until t = 15.00 s, outputting every 15.00 s
30206.2s 9761 
30206.7s 9762 [PROGRESS] Step 50: t=13.88/15.00s (92.6%) | dt=0.2304s
30206.7s 9763 Stored output at t = 15.0000 s (Step 55)
30206.7s 9764 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30206.7s 9765 [A
30206.7s 9766 
30206.7s 9767 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 31.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 31.65s/s]
30206.7s 9768 Simulation finished at t = 15.0000 s after 55 steps.
30206.7s 9769 Total runtime: 0.47 seconds.
30206.7s 9770 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30206.7s 9771 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30206.7s 9772 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01592309 1.         0.04031418 1.        ] (rho_m, v_m, rho_c, v_c)
30206.7s 9773 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30206.7s 9774 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30206.7s 9775 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30206.7s 9776 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00477693 0.00461974 0.0045987  0.00461509 0.00464349 0.00467782]
30206.7s 9777 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00604713 0.0058468  0.0058367  0.00589007 0.00596703 0.00605711]
30206.7s 9778 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30206.7s 9779 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30206.7s 9780 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30206.7s 9781 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30206.7s 9782 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30206.7s 9783 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30206.7s 9784 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30206.7s 9785 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30206.7s 9786 [REWARD_MICROSCOPE] step=14201 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30206.7s 9787 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30206.7s 9788 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30206.7s 9789 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30206.7s 9790 Running simulation until t = 30.00 s, outputting every 15.00 s
30206.7s 9791 
30207.0s 9792 [WARNING] Automatic CFL correction applied (count: 3324100):
30207.0s 9793 Calculated CFL: 0.800 > Limit: 0.500
30207.0s 9794 Original dt: 3.469383e-01 s
30207.0s 9795 Corrected dt: 2.168365e-01 s
30207.0s 9796 Correction factor: 1.6x
30207.0s 9797 Max wave speed detected: 23.06 m/s
30207.1s 9798 [PROGRESS] Step 100: t=24.93/30.00s (83.1%) | dt=0.2150s
30207.3s 9799 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30207.3s 9800 [A
30207.3s 9801 Stored output at t = 30.0000 s (Step 124)
30207.3s 9802 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.95s/s]
30207.3s 9803 
30207.3s 9804 Simulation finished at t = 30.0000 s after 124 steps.
30207.3s 9805 Total runtime: 0.60 seconds.
30207.3s 9806 [REWARD_MICROSCOPE] step=14202 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30207.3s 9807 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30207.3s 9808 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30207.3s 9809 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30207.3s 9810 Running simulation until t = 45.00 s, outputting every 15.00 s
30207.3s 9811 
30207.4s 9812 [PERIODIC:1000] BC_DISPATCHER [Call #13297000] current_bc_params: <class 'dict'>
30207.4s 9813 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30207.4s 9814 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30207.4s 9815 [PERIODIC:1000] BC_GPU [Call #13297000] About to launch kernel
30207.4s 9816 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30207.4s 9817 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30207.4s 9818 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30207.5s 9819 [PROGRESS] Step 150: t=35.53/45.00s (79.0%) | dt=0.2127s
30207.9s 9820 [WARNING] Automatic CFL correction applied (count: 3324200):
30207.9s 9821 Calculated CFL: 0.800 > Limit: 0.500
30207.9s 9822 Original dt: 3.411409e-01 s
30207.9s 9823 Corrected dt: 2.132131e-01 s
30207.9s 9824 Correction factor: 1.6x
30207.9s 9825 Max wave speed detected: 23.45 m/s
30207.9s 9826 Stored output at t = 45.0000 s (Step 195)
30207.9s 9827 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30207.9s 9828 [A
30207.9s 9829 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 24.50s/s]
30207.9s 9830 
30207.9s 9831 Simulation finished at t = 45.0000 s after 195 steps.
30207.9s 9832 Total runtime: 0.61 seconds.
30207.9s 9833 [REWARD_MICROSCOPE] step=14203 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30207.9s 9834 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30207.9s 9835 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30207.9s 9836 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30207.9s 9837 Running simulation until t = 60.00 s, outputting every 15.00 s
30207.9s 9838 
30208.0s 9839 [PROGRESS] Step 200: t=46.07/60.00s (76.8%) | dt=0.2134s
30208.4s 9840 [PROGRESS] Step 250: t=56.75/60.00s (94.6%) | dt=0.2132s
30208.5s 9841 Stored output at t = 60.0000 s (Step 266)
30208.5s 9842 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30208.5s 9843 [A
30208.5s 9844 
30208.5s 9845 Simulation finished at t = 60.0000 s after 266 steps.
30208.5s 9846 Total runtime: 0.61 seconds.
30208.5s 9847 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.47s/s]
30208.5s 9848 [REWARD_MICROSCOPE] step=14204 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30208.5s 9849 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30208.5s 9850 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30208.5s 9851 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30208.5s 9852 Running simulation until t = 75.00 s, outputting every 15.00 s
30208.5s 9853 
30208.7s 9854 [WARNING] Automatic CFL correction applied (count: 3324300):
30208.7s 9855 Calculated CFL: 0.800 > Limit: 0.500
30208.7s 9856 Original dt: 3.398645e-01 s
30208.7s 9857 Corrected dt: 2.124153e-01 s
30208.7s 9858 Correction factor: 1.6x
30208.7s 9859 Max wave speed detected: 23.54 m/s
30208.8s 9860 [PROGRESS] Step 300: t=67.22/75.00s (89.6%) | dt=0.2125s
30209.2s 9861 Stored output at t = 75.0000 s (Step 337)
30209.2s 9862 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30209.2s 9863 [A
30209.2s 9864 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 23.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 23.47s/s]
30209.2s 9865 
30209.2s 9866 Simulation finished at t = 75.0000 s after 337 steps.
30209.2s 9867 Total runtime: 0.64 seconds.
30209.2s 9868 [REWARD_MICROSCOPE] step=14205 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30209.2s 9869 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30209.2s 9870 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30209.2s 9871 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30209.2s 9872 Running simulation until t = 90.00 s, outputting every 15.00 s
30209.2s 9873 
30209.3s 9874 [PROGRESS] Step 350: t=77.77/90.00s (86.4%) | dt=0.2130s
30209.6s 9875 [PERIODIC:1000] BC_DISPATCHER [Call #13298000] current_bc_params: <class 'dict'>
30209.6s 9876 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30209.6s 9877 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30209.6s 9878 [PERIODIC:1000] BC_GPU [Call #13298000] About to launch kernel
30209.6s 9879 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30209.6s 9880 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30209.6s 9881 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30209.6s 9882 [WARNING] Automatic CFL correction applied (count: 3324400):
30209.6s 9883 Calculated CFL: 0.800 > Limit: 0.500
30209.6s 9884 Original dt: 3.412729e-01 s
30209.6s 9885 Corrected dt: 2.132955e-01 s
30209.6s 9886 Correction factor: 1.6x
30209.6s 9887 Max wave speed detected: 23.44 m/s
30209.7s 9888 [PROGRESS] Step 400: t=88.42/90.00s (98.2%) | dt=0.2128s
30209.8s 9889 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30209.8s 9890 [A
30209.8s 9891 Stored output at t = 90.0000 s (Step 408)
30209.8s 9892 
30209.8s 9893 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.00s/s]
30209.8s 9894 Simulation finished at t = 90.0000 s after 408 steps.
30209.8s 9895 Total runtime: 0.63 seconds.
30209.8s 9896 [REWARD_MICROSCOPE] step=14206 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30209.8s 9897 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30209.8s 9898 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30209.8s 9899 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30209.8s 9900 Running simulation until t = 105.00 s, outputting every 15.00 s
30209.8s 9901 
30210.2s 9902 [PROGRESS] Step 450: t=98.92/105.00s (94.2%) | dt=0.2126s
30210.4s 9903 Stored output at t = 105.0000 s (Step 479)
30210.4s 9904 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30210.4s 9905 [A
30210.4s 9906 
30210.4s 9907 Simulation finished at t = 105.0000 s after 479 steps.
30210.4s 9908 Total runtime: 0.62 seconds.
30210.4s 9909 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 24.09s/s]
30210.4s 9910 [REWARD_MICROSCOPE] step=14207 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30210.4s 9911 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30210.4s 9912 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30210.4s 9913 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30210.4s 9914 Running simulation until t = 120.00 s, outputting every 15.00 s
30210.4s 9915 
30210.5s 9916 [WARNING] Automatic CFL correction applied (count: 3324500):
30210.5s 9917 Calculated CFL: 0.800 > Limit: 0.500
30210.5s 9918 Original dt: 3.406665e-01 s
30210.5s 9919 Corrected dt: 2.129165e-01 s
30210.5s 9920 Correction factor: 1.6x
30210.5s 9921 Max wave speed detected: 23.48 m/s
30210.6s 9922 [PROGRESS] Step 500: t=109.47/120.00s (91.2%) | dt=0.2130s
30211.1s 9923 [PROGRESS] Step 550: t=120.00/120.00s (100.0%) | dt=0.0883s
30211.1s 9924 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30211.1s 9925 Stored output at t = 120.0000 s (Step 550)
30211.1s 9926 [A
30211.1s 9927 
30211.1s 9928 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 22.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 22.89s/s]
30211.1s 9929 Simulation finished at t = 120.0000 s after 550 steps.
30211.1s 9930 Total runtime: 0.66 seconds.
30211.1s 9931 [REWARD_MICROSCOPE] step=14208 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30211.1s 9932 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30211.1s 9933 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30211.1s 9934 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30211.1s 9935 Running simulation until t = 135.00 s, outputting every 15.00 s
30211.1s 9936 
30211.4s 9937 [WARNING] Automatic CFL correction applied (count: 3324600):
30211.4s 9938 Calculated CFL: 0.800 > Limit: 0.500
30211.4s 9939 Original dt: 3.400921e-01 s
30211.4s 9940 Corrected dt: 2.125575e-01 s
30211.4s 9941 Correction factor: 1.6x
30211.4s 9942 Max wave speed detected: 23.52 m/s
30211.5s 9943 [PROGRESS] Step 600: t=130.62/135.00s (96.8%) | dt=0.2127s
30211.7s 9944 Stored output at t = 135.0000 s (Step 621)
30211.7s 9945 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30211.7s 9946 [A
30211.7s 9947 
30211.7s 9948 Simulation finished at t = 135.0000 s after 621 steps.
30211.7s 9949 Total runtime: 0.62 seconds.
30211.7s 9950 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.07s/s]
30211.7s 9951 [REWARD_MICROSCOPE] step=14209 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30211.7s 9952 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30211.7s 9953 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30211.7s 9954 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30211.7s 9955 Running simulation until t = 150.00 s, outputting every 15.00 s
30211.7s 9956 
30211.8s 9957 [PERIODIC:1000] BC_DISPATCHER [Call #13299000] current_bc_params: <class 'dict'>
30211.8s 9958 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30211.8s 9959 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30211.8s 9960 [PERIODIC:1000] BC_GPU [Call #13299000] About to launch kernel
30211.8s 9961 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30211.8s 9962 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30211.8s 9963 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30212.0s 9964 [PROGRESS] Step 650: t=141.18/150.00s (94.1%) | dt=0.2131s
30212.3s 9965 [WARNING] Automatic CFL correction applied (count: 3324700):
30212.3s 9966 Calculated CFL: 0.800 > Limit: 0.500
30212.3s 9967 Original dt: 3.402189e-01 s
30212.3s 9968 Corrected dt: 2.126368e-01 s
30212.3s 9969 Correction factor: 1.6x
30212.3s 9970 Max wave speed detected: 23.51 m/s
30212.4s 9971 Stored output at t = 150.0000 s (Step 692)
30212.4s 9972 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30212.4s 9973 [A
30212.4s 9974 
30212.4s 9975 Simulation finished at t = 150.0000 s after 692 steps.
30212.4s 9976 Total runtime: 0.65 seconds.
30212.4s 9977 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 22.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 22.97s/s]
30212.4s 9978 [REWARD_MICROSCOPE] step=14210 t=150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30212.4s 9979 [STEP   10] t=  150.0s | phase=0 | reward=   0.01 | total_reward=    0.10
30212.4s 9980 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30212.4s 9981 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30212.4s 9982 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30212.4s 9983 Running simulation until t = 165.00 s, outputting every 15.00 s
30212.4s 9984 
30212.4s 9985 [PROGRESS] Step 700: t=151.70/165.00s (91.9%) | dt=0.2124s
30212.9s 9986 [PROGRESS] Step 750: t=162.32/165.00s (98.4%) | dt=0.2127s
30213.0s 9987 Stored output at t = 165.0000 s (Step 763)
30213.0s 9988 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30213.0s 9989 [A
30213.0s 9990 
30213.0s 9991 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.27s/s]
30213.0s 9992 Simulation finished at t = 165.0000 s after 763 steps.
30213.0s 9993 Total runtime: 0.62 seconds.
30213.0s 9994 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30213.0s 9995 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30213.0s 9996 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30213.0s 9997 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30213.0s 9998 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30213.0s 9999 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30213.0s 10000 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30213.0s 10001 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30213.0s 10002 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30213.0s 10003 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30213.0s 10004 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30213.0s 10005 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30213.0s 10006 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30213.0s 10007 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30213.0s 10008 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30213.0s 10009 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30213.0s 10010 [REWARD_MICROSCOPE] step=14211 t=165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30213.0s 10011 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30213.0s 10012 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30213.0s 10013 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30213.0s 10014 Running simulation until t = 180.00 s, outputting every 15.00 s
30213.0s 10015 
30213.2s 10016 [WARNING] Automatic CFL correction applied (count: 3324800):
30213.2s 10017 Calculated CFL: 0.800 > Limit: 0.500
30213.2s 10018 Original dt: 3.408895e-01 s
30213.2s 10019 Corrected dt: 2.130559e-01 s
30213.2s 10020 Correction factor: 1.6x
30213.2s 10021 Max wave speed detected: 23.47 m/s
30213.3s 10022 [PROGRESS] Step 800: t=172.88/180.00s (96.0%) | dt=0.2131s
30213.6s 10023 Stored output at t = 180.0000 s (Step 834)
30213.6s 10024 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30213.6s 10025 [A
30213.6s 10026 
30213.6s 10027 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.25s/s]
30213.6s 10028 Simulation finished at t = 180.0000 s after 834 steps.
30213.6s 10029 Total runtime: 0.62 seconds.
30213.6s 10030 [REWARD_MICROSCOPE] step=14212 t=180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30213.6s 10031 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30213.6s 10032 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30213.6s 10033 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30213.6s 10034 Running simulation until t = 195.00 s, outputting every 15.00 s
30213.6s 10035 
30213.8s 10036 [PROGRESS] Step 850: t=183.40/195.00s (94.1%) | dt=0.2123s
30214.0s 10037 [PERIODIC:1000] BC_DISPATCHER [Call #13300000] current_bc_params: <class 'dict'>
30214.0s 10038 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30214.0s 10039 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30214.0s 10040 [PERIODIC:1000] BC_GPU [Call #13300000] About to launch kernel
30214.0s 10041 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30214.0s 10042 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30214.0s 10043 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30214.1s 10044 [WARNING] Automatic CFL correction applied (count: 3324900):
30214.1s 10045 Calculated CFL: 0.800 > Limit: 0.500
30214.1s 10046 Original dt: 3.403151e-01 s
30214.1s 10047 Corrected dt: 2.126969e-01 s
30214.1s 10048 Correction factor: 1.6x
30214.1s 10049 Max wave speed detected: 23.51 m/s
30214.2s 10050 [PROGRESS] Step 900: t=194.03/195.00s (99.5%) | dt=0.2128s
30214.2s 10051 Stored output at t = 195.0000 s (Step 905)
30214.2s 10052 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30214.2s 10053 [A
30214.2s 10054 
30214.2s 10055 Simulation finished at t = 195.0000 s after 905 steps.
30214.2s 10056 Total runtime: 0.63 seconds.
30214.2s 10057 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 23.84s/s]
30214.2s 10058 [REWARD_MICROSCOPE] step=14213 t=195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30214.2s 10059 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30214.2s 10060 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30214.2s 10061 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30214.2s 10062 Running simulation until t = 210.00 s, outputting every 15.00 s
30214.2s 10063 
30214.7s 10064 [PROGRESS] Step 950: t=204.59/210.00s (97.4%) | dt=0.2132s
30214.9s 10065 Stored output at t = 210.0000 s (Step 976)
30214.9s 10066 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30214.9s 10067 [A
30214.9s 10068 
30214.9s 10069 Simulation finished at t = 210.0000 s after 976 steps.
30214.9s 10070 Total runtime: 0.63 seconds.
30214.9s 10071 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.74s/s]
30214.9s 10072 [REWARD_MICROSCOPE] step=14214 t=210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30214.9s 10073 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30214.9s 10074 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30214.9s 10075 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30214.9s 10076 Running simulation until t = 225.00 s, outputting every 15.00 s
30214.9s 10077 
30215.0s 10078 [WARNING] Automatic CFL correction applied (count: 3325000):
30215.0s 10079 Calculated CFL: 0.800 > Limit: 0.500
30215.0s 10080 Original dt: 3.397193e-01 s
30215.0s 10081 Corrected dt: 2.123245e-01 s
30215.0s 10082 Correction factor: 1.6x
30215.0s 10083 Max wave speed detected: 23.55 m/s
30215.1s 10084 [PROGRESS] Step 1000: t=215.10/225.00s (95.6%) | dt=0.2124s
30215.5s 10085 Stored output at t = 225.0000 s (Step 1047)
30215.5s 10086 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30215.5s 10087 [A
30215.5s 10088 
30215.5s 10089 Simulation finished at t = 225.0000 s after 1047 steps.
30215.5s 10090 Total runtime: 0.62 seconds.
30215.5s 10091 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.03s/s]
30215.5s 10092 [REWARD_MICROSCOPE] step=14215 t=225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30215.5s 10093 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30215.5s 10094 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30215.5s 10095 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30215.5s 10096 Running simulation until t = 240.00 s, outputting every 15.00 s
30215.5s 10097 
30215.5s 10098 [PROGRESS] Step 1050: t=225.64/240.00s (94.0%) | dt=0.2129s
30215.9s 10099 [WARNING] Automatic CFL correction applied (count: 3325100):
30215.9s 10100 Calculated CFL: 0.800 > Limit: 0.500
30215.9s 10101 Original dt: 3.411064e-01 s
30215.9s 10102 Corrected dt: 2.131915e-01 s
30215.9s 10103 Correction factor: 1.6x
30215.9s 10104 Max wave speed detected: 23.45 m/s
30216.0s 10105 [PROGRESS] Step 1100: t=236.29/240.00s (98.5%) | dt=0.2133s
30216.1s 10106 Stored output at t = 240.0000 s (Step 1118)
30216.1s 10107 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30216.1s 10108 [A
30216.1s 10109 
30216.1s 10110 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.08s/s]
30216.1s 10111 Simulation finished at t = 240.0000 s after 1118 steps.
30216.1s 10112 Total runtime: 0.62 seconds.
30216.1s 10113 [REWARD_MICROSCOPE] step=14216 t=240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30216.1s 10114 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30216.1s 10115 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30216.1s 10116 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30216.1s 10117 Running simulation until t = 255.00 s, outputting every 15.00 s
30216.1s 10118 
30216.3s 10119 [PERIODIC:1000] BC_DISPATCHER [Call #13301000] current_bc_params: <class 'dict'>
30216.3s 10120 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30216.3s 10121 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30216.3s 10122 [PERIODIC:1000] BC_GPU [Call #13301000] About to launch kernel
30216.3s 10123 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30216.3s 10124 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30216.3s 10125 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30216.4s 10126 [PROGRESS] Step 1150: t=246.80/255.00s (96.8%) | dt=0.2125s
30216.7s 10127 [WARNING] Automatic CFL correction applied (count: 3325200):
30216.7s 10128 Calculated CFL: 0.800 > Limit: 0.500
30216.7s 10129 Original dt: 3.405361e-01 s
30216.7s 10130 Corrected dt: 2.128351e-01 s
30216.7s 10131 Correction factor: 1.6x
30216.7s 10132 Max wave speed detected: 23.49 m/s
30216.8s 10133 Stored output at t = 255.0000 s (Step 1189)
30216.8s 10134 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30216.8s 10135 [A
30216.8s 10136 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 24.20s/s]
30216.8s 10137 
30216.8s 10138 Simulation finished at t = 255.0000 s after 1189 steps.
30216.8s 10139 Total runtime: 0.62 seconds.
30216.8s 10140 [REWARD_MICROSCOPE] step=14217 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30216.8s 10141 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30216.8s 10142 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30216.8s 10143 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30216.8s 10144 Running simulation until t = 270.00 s, outputting every 15.00 s
30216.8s 10145 
30216.9s 10146 [PROGRESS] Step 1200: t=257.34/270.00s (95.3%) | dt=0.2129s
30217.3s 10147 [PROGRESS] Step 1250: t=268.00/270.00s (99.3%) | dt=0.2129s
30217.4s 10148 Stored output at t = 270.0000 s (Step 1260)
30217.4s 10149 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30217.4s 10150 [A
30217.4s 10151 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.85s/s]
30217.4s 10152 
30217.4s 10153 Simulation finished at t = 270.0000 s after 1260 steps.
30217.4s 10154 Total runtime: 0.63 seconds.
30217.4s 10155 [REWARD_MICROSCOPE] step=14218 t=270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30217.4s 10156 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30217.4s 10157 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30217.4s 10158 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30217.4s 10159 Running simulation until t = 285.00 s, outputting every 15.00 s
30217.4s 10160 
30217.6s 10161 [WARNING] Automatic CFL correction applied (count: 3325300):
30217.6s 10162 Calculated CFL: 0.800 > Limit: 0.500
30217.6s 10163 Original dt: 3.399493e-01 s
30217.6s 10164 Corrected dt: 2.124683e-01 s
30217.6s 10165 Correction factor: 1.6x
30217.6s 10166 Max wave speed detected: 23.53 m/s
30217.7s 10167 [PROGRESS] Step 1300: t=278.50/285.00s (97.7%) | dt=0.2126s
30218.0s 10168 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30218.0s 10169 [A
30218.0s 10170 Stored output at t = 285.0000 s (Step 1331)
30218.0s 10171 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.88s/s]
30218.0s 10172 
30218.0s 10173 Simulation finished at t = 285.0000 s after 1331 steps.
30218.0s 10174 Total runtime: 0.63 seconds.
30218.0s 10175 [REWARD_MICROSCOPE] step=14219 t=285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30218.0s 10176 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30218.0s 10177 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30218.0s 10178 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30218.0s 10179 Running simulation until t = 300.00 s, outputting every 15.00 s
30218.0s 10180 
30218.2s 10181 [PROGRESS] Step 1350: t=289.05/300.00s (96.3%) | dt=0.2130s
30218.5s 10182 [PERIODIC:1000] BC_DISPATCHER [Call #13302000] current_bc_params: <class 'dict'>
30218.5s 10183 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30218.5s 10184 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30218.5s 10185 [PERIODIC:1000] BC_GPU [Call #13302000] About to launch kernel
30218.5s 10186 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30218.5s 10187 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30218.5s 10188 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30218.5s 10189 [WARNING] Automatic CFL correction applied (count: 3325400):
30218.5s 10190 Calculated CFL: 0.800 > Limit: 0.500
30218.5s 10191 Original dt: 3.409227e-01 s
30218.5s 10192 Corrected dt: 2.130767e-01 s
30218.5s 10193 Correction factor: 1.6x
30218.5s 10194 Max wave speed detected: 23.47 m/s
30218.6s 10195 [PROGRESS] Step 1400: t=299.70/300.00s (99.9%) | dt=0.2126s
30218.6s 10196 Stored output at t = 300.0000 s (Step 1402)
30218.6s 10197 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30218.6s 10198 [A
30218.6s 10199 
30218.6s 10200 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.10s/s]
30218.6s 10201 Simulation finished at t = 300.0000 s after 1402 steps.
30218.6s 10202 Total runtime: 0.62 seconds.
30218.6s 10203 [REWARD_MICROSCOPE] step=14220 t=300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30218.6s 10204 [STEP   20] t=  300.0s | phase=0 | reward=   0.01 | total_reward=    0.20
30218.6s 10205 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30218.6s 10206 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30218.6s 10207 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30218.6s 10208 Running simulation until t = 315.00 s, outputting every 15.00 s
30218.6s 10209 
30219.1s 10210 [PROGRESS] Step 1450: t=310.20/315.00s (98.5%) | dt=0.2126s
30219.3s 10211 Stored output at t = 315.0000 s (Step 1473)
30219.3s 10212 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30219.3s 10213 [A
30219.3s 10214 
30219.3s 10215 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.75s/s]
30219.3s 10216 Simulation finished at t = 315.0000 s after 1473 steps.
30219.3s 10217 Total runtime: 0.63 seconds.
30219.3s 10218 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30219.3s 10219 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30219.3s 10220 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30219.3s 10221 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30219.3s 10222 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30219.3s 10223 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30219.3s 10224 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30219.3s 10225 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30219.3s 10226 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30219.3s 10227 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30219.3s 10228 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30219.3s 10229 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30219.3s 10230 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30219.3s 10231 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30219.3s 10232 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30219.3s 10233 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30219.3s 10234 [REWARD_MICROSCOPE] step=14221 t=315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30219.3s 10235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30219.3s 10236 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30219.3s 10237 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30219.3s 10238 Running simulation until t = 330.00 s, outputting every 15.00 s
30219.3s 10239 
30219.4s 10240 [WARNING] Automatic CFL correction applied (count: 3325500):
30219.4s 10241 Calculated CFL: 0.800 > Limit: 0.500
30219.4s 10242 Original dt: 3.407491e-01 s
30219.4s 10243 Corrected dt: 2.129682e-01 s
30219.4s 10244 Correction factor: 1.6x
30219.4s 10245 Max wave speed detected: 23.48 m/s
30219.5s 10246 [PROGRESS] Step 1500: t=320.75/330.00s (97.2%) | dt=0.2131s
30219.9s 10247 Stored output at t = 330.0000 s (Step 1544)
30219.9s 10248 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30219.9s 10249 [A
30219.9s 10250 
30219.9s 10251 Simulation finished at t = 330.0000 s after 1544 steps.
30219.9s 10252 Total runtime: 0.62 seconds.
30219.9s 10253 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.39s/s]
30219.9s 10254 [REWARD_MICROSCOPE] step=14222 t=330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30219.9s 10255 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30219.9s 10256 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30219.9s 10257 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30219.9s 10258 Running simulation until t = 345.00 s, outputting every 15.00 s
30219.9s 10259 
30220.0s 10260 [PROGRESS] Step 1550: t=331.27/345.00s (96.0%) | dt=0.2124s
30220.3s 10261 [WARNING] Automatic CFL correction applied (count: 3325600):
30220.3s 10262 Calculated CFL: 0.800 > Limit: 0.500
30220.3s 10263 Original dt: 3.401756e-01 s
30220.3s 10264 Corrected dt: 2.126097e-01 s
30220.3s 10265 Correction factor: 1.6x
30220.3s 10266 Max wave speed detected: 23.52 m/s
30220.4s 10267 [PROGRESS] Step 1600: t=341.90/345.00s (99.1%) | dt=0.2127s
30220.5s 10268 Stored output at t = 345.0000 s (Step 1615)
30220.5s 10269 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30220.5s 10270 [A
30220.5s 10271 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.86s/s]
30220.5s 10272 
30220.5s 10273 Simulation finished at t = 345.0000 s after 1615 steps.
30220.5s 10274 Total runtime: 0.63 seconds.
30220.5s 10275 [REWARD_MICROSCOPE] step=14223 t=345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30220.5s 10276 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30220.5s 10277 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30220.5s 10278 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30220.5s 10279 Running simulation until t = 360.00 s, outputting every 15.00 s
30220.5s 10280 
30220.7s 10281 [PERIODIC:1000] BC_DISPATCHER [Call #13303000] current_bc_params: <class 'dict'>
30220.7s 10282 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30220.7s 10283 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30220.7s 10284 [PERIODIC:1000] BC_GPU [Call #13303000] About to launch kernel
30220.7s 10285 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30220.7s 10286 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30220.7s 10287 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30220.9s 10288 [PROGRESS] Step 1650: t=352.45/360.00s (97.9%) | dt=0.2131s
30221.2s 10289 Stored output at t = 360.0000 s (Step 1686)
30221.2s 10290 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30221.2s 10291 [A
30221.2s 10292 
30221.2s 10293 Simulation finished at t = 360.0000 s after 1686 steps.
30221.2s 10294 Total runtime: 0.66 seconds.
30221.2s 10295 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 22.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 22.89s/s]
30221.2s 10296 [REWARD_MICROSCOPE] step=14224 t=360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30221.2s 10297 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30221.2s 10298 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30221.2s 10299 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30221.2s 10300 Running simulation until t = 375.00 s, outputting every 15.00 s
30221.2s 10301 
30221.2s 10302 [WARNING] Automatic CFL correction applied (count: 3325700):
30221.2s 10303 Calculated CFL: 0.800 > Limit: 0.500
30221.2s 10304 Original dt: 3.399530e-01 s
30221.2s 10305 Corrected dt: 2.124706e-01 s
30221.2s 10306 Correction factor: 1.6x
30221.2s 10307 Max wave speed detected: 23.53 m/s
30221.3s 10308 [PROGRESS] Step 1700: t=362.97/375.00s (96.8%) | dt=0.2123s
30221.7s 10309 [PROGRESS] Step 1750: t=373.60/375.00s (99.6%) | dt=0.2128s
30221.8s 10310 Stored output at t = 375.0000 s (Step 1757)
30221.8s 10311 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30221.8s 10312 [A
30221.8s 10313 
30221.8s 10314 Simulation finished at t = 375.0000 s after 1757 steps.
30221.8s 10315 Total runtime: 0.61 seconds.
30221.8s 10316 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.52s/s]
30221.8s 10317 [REWARD_MICROSCOPE] step=14225 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30221.8s 10318 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30221.8s 10319 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30221.8s 10320 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30221.8s 10321 Running simulation until t = 390.00 s, outputting every 15.00 s
30221.8s 10322 
30222.1s 10323 [WARNING] Automatic CFL correction applied (count: 3325800):
30222.1s 10324 Calculated CFL: 0.800 > Limit: 0.500
30222.1s 10325 Original dt: 3.409728e-01 s
30222.1s 10326 Corrected dt: 2.131080e-01 s
30222.1s 10327 Correction factor: 1.6x
30222.1s 10328 Max wave speed detected: 23.46 m/s
30222.2s 10329 [PROGRESS] Step 1800: t=384.16/390.00s (98.5%) | dt=0.2132s
30222.4s 10330 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30222.4s 10331 [A
30222.4s 10332 Stored output at t = 390.0000 s (Step 1828)
30222.4s 10333 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.11s/s]
30222.4s 10334 
30222.4s 10335 Simulation finished at t = 390.0000 s after 1828 steps.
30222.4s 10336 Total runtime: 0.62 seconds.
30222.4s 10337 [REWARD_MICROSCOPE] step=14226 t=390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30222.4s 10338 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30222.4s 10339 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30222.4s 10340 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30222.4s 10341 Running simulation until t = 405.00 s, outputting every 15.00 s
30222.4s 10342 
30222.6s 10343 [PROGRESS] Step 1850: t=394.67/405.00s (97.4%) | dt=0.2124s
30222.9s 10344 [PERIODIC:1000] BC_DISPATCHER [Call #13304000] current_bc_params: <class 'dict'>
30222.9s 10345 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30222.9s 10346 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30222.9s 10347 [PERIODIC:1000] BC_GPU [Call #13304000] About to launch kernel
30222.9s 10348 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30222.9s 10349 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30222.9s 10350 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30223.0s 10351 [WARNING] Automatic CFL correction applied (count: 3325900):
30223.0s 10352 Calculated CFL: 0.800 > Limit: 0.500
30223.0s 10353 Original dt: 3.403992e-01 s
30223.0s 10354 Corrected dt: 2.127495e-01 s
30223.0s 10355 Correction factor: 1.6x
30223.0s 10356 Max wave speed detected: 23.50 m/s
30223.1s 10357 Stored output at t = 405.0000 s (Step 1899)
30223.1s 10358 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30223.1s 10359 [A
30223.1s 10360 
30223.1s 10361 Simulation finished at t = 405.0000 s after 1899 steps.
30223.1s 10362 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.78s/s]
30223.1s 10363 Total runtime: 0.63 seconds.
30223.1s 10364 [REWARD_MICROSCOPE] step=14227 t=405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30223.1s 10365 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30223.1s 10366 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30223.1s 10367 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30223.1s 10368 Running simulation until t = 420.00 s, outputting every 15.00 s
30223.1s 10369 
30223.1s 10370 [PROGRESS] Step 1900: t=405.21/420.00s (96.5%) | dt=0.2128s
30223.5s 10371 [PROGRESS] Step 1950: t=415.87/420.00s (99.0%) | dt=0.2133s
30223.7s 10372 Stored output at t = 420.0000 s (Step 1970)
30223.7s 10373 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30223.7s 10374 [A
30223.7s 10375 
30223.7s 10376 Simulation finished at t = 420.0000 s after 1970 steps.
30223.7s 10377 Total runtime: 0.62 seconds.
30223.7s 10378 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.40s/s]
30223.7s 10379 [REWARD_MICROSCOPE] step=14228 t=420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30223.7s 10380 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30223.7s 10381 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30223.7s 10382 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30223.7s 10383 Running simulation until t = 435.00 s, outputting every 15.00 s
30223.7s 10384 
30223.8s 10385 [WARNING] Automatic CFL correction applied (count: 3326000):
30223.8s 10386 Calculated CFL: 0.800 > Limit: 0.500
30223.8s 10387 Original dt: 3.397973e-01 s
30223.8s 10388 Corrected dt: 2.123733e-01 s
30223.8s 10389 Correction factor: 1.6x
30223.8s 10390 Max wave speed detected: 23.54 m/s
30223.9s 10391 [PROGRESS] Step 2000: t=426.37/435.00s (98.0%) | dt=0.2125s
30224.3s 10392 Stored output at t = 435.0000 s (Step 2041)
30224.3s 10393 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30224.3s 10394 [A
30224.3s 10395 
30224.3s 10396 Simulation finished at t = 435.0000 s after 2041 steps.
30224.3s 10397 Total runtime: 0.62 seconds.
30224.3s 10398 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.11s/s]
30224.3s 10399 [REWARD_MICROSCOPE] step=14229 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30224.3s 10400 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30224.3s 10401 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30224.3s 10402 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30224.3s 10403 Running simulation until t = 450.00 s, outputting every 15.00 s
30224.3s 10404 
30224.4s 10405 [PROGRESS] Step 2050: t=436.92/450.00s (97.1%) | dt=0.2129s
30224.7s 10406 [WARNING] Automatic CFL correction applied (count: 3326100):
30224.7s 10407 Calculated CFL: 0.800 > Limit: 0.500
30224.7s 10408 Original dt: 3.411876e-01 s
30224.7s 10409 Corrected dt: 2.132423e-01 s
30224.7s 10410 Correction factor: 1.6x
30224.7s 10411 Max wave speed detected: 23.45 m/s
30224.8s 10412 [PROGRESS] Step 2100: t=447.57/450.00s (99.5%) | dt=0.2130s
30224.9s 10413 Stored output at t = 450.0000 s (Step 2112)
30224.9s 10414 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30224.9s 10415 [A
30224.9s 10416 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.13s/s]
30224.9s 10417 
30224.9s 10418 Simulation finished at t = 450.0000 s after 2112 steps.
30224.9s 10419 Total runtime: 0.62 seconds.
30224.9s 10420 [REWARD_MICROSCOPE] step=14230 t=450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30224.9s 10421 [STEP   30] t=  450.0s | phase=0 | reward=   0.01 | total_reward=    0.30
30224.9s 10422 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30224.9s 10423 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30224.9s 10424 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30224.9s 10425 Running simulation until t = 465.00 s, outputting every 15.00 s
30224.9s 10426 
30225.1s 10427 [PERIODIC:1000] BC_DISPATCHER [Call #13305000] current_bc_params: <class 'dict'>
30225.1s 10428 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30225.1s 10429 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30225.1s 10430 [PERIODIC:1000] BC_GPU [Call #13305000] About to launch kernel
30225.1s 10431 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30225.1s 10432 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30225.1s 10433 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30225.3s 10434 [PROGRESS] Step 2150: t=458.07/465.00s (98.5%) | dt=0.2125s
30225.6s 10435 Stored output at t = 465.0000 s (Step 2183)
30225.6s 10436 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30225.6s 10437 [A
30225.6s 10438 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.09s/s]
30225.6s 10439 
30225.6s 10440 Simulation finished at t = 465.0000 s after 2183 steps.
30225.6s 10441 Total runtime: 0.62 seconds.
30225.6s 10442 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30225.6s 10443 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30225.6s 10444 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30225.6s 10445 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30225.6s 10446 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30225.6s 10447 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30225.6s 10448 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30225.6s 10449 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30225.6s 10450 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30225.6s 10451 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30225.6s 10452 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30225.6s 10453 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30225.6s 10454 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30225.6s 10455 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30225.6s 10456 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30225.6s 10457 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30225.6s 10458 [REWARD_MICROSCOPE] step=14231 t=465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30225.6s 10459 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30225.6s 10460 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30225.6s 10461 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30225.6s 10462 Running simulation until t = 480.00 s, outputting every 15.00 s
30225.6s 10463 
30225.6s 10464 [WARNING] Automatic CFL correction applied (count: 3326200):
30225.6s 10465 Calculated CFL: 0.800 > Limit: 0.500
30225.6s 10466 Original dt: 3.406104e-01 s
30225.6s 10467 Corrected dt: 2.128815e-01 s
30225.6s 10468 Correction factor: 1.6x
30225.6s 10469 Max wave speed detected: 23.49 m/s
30225.7s 10470 [PROGRESS] Step 2200: t=468.62/480.00s (97.6%) | dt=0.2130s
30226.2s 10471 [PROGRESS] Step 2250: t=479.27/480.00s (99.8%) | dt=0.2127s
30226.2s 10472 Stored output at t = 480.0000 s (Step 2254)
30226.2s 10473 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30226.2s 10474 [A
30226.2s 10475 
30226.2s 10476 Simulation finished at t = 480.0000 s after 2254 steps.
30226.2s 10477 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.68s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.67s/s]
30226.2s 10478 Total runtime: 0.63 seconds.
30226.2s 10479 [REWARD_MICROSCOPE] step=14232 t=480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30226.2s 10480 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30226.2s 10481 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30226.2s 10482 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30226.2s 10483 Running simulation until t = 495.00 s, outputting every 15.00 s
30226.2s 10484 
30226.5s 10485 [WARNING] Automatic CFL correction applied (count: 3326300):
30226.5s 10486 Calculated CFL: 0.800 > Limit: 0.500
30226.5s 10487 Original dt: 3.400365e-01 s
30226.5s 10488 Corrected dt: 2.125228e-01 s
30226.5s 10489 Correction factor: 1.6x
30226.5s 10490 Max wave speed detected: 23.53 m/s
30226.6s 10491 [PROGRESS] Step 2300: t=489.77/495.00s (98.9%) | dt=0.2126s
30226.8s 10492 Stored output at t = 495.0000 s (Step 2325)
30226.8s 10493 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30226.8s 10494 [A
30226.8s 10495 
30226.8s 10496 Simulation finished at t = 495.0000 s after 2325 steps.
30226.8s 10497 Total runtime: 0.62 seconds.
30226.8s 10498 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.30s/s]
30226.8s 10499 [REWARD_MICROSCOPE] step=14233 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30226.8s 10500 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30226.8s 10501 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30226.8s 10502 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30226.8s 10503 Running simulation until t = 510.00 s, outputting every 15.00 s
30226.8s 10504 
30227.0s 10505 [PROGRESS] Step 2350: t=500.32/510.00s (98.1%) | dt=0.2130s
30227.3s 10506 [PERIODIC:1000] BC_DISPATCHER [Call #13306000] current_bc_params: <class 'dict'>
30227.3s 10507 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30227.3s 10508 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30227.3s 10509 [PERIODIC:1000] BC_GPU [Call #13306000] About to launch kernel
30227.3s 10510 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30227.3s 10511 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30227.3s 10512 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30227.4s 10513 [WARNING] Automatic CFL correction applied (count: 3326400):
30227.4s 10514 Calculated CFL: 0.800 > Limit: 0.500
30227.4s 10515 Original dt: 3.404624e-01 s
30227.4s 10516 Corrected dt: 2.127890e-01 s
30227.4s 10517 Correction factor: 1.6x
30227.4s 10518 Max wave speed detected: 23.50 m/s
30227.4s 10519 Stored output at t = 510.0000 s (Step 2396)
30227.4s 10520 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30227.4s 10521 [A
30227.4s 10522 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.15s/s]
30227.4s 10523 
30227.4s 10524 Simulation finished at t = 510.0000 s after 2396 steps.
30227.4s 10525 Total runtime: 0.62 seconds.
30227.4s 10526 [REWARD_MICROSCOPE] step=14234 t=510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30227.4s 10527 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30227.4s 10528 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30227.4s 10529 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30227.4s 10530 Running simulation until t = 525.00 s, outputting every 15.00 s
30227.4s 10531 
30227.5s 10532 [PROGRESS] Step 2400: t=510.85/525.00s (97.3%) | dt=0.2124s
30227.9s 10533 [PROGRESS] Step 2450: t=521.47/525.00s (99.3%) | dt=0.2127s
30228.1s 10534 Stored output at t = 525.0000 s (Step 2467)
30228.1s 10535 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30228.1s 10536 [A
30228.1s 10537 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.36s/s]
30228.1s 10538 
30228.1s 10539 Simulation finished at t = 525.0000 s after 2467 steps.
30228.1s 10540 Total runtime: 0.64 seconds.
30228.1s 10541 [REWARD_MICROSCOPE] step=14235 t=525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30228.1s 10542 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30228.1s 10543 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30228.1s 10544 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30228.1s 10545 Running simulation until t = 540.00 s, outputting every 15.00 s
30228.1s 10546 
30228.3s 10547 [WARNING] Automatic CFL correction applied (count: 3326500):
30228.3s 10548 Calculated CFL: 0.800 > Limit: 0.500
30228.3s 10549 Original dt: 3.408331e-01 s
30228.3s 10550 Corrected dt: 2.130207e-01 s
30228.3s 10551 Correction factor: 1.6x
30228.3s 10552 Max wave speed detected: 23.47 m/s
30228.4s 10553 [PROGRESS] Step 2500: t=532.03/540.00s (98.5%) | dt=0.2131s
30228.7s 10554 Stored output at t = 540.0000 s (Step 2538)
30228.7s 10555 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30228.7s 10556 [A
30228.7s 10557 
30228.7s 10558 Simulation finished at t = 540.0000 s after 2538 steps.
30228.7s 10559 Total runtime: 0.65 seconds.
30228.7s 10560 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 23.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 23.02s/s]
30228.7s 10561 [REWARD_MICROSCOPE] step=14236 t=540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30228.7s 10562 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30228.7s 10563 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30228.7s 10564 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30228.7s 10565 Running simulation until t = 555.00 s, outputting every 15.00 s
30228.7s 10566 
30228.8s 10567 [PROGRESS] Step 2550: t=542.55/555.00s (97.8%) | dt=0.2123s
30229.2s 10568 [WARNING] Automatic CFL correction applied (count: 3326600):
30229.2s 10569 Calculated CFL: 0.800 > Limit: 0.500
30229.2s 10570 Original dt: 3.402592e-01 s
30229.2s 10571 Corrected dt: 2.126620e-01 s
30229.2s 10572 Correction factor: 1.6x
30229.2s 10573 Max wave speed detected: 23.51 m/s
30229.3s 10574 [PROGRESS] Step 2600: t=553.18/555.00s (99.7%) | dt=0.2128s
30229.4s 10575 Stored output at t = 555.0000 s (Step 2609)
30229.4s 10576 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30229.4s 10577 [A
30229.4s 10578 
30229.4s 10579 Simulation finished at t = 555.0000 s after 2609 steps.
30229.4s 10580 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.10s/s]
30229.4s 10581 Total runtime: 0.62 seconds.
30229.4s 10582 [REWARD_MICROSCOPE] step=14237 t=555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30229.4s 10583 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30229.4s 10584 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30229.4s 10585 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30229.4s 10586 Running simulation until t = 570.00 s, outputting every 15.00 s
30229.4s 10587 
30229.6s 10588 [PERIODIC:1000] BC_DISPATCHER [Call #13307000] current_bc_params: <class 'dict'>
30229.6s 10589 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30229.6s 10590 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30229.6s 10591 [PERIODIC:1000] BC_GPU [Call #13307000] About to launch kernel
30229.6s 10592 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30229.6s 10593 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30229.6s 10594 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30229.7s 10595 [PROGRESS] Step 2650: t=563.73/570.00s (98.9%) | dt=0.2132s
30230.0s 10596 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30230.0s 10597 [A
30230.0s 10598 Stored output at t = 570.0000 s (Step 2680)
30230.0s 10599 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.21s/s]
30230.0s 10600 
30230.0s 10601 Simulation finished at t = 570.0000 s after 2680 steps.
30230.0s 10602 Total runtime: 0.62 seconds.
30230.0s 10603 [REWARD_MICROSCOPE] step=14238 t=570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30230.0s 10604 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30230.0s 10605 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30230.0s 10606 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30230.0s 10607 Running simulation until t = 585.00 s, outputting every 15.00 s
30230.0s 10608 
30230.1s 10609 [WARNING] Automatic CFL correction applied (count: 3326700):
30230.1s 10610 Calculated CFL: 0.800 > Limit: 0.500
30230.1s 10611 Original dt: 3.397413e-01 s
30230.1s 10612 Corrected dt: 2.123383e-01 s
30230.1s 10613 Correction factor: 1.6x
30230.1s 10614 Max wave speed detected: 23.55 m/s
30230.2s 10615 [PROGRESS] Step 2700: t=574.25/585.00s (98.2%) | dt=0.2124s
30230.6s 10616 [PROGRESS] Step 2750: t=584.88/585.00s (100.0%) | dt=0.2128s
30230.6s 10617 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30230.6s 10618 Stored output at t = 585.0000 s (Step 2751)
30230.6s 10619 [A
30230.6s 10620 
30230.6s 10621 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.30s/s]
30230.6s 10622 Simulation finished at t = 585.0000 s after 2751 steps.
30230.6s 10623 Total runtime: 0.62 seconds.
30230.6s 10624 [REWARD_MICROSCOPE] step=14239 t=585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30230.6s 10625 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30230.6s 10626 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30230.6s 10627 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30230.6s 10628 Running simulation until t = 600.00 s, outputting every 15.00 s
30230.6s 10629 
30231.0s 10630 [WARNING] Automatic CFL correction applied (count: 3326800):
30231.0s 10631 Calculated CFL: 0.800 > Limit: 0.500
30231.0s 10632 Original dt: 3.410527e-01 s
30231.0s 10633 Corrected dt: 2.131579e-01 s
30231.0s 10634 Correction factor: 1.6x
30231.0s 10635 Max wave speed detected: 23.46 m/s
30231.1s 10636 [PROGRESS] Step 2800: t=595.44/600.00s (99.2%) | dt=0.2133s
30231.2s 10637 Stored output at t = 600.0000 s (Step 2822)
30231.2s 10638 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30231.2s 10639 [A
30231.3s 10640 
30231.3s 10641 Simulation finished at t = 600.0000 s after 2822 steps.
30231.3s 10642 Total runtime: 0.64 seconds.
30231.3s 10643 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 23.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 23.35s/s]
30231.3s 10644 [REWARD_MICROSCOPE] step=14240 t=600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30231.3s 10645 [STEP   40] t=  600.0s | phase=0 | reward=   0.01 | total_reward=    0.40
30231.3s 10646 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30231.3s 10647 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30231.3s 10648 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30231.3s 10649 Running simulation until t = 615.00 s, outputting every 15.00 s
30231.3s 10650 
30231.5s 10651 [PROGRESS] Step 2850: t=605.95/615.00s (98.5%) | dt=0.2125s
30231.8s 10652 [PERIODIC:1000] BC_DISPATCHER [Call #13308000] current_bc_params: <class 'dict'>
30231.8s 10653 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30231.8s 10654 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30231.8s 10655 [PERIODIC:1000] BC_GPU [Call #13308000] About to launch kernel
30231.8s 10656 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30231.8s 10657 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30231.8s 10658 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30231.8s 10659 [WARNING] Automatic CFL correction applied (count: 3326900):
30231.8s 10660 Calculated CFL: 0.800 > Limit: 0.500
30231.8s 10661 Original dt: 3.404818e-01 s
30231.8s 10662 Corrected dt: 2.128011e-01 s
30231.8s 10663 Correction factor: 1.6x
30231.8s 10664 Max wave speed detected: 23.50 m/s
30231.9s 10665 Stored output at t = 615.0000 s (Step 2893)
30231.9s 10666 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 600.0/615.0 [00:00<?, ?s/s][A
30231.9s 10667 [A
30231.9s 10668 
30231.9s 10669 Simulation finished at t = 615.0000 s after 2893 steps.
30231.9s 10670 Total runtime: 0.63 seconds.
30231.9s 10671 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.82s/s]
30231.9s 10672 [QUEUE_DIAGNOSTIC] ===== Step 40 t=615.0s =====
30231.9s 10673 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30231.9s 10674 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30231.9s 10675 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30231.9s 10676 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30231.9s 10677 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30231.9s 10678 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30231.9s 10679 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30231.9s 10680 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30231.9s 10681 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30231.9s 10682 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30231.9s 10683 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30231.9s 10684 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30231.9s 10685 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30231.9s 10686 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30231.9s 10687 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30231.9s 10688 [REWARD_MICROSCOPE] step=14241 t=615.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30231.9s 10689 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30231.9s 10690 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30231.9s 10691 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30231.9s 10692 Running simulation until t = 630.00 s, outputting every 15.00 s
30231.9s 10693 
30231.9s 10694 [PROGRESS] Step 2900: t=616.49/630.00s (97.9%) | dt=0.2129s
30232.4s 10695 [PROGRESS] Step 2950: t=627.15/630.00s (99.5%) | dt=0.2131s
30232.5s 10696 Stored output at t = 630.0000 s (Step 2964)
30232.5s 10697 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 615.0/630.0 [00:00<?, ?s/s][A
30232.5s 10698 [A
30232.5s 10699 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.09s/s]
30232.5s 10700 
30232.5s 10701 Simulation finished at t = 630.0000 s after 2964 steps.
30232.5s 10702 Total runtime: 0.62 seconds.
30232.5s 10703 [REWARD_MICROSCOPE] step=14242 t=630.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30232.5s 10704 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30232.5s 10705 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30232.5s 10706 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30232.5s 10707 Running simulation until t = 645.00 s, outputting every 15.00 s
30232.5s 10708 
30232.8s 10709 [WARNING] Automatic CFL correction applied (count: 3327000):
30232.8s 10710 Calculated CFL: 0.800 > Limit: 0.500
30232.8s 10711 Original dt: 3.398890e-01 s
30232.8s 10712 Corrected dt: 2.124306e-01 s
30232.8s 10713 Correction factor: 1.6x
30232.8s 10714 Max wave speed detected: 23.54 m/s
30232.9s 10715 [PROGRESS] Step 3000: t=637.65/645.00s (98.9%) | dt=0.2125s
30233.2s 10716 Stored output at t = 645.0000 s (Step 3035)
30233.2s 10717 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 630.0/645.0 [00:00<?, ?s/s][A
30233.2s 10718 [A
30233.2s 10719 
30233.2s 10720 Simulation finished at t = 645.0000 s after 3035 steps.
30233.2s 10721 Total runtime: 0.67 seconds.
30233.2s 10722 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 22.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 22.32s/s]
30233.2s 10723 [REWARD_MICROSCOPE] step=14243 t=645.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30233.2s 10724 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30233.2s 10725 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30233.2s 10726 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30233.2s 10727 Running simulation until t = 660.00 s, outputting every 15.00 s
30233.2s 10728 
30233.3s 10729 [PROGRESS] Step 3050: t=648.19/660.00s (98.2%) | dt=0.2130s
30233.6s 10730 [WARNING] Automatic CFL correction applied (count: 3327100):
30233.6s 10731 Calculated CFL: 0.800 > Limit: 0.500
30233.6s 10732 Original dt: 3.412697e-01 s
30233.6s 10733 Corrected dt: 2.132935e-01 s
30233.6s 10734 Correction factor: 1.6x
30233.6s 10735 Max wave speed detected: 23.44 m/s
30233.7s 10736 [PROGRESS] Step 3100: t=658.85/660.00s (99.8%) | dt=0.2127s
30233.8s 10737 Stored output at t = 660.0000 s (Step 3106)
30233.8s 10738 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 645.0/660.0 [00:00<?, ?s/s][A
30233.8s 10739 [A
30233.8s 10740 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.68s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.67s/s]
30233.8s 10741 
30233.8s 10742 Simulation finished at t = 660.0000 s after 3106 steps.
30233.8s 10743 Total runtime: 0.61 seconds.
30233.8s 10744 [REWARD_MICROSCOPE] step=14244 t=660.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30233.8s 10745 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30233.8s 10746 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30233.8s 10747 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30233.8s 10748 Running simulation until t = 675.00 s, outputting every 15.00 s
30233.8s 10749 
30234.0s 10750 [PERIODIC:1000] BC_DISPATCHER [Call #13309000] current_bc_params: <class 'dict'>
30234.0s 10751 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30234.0s 10752 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30234.0s 10753 [PERIODIC:1000] BC_GPU [Call #13309000] About to launch kernel
30234.0s 10754 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30234.0s 10755 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30234.0s 10756 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30234.2s 10757 [PROGRESS] Step 3150: t=669.35/675.00s (99.2%) | dt=0.2126s
30234.4s 10758 Stored output at t = 675.0000 s (Step 3177)
30234.4s 10759 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 660.0/675.0 [00:00<?, ?s/s][A
30234.4s 10760 [A
30234.4s 10761 
30234.4s 10762 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.19s/s]
30234.4s 10763 Simulation finished at t = 675.0000 s after 3177 steps.
30234.4s 10764 Total runtime: 0.62 seconds.
30234.4s 10765 [REWARD_MICROSCOPE] step=14245 t=675.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30234.4s 10766 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30234.4s 10767 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30234.4s 10768 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30234.4s 10769 Running simulation until t = 690.00 s, outputting every 15.00 s
30234.4s 10770 
30234.5s 10771 [WARNING] Automatic CFL correction applied (count: 3327200):
30234.5s 10772 Calculated CFL: 0.800 > Limit: 0.500
30234.5s 10773 Original dt: 3.406934e-01 s
30234.5s 10774 Corrected dt: 2.129334e-01 s
30234.5s 10775 Correction factor: 1.6x
30234.5s 10776 Max wave speed detected: 23.48 m/s
30234.6s 10777 [PROGRESS] Step 3200: t=679.90/690.00s (98.5%) | dt=0.2130s
30235.0s 10778 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 675.0/690.0 [00:00<?, ?s/s][A
30235.0s 10779 [A
30235.0s 10780 Stored output at t = 690.0000 s (Step 3248)
30235.0s 10781 
30235.0s 10782 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.25s/s]
30235.0s 10783 Simulation finished at t = 690.0000 s after 3248 steps.
30235.0s 10784 Total runtime: 0.62 seconds.
30235.0s 10785 [REWARD_MICROSCOPE] step=14246 t=690.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30235.0s 10786 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30235.0s 10787 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30235.0s 10788 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30235.0s 10789 Running simulation until t = 705.00 s, outputting every 15.00 s
30235.0s 10790 
30235.1s 10791 [PROGRESS] Step 3250: t=690.43/705.00s (97.9%) | dt=0.2125s
30235.4s 10792 [WARNING] Automatic CFL correction applied (count: 3327300):
30235.4s 10793 Calculated CFL: 0.800 > Limit: 0.500
30235.4s 10794 Original dt: 3.401199e-01 s
30235.4s 10795 Corrected dt: 2.125749e-01 s
30235.4s 10796 Correction factor: 1.6x
30235.4s 10797 Max wave speed detected: 23.52 m/s
30235.5s 10798 [PROGRESS] Step 3300: t=701.05/705.00s (99.4%) | dt=0.2127s
30235.7s 10799 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 690.0/705.0 [00:00<?, ?s/s][A
30235.7s 10800 Stored output at t = 705.0000 s (Step 3319)
30235.7s 10801 [A
30235.7s 10802 
30235.7s 10803 Simulation finished at t = 705.0000 s after 3319 steps.
30235.7s 10804 Total runtime: 0.62 seconds.
30235.7s 10805 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 24.28s/s]
30235.7s 10806 [REWARD_MICROSCOPE] step=14247 t=705.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30235.7s 10807 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30235.7s 10808 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30235.7s 10809 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30235.7s 10810 Running simulation until t = 720.00 s, outputting every 15.00 s
30235.7s 10811 
30235.9s 10812 [PROGRESS] Step 3350: t=711.60/720.00s (98.8%) | dt=0.2131s
30236.2s 10813 [PERIODIC:1000] BC_DISPATCHER [Call #13310000] current_bc_params: <class 'dict'>
30236.2s 10814 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30236.2s 10815 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30236.2s 10816 [PERIODIC:1000] BC_GPU [Call #13310000] About to launch kernel
30236.2s 10817 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30236.2s 10818 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30236.2s 10819 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30236.3s 10820 [WARNING] Automatic CFL correction applied (count: 3327400):
30236.3s 10821 Calculated CFL: 0.800 > Limit: 0.500
30236.3s 10822 Original dt: 3.401129e-01 s
30236.3s 10823 Corrected dt: 2.125705e-01 s
30236.3s 10824 Correction factor: 1.6x
30236.3s 10825 Max wave speed detected: 23.52 m/s
30236.3s 10826 Stored output at t = 720.0000 s (Step 3390)
30236.3s 10827 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 705.0/720.0 [00:00<?, ?s/s][A
30236.3s 10828 [A
30236.3s 10829 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.84s/s]
30236.3s 10830 
30236.3s 10831 Simulation finished at t = 720.0000 s after 3390 steps.
30236.3s 10832 Total runtime: 0.63 seconds.
30236.3s 10833 [REWARD_MICROSCOPE] step=14248 t=720.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30236.3s 10834 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30236.3s 10835 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30236.3s 10836 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30236.3s 10837 Running simulation until t = 735.00 s, outputting every 15.00 s
30236.3s 10838 
30236.4s 10839 [PROGRESS] Step 3400: t=722.12/735.00s (98.2%) | dt=0.2123s
30236.8s 10840 [PROGRESS] Step 3450: t=732.75/735.00s (99.7%) | dt=0.2127s
30236.9s 10841 Stored output at t = 735.0000 s (Step 3461)
30236.9s 10842 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 720.0/735.0 [00:00<?, ?s/s][A
30236.9s 10843 [A
30236.9s 10844 
30236.9s 10845 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.43s/s]
30236.9s 10846 Simulation finished at t = 735.0000 s after 3461 steps.
30236.9s 10847 Total runtime: 0.61 seconds.
30236.9s 10848 [REWARD_MICROSCOPE] step=14249 t=735.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30236.9s 10849 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30236.9s 10850 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30236.9s 10851 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30236.9s 10852 Running simulation until t = 750.00 s, outputting every 15.00 s
30236.9s 10853 
30237.2s 10854 [WARNING] Automatic CFL correction applied (count: 3327500):
30237.2s 10855 Calculated CFL: 0.800 > Limit: 0.500
30237.2s 10856 Original dt: 3.409178e-01 s
30237.2s 10857 Corrected dt: 2.130736e-01 s
30237.2s 10858 Correction factor: 1.6x
30237.2s 10859 Max wave speed detected: 23.47 m/s
30237.3s 10860 [PROGRESS] Step 3500: t=743.31/750.00s (99.1%) | dt=0.2132s
30237.5s 10861 Stored output at t = 750.0000 s (Step 3532)
30237.5s 10862 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 735.0/750.0 [00:00<?, ?s/s][A
30237.5s 10863 [A
30237.5s 10864 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.83s/s]
30237.5s 10865 
30237.5s 10866 Simulation finished at t = 750.0000 s after 3532 steps.
30237.5s 10867 Total runtime: 0.63 seconds.
30237.5s 10868 [REWARD_MICROSCOPE] step=14250 t=750.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30237.5s 10869 [STEP   50] t=  750.0s | phase=0 | reward=   0.01 | total_reward=    0.50
30237.5s 10870 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30237.5s 10871 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30237.5s 10872 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30237.5s 10873 Running simulation until t = 765.00 s, outputting every 15.00 s
30237.5s 10874 
30237.7s 10875 [PROGRESS] Step 3550: t=753.82/765.00s (98.5%) | dt=0.2124s
30238.0s 10876 [WARNING] Automatic CFL correction applied (count: 3327600):
30238.0s 10877 Calculated CFL: 0.800 > Limit: 0.500
30238.0s 10878 Original dt: 3.403431e-01 s
30238.0s 10879 Corrected dt: 2.127144e-01 s
30238.0s 10880 Correction factor: 1.6x
30238.0s 10881 Max wave speed detected: 23.51 m/s
30238.1s 10882 [PROGRESS] Step 3600: t=764.45/765.00s (99.9%) | dt=0.2128s
30238.2s 10883 Stored output at t = 765.0000 s (Step 3603)
30238.2s 10884 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 750.0/765.0 [00:00<?, ?s/s][A
30238.2s 10885 [A
30238.2s 10886 
30238.2s 10887 Simulation finished at t = 765.0000 s after 3603 steps.
30238.2s 10888 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.75s/s]
30238.2s 10889 Total runtime: 0.63 seconds.
30238.2s 10890 [QUEUE_DIAGNOSTIC] ===== Step 50 t=765.0s =====
30238.2s 10891 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30238.2s 10892 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30238.2s 10893 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30238.2s 10894 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30238.2s 10895 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30238.2s 10896 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30238.2s 10897 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30238.2s 10898 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30238.2s 10899 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30238.2s 10900 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30238.2s 10901 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30238.2s 10902 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30238.2s 10903 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30238.2s 10904 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30238.2s 10905 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30238.2s 10906 [REWARD_MICROSCOPE] step=14251 t=765.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30238.2s 10907 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30238.2s 10908 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30238.2s 10909 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30238.2s 10910 Running simulation until t = 780.00 s, outputting every 15.00 s
30238.2s 10911 
30238.4s 10912 [PERIODIC:1000] BC_DISPATCHER [Call #13311000] current_bc_params: <class 'dict'>
30238.4s 10913 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30238.4s 10914 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30238.4s 10915 [PERIODIC:1000] BC_GPU [Call #13311000] About to launch kernel
30238.4s 10916 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30238.4s 10917 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30238.4s 10918 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30238.6s 10919 [PROGRESS] Step 3650: t=775.01/780.00s (99.4%) | dt=0.2132s
30238.8s 10920 Stored output at t = 780.0000 s (Step 3674)
30238.8s 10921 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 765.0/780.0 [00:00<?, ?s/s][A
30238.8s 10922 [A
30238.8s 10923 
30238.8s 10924 Simulation finished at t = 780.0000 s after 3674 steps.
30238.8s 10925 Total runtime: 0.62 seconds.
30238.8s 10926 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 24.35s/s]
30238.8s 10927 [REWARD_MICROSCOPE] step=14252 t=780.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30238.8s 10928 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30238.8s 10929 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30238.8s 10930 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30238.8s 10931 Running simulation until t = 795.00 s, outputting every 15.00 s
30238.8s 10932 
30238.9s 10933 [WARNING] Automatic CFL correction applied (count: 3327700):
30238.9s 10934 Calculated CFL: 0.800 > Limit: 0.500
30238.9s 10935 Original dt: 3.397401e-01 s
30238.9s 10936 Corrected dt: 2.123376e-01 s
30238.9s 10937 Correction factor: 1.6x
30238.9s 10938 Max wave speed detected: 23.55 m/s
30239.0s 10939 [PROGRESS] Step 3700: t=785.52/795.00s (98.8%) | dt=0.2124s
30239.4s 10940 Stored output at t = 795.0000 s (Step 3745)
30239.4s 10941 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 780.0/795.0 [00:00<?, ?s/s][A
30239.4s 10942 [A
30239.4s 10943 
30239.4s 10944 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.21s/s]
30239.4s 10945 Simulation finished at t = 795.0000 s after 3745 steps.
30239.4s 10946 Total runtime: 0.62 seconds.
30239.4s 10947 [REWARD_MICROSCOPE] step=14253 t=795.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30239.4s 10948 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30239.4s 10949 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30239.4s 10950 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30239.4s 10951 Running simulation until t = 810.00 s, outputting every 15.00 s
30239.4s 10952 
30239.5s 10953 [PROGRESS] Step 3750: t=796.06/810.00s (98.3%) | dt=0.2129s
30239.8s 10954 [WARNING] Automatic CFL correction applied (count: 3327800):
30239.8s 10955 Calculated CFL: 0.800 > Limit: 0.500
30239.8s 10956 Original dt: 3.411334e-01 s
30239.8s 10957 Corrected dt: 2.132084e-01 s
30239.8s 10958 Correction factor: 1.6x
30239.8s 10959 Max wave speed detected: 23.45 m/s
30239.9s 10960 [PROGRESS] Step 3800: t=806.72/810.00s (99.6%) | dt=0.2133s
30240.1s 10961 Stored output at t = 810.0000 s (Step 3816)
30240.1s 10962 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 795.0/810.0 [00:00<?, ?s/s][A
30240.1s 10963 [A
30240.1s 10964 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.82s/s]
30240.1s 10965 
30240.1s 10966 Simulation finished at t = 810.0000 s after 3816 steps.
30240.1s 10967 Total runtime: 0.63 seconds.
30240.1s 10968 [REWARD_MICROSCOPE] step=14254 t=810.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30240.1s 10969 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30240.1s 10970 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30240.1s 10971 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30240.1s 10972 Running simulation until t = 825.00 s, outputting every 15.00 s
30240.1s 10973 
30240.3s 10974 [PROGRESS] Step 3850: t=817.22/825.00s (99.1%) | dt=0.2125s
30240.6s 10975 [PERIODIC:1000] BC_DISPATCHER [Call #13312000] current_bc_params: <class 'dict'>
30240.6s 10976 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30240.6s 10977 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30240.6s 10978 [PERIODIC:1000] BC_GPU [Call #13312000] About to launch kernel
30240.6s 10979 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30240.6s 10980 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30240.6s 10981 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30240.7s 10982 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 810.0/825.0 [00:00<?, ?s/s][A
30240.7s 10983 [A
30240.7s 10984 Stored output at t = 825.0000 s (Step 3887)
30240.7s 10985 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 23.88s/s]
30240.7s 10986 
30240.7s 10987 Simulation finished at t = 825.0000 s after 3887 steps.
30240.7s 10988 Total runtime: 0.63 seconds.
30240.7s 10989 [REWARD_MICROSCOPE] step=14255 t=825.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30240.7s 10990 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30240.7s 10991 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30240.7s 10992 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30240.7s 10993 Running simulation until t = 840.00 s, outputting every 15.00 s
30240.7s 10994 
30240.7s 10995 [WARNING] Automatic CFL correction applied (count: 3327900):
30240.7s 10996 Calculated CFL: 0.800 > Limit: 0.500
30240.7s 10997 Original dt: 3.405553e-01 s
30240.7s 10998 Corrected dt: 2.128470e-01 s
30240.7s 10999 Correction factor: 1.6x
30240.7s 11000 Max wave speed detected: 23.49 m/s
30240.8s 11001 [PROGRESS] Step 3900: t=827.77/840.00s (98.5%) | dt=0.2129s
30241.3s 11002 [PROGRESS] Step 3950: t=838.42/840.00s (99.8%) | dt=0.2128s
30241.3s 11003 Stored output at t = 840.0000 s (Step 3958)
30241.3s 11004 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 825.0/840.0 [00:00<?, ?s/s][A
30241.3s 11005 [A
30241.3s 11006 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 23.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 23.25s/s]
30241.3s 11007 
30241.3s 11008 Simulation finished at t = 840.0000 s after 3958 steps.
30241.3s 11009 Total runtime: 0.65 seconds.
30241.3s 11010 [REWARD_MICROSCOPE] step=14256 t=840.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30241.3s 11011 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30241.3s 11012 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30241.3s 11013 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30241.3s 11014 Running simulation until t = 855.00 s, outputting every 15.00 s
30241.3s 11015 
30241.6s 11016 [WARNING] Automatic CFL correction applied (count: 3328000):
30241.6s 11017 Calculated CFL: 0.800 > Limit: 0.500
30241.6s 11018 Original dt: 3.399790e-01 s
30241.6s 11019 Corrected dt: 2.124869e-01 s
30241.6s 11020 Correction factor: 1.6x
30241.6s 11021 Max wave speed detected: 23.53 m/s
30241.7s 11022 [PROGRESS] Step 4000: t=848.92/855.00s (99.3%) | dt=0.2126s
30241.9s 11023 Stored output at t = 855.0000 s (Step 4029)
30241.9s 11024 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 840.0/855.0 [00:00<?, ?s/s][A
30241.9s 11025 [A
30241.9s 11026 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.56s/s]
30241.9s 11027 
30241.9s 11028 Simulation finished at t = 855.0000 s after 4029 steps.
30241.9s 11029 Total runtime: 0.61 seconds.
30241.9s 11030 [REWARD_MICROSCOPE] step=14257 t=855.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30241.9s 11031 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30241.9s 11032 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30241.9s 11033 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30241.9s 11034 Running simulation until t = 870.00 s, outputting every 15.00 s
30241.9s 11035 
30242.1s 11036 [PROGRESS] Step 4050: t=859.47/870.00s (98.8%) | dt=0.2130s
30242.5s 11037 [WARNING] Automatic CFL correction applied (count: 3328100):
30242.5s 11038 Calculated CFL: 0.800 > Limit: 0.500
30242.5s 11039 Original dt: 3.407550e-01 s
30242.5s 11040 Corrected dt: 2.129719e-01 s
30242.5s 11041 Correction factor: 1.6x
30242.5s 11042 Max wave speed detected: 23.48 m/s
30242.6s 11043 [PROGRESS] Step 4100: t=870.00/870.00s (100.0%) | dt=0.0883s
30242.6s 11044 Stored output at t = 870.0000 s (Step 4100)
30242.6s 11045 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 855.0/870.0 [00:00<?, ?s/s][A
30242.6s 11046 [A
30242.6s 11047 
30242.6s 11048 Simulation finished at t = 870.0000 s after 4100 steps.
30242.6s 11049 Total runtime: 0.61 seconds.
30242.6s 11050 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 24.51s/s]
30242.6s 11051 [REWARD_MICROSCOPE] step=14258 t=870.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30242.6s 11052 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30242.6s 11053 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30242.6s 11054 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30242.6s 11055 Running simulation until t = 885.00 s, outputting every 15.00 s
30242.6s 11056 
30242.8s 11057 [PERIODIC:1000] BC_DISPATCHER [Call #13313000] current_bc_params: <class 'dict'>
30242.8s 11058 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30242.8s 11059 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30242.8s 11060 [PERIODIC:1000] BC_GPU [Call #13313000] About to launch kernel
30242.8s 11061 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30242.8s 11062 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30242.8s 11063 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30243.0s 11064 [PROGRESS] Step 4150: t=880.62/885.00s (99.5%) | dt=0.2127s
30243.2s 11065 Stored output at t = 885.0000 s (Step 4171)
30243.2s 11066 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 870.0/885.0 [00:00<?, ?s/s][A
30243.2s 11067 [A
30243.2s 11068 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 24.08s/s]
30243.2s 11069 
30243.2s 11070 Simulation finished at t = 885.0000 s after 4171 steps.
30243.2s 11071 Total runtime: 0.62 seconds.
30243.2s 11072 [REWARD_MICROSCOPE] step=14259 t=885.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30243.2s 11073 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30243.2s 11074 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30243.2s 11075 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30243.2s 11076 Running simulation until t = 900.00 s, outputting every 15.00 s
30243.2s 11077 
30243.3s 11078 [WARNING] Automatic CFL correction applied (count: 3328200):
30243.3s 11079 Calculated CFL: 0.800 > Limit: 0.500
30243.3s 11080 Original dt: 3.407770e-01 s
30243.3s 11081 Corrected dt: 2.129856e-01 s
30243.3s 11082 Correction factor: 1.6x
30243.3s 11083 Max wave speed detected: 23.48 m/s
30243.4s 11084 [PROGRESS] Step 4200: t=891.18/900.00s (99.0%) | dt=0.2131s
30243.8s 11085 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 885.0/900.0 [00:00<?, ?s/s][A
30243.8s 11086 [A
30243.8s 11087 Stored output at t = 900.0000 s (Step 4242)
30243.8s 11088 
30243.8s 11089 Simulation finished at t = 900.0000 s after 4242 steps.
30243.8s 11090 Total runtime: 0.62 seconds.
30243.8s 11091 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 24.18s/s]
30243.8s 11092 [REWARD_MICROSCOPE] step=14260 t=900.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30243.8s 11093 [STEP   60] t=  900.0s | phase=0 | reward=   0.01 | total_reward=    0.60
30243.8s 11094 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30243.8s 11095 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30243.8s 11096 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30243.8s 11097 Running simulation until t = 915.00 s, outputting every 15.00 s
30243.8s 11098 
30243.9s 11099 [PROGRESS] Step 4250: t=901.70/915.00s (98.5%) | dt=0.2124s
30244.2s 11100 [WARNING] Automatic CFL correction applied (count: 3328300):
30244.2s 11101 Calculated CFL: 0.800 > Limit: 0.500
30244.2s 11102 Original dt: 3.402034e-01 s
30244.2s 11103 Corrected dt: 2.126271e-01 s
30244.2s 11104 Correction factor: 1.6x
30244.2s 11105 Max wave speed detected: 23.52 m/s
30244.3s 11106 [PROGRESS] Step 4300: t=912.32/915.00s (99.7%) | dt=0.2127s
30244.4s 11107 Stored output at t = 915.0000 s (Step 4313)
30244.4s 11108 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 900.0/915.0 [00:00<?, ?s/s][A
30244.4s 11109 [A
30244.4s 11110 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.81s/s]
30244.4s 11111 
30244.4s 11112 Simulation finished at t = 915.0000 s after 4313 steps.
30244.4s 11113 Total runtime: 0.63 seconds.
30244.4s 11114 [QUEUE_DIAGNOSTIC] ===== Step 60 t=915.0s =====
30244.4s 11115 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30244.4s 11116 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30244.4s 11117 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30244.4s 11118 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30244.4s 11119 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30244.4s 11120 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30244.4s 11121 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30244.4s 11122 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30244.4s 11123 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30244.4s 11124 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30244.4s 11125 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30244.4s 11126 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30244.4s 11127 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30244.4s 11128 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30244.4s 11129 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30244.4s 11130 [REWARD_MICROSCOPE] step=14261 t=915.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30244.4s 11131 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30244.4s 11132 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30244.4s 11133 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30244.4s 11134 Running simulation until t = 930.00 s, outputting every 15.00 s
30244.4s 11135 
30244.8s 11136 [PROGRESS] Step 4350: t=922.88/930.00s (99.2%) | dt=0.2131s
30245.1s 11137 [PERIODIC:1000] BC_DISPATCHER [Call #13314000] current_bc_params: <class 'dict'>
30245.1s 11138 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30245.1s 11139 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30245.1s 11140 [PERIODIC:1000] BC_GPU [Call #13314000] About to launch kernel
30245.1s 11141 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30245.1s 11142 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30245.1s 11143 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30245.1s 11144 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 915.0/930.0 [00:00<?, ?s/s][A
30245.1s 11145 [A
30245.1s 11146 Stored output at t = 930.0000 s (Step 4384)
30245.1s 11147 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.97s/s]
30245.1s 11148 
30245.1s 11149 Simulation finished at t = 930.0000 s after 4384 steps.
30245.1s 11150 Total runtime: 0.63 seconds.
30245.1s 11151 [REWARD_MICROSCOPE] step=14262 t=930.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30245.1s 11152 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30245.1s 11153 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30245.1s 11154 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30245.1s 11155 Running simulation until t = 945.00 s, outputting every 15.00 s
30245.1s 11156 
30245.1s 11157 [WARNING] Automatic CFL correction applied (count: 3328400):
30245.1s 11158 Calculated CFL: 0.800 > Limit: 0.500
30245.1s 11159 Original dt: 3.398708e-01 s
30245.1s 11160 Corrected dt: 2.124193e-01 s
30245.1s 11161 Correction factor: 1.6x
30245.1s 11162 Max wave speed detected: 23.54 m/s
30245.2s 11163 [PROGRESS] Step 4400: t=933.40/945.00s (98.8%) | dt=0.2123s
30245.6s 11164 [PROGRESS] Step 4450: t=944.03/945.00s (99.9%) | dt=0.2128s
30245.7s 11165 Stored output at t = 945.0000 s (Step 4455)
30245.7s 11166 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 930.0/945.0 [00:00<?, ?s/s][A
30245.7s 11167 [A
30245.7s 11168 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.18s/s]
30245.7s 11169 
30245.7s 11170 Simulation finished at t = 945.0000 s after 4455 steps.
30245.7s 11171 Total runtime: 0.62 seconds.
30245.7s 11172 [REWARD_MICROSCOPE] step=14263 t=945.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30245.7s 11173 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30245.7s 11174 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30245.7s 11175 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30245.7s 11176 Running simulation until t = 960.00 s, outputting every 15.00 s
30245.7s 11177 
30246.0s 11178 [WARNING] Automatic CFL correction applied (count: 3328500):
30246.0s 11179 Calculated CFL: 0.800 > Limit: 0.500
30246.0s 11180 Original dt: 3.409993e-01 s
30246.0s 11181 Corrected dt: 2.131246e-01 s
30246.0s 11182 Correction factor: 1.6x
30246.0s 11183 Max wave speed detected: 23.46 m/s
30246.1s 11184 [PROGRESS] Step 4500: t=954.59/960.00s (99.4%) | dt=0.2132s
30246.3s 11185 Stored output at t = 960.0000 s (Step 4526)
30246.3s 11186 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 945.0/960.0 [00:00<?, ?s/s][A
30246.3s 11187 [A
30246.3s 11188 
30246.3s 11189 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 24.02s/s]
30246.3s 11190 Simulation finished at t = 960.0000 s after 4526 steps.
30246.3s 11191 Total runtime: 0.62 seconds.
30246.3s 11192 [REWARD_MICROSCOPE] step=14264 t=960.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30246.3s 11193 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30246.3s 11194 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30246.3s 11195 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30246.3s 11196 Running simulation until t = 975.00 s, outputting every 15.00 s
30246.3s 11197 
30246.5s 11198 [PROGRESS] Step 4550: t=965.10/975.00s (99.0%) | dt=0.2124s
30246.9s 11199 [WARNING] Automatic CFL correction applied (count: 3328600):
30246.9s 11200 Calculated CFL: 0.800 > Limit: 0.500
30246.9s 11201 Original dt: 3.404274e-01 s
30246.9s 11202 Corrected dt: 2.127671e-01 s
30246.9s 11203 Correction factor: 1.6x
30246.9s 11204 Max wave speed detected: 23.50 m/s
30246.9s 11205 Stored output at t = 975.0000 s (Step 4597)
30246.9s 11206 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 960.0/975.0 [00:00<?, ?s/s][A
30246.9s 11207 [A
30246.9s 11208 
30246.9s 11209 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.35s/s]
30246.9s 11210 Simulation finished at t = 975.0000 s after 4597 steps.
30246.9s 11211 Total runtime: 0.62 seconds.
30246.9s 11212 [REWARD_MICROSCOPE] step=14265 t=975.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30246.9s 11213 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30246.9s 11214 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30246.9s 11215 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30246.9s 11216 Running simulation until t = 990.00 s, outputting every 15.00 s
30246.9s 11217 
30247.0s 11218 [PROGRESS] Step 4600: t=975.64/990.00s (98.5%) | dt=0.2129s
30247.3s 11219 [PERIODIC:1000] BC_DISPATCHER [Call #13315000] current_bc_params: <class 'dict'>
30247.3s 11220 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30247.3s 11221 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30247.3s 11222 [PERIODIC:1000] BC_GPU [Call #13315000] About to launch kernel
30247.3s 11223 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30247.3s 11224 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30247.3s 11225 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30247.4s 11226 [PROGRESS] Step 4650: t=986.29/990.00s (99.6%) | dt=0.2133s
30247.6s 11227 Stored output at t = 990.0000 s (Step 4668)
30247.6s 11228 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975.0/990.0 [00:00<?, ?s/s][A
30247.6s 11229 [A
30247.6s 11230 
30247.6s 11231 Simulation finished at t = 990.0000 s after 4668 steps.
30247.6s 11232 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.04s/s]
30247.6s 11233 Total runtime: 0.62 seconds.
30247.6s 11234 [REWARD_MICROSCOPE] step=14266 t=990.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30247.6s 11235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30247.6s 11236 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30247.6s 11237 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30247.6s 11238 Running simulation until t = 1005.00 s, outputting every 15.00 s
30247.6s 11239 
30247.7s 11240 [WARNING] Automatic CFL correction applied (count: 3328700):
30247.7s 11241 Calculated CFL: 0.800 > Limit: 0.500
30247.7s 11242 Original dt: 3.398278e-01 s
30247.7s 11243 Corrected dt: 2.123924e-01 s
30247.7s 11244 Correction factor: 1.6x
30247.7s 11245 Max wave speed detected: 23.54 m/s
30247.8s 11246 [PROGRESS] Step 4700: t=996.80/1005.00s (99.2%) | dt=0.2125s
30248.2s 11247 Stored output at t = 1005.0000 s (Step 4739)
30248.2s 11248 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 990.0/1005.0 [00:00<?, ?s/s][A
30248.2s 11249 [A
30248.2s 11250 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.28s/s]
30248.2s 11251 
30248.2s 11252 Simulation finished at t = 1005.0000 s after 4739 steps.
30248.2s 11253 Total runtime: 0.62 seconds.
30248.2s 11254 [REWARD_MICROSCOPE] step=14267 t=1005.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30248.2s 11255 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30248.2s 11256 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30248.2s 11257 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30248.2s 11258 Running simulation until t = 1020.00 s, outputting every 15.00 s
30248.2s 11259 
30248.3s 11260 [PROGRESS] Step 4750: t=1007.34/1020.00s (98.8%) | dt=0.2129s
30248.6s 11261 [WARNING] Automatic CFL correction applied (count: 3328800):
30248.6s 11262 Calculated CFL: 0.800 > Limit: 0.500
30248.6s 11263 Original dt: 3.412149e-01 s
30248.6s 11264 Corrected dt: 2.132593e-01 s
30248.6s 11265 Correction factor: 1.6x
30248.6s 11266 Max wave speed detected: 23.45 m/s
30248.7s 11267 [PROGRESS] Step 4800: t=1018.00/1020.00s (99.8%) | dt=0.2129s
30248.8s 11268 Stored output at t = 1020.0000 s (Step 4810)
30248.8s 11269 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1005.0/1020.0 [00:00<?, ?s/s][A
30248.8s 11270 [A
30248.8s 11271 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 23.95s/s]
30248.8s 11272 
30248.8s 11273 Simulation finished at t = 1020.0000 s after 4810 steps.
30248.8s 11274 Total runtime: 0.63 seconds.
30248.8s 11275 [REWARD_MICROSCOPE] step=14268 t=1020.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30248.8s 11276 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30248.8s 11277 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30248.8s 11278 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30248.8s 11279 Running simulation until t = 1035.00 s, outputting every 15.00 s
30248.8s 11280 
30249.2s 11281 [PROGRESS] Step 4850: t=1028.50/1035.00s (99.4%) | dt=0.2126s
30249.4s 11282 Stored output at t = 1035.0000 s (Step 4881)
30249.4s 11283 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1020.0/1035.0 [00:00<?, ?s/s][A
30249.4s 11284 [A
30249.4s 11285 
30249.4s 11286 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 23.99s/s]
30249.4s 11287 Simulation finished at t = 1035.0000 s after 4881 steps.
30249.4s 11288 Total runtime: 0.63 seconds.
30249.4s 11289 [REWARD_MICROSCOPE] step=14269 t=1035.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30249.4s 11290 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30249.4s 11291 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30249.4s 11292 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30249.4s 11293 Running simulation until t = 1050.00 s, outputting every 15.00 s
30249.4s 11294 
30249.5s 11295 [PERIODIC:1000] BC_DISPATCHER [Call #13316000] current_bc_params: <class 'dict'>
30249.5s 11296 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30249.5s 11297 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30249.5s 11298 [PERIODIC:1000] BC_GPU [Call #13316000] About to launch kernel
30249.5s 11299 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30249.5s 11300 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30249.5s 11301 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30249.5s 11302 [WARNING] Automatic CFL correction applied (count: 3328900):
30249.5s 11303 Calculated CFL: 0.800 > Limit: 0.500
30249.5s 11304 Original dt: 3.406380e-01 s
30249.5s 11305 Corrected dt: 2.128988e-01 s
30249.5s 11306 Correction factor: 1.6x
30249.5s 11307 Max wave speed detected: 23.49 m/s
30249.6s 11308 [PROGRESS] Step 4900: t=1039.05/1050.00s (99.0%) | dt=0.2130s
30250.0s 11309 [PROGRESS] Step 4950: t=1049.70/1050.00s (100.0%) | dt=0.2126s
30250.1s 11310 Stored output at t = 1050.0000 s (Step 4952)
30250.1s 11311 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1035.0/1050.0 [00:00<?, ?s/s][A
30250.1s 11312 [A
30250.1s 11313 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.31s/s]
30250.1s 11314 
30250.1s 11315 Simulation finished at t = 1050.0000 s after 4952 steps.
30250.1s 11316 Total runtime: 0.62 seconds.
30250.1s 11317 [REWARD_MICROSCOPE] step=14270 t=1050.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30250.1s 11318 [STEP   70] t= 1050.0s | phase=0 | reward=   0.01 | total_reward=    0.70
30250.1s 11319 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30250.1s 11320 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30250.1s 11321 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30250.1s 11322 Running simulation until t = 1065.00 s, outputting every 15.00 s
30250.1s 11323 
30250.4s 11324 [WARNING] Automatic CFL correction applied (count: 3329000):
30250.4s 11325 Calculated CFL: 0.800 > Limit: 0.500
30250.4s 11326 Original dt: 3.400643e-01 s
30250.4s 11327 Corrected dt: 2.125402e-01 s
30250.4s 11328 Correction factor: 1.6x
30250.4s 11329 Max wave speed detected: 23.52 m/s
30250.5s 11330 [PROGRESS] Step 5000: t=1060.20/1065.00s (99.5%) | dt=0.2126s
30250.7s 11331 Stored output at t = 1065.0000 s (Step 5023)
30250.7s 11332 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1050.0/1065.0 [00:00<?, ?s/s][A
30250.7s 11333 [A
30250.7s 11334 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.30s/s]
30250.7s 11335 
30250.7s 11336 Simulation finished at t = 1065.0000 s after 5023 steps.
30250.7s 11337 Total runtime: 0.62 seconds.
30250.7s 11338 [QUEUE_DIAGNOSTIC] ===== Step 70 t=1065.0s =====
30250.7s 11339 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30250.7s 11340 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30250.7s 11341 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30250.7s 11342 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30250.7s 11343 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30250.7s 11344 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30250.7s 11345 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30250.7s 11346 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30250.7s 11347 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30250.7s 11348 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30250.7s 11349 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30250.7s 11350 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30250.7s 11351 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30250.7s 11352 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30250.7s 11353 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30250.7s 11354 [REWARD_MICROSCOPE] step=14271 t=1065.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30250.7s 11355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30250.7s 11356 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30250.7s 11357 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30250.7s 11358 Running simulation until t = 1080.00 s, outputting every 15.00 s
30250.7s 11359 
30251.0s 11360 [PROGRESS] Step 5050: t=1070.75/1080.00s (99.1%) | dt=0.2131s
30251.3s 11361 [WARNING] Automatic CFL correction applied (count: 3329100):
30251.3s 11362 Calculated CFL: 0.800 > Limit: 0.500
30251.3s 11363 Original dt: 3.403351e-01 s
30251.3s 11364 Corrected dt: 2.127094e-01 s
30251.3s 11365 Correction factor: 1.6x
30251.3s 11366 Max wave speed detected: 23.51 m/s
30251.3s 11367 Stored output at t = 1080.0000 s (Step 5094)
30251.3s 11368 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1065.0/1080.0 [00:00<?, ?s/s][A
30251.3s 11369 [A
30251.3s 11370 
30251.3s 11371 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 23.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 23.15s/s]
30251.3s 11372 Simulation finished at t = 1080.0000 s after 5094 steps.
30251.3s 11373 Total runtime: 0.65 seconds.
30251.3s 11374 [REWARD_MICROSCOPE] step=14272 t=1080.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30251.3s 11375 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30251.3s 11376 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30251.3s 11377 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30251.3s 11378 Running simulation until t = 1095.00 s, outputting every 15.00 s
30251.3s 11379 
30251.4s 11380 [PROGRESS] Step 5100: t=1081.27/1095.00s (98.7%) | dt=0.2124s
30251.7s 11381 [PERIODIC:1000] BC_DISPATCHER [Call #13317000] current_bc_params: <class 'dict'>
30251.7s 11382 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30251.7s 11383 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30251.7s 11384 [PERIODIC:1000] BC_GPU [Call #13317000] About to launch kernel
30251.7s 11385 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30251.7s 11386 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30251.7s 11387 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30251.8s 11388 [PROGRESS] Step 5150: t=1091.90/1095.00s (99.7%) | dt=0.2127s
30252.0s 11389 Stored output at t = 1095.0000 s (Step 5165)
30252.0s 11390 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1080.0/1095.0 [00:00<?, ?s/s][A
30252.0s 11391 [A
30252.0s 11392 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.19s/s]
30252.0s 11393 
30252.0s 11394 Simulation finished at t = 1095.0000 s after 5165 steps.
30252.0s 11395 Total runtime: 0.62 seconds.
30252.0s 11396 [REWARD_MICROSCOPE] step=14273 t=1095.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30252.0s 11397 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30252.0s 11398 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30252.0s 11399 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30252.0s 11400 Running simulation until t = 1110.00 s, outputting every 15.00 s
30252.0s 11401 
30252.2s 11402 [WARNING] Automatic CFL correction applied (count: 3329200):
30252.2s 11403 Calculated CFL: 0.800 > Limit: 0.500
30252.2s 11404 Original dt: 3.408612e-01 s
30252.2s 11405 Corrected dt: 2.130383e-01 s
30252.2s 11406 Correction factor: 1.6x
30252.2s 11407 Max wave speed detected: 23.47 m/s
30252.3s 11408 [PROGRESS] Step 5200: t=1102.45/1110.00s (99.3%) | dt=0.2131s
30252.6s 11409 Stored output at t = 1110.0000 s (Step 5236)
30252.6s 11410 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1095.0/1110.0 [00:00<?, ?s/s][A
30252.6s 11411 [A
30252.6s 11412 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.35s/s]
30252.6s 11413 
30252.6s 11414 Simulation finished at t = 1110.0000 s after 5236 steps.
30252.6s 11415 Total runtime: 0.62 seconds.
30252.6s 11416 [REWARD_MICROSCOPE] step=14274 t=1110.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30252.6s 11417 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30252.6s 11418 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30252.6s 11419 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30252.6s 11420 Running simulation until t = 1125.00 s, outputting every 15.00 s
30252.6s 11421 
30252.7s 11422 [PROGRESS] Step 5250: t=1112.97/1125.00s (98.9%) | dt=0.2123s
30253.0s 11423 [WARNING] Automatic CFL correction applied (count: 3329300):
30253.0s 11424 Calculated CFL: 0.800 > Limit: 0.500
30253.0s 11425 Original dt: 3.402871e-01 s
30253.0s 11426 Corrected dt: 2.126795e-01 s
30253.0s 11427 Correction factor: 1.6x
30253.0s 11428 Max wave speed detected: 23.51 m/s
30253.1s 11429 [PROGRESS] Step 5300: t=1123.60/1125.00s (99.9%) | dt=0.2128s
30253.2s 11430 Stored output at t = 1125.0000 s (Step 5307)
30253.2s 11431 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1110.0/1125.0 [00:00<?, ?s/s][A
30253.2s 11432 [A
30253.2s 11433 
30253.2s 11434 Simulation finished at t = 1125.0000 s after 5307 steps.
30253.2s 11435 Total runtime: 0.62 seconds.
30253.2s 11436 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 24.34s/s]
30253.2s 11437 [REWARD_MICROSCOPE] step=14275 t=1125.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30253.2s 11438 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30253.2s 11439 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30253.2s 11440 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30253.2s 11441 Running simulation until t = 1140.00 s, outputting every 15.00 s
30253.2s 11442 
30253.6s 11443 [PROGRESS] Step 5350: t=1134.16/1140.00s (99.5%) | dt=0.2132s
30253.8s 11444 Stored output at t = 1140.0000 s (Step 5378)
30253.8s 11445 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1125.0/1140.0 [00:00<?, ?s/s][A
30253.8s 11446 [A
30253.8s 11447 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.36s/s]
30253.8s 11448 
30253.8s 11449 Simulation finished at t = 1140.0000 s after 5378 steps.
30253.8s 11450 Total runtime: 0.62 seconds.
30253.8s 11451 [REWARD_MICROSCOPE] step=14276 t=1140.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30253.8s 11452 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30253.8s 11453 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30253.8s 11454 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30253.8s 11455 Running simulation until t = 1155.00 s, outputting every 15.00 s
30253.8s 11456 
30253.9s 11457 [PERIODIC:1000] BC_DISPATCHER [Call #13318000] current_bc_params: <class 'dict'>
30253.9s 11458 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30253.9s 11459 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30253.9s 11460 [PERIODIC:1000] BC_GPU [Call #13318000] About to launch kernel
30253.9s 11461 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30253.9s 11462 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30253.9s 11463 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30253.9s 11464 [WARNING] Automatic CFL correction applied (count: 3329400):
30253.9s 11465 Calculated CFL: 0.800 > Limit: 0.500
30253.9s 11466 Original dt: 3.397169e-01 s
30253.9s 11467 Corrected dt: 2.123230e-01 s
30253.9s 11468 Correction factor: 1.6x
30253.9s 11469 Max wave speed detected: 23.55 m/s
30254.0s 11470 [PROGRESS] Step 5400: t=1144.67/1155.00s (99.1%) | dt=0.2124s
30254.4s 11471 Stored output at t = 1155.0000 s (Step 5449)
30254.4s 11472 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1140.0/1155.0 [00:00<?, ?s/s][A
30254.4s 11473 [A
30254.4s 11474 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.45s/s]
30254.4s 11475 
30254.4s 11476 Simulation finished at t = 1155.0000 s after 5449 steps.
30254.4s 11477 Total runtime: 0.61 seconds.
30254.4s 11478 [REWARD_MICROSCOPE] step=14277 t=1155.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30254.4s 11479 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30254.4s 11480 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30254.4s 11481 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30254.4s 11482 Running simulation until t = 1170.00 s, outputting every 15.00 s
30254.4s 11483 
30254.4s 11484 [PROGRESS] Step 5450: t=1155.21/1170.00s (98.7%) | dt=0.2128s
30254.8s 11485 [WARNING] Automatic CFL correction applied (count: 3329500):
30254.8s 11486 Calculated CFL: 0.800 > Limit: 0.500
30254.8s 11487 Original dt: 3.410795e-01 s
30254.8s 11488 Corrected dt: 2.131747e-01 s
30254.8s 11489 Correction factor: 1.6x
30254.8s 11490 Max wave speed detected: 23.45 m/s
30254.9s 11491 [PROGRESS] Step 5500: t=1165.87/1170.00s (99.6%) | dt=0.2133s
30255.1s 11492 Stored output at t = 1170.0000 s (Step 5520)
30255.1s 11493 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1155.0/1170.0 [00:00<?, ?s/s][A
30255.1s 11494 [A
30255.1s 11495 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.32s/s]
30255.1s 11496 
30255.1s 11497 Simulation finished at t = 1170.0000 s after 5520 steps.
30255.1s 11498 Total runtime: 0.62 seconds.
30255.1s 11499 [REWARD_MICROSCOPE] step=14278 t=1170.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30255.1s 11500 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30255.1s 11501 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30255.1s 11502 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30255.1s 11503 Running simulation until t = 1185.00 s, outputting every 15.00 s
30255.1s 11504 
30255.3s 11505 [PROGRESS] Step 5550: t=1176.37/1185.00s (99.3%) | dt=0.2125s
30255.6s 11506 [WARNING] Automatic CFL correction applied (count: 3329600):
30255.6s 11507 Calculated CFL: 0.800 > Limit: 0.500
30255.6s 11508 Original dt: 3.405090e-01 s
30255.6s 11509 Corrected dt: 2.128181e-01 s
30255.6s 11510 Correction factor: 1.6x
30255.6s 11511 Max wave speed detected: 23.49 m/s
30255.7s 11512 Stored output at t = 1185.0000 s (Step 5591)
30255.7s 11513 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1170.0/1185.0 [00:00<?, ?s/s][A
30255.7s 11514 [A
30255.7s 11515 
30255.7s 11516 Simulation finished at t = 1185.0000 s after 5591 steps.
30255.7s 11517 Total runtime: 0.61 seconds.
30255.7s 11518 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.61s/s]
30255.7s 11519 [REWARD_MICROSCOPE] step=14279 t=1185.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30255.7s 11520 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30255.7s 11521 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30255.7s 11522 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30255.7s 11523 Running simulation until t = 1200.00 s, outputting every 15.00 s
30255.7s 11524 
30255.7s 11525 [PROGRESS] Step 5600: t=1186.92/1200.00s (98.9%) | dt=0.2129s
30256.0s 11526 [PERIODIC:1000] BC_DISPATCHER [Call #13319000] current_bc_params: <class 'dict'>
30256.0s 11527 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30256.0s 11528 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30256.0s 11529 [PERIODIC:1000] BC_GPU [Call #13319000] About to launch kernel
30256.0s 11530 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30256.0s 11531 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30256.0s 11532 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30256.2s 11533 [PROGRESS] Step 5650: t=1197.57/1200.00s (99.8%) | dt=0.2130s
30256.3s 11534 Stored output at t = 1200.0000 s (Step 5662)
30256.3s 11535 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1185.0/1200.0 [00:00<?, ?s/s][A
30256.3s 11536 [A
30256.3s 11537 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.53s/s]
30256.3s 11538 
30256.3s 11539 Simulation finished at t = 1200.0000 s after 5662 steps.
30256.3s 11540 Total runtime: 0.64 seconds.
30256.3s 11541 [REWARD_MICROSCOPE] step=14280 t=1200.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30256.3s 11542 [STEP   80] t= 1200.0s | phase=0 | reward=   0.01 | total_reward=    0.80
30256.3s 11543 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30256.3s 11544 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30256.3s 11545 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30256.3s 11546 Running simulation until t = 1215.00 s, outputting every 15.00 s
30256.3s 11547 
30256.9s 11548 [WARNING] Automatic CFL correction applied (count: 3329700):
30256.9s 11549 Calculated CFL: 0.800 > Limit: 0.500
30256.9s 11550 Original dt: 3.399193e-01 s
30256.9s 11551 Corrected dt: 2.124495e-01 s
30256.9s 11552 Correction factor: 1.6x
30256.9s 11553 Max wave speed detected: 23.53 m/s
30257.0s 11554 [PROGRESS] Step 5700: t=1208.07/1215.00s (99.4%) | dt=0.2125s
30257.3s 11555 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1200.0/1215.0 [00:00<?, ?s/s][A
30257.3s 11556 [A
30257.3s 11557 Stored output at t = 1215.0000 s (Step 5733)
30257.3s 11558 
30257.3s 11559 Simulation finished at t = 1215.0000 s after 5733 steps.
30257.3s 11560 Total runtime: 0.99 seconds.
30257.3s 11561 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 15.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 15.13s/s]
30257.3s 11562 [QUEUE_DIAGNOSTIC] ===== Step 80 t=1215.0s =====
30257.3s 11563 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30257.3s 11564 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30257.3s 11565 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30257.3s 11566 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30257.3s 11567 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30257.3s 11568 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30257.3s 11569 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30257.3s 11570 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30257.3s 11571 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30257.3s 11572 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30257.3s 11573 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30257.3s 11574 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30257.3s 11575 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30257.3s 11576 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30257.3s 11577 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30257.3s 11578 [REWARD_MICROSCOPE] step=14281 t=1215.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30257.3s 11579 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30257.3s 11580 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30257.3s 11581 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30257.3s 11582 Running simulation until t = 1230.00 s, outputting every 15.00 s
30257.3s 11583 
30257.5s 11584 [PROGRESS] Step 5750: t=1218.62/1230.00s (99.1%) | dt=0.2130s
30257.8s 11585 [WARNING] Automatic CFL correction applied (count: 3329800):
30257.8s 11586 Calculated CFL: 0.800 > Limit: 0.500
30257.8s 11587 Original dt: 3.411066e-01 s
30257.8s 11588 Corrected dt: 2.131916e-01 s
30257.8s 11589 Correction factor: 1.6x
30257.8s 11590 Max wave speed detected: 23.45 m/s
30257.9s 11591 [PROGRESS] Step 5800: t=1229.27/1230.00s (99.9%) | dt=0.2127s
30257.9s 11592 Stored output at t = 1230.0000 s (Step 5804)
30257.9s 11593 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1215.0/1230.0 [00:00<?, ?s/s][A
30257.9s 11594 [A
30257.9s 11595 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 24.38s/s]
30257.9s 11596 
30257.9s 11597 Simulation finished at t = 1230.0000 s after 5804 steps.
30257.9s 11598 Total runtime: 0.62 seconds.
30257.9s 11599 [REWARD_MICROSCOPE] step=14282 t=1230.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30257.9s 11600 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30257.9s 11601 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30257.9s 11602 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30257.9s 11603 Running simulation until t = 1245.00 s, outputting every 15.00 s
30257.9s 11604 
30258.3s 11605 [PROGRESS] Step 5850: t=1239.77/1245.00s (99.6%) | dt=0.2126s
30258.5s 11606 Stored output at t = 1245.0000 s (Step 5875)
30258.5s 11607 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1230.0/1245.0 [00:00<?, ?s/s][A
30258.5s 11608 [A
30258.5s 11609 
30258.5s 11610 Simulation finished at t = 1245.0000 s after 5875 steps.
30258.5s 11611 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 24.23s/s]
30258.5s 11612 Total runtime: 0.62 seconds.
30258.5s 11613 [REWARD_MICROSCOPE] step=14283 t=1245.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30258.5s 11614 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30258.5s 11615 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30258.5s 11616 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30258.5s 11617 Running simulation until t = 1260.00 s, outputting every 15.00 s
30258.5s 11618 
30258.6s 11619 [PERIODIC:1000] BC_DISPATCHER [Call #13320000] current_bc_params: <class 'dict'>
30258.6s 11620 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30258.6s 11621 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30258.6s 11622 [PERIODIC:1000] BC_GPU [Call #13320000] About to launch kernel
30258.6s 11623 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30258.6s 11624 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30258.6s 11625 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30258.7s 11626 [WARNING] Automatic CFL correction applied (count: 3329900):
30258.7s 11627 Calculated CFL: 0.800 > Limit: 0.500
30258.7s 11628 Original dt: 3.407212e-01 s
30258.7s 11629 Corrected dt: 2.129508e-01 s
30258.7s 11630 Correction factor: 1.6x
30258.7s 11631 Max wave speed detected: 23.48 m/s
30258.8s 11632 [PROGRESS] Step 5900: t=1250.32/1260.00s (99.2%) | dt=0.2130s
30259.2s 11633 Stored output at t = 1260.0000 s (Step 5946)
30259.2s 11634 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1245.0/1260.0 [00:00<?, ?s/s][A
30259.2s 11635 [A
30259.2s 11636 
30259.2s 11637 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.01s/s]
30259.2s 11638 Simulation finished at t = 1260.0000 s after 5946 steps.
30259.2s 11639 Total runtime: 0.62 seconds.
30259.2s 11640 [REWARD_MICROSCOPE] step=14284 t=1260.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30259.2s 11641 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30259.2s 11642 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30259.2s 11643 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30259.2s 11644 Running simulation until t = 1275.00 s, outputting every 15.00 s
30259.2s 11645 
30259.2s 11646 [PROGRESS] Step 5950: t=1260.85/1275.00s (98.9%) | dt=0.2124s
30259.5s 11647 [WARNING] Automatic CFL correction applied (count: 3330000):
30259.5s 11648 Calculated CFL: 0.800 > Limit: 0.500
30259.5s 11649 Original dt: 3.401477e-01 s
30259.5s 11650 Corrected dt: 2.125923e-01 s
30259.5s 11651 Correction factor: 1.6x
30259.5s 11652 Max wave speed detected: 23.52 m/s
30259.6s 11653 [PROGRESS] Step 6000: t=1271.47/1275.00s (99.7%) | dt=0.2127s
30259.8s 11654 Stored output at t = 1275.0000 s (Step 6017)
30259.8s 11655 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1260.0/1275.0 [00:00<?, ?s/s][A
30259.8s 11656 [A
30259.8s 11657 
30259.8s 11658 Simulation finished at t = 1275.0000 s after 6017 steps.
30259.8s 11659 Total runtime: 0.61 seconds.
30259.8s 11660 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.48s/s]
30259.8s 11661 [REWARD_MICROSCOPE] step=14285 t=1275.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30259.8s 11662 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30259.8s 11663 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30259.8s 11664 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30259.8s 11665 Running simulation until t = 1290.00 s, outputting every 15.00 s
30259.8s 11666 
30260.1s 11667 [PROGRESS] Step 6050: t=1282.03/1290.00s (99.4%) | dt=0.2131s
30260.4s 11668 Stored output at t = 1290.0000 s (Step 6088)
30260.4s 11669 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1275.0/1290.0 [00:00<?, ?s/s][A
30260.4s 11670 [A
30260.4s 11671 
30260.4s 11672 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.07s/s]
30260.4s 11673 Simulation finished at t = 1290.0000 s after 6088 steps.
30260.4s 11674 Total runtime: 0.62 seconds.
30260.4s 11675 [REWARD_MICROSCOPE] step=14286 t=1290.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30260.4s 11676 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30260.4s 11677 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30260.4s 11678 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30260.4s 11679 Running simulation until t = 1305.00 s, outputting every 15.00 s
30260.4s 11680 
30260.4s 11681 [WARNING] Automatic CFL correction applied (count: 3330100):
30260.4s 11682 Calculated CFL: 0.800 > Limit: 0.500
30260.4s 11683 Original dt: 3.400436e-01 s
30260.4s 11684 Corrected dt: 2.125273e-01 s
30260.4s 11685 Correction factor: 1.6x
30260.4s 11686 Max wave speed detected: 23.53 m/s
30260.5s 11687 [PROGRESS] Step 6100: t=1292.55/1305.00s (99.0%) | dt=0.2123s
30260.8s 11688 [PERIODIC:1000] BC_DISPATCHER [Call #13321000] current_bc_params: <class 'dict'>
30260.8s 11689 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30260.8s 11690 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30260.8s 11691 [PERIODIC:1000] BC_GPU [Call #13321000] About to launch kernel
30260.8s 11692 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30260.8s 11693 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30260.8s 11694 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30261.0s 11695 [PROGRESS] Step 6150: t=1303.18/1305.00s (99.9%) | dt=0.2128s
30261.1s 11696 Stored output at t = 1305.0000 s (Step 6159)
30261.1s 11697 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1290.0/1305.0 [00:00<?, ?s/s][A
30261.1s 11698 [A
30261.1s 11699 
30261.1s 11700 Simulation finished at t = 1305.0000 s after 6159 steps.
30261.1s 11701 Total runtime: 0.67 seconds.
30261.1s 11702 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 22.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 22.51s/s]
30261.1s 11703 [REWARD_MICROSCOPE] step=14287 t=1305.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30261.1s 11704 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30261.1s 11705 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30261.1s 11706 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30261.1s 11707 Running simulation until t = 1320.00 s, outputting every 15.00 s
30261.1s 11708 
30261.3s 11709 [WARNING] Automatic CFL correction applied (count: 3330200):
30261.3s 11710 Calculated CFL: 0.800 > Limit: 0.500
30261.3s 11711 Original dt: 3.409462e-01 s
30261.3s 11712 Corrected dt: 2.130914e-01 s
30261.3s 11713 Correction factor: 1.6x
30261.3s 11714 Max wave speed detected: 23.46 m/s
30261.4s 11715 [PROGRESS] Step 6200: t=1313.73/1320.00s (99.5%) | dt=0.2132s
30261.7s 11716 Stored output at t = 1320.0000 s (Step 6230)
30261.7s 11717 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1305.0/1320.0 [00:00<?, ?s/s][A
30261.7s 11718 [A
30261.7s 11719 
30261.7s 11720 Simulation finished at t = 1320.0000 s after 6230 steps.
30261.7s 11721 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.90s/s]
30261.7s 11722 Total runtime: 0.63 seconds.
30261.7s 11723 [REWARD_MICROSCOPE] step=14288 t=1320.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30261.7s 11724 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30261.7s 11725 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30261.7s 11726 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30261.7s 11727 Running simulation until t = 1335.00 s, outputting every 15.00 s
30261.7s 11728 
30261.9s 11729 [PROGRESS] Step 6250: t=1324.25/1335.00s (99.2%) | dt=0.2124s
30262.2s 11730 [WARNING] Automatic CFL correction applied (count: 3330300):
30262.2s 11731 Calculated CFL: 0.800 > Limit: 0.500
30262.2s 11732 Original dt: 3.403711e-01 s
30262.2s 11733 Corrected dt: 2.127320e-01 s
30262.2s 11734 Correction factor: 1.6x
30262.2s 11735 Max wave speed detected: 23.50 m/s
30262.3s 11736 [PROGRESS] Step 6300: t=1334.88/1335.00s (100.0%) | dt=0.2128s
30262.3s 11737 Stored output at t = 1335.0000 s (Step 6301)
30262.3s 11738 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1320.0/1335.0 [00:00<?, ?s/s][A
30262.3s 11739 [A
30262.3s 11740 
30262.3s 11741 Simulation finished at t = 1335.0000 s after 6301 steps.
30262.3s 11742 Total runtime: 0.63 seconds.
30262.3s 11743 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.71s/s]
30262.3s 11744 [REWARD_MICROSCOPE] step=14289 t=1335.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30262.3s 11745 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30262.3s 11746 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30262.3s 11747 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30262.3s 11748 Running simulation until t = 1350.00 s, outputting every 15.00 s
30262.3s 11749 
30262.8s 11750 [PROGRESS] Step 6350: t=1345.44/1350.00s (99.7%) | dt=0.2133s
30263.0s 11751 Stored output at t = 1350.0000 s (Step 6372)
30263.0s 11752 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1335.0/1350.0 [00:00<?, ?s/s][A
30263.0s 11753 [A
30263.0s 11754 
30263.0s 11755 Simulation finished at t = 1350.0000 s after 6372 steps.
30263.0s 11756 Total runtime: 0.62 seconds.
30263.0s 11757 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.24s/s]
30263.0s 11758 [REWARD_MICROSCOPE] step=14290 t=1350.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30263.0s 11759 [STEP   90] t= 1350.0s | phase=0 | reward=   0.01 | total_reward=    0.90
30263.0s 11760 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30263.0s 11761 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30263.0s 11762 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30263.0s 11763 Running simulation until t = 1365.00 s, outputting every 15.00 s
30263.0s 11764 
30263.1s 11765 [PERIODIC:1000] BC_DISPATCHER [Call #13322000] current_bc_params: <class 'dict'>
30263.1s 11766 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30263.1s 11767 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30263.1s 11768 [PERIODIC:1000] BC_GPU [Call #13322000] About to launch kernel
30263.1s 11769 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30263.1s 11770 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30263.1s 11771 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30263.1s 11772 [WARNING] Automatic CFL correction applied (count: 3330400):
30263.1s 11773 Calculated CFL: 0.800 > Limit: 0.500
30263.1s 11774 Original dt: 3.397675e-01 s
30263.1s 11775 Corrected dt: 2.123547e-01 s
30263.1s 11776 Correction factor: 1.6x
30263.1s 11777 Max wave speed detected: 23.55 m/s
30263.2s 11778 [PROGRESS] Step 6400: t=1355.95/1365.00s (99.3%) | dt=0.2125s
30263.6s 11779 Stored output at t = 1365.0000 s (Step 6443)
30263.6s 11780 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
30263.6s 11781 [A
30263.6s 11782 
30263.6s 11783 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 23.97s/s]
30263.6s 11784 Simulation finished at t = 1365.0000 s after 6443 steps.
30263.6s 11785 Total runtime: 0.63 seconds.
30263.6s 11786 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
30263.6s 11787 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30263.6s 11788 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30263.6s 11789 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30263.6s 11790 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30263.6s 11791 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30263.6s 11792 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30263.6s 11793 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30263.6s 11794 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30263.6s 11795 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30263.6s 11796 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30263.6s 11797 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30263.6s 11798 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30263.6s 11799 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30263.6s 11800 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30263.6s 11801 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30263.6s 11802 [REWARD_MICROSCOPE] step=14291 t=1365.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30263.6s 11803 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30263.6s 11804 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30263.6s 11805 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30263.6s 11806 Running simulation until t = 1380.00 s, outputting every 15.00 s
30263.6s 11807 
30263.7s 11808 [PROGRESS] Step 6450: t=1366.49/1380.00s (99.0%) | dt=0.2129s
30264.0s 11809 [WARNING] Automatic CFL correction applied (count: 3330500):
30264.0s 11810 Calculated CFL: 0.800 > Limit: 0.500
30264.0s 11811 Original dt: 3.411605e-01 s
30264.0s 11812 Corrected dt: 2.132253e-01 s
30264.0s 11813 Correction factor: 1.6x
30264.0s 11814 Max wave speed detected: 23.45 m/s
30264.1s 11815 [PROGRESS] Step 6500: t=1377.15/1380.00s (99.8%) | dt=0.2131s
30264.2s 11816 Stored output at t = 1380.0000 s (Step 6514)
30264.2s 11817 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
30264.2s 11818 [A
30264.2s 11819 
30264.2s 11820 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.41s/s]
30264.2s 11821 Simulation finished at t = 1380.0000 s after 6514 steps.
30264.2s 11822 Total runtime: 0.62 seconds.
30264.2s 11823 [REWARD_MICROSCOPE] step=14292 t=1380.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30264.2s 11824 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30264.2s 11825 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30264.2s 11826 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30264.2s 11827 Running simulation until t = 1395.00 s, outputting every 15.00 s
30264.2s 11828 
30264.5s 11829 [PROGRESS] Step 6550: t=1387.65/1395.00s (99.5%) | dt=0.2125s
30264.8s 11830 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
30264.8s 11831 [A
30264.8s 11832 Stored output at t = 1395.0000 s (Step 6585)
30264.8s 11833 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 23.90s/s]
30264.8s 11834 
30264.8s 11835 Simulation finished at t = 1395.0000 s after 6585 steps.
30264.8s 11836 Total runtime: 0.63 seconds.
30264.8s 11837 [REWARD_MICROSCOPE] step=14293 t=1395.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30264.8s 11838 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30264.8s 11839 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30264.8s 11840 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30264.8s 11841 Running simulation until t = 1410.00 s, outputting every 15.00 s
30264.8s 11842 
30264.9s 11843 [WARNING] Automatic CFL correction applied (count: 3330600):
30264.9s 11844 Calculated CFL: 0.800 > Limit: 0.500
30264.9s 11845 Original dt: 3.405828e-01 s
30264.9s 11846 Corrected dt: 2.128643e-01 s
30264.9s 11847 Correction factor: 1.6x
30264.9s 11848 Max wave speed detected: 23.49 m/s
30265.0s 11849 [PROGRESS] Step 6600: t=1398.19/1410.00s (99.2%) | dt=0.2130s
30265.3s 11850 [PERIODIC:1000] BC_DISPATCHER [Call #13323000] current_bc_params: <class 'dict'>
30265.3s 11851 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30265.3s 11852 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30265.3s 11853 [PERIODIC:1000] BC_GPU [Call #13323000] About to launch kernel
30265.3s 11854 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30265.3s 11855 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30265.3s 11856 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30265.4s 11857 [PROGRESS] Step 6650: t=1408.85/1410.00s (99.9%) | dt=0.2127s
30265.5s 11858 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
30265.5s 11859 Stored output at t = 1410.0000 s (Step 6656)
30265.5s 11860 [A
30265.5s 11861 
30265.5s 11862 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.30s/s]
30265.5s 11863 Simulation finished at t = 1410.0000 s after 6656 steps.
30265.5s 11864 Total runtime: 0.62 seconds.
30265.5s 11865 [REWARD_MICROSCOPE] step=14294 t=1410.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30265.5s 11866 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30265.5s 11867 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30265.5s 11868 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30265.5s 11869 Running simulation until t = 1425.00 s, outputting every 15.00 s
30265.5s 11870 
30265.7s 11871 [WARNING] Automatic CFL correction applied (count: 3330700):
30265.7s 11872 Calculated CFL: 0.800 > Limit: 0.500
30265.7s 11873 Original dt: 3.400085e-01 s
30265.7s 11874 Corrected dt: 2.125053e-01 s
30265.7s 11875 Correction factor: 1.6x
30265.7s 11876 Max wave speed detected: 23.53 m/s
30265.8s 11877 [PROGRESS] Step 6700: t=1419.35/1425.00s (99.6%) | dt=0.2126s
30266.1s 11878 Stored output at t = 1425.0000 s (Step 6727)
30266.1s 11879 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
30266.1s 11880 [A
30266.1s 11881 
30266.1s 11882 Simulation finished at t = 1425.0000 s after 6727 steps.
30266.1s 11883 Total runtime: 0.64 seconds.
30266.1s 11884 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 23.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 23.37s/s]
30266.1s 11885 [REWARD_MICROSCOPE] step=14295 t=1425.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30266.1s 11886 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30266.1s 11887 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30266.1s 11888 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30266.1s 11889 Running simulation until t = 1440.00 s, outputting every 15.00 s
30266.1s 11890 
30266.3s 11891 [PROGRESS] Step 6750: t=1429.90/1440.00s (99.3%) | dt=0.2130s
30266.7s 11892 [WARNING] Automatic CFL correction applied (count: 3330800):
30266.7s 11893 Calculated CFL: 0.800 > Limit: 0.500
30266.7s 11894 Original dt: 3.406020e-01 s
30266.7s 11895 Corrected dt: 2.128763e-01 s
30266.7s 11896 Correction factor: 1.6x
30266.7s 11897 Max wave speed detected: 23.49 m/s
30266.8s 11898 Stored output at t = 1440.0000 s (Step 6798)
30266.8s 11899 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
30266.8s 11900 [A
30266.8s 11901 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 23.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 23.27s/s]
30266.8s 11902 
30266.8s 11903 Simulation finished at t = 1440.0000 s after 6798 steps.
30266.8s 11904 Total runtime: 0.65 seconds.
30266.8s 11905 [REWARD_MICROSCOPE] step=14296 t=1440.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30266.8s 11906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30266.8s 11907 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30266.8s 11908 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30266.8s 11909 Running simulation until t = 1455.00 s, outputting every 15.00 s
30266.8s 11910 
30266.8s 11911 [PROGRESS] Step 6800: t=1440.43/1455.00s (99.0%) | dt=0.2125s
30267.2s 11912 [PROGRESS] Step 6850: t=1451.05/1455.00s (99.7%) | dt=0.2127s
30267.4s 11913 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
30267.4s 11914 [A
30267.4s 11915 Stored output at t = 1455.0000 s (Step 6869)
30267.4s 11916 
30267.4s 11917 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 24.04s/s]
30267.4s 11918 Simulation finished at t = 1455.0000 s after 6869 steps.
30267.4s 11919 Total runtime: 0.62 seconds.
30267.4s 11920 [REWARD_MICROSCOPE] step=14297 t=1455.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30267.4s 11921 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30267.4s 11922 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30267.4s 11923 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30267.4s 11924 Running simulation until t = 1470.00 s, outputting every 15.00 s
30267.4s 11925 
30267.5s 11926 [PERIODIC:1000] BC_DISPATCHER [Call #13324000] current_bc_params: <class 'dict'>
30267.5s 11927 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30267.5s 11928 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30267.5s 11929 [PERIODIC:1000] BC_GPU [Call #13324000] About to launch kernel
30267.5s 11930 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30267.5s 11931 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30267.5s 11932 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30267.6s 11933 [WARNING] Automatic CFL correction applied (count: 3330900):
30267.6s 11934 Calculated CFL: 0.800 > Limit: 0.500
30267.6s 11935 Original dt: 3.408050e-01 s
30267.6s 11936 Corrected dt: 2.130031e-01 s
30267.6s 11937 Correction factor: 1.6x
30267.6s 11938 Max wave speed detected: 23.47 m/s
30267.7s 11939 [PROGRESS] Step 6900: t=1461.60/1470.00s (99.4%) | dt=0.2131s
30268.0s 11940 Stored output at t = 1470.0000 s (Step 6940)
30268.0s 11941 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
30268.0s 11942 [A
30268.0s 11943 
30268.0s 11944 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.30s/s]
30268.0s 11945 Simulation finished at t = 1470.0000 s after 6940 steps.
30268.0s 11946 Total runtime: 0.62 seconds.
30268.0s 11947 [REWARD_MICROSCOPE] step=14298 t=1470.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30268.0s 11948 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30268.0s 11949 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30268.0s 11950 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30268.0s 11951 Running simulation until t = 1485.00 s, outputting every 15.00 s
30268.0s 11952 
30268.1s 11953 [PROGRESS] Step 6950: t=1472.12/1485.00s (99.1%) | dt=0.2123s
30268.4s 11954 [WARNING] Automatic CFL correction applied (count: 3331000):
30268.4s 11955 Calculated CFL: 0.800 > Limit: 0.500
30268.4s 11956 Original dt: 3.402313e-01 s
30268.4s 11957 Corrected dt: 2.126446e-01 s
30268.4s 11958 Correction factor: 1.6x
30268.4s 11959 Max wave speed detected: 23.51 m/s
30268.5s 11960 [PROGRESS] Step 7000: t=1482.75/1485.00s (99.8%) | dt=0.2127s
30268.6s 11961 Stored output at t = 1485.0000 s (Step 7011)
30268.6s 11962 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
30268.6s 11963 [A
30268.6s 11964 
30268.6s 11965 Simulation finished at t = 1485.0000 s after 7011 steps.
30268.6s 11966 Total runtime: 0.62 seconds.
30268.6s 11967 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.27s/s]
30268.6s 11968 [REWARD_MICROSCOPE] step=14299 t=1485.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30268.6s 11969 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30268.6s 11970 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30268.6s 11971 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30268.6s 11972 Running simulation until t = 1500.00 s, outputting every 15.00 s
30268.6s 11973 
30269.0s 11974 [PROGRESS] Step 7050: t=1493.31/1500.00s (99.6%) | dt=0.2132s
30269.3s 11975 Stored output at t = 1500.0000 s (Step 7082)
30269.3s 11976 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
30269.3s 11977 [A
30269.3s 11978 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.91s/s]
30269.3s 11979 
30269.3s 11980 Simulation finished at t = 1500.0000 s after 7082 steps.
30269.3s 11981 Total runtime: 0.63 seconds.
30269.3s 11982 [REWARD_MICROSCOPE] step=14300 t=1500.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30269.3s 11983 [STEP  100] t= 1500.0s | phase=0 | reward=   0.01 | total_reward=    1.00
30269.3s 11984 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30269.3s 11985 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30269.3s 11986 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30269.3s 11987 Running simulation until t = 1515.00 s, outputting every 15.00 s
30269.3s 11988 
30269.3s 11989 [WARNING] Automatic CFL correction applied (count: 3331100):
30269.3s 11990 Calculated CFL: 0.800 > Limit: 0.500
30269.3s 11991 Original dt: 3.398030e-01 s
30269.3s 11992 Corrected dt: 2.123769e-01 s
30269.3s 11993 Correction factor: 1.6x
30269.3s 11994 Max wave speed detected: 23.54 m/s
30269.4s 11995 [PROGRESS] Step 7100: t=1503.82/1515.00s (99.3%) | dt=0.2124s
30269.7s 11996 [PERIODIC:1000] BC_DISPATCHER [Call #13325000] current_bc_params: <class 'dict'>
30269.7s 11997 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30269.7s 11998 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30269.7s 11999 [PERIODIC:1000] BC_GPU [Call #13325000] About to launch kernel
30269.7s 12000 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30269.7s 12001 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30269.7s 12002 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30269.8s 12003 [PROGRESS] Step 7150: t=1514.45/1515.00s (100.0%) | dt=0.2128s
30269.9s 12004 Stored output at t = 1515.0000 s (Step 7153)
30269.9s 12005 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
30269.9s 12006 [A
30269.9s 12007 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.47s/s]
30269.9s 12008 
30269.9s 12009 Simulation finished at t = 1515.0000 s after 7153 steps.
30269.9s 12010 Total runtime: 0.61 seconds.
30269.9s 12011 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
30269.9s 12012 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30269.9s 12013 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30269.9s 12014 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30269.9s 12015 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30269.9s 12016 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30269.9s 12017 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30269.9s 12018 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30269.9s 12019 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30269.9s 12020 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30269.9s 12021 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30269.9s 12022 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30269.9s 12023 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30269.9s 12024 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30269.9s 12025 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30269.9s 12026 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30269.9s 12027 [REWARD_MICROSCOPE] step=14301 t=1515.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30269.9s 12028 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30269.9s 12029 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30269.9s 12030 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30269.9s 12031 Running simulation until t = 1530.00 s, outputting every 15.00 s
30269.9s 12032 
30270.2s 12033 [WARNING] Automatic CFL correction applied (count: 3331200):
30270.2s 12034 Calculated CFL: 0.800 > Limit: 0.500
30270.2s 12035 Original dt: 3.410260e-01 s
30270.2s 12036 Corrected dt: 2.131412e-01 s
30270.2s 12037 Correction factor: 1.6x
30270.2s 12038 Max wave speed detected: 23.46 m/s
30270.3s 12039 [PROGRESS] Step 7200: t=1525.01/1530.00s (99.7%) | dt=0.2132s
30270.5s 12040 Stored output at t = 1530.0000 s (Step 7224)
30270.5s 12041 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
30270.5s 12042 [A
30270.5s 12043 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.30s/s]
30270.5s 12044 
30270.5s 12045 Simulation finished at t = 1530.0000 s after 7224 steps.
30270.5s 12046 Total runtime: 0.62 seconds.
30270.5s 12047 [REWARD_MICROSCOPE] step=14302 t=1530.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30270.5s 12048 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30270.5s 12049 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30270.5s 12050 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30270.5s 12051 Running simulation until t = 1545.00 s, outputting every 15.00 s
30270.5s 12052 
30270.7s 12053 [PROGRESS] Step 7250: t=1535.52/1545.00s (99.4%) | dt=0.2124s
30271.1s 12054 [WARNING] Automatic CFL correction applied (count: 3331300):
30271.1s 12055 Calculated CFL: 0.800 > Limit: 0.500
30271.1s 12056 Original dt: 3.404547e-01 s
30271.1s 12057 Corrected dt: 2.127842e-01 s
30271.1s 12058 Correction factor: 1.6x
30271.1s 12059 Max wave speed detected: 23.50 m/s
30271.1s 12060 Stored output at t = 1545.0000 s (Step 7295)
30271.1s 12061 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
30271.1s 12062 [A
30271.1s 12063 
30271.1s 12064 Simulation finished at t = 1545.0000 s after 7295 steps.
30271.1s 12065 Total runtime: 0.65 seconds.
30271.1s 12066 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.08s/s]
30271.1s 12067 [REWARD_MICROSCOPE] step=14303 t=1545.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30271.1s 12068 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30271.1s 12069 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30271.1s 12070 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30271.1s 12071 Running simulation until t = 1560.00 s, outputting every 15.00 s
30271.1s 12072 
30271.2s 12073 [PROGRESS] Step 7300: t=1546.06/1560.00s (99.1%) | dt=0.2129s
30271.6s 12074 [PROGRESS] Step 7350: t=1556.72/1560.00s (99.8%) | dt=0.2133s
30271.8s 12075 Stored output at t = 1560.0000 s (Step 7366)
30271.8s 12076 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
30271.8s 12077 [A
30271.8s 12078 
30271.8s 12079 Simulation finished at t = 1560.0000 s after 7366 steps.
30271.8s 12080 Total runtime: 0.62 seconds.
30271.8s 12081 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.23s/s]
30271.8s 12082 [REWARD_MICROSCOPE] step=14304 t=1560.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30271.8s 12083 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30271.8s 12084 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30271.8s 12085 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30271.8s 12086 Running simulation until t = 1575.00 s, outputting every 15.00 s
30271.8s 12087 
30271.9s 12088 [PERIODIC:1000] BC_DISPATCHER [Call #13326000] current_bc_params: <class 'dict'>
30271.9s 12089 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30271.9s 12090 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30271.9s 12091 [PERIODIC:1000] BC_GPU [Call #13326000] About to launch kernel
30271.9s 12092 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30271.9s 12093 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30271.9s 12094 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30272.0s 12095 [WARNING] Automatic CFL correction applied (count: 3331400):
30272.0s 12096 Calculated CFL: 0.800 > Limit: 0.500
30272.0s 12097 Original dt: 3.398585e-01 s
30272.0s 12098 Corrected dt: 2.124115e-01 s
30272.0s 12099 Correction factor: 1.6x
30272.0s 12100 Max wave speed detected: 23.54 m/s
30272.1s 12101 [PROGRESS] Step 7400: t=1567.22/1575.00s (99.5%) | dt=0.2125s
30272.4s 12102 Stored output at t = 1575.0000 s (Step 7437)
30272.4s 12103 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
30272.4s 12104 [A
30272.4s 12105 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.12s/s]
30272.4s 12106 
30272.4s 12107 Simulation finished at t = 1575.0000 s after 7437 steps.
30272.4s 12108 Total runtime: 0.62 seconds.
30272.4s 12109 [REWARD_MICROSCOPE] step=14305 t=1575.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30272.4s 12110 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30272.4s 12111 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30272.4s 12112 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30272.4s 12113 Running simulation until t = 1590.00 s, outputting every 15.00 s
30272.4s 12114 
30272.5s 12115 [PROGRESS] Step 7450: t=1577.77/1590.00s (99.2%) | dt=0.2129s
30272.8s 12116 [WARNING] Automatic CFL correction applied (count: 3331500):
30272.8s 12117 Calculated CFL: 0.800 > Limit: 0.500
30272.8s 12118 Original dt: 3.412422e-01 s
30272.8s 12119 Corrected dt: 2.132764e-01 s
30272.8s 12120 Correction factor: 1.6x
30272.8s 12121 Max wave speed detected: 23.44 m/s
30272.9s 12122 [PROGRESS] Step 7500: t=1588.42/1590.00s (99.9%) | dt=0.2128s
30273.0s 12123 Stored output at t = 1590.0000 s (Step 7508)
30273.0s 12124 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
30273.0s 12125 [A
30273.0s 12126 
30273.0s 12127 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.43s/s]
30273.0s 12128 Simulation finished at t = 1590.0000 s after 7508 steps.
30273.0s 12129 Total runtime: 0.61 seconds.
30273.0s 12130 [REWARD_MICROSCOPE] step=14306 t=1590.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30273.0s 12131 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30273.0s 12132 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30273.0s 12133 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30273.0s 12134 Running simulation until t = 1605.00 s, outputting every 15.00 s
30273.0s 12135 
30273.4s 12136 [PROGRESS] Step 7550: t=1598.92/1605.00s (99.6%) | dt=0.2126s
30273.6s 12137 Stored output at t = 1605.0000 s (Step 7579)
30273.6s 12138 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
30273.6s 12139 [A
30273.6s 12140 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.48s/s]
30273.6s 12141 
30273.6s 12142 Simulation finished at t = 1605.0000 s after 7579 steps.
30273.6s 12143 Total runtime: 0.61 seconds.
30273.6s 12144 [REWARD_MICROSCOPE] step=14307 t=1605.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30273.6s 12145 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30273.6s 12146 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30273.6s 12147 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30273.6s 12148 Running simulation until t = 1620.00 s, outputting every 15.00 s
30273.6s 12149 
30273.7s 12150 [WARNING] Automatic CFL correction applied (count: 3331600):
30273.7s 12151 Calculated CFL: 0.800 > Limit: 0.500
30273.7s 12152 Original dt: 3.406657e-01 s
30273.7s 12153 Corrected dt: 2.129161e-01 s
30273.7s 12154 Correction factor: 1.6x
30273.7s 12155 Max wave speed detected: 23.48 m/s
30273.8s 12156 [PROGRESS] Step 7600: t=1609.47/1620.00s (99.4%) | dt=0.2130s
30274.1s 12157 [PERIODIC:1000] BC_DISPATCHER [Call #13327000] current_bc_params: <class 'dict'>
30274.1s 12158 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30274.1s 12159 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30274.1s 12160 [PERIODIC:1000] BC_GPU [Call #13327000] About to launch kernel
30274.1s 12161 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30274.1s 12162 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30274.1s 12163 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30274.3s 12164 [PROGRESS] Step 7650: t=1620.00/1620.00s (100.0%) | dt=0.0883s
30274.3s 12165 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
30274.3s 12166 [A
30274.3s 12167 Stored output at t = 1620.0000 s (Step 7650)
30274.3s 12168 
30274.3s 12169 Simulation finished at t = 1620.0000 s after 7650 steps.
30274.3s 12170 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.69s/s]
30274.3s 12171 Total runtime: 0.63 seconds.
30274.3s 12172 [REWARD_MICROSCOPE] step=14308 t=1620.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30274.3s 12173 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30274.3s 12174 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30274.3s 12175 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30274.3s 12176 Running simulation until t = 1635.00 s, outputting every 15.00 s
30274.3s 12177 
30274.6s 12178 [WARNING] Automatic CFL correction applied (count: 3331700):
30274.6s 12179 Calculated CFL: 0.800 > Limit: 0.500
30274.6s 12180 Original dt: 3.400921e-01 s
30274.6s 12181 Corrected dt: 2.125575e-01 s
30274.6s 12182 Correction factor: 1.6x
30274.6s 12183 Max wave speed detected: 23.52 m/s
30274.7s 12184 [PROGRESS] Step 7700: t=1630.62/1635.00s (99.7%) | dt=0.2127s
30274.9s 12185 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
30274.9s 12186 Stored output at t = 1635.0000 s (Step 7721)
30274.9s 12187 [A
30274.9s 12188 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.87s/s]
30274.9s 12189 
30274.9s 12190 Simulation finished at t = 1635.0000 s after 7721 steps.
30274.9s 12191 Total runtime: 0.63 seconds.
30274.9s 12192 [REWARD_MICROSCOPE] step=14309 t=1635.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30274.9s 12193 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30274.9s 12194 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30274.9s 12195 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30274.9s 12196 Running simulation until t = 1650.00 s, outputting every 15.00 s
30274.9s 12197 
30275.2s 12198 [PROGRESS] Step 7750: t=1641.18/1650.00s (99.5%) | dt=0.2131s
30275.5s 12199 [WARNING] Automatic CFL correction applied (count: 3331800):
30275.5s 12200 Calculated CFL: 0.800 > Limit: 0.500
30275.5s 12201 Original dt: 3.402189e-01 s
30275.5s 12202 Corrected dt: 2.126368e-01 s
30275.5s 12203 Correction factor: 1.6x
30275.5s 12204 Max wave speed detected: 23.51 m/s
30275.5s 12205 Stored output at t = 1650.0000 s (Step 7792)
30275.5s 12206 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
30275.5s 12207 [A
30275.5s 12208 
30275.5s 12209 Simulation finished at t = 1650.0000 s after 7792 steps.
30275.5s 12210 Total runtime: 0.62 seconds.
30275.5s 12211 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.32s/s]
30275.5s 12212 [REWARD_MICROSCOPE] step=14310 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30275.5s 12213 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    1.10
30275.5s 12214 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30275.5s 12215 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30275.5s 12216 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30275.5s 12217 Running simulation until t = 1665.00 s, outputting every 15.00 s
30275.5s 12218 
30275.6s 12219 [PROGRESS] Step 7800: t=1651.70/1665.00s (99.2%) | dt=0.2124s
30276.0s 12220 [PROGRESS] Step 7850: t=1662.32/1665.00s (99.8%) | dt=0.2127s
30276.1s 12221 Stored output at t = 1665.0000 s (Step 7863)
30276.1s 12222 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
30276.1s 12223 [A
30276.1s 12224 
30276.1s 12225 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.04s/s]
30276.1s 12226 Simulation finished at t = 1665.0000 s after 7863 steps.
30276.1s 12227 Total runtime: 0.62 seconds.
30276.1s 12228 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
30276.1s 12229 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30276.1s 12230 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30276.1s 12231 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30276.1s 12232 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30276.1s 12233 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30276.1s 12234 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30276.1s 12235 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30276.1s 12236 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30276.1s 12237 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30276.1s 12238 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30276.1s 12239 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30276.1s 12240 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30276.1s 12241 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30276.1s 12242 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30276.1s 12243 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30276.1s 12244 [REWARD_MICROSCOPE] step=14311 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30276.1s 12245 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30276.1s 12246 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30276.1s 12247 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30276.1s 12248 Running simulation until t = 1680.00 s, outputting every 15.00 s
30276.1s 12249 
30276.3s 12250 [PERIODIC:1000] BC_DISPATCHER [Call #13328000] current_bc_params: <class 'dict'>
30276.3s 12251 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30276.3s 12252 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30276.3s 12253 [PERIODIC:1000] BC_GPU [Call #13328000] About to launch kernel
30276.3s 12254 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30276.3s 12255 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30276.3s 12256 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30276.4s 12257 [WARNING] Automatic CFL correction applied (count: 3331900):
30276.4s 12258 Calculated CFL: 0.800 > Limit: 0.500
30276.4s 12259 Original dt: 3.408895e-01 s
30276.4s 12260 Corrected dt: 2.130559e-01 s
30276.4s 12261 Correction factor: 1.6x
30276.4s 12262 Max wave speed detected: 23.47 m/s
30276.5s 12263 [PROGRESS] Step 7900: t=1672.88/1680.00s (99.6%) | dt=0.2131s
30276.8s 12264 Stored output at t = 1680.0000 s (Step 7934)
30276.8s 12265 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
30276.8s 12266 [A
30276.8s 12267 
30276.8s 12268 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.61s/s]
30276.8s 12269 Simulation finished at t = 1680.0000 s after 7934 steps.
30276.8s 12270 Total runtime: 0.64 seconds.
30276.8s 12271 [REWARD_MICROSCOPE] step=14312 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30276.8s 12272 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30276.8s 12273 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30276.8s 12274 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30276.8s 12275 Running simulation until t = 1695.00 s, outputting every 15.00 s
30276.8s 12276 
30276.9s 12277 [PROGRESS] Step 7950: t=1683.40/1695.00s (99.3%) | dt=0.2123s
30277.3s 12278 [WARNING] Automatic CFL correction applied (count: 3332000):
30277.3s 12279 Calculated CFL: 0.800 > Limit: 0.500
30277.3s 12280 Original dt: 3.403151e-01 s
30277.3s 12281 Corrected dt: 2.126969e-01 s
30277.3s 12282 Correction factor: 1.6x
30277.3s 12283 Max wave speed detected: 23.51 m/s
30277.4s 12284 [PROGRESS] Step 8000: t=1694.03/1695.00s (99.9%) | dt=0.2128s
30277.4s 12285 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
30277.4s 12286 Stored output at t = 1695.0000 s (Step 8005)
30277.4s 12287 [A
30277.4s 12288 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.96s/s]
30277.4s 12289 
30277.4s 12290 Simulation finished at t = 1695.0000 s after 8005 steps.
30277.4s 12291 Total runtime: 0.63 seconds.
30277.4s 12292 [REWARD_MICROSCOPE] step=14313 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30277.4s 12293 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30277.4s 12294 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30277.4s 12295 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30277.4s 12296 Running simulation until t = 1710.00 s, outputting every 15.00 s
30277.4s 12297 
30277.8s 12298 [PROGRESS] Step 8050: t=1704.59/1710.00s (99.7%) | dt=0.2132s
30278.0s 12299 Stored output at t = 1710.0000 s (Step 8076)
30278.0s 12300 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
30278.0s 12301 [A
30278.0s 12302 
30278.0s 12303 Simulation finished at t = 1710.0000 s after 8076 steps.
30278.0s 12304 Total runtime: 0.62 seconds.
30278.0s 12305 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.26s/s]
30278.0s 12306 [REWARD_MICROSCOPE] step=14314 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30278.0s 12307 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30278.0s 12308 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30278.0s 12309 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30278.0s 12310 Running simulation until t = 1725.00 s, outputting every 15.00 s
30278.0s 12311 
30278.1s 12312 [WARNING] Automatic CFL correction applied (count: 3332100):
30278.1s 12313 Calculated CFL: 0.800 > Limit: 0.500
30278.1s 12314 Original dt: 3.397193e-01 s
30278.1s 12315 Corrected dt: 2.123245e-01 s
30278.1s 12316 Correction factor: 1.6x
30278.1s 12317 Max wave speed detected: 23.55 m/s
30278.2s 12318 [PROGRESS] Step 8100: t=1715.10/1725.00s (99.4%) | dt=0.2124s
30278.5s 12319 [PERIODIC:1000] BC_DISPATCHER [Call #13329000] current_bc_params: <class 'dict'>
30278.5s 12320 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30278.5s 12321 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30278.5s 12322 [PERIODIC:1000] BC_GPU [Call #13329000] About to launch kernel
30278.5s 12323 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30278.5s 12324 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30278.5s 12325 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30278.7s 12326 Stored output at t = 1725.0000 s (Step 8147)
30278.7s 12327 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
30278.7s 12328 [A
30278.7s 12329 
30278.7s 12330 Simulation finished at t = 1725.0000 s after 8147 steps.
30278.7s 12331 Total runtime: 0.62 seconds.
30278.7s 12332 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 24.03s/s]
30278.7s 12333 [REWARD_MICROSCOPE] step=14315 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30278.7s 12334 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30278.7s 12335 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30278.7s 12336 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30278.7s 12337 Running simulation until t = 1740.00 s, outputting every 15.00 s
30278.7s 12338 
30278.7s 12339 [PROGRESS] Step 8150: t=1725.64/1740.00s (99.2%) | dt=0.2129s
30279.0s 12340 [WARNING] Automatic CFL correction applied (count: 3332200):
30279.0s 12341 Calculated CFL: 0.800 > Limit: 0.500
30279.0s 12342 Original dt: 3.411064e-01 s
30279.0s 12343 Corrected dt: 2.131915e-01 s
30279.0s 12344 Correction factor: 1.6x
30279.0s 12345 Max wave speed detected: 23.45 m/s
30279.1s 12346 [PROGRESS] Step 8200: t=1736.29/1740.00s (99.8%) | dt=0.2133s
30279.3s 12347 Stored output at t = 1740.0000 s (Step 8218)
30279.3s 12348 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
30279.3s 12349 [A
30279.3s 12350 
30279.3s 12351 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.50s/s]
30279.3s 12352 Simulation finished at t = 1740.0000 s after 8218 steps.
30279.3s 12353 Total runtime: 0.61 seconds.
30279.3s 12354 [REWARD_MICROSCOPE] step=14316 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30279.3s 12355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30279.3s 12356 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30279.3s 12357 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30279.3s 12358 Running simulation until t = 1755.00 s, outputting every 15.00 s
30279.3s 12359 
30279.5s 12360 [PROGRESS] Step 8250: t=1746.80/1755.00s (99.5%) | dt=0.2125s
30279.9s 12361 [WARNING] Automatic CFL correction applied (count: 3332300):
30279.9s 12362 Calculated CFL: 0.800 > Limit: 0.500
30279.9s 12363 Original dt: 3.405361e-01 s
30279.9s 12364 Corrected dt: 2.128351e-01 s
30279.9s 12365 Correction factor: 1.6x
30279.9s 12366 Max wave speed detected: 23.49 m/s
30279.9s 12367 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
30279.9s 12368 [A
30279.9s 12369 Stored output at t = 1755.0000 s (Step 8289)
30279.9s 12370 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.74s/s]
30279.9s 12371 
30279.9s 12372 Simulation finished at t = 1755.0000 s after 8289 steps.
30279.9s 12373 Total runtime: 0.61 seconds.
30279.9s 12374 [REWARD_MICROSCOPE] step=14317 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30279.9s 12375 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30279.9s 12376 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30279.9s 12377 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30279.9s 12378 Running simulation until t = 1770.00 s, outputting every 15.00 s
30279.9s 12379 
30280.0s 12380 [PROGRESS] Step 8300: t=1757.34/1770.00s (99.3%) | dt=0.2129s
30280.4s 12381 [PROGRESS] Step 8350: t=1768.00/1770.00s (99.9%) | dt=0.2129s
30280.5s 12382 Stored output at t = 1770.0000 s (Step 8360)
30280.5s 12383 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
30280.5s 12384 [A
30280.5s 12385 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.43s/s]
30280.5s 12386 
30280.5s 12387 Simulation finished at t = 1770.0000 s after 8360 steps.
30280.5s 12388 Total runtime: 0.61 seconds.
30280.5s 12389 [REWARD_MICROSCOPE] step=14318 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30280.5s 12390 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30280.5s 12391 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30280.5s 12392 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30280.5s 12393 Running simulation until t = 1785.00 s, outputting every 15.00 s
30280.5s 12394 
30280.7s 12395 [PERIODIC:1000] BC_DISPATCHER [Call #13330000] current_bc_params: <class 'dict'>
30280.7s 12396 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30280.7s 12397 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30280.7s 12398 [PERIODIC:1000] BC_GPU [Call #13330000] About to launch kernel
30280.7s 12399 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30280.7s 12400 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30280.7s 12401 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30280.7s 12402 [WARNING] Automatic CFL correction applied (count: 3332400):
30280.7s 12403 Calculated CFL: 0.800 > Limit: 0.500
30280.7s 12404 Original dt: 3.399493e-01 s
30280.7s 12405 Corrected dt: 2.124683e-01 s
30280.7s 12406 Correction factor: 1.6x
30280.7s 12407 Max wave speed detected: 23.53 m/s
30280.9s 12408 [PROGRESS] Step 8400: t=1778.50/1785.00s (99.6%) | dt=0.2126s
30281.2s 12409 Stored output at t = 1785.0000 s (Step 8431)
30281.2s 12410 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
30281.2s 12411 [A
30281.2s 12412 
30281.2s 12413 Simulation finished at t = 1785.0000 s after 8431 steps.
30281.2s 12414 Total runtime: 0.66 seconds.
30281.2s 12415 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 22.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 22.81s/s]
30281.2s 12416 [REWARD_MICROSCOPE] step=14319 t=1785.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30281.2s 12417 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30281.2s 12418 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30281.2s 12419 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30281.2s 12420 Running simulation until t = 1800.00 s, outputting every 15.00 s
30281.2s 12421 
30281.3s 12422 [PROGRESS] Step 8450: t=1789.05/1800.00s (99.4%) | dt=0.2130s
30281.7s 12423 [WARNING] Automatic CFL correction applied (count: 3332500):
30281.7s 12424 Calculated CFL: 0.800 > Limit: 0.500
30281.7s 12425 Original dt: 3.409227e-01 s
30281.7s 12426 Corrected dt: 2.130767e-01 s
30281.7s 12427 Correction factor: 1.6x
30281.7s 12428 Max wave speed detected: 23.47 m/s
30281.8s 12429 [PROGRESS] Step 8500: t=1799.70/1800.00s (100.0%) | dt=0.2126s
30281.8s 12430 Stored output at t = 1800.0000 s (Step 8502)
30281.8s 12431 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
30281.8s 12432 [A
30281.8s 12433 
30281.8s 12434 Simulation finished at t = 1800.0000 s after 8502 steps.
30281.8s 12435 Total runtime: 0.63 seconds.
30281.8s 12436 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 23.94s/s]
30281.8s 12437 [REWARD_MICROSCOPE] step=14320 t=1800.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30281.8s 12438 [STEP  120] t= 1800.0s | phase=0 | reward=   0.01 | total_reward=    1.20
30281.8s 12439 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30281.8s 12440 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30281.8s 12441 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30281.8s 12442 Running simulation until t = 1815.00 s, outputting every 15.00 s
30281.8s 12443 
30282.2s 12444 [PROGRESS] Step 8550: t=1810.20/1815.00s (99.7%) | dt=0.2126s
30282.4s 12445 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
30282.4s 12446 [A
30282.4s 12447 Stored output at t = 1815.0000 s (Step 8573)
30282.4s 12448 
30282.4s 12449 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.07s/s]
30282.4s 12450 Simulation finished at t = 1815.0000 s after 8573 steps.
30282.4s 12451 Total runtime: 0.62 seconds.
30282.4s 12452 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
30282.4s 12453 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30282.4s 12454 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30282.4s 12455 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30282.4s 12456 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30282.4s 12457 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30282.4s 12458 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30282.4s 12459 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30282.4s 12460 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30282.4s 12461 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30282.4s 12462 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30282.4s 12463 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30282.4s 12464 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30282.4s 12465 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30282.4s 12466 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30282.4s 12467 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30282.4s 12468 [REWARD_MICROSCOPE] step=14321 t=1815.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30282.4s 12469 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30282.4s 12470 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30282.4s 12471 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30282.4s 12472 Running simulation until t = 1830.00 s, outputting every 15.00 s
30282.4s 12473 
30282.6s 12474 [WARNING] Automatic CFL correction applied (count: 3332600):
30282.6s 12475 Calculated CFL: 0.800 > Limit: 0.500
30282.6s 12476 Original dt: 3.407491e-01 s
30282.6s 12477 Corrected dt: 2.129682e-01 s
30282.6s 12478 Correction factor: 1.6x
30282.6s 12479 Max wave speed detected: 23.48 m/s
30282.7s 12480 [PROGRESS] Step 8600: t=1820.75/1830.00s (99.5%) | dt=0.2131s
30283.0s 12481 [PERIODIC:1000] BC_DISPATCHER [Call #13331000] current_bc_params: <class 'dict'>
30283.0s 12482 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30283.0s 12483 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30283.0s 12484 [PERIODIC:1000] BC_GPU [Call #13331000] About to launch kernel
30283.0s 12485 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30283.0s 12486 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30283.0s 12487 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30283.1s 12488 Stored output at t = 1830.0000 s (Step 8644)
30283.1s 12489 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
30283.1s 12490 [A
30283.1s 12491 
30283.1s 12492 Simulation finished at t = 1830.0000 s after 8644 steps.
30283.1s 12493 Total runtime: 0.64 seconds.
30283.1s 12494 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 23.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 23.56s/s]
30283.1s 12495 [REWARD_MICROSCOPE] step=14322 t=1830.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30283.1s 12496 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30283.1s 12497 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30283.1s 12498 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30283.1s 12499 Running simulation until t = 1845.00 s, outputting every 15.00 s
30283.1s 12500 
30283.1s 12501 [PROGRESS] Step 8650: t=1831.27/1845.00s (99.3%) | dt=0.2124s
30283.4s 12502 [WARNING] Automatic CFL correction applied (count: 3332700):
30283.4s 12503 Calculated CFL: 0.800 > Limit: 0.500
30283.4s 12504 Original dt: 3.401756e-01 s
30283.4s 12505 Corrected dt: 2.126097e-01 s
30283.4s 12506 Correction factor: 1.6x
30283.4s 12507 Max wave speed detected: 23.52 m/s
30283.5s 12508 [PROGRESS] Step 8700: t=1841.90/1845.00s (99.8%) | dt=0.2127s
30283.7s 12509 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
30283.7s 12510 Stored output at t = 1845.0000 s (Step 8715)
30283.7s 12511 [A
30283.7s 12512 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.10s/s]
30283.7s 12513 
30283.7s 12514 Simulation finished at t = 1845.0000 s after 8715 steps.
30283.7s 12515 Total runtime: 0.62 seconds.
30283.7s 12516 [REWARD_MICROSCOPE] step=14323 t=1845.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30283.7s 12517 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30283.7s 12518 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30283.7s 12519 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30283.7s 12520 Running simulation until t = 1860.00 s, outputting every 15.00 s
30283.7s 12521 
30284.0s 12522 [PROGRESS] Step 8750: t=1852.45/1860.00s (99.6%) | dt=0.2131s
30284.3s 12523 Stored output at t = 1860.0000 s (Step 8786)
30284.3s 12524 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A
30284.3s 12525 [A
30284.3s 12526 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.49s/s]
30284.3s 12527 
30284.3s 12528 Simulation finished at t = 1860.0000 s after 8786 steps.
30284.3s 12529 Total runtime: 0.61 seconds.
30284.3s 12530 [REWARD_MICROSCOPE] step=14324 t=1860.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30284.3s 12531 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30284.3s 12532 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30284.3s 12533 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30284.3s 12534 Running simulation until t = 1875.00 s, outputting every 15.00 s
30284.3s 12535 
30284.3s 12536 [WARNING] Automatic CFL correction applied (count: 3332800):
30284.3s 12537 Calculated CFL: 0.800 > Limit: 0.500
30284.3s 12538 Original dt: 3.399530e-01 s
30284.3s 12539 Corrected dt: 2.124706e-01 s
30284.3s 12540 Correction factor: 1.6x
30284.3s 12541 Max wave speed detected: 23.53 m/s
30284.4s 12542 [PROGRESS] Step 8800: t=1862.97/1875.00s (99.4%) | dt=0.2123s
30284.9s 12543 [PROGRESS] Step 8850: t=1873.60/1875.00s (99.9%) | dt=0.2128s
30284.9s 12544 Stored output at t = 1875.0000 s (Step 8857)
30284.9s 12545 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1860.0/1875.0 [00:00<?, ?s/s][A
30284.9s 12546 [A
30284.9s 12547 
30284.9s 12548 Simulation finished at t = 1875.0000 s after 8857 steps.
30284.9s 12549 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.12s/s]
30284.9s 12550 Total runtime: 0.62 seconds.
30284.9s 12551 [REWARD_MICROSCOPE] step=14325 t=1875.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30284.9s 12552 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30284.9s 12553 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30284.9s 12554 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30284.9s 12555 Running simulation until t = 1890.00 s, outputting every 15.00 s
30284.9s 12556 
30285.1s 12557 [PERIODIC:1000] BC_DISPATCHER [Call #13332000] current_bc_params: <class 'dict'>
30285.1s 12558 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30285.1s 12559 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30285.1s 12560 [PERIODIC:1000] BC_GPU [Call #13332000] About to launch kernel
30285.1s 12561 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30285.1s 12562 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30285.1s 12563 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30285.2s 12564 [WARNING] Automatic CFL correction applied (count: 3332900):
30285.2s 12565 Calculated CFL: 0.800 > Limit: 0.500
30285.2s 12566 Original dt: 3.409728e-01 s
30285.2s 12567 Corrected dt: 2.131080e-01 s
30285.2s 12568 Correction factor: 1.6x
30285.2s 12569 Max wave speed detected: 23.46 m/s
30285.3s 12570 [PROGRESS] Step 8900: t=1884.16/1890.00s (99.7%) | dt=0.2132s
30285.5s 12571 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1875.0/1890.0 [00:00<?, ?s/s][A
30285.5s 12572 Stored output at t = 1890.0000 s (Step 8928)
30285.5s 12573 [A
30285.5s 12574 
30285.5s 12575 Simulation finished at t = 1890.0000 s after 8928 steps.
30285.5s 12576 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.75s/s]
30285.5s 12577 Total runtime: 0.61 seconds.
30285.5s 12578 [REWARD_MICROSCOPE] step=14326 t=1890.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30285.5s 12579 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30285.5s 12580 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30285.5s 12581 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30285.5s 12582 Running simulation until t = 1905.00 s, outputting every 15.00 s
30285.5s 12583 
30285.7s 12584 [PROGRESS] Step 8950: t=1894.67/1905.00s (99.5%) | dt=0.2124s
30286.0s 12585 [WARNING] Automatic CFL correction applied (count: 3333000):
30286.0s 12586 Calculated CFL: 0.800 > Limit: 0.500
30286.0s 12587 Original dt: 3.403992e-01 s
30286.0s 12588 Corrected dt: 2.127495e-01 s
30286.0s 12589 Correction factor: 1.6x
30286.0s 12590 Max wave speed detected: 23.50 m/s
30286.1s 12591 Stored output at t = 1905.0000 s (Step 8999)
30286.1s 12592 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1890.0/1905.0 [00:00<?, ?s/s][A
30286.1s 12593 [A
30286.1s 12594 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.81s/s]
30286.1s 12595 
30286.1s 12596 Simulation finished at t = 1905.0000 s after 8999 steps.
30286.1s 12597 Total runtime: 0.60 seconds.
30286.1s 12598 [REWARD_MICROSCOPE] step=14327 t=1905.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30286.1s 12599 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30286.1s 12600 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30286.1s 12601 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30286.1s 12602 Running simulation until t = 1920.00 s, outputting every 15.00 s
30286.1s 12603 
30286.1s 12604 [PROGRESS] Step 9000: t=1905.21/1920.00s (99.2%) | dt=0.2128s
30286.6s 12605 [PROGRESS] Step 9050: t=1915.87/1920.00s (99.8%) | dt=0.2133s
30286.8s 12606 Stored output at t = 1920.0000 s (Step 9070)
30286.8s 12607 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1905.0/1920.0 [00:00<?, ?s/s][A
30286.8s 12608 [A
30286.8s 12609 
30286.8s 12610 Simulation finished at t = 1920.0000 s after 9070 steps.
30286.8s 12611 Total runtime: 0.61 seconds.
30286.8s 12612 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.44s/s]
30286.8s 12613 [REWARD_MICROSCOPE] step=14328 t=1920.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30286.8s 12614 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30286.8s 12615 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30286.8s 12616 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30286.8s 12617 Running simulation until t = 1935.00 s, outputting every 15.00 s
30286.8s 12618 
30286.9s 12619 [WARNING] Automatic CFL correction applied (count: 3333100):
30286.9s 12620 Calculated CFL: 0.800 > Limit: 0.500
30286.9s 12621 Original dt: 3.397973e-01 s
30286.9s 12622 Corrected dt: 2.123733e-01 s
30286.9s 12623 Correction factor: 1.6x
30286.9s 12624 Max wave speed detected: 23.54 m/s
30287.0s 12625 [PROGRESS] Step 9100: t=1926.37/1935.00s (99.6%) | dt=0.2125s
30287.3s 12626 [PERIODIC:1000] BC_DISPATCHER [Call #13333000] current_bc_params: <class 'dict'>
30287.3s 12627 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30287.3s 12628 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30287.3s 12629 [PERIODIC:1000] BC_GPU [Call #13333000] About to launch kernel
30287.3s 12630 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30287.3s 12631 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30287.3s 12632 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30287.4s 12633 Stored output at t = 1935.0000 s (Step 9141)
30287.4s 12634 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1920.0/1935.0 [00:00<?, ?s/s][A
30287.4s 12635 [A
30287.4s 12636 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.09s/s]
30287.4s 12637 
30287.4s 12638 Simulation finished at t = 1935.0000 s after 9141 steps.
30287.4s 12639 Total runtime: 0.62 seconds.
30287.4s 12640 [REWARD_MICROSCOPE] step=14329 t=1935.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30287.4s 12641 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30287.4s 12642 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30287.4s 12643 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30287.4s 12644 Running simulation until t = 1950.00 s, outputting every 15.00 s
30287.4s 12645 
30287.5s 12646 [PROGRESS] Step 9150: t=1936.92/1950.00s (99.3%) | dt=0.2129s
30287.8s 12647 [WARNING] Automatic CFL correction applied (count: 3333200):
30287.8s 12648 Calculated CFL: 0.800 > Limit: 0.500
30287.8s 12649 Original dt: 3.411876e-01 s
30287.8s 12650 Corrected dt: 2.132423e-01 s
30287.8s 12651 Correction factor: 1.6x
30287.8s 12652 Max wave speed detected: 23.45 m/s
30287.9s 12653 [PROGRESS] Step 9200: t=1947.57/1950.00s (99.9%) | dt=0.2130s
30288.0s 12654 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1935.0/1950.0 [00:00<?, ?s/s][A
30288.0s 12655 [A
30288.0s 12656 Stored output at t = 1950.0000 s (Step 9212)
30288.0s 12657 
30288.0s 12658 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 24.57s/s]
30288.0s 12659 Simulation finished at t = 1950.0000 s after 9212 steps.
30288.0s 12660 Total runtime: 0.61 seconds.
30288.0s 12661 [REWARD_MICROSCOPE] step=14330 t=1950.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30288.0s 12662 [STEP  130] t= 1950.0s | phase=0 | reward=   0.01 | total_reward=    1.30
30288.0s 12663 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30288.0s 12664 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30288.0s 12665 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30288.0s 12666 Running simulation until t = 1965.00 s, outputting every 15.00 s
30288.0s 12667 
30288.3s 12668 [PROGRESS] Step 9250: t=1958.07/1965.00s (99.6%) | dt=0.2125s
30288.6s 12669 Stored output at t = 1965.0000 s (Step 9283)
30288.6s 12670 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1950.0/1965.0 [00:00<?, ?s/s][A
30288.6s 12671 [A
30288.6s 12672 
30288.6s 12673 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.25s/s]
30288.6s 12674 Simulation finished at t = 1965.0000 s after 9283 steps.
30288.6s 12675 Total runtime: 0.62 seconds.
30288.6s 12676 [QUEUE_DIAGNOSTIC] ===== Step 130 t=1965.0s =====
30288.6s 12677 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30288.6s 12678 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30288.6s 12679 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30288.6s 12680 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30288.6s 12681 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30288.6s 12682 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30288.6s 12683 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30288.6s 12684 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30288.6s 12685 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30288.6s 12686 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30288.6s 12687 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30288.6s 12688 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30288.6s 12689 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30288.6s 12690 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30288.6s 12691 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30288.6s 12692 [REWARD_MICROSCOPE] step=14331 t=1965.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30288.6s 12693 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30288.6s 12694 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30288.6s 12695 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30288.6s 12696 Running simulation until t = 1980.00 s, outputting every 15.00 s
30288.6s 12697 
30288.7s 12698 [WARNING] Automatic CFL correction applied (count: 3333300):
30288.7s 12699 Calculated CFL: 0.800 > Limit: 0.500
30288.7s 12700 Original dt: 3.406104e-01 s
30288.7s 12701 Corrected dt: 2.128815e-01 s
30288.7s 12702 Correction factor: 1.6x
30288.7s 12703 Max wave speed detected: 23.49 m/s
30288.8s 12704 [PROGRESS] Step 9300: t=1968.62/1980.00s (99.4%) | dt=0.2130s
30289.2s 12705 [PROGRESS] Step 9350: t=1979.27/1980.00s (100.0%) | dt=0.2127s
30289.2s 12706 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1965.0/1980.0 [00:00<?, ?s/s][A
30289.2s 12707 [A
30289.2s 12708 Stored output at t = 1980.0000 s (Step 9354)
30289.2s 12709 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.49s/s]
30289.2s 12710 
30289.2s 12711 Simulation finished at t = 1980.0000 s after 9354 steps.
30289.2s 12712 Total runtime: 0.61 seconds.
30289.2s 12713 [REWARD_MICROSCOPE] step=14332 t=1980.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30289.2s 12714 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30289.2s 12715 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30289.2s 12716 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30289.2s 12717 Running simulation until t = 1995.00 s, outputting every 15.00 s
30289.2s 12718 
30289.5s 12719 [PERIODIC:1000] BC_DISPATCHER [Call #13334000] current_bc_params: <class 'dict'>
30289.5s 12720 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30289.5s 12721 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30289.5s 12722 [PERIODIC:1000] BC_GPU [Call #13334000] About to launch kernel
30289.5s 12723 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30289.5s 12724 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30289.5s 12725 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30289.5s 12726 [WARNING] Automatic CFL correction applied (count: 3333400):
30289.5s 12727 Calculated CFL: 0.800 > Limit: 0.500
30289.5s 12728 Original dt: 3.400365e-01 s
30289.5s 12729 Corrected dt: 2.125228e-01 s
30289.5s 12730 Correction factor: 1.6x
30289.5s 12731 Max wave speed detected: 23.53 m/s
30289.6s 12732 [PROGRESS] Step 9400: t=1989.77/1995.00s (99.7%) | dt=0.2126s
30289.8s 12733 Stored output at t = 1995.0000 s (Step 9425)
30289.8s 12734 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1980.0/1995.0 [00:00<?, ?s/s][A
30289.8s 12735 [A
30289.8s 12736 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.64s/s]
30289.8s 12737 
30289.8s 12738 Simulation finished at t = 1995.0000 s after 9425 steps.
30289.8s 12739 Total runtime: 0.61 seconds.
30289.8s 12740 [REWARD_MICROSCOPE] step=14333 t=1995.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30289.8s 12741 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30289.8s 12742 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30289.8s 12743 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30289.8s 12744 Running simulation until t = 2010.00 s, outputting every 15.00 s
30289.8s 12745 
30290.1s 12746 [PROGRESS] Step 9450: t=2000.32/2010.00s (99.5%) | dt=0.2130s
30290.4s 12747 [WARNING] Automatic CFL correction applied (count: 3333500):
30290.4s 12748 Calculated CFL: 0.800 > Limit: 0.500
30290.4s 12749 Original dt: 3.404624e-01 s
30290.4s 12750 Corrected dt: 2.127890e-01 s
30290.4s 12751 Correction factor: 1.6x
30290.4s 12752 Max wave speed detected: 23.50 m/s
30290.5s 12753 Stored output at t = 2010.0000 s (Step 9496)
30290.5s 12754 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1995.0/2010.0 [00:00<?, ?s/s][A
30290.5s 12755 [A
30290.5s 12756 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.62s/s]
30290.5s 12757 
30290.5s 12758 Simulation finished at t = 2010.0000 s after 9496 steps.
30290.5s 12759 Total runtime: 0.61 seconds.
30290.5s 12760 [REWARD_MICROSCOPE] step=14334 t=2010.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30290.5s 12761 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30290.5s 12762 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30290.5s 12763 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30290.5s 12764 Running simulation until t = 2025.00 s, outputting every 15.00 s
30290.5s 12765 
30290.5s 12766 [PROGRESS] Step 9500: t=2010.85/2025.00s (99.3%) | dt=0.2124s
30290.9s 12767 [PROGRESS] Step 9550: t=2021.47/2025.00s (99.8%) | dt=0.2127s
30291.1s 12768 Stored output at t = 2025.0000 s (Step 9567)
30291.1s 12769 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2010.0/2025.0 [00:00<?, ?s/s][A
30291.1s 12770 [A
30291.1s 12771 
30291.1s 12772 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 23.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 23.50s/s]
30291.1s 12773 Simulation finished at t = 2025.0000 s after 9567 steps.
30291.1s 12774 Total runtime: 0.64 seconds.
30291.1s 12775 [REWARD_MICROSCOPE] step=14335 t=2025.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30291.1s 12776 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30291.1s 12777 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30291.1s 12778 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30291.1s 12779 Running simulation until t = 2040.00 s, outputting every 15.00 s
30291.1s 12780 
30291.3s 12781 [WARNING] Automatic CFL correction applied (count: 3333600):
30291.3s 12782 Calculated CFL: 0.800 > Limit: 0.500
30291.3s 12783 Original dt: 3.408331e-01 s
30291.3s 12784 Corrected dt: 2.130207e-01 s
30291.3s 12785 Correction factor: 1.6x
30291.3s 12786 Max wave speed detected: 23.47 m/s
30291.4s 12787 [PROGRESS] Step 9600: t=2032.03/2040.00s (99.6%) | dt=0.2131s
30291.7s 12788 [PERIODIC:1000] BC_DISPATCHER [Call #13335000] current_bc_params: <class 'dict'>
30291.7s 12789 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30291.7s 12790 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30291.7s 12791 [PERIODIC:1000] BC_GPU [Call #13335000] About to launch kernel
30291.7s 12792 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30291.7s 12793 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30291.7s 12794 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30291.7s 12795 Stored output at t = 2040.0000 s (Step 9638)
30291.7s 12796 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2025.0/2040.0 [00:00<?, ?s/s][A
30291.7s 12797 [A
30291.7s 12798 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.20s/s]
30291.7s 12799 
30291.7s 12800 Simulation finished at t = 2040.0000 s after 9638 steps.
30291.7s 12801 Total runtime: 0.62 seconds.
30291.7s 12802 [REWARD_MICROSCOPE] step=14336 t=2040.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30291.7s 12803 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30291.7s 12804 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30291.7s 12805 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30291.7s 12806 Running simulation until t = 2055.00 s, outputting every 15.00 s
30291.7s 12807 
30291.8s 12808 [PROGRESS] Step 9650: t=2042.55/2055.00s (99.4%) | dt=0.2123s
30292.2s 12809 [WARNING] Automatic CFL correction applied (count: 3333700):
30292.2s 12810 Calculated CFL: 0.800 > Limit: 0.500
30292.2s 12811 Original dt: 3.402592e-01 s
30292.2s 12812 Corrected dt: 2.126620e-01 s
30292.2s 12813 Correction factor: 1.6x
30292.2s 12814 Max wave speed detected: 23.51 m/s
30292.3s 12815 [PROGRESS] Step 9700: t=2053.18/2055.00s (99.9%) | dt=0.2128s
30292.3s 12816 Stored output at t = 2055.0000 s (Step 9709)
30292.3s 12817 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2040.0/2055.0 [00:00<?, ?s/s][A
30292.3s 12818 [A
30292.3s 12819 
30292.3s 12820 Simulation finished at t = 2055.0000 s after 9709 steps.
30292.3s 12821 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.45s/s]
30292.3s 12822 Total runtime: 0.61 seconds.
30292.3s 12823 [REWARD_MICROSCOPE] step=14337 t=2055.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30292.3s 12824 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30292.3s 12825 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30292.3s 12826 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30292.3s 12827 Running simulation until t = 2070.00 s, outputting every 15.00 s
30292.3s 12828 
30292.7s 12829 [PROGRESS] Step 9750: t=2063.73/2070.00s (99.7%) | dt=0.2132s
30293.0s 12830 Stored output at t = 2070.0000 s (Step 9780)
30293.0s 12831 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2055.0/2070.0 [00:00<?, ?s/s][A
30293.0s 12832 [A
30293.0s 12833 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.13s/s]
30293.0s 12834 
30293.0s 12835 Simulation finished at t = 2070.0000 s after 9780 steps.
30293.0s 12836 Total runtime: 0.62 seconds.
30293.0s 12837 [REWARD_MICROSCOPE] step=14338 t=2070.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30293.0s 12838 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30293.0s 12839 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30293.0s 12840 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30293.0s 12841 Running simulation until t = 2085.00 s, outputting every 15.00 s
30293.0s 12842 
30293.0s 12843 [WARNING] Automatic CFL correction applied (count: 3333800):
30293.0s 12844 Calculated CFL: 0.800 > Limit: 0.500
30293.0s 12845 Original dt: 3.397413e-01 s
30293.0s 12846 Corrected dt: 2.123383e-01 s
30293.0s 12847 Correction factor: 1.6x
30293.0s 12848 Max wave speed detected: 23.55 m/s
30293.1s 12849 [PROGRESS] Step 9800: t=2074.25/2085.00s (99.5%) | dt=0.2124s
30293.6s 12850 [PROGRESS] Step 9850: t=2084.88/2085.00s (100.0%) | dt=0.2128s
30293.6s 12851 Stored output at t = 2085.0000 s (Step 9851)
30293.6s 12852 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2070.0/2085.0 [00:00<?, ?s/s][A
30293.6s 12853 [A
30293.6s 12854 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.45s/s]
30293.6s 12855 
30293.6s 12856 Simulation finished at t = 2085.0000 s after 9851 steps.
30293.6s 12857 Total runtime: 0.61 seconds.
30293.6s 12858 [REWARD_MICROSCOPE] step=14339 t=2085.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30293.6s 12859 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30293.6s 12860 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30293.6s 12861 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30293.6s 12862 Running simulation until t = 2100.00 s, outputting every 15.00 s
30293.6s 12863 
30293.9s 12864 [PERIODIC:1000] BC_DISPATCHER [Call #13336000] current_bc_params: <class 'dict'>
30293.9s 12865 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30293.9s 12866 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30293.9s 12867 [PERIODIC:1000] BC_GPU [Call #13336000] About to launch kernel
30293.9s 12868 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30293.9s 12869 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30293.9s 12870 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30293.9s 12871 [WARNING] Automatic CFL correction applied (count: 3333900):
30293.9s 12872 Calculated CFL: 0.800 > Limit: 0.500
30293.9s 12873 Original dt: 3.410527e-01 s
30293.9s 12874 Corrected dt: 2.131579e-01 s
30293.9s 12875 Correction factor: 1.6x
30293.9s 12876 Max wave speed detected: 23.46 m/s
30294.0s 12877 [PROGRESS] Step 9900: t=2095.44/2100.00s (99.8%) | dt=0.2133s
30294.2s 12878 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2085.0/2100.0 [00:00<?, ?s/s][A
30294.2s 12879 [A
30294.2s 12880 Stored output at t = 2100.0000 s (Step 9922)
30294.2s 12881 
30294.2s 12882 Simulation finished at t = 2100.0000 s after 9922 steps.
30294.2s 12883 Total runtime: 0.66 seconds.
30294.2s 12884 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 22.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 22.84s/s]
30294.2s 12885 [REWARD_MICROSCOPE] step=14340 t=2100.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30294.2s 12886 [STEP  140] t= 2100.0s | phase=0 | reward=   0.01 | total_reward=    1.40
30294.2s 12887 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30294.2s 12888 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30294.2s 12889 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30294.2s 12890 Running simulation until t = 2115.00 s, outputting every 15.00 s
30294.2s 12891 
30294.5s 12892 [PROGRESS] Step 9950: t=2105.95/2115.00s (99.6%) | dt=0.2125s
30294.8s 12893 [WARNING] Automatic CFL correction applied (count: 3334000):
30294.8s 12894 Calculated CFL: 0.800 > Limit: 0.500
30294.8s 12895 Original dt: 3.404818e-01 s
30294.8s 12896 Corrected dt: 2.128011e-01 s
30294.8s 12897 Correction factor: 1.6x
30294.8s 12898 Max wave speed detected: 23.50 m/s
30294.9s 12899 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2100.0/2115.0 [00:00<?, ?s/s][A
30294.9s 12900 [A
30294.9s 12901 Stored output at t = 2115.0000 s (Step 9993)
30294.9s 12902 
30294.9s 12903 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.27s/s]
30294.9s 12904 Simulation finished at t = 2115.0000 s after 9993 steps.
30294.9s 12905 Total runtime: 0.62 seconds.
30294.9s 12906 [QUEUE_DIAGNOSTIC] ===== Step 140 t=2115.0s =====
30294.9s 12907 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30294.9s 12908 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30294.9s 12909 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30294.9s 12910 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30294.9s 12911 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30294.9s 12912 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30294.9s 12913 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30294.9s 12914 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30294.9s 12915 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30294.9s 12916 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30294.9s 12917 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30294.9s 12918 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30294.9s 12919 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30294.9s 12920 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30294.9s 12921 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30294.9s 12922 [REWARD_MICROSCOPE] step=14341 t=2115.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30294.9s 12923 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30294.9s 12924 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30294.9s 12925 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30294.9s 12926 Running simulation until t = 2130.00 s, outputting every 15.00 s
30294.9s 12927 
30294.9s 12928 [PROGRESS] Step 10000: t=2116.49/2130.00s (99.4%) | dt=0.2129s
30295.4s 12929 [PROGRESS] Step 10050: t=2127.15/2130.00s (99.9%) | dt=0.2131s
30295.5s 12930 Stored output at t = 2130.0000 s (Step 10064)
30295.5s 12931 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2115.0/2130.0 [00:00<?, ?s/s][A
30295.5s 12932 [A
30295.5s 12933 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.38s/s]
30295.5s 12934 
30295.5s 12935 Simulation finished at t = 2130.0000 s after 10064 steps.
30295.5s 12936 Total runtime: 0.62 seconds.
30295.5s 12937 [REWARD_MICROSCOPE] step=14342 t=2130.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30295.5s 12938 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30295.5s 12939 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30295.5s 12940 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30295.5s 12941 Running simulation until t = 2145.00 s, outputting every 15.00 s
30295.5s 12942 
30295.7s 12943 [WARNING] Automatic CFL correction applied (count: 3334100):
30295.7s 12944 Calculated CFL: 0.800 > Limit: 0.500
30295.7s 12945 Original dt: 3.398890e-01 s
30295.7s 12946 Corrected dt: 2.124306e-01 s
30295.7s 12947 Correction factor: 1.6x
30295.7s 12948 Max wave speed detected: 23.54 m/s
30295.8s 12949 [PROGRESS] Step 10100: t=2137.65/2145.00s (99.7%) | dt=0.2125s
30296.1s 12950 [PERIODIC:1000] BC_DISPATCHER [Call #13337000] current_bc_params: <class 'dict'>
30296.1s 12951 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30296.1s 12952 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30296.1s 12953 [PERIODIC:1000] BC_GPU [Call #13337000] About to launch kernel
30296.1s 12954 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30296.1s 12955 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30296.1s 12956 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30296.1s 12957 Stored output at t = 2145.0000 s (Step 10135)
30296.1s 12958 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2130.0/2145.0 [00:00<?, ?s/s][A
30296.1s 12959 [A
30296.1s 12960 
30296.1s 12961 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.54s/s]
30296.1s 12962 Simulation finished at t = 2145.0000 s after 10135 steps.
30296.1s 12963 Total runtime: 0.64 seconds.
30296.1s 12964 [REWARD_MICROSCOPE] step=14343 t=2145.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30296.1s 12965 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30296.1s 12966 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30296.1s 12967 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30296.1s 12968 Running simulation until t = 2160.00 s, outputting every 15.00 s
30296.1s 12969 
30296.3s 12970 [PROGRESS] Step 10150: t=2148.19/2160.00s (99.5%) | dt=0.2130s
30296.6s 12971 [WARNING] Automatic CFL correction applied (count: 3334200):
30296.6s 12972 Calculated CFL: 0.800 > Limit: 0.500
30296.6s 12973 Original dt: 3.412697e-01 s
30296.6s 12974 Corrected dt: 2.132935e-01 s
30296.6s 12975 Correction factor: 1.6x
30296.6s 12976 Max wave speed detected: 23.44 m/s
30296.7s 12977 [PROGRESS] Step 10200: t=2158.85/2160.00s (99.9%) | dt=0.2127s
30296.8s 12978 Stored output at t = 2160.0000 s (Step 10206)
30296.8s 12979 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2145.0/2160.0 [00:00<?, ?s/s][A
30296.8s 12980 [A
30296.8s 12981 
30296.8s 12982 Simulation finished at t = 2160.0000 s after 10206 steps.
30296.8s 12983 Total runtime: 0.65 seconds.
30296.8s 12984 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 23.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 23.16s/s]
30296.8s 12985 [REWARD_MICROSCOPE] step=14344 t=2160.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30296.8s 12986 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30296.8s 12987 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30296.8s 12988 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30296.8s 12989 Running simulation until t = 2175.00 s, outputting every 15.00 s
30296.8s 12990 
30297.2s 12991 [PROGRESS] Step 10250: t=2169.35/2175.00s (99.7%) | dt=0.2126s
30297.4s 12992 Stored output at t = 2175.0000 s (Step 10277)
30297.4s 12993 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2160.0/2175.0 [00:00<?, ?s/s][A
30297.4s 12994 [A
30297.4s 12995 
30297.4s 12996 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.91s/s]
30297.4s 12997 Simulation finished at t = 2175.0000 s after 10277 steps.
30297.4s 12998 Total runtime: 0.63 seconds.
30297.4s 12999 [REWARD_MICROSCOPE] step=14345 t=2175.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30297.4s 13000 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30297.4s 13001 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30297.4s 13002 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30297.4s 13003 Running simulation until t = 2190.00 s, outputting every 15.00 s
30297.4s 13004 
30297.5s 13005 [WARNING] Automatic CFL correction applied (count: 3334300):
30297.5s 13006 Calculated CFL: 0.800 > Limit: 0.500
30297.5s 13007 Original dt: 3.406934e-01 s
30297.5s 13008 Corrected dt: 2.129334e-01 s
30297.5s 13009 Correction factor: 1.6x
30297.5s 13010 Max wave speed detected: 23.48 m/s
30297.6s 13011 [PROGRESS] Step 10300: t=2179.90/2190.00s (99.5%) | dt=0.2130s
30298.0s 13012 Stored output at t = 2190.0000 s (Step 10348)
30298.0s 13013 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2175.0/2190.0 [00:00<?, ?s/s][A
30298.0s 13014 [A
30298.0s 13015 
30298.0s 13016 Simulation finished at t = 2190.0000 s after 10348 steps.
30298.0s 13017 Total runtime: 0.62 seconds.
30298.0s 13018 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.32s/s]
30298.0s 13019 [REWARD_MICROSCOPE] step=14346 t=2190.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30298.0s 13020 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30298.0s 13021 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30298.0s 13022 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30298.0s 13023 Running simulation until t = 2205.00 s, outputting every 15.00 s
30298.0s 13024 
30298.0s 13025 [PROGRESS] Step 10350: t=2190.43/2205.00s (99.3%) | dt=0.2125s
30298.3s 13026 [PERIODIC:1000] BC_DISPATCHER [Call #13338000] current_bc_params: <class 'dict'>
30298.3s 13027 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30298.3s 13028 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30298.3s 13029 [PERIODIC:1000] BC_GPU [Call #13338000] About to launch kernel
30298.3s 13030 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30298.3s 13031 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30298.3s 13032 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30298.4s 13033 [WARNING] Automatic CFL correction applied (count: 3334400):
30298.4s 13034 Calculated CFL: 0.800 > Limit: 0.500
30298.4s 13035 Original dt: 3.401199e-01 s
30298.4s 13036 Corrected dt: 2.125749e-01 s
30298.4s 13037 Correction factor: 1.6x
30298.4s 13038 Max wave speed detected: 23.52 m/s
30298.5s 13039 [PROGRESS] Step 10400: t=2201.05/2205.00s (99.8%) | dt=0.2127s
30298.6s 13040 Stored output at t = 2205.0000 s (Step 10419)
30298.6s 13041 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2190.0/2205.0 [00:00<?, ?s/s][A
30298.6s 13042 [A
30298.6s 13043 
30298.6s 13044 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 24.51s/s]
30298.6s 13045 Simulation finished at t = 2205.0000 s after 10419 steps.
30298.6s 13046 Total runtime: 0.61 seconds.
30298.6s 13047 [REWARD_MICROSCOPE] step=14347 t=2205.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30298.6s 13048 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30298.6s 13049 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30298.6s 13050 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30298.6s 13051 Running simulation until t = 2220.00 s, outputting every 15.00 s
30298.6s 13052 
30298.9s 13053 [PROGRESS] Step 10450: t=2211.60/2220.00s (99.6%) | dt=0.2131s
30299.2s 13054 [WARNING] Automatic CFL correction applied (count: 3334500):
30299.2s 13055 Calculated CFL: 0.800 > Limit: 0.500
30299.2s 13056 Original dt: 3.401129e-01 s
30299.2s 13057 Corrected dt: 2.125705e-01 s
30299.2s 13058 Correction factor: 1.6x
30299.2s 13059 Max wave speed detected: 23.52 m/s
30299.3s 13060 Stored output at t = 2220.0000 s (Step 10490)
30299.3s 13061 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2205.0/2220.0 [00:00<?, ?s/s][A
30299.3s 13062 [A
30299.3s 13063 
30299.3s 13064 Simulation finished at t = 2220.0000 s after 10490 steps.
30299.3s 13065 Total runtime: 0.62 seconds.
30299.3s 13066 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.20s/s]
30299.3s 13067 [REWARD_MICROSCOPE] step=14348 t=2220.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30299.3s 13068 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30299.3s 13069 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30299.3s 13070 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30299.3s 13071 Running simulation until t = 2235.00 s, outputting every 15.00 s
30299.3s 13072 
30299.3s 13073 [PROGRESS] Step 10500: t=2222.12/2235.00s (99.4%) | dt=0.2123s
30299.8s 13074 [PROGRESS] Step 10550: t=2232.75/2235.00s (99.9%) | dt=0.2127s
30299.9s 13075 Stored output at t = 2235.0000 s (Step 10561)
30299.9s 13076 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2220.0/2235.0 [00:00<?, ?s/s][A
30299.9s 13077 [A
30299.9s 13078 
30299.9s 13079 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.40s/s]
30299.9s 13080 Simulation finished at t = 2235.0000 s after 10561 steps.
30299.9s 13081 Total runtime: 0.62 seconds.
30299.9s 13082 [REWARD_MICROSCOPE] step=14349 t=2235.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30299.9s 13083 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30299.9s 13084 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30299.9s 13085 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30299.9s 13086 Running simulation until t = 2250.00 s, outputting every 15.00 s
30299.9s 13087 
30300.1s 13088 [WARNING] Automatic CFL correction applied (count: 3334600):
30300.1s 13089 Calculated CFL: 0.800 > Limit: 0.500
30300.1s 13090 Original dt: 3.409178e-01 s
30300.1s 13091 Corrected dt: 2.130736e-01 s
30300.1s 13092 Correction factor: 1.6x
30300.1s 13093 Max wave speed detected: 23.47 m/s
30300.2s 13094 [PROGRESS] Step 10600: t=2243.31/2250.00s (99.7%) | dt=0.2132s
30300.5s 13095 Stored output at t = 2250.0000 s (Step 10632)
30300.5s 13096 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2235.0/2250.0 [00:00<?, ?s/s][A
30300.5s 13097 [A
30300.5s 13098 
30300.5s 13099 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.19s/s]
30300.5s 13100 Simulation finished at t = 2250.0000 s after 10632 steps.
30300.5s 13101 Total runtime: 0.62 seconds.
30300.5s 13102 [REWARD_MICROSCOPE] step=14350 t=2250.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30300.5s 13103 [STEP  150] t= 2250.0s | phase=0 | reward=   0.01 | total_reward=    1.50
30300.5s 13104 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30300.5s 13105 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30300.5s 13106 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30300.5s 13107 Running simulation until t = 2265.00 s, outputting every 15.00 s
30300.5s 13108 
30300.5s 13109 [PERIODIC:1000] BC_DISPATCHER [Call #13339000] current_bc_params: <class 'dict'>
30300.5s 13110 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30300.5s 13111 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30300.5s 13112 [PERIODIC:1000] BC_GPU [Call #13339000] About to launch kernel
30300.5s 13113 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30300.5s 13114 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30300.5s 13115 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30300.7s 13116 [PROGRESS] Step 10650: t=2253.82/2265.00s (99.5%) | dt=0.2124s
30301.0s 13117 [WARNING] Automatic CFL correction applied (count: 3334700):
30301.0s 13118 Calculated CFL: 0.800 > Limit: 0.500
30301.0s 13119 Original dt: 3.403431e-01 s
30301.0s 13120 Corrected dt: 2.127144e-01 s
30301.0s 13121 Correction factor: 1.6x
30301.0s 13122 Max wave speed detected: 23.51 m/s
30301.1s 13123 [PROGRESS] Step 10700: t=2264.45/2265.00s (100.0%) | dt=0.2128s
30301.2s 13124 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2250.0/2265.0 [00:00<?, ?s/s][A
30301.2s 13125 [A
30301.2s 13126 Stored output at t = 2265.0000 s (Step 10703)
30301.2s 13127 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 22.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 22.97s/s]
30301.2s 13128 
30301.2s 13129 Simulation finished at t = 2265.0000 s after 10703 steps.
30301.2s 13130 Total runtime: 0.65 seconds.
30301.2s 13131 [QUEUE_DIAGNOSTIC] ===== Step 150 t=2265.0s =====
30301.2s 13132 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30301.2s 13133 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30301.2s 13134 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30301.2s 13135 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30301.2s 13136 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30301.2s 13137 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30301.2s 13138 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30301.2s 13139 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30301.2s 13140 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30301.2s 13141 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30301.2s 13142 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30301.2s 13143 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30301.2s 13144 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30301.2s 13145 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30301.2s 13146 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30301.2s 13147 [REWARD_MICROSCOPE] step=14351 t=2265.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30301.2s 13148 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30301.2s 13149 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30301.2s 13150 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30301.2s 13151 Running simulation until t = 2280.00 s, outputting every 15.00 s
30301.2s 13152 
30301.6s 13153 [PROGRESS] Step 10750: t=2275.01/2280.00s (99.8%) | dt=0.2132s
30301.8s 13154 Stored output at t = 2280.0000 s (Step 10774)
30301.8s 13155 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2265.0/2280.0 [00:00<?, ?s/s][A
30301.8s 13156 [A
30301.8s 13157 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.68s/s]
30301.8s 13158 
30301.8s 13159 Simulation finished at t = 2280.0000 s after 10774 steps.
30301.8s 13160 Total runtime: 0.61 seconds.
30301.8s 13161 [REWARD_MICROSCOPE] step=14352 t=2280.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30301.8s 13162 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30301.8s 13163 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30301.8s 13164 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30301.8s 13165 Running simulation until t = 2295.00 s, outputting every 15.00 s
30301.8s 13166 
30301.9s 13167 [WARNING] Automatic CFL correction applied (count: 3334800):
30301.9s 13168 Calculated CFL: 0.800 > Limit: 0.500
30301.9s 13169 Original dt: 3.397401e-01 s
30301.9s 13170 Corrected dt: 2.123376e-01 s
30301.9s 13171 Correction factor: 1.6x
30301.9s 13172 Max wave speed detected: 23.55 m/s
30302.0s 13173 [PROGRESS] Step 10800: t=2285.52/2295.00s (99.6%) | dt=0.2124s
30302.4s 13174 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2280.0/2295.0 [00:00<?, ?s/s][A
30302.4s 13175 [A
30302.4s 13176 Stored output at t = 2295.0000 s (Step 10845)
30302.4s 13177 
30302.4s 13178 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.50s/s]
30302.4s 13179 Simulation finished at t = 2295.0000 s after 10845 steps.
30302.4s 13180 Total runtime: 0.61 seconds.
30302.4s 13181 [REWARD_MICROSCOPE] step=14353 t=2295.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30302.4s 13182 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30302.4s 13183 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30302.4s 13184 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30302.4s 13185 Running simulation until t = 2310.00 s, outputting every 15.00 s
30302.4s 13186 
30302.4s 13187 [PROGRESS] Step 10850: t=2296.06/2310.00s (99.4%) | dt=0.2129s
30302.7s 13188 [PERIODIC:1000] BC_DISPATCHER [Call #13340000] current_bc_params: <class 'dict'>
30302.7s 13189 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30302.7s 13190 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30302.7s 13191 [PERIODIC:1000] BC_GPU [Call #13340000] About to launch kernel
30302.7s 13192 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30302.7s 13193 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30302.7s 13194 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30302.8s 13195 [WARNING] Automatic CFL correction applied (count: 3334900):
30302.8s 13196 Calculated CFL: 0.800 > Limit: 0.500
30302.8s 13197 Original dt: 3.411334e-01 s
30302.8s 13198 Corrected dt: 2.132084e-01 s
30302.8s 13199 Correction factor: 1.6x
30302.8s 13200 Max wave speed detected: 23.45 m/s
30302.9s 13201 [PROGRESS] Step 10900: t=2306.72/2310.00s (99.9%) | dt=0.2133s
30303.0s 13202 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295.0/2310.0 [00:00<?, ?s/s][A
30303.0s 13203 [A
30303.0s 13204 Stored output at t = 2310.0000 s (Step 10916)
30303.0s 13205 
30303.0s 13206 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.33s/s]
30303.0s 13207 Simulation finished at t = 2310.0000 s after 10916 steps.
30303.0s 13208 Total runtime: 0.62 seconds.
30303.0s 13209 [REWARD_MICROSCOPE] step=14354 t=2310.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30303.0s 13210 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30303.0s 13211 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30303.0s 13212 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30303.0s 13213 Running simulation until t = 2325.00 s, outputting every 15.00 s
30303.0s 13214 
30303.3s 13215 [PROGRESS] Step 10950: t=2317.22/2325.00s (99.7%) | dt=0.2125s
30303.6s 13216 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310.0/2325.0 [00:00<?, ?s/s][A
30303.6s 13217 [A
30303.6s 13218 Stored output at t = 2325.0000 s (Step 10987)
30303.6s 13219 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.81s/s]
30303.6s 13220 
30303.6s 13221 Simulation finished at t = 2325.0000 s after 10987 steps.
30303.6s 13222 Total runtime: 0.63 seconds.
30303.6s 13223 [REWARD_MICROSCOPE] step=14355 t=2325.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30303.6s 13224 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30303.6s 13225 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30303.6s 13226 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30303.6s 13227 Running simulation until t = 2340.00 s, outputting every 15.00 s
30303.6s 13228 
30303.6s 13229 [WARNING] Automatic CFL correction applied (count: 3335000):
30303.6s 13230 Calculated CFL: 0.800 > Limit: 0.500
30303.6s 13231 Original dt: 3.405553e-01 s
30303.6s 13232 Corrected dt: 2.128470e-01 s
30303.6s 13233 Correction factor: 1.6x
30303.6s 13234 Max wave speed detected: 23.49 m/s
30303.7s 13235 [PROGRESS] Step 11000: t=2327.77/2340.00s (99.5%) | dt=0.2129s
30304.2s 13236 [PROGRESS] Step 11050: t=2338.42/2340.00s (99.9%) | dt=0.2128s
30304.3s 13237 Stored output at t = 2340.0000 s (Step 11058)
30304.3s 13238 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2325.0/2340.0 [00:00<?, ?s/s][A
30304.3s 13239 [A
30304.3s 13240 
30304.3s 13241 Simulation finished at t = 2340.0000 s after 11058 steps.
30304.3s 13242 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.11s/s]
30304.3s 13243 Total runtime: 0.62 seconds.
30304.3s 13244 [REWARD_MICROSCOPE] step=14356 t=2340.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30304.3s 13245 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30304.3s 13246 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30304.3s 13247 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30304.3s 13248 Running simulation until t = 2355.00 s, outputting every 15.00 s
30304.3s 13249 
30304.5s 13250 [WARNING] Automatic CFL correction applied (count: 3335100):
30304.5s 13251 Calculated CFL: 0.800 > Limit: 0.500
30304.5s 13252 Original dt: 3.399790e-01 s
30304.5s 13253 Corrected dt: 2.124869e-01 s
30304.5s 13254 Correction factor: 1.6x
30304.5s 13255 Max wave speed detected: 23.53 m/s
30304.6s 13256 [PROGRESS] Step 11100: t=2348.92/2355.00s (99.7%) | dt=0.2126s
30304.9s 13257 Stored output at t = 2355.0000 s (Step 11129)
30304.9s 13258 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2340.0/2355.0 [00:00<?, ?s/s][A
30304.9s 13259 [A
30304.9s 13260 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 23.84s/s]
30304.9s 13261 
30304.9s 13262 Simulation finished at t = 2355.0000 s after 11129 steps.
30304.9s 13263 Total runtime: 0.63 seconds.
30304.9s 13264 [REWARD_MICROSCOPE] step=14357 t=2355.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30304.9s 13265 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30304.9s 13266 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30304.9s 13267 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30304.9s 13268 Running simulation until t = 2370.00 s, outputting every 15.00 s
30304.9s 13269 
30304.9s 13270 [PERIODIC:1000] BC_DISPATCHER [Call #13341000] current_bc_params: <class 'dict'>
30304.9s 13271 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30304.9s 13272 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30304.9s 13273 [PERIODIC:1000] BC_GPU [Call #13341000] About to launch kernel
30304.9s 13274 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30304.9s 13275 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30304.9s 13276 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30305.1s 13277 [PROGRESS] Step 11150: t=2359.47/2370.00s (99.6%) | dt=0.2130s
30305.4s 13278 [WARNING] Automatic CFL correction applied (count: 3335200):
30305.4s 13279 Calculated CFL: 0.800 > Limit: 0.500
30305.4s 13280 Original dt: 3.407550e-01 s
30305.4s 13281 Corrected dt: 2.129719e-01 s
30305.4s 13282 Correction factor: 1.6x
30305.4s 13283 Max wave speed detected: 23.48 m/s
30305.5s 13284 [PROGRESS] Step 11200: t=2370.00/2370.00s (100.0%) | dt=0.0883s
30305.5s 13285 Stored output at t = 2370.0000 s (Step 11200)
30305.5s 13286 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2355.0/2370.0 [00:00<?, ?s/s][A
30305.5s 13287 [A
30305.5s 13288 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.76s/s]
30305.5s 13289 
30305.5s 13290 Simulation finished at t = 2370.0000 s after 11200 steps.
30305.5s 13291 Total runtime: 0.63 seconds.
30305.5s 13292 [REWARD_MICROSCOPE] step=14358 t=2370.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30305.5s 13293 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30305.5s 13294 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30305.5s 13295 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30305.5s 13296 Running simulation until t = 2385.00 s, outputting every 15.00 s
30305.5s 13297 
30306.0s 13298 [PROGRESS] Step 11250: t=2380.62/2385.00s (99.8%) | dt=0.2127s
30306.2s 13299 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2370.0/2385.0 [00:00<?, ?s/s][A
30306.2s 13300 [A
30306.2s 13301 Stored output at t = 2385.0000 s (Step 11271)
30306.2s 13302 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 23.87s/s]
30306.2s 13303 
30306.2s 13304 Simulation finished at t = 2385.0000 s after 11271 steps.
30306.2s 13305 Total runtime: 0.63 seconds.
30306.2s 13306 [REWARD_MICROSCOPE] step=14359 t=2385.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30306.2s 13307 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30306.2s 13308 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30306.2s 13309 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30306.2s 13310 Running simulation until t = 2400.00 s, outputting every 15.00 s
30306.2s 13311 
30306.3s 13312 [WARNING] Automatic CFL correction applied (count: 3335300):
30306.3s 13313 Calculated CFL: 0.800 > Limit: 0.500
30306.3s 13314 Original dt: 3.407770e-01 s
30306.3s 13315 Corrected dt: 2.129856e-01 s
30306.3s 13316 Correction factor: 1.6x
30306.3s 13317 Max wave speed detected: 23.48 m/s
30306.4s 13318 [PROGRESS] Step 11300: t=2391.18/2400.00s (99.6%) | dt=0.2131s
30306.8s 13319 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2385.0/2400.0 [00:00<?, ?s/s][A
30306.8s 13320 [A
30306.8s 13321 Stored output at t = 2400.0000 s (Step 11342)
30306.8s 13322 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.43s/s]
30306.8s 13323 
30306.8s 13324 Simulation finished at t = 2400.0000 s after 11342 steps.
30306.8s 13325 Total runtime: 0.61 seconds.
30306.8s 13326 [REWARD_MICROSCOPE] step=14360 t=2400.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30306.8s 13327 [STEP  160] t= 2400.0s | phase=0 | reward=   0.01 | total_reward=    1.60
30306.8s 13328 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30306.8s 13329 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30306.8s 13330 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30306.8s 13331 Running simulation until t = 2415.00 s, outputting every 15.00 s
30306.8s 13332 
30306.8s 13333 [PROGRESS] Step 11350: t=2401.70/2415.00s (99.4%) | dt=0.2124s
30307.1s 13334 [PERIODIC:1000] BC_DISPATCHER [Call #13342000] current_bc_params: <class 'dict'>
30307.1s 13335 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30307.1s 13336 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30307.1s 13337 [PERIODIC:1000] BC_GPU [Call #13342000] About to launch kernel
30307.1s 13338 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30307.1s 13339 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30307.1s 13340 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30307.2s 13341 [WARNING] Automatic CFL correction applied (count: 3335400):
30307.2s 13342 Calculated CFL: 0.800 > Limit: 0.500
30307.2s 13343 Original dt: 3.402034e-01 s
30307.2s 13344 Corrected dt: 2.126271e-01 s
30307.2s 13345 Correction factor: 1.6x
30307.2s 13346 Max wave speed detected: 23.52 m/s
30307.3s 13347 [PROGRESS] Step 11400: t=2412.32/2415.00s (99.9%) | dt=0.2127s
30307.4s 13348 Stored output at t = 2415.0000 s (Step 11413)
30307.4s 13349 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2400.0/2415.0 [00:00<?, ?s/s][A
30307.4s 13350 [A
30307.4s 13351 
30307.4s 13352 Simulation finished at t = 2415.0000 s after 11413 steps.
30307.4s 13353 Total runtime: 0.62 seconds.
30307.4s 13354 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 24.25s/s]
30307.4s 13355 [QUEUE_DIAGNOSTIC] ===== Step 160 t=2415.0s =====
30307.4s 13356 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30307.4s 13357 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30307.4s 13358 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30307.4s 13359 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30307.4s 13360 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30307.4s 13361 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30307.4s 13362 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30307.4s 13363 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30307.4s 13364 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30307.4s 13365 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30307.4s 13366 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30307.4s 13367 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30307.4s 13368 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30307.4s 13369 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30307.4s 13370 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30307.4s 13371 [REWARD_MICROSCOPE] step=14361 t=2415.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30307.4s 13372 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30307.4s 13373 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30307.4s 13374 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30307.4s 13375 Running simulation until t = 2430.00 s, outputting every 15.00 s
30307.4s 13376 
30307.7s 13377 [PROGRESS] Step 11450: t=2422.88/2430.00s (99.7%) | dt=0.2131s
30308.0s 13378 Stored output at t = 2430.0000 s (Step 11484)
30308.0s 13379 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2415.0/2430.0 [00:00<?, ?s/s][A
30308.0s 13380 [A
30308.0s 13381 
30308.0s 13382 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.39s/s]
30308.0s 13383 Simulation finished at t = 2430.0000 s after 11484 steps.
30308.0s 13384 Total runtime: 0.62 seconds.
30308.0s 13385 [REWARD_MICROSCOPE] step=14362 t=2430.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30308.0s 13386 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30308.0s 13387 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30308.0s 13388 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30308.0s 13389 Running simulation until t = 2445.00 s, outputting every 15.00 s
30308.0s 13390 
30308.1s 13391 [WARNING] Automatic CFL correction applied (count: 3335500):
30308.1s 13392 Calculated CFL: 0.800 > Limit: 0.500
30308.1s 13393 Original dt: 3.398708e-01 s
30308.1s 13394 Corrected dt: 2.124193e-01 s
30308.1s 13395 Correction factor: 1.6x
30308.1s 13396 Max wave speed detected: 23.54 m/s
30308.2s 13397 [PROGRESS] Step 11500: t=2433.40/2445.00s (99.5%) | dt=0.2123s
30308.6s 13398 [PROGRESS] Step 11550: t=2444.03/2445.00s (100.0%) | dt=0.2128s
30308.6s 13399 Stored output at t = 2445.0000 s (Step 11555)
30308.6s 13400 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2430.0/2445.0 [00:00<?, ?s/s][A
30308.6s 13401 [A
30308.7s 13402 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.61s/s]
30308.7s 13403 
30308.7s 13404 Simulation finished at t = 2445.0000 s after 11555 steps.
30308.7s 13405 Total runtime: 0.64 seconds.
30308.7s 13406 [REWARD_MICROSCOPE] step=14363 t=2445.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30308.7s 13407 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30308.7s 13408 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30308.7s 13409 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30308.7s 13410 Running simulation until t = 2460.00 s, outputting every 15.00 s
30308.7s 13411 
30308.9s 13412 [WARNING] Automatic CFL correction applied (count: 3335600):
30308.9s 13413 Calculated CFL: 0.800 > Limit: 0.500
30308.9s 13414 Original dt: 3.409993e-01 s
30308.9s 13415 Corrected dt: 2.131246e-01 s
30308.9s 13416 Correction factor: 1.6x
30308.9s 13417 Max wave speed detected: 23.46 m/s
30309.1s 13418 [PROGRESS] Step 11600: t=2454.59/2460.00s (99.8%) | dt=0.2132s
30309.3s 13419 Stored output at t = 2460.0000 s (Step 11626)
30309.3s 13420 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2445.0/2460.0 [00:00<?, ?s/s][A
30309.3s 13421 [A
30309.3s 13422 
30309.3s 13423 Simulation finished at t = 2460.0000 s after 11626 steps.
30309.3s 13424 Total runtime: 0.64 seconds.
30309.3s 13425 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 23.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 23.59s/s]
30309.3s 13426 [REWARD_MICROSCOPE] step=14364 t=2460.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30309.3s 13427 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30309.3s 13428 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30309.3s 13429 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30309.3s 13430 Running simulation until t = 2475.00 s, outputting every 15.00 s
30309.3s 13431 
30309.4s 13432 [PERIODIC:1000] BC_DISPATCHER [Call #13343000] current_bc_params: <class 'dict'>
30309.4s 13433 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30309.4s 13434 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30309.4s 13435 [PERIODIC:1000] BC_GPU [Call #13343000] About to launch kernel
30309.4s 13436 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30309.4s 13437 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30309.4s 13438 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30309.5s 13439 [PROGRESS] Step 11650: t=2465.10/2475.00s (99.6%) | dt=0.2124s
30309.8s 13440 [WARNING] Automatic CFL correction applied (count: 3335700):
30309.8s 13441 Calculated CFL: 0.800 > Limit: 0.500
30309.8s 13442 Original dt: 3.404274e-01 s
30309.8s 13443 Corrected dt: 2.127671e-01 s
30309.8s 13444 Correction factor: 1.6x
30309.8s 13445 Max wave speed detected: 23.50 m/s
30309.9s 13446 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2460.0/2475.0 [00:00<?, ?s/s][A
30309.9s 13447 [A
30309.9s 13448 Stored output at t = 2475.0000 s (Step 11697)
30309.9s 13449 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.66s/s]
30309.9s 13450 
30309.9s 13451 Simulation finished at t = 2475.0000 s after 11697 steps.
30309.9s 13452 Total runtime: 0.63 seconds.
30309.9s 13453 [REWARD_MICROSCOPE] step=14365 t=2475.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30309.9s 13454 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30309.9s 13455 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30309.9s 13456 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30309.9s 13457 Running simulation until t = 2490.00 s, outputting every 15.00 s
30309.9s 13458 
30310.0s 13459 [PROGRESS] Step 11700: t=2475.64/2490.00s (99.4%) | dt=0.2129s
30310.4s 13460 [PROGRESS] Step 11750: t=2486.29/2490.00s (99.9%) | dt=0.2133s
30310.6s 13461 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2475.0/2490.0 [00:00<?, ?s/s][A
30310.6s 13462 [A
30310.6s 13463 Stored output at t = 2490.0000 s (Step 11768)
30310.6s 13464 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.34s/s]
30310.6s 13465 
30310.6s 13466 Simulation finished at t = 2490.0000 s after 11768 steps.
30310.6s 13467 Total runtime: 0.64 seconds.
30310.6s 13468 [REWARD_MICROSCOPE] step=14366 t=2490.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30310.6s 13469 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30310.6s 13470 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30310.6s 13471 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30310.6s 13472 Running simulation until t = 2505.00 s, outputting every 15.00 s
30310.6s 13473 
30310.8s 13474 [WARNING] Automatic CFL correction applied (count: 3335800):
30310.8s 13475 Calculated CFL: 0.800 > Limit: 0.500
30310.8s 13476 Original dt: 3.398278e-01 s
30310.8s 13477 Corrected dt: 2.123924e-01 s
30310.8s 13478 Correction factor: 1.6x
30310.8s 13479 Max wave speed detected: 23.54 m/s
30310.9s 13480 [PROGRESS] Step 11800: t=2496.80/2505.00s (99.7%) | dt=0.2125s
30311.2s 13481 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2490.0/2505.0 [00:00<?, ?s/s][A
30311.2s 13482 [A
30311.2s 13483 Stored output at t = 2505.0000 s (Step 11839)
30311.2s 13484 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 22.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 22.71s/s]
30311.2s 13485 
30311.2s 13486 Simulation finished at t = 2505.0000 s after 11839 steps.
30311.2s 13487 Total runtime: 0.66 seconds.
30311.2s 13488 [REWARD_MICROSCOPE] step=14367 t=2505.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30311.2s 13489 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30311.2s 13490 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30311.2s 13491 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30311.2s 13492 Running simulation until t = 2520.00 s, outputting every 15.00 s
30311.2s 13493 
30311.3s 13494 [PROGRESS] Step 11850: t=2507.34/2520.00s (99.5%) | dt=0.2129s
30311.6s 13495 [PERIODIC:1000] BC_DISPATCHER [Call #13344000] current_bc_params: <class 'dict'>
30311.6s 13496 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30311.6s 13497 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30311.6s 13498 [PERIODIC:1000] BC_GPU [Call #13344000] About to launch kernel
30311.6s 13499 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30311.6s 13500 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30311.6s 13501 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30311.7s 13502 [WARNING] Automatic CFL correction applied (count: 3335900):
30311.7s 13503 Calculated CFL: 0.800 > Limit: 0.500
30311.7s 13504 Original dt: 3.412149e-01 s
30311.7s 13505 Corrected dt: 2.132593e-01 s
30311.7s 13506 Correction factor: 1.6x
30311.7s 13507 Max wave speed detected: 23.45 m/s
30311.8s 13508 [PROGRESS] Step 11900: t=2518.00/2520.00s (99.9%) | dt=0.2129s
30311.9s 13509 Stored output at t = 2520.0000 s (Step 11910)
30311.9s 13510 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2505.0/2520.0 [00:00<?, ?s/s][A
30311.9s 13511 [A
30311.9s 13512 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 23.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 23.41s/s]
30311.9s 13513 
30311.9s 13514 Simulation finished at t = 2520.0000 s after 11910 steps.
30311.9s 13515 Total runtime: 0.64 seconds.
30311.9s 13516 [REWARD_MICROSCOPE] step=14368 t=2520.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30311.9s 13517 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30311.9s 13518 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30311.9s 13519 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30311.9s 13520 Running simulation until t = 2535.00 s, outputting every 15.00 s
30311.9s 13521 
30312.2s 13522 [PROGRESS] Step 11950: t=2528.50/2535.00s (99.7%) | dt=0.2126s
30312.5s 13523 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2520.0/2535.0 [00:00<?, ?s/s][A
30312.5s 13524 [A
30312.5s 13525 Stored output at t = 2535.0000 s (Step 11981)
30312.5s 13526 
30312.5s 13527 Simulation finished at t = 2535.0000 s after 11981 steps.
30312.5s 13528 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.75s/s]
30312.5s 13529 Total runtime: 0.63 seconds.
30312.5s 13530 [REWARD_MICROSCOPE] step=14369 t=2535.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30312.5s 13531 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30312.5s 13532 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30312.5s 13533 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30312.5s 13534 Running simulation until t = 2550.00 s, outputting every 15.00 s
30312.5s 13535 
30312.6s 13536 [WARNING] Automatic CFL correction applied (count: 3336000):
30312.6s 13537 Calculated CFL: 0.800 > Limit: 0.500
30312.6s 13538 Original dt: 3.406380e-01 s
30312.6s 13539 Corrected dt: 2.128988e-01 s
30312.6s 13540 Correction factor: 1.6x
30312.6s 13541 Max wave speed detected: 23.49 m/s
30312.7s 13542 [PROGRESS] Step 12000: t=2539.05/2550.00s (99.6%) | dt=0.2130s
30313.1s 13543 [PROGRESS] Step 12050: t=2549.70/2550.00s (100.0%) | dt=0.2126s
30313.1s 13544 Stored output at t = 2550.0000 s (Step 12052)
30313.1s 13545 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2535.0/2550.0 [00:00<?, ?s/s][A
30313.1s 13546 [A
30313.1s 13547 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 23.85s/s]
30313.1s 13548 
30313.1s 13549 Simulation finished at t = 2550.0000 s after 12052 steps.
30313.1s 13550 Total runtime: 0.63 seconds.
30313.1s 13551 [REWARD_MICROSCOPE] step=14370 t=2550.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30313.1s 13552 [STEP  170] t= 2550.0s | phase=0 | reward=   0.01 | total_reward=    1.70
30313.1s 13553 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30313.1s 13554 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30313.1s 13555 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30313.1s 13556 Running simulation until t = 2565.00 s, outputting every 15.00 s
30313.1s 13557 
30313.5s 13558 [WARNING] Automatic CFL correction applied (count: 3336100):
30313.5s 13559 Calculated CFL: 0.800 > Limit: 0.500
30313.5s 13560 Original dt: 3.400643e-01 s
30313.5s 13561 Corrected dt: 2.125402e-01 s
30313.5s 13562 Correction factor: 1.6x
30313.5s 13563 Max wave speed detected: 23.52 m/s
30313.6s 13564 [PROGRESS] Step 12100: t=2560.20/2565.00s (99.8%) | dt=0.2126s
30313.8s 13565 Stored output at t = 2565.0000 s (Step 12123)
30313.8s 13566 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2550.0/2565.0 [00:00<?, ?s/s][A
30313.8s 13567 [A
30313.8s 13568 
30313.8s 13569 Simulation finished at t = 2565.0000 s after 12123 steps.
30313.8s 13570 Total runtime: 0.68 seconds.
30313.8s 13571 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 22.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 22.23s/s]
30313.8s 13572 [QUEUE_DIAGNOSTIC] ===== Step 170 t=2565.0s =====
30313.8s 13573 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30313.8s 13574 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30313.8s 13575 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30313.8s 13576 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30313.8s 13577 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30313.8s 13578 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30313.8s 13579 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30313.8s 13580 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30313.8s 13581 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30313.8s 13582 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30313.8s 13583 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30313.8s 13584 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30313.8s 13585 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30313.8s 13586 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30313.8s 13587 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30313.8s 13588 [REWARD_MICROSCOPE] step=14371 t=2565.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30313.8s 13589 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30313.8s 13590 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30313.8s 13591 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30313.8s 13592 Running simulation until t = 2580.00 s, outputting every 15.00 s
30313.8s 13593 
30313.9s 13594 [PERIODIC:1000] BC_DISPATCHER [Call #13345000] current_bc_params: <class 'dict'>
30313.9s 13595 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30313.9s 13596 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30313.9s 13597 [PERIODIC:1000] BC_GPU [Call #13345000] About to launch kernel
30313.9s 13598 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30313.9s 13599 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30313.9s 13600 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30314.1s 13601 [PROGRESS] Step 12150: t=2570.75/2580.00s (99.6%) | dt=0.2131s
30314.4s 13602 [WARNING] Automatic CFL correction applied (count: 3336200):
30314.4s 13603 Calculated CFL: 0.800 > Limit: 0.500
30314.4s 13604 Original dt: 3.403351e-01 s
30314.4s 13605 Corrected dt: 2.127094e-01 s
30314.4s 13606 Correction factor: 1.6x
30314.4s 13607 Max wave speed detected: 23.51 m/s
30314.4s 13608 Stored output at t = 2580.0000 s (Step 12194)
30314.4s 13609 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2565.0/2580.0 [00:00<?, ?s/s][A
30314.4s 13610 [A
30314.4s 13611 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.24s/s]
30314.4s 13612 
30314.4s 13613 Simulation finished at t = 2580.0000 s after 12194 steps.
30314.4s 13614 Total runtime: 0.62 seconds.
30314.4s 13615 [REWARD_MICROSCOPE] step=14372 t=2580.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30314.4s 13616 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30314.4s 13617 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30314.4s 13618 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30314.4s 13619 Running simulation until t = 2595.00 s, outputting every 15.00 s
30314.4s 13620 
30314.5s 13621 [PROGRESS] Step 12200: t=2581.27/2595.00s (99.5%) | dt=0.2124s
30314.9s 13622 [PROGRESS] Step 12250: t=2591.90/2595.00s (99.9%) | dt=0.2127s
30315.1s 13623 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2580.0/2595.0 [00:00<?, ?s/s][A
30315.1s 13624 [A
30315.1s 13625 Stored output at t = 2595.0000 s (Step 12265)
30315.1s 13626 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.12s/s]
30315.1s 13627 
30315.1s 13628 Simulation finished at t = 2595.0000 s after 12265 steps.
30315.1s 13629 Total runtime: 0.62 seconds.
30315.1s 13630 [REWARD_MICROSCOPE] step=14373 t=2595.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30315.1s 13631 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30315.1s 13632 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30315.1s 13633 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30315.1s 13634 Running simulation until t = 2610.00 s, outputting every 15.00 s
30315.1s 13635 
30315.3s 13636 [WARNING] Automatic CFL correction applied (count: 3336300):
30315.3s 13637 Calculated CFL: 0.800 > Limit: 0.500
30315.3s 13638 Original dt: 3.408612e-01 s
30315.3s 13639 Corrected dt: 2.130383e-01 s
30315.3s 13640 Correction factor: 1.6x
30315.3s 13641 Max wave speed detected: 23.47 m/s
30315.4s 13642 [PROGRESS] Step 12300: t=2602.45/2610.00s (99.7%) | dt=0.2131s
30315.7s 13643 Stored output at t = 2610.0000 s (Step 12336)
30315.7s 13644 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2595.0/2610.0 [00:00<?, ?s/s][A
30315.7s 13645 [A
30315.7s 13646 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 24.34s/s]
30315.7s 13647 
30315.7s 13648 Simulation finished at t = 2610.0000 s after 12336 steps.
30315.7s 13649 Total runtime: 0.62 seconds.
30315.7s 13650 [REWARD_MICROSCOPE] step=14374 t=2610.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30315.7s 13651 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30315.7s 13652 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30315.7s 13653 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30315.7s 13654 Running simulation until t = 2625.00 s, outputting every 15.00 s
30315.7s 13655 
30315.8s 13656 [PROGRESS] Step 12350: t=2612.97/2625.00s (99.5%) | dt=0.2123s
30316.1s 13657 [PERIODIC:1000] BC_DISPATCHER [Call #13346000] current_bc_params: <class 'dict'>
30316.1s 13658 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30316.1s 13659 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30316.1s 13660 [PERIODIC:1000] BC_GPU [Call #13346000] About to launch kernel
30316.1s 13661 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30316.1s 13662 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30316.1s 13663 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30316.1s 13664 [WARNING] Automatic CFL correction applied (count: 3336400):
30316.1s 13665 Calculated CFL: 0.800 > Limit: 0.500
30316.1s 13666 Original dt: 3.402871e-01 s
30316.1s 13667 Corrected dt: 2.126795e-01 s
30316.1s 13668 Correction factor: 1.6x
30316.1s 13669 Max wave speed detected: 23.51 m/s
30316.2s 13670 [PROGRESS] Step 12400: t=2623.60/2625.00s (99.9%) | dt=0.2128s
30316.3s 13671 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2610.0/2625.0 [00:00<?, ?s/s][A
30316.3s 13672 [A
30316.3s 13673 Stored output at t = 2625.0000 s (Step 12407)
30316.3s 13674 
30316.3s 13675 Simulation finished at t = 2625.0000 s after 12407 steps.
30316.3s 13676 Total runtime: 0.62 seconds.
30316.3s 13677 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.40s/s]
30316.3s 13678 [REWARD_MICROSCOPE] step=14375 t=2625.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30316.3s 13679 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30316.3s 13680 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30316.3s 13681 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30316.3s 13682 Running simulation until t = 2640.00 s, outputting every 15.00 s
30316.3s 13683 
30316.7s 13684 [PROGRESS] Step 12450: t=2634.16/2640.00s (99.8%) | dt=0.2132s
30316.9s 13685 Stored output at t = 2640.0000 s (Step 12478)
30316.9s 13686 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2625.0/2640.0 [00:00<?, ?s/s][A
30316.9s 13687 [A
30316.9s 13688 
30316.9s 13689 Simulation finished at t = 2640.0000 s after 12478 steps.
30316.9s 13690 Total runtime: 0.62 seconds.
30316.9s 13691 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 24.06s/s]
30316.9s 13692 [REWARD_MICROSCOPE] step=14376 t=2640.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30316.9s 13693 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30316.9s 13694 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30316.9s 13695 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30316.9s 13696 Running simulation until t = 2655.00 s, outputting every 15.00 s
30316.9s 13697 
30317.0s 13698 [WARNING] Automatic CFL correction applied (count: 3336500):
30317.0s 13699 Calculated CFL: 0.800 > Limit: 0.500
30317.0s 13700 Original dt: 3.397169e-01 s
30317.0s 13701 Corrected dt: 2.123230e-01 s
30317.0s 13702 Correction factor: 1.6x
30317.0s 13703 Max wave speed detected: 23.55 m/s
30317.1s 13704 [PROGRESS] Step 12500: t=2644.67/2655.00s (99.6%) | dt=0.2124s
30317.6s 13705 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2640.0/2655.0 [00:00<?, ?s/s][A
30317.6s 13706 [A
30317.6s 13707 Stored output at t = 2655.0000 s (Step 12549)
30317.6s 13708 
30317.6s 13709 Simulation finished at t = 2655.0000 s after 12549 steps.
30317.6s 13710 Total runtime: 0.63 seconds.
30317.6s 13711 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.93s/s]
30317.6s 13712 [REWARD_MICROSCOPE] step=14377 t=2655.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30317.6s 13713 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30317.6s 13714 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30317.6s 13715 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30317.6s 13716 Running simulation until t = 2670.00 s, outputting every 15.00 s
30317.6s 13717 
30317.6s 13718 [PROGRESS] Step 12550: t=2655.21/2670.00s (99.4%) | dt=0.2128s
30317.9s 13719 [WARNING] Automatic CFL correction applied (count: 3336600):
30317.9s 13720 Calculated CFL: 0.800 > Limit: 0.500
30317.9s 13721 Original dt: 3.410795e-01 s
30317.9s 13722 Corrected dt: 2.131747e-01 s
30317.9s 13723 Correction factor: 1.6x
30317.9s 13724 Max wave speed detected: 23.45 m/s
30318.0s 13725 [PROGRESS] Step 12600: t=2665.87/2670.00s (99.8%) | dt=0.2133s
30318.2s 13726 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2655.0/2670.0 [00:00<?, ?s/s][A
30318.2s 13727 [A
30318.2s 13728 Stored output at t = 2670.0000 s (Step 12620)
30318.2s 13729 
30318.2s 13730 Simulation finished at t = 2670.0000 s after 12620 steps.
30318.2s 13731 Total runtime: 0.62 seconds.
30318.2s 13732 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.35s/s]
30318.2s 13733 [REWARD_MICROSCOPE] step=14378 t=2670.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30318.2s 13734 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30318.2s 13735 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30318.2s 13736 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30318.2s 13737 Running simulation until t = 2685.00 s, outputting every 15.00 s
30318.2s 13738 
30318.3s 13739 [PERIODIC:1000] BC_DISPATCHER [Call #13347000] current_bc_params: <class 'dict'>
30318.3s 13740 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30318.3s 13741 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30318.3s 13742 [PERIODIC:1000] BC_GPU [Call #13347000] About to launch kernel
30318.3s 13743 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30318.3s 13744 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30318.3s 13745 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30318.5s 13746 [PROGRESS] Step 12650: t=2676.37/2685.00s (99.7%) | dt=0.2125s
30318.9s 13747 [WARNING] Automatic CFL correction applied (count: 3336700):
30318.9s 13748 Calculated CFL: 0.800 > Limit: 0.500
30318.9s 13749 Original dt: 3.405090e-01 s
30318.9s 13750 Corrected dt: 2.128181e-01 s
30318.9s 13751 Correction factor: 1.6x
30318.9s 13752 Max wave speed detected: 23.49 m/s
30318.9s 13753 Stored output at t = 2685.0000 s (Step 12691)
30318.9s 13754 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2670.0/2685.0 [00:00<?, ?s/s][A
30318.9s 13755 [A
30318.9s 13756 
30318.9s 13757 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 21.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 21.53s/s]
30318.9s 13758 Simulation finished at t = 2685.0000 s after 12691 steps.
30318.9s 13759 Total runtime: 0.70 seconds.
30318.9s 13760 [REWARD_MICROSCOPE] step=14379 t=2685.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30318.9s 13761 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30318.9s 13762 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30318.9s 13763 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30318.9s 13764 Running simulation until t = 2700.00 s, outputting every 15.00 s
30318.9s 13765 
30319.0s 13766 [PROGRESS] Step 12700: t=2686.92/2700.00s (99.5%) | dt=0.2129s
30319.4s 13767 [PROGRESS] Step 12750: t=2697.57/2700.00s (99.9%) | dt=0.2130s
30319.5s 13768 Stored output at t = 2700.0000 s (Step 12762)
30319.5s 13769 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2685.0/2700.0 [00:00<?, ?s/s][A
30319.5s 13770 [A
30319.5s 13771 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.19s/s]
30319.5s 13772 
30319.5s 13773 Simulation finished at t = 2700.0000 s after 12762 steps.
30319.5s 13774 Total runtime: 0.62 seconds.
30319.5s 13775 [REWARD_MICROSCOPE] step=14380 t=2700.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30319.5s 13776 [STEP  180] t= 2700.0s | phase=0 | reward=   0.01 | total_reward=    1.80
30319.5s 13777 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30319.5s 13778 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30319.5s 13779 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30319.5s 13780 Running simulation until t = 2715.00 s, outputting every 15.00 s
30319.5s 13781 
30319.7s 13782 [WARNING] Automatic CFL correction applied (count: 3336800):
30319.7s 13783 Calculated CFL: 0.800 > Limit: 0.500
30319.7s 13784 Original dt: 3.399193e-01 s
30319.7s 13785 Corrected dt: 2.124495e-01 s
30319.7s 13786 Correction factor: 1.6x
30319.7s 13787 Max wave speed detected: 23.53 m/s
30319.8s 13788 [PROGRESS] Step 12800: t=2708.07/2715.00s (99.7%) | dt=0.2125s
30320.1s 13789 Stored output at t = 2715.0000 s (Step 12833)
30320.1s 13790 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2700.0/2715.0 [00:00<?, ?s/s][A
30320.1s 13791 [A
30320.1s 13792 
30320.1s 13793 Simulation finished at t = 2715.0000 s after 12833 steps.
30320.1s 13794 Total runtime: 0.63 seconds.
30320.1s 13795 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 23.81s/s]
30320.1s 13796 [QUEUE_DIAGNOSTIC] ===== Step 180 t=2715.0s =====
30320.1s 13797 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30320.1s 13798 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30320.1s 13799 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30320.1s 13800 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30320.1s 13801 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30320.1s 13802 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30320.1s 13803 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30320.1s 13804 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30320.1s 13805 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30320.1s 13806 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30320.1s 13807 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30320.1s 13808 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30320.1s 13809 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30320.1s 13810 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30320.1s 13811 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30320.1s 13812 [REWARD_MICROSCOPE] step=14381 t=2715.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30320.1s 13813 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30320.1s 13814 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30320.1s 13815 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30320.1s 13816 Running simulation until t = 2730.00 s, outputting every 15.00 s
30320.1s 13817 
30320.3s 13818 [PROGRESS] Step 12850: t=2718.62/2730.00s (99.6%) | dt=0.2130s
30320.6s 13819 [PERIODIC:1000] BC_DISPATCHER [Call #13348000] current_bc_params: <class 'dict'>
30320.6s 13820 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30320.6s 13821 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30320.6s 13822 [PERIODIC:1000] BC_GPU [Call #13348000] About to launch kernel
30320.6s 13823 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30320.6s 13824 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30320.6s 13825 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30320.6s 13826 [WARNING] Automatic CFL correction applied (count: 3336900):
30320.6s 13827 Calculated CFL: 0.800 > Limit: 0.500
30320.6s 13828 Original dt: 3.411066e-01 s
30320.6s 13829 Corrected dt: 2.131916e-01 s
30320.6s 13830 Correction factor: 1.6x
30320.6s 13831 Max wave speed detected: 23.45 m/s
30320.7s 13832 [PROGRESS] Step 12900: t=2729.27/2730.00s (100.0%) | dt=0.2127s
30320.8s 13833 Stored output at t = 2730.0000 s (Step 12904)
30320.8s 13834 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2715.0/2730.0 [00:00<?, ?s/s][A
30320.8s 13835 [A
30320.8s 13836 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.51s/s]
30320.8s 13837 
30320.8s 13838 Simulation finished at t = 2730.0000 s after 12904 steps.
30320.8s 13839 Total runtime: 0.64 seconds.
30320.8s 13840 [REWARD_MICROSCOPE] step=14382 t=2730.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30320.8s 13841 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30320.8s 13842 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30320.8s 13843 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30320.8s 13844 Running simulation until t = 2745.00 s, outputting every 15.00 s
30320.8s 13845 
30321.2s 13846 [PROGRESS] Step 12950: t=2739.77/2745.00s (99.8%) | dt=0.2126s
30321.4s 13847 Stored output at t = 2745.0000 s (Step 12975)
30321.4s 13848 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2730.0/2745.0 [00:00<?, ?s/s][A
30321.4s 13849 [A
30321.4s 13850 
30321.4s 13851 Simulation finished at t = 2745.0000 s after 12975 steps.
30321.4s 13852 Total runtime: 0.63 seconds.
30321.4s 13853 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.65s/s]
30321.4s 13854 [REWARD_MICROSCOPE] step=14383 t=2745.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30321.4s 13855 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30321.4s 13856 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30321.4s 13857 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30321.4s 13858 Running simulation until t = 2760.00 s, outputting every 15.00 s
30321.4s 13859 
30321.5s 13860 [WARNING] Automatic CFL correction applied (count: 3337000):
30321.5s 13861 Calculated CFL: 0.800 > Limit: 0.500
30321.5s 13862 Original dt: 3.407212e-01 s
30321.5s 13863 Corrected dt: 2.129508e-01 s
30321.5s 13864 Correction factor: 1.6x
30321.5s 13865 Max wave speed detected: 23.48 m/s
30321.6s 13866 [PROGRESS] Step 13000: t=2750.32/2760.00s (99.6%) | dt=0.2130s
30322.0s 13867 Stored output at t = 2760.0000 s (Step 13046)
30322.0s 13868 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2745.0/2760.0 [00:00<?, ?s/s][A
30322.0s 13869 [A
30322.0s 13870 
30322.0s 13871 Simulation finished at t = 2760.0000 s after 13046 steps.
30322.0s 13872 Total runtime: 0.62 seconds.
30322.0s 13873 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.16s/s]
30322.0s 13874 [REWARD_MICROSCOPE] step=14384 t=2760.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30322.0s 13875 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30322.0s 13876 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30322.0s 13877 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30322.0s 13878 Running simulation until t = 2775.00 s, outputting every 15.00 s
30322.0s 13879 
30322.1s 13880 [PROGRESS] Step 13050: t=2760.85/2775.00s (99.5%) | dt=0.2124s
30322.4s 13881 [WARNING] Automatic CFL correction applied (count: 3337100):
30322.4s 13882 Calculated CFL: 0.800 > Limit: 0.500
30322.4s 13883 Original dt: 3.401477e-01 s
30322.4s 13884 Corrected dt: 2.125923e-01 s
30322.4s 13885 Correction factor: 1.6x
30322.4s 13886 Max wave speed detected: 23.52 m/s
30322.5s 13887 [PROGRESS] Step 13100: t=2771.47/2775.00s (99.9%) | dt=0.2127s
30322.7s 13888 Stored output at t = 2775.0000 s (Step 13117)
30322.7s 13889 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2760.0/2775.0 [00:00<?, ?s/s][A
30322.7s 13890 [A
30322.7s 13891 
30322.7s 13892 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.06s/s]
30322.7s 13893 Simulation finished at t = 2775.0000 s after 13117 steps.
30322.7s 13894 Total runtime: 0.62 seconds.
30322.7s 13895 [REWARD_MICROSCOPE] step=14385 t=2775.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30322.7s 13896 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30322.7s 13897 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30322.7s 13898 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30322.7s 13899 Running simulation until t = 2790.00 s, outputting every 15.00 s
30322.7s 13900 
30322.8s 13901 [PERIODIC:1000] BC_DISPATCHER [Call #13349000] current_bc_params: <class 'dict'>
30322.8s 13902 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30322.8s 13903 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30322.8s 13904 [PERIODIC:1000] BC_GPU [Call #13349000] About to launch kernel
30322.8s 13905 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30322.8s 13906 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30322.8s 13907 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30323.0s 13908 [PROGRESS] Step 13150: t=2782.03/2790.00s (99.7%) | dt=0.2131s
30323.3s 13909 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2775.0/2790.0 [00:00<?, ?s/s][A
30323.3s 13910 [A
30323.3s 13911 Stored output at t = 2790.0000 s (Step 13188)
30323.3s 13912 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.11s/s]
30323.3s 13913 
30323.3s 13914 Simulation finished at t = 2790.0000 s after 13188 steps.
30323.3s 13915 Total runtime: 0.62 seconds.
30323.3s 13916 [REWARD_MICROSCOPE] step=14386 t=2790.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30323.3s 13917 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30323.3s 13918 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30323.3s 13919 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30323.3s 13920 Running simulation until t = 2805.00 s, outputting every 15.00 s
30323.3s 13921 
30323.3s 13922 [WARNING] Automatic CFL correction applied (count: 3337200):
30323.3s 13923 Calculated CFL: 0.800 > Limit: 0.500
30323.3s 13924 Original dt: 3.400436e-01 s
30323.3s 13925 Corrected dt: 2.125273e-01 s
30323.3s 13926 Correction factor: 1.6x
30323.3s 13927 Max wave speed detected: 23.53 m/s
30323.4s 13928 [PROGRESS] Step 13200: t=2792.55/2805.00s (99.6%) | dt=0.2123s
30323.9s 13929 [PROGRESS] Step 13250: t=2803.18/2805.00s (99.9%) | dt=0.2128s
30323.9s 13930 Stored output at t = 2805.0000 s (Step 13259)
30323.9s 13931 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2790.0/2805.0 [00:00<?, ?s/s][A
30323.9s 13932 [A
30323.9s 13933 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.08s/s]
30323.9s 13934 
30323.9s 13935 Simulation finished at t = 2805.0000 s after 13259 steps.
30323.9s 13936 Total runtime: 0.65 seconds.
30323.9s 13937 [REWARD_MICROSCOPE] step=14387 t=2805.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30324.0s 13938 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30324.0s 13939 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30324.0s 13940 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30324.0s 13941 Running simulation until t = 2820.00 s, outputting every 15.00 s
30324.0s 13942 
30324.2s 13943 [WARNING] Automatic CFL correction applied (count: 3337300):
30324.2s 13944 Calculated CFL: 0.800 > Limit: 0.500
30324.2s 13945 Original dt: 3.409462e-01 s
30324.2s 13946 Corrected dt: 2.130914e-01 s
30324.2s 13947 Correction factor: 1.6x
30324.2s 13948 Max wave speed detected: 23.46 m/s
30324.3s 13949 [PROGRESS] Step 13300: t=2813.73/2820.00s (99.8%) | dt=0.2132s
30324.6s 13950 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2805.0/2820.0 [00:00<?, ?s/s][A
30324.6s 13951 [A
30324.6s 13952 Stored output at t = 2820.0000 s (Step 13330)
30324.6s 13953 
30324.6s 13954 Simulation finished at t = 2820.0000 s after 13330 steps.
30324.6s 13955 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.54s/s]
30324.6s 13956 Total runtime: 0.61 seconds.
30324.6s 13957 [REWARD_MICROSCOPE] step=14388 t=2820.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30324.6s 13958 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30324.6s 13959 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30324.6s 13960 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30324.6s 13961 Running simulation until t = 2835.00 s, outputting every 15.00 s
30324.6s 13962 
30324.7s 13963 [PROGRESS] Step 13350: t=2824.25/2835.00s (99.6%) | dt=0.2124s
30325.0s 13964 [PERIODIC:1000] BC_DISPATCHER [Call #13350000] current_bc_params: <class 'dict'>
30325.0s 13965 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30325.0s 13966 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30325.0s 13967 [PERIODIC:1000] BC_GPU [Call #13350000] About to launch kernel
30325.0s 13968 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30325.0s 13969 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30325.0s 13970 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30325.1s 13971 [WARNING] Automatic CFL correction applied (count: 3337400):
30325.1s 13972 Calculated CFL: 0.800 > Limit: 0.500
30325.1s 13973 Original dt: 3.403711e-01 s
30325.1s 13974 Corrected dt: 2.127320e-01 s
30325.1s 13975 Correction factor: 1.6x
30325.1s 13976 Max wave speed detected: 23.50 m/s
30325.2s 13977 [PROGRESS] Step 13400: t=2834.88/2835.00s (100.0%) | dt=0.2128s
30325.2s 13978 Stored output at t = 2835.0000 s (Step 13401)
30325.2s 13979 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2820.0/2835.0 [00:00<?, ?s/s][A
30325.2s 13980 [A
30325.2s 13981 
30325.2s 13982 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.05s/s]
30325.2s 13983 Simulation finished at t = 2835.0000 s after 13401 steps.
30325.2s 13984 Total runtime: 0.62 seconds.
30325.2s 13985 [REWARD_MICROSCOPE] step=14389 t=2835.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30325.2s 13986 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30325.2s 13987 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30325.2s 13988 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30325.2s 13989 Running simulation until t = 2850.00 s, outputting every 15.00 s
30325.2s 13990 
30325.6s 13991 [PROGRESS] Step 13450: t=2845.44/2850.00s (99.8%) | dt=0.2133s
30325.8s 13992 Stored output at t = 2850.0000 s (Step 13472)
30325.8s 13993 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2835.0/2850.0 [00:00<?, ?s/s][A
30325.8s 13994 [A
30325.8s 13995 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 24.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 24.63s/s]
30325.8s 13996 
30325.8s 13997 Simulation finished at t = 2850.0000 s after 13472 steps.
30325.8s 13998 Total runtime: 0.61 seconds.
30325.8s 13999 [REWARD_MICROSCOPE] step=14390 t=2850.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30325.8s 14000 [STEP  190] t= 2850.0s | phase=0 | reward=   0.01 | total_reward=    1.90
30325.8s 14001 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30325.8s 14002 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30325.8s 14003 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30325.8s 14004 Running simulation until t = 2865.00 s, outputting every 15.00 s
30325.8s 14005 
30325.9s 14006 [WARNING] Automatic CFL correction applied (count: 3337500):
30325.9s 14007 Calculated CFL: 0.800 > Limit: 0.500
30325.9s 14008 Original dt: 3.397675e-01 s
30325.9s 14009 Corrected dt: 2.123547e-01 s
30325.9s 14010 Correction factor: 1.6x
30325.9s 14011 Max wave speed detected: 23.55 m/s
30326.0s 14012 [PROGRESS] Step 13500: t=2855.95/2865.00s (99.7%) | dt=0.2125s
30326.4s 14013 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2850.0/2865.0 [00:00<?, ?s/s][A
30326.4s 14014 Stored output at t = 2865.0000 s (Step 13543)
30326.4s 14015 [A
30326.4s 14016 
30326.4s 14017 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 24.42s/s]
30326.4s 14018 Simulation finished at t = 2865.0000 s after 13543 steps.
30326.4s 14019 Total runtime: 0.61 seconds.
30326.4s 14020 [QUEUE_DIAGNOSTIC] ===== Step 190 t=2865.0s =====
30326.4s 14021 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30326.4s 14022 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30326.4s 14023 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30326.4s 14024 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30326.4s 14025 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30326.4s 14026 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30326.4s 14027 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30326.4s 14028 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30326.4s 14029 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30326.4s 14030 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30326.4s 14031 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30326.4s 14032 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30326.4s 14033 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30326.4s 14034 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30326.4s 14035 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30326.4s 14036 [REWARD_MICROSCOPE] step=14391 t=2865.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30326.4s 14037 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30326.4s 14038 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30326.4s 14039 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30326.4s 14040 Running simulation until t = 2880.00 s, outputting every 15.00 s
30326.4s 14041 
30326.5s 14042 [PROGRESS] Step 13550: t=2866.49/2880.00s (99.5%) | dt=0.2129s
30326.8s 14043 [WARNING] Automatic CFL correction applied (count: 3337600):
30326.8s 14044 Calculated CFL: 0.800 > Limit: 0.500
30326.8s 14045 Original dt: 3.411605e-01 s
30326.8s 14046 Corrected dt: 2.132253e-01 s
30326.8s 14047 Correction factor: 1.6x
30326.8s 14048 Max wave speed detected: 23.45 m/s
30326.9s 14049 [PROGRESS] Step 13600: t=2877.15/2880.00s (99.9%) | dt=0.2131s
30327.0s 14050 Stored output at t = 2880.0000 s (Step 13614)
30327.0s 14051 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2865.0/2880.0 [00:00<?, ?s/s][A
30327.0s 14052 [A
30327.0s 14053 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 24.13s/s]
30327.0s 14054 
30327.0s 14055 Simulation finished at t = 2880.0000 s after 13614 steps.
30327.0s 14056 Total runtime: 0.62 seconds.
30327.0s 14057 [REWARD_MICROSCOPE] step=14392 t=2880.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30327.0s 14058 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30327.0s 14059 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30327.0s 14060 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30327.0s 14061 Running simulation until t = 2895.00 s, outputting every 15.00 s
30327.0s 14062 
30327.2s 14063 [PERIODIC:1000] BC_DISPATCHER [Call #13351000] current_bc_params: <class 'dict'>
30327.2s 14064 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30327.2s 14065 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30327.2s 14066 [PERIODIC:1000] BC_GPU [Call #13351000] About to launch kernel
30327.2s 14067 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30327.2s 14068 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30327.2s 14069 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30327.4s 14070 [PROGRESS] Step 13650: t=2887.65/2895.00s (99.7%) | dt=0.2125s
30327.7s 14071 Stored output at t = 2895.0000 s (Step 13685)
30327.7s 14072 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2880.0/2895.0 [00:00<?, ?s/s][A
30327.7s 14073 [A
30327.7s 14074 
30327.7s 14075 Simulation finished at t = 2895.0000 s after 13685 steps.
30327.7s 14076 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 22.61s/s]
30327.7s 14077 Total runtime: 0.66 seconds.
30327.7s 14078 [REWARD_MICROSCOPE] step=14393 t=2895.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30327.7s 14079 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30327.7s 14080 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30327.7s 14081 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30327.7s 14082 Running simulation until t = 2910.00 s, outputting every 15.00 s
30327.7s 14083 
30327.7s 14084 [WARNING] Automatic CFL correction applied (count: 3337700):
30327.7s 14085 Calculated CFL: 0.800 > Limit: 0.500
30327.7s 14086 Original dt: 3.405828e-01 s
30327.7s 14087 Corrected dt: 2.128643e-01 s
30327.7s 14088 Correction factor: 1.6x
30327.7s 14089 Max wave speed detected: 23.49 m/s
30327.8s 14090 [PROGRESS] Step 13700: t=2898.19/2910.00s (99.6%) | dt=0.2130s
30328.3s 14091 [PROGRESS] Step 13750: t=2908.85/2910.00s (100.0%) | dt=0.2127s
30328.3s 14092 Stored output at t = 2910.0000 s (Step 13756)
30328.3s 14093 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2895.0/2910.0 [00:00<?, ?s/s][A
30328.3s 14094 [A
30328.3s 14095 
30328.3s 14096 Simulation finished at t = 2910.0000 s after 13756 steps.
30328.3s 14097 Total runtime: 0.62 seconds.
30328.3s 14098 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.34s/s]
30328.3s 14099 [REWARD_MICROSCOPE] step=14394 t=2910.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30328.3s 14100 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30328.3s 14101 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30328.3s 14102 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30328.3s 14103 Running simulation until t = 2925.00 s, outputting every 15.00 s
30328.3s 14104 
30328.6s 14105 [WARNING] Automatic CFL correction applied (count: 3337800):
30328.6s 14106 Calculated CFL: 0.800 > Limit: 0.500
30328.6s 14107 Original dt: 3.400085e-01 s
30328.6s 14108 Corrected dt: 2.125053e-01 s
30328.6s 14109 Correction factor: 1.6x
30328.6s 14110 Max wave speed detected: 23.53 m/s
30328.7s 14111 [PROGRESS] Step 13800: t=2919.35/2925.00s (99.8%) | dt=0.2126s
30329.0s 14112 Stored output at t = 2925.0000 s (Step 13827)
30329.0s 14113 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2910.0/2925.0 [00:00<?, ?s/s][A
30329.0s 14114 [A
30329.0s 14115 
30329.0s 14116 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.65s/s]
30329.0s 14117 Simulation finished at t = 2925.0000 s after 13827 steps.
30329.0s 14118 Total runtime: 0.63 seconds.
30329.0s 14119 [REWARD_MICROSCOPE] step=14395 t=2925.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30329.0s 14120 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30329.0s 14121 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30329.0s 14122 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30329.0s 14123 Running simulation until t = 2940.00 s, outputting every 15.00 s
30329.0s 14124 
30329.2s 14125 [PROGRESS] Step 13850: t=2929.90/2940.00s (99.7%) | dt=0.2130s
30329.5s 14126 [PERIODIC:1000] BC_DISPATCHER [Call #13352000] current_bc_params: <class 'dict'>
30329.5s 14127 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30329.5s 14128 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30329.5s 14129 [PERIODIC:1000] BC_GPU [Call #13352000] About to launch kernel
30329.5s 14130 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30329.5s 14131 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30329.5s 14132 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30329.5s 14133 [WARNING] Automatic CFL correction applied (count: 3337900):
30329.5s 14134 Calculated CFL: 0.800 > Limit: 0.500
30329.5s 14135 Original dt: 3.406020e-01 s
30329.5s 14136 Corrected dt: 2.128763e-01 s
30329.5s 14137 Correction factor: 1.6x
30329.5s 14138 Max wave speed detected: 23.49 m/s
30329.6s 14139 Stored output at t = 2940.0000 s (Step 13898)
30329.6s 14140 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2925.0/2940.0 [00:00<?, ?s/s][A
30329.6s 14141 [A
30329.6s 14142 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.39s/s]
30329.6s 14143 
30329.6s 14144 Simulation finished at t = 2940.0000 s after 13898 steps.
30329.6s 14145 Total runtime: 0.62 seconds.
30329.6s 14146 [REWARD_MICROSCOPE] step=14396 t=2940.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30329.6s 14147 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30329.6s 14148 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30329.6s 14149 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30329.6s 14150 Running simulation until t = 2955.00 s, outputting every 15.00 s
30329.6s 14151 
30329.6s 14152 [PROGRESS] Step 13900: t=2940.43/2955.00s (99.5%) | dt=0.2125s
30330.1s 14153 [PROGRESS] Step 13950: t=2951.05/2955.00s (99.9%) | dt=0.2127s
30330.2s 14154 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2940.0/2955.0 [00:00<?, ?s/s][A
30330.2s 14155 [A
30330.2s 14156 Stored output at t = 2955.0000 s (Step 13969)
30330.2s 14157 
30330.2s 14158 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.47s/s]
30330.2s 14159 Simulation finished at t = 2955.0000 s after 13969 steps.
30330.2s 14160 Total runtime: 0.64 seconds.
30330.2s 14161 [REWARD_MICROSCOPE] step=14397 t=2955.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30330.2s 14162 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30330.2s 14163 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30330.2s 14164 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30330.2s 14165 Running simulation until t = 2970.00 s, outputting every 15.00 s
30330.2s 14166 
30330.4s 14167 [WARNING] Automatic CFL correction applied (count: 3338000):
30330.4s 14168 Calculated CFL: 0.800 > Limit: 0.500
30330.4s 14169 Original dt: 3.408050e-01 s
30330.4s 14170 Corrected dt: 2.130031e-01 s
30330.4s 14171 Correction factor: 1.6x
30330.4s 14172 Max wave speed detected: 23.47 m/s
30330.5s 14173 [PROGRESS] Step 14000: t=2961.60/2970.00s (99.7%) | dt=0.2131s
30330.9s 14174 Stored output at t = 2970.0000 s (Step 14040)
30330.9s 14175 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2955.0/2970.0 [00:00<?, ?s/s][A
30330.9s 14176 [A
30330.9s 14177 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.55s/s]
30330.9s 14178 
30330.9s 14179 Simulation finished at t = 2970.0000 s after 14040 steps.
30330.9s 14180 Total runtime: 0.64 seconds.
30330.9s 14181 [REWARD_MICROSCOPE] step=14398 t=2970.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30330.9s 14182 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30330.9s 14183 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30330.9s 14184 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30330.9s 14185 Running simulation until t = 2985.00 s, outputting every 15.00 s
30330.9s 14186 
30331.0s 14187 [PROGRESS] Step 14050: t=2972.12/2985.00s (99.6%) | dt=0.2123s
30331.3s 14188 [WARNING] Automatic CFL correction applied (count: 3338100):
30331.3s 14189 Calculated CFL: 0.800 > Limit: 0.500
30331.3s 14190 Original dt: 3.402313e-01 s
30331.3s 14191 Corrected dt: 2.126446e-01 s
30331.3s 14192 Correction factor: 1.6x
30331.3s 14193 Max wave speed detected: 23.51 m/s
30331.4s 14194 [PROGRESS] Step 14100: t=2982.75/2985.00s (99.9%) | dt=0.2127s
30331.5s 14195 Stored output at t = 2985.0000 s (Step 14111)
30331.5s 14196 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2970.0/2985.0 [00:00<?, ?s/s][A
30331.5s 14197 [A
30331.5s 14198 
30331.5s 14199 Simulation finished at t = 2985.0000 s after 14111 steps.
30331.5s 14200 Total runtime: 0.62 seconds.
30331.5s 14201 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.16s/s]
30331.5s 14202 [REWARD_MICROSCOPE] step=14399 t=2985.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30331.5s 14203 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30331.5s 14204 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30331.5s 14205 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30331.5s 14206 Running simulation until t = 3000.00 s, outputting every 15.00 s
30331.5s 14207 
30331.7s 14208 [PERIODIC:1000] BC_DISPATCHER [Call #13353000] current_bc_params: <class 'dict'>
30331.7s 14209 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30331.7s 14210 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30331.7s 14211 [PERIODIC:1000] BC_GPU [Call #13353000] About to launch kernel
30331.7s 14212 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30331.7s 14213 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30331.7s 14214 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30331.8s 14215 [PROGRESS] Step 14150: t=2993.31/3000.00s (99.8%) | dt=0.2132s
30332.1s 14216 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2985.0/3000.0 [00:00<?, ?s/s][A
30332.1s 14217 [A
30332.1s 14218 Stored output at t = 3000.0000 s (Step 14182)
30332.1s 14219 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 24.27s/s]
30332.1s 14220 
30332.1s 14221 Simulation finished at t = 3000.0000 s after 14182 steps.
30332.1s 14222 Total runtime: 0.62 seconds.
30332.1s 14223 [REWARD_MICROSCOPE] step=14400 t=3000.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30332.1s 14224 [STEP  200] t= 3000.0s | phase=0 | reward=   0.01 | total_reward=    2.00
30332.1s 14225 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30332.1s 14226 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30332.1s 14227 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30332.1s 14228 Running simulation until t = 3015.00 s, outputting every 15.00 s
30332.1s 14229 
30332.2s 14230 [WARNING] Automatic CFL correction applied (count: 3338200):
30332.2s 14231 Calculated CFL: 0.800 > Limit: 0.500
30332.2s 14232 Original dt: 3.398030e-01 s
30332.2s 14233 Corrected dt: 2.123769e-01 s
30332.2s 14234 Correction factor: 1.6x
30332.2s 14235 Max wave speed detected: 23.54 m/s
30332.3s 14236 [PROGRESS] Step 14200: t=3003.82/3015.00s (99.6%) | dt=0.2124s
30332.7s 14237 [PROGRESS] Step 14250: t=3014.45/3015.00s (100.0%) | dt=0.2128s
30332.7s 14238 Stored output at t = 3015.0000 s (Step 14253)
30332.7s 14239 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3000.0/3015.0 [00:00<?, ?s/s][A
30332.7s 14240 [A
30332.7s 14241 
30332.7s 14242 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.41s/s]
30332.7s 14243 Simulation finished at t = 3015.0000 s after 14253 steps.
30332.7s 14244 Total runtime: 0.61 seconds.
30332.7s 14245 [QUEUE_DIAGNOSTIC] ===== Step 200 t=3015.0s =====
30332.7s 14246 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30332.7s 14247 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30332.7s 14248 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30332.7s 14249 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30332.7s 14250 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30332.7s 14251 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30332.7s 14252 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30332.7s 14253 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30332.7s 14254 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30332.7s 14255 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30332.7s 14256 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30332.7s 14257 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30332.7s 14258 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30332.7s 14259 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30332.7s 14260 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30332.7s 14261 [REWARD_MICROSCOPE] step=14401 t=3015.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30332.7s 14262 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30332.7s 14263 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30332.7s 14264 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30332.7s 14265 Running simulation until t = 3030.00 s, outputting every 15.00 s
30332.7s 14266 
30333.0s 14267 [WARNING] Automatic CFL correction applied (count: 3338300):
30333.0s 14268 Calculated CFL: 0.800 > Limit: 0.500
30333.0s 14269 Original dt: 3.410260e-01 s
30333.0s 14270 Corrected dt: 2.131412e-01 s
30333.0s 14271 Correction factor: 1.6x
30333.0s 14272 Max wave speed detected: 23.46 m/s
30333.1s 14273 [PROGRESS] Step 14300: t=3025.01/3030.00s (99.8%) | dt=0.2132s
30333.4s 14274 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3015.0/3030.0 [00:00<?, ?s/s][A
30333.4s 14275 [A
30333.4s 14276 Stored output at t = 3030.0000 s (Step 14324)
30333.4s 14277 
30333.4s 14278 Simulation finished at t = 3030.0000 s after 14324 steps.
30333.4s 14279 Total runtime: 0.62 seconds.
30333.4s 14280 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.25s/s]
30333.4s 14281 [REWARD_MICROSCOPE] step=14402 t=3030.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30333.4s 14282 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30333.4s 14283 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30333.4s 14284 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30333.4s 14285 Running simulation until t = 3045.00 s, outputting every 15.00 s
30333.4s 14286 
30333.6s 14287 [PROGRESS] Step 14350: t=3035.52/3045.00s (99.7%) | dt=0.2124s
30333.9s 14288 [PERIODIC:1000] BC_DISPATCHER [Call #13354000] current_bc_params: <class 'dict'>
30333.9s 14289 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30333.9s 14290 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30333.9s 14291 [PERIODIC:1000] BC_GPU [Call #13354000] About to launch kernel
30333.9s 14292 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30333.9s 14293 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30333.9s 14294 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30333.9s 14295 [WARNING] Automatic CFL correction applied (count: 3338400):
30333.9s 14296 Calculated CFL: 0.800 > Limit: 0.500
30333.9s 14297 Original dt: 3.404547e-01 s
30333.9s 14298 Corrected dt: 2.127842e-01 s
30333.9s 14299 Correction factor: 1.6x
30333.9s 14300 Max wave speed detected: 23.50 m/s
30334.0s 14301 Stored output at t = 3045.0000 s (Step 14395)
30334.0s 14302 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3030.0/3045.0 [00:00<?, ?s/s][A
30334.0s 14303 [A
30334.0s 14304 
30334.0s 14305 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.25s/s]
30334.0s 14306 Simulation finished at t = 3045.0000 s after 14395 steps.
30334.0s 14307 Total runtime: 0.62 seconds.
30334.0s 14308 [REWARD_MICROSCOPE] step=14403 t=3045.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30334.0s 14309 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30334.0s 14310 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30334.0s 14311 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30334.0s 14312 Running simulation until t = 3060.00 s, outputting every 15.00 s
30334.0s 14313 
30334.0s 14314 [PROGRESS] Step 14400: t=3046.06/3060.00s (99.5%) | dt=0.2129s
30334.5s 14315 [PROGRESS] Step 14450: t=3056.72/3060.00s (99.9%) | dt=0.2133s
30334.6s 14316 Stored output at t = 3060.0000 s (Step 14466)
30334.6s 14317 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3045.0/3060.0 [00:00<?, ?s/s][A
30334.6s 14318 [A
30334.6s 14319 
30334.6s 14320 Simulation finished at t = 3060.0000 s after 14466 steps.
30334.6s 14321 Total runtime: 0.62 seconds.
30334.6s 14322 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 24.12s/s]
30334.6s 14323 [REWARD_MICROSCOPE] step=14404 t=3060.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30334.6s 14324 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30334.6s 14325 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30334.6s 14326 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30334.6s 14327 Running simulation until t = 3075.00 s, outputting every 15.00 s
30334.6s 14328 
30334.8s 14329 [WARNING] Automatic CFL correction applied (count: 3338500):
30334.8s 14330 Calculated CFL: 0.800 > Limit: 0.500
30334.8s 14331 Original dt: 3.398585e-01 s
30334.8s 14332 Corrected dt: 2.124115e-01 s
30334.8s 14333 Correction factor: 1.6x
30334.8s 14334 Max wave speed detected: 23.54 m/s
30334.9s 14335 [PROGRESS] Step 14500: t=3067.22/3075.00s (99.7%) | dt=0.2125s
30335.2s 14336 Stored output at t = 3075.0000 s (Step 14537)
30335.2s 14337 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3060.0/3075.0 [00:00<?, ?s/s][A
30335.2s 14338 [A
30335.2s 14339 
30335.2s 14340 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.45s/s]
30335.2s 14341 Simulation finished at t = 3075.0000 s after 14537 steps.
30335.2s 14342 Total runtime: 0.61 seconds.
30335.2s 14343 [REWARD_MICROSCOPE] step=14405 t=3075.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30335.2s 14344 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30335.2s 14345 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30335.2s 14346 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30335.2s 14347 Running simulation until t = 3090.00 s, outputting every 15.00 s
30335.2s 14348 
30335.3s 14349 [PROGRESS] Step 14550: t=3077.77/3090.00s (99.6%) | dt=0.2129s
30335.7s 14350 [WARNING] Automatic CFL correction applied (count: 3338600):
30335.7s 14351 Calculated CFL: 0.800 > Limit: 0.500
30335.7s 14352 Original dt: 3.412422e-01 s
30335.7s 14353 Corrected dt: 2.132764e-01 s
30335.7s 14354 Correction factor: 1.6x
30335.7s 14355 Max wave speed detected: 23.44 m/s
30335.8s 14356 [PROGRESS] Step 14600: t=3088.42/3090.00s (99.9%) | dt=0.2128s
30335.8s 14357 Stored output at t = 3090.0000 s (Step 14608)
30335.8s 14358 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3075.0/3090.0 [00:00<?, ?s/s][A
30335.8s 14359 [A
30335.8s 14360 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.51s/s]
30335.8s 14361 
30335.8s 14362 Simulation finished at t = 3090.0000 s after 14608 steps.
30335.8s 14363 Total runtime: 0.61 seconds.
30335.8s 14364 [REWARD_MICROSCOPE] step=14406 t=3090.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30335.8s 14365 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30335.8s 14366 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30335.8s 14367 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30335.8s 14368 Running simulation until t = 3105.00 s, outputting every 15.00 s
30335.8s 14369 
30336.1s 14370 [PERIODIC:1000] BC_DISPATCHER [Call #13355000] current_bc_params: <class 'dict'>
30336.1s 14371 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30336.1s 14372 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30336.1s 14373 [PERIODIC:1000] BC_GPU [Call #13355000] About to launch kernel
30336.1s 14374 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30336.1s 14375 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30336.1s 14376 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30336.2s 14377 [PROGRESS] Step 14650: t=3098.92/3105.00s (99.8%) | dt=0.2126s
30336.4s 14378 Stored output at t = 3105.0000 s (Step 14679)
30336.4s 14379 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3090.0/3105.0 [00:00<?, ?s/s][A
30336.4s 14380 [A
30336.4s 14381 
30336.4s 14382 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.35s/s]
30336.4s 14383 Simulation finished at t = 3105.0000 s after 14679 steps.
30336.4s 14384 Total runtime: 0.62 seconds.
30336.4s 14385 [REWARD_MICROSCOPE] step=14407 t=3105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30336.5s 14386 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30336.5s 14387 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30336.5s 14388 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30336.5s 14389 Running simulation until t = 3120.00 s, outputting every 15.00 s
30336.5s 14390 
30336.5s 14391 [WARNING] Automatic CFL correction applied (count: 3338700):
30336.5s 14392 Calculated CFL: 0.800 > Limit: 0.500
30336.5s 14393 Original dt: 3.406657e-01 s
30336.5s 14394 Corrected dt: 2.129161e-01 s
30336.5s 14395 Correction factor: 1.6x
30336.5s 14396 Max wave speed detected: 23.48 m/s
30336.6s 14397 [PROGRESS] Step 14700: t=3109.47/3120.00s (99.7%) | dt=0.2130s
30337.1s 14398 [PROGRESS] Step 14750: t=3120.00/3120.00s (100.0%) | dt=0.0883s
30337.1s 14399 Stored output at t = 3120.0000 s (Step 14750)
30337.1s 14400 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3105.0/3120.0 [00:00<?, ?s/s][A
30337.1s 14401 [A
30337.1s 14402 
30337.1s 14403 Simulation finished at t = 3120.0000 s after 14750 steps.
30337.1s 14404 Total runtime: 0.62 seconds.
30337.1s 14405 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.39s/s]
30337.1s 14406 [REWARD_MICROSCOPE] step=14408 t=3120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30337.1s 14407 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30337.1s 14408 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30337.1s 14409 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30337.1s 14410 Running simulation until t = 3135.00 s, outputting every 15.00 s
30337.1s 14411 
30337.4s 14412 [WARNING] Automatic CFL correction applied (count: 3338800):
30337.4s 14413 Calculated CFL: 0.800 > Limit: 0.500
30337.4s 14414 Original dt: 3.400921e-01 s
30337.4s 14415 Corrected dt: 2.125575e-01 s
30337.4s 14416 Correction factor: 1.6x
30337.4s 14417 Max wave speed detected: 23.52 m/s
30337.5s 14418 [PROGRESS] Step 14800: t=3130.62/3135.00s (99.9%) | dt=0.2127s
30337.7s 14419 Stored output at t = 3135.0000 s (Step 14821)
30337.7s 14420 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3120.0/3135.0 [00:00<?, ?s/s][A
30337.7s 14421 [A
30337.7s 14422 
30337.7s 14423 Simulation finished at t = 3135.0000 s after 14821 steps.
30337.7s 14424 Total runtime: 0.62 seconds.
30337.7s 14425 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 24.13s/s]
30337.7s 14426 [REWARD_MICROSCOPE] step=14409 t=3135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30337.7s 14427 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30337.7s 14428 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30337.7s 14429 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30337.7s 14430 Running simulation until t = 3150.00 s, outputting every 15.00 s
30337.7s 14431 
30337.9s 14432 [PROGRESS] Step 14850: t=3141.18/3150.00s (99.7%) | dt=0.2131s
30338.2s 14433 [PERIODIC:1000] BC_DISPATCHER [Call #13356000] current_bc_params: <class 'dict'>
30338.2s 14434 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30338.2s 14435 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30338.2s 14436 [PERIODIC:1000] BC_GPU [Call #13356000] About to launch kernel
30338.2s 14437 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30338.2s 14438 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30338.2s 14439 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30338.3s 14440 [WARNING] Automatic CFL correction applied (count: 3338900):
30338.3s 14441 Calculated CFL: 0.800 > Limit: 0.500
30338.3s 14442 Original dt: 3.402189e-01 s
30338.3s 14443 Corrected dt: 2.126368e-01 s
30338.3s 14444 Correction factor: 1.6x
30338.3s 14445 Max wave speed detected: 23.51 m/s
30338.3s 14446 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3135.0/3150.0 [00:00<?, ?s/s][A
30338.3s 14447 [A
30338.3s 14448 Stored output at t = 3150.0000 s (Step 14892)
30338.3s 14449 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.01s/s]
30338.3s 14450 
30338.3s 14451 Simulation finished at t = 3150.0000 s after 14892 steps.
30338.3s 14452 Total runtime: 0.63 seconds.
30338.3s 14453 [REWARD_MICROSCOPE] step=14410 t=3150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30338.3s 14454 [STEP  210] t= 3150.0s | phase=0 | reward=   0.01 | total_reward=    2.10
30338.3s 14455 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30338.3s 14456 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30338.3s 14457 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30338.3s 14458 Running simulation until t = 3165.00 s, outputting every 15.00 s
30338.3s 14459 
30338.4s 14460 [PROGRESS] Step 14900: t=3151.70/3165.00s (99.6%) | dt=0.2124s
30338.8s 14461 [PROGRESS] Step 14950: t=3162.32/3165.00s (99.9%) | dt=0.2127s
30339.0s 14462 Stored output at t = 3165.0000 s (Step 14963)
30339.0s 14463 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3150.0/3165.0 [00:00<?, ?s/s][A
30339.0s 14464 [A
30339.0s 14465 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 23.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 23.64s/s]
30339.0s 14466 
30339.0s 14467 Simulation finished at t = 3165.0000 s after 14963 steps.
30339.0s 14468 Total runtime: 0.63 seconds.
30339.0s 14469 [QUEUE_DIAGNOSTIC] ===== Step 210 t=3165.0s =====
30339.0s 14470 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30339.0s 14471 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30339.0s 14472 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30339.0s 14473 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30339.0s 14474 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30339.0s 14475 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30339.0s 14476 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30339.0s 14477 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30339.0s 14478 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30339.0s 14479 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30339.0s 14480 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30339.0s 14481 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30339.0s 14482 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30339.0s 14483 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30339.0s 14484 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30339.0s 14485 [REWARD_MICROSCOPE] step=14411 t=3165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30339.0s 14486 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30339.0s 14487 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30339.0s 14488 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30339.0s 14489 Running simulation until t = 3180.00 s, outputting every 15.00 s
30339.0s 14490 
30339.2s 14491 [WARNING] Automatic CFL correction applied (count: 3339000):
30339.2s 14492 Calculated CFL: 0.800 > Limit: 0.500
30339.2s 14493 Original dt: 3.408895e-01 s
30339.2s 14494 Corrected dt: 2.130559e-01 s
30339.2s 14495 Correction factor: 1.6x
30339.2s 14496 Max wave speed detected: 23.47 m/s
30339.3s 14497 [PROGRESS] Step 15000: t=3172.88/3180.00s (99.8%) | dt=0.2131s
30339.6s 14498 Stored output at t = 3180.0000 s (Step 15034)
30339.6s 14499 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3165.0/3180.0 [00:00<?, ?s/s][A
30339.6s 14500 [A
30339.6s 14501 
30339.6s 14502 Simulation finished at t = 3180.0000 s after 15034 steps.
30339.6s 14503 Total runtime: 0.62 seconds.
30339.6s 14504 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.31s/s]
30339.6s 14505 [REWARD_MICROSCOPE] step=14412 t=3180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30339.6s 14506 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30339.6s 14507 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30339.6s 14508 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30339.6s 14509 Running simulation until t = 3195.00 s, outputting every 15.00 s
30339.6s 14510 
30339.7s 14511 [PROGRESS] Step 15050: t=3183.40/3195.00s (99.6%) | dt=0.2123s
30340.1s 14512 [WARNING] Automatic CFL correction applied (count: 3339100):
30340.1s 14513 Calculated CFL: 0.800 > Limit: 0.500
30340.1s 14514 Original dt: 3.403151e-01 s
30340.1s 14515 Corrected dt: 2.126969e-01 s
30340.1s 14516 Correction factor: 1.6x
30340.1s 14517 Max wave speed detected: 23.51 m/s
30340.2s 14518 [PROGRESS] Step 15100: t=3194.03/3195.00s (100.0%) | dt=0.2128s
30340.2s 14519 Stored output at t = 3195.0000 s (Step 15105)
30340.2s 14520 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3180.0/3195.0 [00:00<?, ?s/s][A
30340.2s 14521 [A
30340.2s 14522 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 24.26s/s]
30340.2s 14523 
30340.2s 14524 Simulation finished at t = 3195.0000 s after 15105 steps.
30340.2s 14525 Total runtime: 0.62 seconds.
30340.2s 14526 [REWARD_MICROSCOPE] step=14413 t=3195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30340.2s 14527 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30340.2s 14528 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30340.2s 14529 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30340.2s 14530 Running simulation until t = 3210.00 s, outputting every 15.00 s
30340.2s 14531 
30340.4s 14532 [PERIODIC:1000] BC_DISPATCHER [Call #13357000] current_bc_params: <class 'dict'>
30340.4s 14533 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30340.4s 14534 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30340.4s 14535 [PERIODIC:1000] BC_GPU [Call #13357000] About to launch kernel
30340.4s 14536 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30340.4s 14537 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30340.4s 14538 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30340.6s 14539 [PROGRESS] Step 15150: t=3204.59/3210.00s (99.8%) | dt=0.2132s
30340.8s 14540 Stored output at t = 3210.0000 s (Step 15176)
30340.8s 14541 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3195.0/3210.0 [00:00<?, ?s/s][A
30340.8s 14542 [A
30340.8s 14543 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.40s/s]
30340.8s 14544 
30340.8s 14545 Simulation finished at t = 3210.0000 s after 15176 steps.
30340.8s 14546 Total runtime: 0.64 seconds.
30340.8s 14547 [REWARD_MICROSCOPE] step=14414 t=3210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30340.8s 14548 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30340.8s 14549 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30340.8s 14550 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30340.8s 14551 Running simulation until t = 3225.00 s, outputting every 15.00 s
30340.8s 14552 
30340.9s 14553 [WARNING] Automatic CFL correction applied (count: 3339200):
30340.9s 14554 Calculated CFL: 0.800 > Limit: 0.500
30340.9s 14555 Original dt: 3.397193e-01 s
30340.9s 14556 Corrected dt: 2.123245e-01 s
30340.9s 14557 Correction factor: 1.6x
30340.9s 14558 Max wave speed detected: 23.55 m/s
30341.0s 14559 [PROGRESS] Step 15200: t=3215.10/3225.00s (99.7%) | dt=0.2124s
30341.5s 14560 Stored output at t = 3225.0000 s (Step 15247)
30341.5s 14561 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3210.0/3225.0 [00:00<?, ?s/s][A
30341.5s 14562 [A
30341.5s 14563 
30341.5s 14564 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.68s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.67s/s]
30341.5s 14565 Simulation finished at t = 3225.0000 s after 15247 steps.
30341.5s 14566 Total runtime: 0.61 seconds.
30341.5s 14567 [REWARD_MICROSCOPE] step=14415 t=3225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30341.5s 14568 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30341.5s 14569 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30341.5s 14570 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30341.5s 14571 Running simulation until t = 3240.00 s, outputting every 15.00 s
30341.5s 14572 
30341.5s 14573 [PROGRESS] Step 15250: t=3225.64/3240.00s (99.6%) | dt=0.2129s
30341.8s 14574 [WARNING] Automatic CFL correction applied (count: 3339300):
30341.8s 14575 Calculated CFL: 0.800 > Limit: 0.500
30341.8s 14576 Original dt: 3.411064e-01 s
30341.8s 14577 Corrected dt: 2.131915e-01 s
30341.8s 14578 Correction factor: 1.6x
30341.8s 14579 Max wave speed detected: 23.45 m/s
30341.9s 14580 [PROGRESS] Step 15300: t=3236.29/3240.00s (99.9%) | dt=0.2133s
30342.1s 14581 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3225.0/3240.0 [00:00<?, ?s/s][A
30342.1s 14582 [A
30342.1s 14583 Stored output at t = 3240.0000 s (Step 15318)
30342.1s 14584 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 24.39s/s]
30342.1s 14585 
30342.1s 14586 Simulation finished at t = 3240.0000 s after 15318 steps.
30342.1s 14587 Total runtime: 0.62 seconds.
30342.1s 14588 [REWARD_MICROSCOPE] step=14416 t=3240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30342.1s 14589 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30342.1s 14590 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30342.1s 14591 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30342.1s 14592 Running simulation until t = 3255.00 s, outputting every 15.00 s
30342.1s 14593 
30342.4s 14594 [PROGRESS] Step 15350: t=3246.80/3255.00s (99.7%) | dt=0.2125s
30342.6s 14595 [PERIODIC:1000] BC_DISPATCHER [Call #13358000] current_bc_params: <class 'dict'>
30342.6s 14596 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30342.6s 14597 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30342.6s 14598 [PERIODIC:1000] BC_GPU [Call #13358000] About to launch kernel
30342.6s 14599 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30342.6s 14600 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30342.6s 14601 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30342.7s 14602 [WARNING] Automatic CFL correction applied (count: 3339400):
30342.7s 14603 Calculated CFL: 0.800 > Limit: 0.500
30342.7s 14604 Original dt: 3.405361e-01 s
30342.7s 14605 Corrected dt: 2.128351e-01 s
30342.7s 14606 Correction factor: 1.6x
30342.7s 14607 Max wave speed detected: 23.49 m/s
30342.7s 14608 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3240.0/3255.0 [00:00<?, ?s/s][A
30342.7s 14609 [A
30342.7s 14610 Stored output at t = 3255.0000 s (Step 15389)
30342.7s 14611 
30342.7s 14612 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.03s/s]
30342.7s 14613 Simulation finished at t = 3255.0000 s after 15389 steps.
30342.7s 14614 Total runtime: 0.62 seconds.
30342.7s 14615 [REWARD_MICROSCOPE] step=14417 t=3255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30342.7s 14616 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30342.7s 14617 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30342.7s 14618 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30342.7s 14619 Running simulation until t = 3270.00 s, outputting every 15.00 s
30342.7s 14620 
30342.8s 14621 [PROGRESS] Step 15400: t=3257.34/3270.00s (99.6%) | dt=0.2129s
30343.2s 14622 [PROGRESS] Step 15450: t=3268.00/3270.00s (99.9%) | dt=0.2129s
30343.3s 14623 Stored output at t = 3270.0000 s (Step 15460)
30343.3s 14624 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3255.0/3270.0 [00:00<?, ?s/s][A
30343.3s 14625 [A
30343.3s 14626 
30343.3s 14627 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.50s/s]
30343.3s 14628 Simulation finished at t = 3270.0000 s after 15460 steps.
30343.3s 14629 Total runtime: 0.61 seconds.
30343.3s 14630 [REWARD_MICROSCOPE] step=14418 t=3270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30343.3s 14631 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30343.3s 14632 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30343.3s 14633 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30343.3s 14634 Running simulation until t = 3285.00 s, outputting every 15.00 s
30343.3s 14635 
30343.6s 14636 [WARNING] Automatic CFL correction applied (count: 3339500):
30343.6s 14637 Calculated CFL: 0.800 > Limit: 0.500
30343.6s 14638 Original dt: 3.399493e-01 s
30343.6s 14639 Corrected dt: 2.124683e-01 s
30343.6s 14640 Correction factor: 1.6x
30343.6s 14641 Max wave speed detected: 23.53 m/s
30343.7s 14642 [PROGRESS] Step 15500: t=3278.50/3285.00s (99.8%) | dt=0.2126s
30343.9s 14643 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3270.0/3285.0 [00:00<?, ?s/s][A
30343.9s 14644 [A
30343.9s 14645 Stored output at t = 3285.0000 s (Step 15531)
30343.9s 14646 
30343.9s 14647 Simulation finished at t = 3285.0000 s after 15531 steps.
30343.9s 14648 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.21s/s]
30343.9s 14649 Total runtime: 0.62 seconds.
30343.9s 14650 [REWARD_MICROSCOPE] step=14419 t=3285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30343.9s 14651 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30343.9s 14652 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30343.9s 14653 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30343.9s 14654 Running simulation until t = 3300.00 s, outputting every 15.00 s
30343.9s 14655 
30344.1s 14656 [PROGRESS] Step 15550: t=3289.05/3300.00s (99.7%) | dt=0.2130s
30344.4s 14657 [WARNING] Automatic CFL correction applied (count: 3339600):
30344.4s 14658 Calculated CFL: 0.800 > Limit: 0.500
30344.4s 14659 Original dt: 3.409227e-01 s
30344.4s 14660 Corrected dt: 2.130767e-01 s
30344.4s 14661 Correction factor: 1.6x
30344.4s 14662 Max wave speed detected: 23.47 m/s
30344.6s 14663 [PROGRESS] Step 15600: t=3299.70/3300.00s (100.0%) | dt=0.2126s
30344.6s 14664 Stored output at t = 3300.0000 s (Step 15602)
30344.6s 14665 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3285.0/3300.0 [00:00<?, ?s/s][A
30344.6s 14666 [A
30344.6s 14667 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 23.81s/s]
30344.6s 14668 
30344.6s 14669 Simulation finished at t = 3300.0000 s after 15602 steps.
30344.6s 14670 Total runtime: 0.63 seconds.
30344.6s 14671 [REWARD_MICROSCOPE] step=14420 t=3300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30344.6s 14672 [STEP  220] t= 3300.0s | phase=0 | reward=   0.01 | total_reward=    2.20
30344.6s 14673 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30344.6s 14674 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30344.6s 14675 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30344.6s 14676 Running simulation until t = 3315.00 s, outputting every 15.00 s
30344.6s 14677 
30344.8s 14678 [PERIODIC:1000] BC_DISPATCHER [Call #13359000] current_bc_params: <class 'dict'>
30344.8s 14679 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30344.8s 14680 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30344.8s 14681 [PERIODIC:1000] BC_GPU [Call #13359000] About to launch kernel
30344.8s 14682 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30344.8s 14683 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30344.8s 14684 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30345.0s 14685 [PROGRESS] Step 15650: t=3310.20/3315.00s (99.9%) | dt=0.2126s
30345.2s 14686 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3300.0/3315.0 [00:00<?, ?s/s][A
30345.2s 14687 [A
30345.2s 14688 Stored output at t = 3315.0000 s (Step 15673)
30345.2s 14689 
30345.2s 14690 Simulation finished at t = 3315.0000 s after 15673 steps.
30345.2s 14691 Total runtime: 0.63 seconds.
30345.2s 14692 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 23.99s/s]
30345.2s 14693 [QUEUE_DIAGNOSTIC] ===== Step 220 t=3315.0s =====
30345.2s 14694 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30345.2s 14695 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30345.2s 14696 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30345.2s 14697 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30345.2s 14698 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30345.2s 14699 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30345.2s 14700 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30345.2s 14701 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30345.2s 14702 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30345.2s 14703 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30345.2s 14704 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30345.2s 14705 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30345.2s 14706 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30345.2s 14707 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30345.2s 14708 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30345.2s 14709 [REWARD_MICROSCOPE] step=14421 t=3315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30345.2s 14710 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30345.2s 14711 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30345.2s 14712 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30345.2s 14713 Running simulation until t = 3330.00 s, outputting every 15.00 s
30345.2s 14714 
30345.3s 14715 [WARNING] Automatic CFL correction applied (count: 3339700):
30345.3s 14716 Calculated CFL: 0.800 > Limit: 0.500
30345.3s 14717 Original dt: 3.407491e-01 s
30345.3s 14718 Corrected dt: 2.129682e-01 s
30345.3s 14719 Correction factor: 1.6x
30345.3s 14720 Max wave speed detected: 23.48 m/s
30345.4s 14721 [PROGRESS] Step 15700: t=3320.75/3330.00s (99.7%) | dt=0.2131s
30345.8s 14722 Stored output at t = 3330.0000 s (Step 15744)
30345.8s 14723 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3315.0/3330.0 [00:00<?, ?s/s][A
30345.8s 14724 [A
30345.8s 14725 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 24.53s/s]
30345.8s 14726 
30345.8s 14727 Simulation finished at t = 3330.0000 s after 15744 steps.
30345.8s 14728 Total runtime: 0.61 seconds.
30345.8s 14729 [REWARD_MICROSCOPE] step=14422 t=3330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30345.8s 14730 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30345.8s 14731 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30345.8s 14732 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30345.8s 14733 Running simulation until t = 3345.00 s, outputting every 15.00 s
30345.8s 14734 
30345.9s 14735 [PROGRESS] Step 15750: t=3331.27/3345.00s (99.6%) | dt=0.2124s
30346.2s 14736 [WARNING] Automatic CFL correction applied (count: 3339800):
30346.2s 14737 Calculated CFL: 0.800 > Limit: 0.500
30346.2s 14738 Original dt: 3.401756e-01 s
30346.2s 14739 Corrected dt: 2.126097e-01 s
30346.2s 14740 Correction factor: 1.6x
30346.2s 14741 Max wave speed detected: 23.52 m/s
30346.3s 14742 [PROGRESS] Step 15800: t=3341.90/3345.00s (99.9%) | dt=0.2127s
30346.4s 14743 Stored output at t = 3345.0000 s (Step 15815)
30346.4s 14744 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3330.0/3345.0 [00:00<?, ?s/s][A
30346.4s 14745 [A
30346.4s 14746 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.55s/s]
30346.4s 14747 
30346.4s 14748 Simulation finished at t = 3345.0000 s after 15815 steps.
30346.4s 14749 Total runtime: 0.61 seconds.
30346.4s 14750 [REWARD_MICROSCOPE] step=14423 t=3345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30346.4s 14751 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30346.4s 14752 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30346.4s 14753 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30346.4s 14754 Running simulation until t = 3360.00 s, outputting every 15.00 s
30346.4s 14755 
30346.7s 14756 [PROGRESS] Step 15850: t=3352.45/3360.00s (99.8%) | dt=0.2131s
30347.0s 14757 [PERIODIC:1000] BC_DISPATCHER [Call #13360000] current_bc_params: <class 'dict'>
30347.0s 14758 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30347.0s 14759 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30347.0s 14760 [PERIODIC:1000] BC_GPU [Call #13360000] About to launch kernel
30347.0s 14761 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30347.0s 14762 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30347.0s 14763 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30347.0s 14764 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3345.0/3360.0 [00:00<?, ?s/s][A
30347.0s 14765 [A
30347.0s 14766 Stored output at t = 3360.0000 s (Step 15886)
30347.0s 14767 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 24.25s/s]
30347.0s 14768 
30347.0s 14769 Simulation finished at t = 3360.0000 s after 15886 steps.
30347.0s 14770 Total runtime: 0.62 seconds.
30347.0s 14771 [REWARD_MICROSCOPE] step=14424 t=3360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30347.1s 14772 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30347.1s 14773 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30347.1s 14774 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30347.1s 14775 Running simulation until t = 3375.00 s, outputting every 15.00 s
30347.1s 14776 
30347.1s 14777 [WARNING] Automatic CFL correction applied (count: 3339900):
30347.1s 14778 Calculated CFL: 0.800 > Limit: 0.500
30347.1s 14779 Original dt: 3.399530e-01 s
30347.1s 14780 Corrected dt: 2.124706e-01 s
30347.1s 14781 Correction factor: 1.6x
30347.1s 14782 Max wave speed detected: 23.53 m/s
30347.2s 14783 [PROGRESS] Step 15900: t=3362.97/3375.00s (99.6%) | dt=0.2123s
30347.6s 14784 [PROGRESS] Step 15950: t=3373.60/3375.00s (100.0%) | dt=0.2128s
30347.7s 14785 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3360.0/3375.0 [00:00<?, ?s/s][A
30347.7s 14786 [A
30347.7s 14787 Stored output at t = 3375.0000 s (Step 15957)
30347.7s 14788 
30347.7s 14789 Simulation finished at t = 3375.0000 s after 15957 steps.
30347.7s 14790 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.80s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 23.79s/s]
30347.7s 14791 Total runtime: 0.63 seconds.
30347.7s 14792 [REWARD_MICROSCOPE] step=14425 t=3375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30347.7s 14793 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30347.7s 14794 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30347.7s 14795 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30347.7s 14796 Running simulation until t = 3390.00 s, outputting every 15.00 s
30347.7s 14797 
30348.0s 14798 [WARNING] Automatic CFL correction applied (count: 3340000):
30348.0s 14799 Calculated CFL: 0.800 > Limit: 0.500
30348.0s 14800 Original dt: 3.409728e-01 s
30348.0s 14801 Corrected dt: 2.131080e-01 s
30348.0s 14802 Correction factor: 1.6x
30348.0s 14803 Max wave speed detected: 23.46 m/s
30348.1s 14804 [PROGRESS] Step 16000: t=3384.16/3390.00s (99.8%) | dt=0.2132s
30348.3s 14805 Stored output at t = 3390.0000 s (Step 16028)
30348.3s 14806 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3375.0/3390.0 [00:00<?, ?s/s][A
30348.3s 14807 [A
30348.3s 14808 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.15s/s]
30348.3s 14809 
30348.3s 14810 Simulation finished at t = 3390.0000 s after 16028 steps.
30348.3s 14811 Total runtime: 0.62 seconds.
30348.3s 14812 [REWARD_MICROSCOPE] step=14426 t=3390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30348.3s 14813 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30348.3s 14814 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30348.3s 14815 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30348.3s 14816 Running simulation until t = 3405.00 s, outputting every 15.00 s
30348.3s 14817 
30348.5s 14818 [PROGRESS] Step 16050: t=3394.67/3405.00s (99.7%) | dt=0.2124s
30348.8s 14819 [WARNING] Automatic CFL correction applied (count: 3340100):
30348.8s 14820 Calculated CFL: 0.800 > Limit: 0.500
30348.8s 14821 Original dt: 3.403992e-01 s
30348.8s 14822 Corrected dt: 2.127495e-01 s
30348.8s 14823 Correction factor: 1.6x
30348.8s 14824 Max wave speed detected: 23.50 m/s
30348.9s 14825 Stored output at t = 3405.0000 s (Step 16099)
30348.9s 14826 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3390.0/3405.0 [00:00<?, ?s/s][A
30348.9s 14827 [A
30348.9s 14828 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.39s/s]
30348.9s 14829 
30348.9s 14830 Simulation finished at t = 3405.0000 s after 16099 steps.
30348.9s 14831 Total runtime: 0.62 seconds.
30348.9s 14832 [REWARD_MICROSCOPE] step=14427 t=3405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30348.9s 14833 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30348.9s 14834 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30348.9s 14835 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30348.9s 14836 Running simulation until t = 3420.00 s, outputting every 15.00 s
30348.9s 14837 
30348.9s 14838 [PROGRESS] Step 16100: t=3405.21/3420.00s (99.6%) | dt=0.2128s
30349.2s 14839 [PERIODIC:1000] BC_DISPATCHER [Call #13361000] current_bc_params: <class 'dict'>
30349.2s 14840 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30349.2s 14841 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30349.2s 14842 [PERIODIC:1000] BC_GPU [Call #13361000] About to launch kernel
30349.2s 14843 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30349.2s 14844 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30349.2s 14845 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30349.4s 14846 [PROGRESS] Step 16150: t=3415.87/3420.00s (99.9%) | dt=0.2133s
30349.5s 14847 Stored output at t = 3420.0000 s (Step 16170)
30349.5s 14848 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3405.0/3420.0 [00:00<?, ?s/s][A
30349.5s 14849 [A
30349.5s 14850 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 24.15s/s]
30349.5s 14851 
30349.5s 14852 Simulation finished at t = 3420.0000 s after 16170 steps.
30349.5s 14853 Total runtime: 0.62 seconds.
30349.5s 14854 [REWARD_MICROSCOPE] step=14428 t=3420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30349.5s 14855 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30349.5s 14856 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30349.5s 14857 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30349.5s 14858 Running simulation until t = 3435.00 s, outputting every 15.00 s
30349.5s 14859 
30349.7s 14860 [WARNING] Automatic CFL correction applied (count: 3340200):
30349.7s 14861 Calculated CFL: 0.800 > Limit: 0.500
30349.7s 14862 Original dt: 3.397973e-01 s
30349.7s 14863 Corrected dt: 2.123733e-01 s
30349.7s 14864 Correction factor: 1.6x
30349.7s 14865 Max wave speed detected: 23.54 m/s
30349.8s 14866 [PROGRESS] Step 16200: t=3426.37/3435.00s (99.7%) | dt=0.2125s
30350.2s 14867 Stored output at t = 3435.0000 s (Step 16241)
30350.2s 14868 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3420.0/3435.0 [00:00<?, ?s/s][A
30350.2s 14869 [A
30350.2s 14870 
30350.2s 14871 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.17s/s]
30350.2s 14872 Simulation finished at t = 3435.0000 s after 16241 steps.
30350.2s 14873 Total runtime: 0.62 seconds.
30350.2s 14874 [REWARD_MICROSCOPE] step=14429 t=3435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30350.2s 14875 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30350.2s 14876 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30350.2s 14877 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30350.2s 14878 Running simulation until t = 3450.00 s, outputting every 15.00 s
30350.2s 14879 
30350.3s 14880 [PROGRESS] Step 16250: t=3436.92/3450.00s (99.6%) | dt=0.2129s
30350.6s 14881 [WARNING] Automatic CFL correction applied (count: 3340300):
30350.6s 14882 Calculated CFL: 0.800 > Limit: 0.500
30350.6s 14883 Original dt: 3.411876e-01 s
30350.6s 14884 Corrected dt: 2.132423e-01 s
30350.6s 14885 Correction factor: 1.6x
30350.6s 14886 Max wave speed detected: 23.45 m/s
30350.7s 14887 [PROGRESS] Step 16300: t=3447.57/3450.00s (99.9%) | dt=0.2130s
30350.8s 14888 Stored output at t = 3450.0000 s (Step 16312)
30350.8s 14889 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3435.0/3450.0 [00:00<?, ?s/s][A
30350.8s 14890 [A
30350.8s 14891 
30350.8s 14892 Simulation finished at t = 3450.0000 s after 16312 steps.
30350.8s 14893 Total runtime: 0.64 seconds.
30350.8s 14894 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 23.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 23.38s/s]
30350.8s 14895 [REWARD_MICROSCOPE] step=14430 t=3450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30350.8s 14896 [STEP  230] t= 3450.0s | phase=0 | reward=   0.01 | total_reward=    2.30
30350.8s 14897 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30350.8s 14898 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30350.8s 14899 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30350.8s 14900 Running simulation until t = 3465.00 s, outputting every 15.00 s
30350.8s 14901 
30351.2s 14902 [PROGRESS] Step 16350: t=3458.07/3465.00s (99.8%) | dt=0.2125s
30351.4s 14903 Stored output at t = 3465.0000 s (Step 16383)
30351.4s 14904 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3450.0/3465.0 [00:00<?, ?s/s][A
30351.4s 14905 [A
30351.4s 14906 
30351.4s 14907 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.22s/s]
30351.4s 14908 Simulation finished at t = 3465.0000 s after 16383 steps.
30351.4s 14909 Total runtime: 0.62 seconds.
30351.4s 14910 [QUEUE_DIAGNOSTIC] ===== Step 230 t=3465.0s =====
30351.4s 14911 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30351.4s 14912 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30351.4s 14913 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30351.4s 14914 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30351.4s 14915 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30351.4s 14916 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30351.4s 14917 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30351.4s 14918 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30351.4s 14919 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30351.4s 14920 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30351.4s 14921 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30351.4s 14922 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30351.4s 14923 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30351.4s 14924 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30351.4s 14925 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30351.4s 14926 [REWARD_MICROSCOPE] step=14431 t=3465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30351.4s 14927 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30351.4s 14928 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30351.4s 14929 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30351.4s 14930 Running simulation until t = 3480.00 s, outputting every 15.00 s
30351.4s 14931 
30351.4s 14932 [PERIODIC:1000] BC_DISPATCHER [Call #13362000] current_bc_params: <class 'dict'>
30351.4s 14933 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30351.4s 14934 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30351.4s 14935 [PERIODIC:1000] BC_GPU [Call #13362000] About to launch kernel
30351.4s 14936 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30351.4s 14937 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30351.4s 14938 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30351.5s 14939 [WARNING] Automatic CFL correction applied (count: 3340400):
30351.5s 14940 Calculated CFL: 0.800 > Limit: 0.500
30351.5s 14941 Original dt: 3.406104e-01 s
30351.5s 14942 Corrected dt: 2.128815e-01 s
30351.5s 14943 Correction factor: 1.6x
30351.5s 14944 Max wave speed detected: 23.49 m/s
30351.6s 14945 [PROGRESS] Step 16400: t=3468.62/3480.00s (99.7%) | dt=0.2130s
30352.0s 14946 [PROGRESS] Step 16450: t=3479.27/3480.00s (100.0%) | dt=0.2127s
30352.1s 14947 Stored output at t = 3480.0000 s (Step 16454)
30352.1s 14948 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3465.0/3480.0 [00:00<?, ?s/s][A
30352.1s 14949 [A
30352.1s 14950 
30352.1s 14951 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.25s/s]
30352.1s 14952 Simulation finished at t = 3480.0000 s after 16454 steps.
30352.1s 14953 Total runtime: 0.62 seconds.
30352.1s 14954 [REWARD_MICROSCOPE] step=14432 t=3480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30352.1s 14955 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30352.1s 14956 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30352.1s 14957 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30352.1s 14958 Running simulation until t = 3495.00 s, outputting every 15.00 s
30352.1s 14959 
30352.4s 14960 [WARNING] Automatic CFL correction applied (count: 3340500):
30352.4s 14961 Calculated CFL: 0.800 > Limit: 0.500
30352.4s 14962 Original dt: 3.400365e-01 s
30352.4s 14963 Corrected dt: 2.125228e-01 s
30352.4s 14964 Correction factor: 1.6x
30352.4s 14965 Max wave speed detected: 23.53 m/s
30352.5s 14966 [PROGRESS] Step 16500: t=3489.77/3495.00s (99.9%) | dt=0.2126s
30352.7s 14967 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3480.0/3495.0 [00:00<?, ?s/s][A
30352.7s 14968 [A
30352.7s 14969 Stored output at t = 3495.0000 s (Step 16525)
30352.7s 14970 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.35s/s]
30352.7s 14971 
30352.7s 14972 Simulation finished at t = 3495.0000 s after 16525 steps.
30352.7s 14973 Total runtime: 0.62 seconds.
30352.7s 14974 [REWARD_MICROSCOPE] step=14433 t=3495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30352.7s 14975 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30352.7s 14976 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30352.7s 14977 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30352.7s 14978 Running simulation until t = 3510.00 s, outputting every 15.00 s
30352.7s 14979 
30352.9s 14980 [PROGRESS] Step 16550: t=3500.32/3510.00s (99.7%) | dt=0.2130s
30353.2s 14981 [WARNING] Automatic CFL correction applied (count: 3340600):
30353.2s 14982 Calculated CFL: 0.800 > Limit: 0.500
30353.2s 14983 Original dt: 3.404624e-01 s
30353.2s 14984 Corrected dt: 2.127890e-01 s
30353.2s 14985 Correction factor: 1.6x
30353.2s 14986 Max wave speed detected: 23.50 m/s
30353.3s 14987 Stored output at t = 3510.0000 s (Step 16596)
30353.3s 14988 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3495.0/3510.0 [00:00<?, ?s/s][A
30353.3s 14989 [A
30353.3s 14990 
30353.3s 14991 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.53s/s]
30353.3s 14992 Simulation finished at t = 3510.0000 s after 16596 steps.
30353.3s 14993 Total runtime: 0.61 seconds.
30353.3s 14994 [REWARD_MICROSCOPE] step=14434 t=3510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30353.3s 14995 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30353.3s 14996 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30353.3s 14997 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30353.3s 14998 Running simulation until t = 3525.00 s, outputting every 15.00 s
30353.3s 14999 
30353.3s 15000 [PROGRESS] Step 16600: t=3510.85/3525.00s (99.6%) | dt=0.2124s
30353.6s 15001 [PERIODIC:1000] BC_DISPATCHER [Call #13363000] current_bc_params: <class 'dict'>
30353.6s 15002 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30353.6s 15003 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30353.6s 15004 [PERIODIC:1000] BC_GPU [Call #13363000] About to launch kernel
30353.6s 15005 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30353.6s 15006 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30353.6s 15007 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30353.8s 15008 [PROGRESS] Step 16650: t=3521.47/3525.00s (99.9%) | dt=0.2127s
30353.9s 15009 Stored output at t = 3525.0000 s (Step 16667)
30353.9s 15010 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3510.0/3525.0 [00:00<?, ?s/s][A
30353.9s 15011 [A
30353.9s 15012 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.48s/s]
30353.9s 15013 
30353.9s 15014 Simulation finished at t = 3525.0000 s after 16667 steps.
30353.9s 15015 Total runtime: 0.61 seconds.
30353.9s 15016 [REWARD_MICROSCOPE] step=14435 t=3525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30353.9s 15017 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30353.9s 15018 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30353.9s 15019 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30353.9s 15020 Running simulation until t = 3540.00 s, outputting every 15.00 s
30353.9s 15021 
30354.1s 15022 [WARNING] Automatic CFL correction applied (count: 3340700):
30354.1s 15023 Calculated CFL: 0.800 > Limit: 0.500
30354.1s 15024 Original dt: 3.408331e-01 s
30354.1s 15025 Corrected dt: 2.130207e-01 s
30354.1s 15026 Correction factor: 1.6x
30354.1s 15027 Max wave speed detected: 23.47 m/s
30354.2s 15028 [PROGRESS] Step 16700: t=3532.03/3540.00s (99.8%) | dt=0.2131s
30354.5s 15029 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3525.0/3540.0 [00:00<?, ?s/s][A
30354.5s 15030 Stored output at t = 3540.0000 s (Step 16738)
30354.5s 15031 [A
30354.5s 15032 
30354.5s 15033 Simulation finished at t = 3540.0000 s after 16738 steps.
30354.5s 15034 Total runtime: 0.61 seconds.
30354.5s 15035 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.49s/s]
30354.5s 15036 [REWARD_MICROSCOPE] step=14436 t=3540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30354.5s 15037 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30354.5s 15038 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30354.5s 15039 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30354.5s 15040 Running simulation until t = 3555.00 s, outputting every 15.00 s
30354.5s 15041 
30354.6s 15042 [PROGRESS] Step 16750: t=3542.55/3555.00s (99.6%) | dt=0.2123s
30355.0s 15043 [WARNING] Automatic CFL correction applied (count: 3340800):
30355.0s 15044 Calculated CFL: 0.800 > Limit: 0.500
30355.0s 15045 Original dt: 3.402592e-01 s
30355.0s 15046 Corrected dt: 2.126620e-01 s
30355.0s 15047 Correction factor: 1.6x
30355.0s 15048 Max wave speed detected: 23.51 m/s
30355.1s 15049 [PROGRESS] Step 16800: t=3553.18/3555.00s (99.9%) | dt=0.2128s
30355.1s 15050 Stored output at t = 3555.0000 s (Step 16809)
30355.1s 15051 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3540.0/3555.0 [00:00<?, ?s/s][A
30355.1s 15052 [A
30355.1s 15053 
30355.1s 15054 Simulation finished at t = 3555.0000 s after 16809 steps.
30355.1s 15055 Total runtime: 0.61 seconds.
30355.1s 15056 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 24.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 24.59s/s]
30355.1s 15057 [REWARD_MICROSCOPE] step=14437 t=3555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30355.1s 15058 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30355.1s 15059 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30355.1s 15060 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30355.1s 15061 Running simulation until t = 3570.00 s, outputting every 15.00 s
30355.1s 15062 
30355.5s 15063 [PROGRESS] Step 16850: t=3563.73/3570.00s (99.8%) | dt=0.2132s
30355.7s 15064 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3555.0/3570.0 [00:00<?, ?s/s][A
30355.7s 15065 [A
30355.7s 15066 Stored output at t = 3570.0000 s (Step 16880)
30355.7s 15067 
30355.7s 15068 Simulation finished at t = 3570.0000 s after 16880 steps.
30355.7s 15069 Total runtime: 0.61 seconds.
30355.7s 15070 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.66s/s]
30355.8s 15071 [REWARD_MICROSCOPE] step=14438 t=3570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30355.8s 15072 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30355.8s 15073 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30355.8s 15074 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30355.8s 15075 Running simulation until t = 3585.00 s, outputting every 15.00 s
30355.8s 15076 
30355.8s 15077 [PERIODIC:1000] BC_DISPATCHER [Call #13364000] current_bc_params: <class 'dict'>
30355.8s 15078 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30355.8s 15079 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30355.8s 15080 [PERIODIC:1000] BC_GPU [Call #13364000] About to launch kernel
30355.8s 15081 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30355.8s 15082 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30355.8s 15083 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30355.8s 15084 [WARNING] Automatic CFL correction applied (count: 3340900):
30355.8s 15085 Calculated CFL: 0.800 > Limit: 0.500
30355.8s 15086 Original dt: 3.397413e-01 s
30355.8s 15087 Corrected dt: 2.123383e-01 s
30355.8s 15088 Correction factor: 1.6x
30355.8s 15089 Max wave speed detected: 23.55 m/s
30355.9s 15090 [PROGRESS] Step 16900: t=3574.25/3585.00s (99.7%) | dt=0.2124s
30356.4s 15091 [PROGRESS] Step 16950: t=3584.88/3585.00s (100.0%) | dt=0.2128s
30356.4s 15092 Stored output at t = 3585.0000 s (Step 16951)
30356.4s 15093 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3570.0/3585.0 [00:00<?, ?s/s][A
30356.4s 15094 [A
30356.4s 15095 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 24.53s/s]
30356.4s 15096 
30356.4s 15097 Simulation finished at t = 3585.0000 s after 16951 steps.
30356.4s 15098 Total runtime: 0.61 seconds.
30356.4s 15099 [REWARD_MICROSCOPE] step=14439 t=3585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30356.4s 15100 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30356.4s 15101 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30356.4s 15102 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30356.4s 15103 Running simulation until t = 3600.00 s, outputting every 15.00 s
30356.4s 15104 
30356.7s 15105 [WARNING] Automatic CFL correction applied (count: 3341000):
30356.7s 15106 Calculated CFL: 0.800 > Limit: 0.500
30356.7s 15107 Original dt: 3.410527e-01 s
30356.7s 15108 Corrected dt: 2.131579e-01 s
30356.7s 15109 Correction factor: 1.6x
30356.7s 15110 Max wave speed detected: 23.46 m/s
30356.8s 15111 [PROGRESS] Step 17000: t=3595.44/3600.00s (99.9%) | dt=0.2133s
30357.0s 15112 Stored output at t = 3600.0000 s (Step 17022)
30357.0s 15113 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3585.0/3600.0 [00:00<?, ?s/s][A
30357.0s 15114 [A
30357.0s 15115 
30357.0s 15116 Simulation finished at t = 3600.0000 s after 17022 steps.
30357.0s 15117 Total runtime: 0.62 seconds.
30357.0s 15118 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.31s/s]
30357.0s 15119 [REWARD_MICROSCOPE] step=14440 t=3600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30357.0s 15120 [STEP  240] t= 3600.0s | phase=0 | reward=   0.01 | total_reward=    2.40
30357.0s 15121 DEBUG: Truncation - runner.t=3600.0, episode_max_time=3600.0
30357.0s 15122 
30357.0s 15123 ================================================================================
30357.0s 15124 [EPISODE END] Steps: 240 | Duration: 3600.0s | Total Reward: 2.40 | Avg Reward/Step: 0.010
30357.0s 15125 ================================================================================
30357.0s 15126 
30357.0s 15127 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30357.0s 15128 Using device: gpu
30357.0s 15129 DEBUG PARAMS: Reading K_m_kmh = 10.0
30357.0s 15130 DEBUG PARAMS: Reading K_c_kmh = 15.0
30357.0s 15131 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30357.0s 15132 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30357.0s 15133 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30357.0s 15134 V0_m = 13.333 m/s (48.0 km/h)
30357.0s 15135 V0_c = 11.667 m/s (42.0 km/h)
30357.0s 15136 Parameters loaded for scenario: adaptive_speed_control
30357.0s 15137 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30357.0s 15138 Loading road quality type: uniform
30357.0s 15139 Uniform road quality value: 1
30357.0s 15140 Road quality loaded.
30357.0s 15141 Initial state created.
30357.0s 15142 Transferring initial state and road quality to GPU...
30357.0s 15143 GPU data transfer complete.
30357.0s 15144 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30357.0s 15145 Initial boundary conditions applied.
30357.0s 15146 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30357.0s 15147 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30357.0s 15148 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30357.0s 15149 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30357.0s 15150 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30357.0s 15151 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30357.0s 15152 Running simulation until t = 15.00 s, outputting every 15.00 s
30357.0s 15153 
30357.4s 15154 [PROGRESS] Step 50: t=13.88/15.00s (92.6%) | dt=0.2304s
30357.5s 15155 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30357.5s 15156 [A
30357.5s 15157 Stored output at t = 15.0000 s (Step 55)
30357.5s 15158 
30357.5s 15159 Simulation finished at t = 15.0000 s after 55 steps.
30357.5s 15160 Total runtime: 0.49 seconds.
30357.5s 15161 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 30.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 30.89s/s]
30357.5s 15162 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30357.5s 15163 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30357.5s 15164 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01592309 1.         0.04031418 1.        ] (rho_m, v_m, rho_c, v_c)
30357.5s 15165 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30357.5s 15166 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30357.5s 15167 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30357.5s 15168 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00477693 0.00461974 0.0045987  0.00461509 0.00464349 0.00467782]
30357.5s 15169 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00604713 0.0058468  0.0058367  0.00589007 0.00596703 0.00605711]
30357.5s 15170 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30357.5s 15171 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30357.5s 15172 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30357.5s 15173 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30357.5s 15174 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30357.5s 15175 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30357.5s 15176 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30357.5s 15177 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30357.5s 15178 [REWARD_MICROSCOPE] step=14441 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30357.5s 15179 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30357.5s 15180 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30357.5s 15181 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30357.5s 15182 Running simulation until t = 30.00 s, outputting every 15.00 s
30357.5s 15183 
30357.6s 15184 [WARNING] Automatic CFL correction applied (count: 3341100):
30357.6s 15185 Calculated CFL: 0.800 > Limit: 0.500
30357.6s 15186 Original dt: 3.587929e-01 s
30357.6s 15187 Corrected dt: 2.242455e-01 s
30357.6s 15188 Correction factor: 1.6x
30357.6s 15189 Max wave speed detected: 22.30 m/s
30357.9s 15190 [PROGRESS] Step 100: t=24.93/30.00s (83.1%) | dt=0.2150s
30358.0s 15191 [PERIODIC:1000] BC_DISPATCHER [Call #13365000] current_bc_params: <class 'dict'>
30358.0s 15192 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30358.0s 15193 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30358.0s 15194 [PERIODIC:1000] BC_GPU [Call #13365000] About to launch kernel
30358.0s 15195 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30358.0s 15196 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30358.0s 15197 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30358.1s 15198 Stored output at t = 30.0000 s (Step 124)
30358.1s 15199 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30358.1s 15200 [A
30358.1s 15201 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.64s/s]
30358.1s 15202 
30358.1s 15203 Simulation finished at t = 30.0000 s after 124 steps.
30358.1s 15204 Total runtime: 0.61 seconds.
30358.1s 15205 [REWARD_MICROSCOPE] step=14442 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30358.1s 15206 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30358.1s 15207 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30358.1s 15208 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30358.1s 15209 Running simulation until t = 45.00 s, outputting every 15.00 s
30358.1s 15210 
30358.3s 15211 [PROGRESS] Step 150: t=35.53/45.00s (79.0%) | dt=0.2127s
30358.5s 15212 [WARNING] Automatic CFL correction applied (count: 3341200):
30358.5s 15213 Calculated CFL: 0.800 > Limit: 0.500
30358.5s 15214 Original dt: 3.407013e-01 s
30358.5s 15215 Corrected dt: 2.129383e-01 s
30358.5s 15216 Correction factor: 1.6x
30358.5s 15217 Max wave speed detected: 23.48 m/s
30358.7s 15218 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30358.7s 15219 [A
30358.7s 15220 Stored output at t = 45.0000 s (Step 195)
30358.7s 15221 
30358.7s 15222 Simulation finished at t = 45.0000 s after 195 steps.
30358.7s 15223 Total runtime: 0.63 seconds.
30358.7s 15224 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.83s/s]
30358.7s 15225 [REWARD_MICROSCOPE] step=14443 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30358.7s 15226 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30358.7s 15227 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30358.7s 15228 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30358.7s 15229 Running simulation until t = 60.00 s, outputting every 15.00 s
30358.7s 15230 
30358.8s 15231 [PROGRESS] Step 200: t=46.07/60.00s (76.8%) | dt=0.2134s
30359.2s 15232 [PROGRESS] Step 250: t=56.75/60.00s (94.6%) | dt=0.2132s
30359.4s 15233 Stored output at t = 60.0000 s (Step 266)
30359.4s 15234 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30359.4s 15235 [A
30359.4s 15236 
30359.4s 15237 Simulation finished at t = 60.0000 s after 266 steps.
30359.4s 15238 Total runtime: 0.62 seconds.
30359.4s 15239 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 24.09s/s]
30359.4s 15240 [REWARD_MICROSCOPE] step=14444 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30359.4s 15241 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30359.4s 15242 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30359.4s 15243 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30359.4s 15244 Running simulation until t = 75.00 s, outputting every 15.00 s
30359.4s 15245 
30359.4s 15246 [WARNING] Automatic CFL correction applied (count: 3341300):
30359.4s 15247 Calculated CFL: 0.800 > Limit: 0.500
30359.4s 15248 Original dt: 3.400466e-01 s
30359.4s 15249 Corrected dt: 2.125291e-01 s
30359.4s 15250 Correction factor: 1.6x
30359.4s 15251 Max wave speed detected: 23.53 m/s
30359.7s 15252 [PROGRESS] Step 300: t=67.22/75.00s (89.6%) | dt=0.2125s
30360.0s 15253 Stored output at t = 75.0000 s (Step 337)
30360.0s 15254 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30360.0s 15255 [A
30360.0s 15256 
30360.0s 15257 Simulation finished at t = 75.0000 s after 337 steps.
30360.0s 15258 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 22.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 22.85s/s]
30360.0s 15259 Total runtime: 0.66 seconds.
30360.0s 15260 [REWARD_MICROSCOPE] step=14445 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30360.0s 15261 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30360.0s 15262 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30360.0s 15263 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30360.0s 15264 Running simulation until t = 90.00 s, outputting every 15.00 s
30360.0s 15265 
30360.1s 15266 [PROGRESS] Step 350: t=77.77/90.00s (86.4%) | dt=0.2130s
30360.2s 15267 [PERIODIC:1000] BC_DISPATCHER [Call #13366000] current_bc_params: <class 'dict'>
30360.2s 15268 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30360.2s 15269 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30360.2s 15270 [PERIODIC:1000] BC_GPU [Call #13366000] About to launch kernel
30360.2s 15271 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30360.2s 15272 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30360.2s 15273 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30360.3s 15274 [WARNING] Automatic CFL correction applied (count: 3341400):
30360.3s 15275 Calculated CFL: 0.800 > Limit: 0.500
30360.3s 15276 Original dt: 3.409690e-01 s
30360.3s 15277 Corrected dt: 2.131056e-01 s
30360.3s 15278 Correction factor: 1.6x
30360.3s 15279 Max wave speed detected: 23.46 m/s
30360.6s 15280 [PROGRESS] Step 400: t=88.42/90.00s (98.2%) | dt=0.2128s
30360.7s 15281 Stored output at t = 90.0000 s (Step 408)
30360.7s 15282 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30360.7s 15283 [A
30360.7s 15284 
30360.7s 15285 Simulation finished at t = 90.0000 s after 408 steps.
30360.7s 15286 Total runtime: 0.63 seconds.
30360.7s 15287 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 23.84s/s]
30360.7s 15288 [REWARD_MICROSCOPE] step=14446 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30360.7s 15289 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30360.7s 15290 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30360.7s 15291 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30360.7s 15292 Running simulation until t = 105.00 s, outputting every 15.00 s
30360.7s 15293 
30361.0s 15294 [PROGRESS] Step 450: t=98.92/105.00s (94.2%) | dt=0.2126s
30361.2s 15295 [WARNING] Automatic CFL correction applied (count: 3341500):
30361.2s 15296 Calculated CFL: 0.800 > Limit: 0.500
30361.2s 15297 Original dt: 3.403717e-01 s
30361.2s 15298 Corrected dt: 2.127323e-01 s
30361.2s 15299 Correction factor: 1.6x
30361.2s 15300 Max wave speed detected: 23.50 m/s
30361.3s 15301 Stored output at t = 105.0000 s (Step 479)
30361.3s 15302 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30361.3s 15303 [A
30361.3s 15304 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.28s/s]
30361.3s 15305 
30361.3s 15306 Simulation finished at t = 105.0000 s after 479 steps.
30361.3s 15307 Total runtime: 0.64 seconds.
30361.3s 15308 [REWARD_MICROSCOPE] step=14447 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30361.3s 15309 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30361.3s 15310 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30361.3s 15311 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30361.3s 15312 Running simulation until t = 120.00 s, outputting every 15.00 s
30361.3s 15313 
30361.5s 15314 [PROGRESS] Step 500: t=109.47/120.00s (91.2%) | dt=0.2130s
30361.9s 15315 [PROGRESS] Step 550: t=120.00/120.00s (100.0%) | dt=0.0883s
30361.9s 15316 Stored output at t = 120.0000 s (Step 550)
30361.9s 15317 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30361.9s 15318 [A
30361.9s 15319 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 24.07s/s]
30361.9s 15320 
30361.9s 15321 Simulation finished at t = 120.0000 s after 550 steps.
30361.9s 15322 Total runtime: 0.62 seconds.
30361.9s 15323 [REWARD_MICROSCOPE] step=14448 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30361.9s 15324 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30361.9s 15325 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30361.9s 15326 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30361.9s 15327 Running simulation until t = 135.00 s, outputting every 15.00 s
30361.9s 15328 
30362.1s 15329 [WARNING] Automatic CFL correction applied (count: 3341600):
30362.1s 15330 Calculated CFL: 0.800 > Limit: 0.500
30362.1s 15331 Original dt: 3.397675e-01 s
30362.1s 15332 Corrected dt: 2.123547e-01 s
30362.1s 15333 Correction factor: 1.6x
30362.1s 15334 Max wave speed detected: 23.55 m/s
30362.4s 15335 [PROGRESS] Step 600: t=130.62/135.00s (96.8%) | dt=0.2127s
30362.5s 15336 [PERIODIC:1000] BC_DISPATCHER [Call #13367000] current_bc_params: <class 'dict'>
30362.5s 15337 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30362.5s 15338 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30362.5s 15339 [PERIODIC:1000] BC_GPU [Call #13367000] About to launch kernel
30362.5s 15340 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30362.5s 15341 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30362.5s 15342 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30362.5s 15343 Stored output at t = 135.0000 s (Step 621)
30362.5s 15344 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30362.5s 15345 [A
30362.5s 15346 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 24.29s/s]
30362.5s 15347 
30362.5s 15348 Simulation finished at t = 135.0000 s after 621 steps.
30362.5s 15349 Total runtime: 0.62 seconds.
30362.5s 15350 [REWARD_MICROSCOPE] step=14449 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30362.5s 15351 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30362.5s 15352 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30362.5s 15353 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30362.5s 15354 Running simulation until t = 150.00 s, outputting every 15.00 s
30362.5s 15355 
30362.8s 15356 [PROGRESS] Step 650: t=141.18/150.00s (94.1%) | dt=0.2131s
30363.0s 15357 [WARNING] Automatic CFL correction applied (count: 3341700):
30363.0s 15358 Calculated CFL: 0.800 > Limit: 0.500
30363.0s 15359 Original dt: 3.411605e-01 s
30363.0s 15360 Corrected dt: 2.132253e-01 s
30363.0s 15361 Correction factor: 1.6x
30363.0s 15362 Max wave speed detected: 23.45 m/s
30363.2s 15363 Stored output at t = 150.0000 s (Step 692)
30363.2s 15364 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30363.2s 15365 [A
30363.2s 15366 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 23.73s/s]
30363.2s 15367 
30363.2s 15368 Simulation finished at t = 150.0000 s after 692 steps.
30363.2s 15369 Total runtime: 0.63 seconds.
30363.2s 15370 [REWARD_MICROSCOPE] step=14450 t=150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30363.2s 15371 [STEP   10] t=  150.0s | phase=0 | reward=   0.01 | total_reward=    0.10
30363.2s 15372 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30363.2s 15373 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30363.2s 15374 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30363.2s 15375 Running simulation until t = 165.00 s, outputting every 15.00 s
30363.2s 15376 
30363.3s 15377 [PROGRESS] Step 700: t=151.70/165.00s (91.9%) | dt=0.2124s
30363.7s 15378 [PROGRESS] Step 750: t=162.32/165.00s (98.4%) | dt=0.2127s
30363.8s 15379 Stored output at t = 165.0000 s (Step 763)
30363.8s 15380 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30363.8s 15381 [A
30363.8s 15382 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.25s/s]
30363.8s 15383 
30363.8s 15384 Simulation finished at t = 165.0000 s after 763 steps.
30363.8s 15385 Total runtime: 0.62 seconds.
30363.8s 15386 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30363.8s 15387 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30363.8s 15388 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30363.8s 15389 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30363.8s 15390 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30363.8s 15391 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30363.8s 15392 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30363.8s 15393 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30363.8s 15394 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30363.8s 15395 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30363.8s 15396 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30363.8s 15397 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30363.8s 15398 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30363.8s 15399 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30363.8s 15400 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30363.8s 15401 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30363.8s 15402 [REWARD_MICROSCOPE] step=14451 t=165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30363.8s 15403 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30363.8s 15404 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30363.8s 15405 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30363.8s 15406 Running simulation until t = 180.00 s, outputting every 15.00 s
30363.8s 15407 
30363.8s 15408 [WARNING] Automatic CFL correction applied (count: 3341800):
30363.8s 15409 Calculated CFL: 0.800 > Limit: 0.500
30363.8s 15410 Original dt: 3.405828e-01 s
30363.8s 15411 Corrected dt: 2.128643e-01 s
30363.8s 15412 Correction factor: 1.6x
30363.8s 15413 Max wave speed detected: 23.49 m/s
30364.1s 15414 [PROGRESS] Step 800: t=172.88/180.00s (96.0%) | dt=0.2131s
30364.4s 15415 Stored output at t = 180.0000 s (Step 834)
30364.4s 15416 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30364.4s 15417 [A
30364.4s 15418 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.19s/s]
30364.4s 15419 
30364.4s 15420 Simulation finished at t = 180.0000 s after 834 steps.
30364.4s 15421 Total runtime: 0.62 seconds.
30364.4s 15422 [REWARD_MICROSCOPE] step=14452 t=180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30364.4s 15423 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30364.4s 15424 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30364.4s 15425 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30364.4s 15426 Running simulation until t = 195.00 s, outputting every 15.00 s
30364.4s 15427 
30364.6s 15428 [PROGRESS] Step 850: t=183.40/195.00s (94.1%) | dt=0.2123s
30364.7s 15429 [PERIODIC:1000] BC_DISPATCHER [Call #13368000] current_bc_params: <class 'dict'>
30364.7s 15430 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30364.7s 15431 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30364.7s 15432 [PERIODIC:1000] BC_GPU [Call #13368000] About to launch kernel
30364.7s 15433 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30364.7s 15434 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30364.7s 15435 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30364.7s 15436 [WARNING] Automatic CFL correction applied (count: 3341900):
30364.7s 15437 Calculated CFL: 0.800 > Limit: 0.500
30364.7s 15438 Original dt: 3.400085e-01 s
30364.7s 15439 Corrected dt: 2.125053e-01 s
30364.7s 15440 Correction factor: 1.6x
30364.7s 15441 Max wave speed detected: 23.53 m/s
30365.0s 15442 [PROGRESS] Step 900: t=194.03/195.00s (99.5%) | dt=0.2128s
30365.1s 15443 Stored output at t = 195.0000 s (Step 905)
30365.1s 15444 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30365.1s 15445 [A
30365.1s 15446 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.02s/s]
30365.1s 15447 
30365.1s 15448 Simulation finished at t = 195.0000 s after 905 steps.
30365.1s 15449 Total runtime: 0.62 seconds.
30365.1s 15450 [REWARD_MICROSCOPE] step=14453 t=195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30365.1s 15451 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30365.1s 15452 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30365.1s 15453 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30365.1s 15454 Running simulation until t = 210.00 s, outputting every 15.00 s
30365.1s 15455 
30365.4s 15456 [PROGRESS] Step 950: t=204.59/210.00s (97.4%) | dt=0.2132s
30365.6s 15457 [WARNING] Automatic CFL correction applied (count: 3342000):
30365.6s 15458 Calculated CFL: 0.800 > Limit: 0.500
30365.6s 15459 Original dt: 3.406020e-01 s
30365.6s 15460 Corrected dt: 2.128763e-01 s
30365.6s 15461 Correction factor: 1.6x
30365.6s 15462 Max wave speed detected: 23.49 m/s
30365.7s 15463 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30365.7s 15464 [A
30365.7s 15465 Stored output at t = 210.0000 s (Step 976)
30365.7s 15466 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 24.63s/s]
30365.7s 15467 
30365.7s 15468 Simulation finished at t = 210.0000 s after 976 steps.
30365.7s 15469 Total runtime: 0.61 seconds.
30365.7s 15470 [REWARD_MICROSCOPE] step=14454 t=210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30365.7s 15471 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30365.7s 15472 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30365.7s 15473 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30365.7s 15474 Running simulation until t = 225.00 s, outputting every 15.00 s
30365.7s 15475 
30365.9s 15476 [PROGRESS] Step 1000: t=215.10/225.00s (95.6%) | dt=0.2124s
30366.3s 15477 Stored output at t = 225.0000 s (Step 1047)
30366.3s 15478 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30366.3s 15479 [A
30366.3s 15480 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 24.27s/s]
30366.3s 15481 
30366.3s 15482 Simulation finished at t = 225.0000 s after 1047 steps.
30366.3s 15483 Total runtime: 0.62 seconds.
30366.3s 15484 [REWARD_MICROSCOPE] step=14455 t=225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30366.3s 15485 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30366.3s 15486 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30366.3s 15487 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30366.3s 15488 Running simulation until t = 240.00 s, outputting every 15.00 s
30366.3s 15489 
30366.3s 15490 [PROGRESS] Step 1050: t=225.64/240.00s (94.0%) | dt=0.2129s
30366.5s 15491 [WARNING] Automatic CFL correction applied (count: 3342100):
30366.5s 15492 Calculated CFL: 0.800 > Limit: 0.500
30366.5s 15493 Original dt: 3.408050e-01 s
30366.5s 15494 Corrected dt: 2.130031e-01 s
30366.5s 15495 Correction factor: 1.6x
30366.5s 15496 Max wave speed detected: 23.47 m/s
30366.8s 15497 [PROGRESS] Step 1100: t=236.29/240.00s (98.5%) | dt=0.2133s
30366.9s 15498 [PERIODIC:1000] BC_DISPATCHER [Call #13369000] current_bc_params: <class 'dict'>
30366.9s 15499 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30366.9s 15500 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30366.9s 15501 [PERIODIC:1000] BC_GPU [Call #13369000] About to launch kernel
30366.9s 15502 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30366.9s 15503 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30366.9s 15504 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30366.9s 15505 Stored output at t = 240.0000 s (Step 1118)
30366.9s 15506 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30366.9s 15507 [A
30366.9s 15508 
30366.9s 15509 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 23.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 23.36s/s]
30366.9s 15510 Simulation finished at t = 240.0000 s after 1118 steps.
30366.9s 15511 Total runtime: 0.64 seconds.
30366.9s 15512 [REWARD_MICROSCOPE] step=14456 t=240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30366.9s 15513 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30366.9s 15514 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30366.9s 15515 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30366.9s 15516 Running simulation until t = 255.00 s, outputting every 15.00 s
30366.9s 15517 
30367.2s 15518 [PROGRESS] Step 1150: t=246.80/255.00s (96.8%) | dt=0.2125s
30367.4s 15519 [WARNING] Automatic CFL correction applied (count: 3342200):
30367.4s 15520 Calculated CFL: 0.800 > Limit: 0.500
30367.4s 15521 Original dt: 3.402313e-01 s
30367.4s 15522 Corrected dt: 2.126446e-01 s
30367.4s 15523 Correction factor: 1.6x
30367.4s 15524 Max wave speed detected: 23.51 m/s
30367.6s 15525 Stored output at t = 255.0000 s (Step 1189)
30367.6s 15526 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30367.6s 15527 [A
30367.6s 15528 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.38s/s]
30367.6s 15529 
30367.6s 15530 Simulation finished at t = 255.0000 s after 1189 steps.
30367.6s 15531 Total runtime: 0.64 seconds.
30367.6s 15532 [REWARD_MICROSCOPE] step=14457 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30367.6s 15533 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30367.6s 15534 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30367.6s 15535 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30367.6s 15536 Running simulation until t = 270.00 s, outputting every 15.00 s
30367.6s 15537 
30367.7s 15538 [PROGRESS] Step 1200: t=257.34/270.00s (95.3%) | dt=0.2129s
30368.1s 15539 [PROGRESS] Step 1250: t=268.00/270.00s (99.3%) | dt=0.2129s
30368.2s 15540 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30368.2s 15541 [A
30368.2s 15542 Stored output at t = 270.0000 s (Step 1260)
30368.2s 15543 
30368.2s 15544 Simulation finished at t = 270.0000 s after 1260 steps.
30368.2s 15545 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.95s/s]
30368.2s 15546 Total runtime: 0.63 seconds.
30368.2s 15547 [REWARD_MICROSCOPE] step=14458 t=270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30368.2s 15548 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30368.2s 15549 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30368.2s 15550 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30368.2s 15551 Running simulation until t = 285.00 s, outputting every 15.00 s
30368.2s 15552 
30368.3s 15553 [WARNING] Automatic CFL correction applied (count: 3342300):
30368.3s 15554 Calculated CFL: 0.800 > Limit: 0.500
30368.3s 15555 Original dt: 3.398030e-01 s
30368.3s 15556 Corrected dt: 2.123769e-01 s
30368.3s 15557 Correction factor: 1.6x
30368.3s 15558 Max wave speed detected: 23.54 m/s
30368.6s 15559 [PROGRESS] Step 1300: t=278.50/285.00s (97.7%) | dt=0.2126s
30368.8s 15560 Stored output at t = 285.0000 s (Step 1331)
30368.8s 15561 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30368.8s 15562 [A
30368.8s 15563 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 24.08s/s]
30368.8s 15564 
30368.8s 15565 Simulation finished at t = 285.0000 s after 1331 steps.
30368.8s 15566 Total runtime: 0.62 seconds.
30368.8s 15567 [REWARD_MICROSCOPE] step=14459 t=285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30368.8s 15568 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30368.8s 15569 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30368.8s 15570 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30368.8s 15571 Running simulation until t = 300.00 s, outputting every 15.00 s
30368.8s 15572 
30369.0s 15573 [PROGRESS] Step 1350: t=289.05/300.00s (96.3%) | dt=0.2130s
30369.1s 15574 [PERIODIC:1000] BC_DISPATCHER [Call #13370000] current_bc_params: <class 'dict'>
30369.1s 15575 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30369.1s 15576 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30369.1s 15577 [PERIODIC:1000] BC_GPU [Call #13370000] About to launch kernel
30369.1s 15578 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30369.1s 15579 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30369.1s 15580 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30369.2s 15581 [WARNING] Automatic CFL correction applied (count: 3342400):
30369.2s 15582 Calculated CFL: 0.800 > Limit: 0.500
30369.2s 15583 Original dt: 3.410260e-01 s
30369.2s 15584 Corrected dt: 2.131412e-01 s
30369.2s 15585 Correction factor: 1.6x
30369.2s 15586 Max wave speed detected: 23.46 m/s
30369.5s 15587 [PROGRESS] Step 1400: t=299.70/300.00s (99.9%) | dt=0.2126s
30369.5s 15588 Stored output at t = 300.0000 s (Step 1402)
30369.5s 15589 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30369.5s 15590 [A
30369.5s 15591 
30369.5s 15592 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 22.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 22.60s/s]
30369.5s 15593 Simulation finished at t = 300.0000 s after 1402 steps.
30369.5s 15594 Total runtime: 0.66 seconds.
30369.5s 15595 [REWARD_MICROSCOPE] step=14460 t=300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30369.5s 15596 [STEP   20] t=  300.0s | phase=0 | reward=   0.01 | total_reward=    0.20
30369.5s 15597 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30369.5s 15598 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30369.5s 15599 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30369.5s 15600 Running simulation until t = 315.00 s, outputting every 15.00 s
30369.5s 15601 
30369.9s 15602 [PROGRESS] Step 1450: t=310.20/315.00s (98.5%) | dt=0.2126s
30370.1s 15603 [WARNING] Automatic CFL correction applied (count: 3342500):
30370.1s 15604 Calculated CFL: 0.800 > Limit: 0.500
30370.1s 15605 Original dt: 3.404547e-01 s
30370.1s 15606 Corrected dt: 2.127842e-01 s
30370.1s 15607 Correction factor: 1.6x
30370.1s 15608 Max wave speed detected: 23.50 m/s
30370.1s 15609 Stored output at t = 315.0000 s (Step 1473)
30370.1s 15610 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30370.1s 15611 [A
30370.1s 15612 
30370.1s 15613 Simulation finished at t = 315.0000 s after 1473 steps.
30370.1s 15614 Total runtime: 0.65 seconds.
30370.1s 15615 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.16s/s]
30370.1s 15616 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30370.1s 15617 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30370.1s 15618 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30370.1s 15619 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30370.1s 15620 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30370.1s 15621 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30370.1s 15622 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30370.2s 15623 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30370.2s 15624 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30370.2s 15625 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30370.2s 15626 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30370.2s 15627 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30370.2s 15628 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30370.2s 15629 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30370.2s 15630 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30370.2s 15631 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30370.2s 15632 [REWARD_MICROSCOPE] step=14461 t=315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30370.2s 15633 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30370.2s 15634 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30370.2s 15635 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30370.2s 15636 Running simulation until t = 330.00 s, outputting every 15.00 s
30370.2s 15637 
30370.4s 15638 [PROGRESS] Step 1500: t=320.75/330.00s (97.2%) | dt=0.2131s
30370.8s 15639 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30370.8s 15640 Stored output at t = 330.0000 s (Step 1544)
30370.8s 15641 [A
30370.8s 15642 
30370.8s 15643 Simulation finished at t = 330.0000 s after 1544 steps.
30370.8s 15644 Total runtime: 0.65 seconds.
30370.8s 15645 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 23.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 23.20s/s]
30370.8s 15646 [REWARD_MICROSCOPE] step=14462 t=330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30370.8s 15647 
30370.8s 15648 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30370.8s 15649 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30370.8s 15650 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30370.8s 15651 Running simulation until t = 345.00 s, outputting every 15.00 s
30370.9s 15652 [PROGRESS] Step 1550: t=331.27/345.00s (96.0%) | dt=0.2124s
30371.0s 15653 [WARNING] Automatic CFL correction applied (count: 3342600):
30371.0s 15654 Calculated CFL: 0.800 > Limit: 0.500
30371.0s 15655 Original dt: 3.398585e-01 s
30371.0s 15656 Corrected dt: 2.124115e-01 s
30371.0s 15657 Correction factor: 1.6x
30371.0s 15658 Max wave speed detected: 23.54 m/s
30371.3s 15659 [PROGRESS] Step 1600: t=341.90/345.00s (99.1%) | dt=0.2127s
30371.4s 15660 [PERIODIC:1000] BC_DISPATCHER [Call #13371000] current_bc_params: <class 'dict'>
30371.4s 15661 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30371.4s 15662 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30371.4s 15663 [PERIODIC:1000] BC_GPU [Call #13371000] About to launch kernel
30371.4s 15664 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30371.4s 15665 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30371.4s 15666 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30371.4s 15667 Stored output at t = 345.0000 s (Step 1615)
30371.4s 15668 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30371.4s 15669 [A
30371.4s 15670 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.69s/s]
30371.4s 15671 
30371.4s 15672 Simulation finished at t = 345.0000 s after 1615 steps.
30371.4s 15673 Total runtime: 0.63 seconds.
30371.4s 15674 [REWARD_MICROSCOPE] step=14463 t=345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30371.4s 15675 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30371.4s 15676 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30371.4s 15677 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30371.4s 15678 Running simulation until t = 360.00 s, outputting every 15.00 s
30371.4s 15679 
30371.7s 15680 [PROGRESS] Step 1650: t=352.45/360.00s (97.9%) | dt=0.2131s
30371.9s 15681 [WARNING] Automatic CFL correction applied (count: 3342700):
30371.9s 15682 Calculated CFL: 0.800 > Limit: 0.500
30371.9s 15683 Original dt: 3.412422e-01 s
30371.9s 15684 Corrected dt: 2.132764e-01 s
30371.9s 15685 Correction factor: 1.6x
30371.9s 15686 Max wave speed detected: 23.44 m/s
30372.1s 15687 Stored output at t = 360.0000 s (Step 1686)
30372.1s 15688 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30372.1s 15689 [A
30372.1s 15690 
30372.1s 15691 Simulation finished at t = 360.0000 s after 1686 steps.
30372.1s 15692 Total runtime: 0.63 seconds.
30372.1s 15693 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 23.96s/s]
30372.1s 15694 [REWARD_MICROSCOPE] step=14464 t=360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30372.1s 15695 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30372.1s 15696 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30372.1s 15697 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30372.1s 15698 Running simulation until t = 375.00 s, outputting every 15.00 s
30372.1s 15699 
30372.2s 15700 [PROGRESS] Step 1700: t=362.97/375.00s (96.8%) | dt=0.2123s
30372.6s 15701 [PROGRESS] Step 1750: t=373.60/375.00s (99.6%) | dt=0.2128s
30372.7s 15702 Stored output at t = 375.0000 s (Step 1757)
30372.7s 15703 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30372.7s 15704 [A
30372.7s 15705 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 23.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 23.39s/s]
30372.7s 15706 
30372.7s 15707 Simulation finished at t = 375.0000 s after 1757 steps.
30372.7s 15708 Total runtime: 0.64 seconds.
30372.7s 15709 [REWARD_MICROSCOPE] step=14465 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30372.7s 15710 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30372.7s 15711 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30372.7s 15712 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30372.7s 15713 Running simulation until t = 390.00 s, outputting every 15.00 s
30372.7s 15714 
30372.8s 15715 [WARNING] Automatic CFL correction applied (count: 3342800):
30372.8s 15716 Calculated CFL: 0.800 > Limit: 0.500
30372.8s 15717 Original dt: 3.406657e-01 s
30372.8s 15718 Corrected dt: 2.129161e-01 s
30372.8s 15719 Correction factor: 1.6x
30372.8s 15720 Max wave speed detected: 23.48 m/s
30373.1s 15721 [PROGRESS] Step 1800: t=384.16/390.00s (98.5%) | dt=0.2132s
30373.3s 15722 Stored output at t = 390.0000 s (Step 1828)
30373.3s 15723 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30373.3s 15724 [A
30373.3s 15725 
30373.3s 15726 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.64s/s]
30373.3s 15727 Simulation finished at t = 390.0000 s after 1828 steps.
30373.3s 15728 Total runtime: 0.61 seconds.
30373.3s 15729 [REWARD_MICROSCOPE] step=14466 t=390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30373.3s 15730 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30373.3s 15731 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30373.3s 15732 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30373.3s 15733 Running simulation until t = 405.00 s, outputting every 15.00 s
30373.3s 15734 
30373.5s 15735 [PROGRESS] Step 1850: t=394.67/405.00s (97.4%) | dt=0.2124s
30373.6s 15736 [PERIODIC:1000] BC_DISPATCHER [Call #13372000] current_bc_params: <class 'dict'>
30373.6s 15737 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30373.6s 15738 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30373.6s 15739 [PERIODIC:1000] BC_GPU [Call #13372000] About to launch kernel
30373.6s 15740 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30373.6s 15741 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30373.6s 15742 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30373.7s 15743 [WARNING] Automatic CFL correction applied (count: 3342900):
30373.7s 15744 Calculated CFL: 0.800 > Limit: 0.500
30373.7s 15745 Original dt: 3.400921e-01 s
30373.7s 15746 Corrected dt: 2.125575e-01 s
30373.7s 15747 Correction factor: 1.6x
30373.7s 15748 Max wave speed detected: 23.52 m/s
30374.0s 15749 Stored output at t = 405.0000 s (Step 1899)
30374.0s 15750 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30374.0s 15751 [A
30374.0s 15752 
30374.0s 15753 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 22.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 22.43s/s]
30374.0s 15754 Simulation finished at t = 405.0000 s after 1899 steps.
30374.0s 15755 Total runtime: 0.67 seconds.
30374.0s 15756 [REWARD_MICROSCOPE] step=14467 t=405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30374.0s 15757 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30374.0s 15758 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30374.0s 15759 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30374.0s 15760 Running simulation until t = 420.00 s, outputting every 15.00 s
30374.0s 15761 
30374.0s 15762 [PROGRESS] Step 1900: t=405.21/420.00s (96.5%) | dt=0.2128s
30374.4s 15763 [PROGRESS] Step 1950: t=415.87/420.00s (99.0%) | dt=0.2133s
30374.6s 15764 [WARNING] Automatic CFL correction applied (count: 3343000):
30374.6s 15765 Calculated CFL: 0.800 > Limit: 0.500
30374.6s 15766 Original dt: 3.402189e-01 s
30374.6s 15767 Corrected dt: 2.126368e-01 s
30374.6s 15768 Correction factor: 1.6x
30374.6s 15769 Max wave speed detected: 23.51 m/s
30374.6s 15770 Stored output at t = 420.0000 s (Step 1970)
30374.6s 15771 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30374.6s 15772 [A
30374.6s 15773 
30374.6s 15774 Simulation finished at t = 420.0000 s after 1970 steps.
30374.6s 15775 Total runtime: 0.63 seconds.
30374.6s 15776 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 23.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 23.86s/s]
30374.6s 15777 [REWARD_MICROSCOPE] step=14468 t=420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30374.6s 15778 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30374.6s 15779 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30374.6s 15780 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30374.6s 15781 Running simulation until t = 435.00 s, outputting every 15.00 s
30374.6s 15782 
30374.9s 15783 [PROGRESS] Step 2000: t=426.37/435.00s (98.0%) | dt=0.2125s
30375.2s 15784 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30375.2s 15785 [A
30375.2s 15786 Stored output at t = 435.0000 s (Step 2041)
30375.2s 15787 
30375.2s 15788 Simulation finished at t = 435.0000 s after 2041 steps.
30375.2s 15789 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.15s/s]
30375.2s 15790 Total runtime: 0.62 seconds.
30375.2s 15791 [REWARD_MICROSCOPE] step=14469 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30375.2s 15792 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30375.2s 15793 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30375.2s 15794 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30375.2s 15795 Running simulation until t = 450.00 s, outputting every 15.00 s
30375.2s 15796 
30375.3s 15797 [PROGRESS] Step 2050: t=436.92/450.00s (97.1%) | dt=0.2129s
30375.5s 15798 [WARNING] Automatic CFL correction applied (count: 3343100):
30375.5s 15799 Calculated CFL: 0.800 > Limit: 0.500
30375.5s 15800 Original dt: 3.408895e-01 s
30375.5s 15801 Corrected dt: 2.130559e-01 s
30375.5s 15802 Correction factor: 1.6x
30375.5s 15803 Max wave speed detected: 23.47 m/s
30375.8s 15804 [PROGRESS] Step 2100: t=447.57/450.00s (99.5%) | dt=0.2130s
30375.9s 15805 [PERIODIC:1000] BC_DISPATCHER [Call #13373000] current_bc_params: <class 'dict'>
30375.9s 15806 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30375.9s 15807 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30375.9s 15808 [PERIODIC:1000] BC_GPU [Call #13373000] About to launch kernel
30375.9s 15809 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30375.9s 15810 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30375.9s 15811 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30375.9s 15812 Stored output at t = 450.0000 s (Step 2112)
30375.9s 15813 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30375.9s 15814 [A
30375.9s 15815 
30375.9s 15816 Simulation finished at t = 450.0000 s after 2112 steps.
30375.9s 15817 Total runtime: 0.63 seconds.
30375.9s 15818 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.68s/s]
30375.9s 15819 [REWARD_MICROSCOPE] step=14470 t=450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30375.9s 15820 [STEP   30] t=  450.0s | phase=0 | reward=   0.01 | total_reward=    0.30
30375.9s 15821 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30375.9s 15822 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30375.9s 15823 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30375.9s 15824 Running simulation until t = 465.00 s, outputting every 15.00 s
30375.9s 15825 
30376.2s 15826 [PROGRESS] Step 2150: t=458.07/465.00s (98.5%) | dt=0.2125s
30376.4s 15827 [WARNING] Automatic CFL correction applied (count: 3343200):
30376.4s 15828 Calculated CFL: 0.800 > Limit: 0.500
30376.4s 15829 Original dt: 3.403151e-01 s
30376.4s 15830 Corrected dt: 2.126969e-01 s
30376.4s 15831 Correction factor: 1.6x
30376.4s 15832 Max wave speed detected: 23.51 m/s
30376.5s 15833 Stored output at t = 465.0000 s (Step 2183)
30376.5s 15834 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30376.5s 15835 [A
30376.5s 15836 
30376.5s 15837 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.51s/s]
30376.5s 15838 Simulation finished at t = 465.0000 s after 2183 steps.
30376.5s 15839 Total runtime: 0.61 seconds.
30376.5s 15840 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30376.5s 15841 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30376.5s 15842 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30376.5s 15843 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30376.5s 15844 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30376.5s 15845 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30376.5s 15846 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30376.5s 15847 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30376.5s 15848 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30376.5s 15849 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30376.5s 15850 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30376.5s 15851 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30376.5s 15852 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30376.5s 15853 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30376.5s 15854 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30376.5s 15855 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30376.5s 15856 [REWARD_MICROSCOPE] step=14471 t=465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30376.5s 15857 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30376.5s 15858 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30376.5s 15859 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30376.5s 15860 Running simulation until t = 480.00 s, outputting every 15.00 s
30376.5s 15861 
30376.7s 15862 [PROGRESS] Step 2200: t=468.62/480.00s (97.6%) | dt=0.2130s
30377.1s 15863 [PROGRESS] Step 2250: t=479.27/480.00s (99.8%) | dt=0.2127s
30377.1s 15864 Stored output at t = 480.0000 s (Step 2254)
30377.1s 15865 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30377.1s 15866 [A
30377.1s 15867 
30377.1s 15868 Simulation finished at t = 480.0000 s after 2254 steps.
30377.1s 15869 Total runtime: 0.62 seconds.
30377.1s 15870 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.40s/s]
30377.1s 15871 [REWARD_MICROSCOPE] step=14472 t=480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30377.1s 15872 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30377.1s 15873 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30377.1s 15874 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30377.1s 15875 Running simulation until t = 495.00 s, outputting every 15.00 s
30377.1s 15876 
30377.2s 15877 [WARNING] Automatic CFL correction applied (count: 3343300):
30377.2s 15878 Calculated CFL: 0.800 > Limit: 0.500
30377.2s 15879 Original dt: 3.397193e-01 s
30377.2s 15880 Corrected dt: 2.123245e-01 s
30377.2s 15881 Correction factor: 1.6x
30377.2s 15882 Max wave speed detected: 23.55 m/s
30377.5s 15883 [PROGRESS] Step 2300: t=489.77/495.00s (98.9%) | dt=0.2126s
30377.7s 15884 Stored output at t = 495.0000 s (Step 2325)
30377.7s 15885 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30377.7s 15886 [A
30377.7s 15887 
30377.7s 15888 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 24.33s/s]
30377.7s 15889 Simulation finished at t = 495.0000 s after 2325 steps.
30377.7s 15890 Total runtime: 0.62 seconds.
30377.7s 15891 [REWARD_MICROSCOPE] step=14473 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30377.7s 15892 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30377.7s 15893 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30377.7s 15894 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30377.7s 15895 Running simulation until t = 510.00 s, outputting every 15.00 s
30377.7s 15896 
30378.0s 15897 [PROGRESS] Step 2350: t=500.32/510.00s (98.1%) | dt=0.2130s
30378.1s 15898 [PERIODIC:1000] BC_DISPATCHER [Call #13374000] current_bc_params: <class 'dict'>
30378.1s 15899 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30378.1s 15900 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30378.1s 15901 [PERIODIC:1000] BC_GPU [Call #13374000] About to launch kernel
30378.1s 15902 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30378.1s 15903 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30378.1s 15904 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30378.1s 15905 [WARNING] Automatic CFL correction applied (count: 3343400):
30378.1s 15906 Calculated CFL: 0.800 > Limit: 0.500
30378.1s 15907 Original dt: 3.411064e-01 s
30378.1s 15908 Corrected dt: 2.131915e-01 s
30378.1s 15909 Correction factor: 1.6x
30378.1s 15910 Max wave speed detected: 23.45 m/s
30378.4s 15911 Stored output at t = 510.0000 s (Step 2396)
30378.4s 15912 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30378.4s 15913 [A
30378.4s 15914 
30378.4s 15915 Simulation finished at t = 510.0000 s after 2396 steps.
30378.4s 15916 Total runtime: 0.62 seconds.
30378.4s 15917 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.22s/s]
30378.4s 15918 [REWARD_MICROSCOPE] step=14474 t=510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30378.4s 15919 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30378.4s 15920 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30378.4s 15921 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30378.4s 15922 Running simulation until t = 525.00 s, outputting every 15.00 s
30378.4s 15923 
30378.4s 15924 [PROGRESS] Step 2400: t=510.85/525.00s (97.3%) | dt=0.2124s
30378.8s 15925 [PROGRESS] Step 2450: t=521.47/525.00s (99.3%) | dt=0.2127s
30379.0s 15926 [WARNING] Automatic CFL correction applied (count: 3343500):
30379.0s 15927 Calculated CFL: 0.800 > Limit: 0.500
30379.0s 15928 Original dt: 3.405361e-01 s
30379.0s 15929 Corrected dt: 2.128351e-01 s
30379.0s 15930 Correction factor: 1.6x
30379.0s 15931 Max wave speed detected: 23.49 m/s
30379.0s 15932 Stored output at t = 525.0000 s (Step 2467)
30379.0s 15933 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30379.0s 15934 [A
30379.0s 15935 
30379.0s 15936 Simulation finished at t = 525.0000 s after 2467 steps.
30379.0s 15937 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 24.54s/s]
30379.0s 15938 Total runtime: 0.61 seconds.
30379.0s 15939 [REWARD_MICROSCOPE] step=14475 t=525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30379.0s 15940 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30379.0s 15941 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30379.0s 15942 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30379.0s 15943 Running simulation until t = 540.00 s, outputting every 15.00 s
30379.0s 15944 
30379.3s 15945 [PROGRESS] Step 2500: t=532.03/540.00s (98.5%) | dt=0.2131s
30379.6s 15946 Stored output at t = 540.0000 s (Step 2538)
30379.6s 15947 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30379.6s 15948 [A
30379.6s 15949 
30379.6s 15950 Simulation finished at t = 540.0000 s after 2538 steps.
30379.6s 15951 Total runtime: 0.61 seconds.
30379.6s 15952 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.51s/s]
30379.6s 15953 [REWARD_MICROSCOPE] step=14476 t=540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30379.6s 15954 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30379.6s 15955 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30379.6s 15956 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30379.6s 15957 Running simulation until t = 555.00 s, outputting every 15.00 s
30379.6s 15958 
30379.7s 15959 [PROGRESS] Step 2550: t=542.55/555.00s (97.8%) | dt=0.2123s
30379.8s 15960 [WARNING] Automatic CFL correction applied (count: 3343600):
30379.8s 15961 Calculated CFL: 0.800 > Limit: 0.500
30379.8s 15962 Original dt: 3.399493e-01 s
30379.8s 15963 Corrected dt: 2.124683e-01 s
30379.8s 15964 Correction factor: 1.6x
30379.8s 15965 Max wave speed detected: 23.53 m/s
30380.1s 15966 [PROGRESS] Step 2600: t=553.18/555.00s (99.7%) | dt=0.2128s
30380.2s 15967 Stored output at t = 555.0000 s (Step 2609)
30380.2s 15968 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30380.2s 15969 [A
30380.2s 15970 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.50s/s]
30380.2s 15971 
30380.2s 15972 Simulation finished at t = 555.0000 s after 2609 steps.
30380.2s 15973 Total runtime: 0.61 seconds.
30380.2s 15974 [REWARD_MICROSCOPE] step=14477 t=555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30380.2s 15975 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30380.2s 15976 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30380.2s 15977 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30380.2s 15978 Running simulation until t = 570.00 s, outputting every 15.00 s
30380.2s 15979 
30380.2s 15980 [PERIODIC:1000] BC_DISPATCHER [Call #13375000] current_bc_params: <class 'dict'>
30380.2s 15981 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30380.2s 15982 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30380.2s 15983 [PERIODIC:1000] BC_GPU [Call #13375000] About to launch kernel
30380.2s 15984 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30380.2s 15985 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30380.2s 15986 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30380.6s 15987 [PROGRESS] Step 2650: t=563.73/570.00s (98.9%) | dt=0.2132s
30380.7s 15988 [WARNING] Automatic CFL correction applied (count: 3343700):
30380.7s 15989 Calculated CFL: 0.800 > Limit: 0.500
30380.7s 15990 Original dt: 3.409227e-01 s
30380.7s 15991 Corrected dt: 2.130767e-01 s
30380.7s 15992 Correction factor: 1.6x
30380.7s 15993 Max wave speed detected: 23.47 m/s
30380.8s 15994 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30380.8s 15995 [A
30380.8s 15996 Stored output at t = 570.0000 s (Step 2680)
30380.8s 15997 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.54s/s]
30380.8s 15998 
30380.8s 15999 Simulation finished at t = 570.0000 s after 2680 steps.
30380.8s 16000 Total runtime: 0.64 seconds.
30380.8s 16001 [REWARD_MICROSCOPE] step=14478 t=570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30380.8s 16002 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30380.8s 16003 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30380.8s 16004 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30380.8s 16005 Running simulation until t = 585.00 s, outputting every 15.00 s
30380.8s 16006 
30381.0s 16007 [PROGRESS] Step 2700: t=574.25/585.00s (98.2%) | dt=0.2124s
30381.5s 16008 [PROGRESS] Step 2750: t=584.88/585.00s (100.0%) | dt=0.2128s
30381.5s 16009 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30381.5s 16010 [A
30381.5s 16011 Stored output at t = 585.0000 s (Step 2751)
30381.5s 16012 
30381.5s 16013 Simulation finished at t = 585.0000 s after 2751 steps.
30381.5s 16014 Total runtime: 0.62 seconds.
30381.5s 16015 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.20s/s]
30381.5s 16016 [REWARD_MICROSCOPE] step=14479 t=585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30381.5s 16017 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30381.5s 16018 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30381.5s 16019 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30381.5s 16020 Running simulation until t = 600.00 s, outputting every 15.00 s
30381.5s 16021 
30381.6s 16022 [WARNING] Automatic CFL correction applied (count: 3343800):
30381.6s 16023 Calculated CFL: 0.800 > Limit: 0.500
30381.6s 16024 Original dt: 3.407491e-01 s
30381.6s 16025 Corrected dt: 2.129682e-01 s
30381.6s 16026 Correction factor: 1.6x
30381.6s 16027 Max wave speed detected: 23.48 m/s
30381.9s 16028 [PROGRESS] Step 2800: t=595.44/600.00s (99.2%) | dt=0.2133s
30382.1s 16029 Stored output at t = 600.0000 s (Step 2822)
30382.1s 16030 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30382.1s 16031 [A
30382.1s 16032 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.24s/s]
30382.1s 16033 
30382.1s 16034 Simulation finished at t = 600.0000 s after 2822 steps.
30382.1s 16035 Total runtime: 0.62 seconds.
30382.1s 16036 [REWARD_MICROSCOPE] step=14480 t=600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30382.1s 16037 [STEP   40] t=  600.0s | phase=0 | reward=   0.01 | total_reward=    0.40
30382.1s 16038 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30382.1s 16039 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30382.1s 16040 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30382.1s 16041 Running simulation until t = 615.00 s, outputting every 15.00 s
30382.1s 16042 
30382.3s 16043 [PROGRESS] Step 2850: t=605.95/615.00s (98.5%) | dt=0.2125s
30382.4s 16044 [PERIODIC:1000] BC_DISPATCHER [Call #13376000] current_bc_params: <class 'dict'>
30382.4s 16045 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30382.4s 16046 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30382.4s 16047 [PERIODIC:1000] BC_GPU [Call #13376000] About to launch kernel
30382.4s 16048 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30382.4s 16049 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30382.4s 16050 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30382.5s 16051 [WARNING] Automatic CFL correction applied (count: 3343900):
30382.5s 16052 Calculated CFL: 0.800 > Limit: 0.500
30382.5s 16053 Original dt: 3.401756e-01 s
30382.5s 16054 Corrected dt: 2.126097e-01 s
30382.5s 16055 Correction factor: 1.6x
30382.5s 16056 Max wave speed detected: 23.52 m/s
30382.7s 16057 Stored output at t = 615.0000 s (Step 2893)
30382.7s 16058 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 600.0/615.0 [00:00<?, ?s/s][A
30382.7s 16059 [A
30382.7s 16060 
30382.7s 16061 Simulation finished at t = 615.0000 s after 2893 steps.
30382.7s 16062 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.22s/s]
30382.7s 16063 Total runtime: 0.65 seconds.
30382.7s 16064 [QUEUE_DIAGNOSTIC] ===== Step 40 t=615.0s =====
30382.7s 16065 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30382.7s 16066 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30382.7s 16067 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30382.7s 16068 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30382.7s 16069 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30382.7s 16070 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30382.7s 16071 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30382.7s 16072 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30382.7s 16073 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30382.7s 16074 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30382.7s 16075 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30382.7s 16076 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30382.7s 16077 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30382.7s 16078 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30382.7s 16079 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30382.7s 16080 [REWARD_MICROSCOPE] step=14481 t=615.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30382.7s 16081 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30382.7s 16082 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30382.7s 16083 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30382.7s 16084 Running simulation until t = 630.00 s, outputting every 15.00 s
30382.7s 16085 
30382.8s 16086 [PROGRESS] Step 2900: t=616.49/630.00s (97.9%) | dt=0.2129s
30383.2s 16087 [PROGRESS] Step 2950: t=627.15/630.00s (99.5%) | dt=0.2131s
30383.4s 16088 Stored output at t = 630.0000 s (Step 2964)
30383.4s 16089 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 615.0/630.0 [00:00<?, ?s/s][A
30383.4s 16090 [A
30383.4s 16091 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.45s/s]
30383.4s 16092 
30383.4s 16093 Simulation finished at t = 630.0000 s after 2964 steps.
30383.4s 16094 Total runtime: 0.61 seconds.
30383.4s 16095 [REWARD_MICROSCOPE] step=14482 t=630.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30383.4s 16096 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30383.4s 16097 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30383.4s 16098 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30383.4s 16099 Running simulation until t = 645.00 s, outputting every 15.00 s
30383.4s 16100 
30383.4s 16101 [WARNING] Automatic CFL correction applied (count: 3344000):
30383.4s 16102 Calculated CFL: 0.800 > Limit: 0.500
30383.4s 16103 Original dt: 3.399530e-01 s
30383.4s 16104 Corrected dt: 2.124706e-01 s
30383.4s 16105 Correction factor: 1.6x
30383.4s 16106 Max wave speed detected: 23.53 m/s
30383.7s 16107 [PROGRESS] Step 3000: t=637.65/645.00s (98.9%) | dt=0.2125s
30384.0s 16108 Stored output at t = 645.0000 s (Step 3035)
30384.0s 16109 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 630.0/645.0 [00:00<?, ?s/s][A
30384.0s 16110 [A
30384.0s 16111 
30384.0s 16112 Simulation finished at t = 645.0000 s after 3035 steps.
30384.0s 16113 Total runtime: 0.62 seconds.
30384.0s 16114 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 24.31s/s]
30384.0s 16115 [REWARD_MICROSCOPE] step=14483 t=645.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30384.0s 16116 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30384.0s 16117 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30384.0s 16118 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30384.0s 16119 Running simulation until t = 660.00 s, outputting every 15.00 s
30384.0s 16120 
30384.1s 16121 [PROGRESS] Step 3050: t=648.19/660.00s (98.2%) | dt=0.2130s
30384.2s 16122 [WARNING] Automatic CFL correction applied (count: 3344100):
30384.2s 16123 Calculated CFL: 0.800 > Limit: 0.500
30384.2s 16124 Original dt: 3.409728e-01 s
30384.2s 16125 Corrected dt: 2.131080e-01 s
30384.2s 16126 Correction factor: 1.6x
30384.2s 16127 Max wave speed detected: 23.46 m/s
30384.5s 16128 [PROGRESS] Step 3100: t=658.85/660.00s (99.8%) | dt=0.2127s
30384.6s 16129 Stored output at t = 660.0000 s (Step 3106)
30384.6s 16130 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 645.0/660.0 [00:00<?, ?s/s][A
30384.6s 16131 [A
30384.6s 16132 
30384.6s 16133 Simulation finished at t = 660.0000 s after 3106 steps.
30384.6s 16134 Total runtime: 0.62 seconds.
30384.6s 16135 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.19s/s]
30384.6s 16136 [REWARD_MICROSCOPE] step=14484 t=660.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30384.6s 16137 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30384.6s 16138 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30384.6s 16139 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30384.6s 16140 Running simulation until t = 675.00 s, outputting every 15.00 s
30384.6s 16141 
30384.6s 16142 [PERIODIC:1000] BC_DISPATCHER [Call #13377000] current_bc_params: <class 'dict'>
30384.6s 16143 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30384.6s 16144 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30384.6s 16145 [PERIODIC:1000] BC_GPU [Call #13377000] About to launch kernel
30384.6s 16146 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30384.6s 16147 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30384.6s 16148 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30385.0s 16149 [PROGRESS] Step 3150: t=669.35/675.00s (99.2%) | dt=0.2126s
30385.1s 16150 [WARNING] Automatic CFL correction applied (count: 3344200):
30385.1s 16151 Calculated CFL: 0.800 > Limit: 0.500
30385.1s 16152 Original dt: 3.403992e-01 s
30385.1s 16153 Corrected dt: 2.127495e-01 s
30385.1s 16154 Correction factor: 1.6x
30385.1s 16155 Max wave speed detected: 23.50 m/s
30385.2s 16156 Stored output at t = 675.0000 s (Step 3177)
30385.2s 16157 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 660.0/675.0 [00:00<?, ?s/s][A
30385.2s 16158 [A
30385.2s 16159 
30385.2s 16160 Simulation finished at t = 675.0000 s after 3177 steps.
30385.2s 16161 Total runtime: 0.62 seconds.
30385.2s 16162 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.38s/s]
30385.2s 16163 [REWARD_MICROSCOPE] step=14485 t=675.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30385.2s 16164 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30385.2s 16165 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30385.2s 16166 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30385.2s 16167 Running simulation until t = 690.00 s, outputting every 15.00 s
30385.2s 16168 
30385.4s 16169 [PROGRESS] Step 3200: t=679.90/690.00s (98.5%) | dt=0.2130s
30385.8s 16170 Stored output at t = 690.0000 s (Step 3248)
30385.8s 16171 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 675.0/690.0 [00:00<?, ?s/s][A
30385.8s 16172 [A
30385.8s 16173 
30385.8s 16174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.50s/s]
30385.8s 16175 Simulation finished at t = 690.0000 s after 3248 steps.
30385.8s 16176 Total runtime: 0.61 seconds.
30385.8s 16177 [REWARD_MICROSCOPE] step=14486 t=690.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30385.8s 16178 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30385.8s 16179 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30385.8s 16180 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30385.8s 16181 Running simulation until t = 705.00 s, outputting every 15.00 s
30385.8s 16182 
30385.9s 16183 [PROGRESS] Step 3250: t=690.43/705.00s (97.9%) | dt=0.2125s
30386.0s 16184 [WARNING] Automatic CFL correction applied (count: 3344300):
30386.0s 16185 Calculated CFL: 0.800 > Limit: 0.500
30386.0s 16186 Original dt: 3.397973e-01 s
30386.0s 16187 Corrected dt: 2.123733e-01 s
30386.0s 16188 Correction factor: 1.6x
30386.0s 16189 Max wave speed detected: 23.54 m/s
30386.3s 16190 [PROGRESS] Step 3300: t=701.05/705.00s (99.4%) | dt=0.2127s
30386.5s 16191 Stored output at t = 705.0000 s (Step 3319)
30386.5s 16192 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 690.0/705.0 [00:00<?, ?s/s][A
30386.5s 16193 [A
30386.5s 16194 
30386.5s 16195 Simulation finished at t = 705.0000 s after 3319 steps.
30386.5s 16196 Total runtime: 0.63 seconds.
30386.5s 16197 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 23.90s/s]
30386.5s 16198 [REWARD_MICROSCOPE] step=14487 t=705.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30386.5s 16199 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30386.5s 16200 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30386.5s 16201 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30386.5s 16202 Running simulation until t = 720.00 s, outputting every 15.00 s
30386.5s 16203 
30386.7s 16204 [PROGRESS] Step 3350: t=711.60/720.00s (98.8%) | dt=0.2131s
30386.8s 16205 [PERIODIC:1000] BC_DISPATCHER [Call #13378000] current_bc_params: <class 'dict'>
30386.8s 16206 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30386.8s 16207 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30386.8s 16208 [PERIODIC:1000] BC_GPU [Call #13378000] About to launch kernel
30386.8s 16209 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30386.8s 16210 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30386.8s 16211 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30386.9s 16212 [WARNING] Automatic CFL correction applied (count: 3344400):
30386.9s 16213 Calculated CFL: 0.800 > Limit: 0.500
30386.9s 16214 Original dt: 3.411876e-01 s
30386.9s 16215 Corrected dt: 2.132423e-01 s
30386.9s 16216 Correction factor: 1.6x
30386.9s 16217 Max wave speed detected: 23.45 m/s
30387.1s 16218 Stored output at t = 720.0000 s (Step 3390)
30387.1s 16219 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 705.0/720.0 [00:00<?, ?s/s][A
30387.1s 16220 [A
30387.1s 16221 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.91s/s]
30387.1s 16222 
30387.1s 16223 Simulation finished at t = 720.0000 s after 3390 steps.
30387.1s 16224 Total runtime: 0.63 seconds.
30387.1s 16225 [REWARD_MICROSCOPE] step=14488 t=720.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30387.1s 16226 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30387.1s 16227 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30387.1s 16228 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30387.1s 16229 Running simulation until t = 735.00 s, outputting every 15.00 s
30387.1s 16230 
30387.2s 16231 [PROGRESS] Step 3400: t=722.12/735.00s (98.2%) | dt=0.2123s
30387.6s 16232 [PROGRESS] Step 3450: t=732.75/735.00s (99.7%) | dt=0.2127s
30387.7s 16233 Stored output at t = 735.0000 s (Step 3461)
30387.7s 16234 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 720.0/735.0 [00:00<?, ?s/s][A
30387.7s 16235 [A
30387.7s 16236 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.07s/s]
30387.7s 16237 
30387.7s 16238 Simulation finished at t = 735.0000 s after 3461 steps.
30387.7s 16239 Total runtime: 0.62 seconds.
30387.7s 16240 [REWARD_MICROSCOPE] step=14489 t=735.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30387.7s 16241 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30387.7s 16242 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30387.7s 16243 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30387.7s 16244 Running simulation until t = 750.00 s, outputting every 15.00 s
30387.7s 16245 
30387.8s 16246 [WARNING] Automatic CFL correction applied (count: 3344500):
30387.8s 16247 Calculated CFL: 0.800 > Limit: 0.500
30387.8s 16248 Original dt: 3.406104e-01 s
30387.8s 16249 Corrected dt: 2.128815e-01 s
30387.8s 16250 Correction factor: 1.6x
30387.8s 16251 Max wave speed detected: 23.49 m/s
30388.1s 16252 [PROGRESS] Step 3500: t=743.31/750.00s (99.1%) | dt=0.2132s
30388.3s 16253 Stored output at t = 750.0000 s (Step 3532)
30388.3s 16254 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 735.0/750.0 [00:00<?, ?s/s][A
30388.3s 16255 [A
30388.3s 16256 
30388.3s 16257 Simulation finished at t = 750.0000 s after 3532 steps.
30388.3s 16258 Total runtime: 0.63 seconds.
30388.3s 16259 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.97s/s]
30388.3s 16260 [REWARD_MICROSCOPE] step=14490 t=750.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30388.3s 16261 [STEP   50] t=  750.0s | phase=0 | reward=   0.01 | total_reward=    0.50
30388.3s 16262 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30388.3s 16263 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30388.3s 16264 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30388.3s 16265 Running simulation until t = 765.00 s, outputting every 15.00 s
30388.3s 16266 
30388.5s 16267 [PROGRESS] Step 3550: t=753.82/765.00s (98.5%) | dt=0.2124s
30388.6s 16268 [WARNING] Automatic CFL correction applied (count: 3344600):
30388.6s 16269 Calculated CFL: 0.800 > Limit: 0.500
30388.6s 16270 Original dt: 3.400365e-01 s
30388.6s 16271 Corrected dt: 2.125228e-01 s
30388.6s 16272 Correction factor: 1.6x
30388.6s 16273 Max wave speed detected: 23.53 m/s
30388.9s 16274 [PROGRESS] Step 3600: t=764.45/765.00s (99.9%) | dt=0.2128s
30389.0s 16275 Stored output at t = 765.0000 s (Step 3603)
30389.0s 16276 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 750.0/765.0 [00:00<?, ?s/s][A
30389.0s 16277 [A
30389.0s 16278 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 24.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 24.60s/s]
30389.0s 16279 
30389.0s 16280 Simulation finished at t = 765.0000 s after 3603 steps.
30389.0s 16281 Total runtime: 0.61 seconds.
30389.0s 16282 [QUEUE_DIAGNOSTIC] ===== Step 50 t=765.0s =====
30389.0s 16283 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30389.0s 16284 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30389.0s 16285 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30389.0s 16286 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30389.0s 16287 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30389.0s 16288 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30389.0s 16289 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30389.0s 16290 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30389.0s 16291 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30389.0s 16292 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30389.0s 16293 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30389.0s 16294 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30389.0s 16295 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30389.0s 16296 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30389.0s 16297 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30389.0s 16298 [REWARD_MICROSCOPE] step=14491 t=765.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30389.0s 16299 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30389.0s 16300 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30389.0s 16301 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30389.0s 16302 Running simulation until t = 780.00 s, outputting every 15.00 s
30389.0s 16303 
30389.0s 16304 [PERIODIC:1000] BC_DISPATCHER [Call #13379000] current_bc_params: <class 'dict'>
30389.0s 16305 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30389.0s 16306 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30389.0s 16307 [PERIODIC:1000] BC_GPU [Call #13379000] About to launch kernel
30389.0s 16308 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30389.0s 16309 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30389.0s 16310 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30389.4s 16311 [PROGRESS] Step 3650: t=775.01/780.00s (99.4%) | dt=0.2132s
30389.5s 16312 [WARNING] Automatic CFL correction applied (count: 3344700):
30389.5s 16313 Calculated CFL: 0.800 > Limit: 0.500
30389.5s 16314 Original dt: 3.404624e-01 s
30389.5s 16315 Corrected dt: 2.127890e-01 s
30389.5s 16316 Correction factor: 1.6x
30389.5s 16317 Max wave speed detected: 23.50 m/s
30389.6s 16318 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 765.0/780.0 [00:00<?, ?s/s][A
30389.6s 16319 [A
30389.6s 16320 Stored output at t = 780.0000 s (Step 3674)
30389.6s 16321 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 23.85s/s]
30389.6s 16322 
30389.6s 16323 Simulation finished at t = 780.0000 s after 3674 steps.
30389.6s 16324 Total runtime: 0.63 seconds.
30389.6s 16325 [REWARD_MICROSCOPE] step=14492 t=780.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30389.6s 16326 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30389.6s 16327 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30389.6s 16328 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30389.6s 16329 Running simulation until t = 795.00 s, outputting every 15.00 s
30389.6s 16330 
30389.8s 16331 [PROGRESS] Step 3700: t=785.52/795.00s (98.8%) | dt=0.2124s
30390.3s 16332 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 780.0/795.0 [00:00<?, ?s/s][A
30390.3s 16333 [A
30390.3s 16334 Stored output at t = 795.0000 s (Step 3745)
30390.3s 16335 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 22.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 22.15s/s]
30390.3s 16336 
30390.3s 16337 Simulation finished at t = 795.0000 s after 3745 steps.
30390.3s 16338 Total runtime: 0.68 seconds.
30390.3s 16339 [REWARD_MICROSCOPE] step=14493 t=795.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30390.3s 16340 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30390.3s 16341 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30390.3s 16342 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30390.3s 16343 Running simulation until t = 810.00 s, outputting every 15.00 s
30390.3s 16344 
30390.3s 16345 [PROGRESS] Step 3750: t=796.06/810.00s (98.3%) | dt=0.2129s
30390.5s 16346 [WARNING] Automatic CFL correction applied (count: 3344800):
30390.5s 16347 Calculated CFL: 0.800 > Limit: 0.500
30390.5s 16348 Original dt: 3.408331e-01 s
30390.5s 16349 Corrected dt: 2.130207e-01 s
30390.5s 16350 Correction factor: 1.6x
30390.5s 16351 Max wave speed detected: 23.47 m/s
30390.8s 16352 [PROGRESS] Step 3800: t=806.72/810.00s (99.6%) | dt=0.2133s
30390.9s 16353 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 795.0/810.0 [00:00<?, ?s/s][A
30390.9s 16354 [A
30390.9s 16355 Stored output at t = 810.0000 s (Step 3816)
30390.9s 16356 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.36s/s]
30390.9s 16357 
30390.9s 16358 Simulation finished at t = 810.0000 s after 3816 steps.
30390.9s 16359 Total runtime: 0.64 seconds.
30390.9s 16360 [REWARD_MICROSCOPE] step=14494 t=810.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30390.9s 16361 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30390.9s 16362 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30390.9s 16363 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30390.9s 16364 Running simulation until t = 825.00 s, outputting every 15.00 s
30390.9s 16365 
30391.2s 16366 [PROGRESS] Step 3850: t=817.22/825.00s (99.1%) | dt=0.2125s
30391.3s 16367 [PERIODIC:1000] BC_DISPATCHER [Call #13380000] current_bc_params: <class 'dict'>
30391.3s 16368 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30391.3s 16369 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30391.3s 16370 [PERIODIC:1000] BC_GPU [Call #13380000] About to launch kernel
30391.3s 16371 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30391.3s 16372 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30391.3s 16373 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30391.4s 16374 [WARNING] Automatic CFL correction applied (count: 3344900):
30391.4s 16375 Calculated CFL: 0.800 > Limit: 0.500
30391.4s 16376 Original dt: 3.402592e-01 s
30391.4s 16377 Corrected dt: 2.126620e-01 s
30391.4s 16378 Correction factor: 1.6x
30391.4s 16379 Max wave speed detected: 23.51 m/s
30391.5s 16380 Stored output at t = 825.0000 s (Step 3887)
30391.5s 16381 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 810.0/825.0 [00:00<?, ?s/s][A
30391.5s 16382 [A
30391.5s 16383 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.12s/s]
30391.5s 16384 
30391.5s 16385 Simulation finished at t = 825.0000 s after 3887 steps.
30391.5s 16386 Total runtime: 0.62 seconds.
30391.5s 16387 [REWARD_MICROSCOPE] step=14495 t=825.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30391.5s 16388 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30391.5s 16389 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30391.5s 16390 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30391.5s 16391 Running simulation until t = 840.00 s, outputting every 15.00 s
30391.5s 16392 
30391.7s 16393 [PROGRESS] Step 3900: t=827.77/840.00s (98.5%) | dt=0.2129s
30392.1s 16394 [PROGRESS] Step 3950: t=838.42/840.00s (99.8%) | dt=0.2128s
30392.2s 16395 Stored output at t = 840.0000 s (Step 3958)
30392.2s 16396 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 825.0/840.0 [00:00<?, ?s/s][A
30392.2s 16397 [A
30392.2s 16398 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.13s/s]
30392.2s 16399 
30392.2s 16400 Simulation finished at t = 840.0000 s after 3958 steps.
30392.2s 16401 Total runtime: 0.62 seconds.
30392.2s 16402 [REWARD_MICROSCOPE] step=14496 t=840.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30392.2s 16403 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30392.2s 16404 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30392.2s 16405 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30392.2s 16406 Running simulation until t = 855.00 s, outputting every 15.00 s
30392.2s 16407 
30392.2s 16408 [WARNING] Automatic CFL correction applied (count: 3345000):
30392.2s 16409 Calculated CFL: 0.800 > Limit: 0.500
30392.2s 16410 Original dt: 3.397413e-01 s
30392.2s 16411 Corrected dt: 2.123383e-01 s
30392.2s 16412 Correction factor: 1.6x
30392.2s 16413 Max wave speed detected: 23.55 m/s
30392.6s 16414 [PROGRESS] Step 4000: t=848.92/855.00s (99.3%) | dt=0.2126s
30392.8s 16415 Stored output at t = 855.0000 s (Step 4029)
30392.8s 16416 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 840.0/855.0 [00:00<?, ?s/s][A
30392.8s 16417 [A
30392.8s 16418 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 23.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 23.06s/s]
30392.8s 16419 
30392.8s 16420 Simulation finished at t = 855.0000 s after 4029 steps.
30392.8s 16421 Total runtime: 0.65 seconds.
30392.8s 16422 [REWARD_MICROSCOPE] step=14497 t=855.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30392.8s 16423 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30392.8s 16424 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30392.8s 16425 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30392.8s 16426 Running simulation until t = 870.00 s, outputting every 15.00 s
30392.8s 16427 
30393.0s 16428 [PROGRESS] Step 4050: t=859.47/870.00s (98.8%) | dt=0.2130s
30393.2s 16429 [WARNING] Automatic CFL correction applied (count: 3345100):
30393.2s 16430 Calculated CFL: 0.800 > Limit: 0.500
30393.2s 16431 Original dt: 3.410527e-01 s
30393.2s 16432 Corrected dt: 2.131579e-01 s
30393.2s 16433 Correction factor: 1.6x
30393.2s 16434 Max wave speed detected: 23.46 m/s
30393.5s 16435 [PROGRESS] Step 4100: t=870.00/870.00s (100.0%) | dt=0.0883s
30393.5s 16436 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 855.0/870.0 [00:00<?, ?s/s][A
30393.5s 16437 [A
30393.5s 16438 Stored output at t = 870.0000 s (Step 4100)
30393.5s 16439 
30393.5s 16440 Simulation finished at t = 870.0000 s after 4100 steps.
30393.5s 16441 Total runtime: 0.64 seconds.
30393.5s 16442 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 23.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 23.36s/s]
30393.5s 16443 [REWARD_MICROSCOPE] step=14498 t=870.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30393.5s 16444 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30393.5s 16445 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30393.5s 16446 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30393.5s 16447 Running simulation until t = 885.00 s, outputting every 15.00 s
30393.5s 16448 
30393.6s 16449 [PERIODIC:1000] BC_DISPATCHER [Call #13381000] current_bc_params: <class 'dict'>
30393.6s 16450 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30393.6s 16451 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30393.6s 16452 [PERIODIC:1000] BC_GPU [Call #13381000] About to launch kernel
30393.6s 16453 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30393.6s 16454 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30393.6s 16455 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30393.9s 16456 [PROGRESS] Step 4150: t=880.62/885.00s (99.5%) | dt=0.2127s
30394.1s 16457 [WARNING] Automatic CFL correction applied (count: 3345200):
30394.1s 16458 Calculated CFL: 0.800 > Limit: 0.500
30394.1s 16459 Original dt: 3.404818e-01 s
30394.1s 16460 Corrected dt: 2.128011e-01 s
30394.1s 16461 Correction factor: 1.6x
30394.1s 16462 Max wave speed detected: 23.50 m/s
30394.1s 16463 Stored output at t = 885.0000 s (Step 4171)
30394.1s 16464 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 870.0/885.0 [00:00<?, ?s/s][A
30394.1s 16465 [A
30394.1s 16466 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 22.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 22.17s/s]
30394.1s 16467 
30394.1s 16468 Simulation finished at t = 885.0000 s after 4171 steps.
30394.1s 16469 Total runtime: 0.68 seconds.
30394.1s 16470 [REWARD_MICROSCOPE] step=14499 t=885.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30394.1s 16471 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30394.1s 16472 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30394.1s 16473 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30394.1s 16474 Running simulation until t = 900.00 s, outputting every 15.00 s
30394.1s 16475 
30394.4s 16476 [PROGRESS] Step 4200: t=891.18/900.00s (99.0%) | dt=0.2131s
30394.8s 16477 Stored output at t = 900.0000 s (Step 4242)
30394.8s 16478 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 885.0/900.0 [00:00<?, ?s/s][A
30394.8s 16479 [A
30394.8s 16480 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 22.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 22.99s/s]
30394.8s 16481 
30394.8s 16482 Simulation finished at t = 900.0000 s after 4242 steps.
30394.8s 16483 Total runtime: 0.65 seconds.
30394.8s 16484 [REWARD_MICROSCOPE] step=14500 t=900.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30394.8s 16485 [STEP   60] t=  900.0s | phase=0 | reward=   0.01 | total_reward=    0.60
30394.8s 16486 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30394.8s 16487 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30394.8s 16488 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30394.8s 16489 Running simulation until t = 915.00 s, outputting every 15.00 s
30394.8s 16490 
30394.9s 16491 [PROGRESS] Step 4250: t=901.70/915.00s (98.5%) | dt=0.2124s
30395.0s 16492 [WARNING] Automatic CFL correction applied (count: 3345300):
30395.0s 16493 Calculated CFL: 0.800 > Limit: 0.500
30395.0s 16494 Original dt: 3.398890e-01 s
30395.0s 16495 Corrected dt: 2.124306e-01 s
30395.0s 16496 Correction factor: 1.6x
30395.0s 16497 Max wave speed detected: 23.54 m/s
30395.3s 16498 [PROGRESS] Step 4300: t=912.32/915.00s (99.7%) | dt=0.2127s
30395.4s 16499 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 900.0/915.0 [00:00<?, ?s/s][A
30395.4s 16500 [A
30395.4s 16501 Stored output at t = 915.0000 s (Step 4313)
30395.4s 16502 
30395.4s 16503 Simulation finished at t = 915.0000 s after 4313 steps.
30395.4s 16504 Total runtime: 0.63 seconds.
30395.4s 16505 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.74s/s]
30395.4s 16506 [QUEUE_DIAGNOSTIC] ===== Step 60 t=915.0s =====
30395.4s 16507 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30395.4s 16508 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30395.4s 16509 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30395.4s 16510 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30395.4s 16511 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30395.4s 16512 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30395.4s 16513 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30395.4s 16514 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30395.4s 16515 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30395.4s 16516 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30395.4s 16517 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30395.4s 16518 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30395.4s 16519 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30395.4s 16520 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30395.4s 16521 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30395.4s 16522 [REWARD_MICROSCOPE] step=14501 t=915.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30395.4s 16523 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30395.4s 16524 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30395.4s 16525 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30395.4s 16526 Running simulation until t = 930.00 s, outputting every 15.00 s
30395.4s 16527 
30395.8s 16528 [PROGRESS] Step 4350: t=922.88/930.00s (99.2%) | dt=0.2131s
30395.9s 16529 [PERIODIC:1000] BC_DISPATCHER [Call #13382000] current_bc_params: <class 'dict'>
30395.9s 16530 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30395.9s 16531 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30395.9s 16532 [PERIODIC:1000] BC_GPU [Call #13382000] About to launch kernel
30395.9s 16533 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30395.9s 16534 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30395.9s 16535 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30395.9s 16536 [WARNING] Automatic CFL correction applied (count: 3345400):
30395.9s 16537 Calculated CFL: 0.800 > Limit: 0.500
30395.9s 16538 Original dt: 3.412697e-01 s
30395.9s 16539 Corrected dt: 2.132935e-01 s
30395.9s 16540 Correction factor: 1.6x
30395.9s 16541 Max wave speed detected: 23.44 m/s
30396.1s 16542 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 915.0/930.0 [00:00<?, ?s/s][A
30396.1s 16543 [A
30396.1s 16544 Stored output at t = 930.0000 s (Step 4384)
30396.1s 16545 
30396.1s 16546 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 24.23s/s]
30396.1s 16547 Simulation finished at t = 930.0000 s after 4384 steps.
30396.1s 16548 Total runtime: 0.62 seconds.
30396.1s 16549 [REWARD_MICROSCOPE] step=14502 t=930.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30396.1s 16550 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30396.1s 16551 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30396.1s 16552 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30396.1s 16553 Running simulation until t = 945.00 s, outputting every 15.00 s
30396.1s 16554 
30396.2s 16555 [PROGRESS] Step 4400: t=933.40/945.00s (98.8%) | dt=0.2123s
30396.6s 16556 [PROGRESS] Step 4450: t=944.03/945.00s (99.9%) | dt=0.2128s
30396.7s 16557 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 930.0/945.0 [00:00<?, ?s/s][A
30396.7s 16558 [A
30396.7s 16559 Stored output at t = 945.0000 s (Step 4455)
30396.7s 16560 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 24.26s/s]
30396.7s 16561 
30396.7s 16562 Simulation finished at t = 945.0000 s after 4455 steps.
30396.7s 16563 Total runtime: 0.62 seconds.
30396.7s 16564 [REWARD_MICROSCOPE] step=14503 t=945.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30396.7s 16565 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30396.7s 16566 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30396.7s 16567 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30396.7s 16568 Running simulation until t = 960.00 s, outputting every 15.00 s
30396.7s 16569 
30396.8s 16570 [WARNING] Automatic CFL correction applied (count: 3345500):
30396.8s 16571 Calculated CFL: 0.800 > Limit: 0.500
30396.8s 16572 Original dt: 3.406934e-01 s
30396.8s 16573 Corrected dt: 2.129334e-01 s
30396.8s 16574 Correction factor: 1.6x
30396.8s 16575 Max wave speed detected: 23.48 m/s
30397.1s 16576 [PROGRESS] Step 4500: t=954.59/960.00s (99.4%) | dt=0.2132s
30397.3s 16577 Stored output at t = 960.0000 s (Step 4526)
30397.3s 16578 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 945.0/960.0 [00:00<?, ?s/s][A
30397.3s 16579 [A
30397.3s 16580 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.69s/s]
30397.3s 16581 
30397.3s 16582 Simulation finished at t = 960.0000 s after 4526 steps.
30397.3s 16583 Total runtime: 0.63 seconds.
30397.3s 16584 [REWARD_MICROSCOPE] step=14504 t=960.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30397.3s 16585 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30397.3s 16586 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30397.3s 16587 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30397.3s 16588 Running simulation until t = 975.00 s, outputting every 15.00 s
30397.3s 16589 
30397.5s 16590 [PROGRESS] Step 4550: t=965.10/975.00s (99.0%) | dt=0.2124s
30397.7s 16591 [WARNING] Automatic CFL correction applied (count: 3345600):
30397.7s 16592 Calculated CFL: 0.800 > Limit: 0.500
30397.7s 16593 Original dt: 3.401199e-01 s
30397.7s 16594 Corrected dt: 2.125749e-01 s
30397.7s 16595 Correction factor: 1.6x
30397.7s 16596 Max wave speed detected: 23.52 m/s
30397.9s 16597 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 960.0/975.0 [00:00<?, ?s/s][A
30397.9s 16598 [A
30397.9s 16599 Stored output at t = 975.0000 s (Step 4597)
30397.9s 16600 
30397.9s 16601 Simulation finished at t = 975.0000 s after 4597 steps.
30397.9s 16602 Total runtime: 0.62 seconds.
30397.9s 16603 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.02s/s]
30397.9s 16604 [REWARD_MICROSCOPE] step=14505 t=975.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30397.9s 16605 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30397.9s 16606 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30397.9s 16607 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30397.9s 16608 Running simulation until t = 990.00 s, outputting every 15.00 s
30397.9s 16609 
30398.0s 16610 [PROGRESS] Step 4600: t=975.64/990.00s (98.5%) | dt=0.2129s
30398.1s 16611 [PERIODIC:1000] BC_DISPATCHER [Call #13383000] current_bc_params: <class 'dict'>
30398.1s 16612 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30398.1s 16613 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30398.1s 16614 [PERIODIC:1000] BC_GPU [Call #13383000] About to launch kernel
30398.1s 16615 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30398.1s 16616 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30398.1s 16617 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30398.4s 16618 [PROGRESS] Step 4650: t=986.29/990.00s (99.6%) | dt=0.2133s
30398.6s 16619 [WARNING] Automatic CFL correction applied (count: 3345700):
30398.6s 16620 Calculated CFL: 0.800 > Limit: 0.500
30398.6s 16621 Original dt: 3.401129e-01 s
30398.6s 16622 Corrected dt: 2.125705e-01 s
30398.6s 16623 Correction factor: 1.6x
30398.6s 16624 Max wave speed detected: 23.52 m/s
30398.6s 16625 Stored output at t = 990.0000 s (Step 4668)
30398.6s 16626 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975.0/990.0 [00:00<?, ?s/s][A
30398.6s 16627 [A
30398.6s 16628 
30398.6s 16629 Simulation finished at t = 990.0000 s after 4668 steps.
30398.6s 16630 Total runtime: 0.62 seconds.
30398.6s 16631 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.14s/s]
30398.6s 16632 [REWARD_MICROSCOPE] step=14506 t=990.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30398.6s 16633 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30398.6s 16634 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30398.6s 16635 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30398.6s 16636 Running simulation until t = 1005.00 s, outputting every 15.00 s
30398.6s 16637 
30398.8s 16638 [PROGRESS] Step 4700: t=996.80/1005.00s (99.2%) | dt=0.2125s
30399.2s 16639 Stored output at t = 1005.0000 s (Step 4739)
30399.2s 16640 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 990.0/1005.0 [00:00<?, ?s/s][A
30399.2s 16641 [A
30399.2s 16642 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 23.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 23.61s/s]
30399.2s 16643 
30399.2s 16644 Simulation finished at t = 1005.0000 s after 4739 steps.
30399.2s 16645 Total runtime: 0.64 seconds.
30399.2s 16646 [REWARD_MICROSCOPE] step=14507 t=1005.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30399.2s 16647 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30399.2s 16648 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30399.2s 16649 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30399.2s 16650 Running simulation until t = 1020.00 s, outputting every 15.00 s
30399.2s 16651 
30399.3s 16652 [PROGRESS] Step 4750: t=1007.34/1020.00s (98.8%) | dt=0.2129s
30399.4s 16653 [WARNING] Automatic CFL correction applied (count: 3345800):
30399.4s 16654 Calculated CFL: 0.800 > Limit: 0.500
30399.4s 16655 Original dt: 3.409178e-01 s
30399.4s 16656 Corrected dt: 2.130736e-01 s
30399.4s 16657 Correction factor: 1.6x
30399.4s 16658 Max wave speed detected: 23.47 m/s
30399.7s 16659 [PROGRESS] Step 4800: t=1018.00/1020.00s (99.8%) | dt=0.2129s
30399.8s 16660 Stored output at t = 1020.0000 s (Step 4810)
30399.8s 16661 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1005.0/1020.0 [00:00<?, ?s/s][A
30399.8s 16662 [A
30399.8s 16663 
30399.8s 16664 Simulation finished at t = 1020.0000 s after 4810 steps.
30399.8s 16665 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.15s/s]
30399.8s 16666 Total runtime: 0.62 seconds.
30399.8s 16667 [REWARD_MICROSCOPE] step=14508 t=1020.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30399.8s 16668 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30399.8s 16669 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30399.8s 16670 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30399.8s 16671 Running simulation until t = 1035.00 s, outputting every 15.00 s
30399.8s 16672 
30400.2s 16673 [PROGRESS] Step 4850: t=1028.50/1035.00s (99.4%) | dt=0.2126s
30400.3s 16674 [PERIODIC:1000] BC_DISPATCHER [Call #13384000] current_bc_params: <class 'dict'>
30400.3s 16675 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30400.3s 16676 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30400.3s 16677 [PERIODIC:1000] BC_GPU [Call #13384000] About to launch kernel
30400.3s 16678 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30400.3s 16679 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30400.3s 16680 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30400.3s 16681 [WARNING] Automatic CFL correction applied (count: 3345900):
30400.3s 16682 Calculated CFL: 0.800 > Limit: 0.500
30400.3s 16683 Original dt: 3.403431e-01 s
30400.3s 16684 Corrected dt: 2.127144e-01 s
30400.3s 16685 Correction factor: 1.6x
30400.3s 16686 Max wave speed detected: 23.51 m/s
30400.5s 16687 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1020.0/1035.0 [00:00<?, ?s/s][A
30400.5s 16688 [A
30400.5s 16689 Stored output at t = 1035.0000 s (Step 4881)
30400.5s 16690 
30400.5s 16691 Simulation finished at t = 1035.0000 s after 4881 steps.
30400.5s 16692 Total runtime: 0.62 seconds.
30400.5s 16693 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.25s/s]
30400.5s 16694 [REWARD_MICROSCOPE] step=14509 t=1035.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30400.5s 16695 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30400.5s 16696 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30400.5s 16697 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30400.5s 16698 Running simulation until t = 1050.00 s, outputting every 15.00 s
30400.5s 16699 
30400.6s 16700 [PROGRESS] Step 4900: t=1039.05/1050.00s (99.0%) | dt=0.2130s
30401.1s 16701 [PROGRESS] Step 4950: t=1049.70/1050.00s (100.0%) | dt=0.2126s
30401.1s 16702 Stored output at t = 1050.0000 s (Step 4952)
30401.1s 16703 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1035.0/1050.0 [00:00<?, ?s/s][A
30401.1s 16704 [A
30401.1s 16705 
30401.1s 16706 Simulation finished at t = 1050.0000 s after 4952 steps.
30401.1s 16707 Total runtime: 0.65 seconds.
30401.1s 16708 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 23.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 23.10s/s]
30401.1s 16709 [REWARD_MICROSCOPE] step=14510 t=1050.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30401.1s 16710 [STEP   70] t= 1050.0s | phase=0 | reward=   0.01 | total_reward=    0.70
30401.1s 16711 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30401.1s 16712 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30401.1s 16713 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30401.1s 16714 Running simulation until t = 1065.00 s, outputting every 15.00 s
30401.1s 16715 
30401.2s 16716 [WARNING] Automatic CFL correction applied (count: 3346000):
30401.2s 16717 Calculated CFL: 0.800 > Limit: 0.500
30401.2s 16718 Original dt: 3.397401e-01 s
30401.2s 16719 Corrected dt: 2.123376e-01 s
30401.2s 16720 Correction factor: 1.6x
30401.2s 16721 Max wave speed detected: 23.55 m/s
30401.5s 16722 [PROGRESS] Step 5000: t=1060.20/1065.00s (99.5%) | dt=0.2126s
30401.7s 16723 Stored output at t = 1065.0000 s (Step 5023)
30401.7s 16724 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1050.0/1065.0 [00:00<?, ?s/s][A
30401.7s 16725 [A
30401.7s 16726 
30401.7s 16727 Simulation finished at t = 1065.0000 s after 5023 steps.
30401.7s 16728 Total runtime: 0.62 seconds.
30401.7s 16729 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.23s/s]
30401.7s 16730 [QUEUE_DIAGNOSTIC] ===== Step 70 t=1065.0s =====
30401.7s 16731 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30401.7s 16732 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30401.7s 16733 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30401.7s 16734 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30401.7s 16735 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30401.7s 16736 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30401.7s 16737 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30401.7s 16738 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30401.7s 16739 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30401.7s 16740 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30401.7s 16741 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30401.7s 16742 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30401.7s 16743 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30401.7s 16744 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30401.7s 16745 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30401.7s 16746 [REWARD_MICROSCOPE] step=14511 t=1065.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30401.7s 16747 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30401.7s 16748 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30401.7s 16749 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30401.7s 16750 Running simulation until t = 1080.00 s, outputting every 15.00 s
30401.7s 16751 
30402.0s 16752 [PROGRESS] Step 5050: t=1070.75/1080.00s (99.1%) | dt=0.2131s
30402.1s 16753 [WARNING] Automatic CFL correction applied (count: 3346100):
30402.1s 16754 Calculated CFL: 0.800 > Limit: 0.500
30402.1s 16755 Original dt: 3.411334e-01 s
30402.1s 16756 Corrected dt: 2.132084e-01 s
30402.1s 16757 Correction factor: 1.6x
30402.1s 16758 Max wave speed detected: 23.45 m/s
30402.4s 16759 Stored output at t = 1080.0000 s (Step 5094)
30402.4s 16760 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1065.0/1080.0 [00:00<?, ?s/s][A
30402.4s 16761 [A
30402.4s 16762 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 23.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 23.49s/s]
30402.4s 16763 
30402.4s 16764 Simulation finished at t = 1080.0000 s after 5094 steps.
30402.4s 16765 Total runtime: 0.64 seconds.
30402.4s 16766 [REWARD_MICROSCOPE] step=14512 t=1080.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30402.4s 16767 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30402.4s 16768 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30402.4s 16769 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30402.4s 16770 Running simulation until t = 1095.00 s, outputting every 15.00 s
30402.4s 16771 
30402.4s 16772 [PROGRESS] Step 5100: t=1081.27/1095.00s (98.7%) | dt=0.2124s
30402.5s 16773 [PERIODIC:1000] BC_DISPATCHER [Call #13385000] current_bc_params: <class 'dict'>
30402.5s 16774 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30402.5s 16775 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30402.5s 16776 [PERIODIC:1000] BC_GPU [Call #13385000] About to launch kernel
30402.5s 16777 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30402.5s 16778 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30402.5s 16779 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30402.9s 16780 [PROGRESS] Step 5150: t=1091.90/1095.00s (99.7%) | dt=0.2127s
30403.0s 16781 Stored output at t = 1095.0000 s (Step 5165)
30403.0s 16782 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1080.0/1095.0 [00:00<?, ?s/s][A
30403.0s 16783 [A
30403.0s 16784 
30403.0s 16785 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.13s/s]
30403.0s 16786 Simulation finished at t = 1095.0000 s after 5165 steps.
30403.0s 16787 Total runtime: 0.62 seconds.
30403.0s 16788 [REWARD_MICROSCOPE] step=14513 t=1095.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30403.0s 16789 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30403.0s 16790 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30403.0s 16791 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30403.0s 16792 Running simulation until t = 1110.00 s, outputting every 15.00 s
30403.0s 16793 
30403.0s 16794 [WARNING] Automatic CFL correction applied (count: 3346200):
30403.0s 16795 Calculated CFL: 0.800 > Limit: 0.500
30403.0s 16796 Original dt: 3.405553e-01 s
30403.0s 16797 Corrected dt: 2.128470e-01 s
30403.0s 16798 Correction factor: 1.6x
30403.0s 16799 Max wave speed detected: 23.49 m/s
30403.3s 16800 [PROGRESS] Step 5200: t=1102.45/1110.00s (99.3%) | dt=0.2131s
30403.6s 16801 Stored output at t = 1110.0000 s (Step 5236)
30403.6s 16802 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1095.0/1110.0 [00:00<?, ?s/s][A
30403.6s 16803 [A
30403.6s 16804 
30403.6s 16805 Simulation finished at t = 1110.0000 s after 5236 steps.
30403.6s 16806 Total runtime: 0.62 seconds.
30403.6s 16807 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.09s/s]
30403.6s 16808 [REWARD_MICROSCOPE] step=14514 t=1110.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30403.6s 16809 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30403.6s 16810 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30403.6s 16811 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30403.6s 16812 Running simulation until t = 1125.00 s, outputting every 15.00 s
30403.6s 16813 
30403.7s 16814 [PROGRESS] Step 5250: t=1112.97/1125.00s (98.9%) | dt=0.2123s
30403.9s 16815 [WARNING] Automatic CFL correction applied (count: 3346300):
30403.9s 16816 Calculated CFL: 0.800 > Limit: 0.500
30403.9s 16817 Original dt: 3.399790e-01 s
30403.9s 16818 Corrected dt: 2.124869e-01 s
30403.9s 16819 Correction factor: 1.6x
30403.9s 16820 Max wave speed detected: 23.53 m/s
30404.2s 16821 [PROGRESS] Step 5300: t=1123.60/1125.00s (99.9%) | dt=0.2128s
30404.2s 16822 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1110.0/1125.0 [00:00<?, ?s/s][A
30404.2s 16823 [A
30404.2s 16824 Stored output at t = 1125.0000 s (Step 5307)
30404.2s 16825 
30404.2s 16826 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 23.99s/s]
30404.2s 16827 Simulation finished at t = 1125.0000 s after 5307 steps.
30404.2s 16828 Total runtime: 0.63 seconds.
30404.3s 16829 [REWARD_MICROSCOPE] step=14515 t=1125.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30404.3s 16830 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30404.3s 16831 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30404.3s 16832 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30404.3s 16833 Running simulation until t = 1140.00 s, outputting every 15.00 s
30404.3s 16834 
30404.6s 16835 [PROGRESS] Step 5350: t=1134.16/1140.00s (99.5%) | dt=0.2132s
30404.7s 16836 [PERIODIC:1000] BC_DISPATCHER [Call #13386000] current_bc_params: <class 'dict'>
30404.7s 16837 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30404.7s 16838 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30404.7s 16839 [PERIODIC:1000] BC_GPU [Call #13386000] About to launch kernel
30404.7s 16840 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30404.7s 16841 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30404.7s 16842 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30404.8s 16843 [WARNING] Automatic CFL correction applied (count: 3346400):
30404.8s 16844 Calculated CFL: 0.800 > Limit: 0.500
30404.8s 16845 Original dt: 3.407550e-01 s
30404.8s 16846 Corrected dt: 2.129719e-01 s
30404.8s 16847 Correction factor: 1.6x
30404.8s 16848 Max wave speed detected: 23.48 m/s
30404.9s 16849 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1125.0/1140.0 [00:00<?, ?s/s][A
30404.9s 16850 [A
30404.9s 16851 Stored output at t = 1140.0000 s (Step 5378)
30404.9s 16852 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.23s/s]
30404.9s 16853 
30404.9s 16854 Simulation finished at t = 1140.0000 s after 5378 steps.
30404.9s 16855 Total runtime: 0.62 seconds.
30404.9s 16856 [REWARD_MICROSCOPE] step=14516 t=1140.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30404.9s 16857 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30404.9s 16858 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30404.9s 16859 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30404.9s 16860 Running simulation until t = 1155.00 s, outputting every 15.00 s
30404.9s 16861 
30405.1s 16862 [PROGRESS] Step 5400: t=1144.67/1155.00s (99.1%) | dt=0.2124s
30405.5s 16863 Stored output at t = 1155.0000 s (Step 5449)
30405.5s 16864 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1140.0/1155.0 [00:00<?, ?s/s][A
30405.5s 16865 [A
30405.5s 16866 
30405.5s 16867 Simulation finished at t = 1155.0000 s after 5449 steps.
30405.5s 16868 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.00s/s]
30405.5s 16869 Total runtime: 0.63 seconds.
30405.5s 16870 [REWARD_MICROSCOPE] step=14517 t=1155.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30405.5s 16871 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30405.5s 16872 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30405.5s 16873 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30405.5s 16874 Running simulation until t = 1170.00 s, outputting every 15.00 s
30405.5s 16875 
30405.5s 16876 [PROGRESS] Step 5450: t=1155.21/1170.00s (98.7%) | dt=0.2128s
30405.7s 16877 [WARNING] Automatic CFL correction applied (count: 3346500):
30405.7s 16878 Calculated CFL: 0.800 > Limit: 0.500
30405.7s 16879 Original dt: 3.407770e-01 s
30405.7s 16880 Corrected dt: 2.129856e-01 s
30405.7s 16881 Correction factor: 1.6x
30405.7s 16882 Max wave speed detected: 23.48 m/s
30405.9s 16883 [PROGRESS] Step 5500: t=1165.87/1170.00s (99.6%) | dt=0.2133s
30406.1s 16884 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1155.0/1170.0 [00:00<?, ?s/s][A
30406.1s 16885 [A
30406.1s 16886 Stored output at t = 1170.0000 s (Step 5520)
30406.1s 16887 
30406.1s 16888 Simulation finished at t = 1170.0000 s after 5520 steps.
30406.1s 16889 Total runtime: 0.63 seconds.
30406.1s 16890 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 23.89s/s]
30406.1s 16891 [REWARD_MICROSCOPE] step=14518 t=1170.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30406.1s 16892 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30406.1s 16893 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30406.1s 16894 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30406.1s 16895 Running simulation until t = 1185.00 s, outputting every 15.00 s
30406.1s 16896 
30406.4s 16897 [PROGRESS] Step 5550: t=1176.37/1185.00s (99.3%) | dt=0.2125s
30406.5s 16898 [WARNING] Automatic CFL correction applied (count: 3346600):
30406.5s 16899 Calculated CFL: 0.800 > Limit: 0.500
30406.5s 16900 Original dt: 3.402034e-01 s
30406.5s 16901 Corrected dt: 2.126271e-01 s
30406.5s 16902 Correction factor: 1.6x
30406.5s 16903 Max wave speed detected: 23.52 m/s
30406.8s 16904 Stored output at t = 1185.0000 s (Step 5591)
30406.8s 16905 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1170.0/1185.0 [00:00<?, ?s/s][A
30406.8s 16906 [A
30406.8s 16907 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 23.78s/s]
30406.8s 16908 
30406.8s 16909 Simulation finished at t = 1185.0000 s after 5591 steps.
30406.8s 16910 Total runtime: 0.63 seconds.
30406.8s 16911 [REWARD_MICROSCOPE] step=14519 t=1185.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30406.8s 16912 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30406.8s 16913 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30406.8s 16914 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30406.8s 16915 Running simulation until t = 1200.00 s, outputting every 15.00 s
30406.8s 16916 
30406.9s 16917 [PROGRESS] Step 5600: t=1186.92/1200.00s (98.9%) | dt=0.2129s
30406.9s 16918 [PERIODIC:1000] BC_DISPATCHER [Call #13387000] current_bc_params: <class 'dict'>
30406.9s 16919 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30406.9s 16920 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30406.9s 16921 [PERIODIC:1000] BC_GPU [Call #13387000] About to launch kernel
30406.9s 16922 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30406.9s 16923 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30406.9s 16924 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30407.3s 16925 [PROGRESS] Step 5650: t=1197.57/1200.00s (99.8%) | dt=0.2130s
30407.4s 16926 Stored output at t = 1200.0000 s (Step 5662)
30407.4s 16927 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1185.0/1200.0 [00:00<?, ?s/s][A
30407.4s 16928 [A
30407.4s 16929 
30407.4s 16930 Simulation finished at t = 1200.0000 s after 5662 steps.
30407.4s 16931 Total runtime: 0.63 seconds.
30407.4s 16932 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.93s/s]
30407.4s 16933 [REWARD_MICROSCOPE] step=14520 t=1200.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30407.4s 16934 [STEP   80] t= 1200.0s | phase=0 | reward=   0.01 | total_reward=    0.80
30407.4s 16935 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30407.4s 16936 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30407.4s 16937 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30407.4s 16938 Running simulation until t = 1215.00 s, outputting every 15.00 s
30407.4s 16939 
30407.4s 16940 [WARNING] Automatic CFL correction applied (count: 3346700):
30407.4s 16941 Calculated CFL: 0.800 > Limit: 0.500
30407.4s 16942 Original dt: 3.398708e-01 s
30407.4s 16943 Corrected dt: 2.124193e-01 s
30407.4s 16944 Correction factor: 1.6x
30407.4s 16945 Max wave speed detected: 23.54 m/s
30407.7s 16946 [PROGRESS] Step 5700: t=1208.07/1215.00s (99.4%) | dt=0.2125s
30408.0s 16947 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1200.0/1215.0 [00:00<?, ?s/s][A
30408.0s 16948 [A
30408.0s 16949 Stored output at t = 1215.0000 s (Step 5733)
30408.0s 16950 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.17s/s]
30408.0s 16951 
30408.0s 16952 Simulation finished at t = 1215.0000 s after 5733 steps.
30408.0s 16953 Total runtime: 0.62 seconds.
30408.0s 16954 [QUEUE_DIAGNOSTIC] ===== Step 80 t=1215.0s =====
30408.0s 16955 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30408.0s 16956 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30408.0s 16957 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30408.0s 16958 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30408.0s 16959 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30408.0s 16960 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30408.0s 16961 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30408.0s 16962 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30408.0s 16963 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30408.0s 16964 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30408.0s 16965 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30408.0s 16966 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30408.0s 16967 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30408.0s 16968 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30408.0s 16969 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30408.0s 16970 [REWARD_MICROSCOPE] step=14521 t=1215.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30408.0s 16971 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30408.0s 16972 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30408.0s 16973 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30408.0s 16974 Running simulation until t = 1230.00 s, outputting every 15.00 s
30408.0s 16975 
30408.2s 16976 [PROGRESS] Step 5750: t=1218.62/1230.00s (99.1%) | dt=0.2130s
30408.3s 16977 [WARNING] Automatic CFL correction applied (count: 3346800):
30408.3s 16978 Calculated CFL: 0.800 > Limit: 0.500
30408.3s 16979 Original dt: 3.409993e-01 s
30408.3s 16980 Corrected dt: 2.131246e-01 s
30408.3s 16981 Correction factor: 1.6x
30408.3s 16982 Max wave speed detected: 23.46 m/s
30408.6s 16983 [PROGRESS] Step 5800: t=1229.27/1230.00s (99.9%) | dt=0.2127s
30408.6s 16984 Stored output at t = 1230.0000 s (Step 5804)
30408.6s 16985 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1215.0/1230.0 [00:00<?, ?s/s][A
30408.6s 16986 [A
30408.6s 16987 
30408.6s 16988 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 23.96s/s]
30408.6s 16989 Simulation finished at t = 1230.0000 s after 5804 steps.
30408.6s 16990 Total runtime: 0.63 seconds.
30408.7s 16991 [REWARD_MICROSCOPE] step=14522 t=1230.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30408.7s 16992 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30408.7s 16993 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30408.7s 16994 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30408.7s 16995 Running simulation until t = 1245.00 s, outputting every 15.00 s
30408.7s 16996 
30409.1s 16997 [PROGRESS] Step 5850: t=1239.77/1245.00s (99.6%) | dt=0.2126s
30409.2s 16998 [PERIODIC:1000] BC_DISPATCHER [Call #13388000] current_bc_params: <class 'dict'>
30409.2s 16999 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30409.2s 17000 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30409.2s 17001 [PERIODIC:1000] BC_GPU [Call #13388000] About to launch kernel
30409.2s 17002 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30409.2s 17003 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30409.2s 17004 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30409.2s 17005 [WARNING] Automatic CFL correction applied (count: 3346900):
30409.2s 17006 Calculated CFL: 0.800 > Limit: 0.500
30409.2s 17007 Original dt: 3.404274e-01 s
30409.2s 17008 Corrected dt: 2.127671e-01 s
30409.2s 17009 Correction factor: 1.6x
30409.2s 17010 Max wave speed detected: 23.50 m/s
30409.3s 17011 Stored output at t = 1245.0000 s (Step 5875)
30409.3s 17012 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1230.0/1245.0 [00:00<?, ?s/s][A
30409.3s 17013 [A
30409.3s 17014 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.10s/s]
30409.3s 17015 
30409.3s 17016 Simulation finished at t = 1245.0000 s after 5875 steps.
30409.3s 17017 Total runtime: 0.65 seconds.
30409.3s 17018 [REWARD_MICROSCOPE] step=14523 t=1245.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30409.3s 17019 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30409.3s 17020 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30409.3s 17021 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30409.3s 17022 Running simulation until t = 1260.00 s, outputting every 15.00 s
30409.3s 17023 
30409.5s 17024 [PROGRESS] Step 5900: t=1250.32/1260.00s (99.2%) | dt=0.2130s
30409.9s 17025 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1245.0/1260.0 [00:00<?, ?s/s][A
30409.9s 17026 [A
30409.9s 17027 Stored output at t = 1260.0000 s (Step 5946)
30409.9s 17028 
30409.9s 17029 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.03s/s]
30409.9s 17030 Simulation finished at t = 1260.0000 s after 5946 steps.
30409.9s 17031 Total runtime: 0.62 seconds.
30409.9s 17032 [REWARD_MICROSCOPE] step=14524 t=1260.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30409.9s 17033 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30409.9s 17034 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30409.9s 17035 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30409.9s 17036 Running simulation until t = 1275.00 s, outputting every 15.00 s
30409.9s 17037 
30410.0s 17038 [PROGRESS] Step 5950: t=1260.85/1275.00s (98.9%) | dt=0.2124s
30410.1s 17039 [WARNING] Automatic CFL correction applied (count: 3347000):
30410.1s 17040 Calculated CFL: 0.800 > Limit: 0.500
30410.1s 17041 Original dt: 3.398278e-01 s
30410.1s 17042 Corrected dt: 2.123924e-01 s
30410.1s 17043 Correction factor: 1.6x
30410.1s 17044 Max wave speed detected: 23.54 m/s
30410.4s 17045 [PROGRESS] Step 6000: t=1271.47/1275.00s (99.7%) | dt=0.2127s
30410.6s 17046 Stored output at t = 1275.0000 s (Step 6017)
30410.6s 17047 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1260.0/1275.0 [00:00<?, ?s/s][A
30410.6s 17048 [A
30410.6s 17049 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.03s/s]
30410.6s 17050 
30410.6s 17051 Simulation finished at t = 1275.0000 s after 6017 steps.
30410.6s 17052 Total runtime: 0.62 seconds.
30410.6s 17053 [REWARD_MICROSCOPE] step=14525 t=1275.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30410.6s 17054 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30410.6s 17055 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30410.6s 17056 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30410.6s 17057 Running simulation until t = 1290.00 s, outputting every 15.00 s
30410.6s 17058 
30410.9s 17059 [PROGRESS] Step 6050: t=1282.03/1290.00s (99.4%) | dt=0.2131s
30411.0s 17060 [WARNING] Automatic CFL correction applied (count: 3347100):
30411.0s 17061 Calculated CFL: 0.800 > Limit: 0.500
30411.0s 17062 Original dt: 3.412149e-01 s
30411.0s 17063 Corrected dt: 2.132593e-01 s
30411.0s 17064 Correction factor: 1.6x
30411.0s 17065 Max wave speed detected: 23.45 m/s
30411.2s 17066 Stored output at t = 1290.0000 s (Step 6088)
30411.2s 17067 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1275.0/1290.0 [00:00<?, ?s/s][A
30411.2s 17068 [A
30411.2s 17069 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 22.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 22.84s/s]
30411.2s 17070 
30411.2s 17071 Simulation finished at t = 1290.0000 s after 6088 steps.
30411.2s 17072 Total runtime: 0.66 seconds.
30411.2s 17073 [REWARD_MICROSCOPE] step=14526 t=1290.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30411.2s 17074 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30411.2s 17075 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30411.2s 17076 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30411.2s 17077 Running simulation until t = 1305.00 s, outputting every 15.00 s
30411.2s 17078 
30411.3s 17079 [PROGRESS] Step 6100: t=1292.55/1305.00s (99.0%) | dt=0.2123s
30411.4s 17080 [PERIODIC:1000] BC_DISPATCHER [Call #13389000] current_bc_params: <class 'dict'>
30411.4s 17081 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30411.4s 17082 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30411.4s 17083 [PERIODIC:1000] BC_GPU [Call #13389000] About to launch kernel
30411.4s 17084 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30411.4s 17085 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30411.4s 17086 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30411.8s 17087 [PROGRESS] Step 6150: t=1303.18/1305.00s (99.9%) | dt=0.2128s
30411.8s 17088 Stored output at t = 1305.0000 s (Step 6159)
30411.8s 17089 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1290.0/1305.0 [00:00<?, ?s/s][A
30411.8s 17090 [A
30411.8s 17091 
30411.8s 17092 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.10s/s]
30411.8s 17093 Simulation finished at t = 1305.0000 s after 6159 steps.
30411.8s 17094 Total runtime: 0.62 seconds.
30411.8s 17095 [REWARD_MICROSCOPE] step=14527 t=1305.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30411.8s 17096 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30411.8s 17097 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30411.8s 17098 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30411.8s 17099 Running simulation until t = 1320.00 s, outputting every 15.00 s
30411.8s 17100 
30411.9s 17101 [WARNING] Automatic CFL correction applied (count: 3347200):
30411.9s 17102 Calculated CFL: 0.800 > Limit: 0.500
30411.9s 17103 Original dt: 3.406380e-01 s
30411.9s 17104 Corrected dt: 2.128988e-01 s
30411.9s 17105 Correction factor: 1.6x
30411.9s 17106 Max wave speed detected: 23.49 m/s
30412.2s 17107 [PROGRESS] Step 6200: t=1313.73/1320.00s (99.5%) | dt=0.2132s
30412.5s 17108 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1305.0/1320.0 [00:00<?, ?s/s][A
30412.5s 17109 Stored output at t = 1320.0000 s (Step 6230)
30412.5s 17110 [A
30412.5s 17111 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.52s/s]
30412.5s 17112 
30412.5s 17113 Simulation finished at t = 1320.0000 s after 6230 steps.
30412.5s 17114 Total runtime: 0.64 seconds.
30412.5s 17115 [REWARD_MICROSCOPE] step=14528 t=1320.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30412.5s 17116 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30412.5s 17117 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30412.5s 17118 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30412.5s 17119 Running simulation until t = 1335.00 s, outputting every 15.00 s
30412.5s 17120 
30412.7s 17121 [PROGRESS] Step 6250: t=1324.25/1335.00s (99.2%) | dt=0.2124s
30412.8s 17122 [WARNING] Automatic CFL correction applied (count: 3347300):
30412.8s 17123 Calculated CFL: 0.800 > Limit: 0.500
30412.8s 17124 Original dt: 3.400643e-01 s
30412.8s 17125 Corrected dt: 2.125402e-01 s
30412.8s 17126 Correction factor: 1.6x
30412.8s 17127 Max wave speed detected: 23.52 m/s
30413.1s 17128 [PROGRESS] Step 6300: t=1334.88/1335.00s (100.0%) | dt=0.2128s
30413.1s 17129 Stored output at t = 1335.0000 s (Step 6301)
30413.1s 17130 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1320.0/1335.0 [00:00<?, ?s/s][A
30413.1s 17131 [A
30413.1s 17132 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.78s/s]
30413.1s 17133 
30413.1s 17134 Simulation finished at t = 1335.0000 s after 6301 steps.
30413.1s 17135 Total runtime: 0.63 seconds.
30413.1s 17136 [REWARD_MICROSCOPE] step=14529 t=1335.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30413.1s 17137 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30413.1s 17138 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30413.1s 17139 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30413.1s 17140 Running simulation until t = 1350.00 s, outputting every 15.00 s
30413.1s 17141 
30413.5s 17142 [PROGRESS] Step 6350: t=1345.44/1350.00s (99.7%) | dt=0.2133s
30413.6s 17143 [PERIODIC:1000] BC_DISPATCHER [Call #13390000] current_bc_params: <class 'dict'>
30413.6s 17144 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30413.6s 17145 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30413.6s 17146 [PERIODIC:1000] BC_GPU [Call #13390000] About to launch kernel
30413.6s 17147 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30413.6s 17148 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30413.6s 17149 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30413.7s 17150 [WARNING] Automatic CFL correction applied (count: 3347400):
30413.7s 17151 Calculated CFL: 0.800 > Limit: 0.500
30413.7s 17152 Original dt: 3.403351e-01 s
30413.7s 17153 Corrected dt: 2.127094e-01 s
30413.7s 17154 Correction factor: 1.6x
30413.7s 17155 Max wave speed detected: 23.51 m/s
30413.7s 17156 Stored output at t = 1350.0000 s (Step 6372)
30413.7s 17157 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1335.0/1350.0 [00:00<?, ?s/s][A
30413.7s 17158 [A
30413.7s 17159 
30413.7s 17160 Simulation finished at t = 1350.0000 s after 6372 steps.
30413.7s 17161 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.25s/s]
30413.7s 17162 Total runtime: 0.62 seconds.
30413.7s 17163 [REWARD_MICROSCOPE] step=14530 t=1350.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30413.7s 17164 [STEP   90] t= 1350.0s | phase=0 | reward=   0.01 | total_reward=    0.90
30413.7s 17165 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30413.7s 17166 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30413.7s 17167 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30413.7s 17168 Running simulation until t = 1365.00 s, outputting every 15.00 s
30413.7s 17169 
30414.0s 17170 [PROGRESS] Step 6400: t=1355.95/1365.00s (99.3%) | dt=0.2125s
30414.4s 17171 Stored output at t = 1365.0000 s (Step 6443)
30414.4s 17172 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
30414.4s 17173 [A
30414.4s 17174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.20s/s]
30414.4s 17175 
30414.4s 17176 Simulation finished at t = 1365.0000 s after 6443 steps.
30414.4s 17177 Total runtime: 0.62 seconds.
30414.4s 17178 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
30414.4s 17179 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30414.4s 17180 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30414.4s 17181 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30414.4s 17182 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30414.4s 17183 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30414.4s 17184 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30414.4s 17185 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30414.4s 17186 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30414.4s 17187 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30414.4s 17188 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30414.4s 17189 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30414.4s 17190 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30414.4s 17191 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30414.4s 17192 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30414.4s 17193 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30414.4s 17194 [REWARD_MICROSCOPE] step=14531 t=1365.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30414.4s 17195 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30414.4s 17196 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30414.4s 17197 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30414.4s 17198 Running simulation until t = 1380.00 s, outputting every 15.00 s
30414.4s 17199 
30414.4s 17200 [PROGRESS] Step 6450: t=1366.49/1380.00s (99.0%) | dt=0.2129s
30414.6s 17201 [WARNING] Automatic CFL correction applied (count: 3347500):
30414.6s 17202 Calculated CFL: 0.800 > Limit: 0.500
30414.6s 17203 Original dt: 3.408612e-01 s
30414.6s 17204 Corrected dt: 2.130383e-01 s
30414.6s 17205 Correction factor: 1.6x
30414.6s 17206 Max wave speed detected: 23.47 m/s
30414.9s 17207 [PROGRESS] Step 6500: t=1377.15/1380.00s (99.8%) | dt=0.2131s
30415.0s 17208 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
30415.0s 17209 [A
30415.0s 17210 Stored output at t = 1380.0000 s (Step 6514)
30415.0s 17211 
30415.0s 17212 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 23.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 23.66s/s]
30415.0s 17213 Simulation finished at t = 1380.0000 s after 6514 steps.
30415.0s 17214 Total runtime: 0.63 seconds.
30415.0s 17215 [REWARD_MICROSCOPE] step=14532 t=1380.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30415.0s 17216 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30415.0s 17217 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30415.0s 17218 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30415.0s 17219 Running simulation until t = 1395.00 s, outputting every 15.00 s
30415.0s 17220 
30415.3s 17221 [PROGRESS] Step 6550: t=1387.65/1395.00s (99.5%) | dt=0.2125s
30415.5s 17222 [WARNING] Automatic CFL correction applied (count: 3347600):
30415.5s 17223 Calculated CFL: 0.800 > Limit: 0.500
30415.5s 17224 Original dt: 3.402871e-01 s
30415.5s 17225 Corrected dt: 2.126795e-01 s
30415.5s 17226 Correction factor: 1.6x
30415.5s 17227 Max wave speed detected: 23.51 m/s
30415.6s 17228 Stored output at t = 1395.0000 s (Step 6585)
30415.6s 17229 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
30415.6s 17230 [A
30415.6s 17231 
30415.6s 17232 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.42s/s]
30415.6s 17233 Simulation finished at t = 1395.0000 s after 6585 steps.
30415.6s 17234 Total runtime: 0.61 seconds.
30415.6s 17235 [REWARD_MICROSCOPE] step=14533 t=1395.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30415.6s 17236 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30415.6s 17237 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30415.6s 17238 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30415.6s 17239 Running simulation until t = 1410.00 s, outputting every 15.00 s
30415.6s 17240 
30415.8s 17241 [PROGRESS] Step 6600: t=1398.19/1410.00s (99.2%) | dt=0.2130s
30415.8s 17242 [PERIODIC:1000] BC_DISPATCHER [Call #13391000] current_bc_params: <class 'dict'>
30415.8s 17243 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30415.8s 17244 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30415.8s 17245 [PERIODIC:1000] BC_GPU [Call #13391000] About to launch kernel
30415.8s 17246 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30415.8s 17247 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30415.8s 17248 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30416.2s 17249 [PROGRESS] Step 6650: t=1408.85/1410.00s (99.9%) | dt=0.2127s
30416.2s 17250 Stored output at t = 1410.0000 s (Step 6656)
30416.2s 17251 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
30416.2s 17252 [A
30416.2s 17253 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.00s/s]
30416.2s 17254 
30416.2s 17255 Simulation finished at t = 1410.0000 s after 6656 steps.
30416.2s 17256 Total runtime: 0.63 seconds.
30416.2s 17257 [REWARD_MICROSCOPE] step=14534 t=1410.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30416.2s 17258 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30416.2s 17259 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30416.2s 17260 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30416.2s 17261 Running simulation until t = 1425.00 s, outputting every 15.00 s
30416.2s 17262 
30416.3s 17263 [WARNING] Automatic CFL correction applied (count: 3347700):
30416.3s 17264 Calculated CFL: 0.800 > Limit: 0.500
30416.3s 17265 Original dt: 3.397169e-01 s
30416.3s 17266 Corrected dt: 2.123230e-01 s
30416.3s 17267 Correction factor: 1.6x
30416.3s 17268 Max wave speed detected: 23.55 m/s
30416.6s 17269 [PROGRESS] Step 6700: t=1419.35/1425.00s (99.6%) | dt=0.2126s
30416.9s 17270 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
30416.9s 17271 [A
30416.9s 17272 Stored output at t = 1425.0000 s (Step 6727)
30416.9s 17273 
30416.9s 17274 Simulation finished at t = 1425.0000 s after 6727 steps.
30416.9s 17275 Total runtime: 0.62 seconds.
30416.9s 17276 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.27s/s]
30416.9s 17277 [REWARD_MICROSCOPE] step=14535 t=1425.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30416.9s 17278 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30416.9s 17279 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30416.9s 17280 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30416.9s 17281 Running simulation until t = 1440.00 s, outputting every 15.00 s
30416.9s 17282 
30417.1s 17283 [PROGRESS] Step 6750: t=1429.90/1440.00s (99.3%) | dt=0.2130s
30417.2s 17284 [WARNING] Automatic CFL correction applied (count: 3347800):
30417.2s 17285 Calculated CFL: 0.800 > Limit: 0.500
30417.2s 17286 Original dt: 3.410795e-01 s
30417.2s 17287 Corrected dt: 2.131747e-01 s
30417.2s 17288 Correction factor: 1.6x
30417.2s 17289 Max wave speed detected: 23.45 m/s
30417.5s 17290 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
30417.5s 17291 Stored output at t = 1440.0000 s (Step 6798)
30417.5s 17292 [A
30417.5s 17293 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.10s/s]
30417.5s 17294 
30417.5s 17295 Simulation finished at t = 1440.0000 s after 6798 steps.
30417.5s 17296 Total runtime: 0.62 seconds.
30417.5s 17297 [REWARD_MICROSCOPE] step=14536 t=1440.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30417.5s 17298 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30417.5s 17299 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30417.5s 17300 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30417.5s 17301 Running simulation until t = 1455.00 s, outputting every 15.00 s
30417.5s 17302 
30417.5s 17303 [PROGRESS] Step 6800: t=1440.43/1455.00s (99.0%) | dt=0.2125s
30417.9s 17304 [PROGRESS] Step 6850: t=1451.05/1455.00s (99.7%) | dt=0.2127s
30418.0s 17305 [PERIODIC:1000] BC_DISPATCHER [Call #13392000] current_bc_params: <class 'dict'>
30418.0s 17306 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30418.0s 17307 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30418.0s 17308 [PERIODIC:1000] BC_GPU [Call #13392000] About to launch kernel
30418.0s 17309 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30418.0s 17310 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30418.0s 17311 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30418.1s 17312 [WARNING] Automatic CFL correction applied (count: 3347900):
30418.1s 17313 Calculated CFL: 0.800 > Limit: 0.500
30418.1s 17314 Original dt: 3.405090e-01 s
30418.1s 17315 Corrected dt: 2.128181e-01 s
30418.1s 17316 Correction factor: 1.6x
30418.1s 17317 Max wave speed detected: 23.49 m/s
30418.1s 17318 Stored output at t = 1455.0000 s (Step 6869)
30418.1s 17319 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
30418.1s 17320 [A
30418.1s 17321 
30418.1s 17322 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.74s/s]
30418.1s 17323 Simulation finished at t = 1455.0000 s after 6869 steps.
30418.1s 17324 Total runtime: 0.63 seconds.
30418.1s 17325 [REWARD_MICROSCOPE] step=14537 t=1455.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30418.1s 17326 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30418.1s 17327 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30418.1s 17328 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30418.1s 17329 Running simulation until t = 1470.00 s, outputting every 15.00 s
30418.1s 17330 
30418.4s 17331 [PROGRESS] Step 6900: t=1461.60/1470.00s (99.4%) | dt=0.2131s
30418.8s 17332 Stored output at t = 1470.0000 s (Step 6940)
30418.8s 17333 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
30418.8s 17334 [A
30418.8s 17335 
30418.8s 17336 Simulation finished at t = 1470.0000 s after 6940 steps.
30418.8s 17337 Total runtime: 0.64 seconds.
30418.8s 17338 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 23.63s/s]
30418.8s 17339 [REWARD_MICROSCOPE] step=14538 t=1470.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30418.8s 17340 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30418.8s 17341 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30418.8s 17342 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30418.8s 17343 Running simulation until t = 1485.00 s, outputting every 15.00 s
30418.8s 17344 
30418.9s 17345 [PROGRESS] Step 6950: t=1472.12/1485.00s (99.1%) | dt=0.2123s
30419.0s 17346 [WARNING] Automatic CFL correction applied (count: 3348000):
30419.0s 17347 Calculated CFL: 0.800 > Limit: 0.500
30419.0s 17348 Original dt: 3.399193e-01 s
30419.0s 17349 Corrected dt: 2.124495e-01 s
30419.0s 17350 Correction factor: 1.6x
30419.0s 17351 Max wave speed detected: 23.53 m/s
30419.3s 17352 [PROGRESS] Step 7000: t=1482.75/1485.00s (99.8%) | dt=0.2127s
30419.4s 17353 Stored output at t = 1485.0000 s (Step 7011)
30419.4s 17354 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
30419.4s 17355 [A
30419.4s 17356 
30419.4s 17357 Simulation finished at t = 1485.0000 s after 7011 steps.
30419.4s 17358 Total runtime: 0.64 seconds.
30419.4s 17359 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 23.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 23.55s/s]
30419.4s 17360 [REWARD_MICROSCOPE] step=14539 t=1485.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30419.4s 17361 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30419.4s 17362 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30419.4s 17363 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30419.4s 17364 Running simulation until t = 1500.00 s, outputting every 15.00 s
30419.4s 17365 
30419.7s 17366 [PROGRESS] Step 7050: t=1493.31/1500.00s (99.6%) | dt=0.2132s
30419.9s 17367 [WARNING] Automatic CFL correction applied (count: 3348100):
30419.9s 17368 Calculated CFL: 0.800 > Limit: 0.500
30419.9s 17369 Original dt: 3.411066e-01 s
30419.9s 17370 Corrected dt: 2.131916e-01 s
30419.9s 17371 Correction factor: 1.6x
30419.9s 17372 Max wave speed detected: 23.45 m/s
30420.0s 17373 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
30420.0s 17374 [A
30420.0s 17375 Stored output at t = 1500.0000 s (Step 7082)
30420.0s 17376 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 23.81s/s]
30420.0s 17377 
30420.0s 17378 Simulation finished at t = 1500.0000 s after 7082 steps.
30420.0s 17379 Total runtime: 0.63 seconds.
30420.0s 17380 [REWARD_MICROSCOPE] step=14540 t=1500.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30420.0s 17381 [STEP  100] t= 1500.0s | phase=0 | reward=   0.01 | total_reward=    1.00
30420.0s 17382 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30420.0s 17383 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30420.0s 17384 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30420.0s 17385 Running simulation until t = 1515.00 s, outputting every 15.00 s
30420.0s 17386 
30420.2s 17387 [PROGRESS] Step 7100: t=1503.82/1515.00s (99.3%) | dt=0.2124s
30420.3s 17388 [PERIODIC:1000] BC_DISPATCHER [Call #13393000] current_bc_params: <class 'dict'>
30420.3s 17389 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30420.3s 17390 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30420.3s 17391 [PERIODIC:1000] BC_GPU [Call #13393000] About to launch kernel
30420.3s 17392 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30420.3s 17393 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30420.3s 17394 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30420.6s 17395 [PROGRESS] Step 7150: t=1514.45/1515.00s (100.0%) | dt=0.2128s
30420.7s 17396 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
30420.7s 17397 [A
30420.7s 17398 Stored output at t = 1515.0000 s (Step 7153)
30420.7s 17399 
30420.7s 17400 Simulation finished at t = 1515.0000 s after 7153 steps.
30420.7s 17401 Total runtime: 0.63 seconds.
30420.7s 17402 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 23.78s/s]
30420.7s 17403 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
30420.7s 17404 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30420.7s 17405 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30420.7s 17406 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30420.7s 17407 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30420.7s 17408 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30420.7s 17409 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30420.7s 17410 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30420.7s 17411 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30420.7s 17412 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30420.7s 17413 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30420.7s 17414 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30420.7s 17415 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30420.7s 17416 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30420.7s 17417 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30420.7s 17418 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30420.7s 17419 [REWARD_MICROSCOPE] step=14541 t=1515.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30420.7s 17420 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30420.7s 17421 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30420.7s 17422 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30420.7s 17423 Running simulation until t = 1530.00 s, outputting every 15.00 s
30420.7s 17424 
30420.8s 17425 [WARNING] Automatic CFL correction applied (count: 3348200):
30420.8s 17426 Calculated CFL: 0.800 > Limit: 0.500
30420.8s 17427 Original dt: 3.407212e-01 s
30420.8s 17428 Corrected dt: 2.129508e-01 s
30420.8s 17429 Correction factor: 1.6x
30420.8s 17430 Max wave speed detected: 23.48 m/s
30421.1s 17431 [PROGRESS] Step 7200: t=1525.01/1530.00s (99.7%) | dt=0.2132s
30421.3s 17432 Stored output at t = 1530.0000 s (Step 7224)
30421.3s 17433 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
30421.3s 17434 [A
30421.3s 17435 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 23.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 23.16s/s]
30421.3s 17436 
30421.3s 17437 Simulation finished at t = 1530.0000 s after 7224 steps.
30421.3s 17438 Total runtime: 0.65 seconds.
30421.3s 17439 [REWARD_MICROSCOPE] step=14542 t=1530.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30421.3s 17440 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30421.3s 17441 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30421.3s 17442 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30421.3s 17443 Running simulation until t = 1545.00 s, outputting every 15.00 s
30421.3s 17444 
30421.5s 17445 [PROGRESS] Step 7250: t=1535.52/1545.00s (99.4%) | dt=0.2124s
30421.7s 17446 [WARNING] Automatic CFL correction applied (count: 3348300):
30421.7s 17447 Calculated CFL: 0.800 > Limit: 0.500
30421.7s 17448 Original dt: 3.401477e-01 s
30421.7s 17449 Corrected dt: 2.125923e-01 s
30421.7s 17450 Correction factor: 1.6x
30421.7s 17451 Max wave speed detected: 23.52 m/s
30422.0s 17452 Stored output at t = 1545.0000 s (Step 7295)
30422.0s 17453 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
30422.0s 17454 [A
30422.0s 17455 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.87s/s]
30422.0s 17456 
30422.0s 17457 Simulation finished at t = 1545.0000 s after 7295 steps.
30422.0s 17458 Total runtime: 0.63 seconds.
30422.0s 17459 [REWARD_MICROSCOPE] step=14543 t=1545.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30422.0s 17460 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30422.0s 17461 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30422.0s 17462 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30422.0s 17463 Running simulation until t = 1560.00 s, outputting every 15.00 s
30422.0s 17464 
30422.0s 17465 [PROGRESS] Step 7300: t=1546.06/1560.00s (99.1%) | dt=0.2129s
30422.4s 17466 [PROGRESS] Step 7350: t=1556.72/1560.00s (99.8%) | dt=0.2133s
30422.5s 17467 [PERIODIC:1000] BC_DISPATCHER [Call #13394000] current_bc_params: <class 'dict'>
30422.5s 17468 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30422.5s 17469 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30422.5s 17470 [PERIODIC:1000] BC_GPU [Call #13394000] About to launch kernel
30422.5s 17471 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30422.5s 17472 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30422.5s 17473 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30422.6s 17474 Stored output at t = 1560.0000 s (Step 7366)
30422.6s 17475 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
30422.6s 17476 [A
30422.6s 17477 
30422.6s 17478 Simulation finished at t = 1560.0000 s after 7366 steps.
30422.6s 17479 Total runtime: 0.61 seconds.
30422.6s 17480 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.42s/s]
30422.6s 17481 [REWARD_MICROSCOPE] step=14544 t=1560.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30422.6s 17482 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30422.6s 17483 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30422.6s 17484 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30422.6s 17485 Running simulation until t = 1575.00 s, outputting every 15.00 s
30422.6s 17486 
30422.6s 17487 [WARNING] Automatic CFL correction applied (count: 3348400):
30422.6s 17488 Calculated CFL: 0.800 > Limit: 0.500
30422.6s 17489 Original dt: 3.400436e-01 s
30422.6s 17490 Corrected dt: 2.125273e-01 s
30422.6s 17491 Correction factor: 1.6x
30422.6s 17492 Max wave speed detected: 23.53 m/s
30422.9s 17493 [PROGRESS] Step 7400: t=1567.22/1575.00s (99.5%) | dt=0.2125s
30423.2s 17494 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
30423.2s 17495 Stored output at t = 1575.0000 s (Step 7437)
30423.2s 17496 [A
30423.2s 17497 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 24.04s/s]
30423.2s 17498 
30423.2s 17499 Simulation finished at t = 1575.0000 s after 7437 steps.
30423.2s 17500 Total runtime: 0.62 seconds.
30423.2s 17501 [REWARD_MICROSCOPE] step=14545 t=1575.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30423.2s 17502 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30423.2s 17503 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30423.2s 17504 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30423.2s 17505 Running simulation until t = 1590.00 s, outputting every 15.00 s
30423.2s 17506 
30423.3s 17507 [PROGRESS] Step 7450: t=1577.77/1590.00s (99.2%) | dt=0.2129s
30423.5s 17508 [WARNING] Automatic CFL correction applied (count: 3348500):
30423.5s 17509 Calculated CFL: 0.800 > Limit: 0.500
30423.5s 17510 Original dt: 3.409462e-01 s
30423.5s 17511 Corrected dt: 2.130914e-01 s
30423.5s 17512 Correction factor: 1.6x
30423.5s 17513 Max wave speed detected: 23.46 m/s
30423.7s 17514 [PROGRESS] Step 7500: t=1588.42/1590.00s (99.9%) | dt=0.2128s
30423.8s 17515 Stored output at t = 1590.0000 s (Step 7508)
30423.8s 17516 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
30423.8s 17517 [A
30423.8s 17518 
30423.8s 17519 Simulation finished at t = 1590.0000 s after 7508 steps.
30423.8s 17520 Total runtime: 0.62 seconds.
30423.8s 17521 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 24.13s/s]
30423.8s 17522 [REWARD_MICROSCOPE] step=14546 t=1590.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30423.8s 17523 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30423.8s 17524 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30423.8s 17525 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30423.8s 17526 Running simulation until t = 1605.00 s, outputting every 15.00 s
30423.8s 17527 
30424.2s 17528 [PROGRESS] Step 7550: t=1598.92/1605.00s (99.6%) | dt=0.2126s
30424.3s 17529 [WARNING] Automatic CFL correction applied (count: 3348600):
30424.3s 17530 Calculated CFL: 0.800 > Limit: 0.500
30424.3s 17531 Original dt: 3.403711e-01 s
30424.3s 17532 Corrected dt: 2.127320e-01 s
30424.3s 17533 Correction factor: 1.6x
30424.3s 17534 Max wave speed detected: 23.50 m/s
30424.5s 17535 Stored output at t = 1605.0000 s (Step 7579)
30424.5s 17536 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
30424.5s 17537 [A
30424.5s 17538 
30424.5s 17539 Simulation finished at t = 1605.0000 s after 7579 steps.
30424.5s 17540 Total runtime: 0.64 seconds.
30424.5s 17541 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 23.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 23.62s/s]
30424.5s 17542 [REWARD_MICROSCOPE] step=14547 t=1605.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30424.5s 17543 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30424.5s 17544 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30424.5s 17545 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30424.5s 17546 Running simulation until t = 1620.00 s, outputting every 15.00 s
30424.5s 17547 
30424.6s 17548 [PROGRESS] Step 7600: t=1609.47/1620.00s (99.4%) | dt=0.2130s
30424.7s 17549 [PERIODIC:1000] BC_DISPATCHER [Call #13395000] current_bc_params: <class 'dict'>
30424.7s 17550 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30424.7s 17551 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30424.7s 17552 [PERIODIC:1000] BC_GPU [Call #13395000] About to launch kernel
30424.7s 17553 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30424.7s 17554 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30424.7s 17555 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30425.1s 17556 [PROGRESS] Step 7650: t=1620.00/1620.00s (100.0%) | dt=0.0883s
30425.1s 17557 Stored output at t = 1620.0000 s (Step 7650)
30425.1s 17558 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
30425.1s 17559 [A
30425.1s 17560 
30425.1s 17561 Simulation finished at t = 1620.0000 s after 7650 steps.
30425.1s 17562 Total runtime: 0.63 seconds.
30425.1s 17563 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.95s/s]
30425.1s 17564 [REWARD_MICROSCOPE] step=14548 t=1620.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30425.1s 17565 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30425.1s 17566 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30425.1s 17567 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30425.1s 17568 Running simulation until t = 1635.00 s, outputting every 15.00 s
30425.1s 17569 
30425.2s 17570 [WARNING] Automatic CFL correction applied (count: 3348700):
30425.2s 17571 Calculated CFL: 0.800 > Limit: 0.500
30425.2s 17572 Original dt: 3.397675e-01 s
30425.2s 17573 Corrected dt: 2.123547e-01 s
30425.2s 17574 Correction factor: 1.6x
30425.2s 17575 Max wave speed detected: 23.55 m/s
30425.5s 17576 [PROGRESS] Step 7700: t=1630.62/1635.00s (99.7%) | dt=0.2127s
30425.7s 17577 Stored output at t = 1635.0000 s (Step 7721)
30425.7s 17578 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
30425.7s 17579 [A
30425.7s 17580 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.15s/s]
30425.7s 17581 
30425.7s 17582 Simulation finished at t = 1635.0000 s after 7721 steps.
30425.7s 17583 Total runtime: 0.65 seconds.
30425.7s 17584 [REWARD_MICROSCOPE] step=14549 t=1635.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30425.7s 17585 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30425.7s 17586 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30425.7s 17587 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30425.7s 17588 Running simulation until t = 1650.00 s, outputting every 15.00 s
30425.7s 17589 
30426.0s 17590 [PROGRESS] Step 7750: t=1641.18/1650.00s (99.5%) | dt=0.2131s
30426.1s 17591 [WARNING] Automatic CFL correction applied (count: 3348800):
30426.1s 17592 Calculated CFL: 0.800 > Limit: 0.500
30426.1s 17593 Original dt: 3.411605e-01 s
30426.1s 17594 Corrected dt: 2.132253e-01 s
30426.1s 17595 Correction factor: 1.6x
30426.1s 17596 Max wave speed detected: 23.45 m/s
30426.4s 17597 Stored output at t = 1650.0000 s (Step 7792)
30426.4s 17598 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
30426.4s 17599 [A
30426.4s 17600 
30426.4s 17601 Simulation finished at t = 1650.0000 s after 7792 steps.
30426.4s 17602 Total runtime: 0.63 seconds.
30426.4s 17603 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.00s/s]
30426.4s 17604 [REWARD_MICROSCOPE] step=14550 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30426.4s 17605 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    1.10
30426.4s 17606 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30426.4s 17607 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30426.4s 17608 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30426.4s 17609 Running simulation until t = 1665.00 s, outputting every 15.00 s
30426.4s 17610 
30426.4s 17611 [PROGRESS] Step 7800: t=1651.70/1665.00s (99.2%) | dt=0.2124s
30426.9s 17612 [PROGRESS] Step 7850: t=1662.32/1665.00s (99.8%) | dt=0.2127s
30427.0s 17613 [PERIODIC:1000] BC_DISPATCHER [Call #13396000] current_bc_params: <class 'dict'>
30427.0s 17614 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30427.0s 17615 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30427.0s 17616 [PERIODIC:1000] BC_GPU [Call #13396000] About to launch kernel
30427.0s 17617 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30427.0s 17618 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30427.0s 17619 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30427.0s 17620 Stored output at t = 1665.0000 s (Step 7863)
30427.0s 17621 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
30427.0s 17622 [A
30427.0s 17623 
30427.0s 17624 Simulation finished at t = 1665.0000 s after 7863 steps.
30427.0s 17625 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.00s/s]
30427.0s 17626 Total runtime: 0.63 seconds.
30427.0s 17627 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
30427.0s 17628 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30427.0s 17629 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30427.0s 17630 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30427.0s 17631 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30427.0s 17632 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30427.0s 17633 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30427.0s 17634 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30427.0s 17635 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30427.0s 17636 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30427.0s 17637 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30427.0s 17638 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30427.0s 17639 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30427.0s 17640 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30427.0s 17641 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30427.0s 17642 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30427.0s 17643 [REWARD_MICROSCOPE] step=14551 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30427.0s 17644 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30427.0s 17645 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30427.0s 17646 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30427.0s 17647 Running simulation until t = 1680.00 s, outputting every 15.00 s
30427.0s 17648 
30427.0s 17649 [WARNING] Automatic CFL correction applied (count: 3348900):
30427.0s 17650 Calculated CFL: 0.800 > Limit: 0.500
30427.0s 17651 Original dt: 3.405828e-01 s
30427.0s 17652 Corrected dt: 2.128643e-01 s
30427.0s 17653 Correction factor: 1.6x
30427.0s 17654 Max wave speed detected: 23.49 m/s
30427.3s 17655 [PROGRESS] Step 7900: t=1672.88/1680.00s (99.6%) | dt=0.2131s
30427.6s 17656 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
30427.6s 17657 [A
30427.6s 17658 Stored output at t = 1680.0000 s (Step 7934)
30427.6s 17659 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.12s/s]
30427.6s 17660 
30427.6s 17661 Simulation finished at t = 1680.0000 s after 7934 steps.
30427.6s 17662 Total runtime: 0.62 seconds.
30427.6s 17663 [REWARD_MICROSCOPE] step=14552 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30427.6s 17664 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30427.6s 17665 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30427.6s 17666 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30427.6s 17667 Running simulation until t = 1695.00 s, outputting every 15.00 s
30427.6s 17668 
30427.8s 17669 [PROGRESS] Step 7950: t=1683.40/1695.00s (99.3%) | dt=0.2123s
30427.9s 17670 [WARNING] Automatic CFL correction applied (count: 3349000):
30427.9s 17671 Calculated CFL: 0.800 > Limit: 0.500
30427.9s 17672 Original dt: 3.400085e-01 s
30427.9s 17673 Corrected dt: 2.125053e-01 s
30427.9s 17674 Correction factor: 1.6x
30427.9s 17675 Max wave speed detected: 23.53 m/s
30428.2s 17676 [PROGRESS] Step 8000: t=1694.03/1695.00s (99.9%) | dt=0.2128s
30428.3s 17677 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
30428.3s 17678 [A
30428.3s 17679 Stored output at t = 1695.0000 s (Step 8005)
30428.3s 17680 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 23.05s/s]
30428.3s 17681 
30428.3s 17682 Simulation finished at t = 1695.0000 s after 8005 steps.
30428.3s 17683 Total runtime: 0.65 seconds.
30428.3s 17684 [REWARD_MICROSCOPE] step=14553 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30428.3s 17685 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30428.3s 17686 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30428.3s 17687 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30428.3s 17688 Running simulation until t = 1710.00 s, outputting every 15.00 s
30428.3s 17689 
30428.7s 17690 [PROGRESS] Step 8050: t=1704.59/1710.00s (99.7%) | dt=0.2132s
30428.8s 17691 [WARNING] Automatic CFL correction applied (count: 3349100):
30428.8s 17692 Calculated CFL: 0.800 > Limit: 0.500
30428.8s 17693 Original dt: 3.406020e-01 s
30428.8s 17694 Corrected dt: 2.128763e-01 s
30428.8s 17695 Correction factor: 1.6x
30428.8s 17696 Max wave speed detected: 23.49 m/s
30428.9s 17697 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
30428.9s 17698 [A
30428.9s 17699 Stored output at t = 1710.0000 s (Step 8076)
30428.9s 17700 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 23.99s/s]
30428.9s 17701 
30428.9s 17702 Simulation finished at t = 1710.0000 s after 8076 steps.
30428.9s 17703 Total runtime: 0.63 seconds.
30428.9s 17704 [REWARD_MICROSCOPE] step=14554 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30428.9s 17705 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30428.9s 17706 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30428.9s 17707 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30428.9s 17708 Running simulation until t = 1725.00 s, outputting every 15.00 s
30428.9s 17709 
30429.1s 17710 [PROGRESS] Step 8100: t=1715.10/1725.00s (99.4%) | dt=0.2124s
30429.2s 17711 [PERIODIC:1000] BC_DISPATCHER [Call #13397000] current_bc_params: <class 'dict'>
30429.2s 17712 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30429.2s 17713 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30429.2s 17714 [PERIODIC:1000] BC_GPU [Call #13397000] About to launch kernel
30429.2s 17715 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30429.2s 17716 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30429.2s 17717 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30429.6s 17718 Stored output at t = 1725.0000 s (Step 8147)
30429.6s 17719 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
30429.6s 17720 [A
30429.6s 17721 
30429.6s 17722 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 22.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 22.82s/s]
30429.6s 17723 Simulation finished at t = 1725.0000 s after 8147 steps.
30429.6s 17724 Total runtime: 0.66 seconds.
30429.6s 17725 [REWARD_MICROSCOPE] step=14555 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30429.6s 17726 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30429.6s 17727 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30429.6s 17728 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30429.6s 17729 Running simulation until t = 1740.00 s, outputting every 15.00 s
30429.6s 17730 
30429.6s 17731 [PROGRESS] Step 8150: t=1725.64/1740.00s (99.2%) | dt=0.2129s
30429.7s 17732 [WARNING] Automatic CFL correction applied (count: 3349200):
30429.7s 17733 Calculated CFL: 0.800 > Limit: 0.500
30429.7s 17734 Original dt: 3.408050e-01 s
30429.7s 17735 Corrected dt: 2.130031e-01 s
30429.7s 17736 Correction factor: 1.6x
30429.7s 17737 Max wave speed detected: 23.47 m/s
30430.0s 17738 [PROGRESS] Step 8200: t=1736.29/1740.00s (99.8%) | dt=0.2133s
30430.2s 17739 Stored output at t = 1740.0000 s (Step 8218)
30430.2s 17740 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
30430.2s 17741 [A
30430.2s 17742 
30430.2s 17743 Simulation finished at t = 1740.0000 s after 8218 steps.
30430.2s 17744 Total runtime: 0.63 seconds.
30430.2s 17745 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 23.78s/s]
30430.2s 17746 [REWARD_MICROSCOPE] step=14556 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30430.2s 17747 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30430.2s 17748 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30430.2s 17749 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30430.2s 17750 Running simulation until t = 1755.00 s, outputting every 15.00 s
30430.2s 17751 
30430.5s 17752 [PROGRESS] Step 8250: t=1746.80/1755.00s (99.5%) | dt=0.2125s
30430.6s 17753 [WARNING] Automatic CFL correction applied (count: 3349300):
30430.6s 17754 Calculated CFL: 0.800 > Limit: 0.500
30430.6s 17755 Original dt: 3.402313e-01 s
30430.6s 17756 Corrected dt: 2.126446e-01 s
30430.6s 17757 Correction factor: 1.6x
30430.6s 17758 Max wave speed detected: 23.51 m/s
30430.9s 17759 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
30430.9s 17760 [A
30430.9s 17761 Stored output at t = 1755.0000 s (Step 8289)
30430.9s 17762 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 23.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 23.03s/s]
30430.9s 17763 
30430.9s 17764 Simulation finished at t = 1755.0000 s after 8289 steps.
30430.9s 17765 Total runtime: 0.65 seconds.
30430.9s 17766 [REWARD_MICROSCOPE] step=14557 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30430.9s 17767 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30430.9s 17768 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30430.9s 17769 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30430.9s 17770 Running simulation until t = 1770.00 s, outputting every 15.00 s
30430.9s 17771 
30431.0s 17772 [PROGRESS] Step 8300: t=1757.34/1770.00s (99.3%) | dt=0.2129s
30431.4s 17773 [PROGRESS] Step 8350: t=1768.00/1770.00s (99.9%) | dt=0.2129s
30431.5s 17774 Stored output at t = 1770.0000 s (Step 8360)
30431.5s 17775 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
30431.5s 17776 [A
30431.5s 17777 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.88s/s]
30431.5s 17778 
30431.5s 17779 Simulation finished at t = 1770.0000 s after 8360 steps.
30431.5s 17780 Total runtime: 0.63 seconds.
30431.5s 17781 [REWARD_MICROSCOPE] step=14558 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30431.5s 17782 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30431.5s 17783 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30431.5s 17784 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30431.5s 17785 Running simulation until t = 1785.00 s, outputting every 15.00 s
30431.5s 17786 
30431.5s 17787 [PERIODIC:1000] BC_DISPATCHER [Call #13398000] current_bc_params: <class 'dict'>
30431.5s 17788 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30431.5s 17789 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30431.5s 17790 [PERIODIC:1000] BC_GPU [Call #13398000] About to launch kernel
30431.5s 17791 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30431.5s 17792 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30431.5s 17793 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30431.5s 17794 [WARNING] Automatic CFL correction applied (count: 3349400):
30431.5s 17795 Calculated CFL: 0.800 > Limit: 0.500
30431.5s 17796 Original dt: 3.398030e-01 s
30431.5s 17797 Corrected dt: 2.123769e-01 s
30431.5s 17798 Correction factor: 1.6x
30431.5s 17799 Max wave speed detected: 23.54 m/s
30431.8s 17800 [PROGRESS] Step 8400: t=1778.50/1785.00s (99.6%) | dt=0.2126s
30432.1s 17801 Stored output at t = 1785.0000 s (Step 8431)
30432.1s 17802 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
30432.1s 17803 [A
30432.1s 17804 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 23.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 23.68s/s]
30432.1s 17805 
30432.1s 17806 Simulation finished at t = 1785.0000 s after 8431 steps.
30432.1s 17807 Total runtime: 0.63 seconds.
30432.1s 17808 [REWARD_MICROSCOPE] step=14559 t=1785.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30432.1s 17809 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30432.1s 17810 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30432.1s 17811 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30432.1s 17812 Running simulation until t = 1800.00 s, outputting every 15.00 s
30432.1s 17813 
30432.3s 17814 [PROGRESS] Step 8450: t=1789.05/1800.00s (99.4%) | dt=0.2130s
30432.4s 17815 [WARNING] Automatic CFL correction applied (count: 3349500):
30432.4s 17816 Calculated CFL: 0.800 > Limit: 0.500
30432.4s 17817 Original dt: 3.410260e-01 s
30432.4s 17818 Corrected dt: 2.131412e-01 s
30432.4s 17819 Correction factor: 1.6x
30432.4s 17820 Max wave speed detected: 23.46 m/s
30432.7s 17821 [PROGRESS] Step 8500: t=1799.70/1800.00s (100.0%) | dt=0.2126s
30432.7s 17822 Stored output at t = 1800.0000 s (Step 8502)
30432.7s 17823 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
30432.7s 17824 [A
30432.7s 17825 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.30s/s]
30432.7s 17826 
30432.7s 17827 Simulation finished at t = 1800.0000 s after 8502 steps.
30432.7s 17828 Total runtime: 0.62 seconds.
30432.7s 17829 [REWARD_MICROSCOPE] step=14560 t=1800.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30432.7s 17830 [STEP  120] t= 1800.0s | phase=0 | reward=   0.01 | total_reward=    1.20
30432.7s 17831 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30432.7s 17832 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30432.7s 17833 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30432.7s 17834 Running simulation until t = 1815.00 s, outputting every 15.00 s
30432.7s 17835 
30433.2s 17836 [PROGRESS] Step 8550: t=1810.20/1815.00s (99.7%) | dt=0.2126s
30433.3s 17837 [WARNING] Automatic CFL correction applied (count: 3349600):
30433.3s 17838 Calculated CFL: 0.800 > Limit: 0.500
30433.3s 17839 Original dt: 3.404547e-01 s
30433.3s 17840 Corrected dt: 2.127842e-01 s
30433.3s 17841 Correction factor: 1.6x
30433.3s 17842 Max wave speed detected: 23.50 m/s
30433.4s 17843 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
30433.4s 17844 [A
30433.4s 17845 Stored output at t = 1815.0000 s (Step 8573)
30433.4s 17846 
30433.4s 17847 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 23.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 23.02s/s]
30433.4s 17848 Simulation finished at t = 1815.0000 s after 8573 steps.
30433.4s 17849 Total runtime: 0.65 seconds.
30433.4s 17850 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
30433.4s 17851 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30433.4s 17852 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30433.4s 17853 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30433.4s 17854 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30433.4s 17855 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30433.4s 17856 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30433.4s 17857 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30433.4s 17858 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30433.4s 17859 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30433.4s 17860 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30433.4s 17861 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30433.4s 17862 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30433.4s 17863 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30433.4s 17864 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30433.4s 17865 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30433.4s 17866 [REWARD_MICROSCOPE] step=14561 t=1815.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30433.4s 17867 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30433.4s 17868 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30433.4s 17869 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30433.4s 17870 Running simulation until t = 1830.00 s, outputting every 15.00 s
30433.4s 17871 
30433.6s 17872 [PROGRESS] Step 8600: t=1820.75/1830.00s (99.5%) | dt=0.2131s
30433.7s 17873 [PERIODIC:1000] BC_DISPATCHER [Call #13399000] current_bc_params: <class 'dict'>
30433.7s 17874 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30433.7s 17875 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30433.7s 17876 [PERIODIC:1000] BC_GPU [Call #13399000] About to launch kernel
30433.7s 17877 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30433.7s 17878 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30433.7s 17879 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30434.0s 17880 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
30434.0s 17881 [A
30434.0s 17882 Stored output at t = 1830.0000 s (Step 8644)
30434.0s 17883 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.18s/s]
30434.0s 17884 
30434.0s 17885 Simulation finished at t = 1830.0000 s after 8644 steps.
30434.0s 17886 Total runtime: 0.62 seconds.
30434.0s 17887 [REWARD_MICROSCOPE] step=14562 t=1830.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30434.0s 17888 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30434.0s 17889 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30434.0s 17890 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30434.0s 17891 Running simulation until t = 1845.00 s, outputting every 15.00 s
30434.0s 17892 
30434.1s 17893 [PROGRESS] Step 8650: t=1831.27/1845.00s (99.3%) | dt=0.2124s
30434.2s 17894 [WARNING] Automatic CFL correction applied (count: 3349700):
30434.2s 17895 Calculated CFL: 0.800 > Limit: 0.500
30434.2s 17896 Original dt: 3.398585e-01 s
30434.2s 17897 Corrected dt: 2.124115e-01 s
30434.2s 17898 Correction factor: 1.6x
30434.2s 17899 Max wave speed detected: 23.54 m/s
30434.5s 17900 [PROGRESS] Step 8700: t=1841.90/1845.00s (99.8%) | dt=0.2127s
30434.6s 17901 Stored output at t = 1845.0000 s (Step 8715)
30434.6s 17902 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
30434.6s 17903 [A
30434.6s 17904 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.38s/s]
30434.6s 17905 
30434.6s 17906 Simulation finished at t = 1845.0000 s after 8715 steps.
30434.6s 17907 Total runtime: 0.62 seconds.
30434.6s 17908 [REWARD_MICROSCOPE] step=14563 t=1845.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30434.6s 17909 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30434.6s 17910 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30434.6s 17911 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30434.6s 17912 Running simulation until t = 1860.00 s, outputting every 15.00 s
30434.6s 17913 
30434.9s 17914 [PROGRESS] Step 8750: t=1852.45/1860.00s (99.6%) | dt=0.2131s
30435.1s 17915 [WARNING] Automatic CFL correction applied (count: 3349800):
30435.1s 17916 Calculated CFL: 0.800 > Limit: 0.500
30435.1s 17917 Original dt: 3.412422e-01 s
30435.1s 17918 Corrected dt: 2.132764e-01 s
30435.1s 17919 Correction factor: 1.6x
30435.1s 17920 Max wave speed detected: 23.44 m/s
30435.3s 17921 Stored output at t = 1860.0000 s (Step 8786)
30435.3s 17922 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A
30435.3s 17923 [A
30435.3s 17924 
30435.3s 17925 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.19s/s]
30435.3s 17926 Simulation finished at t = 1860.0000 s after 8786 steps.
30435.3s 17927 Total runtime: 0.62 seconds.
30435.3s 17928 [REWARD_MICROSCOPE] step=14564 t=1860.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30435.3s 17929 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30435.3s 17930 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30435.3s 17931 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30435.3s 17932 Running simulation until t = 1875.00 s, outputting every 15.00 s
30435.3s 17933 
30435.4s 17934 [PROGRESS] Step 8800: t=1862.97/1875.00s (99.4%) | dt=0.2123s
30435.8s 17935 [PROGRESS] Step 8850: t=1873.60/1875.00s (99.9%) | dt=0.2128s
30435.9s 17936 Stored output at t = 1875.0000 s (Step 8857)
30435.9s 17937 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1860.0/1875.0 [00:00<?, ?s/s][A
30435.9s 17938 [A
30435.9s 17939 
30435.9s 17940 Simulation finished at t = 1875.0000 s after 8857 steps.
30435.9s 17941 Total runtime: 0.62 seconds.
30435.9s 17942 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 24.14s/s]
30435.9s 17943 [REWARD_MICROSCOPE] step=14565 t=1875.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30435.9s 17944 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30435.9s 17945 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30435.9s 17946 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30435.9s 17947 Running simulation until t = 1890.00 s, outputting every 15.00 s
30435.9s 17948 
30435.9s 17949 [PERIODIC:1000] BC_DISPATCHER [Call #13400000] current_bc_params: <class 'dict'>
30435.9s 17950 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30435.9s 17951 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30435.9s 17952 [PERIODIC:1000] BC_GPU [Call #13400000] About to launch kernel
30435.9s 17953 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30435.9s 17954 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30435.9s 17955 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30436.0s 17956 [WARNING] Automatic CFL correction applied (count: 3349900):
30436.0s 17957 Calculated CFL: 0.800 > Limit: 0.500
30436.0s 17958 Original dt: 3.406657e-01 s
30436.0s 17959 Corrected dt: 2.129161e-01 s
30436.0s 17960 Correction factor: 1.6x
30436.0s 17961 Max wave speed detected: 23.48 m/s
30436.3s 17962 [PROGRESS] Step 8900: t=1884.16/1890.00s (99.7%) | dt=0.2132s
30436.5s 17963 Stored output at t = 1890.0000 s (Step 8928)
30436.5s 17964 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1875.0/1890.0 [00:00<?, ?s/s][A
30436.5s 17965 [A
30436.5s 17966 
30436.5s 17967 Simulation finished at t = 1890.0000 s after 8928 steps.
30436.5s 17968 Total runtime: 0.62 seconds.
30436.5s 17969 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.02s/s]
30436.5s 17970 [REWARD_MICROSCOPE] step=14566 t=1890.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30436.5s 17971 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30436.5s 17972 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30436.5s 17973 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30436.5s 17974 Running simulation until t = 1905.00 s, outputting every 15.00 s
30436.5s 17975 
30436.7s 17976 [PROGRESS] Step 8950: t=1894.67/1905.00s (99.5%) | dt=0.2124s
30436.9s 17977 [WARNING] Automatic CFL correction applied (count: 3350000):
30436.9s 17978 Calculated CFL: 0.800 > Limit: 0.500
30436.9s 17979 Original dt: 3.400921e-01 s
30436.9s 17980 Corrected dt: 2.125575e-01 s
30436.9s 17981 Correction factor: 1.6x
30436.9s 17982 Max wave speed detected: 23.52 m/s
30437.1s 17983 Stored output at t = 1905.0000 s (Step 8999)
30437.1s 17984 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1890.0/1905.0 [00:00<?, ?s/s][A
30437.1s 17985 [A
30437.1s 17986 
30437.1s 17987 Simulation finished at t = 1905.0000 s after 8999 steps.
30437.1s 17988 Total runtime: 0.63 seconds.
30437.1s 17989 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.00s/s]
30437.1s 17990 [REWARD_MICROSCOPE] step=14567 t=1905.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30437.1s 17991 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30437.1s 17992 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30437.1s 17993 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30437.1s 17994 Running simulation until t = 1920.00 s, outputting every 15.00 s
30437.1s 17995 
30437.2s 17996 [PROGRESS] Step 9000: t=1905.21/1920.00s (99.2%) | dt=0.2128s
30437.6s 17997 [PROGRESS] Step 9050: t=1915.87/1920.00s (99.8%) | dt=0.2133s
30437.7s 17998 [WARNING] Automatic CFL correction applied (count: 3350100):
30437.7s 17999 Calculated CFL: 0.800 > Limit: 0.500
30437.7s 18000 Original dt: 3.402189e-01 s
30437.7s 18001 Corrected dt: 2.126368e-01 s
30437.7s 18002 Correction factor: 1.6x
30437.7s 18003 Max wave speed detected: 23.51 m/s
30437.8s 18004 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1905.0/1920.0 [00:00<?, ?s/s][A
30437.8s 18005 Stored output at t = 1920.0000 s (Step 9070)
30437.8s 18006 [A
30437.8s 18007 
30437.8s 18008 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 23.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 23.71s/s]
30437.8s 18009 Simulation finished at t = 1920.0000 s after 9070 steps.
30437.8s 18010 Total runtime: 0.63 seconds.
30437.8s 18011 [REWARD_MICROSCOPE] step=14568 t=1920.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30437.8s 18012 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30437.8s 18013 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30437.8s 18014 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30437.8s 18015 Running simulation until t = 1935.00 s, outputting every 15.00 s
30437.8s 18016 
30438.1s 18017 [PROGRESS] Step 9100: t=1926.37/1935.00s (99.6%) | dt=0.2125s
30438.2s 18018 [PERIODIC:1000] BC_DISPATCHER [Call #13401000] current_bc_params: <class 'dict'>
30438.2s 18019 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30438.2s 18020 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30438.2s 18021 [PERIODIC:1000] BC_GPU [Call #13401000] About to launch kernel
30438.2s 18022 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30438.2s 18023 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30438.2s 18024 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30438.8s 18025 Stored output at t = 1935.0000 s (Step 9141)
30438.8s 18026 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1920.0/1935.0 [00:00<?, ?s/s][A
30438.8s 18027 [A
30438.8s 18028 
30438.8s 18029 Simulation finished at t = 1935.0000 s after 9141 steps.
30438.8s 18030 Total runtime: 1.02 seconds.
30438.8s 18031 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:01<00:00, 14.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:01<00:00, 14.67s/s]
30438.8s 18032 [REWARD_MICROSCOPE] step=14569 t=1935.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30438.8s 18033 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30438.8s 18034 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30438.8s 18035 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30438.8s 18036 Running simulation until t = 1950.00 s, outputting every 15.00 s
30438.8s 18037 
30438.9s 18038 [PROGRESS] Step 9150: t=1936.92/1950.00s (99.3%) | dt=0.2129s
30439.0s 18039 [WARNING] Automatic CFL correction applied (count: 3350200):
30439.0s 18040 Calculated CFL: 0.800 > Limit: 0.500
30439.0s 18041 Original dt: 3.408895e-01 s
30439.0s 18042 Corrected dt: 2.130559e-01 s
30439.0s 18043 Correction factor: 1.6x
30439.0s 18044 Max wave speed detected: 23.47 m/s
30439.3s 18045 [PROGRESS] Step 9200: t=1947.57/1950.00s (99.9%) | dt=0.2130s
30439.4s 18046 Stored output at t = 1950.0000 s (Step 9212)
30439.4s 18047 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1935.0/1950.0 [00:00<?, ?s/s][A
30439.4s 18048 [A
30439.4s 18049 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.81s/s]
30439.4s 18050 
30439.4s 18051 Simulation finished at t = 1950.0000 s after 9212 steps.
30439.4s 18052 Total runtime: 0.63 seconds.
30439.4s 18053 [REWARD_MICROSCOPE] step=14570 t=1950.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30439.4s 18054 [STEP  130] t= 1950.0s | phase=0 | reward=   0.01 | total_reward=    1.30
30439.4s 18055 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30439.4s 18056 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30439.4s 18057 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30439.4s 18058 Running simulation until t = 1965.00 s, outputting every 15.00 s
30439.4s 18059 
30439.8s 18060 [PROGRESS] Step 9250: t=1958.07/1965.00s (99.6%) | dt=0.2125s
30439.9s 18061 [WARNING] Automatic CFL correction applied (count: 3350300):
30439.9s 18062 Calculated CFL: 0.800 > Limit: 0.500
30439.9s 18063 Original dt: 3.403151e-01 s
30439.9s 18064 Corrected dt: 2.126969e-01 s
30439.9s 18065 Correction factor: 1.6x
30439.9s 18066 Max wave speed detected: 23.51 m/s
30440.1s 18067 Stored output at t = 1965.0000 s (Step 9283)
30440.1s 18068 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1950.0/1965.0 [00:00<?, ?s/s][A
30440.1s 18069 [A
30440.1s 18070 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 24.39s/s]
30440.1s 18071 
30440.1s 18072 Simulation finished at t = 1965.0000 s after 9283 steps.
30440.1s 18073 Total runtime: 0.62 seconds.
30440.1s 18074 [QUEUE_DIAGNOSTIC] ===== Step 130 t=1965.0s =====
30440.1s 18075 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30440.1s 18076 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30440.1s 18077 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30440.1s 18078 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30440.1s 18079 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30440.1s 18080 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30440.1s 18081 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30440.1s 18082 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30440.1s 18083 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30440.1s 18084 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30440.1s 18085 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30440.1s 18086 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30440.1s 18087 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30440.1s 18088 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30440.1s 18089 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30440.1s 18090 [REWARD_MICROSCOPE] step=14571 t=1965.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30440.1s 18091 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30440.1s 18092 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30440.1s 18093 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30440.1s 18094 Running simulation until t = 1980.00 s, outputting every 15.00 s
30440.1s 18095 
30440.2s 18096 [PROGRESS] Step 9300: t=1968.62/1980.00s (99.4%) | dt=0.2130s
30440.6s 18097 [PROGRESS] Step 9350: t=1979.27/1980.00s (100.0%) | dt=0.2127s
30440.7s 18098 Stored output at t = 1980.0000 s (Step 9354)
30440.7s 18099 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1965.0/1980.0 [00:00<?, ?s/s][A
30440.7s 18100 [A
30440.7s 18101 
30440.7s 18102 Simulation finished at t = 1980.0000 s after 9354 steps.
30440.7s 18103 Total runtime: 0.62 seconds.
30440.7s 18104 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 24.36s/s]
30440.7s 18105 [REWARD_MICROSCOPE] step=14572 t=1980.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30440.7s 18106 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30440.7s 18107 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30440.7s 18108 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30440.7s 18109 Running simulation until t = 1995.00 s, outputting every 15.00 s
30440.7s 18110 
30440.7s 18111 [PERIODIC:1000] BC_DISPATCHER [Call #13402000] current_bc_params: <class 'dict'>
30440.7s 18112 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30440.7s 18113 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30440.7s 18114 [PERIODIC:1000] BC_GPU [Call #13402000] About to launch kernel
30440.7s 18115 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30440.7s 18116 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30440.7s 18117 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30440.8s 18118 [WARNING] Automatic CFL correction applied (count: 3350400):
30440.8s 18119 Calculated CFL: 0.800 > Limit: 0.500
30440.8s 18120 Original dt: 3.397193e-01 s
30440.8s 18121 Corrected dt: 2.123245e-01 s
30440.8s 18122 Correction factor: 1.6x
30440.8s 18123 Max wave speed detected: 23.55 m/s
30441.1s 18124 [PROGRESS] Step 9400: t=1989.77/1995.00s (99.7%) | dt=0.2126s
30441.3s 18125 Stored output at t = 1995.0000 s (Step 9425)
30441.3s 18126 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1980.0/1995.0 [00:00<?, ?s/s][A
30441.3s 18127 [A
30441.3s 18128 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 23.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 23.58s/s]
30441.3s 18129 
30441.3s 18130 Simulation finished at t = 1995.0000 s after 9425 steps.
30441.3s 18131 Total runtime: 0.64 seconds.
30441.3s 18132 [REWARD_MICROSCOPE] step=14573 t=1995.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30441.3s 18133 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30441.3s 18134 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30441.3s 18135 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30441.3s 18136 Running simulation until t = 2010.00 s, outputting every 15.00 s
30441.3s 18137 
30441.5s 18138 [PROGRESS] Step 9450: t=2000.32/2010.00s (99.5%) | dt=0.2130s
30441.7s 18139 [WARNING] Automatic CFL correction applied (count: 3350500):
30441.7s 18140 Calculated CFL: 0.800 > Limit: 0.500
30441.7s 18141 Original dt: 3.411064e-01 s
30441.7s 18142 Corrected dt: 2.131915e-01 s
30441.7s 18143 Correction factor: 1.6x
30441.7s 18144 Max wave speed detected: 23.45 m/s
30441.9s 18145 Stored output at t = 2010.0000 s (Step 9496)
30441.9s 18146 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1995.0/2010.0 [00:00<?, ?s/s][A
30441.9s 18147 [A
30441.9s 18148 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.13s/s]
30441.9s 18149 
30441.9s 18150 Simulation finished at t = 2010.0000 s after 9496 steps.
30441.9s 18151 Total runtime: 0.62 seconds.
30441.9s 18152 [REWARD_MICROSCOPE] step=14574 t=2010.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30441.9s 18153 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30441.9s 18154 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30441.9s 18155 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30441.9s 18156 Running simulation until t = 2025.00 s, outputting every 15.00 s
30441.9s 18157 
30442.0s 18158 [PROGRESS] Step 9500: t=2010.85/2025.00s (99.3%) | dt=0.2124s
30442.4s 18159 [PROGRESS] Step 9550: t=2021.47/2025.00s (99.8%) | dt=0.2127s
30442.5s 18160 [WARNING] Automatic CFL correction applied (count: 3350600):
30442.5s 18161 Calculated CFL: 0.800 > Limit: 0.500
30442.5s 18162 Original dt: 3.405361e-01 s
30442.5s 18163 Corrected dt: 2.128351e-01 s
30442.5s 18164 Correction factor: 1.6x
30442.5s 18165 Max wave speed detected: 23.49 m/s
30442.6s 18166 Stored output at t = 2025.0000 s (Step 9567)
30442.6s 18167 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2010.0/2025.0 [00:00<?, ?s/s][A
30442.6s 18168 [A
30442.6s 18169 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.36s/s]
30442.6s 18170 
30442.6s 18171 Simulation finished at t = 2025.0000 s after 9567 steps.
30442.6s 18172 Total runtime: 0.62 seconds.
30442.6s 18173 [REWARD_MICROSCOPE] step=14575 t=2025.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30442.6s 18174 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30442.6s 18175 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30442.6s 18176 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30442.6s 18177 Running simulation until t = 2040.00 s, outputting every 15.00 s
30442.6s 18178 
30442.8s 18179 [PROGRESS] Step 9600: t=2032.03/2040.00s (99.6%) | dt=0.2131s
30442.9s 18180 [PERIODIC:1000] BC_DISPATCHER [Call #13403000] current_bc_params: <class 'dict'>
30442.9s 18181 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30442.9s 18182 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30442.9s 18183 [PERIODIC:1000] BC_GPU [Call #13403000] About to launch kernel
30442.9s 18184 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30442.9s 18185 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30442.9s 18186 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30443.2s 18187 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2025.0/2040.0 [00:00<?, ?s/s][A
30443.2s 18188 [A
30443.2s 18189 Stored output at t = 2040.0000 s (Step 9638)
30443.2s 18190 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 24.16s/s]
30443.2s 18191 
30443.2s 18192 Simulation finished at t = 2040.0000 s after 9638 steps.
30443.2s 18193 Total runtime: 0.62 seconds.
30443.2s 18194 [REWARD_MICROSCOPE] step=14576 t=2040.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30443.2s 18195 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30443.2s 18196 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30443.2s 18197 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30443.2s 18198 Running simulation until t = 2055.00 s, outputting every 15.00 s
30443.2s 18199 
30443.3s 18200 [PROGRESS] Step 9650: t=2042.55/2055.00s (99.4%) | dt=0.2123s
30443.4s 18201 [WARNING] Automatic CFL correction applied (count: 3350700):
30443.4s 18202 Calculated CFL: 0.800 > Limit: 0.500
30443.4s 18203 Original dt: 3.399493e-01 s
30443.4s 18204 Corrected dt: 2.124683e-01 s
30443.4s 18205 Correction factor: 1.6x
30443.4s 18206 Max wave speed detected: 23.53 m/s
30443.7s 18207 [PROGRESS] Step 9700: t=2053.18/2055.00s (99.9%) | dt=0.2128s
30443.8s 18208 Stored output at t = 2055.0000 s (Step 9709)
30443.8s 18209 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2040.0/2055.0 [00:00<?, ?s/s][A
30443.8s 18210 [A
30443.8s 18211 
30443.8s 18212 Simulation finished at t = 2055.0000 s after 9709 steps.
30443.8s 18213 Total runtime: 0.62 seconds.
30443.8s 18214 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.31s/s]
30443.8s 18215 [REWARD_MICROSCOPE] step=14577 t=2055.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30443.8s 18216 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30443.8s 18217 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30443.8s 18218 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30443.8s 18219 Running simulation until t = 2070.00 s, outputting every 15.00 s
30443.8s 18220 
30444.2s 18221 [PROGRESS] Step 9750: t=2063.73/2070.00s (99.7%) | dt=0.2132s
30444.3s 18222 [WARNING] Automatic CFL correction applied (count: 3350800):
30444.3s 18223 Calculated CFL: 0.800 > Limit: 0.500
30444.3s 18224 Original dt: 3.409227e-01 s
30444.3s 18225 Corrected dt: 2.130767e-01 s
30444.3s 18226 Correction factor: 1.6x
30444.3s 18227 Max wave speed detected: 23.47 m/s
30444.4s 18228 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2055.0/2070.0 [00:00<?, ?s/s][A
30444.4s 18229 [A
30444.4s 18230 Stored output at t = 2070.0000 s (Step 9780)
30444.4s 18231 
30444.4s 18232 Simulation finished at t = 2070.0000 s after 9780 steps.
30444.4s 18233 Total runtime: 0.61 seconds.
30444.4s 18234 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.45s/s]
30444.4s 18235 [REWARD_MICROSCOPE] step=14578 t=2070.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30444.4s 18236 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30444.4s 18237 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30444.4s 18238 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30444.4s 18239 Running simulation until t = 2085.00 s, outputting every 15.00 s
30444.4s 18240 
30444.6s 18241 [PROGRESS] Step 9800: t=2074.25/2085.00s (99.5%) | dt=0.2124s
30445.0s 18242 [PROGRESS] Step 9850: t=2084.88/2085.00s (100.0%) | dt=0.2128s
30445.0s 18243 Stored output at t = 2085.0000 s (Step 9851)
30445.0s 18244 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2070.0/2085.0 [00:00<?, ?s/s][A
30445.0s 18245 [A
30445.0s 18246 
30445.0s 18247 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.25s/s]
30445.0s 18248 Simulation finished at t = 2085.0000 s after 9851 steps.
30445.0s 18249 Total runtime: 0.62 seconds.
30445.0s 18250 [REWARD_MICROSCOPE] step=14579 t=2085.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30445.0s 18251 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30445.0s 18252 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30445.0s 18253 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30445.0s 18254 Running simulation until t = 2100.00 s, outputting every 15.00 s
30445.0s 18255 
30445.1s 18256 [PERIODIC:1000] BC_DISPATCHER [Call #13404000] current_bc_params: <class 'dict'>
30445.1s 18257 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30445.1s 18258 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30445.1s 18259 [PERIODIC:1000] BC_GPU [Call #13404000] About to launch kernel
30445.1s 18260 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30445.1s 18261 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30445.1s 18262 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30445.2s 18263 [WARNING] Automatic CFL correction applied (count: 3350900):
30445.2s 18264 Calculated CFL: 0.800 > Limit: 0.500
30445.2s 18265 Original dt: 3.407491e-01 s
30445.2s 18266 Corrected dt: 2.129682e-01 s
30445.2s 18267 Correction factor: 1.6x
30445.2s 18268 Max wave speed detected: 23.48 m/s
30445.5s 18269 [PROGRESS] Step 9900: t=2095.44/2100.00s (99.8%) | dt=0.2133s
30445.7s 18270 Stored output at t = 2100.0000 s (Step 9922)
30445.7s 18271 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2085.0/2100.0 [00:00<?, ?s/s][A
30445.7s 18272 [A
30445.7s 18273 
30445.7s 18274 Simulation finished at t = 2100.0000 s after 9922 steps.
30445.7s 18275 Total runtime: 0.62 seconds.
30445.7s 18276 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.25s/s]
30445.7s 18277 [REWARD_MICROSCOPE] step=14580 t=2100.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30445.7s 18278 [STEP  140] t= 2100.0s | phase=0 | reward=   0.01 | total_reward=    1.40
30445.7s 18279 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30445.7s 18280 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30445.7s 18281 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30445.7s 18282 Running simulation until t = 2115.00 s, outputting every 15.00 s
30445.7s 18283 
30445.9s 18284 [PROGRESS] Step 9950: t=2105.95/2115.00s (99.6%) | dt=0.2125s
30446.0s 18285 [WARNING] Automatic CFL correction applied (count: 3351000):
30446.0s 18286 Calculated CFL: 0.800 > Limit: 0.500
30446.0s 18287 Original dt: 3.401756e-01 s
30446.0s 18288 Corrected dt: 2.126097e-01 s
30446.0s 18289 Correction factor: 1.6x
30446.0s 18290 Max wave speed detected: 23.52 m/s
30446.3s 18291 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2100.0/2115.0 [00:00<?, ?s/s][A
30446.3s 18292 Stored output at t = 2115.0000 s (Step 9993)
30446.3s 18293 [A
30446.3s 18294 
30446.3s 18295 Simulation finished at t = 2115.0000 s after 9993 steps.
30446.3s 18296 Total runtime: 0.61 seconds.
30446.3s 18297 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 24.50s/s]
30446.3s 18298 [QUEUE_DIAGNOSTIC] ===== Step 140 t=2115.0s =====
30446.3s 18299 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30446.3s 18300 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30446.3s 18301 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30446.3s 18302 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30446.3s 18303 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30446.3s 18304 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30446.3s 18305 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30446.3s 18306 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30446.3s 18307 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30446.3s 18308 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30446.3s 18309 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30446.3s 18310 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30446.3s 18311 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30446.3s 18312 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30446.3s 18313 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30446.3s 18314 [REWARD_MICROSCOPE] step=14581 t=2115.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30446.3s 18315 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30446.3s 18316 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30446.3s 18317 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30446.3s 18318 Running simulation until t = 2130.00 s, outputting every 15.00 s
30446.3s 18319 
30446.3s 18320 [PROGRESS] Step 10000: t=2116.49/2130.00s (99.4%) | dt=0.2129s
30446.8s 18321 [PROGRESS] Step 10050: t=2127.15/2130.00s (99.9%) | dt=0.2131s
30446.9s 18322 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2115.0/2130.0 [00:00<?, ?s/s][A
30446.9s 18323 [A
30446.9s 18324 Stored output at t = 2130.0000 s (Step 10064)
30446.9s 18325 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.38s/s]
30446.9s 18326 
30446.9s 18327 Simulation finished at t = 2130.0000 s after 10064 steps.
30446.9s 18328 Total runtime: 0.62 seconds.
30446.9s 18329 [REWARD_MICROSCOPE] step=14582 t=2130.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30446.9s 18330 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30446.9s 18331 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30446.9s 18332 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30446.9s 18333 Running simulation until t = 2145.00 s, outputting every 15.00 s
30446.9s 18334 
30446.9s 18335 [WARNING] Automatic CFL correction applied (count: 3351100):
30446.9s 18336 Calculated CFL: 0.800 > Limit: 0.500
30446.9s 18337 Original dt: 3.399530e-01 s
30446.9s 18338 Corrected dt: 2.124706e-01 s
30446.9s 18339 Correction factor: 1.6x
30446.9s 18340 Max wave speed detected: 23.53 m/s
30447.2s 18341 [PROGRESS] Step 10100: t=2137.65/2145.00s (99.7%) | dt=0.2125s
30447.3s 18342 [PERIODIC:1000] BC_DISPATCHER [Call #13405000] current_bc_params: <class 'dict'>
30447.3s 18343 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30447.3s 18344 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30447.3s 18345 [PERIODIC:1000] BC_GPU [Call #13405000] About to launch kernel
30447.3s 18346 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30447.3s 18347 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30447.3s 18348 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30447.5s 18349 Stored output at t = 2145.0000 s (Step 10135)
30447.5s 18350 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2130.0/2145.0 [00:00<?, ?s/s][A
30447.5s 18351 [A
30447.5s 18352 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 24.06s/s]
30447.5s 18353 
30447.5s 18354 Simulation finished at t = 2145.0000 s after 10135 steps.
30447.5s 18355 Total runtime: 0.62 seconds.
30447.5s 18356 [REWARD_MICROSCOPE] step=14583 t=2145.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30447.5s 18357 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30447.5s 18358 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30447.5s 18359 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30447.5s 18360 Running simulation until t = 2160.00 s, outputting every 15.00 s
30447.5s 18361 
30447.7s 18362 [PROGRESS] Step 10150: t=2148.19/2160.00s (99.5%) | dt=0.2130s
30447.8s 18363 [WARNING] Automatic CFL correction applied (count: 3351200):
30447.8s 18364 Calculated CFL: 0.800 > Limit: 0.500
30447.8s 18365 Original dt: 3.409728e-01 s
30447.8s 18366 Corrected dt: 2.131080e-01 s
30447.8s 18367 Correction factor: 1.6x
30447.8s 18368 Max wave speed detected: 23.46 m/s
30448.1s 18369 [PROGRESS] Step 10200: t=2158.85/2160.00s (99.9%) | dt=0.2127s
30448.1s 18370 Stored output at t = 2160.0000 s (Step 10206)
30448.1s 18371 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2145.0/2160.0 [00:00<?, ?s/s][A
30448.1s 18372 [A
30448.1s 18373 
30448.1s 18374 Simulation finished at t = 2160.0000 s after 10206 steps.
30448.1s 18375 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.38s/s]
30448.1s 18376 Total runtime: 0.62 seconds.
30448.1s 18377 [REWARD_MICROSCOPE] step=14584 t=2160.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30448.1s 18378 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30448.1s 18379 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30448.1s 18380 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30448.1s 18381 Running simulation until t = 2175.00 s, outputting every 15.00 s
30448.1s 18382 
30448.5s 18383 [PROGRESS] Step 10250: t=2169.35/2175.00s (99.7%) | dt=0.2126s
30448.7s 18384 [WARNING] Automatic CFL correction applied (count: 3351300):
30448.7s 18385 Calculated CFL: 0.800 > Limit: 0.500
30448.7s 18386 Original dt: 3.403992e-01 s
30448.7s 18387 Corrected dt: 2.127495e-01 s
30448.7s 18388 Correction factor: 1.6x
30448.7s 18389 Max wave speed detected: 23.50 m/s
30448.8s 18390 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2160.0/2175.0 [00:00<?, ?s/s][A
30448.8s 18391 Stored output at t = 2175.0000 s (Step 10277)
30448.8s 18392 [A
30448.8s 18393 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 24.39s/s]
30448.8s 18394 
30448.8s 18395 Simulation finished at t = 2175.0000 s after 10277 steps.
30448.8s 18396 Total runtime: 0.62 seconds.
30448.8s 18397 [REWARD_MICROSCOPE] step=14585 t=2175.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30448.8s 18398 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30448.8s 18399 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30448.8s 18400 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30448.8s 18401 Running simulation until t = 2190.00 s, outputting every 15.00 s
30448.8s 18402 
30449.0s 18403 [PROGRESS] Step 10300: t=2179.90/2190.00s (99.5%) | dt=0.2130s
30449.4s 18404 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2175.0/2190.0 [00:00<?, ?s/s][A
30449.4s 18405 Stored output at t = 2190.0000 s (Step 10348)
30449.4s 18406 [A
30449.4s 18407 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 24.30s/s]
30449.4s 18408 
30449.4s 18409 Simulation finished at t = 2190.0000 s after 10348 steps.
30449.4s 18410 Total runtime: 0.62 seconds.
30449.4s 18411 [REWARD_MICROSCOPE] step=14586 t=2190.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30449.4s 18412 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30449.4s 18413 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30449.4s 18414 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30449.4s 18415 Running simulation until t = 2205.00 s, outputting every 15.00 s
30449.4s 18416 
30449.4s 18417 [PROGRESS] Step 10350: t=2190.43/2205.00s (99.3%) | dt=0.2125s
30449.5s 18418 [PERIODIC:1000] BC_DISPATCHER [Call #13406000] current_bc_params: <class 'dict'>
30449.5s 18419 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30449.5s 18420 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30449.5s 18421 [PERIODIC:1000] BC_GPU [Call #13406000] About to launch kernel
30449.5s 18422 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30449.5s 18423 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30449.5s 18424 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30449.5s 18425 [WARNING] Automatic CFL correction applied (count: 3351400):
30449.5s 18426 Calculated CFL: 0.800 > Limit: 0.500
30449.5s 18427 Original dt: 3.397973e-01 s
30449.5s 18428 Corrected dt: 2.123733e-01 s
30449.5s 18429 Correction factor: 1.6x
30449.5s 18430 Max wave speed detected: 23.54 m/s
30449.8s 18431 [PROGRESS] Step 10400: t=2201.05/2205.00s (99.8%) | dt=0.2127s
30450.0s 18432 Stored output at t = 2205.0000 s (Step 10419)
30450.0s 18433 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2190.0/2205.0 [00:00<?, ?s/s][A
30450.0s 18434 [A
30450.0s 18435 
30450.0s 18436 Simulation finished at t = 2205.0000 s after 10419 steps.
30450.0s 18437 Total runtime: 0.63 seconds.
30450.0s 18438 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 23.83s/s]
30450.0s 18439 [REWARD_MICROSCOPE] step=14587 t=2205.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30450.0s 18440 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30450.0s 18441 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30450.0s 18442 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30450.0s 18443 Running simulation until t = 2220.00 s, outputting every 15.00 s
30450.0s 18444 
30450.3s 18445 [PROGRESS] Step 10450: t=2211.60/2220.00s (99.6%) | dt=0.2131s
30450.4s 18446 [WARNING] Automatic CFL correction applied (count: 3351500):
30450.4s 18447 Calculated CFL: 0.800 > Limit: 0.500
30450.4s 18448 Original dt: 3.411876e-01 s
30450.4s 18449 Corrected dt: 2.132423e-01 s
30450.4s 18450 Correction factor: 1.6x
30450.4s 18451 Max wave speed detected: 23.45 m/s
30450.6s 18452 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2205.0/2220.0 [00:00<?, ?s/s][A
30450.6s 18453 [A
30450.6s 18454 Stored output at t = 2220.0000 s (Step 10490)
30450.6s 18455 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.12s/s]
30450.6s 18456 
30450.6s 18457 Simulation finished at t = 2220.0000 s after 10490 steps.
30450.6s 18458 Total runtime: 0.62 seconds.
30450.6s 18459 [REWARD_MICROSCOPE] step=14588 t=2220.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30450.6s 18460 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30450.6s 18461 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30450.6s 18462 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30450.6s 18463 Running simulation until t = 2235.00 s, outputting every 15.00 s
30450.6s 18464 
30450.7s 18465 [PROGRESS] Step 10500: t=2222.12/2235.00s (99.4%) | dt=0.2123s
30451.2s 18466 [PROGRESS] Step 10550: t=2232.75/2235.00s (99.9%) | dt=0.2127s
30451.3s 18467 Stored output at t = 2235.0000 s (Step 10561)
30451.3s 18468 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2220.0/2235.0 [00:00<?, ?s/s][A
30451.3s 18469 [A
30451.3s 18470 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 23.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 23.42s/s]
30451.3s 18471 
30451.3s 18472 Simulation finished at t = 2235.0000 s after 10561 steps.
30451.3s 18473 Total runtime: 0.64 seconds.
30451.3s 18474 [REWARD_MICROSCOPE] step=14589 t=2235.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30451.3s 18475 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30451.3s 18476 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30451.3s 18477 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30451.3s 18478 Running simulation until t = 2250.00 s, outputting every 15.00 s
30451.3s 18479 
30451.3s 18480 [WARNING] Automatic CFL correction applied (count: 3351600):
30451.3s 18481 Calculated CFL: 0.800 > Limit: 0.500
30451.3s 18482 Original dt: 3.406104e-01 s
30451.3s 18483 Corrected dt: 2.128815e-01 s
30451.3s 18484 Correction factor: 1.6x
30451.3s 18485 Max wave speed detected: 23.49 m/s
30451.6s 18486 [PROGRESS] Step 10600: t=2243.31/2250.00s (99.7%) | dt=0.2132s
30451.7s 18487 [PERIODIC:1000] BC_DISPATCHER [Call #13407000] current_bc_params: <class 'dict'>
30451.7s 18488 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30451.7s 18489 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30451.7s 18490 [PERIODIC:1000] BC_GPU [Call #13407000] About to launch kernel
30451.7s 18491 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30451.7s 18492 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30451.7s 18493 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30452.0s 18494 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2235.0/2250.0 [00:00<?, ?s/s][A
30452.0s 18495 Stored output at t = 2250.0000 s (Step 10632)
30452.0s 18496 [A
30452.0s 18497 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 21.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 21.94s/s]
30452.0s 18498 
30452.0s 18499 Simulation finished at t = 2250.0000 s after 10632 steps.
30452.0s 18500 Total runtime: 0.68 seconds.
30452.0s 18501 [REWARD_MICROSCOPE] step=14590 t=2250.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30452.0s 18502 [STEP  150] t= 2250.0s | phase=0 | reward=   0.01 | total_reward=    1.50
30452.0s 18503 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30452.0s 18504 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30452.0s 18505 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30452.0s 18506 Running simulation until t = 2265.00 s, outputting every 15.00 s
30452.0s 18507 
30452.1s 18508 [PROGRESS] Step 10650: t=2253.82/2265.00s (99.5%) | dt=0.2124s
30452.3s 18509 [WARNING] Automatic CFL correction applied (count: 3351700):
30452.3s 18510 Calculated CFL: 0.800 > Limit: 0.500
30452.3s 18511 Original dt: 3.400365e-01 s
30452.3s 18512 Corrected dt: 2.125228e-01 s
30452.3s 18513 Correction factor: 1.6x
30452.3s 18514 Max wave speed detected: 23.53 m/s
30452.6s 18515 [PROGRESS] Step 10700: t=2264.45/2265.00s (100.0%) | dt=0.2128s
30452.6s 18516 Stored output at t = 2265.0000 s (Step 10703)
30452.6s 18517 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2250.0/2265.0 [00:00<?, ?s/s][A
30452.6s 18518 [A
30452.6s 18519 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.60s/s]
30452.6s 18520 
30452.6s 18521 Simulation finished at t = 2265.0000 s after 10703 steps.
30452.6s 18522 Total runtime: 0.61 seconds.
30452.6s 18523 [QUEUE_DIAGNOSTIC] ===== Step 150 t=2265.0s =====
30452.6s 18524 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30452.6s 18525 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30452.6s 18526 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30452.6s 18527 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30452.6s 18528 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30452.6s 18529 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30452.6s 18530 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30452.6s 18531 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30452.6s 18532 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30452.6s 18533 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30452.6s 18534 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30452.6s 18535 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30452.6s 18536 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30452.6s 18537 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30452.6s 18538 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30452.6s 18539 [REWARD_MICROSCOPE] step=14591 t=2265.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30452.6s 18540 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30452.6s 18541 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30452.6s 18542 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30452.6s 18543 Running simulation until t = 2280.00 s, outputting every 15.00 s
30452.6s 18544 
30453.0s 18545 [PROGRESS] Step 10750: t=2275.01/2280.00s (99.8%) | dt=0.2132s
30453.1s 18546 [WARNING] Automatic CFL correction applied (count: 3351800):
30453.1s 18547 Calculated CFL: 0.800 > Limit: 0.500
30453.1s 18548 Original dt: 3.404624e-01 s
30453.1s 18549 Corrected dt: 2.127890e-01 s
30453.1s 18550 Correction factor: 1.6x
30453.1s 18551 Max wave speed detected: 23.50 m/s
30453.2s 18552 Stored output at t = 2280.0000 s (Step 10774)
30453.2s 18553 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2265.0/2280.0 [00:00<?, ?s/s][A
30453.2s 18554 [A
30453.2s 18555 
30453.2s 18556 Simulation finished at t = 2280.0000 s after 10774 steps.
30453.2s 18557 Total runtime: 0.62 seconds.
30453.2s 18558 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.11s/s]
30453.2s 18559 [REWARD_MICROSCOPE] step=14592 t=2280.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30453.2s 18560 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30453.2s 18561 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30453.2s 18562 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30453.2s 18563 Running simulation until t = 2295.00 s, outputting every 15.00 s
30453.2s 18564 
30453.4s 18565 [PROGRESS] Step 10800: t=2285.52/2295.00s (99.6%) | dt=0.2124s
30453.8s 18566 Stored output at t = 2295.0000 s (Step 10845)
30453.8s 18567 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2280.0/2295.0 [00:00<?, ?s/s][A
30453.8s 18568 [A
30453.8s 18569 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 24.26s/s]
30453.8s 18570 
30453.8s 18571 Simulation finished at t = 2295.0000 s after 10845 steps.
30453.8s 18572 Total runtime: 0.62 seconds.
30453.8s 18573 [REWARD_MICROSCOPE] step=14593 t=2295.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30453.8s 18574 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30453.8s 18575 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30453.8s 18576 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30453.8s 18577 Running simulation until t = 2310.00 s, outputting every 15.00 s
30453.8s 18578 
30453.9s 18579 [PROGRESS] Step 10850: t=2296.06/2310.00s (99.4%) | dt=0.2129s
30454.0s 18580 [PERIODIC:1000] BC_DISPATCHER [Call #13408000] current_bc_params: <class 'dict'>
30454.0s 18581 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30454.0s 18582 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30454.0s 18583 [PERIODIC:1000] BC_GPU [Call #13408000] About to launch kernel
30454.0s 18584 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30454.0s 18585 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30454.0s 18586 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30454.0s 18587 [WARNING] Automatic CFL correction applied (count: 3351900):
30454.0s 18588 Calculated CFL: 0.800 > Limit: 0.500
30454.0s 18589 Original dt: 3.408331e-01 s
30454.0s 18590 Corrected dt: 2.130207e-01 s
30454.0s 18591 Correction factor: 1.6x
30454.0s 18592 Max wave speed detected: 23.47 m/s
30454.4s 18593 [PROGRESS] Step 10900: t=2306.72/2310.00s (99.9%) | dt=0.2133s
30454.5s 18594 Stored output at t = 2310.0000 s (Step 10916)
30454.5s 18595 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295.0/2310.0 [00:00<?, ?s/s][A
30454.5s 18596 [A
30454.5s 18597 
30454.5s 18598 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 21.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 21.35s/s]
30454.5s 18599 Simulation finished at t = 2310.0000 s after 10916 steps.
30454.5s 18600 Total runtime: 0.70 seconds.
30454.5s 18601 [REWARD_MICROSCOPE] step=14594 t=2310.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30454.5s 18602 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30454.5s 18603 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30454.5s 18604 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30454.5s 18605 Running simulation until t = 2325.00 s, outputting every 15.00 s
30454.5s 18606 
30454.8s 18607 [PROGRESS] Step 10950: t=2317.22/2325.00s (99.7%) | dt=0.2125s
30455.0s 18608 [WARNING] Automatic CFL correction applied (count: 3352000):
30455.0s 18609 Calculated CFL: 0.800 > Limit: 0.500
30455.0s 18610 Original dt: 3.402592e-01 s
30455.0s 18611 Corrected dt: 2.126620e-01 s
30455.0s 18612 Correction factor: 1.6x
30455.0s 18613 Max wave speed detected: 23.51 m/s
30455.2s 18614 Stored output at t = 2325.0000 s (Step 10987)
30455.2s 18615 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310.0/2325.0 [00:00<?, ?s/s][A
30455.2s 18616 [A
30455.2s 18617 
30455.2s 18618 Simulation finished at t = 2325.0000 s after 10987 steps.
30455.2s 18619 Total runtime: 0.63 seconds.
30455.2s 18620 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 23.83s/s]
30455.2s 18621 [REWARD_MICROSCOPE] step=14595 t=2325.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30455.2s 18622 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30455.2s 18623 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30455.2s 18624 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30455.2s 18625 Running simulation until t = 2340.00 s, outputting every 15.00 s
30455.2s 18626 
30455.3s 18627 [PROGRESS] Step 11000: t=2327.77/2340.00s (99.5%) | dt=0.2129s
30455.7s 18628 [PROGRESS] Step 11050: t=2338.42/2340.00s (99.9%) | dt=0.2128s
30455.8s 18629 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2325.0/2340.0 [00:00<?, ?s/s][A
30455.8s 18630 [A
30455.8s 18631 Stored output at t = 2340.0000 s (Step 11058)
30455.8s 18632 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.28s/s]
30455.8s 18633 
30455.8s 18634 Simulation finished at t = 2340.0000 s after 11058 steps.
30455.8s 18635 Total runtime: 0.62 seconds.
30455.8s 18636 [REWARD_MICROSCOPE] step=14596 t=2340.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30455.8s 18637 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30455.8s 18638 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30455.8s 18639 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30455.8s 18640 Running simulation until t = 2355.00 s, outputting every 15.00 s
30455.8s 18641 
30455.9s 18642 [WARNING] Automatic CFL correction applied (count: 3352100):
30455.9s 18643 Calculated CFL: 0.800 > Limit: 0.500
30455.9s 18644 Original dt: 3.397413e-01 s
30455.9s 18645 Corrected dt: 2.123383e-01 s
30455.9s 18646 Correction factor: 1.6x
30455.9s 18647 Max wave speed detected: 23.55 m/s
30456.2s 18648 [PROGRESS] Step 11100: t=2348.92/2355.00s (99.7%) | dt=0.2126s
30456.3s 18649 [PERIODIC:1000] BC_DISPATCHER [Call #13409000] current_bc_params: <class 'dict'>
30456.3s 18650 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30456.3s 18651 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30456.3s 18652 [PERIODIC:1000] BC_GPU [Call #13409000] About to launch kernel
30456.3s 18653 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30456.3s 18654 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30456.3s 18655 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30456.4s 18656 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2340.0/2355.0 [00:00<?, ?s/s][A
30456.4s 18657 [A
30456.4s 18658 Stored output at t = 2355.0000 s (Step 11129)
30456.4s 18659 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.16s/s]
30456.4s 18660 
30456.4s 18661 Simulation finished at t = 2355.0000 s after 11129 steps.
30456.4s 18662 Total runtime: 0.62 seconds.
30456.4s 18663 [REWARD_MICROSCOPE] step=14597 t=2355.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30456.4s 18664 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30456.4s 18665 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30456.4s 18666 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30456.4s 18667 Running simulation until t = 2370.00 s, outputting every 15.00 s
30456.4s 18668 
30456.6s 18669 [PROGRESS] Step 11150: t=2359.47/2370.00s (99.6%) | dt=0.2130s
30456.7s 18670 [WARNING] Automatic CFL correction applied (count: 3352200):
30456.7s 18671 Calculated CFL: 0.800 > Limit: 0.500
30456.7s 18672 Original dt: 3.410527e-01 s
30456.7s 18673 Corrected dt: 2.131579e-01 s
30456.7s 18674 Correction factor: 1.6x
30456.7s 18675 Max wave speed detected: 23.46 m/s
30457.0s 18676 [PROGRESS] Step 11200: t=2370.00/2370.00s (100.0%) | dt=0.0883s
30457.0s 18677 Stored output at t = 2370.0000 s (Step 11200)
30457.0s 18678 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2355.0/2370.0 [00:00<?, ?s/s][A
30457.0s 18679 [A
30457.0s 18680 
30457.0s 18681 Simulation finished at t = 2370.0000 s after 11200 steps.
30457.0s 18682 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 23.86s/s]
30457.0s 18683 Total runtime: 0.63 seconds.
30457.0s 18684 [REWARD_MICROSCOPE] step=14598 t=2370.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30457.0s 18685 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30457.0s 18686 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30457.0s 18687 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30457.0s 18688 Running simulation until t = 2385.00 s, outputting every 15.00 s
30457.0s 18689 
30457.5s 18690 [PROGRESS] Step 11250: t=2380.62/2385.00s (99.8%) | dt=0.2127s
30457.6s 18691 [WARNING] Automatic CFL correction applied (count: 3352300):
30457.6s 18692 Calculated CFL: 0.800 > Limit: 0.500
30457.6s 18693 Original dt: 3.404818e-01 s
30457.6s 18694 Corrected dt: 2.128011e-01 s
30457.6s 18695 Correction factor: 1.6x
30457.6s 18696 Max wave speed detected: 23.50 m/s
30457.7s 18697 Stored output at t = 2385.0000 s (Step 11271)
30457.7s 18698 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2370.0/2385.0 [00:00<?, ?s/s][A
30457.7s 18699 [A
30457.7s 18700 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.41s/s]
30457.7s 18701 
30457.7s 18702 Simulation finished at t = 2385.0000 s after 11271 steps.
30457.7s 18703 Total runtime: 0.61 seconds.
30457.7s 18704 [REWARD_MICROSCOPE] step=14599 t=2385.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30457.7s 18705 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30457.7s 18706 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30457.7s 18707 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30457.7s 18708 Running simulation until t = 2400.00 s, outputting every 15.00 s
30457.7s 18709 
30457.9s 18710 [PROGRESS] Step 11300: t=2391.18/2400.00s (99.6%) | dt=0.2131s
30458.3s 18711 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2385.0/2400.0 [00:00<?, ?s/s][A
30458.3s 18712 [A
30458.3s 18713 Stored output at t = 2400.0000 s (Step 11342)
30458.3s 18714 
30458.3s 18715 Simulation finished at t = 2400.0000 s after 11342 steps.
30458.3s 18716 Total runtime: 0.62 seconds.
30458.3s 18717 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.05s/s]
30458.3s 18718 [REWARD_MICROSCOPE] step=14600 t=2400.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30458.3s 18719 [STEP  160] t= 2400.0s | phase=0 | reward=   0.01 | total_reward=    1.60
30458.3s 18720 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30458.3s 18721 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30458.3s 18722 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30458.3s 18723 Running simulation until t = 2415.00 s, outputting every 15.00 s
30458.3s 18724 
30458.4s 18725 [PROGRESS] Step 11350: t=2401.70/2415.00s (99.4%) | dt=0.2124s
30458.5s 18726 [PERIODIC:1000] BC_DISPATCHER [Call #13410000] current_bc_params: <class 'dict'>
30458.5s 18727 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30458.5s 18728 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30458.5s 18729 [PERIODIC:1000] BC_GPU [Call #13410000] About to launch kernel
30458.5s 18730 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30458.5s 18731 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30458.5s 18732 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30458.5s 18733 [WARNING] Automatic CFL correction applied (count: 3352400):
30458.5s 18734 Calculated CFL: 0.800 > Limit: 0.500
30458.5s 18735 Original dt: 3.398890e-01 s
30458.5s 18736 Corrected dt: 2.124306e-01 s
30458.5s 18737 Correction factor: 1.6x
30458.5s 18738 Max wave speed detected: 23.54 m/s
30458.8s 18739 [PROGRESS] Step 11400: t=2412.32/2415.00s (99.9%) | dt=0.2127s
30458.9s 18740 Stored output at t = 2415.0000 s (Step 11413)
30458.9s 18741 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2400.0/2415.0 [00:00<?, ?s/s][A
30458.9s 18742 [A
30458.9s 18743 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 23.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 23.39s/s]
30458.9s 18744 
30458.9s 18745 Simulation finished at t = 2415.0000 s after 11413 steps.
30458.9s 18746 Total runtime: 0.64 seconds.
30458.9s 18747 [QUEUE_DIAGNOSTIC] ===== Step 160 t=2415.0s =====
30458.9s 18748 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30458.9s 18749 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30458.9s 18750 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30458.9s 18751 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30458.9s 18752 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30458.9s 18753 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30458.9s 18754 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30458.9s 18755 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30458.9s 18756 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30458.9s 18757 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30458.9s 18758 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30458.9s 18759 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30458.9s 18760 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30458.9s 18761 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30458.9s 18762 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30458.9s 18763 [REWARD_MICROSCOPE] step=14601 t=2415.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30458.9s 18764 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30458.9s 18765 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30458.9s 18766 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30458.9s 18767 Running simulation until t = 2430.00 s, outputting every 15.00 s
30458.9s 18768 
30459.3s 18769 [PROGRESS] Step 11450: t=2422.88/2430.00s (99.7%) | dt=0.2131s
30459.4s 18770 [WARNING] Automatic CFL correction applied (count: 3352500):
30459.4s 18771 Calculated CFL: 0.800 > Limit: 0.500
30459.4s 18772 Original dt: 3.412697e-01 s
30459.4s 18773 Corrected dt: 2.132935e-01 s
30459.4s 18774 Correction factor: 1.6x
30459.4s 18775 Max wave speed detected: 23.44 m/s
30459.6s 18776 Stored output at t = 2430.0000 s (Step 11484)
30459.6s 18777 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2415.0/2430.0 [00:00<?, ?s/s][A
30459.6s 18778 [A
30459.6s 18779 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 23.85s/s]
30459.6s 18780 
30459.6s 18781 Simulation finished at t = 2430.0000 s after 11484 steps.
30459.6s 18782 Total runtime: 0.63 seconds.
30459.6s 18783 [REWARD_MICROSCOPE] step=14602 t=2430.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30459.6s 18784 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30459.6s 18785 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30459.6s 18786 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30459.6s 18787 Running simulation until t = 2445.00 s, outputting every 15.00 s
30459.6s 18788 
30459.7s 18789 [PROGRESS] Step 11500: t=2433.40/2445.00s (99.5%) | dt=0.2123s
30460.2s 18790 [PROGRESS] Step 11550: t=2444.03/2445.00s (100.0%) | dt=0.2128s
30460.2s 18791 Stored output at t = 2445.0000 s (Step 11555)
30460.2s 18792 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2430.0/2445.0 [00:00<?, ?s/s][A
30460.2s 18793 [A
30460.2s 18794 
30460.2s 18795 Simulation finished at t = 2445.0000 s after 11555 steps.
30460.2s 18796 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.03s/s]
30460.2s 18797 Total runtime: 0.65 seconds.
30460.2s 18798 [REWARD_MICROSCOPE] step=14603 t=2445.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30460.2s 18799 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30460.2s 18800 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30460.2s 18801 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30460.2s 18802 Running simulation until t = 2460.00 s, outputting every 15.00 s
30460.2s 18803 
30460.3s 18804 [WARNING] Automatic CFL correction applied (count: 3352600):
30460.3s 18805 Calculated CFL: 0.800 > Limit: 0.500
30460.3s 18806 Original dt: 3.406934e-01 s
30460.3s 18807 Corrected dt: 2.129334e-01 s
30460.3s 18808 Correction factor: 1.6x
30460.3s 18809 Max wave speed detected: 23.48 m/s
30460.6s 18810 [PROGRESS] Step 11600: t=2454.59/2460.00s (99.8%) | dt=0.2132s
30460.7s 18811 [PERIODIC:1000] BC_DISPATCHER [Call #13411000] current_bc_params: <class 'dict'>
30460.7s 18812 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30460.7s 18813 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30460.7s 18814 [PERIODIC:1000] BC_GPU [Call #13411000] About to launch kernel
30460.7s 18815 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30460.7s 18816 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30460.7s 18817 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30460.9s 18818 Stored output at t = 2460.0000 s (Step 11626)
30460.9s 18819 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2445.0/2460.0 [00:00<?, ?s/s][A
30460.9s 18820 [A
30460.9s 18821 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 22.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 22.70s/s]
30460.9s 18822 
30460.9s 18823 Simulation finished at t = 2460.0000 s after 11626 steps.
30460.9s 18824 Total runtime: 0.66 seconds.
30460.9s 18825 [REWARD_MICROSCOPE] step=14604 t=2460.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30460.9s 18826 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30460.9s 18827 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30460.9s 18828 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30460.9s 18829 Running simulation until t = 2475.00 s, outputting every 15.00 s
30460.9s 18830 
30461.1s 18831 [PROGRESS] Step 11650: t=2465.10/2475.00s (99.6%) | dt=0.2124s
30461.2s 18832 [WARNING] Automatic CFL correction applied (count: 3352700):
30461.2s 18833 Calculated CFL: 0.800 > Limit: 0.500
30461.2s 18834 Original dt: 3.401199e-01 s
30461.2s 18835 Corrected dt: 2.125749e-01 s
30461.2s 18836 Correction factor: 1.6x
30461.2s 18837 Max wave speed detected: 23.52 m/s
30461.5s 18838 Stored output at t = 2475.0000 s (Step 11697)
30461.5s 18839 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2460.0/2475.0 [00:00<?, ?s/s][A
30461.5s 18840 [A
30461.5s 18841 
30461.5s 18842 Simulation finished at t = 2475.0000 s after 11697 steps.
30461.5s 18843 Total runtime: 0.62 seconds.
30461.5s 18844 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 24.33s/s]
30461.5s 18845 [REWARD_MICROSCOPE] step=14605 t=2475.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30461.5s 18846 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30461.5s 18847 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30461.5s 18848 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30461.5s 18849 Running simulation until t = 2490.00 s, outputting every 15.00 s
30461.5s 18850 
30461.5s 18851 [PROGRESS] Step 11700: t=2475.64/2490.00s (99.4%) | dt=0.2129s
30462.0s 18852 [PROGRESS] Step 11750: t=2486.29/2490.00s (99.9%) | dt=0.2133s
30462.1s 18853 [WARNING] Automatic CFL correction applied (count: 3352800):
30462.1s 18854 Calculated CFL: 0.800 > Limit: 0.500
30462.1s 18855 Original dt: 3.401129e-01 s
30462.1s 18856 Corrected dt: 2.125705e-01 s
30462.1s 18857 Correction factor: 1.6x
30462.1s 18858 Max wave speed detected: 23.52 m/s
30462.1s 18859 Stored output at t = 2490.0000 s (Step 11768)
30462.1s 18860 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2475.0/2490.0 [00:00<?, ?s/s][A
30462.1s 18861 [A
30462.1s 18862 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 23.49s/s]
30462.1s 18863 
30462.1s 18864 Simulation finished at t = 2490.0000 s after 11768 steps.
30462.1s 18865 Total runtime: 0.64 seconds.
30462.1s 18866 [REWARD_MICROSCOPE] step=14606 t=2490.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30462.1s 18867 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30462.1s 18868 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30462.1s 18869 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30462.1s 18870 Running simulation until t = 2505.00 s, outputting every 15.00 s
30462.1s 18871 
30462.4s 18872 [PROGRESS] Step 11800: t=2496.80/2505.00s (99.7%) | dt=0.2125s
30462.8s 18873 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2490.0/2505.0 [00:00<?, ?s/s][A
30462.8s 18874 [A
30462.8s 18875 Stored output at t = 2505.0000 s (Step 11839)
30462.8s 18876 
30462.8s 18877 Simulation finished at t = 2505.0000 s after 11839 steps.
30462.8s 18878 Total runtime: 0.62 seconds.
30462.8s 18879 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 24.26s/s]
30462.8s 18880 [REWARD_MICROSCOPE] step=14607 t=2505.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30462.8s 18881 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30462.8s 18882 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30462.8s 18883 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30462.8s 18884 Running simulation until t = 2520.00 s, outputting every 15.00 s
30462.8s 18885 
30462.9s 18886 [PROGRESS] Step 11850: t=2507.34/2520.00s (99.5%) | dt=0.2129s
30463.0s 18887 [PERIODIC:1000] BC_DISPATCHER [Call #13412000] current_bc_params: <class 'dict'>
30463.0s 18888 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30463.0s 18889 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30463.0s 18890 [PERIODIC:1000] BC_GPU [Call #13412000] About to launch kernel
30463.0s 18891 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30463.0s 18892 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30463.0s 18893 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30463.0s 18894 [WARNING] Automatic CFL correction applied (count: 3352900):
30463.0s 18895 Calculated CFL: 0.800 > Limit: 0.500
30463.0s 18896 Original dt: 3.409178e-01 s
30463.0s 18897 Corrected dt: 2.130736e-01 s
30463.0s 18898 Correction factor: 1.6x
30463.0s 18899 Max wave speed detected: 23.47 m/s
30463.3s 18900 [PROGRESS] Step 11900: t=2518.00/2520.00s (99.9%) | dt=0.2129s
30463.4s 18901 Stored output at t = 2520.0000 s (Step 11910)
30463.4s 18902 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2505.0/2520.0 [00:00<?, ?s/s][A
30463.4s 18903 [A
30463.4s 18904 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 23.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 23.45s/s]
30463.4s 18905 
30463.4s 18906 Simulation finished at t = 2520.0000 s after 11910 steps.
30463.4s 18907 Total runtime: 0.64 seconds.
30463.4s 18908 [REWARD_MICROSCOPE] step=14608 t=2520.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30463.4s 18909 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30463.4s 18910 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30463.4s 18911 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30463.4s 18912 Running simulation until t = 2535.00 s, outputting every 15.00 s
30463.4s 18913 
30463.8s 18914 [PROGRESS] Step 11950: t=2528.50/2535.00s (99.7%) | dt=0.2126s
30463.9s 18915 [WARNING] Automatic CFL correction applied (count: 3353000):
30463.9s 18916 Calculated CFL: 0.800 > Limit: 0.500
30463.9s 18917 Original dt: 3.403431e-01 s
30463.9s 18918 Corrected dt: 2.127144e-01 s
30463.9s 18919 Correction factor: 1.6x
30463.9s 18920 Max wave speed detected: 23.51 m/s
30464.0s 18921 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2520.0/2535.0 [00:00<?, ?s/s][A
30464.0s 18922 [A
30464.0s 18923 Stored output at t = 2535.0000 s (Step 11981)
30464.0s 18924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.83s/s]
30464.0s 18925 
30464.0s 18926 Simulation finished at t = 2535.0000 s after 11981 steps.
30464.0s 18927 Total runtime: 0.63 seconds.
30464.0s 18928 [REWARD_MICROSCOPE] step=14609 t=2535.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30464.0s 18929 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30464.0s 18930 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30464.0s 18931 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30464.0s 18932 Running simulation until t = 2550.00 s, outputting every 15.00 s
30464.0s 18933 
30464.2s 18934 [PROGRESS] Step 12000: t=2539.05/2550.00s (99.6%) | dt=0.2130s
30464.7s 18935 [PROGRESS] Step 12050: t=2549.70/2550.00s (100.0%) | dt=0.2126s
30464.7s 18936 Stored output at t = 2550.0000 s (Step 12052)
30464.7s 18937 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2535.0/2550.0 [00:00<?, ?s/s][A
30464.7s 18938 [A
30464.7s 18939 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 23.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 23.36s/s]
30464.7s 18940 
30464.7s 18941 Simulation finished at t = 2550.0000 s after 12052 steps.
30464.7s 18942 Total runtime: 0.64 seconds.
30464.7s 18943 [REWARD_MICROSCOPE] step=14610 t=2550.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30464.7s 18944 [STEP  170] t= 2550.0s | phase=0 | reward=   0.01 | total_reward=    1.70
30464.7s 18945 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30464.7s 18946 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30464.7s 18947 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30464.7s 18948 Running simulation until t = 2565.00 s, outputting every 15.00 s
30464.7s 18949 
30464.8s 18950 [WARNING] Automatic CFL correction applied (count: 3353100):
30464.8s 18951 Calculated CFL: 0.800 > Limit: 0.500
30464.8s 18952 Original dt: 3.397401e-01 s
30464.8s 18953 Corrected dt: 2.123376e-01 s
30464.8s 18954 Correction factor: 1.6x
30464.8s 18955 Max wave speed detected: 23.55 m/s
30465.1s 18956 [PROGRESS] Step 12100: t=2560.20/2565.00s (99.8%) | dt=0.2126s
30465.2s 18957 [PERIODIC:1000] BC_DISPATCHER [Call #13413000] current_bc_params: <class 'dict'>
30465.2s 18958 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30465.2s 18959 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30465.2s 18960 [PERIODIC:1000] BC_GPU [Call #13413000] About to launch kernel
30465.2s 18961 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30465.2s 18962 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30465.2s 18963 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30465.3s 18964 Stored output at t = 2565.0000 s (Step 12123)
30465.3s 18965 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2550.0/2565.0 [00:00<?, ?s/s][A
30465.3s 18966 [A
30465.3s 18967 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 23.96s/s]
30465.3s 18968 
30465.3s 18969 Simulation finished at t = 2565.0000 s after 12123 steps.
30465.3s 18970 Total runtime: 0.63 seconds.
30465.3s 18971 [QUEUE_DIAGNOSTIC] ===== Step 170 t=2565.0s =====
30465.3s 18972 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30465.3s 18973 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30465.3s 18974 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30465.3s 18975 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30465.3s 18976 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30465.3s 18977 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30465.3s 18978 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30465.3s 18979 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30465.3s 18980 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30465.3s 18981 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30465.3s 18982 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30465.3s 18983 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30465.3s 18984 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30465.3s 18985 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30465.3s 18986 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30465.3s 18987 [REWARD_MICROSCOPE] step=14611 t=2565.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30465.3s 18988 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30465.3s 18989 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30465.3s 18990 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30465.3s 18991 Running simulation until t = 2580.00 s, outputting every 15.00 s
30465.3s 18992 
30465.6s 18993 [PROGRESS] Step 12150: t=2570.75/2580.00s (99.6%) | dt=0.2131s
30465.7s 18994 [WARNING] Automatic CFL correction applied (count: 3353200):
30465.7s 18995 Calculated CFL: 0.800 > Limit: 0.500
30465.7s 18996 Original dt: 3.411334e-01 s
30465.7s 18997 Corrected dt: 2.132084e-01 s
30465.7s 18998 Correction factor: 1.6x
30465.7s 18999 Max wave speed detected: 23.45 m/s
30465.9s 19000 Stored output at t = 2580.0000 s (Step 12194)
30465.9s 19001 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2565.0/2580.0 [00:00<?, ?s/s][A
30465.9s 19002 [A
30465.9s 19003 
30465.9s 19004 Simulation finished at t = 2580.0000 s after 12194 steps.
30465.9s 19005 Total runtime: 0.62 seconds.
30465.9s 19006 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 24.40s/s]
30465.9s 19007 [REWARD_MICROSCOPE] step=14612 t=2580.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30465.9s 19008 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30465.9s 19009 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30465.9s 19010 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30465.9s 19011 Running simulation until t = 2595.00 s, outputting every 15.00 s
30465.9s 19012 
30466.0s 19013 [PROGRESS] Step 12200: t=2581.27/2595.00s (99.5%) | dt=0.2124s
30466.4s 19014 [PROGRESS] Step 12250: t=2591.90/2595.00s (99.9%) | dt=0.2127s
30466.5s 19015 Stored output at t = 2595.0000 s (Step 12265)
30466.5s 19016 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2580.0/2595.0 [00:00<?, ?s/s][A
30466.5s 19017 [A
30466.5s 19018 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.62s/s]
30466.5s 19019 
30466.5s 19020 Simulation finished at t = 2595.0000 s after 12265 steps.
30466.5s 19021 Total runtime: 0.61 seconds.
30466.5s 19022 [REWARD_MICROSCOPE] step=14613 t=2595.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30466.5s 19023 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30466.5s 19024 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30466.5s 19025 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30466.5s 19026 Running simulation until t = 2610.00 s, outputting every 15.00 s
30466.5s 19027 
30466.6s 19028 [WARNING] Automatic CFL correction applied (count: 3353300):
30466.6s 19029 Calculated CFL: 0.800 > Limit: 0.500
30466.6s 19030 Original dt: 3.405553e-01 s
30466.6s 19031 Corrected dt: 2.128470e-01 s
30466.6s 19032 Correction factor: 1.6x
30466.6s 19033 Max wave speed detected: 23.49 m/s
30466.9s 19034 [PROGRESS] Step 12300: t=2602.45/2610.00s (99.7%) | dt=0.2131s
30467.2s 19035 Stored output at t = 2610.0000 s (Step 12336)
30467.2s 19036 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2595.0/2610.0 [00:00<?, ?s/s][A
30467.2s 19037 [A
30467.2s 19038 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.27s/s]
30467.2s 19039 
30467.2s 19040 Simulation finished at t = 2610.0000 s after 12336 steps.
30467.2s 19041 Total runtime: 0.65 seconds.
30467.2s 19042 [REWARD_MICROSCOPE] step=14614 t=2610.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30467.2s 19043 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30467.2s 19044 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30467.2s 19045 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30467.2s 19046 Running simulation until t = 2625.00 s, outputting every 15.00 s
30467.2s 19047 
30467.3s 19048 [PROGRESS] Step 12350: t=2612.97/2625.00s (99.5%) | dt=0.2123s
30467.4s 19049 [PERIODIC:1000] BC_DISPATCHER [Call #13414000] current_bc_params: <class 'dict'>
30467.4s 19050 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30467.4s 19051 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30467.4s 19052 [PERIODIC:1000] BC_GPU [Call #13414000] About to launch kernel
30467.4s 19053 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30467.4s 19054 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30467.4s 19055 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30467.5s 19056 [WARNING] Automatic CFL correction applied (count: 3353400):
30467.5s 19057 Calculated CFL: 0.800 > Limit: 0.500
30467.5s 19058 Original dt: 3.399790e-01 s
30467.5s 19059 Corrected dt: 2.124869e-01 s
30467.5s 19060 Correction factor: 1.6x
30467.5s 19061 Max wave speed detected: 23.53 m/s
30467.8s 19062 [PROGRESS] Step 12400: t=2623.60/2625.00s (99.9%) | dt=0.2128s
30467.8s 19063 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2610.0/2625.0 [00:00<?, ?s/s][A
30467.8s 19064 [A
30467.8s 19065 Stored output at t = 2625.0000 s (Step 12407)
30467.8s 19066 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.25s/s]
30467.8s 19067 
30467.8s 19068 Simulation finished at t = 2625.0000 s after 12407 steps.
30467.8s 19069 Total runtime: 0.62 seconds.
30467.8s 19070 [REWARD_MICROSCOPE] step=14615 t=2625.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30467.8s 19071 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30467.8s 19072 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30467.8s 19073 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30467.8s 19074 Running simulation until t = 2640.00 s, outputting every 15.00 s
30467.8s 19075 
30468.2s 19076 [PROGRESS] Step 12450: t=2634.16/2640.00s (99.8%) | dt=0.2132s
30468.4s 19077 [WARNING] Automatic CFL correction applied (count: 3353500):
30468.4s 19078 Calculated CFL: 0.800 > Limit: 0.500
30468.4s 19079 Original dt: 3.407550e-01 s
30468.4s 19080 Corrected dt: 2.129719e-01 s
30468.4s 19081 Correction factor: 1.6x
30468.4s 19082 Max wave speed detected: 23.48 m/s
30468.5s 19083 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2625.0/2640.0 [00:00<?, ?s/s][A
30468.5s 19084 [A
30468.5s 19085 Stored output at t = 2640.0000 s (Step 12478)
30468.5s 19086 
30468.5s 19087 Simulation finished at t = 2640.0000 s after 12478 steps.
30468.5s 19088 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 22.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 22.97s/s]
30468.5s 19089 Total runtime: 0.65 seconds.
30468.5s 19090 [REWARD_MICROSCOPE] step=14616 t=2640.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30468.5s 19091 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30468.5s 19092 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30468.5s 19093 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30468.5s 19094 Running simulation until t = 2655.00 s, outputting every 15.00 s
30468.5s 19095 
30468.7s 19096 [PROGRESS] Step 12500: t=2644.67/2655.00s (99.6%) | dt=0.2124s
30469.1s 19097 Stored output at t = 2655.0000 s (Step 12549)
30469.1s 19098 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2640.0/2655.0 [00:00<?, ?s/s][A
30469.1s 19099 [A
30469.1s 19100 
30469.1s 19101 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 23.90s/s]
30469.1s 19102 Simulation finished at t = 2655.0000 s after 12549 steps.
30469.1s 19103 Total runtime: 0.63 seconds.
30469.1s 19104 [REWARD_MICROSCOPE] step=14617 t=2655.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30469.1s 19105 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30469.1s 19106 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30469.1s 19107 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30469.1s 19108 Running simulation until t = 2670.00 s, outputting every 15.00 s
30469.1s 19109 
30469.1s 19110 [PROGRESS] Step 12550: t=2655.21/2670.00s (99.4%) | dt=0.2128s
30469.3s 19111 [WARNING] Automatic CFL correction applied (count: 3353600):
30469.3s 19112 Calculated CFL: 0.800 > Limit: 0.500
30469.3s 19113 Original dt: 3.407770e-01 s
30469.3s 19114 Corrected dt: 2.129856e-01 s
30469.3s 19115 Correction factor: 1.6x
30469.3s 19116 Max wave speed detected: 23.48 m/s
30469.6s 19117 [PROGRESS] Step 12600: t=2665.87/2670.00s (99.8%) | dt=0.2133s
30469.6s 19118 [PERIODIC:1000] BC_DISPATCHER [Call #13415000] current_bc_params: <class 'dict'>
30469.6s 19119 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30469.6s 19120 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30469.6s 19121 [PERIODIC:1000] BC_GPU [Call #13415000] About to launch kernel
30469.6s 19122 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30469.6s 19123 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30469.6s 19124 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30469.7s 19125 Stored output at t = 2670.0000 s (Step 12620)
30469.7s 19126 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2655.0/2670.0 [00:00<?, ?s/s][A
30469.7s 19127 [A
30469.7s 19128 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 24.09s/s]
30469.7s 19129 
30469.7s 19130 Simulation finished at t = 2670.0000 s after 12620 steps.
30469.7s 19131 Total runtime: 0.62 seconds.
30469.7s 19132 [REWARD_MICROSCOPE] step=14618 t=2670.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30469.7s 19133 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30469.7s 19134 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30469.7s 19135 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30469.7s 19136 Running simulation until t = 2685.00 s, outputting every 15.00 s
30469.7s 19137 
30470.0s 19138 [PROGRESS] Step 12650: t=2676.37/2685.00s (99.7%) | dt=0.2125s
30470.1s 19139 [WARNING] Automatic CFL correction applied (count: 3353700):
30470.1s 19140 Calculated CFL: 0.800 > Limit: 0.500
30470.1s 19141 Original dt: 3.402034e-01 s
30470.1s 19142 Corrected dt: 2.126271e-01 s
30470.1s 19143 Correction factor: 1.6x
30470.1s 19144 Max wave speed detected: 23.52 m/s
30470.3s 19145 Stored output at t = 2685.0000 s (Step 12691)
30470.3s 19146 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2670.0/2685.0 [00:00<?, ?s/s][A
30470.3s 19147 [A
30470.3s 19148 
30470.3s 19149 Simulation finished at t = 2685.0000 s after 12691 steps.
30470.3s 19150 Total runtime: 0.62 seconds.
30470.3s 19151 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.26s/s]
30470.4s 19152 [REWARD_MICROSCOPE] step=14619 t=2685.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30470.4s 19153 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30470.4s 19154 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30470.4s 19155 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30470.4s 19156 Running simulation until t = 2700.00 s, outputting every 15.00 s
30470.4s 19157 
30470.4s 19158 [PROGRESS] Step 12700: t=2686.92/2700.00s (99.5%) | dt=0.2129s
30470.9s 19159 [PROGRESS] Step 12750: t=2697.57/2700.00s (99.9%) | dt=0.2130s
30471.0s 19160 Stored output at t = 2700.0000 s (Step 12762)
30471.0s 19161 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2685.0/2700.0 [00:00<?, ?s/s][A
30471.0s 19162 [A
30471.0s 19163 
30471.0s 19164 Simulation finished at t = 2700.0000 s after 12762 steps.
30471.0s 19165 Total runtime: 0.64 seconds.
30471.0s 19166 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 23.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 23.45s/s]
30471.0s 19167 [REWARD_MICROSCOPE] step=14620 t=2700.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30471.0s 19168 [STEP  180] t= 2700.0s | phase=0 | reward=   0.01 | total_reward=    1.80
30471.0s 19169 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30471.0s 19170 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30471.0s 19171 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30471.0s 19172 Running simulation until t = 2715.00 s, outputting every 15.00 s
30471.0s 19173 
30471.0s 19174 [WARNING] Automatic CFL correction applied (count: 3353800):
30471.0s 19175 Calculated CFL: 0.800 > Limit: 0.500
30471.0s 19176 Original dt: 3.398708e-01 s
30471.0s 19177 Corrected dt: 2.124193e-01 s
30471.0s 19178 Correction factor: 1.6x
30471.0s 19179 Max wave speed detected: 23.54 m/s
30471.3s 19180 [PROGRESS] Step 12800: t=2708.07/2715.00s (99.7%) | dt=0.2125s
30471.6s 19181 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2700.0/2715.0 [00:00<?, ?s/s][A
30471.6s 19182 [A
30471.6s 19183 Stored output at t = 2715.0000 s (Step 12833)
30471.6s 19184 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.14s/s]
30471.6s 19185 
30471.6s 19186 Simulation finished at t = 2715.0000 s after 12833 steps.
30471.6s 19187 Total runtime: 0.62 seconds.
30471.6s 19188 [QUEUE_DIAGNOSTIC] ===== Step 180 t=2715.0s =====
30471.6s 19189 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30471.6s 19190 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30471.6s 19191 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30471.6s 19192 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30471.6s 19193 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30471.6s 19194 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30471.6s 19195 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30471.6s 19196 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30471.6s 19197 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30471.6s 19198 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30471.6s 19199 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30471.6s 19200 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30471.6s 19201 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30471.6s 19202 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30471.6s 19203 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30471.6s 19204 [REWARD_MICROSCOPE] step=14621 t=2715.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30471.6s 19205 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30471.6s 19206 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30471.6s 19207 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30471.6s 19208 Running simulation until t = 2730.00 s, outputting every 15.00 s
30471.6s 19209 
30471.8s 19210 [PROGRESS] Step 12850: t=2718.62/2730.00s (99.6%) | dt=0.2130s
30471.9s 19211 [PERIODIC:1000] BC_DISPATCHER [Call #13416000] current_bc_params: <class 'dict'>
30471.9s 19212 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30471.9s 19213 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30471.9s 19214 [PERIODIC:1000] BC_GPU [Call #13416000] About to launch kernel
30471.9s 19215 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30471.9s 19216 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30471.9s 19217 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30471.9s 19218 [WARNING] Automatic CFL correction applied (count: 3353900):
30471.9s 19219 Calculated CFL: 0.800 > Limit: 0.500
30471.9s 19220 Original dt: 3.409993e-01 s
30471.9s 19221 Corrected dt: 2.131246e-01 s
30471.9s 19222 Correction factor: 1.6x
30471.9s 19223 Max wave speed detected: 23.46 m/s
30472.2s 19224 [PROGRESS] Step 12900: t=2729.27/2730.00s (100.0%) | dt=0.2127s
30472.3s 19225 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2715.0/2730.0 [00:00<?, ?s/s][A
30472.3s 19226 Stored output at t = 2730.0000 s (Step 12904)
30472.3s 19227 [A
30472.3s 19228 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 23.75s/s]
30472.3s 19229 
30472.3s 19230 Simulation finished at t = 2730.0000 s after 12904 steps.
30472.3s 19231 Total runtime: 0.63 seconds.
30472.3s 19232 [REWARD_MICROSCOPE] step=14622 t=2730.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30472.3s 19233 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30472.3s 19234 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30472.3s 19235 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30472.3s 19236 Running simulation until t = 2745.00 s, outputting every 15.00 s
30472.3s 19237 
30472.7s 19238 [PROGRESS] Step 12950: t=2739.77/2745.00s (99.8%) | dt=0.2126s
30472.8s 19239 [WARNING] Automatic CFL correction applied (count: 3354000):
30472.8s 19240 Calculated CFL: 0.800 > Limit: 0.500
30472.8s 19241 Original dt: 3.404274e-01 s
30472.8s 19242 Corrected dt: 2.127671e-01 s
30472.8s 19243 Correction factor: 1.6x
30472.8s 19244 Max wave speed detected: 23.50 m/s
30472.9s 19245 Stored output at t = 2745.0000 s (Step 12975)
30472.9s 19246 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2730.0/2745.0 [00:00<?, ?s/s][A
30472.9s 19247 [A
30472.9s 19248 
30472.9s 19249 Simulation finished at t = 2745.0000 s after 12975 steps.
30472.9s 19250 Total runtime: 0.62 seconds.
30472.9s 19251 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 24.18s/s]
30472.9s 19252 [REWARD_MICROSCOPE] step=14623 t=2745.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30472.9s 19253 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30472.9s 19254 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30472.9s 19255 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30472.9s 19256 Running simulation until t = 2760.00 s, outputting every 15.00 s
30472.9s 19257 
30473.1s 19258 [PROGRESS] Step 13000: t=2750.32/2760.00s (99.6%) | dt=0.2130s
30473.5s 19259 Stored output at t = 2760.0000 s (Step 13046)
30473.5s 19260 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2745.0/2760.0 [00:00<?, ?s/s][A
30473.5s 19261 [A
30473.5s 19262 
30473.5s 19263 Simulation finished at t = 2760.0000 s after 13046 steps.
30473.5s 19264 Total runtime: 0.64 seconds.
30473.5s 19265 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 23.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 23.31s/s]
30473.5s 19266 [REWARD_MICROSCOPE] step=14624 t=2760.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30473.5s 19267 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30473.5s 19268 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30473.5s 19269 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30473.5s 19270 Running simulation until t = 2775.00 s, outputting every 15.00 s
30473.5s 19271 
30473.6s 19272 [PROGRESS] Step 13050: t=2760.85/2775.00s (99.5%) | dt=0.2124s
30473.7s 19273 [WARNING] Automatic CFL correction applied (count: 3354100):
30473.7s 19274 Calculated CFL: 0.800 > Limit: 0.500
30473.7s 19275 Original dt: 3.398278e-01 s
30473.7s 19276 Corrected dt: 2.123924e-01 s
30473.7s 19277 Correction factor: 1.6x
30473.7s 19278 Max wave speed detected: 23.54 m/s
30474.0s 19279 [PROGRESS] Step 13100: t=2771.47/2775.00s (99.9%) | dt=0.2127s
30474.1s 19280 [PERIODIC:1000] BC_DISPATCHER [Call #13417000] current_bc_params: <class 'dict'>
30474.1s 19281 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30474.1s 19282 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30474.1s 19283 [PERIODIC:1000] BC_GPU [Call #13417000] About to launch kernel
30474.1s 19284 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30474.1s 19285 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30474.1s 19286 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30474.2s 19287 Stored output at t = 2775.0000 s (Step 13117)
30474.2s 19288 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2760.0/2775.0 [00:00<?, ?s/s][A
30474.2s 19289 [A
30474.2s 19290 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 23.95s/s]
30474.2s 19291 
30474.2s 19292 Simulation finished at t = 2775.0000 s after 13117 steps.
30474.2s 19293 Total runtime: 0.63 seconds.
30474.2s 19294 [REWARD_MICROSCOPE] step=14625 t=2775.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30474.2s 19295 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30474.2s 19296 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30474.2s 19297 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30474.2s 19298 Running simulation until t = 2790.00 s, outputting every 15.00 s
30474.2s 19299 
30474.4s 19300 [PROGRESS] Step 13150: t=2782.03/2790.00s (99.7%) | dt=0.2131s
30474.6s 19301 [WARNING] Automatic CFL correction applied (count: 3354200):
30474.6s 19302 Calculated CFL: 0.800 > Limit: 0.500
30474.6s 19303 Original dt: 3.412149e-01 s
30474.6s 19304 Corrected dt: 2.132593e-01 s
30474.6s 19305 Correction factor: 1.6x
30474.6s 19306 Max wave speed detected: 23.45 m/s
30474.8s 19307 Stored output at t = 2790.0000 s (Step 13188)
30474.8s 19308 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2775.0/2790.0 [00:00<?, ?s/s][A
30474.8s 19309 [A
30474.8s 19310 
30474.8s 19311 Simulation finished at t = 2790.0000 s after 13188 steps.
30474.8s 19312 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.57s/s]
30474.8s 19313 Total runtime: 0.61 seconds.
30474.8s 19314 [REWARD_MICROSCOPE] step=14626 t=2790.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30474.8s 19315 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30474.8s 19316 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30474.8s 19317 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30474.8s 19318 Running simulation until t = 2805.00 s, outputting every 15.00 s
30474.8s 19319 
30474.9s 19320 [PROGRESS] Step 13200: t=2792.55/2805.00s (99.6%) | dt=0.2123s
30475.3s 19321 [PROGRESS] Step 13250: t=2803.18/2805.00s (99.9%) | dt=0.2128s
30475.4s 19322 Stored output at t = 2805.0000 s (Step 13259)
30475.4s 19323 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2790.0/2805.0 [00:00<?, ?s/s][A
30475.4s 19324 [A
30475.4s 19325 
30475.4s 19326 Simulation finished at t = 2805.0000 s after 13259 steps.
30475.4s 19327 Total runtime: 0.65 seconds.
30475.4s 19328 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 23.01s/s]
30475.4s 19329 [REWARD_MICROSCOPE] step=14627 t=2805.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30475.4s 19330 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30475.4s 19331 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30475.4s 19332 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30475.4s 19333 Running simulation until t = 2820.00 s, outputting every 15.00 s
30475.4s 19334 
30475.5s 19335 [WARNING] Automatic CFL correction applied (count: 3354300):
30475.5s 19336 Calculated CFL: 0.800 > Limit: 0.500
30475.5s 19337 Original dt: 3.406380e-01 s
30475.5s 19338 Corrected dt: 2.128988e-01 s
30475.5s 19339 Correction factor: 1.6x
30475.5s 19340 Max wave speed detected: 23.49 m/s
30475.8s 19341 [PROGRESS] Step 13300: t=2813.73/2820.00s (99.8%) | dt=0.2132s
30476.0s 19342 Stored output at t = 2820.0000 s (Step 13330)
30476.0s 19343 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2805.0/2820.0 [00:00<?, ?s/s][A
30476.0s 19344 [A
30476.0s 19345 
30476.0s 19346 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 24.06s/s]
30476.0s 19347 Simulation finished at t = 2820.0000 s after 13330 steps.
30476.0s 19348 Total runtime: 0.62 seconds.
30476.0s 19349 [REWARD_MICROSCOPE] step=14628 t=2820.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30476.0s 19350 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30476.0s 19351 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30476.0s 19352 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30476.0s 19353 Running simulation until t = 2835.00 s, outputting every 15.00 s
30476.0s 19354 
30476.2s 19355 [PROGRESS] Step 13350: t=2824.25/2835.00s (99.6%) | dt=0.2124s
30476.3s 19356 [PERIODIC:1000] BC_DISPATCHER [Call #13418000] current_bc_params: <class 'dict'>
30476.3s 19357 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30476.3s 19358 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30476.3s 19359 [PERIODIC:1000] BC_GPU [Call #13418000] About to launch kernel
30476.3s 19360 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30476.3s 19361 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30476.3s 19362 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30476.4s 19363 [WARNING] Automatic CFL correction applied (count: 3354400):
30476.4s 19364 Calculated CFL: 0.800 > Limit: 0.500
30476.4s 19365 Original dt: 3.400643e-01 s
30476.4s 19366 Corrected dt: 2.125402e-01 s
30476.4s 19367 Correction factor: 1.6x
30476.4s 19368 Max wave speed detected: 23.52 m/s
30476.7s 19369 [PROGRESS] Step 13400: t=2834.88/2835.00s (100.0%) | dt=0.2128s
30476.7s 19370 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2820.0/2835.0 [00:00<?, ?s/s][A
30476.7s 19371 [A
30476.7s 19372 Stored output at t = 2835.0000 s (Step 13401)
30476.7s 19373 
30476.7s 19374 Simulation finished at t = 2835.0000 s after 13401 steps.
30476.7s 19375 Total runtime: 0.62 seconds.
30476.7s 19376 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.11s/s]
30476.7s 19377 [REWARD_MICROSCOPE] step=14629 t=2835.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30476.7s 19378 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30476.7s 19379 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30476.7s 19380 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30476.7s 19381 Running simulation until t = 2850.00 s, outputting every 15.00 s
30476.7s 19382 
30477.1s 19383 [PROGRESS] Step 13450: t=2845.44/2850.00s (99.8%) | dt=0.2133s
30477.2s 19384 [WARNING] Automatic CFL correction applied (count: 3354500):
30477.2s 19385 Calculated CFL: 0.800 > Limit: 0.500
30477.2s 19386 Original dt: 3.403351e-01 s
30477.2s 19387 Corrected dt: 2.127094e-01 s
30477.2s 19388 Correction factor: 1.6x
30477.2s 19389 Max wave speed detected: 23.51 m/s
30477.3s 19390 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2835.0/2850.0 [00:00<?, ?s/s][A
30477.3s 19391 [A
30477.3s 19392 Stored output at t = 2850.0000 s (Step 13472)
30477.3s 19393 
30477.3s 19394 Simulation finished at t = 2850.0000 s after 13472 steps.
30477.3s 19395 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 23.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 23.91s/s]
30477.3s 19396 Total runtime: 0.63 seconds.
30477.3s 19397 [REWARD_MICROSCOPE] step=14630 t=2850.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30477.3s 19398 [STEP  190] t= 2850.0s | phase=0 | reward=   0.01 | total_reward=    1.90
30477.3s 19399 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30477.3s 19400 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30477.3s 19401 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30477.3s 19402 Running simulation until t = 2865.00 s, outputting every 15.00 s
30477.3s 19403 
30477.6s 19404 [PROGRESS] Step 13500: t=2855.95/2865.00s (99.7%) | dt=0.2125s
30477.9s 19405 Stored output at t = 2865.0000 s (Step 13543)
30477.9s 19406 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2850.0/2865.0 [00:00<?, ?s/s][A
30477.9s 19407 [A
30477.9s 19408 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 23.87s/s]
30477.9s 19409 
30477.9s 19410 Simulation finished at t = 2865.0000 s after 13543 steps.
30477.9s 19411 Total runtime: 0.63 seconds.
30477.9s 19412 [QUEUE_DIAGNOSTIC] ===== Step 190 t=2865.0s =====
30477.9s 19413 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30477.9s 19414 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30477.9s 19415 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30477.9s 19416 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30477.9s 19417 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30477.9s 19418 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30477.9s 19419 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30477.9s 19420 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30477.9s 19421 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30477.9s 19422 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30477.9s 19423 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30477.9s 19424 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30477.9s 19425 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30477.9s 19426 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30477.9s 19427 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30477.9s 19428 [REWARD_MICROSCOPE] step=14631 t=2865.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30477.9s 19429 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30477.9s 19430 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30477.9s 19431 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30477.9s 19432 Running simulation until t = 2880.00 s, outputting every 15.00 s
30477.9s 19433 
30478.0s 19434 [PROGRESS] Step 13550: t=2866.49/2880.00s (99.5%) | dt=0.2129s
30478.1s 19435 [WARNING] Automatic CFL correction applied (count: 3354600):
30478.1s 19436 Calculated CFL: 0.800 > Limit: 0.500
30478.1s 19437 Original dt: 3.408612e-01 s
30478.1s 19438 Corrected dt: 2.130383e-01 s
30478.1s 19439 Correction factor: 1.6x
30478.1s 19440 Max wave speed detected: 23.47 m/s
30478.4s 19441 [PROGRESS] Step 13600: t=2877.15/2880.00s (99.9%) | dt=0.2131s
30478.5s 19442 [PERIODIC:1000] BC_DISPATCHER [Call #13419000] current_bc_params: <class 'dict'>
30478.5s 19443 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30478.5s 19444 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30478.5s 19445 [PERIODIC:1000] BC_GPU [Call #13419000] About to launch kernel
30478.5s 19446 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30478.5s 19447 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30478.5s 19448 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30478.6s 19449 Stored output at t = 2880.0000 s (Step 13614)
30478.6s 19450 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2865.0/2880.0 [00:00<?, ?s/s][A
30478.6s 19451 [A
30478.6s 19452 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.76s/s]
30478.6s 19453 
30478.6s 19454 Simulation finished at t = 2880.0000 s after 13614 steps.
30478.6s 19455 Total runtime: 0.63 seconds.
30478.6s 19456 [REWARD_MICROSCOPE] step=14632 t=2880.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30478.6s 19457 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30478.6s 19458 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30478.6s 19459 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30478.6s 19460 Running simulation until t = 2895.00 s, outputting every 15.00 s
30478.6s 19461 
30478.9s 19462 [PROGRESS] Step 13650: t=2887.65/2895.00s (99.7%) | dt=0.2125s
30479.0s 19463 [WARNING] Automatic CFL correction applied (count: 3354700):
30479.0s 19464 Calculated CFL: 0.800 > Limit: 0.500
30479.0s 19465 Original dt: 3.402871e-01 s
30479.0s 19466 Corrected dt: 2.126795e-01 s
30479.0s 19467 Correction factor: 1.6x
30479.0s 19468 Max wave speed detected: 23.51 m/s
30479.2s 19469 Stored output at t = 2895.0000 s (Step 13685)
30479.2s 19470 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2880.0/2895.0 [00:00<?, ?s/s][A
30479.2s 19471 [A
30479.2s 19472 
30479.2s 19473 Simulation finished at t = 2895.0000 s after 13685 steps.
30479.2s 19474 Total runtime: 0.62 seconds.
30479.2s 19475 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 24.36s/s]
30479.2s 19476 [REWARD_MICROSCOPE] step=14633 t=2895.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30479.2s 19477 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30479.2s 19478 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30479.2s 19479 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30479.2s 19480 Running simulation until t = 2910.00 s, outputting every 15.00 s
30479.2s 19481 
30479.3s 19482 [PROGRESS] Step 13700: t=2898.19/2910.00s (99.6%) | dt=0.2130s
30479.8s 19483 [PROGRESS] Step 13750: t=2908.85/2910.00s (100.0%) | dt=0.2127s
30479.8s 19484 Stored output at t = 2910.0000 s (Step 13756)
30479.8s 19485 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2895.0/2910.0 [00:00<?, ?s/s][A
30479.8s 19486 [A
30479.8s 19487 
30479.8s 19488 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 24.25s/s]
30479.8s 19489 Simulation finished at t = 2910.0000 s after 13756 steps.
30479.8s 19490 Total runtime: 0.62 seconds.
30479.8s 19491 [REWARD_MICROSCOPE] step=14634 t=2910.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30479.8s 19492 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30479.8s 19493 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30479.8s 19494 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30479.8s 19495 Running simulation until t = 2925.00 s, outputting every 15.00 s
30479.8s 19496 
30479.9s 19497 [WARNING] Automatic CFL correction applied (count: 3354800):
30479.9s 19498 Calculated CFL: 0.800 > Limit: 0.500
30479.9s 19499 Original dt: 3.397169e-01 s
30479.9s 19500 Corrected dt: 2.123230e-01 s
30479.9s 19501 Correction factor: 1.6x
30479.9s 19502 Max wave speed detected: 23.55 m/s
30480.2s 19503 [PROGRESS] Step 13800: t=2919.35/2925.00s (99.8%) | dt=0.2126s
30480.4s 19504 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2910.0/2925.0 [00:00<?, ?s/s][A
30480.4s 19505 [A
30480.4s 19506 Stored output at t = 2925.0000 s (Step 13827)
30480.4s 19507 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.95s/s]
30480.4s 19508 
30480.4s 19509 Simulation finished at t = 2925.0000 s after 13827 steps.
30480.4s 19510 Total runtime: 0.63 seconds.
30480.4s 19511 [REWARD_MICROSCOPE] step=14635 t=2925.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30480.4s 19512 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30480.4s 19513 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30480.4s 19514 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30480.4s 19515 Running simulation until t = 2940.00 s, outputting every 15.00 s
30480.4s 19516 
30480.7s 19517 [PROGRESS] Step 13850: t=2929.90/2940.00s (99.7%) | dt=0.2130s
30480.8s 19518 [PERIODIC:1000] BC_DISPATCHER [Call #13420000] current_bc_params: <class 'dict'>
30480.8s 19519 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30480.8s 19520 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30480.8s 19521 [PERIODIC:1000] BC_GPU [Call #13420000] About to launch kernel
30480.8s 19522 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30480.8s 19523 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30480.8s 19524 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30480.8s 19525 [WARNING] Automatic CFL correction applied (count: 3354900):
30480.8s 19526 Calculated CFL: 0.800 > Limit: 0.500
30480.8s 19527 Original dt: 3.410795e-01 s
30480.8s 19528 Corrected dt: 2.131747e-01 s
30480.8s 19529 Correction factor: 1.6x
30480.8s 19530 Max wave speed detected: 23.45 m/s
30481.1s 19531 Stored output at t = 2940.0000 s (Step 13898)
30481.1s 19532 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2925.0/2940.0 [00:00<?, ?s/s][A
30481.1s 19533 [A
30481.1s 19534 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 22.66s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 22.65s/s]
30481.1s 19535 
30481.1s 19536 Simulation finished at t = 2940.0000 s after 13898 steps.
30481.1s 19537 Total runtime: 0.66 seconds.
30481.1s 19538 [REWARD_MICROSCOPE] step=14636 t=2940.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30481.1s 19539 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30481.1s 19540 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30481.1s 19541 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30481.1s 19542 Running simulation until t = 2955.00 s, outputting every 15.00 s
30481.1s 19543 
30481.1s 19544 [PROGRESS] Step 13900: t=2940.43/2955.00s (99.5%) | dt=0.2125s
30481.6s 19545 [PROGRESS] Step 13950: t=2951.05/2955.00s (99.9%) | dt=0.2127s
30481.7s 19546 [WARNING] Automatic CFL correction applied (count: 3355000):
30481.7s 19547 Calculated CFL: 0.800 > Limit: 0.500
30481.7s 19548 Original dt: 3.405090e-01 s
30481.7s 19549 Corrected dt: 2.128181e-01 s
30481.7s 19550 Correction factor: 1.6x
30481.7s 19551 Max wave speed detected: 23.49 m/s
30481.7s 19552 Stored output at t = 2955.0000 s (Step 13969)
30481.7s 19553 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2940.0/2955.0 [00:00<?, ?s/s][A
30481.7s 19554 [A
30481.7s 19555 
30481.7s 19556 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 24.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 24.67s/s]
30481.7s 19557 Simulation finished at t = 2955.0000 s after 13969 steps.
30481.7s 19558 Total runtime: 0.61 seconds.
30481.7s 19559 [REWARD_MICROSCOPE] step=14637 t=2955.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30481.7s 19560 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30481.7s 19561 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30481.7s 19562 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30481.7s 19563 Running simulation until t = 2970.00 s, outputting every 15.00 s
30481.7s 19564 
30482.0s 19565 [PROGRESS] Step 14000: t=2961.60/2970.00s (99.7%) | dt=0.2131s
30482.3s 19566 Stored output at t = 2970.0000 s (Step 14040)
30482.3s 19567 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2955.0/2970.0 [00:00<?, ?s/s][A
30482.3s 19568 [A
30482.3s 19569 
30482.3s 19570 Simulation finished at t = 2970.0000 s after 14040 steps.
30482.3s 19571 Total runtime: 0.63 seconds.
30482.3s 19572 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.95s/s]
30482.3s 19573 [REWARD_MICROSCOPE] step=14638 t=2970.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30482.3s 19574 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30482.3s 19575 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30482.3s 19576 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30482.3s 19577 Running simulation until t = 2985.00 s, outputting every 15.00 s
30482.3s 19578 
30482.4s 19579 [PROGRESS] Step 14050: t=2972.12/2985.00s (99.6%) | dt=0.2123s
30482.6s 19580 [WARNING] Automatic CFL correction applied (count: 3355100):
30482.6s 19581 Calculated CFL: 0.800 > Limit: 0.500
30482.6s 19582 Original dt: 3.399193e-01 s
30482.6s 19583 Corrected dt: 2.124495e-01 s
30482.6s 19584 Correction factor: 1.6x
30482.6s 19585 Max wave speed detected: 23.53 m/s
30482.9s 19586 [PROGRESS] Step 14100: t=2982.75/2985.00s (99.9%) | dt=0.2127s
30483.0s 19587 [PERIODIC:1000] BC_DISPATCHER [Call #13421000] current_bc_params: <class 'dict'>
30483.0s 19588 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30483.0s 19589 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30483.0s 19590 [PERIODIC:1000] BC_GPU [Call #13421000] About to launch kernel
30483.0s 19591 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30483.0s 19592 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30483.0s 19593 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30483.0s 19594 Stored output at t = 2985.0000 s (Step 14111)
30483.0s 19595 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2970.0/2985.0 [00:00<?, ?s/s][A
30483.0s 19596 [A
30483.0s 19597 
30483.0s 19598 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 24.25s/s]
30483.0s 19599 Simulation finished at t = 2985.0000 s after 14111 steps.
30483.0s 19600 Total runtime: 0.62 seconds.
30483.0s 19601 [REWARD_MICROSCOPE] step=14639 t=2985.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30483.0s 19602 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30483.0s 19603 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30483.0s 19604 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30483.0s 19605 Running simulation until t = 3000.00 s, outputting every 15.00 s
30483.0s 19606 
30483.3s 19607 [PROGRESS] Step 14150: t=2993.31/3000.00s (99.8%) | dt=0.2132s
30483.5s 19608 [WARNING] Automatic CFL correction applied (count: 3355200):
30483.5s 19609 Calculated CFL: 0.800 > Limit: 0.500
30483.5s 19610 Original dt: 3.411066e-01 s
30483.5s 19611 Corrected dt: 2.131916e-01 s
30483.5s 19612 Correction factor: 1.6x
30483.5s 19613 Max wave speed detected: 23.45 m/s
30483.6s 19614 Stored output at t = 3000.0000 s (Step 14182)
30483.6s 19615 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2985.0/3000.0 [00:00<?, ?s/s][A
30483.6s 19616 [A
30483.6s 19617 
30483.6s 19618 Simulation finished at t = 3000.0000 s after 14182 steps.
30483.6s 19619 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.19s/s]
30483.6s 19620 Total runtime: 0.65 seconds.
30483.6s 19621 [REWARD_MICROSCOPE] step=14640 t=3000.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30483.6s 19622 [STEP  200] t= 3000.0s | phase=0 | reward=   0.01 | total_reward=    2.00
30483.6s 19623 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30483.6s 19624 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30483.6s 19625 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30483.6s 19626 Running simulation until t = 3015.00 s, outputting every 15.00 s
30483.6s 19627 
30483.8s 19628 [PROGRESS] Step 14200: t=3003.82/3015.00s (99.6%) | dt=0.2124s
30484.2s 19629 [PROGRESS] Step 14250: t=3014.45/3015.00s (100.0%) | dt=0.2128s
30484.2s 19630 Stored output at t = 3015.0000 s (Step 14253)
30484.2s 19631 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3000.0/3015.0 [00:00<?, ?s/s][A
30484.2s 19632 [A
30484.2s 19633 
30484.2s 19634 Simulation finished at t = 3015.0000 s after 14253 steps.
30484.2s 19635 Total runtime: 0.62 seconds.
30484.2s 19636 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 24.17s/s]
30484.2s 19637 [QUEUE_DIAGNOSTIC] ===== Step 200 t=3015.0s =====
30484.2s 19638 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30484.2s 19639 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30484.2s 19640 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30484.2s 19641 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30484.2s 19642 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30484.2s 19643 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30484.2s 19644 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30484.2s 19645 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30484.2s 19646 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30484.2s 19647 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30484.2s 19648 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30484.2s 19649 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30484.2s 19650 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30484.2s 19651 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30484.2s 19652 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30484.2s 19653 [REWARD_MICROSCOPE] step=14641 t=3015.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30484.2s 19654 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30484.2s 19655 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30484.2s 19656 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30484.2s 19657 Running simulation until t = 3030.00 s, outputting every 15.00 s
30484.2s 19658 
30484.4s 19659 [WARNING] Automatic CFL correction applied (count: 3355300):
30484.4s 19660 Calculated CFL: 0.800 > Limit: 0.500
30484.4s 19661 Original dt: 3.407212e-01 s
30484.4s 19662 Corrected dt: 2.129508e-01 s
30484.4s 19663 Correction factor: 1.6x
30484.4s 19664 Max wave speed detected: 23.48 m/s
30484.6s 19665 [PROGRESS] Step 14300: t=3025.01/3030.00s (99.8%) | dt=0.2132s
30484.8s 19666 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3015.0/3030.0 [00:00<?, ?s/s][A
30484.8s 19667 [A
30484.8s 19668 Stored output at t = 3030.0000 s (Step 14324)
30484.8s 19669 
30484.8s 19670 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 24.79s/s]
30484.8s 19671 Simulation finished at t = 3030.0000 s after 14324 steps.
30484.8s 19672 Total runtime: 0.61 seconds.
30484.8s 19673 [REWARD_MICROSCOPE] step=14642 t=3030.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30484.9s 19674 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30484.9s 19675 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30484.9s 19676 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30484.9s 19677 Running simulation until t = 3045.00 s, outputting every 15.00 s
30484.9s 19678 
30485.1s 19679 [PROGRESS] Step 14350: t=3035.52/3045.00s (99.7%) | dt=0.2124s
30485.2s 19680 [PERIODIC:1000] BC_DISPATCHER [Call #13422000] current_bc_params: <class 'dict'>
30485.2s 19681 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30485.2s 19682 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30485.2s 19683 [PERIODIC:1000] BC_GPU [Call #13422000] About to launch kernel
30485.2s 19684 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30485.2s 19685 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30485.2s 19686 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30485.2s 19687 [WARNING] Automatic CFL correction applied (count: 3355400):
30485.2s 19688 Calculated CFL: 0.800 > Limit: 0.500
30485.2s 19689 Original dt: 3.401477e-01 s
30485.2s 19690 Corrected dt: 2.125923e-01 s
30485.2s 19691 Correction factor: 1.6x
30485.2s 19692 Max wave speed detected: 23.52 m/s
30485.5s 19693 Stored output at t = 3045.0000 s (Step 14395)
30485.5s 19694 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3030.0/3045.0 [00:00<?, ?s/s][A
30485.5s 19695 [A
30485.5s 19696 
30485.5s 19697 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 24.09s/s]
30485.5s 19698 Simulation finished at t = 3045.0000 s after 14395 steps.
30485.5s 19699 Total runtime: 0.62 seconds.
30485.5s 19700 [REWARD_MICROSCOPE] step=14643 t=3045.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30485.5s 19701 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30485.5s 19702 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30485.5s 19703 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30485.5s 19704 Running simulation until t = 3060.00 s, outputting every 15.00 s
30485.5s 19705 
30485.5s 19706 [PROGRESS] Step 14400: t=3046.06/3060.00s (99.5%) | dt=0.2129s
30486.0s 19707 [PROGRESS] Step 14450: t=3056.72/3060.00s (99.9%) | dt=0.2133s
30486.1s 19708 Stored output at t = 3060.0000 s (Step 14466)
30486.1s 19709 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3045.0/3060.0 [00:00<?, ?s/s][A
30486.1s 19710 [A
30486.1s 19711 
30486.1s 19712 Simulation finished at t = 3060.0000 s after 14466 steps.
30486.1s 19713 Total runtime: 0.62 seconds.
30486.1s 19714 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 24.25s/s]
30486.1s 19715 [REWARD_MICROSCOPE] step=14644 t=3060.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30486.1s 19716 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30486.1s 19717 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30486.1s 19718 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30486.1s 19719 Running simulation until t = 3075.00 s, outputting every 15.00 s
30486.1s 19720 
30486.1s 19721 [WARNING] Automatic CFL correction applied (count: 3355500):
30486.1s 19722 Calculated CFL: 0.800 > Limit: 0.500
30486.1s 19723 Original dt: 3.400436e-01 s
30486.1s 19724 Corrected dt: 2.125273e-01 s
30486.1s 19725 Correction factor: 1.6x
30486.1s 19726 Max wave speed detected: 23.53 m/s
30486.4s 19727 [PROGRESS] Step 14500: t=3067.22/3075.00s (99.7%) | dt=0.2125s
30486.7s 19728 Stored output at t = 3075.0000 s (Step 14537)
30486.7s 19729 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3060.0/3075.0 [00:00<?, ?s/s][A
30486.7s 19730 [A
30486.7s 19731 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.28s/s]
30486.7s 19732 
30486.7s 19733 Simulation finished at t = 3075.0000 s after 14537 steps.
30486.7s 19734 Total runtime: 0.62 seconds.
30486.7s 19735 [REWARD_MICROSCOPE] step=14645 t=3075.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30486.7s 19736 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30486.7s 19737 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30486.7s 19738 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30486.7s 19739 Running simulation until t = 3090.00 s, outputting every 15.00 s
30486.7s 19740 
30486.8s 19741 [PROGRESS] Step 14550: t=3077.77/3090.00s (99.6%) | dt=0.2129s
30487.0s 19742 [WARNING] Automatic CFL correction applied (count: 3355600):
30487.0s 19743 Calculated CFL: 0.800 > Limit: 0.500
30487.0s 19744 Original dt: 3.409462e-01 s
30487.0s 19745 Corrected dt: 2.130914e-01 s
30487.0s 19746 Correction factor: 1.6x
30487.0s 19747 Max wave speed detected: 23.46 m/s
30487.3s 19748 [PROGRESS] Step 14600: t=3088.42/3090.00s (99.9%) | dt=0.2128s
30487.4s 19749 Stored output at t = 3090.0000 s (Step 14608)
30487.4s 19750 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3075.0/3090.0 [00:00<?, ?s/s][A
30487.4s 19751 [A
30487.4s 19752 
30487.4s 19753 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 23.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 23.51s/s]
30487.4s 19754 Simulation finished at t = 3090.0000 s after 14608 steps.
30487.4s 19755 Total runtime: 0.64 seconds.
30487.4s 19756 [REWARD_MICROSCOPE] step=14646 t=3090.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30487.4s 19757 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30487.4s 19758 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30487.4s 19759 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30487.4s 19760 Running simulation until t = 3105.00 s, outputting every 15.00 s
30487.4s 19761 
30487.4s 19762 [PERIODIC:1000] BC_DISPATCHER [Call #13423000] current_bc_params: <class 'dict'>
30487.4s 19763 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30487.4s 19764 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30487.4s 19765 [PERIODIC:1000] BC_GPU [Call #13423000] About to launch kernel
30487.4s 19766 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30487.4s 19767 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30487.4s 19768 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30487.7s 19769 [PROGRESS] Step 14650: t=3098.92/3105.00s (99.8%) | dt=0.2126s
30487.9s 19770 [WARNING] Automatic CFL correction applied (count: 3355700):
30487.9s 19771 Calculated CFL: 0.800 > Limit: 0.500
30487.9s 19772 Original dt: 3.403711e-01 s
30487.9s 19773 Corrected dt: 2.127320e-01 s
30487.9s 19774 Correction factor: 1.6x
30487.9s 19775 Max wave speed detected: 23.50 m/s
30488.0s 19776 Stored output at t = 3105.0000 s (Step 14679)
30488.0s 19777 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3090.0/3105.0 [00:00<?, ?s/s][A
30488.0s 19778 [A
30488.0s 19779 
30488.0s 19780 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.31s/s]
30488.0s 19781 Simulation finished at t = 3105.0000 s after 14679 steps.
30488.0s 19782 Total runtime: 0.62 seconds.
30488.0s 19783 [REWARD_MICROSCOPE] step=14647 t=3105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30488.0s 19784 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30488.0s 19785 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30488.0s 19786 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30488.0s 19787 Running simulation until t = 3120.00 s, outputting every 15.00 s
30488.0s 19788 
30488.2s 19789 [PROGRESS] Step 14700: t=3109.47/3120.00s (99.7%) | dt=0.2130s
30488.6s 19790 [PROGRESS] Step 14750: t=3120.00/3120.00s (100.0%) | dt=0.0883s
30488.6s 19791 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3105.0/3120.0 [00:00<?, ?s/s][A
30488.6s 19792 [A
30488.6s 19793 Stored output at t = 3120.0000 s (Step 14750)
30488.6s 19794 
30488.6s 19795 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 24.26s/s]
30488.6s 19796 Simulation finished at t = 3120.0000 s after 14750 steps.
30488.6s 19797 Total runtime: 0.62 seconds.
30488.6s 19798 [REWARD_MICROSCOPE] step=14648 t=3120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30488.6s 19799 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30488.6s 19800 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30488.6s 19801 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30488.6s 19802 Running simulation until t = 3135.00 s, outputting every 15.00 s
30488.6s 19803 
30488.7s 19804 [WARNING] Automatic CFL correction applied (count: 3355800):
30488.7s 19805 Calculated CFL: 0.800 > Limit: 0.500
30488.7s 19806 Original dt: 3.397675e-01 s
30488.7s 19807 Corrected dt: 2.123547e-01 s
30488.7s 19808 Correction factor: 1.6x
30488.7s 19809 Max wave speed detected: 23.55 m/s
30489.0s 19810 [PROGRESS] Step 14800: t=3130.62/3135.00s (99.9%) | dt=0.2127s
30489.2s 19811 Stored output at t = 3135.0000 s (Step 14821)
30489.2s 19812 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3120.0/3135.0 [00:00<?, ?s/s][A
30489.2s 19813 [A
30489.2s 19814 
30489.2s 19815 Simulation finished at t = 3135.0000 s after 14821 steps.
30489.2s 19816 Total runtime: 0.63 seconds.
30489.2s 19817 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.98s/s]
30489.2s 19818 [REWARD_MICROSCOPE] step=14649 t=3135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30489.2s 19819 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30489.2s 19820 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30489.2s 19821 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30489.2s 19822 Running simulation until t = 3150.00 s, outputting every 15.00 s
30489.2s 19823 
30489.5s 19824 [PROGRESS] Step 14850: t=3141.18/3150.00s (99.7%) | dt=0.2131s
30489.6s 19825 [PERIODIC:1000] BC_DISPATCHER [Call #13424000] current_bc_params: <class 'dict'>
30489.6s 19826 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30489.6s 19827 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30489.6s 19828 [PERIODIC:1000] BC_GPU [Call #13424000] About to launch kernel
30489.6s 19829 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30489.6s 19830 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30489.6s 19831 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30489.6s 19832 [WARNING] Automatic CFL correction applied (count: 3355900):
30489.6s 19833 Calculated CFL: 0.800 > Limit: 0.500
30489.6s 19834 Original dt: 3.411605e-01 s
30489.6s 19835 Corrected dt: 2.132253e-01 s
30489.6s 19836 Correction factor: 1.6x
30489.6s 19837 Max wave speed detected: 23.45 m/s
30489.8s 19838 Stored output at t = 3150.0000 s (Step 14892)
30489.8s 19839 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3135.0/3150.0 [00:00<?, ?s/s][A
30489.8s 19840 [A
30489.8s 19841 
30489.8s 19842 Simulation finished at t = 3150.0000 s after 14892 steps.
30489.8s 19843 Total runtime: 0.61 seconds.
30489.8s 19844 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.44s/s]
30489.8s 19845 [REWARD_MICROSCOPE] step=14650 t=3150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30489.8s 19846 [STEP  210] t= 3150.0s | phase=0 | reward=   0.01 | total_reward=    2.10
30489.8s 19847 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30489.8s 19848 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30489.8s 19849 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30489.8s 19850 Running simulation until t = 3165.00 s, outputting every 15.00 s
30489.8s 19851 
30489.9s 19852 [PROGRESS] Step 14900: t=3151.70/3165.00s (99.6%) | dt=0.2124s
30490.3s 19853 [PROGRESS] Step 14950: t=3162.32/3165.00s (99.9%) | dt=0.2127s
30490.5s 19854 Stored output at t = 3165.0000 s (Step 14963)
30490.5s 19855 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3150.0/3165.0 [00:00<?, ?s/s][A
30490.5s 19856 [A
30490.5s 19857 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.37s/s]
30490.5s 19858 
30490.5s 19859 Simulation finished at t = 3165.0000 s after 14963 steps.
30490.5s 19860 Total runtime: 0.62 seconds.
30490.5s 19861 [QUEUE_DIAGNOSTIC] ===== Step 210 t=3165.0s =====
30490.5s 19862 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30490.5s 19863 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30490.5s 19864 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30490.5s 19865 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30490.5s 19866 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30490.5s 19867 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30490.5s 19868 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30490.5s 19869 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30490.5s 19870 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30490.5s 19871 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30490.5s 19872 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30490.5s 19873 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30490.5s 19874 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30490.5s 19875 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30490.5s 19876 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30490.5s 19877 [REWARD_MICROSCOPE] step=14651 t=3165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30490.5s 19878 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30490.5s 19879 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30490.5s 19880 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30490.5s 19881 Running simulation until t = 3180.00 s, outputting every 15.00 s
30490.5s 19882 
30490.5s 19883 [WARNING] Automatic CFL correction applied (count: 3356000):
30490.5s 19884 Calculated CFL: 0.800 > Limit: 0.500
30490.5s 19885 Original dt: 3.405828e-01 s
30490.5s 19886 Corrected dt: 2.128643e-01 s
30490.5s 19887 Correction factor: 1.6x
30490.5s 19888 Max wave speed detected: 23.49 m/s
30490.8s 19889 [PROGRESS] Step 15000: t=3172.88/3180.00s (99.8%) | dt=0.2131s
30491.1s 19890 Stored output at t = 3180.0000 s (Step 15034)
30491.1s 19891 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3165.0/3180.0 [00:00<?, ?s/s][A
30491.1s 19892 [A
30491.1s 19893 
30491.1s 19894 Simulation finished at t = 3180.0000 s after 15034 steps.
30491.1s 19895 Total runtime: 0.65 seconds.
30491.1s 19896 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 23.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 23.19s/s]
30491.1s 19897 [REWARD_MICROSCOPE] step=14652 t=3180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30491.1s 19898 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30491.1s 19899 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30491.1s 19900 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30491.1s 19901 Running simulation until t = 3195.00 s, outputting every 15.00 s
30491.1s 19902 
30491.3s 19903 [PROGRESS] Step 15050: t=3183.40/3195.00s (99.6%) | dt=0.2123s
30491.4s 19904 [WARNING] Automatic CFL correction applied (count: 3356100):
30491.4s 19905 Calculated CFL: 0.800 > Limit: 0.500
30491.4s 19906 Original dt: 3.400085e-01 s
30491.4s 19907 Corrected dt: 2.125053e-01 s
30491.4s 19908 Correction factor: 1.6x
30491.4s 19909 Max wave speed detected: 23.53 m/s
30491.7s 19910 [PROGRESS] Step 15100: t=3194.03/3195.00s (100.0%) | dt=0.2128s
30491.8s 19911 Stored output at t = 3195.0000 s (Step 15105)
30491.8s 19912 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3180.0/3195.0 [00:00<?, ?s/s][A
30491.8s 19913 [A
30491.8s 19914 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.12s/s]
30491.8s 19915 
30491.8s 19916 Simulation finished at t = 3195.0000 s after 15105 steps.
30491.8s 19917 Total runtime: 0.65 seconds.
30491.8s 19918 [REWARD_MICROSCOPE] step=14653 t=3195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30491.8s 19919 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30491.8s 19920 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30491.8s 19921 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30491.8s 19922 Running simulation until t = 3210.00 s, outputting every 15.00 s
30491.8s 19923 
30491.8s 19924 [PERIODIC:1000] BC_DISPATCHER [Call #13425000] current_bc_params: <class 'dict'>
30491.8s 19925 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30491.8s 19926 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30491.8s 19927 [PERIODIC:1000] BC_GPU [Call #13425000] About to launch kernel
30491.8s 19928 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30491.8s 19929 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30491.8s 19930 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30492.2s 19931 [PROGRESS] Step 15150: t=3204.59/3210.00s (99.8%) | dt=0.2132s
30492.3s 19932 [WARNING] Automatic CFL correction applied (count: 3356200):
30492.3s 19933 Calculated CFL: 0.800 > Limit: 0.500
30492.3s 19934 Original dt: 3.406020e-01 s
30492.3s 19935 Corrected dt: 2.128763e-01 s
30492.3s 19936 Correction factor: 1.6x
30492.3s 19937 Max wave speed detected: 23.49 m/s
30492.4s 19938 Stored output at t = 3210.0000 s (Step 15176)
30492.4s 19939 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3195.0/3210.0 [00:00<?, ?s/s][A
30492.4s 19940 [A
30492.4s 19941 
30492.4s 19942 Simulation finished at t = 3210.0000 s after 15176 steps.
30492.4s 19943 Total runtime: 0.64 seconds.
30492.4s 19944 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 23.32s/s]
30492.4s 19945 [REWARD_MICROSCOPE] step=14654 t=3210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30492.4s 19946 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30492.4s 19947 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30492.4s 19948 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30492.4s 19949 Running simulation until t = 3225.00 s, outputting every 15.00 s
30492.4s 19950 
30492.6s 19951 [PROGRESS] Step 15200: t=3215.10/3225.00s (99.7%) | dt=0.2124s
30493.0s 19952 Stored output at t = 3225.0000 s (Step 15247)
30493.0s 19953 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3210.0/3225.0 [00:00<?, ?s/s][A
30493.0s 19954 [A
30493.0s 19955 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.13s/s]
30493.0s 19956 
30493.0s 19957 Simulation finished at t = 3225.0000 s after 15247 steps.
30493.0s 19958 Total runtime: 0.62 seconds.
30493.0s 19959 [REWARD_MICROSCOPE] step=14655 t=3225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30493.0s 19960 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30493.0s 19961 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30493.0s 19962 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30493.0s 19963 Running simulation until t = 3240.00 s, outputting every 15.00 s
30493.0s 19964 
30493.1s 19965 [PROGRESS] Step 15250: t=3225.64/3240.00s (99.6%) | dt=0.2129s
30493.2s 19966 [WARNING] Automatic CFL correction applied (count: 3356300):
30493.2s 19967 Calculated CFL: 0.800 > Limit: 0.500
30493.2s 19968 Original dt: 3.408050e-01 s
30493.2s 19969 Corrected dt: 2.130031e-01 s
30493.2s 19970 Correction factor: 1.6x
30493.2s 19971 Max wave speed detected: 23.47 m/s
30493.5s 19972 [PROGRESS] Step 15300: t=3236.29/3240.00s (99.9%) | dt=0.2133s
30493.7s 19973 Stored output at t = 3240.0000 s (Step 15318)
30493.7s 19974 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3225.0/3240.0 [00:00<?, ?s/s][A
30493.7s 19975 [A
30493.7s 19976 
30493.7s 19977 Simulation finished at t = 3240.0000 s after 15318 steps.
30493.7s 19978 Total runtime: 0.64 seconds.
30493.7s 19979 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 23.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 23.34s/s]
30493.7s 19980 [REWARD_MICROSCOPE] step=14656 t=3240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30493.7s 19981 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30493.7s 19982 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30493.7s 19983 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30493.7s 19984 Running simulation until t = 3255.00 s, outputting every 15.00 s
30493.7s 19985 
30494.0s 19986 [PROGRESS] Step 15350: t=3246.80/3255.00s (99.7%) | dt=0.2125s
30494.1s 19987 [PERIODIC:1000] BC_DISPATCHER [Call #13426000] current_bc_params: <class 'dict'>
30494.1s 19988 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30494.1s 19989 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30494.1s 19990 [PERIODIC:1000] BC_GPU [Call #13426000] About to launch kernel
30494.1s 19991 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30494.1s 19992 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30494.1s 19993 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30494.1s 19994 [WARNING] Automatic CFL correction applied (count: 3356400):
30494.1s 19995 Calculated CFL: 0.800 > Limit: 0.500
30494.1s 19996 Original dt: 3.402313e-01 s
30494.1s 19997 Corrected dt: 2.126446e-01 s
30494.1s 19998 Correction factor: 1.6x
30494.1s 19999 Max wave speed detected: 23.51 m/s
30494.3s 20000 Stored output at t = 3255.0000 s (Step 15389)
30494.3s 20001 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3240.0/3255.0 [00:00<?, ?s/s][A
30494.3s 20002 [A
30494.3s 20003 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 24.31s/s]
30494.3s 20004 
30494.3s 20005 Simulation finished at t = 3255.0000 s after 15389 steps.
30494.3s 20006 Total runtime: 0.62 seconds.
30494.3s 20007 [REWARD_MICROSCOPE] step=14657 t=3255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30494.3s 20008 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30494.3s 20009 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30494.3s 20010 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30494.3s 20011 Running simulation until t = 3270.00 s, outputting every 15.00 s
30494.3s 20012 
30494.4s 20013 [PROGRESS] Step 15400: t=3257.34/3270.00s (99.6%) | dt=0.2129s
30494.8s 20014 [PROGRESS] Step 15450: t=3268.00/3270.00s (99.9%) | dt=0.2129s
30494.9s 20015 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3255.0/3270.0 [00:00<?, ?s/s][A
30494.9s 20016 [A
30494.9s 20017 Stored output at t = 3270.0000 s (Step 15460)
30494.9s 20018 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.36s/s]
30494.9s 20019 
30494.9s 20020 Simulation finished at t = 3270.0000 s after 15460 steps.
30494.9s 20021 Total runtime: 0.62 seconds.
30494.9s 20022 [REWARD_MICROSCOPE] step=14658 t=3270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30494.9s 20023 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30494.9s 20024 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30494.9s 20025 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30494.9s 20026 Running simulation until t = 3285.00 s, outputting every 15.00 s
30494.9s 20027 
30495.0s 20028 [WARNING] Automatic CFL correction applied (count: 3356500):
30495.0s 20029 Calculated CFL: 0.800 > Limit: 0.500
30495.0s 20030 Original dt: 3.398030e-01 s
30495.0s 20031 Corrected dt: 2.123769e-01 s
30495.0s 20032 Correction factor: 1.6x
30495.0s 20033 Max wave speed detected: 23.54 m/s
30495.3s 20034 [PROGRESS] Step 15500: t=3278.50/3285.00s (99.8%) | dt=0.2126s
30495.6s 20035 Stored output at t = 3285.0000 s (Step 15531)
30495.6s 20036 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3270.0/3285.0 [00:00<?, ?s/s][A
30495.6s 20037 [A
30495.6s 20038 
30495.6s 20039 Simulation finished at t = 3285.0000 s after 15531 steps.
30495.6s 20040 Total runtime: 0.64 seconds.
30495.6s 20041 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 23.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 23.41s/s]
30495.6s 20042 [REWARD_MICROSCOPE] step=14659 t=3285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30495.6s 20043 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30495.6s 20044 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30495.6s 20045 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30495.6s 20046 Running simulation until t = 3300.00 s, outputting every 15.00 s
30495.6s 20047 
30495.7s 20048 [PROGRESS] Step 15550: t=3289.05/3300.00s (99.7%) | dt=0.2130s
30495.9s 20049 [WARNING] Automatic CFL correction applied (count: 3356600):
30495.9s 20050 Calculated CFL: 0.800 > Limit: 0.500
30495.9s 20051 Original dt: 3.410260e-01 s
30495.9s 20052 Corrected dt: 2.131412e-01 s
30495.9s 20053 Correction factor: 1.6x
30495.9s 20054 Max wave speed detected: 23.46 m/s
30496.2s 20055 [PROGRESS] Step 15600: t=3299.70/3300.00s (100.0%) | dt=0.2126s
30496.2s 20056 Stored output at t = 3300.0000 s (Step 15602)
30496.2s 20057 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3285.0/3300.0 [00:00<?, ?s/s][A
30496.2s 20058 [A
30496.2s 20059 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.45s/s]
30496.2s 20060 
30496.2s 20061 Simulation finished at t = 3300.0000 s after 15602 steps.
30496.2s 20062 Total runtime: 0.61 seconds.
30496.2s 20063 [REWARD_MICROSCOPE] step=14660 t=3300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30496.2s 20064 [STEP  220] t= 3300.0s | phase=0 | reward=   0.01 | total_reward=    2.20
30496.2s 20065 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30496.2s 20066 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30496.2s 20067 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30496.2s 20068 Running simulation until t = 3315.00 s, outputting every 15.00 s
30496.2s 20069 
30496.3s 20070 [PERIODIC:1000] BC_DISPATCHER [Call #13427000] current_bc_params: <class 'dict'>
30496.3s 20071 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30496.3s 20072 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30496.3s 20073 [PERIODIC:1000] BC_GPU [Call #13427000] About to launch kernel
30496.3s 20074 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30496.3s 20075 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30496.3s 20076 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30496.6s 20077 [PROGRESS] Step 15650: t=3310.20/3315.00s (99.9%) | dt=0.2126s
30496.7s 20078 [WARNING] Automatic CFL correction applied (count: 3356700):
30496.7s 20079 Calculated CFL: 0.800 > Limit: 0.500
30496.7s 20080 Original dt: 3.404547e-01 s
30496.7s 20081 Corrected dt: 2.127842e-01 s
30496.7s 20082 Correction factor: 1.6x
30496.7s 20083 Max wave speed detected: 23.50 m/s
30496.8s 20084 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3300.0/3315.0 [00:00<?, ?s/s][A
30496.8s 20085 Stored output at t = 3315.0000 s (Step 15673)
30496.8s 20086 [A
30496.8s 20087 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.37s/s]
30496.8s 20088 
30496.8s 20089 Simulation finished at t = 3315.0000 s after 15673 steps.
30496.8s 20090 Total runtime: 0.62 seconds.
30496.8s 20091 [QUEUE_DIAGNOSTIC] ===== Step 220 t=3315.0s =====
30496.8s 20092 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30496.8s 20093 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30496.8s 20094 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30496.8s 20095 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30496.8s 20096 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30496.8s 20097 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30496.8s 20098 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30496.8s 20099 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30496.8s 20100 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30496.8s 20101 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30496.8s 20102 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30496.8s 20103 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30496.8s 20104 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30496.8s 20105 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30496.8s 20106 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30496.8s 20107 [REWARD_MICROSCOPE] step=14661 t=3315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30496.8s 20108 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30496.8s 20109 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30496.8s 20110 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30496.8s 20111 Running simulation until t = 3330.00 s, outputting every 15.00 s
30496.8s 20112 
30497.0s 20113 [PROGRESS] Step 15700: t=3320.75/3330.00s (99.7%) | dt=0.2131s
30497.4s 20114 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3315.0/3330.0 [00:00<?, ?s/s][A
30497.4s 20115 Stored output at t = 3330.0000 s (Step 15744)
30497.4s 20116 [A
30497.4s 20117 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 23.78s/s]
30497.4s 20118 
30497.4s 20119 Simulation finished at t = 3330.0000 s after 15744 steps.
30497.4s 20120 Total runtime: 0.63 seconds.
30497.4s 20121 [REWARD_MICROSCOPE] step=14662 t=3330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30497.4s 20122 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30497.4s 20123 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30497.4s 20124 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30497.4s 20125 Running simulation until t = 3345.00 s, outputting every 15.00 s
30497.4s 20126 
30497.5s 20127 [PROGRESS] Step 15750: t=3331.27/3345.00s (99.6%) | dt=0.2124s
30497.6s 20128 [WARNING] Automatic CFL correction applied (count: 3356800):
30497.6s 20129 Calculated CFL: 0.800 > Limit: 0.500
30497.6s 20130 Original dt: 3.398585e-01 s
30497.6s 20131 Corrected dt: 2.124115e-01 s
30497.6s 20132 Correction factor: 1.6x
30497.6s 20133 Max wave speed detected: 23.54 m/s
30497.9s 20134 [PROGRESS] Step 15800: t=3341.90/3345.00s (99.9%) | dt=0.2127s
30498.1s 20135 Stored output at t = 3345.0000 s (Step 15815)
30498.1s 20136 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3330.0/3345.0 [00:00<?, ?s/s][A
30498.1s 20137 [A
30498.1s 20138 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.03s/s]
30498.1s 20139 
30498.1s 20140 Simulation finished at t = 3345.0000 s after 15815 steps.
30498.1s 20141 Total runtime: 0.62 seconds.
30498.1s 20142 [REWARD_MICROSCOPE] step=14663 t=3345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30498.1s 20143 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30498.1s 20144 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30498.1s 20145 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30498.1s 20146 Running simulation until t = 3360.00 s, outputting every 15.00 s
30498.1s 20147 
30498.4s 20148 [PROGRESS] Step 15850: t=3352.45/3360.00s (99.8%) | dt=0.2131s
30498.5s 20149 [PERIODIC:1000] BC_DISPATCHER [Call #13428000] current_bc_params: <class 'dict'>
30498.5s 20150 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30498.5s 20151 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30498.5s 20152 [PERIODIC:1000] BC_GPU [Call #13428000] About to launch kernel
30498.5s 20153 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30498.5s 20154 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30498.5s 20155 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30498.5s 20156 [WARNING] Automatic CFL correction applied (count: 3356900):
30498.5s 20157 Calculated CFL: 0.800 > Limit: 0.500
30498.5s 20158 Original dt: 3.412422e-01 s
30498.5s 20159 Corrected dt: 2.132764e-01 s
30498.5s 20160 Correction factor: 1.6x
30498.5s 20161 Max wave speed detected: 23.44 m/s
30498.7s 20162 Stored output at t = 3360.0000 s (Step 15886)
30498.7s 20163 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3345.0/3360.0 [00:00<?, ?s/s][A
30498.7s 20164 [A
30498.7s 20165 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 23.67s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 23.66s/s]
30498.7s 20166 
30498.7s 20167 Simulation finished at t = 3360.0000 s after 15886 steps.
30498.7s 20168 Total runtime: 0.63 seconds.
30498.7s 20169 [REWARD_MICROSCOPE] step=14664 t=3360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30498.7s 20170 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30498.7s 20171 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30498.7s 20172 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30498.7s 20173 Running simulation until t = 3375.00 s, outputting every 15.00 s
30498.7s 20174 
30498.8s 20175 [PROGRESS] Step 15900: t=3362.97/3375.00s (99.6%) | dt=0.2123s
30499.3s 20176 [PROGRESS] Step 15950: t=3373.60/3375.00s (100.0%) | dt=0.2128s
30499.3s 20177 Stored output at t = 3375.0000 s (Step 15957)
30499.3s 20178 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3360.0/3375.0 [00:00<?, ?s/s][A
30499.3s 20179 [A
30499.3s 20180 
30499.3s 20181 Simulation finished at t = 3375.0000 s after 15957 steps.
30499.3s 20182 Total runtime: 0.62 seconds.
30499.3s 20183 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 24.34s/s]
30499.3s 20184 [REWARD_MICROSCOPE] step=14665 t=3375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30499.3s 20185 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30499.3s 20186 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30499.3s 20187 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30499.3s 20188 Running simulation until t = 3390.00 s, outputting every 15.00 s
30499.3s 20189 
30499.4s 20190 [WARNING] Automatic CFL correction applied (count: 3357000):
30499.4s 20191 Calculated CFL: 0.800 > Limit: 0.500
30499.4s 20192 Original dt: 3.406657e-01 s
30499.4s 20193 Corrected dt: 2.129161e-01 s
30499.4s 20194 Correction factor: 1.6x
30499.4s 20195 Max wave speed detected: 23.48 m/s
30499.7s 20196 [PROGRESS] Step 16000: t=3384.16/3390.00s (99.8%) | dt=0.2132s
30499.9s 20197 Stored output at t = 3390.0000 s (Step 16028)
30499.9s 20198 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3375.0/3390.0 [00:00<?, ?s/s][A
30499.9s 20199 [A
30499.9s 20200 
30499.9s 20201 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.11s/s]
30499.9s 20202 Simulation finished at t = 3390.0000 s after 16028 steps.
30499.9s 20203 Total runtime: 0.62 seconds.
30499.9s 20204 [REWARD_MICROSCOPE] step=14666 t=3390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30499.9s 20205 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30499.9s 20206 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30499.9s 20207 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30499.9s 20208 Running simulation until t = 3405.00 s, outputting every 15.00 s
30499.9s 20209 
30500.1s 20210 [PROGRESS] Step 16050: t=3394.67/3405.00s (99.7%) | dt=0.2124s
30500.3s 20211 [WARNING] Automatic CFL correction applied (count: 3357100):
30500.3s 20212 Calculated CFL: 0.800 > Limit: 0.500
30500.3s 20213 Original dt: 3.400921e-01 s
30500.3s 20214 Corrected dt: 2.125575e-01 s
30500.3s 20215 Correction factor: 1.6x
30500.3s 20216 Max wave speed detected: 23.52 m/s
30500.6s 20217 Stored output at t = 3405.0000 s (Step 16099)
30500.6s 20218 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3390.0/3405.0 [00:00<?, ?s/s][A
30500.6s 20219 [A
30500.6s 20220 
30500.6s 20221 Simulation finished at t = 3405.0000 s after 16099 steps.
30500.6s 20222 Total runtime: 0.62 seconds.
30500.6s 20223 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.31s/s]
30500.6s 20224 [REWARD_MICROSCOPE] step=14667 t=3405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30500.6s 20225 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30500.6s 20226 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30500.6s 20227 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30500.6s 20228 Running simulation until t = 3420.00 s, outputting every 15.00 s
30500.6s 20229 
30500.6s 20230 [PROGRESS] Step 16100: t=3405.21/3420.00s (99.6%) | dt=0.2128s
30500.7s 20231 [PERIODIC:1000] BC_DISPATCHER [Call #13429000] current_bc_params: <class 'dict'>
30500.7s 20232 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30500.7s 20233 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30500.7s 20234 [PERIODIC:1000] BC_GPU [Call #13429000] About to launch kernel
30500.7s 20235 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30500.7s 20236 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30500.7s 20237 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30501.0s 20238 [PROGRESS] Step 16150: t=3415.87/3420.00s (99.9%) | dt=0.2133s
30501.2s 20239 [WARNING] Automatic CFL correction applied (count: 3357200):
30501.2s 20240 Calculated CFL: 0.800 > Limit: 0.500
30501.2s 20241 Original dt: 3.402189e-01 s
30501.2s 20242 Corrected dt: 2.126368e-01 s
30501.2s 20243 Correction factor: 1.6x
30501.2s 20244 Max wave speed detected: 23.51 m/s
30501.2s 20245 Stored output at t = 3420.0000 s (Step 16170)
30501.2s 20246 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3405.0/3420.0 [00:00<?, ?s/s][A
30501.2s 20247 [A
30501.2s 20248 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 23.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 23.29s/s]
30501.2s 20249 
30501.2s 20250 Simulation finished at t = 3420.0000 s after 16170 steps.
30501.2s 20251 Total runtime: 0.64 seconds.
30501.2s 20252 [REWARD_MICROSCOPE] step=14668 t=3420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30501.2s 20253 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30501.2s 20254 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30501.2s 20255 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30501.2s 20256 Running simulation until t = 3435.00 s, outputting every 15.00 s
30501.2s 20257 
30501.5s 20258 [PROGRESS] Step 16200: t=3426.37/3435.00s (99.7%) | dt=0.2125s
30501.8s 20259 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3420.0/3435.0 [00:00<?, ?s/s][A
30501.8s 20260 [A
30501.8s 20261 Stored output at t = 3435.0000 s (Step 16241)
30501.8s 20262 
30501.8s 20263 Simulation finished at t = 3435.0000 s after 16241 steps.
30501.8s 20264 Total runtime: 0.61 seconds.
30501.8s 20265 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.46s/s]
30501.8s 20266 [REWARD_MICROSCOPE] step=14669 t=3435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30501.8s 20267 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30501.8s 20268 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30501.8s 20269 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30501.8s 20270 Running simulation until t = 3450.00 s, outputting every 15.00 s
30501.8s 20271 
30501.9s 20272 [PROGRESS] Step 16250: t=3436.92/3450.00s (99.6%) | dt=0.2129s
30502.1s 20273 [WARNING] Automatic CFL correction applied (count: 3357300):
30502.1s 20274 Calculated CFL: 0.800 > Limit: 0.500
30502.1s 20275 Original dt: 3.408895e-01 s
30502.1s 20276 Corrected dt: 2.130559e-01 s
30502.1s 20277 Correction factor: 1.6x
30502.1s 20278 Max wave speed detected: 23.47 m/s
30502.4s 20279 [PROGRESS] Step 16300: t=3447.57/3450.00s (99.9%) | dt=0.2130s
30502.5s 20280 Stored output at t = 3450.0000 s (Step 16312)
30502.5s 20281 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3435.0/3450.0 [00:00<?, ?s/s][A
30502.5s 20282 [A
30502.5s 20283 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 23.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 23.29s/s]
30502.5s 20284 
30502.5s 20285 Simulation finished at t = 3450.0000 s after 16312 steps.
30502.5s 20286 Total runtime: 0.64 seconds.
30502.5s 20287 [REWARD_MICROSCOPE] step=14670 t=3450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30502.5s 20288 [STEP  230] t= 3450.0s | phase=0 | reward=   0.01 | total_reward=    2.30
30502.5s 20289 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30502.5s 20290 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30502.5s 20291 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30502.5s 20292 Running simulation until t = 3465.00 s, outputting every 15.00 s
30502.5s 20293 
30502.8s 20294 [PROGRESS] Step 16350: t=3458.07/3465.00s (99.8%) | dt=0.2125s
30502.9s 20295 [PERIODIC:1000] BC_DISPATCHER [Call #13430000] current_bc_params: <class 'dict'>
30502.9s 20296 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30502.9s 20297 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30502.9s 20298 [PERIODIC:1000] BC_GPU [Call #13430000] About to launch kernel
30502.9s 20299 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30502.9s 20300 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30502.9s 20301 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30502.9s 20302 [WARNING] Automatic CFL correction applied (count: 3357400):
30502.9s 20303 Calculated CFL: 0.800 > Limit: 0.500
30502.9s 20304 Original dt: 3.403151e-01 s
30502.9s 20305 Corrected dt: 2.126969e-01 s
30502.9s 20306 Correction factor: 1.6x
30502.9s 20307 Max wave speed detected: 23.51 m/s
30503.1s 20308 Stored output at t = 3465.0000 s (Step 16383)
30503.1s 20309 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3450.0/3465.0 [00:00<?, ?s/s][A
30503.1s 20310 [A
30503.1s 20311 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.06s/s]
30503.1s 20312 
30503.1s 20313 Simulation finished at t = 3465.0000 s after 16383 steps.
30503.1s 20314 Total runtime: 0.62 seconds.
30503.1s 20315 [QUEUE_DIAGNOSTIC] ===== Step 230 t=3465.0s =====
30503.1s 20316 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30503.1s 20317 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30503.1s 20318 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30503.1s 20319 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30503.1s 20320 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30503.1s 20321 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30503.1s 20322 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30503.1s 20323 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30503.1s 20324 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30503.1s 20325 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30503.1s 20326 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30503.1s 20327 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30503.1s 20328 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30503.1s 20329 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30503.1s 20330 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30503.1s 20331 [REWARD_MICROSCOPE] step=14671 t=3465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30503.1s 20332 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30503.1s 20333 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30503.1s 20334 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30503.1s 20335 Running simulation until t = 3480.00 s, outputting every 15.00 s
30503.1s 20336 
30503.3s 20337 [PROGRESS] Step 16400: t=3468.62/3480.00s (99.7%) | dt=0.2130s
30503.7s 20338 [PROGRESS] Step 16450: t=3479.27/3480.00s (100.0%) | dt=0.2127s
30503.7s 20339 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3465.0/3480.0 [00:00<?, ?s/s][A
30503.7s 20340 [A
30503.7s 20341 Stored output at t = 3480.0000 s (Step 16454)
30503.7s 20342 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.48s/s]
30503.7s 20343 
30503.7s 20344 Simulation finished at t = 3480.0000 s after 16454 steps.
30503.7s 20345 Total runtime: 0.61 seconds.
30503.7s 20346 [REWARD_MICROSCOPE] step=14672 t=3480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30503.7s 20347 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30503.7s 20348 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30503.7s 20349 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30503.7s 20350 Running simulation until t = 3495.00 s, outputting every 15.00 s
30503.7s 20351 
30503.8s 20352 [WARNING] Automatic CFL correction applied (count: 3357500):
30503.8s 20353 Calculated CFL: 0.800 > Limit: 0.500
30503.8s 20354 Original dt: 3.397193e-01 s
30503.8s 20355 Corrected dt: 2.123245e-01 s
30503.8s 20356 Correction factor: 1.6x
30503.8s 20357 Max wave speed detected: 23.55 m/s
30504.1s 20358 [PROGRESS] Step 16500: t=3489.77/3495.00s (99.9%) | dt=0.2126s
30504.3s 20359 Stored output at t = 3495.0000 s (Step 16525)
30504.3s 20360 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3480.0/3495.0 [00:00<?, ?s/s][A
30504.3s 20361 [A
30504.3s 20362 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.32s/s]
30504.3s 20363 
30504.3s 20364 Simulation finished at t = 3495.0000 s after 16525 steps.
30504.3s 20365 Total runtime: 0.62 seconds.
30504.3s 20366 [REWARD_MICROSCOPE] step=14673 t=3495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30504.3s 20367 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30504.3s 20368 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30504.3s 20369 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30504.3s 20370 Running simulation until t = 3510.00 s, outputting every 15.00 s
30504.3s 20371 
30504.6s 20372 [PROGRESS] Step 16550: t=3500.32/3510.00s (99.7%) | dt=0.2130s
30504.7s 20373 [WARNING] Automatic CFL correction applied (count: 3357600):
30504.7s 20374 Calculated CFL: 0.800 > Limit: 0.500
30504.7s 20375 Original dt: 3.411064e-01 s
30504.7s 20376 Corrected dt: 2.131915e-01 s
30504.7s 20377 Correction factor: 1.6x
30504.7s 20378 Max wave speed detected: 23.45 m/s
30505.0s 20379 Stored output at t = 3510.0000 s (Step 16596)
30505.0s 20380 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3495.0/3510.0 [00:00<?, ?s/s][A
30505.0s 20381 [A
30505.0s 20382 
30505.0s 20383 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.39s/s]
30505.0s 20384 Simulation finished at t = 3510.0000 s after 16596 steps.
30505.0s 20385 Total runtime: 0.62 seconds.
30505.0s 20386 [REWARD_MICROSCOPE] step=14674 t=3510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30505.0s 20387 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30505.0s 20388 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30505.0s 20389 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30505.0s 20390 Running simulation until t = 3525.00 s, outputting every 15.00 s
30505.0s 20391 
30505.0s 20392 [PROGRESS] Step 16600: t=3510.85/3525.00s (99.6%) | dt=0.2124s
30505.1s 20393 [PERIODIC:1000] BC_DISPATCHER [Call #13431000] current_bc_params: <class 'dict'>
30505.1s 20394 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30505.1s 20395 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30505.1s 20396 [PERIODIC:1000] BC_GPU [Call #13431000] About to launch kernel
30505.1s 20397 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30505.1s 20398 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30505.1s 20399 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30505.4s 20400 [PROGRESS] Step 16650: t=3521.47/3525.00s (99.9%) | dt=0.2127s
30505.6s 20401 [WARNING] Automatic CFL correction applied (count: 3357700):
30505.6s 20402 Calculated CFL: 0.800 > Limit: 0.500
30505.6s 20403 Original dt: 3.405361e-01 s
30505.6s 20404 Corrected dt: 2.128351e-01 s
30505.6s 20405 Correction factor: 1.6x
30505.6s 20406 Max wave speed detected: 23.49 m/s
30505.6s 20407 Stored output at t = 3525.0000 s (Step 16667)
30505.6s 20408 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3510.0/3525.0 [00:00<?, ?s/s][A
30505.6s 20409 [A
30505.6s 20410 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 24.11s/s]
30505.6s 20411 
30505.6s 20412 Simulation finished at t = 3525.0000 s after 16667 steps.
30505.6s 20413 Total runtime: 0.62 seconds.
30505.6s 20414 [REWARD_MICROSCOPE] step=14675 t=3525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30505.6s 20415 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30505.6s 20416 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30505.6s 20417 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30505.6s 20418 Running simulation until t = 3540.00 s, outputting every 15.00 s
30505.6s 20419 
30505.9s 20420 [PROGRESS] Step 16700: t=3532.03/3540.00s (99.8%) | dt=0.2131s
30506.2s 20421 Stored output at t = 3540.0000 s (Step 16738)
30506.2s 20422 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3525.0/3540.0 [00:00<?, ?s/s][A
30506.2s 20423 [A
30506.2s 20424 
30506.2s 20425 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.04s/s]
30506.2s 20426 Simulation finished at t = 3540.0000 s after 16738 steps.
30506.2s 20427 Total runtime: 0.62 seconds.
30506.2s 20428 [REWARD_MICROSCOPE] step=14676 t=3540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30506.2s 20429 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30506.2s 20430 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30506.2s 20431 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30506.2s 20432 Running simulation until t = 3555.00 s, outputting every 15.00 s
30506.2s 20433 
30506.3s 20434 [PROGRESS] Step 16750: t=3542.55/3555.00s (99.6%) | dt=0.2123s
30506.5s 20435 [WARNING] Automatic CFL correction applied (count: 3357800):
30506.5s 20436 Calculated CFL: 0.800 > Limit: 0.500
30506.5s 20437 Original dt: 3.399493e-01 s
30506.5s 20438 Corrected dt: 2.124683e-01 s
30506.5s 20439 Correction factor: 1.6x
30506.5s 20440 Max wave speed detected: 23.53 m/s
30506.8s 20441 [PROGRESS] Step 16800: t=3553.18/3555.00s (99.9%) | dt=0.2128s
30506.8s 20442 Stored output at t = 3555.0000 s (Step 16809)
30506.8s 20443 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3540.0/3555.0 [00:00<?, ?s/s][A
30506.8s 20444 [A
30506.8s 20445 
30506.8s 20446 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 23.84s/s]
30506.8s 20447 Simulation finished at t = 3555.0000 s after 16809 steps.
30506.8s 20448 Total runtime: 0.63 seconds.
30506.8s 20449 [REWARD_MICROSCOPE] step=14677 t=3555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30506.8s 20450 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30506.8s 20451 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30506.8s 20452 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30506.8s 20453 Running simulation until t = 3570.00 s, outputting every 15.00 s
30506.8s 20454 
30507.2s 20455 [PROGRESS] Step 16850: t=3563.73/3570.00s (99.8%) | dt=0.2132s
30507.3s 20456 [PERIODIC:1000] BC_DISPATCHER [Call #13432000] current_bc_params: <class 'dict'>
30507.3s 20457 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30507.3s 20458 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30507.3s 20459 [PERIODIC:1000] BC_GPU [Call #13432000] About to launch kernel
30507.3s 20460 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30507.3s 20461 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30507.3s 20462 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30507.3s 20463 [WARNING] Automatic CFL correction applied (count: 3357900):
30507.3s 20464 Calculated CFL: 0.800 > Limit: 0.500
30507.3s 20465 Original dt: 3.409227e-01 s
30507.3s 20466 Corrected dt: 2.130767e-01 s
30507.3s 20467 Correction factor: 1.6x
30507.3s 20468 Max wave speed detected: 23.47 m/s
30507.5s 20469 Stored output at t = 3570.0000 s (Step 16880)
30507.5s 20470 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3555.0/3570.0 [00:00<?, ?s/s][A
30507.5s 20471 [A
30507.5s 20472 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.09s/s]
30507.5s 20473 
30507.5s 20474 Simulation finished at t = 3570.0000 s after 16880 steps.
30507.5s 20475 Total runtime: 0.62 seconds.
30507.5s 20476 [REWARD_MICROSCOPE] step=14678 t=3570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30507.5s 20477 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30507.5s 20478 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30507.5s 20479 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30507.5s 20480 Running simulation until t = 3585.00 s, outputting every 15.00 s
30507.5s 20481 
30507.6s 20482 [PROGRESS] Step 16900: t=3574.25/3585.00s (99.7%) | dt=0.2124s
30508.1s 20483 [PROGRESS] Step 16950: t=3584.88/3585.00s (100.0%) | dt=0.2128s
30508.1s 20484 Stored output at t = 3585.0000 s (Step 16951)
30508.1s 20485 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3570.0/3585.0 [00:00<?, ?s/s][A
30508.1s 20486 [A
30508.1s 20487 
30508.1s 20488 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.91s/s]
30508.1s 20489 Simulation finished at t = 3585.0000 s after 16951 steps.
30508.1s 20490 Total runtime: 0.63 seconds.
30508.1s 20491 [REWARD_MICROSCOPE] step=14679 t=3585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30508.1s 20492 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30508.1s 20493 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30508.1s 20494 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30508.1s 20495 Running simulation until t = 3600.00 s, outputting every 15.00 s
30508.1s 20496 
30508.2s 20497 [WARNING] Automatic CFL correction applied (count: 3358000):
30508.2s 20498 Calculated CFL: 0.800 > Limit: 0.500
30508.2s 20499 Original dt: 3.407491e-01 s
30508.2s 20500 Corrected dt: 2.129682e-01 s
30508.2s 20501 Correction factor: 1.6x
30508.2s 20502 Max wave speed detected: 23.48 m/s
30508.5s 20503 [PROGRESS] Step 17000: t=3595.44/3600.00s (99.9%) | dt=0.2133s
30508.7s 20504 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3585.0/3600.0 [00:00<?, ?s/s][A
30508.7s 20505 [A
30508.7s 20506 Stored output at t = 3600.0000 s (Step 17022)
30508.7s 20507 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 24.39s/s]
30508.7s 20508 
30508.7s 20509 Simulation finished at t = 3600.0000 s after 17022 steps.
30508.7s 20510 Total runtime: 0.62 seconds.
30508.7s 20511 [REWARD_MICROSCOPE] step=14680 t=3600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30508.7s 20512 [STEP  240] t= 3600.0s | phase=0 | reward=   0.01 | total_reward=    2.40
30508.7s 20513 DEBUG: Truncation - runner.t=3600.0, episode_max_time=3600.0
30508.7s 20514 
30508.7s 20515 ================================================================================
30508.7s 20516 [EPISODE END] Steps: 240 | Duration: 3600.0s | Total Reward: 2.40 | Avg Reward/Step: 0.010
30508.7s 20517 ================================================================================
30508.7s 20518 
30508.7s 20519 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30508.7s 20520 Using device: gpu
30508.7s 20521 DEBUG PARAMS: Reading K_m_kmh = 10.0
30508.7s 20522 DEBUG PARAMS: Reading K_c_kmh = 15.0
30508.7s 20523 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30508.7s 20524 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30508.7s 20525 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30508.7s 20526 V0_m = 13.333 m/s (48.0 km/h)
30508.7s 20527 V0_c = 11.667 m/s (42.0 km/h)
30508.7s 20528 Parameters loaded for scenario: adaptive_speed_control
30508.7s 20529 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30508.7s 20530 Loading road quality type: uniform
30508.7s 20531 Uniform road quality value: 1
30508.7s 20532 Road quality loaded.
30508.7s 20533 Initial state created.
30508.7s 20534 Transferring initial state and road quality to GPU...
30508.7s 20535 GPU data transfer complete.
30508.7s 20536 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30508.7s 20537 Initial boundary conditions applied.
30508.7s 20538 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30508.7s 20539 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30508.7s 20540 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30508.7s 20541 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30508.7s 20542 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30508.7s 20543 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30508.7s 20544 Running simulation until t = 15.00 s, outputting every 15.00 s
30508.7s 20545 
30509.1s 20546 [WARNING] Automatic CFL correction applied (count: 3358100):
30509.1s 20547 Calculated CFL: 0.800 > Limit: 0.500
30509.1s 20548 Original dt: 3.728789e-01 s
30509.1s 20549 Corrected dt: 2.330493e-01 s
30509.1s 20550 Correction factor: 1.6x
30509.1s 20551 Max wave speed detected: 21.45 m/s
30509.2s 20552 [PROGRESS] Step 50: t=13.88/15.00s (92.6%) | dt=0.2304s
30509.2s 20553 Stored output at t = 15.0000 s (Step 55)
30509.2s 20554 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30509.2s 20555 [A
30509.2s 20556 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 31.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 30.99s/s]
30509.2s 20557 
30509.2s 20558 Simulation finished at t = 15.0000 s after 55 steps.
30509.2s 20559 Total runtime: 0.48 seconds.
30509.2s 20560 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30509.2s 20561 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30509.2s 20562 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01592309 1.         0.04031418 1.        ] (rho_m, v_m, rho_c, v_c)
30509.2s 20563 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30509.2s 20564 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30509.2s 20565 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30509.2s 20566 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00477693 0.00461974 0.0045987  0.00461509 0.00464349 0.00467782]
30509.2s 20567 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00604713 0.0058468  0.0058367  0.00589007 0.00596703 0.00605711]
30509.2s 20568 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30509.2s 20569 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30509.2s 20570 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30509.2s 20571 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30509.2s 20572 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30509.2s 20573 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30509.2s 20574 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30509.2s 20575 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30509.2s 20576 [REWARD_MICROSCOPE] step=14681 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30509.2s 20577 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30509.2s 20578 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30509.2s 20579 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30509.2s 20580 Running simulation until t = 30.00 s, outputting every 15.00 s
30509.2s 20581 
30509.5s 20582 [PERIODIC:1000] BC_DISPATCHER [Call #13433000] current_bc_params: <class 'dict'>
30509.5s 20583 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30509.5s 20584 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30509.5s 20585 [PERIODIC:1000] BC_GPU [Call #13433000] About to launch kernel
30509.5s 20586 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30509.5s 20587 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30509.5s 20588 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30509.6s 20589 [PROGRESS] Step 100: t=24.93/30.00s (83.1%) | dt=0.2150s
30509.8s 20590 Stored output at t = 30.0000 s (Step 124)
30509.8s 20591 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30509.8s 20592 [A
30509.8s 20593 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 24.17s/s]
30509.8s 20594 
30509.8s 20595 Simulation finished at t = 30.0000 s after 124 steps.
30509.8s 20596 Total runtime: 0.62 seconds.
30509.8s 20597 [REWARD_MICROSCOPE] step=14682 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30509.8s 20598 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30509.8s 20599 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30509.8s 20600 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30509.8s 20601 Running simulation until t = 45.00 s, outputting every 15.00 s
30509.8s 20602 
30510.0s 20603 [WARNING] Automatic CFL correction applied (count: 3358200):
30510.0s 20604 Calculated CFL: 0.800 > Limit: 0.500
30510.0s 20605 Original dt: 3.403061e-01 s
30510.0s 20606 Corrected dt: 2.126913e-01 s
30510.0s 20607 Correction factor: 1.6x
30510.0s 20608 Max wave speed detected: 23.51 m/s
30510.1s 20609 [PROGRESS] Step 150: t=35.53/45.00s (79.0%) | dt=0.2127s
30510.5s 20610 Stored output at t = 45.0000 s (Step 195)
30510.5s 20611 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30510.5s 20612 [A
30510.5s 20613 
30510.5s 20614 Simulation finished at t = 45.0000 s after 195 steps.
30510.5s 20615 Total runtime: 0.64 seconds.
30510.5s 20616 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.32s/s]
30510.5s 20617 [REWARD_MICROSCOPE] step=14683 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30510.5s 20618 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30510.5s 20619 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30510.5s 20620 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30510.5s 20621 Running simulation until t = 60.00 s, outputting every 15.00 s
30510.5s 20622 
30510.5s 20623 [PROGRESS] Step 200: t=46.07/60.00s (76.8%) | dt=0.2134s
30511.0s 20624 [WARNING] Automatic CFL correction applied (count: 3358300):
30511.0s 20625 Calculated CFL: 0.800 > Limit: 0.500
30511.0s 20626 Original dt: 3.417249e-01 s
30511.0s 20627 Corrected dt: 2.135781e-01 s
30511.0s 20628 Correction factor: 1.6x
30511.0s 20629 Max wave speed detected: 23.41 m/s
30511.0s 20630 [PROGRESS] Step 250: t=56.75/60.00s (94.6%) | dt=0.2132s
30511.2s 20631 Stored output at t = 60.0000 s (Step 266)
30511.2s 20632 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30511.2s 20633 [A
30511.2s 20634 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 22.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 22.54s/s]
30511.2s 20635 
30511.2s 20636 Simulation finished at t = 60.0000 s after 266 steps.
30511.2s 20637 Total runtime: 0.67 seconds.
30511.2s 20638 [REWARD_MICROSCOPE] step=14684 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30511.2s 20639 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30511.2s 20640 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30511.2s 20641 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30511.2s 20642 Running simulation until t = 75.00 s, outputting every 15.00 s
30511.2s 20643 
30511.5s 20644 [PROGRESS] Step 300: t=67.22/75.00s (89.6%) | dt=0.2125s
30511.8s 20645 Stored output at t = 75.0000 s (Step 337)
30511.8s 20646 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30511.8s 20647 [A
30511.8s 20648 
30511.8s 20649 Simulation finished at t = 75.0000 s after 337 steps.
30511.8s 20650 Total runtime: 0.62 seconds.
30511.8s 20651 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 24.16s/s]
30511.8s 20652 [REWARD_MICROSCOPE] step=14685 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30511.8s 20653 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30511.8s 20654 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30511.8s 20655 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30511.8s 20656 Running simulation until t = 90.00 s, outputting every 15.00 s
30511.8s 20657 
30511.8s 20658 [PERIODIC:1000] BC_DISPATCHER [Call #13434000] current_bc_params: <class 'dict'>
30511.8s 20659 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30511.8s 20660 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30511.8s 20661 [PERIODIC:1000] BC_GPU [Call #13434000] About to launch kernel
30511.8s 20662 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30511.8s 20663 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30511.8s 20664 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30511.8s 20665 [WARNING] Automatic CFL correction applied (count: 3358400):
30511.8s 20666 Calculated CFL: 0.800 > Limit: 0.500
30511.8s 20667 Original dt: 3.406565e-01 s
30511.8s 20668 Corrected dt: 2.129103e-01 s
30511.8s 20669 Correction factor: 1.6x
30511.8s 20670 Max wave speed detected: 23.48 m/s
30511.9s 20671 [PROGRESS] Step 350: t=77.77/90.00s (86.4%) | dt=0.2130s
30512.3s 20672 [PROGRESS] Step 400: t=88.42/90.00s (98.2%) | dt=0.2128s
30512.4s 20673 Stored output at t = 90.0000 s (Step 408)
30512.4s 20674 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30512.4s 20675 [A
30512.4s 20676 
30512.4s 20677 Simulation finished at t = 90.0000 s after 408 steps.
30512.4s 20678 Total runtime: 0.62 seconds.
30512.4s 20679 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 24.13s/s]
30512.4s 20680 [REWARD_MICROSCOPE] step=14686 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30512.4s 20681 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30512.4s 20682 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30512.4s 20683 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30512.4s 20684 Running simulation until t = 105.00 s, outputting every 15.00 s
30512.4s 20685 
30512.7s 20686 [WARNING] Automatic CFL correction applied (count: 3358500):
30512.7s 20687 Calculated CFL: 0.800 > Limit: 0.500
30512.7s 20688 Original dt: 3.400646e-01 s
30512.7s 20689 Corrected dt: 2.125404e-01 s
30512.7s 20690 Correction factor: 1.6x
30512.7s 20691 Max wave speed detected: 23.52 m/s
30512.8s 20692 [PROGRESS] Step 450: t=98.92/105.00s (94.2%) | dt=0.2126s
30513.1s 20693 Stored output at t = 105.0000 s (Step 479)
30513.1s 20694 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30513.1s 20695 [A
30513.1s 20696 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.32s/s]
30513.1s 20697 
30513.1s 20698 Simulation finished at t = 105.0000 s after 479 steps.
30513.1s 20699 Total runtime: 0.64 seconds.
30513.1s 20700 [REWARD_MICROSCOPE] step=14687 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30513.1s 20701 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30513.1s 20702 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30513.1s 20703 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30513.1s 20704 Running simulation until t = 120.00 s, outputting every 15.00 s
30513.1s 20705 
30513.3s 20706 [PROGRESS] Step 500: t=109.47/120.00s (91.2%) | dt=0.2130s
30513.7s 20707 [WARNING] Automatic CFL correction applied (count: 3358600):
30513.7s 20708 Calculated CFL: 0.800 > Limit: 0.500
30513.7s 20709 Original dt: 3.403351e-01 s
30513.7s 20710 Corrected dt: 2.127094e-01 s
30513.7s 20711 Correction factor: 1.6x
30513.7s 20712 Max wave speed detected: 23.51 m/s
30513.7s 20713 [PROGRESS] Step 550: t=120.00/120.00s (100.0%) | dt=0.0883s
30513.7s 20714 Stored output at t = 120.0000 s (Step 550)
30513.7s 20715 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30513.7s 20716 [A
30513.7s 20717 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 21.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 21.76s/s]
30513.7s 20718 
30513.7s 20719 Simulation finished at t = 120.0000 s after 550 steps.
30513.7s 20720 Total runtime: 0.69 seconds.
30513.7s 20721 [REWARD_MICROSCOPE] step=14688 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30513.7s 20722 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30513.7s 20723 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30513.7s 20724 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30513.7s 20725 Running simulation until t = 135.00 s, outputting every 15.00 s
30513.7s 20726 
30514.1s 20727 [PERIODIC:1000] BC_DISPATCHER [Call #13435000] current_bc_params: <class 'dict'>
30514.1s 20728 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30514.1s 20729 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30514.1s 20730 [PERIODIC:1000] BC_GPU [Call #13435000] About to launch kernel
30514.1s 20731 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30514.1s 20732 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30514.1s 20733 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30514.2s 20734 [PROGRESS] Step 600: t=130.62/135.00s (96.8%) | dt=0.2127s
30514.4s 20735 Stored output at t = 135.0000 s (Step 621)
30514.4s 20736 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30514.4s 20737 [A
30514.4s 20738 
30514.4s 20739 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 23.94s/s]
30514.4s 20740 Simulation finished at t = 135.0000 s after 621 steps.
30514.4s 20741 Total runtime: 0.63 seconds.
30514.4s 20742 [REWARD_MICROSCOPE] step=14689 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30514.4s 20743 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30514.4s 20744 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30514.4s 20745 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30514.4s 20746 Running simulation until t = 150.00 s, outputting every 15.00 s
30514.4s 20747 
30514.6s 20748 [WARNING] Automatic CFL correction applied (count: 3358700):
30514.6s 20749 Calculated CFL: 0.800 > Limit: 0.500
30514.6s 20750 Original dt: 3.408613e-01 s
30514.6s 20751 Corrected dt: 2.130383e-01 s
30514.6s 20752 Correction factor: 1.6x
30514.6s 20753 Max wave speed detected: 23.47 m/s
30514.6s 20754 [PROGRESS] Step 650: t=141.18/150.00s (94.1%) | dt=0.2131s
30515.0s 20755 Stored output at t = 150.0000 s (Step 692)
30515.0s 20756 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30515.0s 20757 [A
30515.0s 20758 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.07s/s]
30515.0s 20759 
30515.0s 20760 Simulation finished at t = 150.0000 s after 692 steps.
30515.0s 20761 Total runtime: 0.62 seconds.
30515.0s 20762 [REWARD_MICROSCOPE] step=14690 t=150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30515.0s 20763 [STEP   10] t=  150.0s | phase=0 | reward=   0.01 | total_reward=    0.10
30515.0s 20764 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30515.0s 20765 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30515.0s 20766 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30515.0s 20767 Running simulation until t = 165.00 s, outputting every 15.00 s
30515.0s 20768 
30515.1s 20769 [PROGRESS] Step 700: t=151.70/165.00s (91.9%) | dt=0.2124s
30515.5s 20770 [WARNING] Automatic CFL correction applied (count: 3358800):
30515.5s 20771 Calculated CFL: 0.800 > Limit: 0.500
30515.5s 20772 Original dt: 3.402871e-01 s
30515.5s 20773 Corrected dt: 2.126795e-01 s
30515.5s 20774 Correction factor: 1.6x
30515.5s 20775 Max wave speed detected: 23.51 m/s
30515.5s 20776 [PROGRESS] Step 750: t=162.32/165.00s (98.4%) | dt=0.2127s
30515.6s 20777 Stored output at t = 165.0000 s (Step 763)
30515.6s 20778 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30515.6s 20779 [A
30515.6s 20780 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.33s/s]
30515.6s 20781 
30515.6s 20782 Simulation finished at t = 165.0000 s after 763 steps.
30515.6s 20783 Total runtime: 0.62 seconds.
30515.6s 20784 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30515.6s 20785 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30515.6s 20786 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30515.6s 20787 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30515.6s 20788 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30515.6s 20789 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30515.6s 20790 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30515.6s 20791 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30515.6s 20792 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30515.6s 20793 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30515.6s 20794 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30515.6s 20795 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30515.6s 20796 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30515.6s 20797 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30515.6s 20798 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30515.6s 20799 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30515.6s 20800 [REWARD_MICROSCOPE] step=14691 t=165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30515.6s 20801 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30515.6s 20802 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30515.6s 20803 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30515.6s 20804 Running simulation until t = 180.00 s, outputting every 15.00 s
30515.6s 20805 
30515.9s 20806 [PROGRESS] Step 800: t=172.88/180.00s (96.0%) | dt=0.2131s
30516.2s 20807 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30516.2s 20808 [A
30516.2s 20809 Stored output at t = 180.0000 s (Step 834)
30516.2s 20810 
30516.2s 20811 Simulation finished at t = 180.0000 s after 834 steps.
30516.2s 20812 Total runtime: 0.62 seconds.
30516.2s 20813 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 24.27s/s]
30516.2s 20814 [REWARD_MICROSCOPE] step=14692 t=180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30516.2s 20815 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30516.2s 20816 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30516.2s 20817 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30516.2s 20818 Running simulation until t = 195.00 s, outputting every 15.00 s
30516.2s 20819 
30516.3s 20820 [PERIODIC:1000] BC_DISPATCHER [Call #13436000] current_bc_params: <class 'dict'>
30516.3s 20821 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30516.3s 20822 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30516.3s 20823 [PERIODIC:1000] BC_GPU [Call #13436000] About to launch kernel
30516.3s 20824 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30516.3s 20825 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30516.3s 20826 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30516.3s 20827 [WARNING] Automatic CFL correction applied (count: 3358900):
30516.3s 20828 Calculated CFL: 0.800 > Limit: 0.500
30516.3s 20829 Original dt: 3.397169e-01 s
30516.3s 20830 Corrected dt: 2.123230e-01 s
30516.3s 20831 Correction factor: 1.6x
30516.3s 20832 Max wave speed detected: 23.55 m/s
30516.4s 20833 [PROGRESS] Step 850: t=183.40/195.00s (94.1%) | dt=0.2123s
30516.8s 20834 [PROGRESS] Step 900: t=194.03/195.00s (99.5%) | dt=0.2128s
30516.9s 20835 Stored output at t = 195.0000 s (Step 905)
30516.9s 20836 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30516.9s 20837 [A
30516.9s 20838 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.29s/s]
30516.9s 20839 
30516.9s 20840 Simulation finished at t = 195.0000 s after 905 steps.
30516.9s 20841 Total runtime: 0.62 seconds.
30516.9s 20842 [REWARD_MICROSCOPE] step=14693 t=195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30516.9s 20843 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30516.9s 20844 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30516.9s 20845 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30516.9s 20846 Running simulation until t = 210.00 s, outputting every 15.00 s
30516.9s 20847 
30517.2s 20848 [WARNING] Automatic CFL correction applied (count: 3359000):
30517.2s 20849 Calculated CFL: 0.800 > Limit: 0.500
30517.2s 20850 Original dt: 3.410795e-01 s
30517.2s 20851 Corrected dt: 2.131747e-01 s
30517.2s 20852 Correction factor: 1.6x
30517.2s 20853 Max wave speed detected: 23.45 m/s
30517.3s 20854 [PROGRESS] Step 950: t=204.59/210.00s (97.4%) | dt=0.2132s
30517.5s 20855 Stored output at t = 210.0000 s (Step 976)
30517.5s 20856 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30517.5s 20857 [A
30517.5s 20858 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.70s/s]
30517.5s 20859 
30517.5s 20860 Simulation finished at t = 210.0000 s after 976 steps.
30517.5s 20861 Total runtime: 0.63 seconds.
30517.5s 20862 [REWARD_MICROSCOPE] step=14694 t=210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30517.5s 20863 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30517.5s 20864 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30517.5s 20865 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30517.5s 20866 Running simulation until t = 225.00 s, outputting every 15.00 s
30517.5s 20867 
30517.7s 20868 [PROGRESS] Step 1000: t=215.10/225.00s (95.6%) | dt=0.2124s
30518.1s 20869 [WARNING] Automatic CFL correction applied (count: 3359100):
30518.1s 20870 Calculated CFL: 0.800 > Limit: 0.500
30518.1s 20871 Original dt: 3.405090e-01 s
30518.1s 20872 Corrected dt: 2.128181e-01 s
30518.1s 20873 Correction factor: 1.6x
30518.1s 20874 Max wave speed detected: 23.49 m/s
30518.1s 20875 Stored output at t = 225.0000 s (Step 1047)
30518.1s 20876 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30518.1s 20877 [A
30518.1s 20878 
30518.1s 20879 Simulation finished at t = 225.0000 s after 1047 steps.
30518.1s 20880 Total runtime: 0.63 seconds.
30518.1s 20881 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 23.85s/s]
30518.1s 20882 [REWARD_MICROSCOPE] step=14695 t=225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30518.1s 20883 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30518.1s 20884 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30518.1s 20885 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30518.1s 20886 Running simulation until t = 240.00 s, outputting every 15.00 s
30518.1s 20887 
30518.2s 20888 [PROGRESS] Step 1050: t=225.64/240.00s (94.0%) | dt=0.2129s
30518.5s 20889 [PERIODIC:1000] BC_DISPATCHER [Call #13437000] current_bc_params: <class 'dict'>
30518.5s 20890 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30518.5s 20891 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30518.5s 20892 [PERIODIC:1000] BC_GPU [Call #13437000] About to launch kernel
30518.5s 20893 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30518.5s 20894 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30518.5s 20895 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30518.6s 20896 [PROGRESS] Step 1100: t=236.29/240.00s (98.5%) | dt=0.2133s
30518.7s 20897 Stored output at t = 240.0000 s (Step 1118)
30518.7s 20898 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30518.7s 20899 [A
30518.7s 20900 
30518.7s 20901 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.43s/s]
30518.7s 20902 Simulation finished at t = 240.0000 s after 1118 steps.
30518.7s 20903 Total runtime: 0.61 seconds.
30518.7s 20904 [REWARD_MICROSCOPE] step=14696 t=240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30518.8s 20905 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30518.8s 20906 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30518.8s 20907 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30518.8s 20908 Running simulation until t = 255.00 s, outputting every 15.00 s
30518.8s 20909 
30519.0s 20910 [WARNING] Automatic CFL correction applied (count: 3359200):
30519.0s 20911 Calculated CFL: 0.800 > Limit: 0.500
30519.0s 20912 Original dt: 3.399193e-01 s
30519.0s 20913 Corrected dt: 2.124495e-01 s
30519.0s 20914 Correction factor: 1.6x
30519.0s 20915 Max wave speed detected: 23.53 m/s
30519.0s 20916 [PROGRESS] Step 1150: t=246.80/255.00s (96.8%) | dt=0.2125s
30519.4s 20917 Stored output at t = 255.0000 s (Step 1189)
30519.4s 20918 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30519.4s 20919 [A
30519.4s 20920 
30519.4s 20921 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.82s/s]
30519.4s 20922 Simulation finished at t = 255.0000 s after 1189 steps.
30519.4s 20923 Total runtime: 0.63 seconds.
30519.4s 20924 [REWARD_MICROSCOPE] step=14697 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30519.4s 20925 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30519.4s 20926 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30519.4s 20927 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30519.4s 20928 Running simulation until t = 270.00 s, outputting every 15.00 s
30519.4s 20929 
30519.5s 20930 [PROGRESS] Step 1200: t=257.34/270.00s (95.3%) | dt=0.2129s
30519.9s 20931 [WARNING] Automatic CFL correction applied (count: 3359300):
30519.9s 20932 Calculated CFL: 0.800 > Limit: 0.500
30519.9s 20933 Original dt: 3.411066e-01 s
30519.9s 20934 Corrected dt: 2.131916e-01 s
30519.9s 20935 Correction factor: 1.6x
30519.9s 20936 Max wave speed detected: 23.45 m/s
30519.9s 20937 [PROGRESS] Step 1250: t=268.00/270.00s (99.3%) | dt=0.2129s
30520.0s 20938 Stored output at t = 270.0000 s (Step 1260)
30520.0s 20939 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30520.0s 20940 [A
30520.0s 20941 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 23.81s/s]
30520.0s 20942 
30520.0s 20943 Simulation finished at t = 270.0000 s after 1260 steps.
30520.0s 20944 Total runtime: 0.63 seconds.
30520.0s 20945 [REWARD_MICROSCOPE] step=14698 t=270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30520.0s 20946 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30520.0s 20947 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30520.0s 20948 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30520.0s 20949 Running simulation until t = 285.00 s, outputting every 15.00 s
30520.0s 20950 
30520.4s 20951 [PROGRESS] Step 1300: t=278.50/285.00s (97.7%) | dt=0.2126s
30520.6s 20952 Stored output at t = 285.0000 s (Step 1331)
30520.6s 20953 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30520.6s 20954 [A
30520.6s 20955 
30520.6s 20956 Simulation finished at t = 285.0000 s after 1331 steps.
30520.6s 20957 Total runtime: 0.63 seconds.
30520.6s 20958 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.81s/s]
30520.6s 20959 [REWARD_MICROSCOPE] step=14699 t=285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30520.6s 20960 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30520.6s 20961 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30520.6s 20962 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30520.6s 20963 Running simulation until t = 300.00 s, outputting every 15.00 s
30520.6s 20964 
30520.7s 20965 [PERIODIC:1000] BC_DISPATCHER [Call #13438000] current_bc_params: <class 'dict'>
30520.7s 20966 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30520.7s 20967 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30520.7s 20968 [PERIODIC:1000] BC_GPU [Call #13438000] About to launch kernel
30520.7s 20969 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30520.7s 20970 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30520.7s 20971 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30520.8s 20972 [WARNING] Automatic CFL correction applied (count: 3359400):
30520.8s 20973 Calculated CFL: 0.800 > Limit: 0.500
30520.8s 20974 Original dt: 3.407212e-01 s
30520.8s 20975 Corrected dt: 2.129508e-01 s
30520.8s 20976 Correction factor: 1.6x
30520.8s 20977 Max wave speed detected: 23.48 m/s
30520.8s 20978 [PROGRESS] Step 1350: t=289.05/300.00s (96.3%) | dt=0.2130s
30521.3s 20979 [PROGRESS] Step 1400: t=299.70/300.00s (99.9%) | dt=0.2126s
30521.3s 20980 Stored output at t = 300.0000 s (Step 1402)
30521.3s 20981 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30521.3s 20982 [A
30521.3s 20983 
30521.3s 20984 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 23.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 23.36s/s]
30521.3s 20985 Simulation finished at t = 300.0000 s after 1402 steps.
30521.3s 20986 Total runtime: 0.64 seconds.
30521.3s 20987 [REWARD_MICROSCOPE] step=14700 t=300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30521.3s 20988 [STEP   20] t=  300.0s | phase=0 | reward=   0.01 | total_reward=    0.20
30521.3s 20989 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30521.3s 20990 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30521.3s 20991 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30521.3s 20992 Running simulation until t = 315.00 s, outputting every 15.00 s
30521.3s 20993 
30521.7s 20994 [WARNING] Automatic CFL correction applied (count: 3359500):
30521.7s 20995 Calculated CFL: 0.800 > Limit: 0.500
30521.7s 20996 Original dt: 3.401477e-01 s
30521.7s 20997 Corrected dt: 2.125923e-01 s
30521.7s 20998 Correction factor: 1.6x
30521.7s 20999 Max wave speed detected: 23.52 m/s
30521.7s 21000 [PROGRESS] Step 1450: t=310.20/315.00s (98.5%) | dt=0.2126s
30521.9s 21001 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30521.9s 21002 [A
30521.9s 21003 Stored output at t = 315.0000 s (Step 1473)
30521.9s 21004 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 23.35s/s]
30521.9s 21005 
30521.9s 21006 Simulation finished at t = 315.0000 s after 1473 steps.
30521.9s 21007 Total runtime: 0.64 seconds.
30521.9s 21008 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30521.9s 21009 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30521.9s 21010 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30521.9s 21011 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30521.9s 21012 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30521.9s 21013 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30521.9s 21014 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30521.9s 21015 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30521.9s 21016 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30521.9s 21017 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30521.9s 21018 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30521.9s 21019 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30521.9s 21020 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30521.9s 21021 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30521.9s 21022 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30521.9s 21023 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30521.9s 21024 [REWARD_MICROSCOPE] step=14701 t=315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30521.9s 21025 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30521.9s 21026 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30521.9s 21027 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30521.9s 21028 Running simulation until t = 330.00 s, outputting every 15.00 s
30521.9s 21029 
30522.2s 21030 [PROGRESS] Step 1500: t=320.75/330.00s (97.2%) | dt=0.2131s
30522.6s 21031 Stored output at t = 330.0000 s (Step 1544)
30522.6s 21032 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30522.6s 21033 [A
30522.6s 21034 
30522.6s 21035 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.08s/s]
30522.6s 21036 Simulation finished at t = 330.0000 s after 1544 steps.
30522.6s 21037 Total runtime: 0.62 seconds.
30522.6s 21038 [REWARD_MICROSCOPE] step=14702 t=330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30522.6s 21039 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30522.6s 21040 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30522.6s 21041 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30522.6s 21042 Running simulation until t = 345.00 s, outputting every 15.00 s
30522.6s 21043 
30522.6s 21044 [WARNING] Automatic CFL correction applied (count: 3359600):
30522.6s 21045 Calculated CFL: 0.800 > Limit: 0.500
30522.6s 21046 Original dt: 3.400436e-01 s
30522.6s 21047 Corrected dt: 2.125273e-01 s
30522.6s 21048 Correction factor: 1.6x
30522.6s 21049 Max wave speed detected: 23.53 m/s
30522.6s 21050 [PROGRESS] Step 1550: t=331.27/345.00s (96.0%) | dt=0.2124s
30523.0s 21051 [PERIODIC:1000] BC_DISPATCHER [Call #13439000] current_bc_params: <class 'dict'>
30523.0s 21052 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30523.0s 21053 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30523.0s 21054 [PERIODIC:1000] BC_GPU [Call #13439000] About to launch kernel
30523.0s 21055 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30523.0s 21056 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30523.0s 21057 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30523.1s 21058 [PROGRESS] Step 1600: t=341.90/345.00s (99.1%) | dt=0.2127s
30523.2s 21059 Stored output at t = 345.0000 s (Step 1615)
30523.2s 21060 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30523.2s 21061 [A
30523.2s 21062 
30523.2s 21063 Simulation finished at t = 345.0000 s after 1615 steps.
30523.2s 21064 Total runtime: 0.64 seconds.
30523.2s 21065 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 23.44s/s]
30523.2s 21066 [REWARD_MICROSCOPE] step=14703 t=345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30523.2s 21067 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30523.2s 21068 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30523.2s 21069 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30523.2s 21070 Running simulation until t = 360.00 s, outputting every 15.00 s
30523.2s 21071 
30523.5s 21072 [WARNING] Automatic CFL correction applied (count: 3359700):
30523.5s 21073 Calculated CFL: 0.800 > Limit: 0.500
30523.5s 21074 Original dt: 3.409462e-01 s
30523.5s 21075 Corrected dt: 2.130914e-01 s
30523.5s 21076 Correction factor: 1.6x
30523.5s 21077 Max wave speed detected: 23.46 m/s
30523.5s 21078 [PROGRESS] Step 1650: t=352.45/360.00s (97.9%) | dt=0.2131s
30523.8s 21079 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30523.8s 21080 [A
30523.8s 21081 Stored output at t = 360.0000 s (Step 1686)
30523.8s 21082 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 24.38s/s]
30523.8s 21083 
30523.8s 21084 Simulation finished at t = 360.0000 s after 1686 steps.
30523.8s 21085 Total runtime: 0.62 seconds.
30523.8s 21086 [REWARD_MICROSCOPE] step=14704 t=360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30523.8s 21087 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30523.8s 21088 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30523.8s 21089 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30523.8s 21090 Running simulation until t = 375.00 s, outputting every 15.00 s
30523.8s 21091 
30524.0s 21092 [PROGRESS] Step 1700: t=362.97/375.00s (96.8%) | dt=0.2123s
30524.3s 21093 [WARNING] Automatic CFL correction applied (count: 3359800):
30524.3s 21094 Calculated CFL: 0.800 > Limit: 0.500
30524.3s 21095 Original dt: 3.403711e-01 s
30524.3s 21096 Corrected dt: 2.127320e-01 s
30524.3s 21097 Correction factor: 1.6x
30524.3s 21098 Max wave speed detected: 23.50 m/s
30524.4s 21099 [PROGRESS] Step 1750: t=373.60/375.00s (99.6%) | dt=0.2128s
30524.4s 21100 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30524.4s 21101 Stored output at t = 375.0000 s (Step 1757)
30524.4s 21102 [A
30524.4s 21103 
30524.4s 21104 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.23s/s]
30524.4s 21105 Simulation finished at t = 375.0000 s after 1757 steps.
30524.4s 21106 Total runtime: 0.62 seconds.
30524.5s 21107 [REWARD_MICROSCOPE] step=14705 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30524.5s 21108 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30524.5s 21109 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30524.5s 21110 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30524.5s 21111 Running simulation until t = 390.00 s, outputting every 15.00 s
30524.5s 21112 
30524.8s 21113 [PROGRESS] Step 1800: t=384.16/390.00s (98.5%) | dt=0.2132s
30525.1s 21114 Stored output at t = 390.0000 s (Step 1828)
30525.1s 21115 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30525.1s 21116 [A
30525.1s 21117 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 23.84s/s]
30525.1s 21118 
30525.1s 21119 Simulation finished at t = 390.0000 s after 1828 steps.
30525.1s 21120 Total runtime: 0.63 seconds.
30525.1s 21121 [REWARD_MICROSCOPE] step=14706 t=390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30525.1s 21122 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30525.1s 21123 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30525.1s 21124 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30525.1s 21125 Running simulation until t = 405.00 s, outputting every 15.00 s
30525.1s 21126 
30525.2s 21127 [PERIODIC:1000] BC_DISPATCHER [Call #13440000] current_bc_params: <class 'dict'>
30525.2s 21128 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30525.2s 21129 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30525.2s 21130 [PERIODIC:1000] BC_GPU [Call #13440000] About to launch kernel
30525.2s 21131 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30525.2s 21132 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30525.2s 21133 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30525.2s 21134 [WARNING] Automatic CFL correction applied (count: 3359900):
30525.2s 21135 Calculated CFL: 0.800 > Limit: 0.500
30525.2s 21136 Original dt: 3.397675e-01 s
30525.2s 21137 Corrected dt: 2.123547e-01 s
30525.2s 21138 Correction factor: 1.6x
30525.2s 21139 Max wave speed detected: 23.55 m/s
30525.3s 21140 [PROGRESS] Step 1850: t=394.67/405.00s (97.4%) | dt=0.2124s
30525.7s 21141 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30525.7s 21142 [A
30525.7s 21143 Stored output at t = 405.0000 s (Step 1899)
30525.7s 21144 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.99s/s]
30525.7s 21145 
30525.7s 21146 Simulation finished at t = 405.0000 s after 1899 steps.
30525.7s 21147 Total runtime: 0.63 seconds.
30525.7s 21148 [REWARD_MICROSCOPE] step=14707 t=405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30525.7s 21149 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30525.7s 21150 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30525.7s 21151 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30525.7s 21152 Running simulation until t = 420.00 s, outputting every 15.00 s
30525.7s 21153 
30525.7s 21154 [PROGRESS] Step 1900: t=405.21/420.00s (96.5%) | dt=0.2128s
30526.1s 21155 [WARNING] Automatic CFL correction applied (count: 3360000):
30526.1s 21156 Calculated CFL: 0.800 > Limit: 0.500
30526.1s 21157 Original dt: 3.411605e-01 s
30526.1s 21158 Corrected dt: 2.132253e-01 s
30526.1s 21159 Correction factor: 1.6x
30526.1s 21160 Max wave speed detected: 23.45 m/s
30526.2s 21161 [PROGRESS] Step 1950: t=415.87/420.00s (99.0%) | dt=0.2133s
30526.3s 21162 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30526.3s 21163 [A
30526.3s 21164 Stored output at t = 420.0000 s (Step 1970)
30526.3s 21165 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.01s/s]
30526.3s 21166 
30526.3s 21167 Simulation finished at t = 420.0000 s after 1970 steps.
30526.3s 21168 Total runtime: 0.63 seconds.
30526.3s 21169 [REWARD_MICROSCOPE] step=14708 t=420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30526.3s 21170 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30526.3s 21171 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30526.3s 21172 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30526.3s 21173 Running simulation until t = 435.00 s, outputting every 15.00 s
30526.3s 21174 
30526.6s 21175 [PROGRESS] Step 2000: t=426.37/435.00s (98.0%) | dt=0.2125s
30527.0s 21176 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30527.0s 21177 [A
30527.0s 21178 Stored output at t = 435.0000 s (Step 2041)
30527.0s 21179 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.15s/s]
30527.0s 21180 
30527.0s 21181 Simulation finished at t = 435.0000 s after 2041 steps.
30527.0s 21182 Total runtime: 0.62 seconds.
30527.0s 21183 [REWARD_MICROSCOPE] step=14709 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30527.0s 21184 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30527.0s 21185 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30527.0s 21186 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30527.0s 21187 Running simulation until t = 450.00 s, outputting every 15.00 s
30527.0s 21188 
30527.0s 21189 [WARNING] Automatic CFL correction applied (count: 3360100):
30527.0s 21190 Calculated CFL: 0.800 > Limit: 0.500
30527.0s 21191 Original dt: 3.405828e-01 s
30527.0s 21192 Corrected dt: 2.128643e-01 s
30527.0s 21193 Correction factor: 1.6x
30527.0s 21194 Max wave speed detected: 23.49 m/s
30527.0s 21195 [PROGRESS] Step 2050: t=436.92/450.00s (97.1%) | dt=0.2129s
30527.4s 21196 [PERIODIC:1000] BC_DISPATCHER [Call #13441000] current_bc_params: <class 'dict'>
30527.4s 21197 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30527.4s 21198 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30527.4s 21199 [PERIODIC:1000] BC_GPU [Call #13441000] About to launch kernel
30527.4s 21200 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30527.4s 21201 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30527.4s 21202 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30527.5s 21203 [PROGRESS] Step 2100: t=447.57/450.00s (99.5%) | dt=0.2130s
30527.6s 21204 Stored output at t = 450.0000 s (Step 2112)
30527.6s 21205 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30527.6s 21206 [A
30527.6s 21207 
30527.6s 21208 Simulation finished at t = 450.0000 s after 2112 steps.
30527.6s 21209 Total runtime: 0.62 seconds.
30527.6s 21210 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 24.22s/s]
30527.6s 21211 [REWARD_MICROSCOPE] step=14710 t=450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30527.6s 21212 [STEP   30] t=  450.0s | phase=0 | reward=   0.01 | total_reward=    0.30
30527.6s 21213 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30527.6s 21214 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30527.6s 21215 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30527.6s 21216 Running simulation until t = 465.00 s, outputting every 15.00 s
30527.6s 21217 
30527.9s 21218 [WARNING] Automatic CFL correction applied (count: 3360200):
30527.9s 21219 Calculated CFL: 0.800 > Limit: 0.500
30527.9s 21220 Original dt: 3.400085e-01 s
30527.9s 21221 Corrected dt: 2.125053e-01 s
30527.9s 21222 Correction factor: 1.6x
30527.9s 21223 Max wave speed detected: 23.53 m/s
30527.9s 21224 [PROGRESS] Step 2150: t=458.07/465.00s (98.5%) | dt=0.2125s
30528.2s 21225 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30528.2s 21226 Stored output at t = 465.0000 s (Step 2183)
30528.2s 21227 [A
30528.2s 21228 
30528.2s 21229 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 23.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 22.99s/s]
30528.2s 21230 Simulation finished at t = 465.0000 s after 2183 steps.
30528.2s 21231 Total runtime: 0.65 seconds.
30528.2s 21232 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30528.2s 21233 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30528.2s 21234 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30528.2s 21235 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30528.2s 21236 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30528.2s 21237 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30528.2s 21238 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30528.2s 21239 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30528.2s 21240 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30528.2s 21241 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30528.2s 21242 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30528.2s 21243 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30528.2s 21244 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30528.2s 21245 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30528.2s 21246 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30528.2s 21247 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30528.2s 21248 [REWARD_MICROSCOPE] step=14711 t=465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30528.2s 21249 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30528.2s 21250 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30528.2s 21251 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30528.2s 21252 Running simulation until t = 480.00 s, outputting every 15.00 s
30528.2s 21253 
30528.4s 21254 [PROGRESS] Step 2200: t=468.62/480.00s (97.6%) | dt=0.2130s
30528.8s 21255 [WARNING] Automatic CFL correction applied (count: 3360300):
30528.8s 21256 Calculated CFL: 0.800 > Limit: 0.500
30528.8s 21257 Original dt: 3.406020e-01 s
30528.8s 21258 Corrected dt: 2.128763e-01 s
30528.8s 21259 Correction factor: 1.6x
30528.8s 21260 Max wave speed detected: 23.49 m/s
30528.9s 21261 [PROGRESS] Step 2250: t=479.27/480.00s (99.8%) | dt=0.2127s
30528.9s 21262 Stored output at t = 480.0000 s (Step 2254)
30528.9s 21263 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30528.9s 21264 [A
30528.9s 21265 
30528.9s 21266 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 23.20s/s]
30528.9s 21267 Simulation finished at t = 480.0000 s after 2254 steps.
30528.9s 21268 Total runtime: 0.65 seconds.
30528.9s 21269 [REWARD_MICROSCOPE] step=14712 t=480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30528.9s 21270 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30528.9s 21271 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30528.9s 21272 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30528.9s 21273 Running simulation until t = 495.00 s, outputting every 15.00 s
30528.9s 21274 
30529.3s 21275 [PROGRESS] Step 2300: t=489.77/495.00s (98.9%) | dt=0.2126s
30529.5s 21276 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30529.5s 21277 [A
30529.5s 21278 Stored output at t = 495.0000 s (Step 2325)
30529.5s 21279 
30529.5s 21280 Simulation finished at t = 495.0000 s after 2325 steps.
30529.5s 21281 Total runtime: 0.63 seconds.
30529.5s 21282 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.88s/s]
30529.5s 21283 [REWARD_MICROSCOPE] step=14713 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30529.5s 21284 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30529.5s 21285 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30529.5s 21286 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30529.5s 21287 Running simulation until t = 510.00 s, outputting every 15.00 s
30529.5s 21288 
30529.6s 21289 [PERIODIC:1000] BC_DISPATCHER [Call #13442000] current_bc_params: <class 'dict'>
30529.6s 21290 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30529.6s 21291 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30529.6s 21292 [PERIODIC:1000] BC_GPU [Call #13442000] About to launch kernel
30529.6s 21293 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30529.6s 21294 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30529.6s 21295 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30529.7s 21296 [WARNING] Automatic CFL correction applied (count: 3360400):
30529.7s 21297 Calculated CFL: 0.800 > Limit: 0.500
30529.7s 21298 Original dt: 3.408050e-01 s
30529.7s 21299 Corrected dt: 2.130031e-01 s
30529.7s 21300 Correction factor: 1.6x
30529.7s 21301 Max wave speed detected: 23.47 m/s
30529.8s 21302 [PROGRESS] Step 2350: t=500.32/510.00s (98.1%) | dt=0.2130s
30530.2s 21303 Stored output at t = 510.0000 s (Step 2396)
30530.2s 21304 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30530.2s 21305 [A
30530.2s 21306 
30530.2s 21307 Simulation finished at t = 510.0000 s after 2396 steps.
30530.2s 21308 Total runtime: 0.65 seconds.
30530.2s 21309 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 23.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 22.99s/s]
30530.2s 21310 [REWARD_MICROSCOPE] step=14714 t=510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30530.2s 21311 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30530.2s 21312 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30530.2s 21313 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30530.2s 21314 Running simulation until t = 525.00 s, outputting every 15.00 s
30530.2s 21315 
30530.2s 21316 [PROGRESS] Step 2400: t=510.85/525.00s (97.3%) | dt=0.2124s
30530.6s 21317 [WARNING] Automatic CFL correction applied (count: 3360500):
30530.6s 21318 Calculated CFL: 0.800 > Limit: 0.500
30530.6s 21319 Original dt: 3.402313e-01 s
30530.6s 21320 Corrected dt: 2.126446e-01 s
30530.6s 21321 Correction factor: 1.6x
30530.6s 21322 Max wave speed detected: 23.51 m/s
30530.7s 21323 [PROGRESS] Step 2450: t=521.47/525.00s (99.3%) | dt=0.2127s
30530.8s 21324 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30530.8s 21325 [A
30530.8s 21326 Stored output at t = 525.0000 s (Step 2467)
30530.8s 21327 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 22.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 22.95s/s]
30530.8s 21328 
30530.8s 21329 Simulation finished at t = 525.0000 s after 2467 steps.
30530.8s 21330 Total runtime: 0.65 seconds.
30530.8s 21331 [REWARD_MICROSCOPE] step=14715 t=525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30530.8s 21332 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30530.8s 21333 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30530.8s 21334 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30530.8s 21335 Running simulation until t = 540.00 s, outputting every 15.00 s
30530.8s 21336 
30531.1s 21337 [PROGRESS] Step 2500: t=532.03/540.00s (98.5%) | dt=0.2131s
30531.5s 21338 Stored output at t = 540.0000 s (Step 2538)
30531.5s 21339 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30531.5s 21340 [A
30531.5s 21341 
30531.5s 21342 Simulation finished at t = 540.0000 s after 2538 steps.
30531.5s 21343 Total runtime: 0.62 seconds.
30531.5s 21344 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 24.27s/s]
30531.5s 21345 [REWARD_MICROSCOPE] step=14716 t=540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30531.5s 21346 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30531.5s 21347 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30531.5s 21348 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30531.5s 21349 Running simulation until t = 555.00 s, outputting every 15.00 s
30531.5s 21350 
30531.5s 21351 [WARNING] Automatic CFL correction applied (count: 3360600):
30531.5s 21352 Calculated CFL: 0.800 > Limit: 0.500
30531.5s 21353 Original dt: 3.398030e-01 s
30531.5s 21354 Corrected dt: 2.123769e-01 s
30531.5s 21355 Correction factor: 1.6x
30531.5s 21356 Max wave speed detected: 23.54 m/s
30531.6s 21357 [PROGRESS] Step 2550: t=542.55/555.00s (97.8%) | dt=0.2123s
30531.9s 21358 [PERIODIC:1000] BC_DISPATCHER [Call #13443000] current_bc_params: <class 'dict'>
30531.9s 21359 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30531.9s 21360 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30531.9s 21361 [PERIODIC:1000] BC_GPU [Call #13443000] About to launch kernel
30531.9s 21362 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30531.9s 21363 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30531.9s 21364 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30532.0s 21365 [PROGRESS] Step 2600: t=553.18/555.00s (99.7%) | dt=0.2128s
30532.1s 21366 Stored output at t = 555.0000 s (Step 2609)
30532.1s 21367 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30532.1s 21368 [A
30532.1s 21369 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 23.96s/s]
30532.1s 21370 
30532.1s 21371 Simulation finished at t = 555.0000 s after 2609 steps.
30532.1s 21372 Total runtime: 0.63 seconds.
30532.1s 21373 [REWARD_MICROSCOPE] step=14717 t=555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30532.1s 21374 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30532.1s 21375 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30532.1s 21376 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30532.1s 21377 Running simulation until t = 570.00 s, outputting every 15.00 s
30532.1s 21378 
30532.4s 21379 [WARNING] Automatic CFL correction applied (count: 3360700):
30532.4s 21380 Calculated CFL: 0.800 > Limit: 0.500
30532.4s 21381 Original dt: 3.410260e-01 s
30532.4s 21382 Corrected dt: 2.131412e-01 s
30532.4s 21383 Correction factor: 1.6x
30532.4s 21384 Max wave speed detected: 23.46 m/s
30532.4s 21385 [PROGRESS] Step 2650: t=563.73/570.00s (98.9%) | dt=0.2132s
30532.7s 21386 Stored output at t = 570.0000 s (Step 2680)
30532.7s 21387 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30532.7s 21388 [A
30532.7s 21389 
30532.7s 21390 Simulation finished at t = 570.0000 s after 2680 steps.
30532.7s 21391 Total runtime: 0.62 seconds.
30532.7s 21392 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 24.34s/s]
30532.7s 21393 [REWARD_MICROSCOPE] step=14718 t=570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30532.7s 21394 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30532.7s 21395 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30532.7s 21396 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30532.7s 21397 Running simulation until t = 585.00 s, outputting every 15.00 s
30532.7s 21398 
30532.9s 21399 [PROGRESS] Step 2700: t=574.25/585.00s (98.2%) | dt=0.2124s
30533.3s 21400 [WARNING] Automatic CFL correction applied (count: 3360800):
30533.3s 21401 Calculated CFL: 0.800 > Limit: 0.500
30533.3s 21402 Original dt: 3.404547e-01 s
30533.3s 21403 Corrected dt: 2.127842e-01 s
30533.3s 21404 Correction factor: 1.6x
30533.3s 21405 Max wave speed detected: 23.50 m/s
30533.3s 21406 [PROGRESS] Step 2750: t=584.88/585.00s (100.0%) | dt=0.2128s
30533.3s 21407 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30533.3s 21408 Stored output at t = 585.0000 s (Step 2751)
30533.3s 21409 [A
30533.3s 21410 
30533.3s 21411 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.14s/s]
30533.3s 21412 Simulation finished at t = 585.0000 s after 2751 steps.
30533.3s 21413 Total runtime: 0.62 seconds.
30533.3s 21414 [REWARD_MICROSCOPE] step=14719 t=585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30533.3s 21415 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30533.3s 21416 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30533.3s 21417 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30533.3s 21418 Running simulation until t = 600.00 s, outputting every 15.00 s
30533.3s 21419 
30533.8s 21420 [PROGRESS] Step 2800: t=595.44/600.00s (99.2%) | dt=0.2133s
30534.0s 21421 Stored output at t = 600.0000 s (Step 2822)
30534.0s 21422 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30534.0s 21423 [A
30534.0s 21424 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 24.10s/s]
30534.0s 21425 
30534.0s 21426 Simulation finished at t = 600.0000 s after 2822 steps.
30534.0s 21427 Total runtime: 0.62 seconds.
30534.0s 21428 [REWARD_MICROSCOPE] step=14720 t=600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30534.0s 21429 [STEP   40] t=  600.0s | phase=0 | reward=   0.01 | total_reward=    0.40
30534.0s 21430 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30534.0s 21431 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30534.0s 21432 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30534.0s 21433 Running simulation until t = 615.00 s, outputting every 15.00 s
30534.0s 21434 
30534.1s 21435 [PERIODIC:1000] BC_DISPATCHER [Call #13444000] current_bc_params: <class 'dict'>
30534.1s 21436 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30534.1s 21437 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30534.1s 21438 [PERIODIC:1000] BC_GPU [Call #13444000] About to launch kernel
30534.1s 21439 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30534.1s 21440 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30534.1s 21441 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30534.2s 21442 [WARNING] Automatic CFL correction applied (count: 3360900):
30534.2s 21443 Calculated CFL: 0.800 > Limit: 0.500
30534.2s 21444 Original dt: 3.398585e-01 s
30534.2s 21445 Corrected dt: 2.124115e-01 s
30534.2s 21446 Correction factor: 1.6x
30534.2s 21447 Max wave speed detected: 23.54 m/s
30534.2s 21448 [PROGRESS] Step 2850: t=605.95/615.00s (98.5%) | dt=0.2125s
30534.6s 21449 Stored output at t = 615.0000 s (Step 2893)
30534.6s 21450 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 600.0/615.0 [00:00<?, ?s/s][A
30534.6s 21451 [A
30534.6s 21452 
30534.6s 21453 Simulation finished at t = 615.0000 s after 2893 steps.
30534.6s 21454 Total runtime: 0.63 seconds.
30534.6s 21455 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.97s/s]
30534.6s 21456 [QUEUE_DIAGNOSTIC] ===== Step 40 t=615.0s =====
30534.6s 21457 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30534.6s 21458 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30534.6s 21459 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30534.6s 21460 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30534.6s 21461 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30534.6s 21462 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30534.6s 21463 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30534.6s 21464 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30534.6s 21465 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30534.6s 21466 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30534.6s 21467 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30534.6s 21468 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30534.6s 21469 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30534.6s 21470 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30534.6s 21471 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30534.6s 21472 [REWARD_MICROSCOPE] step=14721 t=615.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30534.6s 21473 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30534.6s 21474 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30534.6s 21475 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30534.6s 21476 Running simulation until t = 630.00 s, outputting every 15.00 s
30534.6s 21477 
30534.6s 21478 [PROGRESS] Step 2900: t=616.49/630.00s (97.9%) | dt=0.2129s
30535.1s 21479 [WARNING] Automatic CFL correction applied (count: 3361000):
30535.1s 21480 Calculated CFL: 0.800 > Limit: 0.500
30535.1s 21481 Original dt: 3.412422e-01 s
30535.1s 21482 Corrected dt: 2.132764e-01 s
30535.1s 21483 Correction factor: 1.6x
30535.1s 21484 Max wave speed detected: 23.44 m/s
30535.1s 21485 [PROGRESS] Step 2950: t=627.15/630.00s (99.5%) | dt=0.2131s
30535.3s 21486 Stored output at t = 630.0000 s (Step 2964)
30535.3s 21487 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 615.0/630.0 [00:00<?, ?s/s][A
30535.3s 21488 [A
30535.3s 21489 
30535.3s 21490 Simulation finished at t = 630.0000 s after 2964 steps.
30535.3s 21491 Total runtime: 0.68 seconds.
30535.3s 21492 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 22.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 22.22s/s]
30535.3s 21493 [REWARD_MICROSCOPE] step=14722 t=630.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30535.3s 21494 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30535.3s 21495 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30535.3s 21496 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30535.3s 21497 Running simulation until t = 645.00 s, outputting every 15.00 s
30535.3s 21498 
30535.6s 21499 [PROGRESS] Step 3000: t=637.65/645.00s (98.9%) | dt=0.2125s
30535.9s 21500 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 630.0/645.0 [00:00<?, ?s/s][A
30535.9s 21501 [A
30535.9s 21502 Stored output at t = 645.0000 s (Step 3035)
30535.9s 21503 
30535.9s 21504 Simulation finished at t = 645.0000 s after 3035 steps.
30535.9s 21505 Total runtime: 0.64 seconds.
30535.9s 21506 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 23.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 23.33s/s]
30535.9s 21507 [REWARD_MICROSCOPE] step=14723 t=645.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30535.9s 21508 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30535.9s 21509 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30535.9s 21510 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30535.9s 21511 Running simulation until t = 660.00 s, outputting every 15.00 s
30535.9s 21512 
30536.0s 21513 [WARNING] Automatic CFL correction applied (count: 3361100):
30536.0s 21514 Calculated CFL: 0.800 > Limit: 0.500
30536.0s 21515 Original dt: 3.406657e-01 s
30536.0s 21516 Corrected dt: 2.129161e-01 s
30536.0s 21517 Correction factor: 1.6x
30536.0s 21518 Max wave speed detected: 23.48 m/s
30536.0s 21519 [PROGRESS] Step 3050: t=648.19/660.00s (98.2%) | dt=0.2130s
30536.4s 21520 [PERIODIC:1000] BC_DISPATCHER [Call #13445000] current_bc_params: <class 'dict'>
30536.4s 21521 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30536.4s 21522 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30536.4s 21523 [PERIODIC:1000] BC_GPU [Call #13445000] About to launch kernel
30536.4s 21524 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30536.4s 21525 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30536.4s 21526 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30536.5s 21527 [PROGRESS] Step 3100: t=658.85/660.00s (99.8%) | dt=0.2127s
30536.5s 21528 Stored output at t = 660.0000 s (Step 3106)
30536.5s 21529 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 645.0/660.0 [00:00<?, ?s/s][A
30536.5s 21530 [A
30536.5s 21531 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 24.18s/s]
30536.5s 21532 
30536.5s 21533 Simulation finished at t = 660.0000 s after 3106 steps.
30536.5s 21534 Total runtime: 0.62 seconds.
30536.5s 21535 [REWARD_MICROSCOPE] step=14724 t=660.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30536.5s 21536 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30536.5s 21537 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30536.5s 21538 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30536.5s 21539 Running simulation until t = 675.00 s, outputting every 15.00 s
30536.5s 21540 
30536.9s 21541 [WARNING] Automatic CFL correction applied (count: 3361200):
30536.9s 21542 Calculated CFL: 0.800 > Limit: 0.500
30536.9s 21543 Original dt: 3.400921e-01 s
30536.9s 21544 Corrected dt: 2.125575e-01 s
30536.9s 21545 Correction factor: 1.6x
30536.9s 21546 Max wave speed detected: 23.52 m/s
30536.9s 21547 [PROGRESS] Step 3150: t=669.35/675.00s (99.2%) | dt=0.2126s
30537.2s 21548 Stored output at t = 675.0000 s (Step 3177)
30537.2s 21549 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 660.0/675.0 [00:00<?, ?s/s][A
30537.2s 21550 [A
30537.2s 21551 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 24.21s/s]
30537.2s 21552 
30537.2s 21553 Simulation finished at t = 675.0000 s after 3177 steps.
30537.2s 21554 Total runtime: 0.62 seconds.
30537.2s 21555 [REWARD_MICROSCOPE] step=14725 t=675.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30537.2s 21556 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30537.2s 21557 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30537.2s 21558 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30537.2s 21559 Running simulation until t = 690.00 s, outputting every 15.00 s
30537.2s 21560 
30537.4s 21561 [PROGRESS] Step 3200: t=679.90/690.00s (98.5%) | dt=0.2130s
30537.7s 21562 [WARNING] Automatic CFL correction applied (count: 3361300):
30537.7s 21563 Calculated CFL: 0.800 > Limit: 0.500
30537.7s 21564 Original dt: 3.402189e-01 s
30537.7s 21565 Corrected dt: 2.126368e-01 s
30537.7s 21566 Correction factor: 1.6x
30537.7s 21567 Max wave speed detected: 23.51 m/s
30537.8s 21568 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 675.0/690.0 [00:00<?, ?s/s][A
30537.8s 21569 [A
30537.8s 21570 Stored output at t = 690.0000 s (Step 3248)
30537.8s 21571 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.49s/s]
30537.8s 21572 
30537.8s 21573 Simulation finished at t = 690.0000 s after 3248 steps.
30537.8s 21574 Total runtime: 0.61 seconds.
30537.8s 21575 [REWARD_MICROSCOPE] step=14726 t=690.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30537.8s 21576 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30537.8s 21577 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30537.8s 21578 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30537.8s 21579 Running simulation until t = 705.00 s, outputting every 15.00 s
30537.8s 21580 
30537.8s 21581 [PROGRESS] Step 3250: t=690.43/705.00s (97.9%) | dt=0.2125s
30538.2s 21582 [PROGRESS] Step 3300: t=701.05/705.00s (99.4%) | dt=0.2127s
30538.4s 21583 Stored output at t = 705.0000 s (Step 3319)
30538.4s 21584 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 690.0/705.0 [00:00<?, ?s/s][A
30538.4s 21585 [A
30538.4s 21586 
30538.4s 21587 Simulation finished at t = 705.0000 s after 3319 steps.
30538.4s 21588 Total runtime: 0.61 seconds.
30538.4s 21589 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 24.46s/s]
30538.4s 21590 [REWARD_MICROSCOPE] step=14727 t=705.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30538.4s 21591 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30538.4s 21592 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30538.4s 21593 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30538.4s 21594 Running simulation until t = 720.00 s, outputting every 15.00 s
30538.4s 21595 
30538.6s 21596 [PERIODIC:1000] BC_DISPATCHER [Call #13446000] current_bc_params: <class 'dict'>
30538.6s 21597 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30538.6s 21598 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30538.6s 21599 [PERIODIC:1000] BC_GPU [Call #13446000] About to launch kernel
30538.6s 21600 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30538.6s 21601 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30538.6s 21602 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30538.6s 21603 [WARNING] Automatic CFL correction applied (count: 3361400):
30538.6s 21604 Calculated CFL: 0.800 > Limit: 0.500
30538.6s 21605 Original dt: 3.408895e-01 s
30538.6s 21606 Corrected dt: 2.130559e-01 s
30538.6s 21607 Correction factor: 1.6x
30538.6s 21608 Max wave speed detected: 23.47 m/s
30538.7s 21609 [PROGRESS] Step 3350: t=711.60/720.00s (98.8%) | dt=0.2131s
30539.0s 21610 Stored output at t = 720.0000 s (Step 3390)
30539.0s 21611 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 705.0/720.0 [00:00<?, ?s/s][A
30539.0s 21612 [A
30539.0s 21613 
30539.0s 21614 Simulation finished at t = 720.0000 s after 3390 steps.
30539.0s 21615 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 24.36s/s]
30539.0s 21616 Total runtime: 0.62 seconds.
30539.0s 21617 [REWARD_MICROSCOPE] step=14728 t=720.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30539.0s 21618 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30539.0s 21619 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30539.0s 21620 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30539.0s 21621 Running simulation until t = 735.00 s, outputting every 15.00 s
30539.0s 21622 
30539.1s 21623 [PROGRESS] Step 3400: t=722.12/735.00s (98.2%) | dt=0.2123s
30539.5s 21624 [WARNING] Automatic CFL correction applied (count: 3361500):
30539.5s 21625 Calculated CFL: 0.800 > Limit: 0.500
30539.5s 21626 Original dt: 3.403151e-01 s
30539.5s 21627 Corrected dt: 2.126969e-01 s
30539.5s 21628 Correction factor: 1.6x
30539.5s 21629 Max wave speed detected: 23.51 m/s
30539.5s 21630 [PROGRESS] Step 3450: t=732.75/735.00s (99.7%) | dt=0.2127s
30539.6s 21631 Stored output at t = 735.0000 s (Step 3461)
30539.6s 21632 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 720.0/735.0 [00:00<?, ?s/s][A
30539.6s 21633 [A
30539.6s 21634 
30539.6s 21635 Simulation finished at t = 735.0000 s after 3461 steps.
30539.6s 21636 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 24.12s/s]
30539.6s 21637 Total runtime: 0.62 seconds.
30539.6s 21638 [REWARD_MICROSCOPE] step=14729 t=735.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30539.6s 21639 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30539.6s 21640 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30539.6s 21641 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30539.6s 21642 Running simulation until t = 750.00 s, outputting every 15.00 s
30539.6s 21643 
30540.0s 21644 [PROGRESS] Step 3500: t=743.31/750.00s (99.1%) | dt=0.2132s
30540.3s 21645 Stored output at t = 750.0000 s (Step 3532)
30540.3s 21646 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 735.0/750.0 [00:00<?, ?s/s][A
30540.3s 21647 [A
30540.3s 21648 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 23.29s/s]
30540.3s 21649 
30540.3s 21650 Simulation finished at t = 750.0000 s after 3532 steps.
30540.3s 21651 Total runtime: 0.64 seconds.
30540.3s 21652 [REWARD_MICROSCOPE] step=14730 t=750.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30540.3s 21653 [STEP   50] t=  750.0s | phase=0 | reward=   0.01 | total_reward=    0.50
30540.3s 21654 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30540.3s 21655 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30540.3s 21656 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30540.3s 21657 Running simulation until t = 765.00 s, outputting every 15.00 s
30540.3s 21658 
30540.4s 21659 [WARNING] Automatic CFL correction applied (count: 3361600):
30540.4s 21660 Calculated CFL: 0.800 > Limit: 0.500
30540.4s 21661 Original dt: 3.397193e-01 s
30540.4s 21662 Corrected dt: 2.123245e-01 s
30540.4s 21663 Correction factor: 1.6x
30540.4s 21664 Max wave speed detected: 23.55 m/s
30540.4s 21665 [PROGRESS] Step 3550: t=753.82/765.00s (98.5%) | dt=0.2124s
30540.8s 21666 [PERIODIC:1000] BC_DISPATCHER [Call #13447000] current_bc_params: <class 'dict'>
30540.8s 21667 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30540.8s 21668 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30540.8s 21669 [PERIODIC:1000] BC_GPU [Call #13447000] About to launch kernel
30540.8s 21670 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30540.8s 21671 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30540.8s 21672 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30540.9s 21673 [PROGRESS] Step 3600: t=764.45/765.00s (99.9%) | dt=0.2128s
30540.9s 21674 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 750.0/765.0 [00:00<?, ?s/s][A
30540.9s 21675 Stored output at t = 765.0000 s (Step 3603)
30540.9s 21676 [A
30540.9s 21677 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.10s/s]
30540.9s 21678 
30540.9s 21679 Simulation finished at t = 765.0000 s after 3603 steps.
30540.9s 21680 Total runtime: 0.65 seconds.
30540.9s 21681 [QUEUE_DIAGNOSTIC] ===== Step 50 t=765.0s =====
30540.9s 21682 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30540.9s 21683 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30540.9s 21684 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30540.9s 21685 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30540.9s 21686 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30540.9s 21687 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30540.9s 21688 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30540.9s 21689 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30540.9s 21690 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30540.9s 21691 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30540.9s 21692 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30540.9s 21693 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30540.9s 21694 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30540.9s 21695 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30540.9s 21696 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30540.9s 21697 [REWARD_MICROSCOPE] step=14731 t=765.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30540.9s 21698 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30540.9s 21699 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30540.9s 21700 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30540.9s 21701 Running simulation until t = 780.00 s, outputting every 15.00 s
30540.9s 21702 
30541.3s 21703 [WARNING] Automatic CFL correction applied (count: 3361700):
30541.3s 21704 Calculated CFL: 0.800 > Limit: 0.500
30541.3s 21705 Original dt: 3.411064e-01 s
30541.3s 21706 Corrected dt: 2.131915e-01 s
30541.3s 21707 Correction factor: 1.6x
30541.3s 21708 Max wave speed detected: 23.45 m/s
30541.3s 21709 [PROGRESS] Step 3650: t=775.01/780.00s (99.4%) | dt=0.2132s
30541.6s 21710 Stored output at t = 780.0000 s (Step 3674)
30541.6s 21711 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 765.0/780.0 [00:00<?, ?s/s][A
30541.6s 21712 [A
30541.6s 21713 
30541.6s 21714 Simulation finished at t = 780.0000 s after 3674 steps.
30541.6s 21715 Total runtime: 0.62 seconds.
30541.6s 21716 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 24.06s/s]
30541.6s 21717 [REWARD_MICROSCOPE] step=14732 t=780.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30541.6s 21718 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30541.6s 21719 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30541.6s 21720 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30541.6s 21721 Running simulation until t = 795.00 s, outputting every 15.00 s
30541.6s 21722 
30541.8s 21723 [PROGRESS] Step 3700: t=785.52/795.00s (98.8%) | dt=0.2124s
30542.2s 21724 [WARNING] Automatic CFL correction applied (count: 3361800):
30542.2s 21725 Calculated CFL: 0.800 > Limit: 0.500
30542.2s 21726 Original dt: 3.405361e-01 s
30542.2s 21727 Corrected dt: 2.128351e-01 s
30542.2s 21728 Correction factor: 1.6x
30542.2s 21729 Max wave speed detected: 23.49 m/s
30542.2s 21730 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 780.0/795.0 [00:00<?, ?s/s][A
30542.2s 21731 [A
30542.2s 21732 Stored output at t = 795.0000 s (Step 3745)
30542.2s 21733 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.29s/s]
30542.2s 21734 
30542.2s 21735 Simulation finished at t = 795.0000 s after 3745 steps.
30542.2s 21736 Total runtime: 0.62 seconds.
30542.2s 21737 [REWARD_MICROSCOPE] step=14733 t=795.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30542.2s 21738 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30542.2s 21739 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30542.2s 21740 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30542.2s 21741 Running simulation until t = 810.00 s, outputting every 15.00 s
30542.2s 21742 
30542.2s 21743 [PROGRESS] Step 3750: t=796.06/810.00s (98.3%) | dt=0.2129s
30542.7s 21744 [PROGRESS] Step 3800: t=806.72/810.00s (99.6%) | dt=0.2133s
30542.8s 21745 Stored output at t = 810.0000 s (Step 3816)
30542.8s 21746 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 795.0/810.0 [00:00<?, ?s/s][A
30542.8s 21747 [A
30542.8s 21748 
30542.8s 21749 Simulation finished at t = 810.0000 s after 3816 steps.
30542.8s 21750 Total runtime: 0.61 seconds.
30542.8s 21751 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 24.42s/s]
30542.8s 21752 [REWARD_MICROSCOPE] step=14734 t=810.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30542.8s 21753 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30542.8s 21754 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30542.8s 21755 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30542.8s 21756 Running simulation until t = 825.00 s, outputting every 15.00 s
30542.8s 21757 
30543.0s 21758 [PERIODIC:1000] BC_DISPATCHER [Call #13448000] current_bc_params: <class 'dict'>
30543.0s 21759 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30543.0s 21760 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30543.0s 21761 [PERIODIC:1000] BC_GPU [Call #13448000] About to launch kernel
30543.0s 21762 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30543.0s 21763 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30543.0s 21764 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30543.0s 21765 [WARNING] Automatic CFL correction applied (count: 3361900):
30543.0s 21766 Calculated CFL: 0.800 > Limit: 0.500
30543.0s 21767 Original dt: 3.399493e-01 s
30543.0s 21768 Corrected dt: 2.124683e-01 s
30543.0s 21769 Correction factor: 1.6x
30543.0s 21770 Max wave speed detected: 23.53 m/s
30543.1s 21771 [PROGRESS] Step 3850: t=817.22/825.00s (99.1%) | dt=0.2125s
30543.4s 21772 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 810.0/825.0 [00:00<?, ?s/s][A
30543.4s 21773 Stored output at t = 825.0000 s (Step 3887)
30543.4s 21774 [A
30543.4s 21775 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 23.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 23.11s/s]
30543.4s 21776 
30543.4s 21777 Simulation finished at t = 825.0000 s after 3887 steps.
30543.4s 21778 Total runtime: 0.65 seconds.
30543.4s 21779 [REWARD_MICROSCOPE] step=14735 t=825.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30543.4s 21780 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30543.4s 21781 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30543.4s 21782 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30543.4s 21783 Running simulation until t = 840.00 s, outputting every 15.00 s
30543.4s 21784 
30543.6s 21785 [PROGRESS] Step 3900: t=827.77/840.00s (98.5%) | dt=0.2129s
30543.9s 21786 [WARNING] Automatic CFL correction applied (count: 3362000):
30543.9s 21787 Calculated CFL: 0.800 > Limit: 0.500
30543.9s 21788 Original dt: 3.409227e-01 s
30543.9s 21789 Corrected dt: 2.130767e-01 s
30543.9s 21790 Correction factor: 1.6x
30543.9s 21791 Max wave speed detected: 23.47 m/s
30544.0s 21792 [PROGRESS] Step 3950: t=838.42/840.00s (99.8%) | dt=0.2128s
30544.1s 21793 Stored output at t = 840.0000 s (Step 3958)
30544.1s 21794 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 825.0/840.0 [00:00<?, ?s/s][A
30544.1s 21795 [A
30544.1s 21796 
30544.1s 21797 Simulation finished at t = 840.0000 s after 3958 steps.
30544.1s 21798 Total runtime: 0.62 seconds.
30544.1s 21799 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.30s/s]
30544.1s 21800 [REWARD_MICROSCOPE] step=14736 t=840.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30544.1s 21801 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30544.1s 21802 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30544.1s 21803 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30544.1s 21804 Running simulation until t = 855.00 s, outputting every 15.00 s
30544.1s 21805 
30544.4s 21806 [PROGRESS] Step 4000: t=848.92/855.00s (99.3%) | dt=0.2126s
30544.7s 21807 Stored output at t = 855.0000 s (Step 4029)
30544.7s 21808 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 840.0/855.0 [00:00<?, ?s/s][A
30544.7s 21809 [A
30544.7s 21810 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.20s/s]
30544.7s 21811 
30544.7s 21812 Simulation finished at t = 855.0000 s after 4029 steps.
30544.7s 21813 Total runtime: 0.62 seconds.
30544.7s 21814 [REWARD_MICROSCOPE] step=14737 t=855.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30544.7s 21815 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30544.7s 21816 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30544.7s 21817 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30544.7s 21818 Running simulation until t = 870.00 s, outputting every 15.00 s
30544.7s 21819 
30544.8s 21820 [WARNING] Automatic CFL correction applied (count: 3362100):
30544.8s 21821 Calculated CFL: 0.800 > Limit: 0.500
30544.8s 21822 Original dt: 3.407491e-01 s
30544.8s 21823 Corrected dt: 2.129682e-01 s
30544.8s 21824 Correction factor: 1.6x
30544.8s 21825 Max wave speed detected: 23.48 m/s
30544.9s 21826 [PROGRESS] Step 4050: t=859.47/870.00s (98.8%) | dt=0.2130s
30545.2s 21827 [PERIODIC:1000] BC_DISPATCHER [Call #13449000] current_bc_params: <class 'dict'>
30545.2s 21828 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30545.2s 21829 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30545.2s 21830 [PERIODIC:1000] BC_GPU [Call #13449000] About to launch kernel
30545.2s 21831 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30545.2s 21832 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30545.2s 21833 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30545.3s 21834 [PROGRESS] Step 4100: t=870.00/870.00s (100.0%) | dt=0.0883s
30545.3s 21835 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 855.0/870.0 [00:00<?, ?s/s][A
30545.3s 21836 [A
30545.3s 21837 Stored output at t = 870.0000 s (Step 4100)
30545.3s 21838 
30545.3s 21839 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 23.97s/s]
30545.3s 21840 Simulation finished at t = 870.0000 s after 4100 steps.
30545.3s 21841 Total runtime: 0.63 seconds.
30545.3s 21842 [REWARD_MICROSCOPE] step=14738 t=870.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30545.3s 21843 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30545.3s 21844 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30545.3s 21845 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30545.3s 21846 Running simulation until t = 885.00 s, outputting every 15.00 s
30545.3s 21847 
30545.7s 21848 [WARNING] Automatic CFL correction applied (count: 3362200):
30545.7s 21849 Calculated CFL: 0.800 > Limit: 0.500
30545.7s 21850 Original dt: 3.401756e-01 s
30545.7s 21851 Corrected dt: 2.126097e-01 s
30545.7s 21852 Correction factor: 1.6x
30545.7s 21853 Max wave speed detected: 23.52 m/s
30545.8s 21854 [PROGRESS] Step 4150: t=880.62/885.00s (99.5%) | dt=0.2127s
30545.9s 21855 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 870.0/885.0 [00:00<?, ?s/s][A
30545.9s 21856 [A
30545.9s 21857 Stored output at t = 885.0000 s (Step 4171)
30545.9s 21858 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 24.22s/s]
30545.9s 21859 
30545.9s 21860 Simulation finished at t = 885.0000 s after 4171 steps.
30545.9s 21861 Total runtime: 0.62 seconds.
30545.9s 21862 [REWARD_MICROSCOPE] step=14739 t=885.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30545.9s 21863 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30545.9s 21864 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30545.9s 21865 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30545.9s 21866 Running simulation until t = 900.00 s, outputting every 15.00 s
30545.9s 21867 
30546.2s 21868 [PROGRESS] Step 4200: t=891.18/900.00s (99.0%) | dt=0.2131s
30546.6s 21869 Stored output at t = 900.0000 s (Step 4242)
30546.6s 21870 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 885.0/900.0 [00:00<?, ?s/s][A
30546.6s 21871 [A
30546.6s 21872 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 23.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 23.80s/s]
30546.6s 21873 
30546.6s 21874 Simulation finished at t = 900.0000 s after 4242 steps.
30546.6s 21875 Total runtime: 0.63 seconds.
30546.6s 21876 [REWARD_MICROSCOPE] step=14740 t=900.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30546.6s 21877 [STEP   60] t=  900.0s | phase=0 | reward=   0.01 | total_reward=    0.60
30546.6s 21878 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30546.6s 21879 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30546.6s 21880 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30546.6s 21881 Running simulation until t = 915.00 s, outputting every 15.00 s
30546.6s 21882 
30546.6s 21883 [WARNING] Automatic CFL correction applied (count: 3362300):
30546.6s 21884 Calculated CFL: 0.800 > Limit: 0.500
30546.6s 21885 Original dt: 3.399530e-01 s
30546.6s 21886 Corrected dt: 2.124706e-01 s
30546.6s 21887 Correction factor: 1.6x
30546.6s 21888 Max wave speed detected: 23.53 m/s
30546.6s 21889 [PROGRESS] Step 4250: t=901.70/915.00s (98.5%) | dt=0.2124s
30547.1s 21890 [PROGRESS] Step 4300: t=912.32/915.00s (99.7%) | dt=0.2127s
30547.2s 21891 Stored output at t = 915.0000 s (Step 4313)
30547.2s 21892 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 900.0/915.0 [00:00<?, ?s/s][A
30547.2s 21893 [A
30547.2s 21894 
30547.2s 21895 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 23.95s/s]
30547.2s 21896 Simulation finished at t = 915.0000 s after 4313 steps.
30547.2s 21897 Total runtime: 0.63 seconds.
30547.2s 21898 [QUEUE_DIAGNOSTIC] ===== Step 60 t=915.0s =====
30547.2s 21899 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30547.2s 21900 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30547.2s 21901 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30547.2s 21902 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30547.2s 21903 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30547.2s 21904 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30547.2s 21905 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30547.2s 21906 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30547.2s 21907 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30547.2s 21908 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30547.2s 21909 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30547.2s 21910 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30547.2s 21911 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30547.2s 21912 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30547.2s 21913 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30547.2s 21914 [REWARD_MICROSCOPE] step=14741 t=915.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30547.2s 21915 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30547.2s 21916 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30547.2s 21917 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30547.2s 21918 Running simulation until t = 930.00 s, outputting every 15.00 s
30547.2s 21919 
30547.4s 21920 [PERIODIC:1000] BC_DISPATCHER [Call #13450000] current_bc_params: <class 'dict'>
30547.4s 21921 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30547.4s 21922 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30547.4s 21923 [PERIODIC:1000] BC_GPU [Call #13450000] About to launch kernel
30547.4s 21924 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30547.4s 21925 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30547.4s 21926 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30547.5s 21927 [WARNING] Automatic CFL correction applied (count: 3362400):
30547.5s 21928 Calculated CFL: 0.800 > Limit: 0.500
30547.5s 21929 Original dt: 3.409728e-01 s
30547.5s 21930 Corrected dt: 2.131080e-01 s
30547.5s 21931 Correction factor: 1.6x
30547.5s 21932 Max wave speed detected: 23.46 m/s
30547.5s 21933 [PROGRESS] Step 4350: t=922.88/930.00s (99.2%) | dt=0.2131s
30547.8s 21934 Stored output at t = 930.0000 s (Step 4384)
30547.8s 21935 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 915.0/930.0 [00:00<?, ?s/s][A
30547.8s 21936 [A
30547.8s 21937 
30547.8s 21938 Simulation finished at t = 930.0000 s after 4384 steps.
30547.8s 21939 Total runtime: 0.64 seconds.
30547.8s 21940 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.27s/s]
30547.8s 21941 [REWARD_MICROSCOPE] step=14742 t=930.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30547.8s 21942 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30547.8s 21943 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30547.8s 21944 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30547.8s 21945 Running simulation until t = 945.00 s, outputting every 15.00 s
30547.8s 21946 
30548.0s 21947 [PROGRESS] Step 4400: t=933.40/945.00s (98.8%) | dt=0.2123s
30548.4s 21948 [WARNING] Automatic CFL correction applied (count: 3362500):
30548.4s 21949 Calculated CFL: 0.800 > Limit: 0.500
30548.4s 21950 Original dt: 3.403992e-01 s
30548.4s 21951 Corrected dt: 2.127495e-01 s
30548.4s 21952 Correction factor: 1.6x
30548.4s 21953 Max wave speed detected: 23.50 m/s
30548.4s 21954 [PROGRESS] Step 4450: t=944.03/945.00s (99.9%) | dt=0.2128s
30548.5s 21955 Stored output at t = 945.0000 s (Step 4455)
30548.5s 21956 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 930.0/945.0 [00:00<?, ?s/s][A
30548.5s 21957 [A
30548.5s 21958 
30548.5s 21959 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 23.82s/s]
30548.5s 21960 Simulation finished at t = 945.0000 s after 4455 steps.
30548.5s 21961 Total runtime: 0.63 seconds.
30548.5s 21962 [REWARD_MICROSCOPE] step=14743 t=945.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30548.5s 21963 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30548.5s 21964 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30548.5s 21965 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30548.5s 21966 Running simulation until t = 960.00 s, outputting every 15.00 s
30548.5s 21967 
30548.9s 21968 [PROGRESS] Step 4500: t=954.59/960.00s (99.4%) | dt=0.2132s
30549.1s 21969 Stored output at t = 960.0000 s (Step 4526)
30549.1s 21970 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 945.0/960.0 [00:00<?, ?s/s][A
30549.1s 21971 [A
30549.1s 21972 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.80s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.79s/s]
30549.1s 21973 
30549.1s 21974 Simulation finished at t = 960.0000 s after 4526 steps.
30549.1s 21975 Total runtime: 0.63 seconds.
30549.1s 21976 [REWARD_MICROSCOPE] step=14744 t=960.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30549.1s 21977 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30549.1s 21978 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30549.1s 21979 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30549.1s 21980 Running simulation until t = 975.00 s, outputting every 15.00 s
30549.1s 21981 
30549.3s 21982 [WARNING] Automatic CFL correction applied (count: 3362600):
30549.3s 21983 Calculated CFL: 0.800 > Limit: 0.500
30549.3s 21984 Original dt: 3.397973e-01 s
30549.3s 21985 Corrected dt: 2.123733e-01 s
30549.3s 21986 Correction factor: 1.6x
30549.3s 21987 Max wave speed detected: 23.54 m/s
30549.3s 21988 [PROGRESS] Step 4550: t=965.10/975.00s (99.0%) | dt=0.2124s
30549.7s 21989 [PERIODIC:1000] BC_DISPATCHER [Call #13451000] current_bc_params: <class 'dict'>
30549.7s 21990 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30549.7s 21991 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30549.7s 21992 [PERIODIC:1000] BC_GPU [Call #13451000] About to launch kernel
30549.7s 21993 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30549.7s 21994 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30549.7s 21995 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30549.7s 21996 Stored output at t = 975.0000 s (Step 4597)
30549.7s 21997 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 960.0/975.0 [00:00<?, ?s/s][A
30549.7s 21998 [A
30549.7s 21999 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.05s/s]
30549.7s 22000 
30549.7s 22001 Simulation finished at t = 975.0000 s after 4597 steps.
30549.7s 22002 Total runtime: 0.62 seconds.
30549.7s 22003 [REWARD_MICROSCOPE] step=14745 t=975.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30549.7s 22004 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30549.7s 22005 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30549.7s 22006 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30549.7s 22007 Running simulation until t = 990.00 s, outputting every 15.00 s
30549.7s 22008 
30549.8s 22009 [PROGRESS] Step 4600: t=975.64/990.00s (98.5%) | dt=0.2129s
30550.2s 22010 [WARNING] Automatic CFL correction applied (count: 3362700):
30550.2s 22011 Calculated CFL: 0.800 > Limit: 0.500
30550.2s 22012 Original dt: 3.411876e-01 s
30550.2s 22013 Corrected dt: 2.132423e-01 s
30550.2s 22014 Correction factor: 1.6x
30550.2s 22015 Max wave speed detected: 23.45 m/s
30550.2s 22016 [PROGRESS] Step 4650: t=986.29/990.00s (99.6%) | dt=0.2133s
30550.4s 22017 Stored output at t = 990.0000 s (Step 4668)
30550.4s 22018 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975.0/990.0 [00:00<?, ?s/s][A
30550.4s 22019 [A
30550.4s 22020 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 23.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 23.59s/s]
30550.4s 22021 
30550.4s 22022 Simulation finished at t = 990.0000 s after 4668 steps.
30550.4s 22023 Total runtime: 0.64 seconds.
30550.4s 22024 [REWARD_MICROSCOPE] step=14746 t=990.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30550.4s 22025 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30550.4s 22026 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30550.4s 22027 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30550.4s 22028 Running simulation until t = 1005.00 s, outputting every 15.00 s
30550.4s 22029 
30550.7s 22030 [PROGRESS] Step 4700: t=996.80/1005.00s (99.2%) | dt=0.2125s
30551.0s 22031 Stored output at t = 1005.0000 s (Step 4739)
30551.0s 22032 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 990.0/1005.0 [00:00<?, ?s/s][A
30551.0s 22033 [A
30551.0s 22034 
30551.0s 22035 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 22.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 22.71s/s]
30551.0s 22036 Simulation finished at t = 1005.0000 s after 4739 steps.
30551.0s 22037 Total runtime: 0.66 seconds.
30551.0s 22038 [REWARD_MICROSCOPE] step=14747 t=1005.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30551.0s 22039 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30551.0s 22040 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30551.0s 22041 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30551.0s 22042 Running simulation until t = 1020.00 s, outputting every 15.00 s
30551.0s 22043 
30551.1s 22044 [WARNING] Automatic CFL correction applied (count: 3362800):
30551.1s 22045 Calculated CFL: 0.800 > Limit: 0.500
30551.1s 22046 Original dt: 3.406104e-01 s
30551.1s 22047 Corrected dt: 2.128815e-01 s
30551.1s 22048 Correction factor: 1.6x
30551.1s 22049 Max wave speed detected: 23.49 m/s
30551.1s 22050 [PROGRESS] Step 4750: t=1007.34/1020.00s (98.8%) | dt=0.2129s
30551.6s 22051 [PROGRESS] Step 4800: t=1018.00/1020.00s (99.8%) | dt=0.2129s
30551.7s 22052 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1005.0/1020.0 [00:00<?, ?s/s][A
30551.7s 22053 [A
30551.7s 22054 Stored output at t = 1020.0000 s (Step 4810)
30551.7s 22055 
30551.7s 22056 Simulation finished at t = 1020.0000 s after 4810 steps.
30551.7s 22057 Total runtime: 0.62 seconds.
30551.7s 22058 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 24.36s/s]
30551.7s 22059 [REWARD_MICROSCOPE] step=14748 t=1020.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30551.7s 22060 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30551.7s 22061 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30551.7s 22062 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30551.7s 22063 Running simulation until t = 1035.00 s, outputting every 15.00 s
30551.7s 22064 
30551.9s 22065 [PERIODIC:1000] BC_DISPATCHER [Call #13452000] current_bc_params: <class 'dict'>
30551.9s 22066 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30551.9s 22067 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30551.9s 22068 [PERIODIC:1000] BC_GPU [Call #13452000] About to launch kernel
30551.9s 22069 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30551.9s 22070 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30551.9s 22071 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30552.0s 22072 [WARNING] Automatic CFL correction applied (count: 3362900):
30552.0s 22073 Calculated CFL: 0.800 > Limit: 0.500
30552.0s 22074 Original dt: 3.400365e-01 s
30552.0s 22075 Corrected dt: 2.125228e-01 s
30552.0s 22076 Correction factor: 1.6x
30552.0s 22077 Max wave speed detected: 23.53 m/s
30552.0s 22078 [PROGRESS] Step 4850: t=1028.50/1035.00s (99.4%) | dt=0.2126s
30552.3s 22079 Stored output at t = 1035.0000 s (Step 4881)
30552.3s 22080 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1020.0/1035.0 [00:00<?, ?s/s][A
30552.3s 22081 [A
30552.3s 22082 
30552.3s 22083 Simulation finished at t = 1035.0000 s after 4881 steps.
30552.3s 22084 Total runtime: 0.62 seconds.
30552.3s 22085 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 24.18s/s]
30552.3s 22086 [REWARD_MICROSCOPE] step=14749 t=1035.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30552.3s 22087 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30552.3s 22088 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30552.3s 22089 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30552.3s 22090 Running simulation until t = 1050.00 s, outputting every 15.00 s
30552.3s 22091 
30552.5s 22092 [PROGRESS] Step 4900: t=1039.05/1050.00s (99.0%) | dt=0.2130s
30552.8s 22093 [WARNING] Automatic CFL correction applied (count: 3363000):
30552.8s 22094 Calculated CFL: 0.800 > Limit: 0.500
30552.8s 22095 Original dt: 3.404624e-01 s
30552.8s 22096 Corrected dt: 2.127890e-01 s
30552.8s 22097 Correction factor: 1.6x
30552.8s 22098 Max wave speed detected: 23.50 m/s
30552.9s 22099 [PROGRESS] Step 4950: t=1049.70/1050.00s (100.0%) | dt=0.2126s
30552.9s 22100 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1035.0/1050.0 [00:00<?, ?s/s][A
30552.9s 22101 Stored output at t = 1050.0000 s (Step 4952)
30552.9s 22102 [A
30552.9s 22103 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.27s/s]
30552.9s 22104 
30552.9s 22105 Simulation finished at t = 1050.0000 s after 4952 steps.
30552.9s 22106 Total runtime: 0.62 seconds.
30552.9s 22107 [REWARD_MICROSCOPE] step=14750 t=1050.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30552.9s 22108 [STEP   70] t= 1050.0s | phase=0 | reward=   0.01 | total_reward=    0.70
30552.9s 22109 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30552.9s 22110 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30552.9s 22111 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30552.9s 22112 Running simulation until t = 1065.00 s, outputting every 15.00 s
30552.9s 22113 
30553.3s 22114 [PROGRESS] Step 5000: t=1060.20/1065.00s (99.5%) | dt=0.2126s
30553.5s 22115 Stored output at t = 1065.0000 s (Step 5023)
30553.5s 22116 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1050.0/1065.0 [00:00<?, ?s/s][A
30553.5s 22117 [A
30553.5s 22118 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.10s/s]
30553.5s 22119 
30553.5s 22120 Simulation finished at t = 1065.0000 s after 5023 steps.
30553.5s 22121 Total runtime: 0.62 seconds.
30553.5s 22122 [QUEUE_DIAGNOSTIC] ===== Step 70 t=1065.0s =====
30553.5s 22123 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30553.5s 22124 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30553.5s 22125 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30553.5s 22126 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30553.5s 22127 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30553.5s 22128 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30553.5s 22129 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30553.5s 22130 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30553.5s 22131 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30553.5s 22132 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30553.5s 22133 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30553.5s 22134 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30553.5s 22135 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30553.5s 22136 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30553.5s 22137 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30553.5s 22138 [REWARD_MICROSCOPE] step=14751 t=1065.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30553.5s 22139 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30553.5s 22140 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30553.5s 22141 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30553.5s 22142 Running simulation until t = 1080.00 s, outputting every 15.00 s
30553.5s 22143 
30553.7s 22144 [WARNING] Automatic CFL correction applied (count: 3363100):
30553.7s 22145 Calculated CFL: 0.800 > Limit: 0.500
30553.7s 22146 Original dt: 3.408331e-01 s
30553.7s 22147 Corrected dt: 2.130207e-01 s
30553.7s 22148 Correction factor: 1.6x
30553.7s 22149 Max wave speed detected: 23.47 m/s
30553.8s 22150 [PROGRESS] Step 5050: t=1070.75/1080.00s (99.1%) | dt=0.2131s
30554.1s 22151 [PERIODIC:1000] BC_DISPATCHER [Call #13453000] current_bc_params: <class 'dict'>
30554.1s 22152 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30554.1s 22153 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30554.1s 22154 [PERIODIC:1000] BC_GPU [Call #13453000] About to launch kernel
30554.1s 22155 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30554.1s 22156 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30554.1s 22157 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30554.2s 22158 Stored output at t = 1080.0000 s (Step 5094)
30554.2s 22159 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1065.0/1080.0 [00:00<?, ?s/s][A
30554.2s 22160 [A
30554.2s 22161 
30554.2s 22162 Simulation finished at t = 1080.0000 s after 5094 steps.
30554.2s 22163 Total runtime: 0.62 seconds.
30554.2s 22164 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.05s/s]
30554.2s 22165 [REWARD_MICROSCOPE] step=14752 t=1080.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30554.2s 22166 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30554.2s 22167 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30554.2s 22168 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30554.2s 22169 Running simulation until t = 1095.00 s, outputting every 15.00 s
30554.2s 22170 
30554.2s 22171 [PROGRESS] Step 5100: t=1081.27/1095.00s (98.7%) | dt=0.2124s
30554.6s 22172 [WARNING] Automatic CFL correction applied (count: 3363200):
30554.6s 22173 Calculated CFL: 0.800 > Limit: 0.500
30554.6s 22174 Original dt: 3.402592e-01 s
30554.6s 22175 Corrected dt: 2.126620e-01 s
30554.6s 22176 Correction factor: 1.6x
30554.6s 22177 Max wave speed detected: 23.51 m/s
30554.6s 22178 [PROGRESS] Step 5150: t=1091.90/1095.00s (99.7%) | dt=0.2127s
30554.8s 22179 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1080.0/1095.0 [00:00<?, ?s/s][A
30554.8s 22180 [A
30554.8s 22181 Stored output at t = 1095.0000 s (Step 5165)
30554.8s 22182 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.19s/s]
30554.8s 22183 
30554.8s 22184 Simulation finished at t = 1095.0000 s after 5165 steps.
30554.8s 22185 Total runtime: 0.62 seconds.
30554.8s 22186 [REWARD_MICROSCOPE] step=14753 t=1095.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30554.8s 22187 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30554.8s 22188 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30554.8s 22189 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30554.8s 22190 Running simulation until t = 1110.00 s, outputting every 15.00 s
30554.8s 22191 
30555.1s 22192 [PROGRESS] Step 5200: t=1102.45/1110.00s (99.3%) | dt=0.2131s
30555.4s 22193 Stored output at t = 1110.0000 s (Step 5236)
30555.4s 22194 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1095.0/1110.0 [00:00<?, ?s/s][A
30555.4s 22195 [A
30555.4s 22196 
30555.4s 22197 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 23.84s/s]
30555.4s 22198 Simulation finished at t = 1110.0000 s after 5236 steps.
30555.4s 22199 Total runtime: 0.63 seconds.
30555.4s 22200 [REWARD_MICROSCOPE] step=14754 t=1110.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30555.4s 22201 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30555.4s 22202 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30555.4s 22203 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30555.4s 22204 Running simulation until t = 1125.00 s, outputting every 15.00 s
30555.4s 22205 
30555.5s 22206 [WARNING] Automatic CFL correction applied (count: 3363300):
30555.5s 22207 Calculated CFL: 0.800 > Limit: 0.500
30555.5s 22208 Original dt: 3.397413e-01 s
30555.5s 22209 Corrected dt: 2.123383e-01 s
30555.5s 22210 Correction factor: 1.6x
30555.5s 22211 Max wave speed detected: 23.55 m/s
30555.5s 22212 [PROGRESS] Step 5250: t=1112.97/1125.00s (98.9%) | dt=0.2123s
30556.0s 22213 [PROGRESS] Step 5300: t=1123.60/1125.00s (99.9%) | dt=0.2128s
30556.1s 22214 Stored output at t = 1125.0000 s (Step 5307)
30556.1s 22215 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1110.0/1125.0 [00:00<?, ?s/s][A
30556.1s 22216 [A
30556.1s 22217 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 22.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 22.73s/s]
30556.1s 22218 
30556.1s 22219 Simulation finished at t = 1125.0000 s after 5307 steps.
30556.1s 22220 Total runtime: 0.66 seconds.
30556.1s 22221 [REWARD_MICROSCOPE] step=14755 t=1125.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30556.1s 22222 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30556.1s 22223 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30556.1s 22224 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30556.1s 22225 Running simulation until t = 1140.00 s, outputting every 15.00 s
30556.1s 22226 
30556.4s 22227 [PERIODIC:1000] BC_DISPATCHER [Call #13454000] current_bc_params: <class 'dict'>
30556.4s 22228 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30556.4s 22229 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30556.4s 22230 [PERIODIC:1000] BC_GPU [Call #13454000] About to launch kernel
30556.4s 22231 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30556.4s 22232 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30556.4s 22233 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30556.4s 22234 [WARNING] Automatic CFL correction applied (count: 3363400):
30556.4s 22235 Calculated CFL: 0.800 > Limit: 0.500
30556.4s 22236 Original dt: 3.410527e-01 s
30556.4s 22237 Corrected dt: 2.131579e-01 s
30556.4s 22238 Correction factor: 1.6x
30556.4s 22239 Max wave speed detected: 23.46 m/s
30556.5s 22240 [PROGRESS] Step 5350: t=1134.16/1140.00s (99.5%) | dt=0.2132s
30556.7s 22241 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1125.0/1140.0 [00:00<?, ?s/s][A
30556.7s 22242 [A
30556.7s 22243 Stored output at t = 1140.0000 s (Step 5378)
30556.7s 22244 
30556.7s 22245 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.47s/s]
30556.7s 22246 Simulation finished at t = 1140.0000 s after 5378 steps.
30556.7s 22247 Total runtime: 0.61 seconds.
30556.7s 22248 [REWARD_MICROSCOPE] step=14756 t=1140.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30556.7s 22249 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30556.7s 22250 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30556.7s 22251 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30556.7s 22252 Running simulation until t = 1155.00 s, outputting every 15.00 s
30556.7s 22253 
30556.9s 22254 [PROGRESS] Step 5400: t=1144.67/1155.00s (99.1%) | dt=0.2124s
30557.3s 22255 [WARNING] Automatic CFL correction applied (count: 3363500):
30557.3s 22256 Calculated CFL: 0.800 > Limit: 0.500
30557.3s 22257 Original dt: 3.404818e-01 s
30557.3s 22258 Corrected dt: 2.128011e-01 s
30557.3s 22259 Correction factor: 1.6x
30557.3s 22260 Max wave speed detected: 23.50 m/s
30557.3s 22261 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1140.0/1155.0 [00:00<?, ?s/s][A
30557.3s 22262 [A
30557.3s 22263 Stored output at t = 1155.0000 s (Step 5449)
30557.3s 22264 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.33s/s]
30557.3s 22265 
30557.3s 22266 Simulation finished at t = 1155.0000 s after 5449 steps.
30557.3s 22267 Total runtime: 0.62 seconds.
30557.3s 22268 [REWARD_MICROSCOPE] step=14757 t=1155.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30557.3s 22269 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30557.3s 22270 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30557.3s 22271 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30557.3s 22272 Running simulation until t = 1170.00 s, outputting every 15.00 s
30557.3s 22273 
30557.3s 22274 [PROGRESS] Step 5450: t=1155.21/1170.00s (98.7%) | dt=0.2128s
30557.8s 22275 [PROGRESS] Step 5500: t=1165.87/1170.00s (99.6%) | dt=0.2133s
30557.9s 22276 Stored output at t = 1170.0000 s (Step 5520)
30557.9s 22277 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1155.0/1170.0 [00:00<?, ?s/s][A
30557.9s 22278 [A
30557.9s 22279 
30557.9s 22280 Simulation finished at t = 1170.0000 s after 5520 steps.
30557.9s 22281 Total runtime: 0.63 seconds.
30557.9s 22282 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 23.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 23.86s/s]
30557.9s 22283 [REWARD_MICROSCOPE] step=14758 t=1170.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30557.9s 22284 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30557.9s 22285 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30557.9s 22286 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30557.9s 22287 Running simulation until t = 1185.00 s, outputting every 15.00 s
30557.9s 22288 
30558.2s 22289 [WARNING] Automatic CFL correction applied (count: 3363600):
30558.2s 22290 Calculated CFL: 0.800 > Limit: 0.500
30558.2s 22291 Original dt: 3.398890e-01 s
30558.2s 22292 Corrected dt: 2.124306e-01 s
30558.2s 22293 Correction factor: 1.6x
30558.2s 22294 Max wave speed detected: 23.54 m/s
30558.2s 22295 [PROGRESS] Step 5550: t=1176.37/1185.00s (99.3%) | dt=0.2125s
30558.5s 22296 [PERIODIC:1000] BC_DISPATCHER [Call #13455000] current_bc_params: <class 'dict'>
30558.5s 22297 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30558.5s 22298 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30558.5s 22299 [PERIODIC:1000] BC_GPU [Call #13455000] About to launch kernel
30558.5s 22300 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30558.5s 22301 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30558.5s 22302 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30558.6s 22303 Stored output at t = 1185.0000 s (Step 5591)
30558.6s 22304 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1170.0/1185.0 [00:00<?, ?s/s][A
30558.6s 22305 [A
30558.6s 22306 
30558.6s 22307 Simulation finished at t = 1185.0000 s after 5591 steps.
30558.6s 22308 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 24.23s/s]
30558.6s 22309 Total runtime: 0.62 seconds.
30558.6s 22310 [REWARD_MICROSCOPE] step=14759 t=1185.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30558.6s 22311 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30558.6s 22312 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30558.6s 22313 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30558.6s 22314 Running simulation until t = 1200.00 s, outputting every 15.00 s
30558.6s 22315 
30558.6s 22316 [PROGRESS] Step 5600: t=1186.92/1200.00s (98.9%) | dt=0.2129s
30559.0s 22317 [WARNING] Automatic CFL correction applied (count: 3363700):
30559.0s 22318 Calculated CFL: 0.800 > Limit: 0.500
30559.0s 22319 Original dt: 3.412697e-01 s
30559.0s 22320 Corrected dt: 2.132935e-01 s
30559.0s 22321 Correction factor: 1.6x
30559.0s 22322 Max wave speed detected: 23.44 m/s
30559.1s 22323 [PROGRESS] Step 5650: t=1197.57/1200.00s (99.8%) | dt=0.2130s
30559.2s 22324 Stored output at t = 1200.0000 s (Step 5662)
30559.2s 22325 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1185.0/1200.0 [00:00<?, ?s/s][A
30559.2s 22326 [A
30559.2s 22327 
30559.2s 22328 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 24.25s/s]
30559.2s 22329 Simulation finished at t = 1200.0000 s after 5662 steps.
30559.2s 22330 Total runtime: 0.62 seconds.
30559.2s 22331 [REWARD_MICROSCOPE] step=14760 t=1200.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30559.2s 22332 [STEP   80] t= 1200.0s | phase=0 | reward=   0.01 | total_reward=    0.80
30559.2s 22333 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30559.2s 22334 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30559.2s 22335 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30559.2s 22336 Running simulation until t = 1215.00 s, outputting every 15.00 s
30559.2s 22337 
30559.5s 22338 [PROGRESS] Step 5700: t=1208.07/1215.00s (99.4%) | dt=0.2125s
30559.8s 22339 Stored output at t = 1215.0000 s (Step 5733)
30559.8s 22340 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1200.0/1215.0 [00:00<?, ?s/s][A
30559.8s 22341 [A
30559.8s 22342 
30559.8s 22343 Simulation finished at t = 1215.0000 s after 5733 steps.
30559.8s 22344 Total runtime: 0.62 seconds.
30559.8s 22345 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.36s/s]
30559.8s 22346 [QUEUE_DIAGNOSTIC] ===== Step 80 t=1215.0s =====
30559.8s 22347 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30559.8s 22348 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30559.8s 22349 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30559.8s 22350 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30559.8s 22351 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30559.8s 22352 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30559.8s 22353 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30559.8s 22354 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30559.8s 22355 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30559.8s 22356 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30559.8s 22357 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30559.8s 22358 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30559.8s 22359 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30559.8s 22360 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30559.8s 22361 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30559.8s 22362 [REWARD_MICROSCOPE] step=14761 t=1215.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30559.8s 22363 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30559.8s 22364 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30559.8s 22365 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30559.8s 22366 Running simulation until t = 1230.00 s, outputting every 15.00 s
30559.8s 22367 
30559.9s 22368 [WARNING] Automatic CFL correction applied (count: 3363800):
30559.9s 22369 Calculated CFL: 0.800 > Limit: 0.500
30559.9s 22370 Original dt: 3.406934e-01 s
30559.9s 22371 Corrected dt: 2.129334e-01 s
30559.9s 22372 Correction factor: 1.6x
30559.9s 22373 Max wave speed detected: 23.48 m/s
30560.0s 22374 [PROGRESS] Step 5750: t=1218.62/1230.00s (99.1%) | dt=0.2130s
30560.4s 22375 [PROGRESS] Step 5800: t=1229.27/1230.00s (99.9%) | dt=0.2127s
30560.4s 22376 Stored output at t = 1230.0000 s (Step 5804)
30560.4s 22377 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1215.0/1230.0 [00:00<?, ?s/s][A
30560.4s 22378 [A
30560.4s 22379 
30560.4s 22380 Simulation finished at t = 1230.0000 s after 5804 steps.
30560.4s 22381 Total runtime: 0.62 seconds.
30560.4s 22382 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 24.08s/s]
30560.4s 22383 [REWARD_MICROSCOPE] step=14762 t=1230.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30560.4s 22384 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30560.4s 22385 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30560.4s 22386 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30560.4s 22387 Running simulation until t = 1245.00 s, outputting every 15.00 s
30560.4s 22388 
30560.7s 22389 [PERIODIC:1000] BC_DISPATCHER [Call #13456000] current_bc_params: <class 'dict'>
30560.7s 22390 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30560.7s 22391 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30560.7s 22392 [PERIODIC:1000] BC_GPU [Call #13456000] About to launch kernel
30560.7s 22393 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30560.7s 22394 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30560.7s 22395 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30560.8s 22396 [WARNING] Automatic CFL correction applied (count: 3363900):
30560.8s 22397 Calculated CFL: 0.800 > Limit: 0.500
30560.8s 22398 Original dt: 3.401199e-01 s
30560.8s 22399 Corrected dt: 2.125749e-01 s
30560.8s 22400 Correction factor: 1.6x
30560.8s 22401 Max wave speed detected: 23.52 m/s
30560.9s 22402 [PROGRESS] Step 5850: t=1239.77/1245.00s (99.6%) | dt=0.2126s
30561.1s 22403 Stored output at t = 1245.0000 s (Step 5875)
30561.1s 22404 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1230.0/1245.0 [00:00<?, ?s/s][A
30561.1s 22405 [A
30561.1s 22406 
30561.1s 22407 Simulation finished at t = 1245.0000 s after 5875 steps.
30561.1s 22408 Total runtime: 0.66 seconds.
30561.1s 22409 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 22.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 22.76s/s]
30561.1s 22410 [REWARD_MICROSCOPE] step=14763 t=1245.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30561.1s 22411 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30561.1s 22412 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30561.1s 22413 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30561.1s 22414 Running simulation until t = 1260.00 s, outputting every 15.00 s
30561.1s 22415 
30561.3s 22416 [PROGRESS] Step 5900: t=1250.32/1260.00s (99.2%) | dt=0.2130s
30561.7s 22417 [WARNING] Automatic CFL correction applied (count: 3364000):
30561.7s 22418 Calculated CFL: 0.800 > Limit: 0.500
30561.7s 22419 Original dt: 3.401129e-01 s
30561.7s 22420 Corrected dt: 2.125705e-01 s
30561.7s 22421 Correction factor: 1.6x
30561.7s 22422 Max wave speed detected: 23.52 m/s
30561.7s 22423 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1245.0/1260.0 [00:00<?, ?s/s][A
30561.7s 22424 [A
30561.7s 22425 Stored output at t = 1260.0000 s (Step 5946)
30561.7s 22426 
30561.7s 22427 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 23.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 23.74s/s]
30561.7s 22428 Simulation finished at t = 1260.0000 s after 5946 steps.
30561.7s 22429 Total runtime: 0.63 seconds.
30561.7s 22430 [REWARD_MICROSCOPE] step=14764 t=1260.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30561.7s 22431 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30561.7s 22432 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30561.7s 22433 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30561.7s 22434 Running simulation until t = 1275.00 s, outputting every 15.00 s
30561.7s 22435 
30561.8s 22436 [PROGRESS] Step 5950: t=1260.85/1275.00s (98.9%) | dt=0.2124s
30562.2s 22437 [PROGRESS] Step 6000: t=1271.47/1275.00s (99.7%) | dt=0.2127s
30562.4s 22438 Stored output at t = 1275.0000 s (Step 6017)
30562.4s 22439 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1260.0/1275.0 [00:00<?, ?s/s][A
30562.4s 22440 [A
30562.4s 22441 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 23.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 23.75s/s]
30562.4s 22442 
30562.4s 22443 Simulation finished at t = 1275.0000 s after 6017 steps.
30562.4s 22444 Total runtime: 0.63 seconds.
30562.4s 22445 [REWARD_MICROSCOPE] step=14765 t=1275.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30562.4s 22446 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30562.4s 22447 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30562.4s 22448 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30562.4s 22449 Running simulation until t = 1290.00 s, outputting every 15.00 s
30562.4s 22450 
30562.6s 22451 [WARNING] Automatic CFL correction applied (count: 3364100):
30562.6s 22452 Calculated CFL: 0.800 > Limit: 0.500
30562.6s 22453 Original dt: 3.409178e-01 s
30562.6s 22454 Corrected dt: 2.130736e-01 s
30562.6s 22455 Correction factor: 1.6x
30562.6s 22456 Max wave speed detected: 23.47 m/s
30562.7s 22457 [PROGRESS] Step 6050: t=1282.03/1290.00s (99.4%) | dt=0.2131s
30563.0s 22458 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1275.0/1290.0 [00:00<?, ?s/s][A
30563.0s 22459 [A
30563.0s 22460 Stored output at t = 1290.0000 s (Step 6088)
30563.0s 22461 
30563.0s 22462 Simulation finished at t = 1290.0000 s after 6088 steps.
30563.0s 22463 Total runtime: 0.64 seconds.
30563.0s 22464 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 23.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 23.58s/s]
30563.0s 22465 [REWARD_MICROSCOPE] step=14766 t=1290.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30563.0s 22466 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30563.0s 22467 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30563.0s 22468 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30563.0s 22469 Running simulation until t = 1305.00 s, outputting every 15.00 s
30563.0s 22470 
30563.0s 22471 [PERIODIC:1000] BC_DISPATCHER [Call #13457000] current_bc_params: <class 'dict'>
30563.0s 22472 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30563.0s 22473 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30563.0s 22474 [PERIODIC:1000] BC_GPU [Call #13457000] About to launch kernel
30563.0s 22475 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30563.0s 22476 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30563.0s 22477 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30563.1s 22478 [PROGRESS] Step 6100: t=1292.55/1305.00s (99.0%) | dt=0.2123s
30563.5s 22479 [WARNING] Automatic CFL correction applied (count: 3364200):
30563.5s 22480 Calculated CFL: 0.800 > Limit: 0.500
30563.5s 22481 Original dt: 3.403431e-01 s
30563.5s 22482 Corrected dt: 2.127144e-01 s
30563.5s 22483 Correction factor: 1.6x
30563.5s 22484 Max wave speed detected: 23.51 m/s
30563.5s 22485 [PROGRESS] Step 6150: t=1303.18/1305.00s (99.9%) | dt=0.2128s
30563.6s 22486 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1290.0/1305.0 [00:00<?, ?s/s][A
30563.6s 22487 [A
30563.6s 22488 Stored output at t = 1305.0000 s (Step 6159)
30563.6s 22489 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 24.56s/s]
30563.6s 22490 
30563.6s 22491 Simulation finished at t = 1305.0000 s after 6159 steps.
30563.6s 22492 Total runtime: 0.61 seconds.
30563.6s 22493 [REWARD_MICROSCOPE] step=14767 t=1305.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30563.6s 22494 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30563.6s 22495 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30563.6s 22496 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30563.6s 22497 Running simulation until t = 1320.00 s, outputting every 15.00 s
30563.6s 22498 
30564.0s 22499 [PROGRESS] Step 6200: t=1313.73/1320.00s (99.5%) | dt=0.2132s
30564.2s 22500 Stored output at t = 1320.0000 s (Step 6230)
30564.2s 22501 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1305.0/1320.0 [00:00<?, ?s/s][A
30564.2s 22502 [A
30564.2s 22503 
30564.2s 22504 Simulation finished at t = 1320.0000 s after 6230 steps.
30564.2s 22505 Total runtime: 0.62 seconds.
30564.2s 22506 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 24.04s/s]
30564.2s 22507 [REWARD_MICROSCOPE] step=14768 t=1320.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30564.2s 22508 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30564.2s 22509 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30564.2s 22510 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30564.2s 22511 Running simulation until t = 1335.00 s, outputting every 15.00 s
30564.2s 22512 
30564.4s 22513 [WARNING] Automatic CFL correction applied (count: 3364300):
30564.4s 22514 Calculated CFL: 0.800 > Limit: 0.500
30564.4s 22515 Original dt: 3.397401e-01 s
30564.4s 22516 Corrected dt: 2.123376e-01 s
30564.4s 22517 Correction factor: 1.6x
30564.4s 22518 Max wave speed detected: 23.55 m/s
30564.4s 22519 [PROGRESS] Step 6250: t=1324.25/1335.00s (99.2%) | dt=0.2124s
30564.9s 22520 [PROGRESS] Step 6300: t=1334.88/1335.00s (100.0%) | dt=0.2128s
30564.9s 22521 Stored output at t = 1335.0000 s (Step 6301)
30564.9s 22522 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1320.0/1335.0 [00:00<?, ?s/s][A
30564.9s 22523 [A
30564.9s 22524 
30564.9s 22525 Simulation finished at t = 1335.0000 s after 6301 steps.
30564.9s 22526 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 24.35s/s]
30564.9s 22527 Total runtime: 0.62 seconds.
30564.9s 22528 [REWARD_MICROSCOPE] step=14769 t=1335.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30564.9s 22529 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30564.9s 22530 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30564.9s 22531 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30564.9s 22532 Running simulation until t = 1350.00 s, outputting every 15.00 s
30564.9s 22533 
30565.2s 22534 [PERIODIC:1000] BC_DISPATCHER [Call #13458000] current_bc_params: <class 'dict'>
30565.2s 22535 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30565.2s 22536 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30565.2s 22537 [PERIODIC:1000] BC_GPU [Call #13458000] About to launch kernel
30565.2s 22538 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30565.2s 22539 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30565.2s 22540 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30565.2s 22541 [WARNING] Automatic CFL correction applied (count: 3364400):
30565.2s 22542 Calculated CFL: 0.800 > Limit: 0.500
30565.2s 22543 Original dt: 3.411334e-01 s
30565.2s 22544 Corrected dt: 2.132084e-01 s
30565.2s 22545 Correction factor: 1.6x
30565.2s 22546 Max wave speed detected: 23.45 m/s
30565.3s 22547 [PROGRESS] Step 6350: t=1345.44/1350.00s (99.7%) | dt=0.2133s
30565.5s 22548 Stored output at t = 1350.0000 s (Step 6372)
30565.5s 22549 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1335.0/1350.0 [00:00<?, ?s/s][A
30565.5s 22550 [A
30565.5s 22551 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 24.12s/s]
30565.5s 22552 
30565.5s 22553 Simulation finished at t = 1350.0000 s after 6372 steps.
30565.5s 22554 Total runtime: 0.62 seconds.
30565.5s 22555 [REWARD_MICROSCOPE] step=14770 t=1350.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30565.5s 22556 [STEP   90] t= 1350.0s | phase=0 | reward=   0.01 | total_reward=    0.90
30565.5s 22557 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30565.5s 22558 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30565.5s 22559 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30565.5s 22560 Running simulation until t = 1365.00 s, outputting every 15.00 s
30565.5s 22561 
30565.7s 22562 [PROGRESS] Step 6400: t=1355.95/1365.00s (99.3%) | dt=0.2125s
30566.1s 22563 Stored output at t = 1365.0000 s (Step 6443)
30566.1s 22564 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
30566.1s 22565 [A
30566.1s 22566 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 24.33s/s]
30566.1s 22567 
30566.1s 22568 Simulation finished at t = 1365.0000 s after 6443 steps.
30566.1s 22569 Total runtime: 0.62 seconds.
30566.1s 22570 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
30566.1s 22571 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30566.1s 22572 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30566.1s 22573 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30566.1s 22574 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30566.1s 22575 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30566.1s 22576 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30566.1s 22577 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30566.1s 22578 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30566.1s 22579 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30566.1s 22580 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30566.1s 22581 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30566.1s 22582 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30566.1s 22583 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30566.1s 22584 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30566.1s 22585 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30566.1s 22586 [REWARD_MICROSCOPE] step=14771 t=1365.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30566.1s 22587 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30566.1s 22588 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30566.1s 22589 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30566.1s 22590 Running simulation until t = 1380.00 s, outputting every 15.00 s
30566.1s 22591 
30566.1s 22592 [WARNING] Automatic CFL correction applied (count: 3364500):
30566.1s 22593 Calculated CFL: 0.800 > Limit: 0.500
30566.1s 22594 Original dt: 3.405553e-01 s
30566.1s 22595 Corrected dt: 2.128470e-01 s
30566.1s 22596 Correction factor: 1.6x
30566.1s 22597 Max wave speed detected: 23.49 m/s
30566.2s 22598 [PROGRESS] Step 6450: t=1366.49/1380.00s (99.0%) | dt=0.2129s
30566.6s 22599 [PROGRESS] Step 6500: t=1377.15/1380.00s (99.8%) | dt=0.2131s
30566.7s 22600 Stored output at t = 1380.0000 s (Step 6514)
30566.7s 22601 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
30566.7s 22602 [A
30566.7s 22603 
30566.7s 22604 Simulation finished at t = 1380.0000 s after 6514 steps.
30566.7s 22605 Total runtime: 0.61 seconds.
30566.7s 22606 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.57s/s]
30566.7s 22607 [REWARD_MICROSCOPE] step=14772 t=1380.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30566.7s 22608 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30566.7s 22609 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30566.7s 22610 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30566.7s 22611 Running simulation until t = 1395.00 s, outputting every 15.00 s
30566.7s 22612 
30567.0s 22613 [WARNING] Automatic CFL correction applied (count: 3364600):
30567.0s 22614 Calculated CFL: 0.800 > Limit: 0.500
30567.0s 22615 Original dt: 3.399790e-01 s
30567.0s 22616 Corrected dt: 2.124869e-01 s
30567.0s 22617 Correction factor: 1.6x
30567.0s 22618 Max wave speed detected: 23.53 m/s
30567.0s 22619 [PROGRESS] Step 6550: t=1387.65/1395.00s (99.5%) | dt=0.2125s
30567.4s 22620 Stored output at t = 1395.0000 s (Step 6585)
30567.4s 22621 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
30567.4s 22622 [A
30567.4s 22623 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 23.83s/s]
30567.4s 22624 
30567.4s 22625 Simulation finished at t = 1395.0000 s after 6585 steps.
30567.4s 22626 Total runtime: 0.63 seconds.
30567.4s 22627 [REWARD_MICROSCOPE] step=14773 t=1395.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30567.4s 22628 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30567.4s 22629 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30567.4s 22630 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30567.4s 22631 Running simulation until t = 1410.00 s, outputting every 15.00 s
30567.4s 22632 
30567.4s 22633 [PERIODIC:1000] BC_DISPATCHER [Call #13459000] current_bc_params: <class 'dict'>
30567.4s 22634 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30567.4s 22635 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30567.4s 22636 [PERIODIC:1000] BC_GPU [Call #13459000] About to launch kernel
30567.4s 22637 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30567.4s 22638 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30567.4s 22639 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30567.5s 22640 [PROGRESS] Step 6600: t=1398.19/1410.00s (99.2%) | dt=0.2130s
30567.9s 22641 [WARNING] Automatic CFL correction applied (count: 3364700):
30567.9s 22642 Calculated CFL: 0.800 > Limit: 0.500
30567.9s 22643 Original dt: 3.407550e-01 s
30567.9s 22644 Corrected dt: 2.129719e-01 s
30567.9s 22645 Correction factor: 1.6x
30567.9s 22646 Max wave speed detected: 23.48 m/s
30567.9s 22647 [PROGRESS] Step 6650: t=1408.85/1410.00s (99.9%) | dt=0.2127s
30568.0s 22648 Stored output at t = 1410.0000 s (Step 6656)
30568.0s 22649 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
30568.0s 22650 [A
30568.0s 22651 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 24.53s/s]
30568.0s 22652 
30568.0s 22653 Simulation finished at t = 1410.0000 s after 6656 steps.
30568.0s 22654 Total runtime: 0.61 seconds.
30568.0s 22655 [REWARD_MICROSCOPE] step=14774 t=1410.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30568.0s 22656 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30568.0s 22657 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30568.0s 22658 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30568.0s 22659 Running simulation until t = 1425.00 s, outputting every 15.00 s
30568.0s 22660 
30568.3s 22661 [PROGRESS] Step 6700: t=1419.35/1425.00s (99.6%) | dt=0.2126s
30568.6s 22662 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
30568.6s 22663 [A
30568.6s 22664 Stored output at t = 1425.0000 s (Step 6727)
30568.6s 22665 
30568.6s 22666 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 24.51s/s]
30568.6s 22667 Simulation finished at t = 1425.0000 s after 6727 steps.
30568.6s 22668 Total runtime: 0.61 seconds.
30568.6s 22669 [REWARD_MICROSCOPE] step=14775 t=1425.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30568.6s 22670 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30568.6s 22671 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30568.6s 22672 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30568.6s 22673 Running simulation until t = 1440.00 s, outputting every 15.00 s
30568.6s 22674 
30568.7s 22675 [WARNING] Automatic CFL correction applied (count: 3364800):
30568.7s 22676 Calculated CFL: 0.800 > Limit: 0.500
30568.7s 22677 Original dt: 3.407770e-01 s
30568.7s 22678 Corrected dt: 2.129856e-01 s
30568.7s 22679 Correction factor: 1.6x
30568.7s 22680 Max wave speed detected: 23.48 m/s
30568.8s 22681 [PROGRESS] Step 6750: t=1429.90/1440.00s (99.3%) | dt=0.2130s
30569.2s 22682 Stored output at t = 1440.0000 s (Step 6798)
30569.2s 22683 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
30569.2s 22684 [A
30569.2s 22685 
30569.2s 22686 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 24.01s/s]
30569.2s 22687 Simulation finished at t = 1440.0000 s after 6798 steps.
30569.2s 22688 Total runtime: 0.63 seconds.
30569.2s 22689 [REWARD_MICROSCOPE] step=14776 t=1440.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30569.2s 22690 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30569.2s 22691 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30569.2s 22692 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30569.2s 22693 Running simulation until t = 1455.00 s, outputting every 15.00 s
30569.2s 22694 
30569.2s 22695 [PROGRESS] Step 6800: t=1440.43/1455.00s (99.0%) | dt=0.2125s
30569.6s 22696 [PERIODIC:1000] BC_DISPATCHER [Call #13460000] current_bc_params: <class 'dict'>
30569.6s 22697 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30569.6s 22698 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30569.6s 22699 [PERIODIC:1000] BC_GPU [Call #13460000] About to launch kernel
30569.6s 22700 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30569.6s 22701 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30569.6s 22702 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30569.6s 22703 [WARNING] Automatic CFL correction applied (count: 3364900):
30569.6s 22704 Calculated CFL: 0.800 > Limit: 0.500
30569.6s 22705 Original dt: 3.402034e-01 s
30569.6s 22706 Corrected dt: 2.126271e-01 s
30569.6s 22707 Correction factor: 1.6x
30569.6s 22708 Max wave speed detected: 23.52 m/s
30569.7s 22709 [PROGRESS] Step 6850: t=1451.05/1455.00s (99.7%) | dt=0.2127s
30569.8s 22710 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
30569.8s 22711 [A
30569.8s 22712 Stored output at t = 1455.0000 s (Step 6869)
30569.8s 22713 
30569.8s 22714 Simulation finished at t = 1455.0000 s after 6869 steps.
30569.8s 22715 Total runtime: 0.63 seconds.
30569.8s 22716 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 23.83s/s]
30569.8s 22717 [REWARD_MICROSCOPE] step=14777 t=1455.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30569.8s 22718 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30569.8s 22719 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30569.8s 22720 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30569.8s 22721 Running simulation until t = 1470.00 s, outputting every 15.00 s
30569.8s 22722 
30570.1s 22723 [PROGRESS] Step 6900: t=1461.60/1470.00s (99.4%) | dt=0.2131s
30570.5s 22724 Stored output at t = 1470.0000 s (Step 6940)
30570.5s 22725 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
30570.5s 22726 [A
30570.5s 22727 
30570.5s 22728 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.47s/s]
30570.5s 22729 Simulation finished at t = 1470.0000 s after 6940 steps.
30570.5s 22730 Total runtime: 0.61 seconds.
30570.5s 22731 [REWARD_MICROSCOPE] step=14778 t=1470.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30570.5s 22732 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30570.5s 22733 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30570.5s 22734 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30570.5s 22735 Running simulation until t = 1485.00 s, outputting every 15.00 s
30570.5s 22736 
30570.5s 22737 [WARNING] Automatic CFL correction applied (count: 3365000):
30570.5s 22738 Calculated CFL: 0.800 > Limit: 0.500
30570.5s 22739 Original dt: 3.398708e-01 s
30570.5s 22740 Corrected dt: 2.124193e-01 s
30570.5s 22741 Correction factor: 1.6x
30570.5s 22742 Max wave speed detected: 23.54 m/s
30570.5s 22743 [PROGRESS] Step 6950: t=1472.12/1485.00s (99.1%) | dt=0.2123s
30571.0s 22744 [PROGRESS] Step 7000: t=1482.75/1485.00s (99.8%) | dt=0.2127s
30571.1s 22745 Stored output at t = 1485.0000 s (Step 7011)
30571.1s 22746 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
30571.1s 22747 [A
30571.1s 22748 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 23.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 23.09s/s]
30571.1s 22749 
30571.1s 22750 Simulation finished at t = 1485.0000 s after 7011 steps.
30571.1s 22751 Total runtime: 0.65 seconds.
30571.1s 22752 [REWARD_MICROSCOPE] step=14779 t=1485.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30571.1s 22753 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30571.1s 22754 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30571.1s 22755 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30571.1s 22756 Running simulation until t = 1500.00 s, outputting every 15.00 s
30571.1s 22757 
30571.4s 22758 [WARNING] Automatic CFL correction applied (count: 3365100):
30571.4s 22759 Calculated CFL: 0.800 > Limit: 0.500
30571.4s 22760 Original dt: 3.409993e-01 s
30571.4s 22761 Corrected dt: 2.131246e-01 s
30571.4s 22762 Correction factor: 1.6x
30571.4s 22763 Max wave speed detected: 23.46 m/s
30571.4s 22764 [PROGRESS] Step 7050: t=1493.31/1500.00s (99.6%) | dt=0.2132s
30571.7s 22765 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
30571.7s 22766 [A
30571.7s 22767 Stored output at t = 1500.0000 s (Step 7082)
30571.7s 22768 
30571.7s 22769 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.80s/s]
30571.7s 22770 Simulation finished at t = 1500.0000 s after 7082 steps.
30571.7s 22771 Total runtime: 0.61 seconds.
30571.7s 22772 [REWARD_MICROSCOPE] step=14780 t=1500.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30571.7s 22773 [STEP  100] t= 1500.0s | phase=0 | reward=   0.01 | total_reward=    1.00
30571.7s 22774 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30571.7s 22775 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30571.7s 22776 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30571.7s 22777 Running simulation until t = 1515.00 s, outputting every 15.00 s
30571.7s 22778 
30571.8s 22779 [PERIODIC:1000] BC_DISPATCHER [Call #13461000] current_bc_params: <class 'dict'>
30571.8s 22780 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30571.8s 22781 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30571.8s 22782 [PERIODIC:1000] BC_GPU [Call #13461000] About to launch kernel
30571.8s 22783 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30571.8s 22784 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30571.8s 22785 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30571.9s 22786 [PROGRESS] Step 7100: t=1503.82/1515.00s (99.3%) | dt=0.2124s
30572.3s 22787 [WARNING] Automatic CFL correction applied (count: 3365200):
30572.3s 22788 Calculated CFL: 0.800 > Limit: 0.500
30572.3s 22789 Original dt: 3.404274e-01 s
30572.3s 22790 Corrected dt: 2.127671e-01 s
30572.3s 22791 Correction factor: 1.6x
30572.3s 22792 Max wave speed detected: 23.50 m/s
30572.3s 22793 [PROGRESS] Step 7150: t=1514.45/1515.00s (100.0%) | dt=0.2128s
30572.4s 22794 Stored output at t = 1515.0000 s (Step 7153)
30572.4s 22795 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
30572.4s 22796 [A
30572.4s 22797 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 23.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 23.77s/s]
30572.4s 22798 
30572.4s 22799 Simulation finished at t = 1515.0000 s after 7153 steps.
30572.4s 22800 Total runtime: 0.63 seconds.
30572.4s 22801 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
30572.4s 22802 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30572.4s 22803 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30572.4s 22804 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30572.4s 22805 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30572.4s 22806 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30572.4s 22807 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30572.4s 22808 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30572.4s 22809 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30572.4s 22810 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30572.4s 22811 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30572.4s 22812 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30572.4s 22813 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30572.4s 22814 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30572.4s 22815 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30572.4s 22816 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30572.4s 22817 [REWARD_MICROSCOPE] step=14781 t=1515.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30572.4s 22818 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30572.4s 22819 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30572.4s 22820 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30572.4s 22821 Running simulation until t = 1530.00 s, outputting every 15.00 s
30572.4s 22822 
30572.8s 22823 [PROGRESS] Step 7200: t=1525.01/1530.00s (99.7%) | dt=0.2132s
30573.0s 22824 Stored output at t = 1530.0000 s (Step 7224)
30573.0s 22825 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
30573.0s 22826 [A
30573.0s 22827 
30573.0s 22828 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.31s/s]
30573.0s 22829 Simulation finished at t = 1530.0000 s after 7224 steps.
30573.0s 22830 Total runtime: 0.62 seconds.
30573.0s 22831 [REWARD_MICROSCOPE] step=14782 t=1530.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30573.0s 22832 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30573.0s 22833 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30573.0s 22834 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30573.0s 22835 Running simulation until t = 1545.00 s, outputting every 15.00 s
30573.0s 22836 
30573.2s 22837 [WARNING] Automatic CFL correction applied (count: 3365300):
30573.2s 22838 Calculated CFL: 0.800 > Limit: 0.500
30573.2s 22839 Original dt: 3.398278e-01 s
30573.2s 22840 Corrected dt: 2.123924e-01 s
30573.2s 22841 Correction factor: 1.6x
30573.2s 22842 Max wave speed detected: 23.54 m/s
30573.2s 22843 [PROGRESS] Step 7250: t=1535.52/1545.00s (99.4%) | dt=0.2124s
30573.6s 22844 Stored output at t = 1545.0000 s (Step 7295)
30573.6s 22845 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
30573.6s 22846 [A
30573.6s 22847 
30573.6s 22848 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 23.69s/s]
30573.6s 22849 Simulation finished at t = 1545.0000 s after 7295 steps.
30573.6s 22850 Total runtime: 0.63 seconds.
30573.6s 22851 [REWARD_MICROSCOPE] step=14783 t=1545.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30573.6s 22852 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30573.6s 22853 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30573.6s 22854 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30573.6s 22855 Running simulation until t = 1560.00 s, outputting every 15.00 s
30573.6s 22856 
30573.7s 22857 [PROGRESS] Step 7300: t=1546.06/1560.00s (99.1%) | dt=0.2129s
30574.0s 22858 [PERIODIC:1000] BC_DISPATCHER [Call #13462000] current_bc_params: <class 'dict'>
30574.0s 22859 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30574.0s 22860 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30574.0s 22861 [PERIODIC:1000] BC_GPU [Call #13462000] About to launch kernel
30574.0s 22862 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30574.0s 22863 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30574.0s 22864 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30574.0s 22865 [WARNING] Automatic CFL correction applied (count: 3365400):
30574.0s 22866 Calculated CFL: 0.800 > Limit: 0.500
30574.0s 22867 Original dt: 3.412149e-01 s
30574.0s 22868 Corrected dt: 2.132593e-01 s
30574.0s 22869 Correction factor: 1.6x
30574.0s 22870 Max wave speed detected: 23.45 m/s
30574.1s 22871 [PROGRESS] Step 7350: t=1556.72/1560.00s (99.8%) | dt=0.2133s
30574.2s 22872 Stored output at t = 1560.0000 s (Step 7366)
30574.2s 22873 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
30574.2s 22874 [A
30574.2s 22875 
30574.2s 22876 Simulation finished at t = 1560.0000 s after 7366 steps.
30574.2s 22877 Total runtime: 0.63 seconds.
30574.2s 22878 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 24.00s/s]
30574.2s 22879 [REWARD_MICROSCOPE] step=14784 t=1560.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30574.2s 22880 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30574.2s 22881 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30574.2s 22882 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30574.2s 22883 Running simulation until t = 1575.00 s, outputting every 15.00 s
30574.2s 22884 
30574.5s 22885 [PROGRESS] Step 7400: t=1567.22/1575.00s (99.5%) | dt=0.2125s
30574.9s 22886 Stored output at t = 1575.0000 s (Step 7437)
30574.9s 22887 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
30574.9s 22888 [A
30574.9s 22889 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.94s/s]
30574.9s 22890 
30574.9s 22891 Simulation finished at t = 1575.0000 s after 7437 steps.
30574.9s 22892 Total runtime: 0.63 seconds.
30574.9s 22893 [REWARD_MICROSCOPE] step=14785 t=1575.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30574.9s 22894 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30574.9s 22895 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30574.9s 22896 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30574.9s 22897 Running simulation until t = 1590.00 s, outputting every 15.00 s
30574.9s 22898 
30574.9s 22899 [WARNING] Automatic CFL correction applied (count: 3365500):
30574.9s 22900 Calculated CFL: 0.800 > Limit: 0.500
30574.9s 22901 Original dt: 3.406380e-01 s
30574.9s 22902 Corrected dt: 2.128988e-01 s
30574.9s 22903 Correction factor: 1.6x
30574.9s 22904 Max wave speed detected: 23.49 m/s
30575.0s 22905 [PROGRESS] Step 7450: t=1577.77/1590.00s (99.2%) | dt=0.2129s
30575.5s 22906 [PROGRESS] Step 7500: t=1588.42/1590.00s (99.9%) | dt=0.2128s
30575.5s 22907 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
30575.5s 22908 Stored output at t = 1590.0000 s (Step 7508)
30575.5s 22909 [A
30575.5s 22910 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 22.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 22.50s/s]
30575.5s 22911 
30575.5s 22912 Simulation finished at t = 1590.0000 s after 7508 steps.
30575.5s 22913 Total runtime: 0.67 seconds.
30575.5s 22914 [REWARD_MICROSCOPE] step=14786 t=1590.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30575.5s 22915 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30575.5s 22916 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30575.5s 22917 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30575.5s 22918 Running simulation until t = 1605.00 s, outputting every 15.00 s
30575.5s 22919 
30575.9s 22920 [WARNING] Automatic CFL correction applied (count: 3365600):
30575.9s 22921 Calculated CFL: 0.800 > Limit: 0.500
30575.9s 22922 Original dt: 3.400643e-01 s
30575.9s 22923 Corrected dt: 2.125402e-01 s
30575.9s 22924 Correction factor: 1.6x
30575.9s 22925 Max wave speed detected: 23.52 m/s
30575.9s 22926 [PROGRESS] Step 7550: t=1598.92/1605.00s (99.6%) | dt=0.2126s
30576.2s 22927 Stored output at t = 1605.0000 s (Step 7579)
30576.2s 22928 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
30576.2s 22929 [A
30576.2s 22930 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.13s/s]
30576.2s 22931 
30576.2s 22932 Simulation finished at t = 1605.0000 s after 7579 steps.
30576.2s 22933 Total runtime: 0.62 seconds.
30576.2s 22934 [REWARD_MICROSCOPE] step=14787 t=1605.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30576.2s 22935 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30576.2s 22936 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30576.2s 22937 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30576.2s 22938 Running simulation until t = 1620.00 s, outputting every 15.00 s
30576.2s 22939 
30576.2s 22940 [PERIODIC:1000] BC_DISPATCHER [Call #13463000] current_bc_params: <class 'dict'>
30576.2s 22941 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30576.2s 22942 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30576.2s 22943 [PERIODIC:1000] BC_GPU [Call #13463000] About to launch kernel
30576.2s 22944 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30576.2s 22945 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30576.2s 22946 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30576.3s 22947 [PROGRESS] Step 7600: t=1609.47/1620.00s (99.4%) | dt=0.2130s
30576.7s 22948 [WARNING] Automatic CFL correction applied (count: 3365700):
30576.7s 22949 Calculated CFL: 0.800 > Limit: 0.500
30576.7s 22950 Original dt: 3.403351e-01 s
30576.7s 22951 Corrected dt: 2.127094e-01 s
30576.7s 22952 Correction factor: 1.6x
30576.7s 22953 Max wave speed detected: 23.51 m/s
30576.8s 22954 [PROGRESS] Step 7650: t=1620.00/1620.00s (100.0%) | dt=0.0883s
30576.8s 22955 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
30576.8s 22956 [A
30576.8s 22957 Stored output at t = 1620.0000 s (Step 7650)
30576.8s 22958 
30576.8s 22959 Simulation finished at t = 1620.0000 s after 7650 steps.
30576.8s 22960 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 24.50s/s]
30576.8s 22961 Total runtime: 0.61 seconds.
30576.8s 22962 [REWARD_MICROSCOPE] step=14788 t=1620.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30576.8s 22963 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30576.8s 22964 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30576.8s 22965 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30576.8s 22966 Running simulation until t = 1635.00 s, outputting every 15.00 s
30576.8s 22967 
30577.2s 22968 [PROGRESS] Step 7700: t=1630.62/1635.00s (99.7%) | dt=0.2127s
30577.4s 22969 Stored output at t = 1635.0000 s (Step 7721)
30577.4s 22970 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
30577.4s 22971 [A
30577.4s 22972 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 23.84s/s]
30577.4s 22973 
30577.4s 22974 Simulation finished at t = 1635.0000 s after 7721 steps.
30577.4s 22975 Total runtime: 0.63 seconds.
30577.4s 22976 [REWARD_MICROSCOPE] step=14789 t=1635.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30577.4s 22977 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30577.4s 22978 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30577.4s 22979 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30577.4s 22980 Running simulation until t = 1650.00 s, outputting every 15.00 s
30577.4s 22981 
30577.6s 22982 [WARNING] Automatic CFL correction applied (count: 3365800):
30577.6s 22983 Calculated CFL: 0.800 > Limit: 0.500
30577.6s 22984 Original dt: 3.408612e-01 s
30577.6s 22985 Corrected dt: 2.130383e-01 s
30577.6s 22986 Correction factor: 1.6x
30577.6s 22987 Max wave speed detected: 23.47 m/s
30577.7s 22988 [PROGRESS] Step 7750: t=1641.18/1650.00s (99.5%) | dt=0.2131s
30578.0s 22989 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
30578.0s 22990 [A
30578.0s 22991 Stored output at t = 1650.0000 s (Step 7792)
30578.0s 22992 
30578.0s 22993 Simulation finished at t = 1650.0000 s after 7792 steps.
30578.0s 22994 Total runtime: 0.62 seconds.
30578.0s 22995 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.28s/s]
30578.0s 22996 [REWARD_MICROSCOPE] step=14790 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30578.0s 22997 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    1.10
30578.0s 22998 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30578.0s 22999 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30578.0s 23000 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30578.0s 23001 Running simulation until t = 1665.00 s, outputting every 15.00 s
30578.0s 23002 
30578.1s 23003 [PROGRESS] Step 7800: t=1651.70/1665.00s (99.2%) | dt=0.2124s
30578.4s 23004 [PERIODIC:1000] BC_DISPATCHER [Call #13464000] current_bc_params: <class 'dict'>
30578.4s 23005 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30578.4s 23006 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30578.4s 23007 [PERIODIC:1000] BC_GPU [Call #13464000] About to launch kernel
30578.4s 23008 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30578.4s 23009 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30578.4s 23010 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30578.5s 23011 [WARNING] Automatic CFL correction applied (count: 3365900):
30578.5s 23012 Calculated CFL: 0.800 > Limit: 0.500
30578.5s 23013 Original dt: 3.402871e-01 s
30578.5s 23014 Corrected dt: 2.126795e-01 s
30578.5s 23015 Correction factor: 1.6x
30578.5s 23016 Max wave speed detected: 23.51 m/s
30578.5s 23017 [PROGRESS] Step 7850: t=1662.32/1665.00s (99.8%) | dt=0.2127s
30578.6s 23018 Stored output at t = 1665.0000 s (Step 7863)
30578.6s 23019 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
30578.6s 23020 [A
30578.6s 23021 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 24.47s/s]
30578.6s 23022 
30578.6s 23023 Simulation finished at t = 1665.0000 s after 7863 steps.
30578.6s 23024 Total runtime: 0.61 seconds.
30578.6s 23025 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
30578.6s 23026 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30578.6s 23027 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30578.6s 23028 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30578.6s 23029 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30578.6s 23030 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30578.6s 23031 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30578.6s 23032 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30578.6s 23033 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30578.6s 23034 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30578.6s 23035 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30578.6s 23036 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30578.6s 23037 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30578.6s 23038 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30578.6s 23039 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30578.6s 23040 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30578.6s 23041 [REWARD_MICROSCOPE] step=14791 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30578.6s 23042 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30578.6s 23043 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30578.6s 23044 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30578.6s 23045 Running simulation until t = 1680.00 s, outputting every 15.00 s
30578.6s 23046 
30579.0s 23047 [PROGRESS] Step 7900: t=1672.88/1680.00s (99.6%) | dt=0.2131s
30579.3s 23048 Stored output at t = 1680.0000 s (Step 7934)
30579.3s 23049 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
30579.3s 23050 [A
30579.3s 23051 
30579.3s 23052 Simulation finished at t = 1680.0000 s after 7934 steps.
30579.3s 23053 Total runtime: 0.62 seconds.
30579.3s 23054 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 24.03s/s]
30579.3s 23055 [REWARD_MICROSCOPE] step=14792 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30579.3s 23056 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30579.3s 23057 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30579.3s 23058 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30579.3s 23059 Running simulation until t = 1695.00 s, outputting every 15.00 s
30579.3s 23060 
30579.4s 23061 [WARNING] Automatic CFL correction applied (count: 3366000):
30579.4s 23062 Calculated CFL: 0.800 > Limit: 0.500
30579.4s 23063 Original dt: 3.397169e-01 s
30579.4s 23064 Corrected dt: 2.123230e-01 s
30579.4s 23065 Correction factor: 1.6x
30579.4s 23066 Max wave speed detected: 23.55 m/s
30579.4s 23067 [PROGRESS] Step 7950: t=1683.40/1695.00s (99.3%) | dt=0.2123s
30579.9s 23068 [PROGRESS] Step 8000: t=1694.03/1695.00s (99.9%) | dt=0.2128s
30579.9s 23069 Stored output at t = 1695.0000 s (Step 8005)
30579.9s 23070 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
30579.9s 23071 [A
30579.9s 23072 
30579.9s 23073 Simulation finished at t = 1695.0000 s after 8005 steps.
30579.9s 23074 Total runtime: 0.62 seconds.
30579.9s 23075 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.20s/s]
30579.9s 23076 [REWARD_MICROSCOPE] step=14793 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30579.9s 23077 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30579.9s 23078 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30579.9s 23079 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30579.9s 23080 Running simulation until t = 1710.00 s, outputting every 15.00 s
30579.9s 23081 
30580.2s 23082 [WARNING] Automatic CFL correction applied (count: 3366100):
30580.2s 23083 Calculated CFL: 0.800 > Limit: 0.500
30580.2s 23084 Original dt: 3.410795e-01 s
30580.2s 23085 Corrected dt: 2.131747e-01 s
30580.2s 23086 Correction factor: 1.6x
30580.2s 23087 Max wave speed detected: 23.45 m/s
30580.3s 23088 [PROGRESS] Step 8050: t=1704.59/1710.00s (99.7%) | dt=0.2132s
30580.5s 23089 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
30580.5s 23090 [A
30580.5s 23091 Stored output at t = 1710.0000 s (Step 8076)
30580.5s 23092 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.04s/s]
30580.5s 23093 
30580.5s 23094 Simulation finished at t = 1710.0000 s after 8076 steps.
30580.5s 23095 Total runtime: 0.62 seconds.
30580.5s 23096 [REWARD_MICROSCOPE] step=14794 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30580.5s 23097 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30580.5s 23098 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30580.5s 23099 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30580.5s 23100 Running simulation until t = 1725.00 s, outputting every 15.00 s
30580.5s 23101 
30580.6s 23102 [PERIODIC:1000] BC_DISPATCHER [Call #13465000] current_bc_params: <class 'dict'>
30580.6s 23103 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30580.6s 23104 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30580.6s 23105 [PERIODIC:1000] BC_GPU [Call #13465000] About to launch kernel
30580.6s 23106 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30580.6s 23107 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30580.6s 23108 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30580.7s 23109 [PROGRESS] Step 8100: t=1715.10/1725.00s (99.4%) | dt=0.2124s
30581.1s 23110 [WARNING] Automatic CFL correction applied (count: 3366200):
30581.1s 23111 Calculated CFL: 0.800 > Limit: 0.500
30581.1s 23112 Original dt: 3.405090e-01 s
30581.1s 23113 Corrected dt: 2.128181e-01 s
30581.1s 23114 Correction factor: 1.6x
30581.1s 23115 Max wave speed detected: 23.49 m/s
30581.2s 23116 Stored output at t = 1725.0000 s (Step 8147)
30581.2s 23117 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
30581.2s 23118 [A
30581.2s 23119 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 23.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 23.07s/s]
30581.2s 23120 
30581.2s 23121 Simulation finished at t = 1725.0000 s after 8147 steps.
30581.2s 23122 Total runtime: 0.65 seconds.
30581.2s 23123 [REWARD_MICROSCOPE] step=14795 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30581.2s 23124 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30581.2s 23125 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30581.2s 23126 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30581.2s 23127 Running simulation until t = 1740.00 s, outputting every 15.00 s
30581.2s 23128 
30581.2s 23129 [PROGRESS] Step 8150: t=1725.64/1740.00s (99.2%) | dt=0.2129s
30581.6s 23130 [PROGRESS] Step 8200: t=1736.29/1740.00s (99.8%) | dt=0.2133s
30581.8s 23131 Stored output at t = 1740.0000 s (Step 8218)
30581.8s 23132 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
30581.8s 23133 [A
30581.8s 23134 
30581.8s 23135 Simulation finished at t = 1740.0000 s after 8218 steps.
30581.8s 23136 Total runtime: 0.62 seconds.
30581.8s 23137 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.38s/s]
30581.8s 23138 [REWARD_MICROSCOPE] step=14796 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30581.8s 23139 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30581.8s 23140 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30581.8s 23141 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30581.8s 23142 Running simulation until t = 1755.00 s, outputting every 15.00 s
30581.8s 23143 
30582.0s 23144 [WARNING] Automatic CFL correction applied (count: 3366300):
30582.0s 23145 Calculated CFL: 0.800 > Limit: 0.500
30582.0s 23146 Original dt: 3.399193e-01 s
30582.0s 23147 Corrected dt: 2.124495e-01 s
30582.0s 23148 Correction factor: 1.6x
30582.0s 23149 Max wave speed detected: 23.53 m/s
30582.1s 23150 [PROGRESS] Step 8250: t=1746.80/1755.00s (99.5%) | dt=0.2125s
30582.4s 23151 Stored output at t = 1755.0000 s (Step 8289)
30582.4s 23152 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
30582.4s 23153 [A
30582.4s 23154 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 23.98s/s]
30582.4s 23155 
30582.4s 23156 Simulation finished at t = 1755.0000 s after 8289 steps.
30582.4s 23157 Total runtime: 0.63 seconds.
30582.4s 23158 [REWARD_MICROSCOPE] step=14797 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30582.4s 23159 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30582.4s 23160 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30582.4s 23161 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30582.4s 23162 Running simulation until t = 1770.00 s, outputting every 15.00 s
30582.4s 23163 
30582.5s 23164 [PROGRESS] Step 8300: t=1757.34/1770.00s (99.3%) | dt=0.2129s
30582.9s 23165 [PERIODIC:1000] BC_DISPATCHER [Call #13466000] current_bc_params: <class 'dict'>
30582.9s 23166 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30582.9s 23167 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30582.9s 23168 [PERIODIC:1000] BC_GPU [Call #13466000] About to launch kernel
30582.9s 23169 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30582.9s 23170 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30582.9s 23171 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30582.9s 23172 [WARNING] Automatic CFL correction applied (count: 3366400):
30582.9s 23173 Calculated CFL: 0.800 > Limit: 0.500
30582.9s 23174 Original dt: 3.411066e-01 s
30582.9s 23175 Corrected dt: 2.131916e-01 s
30582.9s 23176 Correction factor: 1.6x
30582.9s 23177 Max wave speed detected: 23.45 m/s
30583.0s 23178 [PROGRESS] Step 8350: t=1768.00/1770.00s (99.9%) | dt=0.2129s
30583.0s 23179 Stored output at t = 1770.0000 s (Step 8360)
30583.0s 23180 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
30583.0s 23181 [A
30583.0s 23182 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 24.05s/s]
30583.0s 23183 
30583.0s 23184 Simulation finished at t = 1770.0000 s after 8360 steps.
30583.0s 23185 Total runtime: 0.62 seconds.
30583.0s 23186 [REWARD_MICROSCOPE] step=14798 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30583.1s 23187 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30583.1s 23188 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30583.1s 23189 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30583.1s 23190 Running simulation until t = 1785.00 s, outputting every 15.00 s
30583.1s 23191 
30583.4s 23192 [PROGRESS] Step 8400: t=1778.50/1785.00s (99.6%) | dt=0.2126s
30583.7s 23193 Stored output at t = 1785.0000 s (Step 8431)
30583.7s 23194 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
30583.7s 23195 [A
30583.7s 23196 
30583.7s 23197 Simulation finished at t = 1785.0000 s after 8431 steps.
30583.7s 23198 Total runtime: 0.61 seconds.
30583.7s 23199 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 24.48s/s]
30583.7s 23200 [REWARD_MICROSCOPE] step=14799 t=1785.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30583.7s 23201 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30583.7s 23202 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30583.7s 23203 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30583.7s 23204 Running simulation until t = 1800.00 s, outputting every 15.00 s
30583.7s 23205 
30583.8s 23206 [WARNING] Automatic CFL correction applied (count: 3366500):
30583.8s 23207 Calculated CFL: 0.800 > Limit: 0.500
30583.8s 23208 Original dt: 3.407212e-01 s
30583.8s 23209 Corrected dt: 2.129508e-01 s
30583.8s 23210 Correction factor: 1.6x
30583.8s 23211 Max wave speed detected: 23.48 m/s
30583.8s 23212 [PROGRESS] Step 8450: t=1789.05/1800.00s (99.4%) | dt=0.2130s
30584.3s 23213 [PROGRESS] Step 8500: t=1799.70/1800.00s (100.0%) | dt=0.2126s
30584.3s 23214 Stored output at t = 1800.0000 s (Step 8502)
30584.3s 23215 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
30584.3s 23216 [A
30584.3s 23217 
30584.3s 23218 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.24s/s]
30584.3s 23219 Simulation finished at t = 1800.0000 s after 8502 steps.
30584.3s 23220 Total runtime: 0.62 seconds.
30584.3s 23221 [REWARD_MICROSCOPE] step=14800 t=1800.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30584.3s 23222 [STEP  120] t= 1800.0s | phase=0 | reward=   0.01 | total_reward=    1.20
30584.3s 23223 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30584.3s 23224 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30584.3s 23225 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30584.3s 23226 Running simulation until t = 1815.00 s, outputting every 15.00 s
30584.3s 23227 
30584.7s 23228 [WARNING] Automatic CFL correction applied (count: 3366600):
30584.7s 23229 Calculated CFL: 0.800 > Limit: 0.500
30584.7s 23230 Original dt: 3.401477e-01 s
30584.7s 23231 Corrected dt: 2.125923e-01 s
30584.7s 23232 Correction factor: 1.6x
30584.7s 23233 Max wave speed detected: 23.52 m/s
30584.7s 23234 [PROGRESS] Step 8550: t=1810.20/1815.00s (99.7%) | dt=0.2126s
30584.9s 23235 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
30584.9s 23236 Stored output at t = 1815.0000 s (Step 8573)
30584.9s 23237 [A
30584.9s 23238 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 23.96s/s]
30584.9s 23239 
30584.9s 23240 Simulation finished at t = 1815.0000 s after 8573 steps.
30584.9s 23241 Total runtime: 0.63 seconds.
30584.9s 23242 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
30584.9s 23243 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30584.9s 23244 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30584.9s 23245 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30584.9s 23246 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30584.9s 23247 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30584.9s 23248 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30584.9s 23249 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30584.9s 23250 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30584.9s 23251 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30584.9s 23252 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30584.9s 23253 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30584.9s 23254 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30584.9s 23255 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30584.9s 23256 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30584.9s 23257 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30584.9s 23258 [REWARD_MICROSCOPE] step=14801 t=1815.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30584.9s 23259 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30584.9s 23260 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30584.9s 23261 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30584.9s 23262 Running simulation until t = 1830.00 s, outputting every 15.00 s
30584.9s 23263 
30585.1s 23264 [PERIODIC:1000] BC_DISPATCHER [Call #13467000] current_bc_params: <class 'dict'>
30585.1s 23265 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30585.1s 23266 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30585.1s 23267 [PERIODIC:1000] BC_GPU [Call #13467000] About to launch kernel
30585.1s 23268 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30585.1s 23269 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30585.1s 23270 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30585.2s 23271 [PROGRESS] Step 8600: t=1820.75/1830.00s (99.5%) | dt=0.2131s
30585.5s 23272 Stored output at t = 1830.0000 s (Step 8644)
30585.5s 23273 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
30585.5s 23274 [A
30585.5s 23275 
30585.5s 23276 Simulation finished at t = 1830.0000 s after 8644 steps.
30585.5s 23277 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.28s/s]
30585.5s 23278 Total runtime: 0.62 seconds.
30585.5s 23279 [REWARD_MICROSCOPE] step=14802 t=1830.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30585.5s 23280 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30585.5s 23281 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30585.5s 23282 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30585.5s 23283 Running simulation until t = 1845.00 s, outputting every 15.00 s
30585.5s 23284 
30585.5s 23285 [WARNING] Automatic CFL correction applied (count: 3366700):
30585.5s 23286 Calculated CFL: 0.800 > Limit: 0.500
30585.5s 23287 Original dt: 3.400436e-01 s
30585.5s 23288 Corrected dt: 2.125273e-01 s
30585.5s 23289 Correction factor: 1.6x
30585.5s 23290 Max wave speed detected: 23.53 m/s
30585.6s 23291 [PROGRESS] Step 8650: t=1831.27/1845.00s (99.3%) | dt=0.2124s
30586.0s 23292 [PROGRESS] Step 8700: t=1841.90/1845.00s (99.8%) | dt=0.2127s
30586.2s 23293 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
30586.2s 23294 [A
30586.2s 23295 Stored output at t = 1845.0000 s (Step 8715)
30586.2s 23296 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.01s/s]
30586.2s 23297 
30586.2s 23298 Simulation finished at t = 1845.0000 s after 8715 steps.
30586.2s 23299 Total runtime: 0.63 seconds.
30586.2s 23300 [REWARD_MICROSCOPE] step=14803 t=1845.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30586.2s 23301 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30586.2s 23302 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30586.2s 23303 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30586.2s 23304 Running simulation until t = 1860.00 s, outputting every 15.00 s
30586.2s 23305 
30586.4s 23306 [WARNING] Automatic CFL correction applied (count: 3366800):
30586.4s 23307 Calculated CFL: 0.800 > Limit: 0.500
30586.4s 23308 Original dt: 3.409462e-01 s
30586.4s 23309 Corrected dt: 2.130914e-01 s
30586.4s 23310 Correction factor: 1.6x
30586.4s 23311 Max wave speed detected: 23.46 m/s
30586.5s 23312 [PROGRESS] Step 8750: t=1852.45/1860.00s (99.6%) | dt=0.2131s
30586.8s 23313 Stored output at t = 1860.0000 s (Step 8786)
30586.8s 23314 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A
30586.8s 23315 [A
30586.8s 23316 
30586.8s 23317 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1860.0/1860.0 [00:00<00:00, 24.43s/s]
30586.8s 23318 Simulation finished at t = 1860.0000 s after 8786 steps.
30586.8s 23319 Total runtime: 0.61 seconds.
30586.8s 23320 [REWARD_MICROSCOPE] step=14804 t=1860.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30586.8s 23321 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30586.8s 23322 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30586.8s 23323 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30586.8s 23324 Running simulation until t = 1875.00 s, outputting every 15.00 s
30586.8s 23325 
30586.9s 23326 [PROGRESS] Step 8800: t=1862.97/1875.00s (99.4%) | dt=0.2123s
30587.3s 23327 [PERIODIC:1000] BC_DISPATCHER [Call #13468000] current_bc_params: <class 'dict'>
30587.3s 23328 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30587.3s 23329 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30587.3s 23330 [PERIODIC:1000] BC_GPU [Call #13468000] About to launch kernel
30587.3s 23331 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30587.3s 23332 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30587.3s 23333 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30587.3s 23334 [WARNING] Automatic CFL correction applied (count: 3366900):
30587.3s 23335 Calculated CFL: 0.800 > Limit: 0.500
30587.3s 23336 Original dt: 3.403711e-01 s
30587.3s 23337 Corrected dt: 2.127320e-01 s
30587.3s 23338 Correction factor: 1.6x
30587.3s 23339 Max wave speed detected: 23.50 m/s
30587.3s 23340 [PROGRESS] Step 8850: t=1873.60/1875.00s (99.9%) | dt=0.2128s
30587.4s 23341 Stored output at t = 1875.0000 s (Step 8857)
30587.4s 23342 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1860.0/1875.0 [00:00<?, ?s/s][A
30587.4s 23343 [A
30587.4s 23344 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 23.97s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1875.0/1875.0 [00:00<00:00, 23.96s/s]
30587.4s 23345 
30587.4s 23346 Simulation finished at t = 1875.0000 s after 8857 steps.
30587.4s 23347 Total runtime: 0.63 seconds.
30587.4s 23348 [REWARD_MICROSCOPE] step=14805 t=1875.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30587.4s 23349 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30587.4s 23350 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30587.4s 23351 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30587.4s 23352 Running simulation until t = 1890.00 s, outputting every 15.00 s
30587.4s 23353 
30587.8s 23354 [PROGRESS] Step 8900: t=1884.16/1890.00s (99.7%) | dt=0.2132s
30588.0s 23355 Stored output at t = 1890.0000 s (Step 8928)
30588.0s 23356 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1875.0/1890.0 [00:00<?, ?s/s][A
30588.0s 23357 [A
30588.0s 23358 
30588.0s 23359 Simulation finished at t = 1890.0000 s after 8928 steps.
30588.0s 23360 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1890.0/1890.0 [00:00<00:00, 24.34s/s]
30588.0s 23361 Total runtime: 0.62 seconds.
30588.0s 23362 [REWARD_MICROSCOPE] step=14806 t=1890.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30588.0s 23363 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30588.0s 23364 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30588.0s 23365 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30588.0s 23366 Running simulation until t = 1905.00 s, outputting every 15.00 s
30588.0s 23367 
30588.2s 23368 [WARNING] Automatic CFL correction applied (count: 3367000):
30588.2s 23369 Calculated CFL: 0.800 > Limit: 0.500
30588.2s 23370 Original dt: 3.397675e-01 s
30588.2s 23371 Corrected dt: 2.123547e-01 s
30588.2s 23372 Correction factor: 1.6x
30588.2s 23373 Max wave speed detected: 23.55 m/s
30588.2s 23374 [PROGRESS] Step 8950: t=1894.67/1905.00s (99.5%) | dt=0.2124s
30588.6s 23375 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1890.0/1905.0 [00:00<?, ?s/s][A
30588.6s 23376 [A
30588.6s 23377 Stored output at t = 1905.0000 s (Step 8999)
30588.6s 23378 
30588.6s 23379 Simulation finished at t = 1905.0000 s after 8999 steps.
30588.6s 23380 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1905.0/1905.0 [00:00<00:00, 24.34s/s]
30588.6s 23381 Total runtime: 0.62 seconds.
30588.6s 23382 [REWARD_MICROSCOPE] step=14807 t=1905.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30588.7s 23383 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30588.7s 23384 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30588.7s 23385 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30588.7s 23386 Running simulation until t = 1920.00 s, outputting every 15.00 s
30588.7s 23387 
30588.7s 23388 [PROGRESS] Step 9000: t=1905.21/1920.00s (99.2%) | dt=0.2128s
30589.0s 23389 [WARNING] Automatic CFL correction applied (count: 3367100):
30589.0s 23390 Calculated CFL: 0.800 > Limit: 0.500
30589.0s 23391 Original dt: 3.411605e-01 s
30589.0s 23392 Corrected dt: 2.132253e-01 s
30589.0s 23393 Correction factor: 1.6x
30589.0s 23394 Max wave speed detected: 23.45 m/s
30589.1s 23395 [PROGRESS] Step 9050: t=1915.87/1920.00s (99.8%) | dt=0.2133s
30589.3s 23396 Stored output at t = 1920.0000 s (Step 9070)
30589.3s 23397 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1905.0/1920.0 [00:00<?, ?s/s][A
30589.3s 23398 [A
30589.3s 23399 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1920.0/1920.0 [00:00<00:00, 24.13s/s]
30589.3s 23400 
30589.3s 23401 Simulation finished at t = 1920.0000 s after 9070 steps.
30589.3s 23402 Total runtime: 0.62 seconds.
30589.3s 23403 [REWARD_MICROSCOPE] step=14808 t=1920.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30589.3s 23404 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30589.3s 23405 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30589.3s 23406 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30589.3s 23407 Running simulation until t = 1935.00 s, outputting every 15.00 s
30589.3s 23408 
30589.4s 23409 [PERIODIC:1000] BC_DISPATCHER [Call #13469000] current_bc_params: <class 'dict'>
30589.4s 23410 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30589.4s 23411 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30589.4s 23412 [PERIODIC:1000] BC_GPU [Call #13469000] About to launch kernel
30589.4s 23413 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30589.4s 23414 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30589.4s 23415 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30589.5s 23416 [PROGRESS] Step 9100: t=1926.37/1935.00s (99.6%) | dt=0.2125s
30589.9s 23417 Stored output at t = 1935.0000 s (Step 9141)
30589.9s 23418 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1920.0/1935.0 [00:00<?, ?s/s][A
30589.9s 23419 [A
30589.9s 23420 
30589.9s 23421 Simulation finished at t = 1935.0000 s after 9141 steps.
30589.9s 23422 Total runtime: 0.62 seconds.
30589.9s 23423 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1935.0/1935.0 [00:00<00:00, 24.21s/s]
30589.9s 23424 [REWARD_MICROSCOPE] step=14809 t=1935.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30589.9s 23425 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30589.9s 23426 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30589.9s 23427 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30589.9s 23428 Running simulation until t = 1950.00 s, outputting every 15.00 s
30589.9s 23429 
30589.9s 23430 [WARNING] Automatic CFL correction applied (count: 3367200):
30589.9s 23431 Calculated CFL: 0.800 > Limit: 0.500
30589.9s 23432 Original dt: 3.405828e-01 s
30589.9s 23433 Corrected dt: 2.128643e-01 s
30589.9s 23434 Correction factor: 1.6x
30589.9s 23435 Max wave speed detected: 23.49 m/s
30590.0s 23436 [PROGRESS] Step 9150: t=1936.92/1950.00s (99.3%) | dt=0.2129s
30590.4s 23437 [PROGRESS] Step 9200: t=1947.57/1950.00s (99.9%) | dt=0.2130s
30590.5s 23438 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1935.0/1950.0 [00:00<?, ?s/s][A
30590.5s 23439 [A
30590.5s 23440 Stored output at t = 1950.0000 s (Step 9212)
30590.5s 23441 
30590.5s 23442 Simulation finished at t = 1950.0000 s after 9212 steps.
30590.5s 23443 Total runtime: 0.63 seconds.
30590.5s 23444 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1950.0/1950.0 [00:00<00:00, 23.84s/s]
30590.5s 23445 [REWARD_MICROSCOPE] step=14810 t=1950.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30590.5s 23446 [STEP  130] t= 1950.0s | phase=0 | reward=   0.01 | total_reward=    1.30
30590.5s 23447 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30590.5s 23448 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30590.5s 23449 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30590.5s 23450 Running simulation until t = 1965.00 s, outputting every 15.00 s
30590.5s 23451 
30590.9s 23452 [WARNING] Automatic CFL correction applied (count: 3367300):
30590.9s 23453 Calculated CFL: 0.800 > Limit: 0.500
30590.9s 23454 Original dt: 3.400085e-01 s
30590.9s 23455 Corrected dt: 2.125053e-01 s
30590.9s 23456 Correction factor: 1.6x
30590.9s 23457 Max wave speed detected: 23.53 m/s
30590.9s 23458 [PROGRESS] Step 9250: t=1958.07/1965.00s (99.6%) | dt=0.2125s
30591.2s 23459 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1950.0/1965.0 [00:00<?, ?s/s][A
30591.2s 23460 [A
30591.2s 23461 Stored output at t = 1965.0000 s (Step 9283)
30591.2s 23462 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 22.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1965.0/1965.0 [00:00<00:00, 22.41s/s]
30591.2s 23463 
30591.2s 23464 Simulation finished at t = 1965.0000 s after 9283 steps.
30591.2s 23465 Total runtime: 0.67 seconds.
30591.2s 23466 [QUEUE_DIAGNOSTIC] ===== Step 130 t=1965.0s =====
30591.2s 23467 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30591.2s 23468 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30591.2s 23469 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30591.2s 23470 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30591.2s 23471 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30591.2s 23472 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30591.2s 23473 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30591.2s 23474 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30591.2s 23475 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30591.2s 23476 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30591.2s 23477 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30591.2s 23478 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30591.2s 23479 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30591.2s 23480 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30591.2s 23481 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30591.2s 23482 [REWARD_MICROSCOPE] step=14811 t=1965.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30591.2s 23483 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30591.2s 23484 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30591.2s 23485 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30591.2s 23486 Running simulation until t = 1980.00 s, outputting every 15.00 s
30591.2s 23487 
30591.4s 23488 [PROGRESS] Step 9300: t=1968.62/1980.00s (99.4%) | dt=0.2130s
30591.7s 23489 [PERIODIC:1000] BC_DISPATCHER [Call #13470000] current_bc_params: <class 'dict'>
30591.7s 23490 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30591.7s 23491 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30591.7s 23492 [PERIODIC:1000] BC_GPU [Call #13470000] About to launch kernel
30591.7s 23493 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30591.7s 23494 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30591.7s 23495 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30591.7s 23496 [WARNING] Automatic CFL correction applied (count: 3367400):
30591.7s 23497 Calculated CFL: 0.800 > Limit: 0.500
30591.7s 23498 Original dt: 3.406020e-01 s
30591.7s 23499 Corrected dt: 2.128763e-01 s
30591.7s 23500 Correction factor: 1.6x
30591.7s 23501 Max wave speed detected: 23.49 m/s
30591.8s 23502 [PROGRESS] Step 9350: t=1979.27/1980.00s (100.0%) | dt=0.2127s
30591.8s 23503 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1965.0/1980.0 [00:00<?, ?s/s][A
30591.8s 23504 Stored output at t = 1980.0000 s (Step 9354)
30591.8s 23505 [A
30591.8s 23506 
30591.8s 23507 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 23.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1980.0/1980.0 [00:00<00:00, 23.87s/s]
30591.8s 23508 Simulation finished at t = 1980.0000 s after 9354 steps.
30591.8s 23509 Total runtime: 0.63 seconds.
30591.8s 23510 [REWARD_MICROSCOPE] step=14812 t=1980.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30591.8s 23511 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30591.8s 23512 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30591.8s 23513 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30591.8s 23514 Running simulation until t = 1995.00 s, outputting every 15.00 s
30591.8s 23515 
30592.2s 23516 [PROGRESS] Step 9400: t=1989.77/1995.00s (99.7%) | dt=0.2126s
30592.5s 23517 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1980.0/1995.0 [00:00<?, ?s/s][A
30592.5s 23518 [A
30592.5s 23519 Stored output at t = 1995.0000 s (Step 9425)
30592.5s 23520 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1995.0/1995.0 [00:00<00:00, 24.02s/s]
30592.5s 23521 
30592.5s 23522 Simulation finished at t = 1995.0000 s after 9425 steps.
30592.5s 23523 Total runtime: 0.62 seconds.
30592.5s 23524 [REWARD_MICROSCOPE] step=14813 t=1995.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30592.5s 23525 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30592.5s 23526 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30592.5s 23527 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30592.5s 23528 Running simulation until t = 2010.00 s, outputting every 15.00 s
30592.5s 23529 
30592.6s 23530 [WARNING] Automatic CFL correction applied (count: 3367500):
30592.6s 23531 Calculated CFL: 0.800 > Limit: 0.500
30592.6s 23532 Original dt: 3.408050e-01 s
30592.6s 23533 Corrected dt: 2.130031e-01 s
30592.6s 23534 Correction factor: 1.6x
30592.6s 23535 Max wave speed detected: 23.47 m/s
30592.7s 23536 [PROGRESS] Step 9450: t=2000.32/2010.00s (99.5%) | dt=0.2130s
30593.1s 23537 Stored output at t = 2010.0000 s (Step 9496)
30593.1s 23538 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1995.0/2010.0 [00:00<?, ?s/s][A
30593.1s 23539 [A
30593.1s 23540 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2010.0/2010.0 [00:00<00:00, 24.14s/s]
30593.1s 23541 
30593.1s 23542 Simulation finished at t = 2010.0000 s after 9496 steps.
30593.1s 23543 Total runtime: 0.62 seconds.
30593.1s 23544 [REWARD_MICROSCOPE] step=14814 t=2010.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30593.1s 23545 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30593.1s 23546 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30593.1s 23547 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30593.1s 23548 Running simulation until t = 2025.00 s, outputting every 15.00 s
30593.1s 23549 
30593.1s 23550 [PROGRESS] Step 9500: t=2010.85/2025.00s (99.3%) | dt=0.2124s
30593.5s 23551 [WARNING] Automatic CFL correction applied (count: 3367600):
30593.5s 23552 Calculated CFL: 0.800 > Limit: 0.500
30593.5s 23553 Original dt: 3.402313e-01 s
30593.5s 23554 Corrected dt: 2.126446e-01 s
30593.5s 23555 Correction factor: 1.6x
30593.5s 23556 Max wave speed detected: 23.51 m/s
30593.6s 23557 [PROGRESS] Step 9550: t=2021.47/2025.00s (99.8%) | dt=0.2127s
30593.7s 23558 Stored output at t = 2025.0000 s (Step 9567)
30593.7s 23559 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2010.0/2025.0 [00:00<?, ?s/s][A
30593.7s 23560 [A
30593.7s 23561 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2025.0/2025.0 [00:00<00:00, 24.13s/s]
30593.7s 23562 
30593.7s 23563 Simulation finished at t = 2025.0000 s after 9567 steps.
30593.7s 23564 Total runtime: 0.62 seconds.
30593.7s 23565 [REWARD_MICROSCOPE] step=14815 t=2025.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30593.7s 23566 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30593.7s 23567 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30593.7s 23568 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30593.7s 23569 Running simulation until t = 2040.00 s, outputting every 15.00 s
30593.7s 23570 
30593.9s 23571 [PERIODIC:1000] BC_DISPATCHER [Call #13471000] current_bc_params: <class 'dict'>
30593.9s 23572 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30593.9s 23573 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30593.9s 23574 [PERIODIC:1000] BC_GPU [Call #13471000] About to launch kernel
30593.9s 23575 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30593.9s 23576 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30593.9s 23577 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30594.0s 23578 [PROGRESS] Step 9600: t=2032.03/2040.00s (99.6%) | dt=0.2131s
30594.3s 23579 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2025.0/2040.0 [00:00<?, ?s/s][A
30594.3s 23580 [A
30594.3s 23581 Stored output at t = 2040.0000 s (Step 9638)
30594.3s 23582 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 23.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2040.0/2040.0 [00:00<00:00, 23.49s/s]
30594.3s 23583 
30594.3s 23584 Simulation finished at t = 2040.0000 s after 9638 steps.
30594.3s 23585 Total runtime: 0.64 seconds.
30594.4s 23586 [REWARD_MICROSCOPE] step=14816 t=2040.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30594.4s 23587 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30594.4s 23588 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30594.4s 23589 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30594.4s 23590 Running simulation until t = 2055.00 s, outputting every 15.00 s
30594.4s 23591 
30594.4s 23592 [WARNING] Automatic CFL correction applied (count: 3367700):
30594.4s 23593 Calculated CFL: 0.800 > Limit: 0.500
30594.4s 23594 Original dt: 3.398030e-01 s
30594.4s 23595 Corrected dt: 2.123769e-01 s
30594.4s 23596 Correction factor: 1.6x
30594.4s 23597 Max wave speed detected: 23.54 m/s
30594.5s 23598 [PROGRESS] Step 9650: t=2042.55/2055.00s (99.4%) | dt=0.2123s
30594.9s 23599 [PROGRESS] Step 9700: t=2053.18/2055.00s (99.9%) | dt=0.2128s
30595.0s 23600 Stored output at t = 2055.0000 s (Step 9709)
30595.0s 23601 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2040.0/2055.0 [00:00<?, ?s/s][A
30595.0s 23602 [A
30595.0s 23603 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2055.0/2055.0 [00:00<00:00, 24.23s/s]
30595.0s 23604 
30595.0s 23605 Simulation finished at t = 2055.0000 s after 9709 steps.
30595.0s 23606 Total runtime: 0.62 seconds.
30595.0s 23607 [REWARD_MICROSCOPE] step=14817 t=2055.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30595.0s 23608 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30595.0s 23609 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30595.0s 23610 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30595.0s 23611 Running simulation until t = 2070.00 s, outputting every 15.00 s
30595.0s 23612 
30595.3s 23613 [WARNING] Automatic CFL correction applied (count: 3367800):
30595.3s 23614 Calculated CFL: 0.800 > Limit: 0.500
30595.3s 23615 Original dt: 3.410260e-01 s
30595.3s 23616 Corrected dt: 2.131412e-01 s
30595.3s 23617 Correction factor: 1.6x
30595.3s 23618 Max wave speed detected: 23.46 m/s
30595.3s 23619 [PROGRESS] Step 9750: t=2063.73/2070.00s (99.7%) | dt=0.2132s
30595.6s 23620 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2055.0/2070.0 [00:00<?, ?s/s][A
30595.6s 23621 [A
30595.6s 23622 Stored output at t = 2070.0000 s (Step 9780)
30595.6s 23623 
30595.6s 23624 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2070.0/2070.0 [00:00<00:00, 24.32s/s]
30595.6s 23625 Simulation finished at t = 2070.0000 s after 9780 steps.
30595.6s 23626 Total runtime: 0.62 seconds.
30595.6s 23627 [REWARD_MICROSCOPE] step=14818 t=2070.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30595.6s 23628 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30595.6s 23629 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30595.6s 23630 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30595.6s 23631 Running simulation until t = 2085.00 s, outputting every 15.00 s
30595.6s 23632 
30595.8s 23633 [PROGRESS] Step 9800: t=2074.25/2085.00s (99.5%) | dt=0.2124s
30596.1s 23634 [PERIODIC:1000] BC_DISPATCHER [Call #13472000] current_bc_params: <class 'dict'>
30596.1s 23635 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30596.1s 23636 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30596.1s 23637 [PERIODIC:1000] BC_GPU [Call #13472000] About to launch kernel
30596.1s 23638 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30596.1s 23639 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30596.1s 23640 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30596.1s 23641 [WARNING] Automatic CFL correction applied (count: 3367900):
30596.1s 23642 Calculated CFL: 0.800 > Limit: 0.500
30596.1s 23643 Original dt: 3.404547e-01 s
30596.1s 23644 Corrected dt: 2.127842e-01 s
30596.1s 23645 Correction factor: 1.6x
30596.1s 23646 Max wave speed detected: 23.50 m/s
30596.2s 23647 [PROGRESS] Step 9850: t=2084.88/2085.00s (100.0%) | dt=0.2128s
30596.2s 23648 Stored output at t = 2085.0000 s (Step 9851)
30596.2s 23649 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2070.0/2085.0 [00:00<?, ?s/s][A
30596.2s 23650 [A
30596.2s 23651 
30596.2s 23652 Simulation finished at t = 2085.0000 s after 9851 steps.
30596.2s 23653 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2085.0/2085.0 [00:00<00:00, 24.51s/s]
30596.2s 23654 Total runtime: 0.61 seconds.
30596.2s 23655 [REWARD_MICROSCOPE] step=14819 t=2085.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30596.2s 23656 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30596.2s 23657 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30596.2s 23658 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30596.2s 23659 Running simulation until t = 2100.00 s, outputting every 15.00 s
30596.2s 23660 
30596.6s 23661 [PROGRESS] Step 9900: t=2095.44/2100.00s (99.8%) | dt=0.2133s
30596.8s 23662 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2085.0/2100.0 [00:00<?, ?s/s][A
30596.8s 23663 [A
30596.8s 23664 Stored output at t = 2100.0000 s (Step 9922)
30596.8s 23665 
30596.8s 23666 Simulation finished at t = 2100.0000 s after 9922 steps.
30596.8s 23667 Total runtime: 0.62 seconds.
30596.8s 23668 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.25s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2100.0/2100.0 [00:00<00:00, 24.24s/s]
30596.8s 23669 [REWARD_MICROSCOPE] step=14820 t=2100.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30596.8s 23670 [STEP  140] t= 2100.0s | phase=0 | reward=   0.01 | total_reward=    1.40
30596.8s 23671 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30596.8s 23672 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30596.8s 23673 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30596.8s 23674 Running simulation until t = 2115.00 s, outputting every 15.00 s
30596.8s 23675 
30597.0s 23676 [WARNING] Automatic CFL correction applied (count: 3368000):
30597.0s 23677 Calculated CFL: 0.800 > Limit: 0.500
30597.0s 23678 Original dt: 3.398585e-01 s
30597.0s 23679 Corrected dt: 2.124115e-01 s
30597.0s 23680 Correction factor: 1.6x
30597.0s 23681 Max wave speed detected: 23.54 m/s
30597.1s 23682 [PROGRESS] Step 9950: t=2105.95/2115.00s (99.6%) | dt=0.2125s
30597.5s 23683 Stored output at t = 2115.0000 s (Step 9993)
30597.5s 23684 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2100.0/2115.0 [00:00<?, ?s/s][A
30597.5s 23685 [A
30597.5s 23686 
30597.5s 23687 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 23.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2115.0/2115.0 [00:00<00:00, 23.71s/s]
30597.5s 23688 Simulation finished at t = 2115.0000 s after 9993 steps.
30597.5s 23689 Total runtime: 0.63 seconds.
30597.5s 23690 [QUEUE_DIAGNOSTIC] ===== Step 140 t=2115.0s =====
30597.5s 23691 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30597.5s 23692 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30597.5s 23693 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30597.5s 23694 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30597.5s 23695 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30597.5s 23696 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30597.5s 23697 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30597.5s 23698 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30597.5s 23699 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30597.5s 23700 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30597.5s 23701 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30597.5s 23702 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30597.5s 23703 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30597.5s 23704 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30597.5s 23705 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30597.5s 23706 [REWARD_MICROSCOPE] step=14821 t=2115.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30597.5s 23707 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30597.5s 23708 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30597.5s 23709 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30597.5s 23710 Running simulation until t = 2130.00 s, outputting every 15.00 s
30597.5s 23711 
30597.5s 23712 [PROGRESS] Step 10000: t=2116.49/2130.00s (99.4%) | dt=0.2129s
30597.9s 23713 [WARNING] Automatic CFL correction applied (count: 3368100):
30597.9s 23714 Calculated CFL: 0.800 > Limit: 0.500
30597.9s 23715 Original dt: 3.412422e-01 s
30597.9s 23716 Corrected dt: 2.132764e-01 s
30597.9s 23717 Correction factor: 1.6x
30597.9s 23718 Max wave speed detected: 23.44 m/s
30598.0s 23719 [PROGRESS] Step 10050: t=2127.15/2130.00s (99.9%) | dt=0.2131s
30598.1s 23720 Stored output at t = 2130.0000 s (Step 10064)
30598.1s 23721 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2115.0/2130.0 [00:00<?, ?s/s][A
30598.1s 23722 [A
30598.1s 23723 
30598.1s 23724 Simulation finished at t = 2130.0000 s after 10064 steps.
30598.1s 23725 Total runtime: 0.62 seconds.
30598.1s 23726 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2130.0/2130.0 [00:00<00:00, 24.27s/s]
30598.1s 23727 [REWARD_MICROSCOPE] step=14822 t=2130.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30598.1s 23728 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30598.1s 23729 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30598.1s 23730 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30598.1s 23731 Running simulation until t = 2145.00 s, outputting every 15.00 s
30598.1s 23732 
30598.3s 23733 [PERIODIC:1000] BC_DISPATCHER [Call #13473000] current_bc_params: <class 'dict'>
30598.3s 23734 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30598.3s 23735 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30598.3s 23736 [PERIODIC:1000] BC_GPU [Call #13473000] About to launch kernel
30598.3s 23737 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30598.3s 23738 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30598.3s 23739 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30598.4s 23740 [PROGRESS] Step 10100: t=2137.65/2145.00s (99.7%) | dt=0.2125s
30598.7s 23741 Stored output at t = 2145.0000 s (Step 10135)
30598.7s 23742 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2130.0/2145.0 [00:00<?, ?s/s][A
30598.7s 23743 [A
30598.7s 23744 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2145.0/2145.0 [00:00<00:00, 23.83s/s]
30598.7s 23745 
30598.7s 23746 Simulation finished at t = 2145.0000 s after 10135 steps.
30598.7s 23747 Total runtime: 0.63 seconds.
30598.7s 23748 [REWARD_MICROSCOPE] step=14823 t=2145.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30598.7s 23749 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30598.7s 23750 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30598.7s 23751 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30598.7s 23752 Running simulation until t = 2160.00 s, outputting every 15.00 s
30598.7s 23753 
30598.8s 23754 [WARNING] Automatic CFL correction applied (count: 3368200):
30598.8s 23755 Calculated CFL: 0.800 > Limit: 0.500
30598.8s 23756 Original dt: 3.406657e-01 s
30598.8s 23757 Corrected dt: 2.129161e-01 s
30598.8s 23758 Correction factor: 1.6x
30598.8s 23759 Max wave speed detected: 23.48 m/s
30598.9s 23760 [PROGRESS] Step 10150: t=2148.19/2160.00s (99.5%) | dt=0.2130s
30599.3s 23761 [PROGRESS] Step 10200: t=2158.85/2160.00s (99.9%) | dt=0.2127s
30599.3s 23762 Stored output at t = 2160.0000 s (Step 10206)
30599.3s 23763 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2145.0/2160.0 [00:00<?, ?s/s][A
30599.3s 23764 [A
30599.3s 23765 
30599.3s 23766 Simulation finished at t = 2160.0000 s after 10206 steps.
30599.3s 23767 Total runtime: 0.62 seconds.
30599.3s 23768 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2160.0/2160.0 [00:00<00:00, 24.28s/s]
30599.3s 23769 [REWARD_MICROSCOPE] step=14824 t=2160.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30599.3s 23770 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30599.3s 23771 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30599.3s 23772 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30599.3s 23773 Running simulation until t = 2175.00 s, outputting every 15.00 s
30599.3s 23774 
30599.7s 23775 [WARNING] Automatic CFL correction applied (count: 3368300):
30599.7s 23776 Calculated CFL: 0.800 > Limit: 0.500
30599.7s 23777 Original dt: 3.400921e-01 s
30599.7s 23778 Corrected dt: 2.125575e-01 s
30599.7s 23779 Correction factor: 1.6x
30599.7s 23780 Max wave speed detected: 23.52 m/s
30599.7s 23781 [PROGRESS] Step 10250: t=2169.35/2175.00s (99.7%) | dt=0.2126s
30600.0s 23782 Stored output at t = 2175.0000 s (Step 10277)
30600.0s 23783 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2160.0/2175.0 [00:00<?, ?s/s][A
30600.0s 23784 [A
30600.0s 23785 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2175.0/2175.0 [00:00<00:00, 23.30s/s]
30600.0s 23786 
30600.0s 23787 Simulation finished at t = 2175.0000 s after 10277 steps.
30600.0s 23788 Total runtime: 0.64 seconds.
30600.0s 23789 [REWARD_MICROSCOPE] step=14825 t=2175.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30600.0s 23790 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30600.0s 23791 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30600.0s 23792 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30600.0s 23793 Running simulation until t = 2190.00 s, outputting every 15.00 s
30600.0s 23794 
30600.2s 23795 [PROGRESS] Step 10300: t=2179.90/2190.00s (99.5%) | dt=0.2130s
30600.6s 23796 [PERIODIC:1000] BC_DISPATCHER [Call #13474000] current_bc_params: <class 'dict'>
30600.6s 23797 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30600.6s 23798 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30600.6s 23799 [PERIODIC:1000] BC_GPU [Call #13474000] About to launch kernel
30600.6s 23800 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30600.6s 23801 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30600.6s 23802 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30600.6s 23803 [WARNING] Automatic CFL correction applied (count: 3368400):
30600.6s 23804 Calculated CFL: 0.800 > Limit: 0.500
30600.6s 23805 Original dt: 3.402189e-01 s
30600.6s 23806 Corrected dt: 2.126368e-01 s
30600.6s 23807 Correction factor: 1.6x
30600.6s 23808 Max wave speed detected: 23.51 m/s
30600.7s 23809 Stored output at t = 2190.0000 s (Step 10348)
30600.7s 23810 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2175.0/2190.0 [00:00<?, ?s/s][A
30600.7s 23811 [A
30600.7s 23812 
30600.7s 23813 Simulation finished at t = 2190.0000 s after 10348 steps.
30600.7s 23814 Total runtime: 0.67 seconds.
30600.7s 23815 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 22.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2190.0/2190.0 [00:00<00:00, 22.55s/s]
30600.7s 23816 [REWARD_MICROSCOPE] step=14826 t=2190.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30600.7s 23817 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30600.7s 23818 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30600.7s 23819 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30600.7s 23820 Running simulation until t = 2205.00 s, outputting every 15.00 s
30600.7s 23821 
30600.7s 23822 [PROGRESS] Step 10350: t=2190.43/2205.00s (99.3%) | dt=0.2125s
30601.1s 23823 [PROGRESS] Step 10400: t=2201.05/2205.00s (99.8%) | dt=0.2127s
30601.3s 23824 Stored output at t = 2205.0000 s (Step 10419)
30601.3s 23825 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2190.0/2205.0 [00:00<?, ?s/s][A
30601.3s 23826 [A
30601.3s 23827 
30601.3s 23828 Simulation finished at t = 2205.0000 s after 10419 steps.
30601.3s 23829 Total runtime: 0.64 seconds.
30601.3s 23830 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 23.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2205.0/2205.0 [00:00<00:00, 23.44s/s]
30601.3s 23831 [REWARD_MICROSCOPE] step=14827 t=2205.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30601.3s 23832 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30601.3s 23833 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30601.3s 23834 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30601.3s 23835 Running simulation until t = 2220.00 s, outputting every 15.00 s
30601.3s 23836 
30601.5s 23837 [WARNING] Automatic CFL correction applied (count: 3368500):
30601.5s 23838 Calculated CFL: 0.800 > Limit: 0.500
30601.5s 23839 Original dt: 3.408895e-01 s
30601.5s 23840 Corrected dt: 2.130559e-01 s
30601.5s 23841 Correction factor: 1.6x
30601.5s 23842 Max wave speed detected: 23.47 m/s
30601.6s 23843 [PROGRESS] Step 10450: t=2211.60/2220.00s (99.6%) | dt=0.2131s
30601.9s 23844 Stored output at t = 2220.0000 s (Step 10490)
30601.9s 23845 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2205.0/2220.0 [00:00<?, ?s/s][A
30601.9s 23846 [A
30601.9s 23847 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2220.0/2220.0 [00:00<00:00, 24.31s/s]
30601.9s 23848 
30601.9s 23849 Simulation finished at t = 2220.0000 s after 10490 steps.
30601.9s 23850 Total runtime: 0.62 seconds.
30601.9s 23851 [REWARD_MICROSCOPE] step=14828 t=2220.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30601.9s 23852 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30601.9s 23853 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30601.9s 23854 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30601.9s 23855 Running simulation until t = 2235.00 s, outputting every 15.00 s
30601.9s 23856 
30602.0s 23857 [PROGRESS] Step 10500: t=2222.12/2235.00s (99.4%) | dt=0.2123s
30602.4s 23858 [WARNING] Automatic CFL correction applied (count: 3368600):
30602.4s 23859 Calculated CFL: 0.800 > Limit: 0.500
30602.4s 23860 Original dt: 3.403151e-01 s
30602.4s 23861 Corrected dt: 2.126969e-01 s
30602.4s 23862 Correction factor: 1.6x
30602.4s 23863 Max wave speed detected: 23.51 m/s
30602.4s 23864 [PROGRESS] Step 10550: t=2232.75/2235.00s (99.9%) | dt=0.2127s
30602.5s 23865 Stored output at t = 2235.0000 s (Step 10561)
30602.5s 23866 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2220.0/2235.0 [00:00<?, ?s/s][A
30602.5s 23867 [A
30602.5s 23868 
30602.5s 23869 Simulation finished at t = 2235.0000 s after 10561 steps.
30602.5s 23870 Total runtime: 0.62 seconds.
30602.5s 23871 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2235.0/2235.0 [00:00<00:00, 24.25s/s]
30602.5s 23872 [REWARD_MICROSCOPE] step=14829 t=2235.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30602.5s 23873 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30602.5s 23874 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30602.5s 23875 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30602.5s 23876 Running simulation until t = 2250.00 s, outputting every 15.00 s
30602.5s 23877 
30602.8s 23878 [PERIODIC:1000] BC_DISPATCHER [Call #13475000] current_bc_params: <class 'dict'>
30602.8s 23879 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30602.8s 23880 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30602.8s 23881 [PERIODIC:1000] BC_GPU [Call #13475000] About to launch kernel
30602.8s 23882 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30602.8s 23883 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30602.8s 23884 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30602.9s 23885 [PROGRESS] Step 10600: t=2243.31/2250.00s (99.7%) | dt=0.2132s
30603.2s 23886 Stored output at t = 2250.0000 s (Step 10632)
30603.2s 23887 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2235.0/2250.0 [00:00<?, ?s/s][A
30603.2s 23888 [A
30603.2s 23889 
30603.2s 23890 Simulation finished at t = 2250.0000 s after 10632 steps.
30603.2s 23891 Total runtime: 0.61 seconds.
30603.2s 23892 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2250.0/2250.0 [00:00<00:00, 24.49s/s]
30603.2s 23893 [REWARD_MICROSCOPE] step=14830 t=2250.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30603.2s 23894 [STEP  150] t= 2250.0s | phase=0 | reward=   0.01 | total_reward=    1.50
30603.2s 23895 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30603.2s 23896 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30603.2s 23897 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30603.2s 23898 Running simulation until t = 2265.00 s, outputting every 15.00 s
30603.2s 23899 
30603.3s 23900 [WARNING] Automatic CFL correction applied (count: 3368700):
30603.3s 23901 Calculated CFL: 0.800 > Limit: 0.500
30603.3s 23902 Original dt: 3.397193e-01 s
30603.3s 23903 Corrected dt: 2.123245e-01 s
30603.3s 23904 Correction factor: 1.6x
30603.3s 23905 Max wave speed detected: 23.55 m/s
30603.3s 23906 [PROGRESS] Step 10650: t=2253.82/2265.00s (99.5%) | dt=0.2124s
30603.7s 23907 [PROGRESS] Step 10700: t=2264.45/2265.00s (100.0%) | dt=0.2128s
30603.8s 23908 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2250.0/2265.0 [00:00<?, ?s/s][A
30603.8s 23909 [A
30603.8s 23910 Stored output at t = 2265.0000 s (Step 10703)
30603.8s 23911 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2265.0/2265.0 [00:00<00:00, 24.39s/s]
30603.8s 23912 
30603.8s 23913 Simulation finished at t = 2265.0000 s after 10703 steps.
30603.8s 23914 Total runtime: 0.62 seconds.
30603.8s 23915 [QUEUE_DIAGNOSTIC] ===== Step 150 t=2265.0s =====
30603.8s 23916 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30603.8s 23917 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30603.8s 23918 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30603.8s 23919 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30603.8s 23920 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30603.8s 23921 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30603.8s 23922 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30603.8s 23923 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30603.8s 23924 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30603.8s 23925 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30603.8s 23926 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30603.8s 23927 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30603.8s 23928 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30603.8s 23929 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30603.8s 23930 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30603.8s 23931 [REWARD_MICROSCOPE] step=14831 t=2265.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30603.8s 23932 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30603.8s 23933 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30603.8s 23934 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30603.8s 23935 Running simulation until t = 2280.00 s, outputting every 15.00 s
30603.8s 23936 
30604.1s 23937 [WARNING] Automatic CFL correction applied (count: 3368800):
30604.1s 23938 Calculated CFL: 0.800 > Limit: 0.500
30604.1s 23939 Original dt: 3.411064e-01 s
30604.1s 23940 Corrected dt: 2.131915e-01 s
30604.1s 23941 Correction factor: 1.6x
30604.1s 23942 Max wave speed detected: 23.45 m/s
30604.2s 23943 [PROGRESS] Step 10750: t=2275.01/2280.00s (99.8%) | dt=0.2132s
30604.4s 23944 Stored output at t = 2280.0000 s (Step 10774)
30604.4s 23945 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2265.0/2280.0 [00:00<?, ?s/s][A
30604.4s 23946 [A
30604.4s 23947 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2280.0/2280.0 [00:00<00:00, 24.64s/s]
30604.4s 23948 
30604.4s 23949 Simulation finished at t = 2280.0000 s after 10774 steps.
30604.4s 23950 Total runtime: 0.61 seconds.
30604.4s 23951 [REWARD_MICROSCOPE] step=14832 t=2280.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30604.4s 23952 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30604.4s 23953 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30604.4s 23954 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30604.4s 23955 Running simulation until t = 2295.00 s, outputting every 15.00 s
30604.4s 23956 
30604.6s 23957 [PROGRESS] Step 10800: t=2285.52/2295.00s (99.6%) | dt=0.2124s
30605.0s 23958 [PERIODIC:1000] BC_DISPATCHER [Call #13476000] current_bc_params: <class 'dict'>
30605.0s 23959 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30605.0s 23960 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30605.0s 23961 [PERIODIC:1000] BC_GPU [Call #13476000] About to launch kernel
30605.0s 23962 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30605.0s 23963 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30605.0s 23964 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30605.0s 23965 [WARNING] Automatic CFL correction applied (count: 3368900):
30605.0s 23966 Calculated CFL: 0.800 > Limit: 0.500
30605.0s 23967 Original dt: 3.405361e-01 s
30605.0s 23968 Corrected dt: 2.128351e-01 s
30605.0s 23969 Correction factor: 1.6x
30605.0s 23970 Max wave speed detected: 23.49 m/s
30605.0s 23971 Stored output at t = 2295.0000 s (Step 10845)
30605.0s 23972 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2280.0/2295.0 [00:00<?, ?s/s][A
30605.0s 23973 [A
30605.0s 23974 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 23.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2295.0/2295.0 [00:00<00:00, 23.58s/s]
30605.0s 23975 
30605.0s 23976 Simulation finished at t = 2295.0000 s after 10845 steps.
30605.0s 23977 Total runtime: 0.64 seconds.
30605.0s 23978 [REWARD_MICROSCOPE] step=14833 t=2295.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30605.0s 23979 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30605.0s 23980 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30605.0s 23981 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30605.0s 23982 Running simulation until t = 2310.00 s, outputting every 15.00 s
30605.0s 23983 
30605.1s 23984 [PROGRESS] Step 10850: t=2296.06/2310.00s (99.4%) | dt=0.2129s
30605.5s 23985 [PROGRESS] Step 10900: t=2306.72/2310.00s (99.9%) | dt=0.2133s
30605.6s 23986 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295.0/2310.0 [00:00<?, ?s/s][A
30605.6s 23987 [A
30605.6s 23988 Stored output at t = 2310.0000 s (Step 10916)
30605.6s 23989 
30605.6s 23990 Simulation finished at t = 2310.0000 s after 10916 steps.
30605.6s 23991 Total runtime: 0.62 seconds.
30605.6s 23992 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2310.0/2310.0 [00:00<00:00, 24.07s/s]
30605.7s 23993 [REWARD_MICROSCOPE] step=14834 t=2310.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30605.7s 23994 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30605.7s 23995 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30605.7s 23996 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30605.7s 23997 Running simulation until t = 2325.00 s, outputting every 15.00 s
30605.7s 23998 
30605.9s 23999 [WARNING] Automatic CFL correction applied (count: 3369000):
30605.9s 24000 Calculated CFL: 0.800 > Limit: 0.500
30605.9s 24001 Original dt: 3.399493e-01 s
30605.9s 24002 Corrected dt: 2.124683e-01 s
30605.9s 24003 Correction factor: 1.6x
30605.9s 24004 Max wave speed detected: 23.53 m/s
30605.9s 24005 [PROGRESS] Step 10950: t=2317.22/2325.00s (99.7%) | dt=0.2125s
30606.3s 24006 Stored output at t = 2325.0000 s (Step 10987)
30606.3s 24007 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310.0/2325.0 [00:00<?, ?s/s][A
30606.3s 24008 [A
30606.3s 24009 
30606.3s 24010 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2325.0/2325.0 [00:00<00:00, 24.28s/s]
30606.3s 24011 Simulation finished at t = 2325.0000 s after 10987 steps.
30606.3s 24012 Total runtime: 0.62 seconds.
30606.3s 24013 [REWARD_MICROSCOPE] step=14835 t=2325.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30606.3s 24014 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30606.3s 24015 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30606.3s 24016 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30606.3s 24017 Running simulation until t = 2340.00 s, outputting every 15.00 s
30606.3s 24018 
30606.4s 24019 [PROGRESS] Step 11000: t=2327.77/2340.00s (99.5%) | dt=0.2129s
30606.8s 24020 [WARNING] Automatic CFL correction applied (count: 3369100):
30606.8s 24021 Calculated CFL: 0.800 > Limit: 0.500
30606.8s 24022 Original dt: 3.409227e-01 s
30606.8s 24023 Corrected dt: 2.130767e-01 s
30606.8s 24024 Correction factor: 1.6x
30606.8s 24025 Max wave speed detected: 23.47 m/s
30606.8s 24026 [PROGRESS] Step 11050: t=2338.42/2340.00s (99.9%) | dt=0.2128s
30606.9s 24027 Stored output at t = 2340.0000 s (Step 11058)
30606.9s 24028 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2325.0/2340.0 [00:00<?, ?s/s][A
30606.9s 24029 [A
30606.9s 24030 
30606.9s 24031 Simulation finished at t = 2340.0000 s after 11058 steps.
30606.9s 24032 Total runtime: 0.62 seconds.
30606.9s 24033 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2340.0/2340.0 [00:00<00:00, 24.15s/s]
30606.9s 24034 [REWARD_MICROSCOPE] step=14836 t=2340.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30606.9s 24035 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30606.9s 24036 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30606.9s 24037 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30606.9s 24038 Running simulation until t = 2355.00 s, outputting every 15.00 s
30606.9s 24039 
30607.2s 24040 [PERIODIC:1000] BC_DISPATCHER [Call #13477000] current_bc_params: <class 'dict'>
30607.2s 24041 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30607.2s 24042 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30607.2s 24043 [PERIODIC:1000] BC_GPU [Call #13477000] About to launch kernel
30607.2s 24044 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30607.2s 24045 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30607.2s 24046 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30607.3s 24047 [PROGRESS] Step 11100: t=2348.92/2355.00s (99.7%) | dt=0.2126s
30607.5s 24048 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2340.0/2355.0 [00:00<?, ?s/s][A
30607.5s 24049 [A
30607.5s 24050 Stored output at t = 2355.0000 s (Step 11129)
30607.5s 24051 
30607.5s 24052 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2355.0/2355.0 [00:00<00:00, 24.29s/s]
30607.5s 24053 Simulation finished at t = 2355.0000 s after 11129 steps.
30607.5s 24054 Total runtime: 0.62 seconds.
30607.5s 24055 [REWARD_MICROSCOPE] step=14837 t=2355.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30607.5s 24056 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30607.5s 24057 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30607.5s 24058 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30607.5s 24059 Running simulation until t = 2370.00 s, outputting every 15.00 s
30607.5s 24060 
30607.7s 24061 [WARNING] Automatic CFL correction applied (count: 3369200):
30607.7s 24062 Calculated CFL: 0.800 > Limit: 0.500
30607.7s 24063 Original dt: 3.407491e-01 s
30607.7s 24064 Corrected dt: 2.129682e-01 s
30607.7s 24065 Correction factor: 1.6x
30607.7s 24066 Max wave speed detected: 23.48 m/s
30607.7s 24067 [PROGRESS] Step 11150: t=2359.47/2370.00s (99.6%) | dt=0.2130s
30608.1s 24068 [PROGRESS] Step 11200: t=2370.00/2370.00s (100.0%) | dt=0.0883s
30608.1s 24069 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2355.0/2370.0 [00:00<?, ?s/s][A
30608.1s 24070 [A
30608.1s 24071 Stored output at t = 2370.0000 s (Step 11200)
30608.1s 24072 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2370.0/2370.0 [00:00<00:00, 24.07s/s]
30608.1s 24073 
30608.1s 24074 Simulation finished at t = 2370.0000 s after 11200 steps.
30608.1s 24075 Total runtime: 0.62 seconds.
30608.1s 24076 [REWARD_MICROSCOPE] step=14838 t=2370.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30608.1s 24077 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30608.1s 24078 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30608.1s 24079 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30608.1s 24080 Running simulation until t = 2385.00 s, outputting every 15.00 s
30608.1s 24081 
30608.5s 24082 [WARNING] Automatic CFL correction applied (count: 3369300):
30608.5s 24083 Calculated CFL: 0.800 > Limit: 0.500
30608.5s 24084 Original dt: 3.401756e-01 s
30608.5s 24085 Corrected dt: 2.126097e-01 s
30608.5s 24086 Correction factor: 1.6x
30608.5s 24087 Max wave speed detected: 23.52 m/s
30608.6s 24088 [PROGRESS] Step 11250: t=2380.62/2385.00s (99.8%) | dt=0.2127s
30608.8s 24089 Stored output at t = 2385.0000 s (Step 11271)
30608.8s 24090 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2370.0/2385.0 [00:00<?, ?s/s][A
30608.8s 24091 [A
30608.8s 24092 
30608.8s 24093 Simulation finished at t = 2385.0000 s after 11271 steps.
30608.8s 24094 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.49s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2385.0/2385.0 [00:00<00:00, 24.48s/s]
30608.8s 24095 Total runtime: 0.61 seconds.
30608.8s 24096 [REWARD_MICROSCOPE] step=14839 t=2385.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30608.8s 24097 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30608.8s 24098 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30608.8s 24099 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30608.8s 24100 Running simulation until t = 2400.00 s, outputting every 15.00 s
30608.8s 24101 
30609.0s 24102 [PROGRESS] Step 11300: t=2391.18/2400.00s (99.6%) | dt=0.2131s
30609.4s 24103 [PERIODIC:1000] BC_DISPATCHER [Call #13478000] current_bc_params: <class 'dict'>
30609.4s 24104 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30609.4s 24105 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30609.4s 24106 [PERIODIC:1000] BC_GPU [Call #13478000] About to launch kernel
30609.4s 24107 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30609.4s 24108 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30609.4s 24109 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30609.4s 24110 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2385.0/2400.0 [00:00<?, ?s/s][A
30609.4s 24111 [A
30609.4s 24112 Stored output at t = 2400.0000 s (Step 11342)
30609.4s 24113 
30609.4s 24114 Simulation finished at t = 2400.0000 s after 11342 steps.
30609.4s 24115 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.10s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2400.0/2400.0 [00:00<00:00, 24.09s/s]
30609.4s 24116 Total runtime: 0.62 seconds.
30609.4s 24117 [REWARD_MICROSCOPE] step=14840 t=2400.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30609.4s 24118 [STEP  160] t= 2400.0s | phase=0 | reward=   0.01 | total_reward=    1.60
30609.4s 24119 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30609.4s 24120 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30609.4s 24121 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30609.4s 24122 Running simulation until t = 2415.00 s, outputting every 15.00 s
30609.4s 24123 
30609.4s 24124 [WARNING] Automatic CFL correction applied (count: 3369400):
30609.4s 24125 Calculated CFL: 0.800 > Limit: 0.500
30609.4s 24126 Original dt: 3.399530e-01 s
30609.4s 24127 Corrected dt: 2.124706e-01 s
30609.4s 24128 Correction factor: 1.6x
30609.4s 24129 Max wave speed detected: 23.53 m/s
30609.5s 24130 [PROGRESS] Step 11350: t=2401.70/2415.00s (99.4%) | dt=0.2124s
30609.9s 24131 [PROGRESS] Step 11400: t=2412.32/2415.00s (99.9%) | dt=0.2127s
30610.0s 24132 Stored output at t = 2415.0000 s (Step 11413)
30610.0s 24133 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2400.0/2415.0 [00:00<?, ?s/s][A
30610.0s 24134 [A
30610.0s 24135 
30610.0s 24136 Simulation finished at t = 2415.0000 s after 11413 steps.
30610.0s 24137 Total runtime: 0.63 seconds.
30610.0s 24138 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 23.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2415.0/2415.0 [00:00<00:00, 23.77s/s]
30610.0s 24139 [QUEUE_DIAGNOSTIC] ===== Step 160 t=2415.0s =====
30610.0s 24140 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30610.0s 24141 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30610.0s 24142 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30610.0s 24143 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30610.0s 24144 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30610.0s 24145 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30610.0s 24146 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30610.0s 24147 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30610.0s 24148 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30610.0s 24149 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30610.0s 24150 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30610.0s 24151 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30610.0s 24152 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30610.0s 24153 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30610.0s 24154 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30610.0s 24155 [REWARD_MICROSCOPE] step=14841 t=2415.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30610.0s 24156 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30610.0s 24157 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30610.0s 24158 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30610.0s 24159 Running simulation until t = 2430.00 s, outputting every 15.00 s
30610.0s 24160 
30610.3s 24161 [WARNING] Automatic CFL correction applied (count: 3369500):
30610.3s 24162 Calculated CFL: 0.800 > Limit: 0.500
30610.3s 24163 Original dt: 3.409728e-01 s
30610.3s 24164 Corrected dt: 2.131080e-01 s
30610.3s 24165 Correction factor: 1.6x
30610.3s 24166 Max wave speed detected: 23.46 m/s
30610.3s 24167 [PROGRESS] Step 11450: t=2422.88/2430.00s (99.7%) | dt=0.2131s
30610.6s 24168 Stored output at t = 2430.0000 s (Step 11484)
30610.6s 24169 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2415.0/2430.0 [00:00<?, ?s/s][A
30610.6s 24170 [A
30610.6s 24171 
30610.6s 24172 Simulation finished at t = 2430.0000 s after 11484 steps.
30610.6s 24173 Total runtime: 0.62 seconds.
30610.6s 24174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2430.0/2430.0 [00:00<00:00, 24.22s/s]
30610.6s 24175 [REWARD_MICROSCOPE] step=14842 t=2430.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30610.6s 24176 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30610.6s 24177 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30610.6s 24178 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30610.6s 24179 Running simulation until t = 2445.00 s, outputting every 15.00 s
30610.6s 24180 
30610.8s 24181 [PROGRESS] Step 11500: t=2433.40/2445.00s (99.5%) | dt=0.2123s
30611.2s 24182 [WARNING] Automatic CFL correction applied (count: 3369600):
30611.2s 24183 Calculated CFL: 0.800 > Limit: 0.500
30611.2s 24184 Original dt: 3.403992e-01 s
30611.2s 24185 Corrected dt: 2.127495e-01 s
30611.2s 24186 Correction factor: 1.6x
30611.2s 24187 Max wave speed detected: 23.50 m/s
30611.2s 24188 [PROGRESS] Step 11550: t=2444.03/2445.00s (100.0%) | dt=0.2128s
30611.3s 24189 Stored output at t = 2445.0000 s (Step 11555)
30611.3s 24190 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2430.0/2445.0 [00:00<?, ?s/s][A
30611.3s 24191 [A
30611.3s 24192 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2445.0/2445.0 [00:00<00:00, 23.23s/s]
30611.3s 24193 
30611.3s 24194 Simulation finished at t = 2445.0000 s after 11555 steps.
30611.3s 24195 Total runtime: 0.65 seconds.
30611.3s 24196 [REWARD_MICROSCOPE] step=14843 t=2445.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30611.3s 24197 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30611.3s 24198 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30611.3s 24199 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30611.3s 24200 Running simulation until t = 2460.00 s, outputting every 15.00 s
30611.3s 24201 
30611.6s 24202 [PERIODIC:1000] BC_DISPATCHER [Call #13479000] current_bc_params: <class 'dict'>
30611.6s 24203 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30611.6s 24204 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30611.6s 24205 [PERIODIC:1000] BC_GPU [Call #13479000] About to launch kernel
30611.6s 24206 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30611.6s 24207 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30611.6s 24208 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30611.7s 24209 [PROGRESS] Step 11600: t=2454.59/2460.00s (99.8%) | dt=0.2132s
30611.9s 24210 Stored output at t = 2460.0000 s (Step 11626)
30611.9s 24211 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2445.0/2460.0 [00:00<?, ?s/s][A
30611.9s 24212 [A
30611.9s 24213 
30611.9s 24214 Simulation finished at t = 2460.0000 s after 11626 steps.
30611.9s 24215 Total runtime: 0.62 seconds.
30611.9s 24216 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2460.0/2460.0 [00:00<00:00, 24.28s/s]
30611.9s 24217 [REWARD_MICROSCOPE] step=14844 t=2460.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30611.9s 24218 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30611.9s 24219 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30611.9s 24220 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30611.9s 24221 Running simulation until t = 2475.00 s, outputting every 15.00 s
30611.9s 24222 
30612.1s 24223 [WARNING] Automatic CFL correction applied (count: 3369700):
30612.1s 24224 Calculated CFL: 0.800 > Limit: 0.500
30612.1s 24225 Original dt: 3.397973e-01 s
30612.1s 24226 Corrected dt: 2.123733e-01 s
30612.1s 24227 Correction factor: 1.6x
30612.1s 24228 Max wave speed detected: 23.54 m/s
30612.1s 24229 [PROGRESS] Step 11650: t=2465.10/2475.00s (99.6%) | dt=0.2124s
30612.5s 24230 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2460.0/2475.0 [00:00<?, ?s/s][A
30612.5s 24231 [A
30612.5s 24232 Stored output at t = 2475.0000 s (Step 11697)
30612.5s 24233 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2475.0/2475.0 [00:00<00:00, 23.81s/s]
30612.5s 24234 
30612.5s 24235 Simulation finished at t = 2475.0000 s after 11697 steps.
30612.5s 24236 Total runtime: 0.63 seconds.
30612.5s 24237 [REWARD_MICROSCOPE] step=14845 t=2475.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30612.5s 24238 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30612.5s 24239 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30612.5s 24240 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30612.5s 24241 Running simulation until t = 2490.00 s, outputting every 15.00 s
30612.5s 24242 
30612.6s 24243 [PROGRESS] Step 11700: t=2475.64/2490.00s (99.4%) | dt=0.2129s
30612.9s 24244 [WARNING] Automatic CFL correction applied (count: 3369800):
30612.9s 24245 Calculated CFL: 0.800 > Limit: 0.500
30612.9s 24246 Original dt: 3.411876e-01 s
30612.9s 24247 Corrected dt: 2.132423e-01 s
30612.9s 24248 Correction factor: 1.6x
30612.9s 24249 Max wave speed detected: 23.45 m/s
30613.0s 24250 [PROGRESS] Step 11750: t=2486.29/2490.00s (99.9%) | dt=0.2133s
30613.2s 24251 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2475.0/2490.0 [00:00<?, ?s/s][A
30613.2s 24252 [A
30613.2s 24253 Stored output at t = 2490.0000 s (Step 11768)
30613.2s 24254 
30613.2s 24255 Simulation finished at t = 2490.0000 s after 11768 steps.
30613.2s 24256 Total runtime: 0.61 seconds.
30613.2s 24257 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2490.0/2490.0 [00:00<00:00, 24.46s/s]
30613.2s 24258 [REWARD_MICROSCOPE] step=14846 t=2490.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30613.2s 24259 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30613.2s 24260 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30613.2s 24261 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30613.2s 24262 Running simulation until t = 2505.00 s, outputting every 15.00 s
30613.2s 24263 
30613.4s 24264 [PROGRESS] Step 11800: t=2496.80/2505.00s (99.7%) | dt=0.2125s
30613.8s 24265 [PERIODIC:1000] BC_DISPATCHER [Call #13480000] current_bc_params: <class 'dict'>
30613.8s 24266 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30613.8s 24267 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30613.8s 24268 [PERIODIC:1000] BC_GPU [Call #13480000] About to launch kernel
30613.8s 24269 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30613.8s 24270 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30613.8s 24271 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30613.8s 24272 Stored output at t = 2505.0000 s (Step 11839)
30613.8s 24273 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2490.0/2505.0 [00:00<?, ?s/s][A
30613.8s 24274 [A
30613.8s 24275 
30613.8s 24276 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 24.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2505.0/2505.0 [00:00<00:00, 24.42s/s]
30613.8s 24277 Simulation finished at t = 2505.0000 s after 11839 steps.
30613.8s 24278 Total runtime: 0.61 seconds.
30613.8s 24279 [REWARD_MICROSCOPE] step=14847 t=2505.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30613.8s 24280 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30613.8s 24281 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30613.8s 24282 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30613.8s 24283 Running simulation until t = 2520.00 s, outputting every 15.00 s
30613.8s 24284 
30613.8s 24285 [WARNING] Automatic CFL correction applied (count: 3369900):
30613.8s 24286 Calculated CFL: 0.800 > Limit: 0.500
30613.8s 24287 Original dt: 3.406104e-01 s
30613.8s 24288 Corrected dt: 2.128815e-01 s
30613.8s 24289 Correction factor: 1.6x
30613.8s 24290 Max wave speed detected: 23.49 m/s
30613.9s 24291 [PROGRESS] Step 11850: t=2507.34/2520.00s (99.5%) | dt=0.2129s
30614.3s 24292 [PROGRESS] Step 11900: t=2518.00/2520.00s (99.9%) | dt=0.2129s
30614.4s 24293 Stored output at t = 2520.0000 s (Step 11910)
30614.4s 24294 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2505.0/2520.0 [00:00<?, ?s/s][A
30614.4s 24295 [A
30614.4s 24296 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2520.0/2520.0 [00:00<00:00, 24.17s/s]
30614.4s 24297 
30614.4s 24298 Simulation finished at t = 2520.0000 s after 11910 steps.
30614.4s 24299 Total runtime: 0.62 seconds.
30614.4s 24300 [REWARD_MICROSCOPE] step=14848 t=2520.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30614.4s 24301 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30614.4s 24302 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30614.4s 24303 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30614.4s 24304 Running simulation until t = 2535.00 s, outputting every 15.00 s
30614.4s 24305 
30614.7s 24306 [WARNING] Automatic CFL correction applied (count: 3370000):
30614.7s 24307 Calculated CFL: 0.800 > Limit: 0.500
30614.7s 24308 Original dt: 3.400365e-01 s
30614.7s 24309 Corrected dt: 2.125228e-01 s
30614.7s 24310 Correction factor: 1.6x
30614.7s 24311 Max wave speed detected: 23.53 m/s
30614.8s 24312 [PROGRESS] Step 11950: t=2528.50/2535.00s (99.7%) | dt=0.2126s
30615.0s 24313 Stored output at t = 2535.0000 s (Step 11981)
30615.0s 24314 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2520.0/2535.0 [00:00<?, ?s/s][A
30615.0s 24315 [A
30615.0s 24316 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2535.0/2535.0 [00:00<00:00, 23.47s/s]
30615.0s 24317 
30615.0s 24318 Simulation finished at t = 2535.0000 s after 11981 steps.
30615.0s 24319 Total runtime: 0.64 seconds.
30615.0s 24320 [REWARD_MICROSCOPE] step=14849 t=2535.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30615.0s 24321 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30615.0s 24322 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30615.0s 24323 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30615.0s 24324 Running simulation until t = 2550.00 s, outputting every 15.00 s
30615.0s 24325 
30615.2s 24326 [PROGRESS] Step 12000: t=2539.05/2550.00s (99.6%) | dt=0.2130s
30615.6s 24327 [WARNING] Automatic CFL correction applied (count: 3370100):
30615.6s 24328 Calculated CFL: 0.800 > Limit: 0.500
30615.6s 24329 Original dt: 3.404624e-01 s
30615.6s 24330 Corrected dt: 2.127890e-01 s
30615.6s 24331 Correction factor: 1.6x
30615.6s 24332 Max wave speed detected: 23.50 m/s
30615.6s 24333 [PROGRESS] Step 12050: t=2549.70/2550.00s (100.0%) | dt=0.2126s
30615.7s 24334 Stored output at t = 2550.0000 s (Step 12052)
30615.7s 24335 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2535.0/2550.0 [00:00<?, ?s/s][A
30615.7s 24336 [A
30615.7s 24337 
30615.7s 24338 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2550.0/2550.0 [00:00<00:00, 24.33s/s]
30615.7s 24339 Simulation finished at t = 2550.0000 s after 12052 steps.
30615.7s 24340 Total runtime: 0.62 seconds.
30615.7s 24341 [REWARD_MICROSCOPE] step=14850 t=2550.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30615.7s 24342 [STEP  170] t= 2550.0s | phase=0 | reward=   0.01 | total_reward=    1.70
30615.7s 24343 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30615.7s 24344 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30615.7s 24345 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30615.7s 24346 Running simulation until t = 2565.00 s, outputting every 15.00 s
30615.7s 24347 
30616.0s 24348 [PERIODIC:1000] BC_DISPATCHER [Call #13481000] current_bc_params: <class 'dict'>
30616.0s 24349 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30616.0s 24350 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30616.0s 24351 [PERIODIC:1000] BC_GPU [Call #13481000] About to launch kernel
30616.0s 24352 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30616.0s 24353 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30616.0s 24354 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30616.1s 24355 [PROGRESS] Step 12100: t=2560.20/2565.00s (99.8%) | dt=0.2126s
30616.3s 24356 Stored output at t = 2565.0000 s (Step 12123)
30616.3s 24357 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2550.0/2565.0 [00:00<?, ?s/s][A
30616.3s 24358 [A
30616.3s 24359 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 22.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2565.0/2565.0 [00:00<00:00, 22.16s/s]
30616.3s 24360 
30616.3s 24361 Simulation finished at t = 2565.0000 s after 12123 steps.
30616.3s 24362 Total runtime: 0.68 seconds.
30616.3s 24363 [QUEUE_DIAGNOSTIC] ===== Step 170 t=2565.0s =====
30616.3s 24364 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30616.3s 24365 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30616.3s 24366 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30616.3s 24367 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30616.3s 24368 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30616.3s 24369 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30616.3s 24370 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30616.3s 24371 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30616.3s 24372 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30616.3s 24373 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30616.3s 24374 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30616.3s 24375 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30616.3s 24376 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30616.3s 24377 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30616.3s 24378 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30616.3s 24379 [REWARD_MICROSCOPE] step=14851 t=2565.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30616.3s 24380 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30616.3s 24381 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30616.3s 24382 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30616.3s 24383 Running simulation until t = 2580.00 s, outputting every 15.00 s
30616.3s 24384 
30616.5s 24385 [WARNING] Automatic CFL correction applied (count: 3370200):
30616.5s 24386 Calculated CFL: 0.800 > Limit: 0.500
30616.5s 24387 Original dt: 3.408331e-01 s
30616.5s 24388 Corrected dt: 2.130207e-01 s
30616.5s 24389 Correction factor: 1.6x
30616.5s 24390 Max wave speed detected: 23.47 m/s
30616.6s 24391 [PROGRESS] Step 12150: t=2570.75/2580.00s (99.6%) | dt=0.2131s
30617.0s 24392 Stored output at t = 2580.0000 s (Step 12194)
30617.0s 24393 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2565.0/2580.0 [00:00<?, ?s/s][A
30617.0s 24394 [A
30617.0s 24395 
30617.0s 24396 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 23.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2580.0/2580.0 [00:00<00:00, 23.78s/s]
30617.0s 24397 Simulation finished at t = 2580.0000 s after 12194 steps.
30617.0s 24398 Total runtime: 0.63 seconds.
30617.0s 24399 [REWARD_MICROSCOPE] step=14852 t=2580.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30617.0s 24400 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30617.0s 24401 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30617.0s 24402 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30617.0s 24403 Running simulation until t = 2595.00 s, outputting every 15.00 s
30617.0s 24404 
30617.0s 24405 [PROGRESS] Step 12200: t=2581.27/2595.00s (99.5%) | dt=0.2124s
30617.4s 24406 [WARNING] Automatic CFL correction applied (count: 3370300):
30617.4s 24407 Calculated CFL: 0.800 > Limit: 0.500
30617.4s 24408 Original dt: 3.402592e-01 s
30617.4s 24409 Corrected dt: 2.126620e-01 s
30617.4s 24410 Correction factor: 1.6x
30617.4s 24411 Max wave speed detected: 23.51 m/s
30617.5s 24412 [PROGRESS] Step 12250: t=2591.90/2595.00s (99.9%) | dt=0.2127s
30617.6s 24413 Stored output at t = 2595.0000 s (Step 12265)
30617.6s 24414 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2580.0/2595.0 [00:00<?, ?s/s][A
30617.6s 24415 [A
30617.6s 24416 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2595.0/2595.0 [00:00<00:00, 24.02s/s]
30617.6s 24417 
30617.6s 24418 Simulation finished at t = 2595.0000 s after 12265 steps.
30617.6s 24419 Total runtime: 0.63 seconds.
30617.6s 24420 [REWARD_MICROSCOPE] step=14853 t=2595.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30617.6s 24421 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30617.6s 24422 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30617.6s 24423 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30617.6s 24424 Running simulation until t = 2610.00 s, outputting every 15.00 s
30617.6s 24425 
30617.9s 24426 [PROGRESS] Step 12300: t=2602.45/2610.00s (99.7%) | dt=0.2131s
30618.2s 24427 Stored output at t = 2610.0000 s (Step 12336)
30618.2s 24428 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2595.0/2610.0 [00:00<?, ?s/s][A
30618.2s 24429 [A
30618.2s 24430 
30618.2s 24431 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2610.0/2610.0 [00:00<00:00, 23.98s/s]
30618.2s 24432 Simulation finished at t = 2610.0000 s after 12336 steps.
30618.2s 24433 Total runtime: 0.63 seconds.
30618.2s 24434 [REWARD_MICROSCOPE] step=14854 t=2610.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30618.2s 24435 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30618.2s 24436 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30618.2s 24437 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30618.2s 24438 Running simulation until t = 2625.00 s, outputting every 15.00 s
30618.2s 24439 
30618.3s 24440 [PERIODIC:1000] BC_DISPATCHER [Call #13482000] current_bc_params: <class 'dict'>
30618.3s 24441 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30618.3s 24442 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30618.3s 24443 [PERIODIC:1000] BC_GPU [Call #13482000] About to launch kernel
30618.3s 24444 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30618.3s 24445 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30618.3s 24446 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30618.3s 24447 [WARNING] Automatic CFL correction applied (count: 3370400):
30618.3s 24448 Calculated CFL: 0.800 > Limit: 0.500
30618.3s 24449 Original dt: 3.397413e-01 s
30618.3s 24450 Corrected dt: 2.123383e-01 s
30618.3s 24451 Correction factor: 1.6x
30618.3s 24452 Max wave speed detected: 23.55 m/s
30618.4s 24453 [PROGRESS] Step 12350: t=2612.97/2625.00s (99.5%) | dt=0.2123s
30618.8s 24454 [PROGRESS] Step 12400: t=2623.60/2625.00s (99.9%) | dt=0.2128s
30618.8s 24455 Stored output at t = 2625.0000 s (Step 12407)
30618.8s 24456 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2610.0/2625.0 [00:00<?, ?s/s][A
30618.8s 24457 [A
30618.8s 24458 
30618.8s 24459 Simulation finished at t = 2625.0000 s after 12407 steps.
30618.8s 24460 Total runtime: 0.61 seconds.
30618.8s 24461 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2625.0/2625.0 [00:00<00:00, 24.46s/s]
30618.8s 24462 [REWARD_MICROSCOPE] step=14855 t=2625.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30618.8s 24463 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30618.8s 24464 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30618.8s 24465 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30618.8s 24466 Running simulation until t = 2640.00 s, outputting every 15.00 s
30618.8s 24467 
30619.2s 24468 [WARNING] Automatic CFL correction applied (count: 3370500):
30619.2s 24469 Calculated CFL: 0.800 > Limit: 0.500
30619.2s 24470 Original dt: 3.410527e-01 s
30619.2s 24471 Corrected dt: 2.131579e-01 s
30619.2s 24472 Correction factor: 1.6x
30619.2s 24473 Max wave speed detected: 23.46 m/s
30619.3s 24474 [PROGRESS] Step 12450: t=2634.16/2640.00s (99.8%) | dt=0.2132s
30619.5s 24475 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2625.0/2640.0 [00:00<?, ?s/s][A
30619.5s 24476 [A
30619.5s 24477 Stored output at t = 2640.0000 s (Step 12478)
30619.5s 24478 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2640.0/2640.0 [00:00<00:00, 23.17s/s]
30619.5s 24479 
30619.5s 24480 Simulation finished at t = 2640.0000 s after 12478 steps.
30619.5s 24481 Total runtime: 0.65 seconds.
30619.5s 24482 [REWARD_MICROSCOPE] step=14856 t=2640.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30619.5s 24483 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30619.5s 24484 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30619.5s 24485 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30619.5s 24486 Running simulation until t = 2655.00 s, outputting every 15.00 s
30619.5s 24487 
30620.1s 24488 [PROGRESS] Step 12500: t=2644.67/2655.00s (99.6%) | dt=0.2124s
30620.5s 24489 [WARNING] Automatic CFL correction applied (count: 3370600):
30620.5s 24490 Calculated CFL: 0.800 > Limit: 0.500
30620.5s 24491 Original dt: 3.404818e-01 s
30620.5s 24492 Corrected dt: 2.128011e-01 s
30620.5s 24493 Correction factor: 1.6x
30620.5s 24494 Max wave speed detected: 23.50 m/s
30620.5s 24495 Stored output at t = 2655.0000 s (Step 12549)
30620.5s 24496 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2640.0/2655.0 [00:00<?, ?s/s][A
30620.5s 24497 [A
30620.5s 24498 
30620.5s 24499 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 15.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2655.0/2655.0 [00:00<00:00, 15.06s/s]
30620.5s 24500 Simulation finished at t = 2655.0000 s after 12549 steps.
30620.5s 24501 Total runtime: 1.00 seconds.
30620.5s 24502 [REWARD_MICROSCOPE] step=14857 t=2655.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30620.5s 24503 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30620.5s 24504 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30620.5s 24505 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30620.5s 24506 Running simulation until t = 2670.00 s, outputting every 15.00 s
30620.5s 24507 
30620.5s 24508 [PROGRESS] Step 12550: t=2655.21/2670.00s (99.4%) | dt=0.2128s
30620.9s 24509 [PERIODIC:1000] BC_DISPATCHER [Call #13483000] current_bc_params: <class 'dict'>
30620.9s 24510 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30620.9s 24511 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30620.9s 24512 [PERIODIC:1000] BC_GPU [Call #13483000] About to launch kernel
30620.9s 24513 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30620.9s 24514 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30620.9s 24515 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30621.0s 24516 [PROGRESS] Step 12600: t=2665.87/2670.00s (99.8%) | dt=0.2133s
30621.1s 24517 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2655.0/2670.0 [00:00<?, ?s/s][A
30621.1s 24518 [A
30621.1s 24519 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 23.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670.0/2670.0 [00:00<00:00, 23.29s/s]
30621.1s 24520 Stored output at t = 2670.0000 s (Step 12620)
30621.1s 24521 
30621.1s 24522 Simulation finished at t = 2670.0000 s after 12620 steps.
30621.1s 24523 Total runtime: 0.64 seconds.
30621.1s 24524 [REWARD_MICROSCOPE] step=14858 t=2670.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30621.1s 24525 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30621.1s 24526 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30621.1s 24527 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30621.1s 24528 Running simulation until t = 2685.00 s, outputting every 15.00 s
30621.1s 24529 
30621.4s 24530 [WARNING] Automatic CFL correction applied (count: 3370700):
30621.4s 24531 Calculated CFL: 0.800 > Limit: 0.500
30621.4s 24532 Original dt: 3.398890e-01 s
30621.4s 24533 Corrected dt: 2.124306e-01 s
30621.4s 24534 Correction factor: 1.6x
30621.4s 24535 Max wave speed detected: 23.54 m/s
30621.4s 24536 [PROGRESS] Step 12650: t=2676.37/2685.00s (99.7%) | dt=0.2125s
30621.8s 24537 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2670.0/2685.0 [00:00<?, ?s/s][A
30621.8s 24538 [A
30621.8s 24539 Stored output at t = 2685.0000 s (Step 12691)
30621.8s 24540 
30621.8s 24541 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2685.0/2685.0 [00:00<00:00, 24.21s/s]
30621.8s 24542 Simulation finished at t = 2685.0000 s after 12691 steps.
30621.8s 24543 Total runtime: 0.62 seconds.
30621.8s 24544 [REWARD_MICROSCOPE] step=14859 t=2685.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30621.8s 24545 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30621.8s 24546 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30621.8s 24547 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30621.8s 24548 Running simulation until t = 2700.00 s, outputting every 15.00 s
30621.8s 24549 
30621.8s 24550 [PROGRESS] Step 12700: t=2686.92/2700.00s (99.5%) | dt=0.2129s
30622.2s 24551 [WARNING] Automatic CFL correction applied (count: 3370800):
30622.2s 24552 Calculated CFL: 0.800 > Limit: 0.500
30622.2s 24553 Original dt: 3.412697e-01 s
30622.2s 24554 Corrected dt: 2.132935e-01 s
30622.2s 24555 Correction factor: 1.6x
30622.2s 24556 Max wave speed detected: 23.44 m/s
30622.3s 24557 [PROGRESS] Step 12750: t=2697.57/2700.00s (99.9%) | dt=0.2130s
30622.4s 24558 Stored output at t = 2700.0000 s (Step 12762)
30622.4s 24559 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2685.0/2700.0 [00:00<?, ?s/s][A
30622.4s 24560 [A
30622.4s 24561 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2700.0/2700.0 [00:00<00:00, 24.30s/s]
30622.4s 24562 
30622.4s 24563 Simulation finished at t = 2700.0000 s after 12762 steps.
30622.4s 24564 Total runtime: 0.62 seconds.
30622.4s 24565 [REWARD_MICROSCOPE] step=14860 t=2700.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30622.4s 24566 [STEP  180] t= 2700.0s | phase=0 | reward=   0.01 | total_reward=    1.80
30622.4s 24567 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30622.4s 24568 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30622.4s 24569 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30622.4s 24570 Running simulation until t = 2715.00 s, outputting every 15.00 s
30622.4s 24571 
30622.7s 24572 [PROGRESS] Step 12800: t=2708.07/2715.00s (99.7%) | dt=0.2125s
30623.0s 24573 Stored output at t = 2715.0000 s (Step 12833)
30623.0s 24574 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2700.0/2715.0 [00:00<?, ?s/s][A
30623.0s 24575 [A
30623.0s 24576 
30623.0s 24577 Simulation finished at t = 2715.0000 s after 12833 steps.
30623.0s 24578 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2715.0/2715.0 [00:00<00:00, 24.10s/s]
30623.0s 24579 Total runtime: 0.62 seconds.
30623.0s 24580 [QUEUE_DIAGNOSTIC] ===== Step 180 t=2715.0s =====
30623.0s 24581 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30623.0s 24582 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30623.0s 24583 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30623.0s 24584 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30623.0s 24585 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30623.0s 24586 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30623.0s 24587 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30623.0s 24588 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30623.0s 24589 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30623.0s 24590 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30623.0s 24591 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30623.0s 24592 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30623.0s 24593 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30623.0s 24594 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30623.0s 24595 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30623.0s 24596 [REWARD_MICROSCOPE] step=14861 t=2715.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30623.0s 24597 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30623.0s 24598 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30623.0s 24599 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30623.0s 24600 Running simulation until t = 2730.00 s, outputting every 15.00 s
30623.0s 24601 
30623.1s 24602 [PERIODIC:1000] BC_DISPATCHER [Call #13484000] current_bc_params: <class 'dict'>
30623.1s 24603 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30623.1s 24604 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30623.1s 24605 [PERIODIC:1000] BC_GPU [Call #13484000] About to launch kernel
30623.1s 24606 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30623.1s 24607 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30623.1s 24608 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30623.1s 24609 [WARNING] Automatic CFL correction applied (count: 3370900):
30623.1s 24610 Calculated CFL: 0.800 > Limit: 0.500
30623.1s 24611 Original dt: 3.406934e-01 s
30623.1s 24612 Corrected dt: 2.129334e-01 s
30623.1s 24613 Correction factor: 1.6x
30623.1s 24614 Max wave speed detected: 23.48 m/s
30623.2s 24615 [PROGRESS] Step 12850: t=2718.62/2730.00s (99.6%) | dt=0.2130s
30623.6s 24616 [PROGRESS] Step 12900: t=2729.27/2730.00s (100.0%) | dt=0.2127s
30623.6s 24617 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2715.0/2730.0 [00:00<?, ?s/s][A
30623.6s 24618 Stored output at t = 2730.0000 s (Step 12904)
30623.6s 24619 [A
30623.6s 24620 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2730.0/2730.0 [00:00<00:00, 24.35s/s]
30623.6s 24621 
30623.6s 24622 Simulation finished at t = 2730.0000 s after 12904 steps.
30623.6s 24623 Total runtime: 0.62 seconds.
30623.6s 24624 [REWARD_MICROSCOPE] step=14862 t=2730.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30623.6s 24625 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30623.6s 24626 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30623.6s 24627 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30623.6s 24628 Running simulation until t = 2745.00 s, outputting every 15.00 s
30623.6s 24629 
30624.0s 24630 [WARNING] Automatic CFL correction applied (count: 3371000):
30624.0s 24631 Calculated CFL: 0.800 > Limit: 0.500
30624.0s 24632 Original dt: 3.401199e-01 s
30624.0s 24633 Corrected dt: 2.125749e-01 s
30624.0s 24634 Correction factor: 1.6x
30624.0s 24635 Max wave speed detected: 23.52 m/s
30624.1s 24636 [PROGRESS] Step 12950: t=2739.77/2745.00s (99.8%) | dt=0.2126s
30624.3s 24637 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2730.0/2745.0 [00:00<?, ?s/s][A
30624.3s 24638 [A
30624.3s 24639 Stored output at t = 2745.0000 s (Step 12975)
30624.3s 24640 
30624.3s 24641 Simulation finished at t = 2745.0000 s after 12975 steps.
30624.3s 24642 Total runtime: 0.64 seconds.
30624.3s 24643 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2745.0/2745.0 [00:00<00:00, 23.41s/s]
30624.3s 24644 [REWARD_MICROSCOPE] step=14863 t=2745.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30624.3s 24645 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30624.3s 24646 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30624.3s 24647 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30624.3s 24648 Running simulation until t = 2760.00 s, outputting every 15.00 s
30624.3s 24649 
30624.5s 24650 [PROGRESS] Step 13000: t=2750.32/2760.00s (99.6%) | dt=0.2130s
30624.9s 24651 [WARNING] Automatic CFL correction applied (count: 3371100):
30624.9s 24652 Calculated CFL: 0.800 > Limit: 0.500
30624.9s 24653 Original dt: 3.401129e-01 s
30624.9s 24654 Corrected dt: 2.125705e-01 s
30624.9s 24655 Correction factor: 1.6x
30624.9s 24656 Max wave speed detected: 23.52 m/s
30624.9s 24657 Stored output at t = 2760.0000 s (Step 13046)
30624.9s 24658 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2745.0/2760.0 [00:00<?, ?s/s][A
30624.9s 24659 [A
30624.9s 24660 
30624.9s 24661 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2760.0/2760.0 [00:00<00:00, 24.39s/s]
30624.9s 24662 Simulation finished at t = 2760.0000 s after 13046 steps.
30624.9s 24663 Total runtime: 0.62 seconds.
30624.9s 24664 [REWARD_MICROSCOPE] step=14864 t=2760.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30624.9s 24665 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30624.9s 24666 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30624.9s 24667 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30624.9s 24668 Running simulation until t = 2775.00 s, outputting every 15.00 s
30624.9s 24669 
30624.9s 24670 [PROGRESS] Step 13050: t=2760.85/2775.00s (99.5%) | dt=0.2124s
30625.3s 24671 [PERIODIC:1000] BC_DISPATCHER [Call #13485000] current_bc_params: <class 'dict'>
30625.3s 24672 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30625.3s 24673 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30625.3s 24674 [PERIODIC:1000] BC_GPU [Call #13485000] About to launch kernel
30625.3s 24675 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30625.3s 24676 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30625.3s 24677 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30625.4s 24678 [PROGRESS] Step 13100: t=2771.47/2775.00s (99.9%) | dt=0.2127s
30625.5s 24679 Stored output at t = 2775.0000 s (Step 13117)
30625.5s 24680 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2760.0/2775.0 [00:00<?, ?s/s][A
30625.5s 24681 [A
30625.5s 24682 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2775.0/2775.0 [00:00<00:00, 24.34s/s]
30625.5s 24683 
30625.5s 24684 Simulation finished at t = 2775.0000 s after 13117 steps.
30625.5s 24685 Total runtime: 0.62 seconds.
30625.5s 24686 [REWARD_MICROSCOPE] step=14865 t=2775.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30625.5s 24687 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30625.5s 24688 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30625.5s 24689 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30625.5s 24690 Running simulation until t = 2790.00 s, outputting every 15.00 s
30625.5s 24691 
30625.8s 24692 [WARNING] Automatic CFL correction applied (count: 3371200):
30625.8s 24693 Calculated CFL: 0.800 > Limit: 0.500
30625.8s 24694 Original dt: 3.409178e-01 s
30625.8s 24695 Corrected dt: 2.130736e-01 s
30625.8s 24696 Correction factor: 1.6x
30625.8s 24697 Max wave speed detected: 23.47 m/s
30625.8s 24698 [PROGRESS] Step 13150: t=2782.03/2790.00s (99.7%) | dt=0.2131s
30626.1s 24699 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2775.0/2790.0 [00:00<?, ?s/s][A
30626.1s 24700 [A
30626.1s 24701 Stored output at t = 2790.0000 s (Step 13188)
30626.1s 24702 
30626.1s 24703 Simulation finished at t = 2790.0000 s after 13188 steps.
30626.1s 24704 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2790.0/2790.0 [00:00<00:00, 24.27s/s]
30626.1s 24705 Total runtime: 0.62 seconds.
30626.1s 24706 [REWARD_MICROSCOPE] step=14866 t=2790.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30626.1s 24707 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30626.1s 24708 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30626.1s 24709 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30626.1s 24710 Running simulation until t = 2805.00 s, outputting every 15.00 s
30626.1s 24711 
30626.2s 24712 [PROGRESS] Step 13200: t=2792.55/2805.00s (99.6%) | dt=0.2123s
30626.6s 24713 [WARNING] Automatic CFL correction applied (count: 3371300):
30626.6s 24714 Calculated CFL: 0.800 > Limit: 0.500
30626.6s 24715 Original dt: 3.403431e-01 s
30626.6s 24716 Corrected dt: 2.127144e-01 s
30626.6s 24717 Correction factor: 1.6x
30626.6s 24718 Max wave speed detected: 23.51 m/s
30626.7s 24719 [PROGRESS] Step 13250: t=2803.18/2805.00s (99.9%) | dt=0.2128s
30626.8s 24720 Stored output at t = 2805.0000 s (Step 13259)
30626.8s 24721 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2790.0/2805.0 [00:00<?, ?s/s][A
30626.8s 24722 [A
30626.8s 24723 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2805.0/2805.0 [00:00<00:00, 24.01s/s]
30626.8s 24724 
30626.8s 24725 Simulation finished at t = 2805.0000 s after 13259 steps.
30626.8s 24726 Total runtime: 0.63 seconds.
30626.8s 24727 [REWARD_MICROSCOPE] step=14867 t=2805.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30626.8s 24728 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30626.8s 24729 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30626.8s 24730 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30626.8s 24731 Running simulation until t = 2820.00 s, outputting every 15.00 s
30626.8s 24732 
30627.1s 24733 [PROGRESS] Step 13300: t=2813.73/2820.00s (99.8%) | dt=0.2132s
30627.4s 24734 Stored output at t = 2820.0000 s (Step 13330)
30627.4s 24735 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2805.0/2820.0 [00:00<?, ?s/s][A
30627.4s 24736 [A
30627.4s 24737 
30627.4s 24738 Simulation finished at t = 2820.0000 s after 13330 steps.
30627.4s 24739 Total runtime: 0.64 seconds.
30627.4s 24740 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 23.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2820.0/2820.0 [00:00<00:00, 23.53s/s]
30627.4s 24741 [REWARD_MICROSCOPE] step=14868 t=2820.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30627.4s 24742 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30627.4s 24743 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30627.4s 24744 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30627.4s 24745 Running simulation until t = 2835.00 s, outputting every 15.00 s
30627.4s 24746 
30627.5s 24747 [PERIODIC:1000] BC_DISPATCHER [Call #13486000] current_bc_params: <class 'dict'>
30627.5s 24748 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30627.5s 24749 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30627.5s 24750 [PERIODIC:1000] BC_GPU [Call #13486000] About to launch kernel
30627.5s 24751 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30627.5s 24752 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30627.5s 24753 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30627.5s 24754 [WARNING] Automatic CFL correction applied (count: 3371400):
30627.5s 24755 Calculated CFL: 0.800 > Limit: 0.500
30627.5s 24756 Original dt: 3.397401e-01 s
30627.5s 24757 Corrected dt: 2.123376e-01 s
30627.5s 24758 Correction factor: 1.6x
30627.5s 24759 Max wave speed detected: 23.55 m/s
30627.6s 24760 [PROGRESS] Step 13350: t=2824.25/2835.00s (99.6%) | dt=0.2124s
30628.0s 24761 [PROGRESS] Step 13400: t=2834.88/2835.00s (100.0%) | dt=0.2128s
30628.0s 24762 Stored output at t = 2835.0000 s (Step 13401)
30628.0s 24763 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2820.0/2835.0 [00:00<?, ?s/s][A
30628.0s 24764 [A
30628.0s 24765 
30628.0s 24766 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2835.0/2835.0 [00:00<00:00, 24.00s/s]
30628.0s 24767 Simulation finished at t = 2835.0000 s after 13401 steps.
30628.0s 24768 Total runtime: 0.63 seconds.
30628.0s 24769 [REWARD_MICROSCOPE] step=14869 t=2835.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30628.0s 24770 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30628.0s 24771 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30628.0s 24772 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30628.0s 24773 Running simulation until t = 2850.00 s, outputting every 15.00 s
30628.0s 24774 
30628.4s 24775 [WARNING] Automatic CFL correction applied (count: 3371500):
30628.4s 24776 Calculated CFL: 0.800 > Limit: 0.500
30628.4s 24777 Original dt: 3.411334e-01 s
30628.4s 24778 Corrected dt: 2.132084e-01 s
30628.4s 24779 Correction factor: 1.6x
30628.4s 24780 Max wave speed detected: 23.45 m/s
30628.5s 24781 [PROGRESS] Step 13450: t=2845.44/2850.00s (99.8%) | dt=0.2133s
30628.7s 24782 Stored output at t = 2850.0000 s (Step 13472)
30628.7s 24783 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2835.0/2850.0 [00:00<?, ?s/s][A
30628.7s 24784 [A
30628.7s 24785 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2850.0/2850.0 [00:00<00:00, 23.89s/s]
30628.7s 24786 
30628.7s 24787 Simulation finished at t = 2850.0000 s after 13472 steps.
30628.7s 24788 Total runtime: 0.63 seconds.
30628.7s 24789 [REWARD_MICROSCOPE] step=14870 t=2850.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30628.7s 24790 [STEP  190] t= 2850.0s | phase=0 | reward=   0.01 | total_reward=    1.90
30628.7s 24791 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30628.7s 24792 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30628.7s 24793 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30628.7s 24794 Running simulation until t = 2865.00 s, outputting every 15.00 s
30628.7s 24795 
30628.9s 24796 [PROGRESS] Step 13500: t=2855.95/2865.00s (99.7%) | dt=0.2125s
30629.3s 24797 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2850.0/2865.0 [00:00<?, ?s/s][A
30629.3s 24798 [A
30629.3s 24799 Stored output at t = 2865.0000 s (Step 13543)
30629.3s 24800 
30629.3s 24801 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 21.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2865.0/2865.0 [00:00<00:00, 21.88s/s]
30629.3s 24802 Simulation finished at t = 2865.0000 s after 13543 steps.
30629.3s 24803 Total runtime: 0.69 seconds.
30629.3s 24804 [QUEUE_DIAGNOSTIC] ===== Step 190 t=2865.0s =====
30629.3s 24805 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30629.3s 24806 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30629.3s 24807 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30629.3s 24808 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30629.3s 24809 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30629.3s 24810 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30629.4s 24811 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30629.4s 24812 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30629.4s 24813 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30629.4s 24814 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30629.4s 24815 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30629.4s 24816 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30629.4s 24817 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30629.4s 24818 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30629.4s 24819 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30629.4s 24820 [REWARD_MICROSCOPE] step=14871 t=2865.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30629.4s 24821 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30629.4s 24822 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30629.4s 24823 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30629.4s 24824 Running simulation until t = 2880.00 s, outputting every 15.00 s
30629.4s 24825 
30629.4s 24826 [WARNING] Automatic CFL correction applied (count: 3371600):
30629.4s 24827 Calculated CFL: 0.800 > Limit: 0.500
30629.4s 24828 Original dt: 3.405553e-01 s
30629.4s 24829 Corrected dt: 2.128470e-01 s
30629.4s 24830 Correction factor: 1.6x
30629.4s 24831 Max wave speed detected: 23.49 m/s
30629.4s 24832 [PROGRESS] Step 13550: t=2866.49/2880.00s (99.5%) | dt=0.2129s
30629.8s 24833 [PERIODIC:1000] BC_DISPATCHER [Call #13487000] current_bc_params: <class 'dict'>
30629.8s 24834 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30629.8s 24835 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30629.8s 24836 [PERIODIC:1000] BC_GPU [Call #13487000] About to launch kernel
30629.8s 24837 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30629.8s 24838 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30629.8s 24839 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30629.9s 24840 [PROGRESS] Step 13600: t=2877.15/2880.00s (99.9%) | dt=0.2131s
30630.0s 24841 Stored output at t = 2880.0000 s (Step 13614)
30630.0s 24842 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2865.0/2880.0 [00:00<?, ?s/s][A
30630.0s 24843 [A
30630.0s 24844 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2880.0/2880.0 [00:00<00:00, 23.57s/s]
30630.0s 24845 
30630.0s 24846 Simulation finished at t = 2880.0000 s after 13614 steps.
30630.0s 24847 Total runtime: 0.64 seconds.
30630.0s 24848 [REWARD_MICROSCOPE] step=14872 t=2880.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30630.0s 24849 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30630.0s 24850 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30630.0s 24851 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30630.0s 24852 Running simulation until t = 2895.00 s, outputting every 15.00 s
30630.0s 24853 
30630.3s 24854 [WARNING] Automatic CFL correction applied (count: 3371700):
30630.3s 24855 Calculated CFL: 0.800 > Limit: 0.500
30630.3s 24856 Original dt: 3.399790e-01 s
30630.3s 24857 Corrected dt: 2.124869e-01 s
30630.3s 24858 Correction factor: 1.6x
30630.3s 24859 Max wave speed detected: 23.53 m/s
30630.3s 24860 [PROGRESS] Step 13650: t=2887.65/2895.00s (99.7%) | dt=0.2125s
30630.6s 24861 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2880.0/2895.0 [00:00<?, ?s/s][A
30630.6s 24862 [A
30630.6s 24863 Stored output at t = 2895.0000 s (Step 13685)
30630.6s 24864 
30630.6s 24865 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 23.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2895.0/2895.0 [00:00<00:00, 23.64s/s]
30630.6s 24866 Simulation finished at t = 2895.0000 s after 13685 steps.
30630.6s 24867 Total runtime: 0.63 seconds.
30630.6s 24868 [REWARD_MICROSCOPE] step=14873 t=2895.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30630.6s 24869 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30630.6s 24870 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30630.6s 24871 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30630.6s 24872 Running simulation until t = 2910.00 s, outputting every 15.00 s
30630.6s 24873 
30630.8s 24874 [PROGRESS] Step 13700: t=2898.19/2910.00s (99.6%) | dt=0.2130s
30631.2s 24875 [WARNING] Automatic CFL correction applied (count: 3371800):
30631.2s 24876 Calculated CFL: 0.800 > Limit: 0.500
30631.2s 24877 Original dt: 3.407550e-01 s
30631.2s 24878 Corrected dt: 2.129719e-01 s
30631.2s 24879 Correction factor: 1.6x
30631.2s 24880 Max wave speed detected: 23.48 m/s
30631.2s 24881 [PROGRESS] Step 13750: t=2908.85/2910.00s (100.0%) | dt=0.2127s
30631.3s 24882 Stored output at t = 2910.0000 s (Step 13756)
30631.3s 24883 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2895.0/2910.0 [00:00<?, ?s/s][A
30631.3s 24884 [A
30631.3s 24885 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 23.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2910.0/2910.0 [00:00<00:00, 23.34s/s]
30631.3s 24886 
30631.3s 24887 Simulation finished at t = 2910.0000 s after 13756 steps.
30631.3s 24888 Total runtime: 0.64 seconds.
30631.3s 24889 [REWARD_MICROSCOPE] step=14874 t=2910.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30631.3s 24890 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30631.3s 24891 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30631.3s 24892 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30631.3s 24893 Running simulation until t = 2925.00 s, outputting every 15.00 s
30631.3s 24894 
30631.7s 24895 [PROGRESS] Step 13800: t=2919.35/2925.00s (99.8%) | dt=0.2126s
30631.9s 24896 Stored output at t = 2925.0000 s (Step 13827)
30631.9s 24897 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2910.0/2925.0 [00:00<?, ?s/s][A
30631.9s 24898 [A
30631.9s 24899 
30631.9s 24900 Simulation finished at t = 2925.0000 s after 13827 steps.
30631.9s 24901 Total runtime: 0.63 seconds.
30631.9s 24902 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2925.0/2925.0 [00:00<00:00, 23.98s/s]
30631.9s 24903 [REWARD_MICROSCOPE] step=14875 t=2925.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30631.9s 24904 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30631.9s 24905 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30631.9s 24906 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30631.9s 24907 Running simulation until t = 2940.00 s, outputting every 15.00 s
30631.9s 24908 
30632.0s 24909 [PERIODIC:1000] BC_DISPATCHER [Call #13488000] current_bc_params: <class 'dict'>
30632.0s 24910 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30632.0s 24911 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30632.0s 24912 [PERIODIC:1000] BC_GPU [Call #13488000] About to launch kernel
30632.0s 24913 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30632.0s 24914 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30632.0s 24915 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30632.0s 24916 [WARNING] Automatic CFL correction applied (count: 3371900):
30632.0s 24917 Calculated CFL: 0.800 > Limit: 0.500
30632.0s 24918 Original dt: 3.407770e-01 s
30632.0s 24919 Corrected dt: 2.129856e-01 s
30632.0s 24920 Correction factor: 1.6x
30632.0s 24921 Max wave speed detected: 23.48 m/s
30632.1s 24922 [PROGRESS] Step 13850: t=2929.90/2940.00s (99.7%) | dt=0.2130s
30632.5s 24923 Stored output at t = 2940.0000 s (Step 13898)
30632.5s 24924 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2925.0/2940.0 [00:00<?, ?s/s][A
30632.5s 24925 [A
30632.5s 24926 
30632.5s 24927 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.58s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2940.0/2940.0 [00:00<00:00, 24.57s/s]
30632.5s 24928 Simulation finished at t = 2940.0000 s after 13898 steps.
30632.5s 24929 Total runtime: 0.61 seconds.
30632.5s 24930 [REWARD_MICROSCOPE] step=14876 t=2940.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30632.5s 24931 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30632.5s 24932 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30632.5s 24933 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30632.5s 24934 Running simulation until t = 2955.00 s, outputting every 15.00 s
30632.5s 24935 
30632.5s 24936 [PROGRESS] Step 13900: t=2940.43/2955.00s (99.5%) | dt=0.2125s
30632.9s 24937 [WARNING] Automatic CFL correction applied (count: 3372000):
30632.9s 24938 Calculated CFL: 0.800 > Limit: 0.500
30632.9s 24939 Original dt: 3.402034e-01 s
30632.9s 24940 Corrected dt: 2.126271e-01 s
30632.9s 24941 Correction factor: 1.6x
30632.9s 24942 Max wave speed detected: 23.52 m/s
30633.0s 24943 [PROGRESS] Step 13950: t=2951.05/2955.00s (99.9%) | dt=0.2127s
30633.1s 24944 Stored output at t = 2955.0000 s (Step 13969)
30633.1s 24945 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2940.0/2955.0 [00:00<?, ?s/s][A
30633.1s 24946 [A
30633.1s 24947 
30633.1s 24948 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2955.0/2955.0 [00:00<00:00, 23.84s/s]
30633.1s 24949 Simulation finished at t = 2955.0000 s after 13969 steps.
30633.1s 24950 Total runtime: 0.63 seconds.
30633.1s 24951 [REWARD_MICROSCOPE] step=14877 t=2955.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30633.1s 24952 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30633.1s 24953 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30633.1s 24954 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30633.1s 24955 Running simulation until t = 2970.00 s, outputting every 15.00 s
30633.1s 24956 
30633.4s 24957 [PROGRESS] Step 14000: t=2961.60/2970.00s (99.7%) | dt=0.2131s
30633.8s 24958 Stored output at t = 2970.0000 s (Step 14040)
30633.8s 24959 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2955.0/2970.0 [00:00<?, ?s/s][A
30633.8s 24960 [A
30633.8s 24961 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2970.0/2970.0 [00:00<00:00, 23.78s/s]
30633.8s 24962 
30633.8s 24963 Simulation finished at t = 2970.0000 s after 14040 steps.
30633.8s 24964 Total runtime: 0.63 seconds.
30633.8s 24965 [REWARD_MICROSCOPE] step=14878 t=2970.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30633.8s 24966 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30633.8s 24967 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30633.8s 24968 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30633.8s 24969 Running simulation until t = 2985.00 s, outputting every 15.00 s
30633.8s 24970 
30633.8s 24971 [WARNING] Automatic CFL correction applied (count: 3372100):
30633.8s 24972 Calculated CFL: 0.800 > Limit: 0.500
30633.8s 24973 Original dt: 3.398708e-01 s
30633.8s 24974 Corrected dt: 2.124193e-01 s
30633.8s 24975 Correction factor: 1.6x
30633.8s 24976 Max wave speed detected: 23.54 m/s
30633.9s 24977 [PROGRESS] Step 14050: t=2972.12/2985.00s (99.6%) | dt=0.2123s
30634.2s 24978 [PERIODIC:1000] BC_DISPATCHER [Call #13489000] current_bc_params: <class 'dict'>
30634.2s 24979 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30634.2s 24980 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30634.2s 24981 [PERIODIC:1000] BC_GPU [Call #13489000] About to launch kernel
30634.2s 24982 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30634.2s 24983 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30634.2s 24984 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30634.3s 24985 [PROGRESS] Step 14100: t=2982.75/2985.00s (99.9%) | dt=0.2127s
30634.4s 24986 Stored output at t = 2985.0000 s (Step 14111)
30634.4s 24987 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2970.0/2985.0 [00:00<?, ?s/s][A
30634.4s 24988 [A
30634.4s 24989 
30634.4s 24990 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 22.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2985.0/2985.0 [00:00<00:00, 22.70s/s]
30634.4s 24991 Simulation finished at t = 2985.0000 s after 14111 steps.
30634.4s 24992 Total runtime: 0.66 seconds.
30634.4s 24993 [REWARD_MICROSCOPE] step=14879 t=2985.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30634.4s 24994 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30634.4s 24995 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30634.4s 24996 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30634.4s 24997 Running simulation until t = 3000.00 s, outputting every 15.00 s
30634.4s 24998 
30634.8s 24999 [WARNING] Automatic CFL correction applied (count: 3372200):
30634.8s 25000 Calculated CFL: 0.800 > Limit: 0.500
30634.8s 25001 Original dt: 3.409993e-01 s
30634.8s 25002 Corrected dt: 2.131246e-01 s
30634.8s 25003 Correction factor: 1.6x
30634.8s 25004 Max wave speed detected: 23.46 m/s
30634.8s 25005 [PROGRESS] Step 14150: t=2993.31/3000.00s (99.8%) | dt=0.2132s
30635.1s 25006 Stored output at t = 3000.0000 s (Step 14182)
30635.1s 25007 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2985.0/3000.0 [00:00<?, ?s/s][A
30635.1s 25008 [A
30635.1s 25009 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3000.0/3000.0 [00:00<00:00, 23.10s/s]
30635.1s 25010 
30635.1s 25011 Simulation finished at t = 3000.0000 s after 14182 steps.
30635.1s 25012 Total runtime: 0.65 seconds.
30635.1s 25013 [REWARD_MICROSCOPE] step=14880 t=3000.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30635.1s 25014 [STEP  200] t= 3000.0s | phase=0 | reward=   0.01 | total_reward=    2.00
30635.1s 25015 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30635.1s 25016 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30635.1s 25017 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30635.1s 25018 Running simulation until t = 3015.00 s, outputting every 15.00 s
30635.1s 25019 
30635.3s 25020 [PROGRESS] Step 14200: t=3003.82/3015.00s (99.6%) | dt=0.2124s
30635.6s 25021 [WARNING] Automatic CFL correction applied (count: 3372300):
30635.6s 25022 Calculated CFL: 0.800 > Limit: 0.500
30635.6s 25023 Original dt: 3.404274e-01 s
30635.6s 25024 Corrected dt: 2.127671e-01 s
30635.6s 25025 Correction factor: 1.6x
30635.6s 25026 Max wave speed detected: 23.50 m/s
30635.7s 25027 [PROGRESS] Step 14250: t=3014.45/3015.00s (100.0%) | dt=0.2128s
30635.7s 25028 Stored output at t = 3015.0000 s (Step 14253)
30635.7s 25029 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3000.0/3015.0 [00:00<?, ?s/s][A
30635.7s 25030 [A
30635.7s 25031 
30635.7s 25032 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3015.0/3015.0 [00:00<00:00, 23.85s/s]
30635.7s 25033 Simulation finished at t = 3015.0000 s after 14253 steps.
30635.7s 25034 Total runtime: 0.63 seconds.
30635.7s 25035 [QUEUE_DIAGNOSTIC] ===== Step 200 t=3015.0s =====
30635.7s 25036 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30635.7s 25037 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30635.7s 25038 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30635.7s 25039 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30635.7s 25040 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30635.7s 25041 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30635.7s 25042 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30635.7s 25043 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30635.7s 25044 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30635.7s 25045 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30635.7s 25046 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30635.7s 25047 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30635.7s 25048 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30635.7s 25049 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30635.7s 25050 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30635.7s 25051 [REWARD_MICROSCOPE] step=14881 t=3015.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30635.7s 25052 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30635.7s 25053 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30635.7s 25054 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30635.7s 25055 Running simulation until t = 3030.00 s, outputting every 15.00 s
30635.7s 25056 
30636.2s 25057 [PROGRESS] Step 14300: t=3025.01/3030.00s (99.8%) | dt=0.2132s
30636.4s 25058 Stored output at t = 3030.0000 s (Step 14324)
30636.4s 25059 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3015.0/3030.0 [00:00<?, ?s/s][A
30636.4s 25060 [A
30636.4s 25061 
30636.4s 25062 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 22.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3030.0/3030.0 [00:00<00:00, 22.49s/s]
30636.4s 25063 Simulation finished at t = 3030.0000 s after 14324 steps.
30636.4s 25064 Total runtime: 0.67 seconds.
30636.4s 25065 [REWARD_MICROSCOPE] step=14882 t=3030.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30636.4s 25066 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30636.4s 25067 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30636.4s 25068 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30636.4s 25069 Running simulation until t = 3045.00 s, outputting every 15.00 s
30636.4s 25070 
30636.5s 25071 [PERIODIC:1000] BC_DISPATCHER [Call #13490000] current_bc_params: <class 'dict'>
30636.5s 25072 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30636.5s 25073 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30636.5s 25074 [PERIODIC:1000] BC_GPU [Call #13490000] About to launch kernel
30636.5s 25075 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30636.5s 25076 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30636.5s 25077 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30636.6s 25078 [WARNING] Automatic CFL correction applied (count: 3372400):
30636.6s 25079 Calculated CFL: 0.800 > Limit: 0.500
30636.6s 25080 Original dt: 3.398278e-01 s
30636.6s 25081 Corrected dt: 2.123924e-01 s
30636.6s 25082 Correction factor: 1.6x
30636.6s 25083 Max wave speed detected: 23.54 m/s
30636.7s 25084 [PROGRESS] Step 14350: t=3035.52/3045.00s (99.7%) | dt=0.2124s
30637.1s 25085 Stored output at t = 3045.0000 s (Step 14395)
30637.1s 25086 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3030.0/3045.0 [00:00<?, ?s/s][A
30637.1s 25087 [A
30637.1s 25088 
30637.1s 25089 Simulation finished at t = 3045.0000 s after 14395 steps.
30637.1s 25090 Total runtime: 0.71 seconds.
30637.1s 25091 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 21.24s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3045.0/3045.0 [00:00<00:00, 21.24s/s]
30637.1s 25092 [REWARD_MICROSCOPE] step=14883 t=3045.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30637.1s 25093 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30637.1s 25094 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30637.1s 25095 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30637.1s 25096 Running simulation until t = 3060.00 s, outputting every 15.00 s
30637.1s 25097 
30637.2s 25098 [PROGRESS] Step 14400: t=3046.06/3060.00s (99.5%) | dt=0.2129s
30637.5s 25099 [WARNING] Automatic CFL correction applied (count: 3372500):
30637.5s 25100 Calculated CFL: 0.800 > Limit: 0.500
30637.5s 25101 Original dt: 3.412149e-01 s
30637.5s 25102 Corrected dt: 2.132593e-01 s
30637.5s 25103 Correction factor: 1.6x
30637.5s 25104 Max wave speed detected: 23.45 m/s
30637.6s 25105 [PROGRESS] Step 14450: t=3056.72/3060.00s (99.9%) | dt=0.2133s
30637.7s 25106 Stored output at t = 3060.0000 s (Step 14466)
30637.7s 25107 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3045.0/3060.0 [00:00<?, ?s/s][A
30637.7s 25108 [A
30637.7s 25109 
30637.7s 25110 Simulation finished at t = 3060.0000 s after 14466 steps.
30637.7s 25111 Total runtime: 0.63 seconds.
30637.7s 25112 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3060.0/3060.0 [00:00<00:00, 23.93s/s]
30637.7s 25113 [REWARD_MICROSCOPE] step=14884 t=3060.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30637.7s 25114 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30637.7s 25115 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30637.7s 25116 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30637.7s 25117 Running simulation until t = 3075.00 s, outputting every 15.00 s
30637.7s 25118 
30638.0s 25119 [PROGRESS] Step 14500: t=3067.22/3075.00s (99.7%) | dt=0.2125s
30638.4s 25120 Stored output at t = 3075.0000 s (Step 14537)
30638.4s 25121 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3060.0/3075.0 [00:00<?, ?s/s][A
30638.4s 25122 [A
30638.4s 25123 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3075.0/3075.0 [00:00<00:00, 24.60s/s]
30638.4s 25124 
30638.4s 25125 Simulation finished at t = 3075.0000 s after 14537 steps.
30638.4s 25126 Total runtime: 0.61 seconds.
30638.4s 25127 [REWARD_MICROSCOPE] step=14885 t=3075.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30638.4s 25128 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30638.4s 25129 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30638.4s 25130 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30638.4s 25131 Running simulation until t = 3090.00 s, outputting every 15.00 s
30638.4s 25132 
30638.4s 25133 [WARNING] Automatic CFL correction applied (count: 3372600):
30638.4s 25134 Calculated CFL: 0.800 > Limit: 0.500
30638.4s 25135 Original dt: 3.406380e-01 s
30638.4s 25136 Corrected dt: 2.128988e-01 s
30638.4s 25137 Correction factor: 1.6x
30638.4s 25138 Max wave speed detected: 23.49 m/s
30638.5s 25139 [PROGRESS] Step 14550: t=3077.77/3090.00s (99.6%) | dt=0.2129s
30638.8s 25140 [PERIODIC:1000] BC_DISPATCHER [Call #13491000] current_bc_params: <class 'dict'>
30638.8s 25141 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30638.8s 25142 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30638.8s 25143 [PERIODIC:1000] BC_GPU [Call #13491000] About to launch kernel
30638.8s 25144 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30638.8s 25145 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30638.8s 25146 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30638.9s 25147 [PROGRESS] Step 14600: t=3088.42/3090.00s (99.9%) | dt=0.2128s
30639.0s 25148 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3075.0/3090.0 [00:00<?, ?s/s][A
30639.0s 25149 [A
30639.0s 25150 Stored output at t = 3090.0000 s (Step 14608)
30639.0s 25151 
30639.0s 25152 Simulation finished at t = 3090.0000 s after 14608 steps.
30639.0s 25153 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3090.0/3090.0 [00:00<00:00, 24.51s/s]
30639.0s 25154 Total runtime: 0.61 seconds.
30639.0s 25155 [REWARD_MICROSCOPE] step=14886 t=3090.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30639.0s 25156 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30639.0s 25157 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30639.0s 25158 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30639.0s 25159 Running simulation until t = 3105.00 s, outputting every 15.00 s
30639.0s 25160 
30639.3s 25161 [WARNING] Automatic CFL correction applied (count: 3372700):
30639.3s 25162 Calculated CFL: 0.800 > Limit: 0.500
30639.3s 25163 Original dt: 3.400643e-01 s
30639.3s 25164 Corrected dt: 2.125402e-01 s
30639.3s 25165 Correction factor: 1.6x
30639.3s 25166 Max wave speed detected: 23.52 m/s
30639.3s 25167 [PROGRESS] Step 14650: t=3098.92/3105.00s (99.8%) | dt=0.2126s
30639.6s 25168 Stored output at t = 3105.0000 s (Step 14679)
30639.6s 25169 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3090.0/3105.0 [00:00<?, ?s/s][A
30639.6s 25170 [A
30639.6s 25171 
30639.6s 25172 Simulation finished at t = 3105.0000 s after 14679 steps.
30639.6s 25173 Total runtime: 0.61 seconds.
30639.6s 25174 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3105.0/3105.0 [00:00<00:00, 24.54s/s]
30639.6s 25175 [REWARD_MICROSCOPE] step=14887 t=3105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30639.6s 25176 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30639.6s 25177 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30639.6s 25178 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30639.6s 25179 Running simulation until t = 3120.00 s, outputting every 15.00 s
30639.6s 25180 
30639.8s 25181 [PROGRESS] Step 14700: t=3109.47/3120.00s (99.7%) | dt=0.2130s
30640.2s 25182 [WARNING] Automatic CFL correction applied (count: 3372800):
30640.2s 25183 Calculated CFL: 0.800 > Limit: 0.500
30640.2s 25184 Original dt: 3.403351e-01 s
30640.2s 25185 Corrected dt: 2.127094e-01 s
30640.2s 25186 Correction factor: 1.6x
30640.2s 25187 Max wave speed detected: 23.51 m/s
30640.2s 25188 [PROGRESS] Step 14750: t=3120.00/3120.00s (100.0%) | dt=0.0883s
30640.2s 25189 Stored output at t = 3120.0000 s (Step 14750)
30640.2s 25190 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3105.0/3120.0 [00:00<?, ?s/s][A
30640.2s 25191 [A
30640.2s 25192 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 23.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3120.0/3120.0 [00:00<00:00, 23.50s/s]
30640.2s 25193 
30640.2s 25194 Simulation finished at t = 3120.0000 s after 14750 steps.
30640.2s 25195 Total runtime: 0.64 seconds.
30640.2s 25196 [REWARD_MICROSCOPE] step=14888 t=3120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30640.2s 25197 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30640.2s 25198 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30640.2s 25199 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30640.2s 25200 Running simulation until t = 3135.00 s, outputting every 15.00 s
30640.2s 25201 
30640.7s 25202 [PROGRESS] Step 14800: t=3130.62/3135.00s (99.9%) | dt=0.2127s
30640.9s 25203 Stored output at t = 3135.0000 s (Step 14821)
30640.9s 25204 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3120.0/3135.0 [00:00<?, ?s/s][A
30640.9s 25205 [A
30640.9s 25206 
30640.9s 25207 Simulation finished at t = 3135.0000 s after 14821 steps.
30640.9s 25208 Total runtime: 0.64 seconds.
30640.9s 25209 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3135.0/3135.0 [00:00<00:00, 23.54s/s]
30640.9s 25210 [REWARD_MICROSCOPE] step=14889 t=3135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30640.9s 25211 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30640.9s 25212 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30640.9s 25213 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30640.9s 25214 Running simulation until t = 3150.00 s, outputting every 15.00 s
30640.9s 25215 
30641.0s 25216 [PERIODIC:1000] BC_DISPATCHER [Call #13492000] current_bc_params: <class 'dict'>
30641.0s 25217 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30641.0s 25218 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30641.0s 25219 [PERIODIC:1000] BC_GPU [Call #13492000] About to launch kernel
30641.0s 25220 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30641.0s 25221 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30641.0s 25222 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30641.1s 25223 [WARNING] Automatic CFL correction applied (count: 3372900):
30641.1s 25224 Calculated CFL: 0.800 > Limit: 0.500
30641.1s 25225 Original dt: 3.408612e-01 s
30641.1s 25226 Corrected dt: 2.130383e-01 s
30641.1s 25227 Correction factor: 1.6x
30641.1s 25228 Max wave speed detected: 23.47 m/s
30641.1s 25229 [PROGRESS] Step 14850: t=3141.18/3150.00s (99.7%) | dt=0.2131s
30641.5s 25230 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3135.0/3150.0 [00:00<?, ?s/s][A
30641.5s 25231 [A
30641.5s 25232 Stored output at t = 3150.0000 s (Step 14892)
30641.5s 25233 
30641.5s 25234 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3150.0/3150.0 [00:00<00:00, 24.20s/s]
30641.5s 25235 Simulation finished at t = 3150.0000 s after 14892 steps.
30641.5s 25236 Total runtime: 0.62 seconds.
30641.5s 25237 [REWARD_MICROSCOPE] step=14890 t=3150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30641.5s 25238 [STEP  210] t= 3150.0s | phase=0 | reward=   0.01 | total_reward=    2.10
30641.5s 25239 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30641.5s 25240 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30641.5s 25241 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30641.5s 25242 Running simulation until t = 3165.00 s, outputting every 15.00 s
30641.5s 25243 
30641.6s 25244 [PROGRESS] Step 14900: t=3151.70/3165.00s (99.6%) | dt=0.2124s
30641.9s 25245 [WARNING] Automatic CFL correction applied (count: 3373000):
30641.9s 25246 Calculated CFL: 0.800 > Limit: 0.500
30641.9s 25247 Original dt: 3.402871e-01 s
30641.9s 25248 Corrected dt: 2.126795e-01 s
30641.9s 25249 Correction factor: 1.6x
30641.9s 25250 Max wave speed detected: 23.51 m/s
30642.0s 25251 [PROGRESS] Step 14950: t=3162.32/3165.00s (99.9%) | dt=0.2127s
30642.1s 25252 Stored output at t = 3165.0000 s (Step 14963)
30642.1s 25253 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3150.0/3165.0 [00:00<?, ?s/s][A
30642.1s 25254 [A
30642.1s 25255 
30642.1s 25256 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3165.0/3165.0 [00:00<00:00, 24.32s/s]
30642.1s 25257 Simulation finished at t = 3165.0000 s after 14963 steps.
30642.1s 25258 Total runtime: 0.62 seconds.
30642.1s 25259 [QUEUE_DIAGNOSTIC] ===== Step 210 t=3165.0s =====
30642.1s 25260 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30642.1s 25261 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30642.1s 25262 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30642.1s 25263 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30642.1s 25264 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30642.1s 25265 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30642.1s 25266 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30642.1s 25267 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30642.1s 25268 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30642.1s 25269 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30642.1s 25270 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30642.1s 25271 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30642.1s 25272 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30642.1s 25273 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30642.1s 25274 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30642.1s 25275 [REWARD_MICROSCOPE] step=14891 t=3165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30642.1s 25276 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30642.1s 25277 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30642.1s 25278 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30642.1s 25279 Running simulation until t = 3180.00 s, outputting every 15.00 s
30642.1s 25280 
30642.4s 25281 [PROGRESS] Step 15000: t=3172.88/3180.00s (99.8%) | dt=0.2131s
30642.7s 25282 Stored output at t = 3180.0000 s (Step 15034)
30642.7s 25283 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3165.0/3180.0 [00:00<?, ?s/s][A
30642.7s 25284 [A
30642.7s 25285 
30642.7s 25286 Simulation finished at t = 3180.0000 s after 15034 steps.
30642.7s 25287 Total runtime: 0.61 seconds.
30642.7s 25288 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3180.0/3180.0 [00:00<00:00, 24.55s/s]
30642.7s 25289 [REWARD_MICROSCOPE] step=14892 t=3180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30642.7s 25290 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30642.7s 25291 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30642.7s 25292 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30642.7s 25293 Running simulation until t = 3195.00 s, outputting every 15.00 s
30642.7s 25294 
30642.8s 25295 [WARNING] Automatic CFL correction applied (count: 3373100):
30642.8s 25296 Calculated CFL: 0.800 > Limit: 0.500
30642.8s 25297 Original dt: 3.397169e-01 s
30642.8s 25298 Corrected dt: 2.123230e-01 s
30642.8s 25299 Correction factor: 1.6x
30642.8s 25300 Max wave speed detected: 23.55 m/s
30642.9s 25301 [PROGRESS] Step 15050: t=3183.40/3195.00s (99.6%) | dt=0.2123s
30643.2s 25302 [PERIODIC:1000] BC_DISPATCHER [Call #13493000] current_bc_params: <class 'dict'>
30643.2s 25303 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30643.2s 25304 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30643.2s 25305 [PERIODIC:1000] BC_GPU [Call #13493000] About to launch kernel
30643.2s 25306 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30643.2s 25307 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30643.2s 25308 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30643.3s 25309 [PROGRESS] Step 15100: t=3194.03/3195.00s (100.0%) | dt=0.2128s
30643.4s 25310 Stored output at t = 3195.0000 s (Step 15105)
30643.4s 25311 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3180.0/3195.0 [00:00<?, ?s/s][A
30643.4s 25312 [A
30643.4s 25313 
30643.4s 25314 Simulation finished at t = 3195.0000 s after 15105 steps.
30643.4s 25315 Total runtime: 0.64 seconds.
30643.4s 25316 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3195.0/3195.0 [00:00<00:00, 23.35s/s]
30643.4s 25317 [REWARD_MICROSCOPE] step=14893 t=3195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30643.4s 25318 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30643.4s 25319 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30643.4s 25320 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30643.4s 25321 Running simulation until t = 3210.00 s, outputting every 15.00 s
30643.4s 25322 
30643.7s 25323 [WARNING] Automatic CFL correction applied (count: 3373200):
30643.7s 25324 Calculated CFL: 0.800 > Limit: 0.500
30643.7s 25325 Original dt: 3.410795e-01 s
30643.7s 25326 Corrected dt: 2.131747e-01 s
30643.7s 25327 Correction factor: 1.6x
30643.7s 25328 Max wave speed detected: 23.45 m/s
30643.8s 25329 [PROGRESS] Step 15150: t=3204.59/3210.00s (99.8%) | dt=0.2132s
30644.0s 25330 Stored output at t = 3210.0000 s (Step 15176)
30644.0s 25331 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3195.0/3210.0 [00:00<?, ?s/s][A
30644.0s 25332 [A
30644.0s 25333 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3210.0/3210.0 [00:00<00:00, 24.04s/s]
30644.0s 25334 
30644.0s 25335 Simulation finished at t = 3210.0000 s after 15176 steps.
30644.0s 25336 Total runtime: 0.62 seconds.
30644.0s 25337 [REWARD_MICROSCOPE] step=14894 t=3210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30644.0s 25338 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30644.0s 25339 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30644.0s 25340 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30644.0s 25341 Running simulation until t = 3225.00 s, outputting every 15.00 s
30644.0s 25342 
30644.2s 25343 [PROGRESS] Step 15200: t=3215.10/3225.00s (99.7%) | dt=0.2124s
30644.6s 25344 [WARNING] Automatic CFL correction applied (count: 3373300):
30644.6s 25345 Calculated CFL: 0.800 > Limit: 0.500
30644.6s 25346 Original dt: 3.405090e-01 s
30644.6s 25347 Corrected dt: 2.128181e-01 s
30644.6s 25348 Correction factor: 1.6x
30644.6s 25349 Max wave speed detected: 23.49 m/s
30644.6s 25350 Stored output at t = 3225.0000 s (Step 15247)
30644.6s 25351 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3210.0/3225.0 [00:00<?, ?s/s][A
30644.6s 25352 [A
30644.6s 25353 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3225.0/3225.0 [00:00<00:00, 24.55s/s]
30644.6s 25354 
30644.6s 25355 Simulation finished at t = 3225.0000 s after 15247 steps.
30644.6s 25356 Total runtime: 0.61 seconds.
30644.6s 25357 [REWARD_MICROSCOPE] step=14895 t=3225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30644.6s 25358 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30644.6s 25359 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30644.6s 25360 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30644.6s 25361 Running simulation until t = 3240.00 s, outputting every 15.00 s
30644.6s 25362 
30644.6s 25363 [PROGRESS] Step 15250: t=3225.64/3240.00s (99.6%) | dt=0.2129s
30645.1s 25364 [PROGRESS] Step 15300: t=3236.29/3240.00s (99.9%) | dt=0.2133s
30645.2s 25365 Stored output at t = 3240.0000 s (Step 15318)
30645.2s 25366 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3225.0/3240.0 [00:00<?, ?s/s][A
30645.2s 25367 [A
30645.2s 25368 
30645.2s 25369 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3240.0/3240.0 [00:00<00:00, 23.82s/s]
30645.2s 25370 Simulation finished at t = 3240.0000 s after 15318 steps.
30645.2s 25371 Total runtime: 0.63 seconds.
30645.2s 25372 [REWARD_MICROSCOPE] step=14896 t=3240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30645.2s 25373 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30645.2s 25374 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30645.2s 25375 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30645.2s 25376 Running simulation until t = 3255.00 s, outputting every 15.00 s
30645.2s 25377 
30645.4s 25378 [PERIODIC:1000] BC_DISPATCHER [Call #13494000] current_bc_params: <class 'dict'>
30645.4s 25379 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30645.4s 25380 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30645.4s 25381 [PERIODIC:1000] BC_GPU [Call #13494000] About to launch kernel
30645.4s 25382 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30645.4s 25383 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30645.4s 25384 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30645.5s 25385 [WARNING] Automatic CFL correction applied (count: 3373400):
30645.5s 25386 Calculated CFL: 0.800 > Limit: 0.500
30645.5s 25387 Original dt: 3.399193e-01 s
30645.5s 25388 Corrected dt: 2.124495e-01 s
30645.5s 25389 Correction factor: 1.6x
30645.5s 25390 Max wave speed detected: 23.53 m/s
30645.5s 25391 [PROGRESS] Step 15350: t=3246.80/3255.00s (99.7%) | dt=0.2125s
30645.9s 25392 Stored output at t = 3255.0000 s (Step 15389)
30645.9s 25393 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3240.0/3255.0 [00:00<?, ?s/s][A
30645.9s 25394 [A
30645.9s 25395 
30645.9s 25396 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3255.0/3255.0 [00:00<00:00, 23.98s/s]
30645.9s 25397 Simulation finished at t = 3255.0000 s after 15389 steps.
30645.9s 25398 Total runtime: 0.63 seconds.
30645.9s 25399 [REWARD_MICROSCOPE] step=14897 t=3255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30645.9s 25400 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30645.9s 25401 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30645.9s 25402 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30645.9s 25403 Running simulation until t = 3270.00 s, outputting every 15.00 s
30645.9s 25404 
30646.0s 25405 [PROGRESS] Step 15400: t=3257.34/3270.00s (99.6%) | dt=0.2129s
30646.4s 25406 [WARNING] Automatic CFL correction applied (count: 3373500):
30646.4s 25407 Calculated CFL: 0.800 > Limit: 0.500
30646.4s 25408 Original dt: 3.411066e-01 s
30646.4s 25409 Corrected dt: 2.131916e-01 s
30646.4s 25410 Correction factor: 1.6x
30646.4s 25411 Max wave speed detected: 23.45 m/s
30646.4s 25412 [PROGRESS] Step 15450: t=3268.00/3270.00s (99.9%) | dt=0.2129s
30646.5s 25413 Stored output at t = 3270.0000 s (Step 15460)
30646.5s 25414 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3255.0/3270.0 [00:00<?, ?s/s][A
30646.5s 25415 [A
30646.5s 25416 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3270.0/3270.0 [00:00<00:00, 24.27s/s]
30646.5s 25417 
30646.5s 25418 Simulation finished at t = 3270.0000 s after 15460 steps.
30646.5s 25419 Total runtime: 0.62 seconds.
30646.5s 25420 [REWARD_MICROSCOPE] step=14898 t=3270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30646.5s 25421 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30646.5s 25422 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30646.5s 25423 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30646.5s 25424 Running simulation until t = 3285.00 s, outputting every 15.00 s
30646.5s 25425 
30646.8s 25426 [PROGRESS] Step 15500: t=3278.50/3285.00s (99.8%) | dt=0.2126s
30647.1s 25427 Stored output at t = 3285.0000 s (Step 15531)
30647.1s 25428 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3270.0/3285.0 [00:00<?, ?s/s][A
30647.1s 25429 [A
30647.1s 25430 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.35s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3285.0/3285.0 [00:00<00:00, 24.34s/s]
30647.1s 25431 
30647.1s 25432 Simulation finished at t = 3285.0000 s after 15531 steps.
30647.1s 25433 Total runtime: 0.62 seconds.
30647.1s 25434 [REWARD_MICROSCOPE] step=14899 t=3285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30647.1s 25435 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30647.1s 25436 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30647.1s 25437 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30647.1s 25438 Running simulation until t = 3300.00 s, outputting every 15.00 s
30647.1s 25439 
30647.2s 25440 [WARNING] Automatic CFL correction applied (count: 3373600):
30647.2s 25441 Calculated CFL: 0.800 > Limit: 0.500
30647.2s 25442 Original dt: 3.407212e-01 s
30647.2s 25443 Corrected dt: 2.129508e-01 s
30647.2s 25444 Correction factor: 1.6x
30647.2s 25445 Max wave speed detected: 23.48 m/s
30647.3s 25446 [PROGRESS] Step 15550: t=3289.05/3300.00s (99.7%) | dt=0.2130s
30647.6s 25447 [PERIODIC:1000] BC_DISPATCHER [Call #13495000] current_bc_params: <class 'dict'>
30647.6s 25448 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30647.6s 25449 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30647.6s 25450 [PERIODIC:1000] BC_GPU [Call #13495000] About to launch kernel
30647.6s 25451 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30647.6s 25452 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30647.6s 25453 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30647.7s 25454 [PROGRESS] Step 15600: t=3299.70/3300.00s (100.0%) | dt=0.2126s
30647.7s 25455 Stored output at t = 3300.0000 s (Step 15602)
30647.7s 25456 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3285.0/3300.0 [00:00<?, ?s/s][A
30647.7s 25457 [A
30647.7s 25458 
30647.7s 25459 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3300.0/3300.0 [00:00<00:00, 24.15s/s]
30647.7s 25460 Simulation finished at t = 3300.0000 s after 15602 steps.
30647.7s 25461 Total runtime: 0.62 seconds.
30647.7s 25462 [REWARD_MICROSCOPE] step=14900 t=3300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30647.7s 25463 [STEP  220] t= 3300.0s | phase=0 | reward=   0.01 | total_reward=    2.20
30647.7s 25464 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30647.7s 25465 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30647.7s 25466 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30647.7s 25467 Running simulation until t = 3315.00 s, outputting every 15.00 s
30647.7s 25468 
30648.1s 25469 [WARNING] Automatic CFL correction applied (count: 3373700):
30648.1s 25470 Calculated CFL: 0.800 > Limit: 0.500
30648.1s 25471 Original dt: 3.401477e-01 s
30648.1s 25472 Corrected dt: 2.125923e-01 s
30648.1s 25473 Correction factor: 1.6x
30648.1s 25474 Max wave speed detected: 23.52 m/s
30648.1s 25475 [PROGRESS] Step 15650: t=3310.20/3315.00s (99.9%) | dt=0.2126s
30648.3s 25476 Stored output at t = 3315.0000 s (Step 15673)
30648.3s 25477 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3300.0/3315.0 [00:00<?, ?s/s][A
30648.3s 25478 [A
30648.3s 25479 
30648.3s 25480 Simulation finished at t = 3315.0000 s after 15673 steps.
30648.3s 25481 Total runtime: 0.61 seconds.
30648.3s 25482 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3315.0/3315.0 [00:00<00:00, 24.49s/s]
30648.3s 25483 [QUEUE_DIAGNOSTIC] ===== Step 220 t=3315.0s =====
30648.3s 25484 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30648.3s 25485 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30648.3s 25486 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30648.3s 25487 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30648.3s 25488 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30648.3s 25489 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30648.3s 25490 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30648.3s 25491 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30648.3s 25492 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30648.3s 25493 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30648.3s 25494 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30648.3s 25495 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30648.3s 25496 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30648.3s 25497 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30648.3s 25498 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30648.3s 25499 [REWARD_MICROSCOPE] step=14901 t=3315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30648.3s 25500 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30648.3s 25501 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30648.3s 25502 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30648.3s 25503 Running simulation until t = 3330.00 s, outputting every 15.00 s
30648.3s 25504 
30648.6s 25505 [PROGRESS] Step 15700: t=3320.75/3330.00s (99.7%) | dt=0.2131s
30649.0s 25506 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3315.0/3330.0 [00:00<?, ?s/s][A
30649.0s 25507 [A
30649.0s 25508 Stored output at t = 3330.0000 s (Step 15744)
30649.0s 25509 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 24.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3330.0/3330.0 [00:00<00:00, 24.17s/s]
30649.0s 25510 
30649.0s 25511 Simulation finished at t = 3330.0000 s after 15744 steps.
30649.0s 25512 Total runtime: 0.62 seconds.
30649.0s 25513 [REWARD_MICROSCOPE] step=14902 t=3330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30649.0s 25514 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30649.0s 25515 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30649.0s 25516 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30649.0s 25517 Running simulation until t = 3345.00 s, outputting every 15.00 s
30649.0s 25518 
30649.0s 25519 [WARNING] Automatic CFL correction applied (count: 3373800):
30649.0s 25520 Calculated CFL: 0.800 > Limit: 0.500
30649.0s 25521 Original dt: 3.400436e-01 s
30649.0s 25522 Corrected dt: 2.125273e-01 s
30649.0s 25523 Correction factor: 1.6x
30649.0s 25524 Max wave speed detected: 23.53 m/s
30649.0s 25525 [PROGRESS] Step 15750: t=3331.27/3345.00s (99.6%) | dt=0.2124s
30649.5s 25526 [PROGRESS] Step 15800: t=3341.90/3345.00s (99.9%) | dt=0.2127s
30649.6s 25527 Stored output at t = 3345.0000 s (Step 15815)
30649.6s 25528 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3330.0/3345.0 [00:00<?, ?s/s][A
30649.6s 25529 [A
30649.6s 25530 
30649.6s 25531 Simulation finished at t = 3345.0000 s after 15815 steps.
30649.6s 25532 Total runtime: 0.62 seconds.
30649.6s 25533 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.41s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3345.0/3345.0 [00:00<00:00, 24.40s/s]
30649.6s 25534 [REWARD_MICROSCOPE] step=14903 t=3345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30649.6s 25535 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30649.6s 25536 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30649.6s 25537 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30649.6s 25538 Running simulation until t = 3360.00 s, outputting every 15.00 s
30649.6s 25539 
30649.8s 25540 [PERIODIC:1000] BC_DISPATCHER [Call #13496000] current_bc_params: <class 'dict'>
30649.8s 25541 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30649.8s 25542 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30649.8s 25543 [PERIODIC:1000] BC_GPU [Call #13496000] About to launch kernel
30649.8s 25544 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30649.8s 25545 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30649.8s 25546 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30649.8s 25547 [WARNING] Automatic CFL correction applied (count: 3373900):
30649.8s 25548 Calculated CFL: 0.800 > Limit: 0.500
30649.8s 25549 Original dt: 3.409462e-01 s
30649.8s 25550 Corrected dt: 2.130914e-01 s
30649.8s 25551 Correction factor: 1.6x
30649.8s 25552 Max wave speed detected: 23.46 m/s
30649.9s 25553 [PROGRESS] Step 15850: t=3352.45/3360.00s (99.8%) | dt=0.2131s
30650.2s 25554 Stored output at t = 3360.0000 s (Step 15886)
30650.2s 25555 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3345.0/3360.0 [00:00<?, ?s/s][A
30650.2s 25556 [A
30650.2s 25557 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3360.0/3360.0 [00:00<00:00, 23.85s/s]
30650.2s 25558 
30650.2s 25559 Simulation finished at t = 3360.0000 s after 15886 steps.
30650.2s 25560 Total runtime: 0.63 seconds.
30650.2s 25561 [REWARD_MICROSCOPE] step=14904 t=3360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30650.2s 25562 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30650.2s 25563 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30650.2s 25564 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30650.2s 25565 Running simulation until t = 3375.00 s, outputting every 15.00 s
30650.2s 25566 
30650.3s 25567 [PROGRESS] Step 15900: t=3362.97/3375.00s (99.6%) | dt=0.2123s
30650.7s 25568 [WARNING] Automatic CFL correction applied (count: 3374000):
30650.7s 25569 Calculated CFL: 0.800 > Limit: 0.500
30650.7s 25570 Original dt: 3.403711e-01 s
30650.7s 25571 Corrected dt: 2.127320e-01 s
30650.7s 25572 Correction factor: 1.6x
30650.7s 25573 Max wave speed detected: 23.50 m/s
30650.8s 25574 [PROGRESS] Step 15950: t=3373.60/3375.00s (100.0%) | dt=0.2128s
30650.9s 25575 Stored output at t = 3375.0000 s (Step 15957)
30650.9s 25576 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3360.0/3375.0 [00:00<?, ?s/s][A
30650.9s 25577 [A
30650.9s 25578 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 22.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3375.0/3375.0 [00:00<00:00, 22.75s/s]
30650.9s 25579 
30650.9s 25580 Simulation finished at t = 3375.0000 s after 15957 steps.
30650.9s 25581 Total runtime: 0.66 seconds.
30650.9s 25582 [REWARD_MICROSCOPE] step=14905 t=3375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30650.9s 25583 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30650.9s 25584 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30650.9s 25585 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30650.9s 25586 Running simulation until t = 3390.00 s, outputting every 15.00 s
30650.9s 25587 
30651.3s 25588 [PROGRESS] Step 16000: t=3384.16/3390.00s (99.8%) | dt=0.2132s
30651.5s 25589 Stored output at t = 3390.0000 s (Step 16028)
30651.5s 25590 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3375.0/3390.0 [00:00<?, ?s/s][A
30651.5s 25591 [A
30651.5s 25592 
30651.5s 25593 Simulation finished at t = 3390.0000 s after 16028 steps.
30651.5s 25594 Total runtime: 0.62 seconds.
30651.5s 25595 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3390.0/3390.0 [00:00<00:00, 24.33s/s]
30651.5s 25596 [REWARD_MICROSCOPE] step=14906 t=3390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30651.5s 25597 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30651.5s 25598 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30651.5s 25599 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30651.5s 25600 Running simulation until t = 3405.00 s, outputting every 15.00 s
30651.5s 25601 
30651.6s 25602 [WARNING] Automatic CFL correction applied (count: 3374100):
30651.6s 25603 Calculated CFL: 0.800 > Limit: 0.500
30651.6s 25604 Original dt: 3.397675e-01 s
30651.6s 25605 Corrected dt: 2.123547e-01 s
30651.6s 25606 Correction factor: 1.6x
30651.6s 25607 Max wave speed detected: 23.55 m/s
30651.7s 25608 [PROGRESS] Step 16050: t=3394.67/3405.00s (99.7%) | dt=0.2124s
30652.0s 25609 [PERIODIC:1000] BC_DISPATCHER [Call #13497000] current_bc_params: <class 'dict'>
30652.0s 25610 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30652.0s 25611 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30652.0s 25612 [PERIODIC:1000] BC_GPU [Call #13497000] About to launch kernel
30652.0s 25613 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30652.0s 25614 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30652.0s 25615 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30652.1s 25616 Stored output at t = 3405.0000 s (Step 16099)
30652.1s 25617 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3390.0/3405.0 [00:00<?, ?s/s][A
30652.1s 25618 [A
30652.1s 25619 
30652.1s 25620 Simulation finished at t = 3405.0000 s after 16099 steps.
30652.1s 25621 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3405.0/3405.0 [00:00<00:00, 24.37s/s]
30652.1s 25622 Total runtime: 0.62 seconds.
30652.1s 25623 [REWARD_MICROSCOPE] step=14907 t=3405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30652.1s 25624 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30652.1s 25625 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30652.1s 25626 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30652.1s 25627 Running simulation until t = 3420.00 s, outputting every 15.00 s
30652.1s 25628 
30652.1s 25629 [PROGRESS] Step 16100: t=3405.21/3420.00s (99.6%) | dt=0.2128s
30652.5s 25630 [WARNING] Automatic CFL correction applied (count: 3374200):
30652.5s 25631 Calculated CFL: 0.800 > Limit: 0.500
30652.5s 25632 Original dt: 3.411605e-01 s
30652.5s 25633 Corrected dt: 2.132253e-01 s
30652.5s 25634 Correction factor: 1.6x
30652.5s 25635 Max wave speed detected: 23.45 m/s
30652.6s 25636 [PROGRESS] Step 16150: t=3415.87/3420.00s (99.9%) | dt=0.2133s
30652.7s 25637 Stored output at t = 3420.0000 s (Step 16170)
30652.7s 25638 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3405.0/3420.0 [00:00<?, ?s/s][A
30652.7s 25639 [A
30652.7s 25640 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3420.0/3420.0 [00:00<00:00, 24.29s/s]
30652.7s 25641 
30652.7s 25642 Simulation finished at t = 3420.0000 s after 16170 steps.
30652.7s 25643 Total runtime: 0.62 seconds.
30652.7s 25644 [REWARD_MICROSCOPE] step=14908 t=3420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30652.7s 25645 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30652.7s 25646 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30652.7s 25647 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30652.7s 25648 Running simulation until t = 3435.00 s, outputting every 15.00 s
30652.7s 25649 
30653.0s 25650 [PROGRESS] Step 16200: t=3426.37/3435.00s (99.7%) | dt=0.2125s
30653.4s 25651 Stored output at t = 3435.0000 s (Step 16241)
30653.4s 25652 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3420.0/3435.0 [00:00<?, ?s/s][A
30653.4s 25653 [A
30653.4s 25654 
30653.4s 25655 Simulation finished at t = 3435.0000 s after 16241 steps.
30653.4s 25656 Total runtime: 0.62 seconds.
30653.4s 25657 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3435.0/3435.0 [00:00<00:00, 24.35s/s]
30653.4s 25658 [REWARD_MICROSCOPE] step=14909 t=3435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30653.4s 25659 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30653.4s 25660 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30653.4s 25661 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30653.4s 25662 Running simulation until t = 3450.00 s, outputting every 15.00 s
30653.4s 25663 
30653.4s 25664 [WARNING] Automatic CFL correction applied (count: 3374300):
30653.4s 25665 Calculated CFL: 0.800 > Limit: 0.500
30653.4s 25666 Original dt: 3.405828e-01 s
30653.4s 25667 Corrected dt: 2.128643e-01 s
30653.4s 25668 Correction factor: 1.6x
30653.4s 25669 Max wave speed detected: 23.49 m/s
30653.4s 25670 [PROGRESS] Step 16250: t=3436.92/3450.00s (99.6%) | dt=0.2129s
30653.9s 25671 [PROGRESS] Step 16300: t=3447.57/3450.00s (99.9%) | dt=0.2130s
30654.0s 25672 Stored output at t = 3450.0000 s (Step 16312)
30654.0s 25673 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3435.0/3450.0 [00:00<?, ?s/s][A
30654.0s 25674 [A
30654.0s 25675 
30654.0s 25676 Simulation finished at t = 3450.0000 s after 16312 steps.
30654.0s 25677 Total runtime: 0.62 seconds.
30654.0s 25678 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3450.0/3450.0 [00:00<00:00, 24.03s/s]
30654.0s 25679 [REWARD_MICROSCOPE] step=14910 t=3450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30654.0s 25680 [STEP  230] t= 3450.0s | phase=0 | reward=   0.01 | total_reward=    2.30
30654.0s 25681 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30654.0s 25682 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30654.0s 25683 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30654.0s 25684 Running simulation until t = 3465.00 s, outputting every 15.00 s
30654.0s 25685 
30654.2s 25686 [PERIODIC:1000] BC_DISPATCHER [Call #13498000] current_bc_params: <class 'dict'>
30654.2s 25687 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30654.2s 25688 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30654.2s 25689 [PERIODIC:1000] BC_GPU [Call #13498000] About to launch kernel
30654.2s 25690 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30654.2s 25691 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30654.2s 25692 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30654.3s 25693 [WARNING] Automatic CFL correction applied (count: 3374400):
30654.3s 25694 Calculated CFL: 0.800 > Limit: 0.500
30654.3s 25695 Original dt: 3.400085e-01 s
30654.3s 25696 Corrected dt: 2.125053e-01 s
30654.3s 25697 Correction factor: 1.6x
30654.3s 25698 Max wave speed detected: 23.53 m/s
30654.3s 25699 [PROGRESS] Step 16350: t=3458.07/3465.00s (99.8%) | dt=0.2125s
30654.6s 25700 Stored output at t = 3465.0000 s (Step 16383)
30654.6s 25701 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3450.0/3465.0 [00:00<?, ?s/s][A
30654.6s 25702 [A
30654.6s 25703 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3465.0/3465.0 [00:00<00:00, 24.42s/s]
30654.6s 25704 
30654.6s 25705 Simulation finished at t = 3465.0000 s after 16383 steps.
30654.6s 25706 Total runtime: 0.61 seconds.
30654.6s 25707 [QUEUE_DIAGNOSTIC] ===== Step 230 t=3465.0s =====
30654.6s 25708 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30654.6s 25709 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30654.6s 25710 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30654.6s 25711 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30654.6s 25712 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30654.6s 25713 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30654.6s 25714 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30654.6s 25715 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30654.6s 25716 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30654.6s 25717 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30654.6s 25718 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30654.6s 25719 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30654.6s 25720 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30654.6s 25721 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30654.6s 25722 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30654.6s 25723 [REWARD_MICROSCOPE] step=14911 t=3465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30654.6s 25724 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30654.6s 25725 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30654.6s 25726 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30654.6s 25727 Running simulation until t = 3480.00 s, outputting every 15.00 s
30654.6s 25728 
30654.8s 25729 [PROGRESS] Step 16400: t=3468.62/3480.00s (99.7%) | dt=0.2130s
30655.1s 25730 [WARNING] Automatic CFL correction applied (count: 3374500):
30655.1s 25731 Calculated CFL: 0.800 > Limit: 0.500
30655.1s 25732 Original dt: 3.406020e-01 s
30655.1s 25733 Corrected dt: 2.128763e-01 s
30655.1s 25734 Correction factor: 1.6x
30655.1s 25735 Max wave speed detected: 23.49 m/s
30655.2s 25736 [PROGRESS] Step 16450: t=3479.27/3480.00s (100.0%) | dt=0.2127s
30655.2s 25737 Stored output at t = 3480.0000 s (Step 16454)
30655.2s 25738 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3465.0/3480.0 [00:00<?, ?s/s][A
30655.2s 25739 [A
30655.2s 25740 
30655.2s 25741 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3480.0/3480.0 [00:00<00:00, 24.28s/s]
30655.2s 25742 Simulation finished at t = 3480.0000 s after 16454 steps.
30655.2s 25743 Total runtime: 0.62 seconds.
30655.2s 25744 [REWARD_MICROSCOPE] step=14912 t=3480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30655.2s 25745 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30655.2s 25746 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30655.2s 25747 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30655.2s 25748 Running simulation until t = 3495.00 s, outputting every 15.00 s
30655.2s 25749 
30655.6s 25750 [PROGRESS] Step 16500: t=3489.77/3495.00s (99.9%) | dt=0.2126s
30655.8s 25751 Stored output at t = 3495.0000 s (Step 16525)
30655.8s 25752 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3480.0/3495.0 [00:00<?, ?s/s][A
30655.8s 25753 [A
30655.8s 25754 
30655.8s 25755 Simulation finished at t = 3495.0000 s after 16525 steps.
30655.8s 25756 Total runtime: 0.61 seconds.
30655.8s 25757 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.46s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3495.0/3495.0 [00:00<00:00, 24.45s/s]
30655.8s 25758 [REWARD_MICROSCOPE] step=14913 t=3495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30655.8s 25759 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30655.8s 25760 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30655.8s 25761 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30655.8s 25762 Running simulation until t = 3510.00 s, outputting every 15.00 s
30655.8s 25763 
30656.0s 25764 [WARNING] Automatic CFL correction applied (count: 3374600):
30656.0s 25765 Calculated CFL: 0.800 > Limit: 0.500
30656.0s 25766 Original dt: 3.408050e-01 s
30656.0s 25767 Corrected dt: 2.130031e-01 s
30656.0s 25768 Correction factor: 1.6x
30656.0s 25769 Max wave speed detected: 23.47 m/s
30656.1s 25770 [PROGRESS] Step 16550: t=3500.32/3510.00s (99.7%) | dt=0.2130s
30656.4s 25771 [PERIODIC:1000] BC_DISPATCHER [Call #13499000] current_bc_params: <class 'dict'>
30656.4s 25772 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30656.4s 25773 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30656.4s 25774 [PERIODIC:1000] BC_GPU [Call #13499000] About to launch kernel
30656.4s 25775 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30656.4s 25776 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30656.4s 25777 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30656.5s 25778 Stored output at t = 3510.0000 s (Step 16596)
30656.5s 25779 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3495.0/3510.0 [00:00<?, ?s/s][A
30656.5s 25780 [A
30656.5s 25781 
30656.5s 25782 Simulation finished at t = 3510.0000 s after 16596 steps.
30656.5s 25783 Total runtime: 0.61 seconds.
30656.5s 25784 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3510.0/3510.0 [00:00<00:00, 24.64s/s]
30656.5s 25785 [REWARD_MICROSCOPE] step=14914 t=3510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30656.5s 25786 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30656.5s 25787 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30656.5s 25788 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30656.5s 25789 Running simulation until t = 3525.00 s, outputting every 15.00 s
30656.5s 25790 
30656.5s 25791 [PROGRESS] Step 16600: t=3510.85/3525.00s (99.6%) | dt=0.2124s
30656.9s 25792 [WARNING] Automatic CFL correction applied (count: 3374700):
30656.9s 25793 Calculated CFL: 0.800 > Limit: 0.500
30656.9s 25794 Original dt: 3.402313e-01 s
30656.9s 25795 Corrected dt: 2.126446e-01 s
30656.9s 25796 Correction factor: 1.6x
30656.9s 25797 Max wave speed detected: 23.51 m/s
30656.9s 25798 [PROGRESS] Step 16650: t=3521.47/3525.00s (99.9%) | dt=0.2127s
30657.1s 25799 Stored output at t = 3525.0000 s (Step 16667)
30657.1s 25800 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3510.0/3525.0 [00:00<?, ?s/s][A
30657.1s 25801 [A
30657.1s 25802 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 23.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3525.0/3525.0 [00:00<00:00, 23.53s/s]
30657.1s 25803 
30657.1s 25804 Simulation finished at t = 3525.0000 s after 16667 steps.
30657.1s 25805 Total runtime: 0.64 seconds.
30657.1s 25806 [REWARD_MICROSCOPE] step=14915 t=3525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30657.1s 25807 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30657.1s 25808 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30657.1s 25809 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30657.1s 25810 Running simulation until t = 3540.00 s, outputting every 15.00 s
30657.1s 25811 
30657.4s 25812 [PROGRESS] Step 16700: t=3532.03/3540.00s (99.8%) | dt=0.2131s
30657.7s 25813 Stored output at t = 3540.0000 s (Step 16738)
30657.7s 25814 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3525.0/3540.0 [00:00<?, ?s/s][A
30657.7s 25815 [A
30657.7s 25816 
30657.7s 25817 Simulation finished at t = 3540.0000 s after 16738 steps.
30657.7s 25818 Total runtime: 0.62 seconds.
30657.7s 25819 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3540.0/3540.0 [00:00<00:00, 24.06s/s]
30657.7s 25820 [REWARD_MICROSCOPE] step=14916 t=3540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30657.7s 25821 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30657.7s 25822 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30657.7s 25823 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30657.7s 25824 Running simulation until t = 3555.00 s, outputting every 15.00 s
30657.7s 25825 
30657.8s 25826 [WARNING] Automatic CFL correction applied (count: 3374800):
30657.8s 25827 Calculated CFL: 0.800 > Limit: 0.500
30657.8s 25828 Original dt: 3.398030e-01 s
30657.8s 25829 Corrected dt: 2.123769e-01 s
30657.8s 25830 Correction factor: 1.6x
30657.8s 25831 Max wave speed detected: 23.54 m/s
30657.8s 25832 [PROGRESS] Step 16750: t=3542.55/3555.00s (99.6%) | dt=0.2123s
30658.3s 25833 [PROGRESS] Step 16800: t=3553.18/3555.00s (99.9%) | dt=0.2128s
30658.4s 25834 Stored output at t = 3555.0000 s (Step 16809)
30658.4s 25835 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3540.0/3555.0 [00:00<?, ?s/s][A
30658.4s 25836 [A
30658.4s 25837 
30658.4s 25838 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 23.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3555.0/3555.0 [00:00<00:00, 23.70s/s]
30658.4s 25839 Simulation finished at t = 3555.0000 s after 16809 steps.
30658.4s 25840 Total runtime: 0.63 seconds.
30658.4s 25841 [REWARD_MICROSCOPE] step=14917 t=3555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30658.4s 25842 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30658.4s 25843 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30658.4s 25844 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30658.4s 25845 Running simulation until t = 3570.00 s, outputting every 15.00 s
30658.4s 25846 
30658.6s 25847 [PERIODIC:1000] BC_DISPATCHER [Call #13500000] current_bc_params: <class 'dict'>
30658.6s 25848 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30658.6s 25849 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30658.6s 25850 [PERIODIC:1000] BC_GPU [Call #13500000] About to launch kernel
30658.6s 25851 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30658.6s 25852 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30658.6s 25853 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30658.7s 25854 [WARNING] Automatic CFL correction applied (count: 3374900):
30658.7s 25855 Calculated CFL: 0.800 > Limit: 0.500
30658.7s 25856 Original dt: 3.410260e-01 s
30658.7s 25857 Corrected dt: 2.131412e-01 s
30658.7s 25858 Correction factor: 1.6x
30658.7s 25859 Max wave speed detected: 23.46 m/s
30658.7s 25860 [PROGRESS] Step 16850: t=3563.73/3570.00s (99.8%) | dt=0.2132s
30659.0s 25861 Stored output at t = 3570.0000 s (Step 16880)
30659.0s 25862 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3555.0/3570.0 [00:00<?, ?s/s][A
30659.0s 25863 [A
30659.0s 25864 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3570.0/3570.0 [00:00<00:00, 24.08s/s]
30659.0s 25865 
30659.0s 25866 Simulation finished at t = 3570.0000 s after 16880 steps.
30659.0s 25867 Total runtime: 0.62 seconds.
30659.0s 25868 [REWARD_MICROSCOPE] step=14918 t=3570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30659.0s 25869 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30659.0s 25870 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30659.0s 25871 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30659.0s 25872 Running simulation until t = 3585.00 s, outputting every 15.00 s
30659.0s 25873 
30659.2s 25874 [PROGRESS] Step 16900: t=3574.25/3585.00s (99.7%) | dt=0.2124s
30659.6s 25875 [WARNING] Automatic CFL correction applied (count: 3375000):
30659.6s 25876 Calculated CFL: 0.800 > Limit: 0.500
30659.6s 25877 Original dt: 3.404547e-01 s
30659.6s 25878 Corrected dt: 2.127842e-01 s
30659.6s 25879 Correction factor: 1.6x
30659.6s 25880 Max wave speed detected: 23.50 m/s
30659.6s 25881 [PROGRESS] Step 16950: t=3584.88/3585.00s (100.0%) | dt=0.2128s
30659.6s 25882 Stored output at t = 3585.0000 s (Step 16951)
30659.6s 25883 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3570.0/3585.0 [00:00<?, ?s/s][A
30659.6s 25884 [A
30659.6s 25885 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3585.0/3585.0 [00:00<00:00, 23.84s/s]
30659.6s 25886 
30659.6s 25887 Simulation finished at t = 3585.0000 s after 16951 steps.
30659.6s 25888 Total runtime: 0.63 seconds.
30659.6s 25889 [REWARD_MICROSCOPE] step=14919 t=3585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30659.6s 25890 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30659.6s 25891 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30659.6s 25892 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30659.6s 25893 Running simulation until t = 3600.00 s, outputting every 15.00 s
30659.6s 25894 
30660.1s 25895 [PROGRESS] Step 17000: t=3595.44/3600.00s (99.9%) | dt=0.2133s
30660.3s 25896 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 3585.0/3600.0 [00:00<?, ?s/s][A
30660.3s 25897 [A
30660.3s 25898 Stored output at t = 3600.0000 s (Step 17022)
30660.3s 25899 
30660.3s 25900 Simulation finished at t = 3600.0000 s after 17022 steps.
30660.3s 25901 Total runtime: 0.65 seconds.
30660.3s 25902 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 23.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3600.0/3600.0 [00:00<00:00, 23.16s/s]
30660.3s 25903 [REWARD_MICROSCOPE] step=14920 t=3600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30660.3s 25904 [STEP  240] t= 3600.0s | phase=0 | reward=   0.01 | total_reward=    2.40
30660.3s 25905 DEBUG: Truncation - runner.t=3600.0, episode_max_time=3600.0
30660.3s 25906 
30660.3s 25907 ================================================================================
30660.3s 25908 [EPISODE END] Steps: 240 | Duration: 3600.0s | Total Reward: 2.40 | Avg Reward/Step: 0.010
30660.3s 25909 ================================================================================
30660.3s 25910 
30660.3s 25911 Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/adaptive_speed_control.yml
30660.3s 25912 Using device: gpu
30660.3s 25913 DEBUG PARAMS: Reading K_m_kmh = 10.0
30660.3s 25914 DEBUG PARAMS: Reading K_c_kmh = 15.0
30660.3s 25915 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
30660.3s 25916 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
30660.3s 25917 [NETWORK V0 OVERRIDE] Loaded from segment 'zone_1':
30660.3s 25918 V0_m = 13.333 m/s (48.0 km/h)
30660.3s 25919 V0_c = 11.667 m/s (42.0 km/h)
30660.3s 25920 Parameters loaded for scenario: adaptive_speed_control
30660.3s 25921 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
30660.3s 25922 Loading road quality type: uniform
30660.3s 25923 Uniform road quality value: 1
30660.3s 25924 Road quality loaded.
30660.3s 25925 Initial state created.
30660.3s 25926 Transferring initial state and road quality to GPU...
30660.3s 25927 GPU data transfer complete.
30660.3s 25928 DEBUG BC Init: Calculated initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30660.3s 25929 Initial boundary conditions applied.
30660.3s 25930 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30660.3s 25931 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30660.3s 25932 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30660.3s 25933 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30660.3s 25934 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30660.3s 25935 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30660.3s 25936 Running simulation until t = 15.00 s, outputting every 15.00 s
30660.3s 25937 
30660.5s 25938 [WARNING] Automatic CFL correction applied (count: 3375100):
30660.5s 25939 Calculated CFL: 0.800 > Limit: 0.500
30660.5s 25940 Original dt: 4.142387e-01 s
30660.5s 25941 Corrected dt: 2.588992e-01 s
30660.5s 25942 Correction factor: 1.6x
30660.5s 25943 Max wave speed detected: 19.31 m/s
30660.7s 25944 [PROGRESS] Step 50: t=13.88/15.00s (92.6%) | dt=0.2304s
30660.8s 25945 Stored output at t = 15.0000 s (Step 55)
30660.8s 25946 Running Simulation:   0%|          | 0.0/15.0 [00:00<?, ?s/s][A
30660.8s 25947 [A
30660.8s 25948 
30660.8s 25949 Simulation finished at t = 15.0000 s after 55 steps.
30660.8s 25950 Total runtime: 0.50 seconds.
30660.8s 25951 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 29.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0/15.0 [00:00<00:00, 29.78s/s]
30660.8s 25952 [QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====
30660.8s 25953 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30660.8s 25954 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01592309 1.         0.04031418 1.        ] (rho_m, v_m, rho_c, v_c)
30660.8s 25955 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30660.8s 25956 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30660.8s 25957 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30660.8s 25958 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00477693 0.00461974 0.0045987  0.00461509 0.00464349 0.00467782]
30660.8s 25959 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00604713 0.0058468  0.0058367  0.00589007 0.00596703 0.00605711]
30660.8s 25960 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30660.8s 25961 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30660.8s 25962 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30660.8s 25963 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30660.8s 25964 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30660.8s 25965 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30660.8s 25966 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30660.8s 25967 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30660.8s 25968 [REWARD_MICROSCOPE] step=14921 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30660.8s 25969 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30660.8s 25970 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30660.8s 25971 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30660.8s 25972 Running simulation until t = 30.00 s, outputting every 15.00 s
30660.8s 25973 
30660.9s 25974 [PERIODIC:1000] BC_DISPATCHER [Call #13501000] current_bc_params: <class 'dict'>
30660.9s 25975 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30660.9s 25976 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30660.9s 25977 [PERIODIC:1000] BC_GPU [Call #13501000] About to launch kernel
30660.9s 25978 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30660.9s 25979 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30660.9s 25980 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30661.2s 25981 [PROGRESS] Step 100: t=24.93/30.00s (83.1%) | dt=0.2150s
30661.4s 25982 [WARNING] Automatic CFL correction applied (count: 3375200):
30661.4s 25983 Calculated CFL: 0.800 > Limit: 0.500
30661.4s 25984 Original dt: 3.408497e-01 s
30661.4s 25985 Corrected dt: 2.130311e-01 s
30661.4s 25986 Correction factor: 1.6x
30661.4s 25987 Max wave speed detected: 23.47 m/s
30661.4s 25988 Stored output at t = 30.0000 s (Step 124)
30661.4s 25989 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.0/30.0 [00:00<?, ?s/s][A
30661.4s 25990 [A
30661.4s 25991 
30661.4s 25992 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0/30.0 [00:00<00:00, 23.98s/s]
30661.4s 25993 Simulation finished at t = 30.0000 s after 124 steps.
30661.4s 25994 Total runtime: 0.63 seconds.
30661.4s 25995 [REWARD_MICROSCOPE] step=14922 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30661.4s 25996 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30661.4s 25997 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30661.4s 25998 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30661.4s 25999 Running simulation until t = 45.00 s, outputting every 15.00 s
30661.4s 26000 
30661.6s 26001 [PROGRESS] Step 150: t=35.53/45.00s (79.0%) | dt=0.2127s
30662.1s 26002 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30.0/45.0 [00:00<?, ?s/s][A
30662.1s 26003 [A
30662.1s 26004 Stored output at t = 45.0000 s (Step 195)
30662.1s 26005 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45.0/45.0 [00:00<00:00, 23.77s/s]
30662.1s 26006 
30662.1s 26007 Simulation finished at t = 45.0000 s after 195 steps.
30662.1s 26008 Total runtime: 0.63 seconds.
30662.1s 26009 [REWARD_MICROSCOPE] step=14923 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30662.1s 26010 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30662.1s 26011 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30662.1s 26012 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30662.1s 26013 Running simulation until t = 60.00 s, outputting every 15.00 s
30662.1s 26014 
30662.1s 26015 [PROGRESS] Step 200: t=46.07/60.00s (76.8%) | dt=0.2134s
30662.3s 26016 [WARNING] Automatic CFL correction applied (count: 3375300):
30662.3s 26017 Calculated CFL: 0.800 > Limit: 0.500
30662.3s 26018 Original dt: 3.418400e-01 s
30662.3s 26019 Corrected dt: 2.136500e-01 s
30662.3s 26020 Correction factor: 1.6x
30662.3s 26021 Max wave speed detected: 23.40 m/s
30662.5s 26022 [PROGRESS] Step 250: t=56.75/60.00s (94.6%) | dt=0.2132s
30662.7s 26023 Stored output at t = 60.0000 s (Step 266)
30662.7s 26024 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 45.0/60.0 [00:00<?, ?s/s][A
30662.7s 26025 [A
30662.7s 26026 
30662.7s 26027 Simulation finished at t = 60.0000 s after 266 steps.
30662.7s 26028 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:00<00:00, 23.73s/s]
30662.7s 26029 Total runtime: 0.63 seconds.
30662.7s 26030 [REWARD_MICROSCOPE] step=14924 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30662.7s 26031 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30662.7s 26032 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30662.7s 26033 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30662.7s 26034 Running simulation until t = 75.00 s, outputting every 15.00 s
30662.7s 26035 
30663.0s 26036 [PROGRESS] Step 300: t=67.22/75.00s (89.6%) | dt=0.2125s
30663.1s 26037 [PERIODIC:1000] BC_DISPATCHER [Call #13502000] current_bc_params: <class 'dict'>
30663.1s 26038 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30663.1s 26039 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30663.1s 26040 [PERIODIC:1000] BC_GPU [Call #13502000] About to launch kernel
30663.1s 26041 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30663.1s 26042 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30663.1s 26043 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30663.2s 26044 [WARNING] Automatic CFL correction applied (count: 3375400):
30663.2s 26045 Calculated CFL: 0.800 > Limit: 0.500
30663.2s 26046 Original dt: 3.403574e-01 s
30663.2s 26047 Corrected dt: 2.127234e-01 s
30663.2s 26048 Correction factor: 1.6x
30663.2s 26049 Max wave speed detected: 23.50 m/s
30663.3s 26050 Stored output at t = 75.0000 s (Step 337)
30663.3s 26051 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60.0/75.0 [00:00<?, ?s/s][A
30663.3s 26052 [A
30663.3s 26053 
30663.3s 26054 Simulation finished at t = 75.0000 s after 337 steps.
30663.3s 26055 Total runtime: 0.63 seconds.
30663.3s 26056 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 23.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 75.0/75.0 [00:00<00:00, 23.86s/s]
30663.3s 26057 [REWARD_MICROSCOPE] step=14925 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30663.3s 26058 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30663.3s 26059 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30663.3s 26060 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30663.3s 26061 Running simulation until t = 90.00 s, outputting every 15.00 s
30663.3s 26062 
30663.4s 26063 [PROGRESS] Step 350: t=77.77/90.00s (86.4%) | dt=0.2130s
30663.9s 26064 [PROGRESS] Step 400: t=88.42/90.00s (98.2%) | dt=0.2128s
30664.0s 26065 Stored output at t = 90.0000 s (Step 408)
30664.0s 26066 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75.0/90.0 [00:00<?, ?s/s][A
30664.0s 26067 [A
30664.0s 26068 
30664.0s 26069 Simulation finished at t = 90.0000 s after 408 steps.
30664.0s 26070 Total runtime: 0.63 seconds.
30664.0s 26071 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90.0/90.0 [00:00<00:00, 23.81s/s]
30664.0s 26072 [REWARD_MICROSCOPE] step=14926 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30664.0s 26073 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30664.0s 26074 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30664.0s 26075 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30664.0s 26076 Running simulation until t = 105.00 s, outputting every 15.00 s
30664.0s 26077 
30664.1s 26078 [WARNING] Automatic CFL correction applied (count: 3375500):
30664.1s 26079 Calculated CFL: 0.800 > Limit: 0.500
30664.1s 26080 Original dt: 3.397402e-01 s
30664.1s 26081 Corrected dt: 2.123376e-01 s
30664.1s 26082 Correction factor: 1.6x
30664.1s 26083 Max wave speed detected: 23.55 m/s
30664.3s 26084 [PROGRESS] Step 450: t=98.92/105.00s (94.2%) | dt=0.2126s
30664.6s 26085 Stored output at t = 105.0000 s (Step 479)
30664.6s 26086 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 90.0/105.0 [00:00<?, ?s/s][A
30664.6s 26087 [A
30664.6s 26088 
30664.6s 26089 Simulation finished at t = 105.0000 s after 479 steps.
30664.6s 26090 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.80s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 105.0/105.0 [00:00<00:00, 23.79s/s]
30664.6s 26091 Total runtime: 0.63 seconds.
30664.6s 26092 [REWARD_MICROSCOPE] step=14927 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30664.6s 26093 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30664.6s 26094 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30664.6s 26095 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30664.6s 26096 Running simulation until t = 120.00 s, outputting every 15.00 s
30664.6s 26097 
30664.8s 26098 [PROGRESS] Step 500: t=109.47/120.00s (91.2%) | dt=0.2130s
30665.0s 26099 [WARNING] Automatic CFL correction applied (count: 3375600):
30665.0s 26100 Calculated CFL: 0.800 > Limit: 0.500
30665.0s 26101 Original dt: 3.411345e-01 s
30665.0s 26102 Corrected dt: 2.132091e-01 s
30665.0s 26103 Correction factor: 1.6x
30665.0s 26104 Max wave speed detected: 23.45 m/s
30665.3s 26105 [PROGRESS] Step 550: t=120.00/120.00s (100.0%) | dt=0.0883s
30665.3s 26106 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105.0/120.0 [00:00<?, ?s/s][A
30665.3s 26107 [A
30665.3s 26108 Stored output at t = 120.0000 s (Step 550)
30665.3s 26109 
30665.3s 26110 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 22.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:00<00:00, 22.37s/s]
30665.3s 26111 Simulation finished at t = 120.0000 s after 550 steps.
30665.3s 26112 Total runtime: 0.67 seconds.
30665.3s 26113 [REWARD_MICROSCOPE] step=14928 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30665.3s 26114 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30665.3s 26115 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30665.3s 26116 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30665.3s 26117 Running simulation until t = 135.00 s, outputting every 15.00 s
30665.3s 26118 
30665.4s 26119 [PERIODIC:1000] BC_DISPATCHER [Call #13503000] current_bc_params: <class 'dict'>
30665.4s 26120 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30665.4s 26121 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30665.4s 26122 [PERIODIC:1000] BC_GPU [Call #13503000] About to launch kernel
30665.4s 26123 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30665.4s 26124 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30665.4s 26125 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30665.7s 26126 [PROGRESS] Step 600: t=130.62/135.00s (96.8%) | dt=0.2127s
30665.9s 26127 Stored output at t = 135.0000 s (Step 621)
30665.9s 26128 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 120.0/135.0 [00:00<?, ?s/s][A
30665.9s 26129 [A
30665.9s 26130 
30665.9s 26131 Simulation finished at t = 135.0000 s after 621 steps.
30665.9s 26132 Total runtime: 0.63 seconds.
30665.9s 26133 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 23.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 135.0/135.0 [00:00<00:00, 23.70s/s]
30665.9s 26134 [REWARD_MICROSCOPE] step=14929 t=135.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30665.9s 26135 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30665.9s 26136 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30665.9s 26137 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30665.9s 26138 Running simulation until t = 150.00 s, outputting every 15.00 s
30665.9s 26139 
30665.9s 26140 [WARNING] Automatic CFL correction applied (count: 3375700):
30665.9s 26141 Calculated CFL: 0.800 > Limit: 0.500
30665.9s 26142 Original dt: 3.405553e-01 s
30665.9s 26143 Corrected dt: 2.128471e-01 s
30665.9s 26144 Correction factor: 1.6x
30665.9s 26145 Max wave speed detected: 23.49 m/s
30666.1s 26146 [PROGRESS] Step 650: t=141.18/150.00s (94.1%) | dt=0.2131s
30666.5s 26147 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135.0/150.0 [00:00<?, ?s/s][A
30666.5s 26148 [A
30666.5s 26149 Stored output at t = 150.0000 s (Step 692)
30666.5s 26150 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.11s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150.0/150.0 [00:00<00:00, 24.11s/s]
30666.5s 26151 
30666.5s 26152 Simulation finished at t = 150.0000 s after 692 steps.
30666.5s 26153 Total runtime: 0.62 seconds.
30666.5s 26154 [REWARD_MICROSCOPE] step=14930 t=150.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30666.5s 26155 [STEP   10] t=  150.0s | phase=0 | reward=   0.01 | total_reward=    0.10
30666.5s 26156 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30666.5s 26157 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30666.5s 26158 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30666.5s 26159 Running simulation until t = 165.00 s, outputting every 15.00 s
30666.5s 26160 
30666.6s 26161 [PROGRESS] Step 700: t=151.70/165.00s (91.9%) | dt=0.2124s
30666.8s 26162 [WARNING] Automatic CFL correction applied (count: 3375800):
30666.8s 26163 Calculated CFL: 0.800 > Limit: 0.500
30666.8s 26164 Original dt: 3.399790e-01 s
30666.8s 26165 Corrected dt: 2.124869e-01 s
30666.8s 26166 Correction factor: 1.6x
30666.8s 26167 Max wave speed detected: 23.53 m/s
30667.0s 26168 [PROGRESS] Step 750: t=162.32/165.00s (98.4%) | dt=0.2127s
30667.1s 26169 Stored output at t = 165.0000 s (Step 763)
30667.1s 26170 Running Simulation:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150.0/165.0 [00:00<?, ?s/s][A
30667.1s 26171 [A
30667.1s 26172 
30667.1s 26173 Simulation finished at t = 165.0000 s after 763 steps.
30667.1s 26174 Total runtime: 0.62 seconds.
30667.1s 26175 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165.0/165.0 [00:00<00:00, 24.18s/s]
30667.1s 26176 [QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====
30667.1s 26177 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30667.1s 26178 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30667.1s 26179 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30667.1s 26180 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30667.1s 26181 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30667.1s 26182 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30667.1s 26183 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30667.1s 26184 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30667.1s 26185 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30667.1s 26186 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30667.1s 26187 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30667.1s 26188 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30667.1s 26189 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30667.1s 26190 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30667.1s 26191 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30667.1s 26192 [REWARD_MICROSCOPE] step=14931 t=165.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30667.1s 26193 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30667.1s 26194 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30667.1s 26195 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30667.1s 26196 Running simulation until t = 180.00 s, outputting every 15.00 s
30667.1s 26197 
30667.5s 26198 [PROGRESS] Step 800: t=172.88/180.00s (96.0%) | dt=0.2131s
30667.6s 26199 [PERIODIC:1000] BC_DISPATCHER [Call #13504000] current_bc_params: <class 'dict'>
30667.6s 26200 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30667.6s 26201 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30667.6s 26202 [PERIODIC:1000] BC_GPU [Call #13504000] About to launch kernel
30667.6s 26203 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30667.6s 26204 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30667.6s 26205 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30667.7s 26206 [WARNING] Automatic CFL correction applied (count: 3375900):
30667.7s 26207 Calculated CFL: 0.800 > Limit: 0.500
30667.7s 26208 Original dt: 3.407550e-01 s
30667.7s 26209 Corrected dt: 2.129719e-01 s
30667.7s 26210 Correction factor: 1.6x
30667.7s 26211 Max wave speed detected: 23.48 m/s
30667.8s 26212 Stored output at t = 180.0000 s (Step 834)
30667.8s 26213 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 165.0/180.0 [00:00<?, ?s/s][A
30667.8s 26214 [A
30667.8s 26215 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 23.93s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:00<00:00, 23.92s/s]
30667.8s 26216 
30667.8s 26217 Simulation finished at t = 180.0000 s after 834 steps.
30667.8s 26218 Total runtime: 0.63 seconds.
30667.8s 26219 [REWARD_MICROSCOPE] step=14932 t=180.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30667.8s 26220 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30667.8s 26221 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30667.8s 26222 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30667.8s 26223 Running simulation until t = 195.00 s, outputting every 15.00 s
30667.8s 26224 
30667.9s 26225 [PROGRESS] Step 850: t=183.40/195.00s (94.1%) | dt=0.2123s
30668.4s 26226 [PROGRESS] Step 900: t=194.03/195.00s (99.5%) | dt=0.2128s
30668.4s 26227 Running Simulation:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 180.0/195.0 [00:00<?, ?s/s][A
30668.4s 26228 [A
30668.4s 26229 Stored output at t = 195.0000 s (Step 905)
30668.4s 26230 
30668.4s 26231 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 195.0/195.0 [00:00<00:00, 24.22s/s]
30668.4s 26232 Simulation finished at t = 195.0000 s after 905 steps.
30668.4s 26233 Total runtime: 0.62 seconds.
30668.4s 26234 [REWARD_MICROSCOPE] step=14933 t=195.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30668.4s 26235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30668.4s 26236 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30668.4s 26237 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30668.4s 26238 Running simulation until t = 210.00 s, outputting every 15.00 s
30668.4s 26239 
30668.5s 26240 [WARNING] Automatic CFL correction applied (count: 3376000):
30668.5s 26241 Calculated CFL: 0.800 > Limit: 0.500
30668.5s 26242 Original dt: 3.407770e-01 s
30668.5s 26243 Corrected dt: 2.129856e-01 s
30668.5s 26244 Correction factor: 1.6x
30668.5s 26245 Max wave speed detected: 23.48 m/s
30668.8s 26246 [PROGRESS] Step 950: t=204.59/210.00s (97.4%) | dt=0.2132s
30669.0s 26247 Stored output at t = 210.0000 s (Step 976)
30669.0s 26248 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 195.0/210.0 [00:00<?, ?s/s][A
30669.0s 26249 [A
30669.0s 26250 
30669.0s 26251 Simulation finished at t = 210.0000 s after 976 steps.
30669.0s 26252 Total runtime: 0.63 seconds.
30669.0s 26253 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 210.0/210.0 [00:00<00:00, 23.87s/s]
30669.0s 26254 [REWARD_MICROSCOPE] step=14934 t=210.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30669.0s 26255 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30669.0s 26256 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30669.0s 26257 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30669.0s 26258 Running simulation until t = 225.00 s, outputting every 15.00 s
30669.0s 26259 
30669.2s 26260 [PROGRESS] Step 1000: t=215.10/225.00s (95.6%) | dt=0.2124s
30669.4s 26261 [WARNING] Automatic CFL correction applied (count: 3376100):
30669.4s 26262 Calculated CFL: 0.800 > Limit: 0.500
30669.4s 26263 Original dt: 3.402034e-01 s
30669.4s 26264 Corrected dt: 2.126271e-01 s
30669.4s 26265 Correction factor: 1.6x
30669.4s 26266 Max wave speed detected: 23.52 m/s
30669.7s 26267 Stored output at t = 225.0000 s (Step 1047)
30669.7s 26268 Running Simulation:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 210.0/225.0 [00:00<?, ?s/s][A
30669.7s 26269 [A
30669.7s 26270 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 23.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 225.0/225.0 [00:00<00:00, 23.80s/s]
30669.7s 26271 
30669.7s 26272 Simulation finished at t = 225.0000 s after 1047 steps.
30669.7s 26273 Total runtime: 0.63 seconds.
30669.7s 26274 [REWARD_MICROSCOPE] step=14935 t=225.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30669.7s 26275 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30669.7s 26276 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30669.7s 26277 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30669.7s 26278 Running simulation until t = 240.00 s, outputting every 15.00 s
30669.7s 26279 
30669.7s 26280 [PROGRESS] Step 1050: t=225.64/240.00s (94.0%) | dt=0.2129s
30669.8s 26281 [PERIODIC:1000] BC_DISPATCHER [Call #13505000] current_bc_params: <class 'dict'>
30669.8s 26282 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30669.8s 26283 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30669.8s 26284 [PERIODIC:1000] BC_GPU [Call #13505000] About to launch kernel
30669.8s 26285 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30669.8s 26286 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30669.8s 26287 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30670.1s 26288 [PROGRESS] Step 1100: t=236.29/240.00s (98.5%) | dt=0.2133s
30670.3s 26289 Stored output at t = 240.0000 s (Step 1118)
30670.3s 26290 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 225.0/240.0 [00:00<?, ?s/s][A
30670.3s 26291 [A
30670.3s 26292 
30670.3s 26293 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:00<00:00, 24.04s/s]
30670.3s 26294 Simulation finished at t = 240.0000 s after 1118 steps.
30670.3s 26295 Total runtime: 0.62 seconds.
30670.3s 26296 [REWARD_MICROSCOPE] step=14936 t=240.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30670.3s 26297 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30670.3s 26298 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30670.3s 26299 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30670.3s 26300 Running simulation until t = 255.00 s, outputting every 15.00 s
30670.3s 26301 
30670.3s 26302 [WARNING] Automatic CFL correction applied (count: 3376200):
30670.3s 26303 Calculated CFL: 0.800 > Limit: 0.500
30670.3s 26304 Original dt: 3.398708e-01 s
30670.3s 26305 Corrected dt: 2.124193e-01 s
30670.3s 26306 Correction factor: 1.6x
30670.3s 26307 Max wave speed detected: 23.54 m/s
30670.6s 26308 [PROGRESS] Step 1150: t=246.80/255.00s (96.8%) | dt=0.2125s
30670.9s 26309 Stored output at t = 255.0000 s (Step 1189)
30670.9s 26310 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240.0/255.0 [00:00<?, ?s/s][A
30670.9s 26311 [A
30670.9s 26312 
30670.9s 26313 Simulation finished at t = 255.0000 s after 1189 steps.
30670.9s 26314 Total runtime: 0.65 seconds.
30670.9s 26315 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 255.0/255.0 [00:00<00:00, 23.18s/s]
30670.9s 26316 [REWARD_MICROSCOPE] step=14937 t=255.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30670.9s 26317 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30670.9s 26318 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30670.9s 26319 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30670.9s 26320 Running simulation until t = 270.00 s, outputting every 15.00 s
30670.9s 26321 
30671.0s 26322 [PROGRESS] Step 1200: t=257.34/270.00s (95.3%) | dt=0.2129s
30671.2s 26323 [WARNING] Automatic CFL correction applied (count: 3376300):
30671.2s 26324 Calculated CFL: 0.800 > Limit: 0.500
30671.2s 26325 Original dt: 3.409993e-01 s
30671.2s 26326 Corrected dt: 2.131246e-01 s
30671.2s 26327 Correction factor: 1.6x
30671.2s 26328 Max wave speed detected: 23.46 m/s
30671.5s 26329 [PROGRESS] Step 1250: t=268.00/270.00s (99.3%) | dt=0.2129s
30671.6s 26330 Running Simulation:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255.0/270.0 [00:00<?, ?s/s][A
30671.6s 26331 [A
30671.6s 26332 Stored output at t = 270.0000 s (Step 1260)
30671.6s 26333 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 270.0/270.0 [00:00<00:00, 24.21s/s]
30671.6s 26334 
30671.6s 26335 Simulation finished at t = 270.0000 s after 1260 steps.
30671.6s 26336 Total runtime: 0.62 seconds.
30671.6s 26337 [REWARD_MICROSCOPE] step=14938 t=270.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30671.6s 26338 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30671.6s 26339 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30671.6s 26340 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30671.6s 26341 Running simulation until t = 285.00 s, outputting every 15.00 s
30671.6s 26342 
30671.9s 26343 [PROGRESS] Step 1300: t=278.50/285.00s (97.7%) | dt=0.2126s
30672.1s 26344 [PERIODIC:1000] BC_DISPATCHER [Call #13506000] current_bc_params: <class 'dict'>
30672.1s 26345 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30672.1s 26346 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30672.1s 26347 [PERIODIC:1000] BC_GPU [Call #13506000] About to launch kernel
30672.1s 26348 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30672.1s 26349 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30672.1s 26350 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30672.1s 26351 [WARNING] Automatic CFL correction applied (count: 3376400):
30672.1s 26352 Calculated CFL: 0.800 > Limit: 0.500
30672.1s 26353 Original dt: 3.404274e-01 s
30672.1s 26354 Corrected dt: 2.127671e-01 s
30672.1s 26355 Correction factor: 1.6x
30672.1s 26356 Max wave speed detected: 23.50 m/s
30672.2s 26357 Stored output at t = 285.0000 s (Step 1331)
30672.2s 26358 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 270.0/285.0 [00:00<?, ?s/s][A
30672.2s 26359 [A
30672.2s 26360 
30672.2s 26361 Simulation finished at t = 285.0000 s after 1331 steps.
30672.2s 26362 Total runtime: 0.64 seconds.
30672.2s 26363 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 285.0/285.0 [00:00<00:00, 23.37s/s]
30672.2s 26364 [REWARD_MICROSCOPE] step=14939 t=285.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30672.2s 26365 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30672.2s 26366 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30672.2s 26367 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30672.2s 26368 Running simulation until t = 300.00 s, outputting every 15.00 s
30672.2s 26369 
30672.4s 26370 [PROGRESS] Step 1350: t=289.05/300.00s (96.3%) | dt=0.2130s
30672.8s 26371 [PROGRESS] Step 1400: t=299.70/300.00s (99.9%) | dt=0.2126s
30672.8s 26372 Stored output at t = 300.0000 s (Step 1402)
30672.8s 26373 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 285.0/300.0 [00:00<?, ?s/s][A
30672.8s 26374 [A
30672.8s 26375 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:00<00:00, 24.30s/s]
30672.8s 26376 
30672.8s 26377 Simulation finished at t = 300.0000 s after 1402 steps.
30672.8s 26378 Total runtime: 0.62 seconds.
30672.8s 26379 [REWARD_MICROSCOPE] step=14940 t=300.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30672.8s 26380 [STEP   20] t=  300.0s | phase=0 | reward=   0.01 | total_reward=    0.20
30672.8s 26381 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30672.8s 26382 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30672.8s 26383 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30672.8s 26384 Running simulation until t = 315.00 s, outputting every 15.00 s
30672.8s 26385 
30673.0s 26386 [WARNING] Automatic CFL correction applied (count: 3376500):
30673.0s 26387 Calculated CFL: 0.800 > Limit: 0.500
30673.0s 26388 Original dt: 3.398278e-01 s
30673.0s 26389 Corrected dt: 2.123924e-01 s
30673.0s 26390 Correction factor: 1.6x
30673.0s 26391 Max wave speed detected: 23.54 m/s
30673.2s 26392 [PROGRESS] Step 1450: t=310.20/315.00s (98.5%) | dt=0.2126s
30673.5s 26393 Stored output at t = 315.0000 s (Step 1473)
30673.5s 26394 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300.0/315.0 [00:00<?, ?s/s][A
30673.5s 26395 [A
30673.5s 26396 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 315.0/315.0 [00:00<00:00, 24.09s/s]
30673.5s 26397 
30673.5s 26398 Simulation finished at t = 315.0000 s after 1473 steps.
30673.5s 26399 Total runtime: 0.62 seconds.
30673.5s 26400 [QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====
30673.5s 26401 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30673.5s 26402 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30673.5s 26403 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30673.5s 26404 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30673.5s 26405 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30673.5s 26406 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30673.5s 26407 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30673.5s 26408 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30673.5s 26409 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30673.5s 26410 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30673.5s 26411 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30673.5s 26412 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30673.5s 26413 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30673.5s 26414 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30673.5s 26415 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30673.5s 26416 [REWARD_MICROSCOPE] step=14941 t=315.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30673.5s 26417 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30673.5s 26418 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30673.5s 26419 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30673.5s 26420 Running simulation until t = 330.00 s, outputting every 15.00 s
30673.5s 26421 
30673.7s 26422 [PROGRESS] Step 1500: t=320.75/330.00s (97.2%) | dt=0.2131s
30673.9s 26423 [WARNING] Automatic CFL correction applied (count: 3376600):
30673.9s 26424 Calculated CFL: 0.800 > Limit: 0.500
30673.9s 26425 Original dt: 3.412149e-01 s
30673.9s 26426 Corrected dt: 2.132593e-01 s
30673.9s 26427 Correction factor: 1.6x
30673.9s 26428 Max wave speed detected: 23.45 m/s
30674.1s 26429 Running Simulation:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 315.0/330.0 [00:00<?, ?s/s][A
30674.1s 26430 Stored output at t = 330.0000 s (Step 1544)
30674.1s 26431 [A
30674.1s 26432 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 330.0/330.0 [00:00<00:00, 24.32s/s]
30674.1s 26433 
30674.1s 26434 Simulation finished at t = 330.0000 s after 1544 steps.
30674.1s 26435 Total runtime: 0.62 seconds.
30674.1s 26436 [REWARD_MICROSCOPE] step=14942 t=330.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30674.1s 26437 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30674.1s 26438 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30674.1s 26439 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30674.1s 26440 Running simulation until t = 345.00 s, outputting every 15.00 s
30674.1s 26441 
30674.1s 26442 [PROGRESS] Step 1550: t=331.27/345.00s (96.0%) | dt=0.2124s
30674.3s 26443 [PERIODIC:1000] BC_DISPATCHER [Call #13507000] current_bc_params: <class 'dict'>
30674.3s 26444 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30674.3s 26445 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30674.3s 26446 [PERIODIC:1000] BC_GPU [Call #13507000] About to launch kernel
30674.3s 26447 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30674.3s 26448 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30674.3s 26449 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30674.6s 26450 [PROGRESS] Step 1600: t=341.90/345.00s (99.1%) | dt=0.2127s
30674.7s 26451 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 330.0/345.0 [00:00<?, ?s/s][A
30674.7s 26452 [A
30674.7s 26453 Stored output at t = 345.0000 s (Step 1615)
30674.7s 26454 
30674.7s 26455 Simulation finished at t = 345.0000 s after 1615 steps.
30674.7s 26456 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345.0/345.0 [00:00<00:00, 24.36s/s]
30674.7s 26457 Total runtime: 0.62 seconds.
30674.7s 26458 [REWARD_MICROSCOPE] step=14943 t=345.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30674.7s 26459 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30674.7s 26460 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30674.7s 26461 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30674.7s 26462 Running simulation until t = 360.00 s, outputting every 15.00 s
30674.7s 26463 
30674.8s 26464 [WARNING] Automatic CFL correction applied (count: 3376700):
30674.8s 26465 Calculated CFL: 0.800 > Limit: 0.500
30674.8s 26466 Original dt: 3.406380e-01 s
30674.8s 26467 Corrected dt: 2.128988e-01 s
30674.8s 26468 Correction factor: 1.6x
30674.8s 26469 Max wave speed detected: 23.49 m/s
30675.0s 26470 [PROGRESS] Step 1650: t=352.45/360.00s (97.9%) | dt=0.2131s
30675.3s 26471 Stored output at t = 360.0000 s (Step 1686)
30675.3s 26472 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 345.0/360.0 [00:00<?, ?s/s][A
30675.3s 26473 [A
30675.3s 26474 
30675.3s 26475 Simulation finished at t = 360.0000 s after 1686 steps.
30675.3s 26476 Total runtime: 0.63 seconds.
30675.3s 26477 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 23.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:00<00:00, 23.92s/s]
30675.3s 26478 [REWARD_MICROSCOPE] step=14944 t=360.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30675.3s 26479 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30675.3s 26480 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30675.3s 26481 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30675.3s 26482 Running simulation until t = 375.00 s, outputting every 15.00 s
30675.3s 26483 
30675.4s 26484 [PROGRESS] Step 1700: t=362.97/375.00s (96.8%) | dt=0.2123s
30675.6s 26485 [WARNING] Automatic CFL correction applied (count: 3376800):
30675.6s 26486 Calculated CFL: 0.800 > Limit: 0.500
30675.6s 26487 Original dt: 3.400643e-01 s
30675.6s 26488 Corrected dt: 2.125402e-01 s
30675.6s 26489 Correction factor: 1.6x
30675.6s 26490 Max wave speed detected: 23.52 m/s
30675.9s 26491 [PROGRESS] Step 1750: t=373.60/375.00s (99.6%) | dt=0.2128s
30675.9s 26492 Stored output at t = 375.0000 s (Step 1757)
30675.9s 26493 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 360.0/375.0 [00:00<?, ?s/s][A
30675.9s 26494 [A
30675.9s 26495 
30675.9s 26496 Simulation finished at t = 375.0000 s after 1757 steps.
30675.9s 26497 Total runtime: 0.62 seconds.
30675.9s 26498 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 375.0/375.0 [00:00<00:00, 24.02s/s]
30676.0s 26499 [REWARD_MICROSCOPE] step=14945 t=375.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30676.0s 26500 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30676.0s 26501 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30676.0s 26502 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30676.0s 26503 Running simulation until t = 390.00 s, outputting every 15.00 s
30676.0s 26504 
30676.3s 26505 [PROGRESS] Step 1800: t=384.16/390.00s (98.5%) | dt=0.2132s
30676.5s 26506 [PERIODIC:1000] BC_DISPATCHER [Call #13508000] current_bc_params: <class 'dict'>
30676.5s 26507 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30676.5s 26508 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30676.5s 26509 [PERIODIC:1000] BC_GPU [Call #13508000] About to launch kernel
30676.5s 26510 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30676.5s 26511 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30676.5s 26512 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30676.5s 26513 [WARNING] Automatic CFL correction applied (count: 3376900):
30676.5s 26514 Calculated CFL: 0.800 > Limit: 0.500
30676.5s 26515 Original dt: 3.403351e-01 s
30676.5s 26516 Corrected dt: 2.127094e-01 s
30676.5s 26517 Correction factor: 1.6x
30676.5s 26518 Max wave speed detected: 23.51 m/s
30676.6s 26519 Stored output at t = 390.0000 s (Step 1828)
30676.6s 26520 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 375.0/390.0 [00:00<?, ?s/s][A
30676.6s 26521 [A
30676.6s 26522 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 390.0/390.0 [00:00<00:00, 24.30s/s]
30676.6s 26523 
30676.6s 26524 Simulation finished at t = 390.0000 s after 1828 steps.
30676.6s 26525 Total runtime: 0.62 seconds.
30676.6s 26526 [REWARD_MICROSCOPE] step=14946 t=390.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30676.6s 26527 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30676.6s 26528 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30676.6s 26529 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30676.6s 26530 Running simulation until t = 405.00 s, outputting every 15.00 s
30676.6s 26531 
30676.8s 26532 [PROGRESS] Step 1850: t=394.67/405.00s (97.4%) | dt=0.2124s
30677.2s 26533 Stored output at t = 405.0000 s (Step 1899)
30677.2s 26534 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 390.0/405.0 [00:00<?, ?s/s][A
30677.2s 26535 [A
30677.2s 26536 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.51s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 405.0/405.0 [00:00<00:00, 23.51s/s]
30677.2s 26537 
30677.2s 26538 Simulation finished at t = 405.0000 s after 1899 steps.
30677.2s 26539 Total runtime: 0.64 seconds.
30677.2s 26540 [REWARD_MICROSCOPE] step=14947 t=405.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30677.2s 26541 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30677.2s 26542 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30677.2s 26543 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30677.2s 26544 Running simulation until t = 420.00 s, outputting every 15.00 s
30677.2s 26545 
30677.2s 26546 [PROGRESS] Step 1900: t=405.21/420.00s (96.5%) | dt=0.2128s
30677.4s 26547 [WARNING] Automatic CFL correction applied (count: 3377000):
30677.4s 26548 Calculated CFL: 0.800 > Limit: 0.500
30677.4s 26549 Original dt: 3.408612e-01 s
30677.4s 26550 Corrected dt: 2.130383e-01 s
30677.4s 26551 Correction factor: 1.6x
30677.4s 26552 Max wave speed detected: 23.47 m/s
30677.7s 26553 [PROGRESS] Step 1950: t=415.87/420.00s (99.0%) | dt=0.2133s
30677.8s 26554 Stored output at t = 420.0000 s (Step 1970)
30677.8s 26555 Running Simulation:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 405.0/420.0 [00:00<?, ?s/s][A
30677.8s 26556 [A
30677.8s 26557 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:00<00:00, 24.08s/s]
30677.8s 26558 
30677.8s 26559 Simulation finished at t = 420.0000 s after 1970 steps.
30677.8s 26560 Total runtime: 0.62 seconds.
30677.8s 26561 [REWARD_MICROSCOPE] step=14948 t=420.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30677.8s 26562 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30677.8s 26563 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30677.8s 26564 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30677.8s 26565 Running simulation until t = 435.00 s, outputting every 15.00 s
30677.8s 26566 
30678.1s 26567 [PROGRESS] Step 2000: t=426.37/435.00s (98.0%) | dt=0.2125s
30678.3s 26568 [WARNING] Automatic CFL correction applied (count: 3377100):
30678.3s 26569 Calculated CFL: 0.800 > Limit: 0.500
30678.3s 26570 Original dt: 3.402871e-01 s
30678.3s 26571 Corrected dt: 2.126795e-01 s
30678.3s 26572 Correction factor: 1.6x
30678.3s 26573 Max wave speed detected: 23.51 m/s
30678.5s 26574 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 420.0/435.0 [00:00<?, ?s/s][A
30678.5s 26575 [A
30678.5s 26576 Stored output at t = 435.0000 s (Step 2041)
30678.5s 26577 
30678.5s 26578 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 435.0/435.0 [00:00<00:00, 24.08s/s]
30678.5s 26579 Simulation finished at t = 435.0000 s after 2041 steps.
30678.5s 26580 Total runtime: 0.62 seconds.
30678.5s 26581 [REWARD_MICROSCOPE] step=14949 t=435.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30678.5s 26582 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30678.5s 26583 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30678.5s 26584 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30678.5s 26585 Running simulation until t = 450.00 s, outputting every 15.00 s
30678.5s 26586 
30678.5s 26587 [PROGRESS] Step 2050: t=436.92/450.00s (97.1%) | dt=0.2129s
30678.7s 26588 [PERIODIC:1000] BC_DISPATCHER [Call #13509000] current_bc_params: <class 'dict'>
30678.7s 26589 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30678.7s 26590 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30678.7s 26591 [PERIODIC:1000] BC_GPU [Call #13509000] About to launch kernel
30678.7s 26592 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30678.7s 26593 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30678.7s 26594 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30679.0s 26595 [PROGRESS] Step 2100: t=447.57/450.00s (99.5%) | dt=0.2130s
30679.1s 26596 Stored output at t = 450.0000 s (Step 2112)
30679.1s 26597 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 435.0/450.0 [00:00<?, ?s/s][A
30679.1s 26598 [A
30679.1s 26599 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 450.0/450.0 [00:00<00:00, 23.95s/s]
30679.1s 26600 
30679.1s 26601 Simulation finished at t = 450.0000 s after 2112 steps.
30679.1s 26602 Total runtime: 0.63 seconds.
30679.1s 26603 [REWARD_MICROSCOPE] step=14950 t=450.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30679.1s 26604 [STEP   30] t=  450.0s | phase=0 | reward=   0.01 | total_reward=    0.30
30679.1s 26605 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30679.1s 26606 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30679.1s 26607 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30679.1s 26608 Running simulation until t = 465.00 s, outputting every 15.00 s
30679.1s 26609 
30679.2s 26610 [WARNING] Automatic CFL correction applied (count: 3377200):
30679.2s 26611 Calculated CFL: 0.800 > Limit: 0.500
30679.2s 26612 Original dt: 3.397169e-01 s
30679.2s 26613 Corrected dt: 2.123230e-01 s
30679.2s 26614 Correction factor: 1.6x
30679.2s 26615 Max wave speed detected: 23.55 m/s
30679.4s 26616 [PROGRESS] Step 2150: t=458.07/465.00s (98.5%) | dt=0.2125s
30679.7s 26617 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 450.0/465.0 [00:00<?, ?s/s][A
30679.7s 26618 [A
30679.7s 26619 Stored output at t = 465.0000 s (Step 2183)
30679.7s 26620 
30679.7s 26621 Simulation finished at t = 465.0000 s after 2183 steps.
30679.7s 26622 Total runtime: 0.62 seconds.
30679.7s 26623 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.37s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 465.0/465.0 [00:00<00:00, 24.37s/s]
30679.7s 26624 [QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====
30679.7s 26625 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30679.7s 26626 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30679.7s 26627 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30679.7s 26628 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30679.7s 26629 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30679.7s 26630 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30679.7s 26631 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30679.7s 26632 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30679.7s 26633 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30679.7s 26634 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30679.7s 26635 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30679.7s 26636 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30679.7s 26637 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30679.7s 26638 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30679.7s 26639 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30679.7s 26640 [REWARD_MICROSCOPE] step=14951 t=465.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30679.7s 26641 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30679.7s 26642 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30679.7s 26643 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30679.7s 26644 Running simulation until t = 480.00 s, outputting every 15.00 s
30679.7s 26645 
30679.9s 26646 [PROGRESS] Step 2200: t=468.62/480.00s (97.6%) | dt=0.2130s
30680.1s 26647 [WARNING] Automatic CFL correction applied (count: 3377300):
30680.1s 26648 Calculated CFL: 0.800 > Limit: 0.500
30680.1s 26649 Original dt: 3.410795e-01 s
30680.1s 26650 Corrected dt: 2.131747e-01 s
30680.1s 26651 Correction factor: 1.6x
30680.1s 26652 Max wave speed detected: 23.45 m/s
30680.3s 26653 [PROGRESS] Step 2250: t=479.27/480.00s (99.8%) | dt=0.2127s
30680.3s 26654 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 465.0/480.0 [00:00<?, ?s/s][A
30680.3s 26655 [A
30680.3s 26656 Stored output at t = 480.0000 s (Step 2254)
30680.3s 26657 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:00<00:00, 24.28s/s]
30680.3s 26658 
30680.3s 26659 Simulation finished at t = 480.0000 s after 2254 steps.
30680.3s 26660 Total runtime: 0.62 seconds.
30680.3s 26661 [REWARD_MICROSCOPE] step=14952 t=480.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30680.3s 26662 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30680.3s 26663 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30680.3s 26664 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30680.3s 26665 Running simulation until t = 495.00 s, outputting every 15.00 s
30680.3s 26666 
30680.7s 26667 [PROGRESS] Step 2300: t=489.77/495.00s (98.9%) | dt=0.2126s
30680.9s 26668 [PERIODIC:1000] BC_DISPATCHER [Call #13510000] current_bc_params: <class 'dict'>
30680.9s 26669 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30680.9s 26670 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30680.9s 26671 [PERIODIC:1000] BC_GPU [Call #13510000] About to launch kernel
30680.9s 26672 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30680.9s 26673 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30680.9s 26674 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30681.0s 26675 [WARNING] Automatic CFL correction applied (count: 3377400):
30681.0s 26676 Calculated CFL: 0.800 > Limit: 0.500
30681.0s 26677 Original dt: 3.405090e-01 s
30681.0s 26678 Corrected dt: 2.128181e-01 s
30681.0s 26679 Correction factor: 1.6x
30681.0s 26680 Max wave speed detected: 23.49 m/s
30681.0s 26681 Stored output at t = 495.0000 s (Step 2325)
30681.0s 26682 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 480.0/495.0 [00:00<?, ?s/s][A
30681.0s 26683 [A
30681.0s 26684 
30681.0s 26685 Simulation finished at t = 495.0000 s after 2325 steps.
30681.0s 26686 Total runtime: 0.65 seconds.
30681.0s 26687 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 495.0/495.0 [00:00<00:00, 23.18s/s]
30681.0s 26688 [REWARD_MICROSCOPE] step=14953 t=495.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30681.0s 26689 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30681.0s 26690 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30681.0s 26691 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30681.0s 26692 Running simulation until t = 510.00 s, outputting every 15.00 s
30681.0s 26693 
30681.2s 26694 [PROGRESS] Step 2350: t=500.32/510.00s (98.1%) | dt=0.2130s
30681.6s 26695 Stored output at t = 510.0000 s (Step 2396)
30681.6s 26696 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 495.0/510.0 [00:00<?, ?s/s][A
30681.6s 26697 [A
30681.6s 26698 
30681.6s 26699 Simulation finished at t = 510.0000 s after 2396 steps.
30681.6s 26700 Total runtime: 0.62 seconds.
30681.6s 26701 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 510.0/510.0 [00:00<00:00, 24.35s/s]
30681.6s 26702 [REWARD_MICROSCOPE] step=14954 t=510.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30681.6s 26703 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30681.6s 26704 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30681.6s 26705 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30681.6s 26706 Running simulation until t = 525.00 s, outputting every 15.00 s
30681.6s 26707 
30681.6s 26708 [PROGRESS] Step 2400: t=510.85/525.00s (97.3%) | dt=0.2124s
30681.9s 26709 [WARNING] Automatic CFL correction applied (count: 3377500):
30681.9s 26710 Calculated CFL: 0.800 > Limit: 0.500
30681.9s 26711 Original dt: 3.399193e-01 s
30681.9s 26712 Corrected dt: 2.124495e-01 s
30681.9s 26713 Correction factor: 1.6x
30681.9s 26714 Max wave speed detected: 23.53 m/s
30682.1s 26715 [PROGRESS] Step 2450: t=521.47/525.00s (99.3%) | dt=0.2127s
30682.3s 26716 Stored output at t = 525.0000 s (Step 2467)
30682.3s 26717 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 510.0/525.0 [00:00<?, ?s/s][A
30682.3s 26718 [A
30682.3s 26719 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 525.0/525.0 [00:00<00:00, 23.18s/s]
30682.3s 26720 
30682.3s 26721 Simulation finished at t = 525.0000 s after 2467 steps.
30682.3s 26722 Total runtime: 0.65 seconds.
30682.3s 26723 [REWARD_MICROSCOPE] step=14955 t=525.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30682.3s 26724 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30682.3s 26725 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30682.3s 26726 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30682.3s 26727 Running simulation until t = 540.00 s, outputting every 15.00 s
30682.3s 26728 
30682.6s 26729 [PROGRESS] Step 2500: t=532.03/540.00s (98.5%) | dt=0.2131s
30682.8s 26730 [WARNING] Automatic CFL correction applied (count: 3377600):
30682.8s 26731 Calculated CFL: 0.800 > Limit: 0.500
30682.8s 26732 Original dt: 3.411066e-01 s
30682.8s 26733 Corrected dt: 2.131916e-01 s
30682.8s 26734 Correction factor: 1.6x
30682.8s 26735 Max wave speed detected: 23.45 m/s
30682.9s 26736 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 525.0/540.0 [00:00<?, ?s/s][A
30682.9s 26737 [A
30682.9s 26738 Stored output at t = 540.0000 s (Step 2538)
30682.9s 26739 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 22.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:00<00:00, 21.99s/s]
30682.9s 26740 
30682.9s 26741 Simulation finished at t = 540.0000 s after 2538 steps.
30682.9s 26742 Total runtime: 0.68 seconds.
30682.9s 26743 [REWARD_MICROSCOPE] step=14956 t=540.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30682.9s 26744 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30682.9s 26745 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30682.9s 26746 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30682.9s 26747 Running simulation until t = 555.00 s, outputting every 15.00 s
30682.9s 26748 
30683.0s 26749 [PROGRESS] Step 2550: t=542.55/555.00s (97.8%) | dt=0.2123s
30683.2s 26750 [PERIODIC:1000] BC_DISPATCHER [Call #13511000] current_bc_params: <class 'dict'>
30683.2s 26751 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30683.2s 26752 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30683.2s 26753 [PERIODIC:1000] BC_GPU [Call #13511000] About to launch kernel
30683.2s 26754 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30683.2s 26755 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30683.2s 26756 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30683.5s 26757 [PROGRESS] Step 2600: t=553.18/555.00s (99.7%) | dt=0.2128s
30683.6s 26758 Stored output at t = 555.0000 s (Step 2609)
30683.6s 26759 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 540.0/555.0 [00:00<?, ?s/s][A
30683.6s 26760 [A
30683.6s 26761 
30683.6s 26762 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 555.0/555.0 [00:00<00:00, 24.29s/s]
30683.6s 26763 Simulation finished at t = 555.0000 s after 2609 steps.
30683.6s 26764 Total runtime: 0.62 seconds.
30683.6s 26765 [REWARD_MICROSCOPE] step=14957 t=555.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30683.6s 26766 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30683.6s 26767 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30683.6s 26768 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30683.6s 26769 Running simulation until t = 570.00 s, outputting every 15.00 s
30683.6s 26770 
30683.7s 26771 [WARNING] Automatic CFL correction applied (count: 3377700):
30683.7s 26772 Calculated CFL: 0.800 > Limit: 0.500
30683.7s 26773 Original dt: 3.407212e-01 s
30683.7s 26774 Corrected dt: 2.129508e-01 s
30683.7s 26775 Correction factor: 1.6x
30683.7s 26776 Max wave speed detected: 23.48 m/s
30683.9s 26777 [PROGRESS] Step 2650: t=563.73/570.00s (98.9%) | dt=0.2132s
30684.2s 26778 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 555.0/570.0 [00:00<?, ?s/s][A
30684.2s 26779 [A
30684.2s 26780 Stored output at t = 570.0000 s (Step 2680)
30684.2s 26781 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 570.0/570.0 [00:00<00:00, 23.53s/s]
30684.2s 26782 
30684.2s 26783 Simulation finished at t = 570.0000 s after 2680 steps.
30684.2s 26784 Total runtime: 0.64 seconds.
30684.2s 26785 [REWARD_MICROSCOPE] step=14958 t=570.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30684.2s 26786 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30684.2s 26787 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30684.2s 26788 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30684.2s 26789 Running simulation until t = 585.00 s, outputting every 15.00 s
30684.2s 26790 
30684.4s 26791 [PROGRESS] Step 2700: t=574.25/585.00s (98.2%) | dt=0.2124s
30684.6s 26792 [WARNING] Automatic CFL correction applied (count: 3377800):
30684.6s 26793 Calculated CFL: 0.800 > Limit: 0.500
30684.6s 26794 Original dt: 3.401477e-01 s
30684.6s 26795 Corrected dt: 2.125923e-01 s
30684.6s 26796 Correction factor: 1.6x
30684.6s 26797 Max wave speed detected: 23.52 m/s
30684.8s 26798 [PROGRESS] Step 2750: t=584.88/585.00s (100.0%) | dt=0.2128s
30684.8s 26799 Stored output at t = 585.0000 s (Step 2751)
30684.8s 26800 Running Simulation:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 570.0/585.0 [00:00<?, ?s/s][A
30684.8s 26801 [A
30684.8s 26802 
30684.8s 26803 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 585.0/585.0 [00:00<00:00, 24.20s/s]
30684.8s 26804 Simulation finished at t = 585.0000 s after 2751 steps.
30684.8s 26805 Total runtime: 0.62 seconds.
30684.8s 26806 [REWARD_MICROSCOPE] step=14959 t=585.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30684.8s 26807 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30684.8s 26808 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30684.8s 26809 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30684.8s 26810 Running simulation until t = 600.00 s, outputting every 15.00 s
30684.8s 26811 
30685.3s 26812 [PROGRESS] Step 2800: t=595.44/600.00s (99.2%) | dt=0.2133s
30685.4s 26813 [PERIODIC:1000] BC_DISPATCHER [Call #13512000] current_bc_params: <class 'dict'>
30685.4s 26814 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30685.4s 26815 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30685.4s 26816 [PERIODIC:1000] BC_GPU [Call #13512000] About to launch kernel
30685.4s 26817 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30685.4s 26818 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30685.4s 26819 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30685.5s 26820 Stored output at t = 600.0000 s (Step 2822)
30685.5s 26821 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 585.0/600.0 [00:00<?, ?s/s][A
30685.5s 26822 [A
30685.5s 26823 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 23.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:00<00:00, 23.30s/s]
30685.5s 26824 
30685.5s 26825 Simulation finished at t = 600.0000 s after 2822 steps.
30685.5s 26826 Total runtime: 0.64 seconds.
30685.5s 26827 [REWARD_MICROSCOPE] step=14960 t=600.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30685.5s 26828 [STEP   40] t=  600.0s | phase=0 | reward=   0.01 | total_reward=    0.40
30685.5s 26829 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30685.5s 26830 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30685.5s 26831 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30685.5s 26832 Running simulation until t = 615.00 s, outputting every 15.00 s
30685.5s 26833 
30685.5s 26834 [WARNING] Automatic CFL correction applied (count: 3377900):
30685.5s 26835 Calculated CFL: 0.800 > Limit: 0.500
30685.5s 26836 Original dt: 3.400436e-01 s
30685.5s 26837 Corrected dt: 2.125273e-01 s
30685.5s 26838 Correction factor: 1.6x
30685.5s 26839 Max wave speed detected: 23.53 m/s
30685.7s 26840 [PROGRESS] Step 2850: t=605.95/615.00s (98.5%) | dt=0.2125s
30686.1s 26841 Stored output at t = 615.0000 s (Step 2893)
30686.1s 26842 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 600.0/615.0 [00:00<?, ?s/s][A
30686.1s 26843 [A
30686.1s 26844 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 615.0/615.0 [00:00<00:00, 23.89s/s]
30686.1s 26845 
30686.1s 26846 Simulation finished at t = 615.0000 s after 2893 steps.
30686.1s 26847 Total runtime: 0.63 seconds.
30686.1s 26848 [QUEUE_DIAGNOSTIC] ===== Step 40 t=615.0s =====
30686.1s 26849 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30686.1s 26850 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30686.1s 26851 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30686.1s 26852 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30686.1s 26853 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30686.1s 26854 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30686.1s 26855 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30686.1s 26856 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30686.1s 26857 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30686.1s 26858 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30686.1s 26859 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30686.1s 26860 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30686.1s 26861 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30686.1s 26862 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30686.1s 26863 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30686.1s 26864 [REWARD_MICROSCOPE] step=14961 t=615.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30686.1s 26865 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30686.1s 26866 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30686.1s 26867 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30686.1s 26868 Running simulation until t = 630.00 s, outputting every 15.00 s
30686.1s 26869 
30686.2s 26870 [PROGRESS] Step 2900: t=616.49/630.00s (97.9%) | dt=0.2129s
30686.4s 26871 [WARNING] Automatic CFL correction applied (count: 3378000):
30686.4s 26872 Calculated CFL: 0.800 > Limit: 0.500
30686.4s 26873 Original dt: 3.409462e-01 s
30686.4s 26874 Corrected dt: 2.130914e-01 s
30686.4s 26875 Correction factor: 1.6x
30686.4s 26876 Max wave speed detected: 23.46 m/s
30686.6s 26877 [PROGRESS] Step 2950: t=627.15/630.00s (99.5%) | dt=0.2131s
30686.7s 26878 Stored output at t = 630.0000 s (Step 2964)
30686.7s 26879 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 615.0/630.0 [00:00<?, ?s/s][A
30686.7s 26880 [A
30686.7s 26881 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.32s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 630.0/630.0 [00:00<00:00, 24.31s/s]
30686.7s 26882 
30686.7s 26883 Simulation finished at t = 630.0000 s after 2964 steps.
30686.7s 26884 Total runtime: 0.62 seconds.
30686.7s 26885 [REWARD_MICROSCOPE] step=14962 t=630.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30686.7s 26886 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30686.7s 26887 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30686.7s 26888 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30686.7s 26889 Running simulation until t = 645.00 s, outputting every 15.00 s
30686.7s 26890 
30687.0s 26891 [PROGRESS] Step 3000: t=637.65/645.00s (98.9%) | dt=0.2125s
30687.2s 26892 [WARNING] Automatic CFL correction applied (count: 3378100):
30687.2s 26893 Calculated CFL: 0.800 > Limit: 0.500
30687.2s 26894 Original dt: 3.403711e-01 s
30687.2s 26895 Corrected dt: 2.127320e-01 s
30687.2s 26896 Correction factor: 1.6x
30687.2s 26897 Max wave speed detected: 23.50 m/s
30687.3s 26898 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 630.0/645.0 [00:00<?, ?s/s][A
30687.3s 26899 [A
30687.3s 26900 Stored output at t = 645.0000 s (Step 3035)
30687.3s 26901 
30687.3s 26902 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 24.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 645.0/645.0 [00:00<00:00, 24.28s/s]
30687.3s 26903 Simulation finished at t = 645.0000 s after 3035 steps.
30687.3s 26904 Total runtime: 0.62 seconds.
30687.3s 26905 [REWARD_MICROSCOPE] step=14963 t=645.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30687.3s 26906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30687.3s 26907 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30687.3s 26908 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30687.3s 26909 Running simulation until t = 660.00 s, outputting every 15.00 s
30687.3s 26910 
30687.5s 26911 [PROGRESS] Step 3050: t=648.19/660.00s (98.2%) | dt=0.2130s
30687.6s 26912 [PERIODIC:1000] BC_DISPATCHER [Call #13513000] current_bc_params: <class 'dict'>
30687.6s 26913 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30687.6s 26914 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30687.6s 26915 [PERIODIC:1000] BC_GPU [Call #13513000] About to launch kernel
30687.6s 26916 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30687.6s 26917 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30687.6s 26918 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30687.9s 26919 [PROGRESS] Step 3100: t=658.85/660.00s (99.8%) | dt=0.2127s
30688.0s 26920 Stored output at t = 660.0000 s (Step 3106)
30688.0s 26921 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 645.0/660.0 [00:00<?, ?s/s][A
30688.0s 26922 [A
30688.0s 26923 
30688.0s 26924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 23.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 660.0/660.0 [00:00<00:00, 23.56s/s]
30688.0s 26925 Simulation finished at t = 660.0000 s after 3106 steps.
30688.0s 26926 Total runtime: 0.64 seconds.
30688.0s 26927 [REWARD_MICROSCOPE] step=14964 t=660.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30688.0s 26928 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30688.0s 26929 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30688.0s 26930 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30688.0s 26931 Running simulation until t = 675.00 s, outputting every 15.00 s
30688.0s 26932 
30688.1s 26933 [WARNING] Automatic CFL correction applied (count: 3378200):
30688.1s 26934 Calculated CFL: 0.800 > Limit: 0.500
30688.1s 26935 Original dt: 3.397675e-01 s
30688.1s 26936 Corrected dt: 2.123547e-01 s
30688.1s 26937 Correction factor: 1.6x
30688.1s 26938 Max wave speed detected: 23.55 m/s
30688.4s 26939 [PROGRESS] Step 3150: t=669.35/675.00s (99.2%) | dt=0.2126s
30688.6s 26940 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 660.0/675.0 [00:00<?, ?s/s][A
30688.6s 26941 [A
30688.6s 26942 Stored output at t = 675.0000 s (Step 3177)
30688.6s 26943 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 675.0/675.0 [00:00<00:00, 23.89s/s]
30688.6s 26944 
30688.6s 26945 Simulation finished at t = 675.0000 s after 3177 steps.
30688.6s 26946 Total runtime: 0.63 seconds.
30688.6s 26947 [REWARD_MICROSCOPE] step=14965 t=675.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30688.6s 26948 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30688.6s 26949 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30688.6s 26950 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30688.6s 26951 Running simulation until t = 690.00 s, outputting every 15.00 s
30688.6s 26952 
30688.8s 26953 [PROGRESS] Step 3200: t=679.90/690.00s (98.5%) | dt=0.2130s
30689.0s 26954 [WARNING] Automatic CFL correction applied (count: 3378300):
30689.0s 26955 Calculated CFL: 0.800 > Limit: 0.500
30689.0s 26956 Original dt: 3.411605e-01 s
30689.0s 26957 Corrected dt: 2.132253e-01 s
30689.0s 26958 Correction factor: 1.6x
30689.0s 26959 Max wave speed detected: 23.45 m/s
30689.2s 26960 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 675.0/690.0 [00:00<?, ?s/s][A
30689.2s 26961 [A
30689.2s 26962 Stored output at t = 690.0000 s (Step 3248)
30689.2s 26963 
30689.2s 26964 Simulation finished at t = 690.0000 s after 3248 steps.
30689.2s 26965 Total runtime: 0.62 seconds.
30689.2s 26966 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 690.0/690.0 [00:00<00:00, 24.02s/s]
30689.2s 26967 [REWARD_MICROSCOPE] step=14966 t=690.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30689.2s 26968 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30689.2s 26969 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30689.2s 26970 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30689.2s 26971 Running simulation until t = 705.00 s, outputting every 15.00 s
30689.2s 26972 
30689.3s 26973 [PROGRESS] Step 3250: t=690.43/705.00s (97.9%) | dt=0.2125s
30689.7s 26974 [PROGRESS] Step 3300: t=701.05/705.00s (99.4%) | dt=0.2127s
30689.9s 26975 [PERIODIC:1000] BC_DISPATCHER [Call #13514000] current_bc_params: <class 'dict'>
30689.9s 26976 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30689.9s 26977 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30689.9s 26978 [PERIODIC:1000] BC_GPU [Call #13514000] About to launch kernel
30689.9s 26979 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30689.9s 26980 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30689.9s 26981 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30689.9s 26982 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 690.0/705.0 [00:00<?, ?s/s][A
30689.9s 26983 [A
30689.9s 26984 Stored output at t = 705.0000 s (Step 3319)
30689.9s 26985 
30689.9s 26986 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 22.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 705.0/705.0 [00:00<00:00, 22.98s/s]
30689.9s 26987 Simulation finished at t = 705.0000 s after 3319 steps.
30689.9s 26988 Total runtime: 0.65 seconds.
30689.9s 26989 [REWARD_MICROSCOPE] step=14967 t=705.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30689.9s 26990 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30689.9s 26991 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30689.9s 26992 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30689.9s 26993 Running simulation until t = 720.00 s, outputting every 15.00 s
30689.9s 26994 
30689.9s 26995 [WARNING] Automatic CFL correction applied (count: 3378400):
30689.9s 26996 Calculated CFL: 0.800 > Limit: 0.500
30689.9s 26997 Original dt: 3.405828e-01 s
30689.9s 26998 Corrected dt: 2.128643e-01 s
30689.9s 26999 Correction factor: 1.6x
30689.9s 27000 Max wave speed detected: 23.49 m/s
30690.2s 27001 [PROGRESS] Step 3350: t=711.60/720.00s (98.8%) | dt=0.2131s
30690.5s 27002 Stored output at t = 720.0000 s (Step 3390)
30690.5s 27003 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 705.0/720.0 [00:00<?, ?s/s][A
30690.5s 27004 [A
30690.5s 27005 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 720.0/720.0 [00:00<00:00, 23.30s/s]
30690.5s 27006 
30690.5s 27007 Simulation finished at t = 720.0000 s after 3390 steps.
30690.5s 27008 Total runtime: 0.64 seconds.
30690.5s 27009 [REWARD_MICROSCOPE] step=14968 t=720.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30690.5s 27010 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30690.5s 27011 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30690.5s 27012 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30690.5s 27013 Running simulation until t = 735.00 s, outputting every 15.00 s
30690.5s 27014 
30690.6s 27015 [PROGRESS] Step 3400: t=722.12/735.00s (98.2%) | dt=0.2123s
30690.8s 27016 [WARNING] Automatic CFL correction applied (count: 3378500):
30690.8s 27017 Calculated CFL: 0.800 > Limit: 0.500
30690.8s 27018 Original dt: 3.400085e-01 s
30690.8s 27019 Corrected dt: 2.125053e-01 s
30690.8s 27020 Correction factor: 1.6x
30690.8s 27021 Max wave speed detected: 23.53 m/s
30691.1s 27022 [PROGRESS] Step 3450: t=732.75/735.00s (99.7%) | dt=0.2127s
30691.2s 27023 Stored output at t = 735.0000 s (Step 3461)
30691.2s 27024 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 720.0/735.0 [00:00<?, ?s/s][A
30691.2s 27025 [A
30691.2s 27026 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 23.42s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 735.0/735.0 [00:00<00:00, 23.41s/s]
30691.2s 27027 
30691.2s 27028 Simulation finished at t = 735.0000 s after 3461 steps.
30691.2s 27029 Total runtime: 0.64 seconds.
30691.2s 27030 [REWARD_MICROSCOPE] step=14969 t=735.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30691.2s 27031 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30691.2s 27032 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30691.2s 27033 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30691.2s 27034 Running simulation until t = 750.00 s, outputting every 15.00 s
30691.2s 27035 
30691.5s 27036 [PROGRESS] Step 3500: t=743.31/750.00s (99.1%) | dt=0.2132s
30691.7s 27037 [WARNING] Automatic CFL correction applied (count: 3378600):
30691.7s 27038 Calculated CFL: 0.800 > Limit: 0.500
30691.7s 27039 Original dt: 3.406020e-01 s
30691.7s 27040 Corrected dt: 2.128763e-01 s
30691.7s 27041 Correction factor: 1.6x
30691.7s 27042 Max wave speed detected: 23.49 m/s
30691.8s 27043 Stored output at t = 750.0000 s (Step 3532)
30691.8s 27044 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 735.0/750.0 [00:00<?, ?s/s][A
30691.8s 27045 [A
30691.8s 27046 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750.0/750.0 [00:00<00:00, 24.39s/s]
30691.8s 27047 
30691.8s 27048 Simulation finished at t = 750.0000 s after 3532 steps.
30691.8s 27049 Total runtime: 0.62 seconds.
30691.8s 27050 [REWARD_MICROSCOPE] step=14970 t=750.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30691.8s 27051 [STEP   50] t=  750.0s | phase=0 | reward=   0.01 | total_reward=    0.50
30691.8s 27052 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30691.8s 27053 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30691.8s 27054 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30691.8s 27055 Running simulation until t = 765.00 s, outputting every 15.00 s
30691.8s 27056 
30692.0s 27057 [PROGRESS] Step 3550: t=753.82/765.00s (98.5%) | dt=0.2124s
30692.1s 27058 [PERIODIC:1000] BC_DISPATCHER [Call #13515000] current_bc_params: <class 'dict'>
30692.1s 27059 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30692.1s 27060 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30692.1s 27061 [PERIODIC:1000] BC_GPU [Call #13515000] About to launch kernel
30692.1s 27062 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30692.1s 27063 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30692.1s 27064 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30692.4s 27065 [PROGRESS] Step 3600: t=764.45/765.00s (99.9%) | dt=0.2128s
30692.4s 27066 Stored output at t = 765.0000 s (Step 3603)
30692.4s 27067 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 750.0/765.0 [00:00<?, ?s/s][A
30692.4s 27068 [A
30692.4s 27069 
30692.4s 27070 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 765.0/765.0 [00:00<00:00, 23.71s/s]
30692.4s 27071 Simulation finished at t = 765.0000 s after 3603 steps.
30692.4s 27072 Total runtime: 0.63 seconds.
30692.4s 27073 [QUEUE_DIAGNOSTIC] ===== Step 50 t=765.0s =====
30692.4s 27074 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30692.4s 27075 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30692.4s 27076 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30692.4s 27077 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30692.4s 27078 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30692.4s 27079 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30692.4s 27080 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30692.4s 27081 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30692.4s 27082 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30692.4s 27083 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30692.4s 27084 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30692.4s 27085 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30692.4s 27086 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30692.4s 27087 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30692.4s 27088 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30692.4s 27089 [REWARD_MICROSCOPE] step=14971 t=765.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30692.4s 27090 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30692.4s 27091 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30692.4s 27092 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30692.4s 27093 Running simulation until t = 780.00 s, outputting every 15.00 s
30692.4s 27094 
30692.6s 27095 [WARNING] Automatic CFL correction applied (count: 3378700):
30692.6s 27096 Calculated CFL: 0.800 > Limit: 0.500
30692.6s 27097 Original dt: 3.408050e-01 s
30692.6s 27098 Corrected dt: 2.130031e-01 s
30692.6s 27099 Correction factor: 1.6x
30692.6s 27100 Max wave speed detected: 23.47 m/s
30692.9s 27101 [PROGRESS] Step 3650: t=775.01/780.00s (99.4%) | dt=0.2132s
30693.1s 27102 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 765.0/780.0 [00:00<?, ?s/s][A
30693.1s 27103 Stored output at t = 780.0000 s (Step 3674)
30693.1s 27104 [A
30693.1s 27105 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 23.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 780.0/780.0 [00:00<00:00, 23.62s/s]
30693.1s 27106 
30693.1s 27107 Simulation finished at t = 780.0000 s after 3674 steps.
30693.1s 27108 Total runtime: 0.64 seconds.
30693.1s 27109 [REWARD_MICROSCOPE] step=14972 t=780.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30693.1s 27110 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30693.1s 27111 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30693.1s 27112 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30693.1s 27113 Running simulation until t = 795.00 s, outputting every 15.00 s
30693.1s 27114 
30693.3s 27115 [PROGRESS] Step 3700: t=785.52/795.00s (98.8%) | dt=0.2124s
30693.5s 27116 [WARNING] Automatic CFL correction applied (count: 3378800):
30693.5s 27117 Calculated CFL: 0.800 > Limit: 0.500
30693.5s 27118 Original dt: 3.402313e-01 s
30693.5s 27119 Corrected dt: 2.126446e-01 s
30693.5s 27120 Correction factor: 1.6x
30693.5s 27121 Max wave speed detected: 23.51 m/s
30693.7s 27122 Stored output at t = 795.0000 s (Step 3745)
30693.7s 27123 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 780.0/795.0 [00:00<?, ?s/s][A
30693.7s 27124 [A
30693.7s 27125 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 795.0/795.0 [00:00<00:00, 24.22s/s]
30693.7s 27126 
30693.7s 27127 Simulation finished at t = 795.0000 s after 3745 steps.
30693.7s 27128 Total runtime: 0.62 seconds.
30693.7s 27129 [REWARD_MICROSCOPE] step=14973 t=795.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30693.7s 27130 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30693.7s 27131 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30693.7s 27132 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30693.7s 27133 Running simulation until t = 810.00 s, outputting every 15.00 s
30693.7s 27134 
30693.7s 27135 [PROGRESS] Step 3750: t=796.06/810.00s (98.3%) | dt=0.2129s
30694.2s 27136 [PROGRESS] Step 3800: t=806.72/810.00s (99.6%) | dt=0.2133s
30694.3s 27137 Stored output at t = 810.0000 s (Step 3816)
30694.3s 27138 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 795.0/810.0 [00:00<?, ?s/s][A
30694.3s 27139 [A
30694.3s 27140 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 810.0/810.0 [00:00<00:00, 23.52s/s]
30694.3s 27141 
30694.3s 27142 Simulation finished at t = 810.0000 s after 3816 steps.
30694.3s 27143 Total runtime: 0.64 seconds.
30694.3s 27144 [REWARD_MICROSCOPE] step=14974 t=810.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30694.3s 27145 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30694.3s 27146 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30694.3s 27147 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30694.3s 27148 Running simulation until t = 825.00 s, outputting every 15.00 s
30694.3s 27149 
30694.3s 27150 [PERIODIC:1000] BC_DISPATCHER [Call #13516000] current_bc_params: <class 'dict'>
30694.3s 27151 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30694.3s 27152 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30694.3s 27153 [PERIODIC:1000] BC_GPU [Call #13516000] About to launch kernel
30694.3s 27154 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30694.3s 27155 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30694.3s 27156 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30694.4s 27157 [WARNING] Automatic CFL correction applied (count: 3378900):
30694.4s 27158 Calculated CFL: 0.800 > Limit: 0.500
30694.4s 27159 Original dt: 3.398030e-01 s
30694.4s 27160 Corrected dt: 2.123769e-01 s
30694.4s 27161 Correction factor: 1.6x
30694.4s 27162 Max wave speed detected: 23.54 m/s
30694.6s 27163 [PROGRESS] Step 3850: t=817.22/825.00s (99.1%) | dt=0.2125s
30695.0s 27164 Stored output at t = 825.0000 s (Step 3887)
30695.0s 27165 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 810.0/825.0 [00:00<?, ?s/s][A
30695.0s 27166 [A
30695.0s 27167 
30695.0s 27168 Simulation finished at t = 825.0000 s after 3887 steps.
30695.0s 27169 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 825.0/825.0 [00:00<00:00, 24.07s/s]
30695.0s 27170 Total runtime: 0.62 seconds.
30695.0s 27171 [REWARD_MICROSCOPE] step=14975 t=825.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30695.0s 27172 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30695.0s 27173 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30695.0s 27174 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30695.0s 27175 Running simulation until t = 840.00 s, outputting every 15.00 s
30695.0s 27176 
30695.1s 27177 [PROGRESS] Step 3900: t=827.77/840.00s (98.5%) | dt=0.2129s
30695.3s 27178 [WARNING] Automatic CFL correction applied (count: 3379000):
30695.3s 27179 Calculated CFL: 0.800 > Limit: 0.500
30695.3s 27180 Original dt: 3.410260e-01 s
30695.3s 27181 Corrected dt: 2.131412e-01 s
30695.3s 27182 Correction factor: 1.6x
30695.3s 27183 Max wave speed detected: 23.46 m/s
30695.5s 27184 [PROGRESS] Step 3950: t=838.42/840.00s (99.8%) | dt=0.2128s
30695.6s 27185 Stored output at t = 840.0000 s (Step 3958)
30695.6s 27186 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 825.0/840.0 [00:00<?, ?s/s][A
30695.6s 27187 [A
30695.6s 27188 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 840.0/840.0 [00:00<00:00, 24.03s/s]
30695.6s 27189 
30695.6s 27190 Simulation finished at t = 840.0000 s after 3958 steps.
30695.6s 27191 Total runtime: 0.62 seconds.
30695.6s 27192 [REWARD_MICROSCOPE] step=14976 t=840.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30695.6s 27193 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30695.6s 27194 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30695.6s 27195 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30695.6s 27196 Running simulation until t = 855.00 s, outputting every 15.00 s
30695.6s 27197 
30696.0s 27198 [PROGRESS] Step 4000: t=848.92/855.00s (99.3%) | dt=0.2126s
30696.2s 27199 [WARNING] Automatic CFL correction applied (count: 3379100):
30696.2s 27200 Calculated CFL: 0.800 > Limit: 0.500
30696.2s 27201 Original dt: 3.404547e-01 s
30696.2s 27202 Corrected dt: 2.127842e-01 s
30696.2s 27203 Correction factor: 1.6x
30696.2s 27204 Max wave speed detected: 23.50 m/s
30696.2s 27205 Stored output at t = 855.0000 s (Step 4029)
30696.2s 27206 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 840.0/855.0 [00:00<?, ?s/s][A
30696.2s 27207 [A
30696.2s 27208 
30696.2s 27209 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855.0/855.0 [00:00<00:00, 24.01s/s]
30696.2s 27210 Simulation finished at t = 855.0000 s after 4029 steps.
30696.2s 27211 Total runtime: 0.63 seconds.
30696.2s 27212 [REWARD_MICROSCOPE] step=14977 t=855.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30696.2s 27213 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30696.2s 27214 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30696.2s 27215 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30696.2s 27216 Running simulation until t = 870.00 s, outputting every 15.00 s
30696.2s 27217 
30696.4s 27218 [PROGRESS] Step 4050: t=859.47/870.00s (98.8%) | dt=0.2130s
30696.5s 27219 [PERIODIC:1000] BC_DISPATCHER [Call #13517000] current_bc_params: <class 'dict'>
30696.5s 27220 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30696.5s 27221 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30696.5s 27222 [PERIODIC:1000] BC_GPU [Call #13517000] About to launch kernel
30696.5s 27223 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30696.5s 27224 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30696.5s 27225 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30696.9s 27226 [PROGRESS] Step 4100: t=870.00/870.00s (100.0%) | dt=0.0883s
30696.9s 27227 Stored output at t = 870.0000 s (Step 4100)
30696.9s 27228 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 855.0/870.0 [00:00<?, ?s/s][A
30696.9s 27229 [A
30696.9s 27230 
30696.9s 27231 Simulation finished at t = 870.0000 s after 4100 steps.
30696.9s 27232 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 21.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 870.0/870.0 [00:00<00:00, 21.70s/s]
30696.9s 27233 Total runtime: 0.69 seconds.
30696.9s 27234 [REWARD_MICROSCOPE] step=14978 t=870.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30696.9s 27235 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30696.9s 27236 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30696.9s 27237 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30696.9s 27238 Running simulation until t = 885.00 s, outputting every 15.00 s
30696.9s 27239 
30697.2s 27240 [WARNING] Automatic CFL correction applied (count: 3379200):
30697.2s 27241 Calculated CFL: 0.800 > Limit: 0.500
30697.2s 27242 Original dt: 3.398585e-01 s
30697.2s 27243 Corrected dt: 2.124115e-01 s
30697.2s 27244 Correction factor: 1.6x
30697.2s 27245 Max wave speed detected: 23.54 m/s
30697.5s 27246 [PROGRESS] Step 4150: t=880.62/885.00s (99.5%) | dt=0.2127s
30697.7s 27247 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 870.0/885.0 [00:00<?, ?s/s][A
30697.7s 27248 Stored output at t = 885.0000 s (Step 4171)
30697.7s 27249 [A
30697.7s 27250 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 19.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 885.0/885.0 [00:00<00:00, 19.96s/s]
30697.7s 27251 
30697.7s 27252 Simulation finished at t = 885.0000 s after 4171 steps.
30697.7s 27253 Total runtime: 0.75 seconds.
30697.7s 27254 [REWARD_MICROSCOPE] step=14979 t=885.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30697.7s 27255 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30697.7s 27256 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30697.7s 27257 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30697.7s 27258 Running simulation until t = 900.00 s, outputting every 15.00 s
30697.7s 27259 
30698.0s 27260 [PROGRESS] Step 4200: t=891.18/900.00s (99.0%) | dt=0.2131s
30698.2s 27261 [WARNING] Automatic CFL correction applied (count: 3379300):
30698.2s 27262 Calculated CFL: 0.800 > Limit: 0.500
30698.2s 27263 Original dt: 3.412422e-01 s
30698.2s 27264 Corrected dt: 2.132764e-01 s
30698.2s 27265 Correction factor: 1.6x
30698.2s 27266 Max wave speed detected: 23.44 m/s
30698.4s 27267 Stored output at t = 900.0000 s (Step 4242)
30698.4s 27268 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 885.0/900.0 [00:00<?, ?s/s][A
30698.4s 27269 [A
30698.4s 27270 
30698.4s 27271 Simulation finished at t = 900.0000 s after 4242 steps.
30698.4s 27272 Total runtime: 0.72 seconds.
30698.4s 27273 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 20.81s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 900.0/900.0 [00:00<00:00, 20.81s/s]
30698.4s 27274 [REWARD_MICROSCOPE] step=14980 t=900.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30698.4s 27275 [STEP   60] t=  900.0s | phase=0 | reward=   0.01 | total_reward=    0.60
30698.4s 27276 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30698.4s 27277 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30698.4s 27278 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30698.4s 27279 Running simulation until t = 915.00 s, outputting every 15.00 s
30698.4s 27280 
30698.5s 27281 [PROGRESS] Step 4250: t=901.70/915.00s (98.5%) | dt=0.2124s
30698.9s 27282 [PROGRESS] Step 4300: t=912.32/915.00s (99.7%) | dt=0.2127s
30699.0s 27283 Stored output at t = 915.0000 s (Step 4313)
30699.0s 27284 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 900.0/915.0 [00:00<?, ?s/s][A
30699.0s 27285 [A
30699.0s 27286 
30699.0s 27287 Simulation finished at t = 915.0000 s after 4313 steps.
30699.0s 27288 Total runtime: 0.62 seconds.
30699.0s 27289 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 24.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 915.0/915.0 [00:00<00:00, 24.05s/s]
30699.0s 27290 [QUEUE_DIAGNOSTIC] ===== Step 60 t=915.0s =====
30699.0s 27291 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30699.0s 27292 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30699.0s 27293 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30699.0s 27294 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30699.0s 27295 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30699.0s 27296 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30699.0s 27297 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30699.0s 27298 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30699.0s 27299 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30699.0s 27300 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30699.0s 27301 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30699.0s 27302 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30699.0s 27303 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30699.0s 27304 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30699.0s 27305 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30699.0s 27306 [REWARD_MICROSCOPE] step=14981 t=915.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30699.0s 27307 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30699.0s 27308 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30699.0s 27309 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30699.0s 27310 Running simulation until t = 930.00 s, outputting every 15.00 s
30699.0s 27311 
30699.1s 27312 [PERIODIC:1000] BC_DISPATCHER [Call #13518000] current_bc_params: <class 'dict'>
30699.1s 27313 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30699.1s 27314 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30699.1s 27315 [PERIODIC:1000] BC_GPU [Call #13518000] About to launch kernel
30699.1s 27316 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30699.1s 27317 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30699.1s 27318 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30699.1s 27319 [WARNING] Automatic CFL correction applied (count: 3379400):
30699.1s 27320 Calculated CFL: 0.800 > Limit: 0.500
30699.1s 27321 Original dt: 3.406657e-01 s
30699.1s 27322 Corrected dt: 2.129161e-01 s
30699.1s 27323 Correction factor: 1.6x
30699.1s 27324 Max wave speed detected: 23.48 m/s
30699.4s 27325 [PROGRESS] Step 4350: t=922.88/930.00s (99.2%) | dt=0.2131s
30699.7s 27326 Stored output at t = 930.0000 s (Step 4384)
30699.7s 27327 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 915.0/930.0 [00:00<?, ?s/s][A
30699.7s 27328 [A
30699.7s 27329 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 930.0/930.0 [00:00<00:00, 23.56s/s]
30699.7s 27330 
30699.7s 27331 Simulation finished at t = 930.0000 s after 4384 steps.
30699.7s 27332 Total runtime: 0.64 seconds.
30699.7s 27333 [REWARD_MICROSCOPE] step=14982 t=930.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30699.7s 27334 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30699.7s 27335 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30699.7s 27336 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30699.7s 27337 Running simulation until t = 945.00 s, outputting every 15.00 s
30699.7s 27338 
30699.8s 27339 [PROGRESS] Step 4400: t=933.40/945.00s (98.8%) | dt=0.2123s
30700.0s 27340 [WARNING] Automatic CFL correction applied (count: 3379500):
30700.0s 27341 Calculated CFL: 0.800 > Limit: 0.500
30700.0s 27342 Original dt: 3.400921e-01 s
30700.0s 27343 Corrected dt: 2.125575e-01 s
30700.0s 27344 Correction factor: 1.6x
30700.0s 27345 Max wave speed detected: 23.52 m/s
30700.3s 27346 [PROGRESS] Step 4450: t=944.03/945.00s (99.9%) | dt=0.2128s
30700.4s 27347 Stored output at t = 945.0000 s (Step 4455)
30700.4s 27348 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 930.0/945.0 [00:00<?, ?s/s][A
30700.4s 27349 [A
30700.4s 27350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 21.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 945.0/945.0 [00:00<00:00, 21.49s/s]
30700.4s 27351 
30700.4s 27352 Simulation finished at t = 945.0000 s after 4455 steps.
30700.4s 27353 Total runtime: 0.70 seconds.
30700.4s 27354 [REWARD_MICROSCOPE] step=14983 t=945.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30700.4s 27355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30700.4s 27356 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30700.4s 27357 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30700.4s 27358 Running simulation until t = 960.00 s, outputting every 15.00 s
30700.4s 27359 
30700.8s 27360 [PROGRESS] Step 4500: t=954.59/960.00s (99.4%) | dt=0.2132s
30701.0s 27361 [WARNING] Automatic CFL correction applied (count: 3379600):
30701.0s 27362 Calculated CFL: 0.800 > Limit: 0.500
30701.0s 27363 Original dt: 3.402189e-01 s
30701.0s 27364 Corrected dt: 2.126368e-01 s
30701.0s 27365 Correction factor: 1.6x
30701.0s 27366 Max wave speed detected: 23.51 m/s
30701.0s 27367 Stored output at t = 960.0000 s (Step 4526)
30701.0s 27368 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 945.0/960.0 [00:00<?, ?s/s][A
30701.0s 27369 [A
30701.0s 27370 
30701.0s 27371 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 960.0/960.0 [00:00<00:00, 23.00s/s]
30701.0s 27372 Simulation finished at t = 960.0000 s after 4526 steps.
30701.0s 27373 Total runtime: 0.65 seconds.
30701.0s 27374 [REWARD_MICROSCOPE] step=14984 t=960.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30701.0s 27375 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30701.0s 27376 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30701.0s 27377 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30701.0s 27378 Running simulation until t = 975.00 s, outputting every 15.00 s
30701.0s 27379 
30701.2s 27380 [PROGRESS] Step 4550: t=965.10/975.00s (99.0%) | dt=0.2124s
30701.4s 27381 [PERIODIC:1000] BC_DISPATCHER [Call #13519000] current_bc_params: <class 'dict'>
30701.4s 27382 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30701.4s 27383 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30701.4s 27384 [PERIODIC:1000] BC_GPU [Call #13519000] About to launch kernel
30701.4s 27385 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30701.4s 27386 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30701.4s 27387 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30701.6s 27388 Stored output at t = 975.0000 s (Step 4597)
30701.6s 27389 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 960.0/975.0 [00:00<?, ?s/s][A
30701.6s 27390 [A
30701.6s 27391 
30701.6s 27392 Simulation finished at t = 975.0000 s after 4597 steps.
30701.6s 27393 Total runtime: 0.62 seconds.
30701.6s 27394 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 975.0/975.0 [00:00<00:00, 24.15s/s]
30701.6s 27395 [REWARD_MICROSCOPE] step=14985 t=975.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30701.6s 27396 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30701.6s 27397 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30701.6s 27398 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30701.6s 27399 Running simulation until t = 990.00 s, outputting every 15.00 s
30701.6s 27400 
30701.7s 27401 [PROGRESS] Step 4600: t=975.64/990.00s (98.5%) | dt=0.2129s
30701.9s 27402 [WARNING] Automatic CFL correction applied (count: 3379700):
30701.9s 27403 Calculated CFL: 0.800 > Limit: 0.500
30701.9s 27404 Original dt: 3.408895e-01 s
30701.9s 27405 Corrected dt: 2.130559e-01 s
30701.9s 27406 Correction factor: 1.6x
30701.9s 27407 Max wave speed detected: 23.47 m/s
30702.1s 27408 [PROGRESS] Step 4650: t=986.29/990.00s (99.6%) | dt=0.2133s
30702.3s 27409 Stored output at t = 990.0000 s (Step 4668)
30702.3s 27410 Running Simulation:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975.0/990.0 [00:00<?, ?s/s][A
30702.3s 27411 [A
30702.3s 27412 
30702.3s 27413 Simulation finished at t = 990.0000 s after 4668 steps.
30702.3s 27414 Total runtime: 0.62 seconds.
30702.3s 27415 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 990.0/990.0 [00:00<00:00, 24.18s/s]
30702.3s 27416 [REWARD_MICROSCOPE] step=14986 t=990.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30702.3s 27417 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30702.3s 27418 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30702.3s 27419 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30702.3s 27420 Running simulation until t = 1005.00 s, outputting every 15.00 s
30702.3s 27421 
30702.5s 27422 [PROGRESS] Step 4700: t=996.80/1005.00s (99.2%) | dt=0.2125s
30702.7s 27423 [WARNING] Automatic CFL correction applied (count: 3379800):
30702.7s 27424 Calculated CFL: 0.800 > Limit: 0.500
30702.7s 27425 Original dt: 3.403151e-01 s
30702.7s 27426 Corrected dt: 2.126969e-01 s
30702.7s 27427 Correction factor: 1.6x
30702.7s 27428 Max wave speed detected: 23.51 m/s
30702.9s 27429 Stored output at t = 1005.0000 s (Step 4739)
30702.9s 27430 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 990.0/1005.0 [00:00<?, ?s/s][A
30702.9s 27431 [A
30702.9s 27432 
30702.9s 27433 Simulation finished at t = 1005.0000 s after 4739 steps.
30702.9s 27434 Total runtime: 0.62 seconds.
30702.9s 27435 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1005.0/1005.0 [00:00<00:00, 24.09s/s]
30702.9s 27436 [REWARD_MICROSCOPE] step=14987 t=1005.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30702.9s 27437 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30702.9s 27438 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30702.9s 27439 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30702.9s 27440 Running simulation until t = 1020.00 s, outputting every 15.00 s
30702.9s 27441 
30703.0s 27442 [PROGRESS] Step 4750: t=1007.34/1020.00s (98.8%) | dt=0.2129s
30703.4s 27443 [PROGRESS] Step 4800: t=1018.00/1020.00s (99.8%) | dt=0.2129s
30703.5s 27444 Stored output at t = 1020.0000 s (Step 4810)
30703.5s 27445 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1005.0/1020.0 [00:00<?, ?s/s][A
30703.5s 27446 [A
30703.5s 27447 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1020.0/1020.0 [00:00<00:00, 23.99s/s]
30703.5s 27448 
30703.5s 27449 Simulation finished at t = 1020.0000 s after 4810 steps.
30703.5s 27450 Total runtime: 0.63 seconds.
30703.5s 27451 [REWARD_MICROSCOPE] step=14988 t=1020.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30703.5s 27452 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30703.5s 27453 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30703.5s 27454 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30703.5s 27455 Running simulation until t = 1035.00 s, outputting every 15.00 s
30703.5s 27456 
30703.6s 27457 [PERIODIC:1000] BC_DISPATCHER [Call #13520000] current_bc_params: <class 'dict'>
30703.6s 27458 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30703.6s 27459 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30703.6s 27460 [PERIODIC:1000] BC_GPU [Call #13520000] About to launch kernel
30703.6s 27461 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30703.6s 27462 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30703.6s 27463 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30703.6s 27464 [WARNING] Automatic CFL correction applied (count: 3379900):
30703.6s 27465 Calculated CFL: 0.800 > Limit: 0.500
30703.6s 27466 Original dt: 3.397193e-01 s
30703.6s 27467 Corrected dt: 2.123245e-01 s
30703.6s 27468 Correction factor: 1.6x
30703.6s 27469 Max wave speed detected: 23.55 m/s
30703.9s 27470 [PROGRESS] Step 4850: t=1028.50/1035.00s (99.4%) | dt=0.2126s
30704.1s 27471 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1020.0/1035.0 [00:00<?, ?s/s][A
30704.1s 27472 [A
30704.1s 27473 Stored output at t = 1035.0000 s (Step 4881)
30704.1s 27474 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 23.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1035.0/1035.0 [00:00<00:00, 23.94s/s]
30704.1s 27475 
30704.1s 27476 Simulation finished at t = 1035.0000 s after 4881 steps.
30704.1s 27477 Total runtime: 0.63 seconds.
30704.1s 27478 [REWARD_MICROSCOPE] step=14989 t=1035.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30704.2s 27479 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30704.2s 27480 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30704.2s 27481 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30704.2s 27482 Running simulation until t = 1050.00 s, outputting every 15.00 s
30704.2s 27483 
30704.3s 27484 [PROGRESS] Step 4900: t=1039.05/1050.00s (99.0%) | dt=0.2130s
30704.5s 27485 [WARNING] Automatic CFL correction applied (count: 3380000):
30704.5s 27486 Calculated CFL: 0.800 > Limit: 0.500
30704.5s 27487 Original dt: 3.411064e-01 s
30704.5s 27488 Corrected dt: 2.131915e-01 s
30704.5s 27489 Correction factor: 1.6x
30704.5s 27490 Max wave speed detected: 23.45 m/s
30704.7s 27491 [PROGRESS] Step 4950: t=1049.70/1050.00s (100.0%) | dt=0.2126s
30704.8s 27492 Stored output at t = 1050.0000 s (Step 4952)
30704.8s 27493 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1035.0/1050.0 [00:00<?, ?s/s][A
30704.8s 27494 [A
30704.8s 27495 
30704.8s 27496 Simulation finished at t = 1050.0000 s after 4952 steps.
30704.8s 27497 Total runtime: 0.62 seconds.
30704.8s 27498 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1050.0/1050.0 [00:00<00:00, 24.39s/s]
30704.8s 27499 [REWARD_MICROSCOPE] step=14990 t=1050.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30704.8s 27500 [STEP   70] t= 1050.0s | phase=0 | reward=   0.01 | total_reward=    0.70
30704.8s 27501 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30704.8s 27502 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30704.8s 27503 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30704.8s 27504 Running simulation until t = 1065.00 s, outputting every 15.00 s
30704.8s 27505 
30705.2s 27506 [PROGRESS] Step 5000: t=1060.20/1065.00s (99.5%) | dt=0.2126s
30705.4s 27507 [WARNING] Automatic CFL correction applied (count: 3380100):
30705.4s 27508 Calculated CFL: 0.800 > Limit: 0.500
30705.4s 27509 Original dt: 3.405361e-01 s
30705.4s 27510 Corrected dt: 2.128351e-01 s
30705.4s 27511 Correction factor: 1.6x
30705.4s 27512 Max wave speed detected: 23.49 m/s
30705.4s 27513 Stored output at t = 1065.0000 s (Step 5023)
30705.4s 27514 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1050.0/1065.0 [00:00<?, ?s/s][A
30705.4s 27515 [A
30705.4s 27516 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1065.0/1065.0 [00:00<00:00, 24.30s/s]
30705.4s 27517 
30705.4s 27518 Simulation finished at t = 1065.0000 s after 5023 steps.
30705.4s 27519 Total runtime: 0.62 seconds.
30705.4s 27520 [QUEUE_DIAGNOSTIC] ===== Step 70 t=1065.0s =====
30705.4s 27521 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30705.4s 27522 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30705.4s 27523 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30705.4s 27524 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30705.4s 27525 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30705.4s 27526 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30705.4s 27527 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30705.4s 27528 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30705.4s 27529 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30705.4s 27530 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30705.4s 27531 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30705.4s 27532 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30705.4s 27533 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30705.4s 27534 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30705.4s 27535 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30705.4s 27536 [REWARD_MICROSCOPE] step=14991 t=1065.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30705.4s 27537 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30705.4s 27538 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30705.4s 27539 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30705.4s 27540 Running simulation until t = 1080.00 s, outputting every 15.00 s
30705.4s 27541 
30705.6s 27542 [PROGRESS] Step 5050: t=1070.75/1080.00s (99.1%) | dt=0.2131s
30705.8s 27543 [PERIODIC:1000] BC_DISPATCHER [Call #13521000] current_bc_params: <class 'dict'>
30705.8s 27544 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30705.8s 27545 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30705.8s 27546 [PERIODIC:1000] BC_GPU [Call #13521000] About to launch kernel
30705.8s 27547 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30705.8s 27548 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30705.8s 27549 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30706.0s 27550 Stored output at t = 1080.0000 s (Step 5094)
30706.0s 27551 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1065.0/1080.0 [00:00<?, ?s/s][A
30706.0s 27552 [A
30706.0s 27553 
30706.0s 27554 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.02s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080.0/1080.0 [00:00<00:00, 24.02s/s]
30706.0s 27555 Simulation finished at t = 1080.0000 s after 5094 steps.
30706.0s 27556 Total runtime: 0.62 seconds.
30706.0s 27557 [REWARD_MICROSCOPE] step=14992 t=1080.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30706.0s 27558 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30706.0s 27559 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30706.0s 27560 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30706.0s 27561 Running simulation until t = 1095.00 s, outputting every 15.00 s
30706.0s 27562 
30706.1s 27563 [PROGRESS] Step 5100: t=1081.27/1095.00s (98.7%) | dt=0.2124s
30706.3s 27564 [WARNING] Automatic CFL correction applied (count: 3380200):
30706.3s 27565 Calculated CFL: 0.800 > Limit: 0.500
30706.3s 27566 Original dt: 3.399493e-01 s
30706.3s 27567 Corrected dt: 2.124683e-01 s
30706.3s 27568 Correction factor: 1.6x
30706.3s 27569 Max wave speed detected: 23.53 m/s
30706.5s 27570 [PROGRESS] Step 5150: t=1091.90/1095.00s (99.7%) | dt=0.2127s
30706.6s 27571 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1080.0/1095.0 [00:00<?, ?s/s][A
30706.6s 27572 [A
30706.6s 27573 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1095.0/1095.0 [00:00<00:00, 24.07s/s]
30706.6s 27574 Stored output at t = 1095.0000 s (Step 5165)
30706.6s 27575 
30706.6s 27576 Simulation finished at t = 1095.0000 s after 5165 steps.
30706.6s 27577 Total runtime: 0.62 seconds.
30706.6s 27578 [REWARD_MICROSCOPE] step=14993 t=1095.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30706.6s 27579 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30706.6s 27580 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30706.6s 27581 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30706.6s 27582 Running simulation until t = 1110.00 s, outputting every 15.00 s
30706.6s 27583 
30707.0s 27584 [PROGRESS] Step 5200: t=1102.45/1110.00s (99.3%) | dt=0.2131s
30707.1s 27585 [WARNING] Automatic CFL correction applied (count: 3380300):
30707.1s 27586 Calculated CFL: 0.800 > Limit: 0.500
30707.1s 27587 Original dt: 3.409227e-01 s
30707.1s 27588 Corrected dt: 2.130767e-01 s
30707.1s 27589 Correction factor: 1.6x
30707.1s 27590 Max wave speed detected: 23.47 m/s
30707.3s 27591 Stored output at t = 1110.0000 s (Step 5236)
30707.3s 27592 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1095.0/1110.0 [00:00<?, ?s/s][A
30707.3s 27593 [A
30707.3s 27594 
30707.3s 27595 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.03s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1110.0/1110.0 [00:00<00:00, 24.03s/s]
30707.3s 27596 Simulation finished at t = 1110.0000 s after 5236 steps.
30707.3s 27597 Total runtime: 0.62 seconds.
30707.3s 27598 [REWARD_MICROSCOPE] step=14994 t=1110.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30707.3s 27599 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30707.3s 27600 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30707.3s 27601 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30707.3s 27602 Running simulation until t = 1125.00 s, outputting every 15.00 s
30707.3s 27603 
30707.4s 27604 [PROGRESS] Step 5250: t=1112.97/1125.00s (98.9%) | dt=0.2123s
30707.8s 27605 [PROGRESS] Step 5300: t=1123.60/1125.00s (99.9%) | dt=0.2128s
30707.9s 27606 Stored output at t = 1125.0000 s (Step 5307)
30707.9s 27607 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1110.0/1125.0 [00:00<?, ?s/s][A
30707.9s 27608 [A
30707.9s 27609 
30707.9s 27610 Simulation finished at t = 1125.0000 s after 5307 steps.
30707.9s 27611 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 23.61s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1125.0/1125.0 [00:00<00:00, 23.60s/s]
30707.9s 27612 Total runtime: 0.64 seconds.
30707.9s 27613 [REWARD_MICROSCOPE] step=14995 t=1125.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30707.9s 27614 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30707.9s 27615 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30707.9s 27616 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30707.9s 27617 Running simulation until t = 1140.00 s, outputting every 15.00 s
30707.9s 27618 
30708.0s 27619 [PERIODIC:1000] BC_DISPATCHER [Call #13522000] current_bc_params: <class 'dict'>
30708.0s 27620 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30708.0s 27621 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30708.0s 27622 [PERIODIC:1000] BC_GPU [Call #13522000] About to launch kernel
30708.0s 27623 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30708.0s 27624 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30708.0s 27625 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30708.0s 27626 [WARNING] Automatic CFL correction applied (count: 3380400):
30708.0s 27627 Calculated CFL: 0.800 > Limit: 0.500
30708.0s 27628 Original dt: 3.407491e-01 s
30708.0s 27629 Corrected dt: 2.129682e-01 s
30708.0s 27630 Correction factor: 1.6x
30708.0s 27631 Max wave speed detected: 23.48 m/s
30708.3s 27632 [PROGRESS] Step 5350: t=1134.16/1140.00s (99.5%) | dt=0.2132s
30708.5s 27633 Stored output at t = 1140.0000 s (Step 5378)
30708.5s 27634 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1125.0/1140.0 [00:00<?, ?s/s][A
30708.5s 27635 [A
30708.5s 27636 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1140.0/1140.0 [00:00<00:00, 24.03s/s]
30708.5s 27637 
30708.5s 27638 Simulation finished at t = 1140.0000 s after 5378 steps.
30708.5s 27639 Total runtime: 0.62 seconds.
30708.5s 27640 [REWARD_MICROSCOPE] step=14996 t=1140.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30708.5s 27641 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30708.5s 27642 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30708.5s 27643 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30708.5s 27644 Running simulation until t = 1155.00 s, outputting every 15.00 s
30708.5s 27645 
30708.7s 27646 [PROGRESS] Step 5400: t=1144.67/1155.00s (99.1%) | dt=0.2124s
30708.9s 27647 [WARNING] Automatic CFL correction applied (count: 3380500):
30708.9s 27648 Calculated CFL: 0.800 > Limit: 0.500
30708.9s 27649 Original dt: 3.401756e-01 s
30708.9s 27650 Corrected dt: 2.126097e-01 s
30708.9s 27651 Correction factor: 1.6x
30708.9s 27652 Max wave speed detected: 23.52 m/s
30709.2s 27653 Stored output at t = 1155.0000 s (Step 5449)
30709.2s 27654 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1140.0/1155.0 [00:00<?, ?s/s][A
30709.2s 27655 [A
30709.2s 27656 
30709.2s 27657 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.45s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1155.0/1155.0 [00:00<00:00, 24.44s/s]
30709.2s 27658 Simulation finished at t = 1155.0000 s after 5449 steps.
30709.2s 27659 Total runtime: 0.61 seconds.
30709.2s 27660 [REWARD_MICROSCOPE] step=14997 t=1155.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30709.2s 27661 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30709.2s 27662 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30709.2s 27663 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30709.2s 27664 Running simulation until t = 1170.00 s, outputting every 15.00 s
30709.2s 27665 
30709.2s 27666 [PROGRESS] Step 5450: t=1155.21/1170.00s (98.7%) | dt=0.2128s
30709.6s 27667 [PROGRESS] Step 5500: t=1165.87/1170.00s (99.6%) | dt=0.2133s
30709.8s 27668 Stored output at t = 1170.0000 s (Step 5520)
30709.8s 27669 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1155.0/1170.0 [00:00<?, ?s/s][A
30709.8s 27670 [A
30709.8s 27671 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.47s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1170.0/1170.0 [00:00<00:00, 24.46s/s]
30709.8s 27672 
30709.8s 27673 Simulation finished at t = 1170.0000 s after 5520 steps.
30709.8s 27674 Total runtime: 0.61 seconds.
30709.8s 27675 [REWARD_MICROSCOPE] step=14998 t=1170.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30709.8s 27676 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30709.8s 27677 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30709.8s 27678 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30709.8s 27679 Running simulation until t = 1185.00 s, outputting every 15.00 s
30709.8s 27680 
30709.8s 27681 [WARNING] Automatic CFL correction applied (count: 3380600):
30709.8s 27682 Calculated CFL: 0.800 > Limit: 0.500
30709.8s 27683 Original dt: 3.399530e-01 s
30709.8s 27684 Corrected dt: 2.124706e-01 s
30709.8s 27685 Correction factor: 1.6x
30709.8s 27686 Max wave speed detected: 23.53 m/s
30710.1s 27687 [PROGRESS] Step 5550: t=1176.37/1185.00s (99.3%) | dt=0.2125s
30710.2s 27688 [PERIODIC:1000] BC_DISPATCHER [Call #13523000] current_bc_params: <class 'dict'>
30710.2s 27689 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30710.2s 27690 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30710.2s 27691 [PERIODIC:1000] BC_GPU [Call #13523000] About to launch kernel
30710.2s 27692 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30710.2s 27693 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30710.2s 27694 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30710.4s 27695 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 1170.0/1185.0 [00:00<?, ?s/s][A
30710.4s 27696 [A
30710.4s 27697 Stored output at t = 1185.0000 s (Step 5591)
30710.4s 27698 
30710.4s 27699 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 23.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1185.0/1185.0 [00:00<00:00, 23.28s/s]
30710.4s 27700 Simulation finished at t = 1185.0000 s after 5591 steps.
30710.4s 27701 Total runtime: 0.64 seconds.
30710.4s 27702 [REWARD_MICROSCOPE] step=14999 t=1185.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30710.4s 27703 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30710.4s 27704 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30710.4s 27705 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30710.4s 27706 Running simulation until t = 1200.00 s, outputting every 15.00 s
30710.4s 27707 
30710.5s 27708 [PROGRESS] Step 5600: t=1186.92/1200.00s (98.9%) | dt=0.2129s
30710.7s 27709 [WARNING] Automatic CFL correction applied (count: 3380700):
30710.7s 27710 Calculated CFL: 0.800 > Limit: 0.500
30710.7s 27711 Original dt: 3.409728e-01 s
30710.7s 27712 Corrected dt: 2.131080e-01 s
30710.7s 27713 Correction factor: 1.6x
30710.7s 27714 Max wave speed detected: 23.46 m/s
30711.0s 27715 [PROGRESS] Step 5650: t=1197.57/1200.00s (99.8%) | dt=0.2130s
30711.1s 27716 Stored output at t = 1200.0000 s (Step 5662)
30711.1s 27717 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1185.0/1200.0 [00:00<?, ?s/s][A
30711.1s 27718 [A
30711.1s 27719 
30711.1s 27720 Simulation finished at t = 1200.0000 s after 5662 steps.
30711.1s 27721 Total runtime: 0.65 seconds.
30711.1s 27722 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1200.0/1200.0 [00:00<00:00, 23.16s/s]
30711.1s 27723 [REWARD_MICROSCOPE] step=15000 t=1200.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30711.1s 27724 [STEP   80] t= 1200.0s | phase=0 | reward=   0.01 | total_reward=    0.80
30711.1s 27725 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30711.1s 27726 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30711.1s 27727 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30711.1s 27728 Running simulation until t = 1215.00 s, outputting every 15.00 s
30711.1s 27729 
30711.4s 27730 [PROGRESS] Step 5700: t=1208.07/1215.00s (99.4%) | dt=0.2125s
30711.6s 27731 [WARNING] Automatic CFL correction applied (count: 3380800):
30711.6s 27732 Calculated CFL: 0.800 > Limit: 0.500
30711.6s 27733 Original dt: 3.403992e-01 s
30711.6s 27734 Corrected dt: 2.127495e-01 s
30711.6s 27735 Correction factor: 1.6x
30711.6s 27736 Max wave speed detected: 23.50 m/s
30711.7s 27737 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1200.0/1215.0 [00:00<?, ?s/s][A
30711.7s 27738 [A
30711.7s 27739 Stored output at t = 1215.0000 s (Step 5733)
30711.7s 27740 
30711.7s 27741 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.54s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1215.0/1215.0 [00:00<00:00, 24.53s/s]
30711.7s 27742 Simulation finished at t = 1215.0000 s after 5733 steps.
30711.7s 27743 Total runtime: 0.61 seconds.
30711.7s 27744 [QUEUE_DIAGNOSTIC] ===== Step 80 t=1215.0s =====
30711.7s 27745 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30711.7s 27746 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30711.7s 27747 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30711.7s 27748 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30711.7s 27749 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30711.7s 27750 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30711.7s 27751 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30711.7s 27752 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30711.7s 27753 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30711.7s 27754 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30711.7s 27755 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30711.7s 27756 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30711.7s 27757 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30711.7s 27758 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30711.7s 27759 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30711.7s 27760 [REWARD_MICROSCOPE] step=15001 t=1215.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30711.7s 27761 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30711.7s 27762 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30711.7s 27763 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30711.7s 27764 Running simulation until t = 1230.00 s, outputting every 15.00 s
30711.7s 27765 
30711.8s 27766 [PROGRESS] Step 5750: t=1218.62/1230.00s (99.1%) | dt=0.2130s
30712.3s 27767 [PROGRESS] Step 5800: t=1229.27/1230.00s (99.9%) | dt=0.2127s
30712.3s 27768 Stored output at t = 1230.0000 s (Step 5804)
30712.3s 27769 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1215.0/1230.0 [00:00<?, ?s/s][A
30712.3s 27770 [A
30712.3s 27771 
30712.3s 27772 Simulation finished at t = 1230.0000 s after 5804 steps.
30712.3s 27773 Total runtime: 0.65 seconds.
30712.3s 27774 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 23.19s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1230.0/1230.0 [00:00<00:00, 23.19s/s]
30712.3s 27775 [REWARD_MICROSCOPE] step=15002 t=1230.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30712.3s 27776 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30712.3s 27777 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30712.3s 27778 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30712.3s 27779 Running simulation until t = 1245.00 s, outputting every 15.00 s
30712.3s 27780 
30712.4s 27781 [PERIODIC:1000] BC_DISPATCHER [Call #13524000] current_bc_params: <class 'dict'>
30712.4s 27782 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30712.4s 27783 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30712.4s 27784 [PERIODIC:1000] BC_GPU [Call #13524000] About to launch kernel
30712.4s 27785 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30712.4s 27786 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30712.4s 27787 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30712.5s 27788 [WARNING] Automatic CFL correction applied (count: 3380900):
30712.5s 27789 Calculated CFL: 0.800 > Limit: 0.500
30712.5s 27790 Original dt: 3.397973e-01 s
30712.5s 27791 Corrected dt: 2.123733e-01 s
30712.5s 27792 Correction factor: 1.6x
30712.5s 27793 Max wave speed detected: 23.54 m/s
30712.7s 27794 [PROGRESS] Step 5850: t=1239.77/1245.00s (99.6%) | dt=0.2126s
30713.0s 27795 Stored output at t = 1245.0000 s (Step 5875)
30713.0s 27796 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1230.0/1245.0 [00:00<?, ?s/s][A
30713.0s 27797 [A
30713.0s 27798 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1245.0/1245.0 [00:00<00:00, 23.84s/s]
30713.0s 27799 
30713.0s 27800 Simulation finished at t = 1245.0000 s after 5875 steps.
30713.0s 27801 Total runtime: 0.63 seconds.
30713.0s 27802 [REWARD_MICROSCOPE] step=15003 t=1245.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30713.0s 27803 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30713.0s 27804 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30713.0s 27805 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30713.0s 27806 Running simulation until t = 1260.00 s, outputting every 15.00 s
30713.0s 27807 
30713.2s 27808 [PROGRESS] Step 5900: t=1250.32/1260.00s (99.2%) | dt=0.2130s
30713.4s 27809 [WARNING] Automatic CFL correction applied (count: 3381000):
30713.4s 27810 Calculated CFL: 0.800 > Limit: 0.500
30713.4s 27811 Original dt: 3.411876e-01 s
30713.4s 27812 Corrected dt: 2.132423e-01 s
30713.4s 27813 Correction factor: 1.6x
30713.4s 27814 Max wave speed detected: 23.45 m/s
30713.6s 27815 Stored output at t = 1260.0000 s (Step 5946)
30713.6s 27816 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1245.0/1260.0 [00:00<?, ?s/s][A
30713.6s 27817 [A
30713.6s 27818 
30713.6s 27819 Simulation finished at t = 1260.0000 s after 5946 steps.
30713.6s 27820 Total runtime: 0.62 seconds.
30713.6s 27821 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1260.0/1260.0 [00:00<00:00, 24.08s/s]
30713.6s 27822 [REWARD_MICROSCOPE] step=15004 t=1260.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30713.6s 27823 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30713.6s 27824 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30713.6s 27825 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30713.6s 27826 Running simulation until t = 1275.00 s, outputting every 15.00 s
30713.6s 27827 
30713.6s 27828 [PROGRESS] Step 5950: t=1260.85/1275.00s (98.9%) | dt=0.2124s
30714.1s 27829 [PROGRESS] Step 6000: t=1271.47/1275.00s (99.7%) | dt=0.2127s
30714.2s 27830 Stored output at t = 1275.0000 s (Step 6017)
30714.2s 27831 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1260.0/1275.0 [00:00<?, ?s/s][A
30714.2s 27832 [A
30714.2s 27833 
30714.2s 27834 Simulation finished at t = 1275.0000 s after 6017 steps.
30714.2s 27835 Total runtime: 0.62 seconds.
30714.2s 27836 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1275.0/1275.0 [00:00<00:00, 24.22s/s]
30714.2s 27837 [REWARD_MICROSCOPE] step=15005 t=1275.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30714.2s 27838 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30714.2s 27839 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30714.2s 27840 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30714.2s 27841 Running simulation until t = 1290.00 s, outputting every 15.00 s
30714.2s 27842 
30714.3s 27843 [WARNING] Automatic CFL correction applied (count: 3381100):
30714.3s 27844 Calculated CFL: 0.800 > Limit: 0.500
30714.3s 27845 Original dt: 3.406104e-01 s
30714.3s 27846 Corrected dt: 2.128815e-01 s
30714.3s 27847 Correction factor: 1.6x
30714.3s 27848 Max wave speed detected: 23.49 m/s
30714.5s 27849 [PROGRESS] Step 6050: t=1282.03/1290.00s (99.4%) | dt=0.2131s
30714.6s 27850 [PERIODIC:1000] BC_DISPATCHER [Call #13525000] current_bc_params: <class 'dict'>
30714.6s 27851 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30714.6s 27852 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30714.6s 27853 [PERIODIC:1000] BC_GPU [Call #13525000] About to launch kernel
30714.6s 27854 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30714.6s 27855 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30714.6s 27856 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30714.8s 27857 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1275.0/1290.0 [00:00<?, ?s/s][A
30714.8s 27858 [A
30714.8s 27859 Stored output at t = 1290.0000 s (Step 6088)
30714.8s 27860 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1290.0/1290.0 [00:00<00:00, 24.33s/s]
30714.8s 27861 
30714.8s 27862 Simulation finished at t = 1290.0000 s after 6088 steps.
30714.8s 27863 Total runtime: 0.62 seconds.
30714.8s 27864 [REWARD_MICROSCOPE] step=15006 t=1290.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30714.8s 27865 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30714.8s 27866 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30714.8s 27867 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30714.8s 27868 Running simulation until t = 1305.00 s, outputting every 15.00 s
30714.8s 27869 
30714.9s 27870 [PROGRESS] Step 6100: t=1292.55/1305.00s (99.0%) | dt=0.2123s
30715.1s 27871 [WARNING] Automatic CFL correction applied (count: 3381200):
30715.1s 27872 Calculated CFL: 0.800 > Limit: 0.500
30715.1s 27873 Original dt: 3.400365e-01 s
30715.1s 27874 Corrected dt: 2.125228e-01 s
30715.1s 27875 Correction factor: 1.6x
30715.1s 27876 Max wave speed detected: 23.53 m/s
30715.4s 27877 [PROGRESS] Step 6150: t=1303.18/1305.00s (99.9%) | dt=0.2128s
30715.5s 27878 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1290.0/1305.0 [00:00<?, ?s/s][A
30715.5s 27879 [A
30715.5s 27880 Stored output at t = 1305.0000 s (Step 6159)
30715.5s 27881 
30715.5s 27882 Simulation finished at t = 1305.0000 s after 6159 steps.
30715.5s 27883 Total runtime: 0.65 seconds.
30715.5s 27884 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 23.05s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1305.0/1305.0 [00:00<00:00, 23.04s/s]
30715.5s 27885 [REWARD_MICROSCOPE] step=15007 t=1305.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30715.5s 27886 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30715.5s 27887 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30715.5s 27888 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30715.5s 27889 Running simulation until t = 1320.00 s, outputting every 15.00 s
30715.5s 27890 
30715.8s 27891 [PROGRESS] Step 6200: t=1313.73/1320.00s (99.5%) | dt=0.2132s
30716.0s 27892 [WARNING] Automatic CFL correction applied (count: 3381300):
30716.0s 27893 Calculated CFL: 0.800 > Limit: 0.500
30716.0s 27894 Original dt: 3.404624e-01 s
30716.0s 27895 Corrected dt: 2.127890e-01 s
30716.0s 27896 Correction factor: 1.6x
30716.0s 27897 Max wave speed detected: 23.50 m/s
30716.1s 27898 Stored output at t = 1320.0000 s (Step 6230)
30716.1s 27899 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1305.0/1320.0 [00:00<?, ?s/s][A
30716.1s 27900 [A
30716.1s 27901 
30716.1s 27902 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1320.0/1320.0 [00:00<00:00, 23.89s/s]
30716.1s 27903 Simulation finished at t = 1320.0000 s after 6230 steps.
30716.1s 27904 Total runtime: 0.63 seconds.
30716.1s 27905 [REWARD_MICROSCOPE] step=15008 t=1320.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30716.1s 27906 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30716.1s 27907 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30716.1s 27908 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30716.1s 27909 Running simulation until t = 1335.00 s, outputting every 15.00 s
30716.1s 27910 
30716.3s 27911 [PROGRESS] Step 6250: t=1324.25/1335.00s (99.2%) | dt=0.2124s
30716.7s 27912 [PROGRESS] Step 6300: t=1334.88/1335.00s (100.0%) | dt=0.2128s
30716.8s 27913 Stored output at t = 1335.0000 s (Step 6301)
30716.8s 27914 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1320.0/1335.0 [00:00<?, ?s/s][A
30716.8s 27915 [A
30716.8s 27916 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1335.0/1335.0 [00:00<00:00, 23.73s/s]
30716.8s 27917 
30716.8s 27918 Simulation finished at t = 1335.0000 s after 6301 steps.
30716.8s 27919 Total runtime: 0.63 seconds.
30716.8s 27920 [REWARD_MICROSCOPE] step=15009 t=1335.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30716.8s 27921 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30716.8s 27922 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30716.8s 27923 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30716.8s 27924 Running simulation until t = 1350.00 s, outputting every 15.00 s
30716.8s 27925 
30716.9s 27926 [PERIODIC:1000] BC_DISPATCHER [Call #13526000] current_bc_params: <class 'dict'>
30716.9s 27927 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30716.9s 27928 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30716.9s 27929 [PERIODIC:1000] BC_GPU [Call #13526000] About to launch kernel
30716.9s 27930 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30716.9s 27931 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30716.9s 27932 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30716.9s 27933 [WARNING] Automatic CFL correction applied (count: 3381400):
30716.9s 27934 Calculated CFL: 0.800 > Limit: 0.500
30716.9s 27935 Original dt: 3.408331e-01 s
30716.9s 27936 Corrected dt: 2.130207e-01 s
30716.9s 27937 Correction factor: 1.6x
30716.9s 27938 Max wave speed detected: 23.47 m/s
30717.2s 27939 [PROGRESS] Step 6350: t=1345.44/1350.00s (99.7%) | dt=0.2133s
30717.4s 27940 Stored output at t = 1350.0000 s (Step 6372)
30717.4s 27941 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1335.0/1350.0 [00:00<?, ?s/s][A
30717.4s 27942 [A
30717.4s 27943 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 23.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1350.0/1350.0 [00:00<00:00, 23.69s/s]
30717.4s 27944 
30717.4s 27945 Simulation finished at t = 1350.0000 s after 6372 steps.
30717.4s 27946 Total runtime: 0.63 seconds.
30717.4s 27947 [REWARD_MICROSCOPE] step=15010 t=1350.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30717.4s 27948 [STEP   90] t= 1350.0s | phase=0 | reward=   0.01 | total_reward=    0.90
30717.4s 27949 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30717.4s 27950 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30717.4s 27951 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30717.4s 27952 Running simulation until t = 1365.00 s, outputting every 15.00 s
30717.4s 27953 
30717.6s 27954 [PROGRESS] Step 6400: t=1355.95/1365.00s (99.3%) | dt=0.2125s
30717.9s 27955 [WARNING] Automatic CFL correction applied (count: 3381500):
30717.9s 27956 Calculated CFL: 0.800 > Limit: 0.500
30717.9s 27957 Original dt: 3.402592e-01 s
30717.9s 27958 Corrected dt: 2.126620e-01 s
30717.9s 27959 Correction factor: 1.6x
30717.9s 27960 Max wave speed detected: 23.51 m/s
30718.1s 27961 Stored output at t = 1365.0000 s (Step 6443)
30718.1s 27962 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1350.0/1365.0 [00:00<?, ?s/s][A
30718.1s 27963 [A
30718.1s 27964 
30718.1s 27965 Simulation finished at t = 1365.0000 s after 6443 steps.
30718.1s 27966 Total runtime: 0.68 seconds.
30718.1s 27967 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 22.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1365.0/1365.0 [00:00<00:00, 22.19s/s]
30718.1s 27968 [QUEUE_DIAGNOSTIC] ===== Step 90 t=1365.0s =====
30718.1s 27969 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30718.1s 27970 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30718.1s 27971 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30718.1s 27972 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30718.1s 27973 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30718.1s 27974 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30718.1s 27975 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30718.1s 27976 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30718.1s 27977 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30718.1s 27978 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30718.1s 27979 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30718.1s 27980 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30718.1s 27981 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30718.1s 27982 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30718.1s 27983 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30718.1s 27984 [REWARD_MICROSCOPE] step=15011 t=1365.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30718.1s 27985 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30718.1s 27986 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30718.1s 27987 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30718.1s 27988 Running simulation until t = 1380.00 s, outputting every 15.00 s
30718.1s 27989 
30718.1s 27990 [PROGRESS] Step 6450: t=1366.49/1380.00s (99.0%) | dt=0.2129s
30718.6s 27991 [PROGRESS] Step 6500: t=1377.15/1380.00s (99.8%) | dt=0.2131s
30718.7s 27992 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1365.0/1380.0 [00:00<?, ?s/s][A
30718.7s 27993 [A
30718.7s 27994 Stored output at t = 1380.0000 s (Step 6514)
30718.7s 27995 
30718.7s 27996 Simulation finished at t = 1380.0000 s after 6514 steps.
30718.7s 27997 Total runtime: 0.62 seconds.
30718.7s 27998 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1380.0/1380.0 [00:00<00:00, 24.08s/s]
30718.7s 27999 [REWARD_MICROSCOPE] step=15012 t=1380.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30718.7s 28000 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30718.7s 28001 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30718.7s 28002 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30718.7s 28003 Running simulation until t = 1395.00 s, outputting every 15.00 s
30718.7s 28004 
30718.8s 28005 [WARNING] Automatic CFL correction applied (count: 3381600):
30718.8s 28006 Calculated CFL: 0.800 > Limit: 0.500
30718.8s 28007 Original dt: 3.397413e-01 s
30718.8s 28008 Corrected dt: 2.123383e-01 s
30718.8s 28009 Correction factor: 1.6x
30718.8s 28010 Max wave speed detected: 23.55 m/s
30719.0s 28011 [PROGRESS] Step 6550: t=1387.65/1395.00s (99.5%) | dt=0.2125s
30719.2s 28012 [PERIODIC:1000] BC_DISPATCHER [Call #13527000] current_bc_params: <class 'dict'>
30719.2s 28013 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30719.2s 28014 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30719.2s 28015 [PERIODIC:1000] BC_GPU [Call #13527000] About to launch kernel
30719.2s 28016 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30719.2s 28017 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30719.2s 28018 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30719.3s 28019 Stored output at t = 1395.0000 s (Step 6585)
30719.3s 28020 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1380.0/1395.0 [00:00<?, ?s/s][A
30719.3s 28021 [A
30719.3s 28022 
30719.3s 28023 Simulation finished at t = 1395.0000 s after 6585 steps.
30719.3s 28024 Total runtime: 0.62 seconds.
30719.3s 28025 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1395.0/1395.0 [00:00<00:00, 24.13s/s]
30719.3s 28026 [REWARD_MICROSCOPE] step=15013 t=1395.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30719.3s 28027 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30719.3s 28028 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30719.3s 28029 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30719.3s 28030 Running simulation until t = 1410.00 s, outputting every 15.00 s
30719.3s 28031 
30719.5s 28032 [PROGRESS] Step 6600: t=1398.19/1410.00s (99.2%) | dt=0.2130s
30719.6s 28033 [WARNING] Automatic CFL correction applied (count: 3381700):
30719.6s 28034 Calculated CFL: 0.800 > Limit: 0.500
30719.6s 28035 Original dt: 3.410527e-01 s
30719.6s 28036 Corrected dt: 2.131579e-01 s
30719.6s 28037 Correction factor: 1.6x
30719.6s 28038 Max wave speed detected: 23.46 m/s
30719.9s 28039 [PROGRESS] Step 6650: t=1408.85/1410.00s (99.9%) | dt=0.2127s
30719.9s 28040 Stored output at t = 1410.0000 s (Step 6656)
30719.9s 28041 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1395.0/1410.0 [00:00<?, ?s/s][A
30719.9s 28042 [A
30719.9s 28043 
30719.9s 28044 Simulation finished at t = 1410.0000 s after 6656 steps.
30719.9s 28045 Total runtime: 0.63 seconds.
30719.9s 28046 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 23.95s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1410.0/1410.0 [00:00<00:00, 23.94s/s]
30719.9s 28047 [REWARD_MICROSCOPE] step=15014 t=1410.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30720.0s 28048 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30720.0s 28049 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30720.0s 28050 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30720.0s 28051 Running simulation until t = 1425.00 s, outputting every 15.00 s
30720.0s 28052 
30720.3s 28053 [PROGRESS] Step 6700: t=1419.35/1425.00s (99.6%) | dt=0.2126s
30720.5s 28054 [WARNING] Automatic CFL correction applied (count: 3381800):
30720.5s 28055 Calculated CFL: 0.800 > Limit: 0.500
30720.5s 28056 Original dt: 3.404818e-01 s
30720.5s 28057 Corrected dt: 2.128011e-01 s
30720.5s 28058 Correction factor: 1.6x
30720.5s 28059 Max wave speed detected: 23.50 m/s
30720.6s 28060 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1410.0/1425.0 [00:00<?, ?s/s][A
30720.6s 28061 [A
30720.6s 28062 Stored output at t = 1425.0000 s (Step 6727)
30720.6s 28063 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 23.39s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1425.0/1425.0 [00:00<00:00, 23.38s/s]
30720.6s 28064 
30720.6s 28065 Simulation finished at t = 1425.0000 s after 6727 steps.
30720.6s 28066 Total runtime: 0.64 seconds.
30720.6s 28067 [REWARD_MICROSCOPE] step=15015 t=1425.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30720.6s 28068 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30720.6s 28069 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30720.6s 28070 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30720.6s 28071 Running simulation until t = 1440.00 s, outputting every 15.00 s
30720.6s 28072 
30720.8s 28073 [PROGRESS] Step 6750: t=1429.90/1440.00s (99.3%) | dt=0.2130s
30721.2s 28074 Stored output at t = 1440.0000 s (Step 6798)
30721.2s 28075 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1425.0/1440.0 [00:00<?, ?s/s][A
30721.2s 28076 [A
30721.2s 28077 
30721.2s 28078 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 23.28s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1440.0/1440.0 [00:00<00:00, 23.27s/s]
30721.2s 28079 Simulation finished at t = 1440.0000 s after 6798 steps.
30721.2s 28080 Total runtime: 0.65 seconds.
30721.2s 28081 [REWARD_MICROSCOPE] step=15016 t=1440.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30721.2s 28082 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30721.2s 28083 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30721.2s 28084 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30721.2s 28085 Running simulation until t = 1455.00 s, outputting every 15.00 s
30721.2s 28086 
30721.3s 28087 [PROGRESS] Step 6800: t=1440.43/1455.00s (99.0%) | dt=0.2125s
30721.4s 28088 [PERIODIC:1000] BC_DISPATCHER [Call #13528000] current_bc_params: <class 'dict'>
30721.4s 28089 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30721.4s 28090 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30721.4s 28091 [PERIODIC:1000] BC_GPU [Call #13528000] About to launch kernel
30721.4s 28092 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30721.4s 28093 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30721.4s 28094 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30721.5s 28095 [WARNING] Automatic CFL correction applied (count: 3381900):
30721.5s 28096 Calculated CFL: 0.800 > Limit: 0.500
30721.5s 28097 Original dt: 3.398890e-01 s
30721.5s 28098 Corrected dt: 2.124306e-01 s
30721.5s 28099 Correction factor: 1.6x
30721.5s 28100 Max wave speed detected: 23.54 m/s
30721.7s 28101 [PROGRESS] Step 6850: t=1451.05/1455.00s (99.7%) | dt=0.2127s
30721.9s 28102 Stored output at t = 1455.0000 s (Step 6869)
30721.9s 28103 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1440.0/1455.0 [00:00<?, ?s/s][A
30721.9s 28104 [A
30721.9s 28105 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 24.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1455.0/1455.0 [00:00<00:00, 24.39s/s]
30721.9s 28106 
30721.9s 28107 Simulation finished at t = 1455.0000 s after 6869 steps.
30721.9s 28108 Total runtime: 0.62 seconds.
30721.9s 28109 [REWARD_MICROSCOPE] step=15017 t=1455.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30721.9s 28110 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30721.9s 28111 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30721.9s 28112 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30721.9s 28113 Running simulation until t = 1470.00 s, outputting every 15.00 s
30721.9s 28114 
30722.1s 28115 [PROGRESS] Step 6900: t=1461.60/1470.00s (99.4%) | dt=0.2131s
30722.3s 28116 [WARNING] Automatic CFL correction applied (count: 3382000):
30722.3s 28117 Calculated CFL: 0.800 > Limit: 0.500
30722.3s 28118 Original dt: 3.412697e-01 s
30722.3s 28119 Corrected dt: 2.132935e-01 s
30722.3s 28120 Correction factor: 1.6x
30722.3s 28121 Max wave speed detected: 23.44 m/s
30722.5s 28122 Stored output at t = 1470.0000 s (Step 6940)
30722.5s 28123 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1455.0/1470.0 [00:00<?, ?s/s][A
30722.5s 28124 [A
30722.5s 28125 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1470.0/1470.0 [00:00<00:00, 24.11s/s]
30722.5s 28126 
30722.5s 28127 Simulation finished at t = 1470.0000 s after 6940 steps.
30722.5s 28128 Total runtime: 0.62 seconds.
30722.5s 28129 [REWARD_MICROSCOPE] step=15018 t=1470.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30722.5s 28130 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30722.5s 28131 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30722.5s 28132 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30722.5s 28133 Running simulation until t = 1485.00 s, outputting every 15.00 s
30722.5s 28134 
30722.6s 28135 [PROGRESS] Step 6950: t=1472.12/1485.00s (99.1%) | dt=0.2123s
30723.0s 28136 [PROGRESS] Step 7000: t=1482.75/1485.00s (99.8%) | dt=0.2127s
30723.1s 28137 Stored output at t = 1485.0000 s (Step 7011)
30723.1s 28138 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1470.0/1485.0 [00:00<?, ?s/s][A
30723.1s 28139 [A
30723.1s 28140 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1485.0/1485.0 [00:00<00:00, 24.16s/s]
30723.1s 28141 
30723.1s 28142 Simulation finished at t = 1485.0000 s after 7011 steps.
30723.1s 28143 Total runtime: 0.62 seconds.
30723.1s 28144 [REWARD_MICROSCOPE] step=15019 t=1485.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30723.1s 28145 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30723.1s 28146 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30723.1s 28147 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30723.1s 28148 Running simulation until t = 1500.00 s, outputting every 15.00 s
30723.1s 28149 
30723.2s 28150 [WARNING] Automatic CFL correction applied (count: 3382100):
30723.2s 28151 Calculated CFL: 0.800 > Limit: 0.500
30723.2s 28152 Original dt: 3.406934e-01 s
30723.2s 28153 Corrected dt: 2.129334e-01 s
30723.2s 28154 Correction factor: 1.6x
30723.2s 28155 Max wave speed detected: 23.48 m/s
30723.4s 28156 [PROGRESS] Step 7050: t=1493.31/1500.00s (99.6%) | dt=0.2132s
30723.6s 28157 [PERIODIC:1000] BC_DISPATCHER [Call #13529000] current_bc_params: <class 'dict'>
30723.6s 28158 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30723.6s 28159 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30723.6s 28160 [PERIODIC:1000] BC_GPU [Call #13529000] About to launch kernel
30723.6s 28161 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30723.6s 28162 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30723.6s 28163 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30723.7s 28164 Stored output at t = 1500.0000 s (Step 7082)
30723.7s 28165 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1485.0/1500.0 [00:00<?, ?s/s][A
30723.7s 28166 [A
30723.7s 28167 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1500.0/1500.0 [00:00<00:00, 24.75s/s]
30723.7s 28168 
30723.7s 28169 Simulation finished at t = 1500.0000 s after 7082 steps.
30723.7s 28170 Total runtime: 0.61 seconds.
30723.7s 28171 [REWARD_MICROSCOPE] step=15020 t=1500.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30723.7s 28172 [STEP  100] t= 1500.0s | phase=0 | reward=   0.01 | total_reward=    1.00
30723.7s 28173 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30723.7s 28174 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30723.7s 28175 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30723.7s 28176 Running simulation until t = 1515.00 s, outputting every 15.00 s
30723.7s 28177 
30723.9s 28178 [PROGRESS] Step 7100: t=1503.82/1515.00s (99.3%) | dt=0.2124s
30724.1s 28179 [WARNING] Automatic CFL correction applied (count: 3382200):
30724.1s 28180 Calculated CFL: 0.800 > Limit: 0.500
30724.1s 28181 Original dt: 3.401199e-01 s
30724.1s 28182 Corrected dt: 2.125749e-01 s
30724.1s 28183 Correction factor: 1.6x
30724.1s 28184 Max wave speed detected: 23.52 m/s
30724.3s 28185 [PROGRESS] Step 7150: t=1514.45/1515.00s (100.0%) | dt=0.2128s
30724.3s 28186 Stored output at t = 1515.0000 s (Step 7153)
30724.3s 28187 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1500.0/1515.0 [00:00<?, ?s/s][A
30724.3s 28188 [A
30724.3s 28189 
30724.3s 28190 Simulation finished at t = 1515.0000 s after 7153 steps.
30724.3s 28191 Total runtime: 0.62 seconds.
30724.3s 28192 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.20s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1515.0/1515.0 [00:00<00:00, 24.19s/s]
30724.3s 28193 [QUEUE_DIAGNOSTIC] ===== Step 100 t=1515.0s =====
30724.3s 28194 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30724.3s 28195 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30724.3s 28196 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30724.3s 28197 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30724.3s 28198 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30724.3s 28199 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30724.3s 28200 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30724.3s 28201 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30724.3s 28202 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30724.3s 28203 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30724.3s 28204 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30724.3s 28205 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30724.3s 28206 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30724.3s 28207 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30724.3s 28208 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30724.3s 28209 [REWARD_MICROSCOPE] step=15021 t=1515.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30724.3s 28210 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30724.3s 28211 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30724.3s 28212 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30724.3s 28213 Running simulation until t = 1530.00 s, outputting every 15.00 s
30724.3s 28214 
30724.7s 28215 [PROGRESS] Step 7200: t=1525.01/1530.00s (99.7%) | dt=0.2132s
30724.9s 28216 [WARNING] Automatic CFL correction applied (count: 3382300):
30724.9s 28217 Calculated CFL: 0.800 > Limit: 0.500
30724.9s 28218 Original dt: 3.401129e-01 s
30724.9s 28219 Corrected dt: 2.125705e-01 s
30724.9s 28220 Correction factor: 1.6x
30724.9s 28221 Max wave speed detected: 23.52 m/s
30725.0s 28222 Stored output at t = 1530.0000 s (Step 7224)
30725.0s 28223 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1515.0/1530.0 [00:00<?, ?s/s][A
30725.0s 28224 [A
30725.0s 28225 
30725.0s 28226 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1530.0/1530.0 [00:00<00:00, 24.15s/s]
30725.0s 28227 Simulation finished at t = 1530.0000 s after 7224 steps.
30725.0s 28228 Total runtime: 0.62 seconds.
30725.0s 28229 [REWARD_MICROSCOPE] step=15022 t=1530.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30725.0s 28230 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30725.0s 28231 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30725.0s 28232 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30725.0s 28233 Running simulation until t = 1545.00 s, outputting every 15.00 s
30725.0s 28234 
30725.2s 28235 [PROGRESS] Step 7250: t=1535.52/1545.00s (99.4%) | dt=0.2124s
30725.6s 28236 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1530.0/1545.0 [00:00<?, ?s/s][A
30725.6s 28237 [A
30725.6s 28238 Stored output at t = 1545.0000 s (Step 7295)
30725.6s 28239 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 22.62s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1545.0/1545.0 [00:00<00:00, 22.62s/s]
30725.6s 28240 
30725.6s 28241 Simulation finished at t = 1545.0000 s after 7295 steps.
30725.6s 28242 Total runtime: 0.66 seconds.
30725.6s 28243 [REWARD_MICROSCOPE] step=15023 t=1545.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30725.6s 28244 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30725.6s 28245 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30725.6s 28246 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30725.6s 28247 Running simulation until t = 1560.00 s, outputting every 15.00 s
30725.6s 28248 
30725.7s 28249 [PROGRESS] Step 7300: t=1546.06/1560.00s (99.1%) | dt=0.2129s
30725.8s 28250 [PERIODIC:1000] BC_DISPATCHER [Call #13530000] current_bc_params: <class 'dict'>
30725.8s 28251 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30725.8s 28252 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30725.8s 28253 [PERIODIC:1000] BC_GPU [Call #13530000] About to launch kernel
30725.8s 28254 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30725.8s 28255 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30725.8s 28256 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30725.9s 28257 [WARNING] Automatic CFL correction applied (count: 3382400):
30725.9s 28258 Calculated CFL: 0.800 > Limit: 0.500
30725.9s 28259 Original dt: 3.409178e-01 s
30725.9s 28260 Corrected dt: 2.130736e-01 s
30725.9s 28261 Correction factor: 1.6x
30725.9s 28262 Max wave speed detected: 23.47 m/s
30726.1s 28263 [PROGRESS] Step 7350: t=1556.72/1560.00s (99.8%) | dt=0.2133s
30726.3s 28264 Stored output at t = 1560.0000 s (Step 7366)
30726.3s 28265 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1545.0/1560.0 [00:00<?, ?s/s][A
30726.3s 28266 [A
30726.3s 28267 
30726.3s 28268 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 23.93s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1560.0/1560.0 [00:00<00:00, 23.92s/s]
30726.3s 28269 Simulation finished at t = 1560.0000 s after 7366 steps.
30726.3s 28270 Total runtime: 0.63 seconds.
30726.3s 28271 [REWARD_MICROSCOPE] step=15024 t=1560.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30726.3s 28272 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30726.3s 28273 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30726.3s 28274 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30726.3s 28275 Running simulation until t = 1575.00 s, outputting every 15.00 s
30726.3s 28276 
30726.6s 28277 [PROGRESS] Step 7400: t=1567.22/1575.00s (99.5%) | dt=0.2125s
30726.8s 28278 [WARNING] Automatic CFL correction applied (count: 3382500):
30726.8s 28279 Calculated CFL: 0.800 > Limit: 0.500
30726.8s 28280 Original dt: 3.403431e-01 s
30726.8s 28281 Corrected dt: 2.127144e-01 s
30726.8s 28282 Correction factor: 1.6x
30726.8s 28283 Max wave speed detected: 23.51 m/s
30726.9s 28284 Stored output at t = 1575.0000 s (Step 7437)
30726.9s 28285 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1560.0/1575.0 [00:00<?, ?s/s][A
30726.9s 28286 [A
30726.9s 28287 
30726.9s 28288 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1575.0/1575.0 [00:00<00:00, 23.76s/s]
30726.9s 28289 Simulation finished at t = 1575.0000 s after 7437 steps.
30726.9s 28290 Total runtime: 0.63 seconds.
30726.9s 28291 [REWARD_MICROSCOPE] step=15025 t=1575.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30726.9s 28292 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30726.9s 28293 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30726.9s 28294 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30726.9s 28295 Running simulation until t = 1590.00 s, outputting every 15.00 s
30726.9s 28296 
30727.0s 28297 [PROGRESS] Step 7450: t=1577.77/1590.00s (99.2%) | dt=0.2129s
30727.5s 28298 [PROGRESS] Step 7500: t=1588.42/1590.00s (99.9%) | dt=0.2128s
30727.5s 28299 Stored output at t = 1590.0000 s (Step 7508)
30727.5s 28300 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1575.0/1590.0 [00:00<?, ?s/s][A
30727.5s 28301 [A
30727.5s 28302 
30727.5s 28303 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 23.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1590.0/1590.0 [00:00<00:00, 23.89s/s]
30727.5s 28304 Simulation finished at t = 1590.0000 s after 7508 steps.
30727.5s 28305 Total runtime: 0.63 seconds.
30727.5s 28306 [REWARD_MICROSCOPE] step=15026 t=1590.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30727.5s 28307 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30727.5s 28308 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30727.5s 28309 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30727.5s 28310 Running simulation until t = 1605.00 s, outputting every 15.00 s
30727.5s 28311 
30727.7s 28312 [WARNING] Automatic CFL correction applied (count: 3382600):
30727.7s 28313 Calculated CFL: 0.800 > Limit: 0.500
30727.7s 28314 Original dt: 3.397401e-01 s
30727.7s 28315 Corrected dt: 2.123376e-01 s
30727.7s 28316 Correction factor: 1.6x
30727.7s 28317 Max wave speed detected: 23.55 m/s
30727.9s 28318 [PROGRESS] Step 7550: t=1598.92/1605.00s (99.6%) | dt=0.2126s
30728.0s 28319 [PERIODIC:1000] BC_DISPATCHER [Call #13531000] current_bc_params: <class 'dict'>
30728.0s 28320 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30728.0s 28321 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30728.0s 28322 [PERIODIC:1000] BC_GPU [Call #13531000] About to launch kernel
30728.0s 28323 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30728.0s 28324 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30728.0s 28325 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30728.2s 28326 Stored output at t = 1605.0000 s (Step 7579)
30728.2s 28327 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1590.0/1605.0 [00:00<?, ?s/s][A
30728.2s 28328 [A
30728.2s 28329 
30728.2s 28330 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.15s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1605.0/1605.0 [00:00<00:00, 24.14s/s]
30728.2s 28331 Simulation finished at t = 1605.0000 s after 7579 steps.
30728.2s 28332 Total runtime: 0.62 seconds.
30728.2s 28333 [REWARD_MICROSCOPE] step=15027 t=1605.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30728.2s 28334 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30728.2s 28335 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30728.2s 28336 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30728.2s 28337 Running simulation until t = 1620.00 s, outputting every 15.00 s
30728.2s 28338 
30728.3s 28339 [PROGRESS] Step 7600: t=1609.47/1620.00s (99.4%) | dt=0.2130s
30728.5s 28340 [WARNING] Automatic CFL correction applied (count: 3382700):
30728.5s 28341 Calculated CFL: 0.800 > Limit: 0.500
30728.5s 28342 Original dt: 3.411334e-01 s
30728.5s 28343 Corrected dt: 2.132084e-01 s
30728.5s 28344 Correction factor: 1.6x
30728.5s 28345 Max wave speed detected: 23.45 m/s
30728.8s 28346 [PROGRESS] Step 7650: t=1620.00/1620.00s (100.0%) | dt=0.0883s
30728.8s 28347 Stored output at t = 1620.0000 s (Step 7650)
30728.8s 28348 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1605.0/1620.0 [00:00<?, ?s/s][A
30728.8s 28349 [A
30728.8s 28350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.89s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1620.0/1620.0 [00:00<00:00, 23.89s/s]
30728.8s 28351 
30728.8s 28352 Simulation finished at t = 1620.0000 s after 7650 steps.
30728.8s 28353 Total runtime: 0.63 seconds.
30728.8s 28354 [REWARD_MICROSCOPE] step=15028 t=1620.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30728.8s 28355 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30728.8s 28356 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30728.8s 28357 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30728.8s 28358 Running simulation until t = 1635.00 s, outputting every 15.00 s
30728.8s 28359 
30729.2s 28360 [PROGRESS] Step 7700: t=1630.62/1635.00s (99.7%) | dt=0.2127s
30729.4s 28361 Stored output at t = 1635.0000 s (Step 7721)
30729.4s 28362 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1620.0/1635.0 [00:00<?, ?s/s][A
30729.4s 28363 [A
30729.4s 28364 
30729.4s 28365 Simulation finished at t = 1635.0000 s after 7721 steps.
30729.4s 28366 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1635.0/1635.0 [00:00<00:00, 24.82s/s]
30729.4s 28367 Total runtime: 0.60 seconds.
30729.4s 28368 [REWARD_MICROSCOPE] step=15029 t=1635.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30729.4s 28369 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30729.4s 28370 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30729.4s 28371 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30729.4s 28372 Running simulation until t = 1650.00 s, outputting every 15.00 s
30729.4s 28373 
30729.4s 28374 [WARNING] Automatic CFL correction applied (count: 3382800):
30729.4s 28375 Calculated CFL: 0.800 > Limit: 0.500
30729.4s 28376 Original dt: 3.405553e-01 s
30729.4s 28377 Corrected dt: 2.128470e-01 s
30729.4s 28378 Correction factor: 1.6x
30729.4s 28379 Max wave speed detected: 23.49 m/s
30729.6s 28380 [PROGRESS] Step 7750: t=1641.18/1650.00s (99.5%) | dt=0.2131s
30730.0s 28381 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1635.0/1650.0 [00:00<?, ?s/s][A
30730.0s 28382 [A
30730.0s 28383 Stored output at t = 1650.0000 s (Step 7792)
30730.0s 28384 
30730.0s 28385 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1650.0/1650.0 [00:00<00:00, 24.07s/s]
30730.0s 28386 Simulation finished at t = 1650.0000 s after 7792 steps.
30730.0s 28387 Total runtime: 0.62 seconds.
30730.0s 28388 [REWARD_MICROSCOPE] step=15030 t=1650.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30730.0s 28389 [STEP  110] t= 1650.0s | phase=0 | reward=   0.01 | total_reward=    1.10
30730.0s 28390 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30730.0s 28391 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30730.0s 28392 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30730.0s 28393 Running simulation until t = 1665.00 s, outputting every 15.00 s
30730.0s 28394 
30730.1s 28395 [PROGRESS] Step 7800: t=1651.70/1665.00s (99.2%) | dt=0.2124s
30730.3s 28396 [PERIODIC:1000] BC_DISPATCHER [Call #13532000] current_bc_params: <class 'dict'>
30730.3s 28397 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30730.3s 28398 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30730.3s 28399 [PERIODIC:1000] BC_GPU [Call #13532000] About to launch kernel
30730.3s 28400 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30730.3s 28401 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30730.3s 28402 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30730.3s 28403 [WARNING] Automatic CFL correction applied (count: 3382900):
30730.3s 28404 Calculated CFL: 0.800 > Limit: 0.500
30730.3s 28405 Original dt: 3.399790e-01 s
30730.3s 28406 Corrected dt: 2.124869e-01 s
30730.3s 28407 Correction factor: 1.6x
30730.3s 28408 Max wave speed detected: 23.53 m/s
30730.6s 28409 [PROGRESS] Step 7850: t=1662.32/1665.00s (99.8%) | dt=0.2127s
30730.7s 28410 Stored output at t = 1665.0000 s (Step 7863)
30730.7s 28411 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1650.0/1665.0 [00:00<?, ?s/s][A
30730.7s 28412 [A
30730.7s 28413 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 22.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1665.0/1665.0 [00:00<00:00, 22.82s/s]
30730.7s 28414 
30730.7s 28415 Simulation finished at t = 1665.0000 s after 7863 steps.
30730.7s 28416 Total runtime: 0.66 seconds.
30730.7s 28417 [QUEUE_DIAGNOSTIC] ===== Step 110 t=1665.0s =====
30730.7s 28418 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30730.7s 28419 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30730.7s 28420 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30730.7s 28421 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30730.7s 28422 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30730.7s 28423 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30730.7s 28424 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30730.7s 28425 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30730.7s 28426 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30730.7s 28427 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30730.7s 28428 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30730.7s 28429 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30730.7s 28430 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30730.7s 28431 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30730.7s 28432 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30730.7s 28433 [REWARD_MICROSCOPE] step=15031 t=1665.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30730.7s 28434 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30730.7s 28435 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30730.7s 28436 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30730.7s 28437 Running simulation until t = 1680.00 s, outputting every 15.00 s
30730.7s 28438 
30731.0s 28439 [PROGRESS] Step 7900: t=1672.88/1680.00s (99.6%) | dt=0.2131s
30731.2s 28440 [WARNING] Automatic CFL correction applied (count: 3383000):
30731.2s 28441 Calculated CFL: 0.800 > Limit: 0.500
30731.2s 28442 Original dt: 3.407550e-01 s
30731.2s 28443 Corrected dt: 2.129719e-01 s
30731.2s 28444 Correction factor: 1.6x
30731.2s 28445 Max wave speed detected: 23.48 m/s
30731.3s 28446 Stored output at t = 1680.0000 s (Step 7934)
30731.3s 28447 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1665.0/1680.0 [00:00<?, ?s/s][A
30731.3s 28448 [A
30731.3s 28449 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.82s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1680.0/1680.0 [00:00<00:00, 23.82s/s]
30731.3s 28450 
30731.3s 28451 Simulation finished at t = 1680.0000 s after 7934 steps.
30731.3s 28452 Total runtime: 0.63 seconds.
30731.3s 28453 [REWARD_MICROSCOPE] step=15032 t=1680.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30731.3s 28454 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30731.3s 28455 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30731.3s 28456 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30731.3s 28457 Running simulation until t = 1695.00 s, outputting every 15.00 s
30731.3s 28458 
30731.5s 28459 [PROGRESS] Step 7950: t=1683.40/1695.00s (99.3%) | dt=0.2123s
30731.9s 28460 [PROGRESS] Step 8000: t=1694.03/1695.00s (99.9%) | dt=0.2128s
30731.9s 28461 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1680.0/1695.0 [00:00<?, ?s/s][A
30731.9s 28462 [A
30731.9s 28463 Stored output at t = 1695.0000 s (Step 8005)
30731.9s 28464 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1695.0/1695.0 [00:00<00:00, 24.26s/s]
30731.9s 28465 
30731.9s 28466 Simulation finished at t = 1695.0000 s after 8005 steps.
30731.9s 28467 Total runtime: 0.62 seconds.
30731.9s 28468 [REWARD_MICROSCOPE] step=15033 t=1695.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30731.9s 28469 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30731.9s 28470 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30731.9s 28471 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30731.9s 28472 Running simulation until t = 1710.00 s, outputting every 15.00 s
30731.9s 28473 
30732.1s 28474 [WARNING] Automatic CFL correction applied (count: 3383100):
30732.1s 28475 Calculated CFL: 0.800 > Limit: 0.500
30732.1s 28476 Original dt: 3.407770e-01 s
30732.1s 28477 Corrected dt: 2.129856e-01 s
30732.1s 28478 Correction factor: 1.6x
30732.1s 28479 Max wave speed detected: 23.48 m/s
30732.3s 28480 [PROGRESS] Step 8050: t=1704.59/1710.00s (99.7%) | dt=0.2132s
30732.5s 28481 [PERIODIC:1000] BC_DISPATCHER [Call #13533000] current_bc_params: <class 'dict'>
30732.5s 28482 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30732.5s 28483 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30732.5s 28484 [PERIODIC:1000] BC_GPU [Call #13533000] About to launch kernel
30732.5s 28485 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30732.5s 28486 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30732.5s 28487 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30732.5s 28488 Stored output at t = 1710.0000 s (Step 8076)
30732.5s 28489 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1695.0/1710.0 [00:00<?, ?s/s][A
30732.5s 28490 [A
30732.5s 28491 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1710.0/1710.0 [00:00<00:00, 24.73s/s]
30732.5s 28492 
30732.5s 28493 Simulation finished at t = 1710.0000 s after 8076 steps.
30732.5s 28494 Total runtime: 0.61 seconds.
30732.5s 28495 [REWARD_MICROSCOPE] step=15034 t=1710.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30732.5s 28496 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30732.5s 28497 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30732.5s 28498 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30732.5s 28499 Running simulation until t = 1725.00 s, outputting every 15.00 s
30732.5s 28500 
30732.7s 28501 [PROGRESS] Step 8100: t=1715.10/1725.00s (99.4%) | dt=0.2124s
30732.9s 28502 [WARNING] Automatic CFL correction applied (count: 3383200):
30732.9s 28503 Calculated CFL: 0.800 > Limit: 0.500
30732.9s 28504 Original dt: 3.402034e-01 s
30732.9s 28505 Corrected dt: 2.126271e-01 s
30732.9s 28506 Correction factor: 1.6x
30732.9s 28507 Max wave speed detected: 23.52 m/s
30733.2s 28508 Stored output at t = 1725.0000 s (Step 8147)
30733.2s 28509 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1710.0/1725.0 [00:00<?, ?s/s][A
30733.2s 28510 [A
30733.2s 28511 
30733.2s 28512 Simulation finished at t = 1725.0000 s after 8147 steps.
30733.2s 28513 Total runtime: 0.63 seconds.
30733.2s 28514 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1725.0/1725.0 [00:00<00:00, 23.98s/s]
30733.2s 28515 [REWARD_MICROSCOPE] step=15035 t=1725.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30733.2s 28516 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30733.2s 28517 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30733.2s 28518 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30733.2s 28519 Running simulation until t = 1740.00 s, outputting every 15.00 s
30733.2s 28520 
30733.2s 28521 [PROGRESS] Step 8150: t=1725.64/1740.00s (99.2%) | dt=0.2129s
30733.6s 28522 [PROGRESS] Step 8200: t=1736.29/1740.00s (99.8%) | dt=0.2133s
30733.8s 28523 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1725.0/1740.0 [00:00<?, ?s/s][A
30733.8s 28524 [A
30733.8s 28525 Stored output at t = 1740.0000 s (Step 8218)
30733.8s 28526 
30733.8s 28527 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1740.0/1740.0 [00:00<00:00, 24.52s/s]
30733.8s 28528 Simulation finished at t = 1740.0000 s after 8218 steps.
30733.8s 28529 Total runtime: 0.61 seconds.
30733.8s 28530 [REWARD_MICROSCOPE] step=15036 t=1740.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30733.8s 28531 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30733.8s 28532 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30733.8s 28533 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30733.8s 28534 Running simulation until t = 1755.00 s, outputting every 15.00 s
30733.8s 28535 
30733.8s 28536 [WARNING] Automatic CFL correction applied (count: 3383300):
30733.8s 28537 Calculated CFL: 0.800 > Limit: 0.500
30733.8s 28538 Original dt: 3.398708e-01 s
30733.8s 28539 Corrected dt: 2.124193e-01 s
30733.8s 28540 Correction factor: 1.6x
30733.8s 28541 Max wave speed detected: 23.54 m/s
30734.1s 28542 [PROGRESS] Step 8250: t=1746.80/1755.00s (99.5%) | dt=0.2125s
30734.4s 28543 Stored output at t = 1755.0000 s (Step 8289)
30734.4s 28544 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1740.0/1755.0 [00:00<?, ?s/s][A
30734.4s 28545 [A
30734.4s 28546 
30734.4s 28547 Simulation finished at t = 1755.0000 s after 8289 steps.
30734.4s 28548 Total runtime: 0.62 seconds.
30734.4s 28549 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1755.0/1755.0 [00:00<00:00, 24.29s/s]
30734.4s 28550 [REWARD_MICROSCOPE] step=15037 t=1755.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30734.4s 28551 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30734.4s 28552 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30734.4s 28553 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30734.4s 28554 Running simulation until t = 1770.00 s, outputting every 15.00 s
30734.4s 28555 
30734.5s 28556 [PROGRESS] Step 8300: t=1757.34/1770.00s (99.3%) | dt=0.2129s
30734.6s 28557 [PERIODIC:1000] BC_DISPATCHER [Call #13534000] current_bc_params: <class 'dict'>
30734.6s 28558 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30734.6s 28559 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30734.6s 28560 [PERIODIC:1000] BC_GPU [Call #13534000] About to launch kernel
30734.6s 28561 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 0.013888888888888888, 0.01, 0.013888888888888888]
30734.6s 28562 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30734.6s 28563 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30734.7s 28564 [WARNING] Automatic CFL correction applied (count: 3383400):
30734.7s 28565 Calculated CFL: 0.800 > Limit: 0.500
30734.7s 28566 Original dt: 3.409993e-01 s
30734.7s 28567 Corrected dt: 2.131246e-01 s
30734.7s 28568 Correction factor: 1.6x
30734.7s 28569 Max wave speed detected: 23.46 m/s
30734.9s 28570 [PROGRESS] Step 8350: t=1768.00/1770.00s (99.9%) | dt=0.2129s
30735.0s 28571 Stored output at t = 1770.0000 s (Step 8360)
30735.0s 28572 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1755.0/1770.0 [00:00<?, ?s/s][A
30735.0s 28573 [A
30735.0s 28574 
30735.0s 28575 Simulation finished at t = 1770.0000 s after 8360 steps.
30735.0s 28576 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.99s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1770.0/1770.0 [00:00<00:00, 23.98s/s]
30735.0s 28577 Total runtime: 0.63 seconds.
30735.0s 28578 [REWARD_MICROSCOPE] step=15038 t=1770.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30735.0s 28579 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30735.0s 28580 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30735.0s 28581 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30735.0s 28582 Running simulation until t = 1785.00 s, outputting every 15.00 s
30735.0s 28583 
30735.4s 28584 [PROGRESS] Step 8400: t=1778.50/1785.00s (99.6%) | dt=0.2126s
30735.6s 28585 [WARNING] Automatic CFL correction applied (count: 3383500):
30735.6s 28586 Calculated CFL: 0.800 > Limit: 0.500
30735.6s 28587 Original dt: 3.404274e-01 s
30735.6s 28588 Corrected dt: 2.127671e-01 s
30735.6s 28589 Correction factor: 1.6x
30735.6s 28590 Max wave speed detected: 23.50 m/s
30735.7s 28591 Stored output at t = 1785.0000 s (Step 8431)
30735.7s 28592 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1770.0/1785.0 [00:00<?, ?s/s][A
30735.7s 28593 [A
30735.7s 28594 
30735.7s 28595 Simulation finished at t = 1785.0000 s after 8431 steps.
30735.7s 28596 Total runtime: 0.63 seconds.
30735.7s 28597 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 23.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1785.0/1785.0 [00:00<00:00, 23.77s/s]
30735.7s 28598 [REWARD_MICROSCOPE] step=15039 t=1785.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30735.7s 28599 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30735.7s 28600 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30735.7s 28601 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30735.7s 28602 Running simulation until t = 1800.00 s, outputting every 15.00 s
30735.7s 28603 
30735.8s 28604 [PROGRESS] Step 8450: t=1789.05/1800.00s (99.4%) | dt=0.2130s
30736.3s 28605 [PROGRESS] Step 8500: t=1799.70/1800.00s (100.0%) | dt=0.2126s
30736.3s 28606 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1785.0/1800.0 [00:00<?, ?s/s][A
30736.3s 28607 [A
30736.3s 28608 Stored output at t = 1800.0000 s (Step 8502)
30736.3s 28609 
30736.3s 28610 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.53s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1800.0/1800.0 [00:00<00:00, 24.52s/s]
30736.3s 28611 Simulation finished at t = 1800.0000 s after 8502 steps.
30736.3s 28612 Total runtime: 0.61 seconds.
30736.3s 28613 [REWARD_MICROSCOPE] step=15040 t=1800.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30736.3s 28614 [STEP  120] t= 1800.0s | phase=0 | reward=   0.01 | total_reward=    1.20
30736.3s 28615 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30736.3s 28616 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30736.3s 28617 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30736.3s 28618 Running simulation until t = 1815.00 s, outputting every 15.00 s
30736.3s 28619 
30736.5s 28620 [WARNING] Automatic CFL correction applied (count: 3383600):
30736.5s 28621 Calculated CFL: 0.800 > Limit: 0.500
30736.5s 28622 Original dt: 3.398278e-01 s
30736.5s 28623 Corrected dt: 2.123924e-01 s
30736.5s 28624 Correction factor: 1.6x
30736.5s 28625 Max wave speed detected: 23.54 m/s
30736.7s 28626 [PROGRESS] Step 8550: t=1810.20/1815.00s (99.7%) | dt=0.2126s
30736.8s 28627 [PERIODIC:1000] BC_DISPATCHER [Call #13535000] current_bc_params: <class 'dict'>
30736.8s 28628 [PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)
30736.8s 28629 [PERIODIC:1000] BC_DISPATCHER Left inflow: [0.01, 10.0, 0.01, 10.0]
30736.8s 28630 [PERIODIC:1000] BC_GPU [Call #13535000] About to launch kernel
30736.8s 28631 [PERIODIC:1000] BC_GPU Inflow.L: [0.01, 10.0, 0.01, 10.0]
30736.8s 28632 [PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]
30736.8s 28633 [PERIODIC:1000] BC_GPU BC Types: L=0, R=2
30736.9s 28634 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1800.0/1815.0 [00:00<?, ?s/s][A
30736.9s 28635 Stored output at t = 1815.0000 s (Step 8573)
30736.9s 28636 [A
30736.9s 28637 
30736.9s 28638 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1815.0/1815.0 [00:00<00:00, 24.25s/s]
30736.9s 28639 Simulation finished at t = 1815.0000 s after 8573 steps.
30736.9s 28640 Total runtime: 0.62 seconds.
30736.9s 28641 [QUEUE_DIAGNOSTIC] ===== Step 120 t=1815.0s =====
30736.9s 28642 [QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6
30736.9s 28643 [QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.01568704 1.         0.03926914 1.        ] (rho_m, v_m, rho_c, v_c)
30736.9s 28644 [QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=13.33
30736.9s 28645 [QUEUE_DIAGNOSTIC] velocities_m (m/s): [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30736.9s 28646 [QUEUE_DIAGNOSTIC] velocities_c (m/s): [11.666667 11.666667 11.666667 11.666667 11.666667 11.666667]
30736.9s 28647 [QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.00470611 0.00449103 0.00441435 0.00438327 0.00436941 0.00436217]
30736.9s 28648 [QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00589037 0.00546898 0.00523331 0.0050997  0.0050281  0.00499131]
30736.9s 28649 [QUEUE_DIAGNOSTIC] Threshold: 6.67 m/s (24.0 km/h)
30736.9s 28650 [QUEUE_DIAGNOSTIC] v_free_m=13.33 m/s â†’ Threshold=0.5*v_free_m
30736.9s 28651 [QUEUE_DIAGNOSTIC] velocities_m: [13.333333 13.333333 13.333333 13.333333 13.333333 13.333333]
30736.9s 28652 [QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]
30736.9s 28653 [QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]
30736.9s 28654 [QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)
30736.9s 28655 [QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)
30736.9s 28656 [QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles
30736.9s 28657 [REWARD_MICROSCOPE] step=15041 t=1815.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30736.9s 28658 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30736.9s 28659 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30736.9s 28660 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30736.9s 28661 Running simulation until t = 1830.00 s, outputting every 15.00 s
30736.9s 28662 
30737.1s 28663 [PROGRESS] Step 8600: t=1820.75/1830.00s (99.5%) | dt=0.2131s
30737.3s 28664 [WARNING] Automatic CFL correction applied (count: 3383700):
30737.3s 28665 Calculated CFL: 0.800 > Limit: 0.500
30737.3s 28666 Original dt: 3.412149e-01 s
30737.3s 28667 Corrected dt: 2.132593e-01 s
30737.3s 28668 Correction factor: 1.6x
30737.3s 28669 Max wave speed detected: 23.45 m/s
30737.5s 28670 Stored output at t = 1830.0000 s (Step 8644)
30737.5s 28671 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1815.0/1830.0 [00:00<?, ?s/s][A
30737.5s 28672 [A
30737.5s 28673 
30737.5s 28674 Simulation finished at t = 1830.0000 s after 8644 steps.
30737.5s 28675 Total runtime: 0.62 seconds.
30737.5s 28676 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1830.0/1830.0 [00:00<00:00, 24.38s/s]
30737.5s 28677 [REWARD_MICROSCOPE] step=15042 t=1830.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30737.5s 28678 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30737.5s 28679 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
30737.5s 28680 â””â”€ Inflow state: rho_m=0.0100, w_m=10.0, rho_c=0.0100, w_c=10.0
30737.5s 28681 Running simulation until t = 1845.00 s, outputting every 15.00 s
30737.5s 28682 
30737.6s 28683 [PROGRESS] Step 8650: t=1831.27/1845.00s (99.3%) | dt=0.2124s
30738.0s 28684 [PROGRESS] Step 8700: t=1841.90/1845.00s (99.8%) | dt=0.2127s
30738.1s 28685 Stored output at t = 1845.0000 s (Step 8715)
30738.1s 28686 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1830.0/1845.0 [00:00<?, ?s/s][A
30738.1s 28687 [A
30738.1s 28688 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.31s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1845.0/1845.0 [00:00<00:00, 24.31s/s]
30738.1s 28689 
30738.1s 28690 Simulation finished at t = 1845.0000 s after 8715 steps.
30738.1s 28691 Total runtime: 0.62 seconds.
30738.1s 28692 [REWARD_MICROSCOPE] step=15043 t=1845.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100
30738.1s 28693 DEBUG set_traffic_signal_state: Using initial_equilibrium_state = [0.01, 10.0, 0.01, 10.0]
30738.1s 28694 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
30738.1s 28695 â””â”€ Inflow state: rho_m=0.0100, w_m=0.0, rho_c=0.0100, w_c=0.0
30738.1s 28696 Running simulation until t = 1860.00 s, outputting every 15.00 s
30738.1s 28697 
30738.4s 28698 Running Simulation:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 1845.0/1860.0 [00:00<?, ?s/s][A