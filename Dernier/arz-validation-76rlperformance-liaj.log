0.6s 1 ================================================================================
0.6s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.6s 3 Revendications: R5
0.6s 4 ================================================================================
0.6s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.6s 6 Branch: main
5.7s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.7s 8 PyTorch: 2.6.0+cu124
5.8s 9 CUDA available: True
5.8s 10 CUDA device: Tesla P100-PCIE-16GB
5.8s 11 CUDA version: 12.4
5.8s 12 
5.8s 13 [STEP 1/4] Cloning repository from GitHub...
5.8s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
8.8s 15 [OK] Repository cloned successfully
8.8s 16 TRACKING_SUCCESS: Repository cloned
8.8s 17 
8.8s 18 [STEP 2/4] Installing dependencies...
8.8s 19 Installing PyYAML...
12.8s 20 Installing matplotlib...
15.8s 21 Installing pandas...
18.7s 22 Installing scipy...
21.8s 23 Installing numpy...
24.7s 24 Installing gymnasium...
27.7s 25 Installing stable-baselines3...
97.7s 26 [OK] Dependencies installed
97.7s 27 TRACKING_SUCCESS: Dependencies ready
97.7s 28 
97.7s 29 [STEP 3/4] Running validation tests...
97.7s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
97.7s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
97.7s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
97.7s 33 ============================================================
113.1s 34 2025-10-10 13:19:13.406470: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
113.3s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
113.3s 36 E0000 00:00:1760102353.622718      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
113.4s 37 E0000 00:00:1760102353.679421      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
125.6s 38 ================================================================================
125.6s 39 QUICK TEST MODE ENABLED
125.6s 40 - Training: 2 timesteps only
125.6s 41 - Duration: 2 minutes simulated time
125.6s 42 - Scenarios: 1 scenario only
125.6s 43 - Expected runtime: ~5 minutes on GPU
125.6s 44 ================================================================================
125.6s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
125.6s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
125.6s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
125.6s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
125.6s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
125.6s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
125.6s 51 2025-10-10 13:19:25 - INFO - _setup_debug_logging:119 - ================================================================================
125.6s 52 2025-10-10 13:19:25 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
125.6s 53 2025-10-10 13:19:25 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
125.6s 54 2025-10-10 13:19:25 - INFO - _setup_debug_logging:122 - Quick test mode: True
125.6s 55 2025-10-10 13:19:25 - INFO - _setup_debug_logging:123 - ================================================================================
125.6s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
125.6s 57 === Section 7.6: RL Performance Validation ===
125.6s 58 Testing RL agent performance vs baseline controllers...
125.7s 59 [DEVICE] Detected: GPU
125.8s 60 [GPU INFO] Tesla P100-PCIE-16GB
125.8s 61 
125.8s 62 [PHASE 1/2] Training RL agents...
125.8s 63 [QUICK TEST] Training only: traffic_light_control
125.8s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
125.8s 65 2025-10-10 13:19:26 - INFO - train_rl_agent:562 - ================================================================================
125.8s 66 2025-10-10 13:19:26 - INFO - train_rl_agent:563 - Starting train_rl_agent for scenario: traffic_light_control
125.8s 67 2025-10-10 13:19:26 - INFO - train_rl_agent:564 -   - Device: gpu
125.8s 68 2025-10-10 13:19:26 - INFO - train_rl_agent:565 -   - Total timesteps: 100
125.8s 69 2025-10-10 13:19:26 - INFO - train_rl_agent:566 -   - Episode max time: 120.0s
125.8s 70 2025-10-10 13:19:26 - INFO - train_rl_agent:567 -   - Checkpoint frequency: 50
125.8s 71 2025-10-10 13:19:26 - INFO - train_rl_agent:568 - ================================================================================
125.8s 72 
125.8s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
125.8s 74 Device: gpu
125.8s 75 Total timesteps: 100
125.8s 76 Episode max time: 120.0s
125.8s 77 Checkpoint frequency: 50 steps
125.8s 78 2025-10-10 13:19:26 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
125.8s 79 2025-10-10 13:19:26 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
125.8s 80 2025-10-10 13:19:26 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
125.8s 81 2025-10-10 13:19:26 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
125.8s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
125.8s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
125.8s 84 Using device: gpu
125.8s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
125.8s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
125.8s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
125.8s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
125.8s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
125.8s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
125.8s 91 Loading road quality type: uniform
125.8s 92 Uniform road quality value: 2
125.8s 93 Road quality loaded.
125.8s 94 Initial state created.
125.8s 95 Transferring initial state and road quality to GPU...
125.8s 96 GPU data transfer complete.
125.8s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
125.8s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.8s 99 warn(NumbaPerformanceWarning(msg))
127.3s 100 Initial boundary conditions applied.
127.3s 101 TrafficSignalEnvDirect initialized:
127.3s 102 Decision interval: 60.0s
127.3s 103 Observation segments: 6
127.3s 104 Observation space: (26,)
127.3s 105 Action space: 2
127.3s 106 Device: gpu
127.3s 107 [INFO] Environment created: obs_space=(26,), action_space=2
127.3s 108 [INFO] Initializing PPO agent from scratch...
127.3s 109 Using cuda device
127.3s 110 Wrapping the env with a `Monitor` wrapper
127.3s 111 Wrapping the env in a DummyVecEnv.
127.3s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
127.3s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
127.3s 114 Info: (n_steps=100 and n_envs=1)
127.3s 115 warnings.warn(
131.9s 116 
131.9s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
131.9s 118 [INFO] Training for 100 timesteps...
131.9s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
131.9s 120 Using device: gpu
131.9s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
131.9s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
131.9s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
131.9s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
131.9s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
131.9s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
131.9s 127 Loading road quality type: uniform
131.9s 128 Uniform road quality value: 2
131.9s 129 Road quality loaded.
131.9s 130 Initial state created.
131.9s 131 Transferring initial state and road quality to GPU...
131.9s 132 GPU data transfer complete.
131.9s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
131.9s 134 Initial boundary conditions applied.
131.9s 135 [BC UPDATE] left → phase 0 RED (reduced inflow)
131.9s 136 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
131.9s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
131.9s 138 
131.9s 139 🚀 Training started: 100 total timesteps
132.4s 140 Running simulation until t = 60.00 s, outputting every 60.00 s
132.4s 141 
132.5s 142 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.5s 143 warn(NumbaPerformanceWarning(msg))
133.2s 144 [WARNING] Automatic CFL correction applied (count: 1):
133.2s 145 Calculated CFL: 0.800 > Limit: 0.500
133.2s 146 Original dt: 3.228311e-01 s
133.2s 147 Corrected dt: 2.017695e-01 s
133.2s 148 Correction factor: 1.6x
133.2s 149 Max wave speed detected: 24.78 m/s
133.4s 150 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
133.4s 151 warn(NumbaPerformanceWarning(msg))
133.7s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
133.7s 153 warn(NumbaPerformanceWarning(msg))
133.7s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
133.7s 155 warn(NumbaPerformanceWarning(msg))
133.8s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
133.8s 157 warn(NumbaPerformanceWarning(msg))
134.2s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.2s 159 warn(NumbaPerformanceWarning(msg))
134.3s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.3s 161 warn(NumbaPerformanceWarning(msg))
134.4s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.4s 163 warn(NumbaPerformanceWarning(msg))
134.5s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.5s 165 warn(NumbaPerformanceWarning(msg))
134.6s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.6s 167 warn(NumbaPerformanceWarning(msg))
134.7s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.7s 169 warn(NumbaPerformanceWarning(msg))
134.7s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
134.7s 171 warn(NumbaPerformanceWarning(msg))
135.2s 172 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
135.7s 173 [WARNING] Automatic CFL correction applied (count: 100):
135.7s 174 Calculated CFL: 0.800 > Limit: 0.500
135.7s 175 Original dt: 4.145004e-01 s
135.7s 176 Corrected dt: 2.590627e-01 s
135.7s 177 Correction factor: 1.6x
135.7s 178 Max wave speed detected: 19.30 m/s
135.7s 179 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
136.2s 180 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
136.6s 181 [WARNING] Automatic CFL correction applied (count: 200):
136.6s 182 Calculated CFL: 0.800 > Limit: 0.500
136.6s 183 Original dt: 4.115380e-01 s
136.6s 184 Corrected dt: 2.572113e-01 s
136.6s 185 Correction factor: 1.6x
136.6s 186 Max wave speed detected: 19.44 m/s
136.6s 187 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
136.9s 188 Stored output at t = 60.0000 s (Step 231)
136.9s 189 
136.9s 190 [A
136.9s 191 
136.9s 192 Simulation finished at t = 60.0000 s after 231 steps.
136.9s 193 Total runtime: 4.47 seconds.
136.9s 194 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.41s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.41s/s]
136.9s 195 [BC UPDATE] left → phase 1 GREEN (normal inflow)
136.9s 196 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
136.9s 197 Running simulation until t = 120.00 s, outputting every 60.00 s
136.9s 198 
137.1s 199 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
137.6s 200 [WARNING] Automatic CFL correction applied (count: 300):
137.6s 201 Calculated CFL: 0.800 > Limit: 0.500
137.6s 202 Original dt: 4.114988e-01 s
137.6s 203 Corrected dt: 2.571867e-01 s
137.6s 204 Correction factor: 1.6x
137.6s 205 Max wave speed detected: 19.44 m/s
137.6s 206 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
138.0s 207 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
138.5s 208 [WARNING] Automatic CFL correction applied (count: 400):
138.5s 209 Calculated CFL: 0.800 > Limit: 0.500
138.5s 210 Original dt: 4.114980e-01 s
138.5s 211 Corrected dt: 2.571863e-01 s
138.5s 212 Correction factor: 1.6x
138.5s 213 Max wave speed detected: 19.44 m/s
138.5s 214 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
139.0s 215 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
139.1s 216 Stored output at t = 120.0000 s (Step 465)
139.1s 217 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
139.1s 218 [A
139.1s 219 
139.1s 220 Simulation finished at t = 120.0000 s after 465 steps.
139.1s 221 Total runtime: 2.21 seconds.
139.1s 222 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s]
139.1s 223 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
139.1s 224 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
139.1s 225 Using device: gpu
139.1s 226 DEBUG PARAMS: Reading K_m_kmh = 10.0
139.1s 227 DEBUG PARAMS: Reading K_c_kmh = 15.0
139.1s 228 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
139.1s 229 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
139.1s 230 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
139.1s 231 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
139.1s 232 Loading road quality type: uniform
139.1s 233 Uniform road quality value: 2
139.1s 234 Road quality loaded.
139.1s 235 Initial state created.
139.1s 236 Transferring initial state and road quality to GPU...
139.1s 237 GPU data transfer complete.
139.1s 238 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
139.1s 239 Initial boundary conditions applied.
139.1s 240 [BC UPDATE] left → phase 0 RED (reduced inflow)
139.1s 241 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
139.2s 242 Running simulation until t = 60.00 s, outputting every 60.00 s
139.2s 243 
139.5s 244 [WARNING] Automatic CFL correction applied (count: 500):
139.5s 245 Calculated CFL: 0.800 > Limit: 0.500
139.5s 246 Original dt: 4.758816e-01 s
139.5s 247 Corrected dt: 2.974260e-01 s
139.5s 248 Correction factor: 1.6x
139.5s 249 Max wave speed detected: 16.81 m/s
139.6s 250 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
140.1s 251 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
140.4s 252 [WARNING] Automatic CFL correction applied (count: 600):
140.4s 253 Calculated CFL: 0.800 > Limit: 0.500
140.4s 254 Original dt: 4.121510e-01 s
140.4s 255 Corrected dt: 2.575944e-01 s
140.4s 256 Correction factor: 1.6x
140.4s 257 Max wave speed detected: 19.41 m/s
140.6s 258 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
141.1s 259 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
141.4s 260 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
141.4s 261 Stored output at t = 60.0000 s (Step 231)
141.4s 262 [A
141.4s 263 
141.4s 264 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.05s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.04s/s]
141.4s 265 Simulation finished at t = 60.0000 s after 231 steps.
141.4s 266 Total runtime: 2.22 seconds.
141.4s 267 [BC UPDATE] left → phase 1 GREEN (normal inflow)
141.4s 268 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
141.4s 269 Running simulation until t = 120.00 s, outputting every 60.00 s
141.4s 270 
141.4s 271 [WARNING] Automatic CFL correction applied (count: 700):
141.4s 272 Calculated CFL: 0.800 > Limit: 0.500
141.4s 273 Original dt: 4.115082e-01 s
141.4s 274 Corrected dt: 2.571926e-01 s
141.4s 275 Correction factor: 1.6x
141.4s 276 Max wave speed detected: 19.44 m/s
141.6s 277 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
142.0s 278 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
142.4s 279 [WARNING] Automatic CFL correction applied (count: 800):
142.4s 280 Calculated CFL: 0.800 > Limit: 0.500
142.4s 281 Original dt: 4.114982e-01 s
142.4s 282 Corrected dt: 2.571864e-01 s
142.4s 283 Correction factor: 1.6x
142.4s 284 Max wave speed detected: 19.44 m/s
142.5s 285 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
143.0s 286 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
143.3s 287 [WARNING] Automatic CFL correction applied (count: 900):
143.3s 288 Calculated CFL: 0.800 > Limit: 0.500
143.3s 289 Original dt: 4.114980e-01 s
143.3s 290 Corrected dt: 2.571863e-01 s
143.3s 291 Correction factor: 1.6x
143.3s 292 Max wave speed detected: 19.44 m/s
143.5s 293 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
143.6s 294 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
143.6s 295 [A
143.6s 296 Stored output at t = 120.0000 s (Step 465)
143.6s 297 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.18s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.18s/s]
143.6s 298 
143.6s 299 Simulation finished at t = 120.0000 s after 465 steps.
143.6s 300 Total runtime: 2.21 seconds.
143.6s 301 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
143.6s 302 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
143.6s 303 Using device: gpu
143.6s 304 DEBUG PARAMS: Reading K_m_kmh = 10.0
143.6s 305 DEBUG PARAMS: Reading K_c_kmh = 15.0
143.6s 306 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
143.6s 307 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
143.6s 308 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
143.6s 309 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
143.6s 310 Loading road quality type: uniform
143.6s 311 Uniform road quality value: 2
143.6s 312 Road quality loaded.
143.6s 313 Initial state created.
143.6s 314 Transferring initial state and road quality to GPU...
143.6s 315 GPU data transfer complete.
143.6s 316 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
143.6s 317 Initial boundary conditions applied.
143.6s 318 [BC UPDATE] left → phase 0 RED (reduced inflow)
143.6s 319 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
143.6s 320 Running simulation until t = 60.00 s, outputting every 60.00 s
143.6s 321 
144.1s 322 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
144.3s 323 [WARNING] Automatic CFL correction applied (count: 1000):
144.3s 324 Calculated CFL: 0.800 > Limit: 0.500
144.3s 325 Original dt: 4.225636e-01 s
144.3s 326 Corrected dt: 2.641023e-01 s
144.3s 327 Correction factor: 1.6x
144.3s 328 Max wave speed detected: 18.93 m/s
144.6s 329 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
145.0s 330 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
145.2s 331 [WARNING] Automatic CFL correction applied (count: 1100):
145.2s 332 Calculated CFL: 0.800 > Limit: 0.500
145.2s 333 Original dt: 4.116395e-01 s
145.2s 334 Corrected dt: 2.572747e-01 s
145.2s 335 Correction factor: 1.6x
145.2s 336 Max wave speed detected: 19.43 m/s
145.5s 337 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
145.8s 338 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
145.8s 339 [A
145.8s 340 Stored output at t = 60.0000 s (Step 231)
145.8s 341 
145.8s 342 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s]
145.8s 343 Simulation finished at t = 60.0000 s after 231 steps.
145.8s 344 Total runtime: 2.18 seconds.
145.8s 345 [BC UPDATE] left → phase 1 GREEN (normal inflow)
145.8s 346 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
145.8s 347 Running simulation until t = 120.00 s, outputting every 60.00 s
145.8s 348 
146.0s 349 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
146.1s 350 [WARNING] Automatic CFL correction applied (count: 1200):
146.1s 351 Calculated CFL: 0.800 > Limit: 0.500
146.1s 352 Original dt: 4.115005e-01 s
146.1s 353 Corrected dt: 2.571878e-01 s
146.1s 354 Correction factor: 1.6x
146.1s 355 Max wave speed detected: 19.44 m/s
146.4s 356 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
146.9s 357 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
147.1s 358 [WARNING] Automatic CFL correction applied (count: 1300):
147.1s 359 Calculated CFL: 0.800 > Limit: 0.500
147.1s 360 Original dt: 4.114981e-01 s
147.1s 361 Corrected dt: 2.571863e-01 s
147.1s 362 Correction factor: 1.6x
147.1s 363 Max wave speed detected: 19.44 m/s
147.4s 364 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
147.9s 365 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
148.0s 366 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
148.0s 367 [A
148.0s 368 Stored output at t = 120.0000 s (Step 465)
148.0s 369 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.86s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.86s/s]
148.0s 370 
148.0s 371 Simulation finished at t = 120.0000 s after 465 steps.
148.0s 372 Total runtime: 2.23 seconds.
148.0s 373 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
148.0s 374 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
148.0s 375 Using device: gpu
148.0s 376 DEBUG PARAMS: Reading K_m_kmh = 10.0
148.0s 377 DEBUG PARAMS: Reading K_c_kmh = 15.0
148.0s 378 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
148.0s 379 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
148.0s 380 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
148.0s 381 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
148.0s 382 Loading road quality type: uniform
148.0s 383 Uniform road quality value: 2
148.0s 384 Road quality loaded.
148.0s 385 Initial state created.
148.0s 386 Transferring initial state and road quality to GPU...
148.0s 387 GPU data transfer complete.
148.0s 388 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
148.0s 389 Initial boundary conditions applied.
148.0s 390 [BC UPDATE] left → phase 0 RED (reduced inflow)
148.0s 391 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
148.0s 392 [BC UPDATE] left → phase 1 GREEN (normal inflow)
148.0s 393 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
148.0s 394 Running simulation until t = 60.00 s, outputting every 60.00 s
148.0s 395 
148.1s 396 [WARNING] Automatic CFL correction applied (count: 1400):
148.1s 397 Calculated CFL: 0.800 > Limit: 0.500
148.1s 398 Original dt: 3.451280e-01 s
148.1s 399 Corrected dt: 2.157050e-01 s
148.1s 400 Correction factor: 1.6x
148.1s 401 Max wave speed detected: 23.18 m/s
148.5s 402 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
149.0s 403 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
149.0s 404 [WARNING] Automatic CFL correction applied (count: 1500):
149.0s 405 Calculated CFL: 0.800 > Limit: 0.500
149.0s 406 Original dt: 4.139892e-01 s
149.0s 407 Corrected dt: 2.587433e-01 s
149.0s 408 Correction factor: 1.6x
149.0s 409 Max wave speed detected: 19.32 m/s
149.5s 410 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
149.9s 411 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
150.0s 412 [WARNING] Automatic CFL correction applied (count: 1600):
150.0s 413 Calculated CFL: 0.800 > Limit: 0.500
150.0s 414 Original dt: 4.115314e-01 s
150.0s 415 Corrected dt: 2.572071e-01 s
150.0s 416 Correction factor: 1.6x
150.0s 417 Max wave speed detected: 19.44 m/s
150.2s 418 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
150.2s 419 Stored output at t = 60.0000 s (Step 231)
150.2s 420 [A
150.2s 421 
150.2s 422 Simulation finished at t = 60.0000 s after 231 steps.
150.2s 423 Total runtime: 2.19 seconds.
150.2s 424 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s]
150.2s 425 
150.2s 426 Running simulation until t = 120.00 s, outputting every 60.00 s
150.4s 427 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
150.9s 428 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
150.9s 429 [WARNING] Automatic CFL correction applied (count: 1700):
150.9s 430 Calculated CFL: 0.800 > Limit: 0.500
150.9s 431 Original dt: 4.114986e-01 s
150.9s 432 Corrected dt: 2.571866e-01 s
150.9s 433 Correction factor: 1.6x
150.9s 434 Max wave speed detected: 19.44 m/s
151.4s 435 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
151.9s 436 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
151.9s 437 [WARNING] Automatic CFL correction applied (count: 1800):
151.9s 438 Calculated CFL: 0.800 > Limit: 0.500
151.9s 439 Original dt: 4.114980e-01 s
151.9s 440 Corrected dt: 2.571863e-01 s
151.9s 441 Correction factor: 1.6x
151.9s 442 Max wave speed detected: 19.44 m/s
152.3s 443 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
152.5s 444 Stored output at t = 120.0000 s (Step 465)
152.5s 445 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
152.5s 446 [A
152.5s 447 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.56s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.56s/s]
152.5s 448 
152.5s 449 Simulation finished at t = 120.0000 s after 465 steps.
152.5s 450 Total runtime: 2.26 seconds.
152.5s 451 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
152.5s 452 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
152.5s 453 Using device: gpu
152.5s 454 DEBUG PARAMS: Reading K_m_kmh = 10.0
152.5s 455 DEBUG PARAMS: Reading K_c_kmh = 15.0
152.5s 456 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
152.5s 457 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
152.5s 458 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
152.5s 459 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
152.5s 460 Loading road quality type: uniform
152.5s 461 Uniform road quality value: 2
152.5s 462 Road quality loaded.
152.5s 463 Initial state created.
152.5s 464 Transferring initial state and road quality to GPU...
152.5s 465 GPU data transfer complete.
152.5s 466 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
152.5s 467 Initial boundary conditions applied.
152.5s 468 [BC UPDATE] left → phase 0 RED (reduced inflow)
152.5s 469 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
152.5s 470 Running simulation until t = 60.00 s, outputting every 60.00 s
152.5s 471 
152.9s 472 [WARNING] Automatic CFL correction applied (count: 1900):
152.9s 473 Calculated CFL: 0.800 > Limit: 0.500
152.9s 474 Original dt: 4.583403e-01 s
152.9s 475 Corrected dt: 2.864627e-01 s
152.9s 476 Correction factor: 1.6x
152.9s 477 Max wave speed detected: 17.45 m/s
153.0s 478 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
153.5s 479 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
153.9s 480 [WARNING] Automatic CFL correction applied (count: 2000):
153.9s 481 Calculated CFL: 0.800 > Limit: 0.500
153.9s 482 Original dt: 4.120137e-01 s
153.9s 483 Corrected dt: 2.575085e-01 s
153.9s 484 Correction factor: 1.6x
153.9s 485 Max wave speed detected: 19.42 m/s
154.0s 486 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
154.5s 487 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
154.8s 488 Stored output at t = 60.0000 s (Step 231)
154.8s 489 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
154.8s 490 [A
154.8s 491 
154.8s 492 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.75s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.75s/s]
154.8s 493 Simulation finished at t = 60.0000 s after 231 steps.
154.8s 494 Total runtime: 2.24 seconds.
154.8s 495 [BC UPDATE] left → phase 1 GREEN (normal inflow)
154.8s 496 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
154.8s 497 Running simulation until t = 120.00 s, outputting every 60.00 s
154.8s 498 
154.8s 499 [WARNING] Automatic CFL correction applied (count: 2100):
154.8s 500 Calculated CFL: 0.800 > Limit: 0.500
154.8s 501 Original dt: 4.115064e-01 s
154.8s 502 Corrected dt: 2.571915e-01 s
154.8s 503 Correction factor: 1.6x
154.8s 504 Max wave speed detected: 19.44 m/s
154.9s 505 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
155.4s 506 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
155.8s 507 [WARNING] Automatic CFL correction applied (count: 2200):
155.8s 508 Calculated CFL: 0.800 > Limit: 0.500
155.8s 509 Original dt: 4.114982e-01 s
155.8s 510 Corrected dt: 2.571864e-01 s
155.8s 511 Correction factor: 1.6x
155.8s 512 Max wave speed detected: 19.44 m/s
155.9s 513 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
156.4s 514 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
156.8s 515 [WARNING] Automatic CFL correction applied (count: 2300):
156.8s 516 Calculated CFL: 0.800 > Limit: 0.500
156.8s 517 Original dt: 4.114980e-01 s
156.8s 518 Corrected dt: 2.571863e-01 s
156.8s 519 Correction factor: 1.6x
156.8s 520 Max wave speed detected: 19.44 m/s
156.9s 521 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
157.0s 522 Stored output at t = 120.0000 s (Step 465)
157.0s 523 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
157.0s 524 [A
157.0s 525 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.54s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.54s/s]
157.0s 526 
157.0s 527 Simulation finished at t = 120.0000 s after 465 steps.
157.0s 528 Total runtime: 2.26 seconds.
157.0s 529 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
157.0s 530 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
157.0s 531 Using device: gpu
157.0s 532 DEBUG PARAMS: Reading K_m_kmh = 10.0
157.0s 533 DEBUG PARAMS: Reading K_c_kmh = 15.0
157.0s 534 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
157.0s 535 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
157.0s 536 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
157.0s 537 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
157.0s 538 Loading road quality type: uniform
157.0s 539 Uniform road quality value: 2
157.0s 540 Road quality loaded.
157.0s 541 Initial state created.
157.0s 542 Transferring initial state and road quality to GPU...
157.0s 543 GPU data transfer complete.
157.0s 544 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
157.0s 545 Initial boundary conditions applied.
157.0s 546 [BC UPDATE] left → phase 0 RED (reduced inflow)
157.0s 547 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
157.0s 548 [BC UPDATE] left → phase 1 GREEN (normal inflow)
157.0s 549 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
157.0s 550 Running simulation until t = 60.00 s, outputting every 60.00 s
157.0s 551 
157.5s 552 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
157.8s 553 [WARNING] Automatic CFL correction applied (count: 2400):
157.8s 554 Calculated CFL: 0.800 > Limit: 0.500
157.8s 555 Original dt: 4.205139e-01 s
157.8s 556 Corrected dt: 2.628212e-01 s
157.8s 557 Correction factor: 1.6x
157.8s 558 Max wave speed detected: 19.02 m/s
158.0s 559 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
158.5s 560 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
158.7s 561 [WARNING] Automatic CFL correction applied (count: 2500):
158.7s 562 Calculated CFL: 0.800 > Limit: 0.500
158.7s 563 Original dt: 4.116141e-01 s
158.7s 564 Corrected dt: 2.572588e-01 s
158.7s 565 Correction factor: 1.6x
158.7s 566 Max wave speed detected: 19.44 m/s
159.0s 567 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
159.3s 568 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
159.3s 569 [A
159.3s 570 Stored output at t = 60.0000 s (Step 231)
159.3s 571 
159.3s 572 Simulation finished at t = 60.0000 s after 231 steps.
159.3s 573 Total runtime: 2.22 seconds.
159.3s 574 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.98s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.98s/s]
159.3s 575 [BC UPDATE] left → phase 0 RED (reduced inflow)
159.3s 576 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
159.3s 577 Running simulation until t = 120.00 s, outputting every 60.00 s
159.3s 578 
159.4s 579 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
159.7s 580 [WARNING] Automatic CFL correction applied (count: 2600):
159.7s 581 Calculated CFL: 0.800 > Limit: 0.500
159.7s 582 Original dt: 4.115000e-01 s
159.7s 583 Corrected dt: 2.571875e-01 s
159.7s 584 Correction factor: 1.6x
159.7s 585 Max wave speed detected: 19.44 m/s
159.9s 586 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
160.4s 587 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
160.6s 588 [WARNING] Automatic CFL correction applied (count: 2700):
160.6s 589 Calculated CFL: 0.800 > Limit: 0.500
160.6s 590 Original dt: 4.114981e-01 s
160.6s 591 Corrected dt: 2.571863e-01 s
160.6s 592 Correction factor: 1.6x
160.6s 593 Max wave speed detected: 19.44 m/s
160.9s 594 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
161.4s 595 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
161.5s 596 Stored output at t = 120.0000 s (Step 465)
161.5s 597 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
161.5s 598 [A
161.5s 599 
161.5s 600 Simulation finished at t = 120.0000 s after 465 steps.
161.5s 601 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.53s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.53s/s]
161.5s 602 Total runtime: 2.26 seconds.
161.5s 603 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
161.5s 604 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
161.5s 605 Using device: gpu
161.5s 606 DEBUG PARAMS: Reading K_m_kmh = 10.0
161.5s 607 DEBUG PARAMS: Reading K_c_kmh = 15.0
161.5s 608 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
161.5s 609 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
161.5s 610 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
161.5s 611 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
161.5s 612 Loading road quality type: uniform
161.5s 613 Uniform road quality value: 2
161.5s 614 Road quality loaded.
161.5s 615 Initial state created.
161.5s 616 Transferring initial state and road quality to GPU...
161.5s 617 GPU data transfer complete.
161.5s 618 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
161.5s 619 Initial boundary conditions applied.
161.5s 620 [BC UPDATE] left → phase 0 RED (reduced inflow)
161.5s 621 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
161.5s 622 [BC UPDATE] left → phase 1 GREEN (normal inflow)
161.5s 623 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
161.5s 624 Running simulation until t = 60.00 s, outputting every 60.00 s
161.5s 625 
161.6s 626 [WARNING] Automatic CFL correction applied (count: 2800):
161.6s 627 Calculated CFL: 0.800 > Limit: 0.500
161.6s 628 Original dt: 3.737254e-01 s
161.6s 629 Corrected dt: 2.335784e-01 s
161.6s 630 Correction factor: 1.6x
161.6s 631 Max wave speed detected: 21.41 m/s
162.0s 632 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
162.5s 633 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
162.6s 634 [WARNING] Automatic CFL correction applied (count: 2900):
162.6s 635 Calculated CFL: 0.800 > Limit: 0.500
162.6s 636 Original dt: 4.134305e-01 s
162.6s 637 Corrected dt: 2.583941e-01 s
162.6s 638 Correction factor: 1.6x
162.6s 639 Max wave speed detected: 19.35 m/s
163.0s 640 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
163.5s 641 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
163.6s 642 [WARNING] Automatic CFL correction applied (count: 3000):
163.6s 643 Calculated CFL: 0.800 > Limit: 0.500
163.6s 644 Original dt: 4.115259e-01 s
163.6s 645 Corrected dt: 2.572037e-01 s
163.6s 646 Correction factor: 1.6x
163.6s 647 Max wave speed detected: 19.44 m/s
163.8s 648 Stored output at t = 60.0000 s (Step 231)
163.8s 649 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
163.8s 650 [A
163.8s 651 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.94s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.94s/s]
163.8s 652 
163.8s 653 Simulation finished at t = 60.0000 s after 231 steps.
163.8s 654 Total runtime: 2.23 seconds.
163.8s 655 Running simulation until t = 120.00 s, outputting every 60.00 s
163.8s 656 
164.0s 657 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
164.4s 658 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
164.5s 659 [WARNING] Automatic CFL correction applied (count: 3100):
164.5s 660 Calculated CFL: 0.800 > Limit: 0.500
164.5s 661 Original dt: 4.114985e-01 s
164.5s 662 Corrected dt: 2.571866e-01 s
164.5s 663 Correction factor: 1.6x
164.5s 664 Max wave speed detected: 19.44 m/s
164.9s 665 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
165.4s 666 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
165.5s 667 [WARNING] Automatic CFL correction applied (count: 3200):
165.5s 668 Calculated CFL: 0.800 > Limit: 0.500
165.5s 669 Original dt: 4.114980e-01 s
165.5s 670 Corrected dt: 2.571863e-01 s
165.5s 671 Correction factor: 1.6x
165.5s 672 Max wave speed detected: 19.44 m/s
165.9s 673 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
166.0s 674 Stored output at t = 120.0000 s (Step 465)
166.0s 675 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
166.0s 676 [A
166.0s 677 
166.0s 678 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.89s/s]
166.0s 679 Simulation finished at t = 120.0000 s after 465 steps.
166.0s 680 Total runtime: 2.23 seconds.
166.0s 681 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
166.0s 682 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
166.0s 683 Using device: gpu
166.0s 684 DEBUG PARAMS: Reading K_m_kmh = 10.0
166.0s 685 DEBUG PARAMS: Reading K_c_kmh = 15.0
166.0s 686 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
166.0s 687 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
166.0s 688 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
166.0s 689 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
166.0s 690 Loading road quality type: uniform
166.0s 691 Uniform road quality value: 2
166.0s 692 Road quality loaded.
166.0s 693 Initial state created.
166.0s 694 Transferring initial state and road quality to GPU...
166.0s 695 GPU data transfer complete.
166.0s 696 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
166.0s 697 Initial boundary conditions applied.
166.0s 698 [BC UPDATE] left → phase 0 RED (reduced inflow)
166.0s 699 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
166.0s 700 Running simulation until t = 60.00 s, outputting every 60.00 s
166.0s 701 
166.4s 702 [WARNING] Automatic CFL correction applied (count: 3300):
166.4s 703 Calculated CFL: 0.800 > Limit: 0.500
166.4s 704 Original dt: 4.470525e-01 s
166.4s 705 Corrected dt: 2.794078e-01 s
166.4s 706 Correction factor: 1.6x
166.4s 707 Max wave speed detected: 17.89 m/s
166.5s 708 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
166.9s 709 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
167.4s 710 [WARNING] Automatic CFL correction applied (count: 3400):
167.4s 711 Calculated CFL: 0.800 > Limit: 0.500
167.4s 712 Original dt: 4.119130e-01 s
167.4s 713 Corrected dt: 2.574456e-01 s
167.4s 714 Correction factor: 1.6x
167.4s 715 Max wave speed detected: 19.42 m/s
167.4s 716 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
167.9s 717 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
168.2s 718 Stored output at t = 60.0000 s (Step 231)
168.2s 719 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
168.2s 720 [A
168.2s 721 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s]
168.2s 722 
168.2s 723 Simulation finished at t = 60.0000 s after 231 steps.
168.2s 724 Total runtime: 2.16 seconds.
168.2s 725 [BC UPDATE] left → phase 1 GREEN (normal inflow)
168.2s 726 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
168.2s 727 Running simulation until t = 120.00 s, outputting every 60.00 s
168.2s 728 
168.3s 729 [WARNING] Automatic CFL correction applied (count: 3500):
168.3s 730 Calculated CFL: 0.800 > Limit: 0.500
168.3s 731 Original dt: 4.115046e-01 s
168.3s 732 Corrected dt: 2.571904e-01 s
168.3s 733 Correction factor: 1.6x
168.3s 734 Max wave speed detected: 19.44 m/s
168.4s 735 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
168.8s 736 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
169.3s 737 [WARNING] Automatic CFL correction applied (count: 3600):
169.3s 738 Calculated CFL: 0.800 > Limit: 0.500
169.3s 739 Original dt: 4.114982e-01 s
169.3s 740 Corrected dt: 2.571863e-01 s
169.3s 741 Correction factor: 1.6x
169.3s 742 Max wave speed detected: 19.44 m/s
169.3s 743 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
169.8s 744 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
170.2s 745 [WARNING] Automatic CFL correction applied (count: 3700):
170.2s 746 Calculated CFL: 0.800 > Limit: 0.500
170.2s 747 Original dt: 4.114980e-01 s
170.2s 748 Corrected dt: 2.571863e-01 s
170.2s 749 Correction factor: 1.6x
170.2s 750 Max wave speed detected: 19.44 m/s
170.2s 751 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
170.4s 752 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
170.4s 753 [A
170.4s 754 Stored output at t = 120.0000 s (Step 465)
170.4s 755 
170.4s 756 Simulation finished at t = 120.0000 s after 465 steps.
170.4s 757 Total runtime: 2.20 seconds.
170.4s 758 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s]
170.4s 759 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
170.4s 760 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
170.4s 761 Using device: gpu
170.4s 762 DEBUG PARAMS: Reading K_m_kmh = 10.0
170.4s 763 DEBUG PARAMS: Reading K_c_kmh = 15.0
170.4s 764 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
170.4s 765 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
170.4s 766 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
170.4s 767 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
170.4s 768 Loading road quality type: uniform
170.4s 769 Uniform road quality value: 2
170.4s 770 Road quality loaded.
170.4s 771 Initial state created.
170.4s 772 Transferring initial state and road quality to GPU...
170.4s 773 GPU data transfer complete.
170.4s 774 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
170.4s 775 Initial boundary conditions applied.
170.4s 776 [BC UPDATE] left → phase 0 RED (reduced inflow)
170.4s 777 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
170.4s 778 [BC UPDATE] left → phase 1 GREEN (normal inflow)
170.4s 779 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
170.4s 780 Running simulation until t = 60.00 s, outputting every 60.00 s
170.4s 781 
170.9s 782 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
171.2s 783 [WARNING] Automatic CFL correction applied (count: 3800):
171.2s 784 Calculated CFL: 0.800 > Limit: 0.500
171.2s 785 Original dt: 4.190346e-01 s
171.2s 786 Corrected dt: 2.618967e-01 s
171.2s 787 Correction factor: 1.6x
171.2s 788 Max wave speed detected: 19.09 m/s
171.4s 789 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
171.8s 790 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
172.1s 791 [WARNING] Automatic CFL correction applied (count: 3900):
172.1s 792 Calculated CFL: 0.800 > Limit: 0.500
172.1s 793 Original dt: 4.115954e-01 s
172.1s 794 Corrected dt: 2.572472e-01 s
172.1s 795 Correction factor: 1.6x
172.1s 796 Max wave speed detected: 19.44 m/s
172.3s 797 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
172.6s 798 Stored output at t = 60.0000 s (Step 231)
172.6s 799 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
172.6s 800 [A
172.6s 801 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.59s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.59s/s]
172.6s 802 
172.6s 803 Simulation finished at t = 60.0000 s after 231 steps.
172.6s 804 Total runtime: 2.17 seconds.
172.6s 805 [BC UPDATE] left → phase 0 RED (reduced inflow)
172.6s 806 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
172.6s 807 Running simulation until t = 120.00 s, outputting every 60.00 s
172.6s 808 
172.8s 809 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
173.0s 810 [WARNING] Automatic CFL correction applied (count: 4000):
173.0s 811 Calculated CFL: 0.800 > Limit: 0.500
173.0s 812 Original dt: 4.114996e-01 s
173.0s 813 Corrected dt: 2.571873e-01 s
173.0s 814 Correction factor: 1.6x
173.0s 815 Max wave speed detected: 19.44 m/s
173.2s 816 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
173.7s 817 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
174.0s 818 [WARNING] Automatic CFL correction applied (count: 4100):
174.0s 819 Calculated CFL: 0.800 > Limit: 0.500
174.0s 820 Original dt: 4.114981e-01 s
174.0s 821 Corrected dt: 2.571863e-01 s
174.0s 822 Correction factor: 1.6x
174.0s 823 Max wave speed detected: 19.44 m/s
174.2s 824 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
174.7s 825 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
174.8s 826 Stored output at t = 120.0000 s (Step 465)
174.8s 827 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
174.8s 828 [A
174.8s 829 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.64s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.64s/s]
174.8s 830 
174.8s 831 Simulation finished at t = 120.0000 s after 465 steps.
174.8s 832 Total runtime: 2.25 seconds.
174.8s 833 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
174.8s 834 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
174.8s 835 Using device: gpu
174.8s 836 DEBUG PARAMS: Reading K_m_kmh = 10.0
174.8s 837 DEBUG PARAMS: Reading K_c_kmh = 15.0
174.8s 838 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
174.8s 839 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
174.8s 840 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
174.8s 841 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
174.8s 842 Loading road quality type: uniform
174.8s 843 Uniform road quality value: 2
174.8s 844 Road quality loaded.
174.8s 845 Initial state created.
174.8s 846 Transferring initial state and road quality to GPU...
174.8s 847 GPU data transfer complete.
174.8s 848 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
174.8s 849 Initial boundary conditions applied.
174.8s 850 [BC UPDATE] left → phase 0 RED (reduced inflow)
174.8s 851 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
174.8s 852 [BC UPDATE] left → phase 1 GREEN (normal inflow)
174.8s 853 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
174.8s 854 Running simulation until t = 60.00 s, outputting every 60.00 s
174.8s 855 
175.0s 856 [WARNING] Automatic CFL correction applied (count: 4200):
175.0s 857 Calculated CFL: 0.800 > Limit: 0.500
175.0s 858 Original dt: 4.022422e-01 s
175.0s 859 Corrected dt: 2.514014e-01 s
175.0s 860 Correction factor: 1.6x
175.0s 861 Max wave speed detected: 19.89 m/s
175.3s 862 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
175.8s 863 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
175.9s 864 [WARNING] Automatic CFL correction applied (count: 4300):
175.9s 865 Calculated CFL: 0.800 > Limit: 0.500
175.9s 866 Original dt: 4.130229e-01 s
175.9s 867 Corrected dt: 2.581393e-01 s
175.9s 868 Correction factor: 1.6x
175.9s 869 Max wave speed detected: 19.37 m/s
176.3s 870 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
176.7s 871 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
176.9s 872 [WARNING] Automatic CFL correction applied (count: 4400):
176.9s 873 Calculated CFL: 0.800 > Limit: 0.500
176.9s 874 Original dt: 4.115198e-01 s
176.9s 875 Corrected dt: 2.571999e-01 s
176.9s 876 Correction factor: 1.6x
176.9s 877 Max wave speed detected: 19.44 m/s
177.0s 878 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
177.0s 879 [A
177.0s 880 Stored output at t = 60.0000 s (Step 231)
177.0s 881 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s]
177.0s 882 
177.0s 883 Simulation finished at t = 60.0000 s after 231 steps.
177.0s 884 Total runtime: 2.21 seconds.
177.1s 885 Running simulation until t = 120.00 s, outputting every 60.00 s
177.1s 886 
177.2s 887 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
177.7s 888 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
177.8s 889 [WARNING] Automatic CFL correction applied (count: 4500):
177.8s 890 Calculated CFL: 0.800 > Limit: 0.500
177.8s 891 Original dt: 4.114984e-01 s
177.8s 892 Corrected dt: 2.571865e-01 s
177.8s 893 Correction factor: 1.6x
177.8s 894 Max wave speed detected: 19.44 m/s
178.2s 895 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
178.6s 896 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
178.8s 897 [WARNING] Automatic CFL correction applied (count: 4600):
178.8s 898 Calculated CFL: 0.800 > Limit: 0.500
178.8s 899 Original dt: 4.114980e-01 s
178.8s 900 Corrected dt: 2.571863e-01 s
178.8s 901 Correction factor: 1.6x
178.8s 902 Max wave speed detected: 19.44 m/s
179.1s 903 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
179.3s 904 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
179.3s 905 [A
179.3s 906 Stored output at t = 120.0000 s (Step 465)
179.3s 907 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.20s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.19s/s]
179.3s 908 
179.3s 909 Simulation finished at t = 120.0000 s after 465 steps.
179.3s 910 Total runtime: 2.21 seconds.
179.3s 911 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
179.3s 912 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
179.3s 913 Using device: gpu
179.3s 914 DEBUG PARAMS: Reading K_m_kmh = 10.0
179.3s 915 DEBUG PARAMS: Reading K_c_kmh = 15.0
179.3s 916 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
179.3s 917 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
179.3s 918 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
179.3s 919 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
179.3s 920 Loading road quality type: uniform
179.3s 921 Uniform road quality value: 2
179.3s 922 Road quality loaded.
179.3s 923 Initial state created.
179.3s 924 Transferring initial state and road quality to GPU...
179.3s 925 GPU data transfer complete.
179.3s 926 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
179.3s 927 Initial boundary conditions applied.
179.3s 928 [BC UPDATE] left → phase 0 RED (reduced inflow)
179.3s 929 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
179.3s 930 [BC UPDATE] left → phase 1 GREEN (normal inflow)
179.3s 931 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
179.3s 932 
179.3s 933 Running simulation until t = 60.00 s, outputting every 60.00 s
179.7s 934 [WARNING] Automatic CFL correction applied (count: 4700):
179.7s 935 Calculated CFL: 0.800 > Limit: 0.500
179.7s 936 Original dt: 4.396418e-01 s
179.7s 937 Corrected dt: 2.747761e-01 s
179.7s 938 Correction factor: 1.6x
179.7s 939 Max wave speed detected: 18.20 m/s
179.8s 940 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
180.2s 941 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
180.7s 942 [WARNING] Automatic CFL correction applied (count: 4800):
180.7s 943 Calculated CFL: 0.800 > Limit: 0.500
180.7s 944 Original dt: 4.118393e-01 s
180.7s 945 Corrected dt: 2.573996e-01 s
180.7s 946 Correction factor: 1.6x
180.7s 947 Max wave speed detected: 19.43 m/s
180.7s 948 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
181.2s 949 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
181.5s 950 Stored output at t = 60.0000 s (Step 231)
181.5s 951 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
181.5s 952 [A
181.5s 953 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.50s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.50s/s]
181.5s 954 
181.5s 955 Simulation finished at t = 60.0000 s after 231 steps.
181.5s 956 Total runtime: 2.26 seconds.
181.5s 957 [BC UPDATE] left → phase 0 RED (reduced inflow)
181.5s 958 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
181.5s 959 Running simulation until t = 120.00 s, outputting every 60.00 s
181.5s 960 
181.7s 961 [WARNING] Automatic CFL correction applied (count: 4900):
181.7s 962 Calculated CFL: 0.800 > Limit: 0.500
181.7s 963 Original dt: 4.115033e-01 s
181.7s 964 Corrected dt: 2.571896e-01 s
181.7s 965 Correction factor: 1.6x
181.7s 966 Max wave speed detected: 19.44 m/s
181.7s 967 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
182.2s 968 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
182.7s 969 [WARNING] Automatic CFL correction applied (count: 5000):
182.7s 970 Calculated CFL: 0.800 > Limit: 0.500
182.7s 971 Original dt: 4.114981e-01 s
182.7s 972 Corrected dt: 2.571863e-01 s
182.7s 973 Correction factor: 1.6x
182.7s 974 Max wave speed detected: 19.44 m/s
182.7s 975 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
183.2s 976 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
183.6s 977 [WARNING] Automatic CFL correction applied (count: 5100):
183.6s 978 Calculated CFL: 0.800 > Limit: 0.500
183.6s 979 Original dt: 4.114980e-01 s
183.6s 980 Corrected dt: 2.571863e-01 s
183.6s 981 Correction factor: 1.6x
183.6s 982 Max wave speed detected: 19.44 m/s
183.6s 983 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
183.8s 984 Stored output at t = 120.0000 s (Step 465)
183.8s 985 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
183.8s 986 [A
183.8s 987 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.83s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.83s/s]
183.8s 988 
183.8s 989 Simulation finished at t = 120.0000 s after 465 steps.
183.8s 990 Total runtime: 2.24 seconds.
183.8s 991 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
183.8s 992 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
183.8s 993 Using device: gpu
183.8s 994 DEBUG PARAMS: Reading K_m_kmh = 10.0
183.8s 995 DEBUG PARAMS: Reading K_c_kmh = 15.0
183.8s 996 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
183.8s 997 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
183.8s 998 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
183.8s 999 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
183.8s 1000 Loading road quality type: uniform
183.8s 1001 Uniform road quality value: 2
183.8s 1002 Road quality loaded.
183.8s 1003 Initial state created.
183.8s 1004 Transferring initial state and road quality to GPU...
183.8s 1005 GPU data transfer complete.
183.8s 1006 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
183.8s 1007 Initial boundary conditions applied.
183.8s 1008 [BC UPDATE] left → phase 0 RED (reduced inflow)
183.8s 1009 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
183.8s 1010 [BC UPDATE] left → phase 1 GREEN (normal inflow)
183.8s 1011 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
183.8s 1012 Running simulation until t = 60.00 s, outputting every 60.00 s
183.8s 1013 
184.3s 1014 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
184.6s 1015 [WARNING] Automatic CFL correction applied (count: 5200):
184.6s 1016 Calculated CFL: 0.800 > Limit: 0.500
184.6s 1017 Original dt: 4.173029e-01 s
184.6s 1018 Corrected dt: 2.608143e-01 s
184.6s 1019 Correction factor: 1.6x
184.6s 1020 Max wave speed detected: 19.17 m/s
184.7s 1021 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
185.2s 1022 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
185.5s 1023 [WARNING] Automatic CFL correction applied (count: 5300):
185.5s 1024 Calculated CFL: 0.800 > Limit: 0.500
185.5s 1025 Original dt: 4.115760e-01 s
185.5s 1026 Corrected dt: 2.572350e-01 s
185.5s 1027 Correction factor: 1.6x
185.5s 1028 Max wave speed detected: 19.44 m/s
185.7s 1029 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
186.0s 1030 Stored output at t = 60.0000 s (Step 231)
186.0s 1031 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
186.0s 1032 [A
186.0s 1033 
186.0s 1034 Simulation finished at t = 60.0000 s after 231 steps.
186.0s 1035 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.80s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.80s/s]
186.0s 1036 Total runtime: 2.16 seconds.
186.0s 1037 Running simulation until t = 120.00 s, outputting every 60.00 s
186.0s 1038 
186.1s 1039 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
186.5s 1040 [WARNING] Automatic CFL correction applied (count: 5400):
186.5s 1041 Calculated CFL: 0.800 > Limit: 0.500
186.5s 1042 Original dt: 4.114993e-01 s
186.5s 1043 Corrected dt: 2.571871e-01 s
186.5s 1044 Correction factor: 1.6x
186.5s 1045 Max wave speed detected: 19.44 m/s
186.6s 1046 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
187.1s 1047 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
187.4s 1048 [WARNING] Automatic CFL correction applied (count: 5500):
187.4s 1049 Calculated CFL: 0.800 > Limit: 0.500
187.4s 1050 Original dt: 4.114981e-01 s
187.4s 1051 Corrected dt: 2.571863e-01 s
187.4s 1052 Correction factor: 1.6x
187.4s 1053 Max wave speed detected: 19.44 m/s
187.6s 1054 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
188.0s 1055 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
188.2s 1056 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
188.2s 1057 [A
188.2s 1058 Stored output at t = 120.0000 s (Step 465)
188.2s 1059 
188.2s 1060 Simulation finished at t = 120.0000 s after 465 steps.
188.2s 1061 Total runtime: 2.24 seconds.
188.2s 1062 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.84s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.84s/s]
188.2s 1063 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
188.2s 1064 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
188.2s 1065 Using device: gpu
188.2s 1066 DEBUG PARAMS: Reading K_m_kmh = 10.0
188.2s 1067 DEBUG PARAMS: Reading K_c_kmh = 15.0
188.2s 1068 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
188.2s 1069 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
188.2s 1070 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
188.2s 1071 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
188.2s 1072 Loading road quality type: uniform
188.2s 1073 Uniform road quality value: 2
188.2s 1074 Road quality loaded.
188.2s 1075 Initial state created.
188.2s 1076 Transferring initial state and road quality to GPU...
188.2s 1077 GPU data transfer complete.
188.2s 1078 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
188.2s 1079 Initial boundary conditions applied.
188.2s 1080 [BC UPDATE] left → phase 0 RED (reduced inflow)
188.2s 1081 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
188.2s 1082 Running simulation until t = 60.00 s, outputting every 60.00 s
188.2s 1083 
188.4s 1084 [WARNING] Automatic CFL correction applied (count: 5600):
188.4s 1085 Calculated CFL: 0.800 > Limit: 0.500
188.4s 1086 Original dt: 4.295974e-01 s
188.4s 1087 Corrected dt: 2.684983e-01 s
188.4s 1088 Correction factor: 1.6x
188.4s 1089 Max wave speed detected: 18.62 m/s
188.7s 1090 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
189.2s 1091 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
189.3s 1092 [WARNING] Automatic CFL correction applied (count: 5700):
189.3s 1093 Calculated CFL: 0.800 > Limit: 0.500
189.3s 1094 Original dt: 4.127253e-01 s
189.3s 1095 Corrected dt: 2.579533e-01 s
189.3s 1096 Correction factor: 1.6x
189.3s 1097 Max wave speed detected: 19.38 m/s
189.6s 1098 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
190.1s 1099 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
190.3s 1100 [WARNING] Automatic CFL correction applied (count: 5800):
190.3s 1101 Calculated CFL: 0.800 > Limit: 0.500
190.3s 1102 Original dt: 4.115153e-01 s
190.3s 1103 Corrected dt: 2.571971e-01 s
190.3s 1104 Correction factor: 1.6x
190.3s 1105 Max wave speed detected: 19.44 m/s
190.4s 1106 Stored output at t = 60.0000 s (Step 231)
190.4s 1107 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
190.4s 1108 [A
190.4s 1109 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.81s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.81s/s]
190.4s 1110 
190.4s 1111 Simulation finished at t = 60.0000 s after 231 steps.
190.4s 1112 Total runtime: 2.16 seconds.
190.4s 1113 [BC UPDATE] left → phase 1 GREEN (normal inflow)
190.4s 1114 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
190.4s 1115 Running simulation until t = 120.00 s, outputting every 60.00 s
190.4s 1116 
190.6s 1117 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
191.1s 1118 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
191.2s 1119 [WARNING] Automatic CFL correction applied (count: 5900):
191.2s 1120 Calculated CFL: 0.800 > Limit: 0.500
191.2s 1121 Original dt: 4.114984e-01 s
191.2s 1122 Corrected dt: 2.571865e-01 s
191.2s 1123 Correction factor: 1.6x
191.2s 1124 Max wave speed detected: 19.44 m/s
191.5s 1125 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
192.0s 1126 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
192.2s 1127 [WARNING] Automatic CFL correction applied (count: 6000):
192.2s 1128 Calculated CFL: 0.800 > Limit: 0.500
192.2s 1129 Original dt: 4.114980e-01 s
192.2s 1130 Corrected dt: 2.571863e-01 s
192.2s 1131 Correction factor: 1.6x
192.2s 1132 Max wave speed detected: 19.44 m/s
192.5s 1133 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
192.6s 1134 Stored output at t = 120.0000 s (Step 465)
192.6s 1135 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
192.6s 1136 [A
192.6s 1137 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.71s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.71s/s]
192.6s 1138 
192.6s 1139 Simulation finished at t = 120.0000 s after 465 steps.
192.6s 1140 Total runtime: 2.25 seconds.
192.6s 1141 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
192.6s 1142 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
192.6s 1143 Using device: gpu
192.6s 1144 DEBUG PARAMS: Reading K_m_kmh = 10.0
192.6s 1145 DEBUG PARAMS: Reading K_c_kmh = 15.0
192.6s 1146 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
192.6s 1147 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
192.6s 1148 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
192.6s 1149 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
192.6s 1150 Loading road quality type: uniform
192.6s 1151 Uniform road quality value: 2
192.6s 1152 Road quality loaded.
192.6s 1153 Initial state created.
192.6s 1154 Transferring initial state and road quality to GPU...
192.6s 1155 GPU data transfer complete.
192.6s 1156 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
192.6s 1157 Initial boundary conditions applied.
192.6s 1158 [BC UPDATE] left → phase 0 RED (reduced inflow)
192.6s 1159 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
192.6s 1160 Running simulation until t = 60.00 s, outputting every 60.00 s
192.6s 1161 
193.1s 1162 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
193.2s 1163 [WARNING] Automatic CFL correction applied (count: 6100):
193.2s 1164 Calculated CFL: 0.800 > Limit: 0.500
193.2s 1165 Original dt: 4.346596e-01 s
193.2s 1166 Corrected dt: 2.716622e-01 s
193.2s 1167 Correction factor: 1.6x
193.2s 1168 Max wave speed detected: 18.41 m/s
193.6s 1169 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
194.1s 1170 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
194.1s 1171 [WARNING] Automatic CFL correction applied (count: 6200):
194.1s 1172 Calculated CFL: 0.800 > Limit: 0.500
194.1s 1173 Original dt: 4.117853e-01 s
194.1s 1174 Corrected dt: 2.573658e-01 s
194.1s 1175 Correction factor: 1.6x
194.1s 1176 Max wave speed detected: 19.43 m/s
194.6s 1177 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
194.9s 1178 Stored output at t = 60.0000 s (Step 231)
194.9s 1179 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
194.9s 1180 [A
194.9s 1181 
194.9s 1182 Simulation finished at t = 60.0000 s after 231 steps.
194.9s 1183 Total runtime: 2.23 seconds.
194.9s 1184 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.92s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.92s/s]
194.9s 1185 Running simulation until t = 120.00 s, outputting every 60.00 s
194.9s 1186 
195.0s 1187 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
195.1s 1188 [WARNING] Automatic CFL correction applied (count: 6300):
195.1s 1189 Calculated CFL: 0.800 > Limit: 0.500
195.1s 1190 Original dt: 4.115023e-01 s
195.1s 1191 Corrected dt: 2.571890e-01 s
195.1s 1192 Correction factor: 1.6x
195.1s 1193 Max wave speed detected: 19.44 m/s
195.5s 1194 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
196.0s 1195 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
196.0s 1196 [WARNING] Automatic CFL correction applied (count: 6400):
196.0s 1197 Calculated CFL: 0.800 > Limit: 0.500
196.0s 1198 Original dt: 4.114981e-01 s
196.0s 1199 Corrected dt: 2.571863e-01 s
196.0s 1200 Correction factor: 1.6x
196.0s 1201 Max wave speed detected: 19.44 m/s
196.4s 1202 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
196.9s 1203 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
197.0s 1204 [WARNING] Automatic CFL correction applied (count: 6500):
197.0s 1205 Calculated CFL: 0.800 > Limit: 0.500
197.0s 1206 Original dt: 4.114980e-01 s
197.0s 1207 Corrected dt: 2.571863e-01 s
197.0s 1208 Correction factor: 1.6x
197.0s 1209 Max wave speed detected: 19.44 m/s
197.1s 1210 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
197.1s 1211 [A
197.1s 1212 Stored output at t = 120.0000 s (Step 465)
197.1s 1213 
197.1s 1214 Simulation finished at t = 120.0000 s after 465 steps.
197.1s 1215 Total runtime: 2.20 seconds.
197.1s 1216 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.33s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.32s/s]
197.1s 1217 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
197.1s 1218 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
197.1s 1219 Using device: gpu
197.1s 1220 DEBUG PARAMS: Reading K_m_kmh = 10.0
197.1s 1221 DEBUG PARAMS: Reading K_c_kmh = 15.0
197.1s 1222 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
197.1s 1223 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
197.1s 1224 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
197.1s 1225 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
197.1s 1226 Loading road quality type: uniform
197.1s 1227 Uniform road quality value: 2
197.1s 1228 Road quality loaded.
197.1s 1229 Initial state created.
197.1s 1230 Transferring initial state and road quality to GPU...
197.1s 1231 GPU data transfer complete.
197.1s 1232 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
197.1s 1233 Initial boundary conditions applied.
197.1s 1234 [BC UPDATE] left → phase 0 RED (reduced inflow)
197.1s 1235 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
197.1s 1236 Running simulation until t = 60.00 s, outputting every 60.00 s
197.1s 1237 
197.6s 1238 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
197.9s 1239 [WARNING] Automatic CFL correction applied (count: 6600):
197.9s 1240 Calculated CFL: 0.800 > Limit: 0.500
197.9s 1241 Original dt: 4.160552e-01 s
197.9s 1242 Corrected dt: 2.600345e-01 s
197.9s 1243 Correction factor: 1.6x
197.9s 1244 Max wave speed detected: 19.23 m/s
198.0s 1245 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
198.5s 1246 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
198.9s 1247 [WARNING] Automatic CFL correction applied (count: 6700):
198.9s 1248 Calculated CFL: 0.800 > Limit: 0.500
198.9s 1249 Original dt: 4.115592e-01 s
198.9s 1250 Corrected dt: 2.572245e-01 s
198.9s 1251 Correction factor: 1.6x
198.9s 1252 Max wave speed detected: 19.44 m/s
199.0s 1253 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
199.3s 1254 Stored output at t = 60.0000 s (Step 231)
199.3s 1255 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
199.3s 1256 [A
199.3s 1257 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.54s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.54s/s]
199.3s 1258 
199.3s 1259 Simulation finished at t = 60.0000 s after 231 steps.
199.3s 1260 Total runtime: 2.18 seconds.
199.3s 1261 Running simulation until t = 120.00 s, outputting every 60.00 s
199.3s 1262 
199.4s 1263 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
199.8s 1264 [WARNING] Automatic CFL correction applied (count: 6800):
199.8s 1265 Calculated CFL: 0.800 > Limit: 0.500
199.8s 1266 Original dt: 4.114991e-01 s
199.8s 1267 Corrected dt: 2.571870e-01 s
199.8s 1268 Correction factor: 1.6x
199.8s 1269 Max wave speed detected: 19.44 m/s
199.9s 1270 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
200.4s 1271 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
200.7s 1272 [WARNING] Automatic CFL correction applied (count: 6900):
200.7s 1273 Calculated CFL: 0.800 > Limit: 0.500
200.7s 1274 Original dt: 4.114980e-01 s
200.7s 1275 Corrected dt: 2.571863e-01 s
200.7s 1276 Correction factor: 1.6x
200.7s 1277 Max wave speed detected: 19.44 m/s
200.9s 1278 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
201.3s 1279 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
201.5s 1280 Stored output at t = 120.0000 s (Step 465)
201.5s 1281 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
201.5s 1282 [A
201.5s 1283 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.17s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.17s/s]
201.5s 1284 
201.5s 1285 Simulation finished at t = 120.0000 s after 465 steps.
201.5s 1286 Total runtime: 2.21 seconds.
201.5s 1287 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
201.5s 1288 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
201.5s 1289 Using device: gpu
201.5s 1290 DEBUG PARAMS: Reading K_m_kmh = 10.0
201.5s 1291 DEBUG PARAMS: Reading K_c_kmh = 15.0
201.5s 1292 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
201.5s 1293 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
201.5s 1294 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
201.5s 1295 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
201.5s 1296 Loading road quality type: uniform
201.5s 1297 Uniform road quality value: 2
201.5s 1298 Road quality loaded.
201.5s 1299 Initial state created.
201.5s 1300 Transferring initial state and road quality to GPU...
201.5s 1301 GPU data transfer complete.
201.5s 1302 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
201.5s 1303 Initial boundary conditions applied.
201.5s 1304 [BC UPDATE] left → phase 0 RED (reduced inflow)
201.5s 1305 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
201.5s 1306 [BC UPDATE] left → phase 1 GREEN (normal inflow)
201.5s 1307 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
201.5s 1308 Running simulation until t = 60.00 s, outputting every 60.00 s
201.5s 1309 
201.7s 1310 [WARNING] Automatic CFL correction applied (count: 7000):
201.7s 1311 Calculated CFL: 0.800 > Limit: 0.500
201.7s 1312 Original dt: 4.547467e-01 s
201.7s 1313 Corrected dt: 2.842167e-01 s
201.7s 1314 Correction factor: 1.6x
201.7s 1315 Max wave speed detected: 17.59 m/s
202.0s 1316 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
202.4s 1317 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
202.7s 1318 [WARNING] Automatic CFL correction applied (count: 7100):
202.7s 1319 Calculated CFL: 0.800 > Limit: 0.500
202.7s 1320 Original dt: 4.125079e-01 s
202.7s 1321 Corrected dt: 2.578175e-01 s
202.7s 1322 Correction factor: 1.6x
202.7s 1323 Max wave speed detected: 19.39 m/s
202.9s 1324 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
203.4s 1325 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
203.6s 1326 [WARNING] Automatic CFL correction applied (count: 7200):
203.6s 1327 Calculated CFL: 0.800 > Limit: 0.500
203.6s 1328 Original dt: 4.115121e-01 s
203.6s 1329 Corrected dt: 2.571950e-01 s
203.6s 1330 Correction factor: 1.6x
203.6s 1331 Max wave speed detected: 19.44 m/s
203.7s 1332 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
203.7s 1333 [A
203.7s 1334 Stored output at t = 60.0000 s (Step 231)
203.7s 1335 
203.7s 1336 Simulation finished at t = 60.0000 s after 231 steps.
203.7s 1337 Total runtime: 2.18 seconds.
203.7s 1338 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.50s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.50s/s]
203.7s 1339 Running simulation until t = 120.00 s, outputting every 60.00 s
203.7s 1340 
203.9s 1341 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
204.3s 1342 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
204.5s 1343 [WARNING] Automatic CFL correction applied (count: 7300):
204.5s 1344 Calculated CFL: 0.800 > Limit: 0.500
204.5s 1345 Original dt: 4.114983e-01 s
204.5s 1346 Corrected dt: 2.571865e-01 s
204.5s 1347 Correction factor: 1.6x
204.5s 1348 Max wave speed detected: 19.44 m/s
204.8s 1349 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
205.2s 1350 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
205.5s 1351 [WARNING] Automatic CFL correction applied (count: 7400):
205.5s 1352 Calculated CFL: 0.800 > Limit: 0.500
205.5s 1353 Original dt: 4.114980e-01 s
205.5s 1354 Corrected dt: 2.571863e-01 s
205.5s 1355 Correction factor: 1.6x
205.5s 1356 Max wave speed detected: 19.44 m/s
205.7s 1357 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
205.8s 1358 Stored output at t = 120.0000 s (Step 465)
205.8s 1359 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
205.8s 1360 [A
205.8s 1361 
205.8s 1362 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s]
205.8s 1363 Simulation finished at t = 120.0000 s after 465 steps.
205.8s 1364 Total runtime: 2.17 seconds.
205.8s 1365 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
205.8s 1366 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
205.8s 1367 Using device: gpu
205.9s 1368 DEBUG PARAMS: Reading K_m_kmh = 10.0
205.9s 1369 DEBUG PARAMS: Reading K_c_kmh = 15.0
205.9s 1370 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
205.9s 1371 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
205.9s 1372 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
205.9s 1373 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
205.9s 1374 Loading road quality type: uniform
205.9s 1375 Uniform road quality value: 2
205.9s 1376 Road quality loaded.
205.9s 1377 Initial state created.
205.9s 1378 Transferring initial state and road quality to GPU...
205.9s 1379 GPU data transfer complete.
205.9s 1380 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
205.9s 1381 Initial boundary conditions applied.
205.9s 1382 [BC UPDATE] left → phase 0 RED (reduced inflow)
205.9s 1383 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
205.9s 1384 [BC UPDATE] left → phase 1 GREEN (normal inflow)
205.9s 1385 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
205.9s 1386 Running simulation until t = 60.00 s, outputting every 60.00 s
205.9s 1387 
206.3s 1388 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
206.4s 1389 [WARNING] Automatic CFL correction applied (count: 7500):
206.4s 1390 Calculated CFL: 0.800 > Limit: 0.500
206.4s 1391 Original dt: 4.295897e-01 s
206.4s 1392 Corrected dt: 2.684936e-01 s
206.4s 1393 Correction factor: 1.6x
206.4s 1394 Max wave speed detected: 18.62 m/s
206.8s 1395 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
207.3s 1396 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
207.3s 1397 [WARNING] Automatic CFL correction applied (count: 7600):
207.3s 1398 Calculated CFL: 0.800 > Limit: 0.500
207.3s 1399 Original dt: 4.117215e-01 s
207.3s 1400 Corrected dt: 2.573259e-01 s
207.3s 1401 Correction factor: 1.6x
207.3s 1402 Max wave speed detected: 19.43 m/s
207.7s 1403 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
208.0s 1404 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
208.0s 1405 Stored output at t = 60.0000 s (Step 231)
208.0s 1406 [A
208.0s 1407 
208.0s 1408 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.87s/s]
208.0s 1409 Simulation finished at t = 60.0000 s after 231 steps.
208.0s 1410 Total runtime: 2.15 seconds.
208.0s 1411 [BC UPDATE] left → phase 0 RED (reduced inflow)
208.0s 1412 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
208.0s 1413 Running simulation until t = 120.00 s, outputting every 60.00 s
208.0s 1414 
208.2s 1415 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
208.3s 1416 [WARNING] Automatic CFL correction applied (count: 7700):
208.3s 1417 Calculated CFL: 0.800 > Limit: 0.500
208.3s 1418 Original dt: 4.115016e-01 s
208.3s 1419 Corrected dt: 2.571885e-01 s
208.3s 1420 Correction factor: 1.6x
208.3s 1421 Max wave speed detected: 19.44 m/s
208.7s 1422 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
209.1s 1423 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
209.2s 1424 [WARNING] Automatic CFL correction applied (count: 7800):
209.2s 1425 Calculated CFL: 0.800 > Limit: 0.500
209.2s 1426 Original dt: 4.114981e-01 s
209.2s 1427 Corrected dt: 2.571863e-01 s
209.2s 1428 Correction factor: 1.6x
209.2s 1429 Max wave speed detected: 19.44 m/s
209.6s 1430 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
210.1s 1431 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
210.1s 1432 [WARNING] Automatic CFL correction applied (count: 7900):
210.1s 1433 Calculated CFL: 0.800 > Limit: 0.500
210.1s 1434 Original dt: 4.114980e-01 s
210.1s 1435 Corrected dt: 2.571863e-01 s
210.1s 1436 Correction factor: 1.6x
210.1s 1437 Max wave speed detected: 19.44 m/s
210.2s 1438 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
210.2s 1439 [A
210.2s 1440 Stored output at t = 120.0000 s (Step 465)
210.2s 1441 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.40s/s]
210.2s 1442 
210.2s 1443 Simulation finished at t = 120.0000 s after 465 steps.
210.2s 1444 Total runtime: 2.19 seconds.
210.2s 1445 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
210.2s 1446 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
210.2s 1447 Using device: gpu
210.2s 1448 DEBUG PARAMS: Reading K_m_kmh = 10.0
210.2s 1449 DEBUG PARAMS: Reading K_c_kmh = 15.0
210.2s 1450 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
210.2s 1451 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
210.2s 1452 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
210.2s 1453 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
210.2s 1454 Loading road quality type: uniform
210.2s 1455 Uniform road quality value: 2
210.2s 1456 Road quality loaded.
210.2s 1457 Initial state created.
210.2s 1458 Transferring initial state and road quality to GPU...
210.2s 1459 GPU data transfer complete.
210.2s 1460 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
210.2s 1461 Initial boundary conditions applied.
210.2s 1462 [BC UPDATE] left → phase 0 RED (reduced inflow)
210.2s 1463 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
210.2s 1464 Running simulation until t = 60.00 s, outputting every 60.00 s
210.2s 1465 
210.7s 1466 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
211.1s 1467 [WARNING] Automatic CFL correction applied (count: 8000):
211.1s 1468 Calculated CFL: 0.800 > Limit: 0.500
211.1s 1469 Original dt: 4.151534e-01 s
211.1s 1470 Corrected dt: 2.594709e-01 s
211.1s 1471 Correction factor: 1.6x
211.1s 1472 Max wave speed detected: 19.27 m/s
211.2s 1473 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
211.6s 1474 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
212.1s 1475 [WARNING] Automatic CFL correction applied (count: 8100):
212.1s 1476 Calculated CFL: 0.800 > Limit: 0.500
212.1s 1477 Original dt: 4.115470e-01 s
212.1s 1478 Corrected dt: 2.572169e-01 s
212.1s 1479 Correction factor: 1.6x
212.1s 1480 Max wave speed detected: 19.44 m/s
212.1s 1481 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
212.4s 1482 Stored output at t = 60.0000 s (Step 231)
212.4s 1483 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
212.4s 1484 [A
212.4s 1485 
212.4s 1486 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.51s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.51s/s]
212.4s 1487 Simulation finished at t = 60.0000 s after 231 steps.
212.4s 1488 Total runtime: 2.18 seconds.
212.4s 1489 Running simulation until t = 120.00 s, outputting every 60.00 s
212.4s 1490 
212.6s 1491 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
213.0s 1492 [WARNING] Automatic CFL correction applied (count: 8200):
213.0s 1493 Calculated CFL: 0.800 > Limit: 0.500
213.0s 1494 Original dt: 4.114990e-01 s
213.0s 1495 Corrected dt: 2.571869e-01 s
213.0s 1496 Correction factor: 1.6x
213.0s 1497 Max wave speed detected: 19.44 m/s
213.0s 1498 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
213.5s 1499 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
214.0s 1500 [WARNING] Automatic CFL correction applied (count: 8300):
214.0s 1501 Calculated CFL: 0.800 > Limit: 0.500
214.0s 1502 Original dt: 4.114980e-01 s
214.0s 1503 Corrected dt: 2.571863e-01 s
214.0s 1504 Correction factor: 1.6x
214.0s 1505 Max wave speed detected: 19.44 m/s
214.0s 1506 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
214.5s 1507 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
214.6s 1508 Stored output at t = 120.0000 s (Step 465)
214.6s 1509 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
214.6s 1510 [A
214.6s 1511 
214.6s 1512 Simulation finished at t = 120.0000 s after 465 steps.
214.6s 1513 Total runtime: 2.22 seconds.
214.6s 1514 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.02s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.02s/s]
214.6s 1515 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
214.6s 1516 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
214.6s 1517 Using device: gpu
214.6s 1518 DEBUG PARAMS: Reading K_m_kmh = 10.0
214.6s 1519 DEBUG PARAMS: Reading K_c_kmh = 15.0
214.6s 1520 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
214.6s 1521 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
214.6s 1522 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
214.6s 1523 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
214.6s 1524 Loading road quality type: uniform
214.6s 1525 Uniform road quality value: 2
214.6s 1526 Road quality loaded.
214.6s 1527 Initial state created.
214.6s 1528 Transferring initial state and road quality to GPU...
214.6s 1529 GPU data transfer complete.
214.6s 1530 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
214.6s 1531 Initial boundary conditions applied.
214.6s 1532 [BC UPDATE] left → phase 0 RED (reduced inflow)
214.6s 1533 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
214.6s 1534 [BC UPDATE] left → phase 1 GREEN (normal inflow)
214.6s 1535 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
214.6s 1536 Running simulation until t = 60.00 s, outputting every 60.00 s
214.6s 1537 
214.9s 1538 [WARNING] Automatic CFL correction applied (count: 8400):
214.9s 1539 Calculated CFL: 0.800 > Limit: 0.500
214.9s 1540 Original dt: 4.768783e-01 s
214.9s 1541 Corrected dt: 2.980490e-01 s
214.9s 1542 Correction factor: 1.6x
214.9s 1543 Max wave speed detected: 16.78 m/s
215.1s 1544 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
215.6s 1545 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
215.9s 1546 [WARNING] Automatic CFL correction applied (count: 8500):
215.9s 1547 Calculated CFL: 0.800 > Limit: 0.500
215.9s 1548 Original dt: 4.123385e-01 s
215.9s 1549 Corrected dt: 2.577116e-01 s
215.9s 1550 Correction factor: 1.6x
215.9s 1551 Max wave speed detected: 19.40 m/s
216.1s 1552 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
216.5s 1553 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
216.8s 1554 [WARNING] Automatic CFL correction applied (count: 8600):
216.8s 1555 Calculated CFL: 0.800 > Limit: 0.500
216.8s 1556 Original dt: 4.115097e-01 s
216.8s 1557 Corrected dt: 2.571935e-01 s
216.8s 1558 Correction factor: 1.6x
216.8s 1559 Max wave speed detected: 19.44 m/s
216.8s 1560 Stored output at t = 60.0000 s (Step 231)
216.8s 1561 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
216.8s 1562 [A
216.8s 1563 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.62s/s]
216.8s 1564 
216.8s 1565 Simulation finished at t = 60.0000 s after 231 steps.
216.8s 1566 Total runtime: 2.17 seconds.
216.8s 1567 Running simulation until t = 120.00 s, outputting every 60.00 s
216.8s 1568 
217.0s 1569 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
217.5s 1570 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
217.7s 1571 [WARNING] Automatic CFL correction applied (count: 8700):
217.7s 1572 Calculated CFL: 0.800 > Limit: 0.500
217.7s 1573 Original dt: 4.114983e-01 s
217.7s 1574 Corrected dt: 2.571864e-01 s
217.7s 1575 Correction factor: 1.6x
217.7s 1576 Max wave speed detected: 19.44 m/s
217.9s 1577 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
218.4s 1578 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
218.7s 1579 [WARNING] Automatic CFL correction applied (count: 8800):
218.7s 1580 Calculated CFL: 0.800 > Limit: 0.500
218.7s 1581 Original dt: 4.114980e-01 s
218.7s 1582 Corrected dt: 2.571863e-01 s
218.7s 1583 Correction factor: 1.6x
218.7s 1584 Max wave speed detected: 19.44 m/s
218.9s 1585 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
219.0s 1586 Stored output at t = 120.0000 s (Step 465)
219.0s 1587 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
219.0s 1588 [A
219.0s 1589 
219.0s 1590 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.20s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.20s/s]
219.0s 1591 Simulation finished at t = 120.0000 s after 465 steps.
219.0s 1592 Total runtime: 2.21 seconds.
219.0s 1593 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
219.0s 1594 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
219.0s 1595 Using device: gpu
219.0s 1596 DEBUG PARAMS: Reading K_m_kmh = 10.0
219.0s 1597 DEBUG PARAMS: Reading K_c_kmh = 15.0
219.0s 1598 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
219.0s 1599 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
219.0s 1600 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
219.0s 1601 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
219.0s 1602 Loading road quality type: uniform
219.0s 1603 Uniform road quality value: 2
219.0s 1604 Road quality loaded.
219.0s 1605 Initial state created.
219.0s 1606 Transferring initial state and road quality to GPU...
219.0s 1607 GPU data transfer complete.
219.0s 1608 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
219.0s 1609 Initial boundary conditions applied.
219.0s 1610 [BC UPDATE] left → phase 0 RED (reduced inflow)
219.0s 1611 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
219.0s 1612 Running simulation until t = 60.00 s, outputting every 60.00 s
219.0s 1613 
219.5s 1614 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
219.7s 1615 [WARNING] Automatic CFL correction applied (count: 8900):
219.7s 1616 Calculated CFL: 0.800 > Limit: 0.500
219.7s 1617 Original dt: 4.254608e-01 s
219.7s 1618 Corrected dt: 2.659130e-01 s
219.7s 1619 Correction factor: 1.6x
219.7s 1620 Max wave speed detected: 18.80 m/s
220.0s 1621 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
220.5s 1622 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
220.6s 1623 [WARNING] Automatic CFL correction applied (count: 9000):
220.6s 1624 Calculated CFL: 0.800 > Limit: 0.500
220.6s 1625 Original dt: 4.116742e-01 s
220.6s 1626 Corrected dt: 2.572964e-01 s
220.6s 1627 Correction factor: 1.6x
220.6s 1628 Max wave speed detected: 19.43 m/s
221.0s 1629 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
221.3s 1630 Stored output at t = 60.0000 s (Step 231)
221.3s 1631 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
221.3s 1632 [A
221.3s 1633 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.09s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.08s/s]
221.3s 1634 
221.3s 1635 Simulation finished at t = 60.0000 s after 231 steps.
221.3s 1636 Total runtime: 2.22 seconds.
221.3s 1637 Running simulation until t = 120.00 s, outputting every 60.00 s
221.3s 1638 
221.4s 1639 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
221.6s 1640 [WARNING] Automatic CFL correction applied (count: 9100):
221.6s 1641 Calculated CFL: 0.800 > Limit: 0.500
221.6s 1642 Original dt: 4.115011e-01 s
221.6s 1643 Corrected dt: 2.571882e-01 s
221.6s 1644 Correction factor: 1.6x
221.6s 1645 Max wave speed detected: 19.44 m/s
221.9s 1646 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
222.4s 1647 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
222.5s 1648 [WARNING] Automatic CFL correction applied (count: 9200):
222.5s 1649 Calculated CFL: 0.800 > Limit: 0.500
222.5s 1650 Original dt: 4.114981e-01 s
222.5s 1651 Corrected dt: 2.571863e-01 s
222.5s 1652 Correction factor: 1.6x
222.5s 1653 Max wave speed detected: 19.44 m/s
222.9s 1654 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
223.3s 1655 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
223.5s 1656 [WARNING] Automatic CFL correction applied (count: 9300):
223.5s 1657 Calculated CFL: 0.800 > Limit: 0.500
223.5s 1658 Original dt: 4.114980e-01 s
223.5s 1659 Corrected dt: 2.571863e-01 s
223.5s 1660 Correction factor: 1.6x
223.5s 1661 Max wave speed detected: 19.44 m/s
223.5s 1662 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
223.5s 1663 [A
223.5s 1664 Stored output at t = 120.0000 s (Step 465)
223.5s 1665 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.13s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.12s/s]
223.5s 1666 
223.5s 1667 Simulation finished at t = 120.0000 s after 465 steps.
223.5s 1668 Total runtime: 2.21 seconds.
223.5s 1669 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
223.5s 1670 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
223.5s 1671 Using device: gpu
223.5s 1672 DEBUG PARAMS: Reading K_m_kmh = 10.0
223.5s 1673 DEBUG PARAMS: Reading K_c_kmh = 15.0
223.5s 1674 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
223.5s 1675 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
223.5s 1676 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
223.5s 1677 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
223.5s 1678 Loading road quality type: uniform
223.5s 1679 Uniform road quality value: 2
223.5s 1680 Road quality loaded.
223.5s 1681 Initial state created.
223.5s 1682 Transferring initial state and road quality to GPU...
223.5s 1683 GPU data transfer complete.
223.5s 1684 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
223.5s 1685 Initial boundary conditions applied.
223.5s 1686 [BC UPDATE] left → phase 0 RED (reduced inflow)
223.5s 1687 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
223.5s 1688 Running simulation until t = 60.00 s, outputting every 60.00 s
223.5s 1689 
224.0s 1690 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
224.4s 1691 [WARNING] Automatic CFL correction applied (count: 9400):
224.4s 1692 Calculated CFL: 0.800 > Limit: 0.500
224.4s 1693 Original dt: 4.145004e-01 s
224.4s 1694 Corrected dt: 2.590627e-01 s
224.4s 1695 Correction factor: 1.6x
224.4s 1696 Max wave speed detected: 19.30 m/s
224.4s 1697 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
224.9s 1698 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
225.3s 1699 [WARNING] Automatic CFL correction applied (count: 9500):
225.3s 1700 Calculated CFL: 0.800 > Limit: 0.500
225.3s 1701 Original dt: 4.115380e-01 s
225.3s 1702 Corrected dt: 2.572113e-01 s
225.3s 1703 Correction factor: 1.6x
225.3s 1704 Max wave speed detected: 19.44 m/s
225.3s 1705 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
225.6s 1706 Stored output at t = 60.0000 s (Step 231)
225.6s 1707 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
225.6s 1708 [A
225.6s 1709 
225.6s 1710 Simulation finished at t = 60.0000 s after 231 steps.
225.6s 1711 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.05s/s]
225.6s 1712 Total runtime: 2.14 seconds.
225.6s 1713 Running simulation until t = 120.00 s, outputting every 60.00 s
225.6s 1714 
225.8s 1715 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
226.3s 1716 [WARNING] Automatic CFL correction applied (count: 9600):
226.3s 1717 Calculated CFL: 0.800 > Limit: 0.500
226.3s 1718 Original dt: 4.114988e-01 s
226.3s 1719 Corrected dt: 2.571867e-01 s
226.3s 1720 Correction factor: 1.6x
226.3s 1721 Max wave speed detected: 19.44 m/s
226.3s 1722 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
226.7s 1723 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
227.2s 1724 [WARNING] Automatic CFL correction applied (count: 9700):
227.2s 1725 Calculated CFL: 0.800 > Limit: 0.500
227.2s 1726 Original dt: 4.114980e-01 s
227.2s 1727 Corrected dt: 2.571863e-01 s
227.2s 1728 Correction factor: 1.6x
227.2s 1729 Max wave speed detected: 19.44 m/s
227.2s 1730 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
227.7s 1731 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
227.9s 1732 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
227.9s 1733 [A
227.9s 1734 Stored output at t = 120.0000 s (Step 465)
227.9s 1735 
227.9s 1736 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s]
227.9s 1737 Simulation finished at t = 120.0000 s after 465 steps.
227.9s 1738 Total runtime: 2.23 seconds.
227.9s 1739 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
227.9s 1740 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
227.9s 1741 Using device: gpu
227.9s 1742 DEBUG PARAMS: Reading K_m_kmh = 10.0
227.9s 1743 DEBUG PARAMS: Reading K_c_kmh = 15.0
227.9s 1744 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
227.9s 1745 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
227.9s 1746 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
227.9s 1747 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
227.9s 1748 Loading road quality type: uniform
227.9s 1749 Uniform road quality value: 2
227.9s 1750 Road quality loaded.
227.9s 1751 Initial state created.
227.9s 1752 Transferring initial state and road quality to GPU...
227.9s 1753 GPU data transfer complete.
227.9s 1754 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
227.9s 1755 Initial boundary conditions applied.
227.9s 1756 [BC UPDATE] left → phase 0 RED (reduced inflow)
227.9s 1757 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
227.9s 1758 [BC UPDATE] left → phase 1 GREEN (normal inflow)
227.9s 1759 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
227.9s 1760 Running simulation until t = 60.00 s, outputting every 60.00 s
227.9s 1761 
228.2s 1762 [WARNING] Automatic CFL correction applied (count: 9800):
228.2s 1763 Calculated CFL: 0.800 > Limit: 0.500
228.2s 1764 Original dt: 4.758816e-01 s
228.2s 1765 Corrected dt: 2.974260e-01 s
228.2s 1766 Correction factor: 1.6x
228.2s 1767 Max wave speed detected: 16.81 m/s
228.4s 1768 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
228.8s 1769 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
229.1s 1770 [WARNING] Automatic CFL correction applied (count: 9900):
229.1s 1771 Calculated CFL: 0.800 > Limit: 0.500
229.1s 1772 Original dt: 4.121510e-01 s
229.1s 1773 Corrected dt: 2.575944e-01 s
229.1s 1774 Correction factor: 1.6x
229.1s 1775 Max wave speed detected: 19.41 m/s
229.3s 1776 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
229.8s 1777 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
230.0s 1778 Stored output at t = 60.0000 s (Step 231)
230.0s 1779 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
230.0s 1780 [A
230.0s 1781 
230.0s 1782 Simulation finished at t = 60.0000 s after 231 steps.
230.0s 1783 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.58s/s]
230.0s 1784 Total runtime: 2.18 seconds.
230.1s 1785 [BC UPDATE] left → phase 0 RED (reduced inflow)
230.1s 1786 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
230.1s 1787 Running simulation until t = 120.00 s, outputting every 60.00 s
230.1s 1788 
230.1s 1789 [WARNING] Automatic CFL correction applied (count: 10000):
230.1s 1790 Calculated CFL: 0.800 > Limit: 0.500
230.1s 1791 Original dt: 4.115082e-01 s
230.1s 1792 Corrected dt: 2.571926e-01 s
230.1s 1793 Correction factor: 1.6x
230.1s 1794 Max wave speed detected: 19.44 m/s
230.2s 1795 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
230.7s 1796 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
231.1s 1797 [WARNING] Automatic CFL correction applied (count: 10100):
231.1s 1798 Calculated CFL: 0.800 > Limit: 0.500
231.1s 1799 Original dt: 4.114982e-01 s
231.1s 1800 Corrected dt: 2.571864e-01 s
231.1s 1801 Correction factor: 1.6x
231.1s 1802 Max wave speed detected: 19.44 m/s
231.2s 1803 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
231.7s 1804 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
232.0s 1805 [WARNING] Automatic CFL correction applied (count: 10200):
232.0s 1806 Calculated CFL: 0.800 > Limit: 0.500
232.0s 1807 Original dt: 4.114980e-01 s
232.0s 1808 Corrected dt: 2.571863e-01 s
232.0s 1809 Correction factor: 1.6x
232.0s 1810 Max wave speed detected: 19.44 m/s
232.2s 1811 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
232.3s 1812 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
232.3s 1813 [A
232.3s 1814 Stored output at t = 120.0000 s (Step 465)
232.3s 1815 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.69s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.69s/s]
232.3s 1816 
232.3s 1817 Simulation finished at t = 120.0000 s after 465 steps.
232.3s 1818 Total runtime: 2.25 seconds.
232.3s 1819 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
232.3s 1820 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
232.3s 1821 Using device: gpu
232.3s 1822 DEBUG PARAMS: Reading K_m_kmh = 10.0
232.3s 1823 DEBUG PARAMS: Reading K_c_kmh = 15.0
232.3s 1824 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
232.3s 1825 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
232.3s 1826 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
232.3s 1827 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
232.3s 1828 Loading road quality type: uniform
232.3s 1829 Uniform road quality value: 2
232.3s 1830 Road quality loaded.
232.3s 1831 Initial state created.
232.3s 1832 Transferring initial state and road quality to GPU...
232.3s 1833 GPU data transfer complete.
232.3s 1834 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
232.3s 1835 Initial boundary conditions applied.
232.3s 1836 [BC UPDATE] left → phase 0 RED (reduced inflow)
232.3s 1837 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
232.3s 1838 Running simulation until t = 60.00 s, outputting every 60.00 s
232.3s 1839 
232.8s 1840 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
233.0s 1841 [WARNING] Automatic CFL correction applied (count: 10300):
233.0s 1842 Calculated CFL: 0.800 > Limit: 0.500
233.0s 1843 Original dt: 4.225636e-01 s
233.0s 1844 Corrected dt: 2.641023e-01 s
233.0s 1845 Correction factor: 1.6x
233.0s 1846 Max wave speed detected: 18.93 m/s
233.3s 1847 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
233.7s 1848 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
233.9s 1849 [WARNING] Automatic CFL correction applied (count: 10400):
233.9s 1850 Calculated CFL: 0.800 > Limit: 0.500
233.9s 1851 Original dt: 4.116395e-01 s
233.9s 1852 Corrected dt: 2.572747e-01 s
233.9s 1853 Correction factor: 1.6x
233.9s 1854 Max wave speed detected: 19.43 m/s
234.2s 1855 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
234.5s 1856 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
234.5s 1857 [A
234.5s 1858 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.21s/s]
234.5s 1859 Stored output at t = 60.0000 s (Step 231)
234.5s 1860 
234.5s 1861 Simulation finished at t = 60.0000 s after 231 steps.
234.5s 1862 Total runtime: 2.21 seconds.
234.5s 1863 
234.5s 1864 Running simulation until t = 120.00 s, outputting every 60.00 s
234.7s 1865 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
234.9s 1866 [WARNING] Automatic CFL correction applied (count: 10500):
234.9s 1867 Calculated CFL: 0.800 > Limit: 0.500
234.9s 1868 Original dt: 4.115005e-01 s
234.9s 1869 Corrected dt: 2.571878e-01 s
234.9s 1870 Correction factor: 1.6x
234.9s 1871 Max wave speed detected: 19.44 m/s
235.2s 1872 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
235.7s 1873 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
235.9s 1874 [WARNING] Automatic CFL correction applied (count: 10600):
235.9s 1875 Calculated CFL: 0.800 > Limit: 0.500
235.9s 1876 Original dt: 4.114981e-01 s
235.9s 1877 Corrected dt: 2.571863e-01 s
235.9s 1878 Correction factor: 1.6x
235.9s 1879 Max wave speed detected: 19.44 m/s
236.2s 1880 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
236.7s 1881 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
236.8s 1882 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
236.8s 1883 [A
236.8s 1884 Stored output at t = 120.0000 s (Step 465)
236.8s 1885 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.07s/s]
236.8s 1886 
236.8s 1887 Simulation finished at t = 120.0000 s after 465 steps.
236.8s 1888 Total runtime: 2.30 seconds.
236.8s 1889 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
236.8s 1890 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
236.8s 1891 Using device: gpu
236.8s 1892 DEBUG PARAMS: Reading K_m_kmh = 10.0
236.8s 1893 DEBUG PARAMS: Reading K_c_kmh = 15.0
236.8s 1894 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
236.8s 1895 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
236.8s 1896 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
236.8s 1897 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
236.8s 1898 Loading road quality type: uniform
236.8s 1899 Uniform road quality value: 2
236.8s 1900 Road quality loaded.
236.8s 1901 Initial state created.
236.8s 1902 Transferring initial state and road quality to GPU...
236.8s 1903 GPU data transfer complete.
236.8s 1904 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
236.8s 1905 Initial boundary conditions applied.
236.8s 1906 [BC UPDATE] left → phase 0 RED (reduced inflow)
236.8s 1907 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
236.8s 1908 Running simulation until t = 60.00 s, outputting every 60.00 s
236.8s 1909 
236.9s 1910 [WARNING] Automatic CFL correction applied (count: 10700):
236.9s 1911 Calculated CFL: 0.800 > Limit: 0.500
236.9s 1912 Original dt: 3.451280e-01 s
236.9s 1913 Corrected dt: 2.157050e-01 s
236.9s 1914 Correction factor: 1.6x
236.9s 1915 Max wave speed detected: 23.18 m/s
237.3s 1916 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
237.8s 1917 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
237.8s 1918 [WARNING] Automatic CFL correction applied (count: 10800):
237.8s 1919 Calculated CFL: 0.800 > Limit: 0.500
237.8s 1920 Original dt: 4.139892e-01 s
237.8s 1921 Corrected dt: 2.587433e-01 s
237.8s 1922 Correction factor: 1.6x
237.8s 1923 Max wave speed detected: 19.32 m/s
238.2s 1924 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
238.7s 1925 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
238.8s 1926 [WARNING] Automatic CFL correction applied (count: 10900):
238.8s 1927 Calculated CFL: 0.800 > Limit: 0.500
238.8s 1928 Original dt: 4.115314e-01 s
238.8s 1929 Corrected dt: 2.572071e-01 s
238.8s 1930 Correction factor: 1.6x
238.8s 1931 Max wave speed detected: 19.44 m/s
239.0s 1932 Stored output at t = 60.0000 s (Step 231)
239.0s 1933 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
239.0s 1934 [A
239.0s 1935 
239.0s 1936 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s]
239.0s 1937 Simulation finished at t = 60.0000 s after 231 steps.
239.0s 1938 Total runtime: 2.17 seconds.
239.0s 1939 [BC UPDATE] left → phase 1 GREEN (normal inflow)
239.0s 1940 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
239.0s 1941 Running simulation until t = 120.00 s, outputting every 60.00 s
239.0s 1942 
239.2s 1943 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
239.7s 1944 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
239.7s 1945 [WARNING] Automatic CFL correction applied (count: 11000):
239.7s 1946 Calculated CFL: 0.800 > Limit: 0.500
239.7s 1947 Original dt: 4.114986e-01 s
239.7s 1948 Corrected dt: 2.571866e-01 s
239.7s 1949 Correction factor: 1.6x
239.7s 1950 Max wave speed detected: 19.44 m/s
240.1s 1951 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
240.6s 1952 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
240.7s 1953 [WARNING] Automatic CFL correction applied (count: 11100):
240.7s 1954 Calculated CFL: 0.800 > Limit: 0.500
240.7s 1955 Original dt: 4.114980e-01 s
240.7s 1956 Corrected dt: 2.571863e-01 s
240.7s 1957 Correction factor: 1.6x
240.7s 1958 Max wave speed detected: 19.44 m/s
241.1s 1959 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
241.3s 1960 Stored output at t = 120.0000 s (Step 465)
241.3s 1961 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
241.3s 1962 [A
241.3s 1963 
241.3s 1964 Simulation finished at t = 120.0000 s after 465 steps.
241.3s 1965 Total runtime: 2.25 seconds.
241.3s 1966 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.72s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.72s/s]
241.3s 1967 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
241.3s 1968 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
241.3s 1969 Using device: gpu
241.3s 1970 DEBUG PARAMS: Reading K_m_kmh = 10.0
241.3s 1971 DEBUG PARAMS: Reading K_c_kmh = 15.0
241.3s 1972 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
241.3s 1973 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
241.3s 1974 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
241.3s 1975 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
241.3s 1976 Loading road quality type: uniform
241.3s 1977 Uniform road quality value: 2
241.3s 1978 Road quality loaded.
241.3s 1979 Initial state created.
241.3s 1980 Transferring initial state and road quality to GPU...
241.3s 1981 GPU data transfer complete.
241.3s 1982 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
241.3s 1983 Initial boundary conditions applied.
241.3s 1984 [BC UPDATE] left → phase 0 RED (reduced inflow)
241.3s 1985 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
241.3s 1986 Running simulation until t = 60.00 s, outputting every 60.00 s
241.3s 1987 
241.6s 1988 [WARNING] Automatic CFL correction applied (count: 11200):
241.6s 1989 Calculated CFL: 0.800 > Limit: 0.500
241.6s 1990 Original dt: 4.583403e-01 s
241.6s 1991 Corrected dt: 2.864627e-01 s
241.6s 1992 Correction factor: 1.6x
241.6s 1993 Max wave speed detected: 17.45 m/s
241.7s 1994 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
242.2s 1995 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
242.6s 1996 [WARNING] Automatic CFL correction applied (count: 11300):
242.6s 1997 Calculated CFL: 0.800 > Limit: 0.500
242.6s 1998 Original dt: 4.120137e-01 s
242.6s 1999 Corrected dt: 2.575085e-01 s
242.6s 2000 Correction factor: 1.6x
242.6s 2001 Max wave speed detected: 19.42 m/s
242.8s 2002 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
243.2s 2003 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
243.5s 2004 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
243.5s 2005 Stored output at t = 60.0000 s (Step 231)
243.5s 2006 [A
243.5s 2007 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.78s/s]
243.5s 2008 
243.5s 2009 Simulation finished at t = 60.0000 s after 231 steps.
243.5s 2010 Total runtime: 2.24 seconds.
243.5s 2011 [BC UPDATE] left → phase 1 GREEN (normal inflow)
243.5s 2012 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
243.5s 2013 Running simulation until t = 120.00 s, outputting every 60.00 s
243.5s 2014 
243.6s 2015 [WARNING] Automatic CFL correction applied (count: 11400):
243.6s 2016 Calculated CFL: 0.800 > Limit: 0.500
243.6s 2017 Original dt: 4.115064e-01 s
243.6s 2018 Corrected dt: 2.571915e-01 s
243.6s 2019 Correction factor: 1.6x
243.6s 2020 Max wave speed detected: 19.44 m/s
243.7s 2021 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
244.2s 2022 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
244.5s 2023 [WARNING] Automatic CFL correction applied (count: 11500):
244.5s 2024 Calculated CFL: 0.800 > Limit: 0.500
244.5s 2025 Original dt: 4.114982e-01 s
244.5s 2026 Corrected dt: 2.571864e-01 s
244.5s 2027 Correction factor: 1.6x
244.5s 2028 Max wave speed detected: 19.44 m/s
244.6s 2029 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
245.1s 2030 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
245.5s 2031 [WARNING] Automatic CFL correction applied (count: 11600):
245.5s 2032 Calculated CFL: 0.800 > Limit: 0.500
245.5s 2033 Original dt: 4.114980e-01 s
245.5s 2034 Corrected dt: 2.571863e-01 s
245.5s 2035 Correction factor: 1.6x
245.5s 2036 Max wave speed detected: 19.44 m/s
245.6s 2037 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
245.7s 2038 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
245.7s 2039 [A
245.7s 2040 Stored output at t = 120.0000 s (Step 465)
245.7s 2041 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.22s/s]
245.7s 2042 
245.7s 2043 Simulation finished at t = 120.0000 s after 465 steps.
245.7s 2044 Total runtime: 2.20 seconds.
245.7s 2045 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
245.7s 2046 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
245.7s 2047 Using device: gpu
245.7s 2048 DEBUG PARAMS: Reading K_m_kmh = 10.0
245.7s 2049 DEBUG PARAMS: Reading K_c_kmh = 15.0
245.7s 2050 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
245.7s 2051 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
245.7s 2052 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
245.7s 2053 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
245.7s 2054 Loading road quality type: uniform
245.7s 2055 Uniform road quality value: 2
245.7s 2056 Road quality loaded.
245.7s 2057 Initial state created.
245.7s 2058 Transferring initial state and road quality to GPU...
245.7s 2059 GPU data transfer complete.
245.7s 2060 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
245.7s 2061 Initial boundary conditions applied.
245.7s 2062 [BC UPDATE] left → phase 0 RED (reduced inflow)
245.7s 2063 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
245.7s 2064 📊 Progress: 50/100 (50.0%) | ETA: 1.9 min | Speed: 0.4 steps/s
245.7s 2065 [BC UPDATE] left → phase 1 GREEN (normal inflow)
245.7s 2066 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
245.7s 2067 Running simulation until t = 60.00 s, outputting every 60.00 s
245.7s 2068 
246.2s 2069 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
246.4s 2070 [WARNING] Automatic CFL correction applied (count: 11700):
246.4s 2071 Calculated CFL: 0.800 > Limit: 0.500
246.4s 2072 Original dt: 4.205139e-01 s
246.4s 2073 Corrected dt: 2.628212e-01 s
246.4s 2074 Correction factor: 1.6x
246.4s 2075 Max wave speed detected: 19.02 m/s
246.7s 2076 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
247.2s 2077 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
247.4s 2078 [WARNING] Automatic CFL correction applied (count: 11800):
247.4s 2079 Calculated CFL: 0.800 > Limit: 0.500
247.4s 2080 Original dt: 4.116141e-01 s
247.4s 2081 Corrected dt: 2.572588e-01 s
247.4s 2082 Correction factor: 1.6x
247.4s 2083 Max wave speed detected: 19.44 m/s
247.7s 2084 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
248.0s 2085 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
248.0s 2086 [A
248.0s 2087 Stored output at t = 60.0000 s (Step 231)
248.0s 2088 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.21s/s]
248.0s 2089 
248.0s 2090 Simulation finished at t = 60.0000 s after 231 steps.
248.0s 2091 Total runtime: 2.21 seconds.
248.0s 2092 Running simulation until t = 120.00 s, outputting every 60.00 s
248.0s 2093 
248.1s 2094 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
248.4s 2095 [WARNING] Automatic CFL correction applied (count: 11900):
248.4s 2096 Calculated CFL: 0.800 > Limit: 0.500
248.4s 2097 Original dt: 4.115000e-01 s
248.4s 2098 Corrected dt: 2.571875e-01 s
248.4s 2099 Correction factor: 1.6x
248.4s 2100 Max wave speed detected: 19.44 m/s
248.6s 2101 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
249.1s 2102 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
249.3s 2103 [WARNING] Automatic CFL correction applied (count: 12000):
249.3s 2104 Calculated CFL: 0.800 > Limit: 0.500
249.3s 2105 Original dt: 4.114981e-01 s
249.3s 2106 Corrected dt: 2.571863e-01 s
249.3s 2107 Correction factor: 1.6x
249.3s 2108 Max wave speed detected: 19.44 m/s
249.5s 2109 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
250.0s 2110 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
250.2s 2111 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
250.2s 2112 [A
250.2s 2113 Stored output at t = 120.0000 s (Step 465)
250.2s 2114 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.12s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.12s/s]
250.2s 2115 
250.2s 2116 Simulation finished at t = 120.0000 s after 465 steps.
250.2s 2117 Total runtime: 2.21 seconds.
250.2s 2118 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
250.2s 2119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
250.2s 2120 Using device: gpu
250.2s 2121 DEBUG PARAMS: Reading K_m_kmh = 10.0
250.2s 2122 DEBUG PARAMS: Reading K_c_kmh = 15.0
250.2s 2123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
250.2s 2124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
250.2s 2125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
250.2s 2126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
250.2s 2127 Loading road quality type: uniform
250.2s 2128 Uniform road quality value: 2
250.2s 2129 Road quality loaded.
250.2s 2130 Initial state created.
250.2s 2131 Transferring initial state and road quality to GPU...
250.2s 2132 GPU data transfer complete.
250.2s 2133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
250.2s 2134 Initial boundary conditions applied.
250.2s 2135 [BC UPDATE] left → phase 0 RED (reduced inflow)
250.2s 2136 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
250.2s 2137 [BC UPDATE] left → phase 1 GREEN (normal inflow)
250.2s 2138 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
250.2s 2139 Running simulation until t = 60.00 s, outputting every 60.00 s
250.2s 2140 
250.3s 2141 [WARNING] Automatic CFL correction applied (count: 12100):
250.3s 2142 Calculated CFL: 0.800 > Limit: 0.500
250.3s 2143 Original dt: 3.737254e-01 s
250.3s 2144 Corrected dt: 2.335784e-01 s
250.3s 2145 Correction factor: 1.6x
250.3s 2146 Max wave speed detected: 21.41 m/s
250.7s 2147 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
251.2s 2148 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
251.3s 2149 [WARNING] Automatic CFL correction applied (count: 12200):
251.3s 2150 Calculated CFL: 0.800 > Limit: 0.500
251.3s 2151 Original dt: 4.134305e-01 s
251.3s 2152 Corrected dt: 2.583941e-01 s
251.3s 2153 Correction factor: 1.6x
251.3s 2154 Max wave speed detected: 19.35 m/s
251.6s 2155 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
252.1s 2156 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
252.2s 2157 [WARNING] Automatic CFL correction applied (count: 12300):
252.2s 2158 Calculated CFL: 0.800 > Limit: 0.500
252.2s 2159 Original dt: 4.115259e-01 s
252.2s 2160 Corrected dt: 2.572037e-01 s
252.2s 2161 Correction factor: 1.6x
252.2s 2162 Max wave speed detected: 19.44 m/s
252.4s 2163 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
252.4s 2164 Stored output at t = 60.0000 s (Step 231)
252.4s 2165 [A
252.4s 2166 
252.4s 2167 Simulation finished at t = 60.0000 s after 231 steps.
252.4s 2168 Total runtime: 2.21 seconds.
252.4s 2169 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.11s/s]
252.4s 2170 [BC UPDATE] left → phase 0 RED (reduced inflow)
252.4s 2171 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
252.4s 2172 Running simulation until t = 120.00 s, outputting every 60.00 s
252.4s 2173 
252.6s 2174 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
253.1s 2175 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
253.1s 2176 [WARNING] Automatic CFL correction applied (count: 12400):
253.1s 2177 Calculated CFL: 0.800 > Limit: 0.500
253.1s 2178 Original dt: 4.114985e-01 s
253.1s 2179 Corrected dt: 2.571866e-01 s
253.1s 2180 Correction factor: 1.6x
253.1s 2181 Max wave speed detected: 19.44 m/s
253.5s 2182 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
254.0s 2183 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
254.1s 2184 [WARNING] Automatic CFL correction applied (count: 12500):
254.1s 2185 Calculated CFL: 0.800 > Limit: 0.500
254.1s 2186 Original dt: 4.114980e-01 s
254.1s 2187 Corrected dt: 2.571863e-01 s
254.1s 2188 Correction factor: 1.6x
254.1s 2189 Max wave speed detected: 19.44 m/s
254.5s 2190 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
254.6s 2191 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
254.6s 2192 [A
254.6s 2193 Stored output at t = 120.0000 s (Step 465)
254.6s 2194 
254.6s 2195 Simulation finished at t = 120.0000 s after 465 steps.
254.6s 2196 Total runtime: 2.22 seconds.
254.6s 2197 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.01s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.00s/s]
254.6s 2198 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
254.6s 2199 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
254.6s 2200 Using device: gpu
254.6s 2201 DEBUG PARAMS: Reading K_m_kmh = 10.0
254.6s 2202 DEBUG PARAMS: Reading K_c_kmh = 15.0
254.6s 2203 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
254.6s 2204 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
254.6s 2205 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
254.6s 2206 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
254.6s 2207 Loading road quality type: uniform
254.6s 2208 Uniform road quality value: 2
254.6s 2209 Road quality loaded.
254.6s 2210 Initial state created.
254.6s 2211 Transferring initial state and road quality to GPU...
254.6s 2212 GPU data transfer complete.
254.6s 2213 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
254.6s 2214 Initial boundary conditions applied.
254.6s 2215 [BC UPDATE] left → phase 0 RED (reduced inflow)
254.6s 2216 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
254.6s 2217 [BC UPDATE] left → phase 1 GREEN (normal inflow)
254.6s 2218 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
254.6s 2219 Running simulation until t = 60.00 s, outputting every 60.00 s
254.6s 2220 
255.1s 2221 [WARNING] Automatic CFL correction applied (count: 12600):
255.1s 2222 Calculated CFL: 0.800 > Limit: 0.500
255.1s 2223 Original dt: 4.470525e-01 s
255.1s 2224 Corrected dt: 2.794078e-01 s
255.1s 2225 Correction factor: 1.6x
255.1s 2226 Max wave speed detected: 17.89 m/s
255.1s 2227 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
255.6s 2228 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
256.0s 2229 [WARNING] Automatic CFL correction applied (count: 12700):
256.0s 2230 Calculated CFL: 0.800 > Limit: 0.500
256.0s 2231 Original dt: 4.119130e-01 s
256.0s 2232 Corrected dt: 2.574456e-01 s
256.0s 2233 Correction factor: 1.6x
256.0s 2234 Max wave speed detected: 19.42 m/s
256.0s 2235 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
256.5s 2236 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
256.8s 2237 Stored output at t = 60.0000 s (Step 231)
256.8s 2238 
256.8s 2239 Simulation finished at t = 60.0000 s after 231 steps.
256.8s 2240 Total runtime: 2.15 seconds.
256.8s 2241 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
256.8s 2242 [A
256.8s 2243 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.94s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.94s/s]
256.8s 2244 [BC UPDATE] left → phase 0 RED (reduced inflow)
256.8s 2245 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
256.8s 2246 Running simulation until t = 120.00 s, outputting every 60.00 s
256.8s 2247 
256.9s 2248 [WARNING] Automatic CFL correction applied (count: 12800):
256.9s 2249 Calculated CFL: 0.800 > Limit: 0.500
256.9s 2250 Original dt: 4.115046e-01 s
256.9s 2251 Corrected dt: 2.571904e-01 s
256.9s 2252 Correction factor: 1.6x
256.9s 2253 Max wave speed detected: 19.44 m/s
257.0s 2254 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
257.4s 2255 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
257.8s 2256 [WARNING] Automatic CFL correction applied (count: 12900):
257.8s 2257 Calculated CFL: 0.800 > Limit: 0.500
257.8s 2258 Original dt: 4.114982e-01 s
257.8s 2259 Corrected dt: 2.571863e-01 s
257.8s 2260 Correction factor: 1.6x
257.8s 2261 Max wave speed detected: 19.44 m/s
257.9s 2262 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
258.4s 2263 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
258.8s 2264 [WARNING] Automatic CFL correction applied (count: 13000):
258.8s 2265 Calculated CFL: 0.800 > Limit: 0.500
258.8s 2266 Original dt: 4.114980e-01 s
258.8s 2267 Corrected dt: 2.571863e-01 s
258.8s 2268 Correction factor: 1.6x
258.8s 2269 Max wave speed detected: 19.44 m/s
258.8s 2270 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
259.0s 2271 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
259.0s 2272 [A
259.0s 2273 Stored output at t = 120.0000 s (Step 465)
259.0s 2274 
259.0s 2275 Simulation finished at t = 120.0000 s after 465 steps.
259.0s 2276 Total runtime: 2.18 seconds.
259.0s 2277 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s]
259.0s 2278 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
259.0s 2279 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
259.0s 2280 Using device: gpu
259.0s 2281 DEBUG PARAMS: Reading K_m_kmh = 10.0
259.0s 2282 DEBUG PARAMS: Reading K_c_kmh = 15.0
259.0s 2283 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
259.0s 2284 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
259.0s 2285 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
259.0s 2286 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
259.0s 2287 Loading road quality type: uniform
259.0s 2288 Uniform road quality value: 2
259.0s 2289 Road quality loaded.
259.0s 2290 Initial state created.
259.0s 2291 Transferring initial state and road quality to GPU...
259.0s 2292 GPU data transfer complete.
259.0s 2293 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
259.0s 2294 Initial boundary conditions applied.
259.0s 2295 [BC UPDATE] left → phase 0 RED (reduced inflow)
259.0s 2296 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
259.0s 2297 Running simulation until t = 60.00 s, outputting every 60.00 s
259.0s 2298 
259.5s 2299 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
259.7s 2300 [WARNING] Automatic CFL correction applied (count: 13100):
259.7s 2301 Calculated CFL: 0.800 > Limit: 0.500
259.7s 2302 Original dt: 4.190346e-01 s
259.7s 2303 Corrected dt: 2.618967e-01 s
259.7s 2304 Correction factor: 1.6x
259.7s 2305 Max wave speed detected: 19.09 m/s
259.9s 2306 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
260.4s 2307 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
260.7s 2308 [WARNING] Automatic CFL correction applied (count: 13200):
260.7s 2309 Calculated CFL: 0.800 > Limit: 0.500
260.7s 2310 Original dt: 4.115954e-01 s
260.7s 2311 Corrected dt: 2.572472e-01 s
260.7s 2312 Correction factor: 1.6x
260.7s 2313 Max wave speed detected: 19.44 m/s
260.9s 2314 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
261.2s 2315 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
261.2s 2316 [A
261.2s 2317 Stored output at t = 60.0000 s (Step 231)
261.2s 2318 
261.2s 2319 Simulation finished at t = 60.0000 s after 231 steps.
261.2s 2320 Total runtime: 2.27 seconds.
261.2s 2321 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.50s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.49s/s]
261.2s 2322 
261.2s 2323 Running simulation until t = 120.00 s, outputting every 60.00 s
261.4s 2324 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
261.7s 2325 [WARNING] Automatic CFL correction applied (count: 13300):
261.7s 2326 Calculated CFL: 0.800 > Limit: 0.500
261.7s 2327 Original dt: 4.114996e-01 s
261.7s 2328 Corrected dt: 2.571873e-01 s
261.7s 2329 Correction factor: 1.6x
261.7s 2330 Max wave speed detected: 19.44 m/s
261.9s 2331 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
262.4s 2332 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
262.7s 2333 [WARNING] Automatic CFL correction applied (count: 13400):
262.7s 2334 Calculated CFL: 0.800 > Limit: 0.500
262.7s 2335 Original dt: 4.114981e-01 s
262.7s 2336 Corrected dt: 2.571863e-01 s
262.7s 2337 Correction factor: 1.6x
262.7s 2338 Max wave speed detected: 19.44 m/s
262.9s 2339 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
263.3s 2340 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
263.5s 2341 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
263.5s 2342 [A
263.5s 2343 Stored output at t = 120.0000 s (Step 465)
263.5s 2344 
263.5s 2345 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.74s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.74s/s]
263.5s 2346 Simulation finished at t = 120.0000 s after 465 steps.
263.5s 2347 Total runtime: 2.24 seconds.
263.5s 2348 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
263.5s 2349 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
263.5s 2350 Using device: gpu
263.5s 2351 DEBUG PARAMS: Reading K_m_kmh = 10.0
263.5s 2352 DEBUG PARAMS: Reading K_c_kmh = 15.0
263.5s 2353 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
263.5s 2354 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
263.5s 2355 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
263.5s 2356 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
263.5s 2357 Loading road quality type: uniform
263.5s 2358 Uniform road quality value: 2
263.5s 2359 Road quality loaded.
263.5s 2360 Initial state created.
263.5s 2361 Transferring initial state and road quality to GPU...
263.5s 2362 GPU data transfer complete.
263.5s 2363 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
263.5s 2364 Initial boundary conditions applied.
263.5s 2365 [BC UPDATE] left → phase 0 RED (reduced inflow)
263.5s 2366 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
263.5s 2367 Running simulation until t = 60.00 s, outputting every 60.00 s
263.5s 2368 
263.6s 2369 [WARNING] Automatic CFL correction applied (count: 13500):
263.6s 2370 Calculated CFL: 0.800 > Limit: 0.500
263.6s 2371 Original dt: 4.022422e-01 s
263.6s 2372 Corrected dt: 2.514014e-01 s
263.6s 2373 Correction factor: 1.6x
263.6s 2374 Max wave speed detected: 19.89 m/s
264.0s 2375 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
264.5s 2376 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
264.6s 2377 [WARNING] Automatic CFL correction applied (count: 13600):
264.6s 2378 Calculated CFL: 0.800 > Limit: 0.500
264.6s 2379 Original dt: 4.130229e-01 s
264.6s 2380 Corrected dt: 2.581393e-01 s
264.6s 2381 Correction factor: 1.6x
264.6s 2382 Max wave speed detected: 19.37 m/s
265.4s 2383 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
265.9s 2384 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
266.0s 2385 [WARNING] Automatic CFL correction applied (count: 13700):
266.0s 2386 Calculated CFL: 0.800 > Limit: 0.500
266.0s 2387 Original dt: 4.115198e-01 s
266.0s 2388 Corrected dt: 2.571999e-01 s
266.0s 2389 Correction factor: 1.6x
266.0s 2390 Max wave speed detected: 19.44 m/s
266.2s 2391 Stored output at t = 60.0000 s (Step 231)
266.2s 2392 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
266.2s 2393 [A
266.2s 2394 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 22.70s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 22.70s/s]
266.2s 2395 
266.2s 2396 Simulation finished at t = 60.0000 s after 231 steps.
266.2s 2397 Total runtime: 2.64 seconds.
266.2s 2398 Running simulation until t = 120.00 s, outputting every 60.00 s
266.2s 2399 
266.3s 2400 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
266.8s 2401 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
266.9s 2402 [WARNING] Automatic CFL correction applied (count: 13800):
266.9s 2403 Calculated CFL: 0.800 > Limit: 0.500
266.9s 2404 Original dt: 4.114984e-01 s
266.9s 2405 Corrected dt: 2.571865e-01 s
266.9s 2406 Correction factor: 1.6x
266.9s 2407 Max wave speed detected: 19.44 m/s
267.3s 2408 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
267.7s 2409 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
267.9s 2410 [WARNING] Automatic CFL correction applied (count: 13900):
267.9s 2411 Calculated CFL: 0.800 > Limit: 0.500
267.9s 2412 Original dt: 4.114980e-01 s
267.9s 2413 Corrected dt: 2.571863e-01 s
267.9s 2414 Correction factor: 1.6x
267.9s 2415 Max wave speed detected: 19.44 m/s
268.2s 2416 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
268.4s 2417 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
268.4s 2418 Stored output at t = 120.0000 s (Step 465)
268.4s 2419 [A
268.4s 2420 
268.4s 2421 Simulation finished at t = 120.0000 s after 465 steps.
268.4s 2422 Total runtime: 2.20 seconds.
268.4s 2423 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.31s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s]
268.4s 2424 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
268.4s 2425 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
268.4s 2426 Using device: gpu
268.4s 2427 DEBUG PARAMS: Reading K_m_kmh = 10.0
268.4s 2428 DEBUG PARAMS: Reading K_c_kmh = 15.0
268.4s 2429 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
268.4s 2430 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
268.4s 2431 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
268.4s 2432 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
268.4s 2433 Loading road quality type: uniform
268.4s 2434 Uniform road quality value: 2
268.4s 2435 Road quality loaded.
268.4s 2436 Initial state created.
268.4s 2437 Transferring initial state and road quality to GPU...
268.4s 2438 GPU data transfer complete.
268.4s 2439 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
268.4s 2440 Initial boundary conditions applied.
268.4s 2441 [BC UPDATE] left → phase 0 RED (reduced inflow)
268.4s 2442 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
268.4s 2443 Running simulation until t = 60.00 s, outputting every 60.00 s
268.4s 2444 
268.8s 2445 [WARNING] Automatic CFL correction applied (count: 14000):
268.8s 2446 Calculated CFL: 0.800 > Limit: 0.500
268.8s 2447 Original dt: 4.396418e-01 s
268.8s 2448 Corrected dt: 2.747761e-01 s
268.8s 2449 Correction factor: 1.6x
268.8s 2450 Max wave speed detected: 18.20 m/s
268.8s 2451 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
269.3s 2452 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
269.8s 2453 [WARNING] Automatic CFL correction applied (count: 14100):
269.8s 2454 Calculated CFL: 0.800 > Limit: 0.500
269.8s 2455 Original dt: 4.118393e-01 s
269.8s 2456 Corrected dt: 2.573996e-01 s
269.8s 2457 Correction factor: 1.6x
269.8s 2458 Max wave speed detected: 19.43 m/s
269.8s 2459 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
270.3s 2460 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
270.6s 2461 Stored output at t = 60.0000 s (Step 231)
270.6s 2462 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
270.6s 2463 [A
270.6s 2464 
270.6s 2465 Simulation finished at t = 60.0000 s after 231 steps.
270.6s 2466 Total runtime: 2.20 seconds.
270.6s 2467 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s]
270.6s 2468 [BC UPDATE] left → phase 1 GREEN (normal inflow)
270.6s 2469 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
270.6s 2470 Running simulation until t = 120.00 s, outputting every 60.00 s
270.6s 2471 
270.7s 2472 [WARNING] Automatic CFL correction applied (count: 14200):
270.7s 2473 Calculated CFL: 0.800 > Limit: 0.500
270.7s 2474 Original dt: 4.115033e-01 s
270.7s 2475 Corrected dt: 2.571896e-01 s
270.7s 2476 Correction factor: 1.6x
270.7s 2477 Max wave speed detected: 19.44 m/s
270.8s 2478 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
271.3s 2479 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
271.7s 2480 [WARNING] Automatic CFL correction applied (count: 14300):
271.7s 2481 Calculated CFL: 0.800 > Limit: 0.500
271.7s 2482 Original dt: 4.114981e-01 s
271.7s 2483 Corrected dt: 2.571863e-01 s
271.7s 2484 Correction factor: 1.6x
271.7s 2485 Max wave speed detected: 19.44 m/s
271.7s 2486 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
272.2s 2487 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
272.7s 2488 [WARNING] Automatic CFL correction applied (count: 14400):
272.7s 2489 Calculated CFL: 0.800 > Limit: 0.500
272.7s 2490 Original dt: 4.114980e-01 s
272.7s 2491 Corrected dt: 2.571863e-01 s
272.7s 2492 Correction factor: 1.6x
272.7s 2493 Max wave speed detected: 19.44 m/s
272.7s 2494 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
272.8s 2495 Stored output at t = 120.0000 s (Step 465)
272.8s 2496 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
272.8s 2497 [A
272.8s 2498 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.62s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.62s/s]
272.8s 2499 
272.8s 2500 Simulation finished at t = 120.0000 s after 465 steps.
272.8s 2501 Total runtime: 2.25 seconds.
272.8s 2502 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
272.8s 2503 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
272.8s 2504 Using device: gpu
272.8s 2505 DEBUG PARAMS: Reading K_m_kmh = 10.0
272.8s 2506 DEBUG PARAMS: Reading K_c_kmh = 15.0
272.8s 2507 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
272.8s 2508 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
272.8s 2509 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
272.8s 2510 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
272.8s 2511 Loading road quality type: uniform
272.8s 2512 Uniform road quality value: 2
272.8s 2513 Road quality loaded.
272.8s 2514 Initial state created.
272.8s 2515 Transferring initial state and road quality to GPU...
272.8s 2516 GPU data transfer complete.
272.8s 2517 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
272.8s 2518 Initial boundary conditions applied.
272.8s 2519 [BC UPDATE] left → phase 0 RED (reduced inflow)
272.8s 2520 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
272.8s 2521 Running simulation until t = 60.00 s, outputting every 60.00 s
272.8s 2522 
273.3s 2523 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
273.6s 2524 [WARNING] Automatic CFL correction applied (count: 14500):
273.6s 2525 Calculated CFL: 0.800 > Limit: 0.500
273.6s 2526 Original dt: 4.173029e-01 s
273.6s 2527 Corrected dt: 2.608143e-01 s
273.6s 2528 Correction factor: 1.6x
273.6s 2529 Max wave speed detected: 19.17 m/s
273.8s 2530 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
274.3s 2531 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
274.6s 2532 [WARNING] Automatic CFL correction applied (count: 14600):
274.6s 2533 Calculated CFL: 0.800 > Limit: 0.500
274.6s 2534 Original dt: 4.115760e-01 s
274.6s 2535 Corrected dt: 2.572350e-01 s
274.6s 2536 Correction factor: 1.6x
274.6s 2537 Max wave speed detected: 19.44 m/s
274.7s 2538 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
275.0s 2539 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
275.0s 2540 [A
275.0s 2541 Stored output at t = 60.0000 s (Step 231)
275.0s 2542 
275.0s 2543 Simulation finished at t = 60.0000 s after 231 steps.
275.0s 2544 Total runtime: 2.19 seconds.
275.0s 2545 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s]
275.0s 2546 Running simulation until t = 120.00 s, outputting every 60.00 s
275.0s 2547 
275.2s 2548 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
275.5s 2549 [WARNING] Automatic CFL correction applied (count: 14700):
275.5s 2550 Calculated CFL: 0.800 > Limit: 0.500
275.5s 2551 Original dt: 4.114993e-01 s
275.5s 2552 Corrected dt: 2.571871e-01 s
275.5s 2553 Correction factor: 1.6x
275.5s 2554 Max wave speed detected: 19.44 m/s
275.7s 2555 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
276.1s 2556 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
276.5s 2557 [WARNING] Automatic CFL correction applied (count: 14800):
276.5s 2558 Calculated CFL: 0.800 > Limit: 0.500
276.5s 2559 Original dt: 4.114981e-01 s
276.5s 2560 Corrected dt: 2.571863e-01 s
276.5s 2561 Correction factor: 1.6x
276.5s 2562 Max wave speed detected: 19.44 m/s
276.6s 2563 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
277.1s 2564 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
277.2s 2565 Stored output at t = 120.0000 s (Step 465)
277.2s 2566 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
277.2s 2567 [A
277.2s 2568 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s]
277.2s 2569 
277.2s 2570 Simulation finished at t = 120.0000 s after 465 steps.
277.2s 2571 Total runtime: 2.18 seconds.
277.2s 2572 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
277.2s 2573 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
277.2s 2574 Using device: gpu
277.2s 2575 DEBUG PARAMS: Reading K_m_kmh = 10.0
277.2s 2576 DEBUG PARAMS: Reading K_c_kmh = 15.0
277.2s 2577 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
277.2s 2578 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
277.2s 2579 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
277.2s 2580 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
277.2s 2581 Loading road quality type: uniform
277.2s 2582 Uniform road quality value: 2
277.2s 2583 Road quality loaded.
277.2s 2584 Initial state created.
277.2s 2585 Transferring initial state and road quality to GPU...
277.2s 2586 GPU data transfer complete.
277.2s 2587 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
277.2s 2588 Initial boundary conditions applied.
277.2s 2589 [BC UPDATE] left → phase 0 RED (reduced inflow)
277.2s 2590 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
277.2s 2591 [BC UPDATE] left → phase 1 GREEN (normal inflow)
277.2s 2592 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
277.2s 2593 Running simulation until t = 60.00 s, outputting every 60.00 s
277.2s 2594 
277.4s 2595 [WARNING] Automatic CFL correction applied (count: 14900):
277.4s 2596 Calculated CFL: 0.800 > Limit: 0.500
277.4s 2597 Original dt: 4.295974e-01 s
277.4s 2598 Corrected dt: 2.684983e-01 s
277.4s 2599 Correction factor: 1.6x
277.4s 2600 Max wave speed detected: 18.62 m/s
277.7s 2601 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
278.2s 2602 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
278.4s 2603 [WARNING] Automatic CFL correction applied (count: 15000):
278.4s 2604 Calculated CFL: 0.800 > Limit: 0.500
278.4s 2605 Original dt: 4.127253e-01 s
278.4s 2606 Corrected dt: 2.579533e-01 s
278.4s 2607 Correction factor: 1.6x
278.4s 2608 Max wave speed detected: 19.38 m/s
278.7s 2609 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
279.1s 2610 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
279.3s 2611 [WARNING] Automatic CFL correction applied (count: 15100):
279.3s 2612 Calculated CFL: 0.800 > Limit: 0.500
279.3s 2613 Original dt: 4.115153e-01 s
279.3s 2614 Corrected dt: 2.571971e-01 s
279.3s 2615 Correction factor: 1.6x
279.3s 2616 Max wave speed detected: 19.44 m/s
279.4s 2617 Stored output at t = 60.0000 s (Step 231)
279.4s 2618 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
279.4s 2619 [A
279.4s 2620 
279.4s 2621 Simulation finished at t = 60.0000 s after 231 steps.
279.4s 2622 Total runtime: 2.20 seconds.
279.4s 2623 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.24s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.23s/s]
279.4s 2624 [BC UPDATE] left → phase 0 RED (reduced inflow)
279.4s 2625 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
279.4s 2626 Running simulation until t = 120.00 s, outputting every 60.00 s
279.4s 2627 
279.6s 2628 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
280.1s 2629 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
280.3s 2630 [WARNING] Automatic CFL correction applied (count: 15200):
280.3s 2631 Calculated CFL: 0.800 > Limit: 0.500
280.3s 2632 Original dt: 4.114984e-01 s
280.3s 2633 Corrected dt: 2.571865e-01 s
280.3s 2634 Correction factor: 1.6x
280.3s 2635 Max wave speed detected: 19.44 m/s
280.5s 2636 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
281.0s 2637 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
281.2s 2638 [WARNING] Automatic CFL correction applied (count: 15300):
281.2s 2639 Calculated CFL: 0.800 > Limit: 0.500
281.2s 2640 Original dt: 4.114980e-01 s
281.2s 2641 Corrected dt: 2.571863e-01 s
281.2s 2642 Correction factor: 1.6x
281.2s 2643 Max wave speed detected: 19.44 m/s
281.5s 2644 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
281.7s 2645 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
281.7s 2646 [A
281.7s 2647 Stored output at t = 120.0000 s (Step 465)
281.7s 2648 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.06s/s]
281.7s 2649 
281.7s 2650 Simulation finished at t = 120.0000 s after 465 steps.
281.7s 2651 Total runtime: 2.22 seconds.
281.7s 2652 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
281.7s 2653 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
281.7s 2654 Using device: gpu
281.7s 2655 DEBUG PARAMS: Reading K_m_kmh = 10.0
281.7s 2656 DEBUG PARAMS: Reading K_c_kmh = 15.0
281.7s 2657 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
281.7s 2658 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
281.7s 2659 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
281.7s 2660 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
281.7s 2661 Loading road quality type: uniform
281.7s 2662 Uniform road quality value: 2
281.7s 2663 Road quality loaded.
281.7s 2664 Initial state created.
281.7s 2665 Transferring initial state and road quality to GPU...
281.7s 2666 GPU data transfer complete.
281.7s 2667 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
281.7s 2668 Initial boundary conditions applied.
281.7s 2669 [BC UPDATE] left → phase 0 RED (reduced inflow)
281.7s 2670 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
281.7s 2671 Running simulation until t = 60.00 s, outputting every 60.00 s
281.7s 2672 
282.1s 2673 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
282.2s 2674 [WARNING] Automatic CFL correction applied (count: 15400):
282.2s 2675 Calculated CFL: 0.800 > Limit: 0.500
282.2s 2676 Original dt: 4.346596e-01 s
282.2s 2677 Corrected dt: 2.716622e-01 s
282.2s 2678 Correction factor: 1.6x
282.2s 2679 Max wave speed detected: 18.41 m/s
282.6s 2680 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
283.1s 2681 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
283.1s 2682 [WARNING] Automatic CFL correction applied (count: 15500):
283.1s 2683 Calculated CFL: 0.800 > Limit: 0.500
283.1s 2684 Original dt: 4.117853e-01 s
283.1s 2685 Corrected dt: 2.573658e-01 s
283.1s 2686 Correction factor: 1.6x
283.1s 2687 Max wave speed detected: 19.43 m/s
283.6s 2688 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
283.9s 2689 Stored output at t = 60.0000 s (Step 231)
283.9s 2690 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
283.9s 2691 [A
283.9s 2692 
283.9s 2693 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.22s/s]
283.9s 2694 Simulation finished at t = 60.0000 s after 231 steps.
283.9s 2695 Total runtime: 2.20 seconds.
283.9s 2696 [BC UPDATE] left → phase 1 GREEN (normal inflow)
283.9s 2697 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
283.9s 2698 Running simulation until t = 120.00 s, outputting every 60.00 s
283.9s 2699 
284.1s 2700 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
284.1s 2701 [WARNING] Automatic CFL correction applied (count: 15600):
284.1s 2702 Calculated CFL: 0.800 > Limit: 0.500
284.1s 2703 Original dt: 4.115023e-01 s
284.1s 2704 Corrected dt: 2.571890e-01 s
284.1s 2705 Correction factor: 1.6x
284.1s 2706 Max wave speed detected: 19.44 m/s
284.5s 2707 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
285.0s 2708 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
285.0s 2709 [WARNING] Automatic CFL correction applied (count: 15700):
285.0s 2710 Calculated CFL: 0.800 > Limit: 0.500
285.0s 2711 Original dt: 4.114981e-01 s
285.0s 2712 Corrected dt: 2.571863e-01 s
285.0s 2713 Correction factor: 1.6x
285.0s 2714 Max wave speed detected: 19.44 m/s
285.5s 2715 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
285.9s 2716 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
286.0s 2717 [WARNING] Automatic CFL correction applied (count: 15800):
286.0s 2718 Calculated CFL: 0.800 > Limit: 0.500
286.0s 2719 Original dt: 4.114980e-01 s
286.0s 2720 Corrected dt: 2.571863e-01 s
286.0s 2721 Correction factor: 1.6x
286.0s 2722 Max wave speed detected: 19.44 m/s
286.1s 2723 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
286.1s 2724 Stored output at t = 120.0000 s (Step 465)
286.1s 2725 [A
286.1s 2726 
286.1s 2727 Simulation finished at t = 120.0000 s after 465 steps.
286.1s 2728 Total runtime: 2.21 seconds.
286.1s 2729 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.11s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.11s/s]
286.1s 2730 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
286.1s 2731 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
286.1s 2732 Using device: gpu
286.1s 2733 DEBUG PARAMS: Reading K_m_kmh = 10.0
286.1s 2734 DEBUG PARAMS: Reading K_c_kmh = 15.0
286.1s 2735 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
286.1s 2736 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
286.1s 2737 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
286.1s 2738 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
286.1s 2739 Loading road quality type: uniform
286.1s 2740 Uniform road quality value: 2
286.1s 2741 Road quality loaded.
286.1s 2742 Initial state created.
286.1s 2743 Transferring initial state and road quality to GPU...
286.1s 2744 GPU data transfer complete.
286.1s 2745 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
286.1s 2746 Initial boundary conditions applied.
286.1s 2747 [BC UPDATE] left → phase 0 RED (reduced inflow)
286.1s 2748 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
286.1s 2749 [BC UPDATE] left → phase 1 GREEN (normal inflow)
286.1s 2750 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
286.1s 2751 Running simulation until t = 60.00 s, outputting every 60.00 s
286.1s 2752 
286.6s 2753 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
287.0s 2754 [WARNING] Automatic CFL correction applied (count: 15900):
287.0s 2755 Calculated CFL: 0.800 > Limit: 0.500
287.0s 2756 Original dt: 4.160552e-01 s
287.0s 2757 Corrected dt: 2.600345e-01 s
287.0s 2758 Correction factor: 1.6x
287.0s 2759 Max wave speed detected: 19.23 m/s
287.1s 2760 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
287.5s 2761 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
287.9s 2762 [WARNING] Automatic CFL correction applied (count: 16000):
287.9s 2763 Calculated CFL: 0.800 > Limit: 0.500
287.9s 2764 Original dt: 4.115592e-01 s
287.9s 2765 Corrected dt: 2.572245e-01 s
287.9s 2766 Correction factor: 1.6x
287.9s 2767 Max wave speed detected: 19.44 m/s
288.0s 2768 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
288.3s 2769 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
288.3s 2770 [A
288.3s 2771 Stored output at t = 60.0000 s (Step 231)
288.3s 2772 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.25s/s]
288.3s 2773 
288.3s 2774 Simulation finished at t = 60.0000 s after 231 steps.
288.3s 2775 Total runtime: 2.20 seconds.
288.3s 2776 Running simulation until t = 120.00 s, outputting every 60.00 s
288.3s 2777 
288.5s 2778 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
288.9s 2779 [WARNING] Automatic CFL correction applied (count: 16100):
288.9s 2780 Calculated CFL: 0.800 > Limit: 0.500
288.9s 2781 Original dt: 4.114991e-01 s
288.9s 2782 Corrected dt: 2.571870e-01 s
288.9s 2783 Correction factor: 1.6x
288.9s 2784 Max wave speed detected: 19.44 m/s
289.0s 2785 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
289.4s 2786 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
289.8s 2787 [WARNING] Automatic CFL correction applied (count: 16200):
289.8s 2788 Calculated CFL: 0.800 > Limit: 0.500
289.8s 2789 Original dt: 4.114980e-01 s
289.8s 2790 Corrected dt: 2.571863e-01 s
289.8s 2791 Correction factor: 1.6x
289.8s 2792 Max wave speed detected: 19.44 m/s
289.9s 2793 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
290.4s 2794 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
290.5s 2795 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
290.5s 2796 [A
290.5s 2797 Stored output at t = 120.0000 s (Step 465)
290.5s 2798 
290.5s 2799 Simulation finished at t = 120.0000 s after 465 steps.
290.5s 2800 Total runtime: 2.21 seconds.
290.5s 2801 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.18s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.17s/s]
290.5s 2802 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
290.5s 2803 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
290.5s 2804 Using device: gpu
290.5s 2805 DEBUG PARAMS: Reading K_m_kmh = 10.0
290.5s 2806 DEBUG PARAMS: Reading K_c_kmh = 15.0
290.5s 2807 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
290.5s 2808 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
290.5s 2809 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
290.5s 2810 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
290.5s 2811 Loading road quality type: uniform
290.5s 2812 Uniform road quality value: 2
290.5s 2813 Road quality loaded.
290.5s 2814 Initial state created.
290.5s 2815 Transferring initial state and road quality to GPU...
290.5s 2816 GPU data transfer complete.
290.5s 2817 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
290.5s 2818 Initial boundary conditions applied.
290.5s 2819 [BC UPDATE] left → phase 0 RED (reduced inflow)
290.5s 2820 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
290.5s 2821 Running simulation until t = 60.00 s, outputting every 60.00 s
290.5s 2822 
290.8s 2823 [WARNING] Automatic CFL correction applied (count: 16300):
290.8s 2824 Calculated CFL: 0.800 > Limit: 0.500
290.8s 2825 Original dt: 4.547467e-01 s
290.8s 2826 Corrected dt: 2.842167e-01 s
290.8s 2827 Correction factor: 1.6x
290.8s 2828 Max wave speed detected: 17.59 m/s
291.0s 2829 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
291.5s 2830 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
291.7s 2831 [WARNING] Automatic CFL correction applied (count: 16400):
291.7s 2832 Calculated CFL: 0.800 > Limit: 0.500
291.7s 2833 Original dt: 4.125079e-01 s
291.7s 2834 Corrected dt: 2.578175e-01 s
291.7s 2835 Correction factor: 1.6x
291.7s 2836 Max wave speed detected: 19.39 m/s
292.0s 2837 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
292.5s 2838 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
292.7s 2839 [WARNING] Automatic CFL correction applied (count: 16500):
292.7s 2840 Calculated CFL: 0.800 > Limit: 0.500
292.7s 2841 Original dt: 4.115121e-01 s
292.7s 2842 Corrected dt: 2.571950e-01 s
292.7s 2843 Correction factor: 1.6x
292.7s 2844 Max wave speed detected: 19.44 m/s
292.8s 2845 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
292.8s 2846 Stored output at t = 60.0000 s (Step 231)
292.8s 2847 [A
292.8s 2848 
292.8s 2849 Simulation finished at t = 60.0000 s after 231 steps.
292.8s 2850 Total runtime: 2.24 seconds.
292.8s 2851 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.79s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.79s/s]
292.8s 2852 [BC UPDATE] left → phase 1 GREEN (normal inflow)
292.8s 2853 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
292.8s 2854 Running simulation until t = 120.00 s, outputting every 60.00 s
292.8s 2855 
293.0s 2856 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
293.4s 2857 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
293.7s 2858 [WARNING] Automatic CFL correction applied (count: 16600):
293.7s 2859 Calculated CFL: 0.800 > Limit: 0.500
293.7s 2860 Original dt: 4.114983e-01 s
293.7s 2861 Corrected dt: 2.571865e-01 s
293.7s 2862 Correction factor: 1.6x
293.7s 2863 Max wave speed detected: 19.44 m/s
293.9s 2864 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
294.4s 2865 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
294.7s 2866 [WARNING] Automatic CFL correction applied (count: 16700):
294.7s 2867 Calculated CFL: 0.800 > Limit: 0.500
294.7s 2868 Original dt: 4.114980e-01 s
294.7s 2869 Corrected dt: 2.571863e-01 s
294.7s 2870 Correction factor: 1.6x
294.7s 2871 Max wave speed detected: 19.44 m/s
294.9s 2872 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
295.0s 2873 Stored output at t = 120.0000 s (Step 465)
295.0s 2874 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
295.0s 2875 [A
295.0s 2876 
295.0s 2877 Simulation finished at t = 120.0000 s after 465 steps.
295.0s 2878 Total runtime: 2.26 seconds.
295.0s 2879 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.61s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.61s/s]
295.0s 2880 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
295.0s 2881 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
295.0s 2882 Using device: gpu
295.0s 2883 DEBUG PARAMS: Reading K_m_kmh = 10.0
295.0s 2884 DEBUG PARAMS: Reading K_c_kmh = 15.0
295.0s 2885 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
295.0s 2886 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
295.0s 2887 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
295.0s 2888 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
295.0s 2889 Loading road quality type: uniform
295.0s 2890 Uniform road quality value: 2
295.0s 2891 Road quality loaded.
295.0s 2892 Initial state created.
295.0s 2893 Transferring initial state and road quality to GPU...
295.0s 2894 GPU data transfer complete.
295.0s 2895 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
295.0s 2896 Initial boundary conditions applied.
295.0s 2897 [BC UPDATE] left → phase 0 RED (reduced inflow)
295.0s 2898 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
295.0s 2899 Running simulation until t = 60.00 s, outputting every 60.00 s
295.0s 2900 
295.5s 2901 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
295.6s 2902 [WARNING] Automatic CFL correction applied (count: 16800):
295.6s 2903 Calculated CFL: 0.800 > Limit: 0.500
295.6s 2904 Original dt: 4.295897e-01 s
295.6s 2905 Corrected dt: 2.684936e-01 s
295.6s 2906 Correction factor: 1.6x
295.6s 2907 Max wave speed detected: 18.62 m/s
296.0s 2908 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
296.5s 2909 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
296.5s 2910 [WARNING] Automatic CFL correction applied (count: 16900):
296.5s 2911 Calculated CFL: 0.800 > Limit: 0.500
296.5s 2912 Original dt: 4.117215e-01 s
296.5s 2913 Corrected dt: 2.573259e-01 s
296.5s 2914 Correction factor: 1.6x
296.5s 2915 Max wave speed detected: 19.43 m/s
296.9s 2916 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
297.2s 2917 Stored output at t = 60.0000 s (Step 231)
297.2s 2918 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
297.2s 2919 [A
297.2s 2920 
297.2s 2921 Simulation finished at t = 60.0000 s after 231 steps.
297.2s 2922 Total runtime: 2.16 seconds.
297.2s 2923 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s]
297.2s 2924 Running simulation until t = 120.00 s, outputting every 60.00 s
297.2s 2925 
297.4s 2926 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
297.5s 2927 [WARNING] Automatic CFL correction applied (count: 17000):
297.5s 2928 Calculated CFL: 0.800 > Limit: 0.500
297.5s 2929 Original dt: 4.115016e-01 s
297.5s 2930 Corrected dt: 2.571885e-01 s
297.5s 2931 Correction factor: 1.6x
297.5s 2932 Max wave speed detected: 19.44 m/s
297.9s 2933 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
298.3s 2934 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
298.4s 2935 [WARNING] Automatic CFL correction applied (count: 17100):
298.4s 2936 Calculated CFL: 0.800 > Limit: 0.500
298.4s 2937 Original dt: 4.114981e-01 s
298.4s 2938 Corrected dt: 2.571863e-01 s
298.4s 2939 Correction factor: 1.6x
298.4s 2940 Max wave speed detected: 19.44 m/s
298.8s 2941 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
299.3s 2942 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
299.4s 2943 [WARNING] Automatic CFL correction applied (count: 17200):
299.4s 2944 Calculated CFL: 0.800 > Limit: 0.500
299.4s 2945 Original dt: 4.114980e-01 s
299.4s 2946 Corrected dt: 2.571863e-01 s
299.4s 2947 Correction factor: 1.6x
299.4s 2948 Max wave speed detected: 19.44 m/s
299.4s 2949 Stored output at t = 120.0000 s (Step 465)
299.4s 2950 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
299.4s 2951 [A
299.4s 2952 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s]
299.4s 2953 
299.4s 2954 Simulation finished at t = 120.0000 s after 465 steps.
299.4s 2955 Total runtime: 2.22 seconds.
299.4s 2956 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
299.4s 2957 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
299.4s 2958 Using device: gpu
299.4s 2959 DEBUG PARAMS: Reading K_m_kmh = 10.0
299.4s 2960 DEBUG PARAMS: Reading K_c_kmh = 15.0
299.4s 2961 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
299.4s 2962 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
299.4s 2963 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
299.4s 2964 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
299.4s 2965 Loading road quality type: uniform
299.4s 2966 Uniform road quality value: 2
299.4s 2967 Road quality loaded.
299.4s 2968 Initial state created.
299.4s 2969 Transferring initial state and road quality to GPU...
299.4s 2970 GPU data transfer complete.
299.4s 2971 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
299.4s 2972 Initial boundary conditions applied.
299.4s 2973 [BC UPDATE] left → phase 0 RED (reduced inflow)
299.4s 2974 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
299.4s 2975 Running simulation until t = 60.00 s, outputting every 60.00 s
299.4s 2976 
299.9s 2977 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
300.3s 2978 [WARNING] Automatic CFL correction applied (count: 17300):
300.3s 2979 Calculated CFL: 0.800 > Limit: 0.500
300.3s 2980 Original dt: 4.151534e-01 s
300.3s 2981 Corrected dt: 2.594709e-01 s
300.3s 2982 Correction factor: 1.6x
300.3s 2983 Max wave speed detected: 19.27 m/s
300.4s 2984 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
300.9s 2985 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
301.3s 2986 [WARNING] Automatic CFL correction applied (count: 17400):
301.3s 2987 Calculated CFL: 0.800 > Limit: 0.500
301.3s 2988 Original dt: 4.115470e-01 s
301.3s 2989 Corrected dt: 2.572169e-01 s
301.3s 2990 Correction factor: 1.6x
301.3s 2991 Max wave speed detected: 19.44 m/s
301.4s 2992 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
301.6s 2993 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
301.6s 2994 [A
301.6s 2995 Stored output at t = 60.0000 s (Step 231)
301.6s 2996 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s]
301.6s 2997 
301.6s 2998 Simulation finished at t = 60.0000 s after 231 steps.
301.6s 2999 Total runtime: 2.19 seconds.
301.6s 3000 Running simulation until t = 120.00 s, outputting every 60.00 s
301.6s 3001 
301.8s 3002 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
302.2s 3003 [WARNING] Automatic CFL correction applied (count: 17500):
302.2s 3004 Calculated CFL: 0.800 > Limit: 0.500
302.2s 3005 Original dt: 4.114990e-01 s
302.2s 3006 Corrected dt: 2.571869e-01 s
302.2s 3007 Correction factor: 1.6x
302.2s 3008 Max wave speed detected: 19.44 m/s
302.3s 3009 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
302.8s 3010 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
303.2s 3011 [WARNING] Automatic CFL correction applied (count: 17600):
303.2s 3012 Calculated CFL: 0.800 > Limit: 0.500
303.2s 3013 Original dt: 4.114980e-01 s
303.2s 3014 Corrected dt: 2.571863e-01 s
303.2s 3015 Correction factor: 1.6x
303.2s 3016 Max wave speed detected: 19.44 m/s
303.2s 3017 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
303.7s 3018 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
303.9s 3019 Stored output at t = 120.0000 s (Step 465)
303.9s 3020 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
303.9s 3021 [A
303.9s 3022 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s]
303.9s 3023 
303.9s 3024 Simulation finished at t = 120.0000 s after 465 steps.
303.9s 3025 Total runtime: 2.23 seconds.
303.9s 3026 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
303.9s 3027 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
303.9s 3028 Using device: gpu
303.9s 3029 DEBUG PARAMS: Reading K_m_kmh = 10.0
303.9s 3030 DEBUG PARAMS: Reading K_c_kmh = 15.0
303.9s 3031 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
303.9s 3032 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
303.9s 3033 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
303.9s 3034 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
303.9s 3035 Loading road quality type: uniform
303.9s 3036 Uniform road quality value: 2
303.9s 3037 Road quality loaded.
303.9s 3038 Initial state created.
303.9s 3039 Transferring initial state and road quality to GPU...
303.9s 3040 GPU data transfer complete.
303.9s 3041 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
303.9s 3042 Initial boundary conditions applied.
303.9s 3043 [BC UPDATE] left → phase 0 RED (reduced inflow)
303.9s 3044 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
303.9s 3045 Running simulation until t = 60.00 s, outputting every 60.00 s
303.9s 3046 
304.2s 3047 [WARNING] Automatic CFL correction applied (count: 17700):
304.2s 3048 Calculated CFL: 0.800 > Limit: 0.500
304.2s 3049 Original dt: 4.768783e-01 s
304.2s 3050 Corrected dt: 2.980490e-01 s
304.2s 3051 Correction factor: 1.6x
304.2s 3052 Max wave speed detected: 16.78 m/s
304.4s 3053 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
304.9s 3054 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
305.1s 3055 [WARNING] Automatic CFL correction applied (count: 17800):
305.1s 3056 Calculated CFL: 0.800 > Limit: 0.500
305.1s 3057 Original dt: 4.123385e-01 s
305.1s 3058 Corrected dt: 2.577116e-01 s
305.1s 3059 Correction factor: 1.6x
305.1s 3060 Max wave speed detected: 19.40 m/s
305.3s 3061 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
305.8s 3062 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
306.1s 3063 [WARNING] Automatic CFL correction applied (count: 17900):
306.1s 3064 Calculated CFL: 0.800 > Limit: 0.500
306.1s 3065 Original dt: 4.115097e-01 s
306.1s 3066 Corrected dt: 2.571935e-01 s
306.1s 3067 Correction factor: 1.6x
306.1s 3068 Max wave speed detected: 19.44 m/s
306.1s 3069 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
306.1s 3070 Stored output at t = 60.0000 s (Step 231)
306.1s 3071 [A
306.1s 3072 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.27s/s]
306.1s 3073 
306.1s 3074 Simulation finished at t = 60.0000 s after 231 steps.
306.1s 3075 Total runtime: 2.20 seconds.
306.1s 3076 [BC UPDATE] left → phase 1 GREEN (normal inflow)
306.1s 3077 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
306.1s 3078 Running simulation until t = 120.00 s, outputting every 60.00 s
306.1s 3079 
306.3s 3080 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
306.7s 3081 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
307.0s 3082 [WARNING] Automatic CFL correction applied (count: 18000):
307.0s 3083 Calculated CFL: 0.800 > Limit: 0.500
307.0s 3084 Original dt: 4.114983e-01 s
307.0s 3085 Corrected dt: 2.571864e-01 s
307.0s 3086 Correction factor: 1.6x
307.0s 3087 Max wave speed detected: 19.44 m/s
307.2s 3088 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
307.7s 3089 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
308.0s 3090 [WARNING] Automatic CFL correction applied (count: 18100):
308.0s 3091 Calculated CFL: 0.800 > Limit: 0.500
308.0s 3092 Original dt: 4.114980e-01 s
308.0s 3093 Corrected dt: 2.571863e-01 s
308.0s 3094 Correction factor: 1.6x
308.0s 3095 Max wave speed detected: 19.44 m/s
308.2s 3096 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
308.3s 3097 Stored output at t = 120.0000 s (Step 465)
308.3s 3098 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
308.3s 3099 [A
308.3s 3100 
308.3s 3101 Simulation finished at t = 120.0000 s after 465 steps.
308.3s 3102 Total runtime: 2.22 seconds.
308.3s 3103 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.99s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.98s/s]
308.3s 3104 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
308.3s 3105 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
308.3s 3106 Using device: gpu
308.3s 3107 DEBUG PARAMS: Reading K_m_kmh = 10.0
308.3s 3108 DEBUG PARAMS: Reading K_c_kmh = 15.0
308.3s 3109 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
308.3s 3110 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
308.3s 3111 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
308.3s 3112 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
308.3s 3113 Loading road quality type: uniform
308.3s 3114 Uniform road quality value: 2
308.3s 3115 Road quality loaded.
308.3s 3116 Initial state created.
308.3s 3117 Transferring initial state and road quality to GPU...
308.3s 3118 GPU data transfer complete.
308.3s 3119 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
308.3s 3120 Initial boundary conditions applied.
308.3s 3121 [BC UPDATE] left → phase 0 RED (reduced inflow)
308.3s 3122 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
308.3s 3123 Running simulation until t = 60.00 s, outputting every 60.00 s
308.3s 3124 
308.8s 3125 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
308.9s 3126 [WARNING] Automatic CFL correction applied (count: 18200):
308.9s 3127 Calculated CFL: 0.800 > Limit: 0.500
308.9s 3128 Original dt: 4.254608e-01 s
308.9s 3129 Corrected dt: 2.659130e-01 s
308.9s 3130 Correction factor: 1.6x
308.9s 3131 Max wave speed detected: 18.80 m/s
309.3s 3132 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
309.7s 3133 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
309.9s 3134 [WARNING] Automatic CFL correction applied (count: 18300):
309.9s 3135 Calculated CFL: 0.800 > Limit: 0.500
309.9s 3136 Original dt: 4.116742e-01 s
309.9s 3137 Corrected dt: 2.572964e-01 s
309.9s 3138 Correction factor: 1.6x
309.9s 3139 Max wave speed detected: 19.43 m/s
310.2s 3140 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
310.5s 3141 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
310.5s 3142 [A
310.5s 3143 Stored output at t = 60.0000 s (Step 231)
310.5s 3144 
310.5s 3145 Simulation finished at t = 60.0000 s after 231 steps.
310.5s 3146 Total runtime: 2.16 seconds.
310.5s 3147 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.82s/s]
310.5s 3148 [BC UPDATE] left → phase 1 GREEN (normal inflow)
310.5s 3149 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
310.5s 3150 Running simulation until t = 120.00 s, outputting every 60.00 s
310.5s 3151 
310.7s 3152 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
310.8s 3153 [WARNING] Automatic CFL correction applied (count: 18400):
310.8s 3154 Calculated CFL: 0.800 > Limit: 0.500
310.8s 3155 Original dt: 4.115011e-01 s
310.8s 3156 Corrected dt: 2.571882e-01 s
310.8s 3157 Correction factor: 1.6x
310.8s 3158 Max wave speed detected: 19.44 m/s
311.2s 3159 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
311.6s 3160 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
311.8s 3161 [WARNING] Automatic CFL correction applied (count: 18500):
311.8s 3162 Calculated CFL: 0.800 > Limit: 0.500
311.8s 3163 Original dt: 4.114981e-01 s
311.8s 3164 Corrected dt: 2.571863e-01 s
311.8s 3165 Correction factor: 1.6x
311.8s 3166 Max wave speed detected: 19.44 m/s
312.1s 3167 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
312.6s 3168 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
312.7s 3169 [WARNING] Automatic CFL correction applied (count: 18600):
312.7s 3170 Calculated CFL: 0.800 > Limit: 0.500
312.7s 3171 Original dt: 4.114980e-01 s
312.7s 3172 Corrected dt: 2.571863e-01 s
312.7s 3173 Correction factor: 1.6x
312.7s 3174 Max wave speed detected: 19.44 m/s
312.7s 3175 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
312.7s 3176 [A
312.7s 3177 Stored output at t = 120.0000 s (Step 465)
312.7s 3178 
312.7s 3179 Simulation finished at t = 120.0000 s after 465 steps.
312.7s 3180 Total runtime: 2.20 seconds.
312.7s 3181 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.23s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.22s/s]
312.7s 3182 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
312.7s 3183 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
312.7s 3184 Using device: gpu
312.7s 3185 DEBUG PARAMS: Reading K_m_kmh = 10.0
312.7s 3186 DEBUG PARAMS: Reading K_c_kmh = 15.0
312.7s 3187 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
312.7s 3188 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
312.7s 3189 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
312.7s 3190 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
312.7s 3191 Loading road quality type: uniform
312.7s 3192 Uniform road quality value: 2
312.7s 3193 Road quality loaded.
312.7s 3194 Initial state created.
312.7s 3195 Transferring initial state and road quality to GPU...
312.7s 3196 GPU data transfer complete.
312.7s 3197 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
312.7s 3198 Initial boundary conditions applied.
312.7s 3199 [BC UPDATE] left → phase 0 RED (reduced inflow)
312.7s 3200 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
312.7s 3201 Running simulation until t = 60.00 s, outputting every 60.00 s
312.7s 3202 
313.2s 3203 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
313.7s 3204 [WARNING] Automatic CFL correction applied (count: 18700):
313.7s 3205 Calculated CFL: 0.800 > Limit: 0.500
313.7s 3206 Original dt: 4.145004e-01 s
313.7s 3207 Corrected dt: 2.590627e-01 s
313.7s 3208 Correction factor: 1.6x
313.7s 3209 Max wave speed detected: 19.30 m/s
313.7s 3210 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
314.1s 3211 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
314.6s 3212 [WARNING] Automatic CFL correction applied (count: 18800):
314.6s 3213 Calculated CFL: 0.800 > Limit: 0.500
314.6s 3214 Original dt: 4.115380e-01 s
314.6s 3215 Corrected dt: 2.572113e-01 s
314.6s 3216 Correction factor: 1.6x
314.6s 3217 Max wave speed detected: 19.44 m/s
314.6s 3218 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
314.9s 3219 Stored output at t = 60.0000 s (Step 231)
314.9s 3220 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
314.9s 3221 [A
314.9s 3222 
314.9s 3223 Simulation finished at t = 60.0000 s after 231 steps.
314.9s 3224 Total runtime: 2.22 seconds.
314.9s 3225 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.02s/s]
314.9s 3226 [BC UPDATE] left → phase 1 GREEN (normal inflow)
314.9s 3227 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
314.9s 3228 Running simulation until t = 120.00 s, outputting every 60.00 s
314.9s 3229 
315.1s 3230 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
315.6s 3231 [WARNING] Automatic CFL correction applied (count: 18900):
315.6s 3232 Calculated CFL: 0.800 > Limit: 0.500
315.6s 3233 Original dt: 4.114988e-01 s
315.6s 3234 Corrected dt: 2.571867e-01 s
315.6s 3235 Correction factor: 1.6x
315.6s 3236 Max wave speed detected: 19.44 m/s
315.6s 3237 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
316.1s 3238 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
316.5s 3239 [WARNING] Automatic CFL correction applied (count: 19000):
316.5s 3240 Calculated CFL: 0.800 > Limit: 0.500
316.5s 3241 Original dt: 4.114980e-01 s
316.5s 3242 Corrected dt: 2.571863e-01 s
316.5s 3243 Correction factor: 1.6x
316.5s 3244 Max wave speed detected: 19.44 m/s
316.5s 3245 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
317.0s 3246 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
317.1s 3247 Stored output at t = 120.0000 s (Step 465)
317.1s 3248 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
317.1s 3249 [A
317.1s 3250 
317.1s 3251 Simulation finished at t = 120.0000 s after 465 steps.
317.1s 3252 Total runtime: 2.21 seconds.
317.1s 3253 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.15s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.15s/s]
317.1s 3254 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
317.1s 3255 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
317.1s 3256 Using device: gpu
317.2s 3257 DEBUG PARAMS: Reading K_m_kmh = 10.0
317.2s 3258 DEBUG PARAMS: Reading K_c_kmh = 15.0
317.2s 3259 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
317.2s 3260 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
317.2s 3261 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
317.2s 3262 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
317.2s 3263 Loading road quality type: uniform
317.2s 3264 Uniform road quality value: 2
317.2s 3265 Road quality loaded.
317.2s 3266 Initial state created.
317.2s 3267 Transferring initial state and road quality to GPU...
317.2s 3268 GPU data transfer complete.
317.2s 3269 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
317.2s 3270 Initial boundary conditions applied.
317.2s 3271 [BC UPDATE] left → phase 0 RED (reduced inflow)
317.2s 3272 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
317.2s 3273 Running simulation until t = 60.00 s, outputting every 60.00 s
317.2s 3274 
317.5s 3275 [WARNING] Automatic CFL correction applied (count: 19100):
317.5s 3276 Calculated CFL: 0.800 > Limit: 0.500
317.5s 3277 Original dt: 4.758816e-01 s
317.5s 3278 Corrected dt: 2.974260e-01 s
317.5s 3279 Correction factor: 1.6x
317.5s 3280 Max wave speed detected: 16.81 m/s
317.6s 3281 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
318.1s 3282 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
318.4s 3283 [WARNING] Automatic CFL correction applied (count: 19200):
318.4s 3284 Calculated CFL: 0.800 > Limit: 0.500
318.4s 3285 Original dt: 4.121510e-01 s
318.4s 3286 Corrected dt: 2.575944e-01 s
318.4s 3287 Correction factor: 1.6x
318.4s 3288 Max wave speed detected: 19.41 m/s
318.6s 3289 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
319.0s 3290 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
319.3s 3291 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
319.3s 3292 [A
319.3s 3293 Stored output at t = 60.0000 s (Step 231)
319.3s 3294 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.75s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.75s/s]
319.3s 3295 
319.3s 3296 Simulation finished at t = 60.0000 s after 231 steps.
319.3s 3297 Total runtime: 2.16 seconds.
319.3s 3298 Running simulation until t = 120.00 s, outputting every 60.00 s
319.3s 3299 
319.4s 3300 [WARNING] Automatic CFL correction applied (count: 19300):
319.4s 3301 Calculated CFL: 0.800 > Limit: 0.500
319.4s 3302 Original dt: 4.115082e-01 s
319.4s 3303 Corrected dt: 2.571926e-01 s
319.4s 3304 Correction factor: 1.6x
319.4s 3305 Max wave speed detected: 19.44 m/s
319.5s 3306 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
320.0s 3307 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
320.3s 3308 [WARNING] Automatic CFL correction applied (count: 19400):
320.3s 3309 Calculated CFL: 0.800 > Limit: 0.500
320.3s 3310 Original dt: 4.114982e-01 s
320.3s 3311 Corrected dt: 2.571864e-01 s
320.3s 3312 Correction factor: 1.6x
320.3s 3313 Max wave speed detected: 19.44 m/s
320.4s 3314 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
320.9s 3315 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
321.2s 3316 [WARNING] Automatic CFL correction applied (count: 19500):
321.2s 3317 Calculated CFL: 0.800 > Limit: 0.500
321.2s 3318 Original dt: 4.114980e-01 s
321.2s 3319 Corrected dt: 2.571863e-01 s
321.2s 3320 Correction factor: 1.6x
321.2s 3321 Max wave speed detected: 19.44 m/s
321.4s 3322 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
321.5s 3323 Stored output at t = 120.0000 s (Step 465)
321.5s 3324 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
321.5s 3325 [A
321.5s 3326 
321.5s 3327 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.11s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.10s/s]
321.5s 3328 Simulation finished at t = 120.0000 s after 465 steps.
321.5s 3329 Total runtime: 2.21 seconds.
321.5s 3330 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
321.5s 3331 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
321.5s 3332 Using device: gpu
321.5s 3333 DEBUG PARAMS: Reading K_m_kmh = 10.0
321.5s 3334 DEBUG PARAMS: Reading K_c_kmh = 15.0
321.5s 3335 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
321.5s 3336 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
321.5s 3337 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
321.5s 3338 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
321.5s 3339 Loading road quality type: uniform
321.5s 3340 Uniform road quality value: 2
321.5s 3341 Road quality loaded.
321.5s 3342 Initial state created.
321.5s 3343 Transferring initial state and road quality to GPU...
321.5s 3344 GPU data transfer complete.
321.5s 3345 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
321.5s 3346 Initial boundary conditions applied.
321.5s 3347 [BC UPDATE] left → phase 0 RED (reduced inflow)
321.5s 3348 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
321.6s 3349 Running simulation until t = 60.00 s, outputting every 60.00 s
321.6s 3350 
322.0s 3351 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
322.2s 3352 [WARNING] Automatic CFL correction applied (count: 19600):
322.2s 3353 Calculated CFL: 0.800 > Limit: 0.500
322.2s 3354 Original dt: 4.225636e-01 s
322.2s 3355 Corrected dt: 2.641023e-01 s
322.2s 3356 Correction factor: 1.6x
322.2s 3357 Max wave speed detected: 18.93 m/s
322.5s 3358 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
323.0s 3359 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
323.1s 3360 [WARNING] Automatic CFL correction applied (count: 19700):
323.1s 3361 Calculated CFL: 0.800 > Limit: 0.500
323.1s 3362 Original dt: 4.116395e-01 s
323.1s 3363 Corrected dt: 2.572747e-01 s
323.1s 3364 Correction factor: 1.6x
323.1s 3365 Max wave speed detected: 19.43 m/s
323.4s 3366 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
323.7s 3367 Stored output at t = 60.0000 s (Step 231)
323.7s 3368 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
323.7s 3369 [A
323.7s 3370 
323.7s 3371 Simulation finished at t = 60.0000 s after 231 steps.
323.7s 3372 Total runtime: 2.19 seconds.
323.7s 3373 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.42s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.41s/s]
323.7s 3374 Running simulation until t = 120.00 s, outputting every 60.00 s
323.7s 3375 
323.9s 3376 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
324.1s 3377 [WARNING] Automatic CFL correction applied (count: 19800):
324.1s 3378 Calculated CFL: 0.800 > Limit: 0.500
324.1s 3379 Original dt: 4.115005e-01 s
324.1s 3380 Corrected dt: 2.571878e-01 s
324.1s 3381 Correction factor: 1.6x
324.1s 3382 Max wave speed detected: 19.44 m/s
324.4s 3383 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
324.9s 3384 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
325.1s 3385 [WARNING] Automatic CFL correction applied (count: 19900):
325.1s 3386 Calculated CFL: 0.800 > Limit: 0.500
325.1s 3387 Original dt: 4.114981e-01 s
325.1s 3388 Corrected dt: 2.571863e-01 s
325.1s 3389 Correction factor: 1.6x
325.1s 3390 Max wave speed detected: 19.44 m/s
325.4s 3391 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
325.8s 3392 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
326.0s 3393 Stored output at t = 120.0000 s (Step 465)
326.0s 3394 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
326.0s 3395 [A
326.0s 3396 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.95s/s]
326.0s 3397 
326.0s 3398 Simulation finished at t = 120.0000 s after 465 steps.
326.0s 3399 Total runtime: 2.23 seconds.
326.0s 3400 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
326.0s 3401 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
326.0s 3402 Using device: gpu
326.0s 3403 DEBUG PARAMS: Reading K_m_kmh = 10.0
326.0s 3404 DEBUG PARAMS: Reading K_c_kmh = 15.0
326.0s 3405 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
326.0s 3406 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
326.0s 3407 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
326.0s 3408 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
326.0s 3409 Loading road quality type: uniform
326.0s 3410 Uniform road quality value: 2
326.0s 3411 Road quality loaded.
326.0s 3412 Initial state created.
326.0s 3413 Transferring initial state and road quality to GPU...
326.0s 3414 GPU data transfer complete.
326.0s 3415 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
326.0s 3416 Initial boundary conditions applied.
326.0s 3417 [BC UPDATE] left → phase 0 RED (reduced inflow)
326.0s 3418 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
326.0s 3419 [BC UPDATE] left → phase 1 GREEN (normal inflow)
326.0s 3420 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
326.0s 3421 Running simulation until t = 60.00 s, outputting every 60.00 s
326.0s 3422 
326.0s 3423 [WARNING] Automatic CFL correction applied (count: 20000):
326.0s 3424 Calculated CFL: 0.800 > Limit: 0.500
326.0s 3425 Original dt: 3.451280e-01 s
326.0s 3426 Corrected dt: 2.157050e-01 s
326.0s 3427 Correction factor: 1.6x
326.0s 3428 Max wave speed detected: 23.18 m/s
326.5s 3429 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
326.9s 3430 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
327.0s 3431 [WARNING] Automatic CFL correction applied (count: 20100):
327.0s 3432 Calculated CFL: 0.800 > Limit: 0.500
327.0s 3433 Original dt: 4.139892e-01 s
327.0s 3434 Corrected dt: 2.587433e-01 s
327.0s 3435 Correction factor: 1.6x
327.0s 3436 Max wave speed detected: 19.32 m/s
327.4s 3437 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
327.9s 3438 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
327.9s 3439 [WARNING] Automatic CFL correction applied (count: 20200):
327.9s 3440 Calculated CFL: 0.800 > Limit: 0.500
327.9s 3441 Original dt: 4.115314e-01 s
327.9s 3442 Corrected dt: 2.572071e-01 s
327.9s 3443 Correction factor: 1.6x
327.9s 3444 Max wave speed detected: 19.44 m/s
328.1s 3445 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
328.1s 3446 [A
328.1s 3447 Stored output at t = 60.0000 s (Step 231)
328.1s 3448 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.82s/s]
328.1s 3449 
328.1s 3450 Simulation finished at t = 60.0000 s after 231 steps.
328.1s 3451 Total runtime: 2.16 seconds.
328.2s 3452 [BC UPDATE] left → phase 0 RED (reduced inflow)
328.2s 3453 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
328.2s 3454 Running simulation until t = 120.00 s, outputting every 60.00 s
328.2s 3455 
328.3s 3456 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
328.8s 3457 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
328.8s 3458 [WARNING] Automatic CFL correction applied (count: 20300):
328.8s 3459 Calculated CFL: 0.800 > Limit: 0.500
328.8s 3460 Original dt: 4.114986e-01 s
328.8s 3461 Corrected dt: 2.571866e-01 s
328.8s 3462 Correction factor: 1.6x
328.8s 3463 Max wave speed detected: 19.44 m/s
329.3s 3464 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
329.7s 3465 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
329.8s 3466 [WARNING] Automatic CFL correction applied (count: 20400):
329.8s 3467 Calculated CFL: 0.800 > Limit: 0.500
329.8s 3468 Original dt: 4.114980e-01 s
329.8s 3469 Corrected dt: 2.571863e-01 s
329.8s 3470 Correction factor: 1.6x
329.8s 3471 Max wave speed detected: 19.44 m/s
330.2s 3472 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
330.4s 3473 Stored output at t = 120.0000 s (Step 465)
330.4s 3474 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
330.4s 3475 [A
330.4s 3476 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.26s/s]
330.4s 3477 
330.4s 3478 Simulation finished at t = 120.0000 s after 465 steps.
330.4s 3479 Total runtime: 2.20 seconds.
330.4s 3480 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
330.4s 3481 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
330.4s 3482 Using device: gpu
330.4s 3483 DEBUG PARAMS: Reading K_m_kmh = 10.0
330.4s 3484 DEBUG PARAMS: Reading K_c_kmh = 15.0
330.4s 3485 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
330.4s 3486 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
330.4s 3487 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
330.4s 3488 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
330.4s 3489 Loading road quality type: uniform
330.4s 3490 Uniform road quality value: 2
330.4s 3491 Road quality loaded.
330.4s 3492 Initial state created.
330.4s 3493 Transferring initial state and road quality to GPU...
330.4s 3494 GPU data transfer complete.
330.4s 3495 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
330.4s 3496 Initial boundary conditions applied.
330.4s 3497 [BC UPDATE] left → phase 0 RED (reduced inflow)
330.4s 3498 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
330.4s 3499 Running simulation until t = 60.00 s, outputting every 60.00 s
330.4s 3500 
330.7s 3501 [WARNING] Automatic CFL correction applied (count: 20500):
330.7s 3502 Calculated CFL: 0.800 > Limit: 0.500
330.7s 3503 Original dt: 4.583403e-01 s
330.7s 3504 Corrected dt: 2.864627e-01 s
330.7s 3505 Correction factor: 1.6x
330.7s 3506 Max wave speed detected: 17.45 m/s
330.9s 3507 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
331.3s 3508 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
331.7s 3509 [WARNING] Automatic CFL correction applied (count: 20600):
331.7s 3510 Calculated CFL: 0.800 > Limit: 0.500
331.7s 3511 Original dt: 4.120137e-01 s
331.7s 3512 Corrected dt: 2.575085e-01 s
331.7s 3513 Correction factor: 1.6x
331.7s 3514 Max wave speed detected: 19.42 m/s
331.8s 3515 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
332.3s 3516 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
332.6s 3517 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
332.6s 3518 [A
332.6s 3519 Stored output at t = 60.0000 s (Step 231)
332.6s 3520 
332.6s 3521 Simulation finished at t = 60.0000 s after 231 steps.
332.6s 3522 Total runtime: 2.19 seconds.
332.6s 3523 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.41s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.41s/s]
332.6s 3524 Running simulation until t = 120.00 s, outputting every 60.00 s
332.6s 3525 
332.6s 3526 [WARNING] Automatic CFL correction applied (count: 20700):
332.6s 3527 Calculated CFL: 0.800 > Limit: 0.500
332.6s 3528 Original dt: 4.115064e-01 s
332.6s 3529 Corrected dt: 2.571915e-01 s
332.6s 3530 Correction factor: 1.6x
332.6s 3531 Max wave speed detected: 19.44 m/s
332.7s 3532 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
333.2s 3533 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
333.6s 3534 [WARNING] Automatic CFL correction applied (count: 20800):
333.6s 3535 Calculated CFL: 0.800 > Limit: 0.500
333.6s 3536 Original dt: 4.114982e-01 s
333.6s 3537 Corrected dt: 2.571864e-01 s
333.6s 3538 Correction factor: 1.6x
333.6s 3539 Max wave speed detected: 19.44 m/s
333.7s 3540 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
334.2s 3541 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
334.5s 3542 [WARNING] Automatic CFL correction applied (count: 20900):
334.5s 3543 Calculated CFL: 0.800 > Limit: 0.500
334.5s 3544 Original dt: 4.114980e-01 s
334.5s 3545 Corrected dt: 2.571863e-01 s
334.5s 3546 Correction factor: 1.6x
334.5s 3547 Max wave speed detected: 19.44 m/s
334.6s 3548 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
334.8s 3549 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
334.8s 3550 [A
334.8s 3551 Stored output at t = 120.0000 s (Step 465)
334.8s 3552 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.12s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.12s/s]
334.8s 3553 
334.8s 3554 Simulation finished at t = 120.0000 s after 465 steps.
334.8s 3555 Total runtime: 2.21 seconds.
334.8s 3556 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
334.8s 3557 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.8s 3558 Using device: gpu
334.8s 3559 DEBUG PARAMS: Reading K_m_kmh = 10.0
334.8s 3560 DEBUG PARAMS: Reading K_c_kmh = 15.0
334.8s 3561 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
334.8s 3562 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
334.8s 3563 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
334.8s 3564 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
334.8s 3565 Loading road quality type: uniform
334.8s 3566 Uniform road quality value: 2
334.8s 3567 Road quality loaded.
334.8s 3568 Initial state created.
334.8s 3569 Transferring initial state and road quality to GPU...
334.8s 3570 GPU data transfer complete.
334.8s 3571 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
334.8s 3572 Initial boundary conditions applied.
334.8s 3573 [BC UPDATE] left → phase 0 RED (reduced inflow)
334.8s 3574 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
334.8s 3575 [BC UPDATE] left → phase 1 GREEN (normal inflow)
334.8s 3576 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
334.8s 3577 Running simulation until t = 60.00 s, outputting every 60.00 s
334.8s 3578 
335.3s 3579 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
335.5s 3580 [WARNING] Automatic CFL correction applied (count: 21000):
335.5s 3581 Calculated CFL: 0.800 > Limit: 0.500
335.5s 3582 Original dt: 4.205139e-01 s
335.5s 3583 Corrected dt: 2.628212e-01 s
335.5s 3584 Correction factor: 1.6x
335.5s 3585 Max wave speed detected: 19.02 m/s
335.7s 3586 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
336.2s 3587 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
336.4s 3588 [WARNING] Automatic CFL correction applied (count: 21100):
336.4s 3589 Calculated CFL: 0.800 > Limit: 0.500
336.4s 3590 Original dt: 4.116141e-01 s
336.4s 3591 Corrected dt: 2.572588e-01 s
336.4s 3592 Correction factor: 1.6x
336.4s 3593 Max wave speed detected: 19.44 m/s
336.7s 3594 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
337.0s 3595 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
337.0s 3596 [A
337.0s 3597 Stored output at t = 60.0000 s (Step 231)
337.0s 3598 
337.0s 3599 Simulation finished at t = 60.0000 s after 231 steps.
337.0s 3600 Total runtime: 2.17 seconds.
337.0s 3601 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s]
337.0s 3602 Running simulation until t = 120.00 s, outputting every 60.00 s
337.0s 3603 
337.1s 3604 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
337.4s 3605 [WARNING] Automatic CFL correction applied (count: 21200):
337.4s 3606 Calculated CFL: 0.800 > Limit: 0.500
337.4s 3607 Original dt: 4.115000e-01 s
337.4s 3608 Corrected dt: 2.571875e-01 s
337.4s 3609 Correction factor: 1.6x
337.4s 3610 Max wave speed detected: 19.44 m/s
337.6s 3611 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
338.1s 3612 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
338.3s 3613 [WARNING] Automatic CFL correction applied (count: 21300):
338.3s 3614 Calculated CFL: 0.800 > Limit: 0.500
338.3s 3615 Original dt: 4.114981e-01 s
338.3s 3616 Corrected dt: 2.571863e-01 s
338.3s 3617 Correction factor: 1.6x
338.3s 3618 Max wave speed detected: 19.44 m/s
338.5s 3619 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
339.0s 3620 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
339.2s 3621 Stored output at t = 120.0000 s (Step 465)
339.2s 3622 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
339.2s 3623 [A
339.2s 3624 
339.2s 3625 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.29s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.29s/s]
339.2s 3626 Simulation finished at t = 120.0000 s after 465 steps.
339.2s 3627 Total runtime: 2.20 seconds.
339.2s 3628 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
339.2s 3629 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
339.2s 3630 Using device: gpu
339.2s 3631 DEBUG PARAMS: Reading K_m_kmh = 10.0
339.2s 3632 DEBUG PARAMS: Reading K_c_kmh = 15.0
339.2s 3633 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
339.2s 3634 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
339.2s 3635 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
339.2s 3636 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
339.2s 3637 Loading road quality type: uniform
339.2s 3638 Uniform road quality value: 2
339.2s 3639 Road quality loaded.
339.2s 3640 Initial state created.
339.2s 3641 Transferring initial state and road quality to GPU...
339.2s 3642 GPU data transfer complete.
339.2s 3643 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
339.2s 3644 Initial boundary conditions applied.
339.2s 3645 [BC UPDATE] left → phase 0 RED (reduced inflow)
339.2s 3646 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
339.2s 3647 Running simulation until t = 60.00 s, outputting every 60.00 s
339.2s 3648 
339.3s 3649 [WARNING] Automatic CFL correction applied (count: 21400):
339.3s 3650 Calculated CFL: 0.800 > Limit: 0.500
339.3s 3651 Original dt: 3.737254e-01 s
339.3s 3652 Corrected dt: 2.335784e-01 s
339.3s 3653 Correction factor: 1.6x
339.3s 3654 Max wave speed detected: 21.41 m/s
339.6s 3655 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
340.1s 3656 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
340.2s 3657 [WARNING] Automatic CFL correction applied (count: 21500):
340.2s 3658 Calculated CFL: 0.800 > Limit: 0.500
340.2s 3659 Original dt: 4.134305e-01 s
340.2s 3660 Corrected dt: 2.583941e-01 s
340.2s 3661 Correction factor: 1.6x
340.2s 3662 Max wave speed detected: 19.35 m/s
340.6s 3663 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
341.0s 3664 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
341.1s 3665 [WARNING] Automatic CFL correction applied (count: 21600):
341.1s 3666 Calculated CFL: 0.800 > Limit: 0.500
341.1s 3667 Original dt: 4.115259e-01 s
341.1s 3668 Corrected dt: 2.572037e-01 s
341.1s 3669 Correction factor: 1.6x
341.1s 3670 Max wave speed detected: 19.44 m/s
341.3s 3671 Stored output at t = 60.0000 s (Step 231)
341.3s 3672 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
341.3s 3673 [A
341.3s 3674 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.82s/s]
341.3s 3675 
341.3s 3676 Simulation finished at t = 60.0000 s after 231 steps.
341.3s 3677 Total runtime: 2.16 seconds.
341.3s 3678 [BC UPDATE] left → phase 1 GREEN (normal inflow)
341.3s 3679 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
341.3s 3680 Running simulation until t = 120.00 s, outputting every 60.00 s
341.3s 3681 
341.5s 3682 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
342.0s 3683 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
342.1s 3684 [WARNING] Automatic CFL correction applied (count: 21700):
342.1s 3685 Calculated CFL: 0.800 > Limit: 0.500
342.1s 3686 Original dt: 4.114985e-01 s
342.1s 3687 Corrected dt: 2.571866e-01 s
342.1s 3688 Correction factor: 1.6x
342.1s 3689 Max wave speed detected: 19.44 m/s
342.4s 3690 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
342.9s 3691 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
343.0s 3692 [WARNING] Automatic CFL correction applied (count: 21800):
343.0s 3693 Calculated CFL: 0.800 > Limit: 0.500
343.0s 3694 Original dt: 4.114980e-01 s
343.0s 3695 Corrected dt: 2.571863e-01 s
343.0s 3696 Correction factor: 1.6x
343.0s 3697 Max wave speed detected: 19.44 m/s
343.4s 3698 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
343.5s 3699 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
343.5s 3700 [A
343.5s 3701 Stored output at t = 120.0000 s (Step 465)
343.5s 3702 
343.5s 3703 Simulation finished at t = 120.0000 s after 465 steps.
343.5s 3704 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s]
343.5s 3705 Total runtime: 2.16 seconds.
343.5s 3706 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
343.5s 3707 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
343.5s 3708 Using device: gpu
343.5s 3709 DEBUG PARAMS: Reading K_m_kmh = 10.0
343.5s 3710 DEBUG PARAMS: Reading K_c_kmh = 15.0
343.5s 3711 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
343.5s 3712 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
343.5s 3713 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
343.5s 3714 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
343.5s 3715 Loading road quality type: uniform
343.5s 3716 Uniform road quality value: 2
343.5s 3717 Road quality loaded.
343.5s 3718 Initial state created.
343.5s 3719 Transferring initial state and road quality to GPU...
343.5s 3720 GPU data transfer complete.
343.5s 3721 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
343.5s 3722 Initial boundary conditions applied.
343.5s 3723 [BC UPDATE] left → phase 0 RED (reduced inflow)
343.5s 3724 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
343.5s 3725 [BC UPDATE] left → phase 1 GREEN (normal inflow)
343.5s 3726 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
343.5s 3727 Running simulation until t = 60.00 s, outputting every 60.00 s
343.5s 3728 
343.9s 3729 [WARNING] Automatic CFL correction applied (count: 21900):
343.9s 3730 Calculated CFL: 0.800 > Limit: 0.500
343.9s 3731 Original dt: 4.470525e-01 s
343.9s 3732 Corrected dt: 2.794078e-01 s
343.9s 3733 Correction factor: 1.6x
343.9s 3734 Max wave speed detected: 17.89 m/s
344.0s 3735 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
344.5s 3736 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
344.9s 3737 [WARNING] Automatic CFL correction applied (count: 22000):
344.9s 3738 Calculated CFL: 0.800 > Limit: 0.500
344.9s 3739 Original dt: 4.119130e-01 s
344.9s 3740 Corrected dt: 2.574456e-01 s
344.9s 3741 Correction factor: 1.6x
344.9s 3742 Max wave speed detected: 19.42 m/s
344.9s 3743 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
345.4s 3744 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
345.7s 3745 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
345.7s 3746 [A
345.7s 3747 Stored output at t = 60.0000 s (Step 231)
345.7s 3748 
345.7s 3749 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s]
345.7s 3750 Simulation finished at t = 60.0000 s after 231 steps.
345.7s 3751 Total runtime: 2.17 seconds.
345.7s 3752 [BC UPDATE] left → phase 0 RED (reduced inflow)
345.7s 3753 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
345.7s 3754 Running simulation until t = 120.00 s, outputting every 60.00 s
345.7s 3755 
345.8s 3756 [WARNING] Automatic CFL correction applied (count: 22100):
345.8s 3757 Calculated CFL: 0.800 > Limit: 0.500
345.8s 3758 Original dt: 4.115046e-01 s
345.8s 3759 Corrected dt: 2.571904e-01 s
345.8s 3760 Correction factor: 1.6x
345.8s 3761 Max wave speed detected: 19.44 m/s
345.9s 3762 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
346.3s 3763 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
346.8s 3764 [WARNING] Automatic CFL correction applied (count: 22200):
346.8s 3765 Calculated CFL: 0.800 > Limit: 0.500
346.8s 3766 Original dt: 4.114982e-01 s
346.8s 3767 Corrected dt: 2.571863e-01 s
346.8s 3768 Correction factor: 1.6x
346.8s 3769 Max wave speed detected: 19.44 m/s
346.8s 3770 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
347.3s 3771 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
347.7s 3772 [WARNING] Automatic CFL correction applied (count: 22300):
347.7s 3773 Calculated CFL: 0.800 > Limit: 0.500
347.7s 3774 Original dt: 4.114980e-01 s
347.7s 3775 Corrected dt: 2.571863e-01 s
347.7s 3776 Correction factor: 1.6x
347.7s 3777 Max wave speed detected: 19.44 m/s
347.7s 3778 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
347.9s 3779 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
347.9s 3780 Stored output at t = 120.0000 s (Step 465)
347.9s 3781 [A
347.9s 3782 
347.9s 3783 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.32s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.32s/s]
347.9s 3784 Simulation finished at t = 120.0000 s after 465 steps.
347.9s 3785 Total runtime: 2.20 seconds.
347.9s 3786 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
347.9s 3787 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
347.9s 3788 Using device: gpu
347.9s 3789 DEBUG PARAMS: Reading K_m_kmh = 10.0
347.9s 3790 DEBUG PARAMS: Reading K_c_kmh = 15.0
347.9s 3791 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
347.9s 3792 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
347.9s 3793 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
347.9s 3794 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
347.9s 3795 Loading road quality type: uniform
347.9s 3796 Uniform road quality value: 2
347.9s 3797 Road quality loaded.
347.9s 3798 Initial state created.
347.9s 3799 Transferring initial state and road quality to GPU...
347.9s 3800 GPU data transfer complete.
347.9s 3801 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
347.9s 3802 Initial boundary conditions applied.
347.9s 3803 [BC UPDATE] left → phase 0 RED (reduced inflow)
347.9s 3804 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
347.9s 3805 Running simulation until t = 60.00 s, outputting every 60.00 s
347.9s 3806 
348.4s 3807 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
348.6s 3808 [WARNING] Automatic CFL correction applied (count: 22400):
348.6s 3809 Calculated CFL: 0.800 > Limit: 0.500
348.6s 3810 Original dt: 4.190346e-01 s
348.6s 3811 Corrected dt: 2.618967e-01 s
348.6s 3812 Correction factor: 1.6x
348.6s 3813 Max wave speed detected: 19.09 m/s
348.8s 3814 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
349.3s 3815 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
349.6s 3816 [WARNING] Automatic CFL correction applied (count: 22500):
349.6s 3817 Calculated CFL: 0.800 > Limit: 0.500
349.6s 3818 Original dt: 4.115954e-01 s
349.6s 3819 Corrected dt: 2.572472e-01 s
349.6s 3820 Correction factor: 1.6x
349.6s 3821 Max wave speed detected: 19.44 m/s
349.8s 3822 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
350.1s 3823 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
350.1s 3824 [A
350.1s 3825 Stored output at t = 60.0000 s (Step 231)
350.1s 3826 
350.1s 3827 Simulation finished at t = 60.0000 s after 231 steps.
350.1s 3828 Total runtime: 2.17 seconds.
350.1s 3829 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.60s/s]
350.1s 3830 Running simulation until t = 120.00 s, outputting every 60.00 s
350.1s 3831 
350.3s 3832 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
350.5s 3833 [WARNING] Automatic CFL correction applied (count: 22600):
350.5s 3834 Calculated CFL: 0.800 > Limit: 0.500
350.5s 3835 Original dt: 4.114996e-01 s
350.5s 3836 Corrected dt: 2.571873e-01 s
350.5s 3837 Correction factor: 1.6x
350.5s 3838 Max wave speed detected: 19.44 m/s
350.7s 3839 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
351.2s 3840 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
351.5s 3841 [WARNING] Automatic CFL correction applied (count: 22700):
351.5s 3842 Calculated CFL: 0.800 > Limit: 0.500
351.5s 3843 Original dt: 4.114981e-01 s
351.5s 3844 Corrected dt: 2.571863e-01 s
351.5s 3845 Correction factor: 1.6x
351.5s 3846 Max wave speed detected: 19.44 m/s
351.7s 3847 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
352.2s 3848 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
352.3s 3849 Stored output at t = 120.0000 s (Step 465)
352.3s 3850 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
352.3s 3851 [A
352.3s 3852 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.73s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.73s/s]
352.3s 3853 
352.3s 3854 Simulation finished at t = 120.0000 s after 465 steps.
352.3s 3855 Total runtime: 2.25 seconds.
352.3s 3856 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
352.3s 3857 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
352.3s 3858 Using device: gpu
352.3s 3859 DEBUG PARAMS: Reading K_m_kmh = 10.0
352.3s 3860 DEBUG PARAMS: Reading K_c_kmh = 15.0
352.3s 3861 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
352.3s 3862 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
352.3s 3863 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
352.3s 3864 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
352.3s 3865 Loading road quality type: uniform
352.3s 3866 Uniform road quality value: 2
352.3s 3867 Road quality loaded.
352.3s 3868 Initial state created.
352.3s 3869 Transferring initial state and road quality to GPU...
352.3s 3870 GPU data transfer complete.
352.3s 3871 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
352.3s 3872 Initial boundary conditions applied.
352.3s 3873 [BC UPDATE] left → phase 0 RED (reduced inflow)
352.3s 3874 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
352.3s 3875 [BC UPDATE] left → phase 1 GREEN (normal inflow)
352.3s 3876 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
352.3s 3877 Running simulation until t = 60.00 s, outputting every 60.00 s
352.3s 3878 
352.5s 3879 [WARNING] Automatic CFL correction applied (count: 22800):
352.5s 3880 Calculated CFL: 0.800 > Limit: 0.500
352.5s 3881 Original dt: 4.022422e-01 s
352.5s 3882 Corrected dt: 2.514014e-01 s
352.5s 3883 Correction factor: 1.6x
352.5s 3884 Max wave speed detected: 19.89 m/s
352.8s 3885 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
353.3s 3886 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
353.4s 3887 [WARNING] Automatic CFL correction applied (count: 22900):
353.4s 3888 Calculated CFL: 0.800 > Limit: 0.500
353.4s 3889 Original dt: 4.130229e-01 s
353.4s 3890 Corrected dt: 2.581393e-01 s
353.4s 3891 Correction factor: 1.6x
353.4s 3892 Max wave speed detected: 19.37 m/s
353.8s 3893 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
354.3s 3894 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
354.4s 3895 [WARNING] Automatic CFL correction applied (count: 23000):
354.4s 3896 Calculated CFL: 0.800 > Limit: 0.500
354.4s 3897 Original dt: 4.115198e-01 s
354.4s 3898 Corrected dt: 2.571999e-01 s
354.4s 3899 Correction factor: 1.6x
354.4s 3900 Max wave speed detected: 19.44 m/s
354.6s 3901 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
354.6s 3902 Stored output at t = 60.0000 s (Step 231)
354.6s 3903 [A
354.6s 3904 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.87s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.87s/s]
354.6s 3905 
354.6s 3906 Simulation finished at t = 60.0000 s after 231 steps.
354.6s 3907 Total runtime: 2.23 seconds.
354.6s 3908 Running simulation until t = 120.00 s, outputting every 60.00 s
354.6s 3909 
354.8s 3910 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
355.2s 3911 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
355.4s 3912 [WARNING] Automatic CFL correction applied (count: 23100):
355.4s 3913 Calculated CFL: 0.800 > Limit: 0.500
355.4s 3914 Original dt: 4.114984e-01 s
355.4s 3915 Corrected dt: 2.571865e-01 s
355.4s 3916 Correction factor: 1.6x
355.4s 3917 Max wave speed detected: 19.44 m/s
355.7s 3918 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
356.2s 3919 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
356.3s 3920 [WARNING] Automatic CFL correction applied (count: 23200):
356.3s 3921 Calculated CFL: 0.800 > Limit: 0.500
356.3s 3922 Original dt: 4.114980e-01 s
356.3s 3923 Corrected dt: 2.571863e-01 s
356.3s 3924 Correction factor: 1.6x
356.3s 3925 Max wave speed detected: 19.44 m/s
356.7s 3926 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
356.8s 3927 Stored output at t = 120.0000 s (Step 465)
356.8s 3928 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
356.8s 3929 [A
356.8s 3930 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.88s/s]
356.8s 3931 
356.8s 3932 Simulation finished at t = 120.0000 s after 465 steps.
356.8s 3933 Total runtime: 2.23 seconds.
356.8s 3934 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
356.8s 3935 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
356.8s 3936 Using device: gpu
356.8s 3937 DEBUG PARAMS: Reading K_m_kmh = 10.0
356.8s 3938 DEBUG PARAMS: Reading K_c_kmh = 15.0
356.8s 3939 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
356.8s 3940 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
356.8s 3941 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
356.8s 3942 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
356.8s 3943 Loading road quality type: uniform
356.8s 3944 Uniform road quality value: 2
356.8s 3945 Road quality loaded.
356.8s 3946 Initial state created.
356.8s 3947 Transferring initial state and road quality to GPU...
356.8s 3948 GPU data transfer complete.
356.8s 3949 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
356.8s 3950 Initial boundary conditions applied.
356.8s 3951 [BC UPDATE] left → phase 0 RED (reduced inflow)
356.8s 3952 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
356.8s 3953 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.4 steps/s
356.8s 3954 ---------------------------------
356.8s 3955 | rollout/           |          |
356.8s 3956 |    ep_len_mean     | 2        |
356.8s 3957 |    ep_rew_mean     | -0.0596  |
356.8s 3958 | time/              |          |
356.8s 3959 |    fps             | 0        |
356.8s 3960 |    iterations      | 1        |
356.8s 3961 |    time_elapsed    | 224      |
356.8s 3962 |    total_timesteps | 100      |
356.8s 3963 ---------------------------------
357.4s 3964 
357.4s 3965 ✅ Training completed in 3.8 minutes (225.5s)
357.4s 3966 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:44 < 0:00:00 , 0 it/s ]
357.4s 3967 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
357.4s 3968 
357.4s 3969 [PHASE 2/2] Running performance comparisons...
357.4s 3970 [QUICK TEST] Testing only: traffic_light_control
357.4s 3971 
357.4s 3972 Testing scenario: traffic_light_control (device=gpu)
357.4s 3973 2025-10-10 13:23:17 - INFO - run_performance_comparison:700 - ================================================================================
357.4s 3974 2025-10-10 13:23:17 - INFO - run_performance_comparison:701 - Starting run_performance_comparison for scenario: traffic_light_control
357.4s 3975 2025-10-10 13:23:17 - INFO - run_performance_comparison:702 - Device: gpu
357.4s 3976 2025-10-10 13:23:17 - INFO - run_performance_comparison:703 - ================================================================================
357.4s 3977 2025-10-10 13:23:17 - INFO - run_performance_comparison:704 - ================================================================================
357.4s 3978 2025-10-10 13:23:17 - INFO - run_performance_comparison:705 - Starting run_performance_comparison for scenario: traffic_light_control
357.4s 3979 2025-10-10 13:23:17 - INFO - run_performance_comparison:706 - Device: gpu
357.4s 3980 2025-10-10 13:23:17 - INFO - run_performance_comparison:707 - ================================================================================
357.4s 3981 2025-10-10 13:23:17 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
357.4s 3982 2025-10-10 13:23:17 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
357.4s 3983 2025-10-10 13:23:17 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
357.4s 3984 2025-10-10 13:23:17 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
357.4s 3985 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
357.4s 3986 Running baseline controller...
357.4s 3987 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
357.4s 3988 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
357.4s 3989 2025-10-10 13:23:17 - INFO - run_control_simulation:286 - ================================================================================
357.4s 3990 2025-10-10 13:23:17 - INFO - run_control_simulation:287 - Starting run_control_simulation:
357.4s 3991 2025-10-10 13:23:17 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
357.4s 3992 2025-10-10 13:23:17 - INFO - run_control_simulation:289 -   - duration: 600.0s
357.4s 3993 2025-10-10 13:23:17 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
357.4s 3994 2025-10-10 13:23:17 - INFO - run_control_simulation:291 -   - device: gpu
357.4s 3995 2025-10-10 13:23:17 - INFO - run_control_simulation:292 -   - controller: BaselineController
357.4s 3996 2025-10-10 13:23:17 - INFO - run_control_simulation:293 -   - max_control_steps: 11
357.4s 3997 2025-10-10 13:23:17 - INFO - run_control_simulation:294 - ================================================================================
357.4s 3998 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
357.4s 3999 2025-10-10 13:23:17 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
357.4s 4000 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
357.4s 4001 Using device: gpu
357.4s 4002 DEBUG PARAMS: Reading K_m_kmh = 10.0
357.4s 4003 DEBUG PARAMS: Reading K_c_kmh = 15.0
357.4s 4004 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
357.4s 4005 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
357.4s 4006 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
357.4s 4007 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
357.4s 4008 Loading road quality type: uniform
357.4s 4009 Uniform road quality value: 2
357.4s 4010 Road quality loaded.
357.4s 4011 Initial state created.
357.4s 4012 Transferring initial state and road quality to GPU...
357.4s 4013 GPU data transfer complete.
357.4s 4014 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
357.4s 4015 Initial boundary conditions applied.
357.4s 4016 TrafficSignalEnvDirect initialized:
357.4s 4017 Decision interval: 60.0s
357.4s 4018 Observation segments: 6
357.4s 4019 Observation space: (26,)
357.4s 4020 Action space: 2
357.4s 4021 Device: gpu
357.4s 4022 2025-10-10 13:23:17 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
357.4s 4023 2025-10-10 13:23:17 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
357.4s 4024 [INFO] Calling env.reset()...
357.4s 4025 2025-10-10 13:23:17 - INFO - run_control_simulation:331 - Calling env.reset()...
357.4s 4026 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
357.4s 4027 Using device: gpu
357.5s 4028 DEBUG PARAMS: Reading K_m_kmh = 10.0
357.5s 4029 DEBUG PARAMS: Reading K_c_kmh = 15.0
357.5s 4030 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
357.5s 4031 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
357.5s 4032 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
357.5s 4033 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
357.5s 4034 Loading road quality type: uniform
357.5s 4035 Uniform road quality value: 2
357.5s 4036 Road quality loaded.
357.5s 4037 Initial state created.
357.5s 4038 Transferring initial state and road quality to GPU...
357.5s 4039 GPU data transfer complete.
357.5s 4040 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
357.5s 4041 Initial boundary conditions applied.
357.5s 4042 [BC UPDATE] left → phase 0 RED (reduced inflow)
357.5s 4043 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
357.5s 4044 2025-10-10 13:23:17 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
357.5s 4045 2025-10-10 13:23:17 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
357.5s 4046 2025-10-10 13:23:17 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
357.5s 4047 [INFO] Starting simulation loop (max 11 control steps)
357.5s 4048 2025-10-10 13:23:17 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
357.5s 4049 2025-10-10 13:23:17 - INFO - run_control_simulation:368 - ================================================================================
357.5s 4050 2025-10-10 13:23:17 - INFO - run_control_simulation:369 - STEP 0 START:
357.5s 4051 2025-10-10 13:23:17 - INFO - run_control_simulation:370 -   Controller: BaselineController
357.5s 4052 2025-10-10 13:23:17 - INFO - run_control_simulation:371 -   Action: 1.000000
357.5s 4053 2025-10-10 13:23:17 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
357.5s 4054 [BC UPDATE] left → phase 1 GREEN (normal inflow)
357.5s 4055 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
357.5s 4056 Running simulation until t = 60.00 s, outputting every 60.00 s
357.9s 4057 [WARNING] Automatic CFL correction applied (count: 23300):
357.9s 4058 Calculated CFL: 0.800 > Limit: 0.500
357.9s 4059 Original dt: 4.396418e-01 s
357.9s 4060 Corrected dt: 2.747761e-01 s
357.9s 4061 Correction factor: 1.6x
357.9s 4062 Max wave speed detected: 18.20 m/s
357.9s 4063 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
358.4s 4064 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
358.9s 4065 [WARNING] Automatic CFL correction applied (count: 23400):
358.9s 4066 Calculated CFL: 0.800 > Limit: 0.500
358.9s 4067 Original dt: 4.118393e-01 s
358.9s 4068 Corrected dt: 2.573996e-01 s
358.9s 4069 Correction factor: 1.6x
358.9s 4070 Max wave speed detected: 19.43 m/s
358.9s 4071 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
359.4s 4072 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
359.7s 4073 Stored output at t = 60.0000 s (Step 231)
359.7s 4074 
359.7s 4075 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.82s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.82s/s]
359.7s 4076 Simulation finished at t = 60.0000 s after 231 steps.
359.7s 4077 Total runtime: 2.24 seconds.
359.7s 4078 2025-10-10 13:23:19 - INFO - run_control_simulation:384 -   Reward: -0.084799
359.7s 4079 2025-10-10 13:23:19 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
359.7s 4080 2025-10-10 13:23:19 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
359.7s 4081 2025-10-10 13:23:19 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
359.7s 4082 2025-10-10 13:23:19 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
359.7s 4083 2025-10-10 13:23:19 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
359.7s 4084 2025-10-10 13:23:19 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.406686, w_c=11.325496
359.7s 4085 2025-10-10 13:23:19 - INFO - run_control_simulation:418 -   State hash: -1603931181899818387
359.7s 4086 2025-10-10 13:23:19 - INFO - run_control_simulation:420 - ================================================================================
359.7s 4087 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
359.7s 4088 2025-10-10 13:23:19 - INFO - run_control_simulation:368 - ================================================================================
359.7s 4089 2025-10-10 13:23:19 - INFO - run_control_simulation:369 - STEP 1 START:
359.7s 4090 2025-10-10 13:23:19 - INFO - run_control_simulation:370 -   Controller: BaselineController
359.7s 4091 2025-10-10 13:23:19 - INFO - run_control_simulation:371 -   Action: 0.000000
359.7s 4092 2025-10-10 13:23:19 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
359.7s 4093 Running simulation until t = 120.00 s, outputting every 60.00 s
359.9s 4094 [WARNING] Automatic CFL correction applied (count: 23500):
359.9s 4095 Calculated CFL: 0.800 > Limit: 0.500
359.9s 4096 Original dt: 4.115033e-01 s
359.9s 4097 Corrected dt: 2.571896e-01 s
359.9s 4098 Correction factor: 1.6x
359.9s 4099 Max wave speed detected: 19.44 m/s
359.9s 4100 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
360.4s 4101 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
360.9s 4102 [WARNING] Automatic CFL correction applied (count: 23600):
360.9s 4103 Calculated CFL: 0.800 > Limit: 0.500
360.9s 4104 Original dt: 4.114981e-01 s
360.9s 4105 Corrected dt: 2.571863e-01 s
360.9s 4106 Correction factor: 1.6x
360.9s 4107 Max wave speed detected: 19.44 m/s
360.9s 4108 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
361.4s 4109 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
361.8s 4110 [WARNING] Automatic CFL correction applied (count: 23700):
361.8s 4111 Calculated CFL: 0.800 > Limit: 0.500
361.8s 4112 Original dt: 4.114980e-01 s
361.8s 4113 Corrected dt: 2.571863e-01 s
361.8s 4114 Correction factor: 1.6x
361.8s 4115 Max wave speed detected: 19.44 m/s
361.8s 4116 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
362.0s 4117 Stored output at t = 120.0000 s (Step 465)
362.0s 4118 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.35s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.34s/s]
362.0s 4119 
362.0s 4120 Simulation finished at t = 120.0000 s after 465 steps.
362.0s 4121 Total runtime: 2.28 seconds.
362.0s 4122 2025-10-10 13:23:22 - INFO - run_control_simulation:384 -   Reward: 0.015200
362.0s 4123 2025-10-10 13:23:22 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
362.0s 4124 2025-10-10 13:23:22 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
362.0s 4125 2025-10-10 13:23:22 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
362.0s 4126 2025-10-10 13:23:22 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
362.0s 4127 2025-10-10 13:23:22 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
362.0s 4128 2025-10-10 13:23:22 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.918019, w_c=14.101648
362.0s 4129 2025-10-10 13:23:22 - INFO - run_control_simulation:418 -   State hash: -6248085352882979206
362.0s 4130 2025-10-10 13:23:22 - INFO - run_control_simulation:420 - ================================================================================
362.0s 4131 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
362.0s 4132 2025-10-10 13:23:22 - INFO - run_control_simulation:368 - ================================================================================
362.0s 4133 2025-10-10 13:23:22 - INFO - run_control_simulation:369 - STEP 2 START:
362.0s 4134 2025-10-10 13:23:22 - INFO - run_control_simulation:370 -   Controller: BaselineController
362.0s 4135 2025-10-10 13:23:22 - INFO - run_control_simulation:371 -   Action: 1.000000
362.0s 4136 2025-10-10 13:23:22 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
362.0s 4137 [BC UPDATE] left → phase 0 RED (reduced inflow)
362.0s 4138 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
362.0s 4139 Running simulation until t = 180.00 s, outputting every 60.00 s
362.3s 4140 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
362.8s 4141 [WARNING] Automatic CFL correction applied (count: 23800):
362.8s 4142 Calculated CFL: 0.800 > Limit: 0.500
362.8s 4143 Original dt: 4.114980e-01 s
362.8s 4144 Corrected dt: 2.571863e-01 s
362.8s 4145 Correction factor: 1.6x
362.8s 4146 Max wave speed detected: 19.44 m/s
362.8s 4147 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
363.3s 4148 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
363.8s 4149 [WARNING] Automatic CFL correction applied (count: 23900):
363.8s 4150 Calculated CFL: 0.800 > Limit: 0.500
363.8s 4151 Original dt: 4.114980e-01 s
363.8s 4152 Corrected dt: 2.571863e-01 s
363.8s 4153 Correction factor: 1.6x
363.8s 4154 Max wave speed detected: 19.44 m/s
363.8s 4155 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
364.2s 4156 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 26.59s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 26.58s/s]
364.2s 4157 Stored output at t = 180.0000 s (Step 699)
364.2s 4158 
364.2s 4159 Simulation finished at t = 180.0000 s after 699 steps.
364.2s 4160 Total runtime: 2.26 seconds.
364.2s 4161 2025-10-10 13:23:24 - INFO - run_control_simulation:384 -   Reward: -0.084800
364.2s 4162 2025-10-10 13:23:24 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
364.2s 4163 2025-10-10 13:23:24 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
364.2s 4164 2025-10-10 13:23:24 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
364.2s 4165 2025-10-10 13:23:24 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.241080e+00, max=7.500000e+00, std=2.066254e+00
364.2s 4166 2025-10-10 13:23:24 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
364.2s 4167 2025-10-10 13:23:24 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
364.2s 4168 2025-10-10 13:23:24 - INFO - run_control_simulation:418 -   State hash: 5460308249474091415
364.2s 4169 2025-10-10 13:23:24 - INFO - run_control_simulation:420 - ================================================================================
364.2s 4170 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.241080e+00
364.2s 4171 2025-10-10 13:23:24 - INFO - run_control_simulation:368 - ================================================================================
364.2s 4172 2025-10-10 13:23:24 - INFO - run_control_simulation:369 - STEP 3 START:
364.2s 4173 2025-10-10 13:23:24 - INFO - run_control_simulation:370 -   Controller: BaselineController
364.2s 4174 2025-10-10 13:23:24 - INFO - run_control_simulation:371 -   Action: 0.000000
364.2s 4175 2025-10-10 13:23:24 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
364.2s 4176 Running simulation until t = 240.00 s, outputting every 60.00 s
364.3s 4177 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
364.7s 4178 [WARNING] Automatic CFL correction applied (count: 24000):
364.7s 4179 Calculated CFL: 0.800 > Limit: 0.500
364.7s 4180 Original dt: 4.114980e-01 s
364.7s 4181 Corrected dt: 2.571863e-01 s
364.7s 4182 Correction factor: 1.6x
364.7s 4183 Max wave speed detected: 19.44 m/s
364.7s 4184 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
365.2s 4185 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
365.7s 4186 [WARNING] Automatic CFL correction applied (count: 24100):
365.7s 4187 Calculated CFL: 0.800 > Limit: 0.500
365.7s 4188 Original dt: 4.114980e-01 s
365.7s 4189 Corrected dt: 2.571863e-01 s
365.7s 4190 Correction factor: 1.6x
365.7s 4191 Max wave speed detected: 19.44 m/s
365.7s 4192 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
366.2s 4193 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
366.5s 4194 Stored output at t = 240.0000 s (Step 933)
366.5s 4195 
366.5s 4196 Simulation finished at t = 240.0000 s after 933 steps.
366.5s 4197 Total runtime: 2.29 seconds.
366.5s 4198 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 26.15s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 26.15s/s]
366.5s 4199 2025-10-10 13:23:26 - INFO - run_control_simulation:384 -   Reward: 0.015200
366.5s 4200 2025-10-10 13:23:26 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
366.5s 4201 2025-10-10 13:23:26 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
366.5s 4202 2025-10-10 13:23:26 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
366.5s 4203 2025-10-10 13:23:26 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
366.5s 4204 2025-10-10 13:23:26 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
366.5s 4205 2025-10-10 13:23:26 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
366.5s 4206 2025-10-10 13:23:26 - INFO - run_control_simulation:418 -   State hash: 2767462672266625719
366.5s 4207 2025-10-10 13:23:26 - INFO - run_control_simulation:420 - ================================================================================
366.5s 4208 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
366.5s 4209 2025-10-10 13:23:26 - INFO - run_control_simulation:368 - ================================================================================
366.5s 4210 2025-10-10 13:23:26 - INFO - run_control_simulation:369 - STEP 4 START:
366.5s 4211 2025-10-10 13:23:26 - INFO - run_control_simulation:370 -   Controller: BaselineController
366.5s 4212 2025-10-10 13:23:26 - INFO - run_control_simulation:371 -   Action: 1.000000
366.5s 4213 2025-10-10 13:23:26 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
366.5s 4214 [BC UPDATE] left → phase 1 GREEN (normal inflow)
366.5s 4215 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
366.5s 4216 Running simulation until t = 300.00 s, outputting every 60.00 s
366.7s 4217 [WARNING] Automatic CFL correction applied (count: 24200):
366.7s 4218 Calculated CFL: 0.800 > Limit: 0.500
366.7s 4219 Original dt: 4.114980e-01 s
366.7s 4220 Corrected dt: 2.571863e-01 s
366.7s 4221 Correction factor: 1.6x
366.7s 4222 Max wave speed detected: 19.44 m/s
366.7s 4223 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
367.2s 4224 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
367.7s 4225 [WARNING] Automatic CFL correction applied (count: 24300):
367.7s 4226 Calculated CFL: 0.800 > Limit: 0.500
367.7s 4227 Original dt: 4.114980e-01 s
367.7s 4228 Corrected dt: 2.571863e-01 s
367.7s 4229 Correction factor: 1.6x
367.7s 4230 Max wave speed detected: 19.44 m/s
367.7s 4231 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
368.2s 4232 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
368.6s 4233 [WARNING] Automatic CFL correction applied (count: 24400):
368.6s 4234 Calculated CFL: 0.800 > Limit: 0.500
368.6s 4235 Original dt: 4.114980e-01 s
368.6s 4236 Corrected dt: 2.571863e-01 s
368.6s 4237 Correction factor: 1.6x
368.6s 4238 Max wave speed detected: 19.44 m/s
368.7s 4239 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
368.8s 4240 Stored output at t = 300.0000 s (Step 1167)
368.8s 4241 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 26.33s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 26.33s/s]
368.8s 4242 
368.8s 4243 Simulation finished at t = 300.0000 s after 1167 steps.
368.8s 4244 Total runtime: 2.28 seconds.
368.8s 4245 2025-10-10 13:23:29 - INFO - run_control_simulation:384 -   Reward: -0.084800
368.8s 4246 2025-10-10 13:23:29 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
368.8s 4247 2025-10-10 13:23:29 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
368.8s 4248 2025-10-10 13:23:29 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
368.8s 4249 2025-10-10 13:23:29 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.491564e-02, max=7.500000e+00, std=6.627938e-01
368.8s 4250 2025-10-10 13:23:29 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
368.8s 4251 2025-10-10 13:23:29 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
368.8s 4252 2025-10-10 13:23:29 - INFO - run_control_simulation:418 -   State hash: -7565154368268882178
368.8s 4253 2025-10-10 13:23:29 - INFO - run_control_simulation:420 - ================================================================================
368.8s 4254 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=6.491564e-02
368.8s 4255 2025-10-10 13:23:29 - INFO - run_control_simulation:368 - ================================================================================
368.8s 4256 2025-10-10 13:23:29 - INFO - run_control_simulation:369 - STEP 5 START:
368.8s 4257 2025-10-10 13:23:29 - INFO - run_control_simulation:370 -   Controller: BaselineController
368.8s 4258 2025-10-10 13:23:29 - INFO - run_control_simulation:371 -   Action: 0.000000
368.8s 4259 2025-10-10 13:23:29 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
368.8s 4260 Running simulation until t = 360.00 s, outputting every 60.00 s
369.2s 4261 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
369.6s 4262 [WARNING] Automatic CFL correction applied (count: 24500):
369.6s 4263 Calculated CFL: 0.800 > Limit: 0.500
369.6s 4264 Original dt: 4.114980e-01 s
369.6s 4265 Corrected dt: 2.571863e-01 s
369.6s 4266 Correction factor: 1.6x
369.6s 4267 Max wave speed detected: 19.44 m/s
369.6s 4268 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
370.1s 4269 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
370.6s 4270 [WARNING] Automatic CFL correction applied (count: 24600):
370.6s 4271 Calculated CFL: 0.800 > Limit: 0.500
370.6s 4272 Original dt: 4.114980e-01 s
370.6s 4273 Corrected dt: 2.571863e-01 s
370.6s 4274 Correction factor: 1.6x
370.6s 4275 Max wave speed detected: 19.44 m/s
370.6s 4276 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
371.1s 4277 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
371.1s 4278 Stored output at t = 360.0000 s (Step 1401)
371.1s 4279 
371.1s 4280 Simulation finished at t = 360.0000 s after 1401 steps.
371.1s 4281 Total runtime: 2.30 seconds.
371.1s 4282 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 26.05s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 26.05s/s]
371.1s 4283 2025-10-10 13:23:31 - INFO - run_control_simulation:384 -   Reward: 0.015200
371.1s 4284 2025-10-10 13:23:31 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
371.1s 4285 2025-10-10 13:23:31 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
371.1s 4286 2025-10-10 13:23:31 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
371.1s 4287 2025-10-10 13:23:31 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
371.1s 4288 2025-10-10 13:23:31 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
371.1s 4289 2025-10-10 13:23:31 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
371.1s 4290 2025-10-10 13:23:31 - INFO - run_control_simulation:418 -   State hash: -320426465284029370
371.1s 4291 2025-10-10 13:23:31 - INFO - run_control_simulation:420 - ================================================================================
371.1s 4292 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
371.1s 4293 2025-10-10 13:23:31 - INFO - run_control_simulation:368 - ================================================================================
371.1s 4294 2025-10-10 13:23:31 - INFO - run_control_simulation:369 - STEP 6 START:
371.1s 4295 2025-10-10 13:23:31 - INFO - run_control_simulation:370 -   Controller: BaselineController
371.1s 4296 2025-10-10 13:23:31 - INFO - run_control_simulation:371 -   Action: 1.000000
371.1s 4297 2025-10-10 13:23:31 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
371.1s 4298 [BC UPDATE] left → phase 0 RED (reduced inflow)
371.1s 4299 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
371.1s 4300 Running simulation until t = 420.00 s, outputting every 60.00 s
371.6s 4301 [WARNING] Automatic CFL correction applied (count: 24700):
371.6s 4302 Calculated CFL: 0.800 > Limit: 0.500
371.6s 4303 Original dt: 4.114980e-01 s
371.6s 4304 Corrected dt: 2.571863e-01 s
371.6s 4305 Correction factor: 1.6x
371.6s 4306 Max wave speed detected: 19.44 m/s
371.6s 4307 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
372.1s 4308 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
372.5s 4309 [WARNING] Automatic CFL correction applied (count: 24800):
372.5s 4310 Calculated CFL: 0.800 > Limit: 0.500
372.5s 4311 Original dt: 4.114980e-01 s
372.5s 4312 Corrected dt: 2.571863e-01 s
372.5s 4313 Correction factor: 1.6x
372.5s 4314 Max wave speed detected: 19.44 m/s
372.5s 4315 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
373.0s 4316 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
373.4s 4317 Stored output at t = 420.0000 s (Step 1635)
373.4s 4318 
373.4s 4319 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 26.92s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 26.91s/s]
373.4s 4320 Simulation finished at t = 420.0000 s after 1635 steps.
373.4s 4321 Total runtime: 2.23 seconds.
373.4s 4322 2025-10-10 13:23:33 - INFO - run_control_simulation:384 -   Reward: -0.084800
373.4s 4323 2025-10-10 13:23:33 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
373.4s 4324 2025-10-10 13:23:33 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
373.4s 4325 2025-10-10 13:23:33 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
373.4s 4326 2025-10-10 13:23:33 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
373.4s 4327 2025-10-10 13:23:33 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
373.4s 4328 2025-10-10 13:23:33 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
373.4s 4329 2025-10-10 13:23:33 - INFO - run_control_simulation:418 -   State hash: -1210140820769954636
373.4s 4330 2025-10-10 13:23:33 - INFO - run_control_simulation:420 - ================================================================================
373.4s 4331 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=6.490385e-02
373.4s 4332 2025-10-10 13:23:33 - INFO - run_control_simulation:368 - ================================================================================
373.4s 4333 2025-10-10 13:23:33 - INFO - run_control_simulation:369 - STEP 7 START:
373.4s 4334 2025-10-10 13:23:33 - INFO - run_control_simulation:370 -   Controller: BaselineController
373.4s 4335 2025-10-10 13:23:33 - INFO - run_control_simulation:371 -   Action: 0.000000
373.4s 4336 2025-10-10 13:23:33 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
373.4s 4337 Running simulation until t = 480.00 s, outputting every 60.00 s
373.5s 4338 [WARNING] Automatic CFL correction applied (count: 24900):
373.5s 4339 Calculated CFL: 0.800 > Limit: 0.500
373.5s 4340 Original dt: 4.114980e-01 s
373.5s 4341 Corrected dt: 2.571863e-01 s
373.5s 4342 Correction factor: 1.6x
373.5s 4343 Max wave speed detected: 19.44 m/s
373.5s 4344 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
374.0s 4345 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
374.5s 4346 [WARNING] Automatic CFL correction applied (count: 25000):
374.5s 4347 Calculated CFL: 0.800 > Limit: 0.500
374.5s 4348 Original dt: 4.114980e-01 s
374.5s 4349 Corrected dt: 2.571863e-01 s
374.5s 4350 Correction factor: 1.6x
374.5s 4351 Max wave speed detected: 19.44 m/s
374.5s 4352 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
375.0s 4353 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
375.4s 4354 [WARNING] Automatic CFL correction applied (count: 25100):
375.4s 4355 Calculated CFL: 0.800 > Limit: 0.500
375.4s 4356 Original dt: 4.114980e-01 s
375.4s 4357 Corrected dt: 2.571863e-01 s
375.4s 4358 Correction factor: 1.6x
375.4s 4359 Max wave speed detected: 19.44 m/s
375.4s 4360 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
375.6s 4361 Stored output at t = 480.0000 s (Step 1869)
375.6s 4362 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 26.61s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 26.61s/s]
375.6s 4363 
375.6s 4364 Simulation finished at t = 480.0000 s after 1869 steps.
375.6s 4365 Total runtime: 2.25 seconds.
375.6s 4366 2025-10-10 13:23:35 - INFO - run_control_simulation:384 -   Reward: 0.015200
375.6s 4367 2025-10-10 13:23:35 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
375.6s 4368 2025-10-10 13:23:35 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
375.6s 4369 2025-10-10 13:23:35 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
375.6s 4370 2025-10-10 13:23:35 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
375.6s 4371 2025-10-10 13:23:35 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
375.6s 4372 2025-10-10 13:23:35 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
375.6s 4373 2025-10-10 13:23:35 - INFO - run_control_simulation:418 -   State hash: -1061288204543211807
375.6s 4374 2025-10-10 13:23:35 - INFO - run_control_simulation:420 - ================================================================================
375.6s 4375 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
375.6s 4376 2025-10-10 13:23:35 - INFO - run_control_simulation:368 - ================================================================================
375.6s 4377 2025-10-10 13:23:35 - INFO - run_control_simulation:369 - STEP 8 START:
375.6s 4378 2025-10-10 13:23:35 - INFO - run_control_simulation:370 -   Controller: BaselineController
375.6s 4379 2025-10-10 13:23:35 - INFO - run_control_simulation:371 -   Action: 1.000000
375.6s 4380 2025-10-10 13:23:35 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
375.6s 4381 [BC UPDATE] left → phase 1 GREEN (normal inflow)
375.6s 4382 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
375.6s 4383 Running simulation until t = 540.00 s, outputting every 60.00 s
375.9s 4384 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
376.4s 4385 [WARNING] Automatic CFL correction applied (count: 25200):
376.4s 4386 Calculated CFL: 0.800 > Limit: 0.500
376.4s 4387 Original dt: 4.114980e-01 s
376.4s 4388 Corrected dt: 2.571863e-01 s
376.4s 4389 Correction factor: 1.6x
376.4s 4390 Max wave speed detected: 19.44 m/s
376.4s 4391 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
376.9s 4392 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
377.3s 4393 [WARNING] Automatic CFL correction applied (count: 25300):
377.3s 4394 Calculated CFL: 0.800 > Limit: 0.500
377.3s 4395 Original dt: 4.114980e-01 s
377.3s 4396 Corrected dt: 2.571863e-01 s
377.3s 4397 Correction factor: 1.6x
377.3s 4398 Max wave speed detected: 19.44 m/s
377.3s 4399 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
377.8s 4400 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
377.9s 4401 Stored output at t = 540.0000 s (Step 2103)
377.9s 4402 
377.9s 4403 Simulation finished at t = 540.0000 s after 2103 steps.
377.9s 4404 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 26.98s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 26.98s/s]
377.9s 4405 Total runtime: 2.22 seconds.
377.9s 4406 2025-10-10 13:23:38 - INFO - run_control_simulation:384 -   Reward: -0.084800
377.9s 4407 2025-10-10 13:23:38 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
377.9s 4408 2025-10-10 13:23:38 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
377.9s 4409 2025-10-10 13:23:38 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
377.9s 4410 2025-10-10 13:23:38 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
377.9s 4411 2025-10-10 13:23:38 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
377.9s 4412 2025-10-10 13:23:38 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
377.9s 4413 2025-10-10 13:23:38 - INFO - run_control_simulation:418 -   State hash: -1627956185891686381
377.9s 4414 2025-10-10 13:23:38 - INFO - run_control_simulation:420 - ================================================================================
377.9s 4415 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=6.490385e-02
377.9s 4416 2025-10-10 13:23:38 - INFO - run_control_simulation:368 - ================================================================================
377.9s 4417 2025-10-10 13:23:38 - INFO - run_control_simulation:369 - STEP 9 START:
377.9s 4418 2025-10-10 13:23:38 - INFO - run_control_simulation:370 -   Controller: BaselineController
377.9s 4419 2025-10-10 13:23:38 - INFO - run_control_simulation:371 -   Action: 0.000000
377.9s 4420 2025-10-10 13:23:38 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
377.9s 4421 Running simulation until t = 600.00 s, outputting every 60.00 s
378.3s 4422 [WARNING] Automatic CFL correction applied (count: 25400):
378.3s 4423 Calculated CFL: 0.800 > Limit: 0.500
378.3s 4424 Original dt: 4.114980e-01 s
378.3s 4425 Corrected dt: 2.571863e-01 s
378.3s 4426 Correction factor: 1.6x
378.3s 4427 Max wave speed detected: 19.44 m/s
378.3s 4428 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
378.8s 4429 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
379.3s 4430 [WARNING] Automatic CFL correction applied (count: 25500):
379.3s 4431 Calculated CFL: 0.800 > Limit: 0.500
379.3s 4432 Original dt: 4.114980e-01 s
379.3s 4433 Corrected dt: 2.571863e-01 s
379.3s 4434 Correction factor: 1.6x
379.3s 4435 Max wave speed detected: 19.44 m/s
379.3s 4436 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
379.8s 4437 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
380.1s 4438 Stored output at t = 600.0000 s (Step 2337)
380.1s 4439 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 26.33s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 26.32s/s]
380.1s 4440 
380.1s 4441 Simulation finished at t = 600.0000 s after 2337 steps.
380.1s 4442 Total runtime: 2.28 seconds.
380.1s 4443 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
380.1s 4444 2025-10-10 13:23:40 - INFO - run_control_simulation:384 -   Reward: 0.015200
380.1s 4445 2025-10-10 13:23:40 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
380.1s 4446 2025-10-10 13:23:40 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
380.1s 4447 2025-10-10 13:23:40 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
380.1s 4448 2025-10-10 13:23:40 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
380.1s 4449 2025-10-10 13:23:40 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
380.1s 4450 2025-10-10 13:23:40 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
380.1s 4451 2025-10-10 13:23:40 - INFO - run_control_simulation:418 -   State hash: 391874124427556960
380.1s 4452 2025-10-10 13:23:40 - INFO - run_control_simulation:420 - ================================================================================
380.1s 4453 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
380.1s 4454 
380.1s 4455 [SIMULATION COMPLETED] Summary:
380.1s 4456 - Total control steps: 10
380.1s 4457 - Total reward: -0.35
380.1s 4458 - Avg step time: 2.268s (device=gpu)
380.1s 4459 - Simulated time: 600.0s / 600.0s
380.1s 4460 - Wallclock time: 22.7s
380.1s 4461 - Speed ratio: 26.46x real-time
380.1s 4462 
380.1s 4463 2025-10-10 13:23:40 - INFO - run_control_simulation:455 -
380.1s 4464 [SIMULATION COMPLETED] Summary:
380.1s 4465 - Total control steps: 10
380.1s 4466 - Total reward: -0.35
380.1s 4467 - Avg step time: 2.268s (device=gpu)
380.1s 4468 - Simulated time: 600.0s / 600.0s
380.1s 4469 - Wallclock time: 22.7s
380.1s 4470 - Speed ratio: 26.46x real-time
380.1s 4471 
380.1s 4472 2025-10-10 13:23:40 - INFO - run_control_simulation:456 - Returning 10 state snapshots
380.1s 4473 2025-10-10 13:23:40 - INFO - run_performance_comparison:725 - Baseline states copied: 10 snapshots
380.1s 4474 2025-10-10 13:23:40 - INFO - run_performance_comparison:726 - Baseline FIRST state hash: -1603931181899818387
380.1s 4475 2025-10-10 13:23:40 - INFO - run_performance_comparison:727 - Baseline LAST state hash: 391874124427556960
380.1s 4476 2025-10-10 13:23:40 - INFO - run_performance_comparison:728 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
380.1s 4477 2.14351577e-05]
380.1s 4478 2025-10-10 13:23:40 - INFO - run_performance_comparison:729 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
380.1s 4479 2.14319923e-05]
380.1s 4480 2025-10-10 13:23:40 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
380.1s 4481 2025-10-10 13:23:40 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=-1603931181899818387, last=391874124427556960
380.1s 4482 2025-10-10 13:23:40 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
380.1s 4483 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
380.1s 4484 2025-10-10 13:23:40 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
380.1s 4485 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
380.1s 4486 2025-10-10 13:23:40 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
380.1s 4487 Running RL controller...
380.1s 4488 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
380.1s 4489 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
380.2s 4490 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
380.2s 4491 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
380.2s 4492 2025-10-10 13:23:40 - INFO - run_control_simulation:286 - ================================================================================
380.2s 4493 2025-10-10 13:23:40 - INFO - run_control_simulation:287 - Starting run_control_simulation:
380.2s 4494 2025-10-10 13:23:40 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
380.2s 4495 2025-10-10 13:23:40 - INFO - run_control_simulation:289 -   - duration: 600.0s
380.2s 4496 2025-10-10 13:23:40 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
380.2s 4497 2025-10-10 13:23:40 - INFO - run_control_simulation:291 -   - device: gpu
380.2s 4498 2025-10-10 13:23:40 - INFO - run_control_simulation:292 -   - controller: RLController
380.2s 4499 2025-10-10 13:23:40 - INFO - run_control_simulation:293 -   - max_control_steps: 11
380.2s 4500 2025-10-10 13:23:40 - INFO - run_control_simulation:294 - ================================================================================
380.2s 4501 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
380.2s 4502 2025-10-10 13:23:40 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
380.2s 4503 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
380.2s 4504 Using device: gpu
380.2s 4505 DEBUG PARAMS: Reading K_m_kmh = 10.0
380.2s 4506 DEBUG PARAMS: Reading K_c_kmh = 15.0
380.2s 4507 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
380.2s 4508 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
380.2s 4509 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
380.2s 4510 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
380.2s 4511 Loading road quality type: uniform
380.2s 4512 Uniform road quality value: 2
380.2s 4513 Road quality loaded.
380.2s 4514 Initial state created.
380.2s 4515 Transferring initial state and road quality to GPU...
380.2s 4516 GPU data transfer complete.
380.2s 4517 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
380.2s 4518 Initial boundary conditions applied.
380.2s 4519 TrafficSignalEnvDirect initialized:
380.2s 4520 Decision interval: 60.0s
380.2s 4521 Observation segments: 6
380.2s 4522 Observation space: (26,)
380.2s 4523 Action space: 2
380.2s 4524 Device: gpu
380.2s 4525 2025-10-10 13:23:40 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
380.2s 4526 2025-10-10 13:23:40 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
380.2s 4527 [INFO] Calling env.reset()...
380.2s 4528 2025-10-10 13:23:40 - INFO - run_control_simulation:331 - Calling env.reset()...
380.2s 4529 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
380.2s 4530 Using device: gpu
380.2s 4531 DEBUG PARAMS: Reading K_m_kmh = 10.0
380.2s 4532 DEBUG PARAMS: Reading K_c_kmh = 15.0
380.2s 4533 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
380.2s 4534 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
380.2s 4535 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
380.2s 4536 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
380.2s 4537 Loading road quality type: uniform
380.2s 4538 Uniform road quality value: 2
380.2s 4539 Road quality loaded.
380.2s 4540 Initial state created.
380.2s 4541 Transferring initial state and road quality to GPU...
380.2s 4542 GPU data transfer complete.
380.2s 4543 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
380.2s 4544 Initial boundary conditions applied.
380.2s 4545 [BC UPDATE] left → phase 0 RED (reduced inflow)
380.2s 4546 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
380.2s 4547 2025-10-10 13:23:40 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
380.2s 4548 2025-10-10 13:23:40 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
380.2s 4549 2025-10-10 13:23:40 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
380.2s 4550 [INFO] Starting simulation loop (max 11 control steps)
380.2s 4551 2025-10-10 13:23:40 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
380.2s 4552 2025-10-10 13:23:40 - INFO - run_control_simulation:368 - ================================================================================
380.2s 4553 2025-10-10 13:23:40 - INFO - run_control_simulation:369 - STEP 0 START:
380.2s 4554 2025-10-10 13:23:40 - INFO - run_control_simulation:370 -   Controller: RLController
380.2s 4555 2025-10-10 13:23:40 - INFO - run_control_simulation:371 -   Action: 0.000000
380.2s 4556 2025-10-10 13:23:40 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
380.2s 4557 Running simulation until t = 60.00 s, outputting every 60.00 s
380.3s 4558 [WARNING] Automatic CFL correction applied (count: 25600):
380.3s 4559 Calculated CFL: 0.800 > Limit: 0.500
380.3s 4560 Original dt: 3.909130e-01 s
380.3s 4561 Corrected dt: 2.443206e-01 s
380.3s 4562 Correction factor: 1.6x
380.3s 4563 Max wave speed detected: 20.46 m/s
380.7s 4564 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
381.2s 4565 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
381.3s 4566 [WARNING] Automatic CFL correction applied (count: 25700):
381.3s 4567 Calculated CFL: 0.800 > Limit: 0.500
381.3s 4568 Original dt: 4.131708e-01 s
381.3s 4569 Corrected dt: 2.582317e-01 s
381.3s 4570 Correction factor: 1.6x
381.3s 4571 Max wave speed detected: 19.36 m/s
381.6s 4572 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
382.1s 4573 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
382.2s 4574 [WARNING] Automatic CFL correction applied (count: 25800):
382.2s 4575 Calculated CFL: 0.800 > Limit: 0.500
382.2s 4576 Original dt: 4.115220e-01 s
382.2s 4577 Corrected dt: 2.572013e-01 s
382.2s 4578 Correction factor: 1.6x
382.2s 4579 Max wave speed detected: 19.44 m/s
382.4s 4580 Stored output at t = 60.0000 s (Step 231)
382.4s 4581 
382.4s 4582 Simulation finished at t = 60.0000 s after 231 steps.
382.4s 4583 Total runtime: 2.22 seconds.
382.4s 4584 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.99s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.98s/s]
382.4s 4585 2025-10-10 13:23:42 - INFO - run_control_simulation:384 -   Reward: 0.015201
382.4s 4586 2025-10-10 13:23:42 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
382.4s 4587 2025-10-10 13:23:42 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
382.4s 4588 2025-10-10 13:23:42 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
382.4s 4589 2025-10-10 13:23:42 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.609084e+00, max=1.233795e+01, std=4.039166e+00
382.4s 4590 2025-10-10 13:23:42 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
382.4s 4591 2025-10-10 13:23:42 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.262455, w_c=11.210112
382.4s 4592 2025-10-10 13:23:42 - INFO - run_control_simulation:418 -   State hash: -8350900293439220016
382.4s 4593 2025-10-10 13:23:42 - INFO - run_control_simulation:420 - ================================================================================
382.4s 4594 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.609084e+00
382.4s 4595 2025-10-10 13:23:42 - INFO - run_control_simulation:368 - ================================================================================
382.4s 4596 2025-10-10 13:23:42 - INFO - run_control_simulation:369 - STEP 1 START:
382.4s 4597 2025-10-10 13:23:42 - INFO - run_control_simulation:370 -   Controller: RLController
382.4s 4598 2025-10-10 13:23:42 - INFO - run_control_simulation:371 -   Action: 0.000000
382.4s 4599 2025-10-10 13:23:42 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
382.4s 4600 Running simulation until t = 120.00 s, outputting every 60.00 s
382.6s 4601 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
383.1s 4602 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
383.2s 4603 [WARNING] Automatic CFL correction applied (count: 25900):
383.2s 4604 Calculated CFL: 0.800 > Limit: 0.500
383.2s 4605 Original dt: 4.114985e-01 s
383.2s 4606 Corrected dt: 2.571865e-01 s
383.2s 4607 Correction factor: 1.6x
383.2s 4608 Max wave speed detected: 19.44 m/s
383.6s 4609 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
384.1s 4610 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
384.2s 4611 [WARNING] Automatic CFL correction applied (count: 26000):
384.2s 4612 Calculated CFL: 0.800 > Limit: 0.500
384.2s 4613 Original dt: 4.114980e-01 s
384.2s 4614 Corrected dt: 2.571863e-01 s
384.2s 4615 Correction factor: 1.6x
384.2s 4616 Max wave speed detected: 19.44 m/s
384.6s 4617 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
384.8s 4618 Stored output at t = 120.0000 s (Step 465)
384.8s 4619 
384.8s 4620 Simulation finished at t = 120.0000 s after 465 steps.
384.8s 4621 Total runtime: 2.34 seconds.
384.8s 4622 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.64s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.63s/s]
384.8s 4623 2025-10-10 13:23:45 - INFO - run_control_simulation:384 -   Reward: 0.015200
384.8s 4624 2025-10-10 13:23:45 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
384.8s 4625 2025-10-10 13:23:45 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
384.8s 4626 2025-10-10 13:23:45 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
384.8s 4627 2025-10-10 13:23:45 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
384.8s 4628 2025-10-10 13:23:45 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
384.8s 4629 2025-10-10 13:23:45 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.773789, w_c=13.986264
384.8s 4630 2025-10-10 13:23:45 - INFO - run_control_simulation:418 -   State hash: 9013459084362335020
384.8s 4631 2025-10-10 13:23:45 - INFO - run_control_simulation:420 - ================================================================================
384.8s 4632 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
384.8s 4633 2025-10-10 13:23:45 - INFO - run_control_simulation:368 - ================================================================================
384.8s 4634 2025-10-10 13:23:45 - INFO - run_control_simulation:369 - STEP 2 START:
384.8s 4635 2025-10-10 13:23:45 - INFO - run_control_simulation:370 -   Controller: RLController
384.8s 4636 2025-10-10 13:23:45 - INFO - run_control_simulation:371 -   Action: 0.000000
384.8s 4637 2025-10-10 13:23:45 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
384.8s 4638 Running simulation until t = 180.00 s, outputting every 60.00 s
385.1s 4639 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
385.2s 4640 [WARNING] Automatic CFL correction applied (count: 26100):
385.2s 4641 Calculated CFL: 0.800 > Limit: 0.500
385.2s 4642 Original dt: 4.114980e-01 s
385.2s 4643 Corrected dt: 2.571863e-01 s
385.2s 4644 Correction factor: 1.6x
385.2s 4645 Max wave speed detected: 19.44 m/s
385.6s 4646 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
386.0s 4647 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
386.2s 4648 [WARNING] Automatic CFL correction applied (count: 26200):
386.2s 4649 Calculated CFL: 0.800 > Limit: 0.500
386.2s 4650 Original dt: 4.114980e-01 s
386.2s 4651 Corrected dt: 2.571863e-01 s
386.2s 4652 Correction factor: 1.6x
386.2s 4653 Max wave speed detected: 19.44 m/s
386.5s 4654 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
387.0s 4655 Stored output at t = 180.0000 s (Step 699)
387.0s 4656 
387.0s 4657 Simulation finished at t = 180.0000 s after 699 steps.
387.0s 4658 Total runtime: 2.22 seconds.
387.0s 4659 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 26.98s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 26.98s/s]
387.0s 4660 2025-10-10 13:23:47 - INFO - run_control_simulation:384 -   Reward: 0.015200
387.0s 4661 2025-10-10 13:23:47 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
387.0s 4662 2025-10-10 13:23:47 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
387.0s 4663 2025-10-10 13:23:47 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
387.0s 4664 2025-10-10 13:23:47 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
387.0s 4665 2025-10-10 13:23:47 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
387.0s 4666 2025-10-10 13:23:47 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
387.0s 4667 2025-10-10 13:23:47 - INFO - run_control_simulation:418 -   State hash: 5460308249474091415
387.0s 4668 2025-10-10 13:23:47 - INFO - run_control_simulation:420 - ================================================================================
387.0s 4669 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
387.0s 4670 2025-10-10 13:23:47 - INFO - run_control_simulation:368 - ================================================================================
387.0s 4671 2025-10-10 13:23:47 - INFO - run_control_simulation:369 - STEP 3 START:
387.0s 4672 2025-10-10 13:23:47 - INFO - run_control_simulation:370 -   Controller: RLController
387.0s 4673 2025-10-10 13:23:47 - INFO - run_control_simulation:371 -   Action: 0.000000
387.0s 4674 2025-10-10 13:23:47 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
387.0s 4675 Running simulation until t = 240.00 s, outputting every 60.00 s
387.0s 4676 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
387.1s 4677 [WARNING] Automatic CFL correction applied (count: 26300):
387.1s 4678 Calculated CFL: 0.800 > Limit: 0.500
387.1s 4679 Original dt: 4.114980e-01 s
387.1s 4680 Corrected dt: 2.571863e-01 s
387.1s 4681 Correction factor: 1.6x
387.1s 4682 Max wave speed detected: 19.44 m/s
387.5s 4683 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
387.9s 4684 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
388.1s 4685 [WARNING] Automatic CFL correction applied (count: 26400):
388.1s 4686 Calculated CFL: 0.800 > Limit: 0.500
388.1s 4687 Original dt: 4.114980e-01 s
388.1s 4688 Corrected dt: 2.571863e-01 s
388.1s 4689 Correction factor: 1.6x
388.1s 4690 Max wave speed detected: 19.44 m/s
388.4s 4691 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
388.9s 4692 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
389.0s 4693 [WARNING] Automatic CFL correction applied (count: 26500):
389.0s 4694 Calculated CFL: 0.800 > Limit: 0.500
389.0s 4695 Original dt: 4.114980e-01 s
389.0s 4696 Corrected dt: 2.571863e-01 s
389.0s 4697 Correction factor: 1.6x
389.0s 4698 Max wave speed detected: 19.44 m/s
389.2s 4699 Stored output at t = 240.0000 s (Step 933)
389.2s 4700 
389.2s 4701 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 27.22s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 27.22s/s]
389.2s 4702 Simulation finished at t = 240.0000 s after 933 steps.
389.2s 4703 Total runtime: 2.20 seconds.
389.2s 4704 2025-10-10 13:23:49 - INFO - run_control_simulation:384 -   Reward: 0.015200
389.2s 4705 2025-10-10 13:23:49 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
389.2s 4706 2025-10-10 13:23:49 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
389.2s 4707 2025-10-10 13:23:49 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
389.2s 4708 2025-10-10 13:23:49 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
389.2s 4709 2025-10-10 13:23:49 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
389.2s 4710 2025-10-10 13:23:49 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
389.2s 4711 2025-10-10 13:23:49 - INFO - run_control_simulation:418 -   State hash: 2767462672266625719
389.2s 4712 2025-10-10 13:23:49 - INFO - run_control_simulation:420 - ================================================================================
389.2s 4713 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
389.2s 4714 2025-10-10 13:23:49 - INFO - run_control_simulation:368 - ================================================================================
389.2s 4715 2025-10-10 13:23:49 - INFO - run_control_simulation:369 - STEP 4 START:
389.2s 4716 2025-10-10 13:23:49 - INFO - run_control_simulation:370 -   Controller: RLController
389.2s 4717 2025-10-10 13:23:49 - INFO - run_control_simulation:371 -   Action: 0.000000
389.2s 4718 2025-10-10 13:23:49 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
389.2s 4719 Running simulation until t = 300.00 s, outputting every 60.00 s
389.4s 4720 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
389.8s 4721 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
390.0s 4722 [WARNING] Automatic CFL correction applied (count: 26600):
390.0s 4723 Calculated CFL: 0.800 > Limit: 0.500
390.0s 4724 Original dt: 4.114980e-01 s
390.0s 4725 Corrected dt: 2.571863e-01 s
390.0s 4726 Correction factor: 1.6x
390.0s 4727 Max wave speed detected: 19.44 m/s
390.3s 4728 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
390.8s 4729 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
390.9s 4730 [WARNING] Automatic CFL correction applied (count: 26700):
390.9s 4731 Calculated CFL: 0.800 > Limit: 0.500
390.9s 4732 Original dt: 4.114980e-01 s
390.9s 4733 Corrected dt: 2.571863e-01 s
390.9s 4734 Correction factor: 1.6x
390.9s 4735 Max wave speed detected: 19.44 m/s
391.3s 4736 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
391.4s 4737 Stored output at t = 300.0000 s (Step 1167)
391.4s 4738 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 26.81s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 26.81s/s]
391.4s 4739 
391.4s 4740 Simulation finished at t = 300.0000 s after 1167 steps.
391.4s 4741 Total runtime: 2.24 seconds.
391.4s 4742 2025-10-10 13:23:51 - INFO - run_control_simulation:384 -   Reward: 0.015200
391.4s 4743 2025-10-10 13:23:51 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
391.4s 4744 2025-10-10 13:23:51 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
391.4s 4745 2025-10-10 13:23:51 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
391.4s 4746 2025-10-10 13:23:51 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
391.4s 4747 2025-10-10 13:23:51 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
391.4s 4748 2025-10-10 13:23:51 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
391.4s 4749 2025-10-10 13:23:51 - INFO - run_control_simulation:418 -   State hash: 4583633481978107912
391.4s 4750 2025-10-10 13:23:51 - INFO - run_control_simulation:420 - ================================================================================
391.4s 4751 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
391.4s 4752 2025-10-10 13:23:51 - INFO - run_control_simulation:368 - ================================================================================
391.4s 4753 2025-10-10 13:23:51 - INFO - run_control_simulation:369 - STEP 5 START:
391.4s 4754 2025-10-10 13:23:51 - INFO - run_control_simulation:370 -   Controller: RLController
391.4s 4755 2025-10-10 13:23:51 - INFO - run_control_simulation:371 -   Action: 0.000000
391.4s 4756 2025-10-10 13:23:51 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
391.4s 4757 Running simulation until t = 360.00 s, outputting every 60.00 s
391.8s 4758 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
391.9s 4759 [WARNING] Automatic CFL correction applied (count: 26800):
391.9s 4760 Calculated CFL: 0.800 > Limit: 0.500
391.9s 4761 Original dt: 4.114980e-01 s
391.9s 4762 Corrected dt: 2.571863e-01 s
391.9s 4763 Correction factor: 1.6x
391.9s 4764 Max wave speed detected: 19.44 m/s
392.3s 4765 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
392.7s 4766 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
392.8s 4767 [WARNING] Automatic CFL correction applied (count: 26900):
392.8s 4768 Calculated CFL: 0.800 > Limit: 0.500
392.8s 4769 Original dt: 4.114980e-01 s
392.8s 4770 Corrected dt: 2.571863e-01 s
392.8s 4771 Correction factor: 1.6x
392.8s 4772 Max wave speed detected: 19.44 m/s
393.2s 4773 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
393.7s 4774 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
393.7s 4775 Stored output at t = 360.0000 s (Step 1401)
393.7s 4776 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 26.66s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 26.66s/s]
393.7s 4777 
393.7s 4778 Simulation finished at t = 360.0000 s after 1401 steps.
393.7s 4779 Total runtime: 2.25 seconds.
393.7s 4780 2025-10-10 13:23:53 - INFO - run_control_simulation:384 -   Reward: 0.015200
393.7s 4781 2025-10-10 13:23:53 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
393.7s 4782 2025-10-10 13:23:53 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
393.7s 4783 2025-10-10 13:23:53 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
393.7s 4784 2025-10-10 13:23:53 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
393.7s 4785 2025-10-10 13:23:53 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
393.7s 4786 2025-10-10 13:23:53 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
393.7s 4787 2025-10-10 13:23:53 - INFO - run_control_simulation:418 -   State hash: 3114410710316347802
393.7s 4788 2025-10-10 13:23:53 - INFO - run_control_simulation:420 - ================================================================================
393.7s 4789 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
393.7s 4790 2025-10-10 13:23:53 - INFO - run_control_simulation:368 - ================================================================================
393.7s 4791 2025-10-10 13:23:53 - INFO - run_control_simulation:369 - STEP 6 START:
393.7s 4792 2025-10-10 13:23:53 - INFO - run_control_simulation:370 -   Controller: RLController
393.7s 4793 2025-10-10 13:23:53 - INFO - run_control_simulation:371 -   Action: 0.000000
393.7s 4794 2025-10-10 13:23:53 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
393.7s 4795 Running simulation until t = 420.00 s, outputting every 60.00 s
393.8s 4796 [WARNING] Automatic CFL correction applied (count: 27000):
393.8s 4797 Calculated CFL: 0.800 > Limit: 0.500
393.8s 4798 Original dt: 4.114980e-01 s
393.8s 4799 Corrected dt: 2.571863e-01 s
393.8s 4800 Correction factor: 1.6x
393.8s 4801 Max wave speed detected: 19.44 m/s
394.2s 4802 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
394.6s 4803 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
394.7s 4804 [WARNING] Automatic CFL correction applied (count: 27100):
394.7s 4805 Calculated CFL: 0.800 > Limit: 0.500
394.7s 4806 Original dt: 4.114980e-01 s
394.7s 4807 Corrected dt: 2.571863e-01 s
394.7s 4808 Correction factor: 1.6x
394.7s 4809 Max wave speed detected: 19.44 m/s
395.1s 4810 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
395.6s 4811 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
395.7s 4812 [WARNING] Automatic CFL correction applied (count: 27200):
395.7s 4813 Calculated CFL: 0.800 > Limit: 0.500
395.7s 4814 Original dt: 4.114980e-01 s
395.7s 4815 Corrected dt: 2.571863e-01 s
395.7s 4816 Correction factor: 1.6x
395.7s 4817 Max wave speed detected: 19.44 m/s
395.9s 4818 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 27.09s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 27.09s/s]
395.9s 4819 Stored output at t = 420.0000 s (Step 1635)
395.9s 4820 
395.9s 4821 Simulation finished at t = 420.0000 s after 1635 steps.
395.9s 4822 Total runtime: 2.22 seconds.
395.9s 4823 2025-10-10 13:23:56 - INFO - run_control_simulation:384 -   Reward: 0.015200
395.9s 4824 2025-10-10 13:23:56 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
395.9s 4825 2025-10-10 13:23:56 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
395.9s 4826 2025-10-10 13:23:56 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
395.9s 4827 2025-10-10 13:23:56 - INFO - run_control_simulation:403 -     Diff statistics: mean=2.295402e-11, max=7.384955e-10, std=9.818588e-11
395.9s 4828 2025-10-10 13:23:56 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
395.9s 4829 2025-10-10 13:23:56 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
395.9s 4830 2025-10-10 13:23:56 - INFO - run_control_simulation:418 -   State hash: -1210140820769954636
395.9s 4831 2025-10-10 13:23:56 - INFO - run_control_simulation:420 - ================================================================================
395.9s 4832 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295402e-11
395.9s 4833 2025-10-10 13:23:56 - INFO - run_control_simulation:368 - ================================================================================
395.9s 4834 2025-10-10 13:23:56 - INFO - run_control_simulation:369 - STEP 7 START:
395.9s 4835 2025-10-10 13:23:56 - INFO - run_control_simulation:370 -   Controller: RLController
395.9s 4836 2025-10-10 13:23:56 - INFO - run_control_simulation:371 -   Action: 0.000000
395.9s 4837 2025-10-10 13:23:56 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
395.9s 4838 Running simulation until t = 480.00 s, outputting every 60.00 s
396.1s 4839 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
396.5s 4840 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
396.6s 4841 [WARNING] Automatic CFL correction applied (count: 27300):
396.6s 4842 Calculated CFL: 0.800 > Limit: 0.500
396.6s 4843 Original dt: 4.114980e-01 s
396.6s 4844 Corrected dt: 2.571863e-01 s
396.6s 4845 Correction factor: 1.6x
396.6s 4846 Max wave speed detected: 19.44 m/s
397.0s 4847 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
397.5s 4848 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
397.6s 4849 [WARNING] Automatic CFL correction applied (count: 27400):
397.6s 4850 Calculated CFL: 0.800 > Limit: 0.500
397.6s 4851 Original dt: 4.114980e-01 s
397.6s 4852 Corrected dt: 2.571863e-01 s
397.6s 4853 Correction factor: 1.6x
397.6s 4854 Max wave speed detected: 19.44 m/s
397.9s 4855 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
398.1s 4856 Stored output at t = 480.0000 s (Step 1869)
398.1s 4857 
398.1s 4858 Simulation finished at t = 480.0000 s after 1869 steps.
398.1s 4859 Total runtime: 2.20 seconds.
398.1s 4860 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.32s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.31s/s]
398.1s 4861 2025-10-10 13:23:58 - INFO - run_control_simulation:384 -   Reward: 0.015200
398.1s 4862 2025-10-10 13:23:58 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
398.1s 4863 2025-10-10 13:23:58 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
398.1s 4864 2025-10-10 13:23:58 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
398.1s 4865 2025-10-10 13:23:58 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
398.1s 4866 2025-10-10 13:23:58 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
398.1s 4867 2025-10-10 13:23:58 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
398.1s 4868 2025-10-10 13:23:58 - INFO - run_control_simulation:418 -   State hash: -1061288204543211807
398.1s 4869 2025-10-10 13:23:58 - INFO - run_control_simulation:420 - ================================================================================
398.1s 4870 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
398.1s 4871 2025-10-10 13:23:58 - INFO - run_control_simulation:368 - ================================================================================
398.1s 4872 2025-10-10 13:23:58 - INFO - run_control_simulation:369 - STEP 8 START:
398.1s 4873 2025-10-10 13:23:58 - INFO - run_control_simulation:370 -   Controller: RLController
398.1s 4874 2025-10-10 13:23:58 - INFO - run_control_simulation:371 -   Action: 0.000000
398.1s 4875 2025-10-10 13:23:58 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
398.1s 4876 Running simulation until t = 540.00 s, outputting every 60.00 s
398.4s 4877 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
398.5s 4878 [WARNING] Automatic CFL correction applied (count: 27500):
398.5s 4879 Calculated CFL: 0.800 > Limit: 0.500
398.5s 4880 Original dt: 4.114980e-01 s
398.5s 4881 Corrected dt: 2.571863e-01 s
398.5s 4882 Correction factor: 1.6x
398.5s 4883 Max wave speed detected: 19.44 m/s
398.9s 4884 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
399.3s 4885 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
399.5s 4886 [WARNING] Automatic CFL correction applied (count: 27600):
399.5s 4887 Calculated CFL: 0.800 > Limit: 0.500
399.5s 4888 Original dt: 4.114980e-01 s
399.5s 4889 Corrected dt: 2.571863e-01 s
399.5s 4890 Correction factor: 1.6x
399.5s 4891 Max wave speed detected: 19.44 m/s
399.8s 4892 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
400.3s 4893 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
400.3s 4894 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 27.37s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 27.37s/s]
400.3s 4895 Stored output at t = 540.0000 s (Step 2103)
400.3s 4896 
400.3s 4897 Simulation finished at t = 540.0000 s after 2103 steps.
400.3s 4898 Total runtime: 2.19 seconds.
400.3s 4899 2025-10-10 13:24:00 - INFO - run_control_simulation:384 -   Reward: 0.015200
400.3s 4900 2025-10-10 13:24:00 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
400.3s 4901 2025-10-10 13:24:00 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
400.3s 4902 2025-10-10 13:24:00 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
400.3s 4903 2025-10-10 13:24:00 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
400.3s 4904 2025-10-10 13:24:00 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
400.3s 4905 2025-10-10 13:24:00 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
400.3s 4906 2025-10-10 13:24:00 - INFO - run_control_simulation:418 -   State hash: -5512530168497891446
400.3s 4907 2025-10-10 13:24:00 - INFO - run_control_simulation:420 - ================================================================================
400.3s 4908 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
400.3s 4909 2025-10-10 13:24:00 - INFO - run_control_simulation:368 - ================================================================================
400.3s 4910 2025-10-10 13:24:00 - INFO - run_control_simulation:369 - STEP 9 START:
400.3s 4911 2025-10-10 13:24:00 - INFO - run_control_simulation:370 -   Controller: RLController
400.3s 4912 2025-10-10 13:24:00 - INFO - run_control_simulation:371 -   Action: 0.000000
400.3s 4913 2025-10-10 13:24:00 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
400.3s 4914 Running simulation until t = 600.00 s, outputting every 60.00 s
400.4s 4915 [WARNING] Automatic CFL correction applied (count: 27700):
400.4s 4916 Calculated CFL: 0.800 > Limit: 0.500
400.4s 4917 Original dt: 4.114980e-01 s
400.4s 4918 Corrected dt: 2.571863e-01 s
400.4s 4919 Correction factor: 1.6x
400.4s 4920 Max wave speed detected: 19.44 m/s
400.8s 4921 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
401.3s 4922 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
401.4s 4923 [WARNING] Automatic CFL correction applied (count: 27800):
401.4s 4924 Calculated CFL: 0.800 > Limit: 0.500
401.4s 4925 Original dt: 4.114980e-01 s
401.4s 4926 Corrected dt: 2.571863e-01 s
401.4s 4927 Correction factor: 1.6x
401.4s 4928 Max wave speed detected: 19.44 m/s
401.7s 4929 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
402.2s 4930 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
402.3s 4931 [WARNING] Automatic CFL correction applied (count: 27900):
402.3s 4932 Calculated CFL: 0.800 > Limit: 0.500
402.3s 4933 Original dt: 4.114980e-01 s
402.3s 4934 Corrected dt: 2.571863e-01 s
402.3s 4935 Correction factor: 1.6x
402.3s 4936 Max wave speed detected: 19.44 m/s
402.5s 4937 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 27.12s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 27.12s/s]
402.5s 4938 Stored output at t = 600.0000 s (Step 2337)
402.5s 4939 
402.5s 4940 Simulation finished at t = 600.0000 s after 2337 steps.
402.5s 4941 Total runtime: 2.21 seconds.
402.5s 4942 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
402.5s 4943 2025-10-10 13:24:02 - INFO - run_control_simulation:384 -   Reward: 0.015200
402.5s 4944 2025-10-10 13:24:02 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
402.5s 4945 2025-10-10 13:24:02 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
402.5s 4946 2025-10-10 13:24:02 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
402.5s 4947 2025-10-10 13:24:02 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
402.5s 4948 2025-10-10 13:24:02 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
402.5s 4949 2025-10-10 13:24:02 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
402.5s 4950 2025-10-10 13:24:02 - INFO - run_control_simulation:418 -   State hash: -2786667868715992229
402.5s 4951 2025-10-10 13:24:02 - INFO - run_control_simulation:420 - ================================================================================
402.5s 4952 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
402.5s 4953 
402.5s 4954 [SIMULATION COMPLETED] Summary:
402.5s 4955 - Total control steps: 10
402.5s 4956 - Total reward: 0.15
402.5s 4957 - Avg step time: 2.235s (device=gpu)
402.5s 4958 - Simulated time: 600.0s / 600.0s
402.5s 4959 - Wallclock time: 22.4s
402.5s 4960 - Speed ratio: 26.85x real-time
402.5s 4961 
402.5s 4962 2025-10-10 13:24:02 - INFO - run_control_simulation:455 -
402.5s 4963 [SIMULATION COMPLETED] Summary:
402.5s 4964 - Total control steps: 10
402.5s 4965 - Total reward: 0.15
402.5s 4966 - Avg step time: 2.235s (device=gpu)
402.5s 4967 - Simulated time: 600.0s / 600.0s
402.5s 4968 - Wallclock time: 22.4s
402.5s 4969 - Speed ratio: 26.85x real-time
402.5s 4970 
402.5s 4971 2025-10-10 13:24:02 - INFO - run_control_simulation:456 - Returning 10 state snapshots
402.5s 4972 2025-10-10 13:24:02 - INFO - run_performance_comparison:762 - RL states copied: 10 snapshots
402.5s 4973 2025-10-10 13:24:02 - INFO - run_performance_comparison:763 - RL FIRST state hash: -8350900293439220016
402.5s 4974 2025-10-10 13:24:02 - INFO - run_performance_comparison:764 - RL LAST state hash: -2786667868715992229
402.5s 4975 2025-10-10 13:24:02 - INFO - run_performance_comparison:765 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
402.5s 4976 2.14351577e-05]
402.5s 4977 2025-10-10 13:24:02 - INFO - run_performance_comparison:766 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
402.5s 4978 2.14319923e-05]
402.5s 4979 2025-10-10 13:24:02 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
402.5s 4980 2025-10-10 13:24:02 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=-8350900293439220016, last=-2786667868715992229
402.5s 4981 2025-10-10 13:24:02 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
402.5s 4982 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
402.5s 4983 2025-10-10 13:24:02 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
402.5s 4984 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
402.5s 4985 2025-10-10 13:24:02 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
402.5s 4986 2025-10-10 13:24:02 - WARNING - run_performance_comparison:774 - States comparison - Identical: False, baseline_hash=-1603931181899818387, rl_hash=-8350900293439220016
402.5s 4987 2025-10-10 13:24:02 - INFO - run_performance_comparison:783 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
402.5s 4988 2025-10-10 13:24:02 - INFO - run_performance_comparison:784 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
402.5s 4989 2025-10-10 13:24:02 - INFO - run_performance_comparison:792 - Flow improvement: 0.000%
402.5s 4990 2025-10-10 13:24:02 - INFO - run_performance_comparison:793 - Efficiency improvement: 0.000%
402.5s 4991 2025-10-10 13:24:02 - INFO - run_performance_comparison:794 - Delay reduction: -0.000%
402.5s 4992 Flow improvement: 0.0%
402.5s 4993 Efficiency improvement: 0.0%
402.5s 4994 Delay reduction: -0.0%
402.5s 4995 Result: FAILED
402.5s 4996 
402.5s 4997 [FIGURES] Generating RL performance figures...
403.1s 4998 [OK] fig_rl_performance_improvements.png
403.7s 4999 [OK] fig_rl_learning_curve.png
403.7s 5000 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
403.7s 5001 
403.7s 5002 [METRICS] Saving RL performance metrics...
403.7s 5003 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
403.7s 5004 
403.7s 5005 [LATEX] Generating content for Section 7.6...
403.7s 5006 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
403.7s 5007 
403.7s 5008 === RL Performance Validation Summary ===
403.7s 5009 Scenarios passed: 0/1 (0.0%)
403.7s 5010 Average flow improvement: 0.00%
403.7s 5011 Average efficiency improvement: 0.00%
403.7s 5012 Average delay reduction: 0.00%
403.7s 5013 Overall validation: FAILED
403.7s 5014 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
406.5s 5015 [WARNING] Tests returned code: 1
406.5s 5016 
406.5s 5017 [STEP 4/4] Copying artifacts and cleaning up...
406.5s 5018 [ARTIFACTS] Copying results for section_7_6_rl_performance...
406.5s 5019 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
406.5s 5020 [ARTIFACTS] NPZ files: 0
406.5s 5021 [ARTIFACTS] PNG figures: 2
406.5s 5022 [ARTIFACTS] YAML scenarios: 1
406.5s 5023 [ARTIFACTS] TEX files: 1
406.5s 5024 [ARTIFACTS] JSON files: 1
406.5s 5025 [ARTIFACTS] CSV metrics: 1
406.5s 5026 TRACKING_SUCCESS: Artifacts copied
406.5s 5027 [SUCCESS] All artifacts organized and copied
406.5s 5028 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
406.6s 5029 [OK] Cleanup completed - only validation results remain
406.6s 5030 TRACKING_SUCCESS: Cleanup completed
406.6s 5031 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
406.6s 5032 TRACKING_SUCCESS: Session summary created
406.6s 5033 
406.6s 5034 [FINAL] Validation workflow completed
406.6s 5035 Remote logging finalized - ready for download
406.6s 5036 
406.6s 5037 ================================================================================
406.6s 5038 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
406.6s 5039 Output ready at: /kaggle/working/validation_results/
406.6s 5040 ================================================================================
410.1s 5041 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
410.1s 5042 warn(
410.2s 5043 [NbConvertApp] Converting notebook __script__.ipynb to html
411.0s 5044 [NbConvertApp] Writing 321270 bytes to __results__.html