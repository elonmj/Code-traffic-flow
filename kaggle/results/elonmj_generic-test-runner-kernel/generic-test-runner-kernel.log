[{"stream_name":"stdout","time":0.504618806,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.504675296,"data":"GENERIC_TEST_TESTS\n"}
,{"stream_name":"stdout","time":0.504681432,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.504686031,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.504794846,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":0.504847651,"data":"Target: arz_model/tests/\n"}
,{"stream_name":"stdout","time":5.103469763,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.103556673,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.1507156179999996,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.171361831,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.17139415,"data":"\n"}
,{"stream_name":"stdout","time":5.17139897,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.171580056,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":6.037774544,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":6.037810146,"data":"\n"}
,{"stream_name":"stdout","time":6.037819793,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":6.037906502,"data":"Installing pytest...\n"}
,{"stream_name":"stdout","time":9.898044561,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":9.898080093,"data":"\n"}
,{"stream_name":"stdout","time":9.898084985,"data":"[STEP 3/4] Running Target...\n"}
,{"stream_name":"stdout","time":9.898088727,"data":"Target is a directory. Executing pytest...\n"}
,{"stream_name":"stdout","time":9.898092683,"data":"Command: /usr/bin/python3 -m pytest -v /kaggle/working/Code-traffic-flow/arz_model/tests\n"}
,{"stream_name":"stdout","time":11.533863004,"data":"============================= test session starts ==============================\n"}
,{"stream_name":"stdout","time":11.533891816,"data":"platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /usr/bin/python3\n"}
,{"stream_name":"stdout","time":11.533897968,"data":"cachedir: .pytest_cache\n"}
,{"stream_name":"stdout","time":11.53390247,"data":"rootdir: /kaggle/working/Code-traffic-flow/arz_model\n"}
,{"stream_name":"stdout","time":11.533906961,"data":"configfile: pytest.ini\n"}
,{"stream_name":"stdout","time":11.533910606,"data":"plugins: anyio-4.11.0, typeguard-4.4.4, langsmith-0.4.8\n"}
,{"stream_name":"stdout","time":16.197046407,"data":"collecting ... collected 21 items\n"}
,{"stream_name":"stdout","time":16.197078313,"data":"\n"}
,{"stream_name":"stdout","time":16.329925156,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_state_initialization_full_array PASSED [  4%]\n"}
,{"stream_name":"stdout","time":16.33473773,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_state_initialization_physical_only PASSED [  9%]\n"}
,{"stream_name":"stdout","time":16.337526937,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_invalid_initialization PASSED [ 14%]\n"}
,{"stream_name":"stdout","time":16.339772421,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_segment_state_access PASSED [ 19%]\n"}
,{"stream_name":"stdout","time":16.342221174,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_road_quality_access PASSED [ 23%]\n"}
,{"stream_name":"stdout","time":16.345355711,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_stream_access PASSED [ 28%]\n"}
,{"stream_name":"stdout","time":16.348175805,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_synchronous_checkpoint PASSED [ 33%]\n"}
,{"stream_name":"stdout","time":16.352018506,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_asynchronous_checkpoint PASSED [ 38%]\n"}
,{"stream_name":"stdout","time":16.355917413,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_checkpoint_invalid_segment PASSED [ 42%]\n"}
,{"stream_name":"stdout","time":16.358281174,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolStreams::test_stream_synchronization PASSED [ 47%]\n"}
,{"stream_name":"stdout","time":16.360418825,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolStreams::test_no_streams_synchronization PASSED [ 52%]\n"}
,{"stream_name":"stdout","time":16.362480143,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolMonitoring::test_memory_statistics PASSED [ 57%]\n"}
,{"stream_name":"stdout","time":16.364637028,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolMonitoring::test_string_representation PASSED [ 61%]\n"}
,{"stream_name":"stdout","time":16.366773924,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCleanup::test_explicit_cleanup PASSED [ 66%]\n"}
,{"stream_name":"stdout","time":16.368913916,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCleanup::test_destructor_cleanup PASSED [ 71%]\n"}
,{"stream_name":"stdout","time":16.3730861,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolIntegration::test_multi_segment_workflow PASSED [ 76%]\n"}
,{"stream_name":"stdout","time":16.376225016,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolIntegration::test_memory_persistence PASSED [ 80%]\n"}
,{"stream_name":"stdout","time":19.760824753,"data":"arz_model/tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu FAILED [ 85%]\n"}
,{"stream_name":"stdout","time":19.76180084,"data":"arz_model/tests/test_gpu_only_integration.py::test_gpu_required_error SKIPPED [ 90%]\n"}
,{"stream_name":"stdout","time":19.805621652,"data":"arz_model/tests/test_gpu_only_integration.py::test_no_cpu_transfers_in_loop FAILED [ 95%]\n"}
,{"stream_name":"stdout","time":19.848380306,"data":"arz_model/tests/test_gpu_only_integration.py::test_mass_conservation_gpu FAILED [100%]\n"}
,{"stream_name":"stdout","time":19.848397516,"data":"\n"}
,{"stream_name":"stdout","time":19.848400823,"data":"=================================== FAILURES ===================================\n"}
,{"stream_name":"stdout","time":19.848404407,"data":"____________________ test_simulation_runs_end_to_end_on_gpu ____________________\n"}
,{"stream_name":"stdout","time":19.848408468,"data":"\n"}
,{"stream_name":"stdout","time":19.848412767,"data":"    def test_simulation_runs_end_to_end_on_gpu():\n"}
,{"stream_name":"stdout","time":19.848417331,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848421713,"data":"        Tests that a simple simulation can run from start to finish on the GPU.\n"}
,{"stream_name":"stdout","time":19.848426391,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848430634,"data":"        print(\"Running test: test_simulation_runs_end_to_end_on_gpu\")\n"}
,{"stream_name":"stdout","time":19.84843492,"data":"        try:\n"}
,{"stream_name":"stdout","time":19.848457554,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":19.848473583,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":19.848477317,"data":"            runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":19.848481399,"data":"\u003e           results = runner.run()\n"}
,{"stream_name":"stdout","time":19.848485046,"data":"                      ^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":19.848487526,"data":"\n"}
,{"stream_name":"stdout","time":19.848489806,"data":"arz_model/tests/test_gpu_only_integration.py:89: \n"}
,{"stream_name":"stdout","time":19.848492219,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":19.848494662,"data":"arz_model/simulation/runner.py:745: in run\n"}
,{"stream_name":"stdout","time":19.848497101,"data":"    return self.network_simulator.run(t_final=sim_t_final)\n"}
,{"stream_name":"stdout","time":19.848499852,"data":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":19.848502426,"data":"arz_model/simulation/execution/network_simulator.py:185: in run\n"}
,{"stream_name":"stdout","time":19.848504859,"data":"    self.network_coupling.apply_coupling(self.config.physics)\n"}
,{"stream_name":"stdout","time":19.848507356,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":19.848509818,"data":"\n"}
,{"stream_name":"stdout","time":19.848512144,"data":"self = \u003carz_model.numerics.gpu.network_coupling_gpu.NetworkCouplingGPU object at 0x7d862dcca410\u003e\n"}
,{"stream_name":"stdout","time":19.84851478,"data":"params = PhysicsConfig(alpha=0.6, v_max_c=120.0 km/h, v_max_m=100.0 km/h, tau_c=1.5s, tau_m=1.0s)\n"}
,{"stream_name":"stdout","time":19.848517379,"data":"\n"}
,{"stream_name":"stdout","time":19.848519649,"data":"    def apply_coupling(self, params: PhysicsConfig):\n"}
,{"stream_name":"stdout","time":19.848522073,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848524456,"data":"        Executes the network coupling kernel on the GPU.\n"}
,{"stream_name":"stdout","time":19.848526933,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848529296,"data":"        if self.num_nodes == 0:\n"}
,{"stream_name":"stdout","time":19.848531675,"data":"            return\n"}
,{"stream_name":"stdout","time":19.848534019,"data":"    \n"}
,{"stream_name":"stdout","time":19.848536428,"data":"        # Get the pool of all segment device arrays\n"}
,{"stream_name":"stdout","time":19.848538895,"data":"\u003e       d_all_segments_pool = self.gpu_pool.get_all_segment_states_list()\n"}
,{"stream_name":"stdout","time":19.848541398,"data":"                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":19.848543911,"data":"E       AttributeError: 'GPUMemoryPool' object has no attribute 'get_all_segment_states_list'\n"}
,{"stream_name":"stdout","time":19.848546476,"data":"\n"}
,{"stream_name":"stdout","time":19.848548756,"data":"arz_model/numerics/gpu/network_coupling_gpu.py:127: AttributeError\n"}
,{"stream_name":"stdout","time":19.848551191,"data":"\n"}
,{"stream_name":"stdout","time":19.848553464,"data":"During handling of the above exception, another exception occurred:\n"}
,{"stream_name":"stdout","time":19.848555903,"data":"\n"}
,{"stream_name":"stdout","time":19.848558207,"data":"    def test_simulation_runs_end_to_end_on_gpu():\n"}
,{"stream_name":"stdout","time":19.848561396,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848567218,"data":"        Tests that a simple simulation can run from start to finish on the GPU.\n"}
,{"stream_name":"stdout","time":19.848569926,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848572269,"data":"        print(\"Running test: test_simulation_runs_end_to_end_on_gpu\")\n"}
,{"stream_name":"stdout","time":19.848574798,"data":"        try:\n"}
,{"stream_name":"stdout","time":19.848577166,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":19.848579579,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":19.848582029,"data":"            runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":19.848584528,"data":"            results = runner.run()\n"}
,{"stream_name":"stdout","time":19.848586946,"data":"    \n"}
,{"stream_name":"stdout","time":19.848589252,"data":"            # Verify results structure\n"}
,{"stream_name":"stdout","time":19.848591628,"data":"            assert \"final_time\" in results\n"}
,{"stream_name":"stdout","time":19.848594121,"data":"            assert \"total_steps\" in results\n"}
,{"stream_name":"stdout","time":19.848596561,"data":"            assert \"final_states\" in results\n"}
,{"stream_name":"stdout","time":19.848599013,"data":"            assert \"seg-1\" in results[\"final_states\"]\n"}
,{"stream_name":"stdout","time":19.848601528,"data":"            assert \"seg-2\" in results[\"final_states\"]\n"}
,{"stream_name":"stdout","time":19.848604004,"data":"    \n"}
,{"stream_name":"stdout","time":19.848606329,"data":"            # Verify state array shape\n"}
,{"stream_name":"stdout","time":19.848608698,"data":"            final_state_seg1 = results[\"final_states\"][\"seg-1\"]\n"}
,{"stream_name":"stdout","time":19.848611286,"data":"            expected_shape = (4, config.segments[0].N + 2 * config.grid.num_ghost_cells)\n"}
,{"stream_name":"stdout","time":19.848613801,"data":"            assert final_state_seg1.shape == expected_shape, f\"Expected shape {expected_shape}, but got {final_state_seg1.shape}\"\n"}
,{"stream_name":"stdout","time":19.848616402,"data":"    \n"}
,{"stream_name":"stdout","time":19.848618704,"data":"            print(\"✅ Test passed. Simulation ran end-to-end and produced valid results.\")\n"}
,{"stream_name":"stdout","time":19.848622078,"data":"        except Exception as e:\n"}
,{"stream_name":"stdout","time":19.848624538,"data":"\u003e           pytest.fail(f\"End-to-end GPU simulation test failed with an exception: {e}\", pytrace=True)\n"}
,{"stream_name":"stdout","time":19.848627194,"data":"E           Failed: End-to-end GPU simulation test failed with an exception: 'GPUMemoryPool' object has no attribute 'get_all_segment_states_list'\n"}
,{"stream_name":"stdout","time":19.848629809,"data":"\n"}
,{"stream_name":"stdout","time":19.848632114,"data":"arz_model/tests/test_gpu_only_integration.py:105: Failed\n"}
,{"stream_name":"stdout","time":19.848634629,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":19.848637086,"data":"Running test: test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":19.848639505,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":19.848641922,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":19.848644348,"data":"✅ GPUMemoryPool initialized:\n"}
,{"stream_name":"stdout","time":19.848646761,"data":"   - Segments: 2\n"}
,{"stream_name":"stdout","time":19.848651863,"data":"   - Total cells: 150\n"}
,{"stream_name":"stdout","time":19.848654352,"data":"   - Ghost cells: 3\n"}
,{"stream_name":"stdout","time":19.848656708,"data":"   - Compute Capability: (6, 0)\n"}
,{"stream_name":"stdout","time":19.848659089999998,"data":"   - CUDA streams: Enabled\n"}
,{"stream_name":"stdout","time":19.848661448,"data":"   - GPU memory allocated: 0.00 MB\n"}
,{"stream_name":"stdout","time":19.848663894,"data":"  - Preparing GPU topology for network coupling...\n"}
,{"stream_name":"stdout","time":19.848666334,"data":"    - GPU topology prepared and transferred.\n"}
,{"stream_name":"stdout","time":19.848669037,"data":"________________________ test_no_cpu_transfers_in_loop _________________________\n"}
,{"stream_name":"stdout","time":19.848671558,"data":"\n"}
,{"stream_name":"stdout","time":19.848673866,"data":"    def test_no_cpu_transfers_in_loop():\n"}
,{"stream_name":"stdout","time":19.848676291,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848678685,"data":"        Hooks into CUDA transfer functions to verify that no transfers occur\n"}
,{"stream_name":"stdout","time":19.848681151,"data":"        during the main simulation loop.\n"}
,{"stream_name":"stdout","time":19.848683552,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848685929,"data":"        print(\"Running test: test_no_cpu_transfers_in_loop\")\n"}
,{"stream_name":"stdout","time":19.848688429,"data":"    \n"}
,{"stream_name":"stdout","time":19.84869072,"data":"        transfer_log = []\n"}
,{"stream_name":"stdout","time":19.848693089,"data":"        original_to_device = cuda.to_device\n"}
,{"stream_name":"stdout","time":19.848695491,"data":"        original_copy_to_host = cuda.devicearray.DeviceNDArray.copy_to_host\n"}
,{"stream_name":"stdout","time":19.848697968,"data":"    \n"}
,{"stream_name":"stdout","time":19.848700296,"data":"        def tracked_to_device(obj, *args, **kwargs):\n"}
,{"stream_name":"stdout","time":19.848702711,"data":"            transfer_log.append(f\"to_device: {type(obj)}\")\n"}
,{"stream_name":"stdout","time":19.848705184,"data":"            return original_to_device(obj, *args, **kwargs)\n"}
,{"stream_name":"stdout","time":19.848707626,"data":"    \n"}
,{"stream_name":"stdout","time":19.848709924,"data":"        def tracked_copy_to_host(self, *args, **kwargs):\n"}
,{"stream_name":"stdout","time":19.848712336,"data":"            transfer_log.append(f\"copy_to_host: shape={self.shape}\")\n"}
,{"stream_name":"stdout","time":19.848714839,"data":"            return original_copy_to_host(self, *args, **kwargs)\n"}
,{"stream_name":"stdout","time":19.848717273,"data":"    \n"}
,{"stream_name":"stdout","time":19.848719598,"data":"        try:\n"}
,{"stream_name":"stdout","time":19.848721957,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":19.848724465,"data":"    \n"}
,{"stream_name":"stdout","time":19.848726763,"data":"            cuda.to_device = tracked_to_device\n"}
,{"stream_name":"stdout","time":19.848729164,"data":"            cuda.devicearray.DeviceNDArray.copy_to_host = tracked_copy_to_host\n"}
,{"stream_name":"stdout","time":19.848731639,"data":"    \n"}
,{"stream_name":"stdout","time":19.848733933,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":19.848736374,"data":"            runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":19.848738874,"data":"    \n"}
,{"stream_name":"stdout","time":19.848741204,"data":"            # Test 1: Check transfers during the main `run()` method\n"}
,{"stream_name":"stdout","time":19.848746659,"data":"            transfer_log.clear()\n"}
,{"stream_name":"stdout","time":19.848749253,"data":"\u003e           runner.run()\n"}
,{"stream_name":"stdout","time":19.848751659,"data":"\n"}
,{"stream_name":"stdout","time":19.848753934,"data":"arz_model/tests/test_gpu_only_integration.py:152: \n"}
,{"stream_name":"stdout","time":19.848756341,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":19.848758797,"data":"arz_model/simulation/runner.py:745: in run\n"}
,{"stream_name":"stdout","time":19.848761184,"data":"    return self.network_simulator.run(t_final=sim_t_final)\n"}
,{"stream_name":"stdout","time":19.848763601,"data":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":19.848766013,"data":"arz_model/simulation/execution/network_simulator.py:185: in run\n"}
,{"stream_name":"stdout","time":19.848768456,"data":"    self.network_coupling.apply_coupling(self.config.physics)\n"}
,{"stream_name":"stdout","time":19.848770887,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":19.848773344,"data":"\n"}
,{"stream_name":"stdout","time":19.848775674,"data":"self = \u003carz_model.numerics.gpu.network_coupling_gpu.NetworkCouplingGPU object at 0x7d86264b6410\u003e\n"}
,{"stream_name":"stdout","time":19.848778305,"data":"params = PhysicsConfig(alpha=0.6, v_max_c=120.0 km/h, v_max_m=100.0 km/h, tau_c=1.5s, tau_m=1.0s)\n"}
,{"stream_name":"stdout","time":19.848780799,"data":"\n"}
,{"stream_name":"stdout","time":19.848783076,"data":"    def apply_coupling(self, params: PhysicsConfig):\n"}
,{"stream_name":"stdout","time":19.848785504,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848788282,"data":"        Executes the network coupling kernel on the GPU.\n"}
,{"stream_name":"stdout","time":19.848790744,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848793079,"data":"        if self.num_nodes == 0:\n"}
,{"stream_name":"stdout","time":19.848795459,"data":"            return\n"}
,{"stream_name":"stdout","time":19.848797808,"data":"    \n"}
,{"stream_name":"stdout","time":19.848800128,"data":"        # Get the pool of all segment device arrays\n"}
,{"stream_name":"stdout","time":19.84880258,"data":"\u003e       d_all_segments_pool = self.gpu_pool.get_all_segment_states_list()\n"}
,{"stream_name":"stdout","time":19.848805086,"data":"                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":19.848807581,"data":"E       AttributeError: 'GPUMemoryPool' object has no attribute 'get_all_segment_states_list'\n"}
,{"stream_name":"stdout","time":19.848810071,"data":"\n"}
,{"stream_name":"stdout","time":19.84881242,"data":"arz_model/numerics/gpu/network_coupling_gpu.py:127: AttributeError\n"}
,{"stream_name":"stdout","time":19.848814868,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":19.84881735,"data":"Running test: test_no_cpu_transfers_in_loop\n"}
,{"stream_name":"stdout","time":19.848819774,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":19.848822226,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":19.848827223,"data":"✅ GPUMemoryPool initialized:\n"}
,{"stream_name":"stdout","time":19.848829719,"data":"   - Segments: 2\n"}
,{"stream_name":"stdout","time":19.848834653,"data":"   - Total cells: 150\n"}
,{"stream_name":"stdout","time":19.848837134,"data":"   - Ghost cells: 3\n"}
,{"stream_name":"stdout","time":19.848839467,"data":"   - Compute Capability: (6, 0)\n"}
,{"stream_name":"stdout","time":19.848841829,"data":"   - CUDA streams: Enabled\n"}
,{"stream_name":"stdout","time":19.848844203,"data":"   - GPU memory allocated: 0.00 MB\n"}
,{"stream_name":"stdout","time":19.848846594,"data":"  - Preparing GPU topology for network coupling...\n"}
,{"stream_name":"stdout","time":19.848849004,"data":"    - GPU topology prepared and transferred.\n"}
,{"stream_name":"stdout","time":19.848851433,"data":"__________________________ test_mass_conservation_gpu __________________________\n"}
,{"stream_name":"stdout","time":19.848853883,"data":"\n"}
,{"stream_name":"stdout","time":19.848856178,"data":"    def test_mass_conservation_gpu():\n"}
,{"stream_name":"stdout","time":19.848858562,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848869278,"data":"        Verifies that the total mass (rho) in the system is conserved on the GPU\n"}
,{"stream_name":"stdout","time":19.848871941,"data":"        when using reflective boundary conditions.\n"}
,{"stream_name":"stdout","time":19.848874366,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":19.848876699,"data":"        print(\"Running test: test_mass_conservation_gpu\")\n"}
,{"stream_name":"stdout","time":19.848879209,"data":"    \n"}
,{"stream_name":"stdout","time":19.848881573,"data":"        config = create_test_config()\n"}
,{"stream_name":"stdout","time":19.84888396,"data":"        # Use reflective \"wall\" boundary conditions to ensure mass is conserved\n"}
,{"stream_name":"stdout","time":19.848886518,"data":"        config.segments[0].boundary_conditions.left = ReflectiveBC()\n"}
,{"stream_name":"stdout","time":19.84888898,"data":"        config.segments[1].boundary_conditions.right = ReflectiveBC()\n"}
,{"stream_name":"stdout","time":19.848891529,"data":"    \n"}
,{"stream_name":"stdout","time":19.848893817,"data":"        network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":19.848896241,"data":"    \n"}
,{"stream_name":"stdout","time":19.848898539,"data":"        # Calculate initial mass from the config\n"}
,{"stream_name":"stdout","time":19.848901017,"data":"        initial_mass = 0.0\n"}
,{"stream_name":"stdout","time":19.848903391,"data":"        for seg_config in config.segments:\n"}
,{"stream_name":"stdout","time":19.84890588,"data":"            segment = network_grid.segments[seg_config.id]\n"}
,{"stream_name":"stdout","time":19.84890829,"data":"            ic_config = seg_config.initial_conditions.config\n"}
,{"stream_name":"stdout","time":19.848910756,"data":"            if isinstance(ic_config, UniformIC):\n"}
,{"stream_name":"stdout","time":19.84891314,"data":"                # Mass = density * length\n"}
,{"stream_name":"stdout","time":19.848915574,"data":"                initial_mass += ic_config.density * (segment['grid'].xmax - segment['grid'].xmin)\n"}
,{"stream_name":"stdout","time":19.848918093,"data":"    \n"}
,{"stream_name":"stdout","time":20.299743374,"data":"        runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":20.299777266,"data":"\u003e       results = runner.run()\n"}
,{"stream_name":"stdout","time":20.299783298,"data":"                  ^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":20.299787505,"data":"\n"}
,{"stream_name":"stdout","time":20.299791674,"data":"arz_model/tests/test_gpu_only_integration.py:196: \n"}
,{"stream_name":"stdout","time":20.299815331,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":20.299819883,"data":"arz_model/simulation/runner.py:745: in run\n"}
,{"stream_name":"stdout","time":20.299823606,"data":"    return self.network_simulator.run(t_final=sim_t_final)\n"}
,{"stream_name":"stdout","time":20.299827414,"data":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":20.299831638,"data":"arz_model/simulation/execution/network_simulator.py:185: in run\n"}
,{"stream_name":"stdout","time":20.299836293,"data":"    self.network_coupling.apply_coupling(self.config.physics)\n"}
,{"stream_name":"stdout","time":20.299840496,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":20.299845605,"data":"\n"}
,{"stream_name":"stdout","time":20.299849887,"data":"self = \u003carz_model.numerics.gpu.network_coupling_gpu.NetworkCouplingGPU object at 0x7d86119c4210\u003e\n"}
,{"stream_name":"stdout","time":20.299854082,"data":"params = PhysicsConfig(alpha=0.6, v_max_c=120.0 km/h, v_max_m=100.0 km/h, tau_c=1.5s, tau_m=1.0s)\n"}
,{"stream_name":"stdout","time":20.299864383,"data":"\n"}
,{"stream_name":"stdout","time":20.299867897,"data":"    def apply_coupling(self, params: PhysicsConfig):\n"}
,{"stream_name":"stdout","time":20.299871566,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":20.299875276,"data":"        Executes the network coupling kernel on the GPU.\n"}
,{"stream_name":"stdout","time":20.299878636,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":20.299881045,"data":"        if self.num_nodes == 0:\n"}
,{"stream_name":"stdout","time":20.299883496,"data":"            return\n"}
,{"stream_name":"stdout","time":20.299885871,"data":"    \n"}
,{"stream_name":"stdout","time":20.299888214,"data":"        # Get the pool of all segment device arrays\n"}
,{"stream_name":"stdout","time":20.299890676,"data":"\u003e       d_all_segments_pool = self.gpu_pool.get_all_segment_states_list()\n"}
,{"stream_name":"stdout","time":20.299893362,"data":"                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":20.299896251,"data":"E       AttributeError: 'GPUMemoryPool' object has no attribute 'get_all_segment_states_list'\n"}
,{"stream_name":"stdout","time":20.299898766,"data":"\n"}
,{"stream_name":"stdout","time":20.299901065,"data":"arz_model/numerics/gpu/network_coupling_gpu.py:127: AttributeError\n"}
,{"stream_name":"stdout","time":20.299903549,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":20.299906033,"data":"Running test: test_mass_conservation_gpu\n"}
,{"stream_name":"stdout","time":20.299908419,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":20.299910838,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":20.299915011,"data":"✅ GPUMemoryPool initialized:\n"}
,{"stream_name":"stdout","time":20.299919179,"data":"   - Segments: 2\n"}
,{"stream_name":"stdout","time":20.299922781,"data":"   - Total cells: 150\n"}
,{"stream_name":"stdout","time":20.29992749,"data":"   - Ghost cells: 3\n"}
,{"stream_name":"stdout","time":20.299931758,"data":"   - Compute Capability: (6, 0)\n"}
,{"stream_name":"stdout","time":20.299936218,"data":"   - CUDA streams: Enabled\n"}
,{"stream_name":"stdout","time":20.299940492,"data":"   - GPU memory allocated: 0.00 MB\n"}
,{"stream_name":"stdout","time":20.299949508,"data":"  - Preparing GPU topology for network coupling...\n"}
,{"stream_name":"stdout","time":20.299953303,"data":"    - GPU topology prepared and transferred.\n"}
,{"stream_name":"stdout","time":20.299956926,"data":"=============================== warnings summary ===============================\n"}
,{"stream_name":"stdout","time":20.299960606,"data":"tests/test_gpu_only_integration.py: 10 warnings\n"}
,{"stream_name":"stdout","time":20.299966099,"data":"  /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stdout","time":20.29997177,"data":"    warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":20.299975419,"data":"\n"}
,{"stream_name":"stdout","time":20.299978904,"data":"tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":20.299982554,"data":"tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":20.299986346,"data":"tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":20.299989753,"data":"  /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 7 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stdout","time":20.299992639,"data":"    warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":20.299995034,"data":"\n"}
,{"stream_name":"stdout","time":20.299997308000002,"data":"tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":20.299999781,"data":"  /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 4 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stdout","time":20.300002584,"data":"    warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":20.300004948,"data":"\n"}
,{"stream_name":"stdout","time":20.30000766,"data":"-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n"}
,{"stream_name":"stdout","time":20.300011544,"data":"=========================== short test summary info ============================\n"}
,{"stream_name":"stdout","time":20.300015788,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":20.300020569,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_no_cpu_transfers_in_loop\n"}
,{"stream_name":"stdout","time":20.300025084,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_mass_conservation_gpu\n"}
,{"stream_name":"stdout","time":20.300029951,"data":"============= 3 failed, 17 passed, 1 skipped, 14 warnings in 8.32s =============\n"}
,{"stream_name":"stdout","time":20.926944154,"data":"[WARNING] Target execution returned code: 1\n"}
,{"stream_name":"stdout","time":20.927093909,"data":"\n"}
,{"stream_name":"stdout","time":20.927102071,"data":"[STEP 4/4] Cleanup...\n"}
,{"stream_name":"stdout","time":20.927164655,"data":"Cleaning up cloned repository at /kaggle/working/Code-traffic-flow...\n"}
,{"stream_name":"stdout","time":20.93666862,"data":"[OK] Repository cleaned up.\n"}
,{"stream_name":"stdout","time":20.936691094,"data":"\n"}
,{"stream_name":"stdout","time":20.936697011,"data":"[FINAL] Test workflow completed\n"}
,{"stream_name":"stdout","time":20.936824807,"data":"\n"}
,{"stream_name":"stdout","time":20.936844364,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":20.936848727,"data":"EXECUTION COMPLETED\n"}
,{"stream_name":"stdout","time":20.936852486,"data":"Check /kaggle/working/test_log.txt for details.\n"}
,{"stream_name":"stdout","time":20.936856189,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":24.671538676,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":24.671584071,"data":"  warn(\n"}
,{"stream_name":"stderr","time":24.710891765,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":25.808229668,"data":"[NbConvertApp] Writing 298633 bytes to __results__.html\n"}
]