[{"stream_name":"stdout","time":0.533969885,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.534045388,"data":"GENERIC_TEST_TESTS\n"}
,{"stream_name":"stdout","time":0.5340517,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.534056507,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.534062571,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":0.534092022,"data":"Target: arz_model/tests/\n"}
,{"stream_name":"stdout","time":6.332542595,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":6.332698467,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":6.383663846,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":6.405765634,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":6.405817049,"data":"\n"}
,{"stream_name":"stdout","time":6.40582701,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":6.405974167,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":7.075453969,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":7.07552198,"data":"\n"}
,{"stream_name":"stdout","time":7.075529046,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":7.075630216,"data":"Installing pytest...\n"}
,{"stream_name":"stdout","time":11.317462295,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":11.317500594,"data":"\n"}
,{"stream_name":"stdout","time":11.317506123,"data":"[STEP 3/4] Running Target...\n"}
,{"stream_name":"stdout","time":11.317510397,"data":"Target is a directory. Executing pytest...\n"}
,{"stream_name":"stdout","time":11.317514566,"data":"Command: /usr/bin/python3 -m pytest -v /kaggle/working/Code-traffic-flow/arz_model/tests\n"}
,{"stream_name":"stdout","time":13.095522357,"data":"============================= test session starts ==============================\n"}
,{"stream_name":"stdout","time":13.095559523,"data":"platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /usr/bin/python3\n"}
,{"stream_name":"stdout","time":13.09556412,"data":"cachedir: .pytest_cache\n"}
,{"stream_name":"stdout","time":13.095566973,"data":"rootdir: /kaggle/working/Code-traffic-flow/arz_model\n"}
,{"stream_name":"stdout","time":13.09556985,"data":"configfile: pytest.ini\n"}
,{"stream_name":"stdout","time":13.095572325,"data":"plugins: anyio-4.11.0, typeguard-4.4.4, langsmith-0.4.8\n"}
,{"stream_name":"stdout","time":20.552704489,"data":"collecting ... collected 21 items\n"}
,{"stream_name":"stdout","time":20.552738484,"data":"\n"}
,{"stream_name":"stdout","time":21.326250405,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_state_initialization_full_array PASSED [  4%]\n"}
,{"stream_name":"stdout","time":21.331973034,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_state_initialization_physical_only PASSED [  9%]\n"}
,{"stream_name":"stdout","time":21.334762229,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolInitialization::test_invalid_initialization PASSED [ 14%]\n"}
,{"stream_name":"stdout","time":21.337163942,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_segment_state_access PASSED [ 19%]\n"}
,{"stream_name":"stdout","time":21.45016887,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_road_quality_access FAILED [ 23%]\n"}
,{"stream_name":"stdout","time":21.458651265,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_stream_access FAILED [ 28%]\n"}
,{"stream_name":"stdout","time":21.461931157,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_synchronous_checkpoint PASSED [ 33%]\n"}
,{"stream_name":"stdout","time":21.465105871,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_asynchronous_checkpoint PASSED [ 38%]\n"}
,{"stream_name":"stdout","time":21.467696038,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCheckpointing::test_checkpoint_invalid_segment PASSED [ 42%]\n"}
,{"stream_name":"stdout","time":21.470136774,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolStreams::test_stream_synchronization PASSED [ 47%]\n"}
,{"stream_name":"stdout","time":21.472553264,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolStreams::test_no_streams_synchronization PASSED [ 52%]\n"}
,{"stream_name":"stdout","time":21.474826708,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolMonitoring::test_memory_statistics PASSED [ 57%]\n"}
,{"stream_name":"stdout","time":21.477108597,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolMonitoring::test_string_representation PASSED [ 61%]\n"}
,{"stream_name":"stdout","time":21.479495645,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCleanup::test_explicit_cleanup PASSED [ 66%]\n"}
,{"stream_name":"stdout","time":21.481709559,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolCleanup::test_destructor_cleanup PASSED [ 71%]\n"}
,{"stream_name":"stdout","time":21.486375387,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolIntegration::test_multi_segment_workflow PASSED [ 76%]\n"}
,{"stream_name":"stdout","time":21.489819479,"data":"arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolIntegration::test_memory_persistence PASSED [ 80%]\n"}
,{"stream_name":"stdout","time":21.540418459,"data":"arz_model/tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu FAILED [ 85%]\n"}
,{"stream_name":"stdout","time":21.541546272,"data":"arz_model/tests/test_gpu_only_integration.py::test_gpu_required_error SKIPPED [ 90%]\n"}
,{"stream_name":"stdout","time":21.666731068,"data":"arz_model/tests/test_gpu_only_integration.py::test_no_cpu_transfers_in_loop FAILED [ 95%]\n"}
,{"stream_name":"stdout","time":21.714225793,"data":"arz_model/tests/test_gpu_only_integration.py::test_mass_conservation_gpu FAILED [100%]\n"}
,{"stream_name":"stdout","time":21.714253565,"data":"\n"}
,{"stream_name":"stdout","time":21.714259763,"data":"=================================== FAILURES ===================================\n"}
,{"stream_name":"stdout","time":21.7142631,"data":"_______________ TestGPUMemoryPoolAccess.test_road_quality_access _______________\n"}
,{"stream_name":"stdout","time":21.714266083,"data":"\n"}
,{"stream_name":"stdout","time":21.714268607,"data":"self = \u003ctest_gpu_memory_pool.TestGPUMemoryPoolAccess object at 0x7e33d54fe110\u003e\n"}
,{"stream_name":"stdout","time":21.714271662,"data":"simple_config = {'N_per_segment': {'seg1': 100, 'seg2': 50}, 'ghost_cells': 3, 'segment_ids': ['seg1', 'seg2']}\n"}
,{"stream_name":"stdout","time":21.714274346,"data":"\n"}
,{"stream_name":"stdout","time":21.714276685,"data":"    def test_road_quality_access(self, simple_config):\n"}
,{"stream_name":"stdout","time":21.714279193,"data":"        \"\"\"Test access to road quality arrays.\"\"\"\n"}
,{"stream_name":"stdout","time":21.714281797,"data":"        pool = GPUMemoryPool(**simple_config)\n"}
,{"stream_name":"stdout","time":21.714291871,"data":"    \n"}
,{"stream_name":"stdout","time":21.714294433,"data":"        # Test valid access\n"}
,{"stream_name":"stdout","time":21.71429696,"data":"        for seg_id in simple_config['segment_ids']:\n"}
,{"stream_name":"stdout","time":21.714299398,"data":"            d_R = pool.get_road_quality_array(seg_id)\n"}
,{"stream_name":"stdout","time":21.714301836,"data":"            assert d_R is not None\n"}
,{"stream_name":"stdout","time":21.714304252,"data":"            assert isinstance(d_R, cuda.devicearray.DeviceNDArray)\n"}
,{"stream_name":"stdout","time":21.714306829,"data":"    \n"}
,{"stream_name":"stdout","time":21.714309185,"data":"            N_phys = simple_config['N_per_segment'][seg_id]\n"}
,{"stream_name":"stdout","time":21.714311648,"data":"            N_total = N_phys + 2 * simple_config['ghost_cells']\n"}
,{"stream_name":"stdout","time":21.714314138,"data":"            assert d_R.shape == (N_total,)\n"}
,{"stream_name":"stdout","time":21.714316644,"data":"    \n"}
,{"stream_name":"stdout","time":21.714319003,"data":"        # Test invalid access\n"}
,{"stream_name":"stdout","time":21.714321413,"data":"        with pytest.raises(KeyError, match=\"not found\"):\n"}
,{"stream_name":"stdout","time":21.714323943,"data":"\u003e           pool.get_road_quality('invalid_seg')\n"}
,{"stream_name":"stdout","time":21.714326538999998,"data":"            ^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":21.714328984,"data":"E           AttributeError: 'GPUMemoryPool' object has no attribute 'get_road_quality'\n"}
,{"stream_name":"stdout","time":21.714331539,"data":"\n"}
,{"stream_name":"stdout","time":21.714334475,"data":"arz_model/tests/test_gpu_memory_pool.py:155: AttributeError\n"}
,{"stream_name":"stdout","time":21.714336986,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":21.714339492,"data":"✅ GPUMemoryPool initialized:\n"}
,{"stream_name":"stdout","time":21.714342533,"data":"   - Segments: 2\n"}
,{"stream_name":"stdout","time":21.714344978,"data":"   - Total cells: 150\n"}
,{"stream_name":"stdout","time":21.714347398,"data":"   - Ghost cells: 3\n"}
,{"stream_name":"stdout","time":21.714349776,"data":"   - Compute Capability: (6, 0)\n"}
,{"stream_name":"stdout","time":21.714352178,"data":"   - CUDA streams: Enabled\n"}
,{"stream_name":"stdout","time":21.714354616,"data":"   - GPU memory allocated: 0.00 MB\n"}
,{"stream_name":"stdout","time":21.714357077,"data":"__________________ TestGPUMemoryPoolAccess.test_stream_access __________________\n"}
,{"stream_name":"stdout","time":21.714359657,"data":"\n"}
,{"stream_name":"stdout","time":21.714362009,"data":"self = \u003ctest_gpu_memory_pool.TestGPUMemoryPoolAccess object at 0x7e33d54fe750\u003e\n"}
,{"stream_name":"stdout","time":21.714364634,"data":"simple_config = {'N_per_segment': {'seg1': 100, 'seg2': 50}, 'ghost_cells': 3, 'segment_ids': ['seg1', 'seg2']}\n"}
,{"stream_name":"stdout","time":21.714367186,"data":"\n"}
,{"stream_name":"stdout","time":21.714369519,"data":"    def test_stream_access(self, simple_config):\n"}
,{"stream_name":"stdout","time":21.714372027,"data":"        \"\"\"Test CUDA stream access.\"\"\"\n"}
,{"stream_name":"stdout","time":21.714374573,"data":"        # Test with streams enabled\n"}
,{"stream_name":"stdout","time":21.714377072,"data":"        pool = GPUMemoryPool(**simple_config, compute_capability=(6,0))\n"}
,{"stream_name":"stdout","time":21.714379615,"data":"    \n"}
,{"stream_name":"stdout","time":21.714385162,"data":"        for seg_id in simple_config['segment_ids']:\n"}
,{"stream_name":"stdout","time":21.714388456000002,"data":"            stream = pool.get_stream(seg_id)\n"}
,{"stream_name":"stdout","time":21.714390976,"data":"\u003e           assert isinstance(stream, cuda.Stream)\n"}
,{"stream_name":"stdout","time":21.714393439,"data":"                                      ^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":21.714395878,"data":"E           AttributeError: module 'numba.cuda' has no attribute 'Stream'\n"}
,{"stream_name":"stdout","time":21.714398397,"data":"\n"}
,{"stream_name":"stdout","time":21.714400699,"data":"arz_model/tests/test_gpu_memory_pool.py:166: AttributeError\n"}
,{"stream_name":"stdout","time":21.714403139,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":21.71440561,"data":"✅ GPUMemoryPool initialized:\n"}
,{"stream_name":"stdout","time":21.714408046,"data":"   - Segments: 2\n"}
,{"stream_name":"stdout","time":21.714410406,"data":"   - Total cells: 150\n"}
,{"stream_name":"stdout","time":21.714412771,"data":"   - Ghost cells: 3\n"}
,{"stream_name":"stdout","time":21.71441513,"data":"   - Compute Capability: (6, 0)\n"}
,{"stream_name":"stdout","time":21.714417555,"data":"   - CUDA streams: Enabled\n"}
,{"stream_name":"stdout","time":21.714419937,"data":"   - GPU memory allocated: 0.00 MB\n"}
,{"stream_name":"stdout","time":21.714422343,"data":"____________________ test_simulation_runs_end_to_end_on_gpu ____________________\n"}
,{"stream_name":"stdout","time":21.714424791,"data":"\n"}
,{"stream_name":"stdout","time":21.714427107,"data":"    def test_simulation_runs_end_to_end_on_gpu():\n"}
,{"stream_name":"stdout","time":21.71442952,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.71443195,"data":"        Tests that a simple simulation can run from start to finish on the GPU.\n"}
,{"stream_name":"stdout","time":21.714434536,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.714436958,"data":"        print(\"Running test: test_simulation_runs_end_to_end_on_gpu\")\n"}
,{"stream_name":"stdout","time":21.714439518,"data":"        try:\n"}
,{"stream_name":"stdout","time":21.714441895,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":21.714444316,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":21.714446867,"data":"\u003e           runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":21.714449611,"data":"                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":21.714452163,"data":"\n"}
,{"stream_name":"stdout","time":21.714454821,"data":"arz_model/tests/test_gpu_only_integration.py:88: \n"}
,{"stream_name":"stdout","time":21.714457266,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":21.714459728,"data":"arz_model/simulation/runner.py:72: in __init__\n"}
,{"stream_name":"stdout","time":21.714462149,"data":"    self._init_from_network_grid(network_grid, simulation_config, quiet, device)\n"}
,{"stream_name":"stdout","time":21.714464651,"data":"arz_model/simulation/runner.py:123: in _init_from_network_grid\n"}
,{"stream_name":"stdout","time":21.714467073,"data":"    self.network_simulator = NetworkSimulator(\n"}
,{"stream_name":"stdout","time":21.714477819,"data":"arz_model/simulation/execution/network_simulator.py:48: in __init__\n"}
,{"stream_name":"stdout","time":21.714483214,"data":"    self.gpu_pool = self._initialize_gpu_pool()\n"}
,{"stream_name":"stdout","time":21.714485817,"data":"                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":21.714488306,"data":"arz_model/simulation/execution/network_simulator.py:78: in _initialize_gpu_pool\n"}
,{"stream_name":"stdout","time":21.714490765,"data":"    ghost_cells=self.config.grid.ghost_cells,\n"}
,{"stream_name":"stdout","time":21.714493158,"data":"                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":21.714495638,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":21.714498123,"data":"\n"}
,{"stream_name":"stdout","time":21.714500713,"data":"self = GridConfig(num_ghost_cells=3, spatial_scheme='weno5', numerical_flux='godunov', time_scheme='ssprk3')\n"}
,{"stream_name":"stdout","time":21.714503403,"data":"item = 'ghost_cells'\n"}
,{"stream_name":"stdout","time":21.714505863,"data":"\n"}
,{"stream_name":"stdout","time":21.714508185,"data":"    def __getattr__(self, item: str) -\u003e Any:\n"}
,{"stream_name":"stdout","time":21.714510688,"data":"        private_attributes = object.__getattribute__(self, '__private_attributes__')\n"}
,{"stream_name":"stdout","time":21.714513186,"data":"        if item in private_attributes:\n"}
,{"stream_name":"stdout","time":21.714515639,"data":"            attribute = private_attributes[item]\n"}
,{"stream_name":"stdout","time":21.714518056,"data":"            if hasattr(attribute, '__get__'):\n"}
,{"stream_name":"stdout","time":21.714520468,"data":"                return attribute.__get__(self, type(self))  # type: ignore\n"}
,{"stream_name":"stdout","time":21.71452296,"data":"    \n"}
,{"stream_name":"stdout","time":21.714525372,"data":"            try:\n"}
,{"stream_name":"stdout","time":21.714527795,"data":"                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items\n"}
,{"stream_name":"stdout","time":21.714530352,"data":"                return self.__pydantic_private__[item]  # type: ignore\n"}
,{"stream_name":"stdout","time":21.714532833,"data":"            except KeyError as exc:\n"}
,{"stream_name":"stdout","time":21.714535253,"data":"                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc\n"}
,{"stream_name":"stdout","time":21.714537787,"data":"        else:\n"}
,{"stream_name":"stdout","time":21.714540163,"data":"            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.\n"}
,{"stream_name":"stdout","time":21.714542675,"data":"            # See `BaseModel.__repr_args__` for more details\n"}
,{"stream_name":"stdout","time":21.71454512,"data":"            try:\n"}
,{"stream_name":"stdout","time":21.714547543,"data":"                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')\n"}
,{"stream_name":"stdout","time":21.714550039,"data":"            except AttributeError:\n"}
,{"stream_name":"stdout","time":21.714552443,"data":"                pydantic_extra = None\n"}
,{"stream_name":"stdout","time":21.714554857,"data":"    \n"}
,{"stream_name":"stdout","time":21.714557168,"data":"            if pydantic_extra and item in pydantic_extra:\n"}
,{"stream_name":"stdout","time":21.714559596,"data":"                return pydantic_extra[item]\n"}
,{"stream_name":"stdout","time":21.714562018,"data":"            else:\n"}
,{"stream_name":"stdout","time":21.714564376,"data":"                if hasattr(self.__class__, item):\n"}
,{"stream_name":"stdout","time":21.714569414,"data":"                    return super().__getattribute__(item)  # Raises AttributeError if appropriate\n"}
,{"stream_name":"stdout","time":21.714572054,"data":"                else:\n"}
,{"stream_name":"stdout","time":21.714574426,"data":"                    # this is the current error\n"}
,{"stream_name":"stdout","time":21.714576866,"data":"\u003e                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n"}
,{"stream_name":"stdout","time":21.714579396,"data":"E                   AttributeError: 'GridConfig' object has no attribute 'ghost_cells'\n"}
,{"stream_name":"stdout","time":21.714581903,"data":"\n"}
,{"stream_name":"stdout","time":21.714584221,"data":"/usr/local/lib/python3.11/dist-packages/pydantic/main.py:1026: AttributeError\n"}
,{"stream_name":"stdout","time":21.714586721,"data":"\n"}
,{"stream_name":"stdout","time":21.714589043,"data":"During handling of the above exception, another exception occurred:\n"}
,{"stream_name":"stdout","time":21.714591513,"data":"\n"}
,{"stream_name":"stdout","time":21.714593818,"data":"    def test_simulation_runs_end_to_end_on_gpu():\n"}
,{"stream_name":"stdout","time":21.714596236,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.714598621,"data":"        Tests that a simple simulation can run from start to finish on the GPU.\n"}
,{"stream_name":"stdout","time":21.714623205,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.714631401,"data":"        print(\"Running test: test_simulation_runs_end_to_end_on_gpu\")\n"}
,{"stream_name":"stdout","time":21.714635738,"data":"        try:\n"}
,{"stream_name":"stdout","time":21.714640902,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":21.714644384,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":21.714646965,"data":"            runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":21.714649495,"data":"            results = runner.run()\n"}
,{"stream_name":"stdout","time":21.714651974,"data":"    \n"}
,{"stream_name":"stdout","time":21.714654343,"data":"            # Verify results structure\n"}
,{"stream_name":"stdout","time":21.714656756,"data":"            assert \"final_time\" in results\n"}
,{"stream_name":"stdout","time":21.714659329,"data":"            assert \"total_steps\" in results\n"}
,{"stream_name":"stdout","time":21.714661856,"data":"            assert \"final_states\" in results\n"}
,{"stream_name":"stdout","time":21.71466432,"data":"            assert \"seg-1\" in results[\"final_states\"]\n"}
,{"stream_name":"stdout","time":21.714666853,"data":"            assert \"seg-2\" in results[\"final_states\"]\n"}
,{"stream_name":"stdout","time":21.714669411,"data":"    \n"}
,{"stream_name":"stdout","time":21.714671726,"data":"            # Verify state array shape\n"}
,{"stream_name":"stdout","time":21.714674121,"data":"            final_state_seg1 = results[\"final_states\"][\"seg-1\"]\n"}
,{"stream_name":"stdout","time":21.714676726,"data":"            expected_shape = (4, config.segments[0].N + 2 * config.grid.num_ghost_cells)\n"}
,{"stream_name":"stdout","time":21.714679285,"data":"            assert final_state_seg1.shape == expected_shape, f\"Expected shape {expected_shape}, but got {final_state_seg1.shape}\"\n"}
,{"stream_name":"stdout","time":21.714681974,"data":"    \n"}
,{"stream_name":"stdout","time":21.714684328,"data":"            print(\"✅ Test passed. Simulation ran end-to-end and produced valid results.\")\n"}
,{"stream_name":"stdout","time":21.714691015,"data":"        except Exception as e:\n"}
,{"stream_name":"stdout","time":21.714693564,"data":"\u003e           pytest.fail(f\"End-to-end GPU simulation test failed with an exception: {e}\", pytrace=True)\n"}
,{"stream_name":"stdout","time":21.714696266,"data":"E           Failed: End-to-end GPU simulation test failed with an exception: 'GridConfig' object has no attribute 'ghost_cells'\n"}
,{"stream_name":"stdout","time":21.714699006,"data":"\n"}
,{"stream_name":"stdout","time":21.71470247,"data":"arz_model/tests/test_gpu_only_integration.py:105: Failed\n"}
,{"stream_name":"stdout","time":21.714707824,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":21.71471222,"data":"Running test: test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":21.714716623,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":21.714721485,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":21.714725203,"data":"________________________ test_no_cpu_transfers_in_loop _________________________\n"}
,{"stream_name":"stdout","time":21.71472889,"data":"\n"}
,{"stream_name":"stdout","time":21.714732285,"data":"    def test_no_cpu_transfers_in_loop():\n"}
,{"stream_name":"stdout","time":21.714737615,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.714741186,"data":"        Hooks into CUDA transfer functions to verify that no transfers occur\n"}
,{"stream_name":"stdout","time":21.714744253,"data":"        during the main simulation loop.\n"}
,{"stream_name":"stdout","time":21.714746714,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":21.714749113,"data":"        print(\"Running test: test_no_cpu_transfers_in_loop\")\n"}
,{"stream_name":"stdout","time":21.714751723,"data":"    \n"}
,{"stream_name":"stdout","time":21.714754065,"data":"        transfer_log = []\n"}
,{"stream_name":"stdout","time":21.714756481,"data":"        original_to_device = cuda.to_device\n"}
,{"stream_name":"stdout","time":21.714758895,"data":"        original_copy_to_host = cuda.devicearray.DeviceNDArray.copy_to_host\n"}
,{"stream_name":"stdout","time":21.71476138,"data":"    \n"}
,{"stream_name":"stdout","time":21.714763732,"data":"        def tracked_to_device(obj, *args, **kwargs):\n"}
,{"stream_name":"stdout","time":21.714766195,"data":"            transfer_log.append(f\"to_device: {type(obj)}\")\n"}
,{"stream_name":"stdout","time":22.092388767,"data":"            return original_to_device(obj, *args, **kwargs)\n"}
,{"stream_name":"stdout","time":22.092425398,"data":"    \n"}
,{"stream_name":"stdout","time":22.09243114,"data":"        def tracked_copy_to_host(self, *args, **kwargs):\n"}
,{"stream_name":"stdout","time":22.092435459,"data":"            transfer_log.append(f\"copy_to_host: shape={self.shape}\")\n"}
,{"stream_name":"stdout","time":22.092439442,"data":"            return original_copy_to_host(self, *args, **kwargs)\n"}
,{"stream_name":"stdout","time":22.092443709,"data":"    \n"}
,{"stream_name":"stdout","time":22.092447669,"data":"        try:\n"}
,{"stream_name":"stdout","time":22.092452845,"data":"            config = create_test_config()\n"}
,{"stream_name":"stdout","time":22.092456996,"data":"    \n"}
,{"stream_name":"stdout","time":22.092459669,"data":"            cuda.to_device = tracked_to_device\n"}
,{"stream_name":"stdout","time":22.092462277,"data":"            cuda.devicearray.DeviceNDArray.copy_to_host = tracked_copy_to_host\n"}
,{"stream_name":"stdout","time":22.092464932,"data":"    \n"}
,{"stream_name":"stdout","time":22.092490675,"data":"            network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":22.09249364,"data":"\u003e           runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":22.092496521,"data":"                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092499073,"data":"\n"}
,{"stream_name":"stdout","time":22.092501434,"data":"arz_model/tests/test_gpu_only_integration.py:148: \n"}
,{"stream_name":"stdout","time":22.092504034,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":22.092506564,"data":"arz_model/simulation/runner.py:72: in __init__\n"}
,{"stream_name":"stdout","time":22.092509008,"data":"    self._init_from_network_grid(network_grid, simulation_config, quiet, device)\n"}
,{"stream_name":"stdout","time":22.092511488,"data":"arz_model/simulation/runner.py:123: in _init_from_network_grid\n"}
,{"stream_name":"stdout","time":22.092514059,"data":"    self.network_simulator = NetworkSimulator(\n"}
,{"stream_name":"stdout","time":22.092516527,"data":"arz_model/simulation/execution/network_simulator.py:48: in __init__\n"}
,{"stream_name":"stdout","time":22.092518992,"data":"    self.gpu_pool = self._initialize_gpu_pool()\n"}
,{"stream_name":"stdout","time":22.092521441,"data":"                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092523981,"data":"arz_model/simulation/execution/network_simulator.py:78: in _initialize_gpu_pool\n"}
,{"stream_name":"stdout","time":22.092526515,"data":"    ghost_cells=self.config.grid.ghost_cells,\n"}
,{"stream_name":"stdout","time":22.092532695,"data":"                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092536003,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":22.092538661,"data":"\n"}
,{"stream_name":"stdout","time":22.092541089,"data":"self = GridConfig(num_ghost_cells=3, spatial_scheme='weno5', numerical_flux='godunov', time_scheme='ssprk3')\n"}
,{"stream_name":"stdout","time":22.092543816,"data":"item = 'ghost_cells'\n"}
,{"stream_name":"stdout","time":22.092546217,"data":"\n"}
,{"stream_name":"stdout","time":22.092548611,"data":"    def __getattr__(self, item: str) -\u003e Any:\n"}
,{"stream_name":"stdout","time":22.092551192,"data":"        private_attributes = object.__getattribute__(self, '__private_attributes__')\n"}
,{"stream_name":"stdout","time":22.092553857,"data":"        if item in private_attributes:\n"}
,{"stream_name":"stdout","time":22.092556352,"data":"            attribute = private_attributes[item]\n"}
,{"stream_name":"stdout","time":22.092558912,"data":"            if hasattr(attribute, '__get__'):\n"}
,{"stream_name":"stdout","time":22.092561377,"data":"                return attribute.__get__(self, type(self))  # type: ignore\n"}
,{"stream_name":"stdout","time":22.092564691,"data":"    \n"}
,{"stream_name":"stdout","time":22.092567122,"data":"            try:\n"}
,{"stream_name":"stdout","time":22.092569595,"data":"                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items\n"}
,{"stream_name":"stdout","time":22.092573844,"data":"                return self.__pydantic_private__[item]  # type: ignore\n"}
,{"stream_name":"stdout","time":22.092576381,"data":"            except KeyError as exc:\n"}
,{"stream_name":"stdout","time":22.092578896,"data":"                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc\n"}
,{"stream_name":"stdout","time":22.092584637,"data":"        else:\n"}
,{"stream_name":"stdout","time":22.092587138,"data":"            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.\n"}
,{"stream_name":"stdout","time":22.092589666,"data":"            # See `BaseModel.__repr_args__` for more details\n"}
,{"stream_name":"stdout","time":22.092592496,"data":"            try:\n"}
,{"stream_name":"stdout","time":22.092594871,"data":"                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')\n"}
,{"stream_name":"stdout","time":22.092597411,"data":"            except AttributeError:\n"}
,{"stream_name":"stdout","time":22.092599806,"data":"                pydantic_extra = None\n"}
,{"stream_name":"stdout","time":22.092620829,"data":"    \n"}
,{"stream_name":"stdout","time":22.092623466,"data":"            if pydantic_extra and item in pydantic_extra:\n"}
,{"stream_name":"stdout","time":22.092626177,"data":"                return pydantic_extra[item]\n"}
,{"stream_name":"stdout","time":22.092629584,"data":"            else:\n"}
,{"stream_name":"stdout","time":22.092633079,"data":"                if hasattr(self.__class__, item):\n"}
,{"stream_name":"stdout","time":22.092638259,"data":"                    return super().__getattribute__(item)  # Raises AttributeError if appropriate\n"}
,{"stream_name":"stdout","time":22.092642036,"data":"                else:\n"}
,{"stream_name":"stdout","time":22.092646882,"data":"                    # this is the current error\n"}
,{"stream_name":"stdout","time":22.092651008,"data":"\u003e                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n"}
,{"stream_name":"stdout","time":22.092655546,"data":"E                   AttributeError: 'GridConfig' object has no attribute 'ghost_cells'\n"}
,{"stream_name":"stdout","time":22.092659597,"data":"\n"}
,{"stream_name":"stdout","time":22.092663488,"data":"/usr/local/lib/python3.11/dist-packages/pydantic/main.py:1026: AttributeError\n"}
,{"stream_name":"stdout","time":22.092667989,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":22.092673402,"data":"Running test: test_no_cpu_transfers_in_loop\n"}
,{"stream_name":"stdout","time":22.092677739,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":22.092680427,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":22.092683856,"data":"__________________________ test_mass_conservation_gpu __________________________\n"}
,{"stream_name":"stdout","time":22.092686482,"data":"\n"}
,{"stream_name":"stdout","time":22.0926888,"data":"    def test_mass_conservation_gpu():\n"}
,{"stream_name":"stdout","time":22.092691291,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":22.092694107,"data":"        Verifies that the total mass (rho) in the system is conserved on the GPU\n"}
,{"stream_name":"stdout","time":22.092696586,"data":"        when using reflective boundary conditions.\n"}
,{"stream_name":"stdout","time":22.092699088,"data":"        \"\"\"\n"}
,{"stream_name":"stdout","time":22.092701461,"data":"        print(\"Running test: test_mass_conservation_gpu\")\n"}
,{"stream_name":"stdout","time":22.092703991,"data":"    \n"}
,{"stream_name":"stdout","time":22.09270633,"data":"        config = create_test_config()\n"}
,{"stream_name":"stdout","time":22.092708828,"data":"        # Use reflective \"wall\" boundary conditions to ensure mass is conserved\n"}
,{"stream_name":"stdout","time":22.092715373,"data":"        config.segments[0].boundary_conditions.left = ReflectiveBC()\n"}
,{"stream_name":"stdout","time":22.092717996,"data":"        config.segments[1].boundary_conditions.right = ReflectiveBC()\n"}
,{"stream_name":"stdout","time":22.092720555,"data":"    \n"}
,{"stream_name":"stdout","time":22.092722939,"data":"        network_grid = NetworkGrid.from_config(config)\n"}
,{"stream_name":"stdout","time":22.092725401,"data":"    \n"}
,{"stream_name":"stdout","time":22.092728627,"data":"        # Calculate initial mass from the config\n"}
,{"stream_name":"stdout","time":22.092731159,"data":"        initial_mass = 0.0\n"}
,{"stream_name":"stdout","time":22.092733576,"data":"        for seg_config in config.segments:\n"}
,{"stream_name":"stdout","time":22.092735972,"data":"            segment = network_grid.segments[seg_config.id]\n"}
,{"stream_name":"stdout","time":22.092738414,"data":"            ic_config = seg_config.initial_conditions.config\n"}
,{"stream_name":"stdout","time":22.092740835,"data":"            if isinstance(ic_config, UniformIC):\n"}
,{"stream_name":"stdout","time":22.092743249,"data":"                # Mass = density * length\n"}
,{"stream_name":"stdout","time":22.092745682,"data":"                initial_mass += ic_config.density * (segment['grid'].xmax - segment['grid'].xmin)\n"}
,{"stream_name":"stdout","time":22.092748236,"data":"    \n"}
,{"stream_name":"stdout","time":22.092750627,"data":"\u003e       runner = SimulationRunner(network_grid=network_grid, simulation_config=config, quiet=True)\n"}
,{"stream_name":"stdout","time":22.092753198,"data":"                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092755697,"data":"\n"}
,{"stream_name":"stdout","time":22.092757989,"data":"arz_model/tests/test_gpu_only_integration.py:195: \n"}
,{"stream_name":"stdout","time":22.09276041,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":22.092762867,"data":"arz_model/simulation/runner.py:72: in __init__\n"}
,{"stream_name":"stdout","time":22.092765291,"data":"    self._init_from_network_grid(network_grid, simulation_config, quiet, device)\n"}
,{"stream_name":"stdout","time":22.092767747,"data":"arz_model/simulation/runner.py:123: in _init_from_network_grid\n"}
,{"stream_name":"stdout","time":22.092770212,"data":"    self.network_simulator = NetworkSimulator(\n"}
,{"stream_name":"stdout","time":22.092772651,"data":"arz_model/simulation/execution/network_simulator.py:48: in __init__\n"}
,{"stream_name":"stdout","time":22.092775088,"data":"    self.gpu_pool = self._initialize_gpu_pool()\n"}
,{"stream_name":"stdout","time":22.092777497,"data":"                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092779922,"data":"arz_model/simulation/execution/network_simulator.py:78: in _initialize_gpu_pool\n"}
,{"stream_name":"stdout","time":22.092782388,"data":"    ghost_cells=self.config.grid.ghost_cells,\n"}
,{"stream_name":"stdout","time":22.092784792,"data":"                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"}
,{"stream_name":"stdout","time":22.092787231,"data":"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n"}
,{"stream_name":"stdout","time":22.092789723,"data":"\n"}
,{"stream_name":"stdout","time":22.092792056,"data":"self = GridConfig(num_ghost_cells=3, spatial_scheme='weno5', numerical_flux='godunov', time_scheme='ssprk3')\n"}
,{"stream_name":"stdout","time":22.092794589,"data":"item = 'ghost_cells'\n"}
,{"stream_name":"stdout","time":22.092799793,"data":"\n"}
,{"stream_name":"stdout","time":22.092802229,"data":"    def __getattr__(self, item: str) -\u003e Any:\n"}
,{"stream_name":"stdout","time":22.092804716,"data":"        private_attributes = object.__getattribute__(self, '__private_attributes__')\n"}
,{"stream_name":"stdout","time":22.092807195,"data":"        if item in private_attributes:\n"}
,{"stream_name":"stdout","time":22.092809669,"data":"            attribute = private_attributes[item]\n"}
,{"stream_name":"stdout","time":22.092812114,"data":"            if hasattr(attribute, '__get__'):\n"}
,{"stream_name":"stdout","time":22.092814556,"data":"                return attribute.__get__(self, type(self))  # type: ignore\n"}
,{"stream_name":"stdout","time":22.092817042,"data":"    \n"}
,{"stream_name":"stdout","time":22.092819393,"data":"            try:\n"}
,{"stream_name":"stdout","time":22.09282179,"data":"                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items\n"}
,{"stream_name":"stdout","time":22.092824676,"data":"                return self.__pydantic_private__[item]  # type: ignore\n"}
,{"stream_name":"stdout","time":22.092827197,"data":"            except KeyError as exc:\n"}
,{"stream_name":"stdout","time":22.092829629,"data":"                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc\n"}
,{"stream_name":"stdout","time":22.092832189,"data":"        else:\n"}
,{"stream_name":"stdout","time":22.092834592,"data":"            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.\n"}
,{"stream_name":"stdout","time":22.092837109,"data":"            # See `BaseModel.__repr_args__` for more details\n"}
,{"stream_name":"stdout","time":22.092839562,"data":"            try:\n"}
,{"stream_name":"stdout","time":22.092841965,"data":"                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')\n"}
,{"stream_name":"stdout","time":22.092844434,"data":"            except AttributeError:\n"}
,{"stream_name":"stdout","time":22.092846807,"data":"                pydantic_extra = None\n"}
,{"stream_name":"stdout","time":22.092849346,"data":"    \n"}
,{"stream_name":"stdout","time":22.092851697,"data":"            if pydantic_extra and item in pydantic_extra:\n"}
,{"stream_name":"stdout","time":22.092854131,"data":"                return pydantic_extra[item]\n"}
,{"stream_name":"stdout","time":22.092856564,"data":"            else:\n"}
,{"stream_name":"stdout","time":22.092858921,"data":"                if hasattr(self.__class__, item):\n"}
,{"stream_name":"stdout","time":22.092861366,"data":"                    return super().__getattribute__(item)  # Raises AttributeError if appropriate\n"}
,{"stream_name":"stdout","time":22.092863865,"data":"                else:\n"}
,{"stream_name":"stdout","time":22.092866227,"data":"                    # this is the current error\n"}
,{"stream_name":"stdout","time":22.092868646,"data":"\u003e                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n"}
,{"stream_name":"stdout","time":22.092871309,"data":"E                   AttributeError: 'GridConfig' object has no attribute 'ghost_cells'\n"}
,{"stream_name":"stdout","time":22.092873822,"data":"\n"}
,{"stream_name":"stdout","time":22.09287622,"data":"/usr/local/lib/python3.11/dist-packages/pydantic/main.py:1026: AttributeError\n"}
,{"stream_name":"stdout","time":22.092878709,"data":"----------------------------- Captured stdout call -----------------------------\n"}
,{"stream_name":"stdout","time":22.092881207,"data":"Running test: test_mass_conservation_gpu\n"}
,{"stream_name":"stdout","time":22.092886079,"data":"Finalizing network structure and validating topology...\n"}
,{"stream_name":"stdout","time":22.092888631,"data":"✅ Network topology is valid.\n"}
,{"stream_name":"stdout","time":22.092891129,"data":"=========================== short test summary info ============================\n"}
,{"stream_name":"stdout","time":22.092893644,"data":"FAILED arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_road_quality_access\n"}
,{"stream_name":"stdout","time":22.092896232,"data":"FAILED arz_model/tests/test_gpu_memory_pool.py::TestGPUMemoryPoolAccess::test_stream_access\n"}
,{"stream_name":"stdout","time":22.092898833,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_simulation_runs_end_to_end_on_gpu\n"}
,{"stream_name":"stdout","time":22.092901312,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_no_cpu_transfers_in_loop\n"}
,{"stream_name":"stdout","time":22.092903842,"data":"FAILED arz_model/tests/test_gpu_only_integration.py::test_mass_conservation_gpu\n"}
,{"stream_name":"stdout","time":22.092907164,"data":"=================== 5 failed, 15 passed, 1 skipped in 8.62s ====================\n"}
,{"stream_name":"stdout","time":22.549519905,"data":"[WARNING] Target execution returned code: 1\n"}
,{"stream_name":"stdout","time":22.549655878,"data":"\n"}
,{"stream_name":"stdout","time":22.549684671,"data":"[STEP 4/4] Cleanup...\n"}
,{"stream_name":"stdout","time":22.549789053,"data":"Cleaning up cloned repository at /kaggle/working/Code-traffic-flow...\n"}
,{"stream_name":"stdout","time":22.557812743,"data":"[OK] Repository cleaned up.\n"}
,{"stream_name":"stdout","time":22.557873113,"data":"\n"}
,{"stream_name":"stdout","time":22.557882156,"data":"[FINAL] Test workflow completed\n"}
,{"stream_name":"stdout","time":22.558073923,"data":"\n"}
,{"stream_name":"stdout","time":22.558079692,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":22.558083084,"data":"EXECUTION COMPLETED\n"}
,{"stream_name":"stdout","time":22.558086021,"data":"Check /kaggle/working/test_log.txt for details.\n"}
,{"stream_name":"stdout","time":22.558088984,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":27.911366892,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":27.911441749,"data":"  warn(\n"}
,{"stream_name":"stderr","time":27.954227032,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":29.085412922,"data":"[NbConvertApp] Writing 298633 bytes to __results__.html\n"}
]