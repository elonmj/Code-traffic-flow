2025-11-14 19:18:49,737 - INFO - Repository: https://github.com/elonmj/Code-traffic-flow.git
2025-11-14 19:18:49,738 - INFO - Branch: main
2025-11-14 19:18:49,738 - INFO - Target: arz_model/main_network_simulation.py
2025-11-14 19:18:56,141 - INFO - Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
2025-11-14 19:18:56,141 - INFO - PyTorch: 2.6.0+cu124
2025-11-14 19:18:56,190 - INFO - CUDA available: True
2025-11-14 19:18:56,212 - INFO - CUDA device: Tesla P100-PCIE-16GB
2025-11-14 19:18:56,212 - INFO - 
[STEP 1/4] Cloning repository from GitHub...
2025-11-14 19:18:56,212 - INFO - Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
2025-11-14 19:18:57,751 - INFO - [OK] Repository cloned successfully
2025-11-14 19:18:57,751 - INFO - 
[STEP 2/4] Installing dependencies...
2025-11-14 19:18:57,751 - INFO - Installing pytest...
2025-11-14 19:19:02,184 - INFO - Installing pydantic...
2025-11-14 19:19:05,197 - INFO - Installing tqdm...
2025-11-14 19:19:08,181 - INFO - Installing numba...
2025-11-14 19:19:11,203 - INFO - [OK] Dependencies installed
2025-11-14 19:19:11,203 - INFO - 
[STEP 3/4] Running Target...
2025-11-14 19:19:11,204 - INFO - Target is a file. Executing script...
2025-11-14 19:19:11,204 - INFO - Command: /usr/bin/python3 -u /kaggle/working/Code-traffic-flow/arz_model/main_network_simulation.py
2025-11-14 19:19:16,721 - INFO - 
2025-11-14 19:19:16,721 - INFO - ======================================================================
2025-11-14 19:19:16,721 - INFO - === SCRIPT MAIN STARTING ===
2025-11-14 19:19:16,721 - INFO - ======================================================================
2025-11-14 19:19:16,722 - INFO - 
2025-11-14 19:19:16,722 - INFO - ======================================================================
2025-11-14 19:19:16,722 - INFO - === D√âBUT DU SCRIPT main_network_simulation.py ===
2025-11-14 19:19:16,722 - INFO - ======================================================================
2025-11-14 19:19:16,722 - INFO - ======================================================
2025-11-14 19:19:16,722 - INFO - = Full Network Simulation Execution (GPU-Only/Pydantic) =
2025-11-14 19:19:16,722 - INFO - ======================================================
2025-11-14 19:19:16,722 - INFO - 
2025-11-14 19:19:16,722 - INFO - [PHASE 1] Defining simulation configuration...
2025-11-14 19:19:16,722 - INFO - - Creating Pydantic config for a two-segment corridor...
2025-11-14 19:19:16,723 - INFO - - Pydantic config created.
2025-11-14 19:19:16,723 - INFO - ‚úÖ Network configuration defined successfully.
2025-11-14 19:19:16,723 - INFO - 
2025-11-14 19:19:16,723 - INFO - [PHASE 2] Building NetworkGrid from Pydantic config...
2025-11-14 19:19:16,723 - INFO - [DEBUG] add_segment_from_config called for segment: seg1
2025-11-14 19:19:16,723 - INFO - [DEBUG] seg_config.initial_conditions = config=UniformIC(type='uniform', density=50.0, velocity=40.0)
2025-11-14 19:19:16,723 - INFO - [DEBUG] seg_config.initial_conditions type = <class 'arz_model.config.ic_config.ICConfig'>
2025-11-14 19:19:16,723 - INFO - [DEBUG] IC is NOT None, proceeding with application...
2025-11-14 19:19:16,723 - INFO - [DEBUG] ic_config = config=UniformIC(type='uniform', density=50.0, velocity=40.0)
2025-11-14 19:19:16,723 - INFO - [DEBUG] ic extracted = type='uniform' density=50.0 velocity=40.0
2025-11-14 19:19:16,723 - INFO - [DEBUG] ic type = <class 'arz_model.config.ic_config.UniformIC'>
2025-11-14 19:19:16,723 - INFO - [DEBUG] IC has density and velocity attributes
2025-11-14 19:19:16,723 - INFO - [DEBUG] density=50.0, velocity=40.0
2025-11-14 19:19:21,118 - INFO - [IC APPLIED] Segment seg1:
2025-11-14 19:19:21,118 - INFO - œÅ_total = 50.0 veh/km ‚Üí 0.050000 veh/m
2025-11-14 19:19:21,118 - INFO - v = 40.0 km/h ‚Üí 11.111 m/s
2025-11-14 19:19:21,118 - INFO - Œ± = 0.600 ‚Üí œÅ_m=0.030000, œÅ_c=0.020000
2025-11-14 19:19:21,119 - INFO - U[0] (œÅ_m): min=0.030000, max=0.030000, mean=0.030000
2025-11-14 19:19:21,119 - INFO - U[1] (w_m): min=11.331611, max=11.331611, mean=11.331611
2025-11-14 19:19:21,119 - INFO - U[2] (œÅ_c): min=0.020000, max=0.020000, mean=0.020000
2025-11-14 19:19:21,119 - INFO - U[3] (w_c): min=11.736111, max=11.736111, mean=11.736111
2025-11-14 19:19:21,119 - INFO - [DEBUG] Final U array for seg1:
2025-11-14 19:19:21,119 - INFO - U shape: (4, 106)
2025-11-14 19:19:21,119 - INFO - U[0] (œÅ_m): min=0.030000, max=0.030000
2025-11-14 19:19:21,119 - INFO - U[1] (w_m): min=11.331611, max=11.331611
2025-11-14 19:19:21,119 - INFO - U[2] (œÅ_c): min=0.020000, max=0.020000
2025-11-14 19:19:21,119 - INFO - U[3] (w_c): min=11.736111, max=11.736111
2025-11-14 19:19:21,119 - INFO - [DEBUG] add_segment_from_config called for segment: seg2
2025-11-14 19:19:21,119 - INFO - [DEBUG] seg_config.initial_conditions = config=UniformIC(type='uniform', density=20.0, velocity=50.0)
2025-11-14 19:19:21,119 - INFO - [DEBUG] seg_config.initial_conditions type = <class 'arz_model.config.ic_config.ICConfig'>
2025-11-14 19:19:21,120 - INFO - [DEBUG] IC is NOT None, proceeding with application...
2025-11-14 19:19:21,120 - INFO - [DEBUG] ic_config = config=UniformIC(type='uniform', density=20.0, velocity=50.0)
2025-11-14 19:19:21,120 - INFO - [DEBUG] ic extracted = type='uniform' density=20.0 velocity=50.0
2025-11-14 19:19:21,120 - INFO - [DEBUG] ic type = <class 'arz_model.config.ic_config.UniformIC'>
2025-11-14 19:19:21,120 - INFO - [DEBUG] IC has density and velocity attributes
2025-11-14 19:19:21,120 - INFO - [DEBUG] density=20.0, velocity=50.0
2025-11-14 19:19:21,120 - INFO - [IC APPLIED] Segment seg2:
2025-11-14 19:19:21,120 - INFO - œÅ_total = 20.0 veh/km ‚Üí 0.020000 veh/m
2025-11-14 19:19:21,120 - INFO - v = 50.0 km/h ‚Üí 13.889 m/s
2025-11-14 19:19:21,120 - INFO - Œ± = 0.600 ‚Üí œÅ_m=0.012000, œÅ_c=0.008000
2025-11-14 19:19:21,120 - INFO - U[0] (œÅ_m): min=0.012000, max=0.012000, mean=0.012000
2025-11-14 19:19:21,120 - INFO - U[1] (w_m): min=13.924169, max=13.924169, mean=13.924169
2025-11-14 19:19:21,120 - INFO - U[2] (œÅ_c): min=0.008000, max=0.008000, mean=0.008000
2025-11-14 19:19:21,120 - INFO - U[3] (w_c): min=13.988889, max=13.988889, mean=13.988889
2025-11-14 19:19:21,120 - INFO - [DEBUG] Final U array for seg2:
2025-11-14 19:19:21,121 - INFO - U shape: (4, 106)
2025-11-14 19:19:21,121 - INFO - U[0] (œÅ_m): min=0.012000, max=0.012000
2025-11-14 19:19:21,121 - INFO - U[1] (w_m): min=13.924169, max=13.924169
2025-11-14 19:19:21,121 - INFO - U[2] (œÅ_c): min=0.008000, max=0.008000
2025-11-14 19:19:21,121 - INFO - U[3] (w_c): min=13.988889, max=13.988889
2025-11-14 19:19:21,121 - INFO - Finalizing network structure and validating topology...
2025-11-14 19:19:21,121 - INFO - Found isolated nodes with no connections: ['node1']
2025-11-14 19:19:21,121 - INFO - ‚úÖ Network topology is valid.
2025-11-14 19:19:21,121 - INFO - ‚úÖ NetworkGrid built successfully.
2025-11-14 19:19:21,121 - INFO - - Segments: ['seg1', 'seg2']
2025-11-14 19:19:21,121 - INFO - - Nodes: ['node1']
2025-11-14 19:19:21,121 - INFO - 
2025-11-14 19:19:21,121 - INFO - [PHASE 3] Initializing simulation runner...
2025-11-14 19:19:21,376 - INFO - - Mode: Network Simulation
2025-11-14 19:19:21,376 - INFO - - Device: GPU (Compute Capability: (6, 0))
2025-11-14 19:19:21,376 - INFO - - Segments: 2
2025-11-14 19:19:21,376 - INFO - - Nodes: 1
2025-11-14 19:19:21,376 - INFO - Initializing GPU Network Simulator...
2025-11-14 19:19:21,376 - INFO - [DEBUG] GPU debug logging ENABLED
2025-11-14 19:19:21,376 - INFO - - Initializing GPU Memory Pool for network...
2025-11-14 19:19:21,381 - INFO - ‚úÖ GPUMemoryPool initialized:
2025-11-14 19:19:21,381 - INFO - - Segments: 2
2025-11-14 19:19:21,381 - INFO - - Total cells: 200
2025-11-14 19:19:21,381 - INFO - - Ghost cells: 3
2025-11-14 19:19:21,381 - INFO - - Compute Capability: (6, 0)
2025-11-14 19:19:21,381 - INFO - - CUDA streams: Enabled
2025-11-14 19:19:21,381 - INFO - - GPU memory allocated: 0.00 MB
2025-11-14 19:19:21,383 - INFO - - GPU Memory Pool created. Allocated: 0.00 MB
2025-11-14 19:19:21,384 - INFO - - Initializing GPU-native network coupling...
2025-11-14 19:19:21,384 - INFO - - Preparing GPU topology for network coupling...
2025-11-14 19:19:21,387 - INFO - - GPU topology prepared and transferred.
2025-11-14 19:19:21,387 - INFO - - GPU Coupling Manager created.
2025-11-14 19:19:21,387 - INFO - [DEBUG] Initial state (t=0)
2025-11-14 19:19:21,387 - INFO - Segment seg1: density[min=11.361611, max=11.361611, mean=11.361611] speed[min=11.705175, max=11.705175, mean=11.705175]
2025-11-14 19:19:21,387 - INFO - Segment seg2: density[min=13.936169, max=13.936169, mean=13.936169] speed[min=13.976850, max=13.976850, mean=13.976850]
2025-11-14 19:19:21,388 - INFO - ‚úÖ GPU Network Simulator initialized.
2025-11-14 19:19:21,388 - INFO - ‚úÖ Simulation runner initialized.
2025-11-14 19:19:21,388 - INFO - 
2025-11-14 19:19:21,388 - INFO - [PHASE 4] Running simulation for 260 seconds...
2025-11-14 19:19:21,388 - INFO - Starting GPU network simulation from t=0 to t=1800.0s...
2025-11-14 19:19:21,391 - INFO - 
2025-11-14 19:19:21,392 - INFO - Simulating on GPU:   0%|          | 0/1800.0 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:21,392 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:22,367 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:22,367 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:22,620 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:22,620 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:22,754 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:22,754 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,009 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,009 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,071 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,071 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,493 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,493 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,566 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 7 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,566 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,631 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 7 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,631 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,703 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 7 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,704 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,778 - INFO - /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
2025-11-14 19:19:23,778 - INFO - warn(NumbaPerformanceWarning(msg))
2025-11-14 19:19:23,788 - INFO - ‚ùå Error during simulation: 'GPUMemoryPool' object has no attribute 'd_U_flat'
2025-11-14 19:19:23,789 - INFO - Traceback (most recent call last):
2025-11-14 19:19:23,789 - INFO - File "/kaggle/working/Code-traffic-flow/arz_model/main_network_simulation.py", line 147, in main
2025-11-14 19:19:23,789 - INFO - results = runner.run(timeout=260)
2025-11-14 19:19:23,789 - INFO - ^^^^^^^^^^^^^^^^^^^^^^^
2025-11-14 19:19:23,789 - INFO - File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 749, in run
2025-11-14 19:19:23,789 - INFO - return self.network_simulator.run(t_final=sim_t_final, timeout=timeout)
2025-11-14 19:19:23,790 - INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-14 19:19:23,790 - INFO - File "/kaggle/working/Code-traffic-flow/arz_model/simulation/execution/network_simulator.py", line 202, in run
2025-11-14 19:19:23,790 - INFO - self.network_coupling.apply_coupling(self.config.physics)
2025-11-14 19:19:23,790 - INFO - File "/kaggle/working/Code-traffic-flow/arz_model/numerics/gpu/network_coupling_gpu.py", line 140, in apply_coupling
2025-11-14 19:19:23,790 - INFO - self.gpu_pool.d_U_flat,
2025-11-14 19:19:23,790 - INFO - ^^^^^^^^^^^^^^^^^^^^^^
2025-11-14 19:19:23,790 - INFO - AttributeError: 'GPUMemoryPool' object has no attribute 'd_U_flat'
2025-11-14 19:19:23,790 - INFO - 
2025-11-14 19:19:23,790 - INFO - Simulating on GPU:   0%|          | 0/1800.0 [00:02<?, ?it/s]
2025-11-14 19:19:23,791 - INFO - 
2025-11-14 19:19:23,791 - INFO - ======================================================================
2025-11-14 19:19:23,791 - INFO - === SCRIPT MAIN COMPLETED ===
2025-11-14 19:19:23,791 - INFO - ======================================================================
2025-11-14 19:19:24,340 - INFO - [SUCCESS] Target executed successfully
2025-11-14 19:19:24,340 - INFO - 
[STEP 4/4] Persisting results and cleaning up...
2025-11-14 19:19:24,340 - WARNING - [WARN] No 'results' directory found or it is empty.
2025-11-14 19:19:24,340 - INFO - Cleaning up cloned repository at /kaggle/working/Code-traffic-flow...
2025-11-14 19:19:24,340 - INFO - [OK] Repository cleanup skipped for debugging.
2025-11-14 19:19:24,340 - INFO - 
[FINAL] Test workflow completed
2025-11-14 19:19:24,340 - INFO - Created placeholder in output directory for Kaggle.
