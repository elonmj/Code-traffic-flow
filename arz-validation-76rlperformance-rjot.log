[{"stream_name":"stdout","time":0.811071448,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.811114971,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.811121235,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.811125262,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.811128946,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.811338493,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":6.940290728,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":6.940515976,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":6.98854234,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":7.009460948,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":7.009519151,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":7.009652275,"data":"\n"}
,{"stream_name":"stdout","time":7.009661026,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":7.009778479,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":11.023354731,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":11.02365691,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":11.023782421,"data":"\n"}
,{"stream_name":"stdout","time":11.023789815,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":11.024009883,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":15.290860196,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":18.253586907,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":21.203941991,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":24.153291007,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":27.079359315,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":30.025546382,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":109.258804283,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":109.258838552,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":109.258845634,"data":"\n"}
,{"stream_name":"stdout","time":109.258851278,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":109.258856945,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":109.258863298,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":109.258869101,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":109.258874778,"data":"============================================================\n"}
,{"stream_name":"stderr","time":122.341607538,"data":"2025-10-16 06:38:09.477204: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":122.588947901,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":122.589000321,"data":"E0000 00:00:1760596689.724491     102 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":122.653785514,"data":"E0000 00:00:1760596689.789432     102 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":135.123281065,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.123309997,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":135.123315309,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":135.123319042,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":135.123322709,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":135.123326262,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":135.123329887,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.123521091,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":135.123532681,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":135.123536897,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":135.123541033,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":135.123545176,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":135.123549163,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":135.124054183,"data":"2025-10-16 06:38:22 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":135.124188266,"data":"2025-10-16 06:38:22 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":135.124297753,"data":"2025-10-16 06:38:22 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":135.124407832,"data":"2025-10-16 06:38:22 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":135.12451803,"data":"2025-10-16 06:38:22 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":135.124524031,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":135.124527842,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":135.124531593,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":135.268522527,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":135.359787149,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":135.359820363,"data":"\n"}
,{"stream_name":"stdout","time":135.359825205,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":135.359829688,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":135.359850195,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":135.359854343,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":135.359912498,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":135.360028105,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":135.360101541,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":135.360171303,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":135.360236242,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":135.360310784,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":135.360376154,"data":"2025-10-16 06:38:22 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":135.360442465,"data":"\n"}
,{"stream_name":"stdout","time":135.360448285,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":135.360452492,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":135.360456597,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":135.360460332,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":135.360715826,"data":"2025-10-16 06:38:22 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":135.360756688,"data":"2025-10-16 06:38:22 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":135.360868795,"data":"2025-10-16 06:38:22 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":135.361239082,"data":"2025-10-16 06:38:22 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":135.365651946,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":135.365683892,"data":"2025-10-16 06:38:22 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":135.365821693,"data":"2025-10-16 06:38:22 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":135.36589577,"data":"2025-10-16 06:38:22 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":135.36597694,"data":"2025-10-16 06:38:22 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":135.366009016,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":135.366016768,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":135.366137796,"data":"2025-10-16 06:38:22 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":135.366269059,"data":"2025-10-16 06:38:22 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":135.366459306,"data":"2025-10-16 06:38:22 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":135.36661827,"data":"2025-10-16 06:38:22 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config 25b78b90\n"}
,{"stream_name":"stdout","time":135.366624182,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":135.367174656,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":135.367187151,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":135.374054336,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":135.374072071,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":135.37407734,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":135.374081708,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":135.374085892,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":135.374162311,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":135.37416885,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":135.374172555,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":135.374176208,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":135.374234071,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.374241887,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":135.374245963,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":135.37711943,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":135.377133726,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":135.377611889,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":135.37762258,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":136.837921848,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":136.837947648,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":136.837952331,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":136.837956697,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":136.837960628,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":136.837964413,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":136.837968211,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":136.837971754,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":136.838313791,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":136.839116926,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":136.839197964,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":136.839216418,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":141.585459368,"data":"2025-10-16 06:38:28 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":141.585927504,"data":"\n"}
,{"stream_name":"stdout","time":141.586019279,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":141.586028029,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":141.586033954,"data":"\n"}
,{"stream_name":"stdout","time":141.586039963,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.586045958,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":141.586051887,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":141.586057483,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":141.586063281,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":141.586069021,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.586101908,"data":"\n"}
,{"stream_name":"stdout","time":141.586112305,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.586118604,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.598267643,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.598289234,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.598295368,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.59830148,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.598411721,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":141.598586756,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.598598192,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.598604011,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":141.598609946,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.598615556,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.598736547,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.598746174,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.599800243,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.599895423,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":141.601039921,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.601347,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.601360306,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.60136736,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.608860171,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":141.609076471,"data":"\n"}
,{"stream_name":"stdout","time":141.609085597,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":141.610883502,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.610898268,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.610903402,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.610907919,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.611460419,"data":"\n"}
,{"stream_name":"stderr","time":141.668185264,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":141.668211708,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":142.390478876,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":142.390511146,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.390514989,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":142.390517764,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":142.390520259,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.390522825,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":142.570332956,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":142.570365774,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":142.824775352,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":142.824809955,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":142.88445006,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":142.884480351,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":142.942639783,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":142.942669399,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.355892267,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.355922935,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.427322579,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.427350642,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.511520227,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.511548562,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.606875496,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.606902778,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.701018912,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.70104813,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.760539103,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.760566227,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":143.816906878,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":143.816934584,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":144.195237948,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":144.195266378,"data":"\n"}
,{"stream_name":"stderr","time":144.195282502,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.195586254,"data":"\n"}
,{"stream_name":"stderr","time":144.19558923,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.81s/s]\n"}
,{"stream_name":"stdout","time":144.195599903,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":144.19560799,"data":"Total runtime: 2.58 seconds.\n"}
,{"stream_name":"stdout","time":144.197185559,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":144.197197421,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":144.19744864,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":144.197459261,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":144.197654314,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":144.197835551,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":144.19801437,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":144.198188395,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":144.198195025,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":144.198312988,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.198349289,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.198435505,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.198446251,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.198521401,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":144.198532718,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.198923238,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.198934258,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.198939027,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.198942817,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.199117812,"data":"\n"}
,{"stream_name":"stdout","time":144.270871038,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":144.669968949,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":144.669990676,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.670008593,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":144.670277944,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.85s/s]\n"}
,{"stream_name":"stdout","time":144.670281256,"data":"\n"}
,{"stream_name":"stdout","time":144.670297238,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":144.670301767,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":144.671831456,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":144.671846213,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":144.672074757,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14728652 1.         0.01511905 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":144.672081944,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":144.672261164,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":144.672745258,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":144.672956379,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04418596 0.03245596 0.02963171 0.02876023 0.02847843 0.02839937]\n"}
,{"stream_name":"stdout","time":144.673157538,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00226786 0.00147845 0.00125712 0.00117426 0.00114274 0.00113299]\n"}
,{"stream_name":"stdout","time":144.673168048,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":144.673233486,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.673300305,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.673342907,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.673367984,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.673427455,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":144.673487317,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":144.673911559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.67391867,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.673922934,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.673926829,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.67412783,"data":"\n"}
,{"stream_name":"stdout","time":144.722756092,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":144.722774675,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.722779301,"data":"  Original dt: 4.632357e-01 s\n"}
,{"stream_name":"stdout","time":144.722784976,"data":"  Corrected dt: 2.895223e-01 s\n"}
,{"stream_name":"stdout","time":144.722788971,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.722793051,"data":"  Max wave speed detected: 17.27 m/s\n"}
,{"stream_name":"stdout","time":144.731054596,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2895s\n"}
,{"stream_name":"stdout","time":145.148981446,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":145.148995128,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.149024564,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":145.149279733,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.59s/s]\n"}
,{"stream_name":"stdout","time":145.149281813,"data":"\n"}
,{"stream_name":"stdout","time":145.149299146,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":145.149303559,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":145.150721483,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":145.150736654,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":145.150960126,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14408623 1.         0.01497548 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":145.150967253,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":145.15114123,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":145.151302776,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":145.151560593,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04322587 0.03180861 0.0290486  0.02817912 0.02788006 0.02777789]\n"}
,{"stream_name":"stdout","time":145.151788279,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224632 0.00146764 0.00124475 0.00115563 0.00111598 0.00109814]\n"}
,{"stream_name":"stdout","time":145.151800285,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":145.151804448,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.151808719,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.1518623,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.151893632,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.151899543,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":145.151967374,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":145.152347275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.152354975,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.152359353,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.152365854,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.152576127,"data":"\n"}
,{"stream_name":"stdout","time":145.189184039,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2882s\n"}
,{"stream_name":"stderr","time":145.627579913,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.627606152,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.627581453,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stderr","time":145.627862446,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.57s/s]\n"}
,{"stream_name":"stdout","time":145.627884651,"data":"\n"}
,{"stream_name":"stdout","time":145.627896538,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":145.627900874,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":145.629302178,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":145.62931632,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":145.629562165,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14737645 1.         0.01513132 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":145.629573349,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":145.629744271,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":145.629905927,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":145.630063135,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04421294 0.03247146 0.02962974 0.02873066 0.02841512 0.02830032]\n"}
,{"stream_name":"stdout","time":145.63022723,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022697  0.00147873 0.00125261 0.00116175 0.00112044 0.00110076]\n"}
,{"stream_name":"stdout","time":145.630233976,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":145.630305039,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.630393565,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.630416216,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.630460257,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.630543306,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":145.630549625,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":145.631047949,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.631057832,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.631062047,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.631066282,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.631235617,"data":"\n"}
,{"stream_name":"stdout","time":145.632335349,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":145.632349905,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.632354492,"data":"  Original dt: 4.610819e-01 s\n"}
,{"stream_name":"stdout","time":145.632358531,"data":"  Corrected dt: 2.881762e-01 s\n"}
,{"stream_name":"stdout","time":145.632362179,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.632365859,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":145.640619402,"data":"[PROGRESS] Step 200: t=60.29/75.00s (80.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":146.088476901,"data":"[PROGRESS] Step 250: t=74.70/75.00s (99.6%) | dt=0.2883s\n"}
,{"stream_name":"stdout","time":146.106300735,"data":"  Stored output at t = 75.0000 s (Step 252)\n"}
,{"stream_name":"stderr","time":146.106345387,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.106360247,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":146.106546347,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.58s/s]\n"}
,{"stream_name":"stdout","time":146.10655983,"data":"\n"}
,{"stream_name":"stdout","time":146.106571132,"data":"Simulation finished at t = 75.0000 s after 252 steps.\n"}
,{"stream_name":"stdout","time":146.106575496,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":146.108106722,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":146.108121369,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":146.108302679,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741477 1.         0.01513343 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":146.108308894,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":146.108512404,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":146.10867056,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":146.108864924,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422443 0.03248442 0.0296447  0.02874749 0.02843412 0.02832228]\n"}
,{"stream_name":"stdout","time":146.109019528,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227001 0.00147937 0.00125329 0.00116235 0.0011209  0.00110104]\n"}
,{"stream_name":"stdout","time":146.109025642,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":146.109107172,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.109162635,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.109217808,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.109226864,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.109279079,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":146.109317099,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.109736575,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.109751974,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":146.109756623,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.109763894,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.10993278,"data":"\n"}
,{"stream_name":"stdout","time":146.532882714,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":146.532910579,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.532915738,"data":"  Original dt: 4.610823e-01 s\n"}
,{"stream_name":"stdout","time":146.53291948,"data":"  Corrected dt: 2.881764e-01 s\n"}
,{"stream_name":"stdout","time":146.532940197,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.53294464,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":146.541051071,"data":"[PROGRESS] Step 300: t=88.84/90.00s (98.7%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":146.586222249,"data":"  Stored output at t = 90.0000 s (Step 305)\n"}
,{"stream_name":"stderr","time":146.586226195,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.586263633,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.58651152,"data":"\n"}
,{"stream_name":"stdout","time":146.586524479,"data":"Simulation finished at t = 90.0000 s after 305 steps.\n"}
,{"stream_name":"stdout","time":146.586529164,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":146.586534193,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.49s/s]\n"}
,{"stream_name":"stdout","time":146.588029507,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":146.588143914,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.588173046,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.588254366,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.588261219,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.588324259,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":146.58833149,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":146.588739365,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.588750887,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.58875607,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.588761153,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.588958488,"data":"\n"}
,{"stream_name":"stdout","time":146.995435918,"data":"[PROGRESS] Step 350: t=102.96/105.00s (98.1%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":147.066289337,"data":"  Stored output at t = 105.0000 s (Step 358)\n"}
,{"stream_name":"stderr","time":147.066334808,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.066345574,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.066596714,"data":"\n"}
,{"stream_name":"stderr","time":147.066597386,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.42s/s]\n"}
,{"stream_name":"stdout","time":147.066612179,"data":"Simulation finished at t = 105.0000 s after 358 steps.\n"}
,{"stream_name":"stdout","time":147.066653711,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":147.068172743,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":147.068189632,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.068291553,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.06830059,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.068345919,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.068422201,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":147.068464706,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.068839469,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.068846467,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.068851276,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.06885514,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.069030624,"data":"\n"}
,{"stream_name":"stdout","time":147.449505832,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":147.449535544,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.449541825,"data":"  Original dt: 4.610189e-01 s\n"}
,{"stream_name":"stdout","time":147.449546465,"data":"  Corrected dt: 2.881368e-01 s\n"}
,{"stream_name":"stdout","time":147.44955085,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.449555284,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":147.458159095,"data":"[PROGRESS] Step 400: t=117.10/120.00s (97.6%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":147.55745773,"data":"  Stored output at t = 120.0000 s (Step 411)\n"}
,{"stream_name":"stderr","time":147.557498535,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.557510398,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":147.557654307,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.71s/s]\n"}
,{"stream_name":"stdout","time":147.55765871,"data":"\n"}
,{"stream_name":"stdout","time":147.557669255,"data":"Simulation finished at t = 120.0000 s after 411 steps.\n"}
,{"stream_name":"stdout","time":147.55767387,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":147.559206421,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":147.559226912,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.55931842,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.559344661,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.559349746,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.559431576,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":147.559445612,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.559451095,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":147.559545751,"data":"\n"}
,{"stream_name":"stdout","time":147.559554672,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.559559214,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.02 | Avg Reward/Step: 0.003\n"}
,{"stream_name":"stdout","time":147.559563456,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.559567346,"data":"\n"}
,{"stream_name":"stdout","time":147.559571008,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":147.559575324,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":147.567023909,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":147.567042424,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":147.567046929,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":147.567050819,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":147.567054571,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":147.567069992,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":147.567074844,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":147.567078939,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":147.567082462,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":147.567086023,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.567133189,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":147.567145272,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":147.567761726,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":147.567778846,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":147.568020291,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":147.568246648,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.568256358,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.56826091,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.570031979,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.570057134,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.570062305,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.570066323,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.570179893,"data":"\n"}
,{"stream_name":"stdout","time":147.948051763,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":147.948075421,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.948092639,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":147.948297181,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.69s/s]\n"}
,{"stream_name":"stdout","time":147.948426284,"data":"\n"}
,{"stream_name":"stdout","time":147.948444659,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":147.948449628,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":147.94997939,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":147.949993548,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":147.95019757,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":147.950204707,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":147.950374942,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":147.95056163,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":147.950754533,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":147.95094247,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":147.950949603,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":147.95103565,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.951109292,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":147.951146207,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.951151012,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":147.951236332,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":147.951242256,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.951639115,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.951667535,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.951672165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.951676336,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.951844988,"data":"\n"}
,{"stream_name":"stdout","time":148.023611466,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":148.361067106,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":148.361094082,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.36110038,"data":"  Original dt: 4.643714e-01 s\n"}
,{"stream_name":"stdout","time":148.361104458,"data":"  Corrected dt: 2.902321e-01 s\n"}
,{"stream_name":"stdout","time":148.361108681,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.361112277,"data":"  Max wave speed detected: 17.23 m/s\n"}
,{"stream_name":"stdout","time":148.405154865,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":148.405201588,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.405212309,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.40540569,"data":"\n"}
,{"stream_name":"stdout","time":148.405433269,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":148.405439467,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":148.405410873,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.09s/s]\n"}
,{"stream_name":"stdout","time":148.407119881,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":148.407327862,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.407339195,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.407343572,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.407347796,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.407544352,"data":"\n"}
,{"stream_name":"stdout","time":148.46958199,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":148.873247582,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":148.873286685,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.873303934,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.873411211,"data":"\n"}
,{"stream_name":"stdout","time":148.873419656,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stderr","time":148.873421984,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":148.873429978,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":148.875215816,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":148.875370869,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.875403981,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.87540923,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.875413204,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.875586041,"data":"\n"}
,{"stream_name":"stdout","time":148.919981234,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":149.259957605,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":149.259985881,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.25999151,"data":"  Original dt: 4.617951e-01 s\n"}
,{"stream_name":"stdout","time":149.259995747,"data":"  Corrected dt: 2.886220e-01 s\n"}
,{"stream_name":"stdout","time":149.25999986,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.260004018,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":149.340250822,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.340276206,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.340261059,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":149.340426296,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.29s/s]\n"}
,{"stream_name":"stdout","time":149.340464121,"data":"\n"}
,{"stream_name":"stdout","time":149.340480332,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":149.340484727,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":149.341977122,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.342359168,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.342370839,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.342375824,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.342399589,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.342559424,"data":"\n"}
,{"stream_name":"stdout","time":149.370833319,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":149.815974646,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.816028834,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.815974549,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":149.816196869,"data":"\n"}
,{"stream_name":"stdout","time":149.816207519,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":149.81621205,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":149.81623404,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.68s/s]\n"}
,{"stream_name":"stdout","time":149.817837426,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":149.818142573,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.818149303,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.818154056,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.818158837,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.818312368,"data":"\n"}
,{"stream_name":"stdout","time":149.827708809,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":150.171325823,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":150.171351528,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.17135763,"data":"  Original dt: 4.617547e-01 s\n"}
,{"stream_name":"stdout","time":150.171361895,"data":"  Corrected dt: 2.885967e-01 s\n"}
,{"stream_name":"stdout","time":150.171365895,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.171369765,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":150.278239351,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":150.287689312,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":150.287695907,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.287718717,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":150.287945693,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.95s/s]\n"}
,{"stream_name":"stdout","time":150.287967081,"data":"\n"}
,{"stream_name":"stdout","time":150.287975922,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":150.287980295,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":150.289637095,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":150.289917697,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.289929271,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.289934165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.289938074,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.290096645,"data":"\n"}
,{"stream_name":"stdout","time":150.738210526,"data":"[PROGRESS] Step 350: t=104.13/105.00s (99.2%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":150.777123144,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":150.77714052,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.777157299,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":150.777434289,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":150.777437778,"data":"\n"}
,{"stream_name":"stdout","time":150.777459959,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":150.777464751,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":150.778954132,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.779253274,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.779264499,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.779269104,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.779272868,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.779421621,"data":"\n"}
,{"stream_name":"stdout","time":151.093591694,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":151.093616781,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.093622352,"data":"  Original dt: 4.607300e-01 s\n"}
,{"stream_name":"stdout","time":151.093626338,"data":"  Corrected dt: 2.879562e-01 s\n"}
,{"stream_name":"stdout","time":151.093630489,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.093634341,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":151.203531162,"data":"[PROGRESS] Step 400: t=118.25/120.00s (98.5%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":151.268339373,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.268365194,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.268348719,"data":"  Stored output at t = 120.0000 s (Step 407)\n"}
,{"stream_name":"stderr","time":151.268544603,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.68s/s]\n"}
,{"stream_name":"stdout","time":151.26856504,"data":"\n"}
,{"stream_name":"stdout","time":151.268581188,"data":"Simulation finished at t = 120.0000 s after 407 steps.\n"}
,{"stream_name":"stdout","time":151.268586311,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":151.27008281,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.270100365,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":151.270128438,"data":"\n"}
,{"stream_name":"stdout","time":151.270153462,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.270158292,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":151.270162497,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.270166024,"data":"\n"}
,{"stream_name":"stdout","time":151.270169665,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":151.270174791,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":151.277805245,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":151.277821323,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":151.277824406,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":151.277827106,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":151.277829753,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":151.277982323,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":151.277990964,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":151.277995731,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":151.277999455,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":151.278003035,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.278058686,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":151.278064788,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":151.278698184,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":151.278711686,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":151.278933038,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":151.279160863,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.279168554,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.279172903,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.281007059,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.281018721,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.281023045,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.281026905,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.28117233,"data":"\n"}
,{"stream_name":"stdout","time":151.694233849,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":151.694240967,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.694296873,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.694534031,"data":"\n"}
,{"stream_name":"stdout","time":151.694558691,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":151.694564237,"data":"Total runtime: 0.41 seconds.\n"}
,{"stream_name":"stderr","time":151.694536984,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.31s/s]\n"}
,{"stream_name":"stdout","time":151.69611496,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":151.696132174,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":151.696320149,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":151.6963299,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":151.696544802,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":151.696714862,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":151.696902302,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":151.697035788,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":151.697044077,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":151.697128517,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":151.697191812,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":151.697241472,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":151.697248599,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":151.697284492,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":151.697331982,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.697702255,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.697728702,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.697732461,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.697735218,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.697872298,"data":"\n"}
,{"stream_name":"stdout","time":151.772969081,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":152.054087504,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":152.054113301,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.054119421,"data":"  Original dt: 4.653826e-01 s\n"}
,{"stream_name":"stdout","time":152.054123134,"data":"  Corrected dt: 2.908641e-01 s\n"}
,{"stream_name":"stdout","time":152.054127027,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.054130867,"data":"  Max wave speed detected: 17.19 m/s\n"}
,{"stream_name":"stdout","time":152.160560335,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":152.160560377,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.160608267,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.160784053,"data":"\n"}
,{"stream_name":"stderr","time":152.160788902,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.42s/s]\n"}
,{"stream_name":"stdout","time":152.160797748,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":152.160808039,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":152.162482777,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.162789937,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.162797169,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.162801932,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.162806492,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.162971313,"data":"\n"}
,{"stream_name":"stdout","time":152.22666759,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":152.635316659,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.635349755,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.635332158,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":152.635556291,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.75s/s]\n"}
,{"stream_name":"stdout","time":152.635584347,"data":"\n"}
,{"stream_name":"stdout","time":152.635612824,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":152.635617859,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":152.637208501,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.637528458,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.637543866,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.637548526,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.637552849,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.637711604,"data":"\n"}
,{"stream_name":"stdout","time":152.682203894,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":152.965588067,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":152.965618529,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.965623908,"data":"  Original dt: 4.613577e-01 s\n"}
,{"stream_name":"stdout","time":152.965637199,"data":"  Corrected dt: 2.883486e-01 s\n"}
,{"stream_name":"stdout","time":152.965640378,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.9656429,"data":"  Max wave speed detected: 17.34 m/s\n"}
,{"stream_name":"stdout","time":153.108229405,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":153.108234756,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.108263661,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.108576794,"data":"\n"}
,{"stream_name":"stdout","time":153.108596126,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":153.108601878,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":153.108575886,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.88s/s]\n"}
,{"stream_name":"stdout","time":153.110181698,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.110524573,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.110541088,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.110546451,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.110550481,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.110711084,"data":"\n"}
,{"stream_name":"stdout","time":153.138006722,"data":"[PROGRESS] Step 200: t=60.86/75.00s (81.2%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":153.585403815,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.0240s\n"}
,{"stream_name":"stdout","time":153.585650417,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":153.585647604,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.585673052,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.585927572,"data":"\n"}
,{"stream_name":"stderr","time":153.585928448,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.58s/s]\n"}
,{"stream_name":"stdout","time":153.58593769,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":153.585945995,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":153.587593631,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.587842043,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.587854012,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.587858738,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.587862918,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.588031444,"data":"\n"}
,{"stream_name":"stdout","time":153.872179,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":153.872205444,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.872211433,"data":"  Original dt: 4.606546e-01 s\n"}
,{"stream_name":"stdout","time":153.872215297,"data":"  Corrected dt: 2.879091e-01 s\n"}
,{"stream_name":"stdout","time":153.872219032,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.872223393,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":154.049328871,"data":"[PROGRESS] Step 300: t=89.40/90.00s (99.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":154.077247916,"data":"  Stored output at t = 90.0000 s (Step 303)\n"}
,{"stream_name":"stderr","time":154.077253094,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.077275714,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.07746135,"data":"\n"}
,{"stream_name":"stdout","time":154.077476609,"data":"Simulation finished at t = 90.0000 s after 303 steps.\n"}
,{"stream_name":"stdout","time":154.077481756,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":154.077487394,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.66s/s]\n"}
,{"stream_name":"stdout","time":154.079153627,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.079446066,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.079461892,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.079466445,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.079470143,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.079657862,"data":"\n"}
,{"stream_name":"stdout","time":154.553797012,"data":"[PROGRESS] Step 350: t=103.53/105.00s (98.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":154.607716312,"data":"  Stored output at t = 105.0000 s (Step 356)\n"}
,{"stream_name":"stderr","time":154.607716374,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.607749719,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.608021528,"data":"\n"}
,{"stream_name":"stdout","time":154.608035891,"data":"Simulation finished at t = 105.0000 s after 356 steps.\n"}
,{"stream_name":"stdout","time":154.60804047,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":154.608044667,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.40s/s]\n"}
,{"stream_name":"stdout","time":154.609535119,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.609804371,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.609815198,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.609820399,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.609823956,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.609978291,"data":"\n"}
,{"stream_name":"stdout","time":154.839199468,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":154.839226358,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.839232658,"data":"  Original dt: 4.606419e-01 s\n"}
,{"stream_name":"stdout","time":154.839236985,"data":"  Corrected dt: 2.879012e-01 s\n"}
,{"stream_name":"stdout","time":154.839241142,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.839245141,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":155.007689383,"data":"[PROGRESS] Step 400: t=117.67/120.00s (98.1%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":155.086965219,"data":"  Stored output at t = 120.0000 s (Step 409)\n"}
,{"stream_name":"stderr","time":155.086965216,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.086992433,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.087279407,"data":"\n"}
,{"stream_name":"stderr","time":155.087278749,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.44s/s]\n"}
,{"stream_name":"stdout","time":155.08728909,"data":"Simulation finished at t = 120.0000 s after 409 steps.\n"}
,{"stream_name":"stdout","time":155.087305081,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":155.088801439,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.088821492,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":155.088826431,"data":"\n"}
,{"stream_name":"stdout","time":155.088830288,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.088835124,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":155.088839577,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.088844074,"data":"\n"}
,{"stream_name":"stdout","time":155.088864718,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":155.088870431,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":155.095930193,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":155.095945604,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":155.095950215,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":155.095954468,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":155.095969293,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":155.096087988,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":155.096095819,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":155.096100301,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":155.096104325,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":155.096123749,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.096191073,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":155.096206131,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":155.096787944,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":155.096804224,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":155.097006601,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":155.097214772,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.097224193,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.097239088,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.099034879,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.099062524,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.099067262,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.09907118,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.099209852,"data":"\n"}
,{"stream_name":"stderr","time":155.470001977,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":155.470020038,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":155.470026442,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.470225957,"data":"\n"}
,{"stream_name":"stderr","time":155.470223916,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.45s/s]\n"}
,{"stream_name":"stdout","time":155.470236418,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":155.470245976,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":155.471747967,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":155.471766602,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":155.471968741,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":155.471976429,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":155.472147941,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":155.472304336,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":155.472500592,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":155.472671919,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":155.472678218,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":155.472747818,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":155.472825719,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":155.472856998,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":155.472864648,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":155.472936828,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":155.472956587,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.473317873,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.473326629,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.47333169,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.473336378,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.473506287,"data":"\n"}
,{"stream_name":"stdout","time":155.545190287,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":155.741061941,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":155.741086801,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.741092535,"data":"  Original dt: 4.666887e-01 s\n"}
,{"stream_name":"stdout","time":155.741096337,"data":"  Corrected dt: 2.916804e-01 s\n"}
,{"stream_name":"stdout","time":155.741100144,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.741103883,"data":"  Max wave speed detected: 17.14 m/s\n"}
,{"stream_name":"stderr","time":155.940419526,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.940447388,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.940472554,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":155.940707063,"data":"\n"}
,{"stream_name":"stdout","time":155.940715393,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":155.940720017,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":155.940728723,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.12s/s]\n"}
,{"stream_name":"stdout","time":155.942423119,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.942733532,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.942745235,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.94275046,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.942754798,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.942912405,"data":"\n"}
,{"stream_name":"stdout","time":155.998451191,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2891s\n"}
,{"stream_name":"stdout","time":156.416908718,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":156.416926574,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.41694451,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.417161487,"data":"\n"}
,{"stream_name":"stdout","time":156.417194052,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":156.417199883,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":156.417153267,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.65s/s]\n"}
,{"stream_name":"stdout","time":156.418862411,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.419139645,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.419150258,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.419154625,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.41915849,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.419302125,"data":"\n"}
,{"stream_name":"stdout","time":156.456490716,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2885s\n"}
,{"stream_name":"stdout","time":156.655525186,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":156.655548772,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.655553481,"data":"  Original dt: 4.617199e-01 s\n"}
,{"stream_name":"stdout","time":156.655559224,"data":"  Corrected dt: 2.885750e-01 s\n"}
,{"stream_name":"stdout","time":156.655563502,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.655567882,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":156.887736498,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.887766116,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.887748637,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":156.887982365,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":156.887993133,"data":"\n"}
,{"stream_name":"stdout","time":156.888017755,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":156.888022735,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":156.88961059,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.890037915,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.89004708,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.890051691,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.890055581,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.890226591,"data":"\n"}
,{"stream_name":"stdout","time":156.908400651,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":157.356030269,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":157.365154399,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":157.365160698,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stderr","time":157.365173188,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.365503904,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.58s/s]\n"}
,{"stream_name":"stdout","time":157.365517008,"data":"\n"}
,{"stream_name":"stdout","time":157.365528376,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":157.365532899,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":157.367107687,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.367418556,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.367434766,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.367439885,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.367443767,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.367577398,"data":"\n"}
,{"stream_name":"stdout","time":157.590884943,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":157.590915639,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.59092189,"data":"  Original dt: 4.607917e-01 s\n"}
,{"stream_name":"stdout","time":157.590926161,"data":"  Corrected dt: 2.879948e-01 s\n"}
,{"stream_name":"stdout","time":157.590930474,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.59093476,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":157.844323468,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":157.880469888,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.88049648,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.880480127,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stdout","time":157.880728266,"data":"\n"}
,{"stream_name":"stdout","time":157.880739609,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stderr","time":157.880734973,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.24s/s]\n"}
,{"stream_name":"stdout","time":157.880744574,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":157.882298493,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.882672345,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.882689297,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.882694153,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.882698857,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.88281272,"data":"\n"}
,{"stream_name":"stdout","time":158.294812004,"data":"[PROGRESS] Step 350: t=103.24/105.00s (98.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":158.357484283,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":158.357514032,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.35752634,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.357753829,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.60s/s]\n"}
,{"stream_name":"stdout","time":158.357784396,"data":"\n"}
,{"stream_name":"stdout","time":158.357797979,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":158.357802716,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.359327038,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.35963476,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.359645079,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.359649436,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.359653321,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.35981474,"data":"\n"}
,{"stream_name":"stdout","time":158.492875098,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":158.492898678,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.492905789,"data":"  Original dt: 4.606442e-01 s\n"}
,{"stream_name":"stdout","time":158.492908492,"data":"  Corrected dt: 2.879026e-01 s\n"}
,{"stream_name":"stdout","time":158.492910973,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.492913525,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":158.741267794,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":158.833061771,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":158.833063676,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.833107545,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":158.833368799,"data":"\n"}
,{"stream_name":"stdout","time":158.833406375,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":158.833412715,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":158.833409642,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.69s/s]\n"}
,{"stream_name":"stdout","time":158.835157436,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.83517564,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":158.8351807,"data":"\n"}
,{"stream_name":"stdout","time":158.835184987,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":158.835189505,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":158.835194005,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":158.835198616,"data":"\n"}
,{"stream_name":"stdout","time":158.83520309,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":158.835208945,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":158.842109839,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":158.842125355,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":158.842129817,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":158.842135882,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":158.842189268,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":158.842248988,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":158.842254895,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":158.842258986,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":158.84230198,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":158.842308309,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.842321896,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":158.842326509,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":158.842959349,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":158.842972096,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":158.843216244,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":158.843878492,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.843900551,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.843905403,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.845913244,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":158.845924227,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":158.845928603,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":158.84593274,"data":"|    ep_rew_mean      | 0.0925   |\n"}
,{"stream_name":"stdout","time":158.845936915,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":158.845940621,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":158.84594477,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":158.845949467,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":158.845953545,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":158.84595772,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":158.845962256,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":158.847038779,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.847054717,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.847059909,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.847063974,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.847187412,"data":"\n"}
,{"stream_name":"stdout","time":159.221116153,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":159.221147079,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.221164691,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.221334225,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.11s/s]\n"}
,{"stream_name":"stdout","time":159.221353722,"data":"\n"}
,{"stream_name":"stdout","time":159.221361618,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":159.221366187,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":159.222884574,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":159.222897419,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":159.223111932,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":159.223118841,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":159.223292535,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":159.223499375,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":159.223679079,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":159.223848122,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":159.223855014,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":159.223919541,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":159.2239964,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":159.224017449,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":159.224054209,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":159.224095947,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":159.224135077,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":159.22452709,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.224556227,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.224561487,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.224566725,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.224765367,"data":"\n"}
,{"stream_name":"stdout","time":159.297183445,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":159.405215888,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":159.405238885,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.405244399,"data":"  Original dt: 4.695747e-01 s\n"}
,{"stream_name":"stdout","time":159.405248621,"data":"  Corrected dt: 2.934842e-01 s\n"}
,{"stream_name":"stdout","time":159.405253144,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.405256882,"data":"  Max wave speed detected: 17.04 m/s\n"}
,{"stream_name":"stderr","time":159.694528744,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.694585685,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.694528742,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":159.694747169,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.93s/s]\n"}
,{"stream_name":"stdout","time":159.694747167,"data":"\n"}
,{"stream_name":"stdout","time":159.694762892,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":159.69476788,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":159.69652463,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.696787282,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.696796179,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.69680126,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.696805784,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.696973076,"data":"\n"}
,{"stream_name":"stdout","time":159.749918394,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2895s\n"}
,{"stream_name":"stdout","time":160.165968688,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":160.166000939,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.166019546,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.166208063,"data":"\n"}
,{"stream_name":"stderr","time":160.166208206,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.98s/s]\n"}
,{"stream_name":"stdout","time":160.166217096,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":160.166226527,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":160.167887486,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.168073977,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.1680827,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.168087322,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.168093052,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.168226421,"data":"\n"}
,{"stream_name":"stdout","time":160.205514849,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":160.31490297,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":160.314924348,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.314928409,"data":"  Original dt: 4.618567e-01 s\n"}
,{"stream_name":"stdout","time":160.314931011,"data":"  Corrected dt: 2.886604e-01 s\n"}
,{"stream_name":"stdout","time":160.314933505,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.314936118,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":160.642844375,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":160.642859277,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.642873565,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.643207438,"data":"\n"}
,{"stream_name":"stdout","time":160.643273948,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":160.643280794,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":160.643214081,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.60s/s]\n"}
,{"stream_name":"stdout","time":160.644859742,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.645295296,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.645304253,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.645309424,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.645313678,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.645475072,"data":"\n"}
,{"stream_name":"stdout","time":160.66287637,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":161.120089997,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":161.129767647,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.129787062,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.129788447,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stdout","time":161.130066427,"data":"\n"}
,{"stream_name":"stderr","time":161.130065587,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":161.13007586,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":161.130087048,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":161.131911829,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.132182893,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.132191123,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.132195726,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.13220013,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.132353329,"data":"\n"}
,{"stream_name":"stdout","time":161.234029203,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":161.234049274,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.234055867,"data":"  Original dt: 4.608703e-01 s\n"}
,{"stream_name":"stdout","time":161.234059466,"data":"  Corrected dt: 2.880439e-01 s\n"}
,{"stream_name":"stdout","time":161.234080245,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.234085047,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":161.600443327,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":161.636907343,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":161.636925952,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":161.63692831,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":161.637060765,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.74s/s]\n"}
,{"stream_name":"stdout","time":161.63706788,"data":"\n"}
,{"stream_name":"stdout","time":161.637082315,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":161.637086279,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":161.638600184,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.638892743,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.638900424,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.638904805,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.638908618,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.639062615,"data":"\n"}
,{"stream_name":"stdout","time":162.050251998,"data":"[PROGRESS] Step 350: t=103.24/105.00s (98.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":162.112411355,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":162.112426468,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.112440757,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.112667788,"data":"\n"}
,{"stream_name":"stdout","time":162.112675476,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":162.112679708,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":162.11267726,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.69s/s]\n"}
,{"stream_name":"stdout","time":162.114430005,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.114749902,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.114762184,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.11478262,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.114787562,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.114919843,"data":"\n"}
,{"stream_name":"stdout","time":162.159588758,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":162.159604665,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.159609448,"data":"  Original dt: 4.606456e-01 s\n"}
,{"stream_name":"stdout","time":162.159613192,"data":"  Corrected dt: 2.879035e-01 s\n"}
,{"stream_name":"stdout","time":162.159616877,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.159620706,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":162.503282885,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":162.612929685,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.612958829,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.612956927,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":162.613031114,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.13s/s]\n"}
,{"stream_name":"stdout","time":162.613060283,"data":"\n"}
,{"stream_name":"stdout","time":162.613069792,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":162.613074368,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":162.614698321,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.614716852,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":162.614721585,"data":"\n"}
,{"stream_name":"stdout","time":162.614725761,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.614730243,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":162.614734879,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.614739377,"data":"\n"}
,{"stream_name":"stdout","time":162.61474733,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":162.61475172,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":162.621856244,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":162.621873831,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":162.621879016,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":162.621883072,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":162.621887136,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":162.621903779,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":162.621908778,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":162.621913518,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":162.621919808,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":162.621923613,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.621928779,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":162.621932742,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":162.622541683,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":162.622561017,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":162.622774144,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":162.623002897,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.623009584,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.623013801,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.624888557,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.624901786,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.624906481,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.624910962,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.625081815,"data":"\n"}
,{"stream_name":"stdout","time":163.00385303,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":163.003878408,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.003895071,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":163.004087795,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.60s/s]\n"}
,{"stream_name":"stdout","time":163.004109158,"data":"\n"}
,{"stream_name":"stdout","time":163.00411619,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":163.004120146,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":163.005772185,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":163.005786346,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":163.00600699,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":163.006014606,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":163.006187583,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":163.006371773,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":163.00658191,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":163.006768096,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":163.006775548,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":163.006848043,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":163.006930477,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":163.006981851,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":163.006989047,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":163.007017868,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":163.00706825,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.007427272,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.007437531,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.007440945,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.007443624,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.007625754,"data":"\n"}
,{"stream_name":"stdout","time":163.080216717,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":163.099000194,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":163.099018636,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.099023441,"data":"  Original dt: 4.759960e-01 s\n"}
,{"stream_name":"stdout","time":163.099027264,"data":"  Corrected dt: 2.974975e-01 s\n"}
,{"stream_name":"stdout","time":163.099030214,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.099032776,"data":"  Max wave speed detected: 16.81 m/s\n"}
,{"stream_name":"stdout","time":163.467813114,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":163.467842297,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.46785853,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.468085269,"data":"\n"}
,{"stream_name":"stdout","time":163.468096329,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stderr","time":163.468093425,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.59s/s]\n"}
,{"stream_name":"stdout","time":163.468101192,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":163.46975154,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.470052672,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.470064395,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.470069165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.470073042,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.470216083,"data":"\n"}
,{"stream_name":"stdout","time":163.534706036,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":163.947489024,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.947516263,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.947522378,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":163.947773951,"data":"\n"}
,{"stream_name":"stdout","time":163.947782956,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":163.947787384,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":163.947800967,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.42s/s]\n"}
,{"stream_name":"stdout","time":163.949490231,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.949832744,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.94984184,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.949846138,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.949850254,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.950023934,"data":"\n"}
,{"stream_name":"stdout","time":163.998000336,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":164.01663297,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":164.01665248,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.016656117,"data":"  Original dt: 4.619245e-01 s\n"}
,{"stream_name":"stdout","time":164.01665872,"data":"  Corrected dt: 2.887028e-01 s\n"}
,{"stream_name":"stdout","time":164.016661491,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.016664618,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":164.418492059,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":164.418511192,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":164.418519992,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.418704762,"data":"\n"}
,{"stream_name":"stdout","time":164.418714545,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stderr","time":164.418712323,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":164.41871912,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":164.42034134,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.420816093,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.420827622,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.420832287,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.420838314,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.421024841,"data":"\n"}
,{"stream_name":"stdout","time":164.448287866,"data":"[PROGRESS] Step 200: t=60.86/75.00s (81.2%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":164.905727712,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.0240s\n"}
,{"stream_name":"stderr","time":164.906070768,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.90608165,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.906113966,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":164.906366245,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.92s/s]\n"}
,{"stream_name":"stdout","time":164.906422885,"data":"\n"}
,{"stream_name":"stdout","time":164.906431933,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":164.906435864,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":164.908013105,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":164.908293875,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.908305084,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.908310061,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.90831406,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.9084772,"data":"\n"}
,{"stream_name":"stdout","time":164.927787931,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":164.92780496,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.927822388,"data":"  Original dt: 4.606835e-01 s\n"}
,{"stream_name":"stdout","time":164.927826845,"data":"  Corrected dt: 2.879272e-01 s\n"}
,{"stream_name":"stdout","time":164.927830797,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.927834884,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":165.356460678,"data":"[PROGRESS] Step 300: t=89.40/90.00s (99.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":165.385062558,"data":"  Stored output at t = 90.0000 s (Step 303)\n"}
,{"stream_name":"stderr","time":165.38510016,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.385118172,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.385359082,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.47s/s]\n"}
,{"stream_name":"stdout","time":165.385366561,"data":"\n"}
,{"stream_name":"stdout","time":165.38540631,"data":"Simulation finished at t = 90.0000 s after 303 steps.\n"}
,{"stream_name":"stdout","time":165.385412496,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":165.387122911,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.387435928,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.387451742,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.387456814,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.387460993,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.387648021,"data":"\n"}
,{"stream_name":"stdout","time":165.809726793,"data":"[PROGRESS] Step 350: t=103.53/105.00s (98.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":165.82854086,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":165.828559383,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.82856494,"data":"  Original dt: 4.606418e-01 s\n"}
,{"stream_name":"stdout","time":165.828569273,"data":"  Corrected dt: 2.879011e-01 s\n"}
,{"stream_name":"stdout","time":165.82857301,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.82857726,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":165.864156807,"data":"  Stored output at t = 105.0000 s (Step 356)\n"}
,{"stream_name":"stderr","time":165.86416964,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.864193236,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.8645013,"data":"\n"}
,{"stream_name":"stdout","time":165.864519915,"data":"Simulation finished at t = 105.0000 s after 356 steps.\n"}
,{"stream_name":"stdout","time":165.864525568,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":165.864501345,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.47s/s]\n"}
,{"stream_name":"stdout","time":165.866279543,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.866605661,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.866617312,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.866622342,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.866626143,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.866772159,"data":"\n"}
,{"stream_name":"stdout","time":166.262161322,"data":"[PROGRESS] Step 400: t=117.67/120.00s (98.1%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":166.344108501,"data":"  Stored output at t = 120.0000 s (Step 409)\n"}
,{"stream_name":"stderr","time":166.344112885,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.344136481,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.34440569,"data":"\n"}
,{"stream_name":"stdout","time":166.344419108,"data":"Simulation finished at t = 120.0000 s after 409 steps.\n"}
,{"stream_name":"stdout","time":166.344424126,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":166.34442915,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.42s/s]\n"}
,{"stream_name":"stdout","time":166.346054764,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.34607273,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":166.346080574,"data":"\n"}
,{"stream_name":"stdout","time":166.346085117,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.34609053,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":166.346095152,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.346099581,"data":"\n"}
,{"stream_name":"stdout","time":166.346170947,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":166.346177282,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":166.353994559,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":166.354012454,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":166.354017541,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":166.354022089,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":166.354039979,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":166.354129139,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":166.354137266,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":166.354141479,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":166.354144914,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":166.354192772,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.354205489,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":166.354217441,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":166.354861697,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":166.35487877,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":166.355103187,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":166.355321054,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.355331461,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.355336327,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.357294718,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.357311353,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.357316441,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.357320575,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.357455017,"data":"\n"}
,{"stream_name":"stdout","time":166.736660595,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":166.736713305,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.736728839,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.736889123,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.56s/s]\n"}
,{"stream_name":"stdout","time":166.736897777,"data":"\n"}
,{"stream_name":"stdout","time":166.736907892,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":166.7369129,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":166.738351988,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":166.73836902,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":166.738591243,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":166.738605193,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":166.738771278,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":166.738933471,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":166.739093766,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":166.739251598,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":166.739258078,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":166.739332565,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":166.739402566,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":166.739425427,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":166.739476356,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":166.739535416,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":166.739575119,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.739884206,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.739892148,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.739897189,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.739901321,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.740046756,"data":"\n"}
,{"stream_name":"stdout","time":166.750179879,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":166.750194759,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.750199122,"data":"  Original dt: 4.840157e-01 s\n"}
,{"stream_name":"stdout","time":166.750202847,"data":"  Corrected dt: 3.025098e-01 s\n"}
,{"stream_name":"stdout","time":166.75020816400001,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.750211853,"data":"  Max wave speed detected: 16.53 m/s\n"}
,{"stream_name":"stdout","time":166.813593835,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":167.20155095,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":167.201593367,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.20160947,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":167.201703639,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.52s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.51s/s]\n"}
,{"stream_name":"stdout","time":167.201726697,"data":"\n"}
,{"stream_name":"stdout","time":167.201736178,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":167.201740975,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":167.203724645,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.223303118,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":167.223477042,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.22349211,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.223496579,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.223502078,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.223724653,"data":"\n"}
,{"stream_name":"stdout","time":167.286110989,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":167.691455674,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":167.691484546,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.691490661,"data":"  Original dt: 4.612226e-01 s\n"}
,{"stream_name":"stdout","time":167.691494863,"data":"  Corrected dt: 2.882641e-01 s\n"}
,{"stream_name":"stdout","time":167.691499526,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.691503299,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":167.708938669,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":167.708948863,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.708979484,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.709225299,"data":"\n"}
,{"stream_name":"stdout","time":167.709234365,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":167.709239272,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":167.709243029,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.91s/s]\n"}
,{"stream_name":"stdout","time":167.710841793,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.711139253,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.711147306,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.711151541,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.711155393,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.711322385,"data":"\n"}
,{"stream_name":"stdout","time":167.756618236,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":168.198033251,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":168.198060575,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.198087323,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.198273906,"data":"\n"}
,{"stream_name":"stderr","time":168.198277248,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.82s/s]\n"}
,{"stream_name":"stdout","time":168.198281553,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":168.198290943,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":168.199865107,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.200275341,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.200284732,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.200289018,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.200292947,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.200470338,"data":"\n"}
,{"stream_name":"stdout","time":168.219243444,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":168.601076315,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":168.601104914,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.601110432,"data":"  Original dt: 4.613428e-01 s\n"}
,{"stream_name":"stdout","time":168.60111458,"data":"  Corrected dt: 2.883392e-01 s\n"}
,{"stream_name":"stdout","time":168.601118811,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.601122437,"data":"  Max wave speed detected: 17.34 m/s\n"}
,{"stream_name":"stdout","time":168.661897962,"data":"[PROGRESS] Step 250: t=74.99/75.00s (100.0%) | dt=0.2884s\n"}
,{"stream_name":"stdout","time":168.670713436,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stderr","time":168.670758274,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.670766785,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":168.670979199,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.89s/s]\n"}
,{"stream_name":"stdout","time":168.671018505,"data":"\n"}
,{"stream_name":"stdout","time":168.671032304,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":168.671036599,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":168.672552855,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.672836582,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.672843333,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.672847643,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.672851479,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.673008971,"data":"\n"}
,{"stream_name":"stdout","time":169.108734902,"data":"[PROGRESS] Step 300: t=89.13/90.00s (99.0%) | dt=0.2885s\n"}
,{"stream_name":"stderr","time":169.144511979,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":169.144509367,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":169.144534143,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.144836697,"data":"\n"}
,{"stream_name":"stdout","time":169.144845682,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stderr","time":169.144842646,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.81s/s]\n"}
,{"stream_name":"stdout","time":169.144850641,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":169.146500927,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.146865552,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.146873973,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.1468782,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.146882141,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.147049176,"data":"\n"}
,{"stream_name":"stdout","time":169.491509667,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":169.491534955,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.491541015,"data":"  Original dt: 4.612531e-01 s\n"}
,{"stream_name":"stdout","time":169.491544942,"data":"  Corrected dt: 2.882832e-01 s\n"}
,{"stream_name":"stdout","time":169.491549301,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.491552992,"data":"  Max wave speed detected: 17.34 m/s\n"}
,{"stream_name":"stdout","time":169.554134341,"data":"[PROGRESS] Step 350: t=103.27/105.00s (98.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":169.617527877,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":169.61756318,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.617578324,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.617878943,"data":"\n"}
,{"stream_name":"stdout","time":169.61790547,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":169.617910715,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":169.617877105,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.88s/s]\n"}
,{"stream_name":"stdout","time":169.619777381,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.620052826,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.620063966,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.620068584,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.620072644,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.620228916,"data":"\n"}
,{"stream_name":"stdout","time":170.00969457,"data":"[PROGRESS] Step 400: t=117.39/120.00s (97.8%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":170.099684398,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":170.099684352,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.09971982,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.099949065,"data":"\n"}
,{"stream_name":"stderr","time":170.099955941,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.28s/s]\n"}
,{"stream_name":"stdout","time":170.099967762,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":170.099989651,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":170.10153685,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.101554254,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":170.101559527,"data":"\n"}
,{"stream_name":"stdout","time":170.101563167,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.101567417,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":170.101571486,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.10157513,"data":"\n"}
,{"stream_name":"stdout","time":170.101579059,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":170.101583387,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":170.108776959,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":170.108803868,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":170.108808754,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":170.108812381,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":170.108816009,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":170.108819571,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":170.108823247,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":170.108826931,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":170.108830587,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":170.108834202,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.108837924,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":170.108842756,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":170.109370257,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":170.109403154,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":170.109626476,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":170.109839608,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.10985267,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.109857165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.111674984,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.111689805,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.111694393,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.111698335,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.111852413,"data":"\n"}
,{"stream_name":"stdout","time":170.416800525,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":170.41682336,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.416828368,"data":"  Original dt: 4.982632e-01 s\n"}
,{"stream_name":"stdout","time":170.416832173,"data":"  Corrected dt: 3.114145e-01 s\n"}
,{"stream_name":"stdout","time":170.416835919,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.416839991,"data":"  Max wave speed detected: 16.06 m/s\n"}
,{"stream_name":"stdout","time":170.499658969,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":170.499667386,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.499689718,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.499851536,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.68s/s]\n"}
,{"stream_name":"stdout","time":170.499880631,"data":"\n"}
,{"stream_name":"stdout","time":170.499889251,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":170.499893781,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":170.501319568,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":170.501333061,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":170.501681809,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":170.501699717,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":170.501769176,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":170.501974149,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":170.502162977,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":170.502342488,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":170.502348982,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":170.502460416,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":170.502542815,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":170.502564763,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":170.50261841,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":170.50263783,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":170.502701445,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.503074427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.503085456,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.503090766,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.503095257,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.503268171,"data":"\n"}
,{"stream_name":"stdout","time":170.578338015,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":170.968697657,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":170.968705809,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.968739187,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.968993682,"data":"\n"}
,{"stream_name":"stdout","time":170.969004123,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stderr","time":170.969014693,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.22s/s]\n"}
,{"stream_name":"stdout","time":170.969020853,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":170.970682937,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.970982482,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.970989753,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.970994894,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.970999457,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.971164558,"data":"\n"}
,{"stream_name":"stdout","time":171.03345288,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":171.32832593,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":171.328353741,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.32836323,"data":"  Original dt: 4.621224e-01 s\n"}
,{"stream_name":"stdout","time":171.328366696,"data":"  Corrected dt: 2.888265e-01 s\n"}
,{"stream_name":"stdout","time":171.328370593,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.328373954,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stderr","time":171.440459565,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.440488073,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.440519329,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":171.44079386,"data":"\n"}
,{"stream_name":"stdout","time":171.440805194,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":171.440809502,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":171.440821778,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.96s/s]\n"}
,{"stream_name":"stdout","time":171.442350526,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.442664432,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.442680184,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.442685361,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.442689162,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.44284584,"data":"\n"}
,{"stream_name":"stdout","time":171.493712814,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":171.936449352,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.936482245,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.936450523,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":171.936706476,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.38s/s]\n"}
,{"stream_name":"stdout","time":171.936742469,"data":"\n"}
,{"stream_name":"stdout","time":171.936767082,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":171.936771838,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":171.938254616,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":171.938719419,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.938731344,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.938735677,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.938739777,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.938897686,"data":"\n"}
,{"stream_name":"stdout","time":171.966659867,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":172.267207209,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":172.267232287,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.267237986,"data":"  Original dt: 4.617618e-01 s\n"}
,{"stream_name":"stdout","time":172.267242346,"data":"  Corrected dt: 2.886012e-01 s\n"}
,{"stream_name":"stdout","time":172.267246463,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.267250661,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":172.409653902,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":172.409663086,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.409685839,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.409916073,"data":"\n"}
,{"stream_name":"stdout","time":172.409930089,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":172.409934709,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":172.409949758,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.86s/s]\n"}
,{"stream_name":"stdout","time":172.411532482,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.411836443,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.411847217,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.411852029,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.411856003,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.412006117,"data":"\n"}
,{"stream_name":"stdout","time":172.420609212,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":172.888513782,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":172.898241757,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.898274516,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.898248039,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stdout","time":172.898556976,"data":"\n"}
,{"stream_name":"stdout","time":172.898578171,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":172.898583289,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":172.89855555,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.85s/s]\n"}
,{"stream_name":"stdout","time":172.900033792,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.900344137,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.90035103,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.90035514,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.900358989,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.900559401,"data":"\n"}
,{"stream_name":"stdout","time":173.184860215,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":173.184888718,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.184894318,"data":"  Original dt: 4.617537e-01 s\n"}
,{"stream_name":"stdout","time":173.184898481,"data":"  Corrected dt: 2.885960e-01 s\n"}
,{"stream_name":"stdout","time":173.184902776,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.184906521,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":173.33480531,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":173.361442621,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.361464937,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.361479203,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":173.361784569,"data":"\n"}
,{"stream_name":"stdout","time":173.36179293,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":173.361797676,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":173.36180346,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.54s/s]\n"}
,{"stream_name":"stdout","time":173.363366127,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":173.363698207,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.363708956,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.363713321,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.363717114,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.363883367,"data":"\n"}
,{"stream_name":"stdout","time":173.780916631,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":173.827037909,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":173.827041868,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.827064983,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.827357186,"data":"\n"}
,{"stream_name":"stdout","time":173.827365515,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":173.827370033,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":173.827400231,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.38s/s]\n"}
,{"stream_name":"stdout","time":173.828935243,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":173.828950373,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":173.828955379,"data":"\n"}
,{"stream_name":"stdout","time":173.828959591,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.828964172,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.05 | Avg Reward/Step: 0.006\n"}
,{"stream_name":"stdout","time":173.828969088,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.828973393,"data":"\n"}
,{"stream_name":"stdout","time":173.828980166,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":173.828985236,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":173.835903087,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":173.835921541,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":173.835926672,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":173.835931208,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":173.835935418,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":173.83607182,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":173.836082185,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":173.836086522,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":173.83609063,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":173.836094806,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.836122129,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":173.836133925,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":173.836783245,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":173.836797441,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":173.837043867,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":173.837290444,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.837302589,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.837306956,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.839049731,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":173.839062748,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":173.839067003,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":173.839070861,"data":"|    ep_rew_mean      | 0.0975   |\n"}
,{"stream_name":"stdout","time":173.839074423,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":173.83907816,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":173.83908148,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":173.839083953,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":173.839086758,"data":"|    time_elapsed     | 32       |\n"}
,{"stream_name":"stdout","time":173.839089161,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":173.83909157,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":173.840354536,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.840370502,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.840396588,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.840401784,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.840558203,"data":"\n"}
,{"stream_name":"stdout","time":174.095285442,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":174.095311631,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.095317567,"data":"  Original dt: 5.067758e-01 s\n"}
,{"stream_name":"stdout","time":174.095322215,"data":"  Corrected dt: 3.167349e-01 s\n"}
,{"stream_name":"stdout","time":174.095325907,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.095329544,"data":"  Max wave speed detected: 15.79 m/s\n"}
,{"stream_name":"stdout","time":174.220537751,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":174.220577456,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.220593428,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.220820392,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.47s/s]\n"}
,{"stream_name":"stdout","time":174.220826549,"data":"\n"}
,{"stream_name":"stdout","time":174.220837588,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":174.22084229,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":174.22231787,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":174.222335568,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":174.222646073,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":174.222663488,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":174.222841759,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":174.223025428,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":174.223224733,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":174.223469724,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":174.223489286,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":174.223619942,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":174.223693521,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":174.223775209,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":174.223782966,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":174.223844377,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":174.223862709,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":174.224228217,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.224252935,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.224257777,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.224261866,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.224420806,"data":"\n"}
,{"stream_name":"stdout","time":174.296135878,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":174.687400079,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":174.687441785,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.687458374,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.687847128,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.40s/s]\n"}
,{"stream_name":"stdout","time":174.687873767,"data":"\n"}
,{"stream_name":"stdout","time":174.687887302,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":174.687892207,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":174.689497518,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.689759828,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.689769142,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.689773684,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.689777652,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.68992976,"data":"\n"}
,{"stream_name":"stdout","time":174.744262995,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2891s\n"}
,{"stream_name":"stdout","time":174.995747777,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":174.995787672,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.995793358,"data":"  Original dt: 4.611760e-01 s\n"}
,{"stream_name":"stdout","time":174.995797785,"data":"  Corrected dt: 2.882350e-01 s\n"}
,{"stream_name":"stdout","time":174.995801812,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.995806237,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":175.155181612,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":175.155227977,"data":"\n"}
,{"stream_name":"stdout","time":175.155233923,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":175.155237726,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":175.155253563,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.155269508,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.155288567,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.25s/s]\n"}
,{"stream_name":"stdout","time":175.1569543,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.157157109,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.157165267,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.157169729,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.157173613,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.157334443,"data":"\n"}
,{"stream_name":"stdout","time":175.193891843,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2880s\n"}
,{"stream_name":"stderr","time":175.629638903,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.629664113,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.62967815,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stdout","time":175.629955926,"data":"\n"}
,{"stream_name":"stderr","time":175.629955793,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.76s/s]\n"}
,{"stream_name":"stdout","time":175.629965626,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":175.629976593,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":175.631459334,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.631956634,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.631965217,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.631970174,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.631974137,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.632142742,"data":"\n"}
,{"stream_name":"stdout","time":175.64153042,"data":"[PROGRESS] Step 200: t=60.29/75.00s (80.4%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":175.897279052,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":175.897307157,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.897314351,"data":"  Original dt: 4.611194e-01 s\n"}
,{"stream_name":"stdout","time":175.897320299,"data":"  Corrected dt: 2.881996e-01 s\n"}
,{"stream_name":"stdout","time":175.897326099,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.897344904,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":176.091638808,"data":"[PROGRESS] Step 250: t=74.70/75.00s (99.6%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":176.109550054,"data":"  Stored output at t = 75.0000 s (Step 252)\n"}
,{"stream_name":"stderr","time":176.109593241,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.109603648,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":176.109776862,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.42s/s]\n"}
,{"stream_name":"stdout","time":176.109778748,"data":"\n"}
,{"stream_name":"stdout","time":176.109795617,"data":"Simulation finished at t = 75.0000 s after 252 steps.\n"}
,{"stream_name":"stdout","time":176.10980041,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":176.11127516,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.111613262,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.111625302,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.111630234,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.111634248,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.111784537,"data":"\n"}
,{"stream_name":"stdout","time":176.53277868200001,"data":"[PROGRESS] Step 300: t=88.82/90.00s (98.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":176.578763755,"data":"  Stored output at t = 90.0000 s (Step 305)\n"}
,{"stream_name":"stderr","time":176.578768773,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.57879108,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.579094462,"data":"\n"}
,{"stream_name":"stdout","time":176.579120137,"data":"Simulation finished at t = 90.0000 s after 305 steps.\n"}
,{"stream_name":"stdout","time":176.579125643,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":176.579136003,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.12s/s]\n"}
,{"stream_name":"stdout","time":176.580667907,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":176.580957781,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.580965636,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.580969862,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.580984715,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.581131096,"data":"\n"}
,{"stream_name":"stdout","time":176.784856248,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":176.784883711,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.784889363,"data":"  Original dt: 4.606570e-01 s\n"}
,{"stream_name":"stdout","time":176.784893654,"data":"  Corrected dt: 2.879106e-01 s\n"}
,{"stream_name":"stdout","time":176.784897927,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.784901985,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":176.986841554,"data":"[PROGRESS] Step 350: t=102.96/105.00s (98.1%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":177.059072801,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":177.059375766,"data":"  Stored output at t = 105.0000 s (Step 358)\n"}
,{"stream_name":"stderr","time":177.059416895,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.059697771,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.36s/s]\n"}
,{"stream_name":"stdout","time":177.059718754,"data":"\n"}
,{"stream_name":"stdout","time":177.059726293,"data":"Simulation finished at t = 105.0000 s after 358 steps.\n"}
,{"stream_name":"stdout","time":177.059731178,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":177.061242491,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.061558919,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.061574967,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.061580257,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.061584106,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.061727643,"data":"\n"}
,{"stream_name":"stdout","time":177.433222164,"data":"[PROGRESS] Step 400: t=117.09/120.00s (97.6%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":177.531307302,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":177.531316342,"data":"  Stored output at t = 120.0000 s (Step 411)\n"}
,{"stream_name":"stderr","time":177.531334581,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.531570099,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.94s/s]\n"}
,{"stream_name":"stdout","time":177.531585114,"data":"\n"}
,{"stream_name":"stdout","time":177.5315994,"data":"Simulation finished at t = 120.0000 s after 411 steps.\n"}
,{"stream_name":"stdout","time":177.53160413,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":177.533311818,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.533327965,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":177.533353538,"data":"\n"}
,{"stream_name":"stdout","time":177.533358764,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.533363507,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":177.533368197,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.533372683,"data":"\n"}
,{"stream_name":"stdout","time":177.533393499,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.533408242,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.540627643,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.540644637,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.540651167,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.540655027,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.540660391,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.540737568,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.540744791,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.540749293,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.540753514,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.540757828,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.540777857,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.540785807,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.541345902,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.54135871,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.541605367,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.541826513,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.541837123,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.541841957,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.543670293,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.543686512,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.543691651,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.543709139,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.543843464,"data":"\n"}
,{"stream_name":"stdout","time":177.694106077,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":177.694127136,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.694132559,"data":"  Original dt: 5.434493e-01 s\n"}
,{"stream_name":"stdout","time":177.694136666,"data":"  Corrected dt: 3.396558e-01 s\n"}
,{"stream_name":"stdout","time":177.694140482,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.694144457,"data":"  Max wave speed detected: 14.72 m/s\n"}
,{"stream_name":"stderr","time":177.915681177,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":177.915700956,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":177.915707075,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.915802376,"data":"\n"}
,{"stream_name":"stdout","time":177.915811649,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":177.915815846,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":177.91583166,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.35s/s]\n"}
,{"stream_name":"stdout","time":177.917455008,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":177.917472081,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":177.91771499,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":177.917725515,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":177.917903552,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":177.918075112,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":177.9182489,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":177.918453078,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":177.918464085,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":177.918549752,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":177.918600437,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":177.918681291,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":177.918692338,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":177.918698133,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":177.918755392,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":177.919109905,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.919120499,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.919125148,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.91912876,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.919277476,"data":"\n"}
,{"stream_name":"stdout","time":177.991188311,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":178.38320695,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":178.383206948,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.383258284,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":178.383287637,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.34s/s]\n"}
,{"stream_name":"stdout","time":178.383302428,"data":"\n"}
,{"stream_name":"stdout","time":178.383332614,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":178.383337482,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":178.385020016,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.385315538,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.385326353,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.385330789,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.385334763,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.385502034,"data":"\n"}
,{"stream_name":"stdout","time":178.437971937,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2895s\n"}
,{"stream_name":"stdout","time":178.588981685,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":178.589007139,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.589012537,"data":"  Original dt: 4.624184e-01 s\n"}
,{"stream_name":"stdout","time":178.589018302,"data":"  Corrected dt: 2.890115e-01 s\n"}
,{"stream_name":"stdout","time":178.589022339,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.589026501,"data":"  Max wave speed detected: 17.30 m/s\n"}
,{"stream_name":"stderr","time":178.845096252,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.845118179,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.845095517,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":178.845356194,"data":"\n"}
,{"stream_name":"stdout","time":178.84539676,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":178.845407422,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":178.845422745,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.63s/s]\n"}
,{"stream_name":"stdout","time":178.846981575,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.847295068,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.847302751,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.847306903,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.84731068,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.847502858,"data":"\n"}
,{"stream_name":"stdout","time":178.884087508,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":179.316102443,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":179.31610115,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.31614273,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.316248853,"data":"\n"}
,{"stream_name":"stdout","time":179.316263489,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":179.31626903,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":179.316248117,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":179.317928048,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":179.318363016,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.318376422,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.318409518,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.318414145,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.318583193,"data":"\n"}
,{"stream_name":"stdout","time":179.337675972,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":179.496887304,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":179.496914907,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.496920748,"data":"  Original dt: 4.608110e-01 s\n"}
,{"stream_name":"stdout","time":179.496925399,"data":"  Corrected dt: 2.880069e-01 s\n"}
,{"stream_name":"stdout","time":179.496945282,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.496949626,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":179.793333224,"data":"[PROGRESS] Step 250: t=74.98/75.00s (100.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":179.802798728,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.802819663,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.802800245,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stderr","time":179.803043975,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.98s/s]\n"}
,{"stream_name":"stdout","time":179.803063865,"data":"\n"}
,{"stream_name":"stdout","time":179.803068426,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":179.803072245,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":179.805318506,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.805653862,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.805665854,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.805671161,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.805675531,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.805835163,"data":"\n"}
,{"stream_name":"stdout","time":180.244519726,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":180.282428368,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":180.282430142,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.282453303,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":180.282789169,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.47s/s]\n"}
,{"stream_name":"stdout","time":180.282792364,"data":"\n"}
,{"stream_name":"stdout","time":180.282810422,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":180.282814749,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":180.284412105,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":180.284729348,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.284736411,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.284751936,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.284755889,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.284907432,"data":"\n"}
,{"stream_name":"stdout","time":180.405916569,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":180.405938532,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.405942914,"data":"  Original dt: 4.607242e-01 s\n"}
,{"stream_name":"stdout","time":180.405946752,"data":"  Corrected dt: 2.879526e-01 s\n"}
,{"stream_name":"stdout","time":180.405950372,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.405955694,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":180.709424008,"data":"[PROGRESS] Step 350: t=103.25/105.00s (98.3%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":180.776820636,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":180.776895039,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.776912158,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":180.7771569,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.49s/s]\n"}
,{"stream_name":"stdout","time":180.777162549,"data":"\n"}
,{"stream_name":"stdout","time":180.77717782,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":180.777182045,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":180.778868638,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":180.779238518,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.779246356,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.779251164,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.779255597,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.7794405,"data":"\n"}
,{"stream_name":"stdout","time":181.171323515,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":181.261482373,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":181.261489924,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.261526035,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.261784975,"data":"\n"}
,{"stream_name":"stdout","time":181.261795209,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":181.261799926,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":181.2618006,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.11s/s]\n"}
,{"stream_name":"stdout","time":181.263634596,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":181.263662988,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":181.26366821,"data":"\n"}
,{"stream_name":"stdout","time":181.263671991,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":181.263676497,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":181.263681061,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":181.263685778,"data":"\n"}
,{"stream_name":"stdout","time":181.263690136,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":181.263694945,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":181.270679892,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":181.270696254,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":181.270700879,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":181.270704954,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":181.270708594,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":181.270795214,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":181.270801821,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":181.270805612,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":181.270809604,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":181.27082393,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.270836424,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":181.270840235,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":181.271429284,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":181.271445682,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":181.271725491,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":181.272315134,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.27232583,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.272330626,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.274040837,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.274057907,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.274073867,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.274078159,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.274203387,"data":"\n"}
,{"stream_name":"stdout","time":181.339093318,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":181.339110184,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.3391151,"data":"  Original dt: 6.434348e-01 s\n"}
,{"stream_name":"stdout","time":181.339119068,"data":"  Corrected dt: 4.021468e-01 s\n"}
,{"stream_name":"stdout","time":181.339124228,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.33912718,"data":"  Max wave speed detected: 12.43 m/s\n"}
,{"stream_name":"stderr","time":181.687473108,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.687500218,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.687523089,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":181.687902044,"data":"\n"}
,{"stream_name":"stdout","time":181.68791087,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":181.687915558,"data":"Total runtime: 0.41 seconds.\n"}
,{"stream_name":"stderr","time":181.687928219,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.28s/s]\n"}
,{"stream_name":"stdout","time":181.689423337,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":181.68943761,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":181.689690475,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":181.689705098,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":181.689840706,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":181.68998761,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":181.690170966,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":181.690340774,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":181.6903552,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":181.690427514,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.690504901,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.690571394,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.690581192,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.690605386,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":181.690651534,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":181.690996601,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.691006826,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.691011896,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.691015461,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.691166077,"data":"\n"}
,{"stream_name":"stdout","time":181.763779998,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":182.146373019,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":182.146373025,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.146429108,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":182.146683582,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.95s/s]\n"}
,{"stream_name":"stdout","time":182.146691103,"data":"\n"}
,{"stream_name":"stdout","time":182.14672218,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":182.146727858,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":182.148330147,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.14864075,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.148663512,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.148668234,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.148672308,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.148801784,"data":"\n"}
,{"stream_name":"stdout","time":182.211787366,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":182.276135233,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":182.276152479,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.276157471,"data":"  Original dt: 4.628809e-01 s\n"}
,{"stream_name":"stdout","time":182.276162836,"data":"  Corrected dt: 2.893005e-01 s\n"}
,{"stream_name":"stdout","time":182.276165513,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.276168091,"data":"  Max wave speed detected: 17.28 m/s\n"}
,{"stream_name":"stderr","time":182.614498751,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.614538926,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":182.614503336,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":182.61465965,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":182.614662197,"data":"\n"}
,{"stream_name":"stdout","time":182.614682163,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":182.614694011,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":182.616256074,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.61661871,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.616629702,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.61665852,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.616663627,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.616836364,"data":"\n"}
,{"stream_name":"stdout","time":182.662058951,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":183.084463848,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.084491106,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":183.084468551,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":183.08469764,"data":"\n"}
,{"stream_name":"stderr","time":183.08470177,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.09s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.08s/s]\n"}
,{"stream_name":"stdout","time":183.084707138,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":183.084715179,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":183.086187159,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.086685915,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.086698374,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.086702934,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.086707023,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.086865828,"data":"\n"}
,{"stream_name":"stdout","time":183.113743284,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":183.177162417,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":183.177183965,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.177206007,"data":"  Original dt: 4.617743e-01 s\n"}
,{"stream_name":"stdout","time":183.177211286,"data":"  Corrected dt: 2.886090e-01 s\n"}
,{"stream_name":"stdout","time":183.177215645,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.177220107,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":183.562147317,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.0006s\n"}
,{"stream_name":"stdout","time":183.562508178,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":183.56255161,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.562567811,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":183.562852534,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.53s/s]\n"}
,{"stream_name":"stdout","time":183.562857085,"data":"\n"}
,{"stream_name":"stdout","time":183.56287076,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":183.562874775,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":183.564434111,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":183.564751621,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.564764314,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.564769248,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.564773677,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.564917928,"data":"\n"}
,{"stream_name":"stdout","time":184.016817697,"data":"[PROGRESS] Step 300: t=89.40/90.00s (99.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":184.043247396,"data":"  Stored output at t = 90.0000 s (Step 303)\n"}
,{"stream_name":"stderr","time":184.043258126,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.043283987,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":184.043605948,"data":"\n"}
,{"stream_name":"stdout","time":184.043621065,"data":"Simulation finished at t = 90.0000 s after 303 steps.\n"}
,{"stream_name":"stdout","time":184.043635467,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":184.04360601,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.35s/s]\n"}
,{"stream_name":"stdout","time":184.045262834,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":184.045607802,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.045638679,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.045643727,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.045647613,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":184.045784697,"data":"\n"}
,{"stream_name":"stdout","time":184.081703235,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":184.081721457,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.081727967,"data":"  Original dt: 4.606782e-01 s\n"}
,{"stream_name":"stdout","time":184.08173099,"data":"  Corrected dt: 2.879238e-01 s\n"}
,{"stream_name":"stdout","time":184.081733495,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.081736412,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":184.463238848,"data":"[PROGRESS] Step 350: t=103.53/105.00s (98.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":184.518300128,"data":"  Stored output at t = 105.0000 s (Step 356)\n"}
,{"stream_name":"stderr","time":184.518318127,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.518335466,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":184.518437629,"data":"\n"}
,{"stream_name":"stderr","time":184.518444422,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.75s/s]\n"}
,{"stream_name":"stdout","time":184.51845055,"data":"Simulation finished at t = 105.0000 s after 356 steps.\n"}
,{"stream_name":"stdout","time":184.518458975,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":184.520087881,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":184.520423314,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.52043482,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.520439825,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.520444703,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":184.520629009,"data":"\n"}
,{"stream_name":"stdout","time":184.911888669,"data":"[PROGRESS] Step 400: t=117.67/120.00s (98.1%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":184.977202189,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":184.977230223,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.977236711,"data":"  Original dt: 4.607609e-01 s\n"}
,{"stream_name":"stdout","time":184.977241294,"data":"  Corrected dt: 2.879756e-01 s\n"}
,{"stream_name":"stdout","time":184.977245425,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.977250055,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":184.993956349,"data":"  Stored output at t = 120.0000 s (Step 409)\n"}
,{"stream_name":"stderr","time":184.993995578,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.994012609,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":184.994272516,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.69s/s]\n"}
,{"stream_name":"stdout","time":184.994276754,"data":"\n"}
,{"stream_name":"stdout","time":184.994291564,"data":"Simulation finished at t = 120.0000 s after 409 steps.\n"}
,{"stream_name":"stdout","time":184.994295707,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":184.995956405,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":184.995975329,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":184.995980728,"data":"\n"}
,{"stream_name":"stdout","time":184.995984574,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.995988392,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":184.995992247,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.995997832,"data":"\n"}
,{"stream_name":"stdout","time":184.996001546,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.996004561,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":185.002893606,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":185.002910934,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":185.00291635,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":185.00292042,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":185.002951771,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":185.003043551,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":185.003056151,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":185.003060513,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":185.003065068,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":185.003074632,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.003080099,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":185.00308423,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":185.003707122,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":185.003723475,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":185.003938247,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":185.004466725,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.004481531,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.004486714,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.006214448,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.006229958,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.006234732,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.006238591,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":185.006368127,"data":"\n"}
,{"stream_name":"stdout","time":185.383988066,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":185.38400984,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":185.38402104,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":185.384281703,"data":"\n"}
,{"stream_name":"stdout","time":185.384296265,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":185.384301156,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":185.384303307,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.72s/s]\n"}
,{"stream_name":"stdout","time":185.385795888,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":185.38581243,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":185.385996051,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":185.386005601,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":185.386153019,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":185.386303031,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":185.386490227,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":185.386671922,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":185.38667908,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":185.386757314,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.386824295,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.386889816,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.386911606,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.386956453,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":185.38698902,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":185.387399693,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.387413786,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.387419611,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.387424054,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":185.387568039,"data":"\n"}
,{"stream_name":"stdout","time":185.460451647,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":185.851651422,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":185.851688299,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":185.851703829,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":185.851943685,"data":"\n"}
,{"stream_name":"stdout","time":185.851953682,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":185.851958412,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":185.851956331,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.32s/s]\n"}
,{"stream_name":"stdout","time":185.8534259,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":185.853735604,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.853743537,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.853747909,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.853751804,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":185.853904964,"data":"\n"}
,{"stream_name":"stdout","time":185.899577741,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":185.899595535,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.899600588,"data":"  Original dt: 4.634440e-01 s\n"}
,{"stream_name":"stdout","time":185.89960605,"data":"  Corrected dt: 2.896525e-01 s\n"}
,{"stream_name":"stdout","time":185.89960988,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.899612631,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stdout","time":185.915985938,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":186.324894862,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":186.324950327,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":186.324978859,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":186.325033074,"data":"\n"}
,{"stream_name":"stdout","time":186.325044002,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":186.325048385,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":186.32507862,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.85s/s]\n"}
,{"stream_name":"stdout","time":186.326726153,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":186.326945345,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.32695434,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.326959517,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.32696385,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":186.327147773,"data":"\n"}
,{"stream_name":"stdout","time":186.370959743,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2882s\n"}
,{"stream_name":"stderr","time":186.798482196,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":186.798482194,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":186.798510798,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":186.798753043,"data":"\n"}
,{"stream_name":"stdout","time":186.798767884,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":186.798773062,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":186.798790452,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.83s/s]\n"}
,{"stream_name":"stdout","time":186.800338174,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":186.800765514,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.800783913,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.800789347,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.800793402,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":186.800919104,"data":"\n"}
,{"stream_name":"stdout","time":186.801902385,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":186.801917888,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.801936838,"data":"  Original dt: 4.611000e-01 s\n"}
,{"stream_name":"stdout","time":186.801942797,"data":"  Corrected dt: 2.881875e-01 s\n"}
,{"stream_name":"stdout","time":186.801946169,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.801948716,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":186.818605698,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":187.27245241,"data":"[PROGRESS] Step 250: t=74.99/75.00s (100.0%) | dt=0.2884s\n"}
,{"stream_name":"stdout","time":187.282506007,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stderr","time":187.282529897,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":187.282540002,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":187.282885212,"data":"\n"}
,{"stream_name":"stdout","time":187.28289224,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":187.282896543,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":187.282902448,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":187.284593346,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":187.284915866,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.284923454,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.284928363,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.284932884,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":187.285110134,"data":"\n"}
,{"stream_name":"stdout","time":187.707919091,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":187.70794698,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.707952991,"data":"  Original dt: 4.610823e-01 s\n"}
,{"stream_name":"stdout","time":187.707957429,"data":"  Corrected dt: 2.881765e-01 s\n"}
,{"stream_name":"stdout","time":187.707961543,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.707966081,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":187.724932109,"data":"[PROGRESS] Step 300: t=89.13/90.00s (99.0%) | dt=0.2882s\n"}
,{"stream_name":"stderr","time":187.76146867,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":187.761493104,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":187.76151277,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":187.761828221,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.48s/s]\n"}
,{"stream_name":"stdout","time":187.761833867,"data":"\n"}
,{"stream_name":"stdout","time":187.761882285,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":187.76188682,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":187.763490474,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":187.763820752,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.763833959,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.76383968,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.763843963,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":187.764001133,"data":"\n"}
,{"stream_name":"stdout","time":188.180836993,"data":"[PROGRESS] Step 350: t=103.25/105.00s (98.3%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":188.244326583,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":188.244461806,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":188.244484712,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":188.24464617,"data":"\n"}
,{"stream_name":"stderr","time":188.244644714,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.22s/s]\n"}
,{"stream_name":"stdout","time":188.244656242,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":188.244667583,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":188.246192607,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":188.246488087,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.24650436,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.246509239,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.246513124,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":188.246651774,"data":"\n"}
,{"stream_name":"stdout","time":188.615179717,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":188.615203258,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.615208524,"data":"  Original dt: 4.610190e-01 s\n"}
,{"stream_name":"stdout","time":188.6152127,"data":"  Corrected dt: 2.881369e-01 s\n"}
,{"stream_name":"stdout","time":188.615216529,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.615224592,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":188.632022421,"data":"[PROGRESS] Step 400: t=117.39/120.00s (97.8%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":188.721240344,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":188.721263552,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":188.721270083,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":188.72147071,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.61s/s]\n"}
,{"stream_name":"stdout","time":188.72150469,"data":"\n"}
,{"stream_name":"stdout","time":188.721515185,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":188.721519378,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":188.722999855,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":188.723014571,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":188.723019301,"data":"\n"}
,{"stream_name":"stdout","time":188.72302372,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":188.72302799,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":188.723033134,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":188.72303747,"data":"\n"}
,{"stream_name":"stdout","time":188.723045123,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":188.723049992,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":188.730438577,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":188.730456504,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":188.730461313,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":188.730465129,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":188.730468857,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":188.730545779,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":188.730554483,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":188.730558937,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":188.730563062,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":188.730567403,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.730600471,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":188.730607447,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":188.731213015,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":188.731220925,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":188.731514035,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":188.731780617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.731787931,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.731792646,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.73369505,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":188.733705428,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":188.733709864,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":188.733714046,"data":"|    ep_rew_mean      | 0.0975   |\n"}
,{"stream_name":"stdout","time":188.733718219,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":188.733722037,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":188.733725562,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":188.733729151,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":188.733734416,"data":"|    time_elapsed     | 47       |\n"}
,{"stream_name":"stdout","time":188.733738117,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":188.733743443,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":188.734690812,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.734707243,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.734981428,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.734993455,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":188.735125302,"data":"\n"}
,{"stream_name":"stderr","time":189.10945485,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":189.109482814,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":189.109454851,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":189.109640347,"data":"\n"}
,{"stream_name":"stdout","time":189.109650434,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":189.109654639,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":189.109669793,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.08s/s]\n"}
,{"stream_name":"stdout","time":189.111142042,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":189.111155554,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":189.111354721,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":189.111361612,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":189.111586262,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":189.111752529,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":189.111939284,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":189.11207746,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":189.112085543,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":189.112166879,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.112238042,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.112278117,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.112284219,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.112347018,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":189.11242338,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":189.112748779,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.112756287,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.112761498,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.112765463,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":189.112921468,"data":"\n"}
,{"stream_name":"stdout","time":189.185074501,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":189.525010735,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":189.525038364,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.525044113,"data":"  Original dt: 4.635547e-01 s\n"}
,{"stream_name":"stdout","time":189.525048528,"data":"  Corrected dt: 2.897217e-01 s\n"}
,{"stream_name":"stdout","time":189.525052263,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.525056379,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stderr","time":189.578440637,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":189.57846707,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":189.578451431,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":189.578671643,"data":"\n"}
,{"stream_name":"stdout","time":189.578684257,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":189.578689162,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":189.578694951,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.22s/s]\n"}
,{"stream_name":"stdout","time":189.580178883,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":189.5805046,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.580515545,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.580519832,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.580523759,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":189.580689246,"data":"\n"}
,{"stream_name":"stdout","time":189.634991842,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2891s\n"}
,{"stream_name":"stderr","time":190.048489407,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":190.04851452,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":190.04851913,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":190.048704099,"data":"\n"}
,{"stream_name":"stderr","time":190.048704211,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.08s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.06s/s]\n"}
,{"stream_name":"stdout","time":190.048712246,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":190.048720303,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":190.050301054,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":190.050636867,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.050648265,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.050663872,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.050667956,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":190.050813166,"data":"\n"}
,{"stream_name":"stdout","time":190.086114252,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":190.427612958,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":190.427642564,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.42764898,"data":"  Original dt: 4.608982e-01 s\n"}
,{"stream_name":"stdout","time":190.427663911,"data":"  Corrected dt: 2.880613e-01 s\n"}
,{"stream_name":"stdout","time":190.427668078,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.427671911,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stderr","time":190.53259142,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":190.532621982,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":190.532670735,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stdout","time":190.53291191900001,"data":"\n"}
,{"stream_name":"stderr","time":190.532907921,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.13s/s]\n"}
,{"stream_name":"stdout","time":190.532921508,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":190.53294709,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":190.534847627,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":190.550562638,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":190.550621248,"data":"\n"}
,{"stream_name":"stdout","time":190.550630328,"data":"✅ Training completed in 0.8 minutes (48.9s)\n"}
,{"stream_name":"stdout","time":190.554089772,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:48 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":190.55425993,"data":"\n"}
,{"stream_name":"stdout","time":190.554271235,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":190.554276843,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":190.55428125,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":190.554285731,"data":"\n"}
,{"stream_name":"stdout","time":190.558568376,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":190.558699496,"data":"2025-10-16 06:39:17 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":190.558873715,"data":"2025-10-16 06:39:17 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":190.559076667,"data":"2025-10-16 06:39:17 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":190.559308184,"data":"2025-10-16 06:39:17 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_25b78b90_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":190.559315882,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_25b78b90_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":190.559592065,"data":"\n"}
,{"stream_name":"stdout","time":190.559603262,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":190.559607872,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":190.559611575,"data":"\n"}
,{"stream_name":"stdout","time":190.559615037,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":190.559653765,"data":"2025-10-16 06:39:17 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.559766322,"data":"2025-10-16 06:39:17 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":190.55983557,"data":"2025-10-16 06:39:17 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":190.559911185,"data":"2025-10-16 06:39:17 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.564103183,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.564135999,"data":"2025-10-16 06:39:17 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.564327186,"data":"2025-10-16 06:39:17 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":190.564408608,"data":"2025-10-16 06:39:17 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":190.564485434,"data":"2025-10-16 06:39:17 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":190.564547632,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":190.56455711,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":190.564678855,"data":"2025-10-16 06:39:17 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":190.56480516,"data":"2025-10-16 06:39:17 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":190.565175003,"data":"2025-10-16 06:39:17 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":190.565254567,"data":"2025-10-16 06:39:17 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":190.565261124,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":190.565266363,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":190.565350631,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":190.565361297,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":190.565395323,"data":"2025-10-16 06:39:17 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":190.56545312,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":190.565461333,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":190.565465246,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":190.565469194,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":190.565584016,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.565639804,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":190.565769094,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.565840509,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":190.565911801,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":190.565992499,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":190.566067968,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":190.566179428,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":190.566217504,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.566232769,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":190.566326869,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":190.566685731,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.566697543,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":190.574638393,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":190.574665873,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":190.574672011,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":190.574676869,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":190.574681189,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":190.574685754,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":190.574690404,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":190.574694541,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":190.574701876,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":190.574711111,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.5747174,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":190.574722606,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":190.575413636,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":190.575425321,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":190.575743223,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":190.57575043,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":190.57575519,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":190.575759397,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":190.575763525,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":190.575767922,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":190.575771602,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":190.575906793,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":190.576058999,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":190.576070684,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":190.576138141,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":190.576191811,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.576197451,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":190.583767742,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":190.583781478,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":190.583786174,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":190.583790014,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":190.583830396,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":190.583944876,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":190.583953928,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":190.583959356,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":190.583987334,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":190.584000124,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.58403113,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":190.584038241,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":190.584761055,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":190.584778715,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":190.585011049,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":190.585212695,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.585223009,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.585228016,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.586989196,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":190.587004773,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":190.587020529,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":190.587628999,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":190.587841403,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":190.588158105,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":190.588169308,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":190.588214276,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":190.588297465,"data":"\n"}
,{"stream_name":"stdout","time":190.588304339,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":190.588309079,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":190.588313623,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":190.588318483,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":190.58832295,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":190.588327436,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":190.588331777,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":190.588336651,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":190.588342028,"data":"\n"}
,{"stream_name":"stdout","time":190.588430342,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":190.588444007,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":190.588448642,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":190.588453145,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":190.588457597,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":190.588476654,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":190.588480801,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":190.588484887,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":190.588488642,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":190.588492414,"data":"\n"}
,{"stream_name":"stdout","time":190.588549814,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":190.588783846,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":190.588837578,"data":"2025-10-16 06:39:17 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":190.588976831,"data":"2025-10-16 06:39:17 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":190.589694979,"data":"2025-10-16 06:39:17 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":190.589708657,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":190.589923873,"data":"2025-10-16 06:39:17 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":190.589990854,"data":"2025-10-16 06:39:17 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=1918112972664939409, last=-7268171295621305705\n"}
,{"stream_name":"stdout","time":190.590454034,"data":"2025-10-16 06:39:17 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":190.595795118,"data":"2025-10-16 06:39:17 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":190.596088785,"data":"2025-10-16 06:39:17 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":190.596096974,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":190.596191774,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":190.596199846,"data":"\n"}
,{"stream_name":"stdout","time":190.596203822,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":190.596207643,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":190.596211996,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":190.596216382,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":190.596220899,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":190.596225577,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":190.596230165,"data":"\n"}
,{"stream_name":"stdout","time":190.59627401,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":190.603716511,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":190.603734448,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":190.603739784,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":190.603744083,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":190.604700303,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":190.610702886,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":190.610720815,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":190.614303447,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":190.61432039,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":190.614327338,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.614330364,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":190.61446052,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.614556722,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":190.614638917,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":190.614707034,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":190.614787513,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":190.614854858,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":190.614939891,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.61494793,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":190.615019517,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":190.615320142,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.615331798,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":190.622812293,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":190.622829483,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":190.622834801,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":190.622839447,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":190.622844196,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":190.622891736,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":190.622897734,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":190.622902194,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":190.622922651,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":190.622934725,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.622977218,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":190.622982745,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":190.623646288,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":190.623663396,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":190.623945545,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":190.623956888,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":190.623961207,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":190.623965209,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":190.623969033,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":190.623972822,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":190.623976674,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":190.624096114,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":190.62418594,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":190.62420584,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":190.624303497,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":190.624312907,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":190.624317674,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":190.632198201,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":190.632215692,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":190.632220702,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":190.632224792,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":190.632228726,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":190.632232869,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":190.632237298,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":190.632241443,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":190.632245357,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":190.632249299,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.632253426,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":190.632257267,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":190.632871258,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":190.632888491,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":190.633104681,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":190.633313495,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.63332412,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.633328955,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.634989274,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":190.635198058,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":190.635208105,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":190.635271282,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":190.728559948,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.728682868,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.728838036,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":190.728911105,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.728991677,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.729071768,"data":"2025-10-16 06:39:17 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":190.729147666,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.729157373,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.729162246,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.729165797,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.115635195,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":191.115785175,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.86s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.84s/s]\n"}
,{"stream_name":"stdout","time":191.115885914,"data":"\n"}
,{"stream_name":"stdout","time":191.115894196,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":191.11589865,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":191.117423825,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":191.117443683,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":191.117670277,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":191.117681745,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":191.117880242,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":191.118084743,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":191.118280272,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":191.118520138,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":191.118537789,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":191.118610795,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":191.118697844,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":191.118759135,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":191.118768436,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":191.11883884,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":191.118848204,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":191.119040189,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":191.119141816,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.119553746,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.119728956,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.119805704,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.397608e+00, max=8.547104e+00, std=3.615433e+00\n"}
,{"stream_name":"stdout","time":191.119992586,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033390, rho_c=0.012308\n"}
,{"stream_name":"stdout","time":191.120070327,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.954114, w_c=12.251116\n"}
,{"stream_name":"stdout","time":191.120160123,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:887 -   State hash: -303498281453585044\n"}
,{"stream_name":"stdout","time":191.120241315,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.120430314,"data":"    [RL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=3.397608e+00\n"}
,{"stream_name":"stdout","time":191.121340724,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.121458761,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.121597729,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":191.12167664,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.121749247,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.121838112,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":191.121884173,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.12189072,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.121895742,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.121923944,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.194709079,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":191.571141571,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":191.571166045,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.571174078,"data":"  Original dt: 4.642550e-01 s\n"}
,{"stream_name":"stdout","time":191.571179937,"data":"  Corrected dt: 2.901594e-01 s\n"}
,{"stream_name":"stdout","time":191.571185895,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.571191866,"data":"  Max wave speed detected: 17.23 m/s\n"}
,{"stream_name":"stdout","time":191.606366729,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":191.606668336,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.98s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":191.606674348,"data":"\n"}
,{"stream_name":"stdout","time":191.606715003,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":191.606720346,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":191.608331674,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":191.608342625,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":191.608607105,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14732532 1.         0.01512134 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":191.608617994,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":191.60879625,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":191.608959194,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":191.609125419,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0441976  0.03246922 0.02964819 0.02877944 0.02850045 0.02842542]\n"}
,{"stream_name":"stdout","time":191.609278171,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022682  0.00147918 0.00125801 0.0011752  0.00114374 0.00113409]\n"}
,{"stream_name":"stdout","time":191.609287099,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":191.609342106,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":191.609425915,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":191.609447318,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":191.609477418,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":191.609552678,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":191.609560128,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.609740224,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.609830033,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.610178005,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.610256971,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.61036636,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.121422e-01, max=1.677267e+00, std=5.314570e-01\n"}
,{"stream_name":"stdout","time":191.61057345,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.034444, rho_c=0.010223\n"}
,{"stream_name":"stdout","time":191.61062306,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.387120, w_c=13.458675\n"}
,{"stream_name":"stdout","time":191.610750144,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:887 -   State hash: 4806145846383778906\n"}
,{"stream_name":"stdout","time":191.610811362,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.610994664,"data":"    [RL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=4.121422e-01\n"}
,{"stream_name":"stdout","time":191.612063569,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.612106759,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.612259861,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":191.612319155,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.612477512,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.612544257,"data":"2025-10-16 06:39:18 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":191.612598415,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.612605045,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.612609397,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.61263389,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.675204746,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":192.076726398,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":192.076896746,"data":"\n"}
,{"stream_name":"stdout","time":192.07690748,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":192.076913091,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":192.076922776,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.35s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.34s/s]\n"}
,{"stream_name":"stdout","time":192.078703124,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":192.078721594,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":192.078765839,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741239 1.         0.01513268 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":192.078781449,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":192.078972159,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":192.079119153,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":192.079245187,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422372 0.03248503 0.02964484 0.02874772 0.02843718 0.02832831]\n"}
,{"stream_name":"stdout","time":192.079456619,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022699  0.00147934 0.00125354 0.00116332 0.00112318 0.00110507]\n"}
,{"stream_name":"stdout","time":192.079473791,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":192.079533765,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":192.079610003,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":192.079636322,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":192.079692578,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":192.079753291,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":192.079759203,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.079943344,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.080028147,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.080372651,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.080471702,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.080609631,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.251041e-01, max=6.802830e-01, std=1.885268e-01\n"}
,{"stream_name":"stdout","time":192.080783162,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035459, rho_c=0.008026\n"}
,{"stream_name":"stdout","time":192.080873781,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.487844, w_c=13.776733\n"}
,{"stream_name":"stdout","time":192.080993477,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:887 -   State hash: -3931465526429272202\n"}
,{"stream_name":"stdout","time":192.081055258,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.081231974,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=1.251041e-01\n"}
,{"stream_name":"stdout","time":192.082162925,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.082277282,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.082364565,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":192.082503127,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.08257699,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.082662483,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":192.082730572,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.08273916,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.082744163,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.082748869,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.128120407,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":192.482255507,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":192.482280415,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.482286375,"data":"  Original dt: 4.617937e-01 s\n"}
,{"stream_name":"stdout","time":192.482290336,"data":"  Corrected dt: 2.886210e-01 s\n"}
,{"stream_name":"stdout","time":192.482294109,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.482297813,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":192.554689515,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":192.554959304,"data":"\n"}
,{"stream_name":"stdout","time":192.554969281,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":192.554974411,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":192.555001872,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.80s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.79s/s]\n"}
,{"stream_name":"stdout","time":192.556621972,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":192.556635284,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":192.556866592,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474163  1.         0.01513357 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":192.556873934,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":192.557049453,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":192.557214519,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":192.55737486,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422489 0.03248531 0.02964581 0.02874856 0.02843571 0.02832439]\n"}
,{"stream_name":"stdout","time":192.557607215,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147945 0.00125344 0.00116259 0.00112129 0.00110166]\n"}
,{"stream_name":"stdout","time":192.557614454,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":192.557696858,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":192.557749658,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":192.557806423,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":192.557831979,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":192.557889379,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":192.557911354,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.558105833,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.558219648,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.558663109,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.558775838,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.558874931,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.833548e-02, max=5.610049e-01, std=1.405242e-01\n"}
,{"stream_name":"stdout","time":192.559058793,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036376, rho_c=0.005816\n"}
,{"stream_name":"stdout","time":192.559128155,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.578423, w_c=13.905640\n"}
,{"stream_name":"stdout","time":192.55922999,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:887 -   State hash: 6077117673258971275\n"}
,{"stream_name":"stdout","time":192.559291339,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.559487771,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=8.833548e-02\n"}
,{"stream_name":"stdout","time":192.560379161,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.560525859,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.560613591,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":192.560689457,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.56079734,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.560851522,"data":"2025-10-16 06:39:19 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":192.56091962,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.560926078,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.56093139,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.56093628,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.590106473,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.03727618,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":193.037492669,"data":"\n"}
,{"stream_name":"stdout","time":193.037509113,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":193.037514726,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":193.037524419,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.51s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.50s/s]\n"}
,{"stream_name":"stdout","time":193.039158978,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":193.039172882,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":193.039364111,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474164  1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":193.039370623,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":193.039596999,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":193.039769381,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":193.039955993,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248525 0.02964588 0.02874873 0.02843574 0.02832427]\n"}
,{"stream_name":"stdout","time":193.040144531,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.00110133]\n"}
,{"stream_name":"stdout","time":193.040152245,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":193.04021854,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.040296562,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.040337027,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.040370137,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.040433582,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":193.040501597,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.040690358,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.04080209,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.04113925,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.041197631,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.041335708,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.478507e-02, max=5.273854e-01, std=1.305134e-01\n"}
,{"stream_name":"stdout","time":193.041538986,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036222, rho_c=0.003917\n"}
,{"stream_name":"stdout","time":193.041612264,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.705534, w_c=14.018867\n"}
,{"stream_name":"stdout","time":193.041702539,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:887 -   State hash: 5066769893206590791\n"}
,{"stream_name":"stdout","time":193.041782387,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.041982229,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=7.478507e-02\n"}
,{"stream_name":"stdout","time":193.042932013,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.043009502,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.043139285,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":193.043219562,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.043293017,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.043372027,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":193.04348675,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.043492405,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.043496527,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.043507567,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.052636455,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.398645787,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":193.398674568,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.398679936,"data":"  Original dt: 4.617547e-01 s\n"}
,{"stream_name":"stdout","time":193.398684241,"data":"  Corrected dt: 2.885967e-01 s\n"}
,{"stream_name":"stdout","time":193.398688582,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.398692868,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":193.494690711,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.503660638,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stdout","time":193.50389126,"data":"\n"}
,{"stream_name":"stderr","time":193.503887903,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.62s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.61s/s]\n"}
,{"stream_name":"stdout","time":193.503899666,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":193.503907698,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":193.505321514,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":193.505424949,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.505475705,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.505551752,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.505594564,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.505603753,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":193.505660547,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.505790665,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.50590792,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.506274223,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.506341318,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.506542061,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.167747e-02, max=5.048404e-01, std=1.259331e-01\n"}
,{"stream_name":"stdout","time":193.506703733,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035351, rho_c=0.003229\n"}
,{"stream_name":"stdout","time":193.506784687,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.832169, w_c=14.137383\n"}
,{"stream_name":"stdout","time":193.506879453,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:887 -   State hash: -3800873230787996171\n"}
,{"stream_name":"stdout","time":193.506963551,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.507145573,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=6.167747e-02\n"}
,{"stream_name":"stdout","time":193.508156891,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.508243243,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.508415162,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":193.508518781,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.508658602,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.508713997,"data":"2025-10-16 06:39:20 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":193.508775754,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.508781602,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.508827754,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.508847109,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.944855643,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.973476124,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":193.973634354,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.31s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.30s/s]\n"}
,{"stream_name":"stdout","time":193.973643304,"data":"\n"}
,{"stream_name":"stdout","time":193.973667555,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":193.973672962,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":193.975148686,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":193.975202527,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.975320705,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":193.975346199,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.97535226,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":193.97541189,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":193.975504964,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.975712178,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.975802719,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.976238286,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.976313831,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.976437641,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.521459e-02, max=3.120188e-01, std=6.417648e-02\n"}
,{"stream_name":"stdout","time":193.976673074,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035068, rho_c=0.003175\n"}
,{"stream_name":"stdout","time":193.976772812,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.874419, w_c=14.195654\n"}
,{"stream_name":"stdout","time":193.976829173,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:887 -   State hash: 7722922080397840194\n"}
,{"stream_name":"stdout","time":193.976922515,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.97713364,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.521459e-02\n"}
,{"stream_name":"stdout","time":193.978240829,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.978345853,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.978513978,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":193.978665038,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.97873945,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.978879764,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":193.978889804,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.978894486,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.978908221,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.978920382,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.300185886,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":194.300255648,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.300263474,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":194.300266078,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":194.300268499,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.300271322,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":194.394436429,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.438645663,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":194.438849058,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.65s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.64s/s]\n"}
,{"stream_name":"stdout","time":194.43887514,"data":"\n"}
,{"stream_name":"stdout","time":194.438878397,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":194.438881268,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":194.440505671,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":194.440524276,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.440529299,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.440544168,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.440548839,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.440643856,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":194.440650288,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.440829017,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.440929688,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.441277457,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.441326467,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.441476552,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.296586e-03, max=1.122077e-01, std=1.794181e-02\n"}
,{"stream_name":"stdout","time":194.441653328,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035023, rho_c=0.003167\n"}
,{"stream_name":"stdout","time":194.441729373,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.882162, w_c=14.213044\n"}
,{"stream_name":"stdout","time":194.44181855,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:887 -   State hash: -7442566960184912854\n"}
,{"stream_name":"stdout","time":194.441907908,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.442085635,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=6.296586e-03\n"}
,{"stream_name":"stdout","time":194.443038953,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.443137821,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.443271648,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":194.443326813,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.44346246,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.443598038,"data":"2025-10-16 06:39:21 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":194.443654546,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.443660809,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.443666403,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.443671218,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.85073452,"data":"[PROGRESS] Step 450: t=132.99/135.00s (98.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.912992865,"data":"  Stored output at t = 135.0000 s (Step 457)\n"}
,{"stream_name":"stderr","time":194.913238369,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.98s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.97s/s]\n"}
,{"stream_name":"stdout","time":194.913253712,"data":"\n"}
,{"stream_name":"stdout","time":194.913275303,"data":"Simulation finished at t = 135.0000 s after 457 steps.\n"}
,{"stream_name":"stdout","time":194.913279775,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":194.914737318,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":194.91481758,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.914833997,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.914906165,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.914925975,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.914972674,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":194.91501277,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.915190382,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.915264933,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.915671137,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.915765481,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.915889965,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.408427e-03, max=3.036733e-02, std=4.401753e-03\n"}
,{"stream_name":"stdout","time":194.91604185,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035016, rho_c=0.003165\n"}
,{"stream_name":"stdout","time":194.916114501,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883439, w_c=14.217392\n"}
,{"stream_name":"stdout","time":194.916212836,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:887 -   State hash: 4533422941546371439\n"}
,{"stream_name":"stdout","time":194.916279358,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.916498424,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.408427e-03\n"}
,{"stream_name":"stdout","time":194.917376192,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.917482268,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.917622052,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":194.917755856,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.917878406,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.917956506,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":194.917994841,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.918011727,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.918050427,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.918058617,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.200964719,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":195.200990779,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.200997522,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":195.201001091,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":195.201003594,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.201006181,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":195.299179257,"data":"[PROGRESS] Step 500: t=147.41/150.00s (98.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.377966265,"data":"  Stored output at t = 150.0000 s (Step 509)\n"}
,{"stream_name":"stderr","time":195.378195747,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 32.64s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 32.62s/s]\n"}
,{"stream_name":"stdout","time":195.378219225,"data":"\n"}
,{"stream_name":"stdout","time":195.378230137,"data":"Simulation finished at t = 150.0000 s after 509 steps.\n"}
,{"stream_name":"stdout","time":195.378234647,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":195.379850429,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":195.379867048,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.379954537,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.379962569,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.380014947,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.380034845,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":195.380092401,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.380108166,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":195.380266673,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.380353142,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.380727344,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.38083449,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.380920551,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.039691e-04, max=7.310802e-03, std=1.016559e-03\n"}
,{"stream_name":"stdout","time":195.381092955,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.381174316,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883651, w_c=14.218394\n"}
,{"stream_name":"stdout","time":195.381259879,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:887 -   State hash: 3249771043601705140\n"}
,{"stream_name":"stdout","time":195.381363718,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.38160883,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=3.039691e-04\n"}
,{"stream_name":"stdout","time":195.382463502,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.382562246,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.382683634,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":195.382772078,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.382853003,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.382957923,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":195.382973557,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.382978612,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.383044184,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.383053875,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.744739251,"data":"[PROGRESS] Step 550: t=161.83/165.00s (98.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.84268534,"data":"  Stored output at t = 165.0000 s (Step 561)\n"}
,{"stream_name":"stderr","time":195.842912873,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 32.66s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 32.64s/s]\n"}
,{"stream_name":"stdout","time":195.842920384,"data":"\n"}
,{"stream_name":"stdout","time":195.8429352,"data":"Simulation finished at t = 165.0000 s after 561 steps.\n"}
,{"stream_name":"stdout","time":195.842939668,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":195.844419666,"data":"[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====\n"}
,{"stream_name":"stdout","time":195.844435235,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":195.844630523,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":195.844637554,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":195.844819291,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":195.844984181,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":195.845144264,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":195.845307624,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":195.845313386,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":195.845409858,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.84546696,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.845525166,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.845546709,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.845592867,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":195.8456306,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.845790328,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.845875539,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.846231303,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.846291902,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.846424117,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.460893e-05, max=1.659553e-03, std=2.261282e-04\n"}
,{"stream_name":"stdout","time":195.846607014,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.846648201,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883687, w_c=14.218616\n"}
,{"stream_name":"stdout","time":195.846737212,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:887 -   State hash: 7610758618144838673\n"}
,{"stream_name":"stdout","time":195.846849322,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.84701605,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=6.460893e-05\n"}
,{"stream_name":"stdout","time":195.847974502,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.848057946,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.848153629,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":195.848267337,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.848422596,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.848618883,"data":"2025-10-16 06:39:22 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":195.848645987,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.848650635,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.848701565,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.848713294,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.098619986,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":196.098653996,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.098660406,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":196.098664583,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":196.0986687,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.0986734,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":196.193782493,"data":"[PROGRESS] Step 600: t=176.26/180.00s (97.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.307698279,"data":"  Stored output at t = 180.0000 s (Step 613)\n"}
,{"stream_name":"stderr","time":196.307870815,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 32.71s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 32.70s/s]\n"}
,{"stream_name":"stdout","time":196.307888129,"data":"\n"}
,{"stream_name":"stdout","time":196.307893751,"data":"Simulation finished at t = 180.0000 s after 613 steps.\n"}
,{"stream_name":"stdout","time":196.307898311,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":196.309656032,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.309771163,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.309913688,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.310232598,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.310250718,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.310436721,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.363054e-05, max=3.647833e-04, std=4.914669e-05\n"}
,{"stream_name":"stdout","time":196.310578302,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.310671794,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883694, w_c=14.218664\n"}
,{"stream_name":"stdout","time":196.310756061,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:887 -   State hash: 2366931847263611934\n"}
,{"stream_name":"stdout","time":196.310837866,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.31102807,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.363054e-05\n"}
,{"stream_name":"stdout","time":196.311922607,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.312033342,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.312120239,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":196.312245,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.312301472,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.312413237,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":196.31246578,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.312473675,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.312477849,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.312516398,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.635430462,"data":"[PROGRESS] Step 650: t=190.68/195.00s (97.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.766268518,"data":"  Stored output at t = 195.0000 s (Step 665)\n"}
,{"stream_name":"stdout","time":196.766487622,"data":"\n"}
,{"stream_name":"stdout","time":196.766506105,"data":"Simulation finished at t = 195.0000 s after 665 steps.\n"}
,{"stream_name":"stdout","time":196.766512103,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":196.766489455,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 33.08s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 33.07s/s]\n"}
,{"stream_name":"stdout","time":196.767988223,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.768096541,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.768239507,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.76862896,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.768678175,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.768818865,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.862432e-06, max=7.870081e-05, std=1.052756e-05\n"}
,{"stream_name":"stdout","time":196.769018792,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.769070505,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883695, w_c=14.218674\n"}
,{"stream_name":"stdout","time":196.769165817,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:887 -   State hash: -7893505669213154269\n"}
,{"stream_name":"stdout","time":196.769250063,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.769425577,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=2.862432e-06\n"}
,{"stream_name":"stdout","time":196.770295635,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.770353464,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.770529783,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":196.770586777,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.770678508,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.770767038,"data":"2025-10-16 06:39:23 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":196.770815585,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.770822951,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.770827206,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.770831078,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.98467076,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":196.984693558,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.984697425,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":196.984700412,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":196.984702994,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.984705639,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":197.078960132,"data":"[PROGRESS] Step 700: t=205.10/210.00s (97.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.226517524,"data":"  Stored output at t = 210.0000 s (Step 717)\n"}
,{"stream_name":"stdout","time":197.226766442,"data":"\n"}
,{"stream_name":"stdout","time":197.2267762,"data":"Simulation finished at t = 210.0000 s after 717 steps.\n"}
,{"stream_name":"stderr","time":197.226772965,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.94s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.92s/s]\n"}
,{"stream_name":"stdout","time":197.226781051,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":197.228360519,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.228504891,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.22866447,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.229031581,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.229074038,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.229229893,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.988992e-07, max=1.678477e-05, std=2.233747e-06\n"}
,{"stream_name":"stdout","time":197.229370338,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.22949883,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218676\n"}
,{"stream_name":"stdout","time":197.229574611,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:887 -   State hash: 7715234762832296173\n"}
,{"stream_name":"stdout","time":197.229655228,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.229838593,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=5.988992e-07\n"}
,{"stream_name":"stdout","time":197.23078593,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.230831928,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.231008802,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":197.231038724,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.231177337,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.231244724,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":197.231298785,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.231305984,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.231311287,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.231316954,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.520416326,"data":"[PROGRESS] Step 750: t=219.52/225.00s (97.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.686241674,"data":"  Stored output at t = 225.0000 s (Step 769)\n"}
,{"stream_name":"stdout","time":197.686354518,"data":"\n"}
,{"stream_name":"stdout","time":197.68636868,"data":"Simulation finished at t = 225.0000 s after 769 steps.\n"}
,{"stream_name":"stdout","time":197.686413676,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":197.686368165,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 33.01s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 33.00s/s]\n"}
,{"stream_name":"stdout","time":197.687916234,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.688030074,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.688162335,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.688579916,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.68864579,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.688913252,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.248735e-07, max=3.551999e-06, std=4.707803e-07\n"}
,{"stream_name":"stdout","time":197.689156571,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.689220211,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":197.689339464,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:887 -   State hash: 4619549566840650000\n"}
,{"stream_name":"stdout","time":197.689410383,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.689659576,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.248735e-07\n"}
,{"stream_name":"stdout","time":197.690550096,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.690629619,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.690752158,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":197.690847706,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.690904697,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.690999707,"data":"2025-10-16 06:39:24 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":197.691023092,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.691031004,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.691063658,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.691070978,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.870082186,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":197.870101663,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.870106579,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":197.87011071,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":197.870114743,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.870118592,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":197.968178413,"data":"[PROGRESS] Step 800: t=233.95/240.00s (97.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.155696531,"data":"  Stored output at t = 240.0000 s (Step 821)\n"}
,{"stream_name":"stdout","time":198.155932991,"data":"\n"}
,{"stream_name":"stdout","time":198.155947341,"data":"Simulation finished at t = 240.0000 s after 821 steps.\n"}
,{"stream_name":"stdout","time":198.155952317,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":198.155931087,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 32.31s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 32.29s/s]\n"}
,{"stream_name":"stdout","time":198.157490276,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.157593878,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.157735396,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.158078444,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.158137582,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.15828005,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.594896e-08, max=7.473341e-07, std=9.870491e-08\n"}
,{"stream_name":"stdout","time":198.158445485,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.158575634,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":198.15866634,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:887 -   State hash: -7593802090731772941\n"}
,{"stream_name":"stdout","time":198.158756877,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.158943772,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=2.594896e-08\n"}
,{"stream_name":"stdout","time":198.159916212,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.16003666,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.160121789,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":198.160224489,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.160292339,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.160447672,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":198.16047766,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.160482741,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.160507755,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.160512823,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.417499092,"data":"[PROGRESS] Step 850: t=248.37/255.00s (97.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.621542704,"data":"  Stored output at t = 255.0000 s (Step 873)\n"}
,{"stream_name":"stdout","time":198.621752344,"data":"\n"}
,{"stream_name":"stdout","time":198.621768441,"data":"Simulation finished at t = 255.0000 s after 873 steps.\n"}
,{"stream_name":"stdout","time":198.621773976,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":198.621749399,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.56s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.55s/s]\n"}
,{"stream_name":"stdout","time":198.623218093,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.623336215,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.623482145,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.62385807,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.623948566,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.624047728,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.374553e-09, max=1.564994e-07, std=2.060470e-08\n"}
,{"stream_name":"stdout","time":198.624214884,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.624342181,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":198.6244491,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:887 -   State hash: -3112051884820002673\n"}
,{"stream_name":"stdout","time":198.624590358,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.6247651,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=5.374553e-09\n"}
,{"stream_name":"stdout","time":198.625731122,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.625756702,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.625923436,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":198.625976518,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.626099655,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.626149488,"data":"2025-10-16 06:39:25 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":198.626228542,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.626236628,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.626240925,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.62624495,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.769792666,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":198.769812918,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.769817996,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":198.76982144,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":198.769824876,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.769828663,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":198.865397672,"data":"[PROGRESS] Step 900: t=262.79/270.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":199.083758249,"data":"  Stored output at t = 270.0000 s (Step 925)\n"}
,{"stream_name":"stderr","time":199.08395038,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.81s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.80s/s]\n"}
,{"stream_name":"stdout","time":199.083962994,"data":"\n"}
,{"stream_name":"stdout","time":199.083973546,"data":"Simulation finished at t = 270.0000 s after 925 steps.\n"}
,{"stream_name":"stdout","time":199.083977738,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":199.085540496,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.085609398,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.08572294,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.086032295,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.08608681,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.086215266,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.109661e-09, max=3.263938e-08, std=4.284751e-09\n"}
,{"stream_name":"stdout","time":199.086370896,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":199.086498988,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":199.086603806,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:887 -   State hash: -3580576296372562016\n"}
,{"stream_name":"stdout","time":199.08671384,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.086870929,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.109661e-09\n"}
,{"stream_name":"stdout","time":199.087826019,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.087940528,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.08806688,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":199.088126072,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.088238979,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.088354284,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":199.088404708,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":199.088415788,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.088448201,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":199.088454602,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.308828285,"data":"[PROGRESS] Step 950: t=277.21/285.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":199.543952814,"data":"  Stored output at t = 285.0000 s (Step 977)\n"}
,{"stream_name":"stderr","time":199.544174578,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 32.96s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 32.94s/s]\n"}
,{"stream_name":"stdout","time":199.544199024,"data":"\n"}
,{"stream_name":"stdout","time":199.544209658,"data":"Simulation finished at t = 285.0000 s after 977 steps.\n"}
,{"stream_name":"stdout","time":199.544214079,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":199.545726655,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.545818694,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.545927353,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.546270309,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.546301599,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.54645883,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.284143e-10, max=6.782328e-09, std=8.879027e-10\n"}
,{"stream_name":"stdout","time":199.546631677,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":199.546710303,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":199.546828278,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:887 -   State hash: 2203346671699363235\n"}
,{"stream_name":"stdout","time":199.546935792,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.54711189,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=2.284143e-10\n"}
,{"stream_name":"stdout","time":199.54801435,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.548080652,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.548226141,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":199.548305755,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.5484141,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.548534104,"data":"2025-10-16 06:39:26 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":199.548553927,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":199.548559552,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.548618379,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":199.548634031,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.654572677,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":199.654591704,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":199.654598157,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":199.654600886,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":199.654603361,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":199.654605878,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":199.751978866,"data":"[PROGRESS] Step 1000: t=291.64/300.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":200.006614819,"data":"  Stored output at t = 300.0000 s (Step 1029)\n"}
,{"stream_name":"stdout","time":200.006845911,"data":"\n"}
,{"stream_name":"stderr","time":200.006845319,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.78s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.76s/s]\n"}
,{"stream_name":"stdout","time":200.006854839,"data":"Simulation finished at t = 300.0000 s after 1029 steps.\n"}
,{"stream_name":"stdout","time":200.006862734,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":200.008331797,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.008346535,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":200.008520323,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.008608245,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.008984737,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.009007529,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.009166524,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.688165e-11, max=1.404574e-09, std=1.833974e-10\n"}
,{"stream_name":"stdout","time":200.009331225,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":200.009414557,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":200.009535311,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:887 -   State hash: -7920402102117629953\n"}
,{"stream_name":"stdout","time":200.009602435,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.009781135,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=4.688165e-11\n"}
,{"stream_name":"stdout","time":200.010709941,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.010833896,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.010895145,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":200.0110236,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.011040799,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.011182833,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":200.011208201,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":200.011225976,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.011231111,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":200.011244466,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.195674721,"data":"[PROGRESS] Step 1050: t=306.06/315.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":200.467503468,"data":"  Stored output at t = 315.0000 s (Step 1081)\n"}
,{"stream_name":"stdout","time":200.467576666,"data":"\n"}
,{"stream_name":"stdout","time":200.467584421,"data":"Simulation finished at t = 315.0000 s after 1081 steps.\n"}
,{"stream_name":"stdout","time":200.467589306,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":200.467586898,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.91s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.90s/s]\n"}
,{"stream_name":"stdout","time":200.469473794,"data":"[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====\n"}
,{"stream_name":"stdout","time":200.46948832,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":200.46974039,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":200.46974799,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":200.469931237,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":200.470088742,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":200.470290835,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":200.470465399,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":200.470477192,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":200.470550959,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":200.470621122,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":200.470637324,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":200.47070897,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":200.470714662,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":200.470770625,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.470919416,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.4710397,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.471402909,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.471490409,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.471610147,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.595821e-12, max=2.899601e-10, std=3.776549e-11\n"}
,{"stream_name":"stdout","time":200.471773515,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":200.471868993,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":200.471969951,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:887 -   State hash: 1965478437920247570\n"}
,{"stream_name":"stdout","time":200.472032073,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.47220071,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=9.595821e-12\n"}
,{"stream_name":"stdout","time":200.473123071,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.473237912,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.473346344,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":200.473407814,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.473536432,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.473596133,"data":"2025-10-16 06:39:27 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":200.473662755,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":200.473669717,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.473673997,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":200.473677852,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.545300705,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":200.545324178,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":200.545330012,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":200.545334425,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":200.545338888,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":200.5453426,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":200.641839234,"data":"[PROGRESS] Step 1100: t=320.48/330.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":200.937494286,"data":"  Stored output at t = 330.0000 s (Step 1133)\n"}
,{"stream_name":"stdout","time":200.937773864,"data":"\n"}
,{"stream_name":"stderr","time":200.937774076,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 32.36s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 32.35s/s]\n"}
,{"stream_name":"stdout","time":200.937785085,"data":"Simulation finished at t = 330.0000 s after 1133 steps.\n"}
,{"stream_name":"stdout","time":200.937806852,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":200.939537467,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.939669094,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.939813654,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.940218543,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.940298903,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.940445134,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.958695e-12, max=5.968026e-11, std=7.754176e-12\n"}
,{"stream_name":"stdout","time":200.940623816,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":200.94071539,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":200.940832384,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:887 -   State hash: -5920476040923852797\n"}
,{"stream_name":"stdout","time":200.94091432,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.941138695,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=1.958695e-12\n"}
,{"stream_name":"stdout","time":200.942111823,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.942224582,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.942364001,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":200.9424622,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.942589309,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.942664069,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":200.942699811,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":200.942708583,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.942713919,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":200.942719489,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.094044062,"data":"[PROGRESS] Step 1150: t=334.91/345.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":201.431367722,"data":"  Stored output at t = 345.0000 s (Step 1185)\n"}
,{"stream_name":"stdout","time":201.4317401,"data":"\n"}
,{"stream_name":"stdout","time":201.431752339,"data":"Simulation finished at t = 345.0000 s after 1185 steps.\n"}
,{"stream_name":"stdout","time":201.431757926,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":201.431781039,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.71s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.70s/s]\n"}
,{"stream_name":"stdout","time":201.433690001,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":201.43384021,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":201.433998053,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":201.434420202,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":201.43456289,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":201.434733954,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.990405e-13, max=1.225509e-11, std=1.588785e-12\n"}
,{"stream_name":"stdout","time":201.434949954,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":201.435029031,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":201.43516781,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:887 -   State hash: -2555016355933278689\n"}
,{"stream_name":"stdout","time":201.43526979,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.435538563,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=3.990405e-13\n"}
,{"stream_name":"stdout","time":201.436602339,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":201.43667366,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.436824741,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":201.436947703,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":201.437062397,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":201.437166564,"data":"2025-10-16 06:39:28 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":201.43723488,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":201.437258415,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.437265066,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":201.437269864,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.48811484,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":201.488136119,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":201.488142594,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":201.488147519,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":201.488152426,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":201.488157654,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":201.6351891,"data":"[PROGRESS] Step 1200: t=349.33/360.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":201.997298672,"data":"  Stored output at t = 360.0000 s (Step 1237)\n"}
,{"stream_name":"stderr","time":201.997548517,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 26.80s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 26.80s/s]\n"}
,{"stream_name":"stdout","time":201.997574032,"data":"\n"}
,{"stream_name":"stdout","time":201.997589595,"data":"Simulation finished at t = 360.0000 s after 1237 steps.\n"}
,{"stream_name":"stdout","time":201.997610799,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":201.999194009,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":201.999276891,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":201.999426798,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":201.999791379,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":201.999877882,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":201.999992153,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.093729e-14, max=2.506440e-12, std=3.239125e-13\n"}
,{"stream_name":"stdout","time":202.000150531,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":202.000238425,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":202.000358405,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:887 -   State hash: -7282492363720549806\n"}
,{"stream_name":"stdout","time":202.00044901,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.000642371,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=8.093729e-14\n"}
,{"stream_name":"stdout","time":202.00161012,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.0017125,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.001830854,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":202.00189415,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.001993837,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.002128716,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":202.002139277,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":202.002144049,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.002184027,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":202.002191961,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.122450722,"data":"[PROGRESS] Step 1250: t=363.75/375.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":202.464083966,"data":"  Stored output at t = 375.0000 s (Step 1289)\n"}
,{"stream_name":"stderr","time":202.464265272,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 32.51s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 32.49s/s]\n"}
,{"stream_name":"stdout","time":202.464269612,"data":"\n"}
,{"stream_name":"stdout","time":202.464299784,"data":"Simulation finished at t = 375.0000 s after 1289 steps.\n"}
,{"stream_name":"stdout","time":202.46430555,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":202.465907594,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.465934698,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.466106557,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.466438095,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.466536195,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.46665263,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.630333e-14, max=5.098144e-13, std=6.574957e-14\n"}
,{"stream_name":"stdout","time":202.466811551,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":202.466910167,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":202.467008237,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:887 -   State hash: -4953650339952945871\n"}
,{"stream_name":"stdout","time":202.467074274,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.467262397,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=1.630333e-14\n"}
,{"stream_name":"stdout","time":202.46815199,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.46826032,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.468377024,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":202.468513187,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.468576147,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.468710258,"data":"2025-10-16 06:39:29 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":202.468718035,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":202.46872305,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.468737837,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":202.468742605,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.470062274,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":202.470077254,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":202.470082245,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":202.470086009,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":202.470089824,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":202.470093454,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":202.567005798,"data":"[PROGRESS] Step 1300: t=378.17/390.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":202.935451346,"data":"  Stored output at t = 390.0000 s (Step 1341)\n"}
,{"stream_name":"stderr","time":202.935667605,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 32.17s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":202.935675019,"data":"\n"}
,{"stream_name":"stdout","time":202.935685797,"data":"Simulation finished at t = 390.0000 s after 1341 steps.\n"}
,{"stream_name":"stdout","time":202.935690738,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":202.937150189,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.937288246,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.937370312,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.937781132,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.937805217,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.93796514,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.204002e-15, max=1.030287e-13, std=1.371947e-14\n"}
,{"stream_name":"stdout","time":202.938110123,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":202.938165359,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":202.938286372,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:887 -   State hash: 5222149952895046896\n"}
,{"stream_name":"stdout","time":202.938357384,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.938602141,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=3.204002e-15\n"}
,{"stream_name":"stdout","time":202.939521545,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.939645561,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.939764637,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":202.939814317,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.939936434,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.940023674,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":202.940077287,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":202.940083758,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.940088208,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":202.940092071,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":203.019438071,"data":"[PROGRESS] Step 1350: t=392.60/405.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":203.363100183,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":203.363125888,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":203.363130933,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":203.363134809,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":203.363138585,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":203.363142233,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":203.397781482,"data":"  Stored output at t = 405.0000 s (Step 1393)\n"}
,{"stream_name":"stderr","time":203.397921643,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 32.80s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 32.79s/s]\n"}
,{"stream_name":"stdout","time":203.397957032,"data":"\n"}
,{"stream_name":"stdout","time":203.397967299,"data":"Simulation finished at t = 405.0000 s after 1393 steps.\n"}
,{"stream_name":"stdout","time":203.39797153,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":203.399649755,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.399699336,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.39987326,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":203.400180289,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.4002025,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.40034742,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.179905e-16, max=2.309264e-14, std=3.049549e-15\n"}
,{"stream_name":"stdout","time":203.400538127,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":203.40060538,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":203.40069848,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:887 -   State hash: -3231485629721317332\n"}
,{"stream_name":"stdout","time":203.400765637,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.400974333,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=7.179905e-16\n"}
,{"stream_name":"stdout","time":203.401870752,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":203.401920242,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.402059067,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":203.402101737,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":203.402223901,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":203.402289201,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":203.402341899,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":203.402349815,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":203.402364062,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":203.402368514,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":203.463140993,"data":"[PROGRESS] Step 1400: t=407.02/420.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":203.857603067,"data":"  Stored output at t = 420.0000 s (Step 1445)\n"}
,{"stream_name":"stdout","time":203.857847597,"data":"\n"}
,{"stream_name":"stderr","time":203.857846992,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.98s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.96s/s]\n"}
,{"stream_name":"stdout","time":203.85785933,"data":"Simulation finished at t = 420.0000 s after 1445 steps.\n"}
,{"stream_name":"stdout","time":203.857870661,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":203.859503164,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.859630072,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.859754612,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":203.860222212,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.860282681,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.860393675,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.409432e-16, max=1.065814e-14, std=8.725885e-16\n"}
,{"stream_name":"stdout","time":203.860607327,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":203.860689835,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":203.860775029,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:887 -   State hash: 1653265802930996036\n"}
,{"stream_name":"stdout","time":203.860880259,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.861107831,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=1.409432e-16\n"}
,{"stream_name":"stdout","time":203.862018229,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":203.862076744,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.862222069,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":203.862303542,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":203.862408218,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":203.862541622,"data":"2025-10-16 06:39:30 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":203.862551311,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":203.862558222,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":203.862602683,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":203.862611906,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":203.907923166,"data":"[PROGRESS] Step 1450: t=421.44/435.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":204.25666472,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":204.256693046,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":204.256699143,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":204.256703625,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":204.256707686,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":204.256711723,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":204.326585973,"data":"  Stored output at t = 435.0000 s (Step 1497)\n"}
,{"stream_name":"stdout","time":204.32675782,"data":"\n"}
,{"stream_name":"stdout","time":204.326771418,"data":"Simulation finished at t = 435.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":204.32677586,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":204.326778918,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 32.36s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 32.35s/s]\n"}
,{"stream_name":"stdout","time":204.32825195,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":204.328422754,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":204.328660073,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":204.328933122,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":204.32898665,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":204.329097997,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.281035e-18, max=1.776357e-15, std=8.698780e-17\n"}
,{"stream_name":"stdout","time":204.329268497,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":204.329349517,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":204.329486804,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":204.3296088,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":204.329775204,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=4.281035e-18\n"}
,{"stream_name":"stdout","time":204.330803989,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":204.33087441200001,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":204.331040384,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":204.331095055,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":204.331216963,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":204.331278046,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":204.331346357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":204.331368473,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":204.331373301,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":204.331377173,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":204.358261304,"data":"[PROGRESS] Step 1500: t=435.87/450.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":204.792902709,"data":"  Stored output at t = 450.0000 s (Step 1549)\n"}
,{"stream_name":"stdout","time":204.79314822,"data":"\n"}
,{"stream_name":"stdout","time":204.793159306,"data":"Simulation finished at t = 450.0000 s after 1549 steps.\n"}
,{"stream_name":"stdout","time":204.793164275,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":204.793164435,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 32.53s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 32.51s/s]\n"}
,{"stream_name":"stdout","time":204.794824694,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":204.794839057,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":204.794966813,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":204.795096031,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":204.795472715,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":204.795501117,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":204.79568508,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":204.795830589,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":204.79588304,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":204.796008792,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":204.796062495,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":204.796235512,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":204.797131872,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":204.797253044,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":204.79733213,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":204.797450208,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":204.797554175,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":204.797648295,"data":"2025-10-16 06:39:31 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":204.797716427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":204.797724865,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":204.797729218,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":204.797733038,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":204.806649397,"data":"[PROGRESS] Step 1550: t=450.29/465.00s (96.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":205.152738325,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":205.152760506,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":205.152765977,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":205.152769936,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":205.152773632,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":205.152778489,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":205.248957315,"data":"[PROGRESS] Step 1600: t=464.72/465.00s (99.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":205.257703054,"data":"  Stored output at t = 465.0000 s (Step 1601)\n"}
,{"stream_name":"stdout","time":205.258013291,"data":"\n"}
,{"stream_name":"stderr","time":205.258014888,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 32.63s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 32.61s/s]\n"}
,{"stream_name":"stdout","time":205.258022597,"data":"Simulation finished at t = 465.0000 s after 1601 steps.\n"}
,{"stream_name":"stdout","time":205.258045775,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":205.259750765,"data":"[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====\n"}
,{"stream_name":"stdout","time":205.259764778,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":205.260005868,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":205.260013925,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":205.260202149,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":205.260419706,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":205.260611833,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":205.260791358,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":205.260801536,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":205.260853886,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":205.260917946,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":205.260939095,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":205.260996225,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":205.261012376,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":205.261084347,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":205.261237429,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":205.261314558,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":205.261703464,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":205.261789579,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":205.26194116,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":205.262130383,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":205.262196127,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":205.262308403,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":205.262415308,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.262622001,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":205.263576508,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":205.263630451,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.263743186,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":205.263863991,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":205.263950514,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":205.26402001,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":205.264069908,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":205.264076575,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":205.26408157,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":205.264115576,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":205.696929251,"data":"[PROGRESS] Step 1650: t=479.14/480.00s (99.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":205.7242045,"data":"  Stored output at t = 480.0000 s (Step 1653)\n"}
,{"stream_name":"stdout","time":205.724472984,"data":"\n"}
,{"stream_name":"stdout","time":205.724487925,"data":"Simulation finished at t = 480.0000 s after 1653 steps.\n"}
,{"stream_name":"stdout","time":205.724492965,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":205.72447266,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 32.63s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 32.61s/s]\n"}
,{"stream_name":"stdout","time":205.726348873,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":205.726517882,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":205.726660362,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":205.727056653,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":205.727144131,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":205.727275104,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":205.727529103,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":205.727601991,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":205.727698425,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":205.727767671,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.727978915,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":205.728951107,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":205.728981974,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.729161155,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":205.72921063,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":205.729329367,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":205.729476905,"data":"2025-10-16 06:39:32 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":205.729564447,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":205.729575202,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":205.729581987,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":205.729586579,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":206.063802893,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":206.063827463,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":206.063832952,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":206.063837214,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":206.063841236,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":206.063845343,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":206.157448513,"data":"[PROGRESS] Step 1700: t=493.56/495.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":206.2010733,"data":"  Stored output at t = 495.0000 s (Step 1705)\n"}
,{"stream_name":"stderr","time":206.20129671,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.83s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.82s/s]\n"}
,{"stream_name":"stdout","time":206.201301887,"data":"\n"}
,{"stream_name":"stdout","time":206.201329412,"data":"Simulation finished at t = 495.0000 s after 1705 steps.\n"}
,{"stream_name":"stdout","time":206.201334566,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":206.202793781,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":206.20289808,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":206.203032236,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":206.203364906,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":206.203472967,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":206.203611215,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":206.203770946,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":206.203857077,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":206.203939574,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":206.20403577,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.204196621,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":206.205127538,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":206.205172256,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.205303441,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":206.205368736,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":206.205489383,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":206.205612016,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":206.205622344,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":206.205627017,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":206.205632747,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":206.205671223,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":206.597596939,"data":"[PROGRESS] Step 1750: t=507.99/510.00s (99.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":206.658978521,"data":"  Stored output at t = 510.0000 s (Step 1757)\n"}
,{"stream_name":"stderr","time":206.659244432,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 33.11s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 33.10s/s]\n"}
,{"stream_name":"stdout","time":206.659258676,"data":"\n"}
,{"stream_name":"stdout","time":206.659279047,"data":"Simulation finished at t = 510.0000 s after 1757 steps.\n"}
,{"stream_name":"stdout","time":206.659316516,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":206.660789142,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":206.660900404,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":206.661032406,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":206.661397344,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":206.661470118,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":206.661613149,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":206.661786121,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":206.661842518,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":206.661960297,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:887 -   State hash: -5388771479397824830\n"}
,{"stream_name":"stdout","time":206.662040064,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.662225994,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":206.663156717,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":206.663242506,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.663420288,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":206.663433559,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":206.663590449,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":206.663682327,"data":"2025-10-16 06:39:33 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":206.663714854,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":206.663721741,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":206.663726787,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":206.663760157,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":206.946930132,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":206.946954738,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":206.946961482,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":206.946978893,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":206.946983549,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":206.946987187,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":207.042282255,"data":"[PROGRESS] Step 1800: t=522.41/525.00s (99.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":207.122176251,"data":"  Stored output at t = 525.0000 s (Step 1809)\n"}
,{"stream_name":"stdout","time":207.122406855,"data":"\n"}
,{"stream_name":"stderr","time":207.122413526,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 32.74s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 32.73s/s]\n"}
,{"stream_name":"stdout","time":207.122421544,"data":"Simulation finished at t = 525.0000 s after 1809 steps.\n"}
,{"stream_name":"stdout","time":207.122429644,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":207.124074692,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":207.124219879,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":207.124329463,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":207.124730729,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":207.124761992,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":207.124907383,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.059243e-17, max=3.552714e-15, std=3.144142e-16\n"}
,{"stream_name":"stdout","time":207.125066164,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":207.1251338,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":207.12522346,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:887 -   State hash: 4389630110149378198\n"}
,{"stream_name":"stdout","time":207.125321847,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.125508686,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=4.059243e-17\n"}
,{"stream_name":"stdout","time":207.126433484,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":207.126538427,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.126639972,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":207.126759916,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":207.126833381,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":207.126954499,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":207.126964208,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":207.12697036,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":207.126992078,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":207.126999893,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":207.488967171,"data":"[PROGRESS] Step 1850: t=536.83/540.00s (99.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":207.585239012,"data":"  Stored output at t = 540.0000 s (Step 1861)\n"}
,{"stream_name":"stderr","time":207.585455931,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 32.76s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 32.74s/s]\n"}
,{"stream_name":"stdout","time":207.585482984,"data":"\n"}
,{"stream_name":"stdout","time":207.585495789,"data":"Simulation finished at t = 540.0000 s after 1861 steps.\n"}
,{"stream_name":"stdout","time":207.585500136,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":207.586993385,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":207.587075762,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":207.587207523,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":207.587571799,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":207.587652542,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":207.58777185,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.299632e-17, max=3.552714e-15, std=4.247902e-16\n"}
,{"stream_name":"stdout","time":207.587929888,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":207.58803325,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":207.588113385,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:887 -   State hash: -2730448652016051436\n"}
,{"stream_name":"stdout","time":207.588208098,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.588406379,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=6.299632e-17\n"}
,{"stream_name":"stdout","time":207.589303671,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":207.58953297,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.589662821,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":207.589821641,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":207.589907216,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":207.590066257,"data":"2025-10-16 06:39:34 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":207.590090985,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":207.59009863,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":207.590166821,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":207.590174741,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":207.834464928,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":207.834487264,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":207.834492957,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":207.834496946,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":207.834500704,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":207.834504551,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":207.930225062,"data":"[PROGRESS] Step 1900: t=551.26/555.00s (99.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":208.04357078,"data":"  Stored output at t = 555.0000 s (Step 1913)\n"}
,{"stream_name":"stdout","time":208.043840922,"data":"\n"}
,{"stream_name":"stderr","time":208.043844543,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 33.11s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 33.09s/s]\n"}
,{"stream_name":"stdout","time":208.043851825,"data":"Simulation finished at t = 555.0000 s after 1913 steps.\n"}
,{"stream_name":"stdout","time":208.043869581,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":208.045374926,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":208.045427816,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":208.045555136,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":208.045901541,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":208.045942339,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":208.046084061,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.576083e-17, max=7.105427e-15, std=5.815726e-16\n"}
,{"stream_name":"stdout","time":208.046253626,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":208.046333351,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":208.046445001,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:887 -   State hash: -257379689044131077\n"}
,{"stream_name":"stdout","time":208.046550537,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.046731811,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=5.576083e-17\n"}
,{"stream_name":"stdout","time":208.047686456,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":208.047797369,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.047876187,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":208.048013419,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":208.048076257,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":208.048172814,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":208.04822984,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":208.048237164,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":208.048242623,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":208.048254996,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":208.371445618,"data":"[PROGRESS] Step 1950: t=565.68/570.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":208.501848378,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 33.10s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 33.10s/s]\n"}
,{"stream_name":"stdout","time":208.501850086,"data":"  Stored output at t = 570.0000 s (Step 1965)\n"}
,{"stream_name":"stdout","time":208.501886513,"data":"\n"}
,{"stream_name":"stdout","time":208.501891351,"data":"Simulation finished at t = 570.0000 s after 1965 steps.\n"}
,{"stream_name":"stdout","time":208.501895558,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":208.503329492,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":208.503478197,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":208.503667912,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":208.503993541,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":208.504037888,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":208.504164975,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.194820e-17, max=7.105427e-15, std=4.696656e-16\n"}
,{"stream_name":"stdout","time":208.504324706,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":208.504395442,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":208.50453803,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:887 -   State hash: 3339208902992801959\n"}
,{"stream_name":"stdout","time":208.504649675,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.504807841,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=4.194820e-17\n"}
,{"stream_name":"stdout","time":208.505736575,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":208.505844687,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.505954631,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":208.506028233,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":208.506136175,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":208.506211204,"data":"2025-10-16 06:39:35 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":208.506255979,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":208.506261841,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":208.506265869,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":208.506276506,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":208.716466906,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":208.716492925,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":208.716498297,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":208.716502516,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":208.716506288,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":208.716509868,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":208.812294168,"data":"[PROGRESS] Step 2000: t=580.10/585.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":208.962534364,"data":"  Stored output at t = 585.0000 s (Step 2017)\n"}
,{"stream_name":"stderr","time":208.962803788,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 32.90s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 32.89s/s]\n"}
,{"stream_name":"stdout","time":208.962812636,"data":"\n"}
,{"stream_name":"stdout","time":208.96284421,"data":"Simulation finished at t = 585.0000 s after 2017 steps.\n"}
,{"stream_name":"stdout","time":208.962851615,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":208.964443831,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":208.964574285,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":208.96470058,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":208.96501018,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":208.965094557,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":208.965204549,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.673216e-19, max=1.040834e-17, std=8.253824e-19\n"}
,{"stream_name":"stdout","time":208.965360126,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":208.965472927,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":208.965583072,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:887 -   State hash: -5711140148785646040\n"}
,{"stream_name":"stdout","time":208.965645822,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.96584222,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=1.673216e-19\n"}
,{"stream_name":"stdout","time":208.966810322,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":208.966895448,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.967025027,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":208.967107907,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":208.967181241,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":208.967274594,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":208.967314257,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":208.967321718,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":208.967327407,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":208.967344427,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":209.256235251,"data":"[PROGRESS] Step 2050: t=594.52/600.00s (99.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":209.422734676,"data":"  Stored output at t = 600.0000 s (Step 2069)\n"}
,{"stream_name":"stdout","time":209.42288828,"data":"\n"}
,{"stream_name":"stdout","time":209.422897881,"data":"Simulation finished at t = 600.0000 s after 2069 steps.\n"}
,{"stream_name":"stdout","time":209.422902417,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":209.422910904,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.97s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.95s/s]\n"}
,{"stream_name":"stdout","time":209.424561771,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":209.424589012,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":209.424593709,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":209.424688141,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":209.424815101,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":209.425134531,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":209.425210293,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":209.425330165,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.916869e-17, max=5.329071e-15, std=3.282021e-16\n"}
,{"stream_name":"stdout","time":209.425523019,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":209.425606599,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":209.425745002,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:887 -   State hash: 1101095451052556639\n"}
,{"stream_name":"stdout","time":209.425810746,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":209.425981822,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=2.916869e-17\n"}
,{"stream_name":"stdout","time":209.426043485,"data":"\n"}
,{"stream_name":"stdout","time":209.426050564,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":209.426055277,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":209.42605916,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":209.426062867,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":209.426066494,"data":"    - Avg step time: 0.470s (device=gpu)\n"}
,{"stream_name":"stdout","time":209.426070182,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":209.426073733,"data":"    - Wallclock time: 18.8s\n"}
,{"stream_name":"stdout","time":209.426077336,"data":"    - Speed ratio: 31.94x real-time\n"}
,{"stream_name":"stdout","time":209.426092203,"data":"\n"}
,{"stream_name":"stdout","time":209.426139366,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":209.426144262,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":209.426148461,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":209.426152511,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":209.426162546,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":209.426166717,"data":"    - Avg step time: 0.470s (device=gpu)\n"}
,{"stream_name":"stdout","time":209.426170452,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":209.42617397,"data":"    - Wallclock time: 18.8s\n"}
,{"stream_name":"stdout","time":209.426177534,"data":"    - Speed ratio: 31.94x real-time\n"}
,{"stream_name":"stdout","time":209.426181141,"data":"\n"}
,{"stream_name":"stdout","time":209.426248483,"data":"2025-10-16 06:39:36 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":209.426610901,"data":"\n"}
,{"stream_name":"stdout","time":209.426622173,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":209.426626196,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":209.426643768,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":209.426647651,"data":"\n"}
,{"stream_name":"stdout","time":209.426778653,"data":"2025-10-16 06:39:36 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":209.426847846,"data":"2025-10-16 06:39:36 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-303498281453585044, last=1101095451052556639\n"}
,{"stream_name":"stdout","time":209.427412212,"data":"2025-10-16 06:39:36 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.03122336 0.03168972 0.03217945 0.03267153 0.03313596], w_m[10:15]=[16.46560214 16.40817721 16.35330629 16.30413114 16.26362536]\n"}
,{"stream_name":"stdout","time":209.432276826,"data":"2025-10-16 06:39:36 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02826931 0.02826386 0.02826182 0.02826104 0.02826073], w_m[10:15]=[17.42793983 17.43125511 17.43249708 17.43297014 17.43315409]\n"}
,{"stream_name":"stdout","time":209.432589112,"data":"2025-10-16 06:39:36 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=31.787073, efficiency=5.085932, delay=-175.12s\n"}
,{"stream_name":"stdout","time":209.432717095,"data":"2025-10-16 06:39:36 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":209.432800848,"data":"2025-10-16 06:39:36 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 31.787073312784855, 'avg_speed': 1055.4375174172515, 'avg_density': 0.03023631435669528, 'efficiency': 5.085931730045576, 'delay': -175.118743243177, 'throughput': 158935.36656392427}\n"}
,{"stream_name":"stdout","time":209.432909423,"data":"2025-10-16 06:39:36 - INFO - run_performance_comparison:1430 - Flow improvement: 12.361%\n"}
,{"stream_name":"stdout","time":209.432997598,"data":"2025-10-16 06:39:36 - INFO - run_performance_comparison:1431 - Efficiency improvement: 12.361%\n"}
,{"stream_name":"stdout","time":209.433064686,"data":"2025-10-16 06:39:36 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":209.433137703,"data":"  Flow improvement: 12.4%\n"}
,{"stream_name":"stdout","time":209.433143576,"data":"  Efficiency improvement: 12.4%\n"}
,{"stream_name":"stdout","time":209.43314804,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":209.433152376,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":209.433680135,"data":"\n"}
,{"stream_name":"stdout","time":209.433693606,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":210.01592342,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":210.519206265,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":210.519235429,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":210.519241918,"data":"\n"}
,{"stream_name":"stdout","time":210.519245884,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":210.52871886,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":210.528742062,"data":"\n"}
,{"stream_name":"stdout","time":210.528747261,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":210.528925831,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":210.528934,"data":"\n"}
,{"stream_name":"stdout","time":210.528938298,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":210.528942534,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":210.528947027,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":210.528951614,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":210.528955785,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":210.528959885,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":210.529996392,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":213.101245663,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":213.101271278,"data":"\n"}
,{"stream_name":"stdout","time":213.101274614,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":213.101277493,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":213.10440771,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":213.105327786,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":213.105349407,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":213.105493839,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":213.105560063,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":213.105642705,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":213.105702243,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":213.105765489,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":213.105832667,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":213.105934708,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":213.159769906,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":213.159795346,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":213.160169998,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":213.160207852,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":213.160322595,"data":"\n"}
,{"stream_name":"stdout","time":213.160330635,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":213.16042306,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":213.160523613,"data":"\n"}
,{"stream_name":"stdout","time":213.160530853,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":213.160534769,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":213.160538452,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":213.160542096,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":216.701280248,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":216.701315001,"data":"  warn(\n"}
,{"stream_name":"stderr","time":216.743672903,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":217.477952284,"data":"[NbConvertApp] Writing 322209 bytes to __results__.html\n"}
]