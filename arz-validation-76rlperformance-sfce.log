0.8s 1 ================================================================================
0.8s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.8s 3 Revendications: R5
0.8s 4 ================================================================================
0.8s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.8s 6 Branch: main
7.2s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
7.3s 8 PyTorch: 2.6.0+cu124
7.3s 9 CUDA available: True
7.3s 10 CUDA device: Tesla P100-PCIE-16GB
7.3s 11 CUDA version: 12.4
7.3s 12 
7.3s 13 [STEP 1/4] Cloning repository from GitHub...
7.3s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
11.2s 15 [OK] Repository cloned successfully
11.2s 16 TRACKING_SUCCESS: Repository cloned
11.2s 17 
11.2s 18 [STEP 2/4] Installing dependencies...
11.2s 19 Installing PyYAML...
15.6s 20 Installing matplotlib...
18.6s 21 Installing pandas...
21.8s 22 Installing scipy...
24.8s 23 Installing numpy...
27.8s 24 Installing gymnasium...
31.0s 25 Installing stable-baselines3...
103.6s 26 [OK] Dependencies installed
103.6s 27 TRACKING_SUCCESS: Dependencies ready
103.6s 28 
103.6s 29 [STEP 3/4] Running validation tests...
103.6s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
103.6s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
103.6s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
103.6s 33 ============================================================
117.8s 34 2025-10-10 12:04:10.254207: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
118.1s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
118.1s 36 E0000 00:00:1760097850.493204      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
118.1s 37 E0000 00:00:1760097850.564187      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
131.9s 38 ================================================================================
131.9s 39 QUICK TEST MODE ENABLED
131.9s 40 - Training: 2 timesteps only
131.9s 41 - Duration: 2 minutes simulated time
131.9s 42 - Scenarios: 1 scenario only
131.9s 43 - Expected runtime: ~5 minutes on GPU
131.9s 44 ================================================================================
131.9s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
131.9s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
131.9s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
131.9s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
131.9s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
131.9s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
131.9s 51 2025-10-10 12:04:24 - INFO - _setup_debug_logging:119 - ================================================================================
131.9s 52 2025-10-10 12:04:24 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
131.9s 53 2025-10-10 12:04:24 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
131.9s 54 2025-10-10 12:04:24 - INFO - _setup_debug_logging:122 - Quick test mode: True
131.9s 55 2025-10-10 12:04:24 - INFO - _setup_debug_logging:123 - ================================================================================
131.9s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
131.9s 57 === Section 7.6: RL Performance Validation ===
131.9s 58 Testing RL agent performance vs baseline controllers...
132.0s 59 [DEVICE] Detected: GPU
132.1s 60 [GPU INFO] Tesla P100-PCIE-16GB
132.1s 61 
132.1s 62 [PHASE 1/2] Training RL agents...
132.1s 63 [QUICK TEST] Training only: traffic_light_control
132.1s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
132.1s 65 2025-10-10 12:04:24 - INFO - train_rl_agent:560 - ================================================================================
132.1s 66 2025-10-10 12:04:24 - INFO - train_rl_agent:561 - Starting train_rl_agent for scenario: traffic_light_control
132.1s 67 2025-10-10 12:04:24 - INFO - train_rl_agent:562 -   - Device: gpu
132.1s 68 2025-10-10 12:04:24 - INFO - train_rl_agent:563 -   - Total timesteps: 100
132.1s 69 2025-10-10 12:04:24 - INFO - train_rl_agent:564 -   - Episode max time: 120.0s
132.1s 70 2025-10-10 12:04:24 - INFO - train_rl_agent:565 -   - Checkpoint frequency: 50
132.1s 71 2025-10-10 12:04:24 - INFO - train_rl_agent:566 - ================================================================================
132.1s 72 
132.1s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
132.1s 74 Device: gpu
132.1s 75 Total timesteps: 100
132.1s 76 Episode max time: 120.0s
132.1s 77 Checkpoint frequency: 50 steps
132.1s 78 2025-10-10 12:04:24 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
132.1s 79 2025-10-10 12:04:24 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
132.1s 80 2025-10-10 12:04:24 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
132.1s 81 2025-10-10 12:04:24 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
132.1s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
132.1s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
132.1s 84 Using device: gpu
132.1s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
132.1s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
132.1s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
132.1s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
132.1s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
132.1s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
132.1s 91 Loading road quality type: uniform
132.1s 92 Uniform road quality value: 2
132.1s 93 Road quality loaded.
132.1s 94 Initial state created.
132.1s 95 Transferring initial state and road quality to GPU...
132.1s 96 GPU data transfer complete.
132.1s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
132.1s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.1s 99 warn(NumbaPerformanceWarning(msg))
133.7s 100 Initial boundary conditions applied.
133.7s 101 TrafficSignalEnvDirect initialized:
133.7s 102 Decision interval: 60.0s
133.7s 103 Observation segments: 6
133.7s 104 Observation space: (26,)
133.7s 105 Action space: 2
133.7s 106 Device: gpu
133.7s 107 [INFO] Environment created: obs_space=(26,), action_space=2
133.7s 108 [INFO] Initializing PPO agent from scratch...
133.7s 109 Using cuda device
133.7s 110 Wrapping the env with a `Monitor` wrapper
133.7s 111 Wrapping the env in a DummyVecEnv.
133.7s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
133.7s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
133.7s 114 Info: (n_steps=100 and n_envs=1)
133.7s 115 warnings.warn(
139.1s 116 
139.1s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
139.1s 118 [INFO] Training for 100 timesteps...
139.1s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
139.1s 120 Using device: gpu
139.1s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
139.1s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
139.1s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
139.1s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
139.1s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
139.1s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
139.1s 127 Loading road quality type: uniform
139.1s 128 Uniform road quality value: 2
139.1s 129 Road quality loaded.
139.1s 130 Initial state created.
139.1s 131 Transferring initial state and road quality to GPU...
139.1s 132 GPU data transfer complete.
139.1s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
139.1s 134 Initial boundary conditions applied.
139.1s 135 [BC UPDATE] left → phase 0 RED (reduced inflow)
139.1s 136 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
139.1s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
139.1s 138 
139.1s 139 🚀 Training started: 100 total timesteps
139.7s 140 Running simulation until t = 60.00 s, outputting every 60.00 s
139.7s 141 
139.8s 142 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
139.8s 143 warn(NumbaPerformanceWarning(msg))
140.1s 144 [WARNING] Automatic CFL correction applied (count: 1):
140.1s 145 Calculated CFL: 0.800 > Limit: 0.500
140.1s 146 Original dt: 3.228311e-01 s
140.1s 147 Corrected dt: 2.017695e-01 s
140.1s 148 Correction factor: 1.6x
140.1s 149 Max wave speed detected: 24.78 m/s
140.3s 150 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
140.3s 151 warn(NumbaPerformanceWarning(msg))
141.0s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.0s 153 warn(NumbaPerformanceWarning(msg))
141.1s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.1s 155 warn(NumbaPerformanceWarning(msg))
141.2s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.2s 157 warn(NumbaPerformanceWarning(msg))
141.6s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.6s 159 warn(NumbaPerformanceWarning(msg))
141.7s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.7s 161 warn(NumbaPerformanceWarning(msg))
141.8s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.8s 163 warn(NumbaPerformanceWarning(msg))
141.9s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
141.9s 165 warn(NumbaPerformanceWarning(msg))
142.0s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
142.0s 167 warn(NumbaPerformanceWarning(msg))
142.1s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
142.1s 169 warn(NumbaPerformanceWarning(msg))
142.1s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
142.1s 171 warn(NumbaPerformanceWarning(msg))
142.7s 172 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
143.1s 173 [WARNING] Automatic CFL correction applied (count: 100):
143.1s 174 Calculated CFL: 0.800 > Limit: 0.500
143.1s 175 Original dt: 4.145004e-01 s
143.1s 176 Corrected dt: 2.590627e-01 s
143.1s 177 Correction factor: 1.6x
143.1s 178 Max wave speed detected: 19.30 m/s
143.2s 179 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
143.6s 180 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
144.2s 181 [WARNING] Automatic CFL correction applied (count: 200):
144.2s 182 Calculated CFL: 0.800 > Limit: 0.500
144.2s 183 Original dt: 4.115380e-01 s
144.2s 184 Corrected dt: 2.572113e-01 s
144.2s 185 Correction factor: 1.6x
144.2s 186 Max wave speed detected: 19.44 m/s
144.2s 187 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
144.5s 188 Stored output at t = 60.0000 s (Step 231)
144.5s 189 
144.5s 190 [A
144.5s 191 
144.5s 192 Simulation finished at t = 60.0000 s after 231 steps.
144.5s 193 Total runtime: 4.75 seconds.
144.5s 194 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 12.64s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 12.64s/s]
144.5s 195 [BC UPDATE] left → phase 1 GREEN (normal inflow)
144.5s 196 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
144.5s 197 Running simulation until t = 120.00 s, outputting every 60.00 s
144.5s 198 
144.7s 199 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
145.2s 200 [WARNING] Automatic CFL correction applied (count: 300):
145.2s 201 Calculated CFL: 0.800 > Limit: 0.500
145.2s 202 Original dt: 4.114988e-01 s
145.2s 203 Corrected dt: 2.571867e-01 s
145.2s 204 Correction factor: 1.6x
145.2s 205 Max wave speed detected: 19.44 m/s
145.2s 206 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
145.7s 207 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
146.2s 208 [WARNING] Automatic CFL correction applied (count: 400):
146.2s 209 Calculated CFL: 0.800 > Limit: 0.500
146.2s 210 Original dt: 4.114980e-01 s
146.2s 211 Corrected dt: 2.571863e-01 s
146.2s 212 Correction factor: 1.6x
146.2s 213 Max wave speed detected: 19.44 m/s
146.2s 214 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
146.7s 215 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
146.8s 216 Stored output at t = 120.0000 s (Step 465)
146.8s 217 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
146.8s 218 [A
146.8s 219 
146.8s 220 Simulation finished at t = 120.0000 s after 465 steps.
146.8s 221 Total runtime: 2.34 seconds.
146.8s 222 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.63s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.63s/s]
146.8s 223 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
146.8s 224 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
146.8s 225 Using device: gpu
146.8s 226 DEBUG PARAMS: Reading K_m_kmh = 10.0
146.8s 227 DEBUG PARAMS: Reading K_c_kmh = 15.0
146.8s 228 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
146.8s 229 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
146.8s 230 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
146.8s 231 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
146.8s 232 Loading road quality type: uniform
146.8s 233 Uniform road quality value: 2
146.8s 234 Road quality loaded.
146.8s 235 Initial state created.
146.8s 236 Transferring initial state and road quality to GPU...
146.8s 237 GPU data transfer complete.
146.8s 238 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
146.8s 239 Initial boundary conditions applied.
146.8s 240 [BC UPDATE] left → phase 0 RED (reduced inflow)
146.8s 241 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
146.8s 242 [BC UPDATE] left → phase 1 GREEN (normal inflow)
146.8s 243 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
146.8s 244 Running simulation until t = 60.00 s, outputting every 60.00 s
146.8s 245 
147.2s 246 [WARNING] Automatic CFL correction applied (count: 500):
147.2s 247 Calculated CFL: 0.800 > Limit: 0.500
147.2s 248 Original dt: 4.758816e-01 s
147.2s 249 Corrected dt: 2.974260e-01 s
147.2s 250 Correction factor: 1.6x
147.2s 251 Max wave speed detected: 16.81 m/s
147.3s 252 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
147.8s 253 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
148.2s 254 [WARNING] Automatic CFL correction applied (count: 600):
148.2s 255 Calculated CFL: 0.800 > Limit: 0.500
148.2s 256 Original dt: 4.121510e-01 s
148.2s 257 Corrected dt: 2.575944e-01 s
148.2s 258 Correction factor: 1.6x
148.2s 259 Max wave speed detected: 19.41 m/s
148.3s 260 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
148.8s 261 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
149.1s 262 Stored output at t = 60.0000 s (Step 231)
149.1s 263 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
149.1s 264 [A
149.1s 265 
149.1s 266 Simulation finished at t = 60.0000 s after 231 steps.
149.1s 267 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.62s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.61s/s]
149.1s 268 Total runtime: 2.25 seconds.
149.1s 269 [BC UPDATE] left → phase 0 RED (reduced inflow)
149.1s 270 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
149.1s 271 Running simulation until t = 120.00 s, outputting every 60.00 s
149.1s 272 
149.1s 273 [WARNING] Automatic CFL correction applied (count: 700):
149.1s 274 Calculated CFL: 0.800 > Limit: 0.500
149.1s 275 Original dt: 4.115082e-01 s
149.1s 276 Corrected dt: 2.571926e-01 s
149.1s 277 Correction factor: 1.6x
149.1s 278 Max wave speed detected: 19.44 m/s
149.3s 279 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
149.8s 280 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
150.2s 281 [WARNING] Automatic CFL correction applied (count: 800):
150.2s 282 Calculated CFL: 0.800 > Limit: 0.500
150.2s 283 Original dt: 4.114982e-01 s
150.2s 284 Corrected dt: 2.571864e-01 s
150.2s 285 Correction factor: 1.6x
150.2s 286 Max wave speed detected: 19.44 m/s
150.3s 287 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
150.8s 288 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
151.2s 289 [WARNING] Automatic CFL correction applied (count: 900):
151.2s 290 Calculated CFL: 0.800 > Limit: 0.500
151.2s 291 Original dt: 4.114980e-01 s
151.2s 292 Corrected dt: 2.571863e-01 s
151.2s 293 Correction factor: 1.6x
151.2s 294 Max wave speed detected: 19.44 m/s
151.3s 295 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
151.5s 296 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
151.5s 297 [A
151.5s 298 Stored output at t = 120.0000 s (Step 465)
151.5s 299 
151.5s 300 Simulation finished at t = 120.0000 s after 465 steps.
151.5s 301 Total runtime: 2.35 seconds.
151.5s 302 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.50s/s]
151.5s 303 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
151.5s 304 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
151.5s 305 Using device: gpu
151.5s 306 DEBUG PARAMS: Reading K_m_kmh = 10.0
151.5s 307 DEBUG PARAMS: Reading K_c_kmh = 15.0
151.5s 308 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
151.5s 309 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
151.5s 310 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
151.5s 311 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
151.5s 312 Loading road quality type: uniform
151.5s 313 Uniform road quality value: 2
151.5s 314 Road quality loaded.
151.5s 315 Initial state created.
151.5s 316 Transferring initial state and road quality to GPU...
151.5s 317 GPU data transfer complete.
151.5s 318 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
151.5s 319 Initial boundary conditions applied.
151.5s 320 [BC UPDATE] left → phase 0 RED (reduced inflow)
151.5s 321 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
151.5s 322 Running simulation until t = 60.00 s, outputting every 60.00 s
151.5s 323 
152.0s 324 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
152.2s 325 [WARNING] Automatic CFL correction applied (count: 1000):
152.2s 326 Calculated CFL: 0.800 > Limit: 0.500
152.2s 327 Original dt: 4.225636e-01 s
152.2s 328 Corrected dt: 2.641023e-01 s
152.2s 329 Correction factor: 1.6x
152.2s 330 Max wave speed detected: 18.93 m/s
152.5s 331 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
153.0s 332 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
153.2s 333 [WARNING] Automatic CFL correction applied (count: 1100):
153.2s 334 Calculated CFL: 0.800 > Limit: 0.500
153.2s 335 Original dt: 4.116395e-01 s
153.2s 336 Corrected dt: 2.572747e-01 s
153.2s 337 Correction factor: 1.6x
153.2s 338 Max wave speed detected: 19.43 m/s
153.5s 339 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
153.8s 340 Stored output at t = 60.0000 s (Step 231)
153.8s 341 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
153.8s 342 [A
153.8s 343 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.56s/s]
153.8s 344 
153.8s 345 Simulation finished at t = 60.0000 s after 231 steps.
153.8s 346 Total runtime: 2.35 seconds.
153.8s 347 [BC UPDATE] left → phase 1 GREEN (normal inflow)
153.8s 348 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
153.8s 349 Running simulation until t = 120.00 s, outputting every 60.00 s
153.8s 350 
154.0s 351 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
154.2s 352 [WARNING] Automatic CFL correction applied (count: 1200):
154.2s 353 Calculated CFL: 0.800 > Limit: 0.500
154.2s 354 Original dt: 4.115005e-01 s
154.2s 355 Corrected dt: 2.571878e-01 s
154.2s 356 Correction factor: 1.6x
154.2s 357 Max wave speed detected: 19.44 m/s
154.5s 358 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
155.0s 359 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
155.2s 360 [WARNING] Automatic CFL correction applied (count: 1300):
155.2s 361 Calculated CFL: 0.800 > Limit: 0.500
155.2s 362 Original dt: 4.114981e-01 s
155.2s 363 Corrected dt: 2.571863e-01 s
155.2s 364 Correction factor: 1.6x
155.2s 365 Max wave speed detected: 19.44 m/s
155.5s 366 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
156.0s 367 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
156.2s 368 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
156.2s 369 [A
156.2s 370 Stored output at t = 120.0000 s (Step 465)
156.2s 371 
156.2s 372 Simulation finished at t = 120.0000 s after 465 steps.
156.2s 373 Total runtime: 2.35 seconds.
156.2s 374 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.57s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.57s/s]
156.2s 375 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
156.2s 376 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
156.2s 377 Using device: gpu
156.2s 378 DEBUG PARAMS: Reading K_m_kmh = 10.0
156.2s 379 DEBUG PARAMS: Reading K_c_kmh = 15.0
156.2s 380 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
156.2s 381 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
156.2s 382 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
156.2s 383 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
156.2s 384 Loading road quality type: uniform
156.2s 385 Uniform road quality value: 2
156.2s 386 Road quality loaded.
156.2s 387 Initial state created.
156.2s 388 Transferring initial state and road quality to GPU...
156.2s 389 GPU data transfer complete.
156.2s 390 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
156.2s 391 Initial boundary conditions applied.
156.2s 392 [BC UPDATE] left → phase 0 RED (reduced inflow)
156.2s 393 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
156.2s 394 [BC UPDATE] left → phase 1 GREEN (normal inflow)
156.2s 395 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
156.2s 396 Running simulation until t = 60.00 s, outputting every 60.00 s
156.2s 397 
156.2s 398 [WARNING] Automatic CFL correction applied (count: 1400):
156.2s 399 Calculated CFL: 0.800 > Limit: 0.500
156.2s 400 Original dt: 3.451280e-01 s
156.2s 401 Corrected dt: 2.157050e-01 s
156.2s 402 Correction factor: 1.6x
156.2s 403 Max wave speed detected: 23.18 m/s
156.7s 404 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
157.2s 405 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
157.2s 406 [WARNING] Automatic CFL correction applied (count: 1500):
157.2s 407 Calculated CFL: 0.800 > Limit: 0.500
157.2s 408 Original dt: 4.139892e-01 s
157.2s 409 Corrected dt: 2.587433e-01 s
157.2s 410 Correction factor: 1.6x
157.2s 411 Max wave speed detected: 19.32 m/s
157.7s 412 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
158.2s 413 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
158.2s 414 [WARNING] Automatic CFL correction applied (count: 1600):
158.2s 415 Calculated CFL: 0.800 > Limit: 0.500
158.2s 416 Original dt: 4.115314e-01 s
158.2s 417 Corrected dt: 2.572071e-01 s
158.2s 418 Correction factor: 1.6x
158.2s 419 Max wave speed detected: 19.44 m/s
158.5s 420 Stored output at t = 60.0000 s (Step 231)
158.5s 421 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
158.5s 422 [A
158.5s 423 
158.5s 424 Simulation finished at t = 60.0000 s after 231 steps.
158.5s 425 Total runtime: 2.30 seconds.
158.5s 426 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.12s/s]
158.5s 427 [BC UPDATE] left → phase 0 RED (reduced inflow)
158.5s 428 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
158.5s 429 Running simulation until t = 120.00 s, outputting every 60.00 s
158.5s 430 
158.7s 431 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
159.2s 432 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
159.3s 433 [WARNING] Automatic CFL correction applied (count: 1700):
159.3s 434 Calculated CFL: 0.800 > Limit: 0.500
159.3s 435 Original dt: 4.114986e-01 s
159.3s 436 Corrected dt: 2.571866e-01 s
159.3s 437 Correction factor: 1.6x
159.3s 438 Max wave speed detected: 19.44 m/s
159.7s 439 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
160.2s 440 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
160.3s 441 [WARNING] Automatic CFL correction applied (count: 1800):
160.3s 442 Calculated CFL: 0.800 > Limit: 0.500
160.3s 443 Original dt: 4.114980e-01 s
160.3s 444 Corrected dt: 2.571863e-01 s
160.3s 445 Correction factor: 1.6x
160.3s 446 Max wave speed detected: 19.44 m/s
160.7s 447 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
160.9s 448 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
160.9s 449 [A
160.9s 450 Stored output at t = 120.0000 s (Step 465)
160.9s 451 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.23s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.23s/s]
160.9s 452 
160.9s 453 Simulation finished at t = 120.0000 s after 465 steps.
160.9s 454 Total runtime: 2.38 seconds.
160.9s 455 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
160.9s 456 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
160.9s 457 Using device: gpu
160.9s 458 DEBUG PARAMS: Reading K_m_kmh = 10.0
160.9s 459 DEBUG PARAMS: Reading K_c_kmh = 15.0
160.9s 460 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
160.9s 461 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
160.9s 462 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
160.9s 463 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
160.9s 464 Loading road quality type: uniform
160.9s 465 Uniform road quality value: 2
160.9s 466 Road quality loaded.
160.9s 467 Initial state created.
160.9s 468 Transferring initial state and road quality to GPU...
160.9s 469 GPU data transfer complete.
160.9s 470 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
160.9s 471 Initial boundary conditions applied.
160.9s 472 [BC UPDATE] left → phase 0 RED (reduced inflow)
160.9s 473 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
160.9s 474 [BC UPDATE] left → phase 1 GREEN (normal inflow)
160.9s 475 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
160.9s 476 Running simulation until t = 60.00 s, outputting every 60.00 s
160.9s 477 
161.3s 478 [WARNING] Automatic CFL correction applied (count: 1900):
161.3s 479 Calculated CFL: 0.800 > Limit: 0.500
161.3s 480 Original dt: 4.583403e-01 s
161.3s 481 Corrected dt: 2.864627e-01 s
161.3s 482 Correction factor: 1.6x
161.3s 483 Max wave speed detected: 17.45 m/s
161.4s 484 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
161.9s 485 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
162.3s 486 [WARNING] Automatic CFL correction applied (count: 2000):
162.3s 487 Calculated CFL: 0.800 > Limit: 0.500
162.3s 488 Original dt: 4.120137e-01 s
162.3s 489 Corrected dt: 2.575085e-01 s
162.3s 490 Correction factor: 1.6x
162.3s 491 Max wave speed detected: 19.42 m/s
162.4s 492 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
162.9s 493 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
163.2s 494 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
163.2s 495 [A
163.2s 496 Stored output at t = 60.0000 s (Step 231)
163.2s 497 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.63s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.63s/s]
163.2s 498 
163.2s 499 Simulation finished at t = 60.0000 s after 231 steps.
163.2s 500 Total runtime: 2.34 seconds.
163.2s 501 [BC UPDATE] left → phase 0 RED (reduced inflow)
163.2s 502 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
163.2s 503 Running simulation until t = 120.00 s, outputting every 60.00 s
163.2s 504 
163.3s 505 [WARNING] Automatic CFL correction applied (count: 2100):
163.3s 506 Calculated CFL: 0.800 > Limit: 0.500
163.3s 507 Original dt: 4.115064e-01 s
163.3s 508 Corrected dt: 2.571915e-01 s
163.3s 509 Correction factor: 1.6x
163.3s 510 Max wave speed detected: 19.44 m/s
163.4s 511 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
163.9s 512 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
164.3s 513 [WARNING] Automatic CFL correction applied (count: 2200):
164.3s 514 Calculated CFL: 0.800 > Limit: 0.500
164.3s 515 Original dt: 4.114982e-01 s
164.3s 516 Corrected dt: 2.571864e-01 s
164.3s 517 Correction factor: 1.6x
164.3s 518 Max wave speed detected: 19.44 m/s
164.4s 519 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
165.0s 520 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
165.3s 521 [WARNING] Automatic CFL correction applied (count: 2300):
165.3s 522 Calculated CFL: 0.800 > Limit: 0.500
165.3s 523 Original dt: 4.114980e-01 s
165.3s 524 Corrected dt: 2.571863e-01 s
165.3s 525 Correction factor: 1.6x
165.3s 526 Max wave speed detected: 19.44 m/s
165.5s 527 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
165.6s 528 Stored output at t = 120.0000 s (Step 465)
165.6s 529 
165.6s 530 Simulation finished at t = 120.0000 s after 465 steps.
165.6s 531 Total runtime: 2.37 seconds.
165.6s 532 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
165.6s 533 [A
165.6s 534 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.35s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.35s/s]
165.6s 535 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
165.6s 536 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
165.6s 537 Using device: gpu
165.6s 538 DEBUG PARAMS: Reading K_m_kmh = 10.0
165.6s 539 DEBUG PARAMS: Reading K_c_kmh = 15.0
165.6s 540 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
165.6s 541 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
165.6s 542 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
165.6s 543 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
165.6s 544 Loading road quality type: uniform
165.6s 545 Uniform road quality value: 2
165.6s 546 Road quality loaded.
165.6s 547 Initial state created.
165.6s 548 Transferring initial state and road quality to GPU...
165.6s 549 GPU data transfer complete.
165.6s 550 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
165.6s 551 Initial boundary conditions applied.
165.6s 552 [BC UPDATE] left → phase 0 RED (reduced inflow)
165.6s 553 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
165.6s 554 Running simulation until t = 60.00 s, outputting every 60.00 s
165.6s 555 
166.1s 556 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
166.4s 557 [WARNING] Automatic CFL correction applied (count: 2400):
166.4s 558 Calculated CFL: 0.800 > Limit: 0.500
166.4s 559 Original dt: 4.205139e-01 s
166.4s 560 Corrected dt: 2.628212e-01 s
166.4s 561 Correction factor: 1.6x
166.4s 562 Max wave speed detected: 19.02 m/s
166.6s 563 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
167.1s 564 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
167.3s 565 [WARNING] Automatic CFL correction applied (count: 2500):
167.3s 566 Calculated CFL: 0.800 > Limit: 0.500
167.3s 567 Original dt: 4.116141e-01 s
167.3s 568 Corrected dt: 2.572588e-01 s
167.3s 569 Correction factor: 1.6x
167.3s 570 Max wave speed detected: 19.44 m/s
167.6s 571 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
167.9s 572 Stored output at t = 60.0000 s (Step 231)
167.9s 573 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
167.9s 574 [A
167.9s 575 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.42s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.42s/s]
167.9s 576 
167.9s 577 Simulation finished at t = 60.0000 s after 231 steps.
167.9s 578 Total runtime: 2.27 seconds.
167.9s 579 [BC UPDATE] left → phase 1 GREEN (normal inflow)
167.9s 580 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
167.9s 581 Running simulation until t = 120.00 s, outputting every 60.00 s
167.9s 582 
168.1s 583 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
168.3s 584 [WARNING] Automatic CFL correction applied (count: 2600):
168.3s 585 Calculated CFL: 0.800 > Limit: 0.500
168.3s 586 Original dt: 4.115000e-01 s
168.3s 587 Corrected dt: 2.571875e-01 s
168.3s 588 Correction factor: 1.6x
168.3s 589 Max wave speed detected: 19.44 m/s
168.6s 590 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
169.1s 591 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
169.3s 592 [WARNING] Automatic CFL correction applied (count: 2700):
169.3s 593 Calculated CFL: 0.800 > Limit: 0.500
169.3s 594 Original dt: 4.114981e-01 s
169.3s 595 Corrected dt: 2.571863e-01 s
169.3s 596 Correction factor: 1.6x
169.3s 597 Max wave speed detected: 19.44 m/s
169.6s 598 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
170.1s 599 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
170.3s 600 Stored output at t = 120.0000 s (Step 465)
170.3s 601 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
170.3s 602 [A
170.3s 603 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.29s/s]
170.3s 604 
170.3s 605 Simulation finished at t = 120.0000 s after 465 steps.
170.3s 606 Total runtime: 2.37 seconds.
170.3s 607 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
170.3s 608 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
170.3s 609 Using device: gpu
170.3s 610 DEBUG PARAMS: Reading K_m_kmh = 10.0
170.3s 611 DEBUG PARAMS: Reading K_c_kmh = 15.0
170.3s 612 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
170.3s 613 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
170.3s 614 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
170.3s 615 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
170.3s 616 Loading road quality type: uniform
170.3s 617 Uniform road quality value: 2
170.3s 618 Road quality loaded.
170.3s 619 Initial state created.
170.3s 620 Transferring initial state and road quality to GPU...
170.3s 621 GPU data transfer complete.
170.3s 622 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
170.3s 623 Initial boundary conditions applied.
170.3s 624 [BC UPDATE] left → phase 0 RED (reduced inflow)
170.3s 625 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
170.3s 626 Running simulation until t = 60.00 s, outputting every 60.00 s
170.3s 627 
170.4s 628 [WARNING] Automatic CFL correction applied (count: 2800):
170.4s 629 Calculated CFL: 0.800 > Limit: 0.500
170.4s 630 Original dt: 3.737254e-01 s
170.4s 631 Corrected dt: 2.335784e-01 s
170.4s 632 Correction factor: 1.6x
170.4s 633 Max wave speed detected: 21.41 m/s
170.8s 634 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
171.3s 635 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
171.4s 636 [WARNING] Automatic CFL correction applied (count: 2900):
171.4s 637 Calculated CFL: 0.800 > Limit: 0.500
171.4s 638 Original dt: 4.134305e-01 s
171.4s 639 Corrected dt: 2.583941e-01 s
171.4s 640 Correction factor: 1.6x
171.4s 641 Max wave speed detected: 19.35 m/s
171.8s 642 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
172.3s 643 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
172.4s 644 [WARNING] Automatic CFL correction applied (count: 3000):
172.4s 645 Calculated CFL: 0.800 > Limit: 0.500
172.4s 646 Original dt: 4.115259e-01 s
172.4s 647 Corrected dt: 2.572037e-01 s
172.4s 648 Correction factor: 1.6x
172.4s 649 Max wave speed detected: 19.44 m/s
172.6s 650 Stored output at t = 60.0000 s (Step 231)
172.6s 651 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
172.6s 652 [A
172.6s 653 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.11s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.11s/s]
172.6s 654 
172.6s 655 Simulation finished at t = 60.0000 s after 231 steps.
172.6s 656 Total runtime: 2.30 seconds.
172.6s 657 [BC UPDATE] left → phase 1 GREEN (normal inflow)
172.6s 658 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
172.6s 659 Running simulation until t = 120.00 s, outputting every 60.00 s
172.6s 660 
172.8s 661 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
173.3s 662 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
173.4s 663 [WARNING] Automatic CFL correction applied (count: 3100):
173.4s 664 Calculated CFL: 0.800 > Limit: 0.500
173.4s 665 Original dt: 4.114985e-01 s
173.4s 666 Corrected dt: 2.571866e-01 s
173.4s 667 Correction factor: 1.6x
173.4s 668 Max wave speed detected: 19.44 m/s
173.8s 669 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
174.3s 670 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
174.3s 671 [WARNING] Automatic CFL correction applied (count: 3200):
174.3s 672 Calculated CFL: 0.800 > Limit: 0.500
174.3s 673 Original dt: 4.114980e-01 s
174.3s 674 Corrected dt: 2.571863e-01 s
174.3s 675 Correction factor: 1.6x
174.3s 676 Max wave speed detected: 19.44 m/s
174.7s 677 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
174.9s 678 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
174.9s 679 [A
174.9s 680 Stored output at t = 120.0000 s (Step 465)
174.9s 681 
174.9s 682 Simulation finished at t = 120.0000 s after 465 steps.
174.9s 683 Total runtime: 2.30 seconds.
174.9s 684 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.09s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.08s/s]
174.9s 685 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
174.9s 686 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
174.9s 687 Using device: gpu
174.9s 688 DEBUG PARAMS: Reading K_m_kmh = 10.0
174.9s 689 DEBUG PARAMS: Reading K_c_kmh = 15.0
174.9s 690 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
174.9s 691 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
174.9s 692 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
174.9s 693 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
174.9s 694 Loading road quality type: uniform
174.9s 695 Uniform road quality value: 2
174.9s 696 Road quality loaded.
174.9s 697 Initial state created.
174.9s 698 Transferring initial state and road quality to GPU...
174.9s 699 GPU data transfer complete.
174.9s 700 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
174.9s 701 Initial boundary conditions applied.
174.9s 702 [BC UPDATE] left → phase 0 RED (reduced inflow)
174.9s 703 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
174.9s 704 [BC UPDATE] left → phase 1 GREEN (normal inflow)
174.9s 705 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
174.9s 706 Running simulation until t = 60.00 s, outputting every 60.00 s
174.9s 707 
175.3s 708 [WARNING] Automatic CFL correction applied (count: 3300):
175.3s 709 Calculated CFL: 0.800 > Limit: 0.500
175.3s 710 Original dt: 4.470525e-01 s
175.3s 711 Corrected dt: 2.794078e-01 s
175.3s 712 Correction factor: 1.6x
175.3s 713 Max wave speed detected: 17.89 m/s
175.4s 714 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
175.9s 715 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
176.3s 716 [WARNING] Automatic CFL correction applied (count: 3400):
176.3s 717 Calculated CFL: 0.800 > Limit: 0.500
176.3s 718 Original dt: 4.119130e-01 s
176.3s 719 Corrected dt: 2.574456e-01 s
176.3s 720 Correction factor: 1.6x
176.3s 721 Max wave speed detected: 19.42 m/s
176.3s 722 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
176.8s 723 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
177.1s 724 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
177.1s 725 [A
177.1s 726 Stored output at t = 60.0000 s (Step 231)
177.1s 727 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.38s/s]
177.1s 728 
177.1s 729 Simulation finished at t = 60.0000 s after 231 steps.
177.1s 730 Total runtime: 2.19 seconds.
177.1s 731 [BC UPDATE] left → phase 0 RED (reduced inflow)
177.1s 732 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
177.1s 733 Running simulation until t = 120.00 s, outputting every 60.00 s
177.1s 734 
177.2s 735 [WARNING] Automatic CFL correction applied (count: 3500):
177.2s 736 Calculated CFL: 0.800 > Limit: 0.500
177.2s 737 Original dt: 4.115046e-01 s
177.2s 738 Corrected dt: 2.571904e-01 s
177.2s 739 Correction factor: 1.6x
177.2s 740 Max wave speed detected: 19.44 m/s
177.3s 741 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
177.7s 742 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
178.1s 743 [WARNING] Automatic CFL correction applied (count: 3600):
178.1s 744 Calculated CFL: 0.800 > Limit: 0.500
178.1s 745 Original dt: 4.114982e-01 s
178.1s 746 Corrected dt: 2.571863e-01 s
178.1s 747 Correction factor: 1.6x
178.1s 748 Max wave speed detected: 19.44 m/s
178.2s 749 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
178.7s 750 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
179.1s 751 [WARNING] Automatic CFL correction applied (count: 3700):
179.1s 752 Calculated CFL: 0.800 > Limit: 0.500
179.1s 753 Original dt: 4.114980e-01 s
179.1s 754 Corrected dt: 2.571863e-01 s
179.1s 755 Correction factor: 1.6x
179.1s 756 Max wave speed detected: 19.44 m/s
179.2s 757 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
179.3s 758 Stored output at t = 120.0000 s (Step 465)
179.3s 759 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
179.3s 760 [A
179.3s 761 
179.3s 762 Simulation finished at t = 120.0000 s after 465 steps.
179.3s 763 Total runtime: 2.20 seconds.
179.3s 764 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.25s/s]
179.3s 765 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
179.3s 766 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
179.3s 767 Using device: gpu
179.3s 768 DEBUG PARAMS: Reading K_m_kmh = 10.0
179.3s 769 DEBUG PARAMS: Reading K_c_kmh = 15.0
179.3s 770 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
179.3s 771 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
179.3s 772 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
179.3s 773 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
179.3s 774 Loading road quality type: uniform
179.3s 775 Uniform road quality value: 2
179.3s 776 Road quality loaded.
179.3s 777 Initial state created.
179.3s 778 Transferring initial state and road quality to GPU...
179.3s 779 GPU data transfer complete.
179.3s 780 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
179.3s 781 Initial boundary conditions applied.
179.3s 782 [BC UPDATE] left → phase 0 RED (reduced inflow)
179.3s 783 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
179.3s 784 [BC UPDATE] left → phase 1 GREEN (normal inflow)
179.3s 785 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
179.3s 786 Running simulation until t = 60.00 s, outputting every 60.00 s
179.3s 787 
179.8s 788 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
180.1s 789 [WARNING] Automatic CFL correction applied (count: 3800):
180.1s 790 Calculated CFL: 0.800 > Limit: 0.500
180.1s 791 Original dt: 4.190346e-01 s
180.1s 792 Corrected dt: 2.618967e-01 s
180.1s 793 Correction factor: 1.6x
180.1s 794 Max wave speed detected: 19.09 m/s
180.3s 795 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
180.7s 796 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
181.0s 797 [WARNING] Automatic CFL correction applied (count: 3900):
181.0s 798 Calculated CFL: 0.800 > Limit: 0.500
181.0s 799 Original dt: 4.115954e-01 s
181.0s 800 Corrected dt: 2.572472e-01 s
181.0s 801 Correction factor: 1.6x
181.0s 802 Max wave speed detected: 19.44 m/s
181.2s 803 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
181.5s 804 Stored output at t = 60.0000 s (Step 231)
181.5s 805 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
181.5s 806 [A
181.5s 807 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.01s/s]
181.5s 808 
181.5s 809 Simulation finished at t = 60.0000 s after 231 steps.
181.5s 810 Total runtime: 2.22 seconds.
181.5s 811 Running simulation until t = 120.00 s, outputting every 60.00 s
181.5s 812 
181.7s 813 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
182.0s 814 [WARNING] Automatic CFL correction applied (count: 4000):
182.0s 815 Calculated CFL: 0.800 > Limit: 0.500
182.0s 816 Original dt: 4.114996e-01 s
182.0s 817 Corrected dt: 2.571873e-01 s
182.0s 818 Correction factor: 1.6x
182.0s 819 Max wave speed detected: 19.44 m/s
182.2s 820 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
182.7s 821 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
183.0s 822 [WARNING] Automatic CFL correction applied (count: 4100):
183.0s 823 Calculated CFL: 0.800 > Limit: 0.500
183.0s 824 Original dt: 4.114981e-01 s
183.0s 825 Corrected dt: 2.571863e-01 s
183.0s 826 Correction factor: 1.6x
183.0s 827 Max wave speed detected: 19.44 m/s
183.2s 828 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
183.7s 829 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
183.8s 830 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
183.8s 831 [A
183.8s 832 Stored output at t = 120.0000 s (Step 465)
183.8s 833 
183.8s 834 Simulation finished at t = 120.0000 s after 465 steps.
183.8s 835 Total runtime: 2.27 seconds.
183.8s 836 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.44s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.44s/s]
183.8s 837 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
183.8s 838 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
183.8s 839 Using device: gpu
183.8s 840 DEBUG PARAMS: Reading K_m_kmh = 10.0
183.8s 841 DEBUG PARAMS: Reading K_c_kmh = 15.0
183.8s 842 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
183.8s 843 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
183.8s 844 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
183.8s 845 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
183.8s 846 Loading road quality type: uniform
183.8s 847 Uniform road quality value: 2
183.8s 848 Road quality loaded.
183.8s 849 Initial state created.
183.8s 850 Transferring initial state and road quality to GPU...
183.8s 851 GPU data transfer complete.
183.8s 852 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
183.8s 853 Initial boundary conditions applied.
183.8s 854 [BC UPDATE] left → phase 0 RED (reduced inflow)
183.8s 855 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
183.8s 856 Running simulation until t = 60.00 s, outputting every 60.00 s
183.8s 857 
184.0s 858 [WARNING] Automatic CFL correction applied (count: 4200):
184.0s 859 Calculated CFL: 0.800 > Limit: 0.500
184.0s 860 Original dt: 4.022422e-01 s
184.0s 861 Corrected dt: 2.514014e-01 s
184.0s 862 Correction factor: 1.6x
184.0s 863 Max wave speed detected: 19.89 m/s
184.3s 864 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
184.8s 865 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
184.9s 866 [WARNING] Automatic CFL correction applied (count: 4300):
184.9s 867 Calculated CFL: 0.800 > Limit: 0.500
184.9s 868 Original dt: 4.130229e-01 s
184.9s 869 Corrected dt: 2.581393e-01 s
184.9s 870 Correction factor: 1.6x
184.9s 871 Max wave speed detected: 19.37 m/s
185.3s 872 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
185.8s 873 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
185.9s 874 [WARNING] Automatic CFL correction applied (count: 4400):
185.9s 875 Calculated CFL: 0.800 > Limit: 0.500
185.9s 876 Original dt: 4.115198e-01 s
185.9s 877 Corrected dt: 2.571999e-01 s
185.9s 878 Correction factor: 1.6x
185.9s 879 Max wave speed detected: 19.44 m/s
186.1s 880 Stored output at t = 60.0000 s (Step 231)
186.1s 881 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
186.1s 882 [A
186.1s 883 
186.1s 884 Simulation finished at t = 60.0000 s after 231 steps.
186.1s 885 Total runtime: 2.24 seconds.
186.1s 886 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.82s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.81s/s]
186.1s 887 Running simulation until t = 120.00 s, outputting every 60.00 s
186.1s 888 
186.2s 889 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
186.8s 890 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
186.9s 891 [WARNING] Automatic CFL correction applied (count: 4500):
186.9s 892 Calculated CFL: 0.800 > Limit: 0.500
186.9s 893 Original dt: 4.114984e-01 s
186.9s 894 Corrected dt: 2.571865e-01 s
186.9s 895 Correction factor: 1.6x
186.9s 896 Max wave speed detected: 19.44 m/s
187.2s 897 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
187.7s 898 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
187.9s 899 [WARNING] Automatic CFL correction applied (count: 4600):
187.9s 900 Calculated CFL: 0.800 > Limit: 0.500
187.9s 901 Original dt: 4.114980e-01 s
187.9s 902 Corrected dt: 2.571863e-01 s
187.9s 903 Correction factor: 1.6x
187.9s 904 Max wave speed detected: 19.44 m/s
188.2s 905 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
188.4s 906 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
188.4s 907 [A
188.4s 908 Stored output at t = 120.0000 s (Step 465)
188.4s 909 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.16s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.15s/s]
188.4s 910 
188.4s 911 Simulation finished at t = 120.0000 s after 465 steps.
188.4s 912 Total runtime: 2.29 seconds.
188.4s 913 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
188.4s 914 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
188.4s 915 Using device: gpu
188.4s 916 DEBUG PARAMS: Reading K_m_kmh = 10.0
188.4s 917 DEBUG PARAMS: Reading K_c_kmh = 15.0
188.4s 918 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
188.4s 919 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
188.4s 920 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
188.4s 921 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
188.4s 922 Loading road quality type: uniform
188.4s 923 Uniform road quality value: 2
188.4s 924 Road quality loaded.
188.4s 925 Initial state created.
188.4s 926 Transferring initial state and road quality to GPU...
188.4s 927 GPU data transfer complete.
188.4s 928 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
188.4s 929 Initial boundary conditions applied.
188.4s 930 [BC UPDATE] left → phase 0 RED (reduced inflow)
188.4s 931 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
188.4s 932 Running simulation until t = 60.00 s, outputting every 60.00 s
188.4s 933 
188.8s 934 [WARNING] Automatic CFL correction applied (count: 4700):
188.8s 935 Calculated CFL: 0.800 > Limit: 0.500
188.8s 936 Original dt: 4.396418e-01 s
188.8s 937 Corrected dt: 2.747761e-01 s
188.8s 938 Correction factor: 1.6x
188.8s 939 Max wave speed detected: 18.20 m/s
188.9s 940 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
189.3s 941 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
189.8s 942 [WARNING] Automatic CFL correction applied (count: 4800):
189.8s 943 Calculated CFL: 0.800 > Limit: 0.500
189.8s 944 Original dt: 4.118393e-01 s
189.8s 945 Corrected dt: 2.573996e-01 s
189.8s 946 Correction factor: 1.6x
189.8s 947 Max wave speed detected: 19.43 m/s
189.8s 948 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
190.3s 949 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
190.6s 950 Stored output at t = 60.0000 s (Step 231)
190.6s 951 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
190.6s 952 [A
190.6s 953 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.17s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.17s/s]
190.6s 954 
190.6s 955 Simulation finished at t = 60.0000 s after 231 steps.
190.6s 956 Total runtime: 2.21 seconds.
190.6s 957 [BC UPDATE] left → phase 1 GREEN (normal inflow)
190.6s 958 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
190.6s 959 Running simulation until t = 120.00 s, outputting every 60.00 s
190.6s 960 
190.8s 961 [WARNING] Automatic CFL correction applied (count: 4900):
190.8s 962 Calculated CFL: 0.800 > Limit: 0.500
190.8s 963 Original dt: 4.115033e-01 s
190.8s 964 Corrected dt: 2.571896e-01 s
190.8s 965 Correction factor: 1.6x
190.8s 966 Max wave speed detected: 19.44 m/s
190.8s 967 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
191.2s 968 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
191.8s 969 [WARNING] Automatic CFL correction applied (count: 5000):
191.8s 970 Calculated CFL: 0.800 > Limit: 0.500
191.8s 971 Original dt: 4.114981e-01 s
191.8s 972 Corrected dt: 2.571863e-01 s
191.8s 973 Correction factor: 1.6x
191.8s 974 Max wave speed detected: 19.44 m/s
191.8s 975 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
192.3s 976 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
192.8s 977 [WARNING] Automatic CFL correction applied (count: 5100):
192.8s 978 Calculated CFL: 0.800 > Limit: 0.500
192.8s 979 Original dt: 4.114980e-01 s
192.8s 980 Corrected dt: 2.571863e-01 s
192.8s 981 Correction factor: 1.6x
192.8s 982 Max wave speed detected: 19.44 m/s
192.8s 983 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
193.0s 984 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
193.0s 985 Stored output at t = 120.0000 s (Step 465)
193.0s 986 [A
193.0s 987 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.30s/s]
193.0s 988 
193.0s 989 Simulation finished at t = 120.0000 s after 465 steps.
193.0s 990 Total runtime: 2.37 seconds.
193.0s 991 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
193.0s 992 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
193.0s 993 Using device: gpu
193.0s 994 DEBUG PARAMS: Reading K_m_kmh = 10.0
193.0s 995 DEBUG PARAMS: Reading K_c_kmh = 15.0
193.0s 996 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
193.0s 997 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
193.0s 998 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
193.0s 999 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
193.0s 1000 Loading road quality type: uniform
193.0s 1001 Uniform road quality value: 2
193.0s 1002 Road quality loaded.
193.0s 1003 Initial state created.
193.0s 1004 Transferring initial state and road quality to GPU...
193.0s 1005 GPU data transfer complete.
193.0s 1006 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
193.0s 1007 Initial boundary conditions applied.
193.0s 1008 [BC UPDATE] left → phase 0 RED (reduced inflow)
193.0s 1009 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
193.0s 1010 [BC UPDATE] left → phase 1 GREEN (normal inflow)
193.0s 1011 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
193.0s 1012 Running simulation until t = 60.00 s, outputting every 60.00 s
193.0s 1013 
193.4s 1014 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
193.8s 1015 [WARNING] Automatic CFL correction applied (count: 5200):
193.8s 1016 Calculated CFL: 0.800 > Limit: 0.500
193.8s 1017 Original dt: 4.173029e-01 s
193.8s 1018 Corrected dt: 2.608143e-01 s
193.8s 1019 Correction factor: 1.6x
193.8s 1020 Max wave speed detected: 19.17 m/s
193.9s 1021 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
194.4s 1022 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
194.7s 1023 [WARNING] Automatic CFL correction applied (count: 5300):
194.7s 1024 Calculated CFL: 0.800 > Limit: 0.500
194.7s 1025 Original dt: 4.115760e-01 s
194.7s 1026 Corrected dt: 2.572350e-01 s
194.7s 1027 Correction factor: 1.6x
194.7s 1028 Max wave speed detected: 19.44 m/s
194.8s 1029 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
195.1s 1030 Stored output at t = 60.0000 s (Step 231)
195.1s 1031 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
195.1s 1032 [A
195.1s 1033 
195.1s 1034 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s]
195.1s 1035 Simulation finished at t = 60.0000 s after 231 steps.
195.1s 1036 Total runtime: 2.17 seconds.
195.1s 1037 [BC UPDATE] left → phase 0 RED (reduced inflow)
195.1s 1038 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
195.1s 1039 Running simulation until t = 120.00 s, outputting every 60.00 s
195.1s 1040 
195.3s 1041 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
195.7s 1042 [WARNING] Automatic CFL correction applied (count: 5400):
195.7s 1043 Calculated CFL: 0.800 > Limit: 0.500
195.7s 1044 Original dt: 4.114993e-01 s
195.7s 1045 Corrected dt: 2.571871e-01 s
195.7s 1046 Correction factor: 1.6x
195.7s 1047 Max wave speed detected: 19.44 m/s
195.8s 1048 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
196.3s 1049 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
196.6s 1050 [WARNING] Automatic CFL correction applied (count: 5500):
196.6s 1051 Calculated CFL: 0.800 > Limit: 0.500
196.6s 1052 Original dt: 4.114981e-01 s
196.6s 1053 Corrected dt: 2.571863e-01 s
196.6s 1054 Correction factor: 1.6x
196.6s 1055 Max wave speed detected: 19.44 m/s
196.7s 1056 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
197.2s 1057 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
197.4s 1058 Stored output at t = 120.0000 s (Step 465)
197.4s 1059 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
197.4s 1060 [A
197.4s 1061 
197.4s 1062 Simulation finished at t = 120.0000 s after 465 steps.
197.4s 1063 Total runtime: 2.24 seconds.
197.4s 1064 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.75s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.75s/s]
197.4s 1065 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
197.4s 1066 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
197.4s 1067 Using device: gpu
197.4s 1068 DEBUG PARAMS: Reading K_m_kmh = 10.0
197.4s 1069 DEBUG PARAMS: Reading K_c_kmh = 15.0
197.4s 1070 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
197.4s 1071 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
197.4s 1072 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
197.4s 1073 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
197.4s 1074 Loading road quality type: uniform
197.4s 1075 Uniform road quality value: 2
197.4s 1076 Road quality loaded.
197.4s 1077 Initial state created.
197.4s 1078 Transferring initial state and road quality to GPU...
197.4s 1079 GPU data transfer complete.
197.4s 1080 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
197.4s 1081 Initial boundary conditions applied.
197.4s 1082 [BC UPDATE] left → phase 0 RED (reduced inflow)
197.4s 1083 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
197.4s 1084 Running simulation until t = 60.00 s, outputting every 60.00 s
197.4s 1085 
197.6s 1086 [WARNING] Automatic CFL correction applied (count: 5600):
197.6s 1087 Calculated CFL: 0.800 > Limit: 0.500
197.6s 1088 Original dt: 4.295974e-01 s
197.6s 1089 Corrected dt: 2.684983e-01 s
197.6s 1090 Correction factor: 1.6x
197.6s 1091 Max wave speed detected: 18.62 m/s
197.9s 1092 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
198.4s 1093 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
198.5s 1094 [WARNING] Automatic CFL correction applied (count: 5700):
198.5s 1095 Calculated CFL: 0.800 > Limit: 0.500
198.5s 1096 Original dt: 4.127253e-01 s
198.5s 1097 Corrected dt: 2.579533e-01 s
198.5s 1098 Correction factor: 1.6x
198.5s 1099 Max wave speed detected: 19.38 m/s
198.8s 1100 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
199.3s 1101 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
199.5s 1102 [WARNING] Automatic CFL correction applied (count: 5800):
199.5s 1103 Calculated CFL: 0.800 > Limit: 0.500
199.5s 1104 Original dt: 4.115153e-01 s
199.5s 1105 Corrected dt: 2.571971e-01 s
199.5s 1106 Correction factor: 1.6x
199.5s 1107 Max wave speed detected: 19.44 m/s
199.6s 1108 Stored output at t = 60.0000 s (Step 231)
199.6s 1109 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
199.6s 1110 [A
199.6s 1111 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.25s/s]
199.6s 1112 
199.6s 1113 Simulation finished at t = 60.0000 s after 231 steps.
199.6s 1114 Total runtime: 2.20 seconds.
199.6s 1115 [BC UPDATE] left → phase 1 GREEN (normal inflow)
199.6s 1116 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
199.6s 1117 Running simulation until t = 120.00 s, outputting every 60.00 s
199.6s 1118 
199.8s 1119 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
200.3s 1120 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
200.5s 1121 [WARNING] Automatic CFL correction applied (count: 5900):
200.5s 1122 Calculated CFL: 0.800 > Limit: 0.500
200.5s 1123 Original dt: 4.114984e-01 s
200.5s 1124 Corrected dt: 2.571865e-01 s
200.5s 1125 Correction factor: 1.6x
200.5s 1126 Max wave speed detected: 19.44 m/s
200.8s 1127 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
201.2s 1128 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
201.4s 1129 [WARNING] Automatic CFL correction applied (count: 6000):
201.4s 1130 Calculated CFL: 0.800 > Limit: 0.500
201.4s 1131 Original dt: 4.114980e-01 s
201.4s 1132 Corrected dt: 2.571863e-01 s
201.4s 1133 Correction factor: 1.6x
201.4s 1134 Max wave speed detected: 19.44 m/s
201.7s 1135 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
201.9s 1136 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
201.9s 1137 [A
201.9s 1138 Stored output at t = 120.0000 s (Step 465)
201.9s 1139 
201.9s 1140 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.56s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.56s/s]
201.9s 1141 Simulation finished at t = 120.0000 s after 465 steps.
201.9s 1142 Total runtime: 2.26 seconds.
201.9s 1143 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
201.9s 1144 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
201.9s 1145 Using device: gpu
201.9s 1146 DEBUG PARAMS: Reading K_m_kmh = 10.0
201.9s 1147 DEBUG PARAMS: Reading K_c_kmh = 15.0
201.9s 1148 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
201.9s 1149 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
201.9s 1150 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
201.9s 1151 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
201.9s 1152 Loading road quality type: uniform
201.9s 1153 Uniform road quality value: 2
201.9s 1154 Road quality loaded.
201.9s 1155 Initial state created.
201.9s 1156 Transferring initial state and road quality to GPU...
201.9s 1157 GPU data transfer complete.
201.9s 1158 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
201.9s 1159 Initial boundary conditions applied.
201.9s 1160 [BC UPDATE] left → phase 0 RED (reduced inflow)
201.9s 1161 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
201.9s 1162 Running simulation until t = 60.00 s, outputting every 60.00 s
201.9s 1163 
202.4s 1164 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
202.4s 1165 [WARNING] Automatic CFL correction applied (count: 6100):
202.4s 1166 Calculated CFL: 0.800 > Limit: 0.500
202.4s 1167 Original dt: 4.346596e-01 s
202.4s 1168 Corrected dt: 2.716622e-01 s
202.4s 1169 Correction factor: 1.6x
202.4s 1170 Max wave speed detected: 18.41 m/s
202.8s 1171 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
203.3s 1172 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
203.3s 1173 [WARNING] Automatic CFL correction applied (count: 6200):
203.3s 1174 Calculated CFL: 0.800 > Limit: 0.500
203.3s 1175 Original dt: 4.117853e-01 s
203.3s 1176 Corrected dt: 2.573658e-01 s
203.3s 1177 Correction factor: 1.6x
203.3s 1178 Max wave speed detected: 19.43 m/s
203.8s 1179 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
204.1s 1180 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
204.1s 1181 [A
204.1s 1182 Stored output at t = 60.0000 s (Step 231)
204.1s 1183 
204.1s 1184 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.26s/s]
204.1s 1185 Simulation finished at t = 60.0000 s after 231 steps.
204.1s 1186 Total runtime: 2.20 seconds.
204.1s 1187 [BC UPDATE] left → phase 1 GREEN (normal inflow)
204.1s 1188 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
204.1s 1189 Running simulation until t = 120.00 s, outputting every 60.00 s
204.1s 1190 
204.3s 1191 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
204.3s 1192 [WARNING] Automatic CFL correction applied (count: 6300):
204.3s 1193 Calculated CFL: 0.800 > Limit: 0.500
204.3s 1194 Original dt: 4.115023e-01 s
204.3s 1195 Corrected dt: 2.571890e-01 s
204.3s 1196 Correction factor: 1.6x
204.3s 1197 Max wave speed detected: 19.44 m/s
204.7s 1198 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
205.2s 1199 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
205.3s 1200 [WARNING] Automatic CFL correction applied (count: 6400):
205.3s 1201 Calculated CFL: 0.800 > Limit: 0.500
205.3s 1202 Original dt: 4.114981e-01 s
205.3s 1203 Corrected dt: 2.571863e-01 s
205.3s 1204 Correction factor: 1.6x
205.3s 1205 Max wave speed detected: 19.44 m/s
205.7s 1206 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
206.1s 1207 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
206.2s 1208 [WARNING] Automatic CFL correction applied (count: 6500):
206.2s 1209 Calculated CFL: 0.800 > Limit: 0.500
206.2s 1210 Original dt: 4.114980e-01 s
206.2s 1211 Corrected dt: 2.571863e-01 s
206.2s 1212 Correction factor: 1.6x
206.2s 1213 Max wave speed detected: 19.44 m/s
206.3s 1214 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
206.3s 1215 Stored output at t = 120.0000 s (Step 465)
206.3s 1216 [A
206.3s 1217 
206.3s 1218 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.34s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.33s/s]
206.3s 1219 Simulation finished at t = 120.0000 s after 465 steps.
206.3s 1220 Total runtime: 2.20 seconds.
206.3s 1221 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
206.3s 1222 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
206.3s 1223 Using device: gpu
206.3s 1224 DEBUG PARAMS: Reading K_m_kmh = 10.0
206.3s 1225 DEBUG PARAMS: Reading K_c_kmh = 15.0
206.3s 1226 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
206.3s 1227 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
206.3s 1228 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
206.3s 1229 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
206.3s 1230 Loading road quality type: uniform
206.3s 1231 Uniform road quality value: 2
206.3s 1232 Road quality loaded.
206.3s 1233 Initial state created.
206.3s 1234 Transferring initial state and road quality to GPU...
206.3s 1235 GPU data transfer complete.
206.3s 1236 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
206.3s 1237 Initial boundary conditions applied.
206.3s 1238 [BC UPDATE] left → phase 0 RED (reduced inflow)
206.3s 1239 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
206.3s 1240 Running simulation until t = 60.00 s, outputting every 60.00 s
206.3s 1241 
206.8s 1242 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
207.2s 1243 [WARNING] Automatic CFL correction applied (count: 6600):
207.2s 1244 Calculated CFL: 0.800 > Limit: 0.500
207.2s 1245 Original dt: 4.160552e-01 s
207.2s 1246 Corrected dt: 2.600345e-01 s
207.2s 1247 Correction factor: 1.6x
207.2s 1248 Max wave speed detected: 19.23 m/s
207.3s 1249 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
207.8s 1250 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
208.1s 1251 [WARNING] Automatic CFL correction applied (count: 6700):
208.1s 1252 Calculated CFL: 0.800 > Limit: 0.500
208.1s 1253 Original dt: 4.115592e-01 s
208.1s 1254 Corrected dt: 2.572245e-01 s
208.1s 1255 Correction factor: 1.6x
208.1s 1256 Max wave speed detected: 19.44 m/s
208.2s 1257 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
208.5s 1258 Stored output at t = 60.0000 s (Step 231)
208.5s 1259 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
208.5s 1260 [A
208.5s 1261 
208.5s 1262 Simulation finished at t = 60.0000 s after 231 steps.
208.5s 1263 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.95s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.95s/s]
208.5s 1264 Total runtime: 2.23 seconds.
208.5s 1265 [BC UPDATE] left → phase 1 GREEN (normal inflow)
208.5s 1266 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
208.5s 1267 Running simulation until t = 120.00 s, outputting every 60.00 s
208.5s 1268 
208.7s 1269 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
209.1s 1270 [WARNING] Automatic CFL correction applied (count: 6800):
209.1s 1271 Calculated CFL: 0.800 > Limit: 0.500
209.1s 1272 Original dt: 4.114991e-01 s
209.1s 1273 Corrected dt: 2.571870e-01 s
209.1s 1274 Correction factor: 1.6x
209.1s 1275 Max wave speed detected: 19.44 m/s
209.2s 1276 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
209.7s 1277 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
210.1s 1278 [WARNING] Automatic CFL correction applied (count: 6900):
210.1s 1279 Calculated CFL: 0.800 > Limit: 0.500
210.1s 1280 Original dt: 4.114980e-01 s
210.1s 1281 Corrected dt: 2.571863e-01 s
210.1s 1282 Correction factor: 1.6x
210.1s 1283 Max wave speed detected: 19.44 m/s
210.2s 1284 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
210.7s 1285 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
210.9s 1286 Stored output at t = 120.0000 s (Step 465)
210.9s 1287 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
210.9s 1288 [A
210.9s 1289 
210.9s 1290 Simulation finished at t = 120.0000 s after 465 steps.
210.9s 1291 Total runtime: 2.35 seconds.
210.9s 1292 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.57s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.57s/s]
210.9s 1293 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
210.9s 1294 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
210.9s 1295 Using device: gpu
210.9s 1296 DEBUG PARAMS: Reading K_m_kmh = 10.0
210.9s 1297 DEBUG PARAMS: Reading K_c_kmh = 15.0
210.9s 1298 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
210.9s 1299 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
210.9s 1300 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
210.9s 1301 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
210.9s 1302 Loading road quality type: uniform
210.9s 1303 Uniform road quality value: 2
210.9s 1304 Road quality loaded.
210.9s 1305 Initial state created.
210.9s 1306 Transferring initial state and road quality to GPU...
210.9s 1307 GPU data transfer complete.
210.9s 1308 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
210.9s 1309 Initial boundary conditions applied.
210.9s 1310 [BC UPDATE] left → phase 0 RED (reduced inflow)
210.9s 1311 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
210.9s 1312 
210.9s 1313 Running simulation until t = 60.00 s, outputting every 60.00 s
211.1s 1314 [WARNING] Automatic CFL correction applied (count: 7000):
211.1s 1315 Calculated CFL: 0.800 > Limit: 0.500
211.1s 1316 Original dt: 4.547467e-01 s
211.1s 1317 Corrected dt: 2.842167e-01 s
211.1s 1318 Correction factor: 1.6x
211.1s 1319 Max wave speed detected: 17.59 m/s
211.4s 1320 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
211.9s 1321 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
212.2s 1322 [WARNING] Automatic CFL correction applied (count: 7100):
212.2s 1323 Calculated CFL: 0.800 > Limit: 0.500
212.2s 1324 Original dt: 4.125079e-01 s
212.2s 1325 Corrected dt: 2.578175e-01 s
212.2s 1326 Correction factor: 1.6x
212.2s 1327 Max wave speed detected: 19.39 m/s
212.5s 1328 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
213.0s 1329 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
213.2s 1330 [WARNING] Automatic CFL correction applied (count: 7200):
213.2s 1331 Calculated CFL: 0.800 > Limit: 0.500
213.2s 1332 Original dt: 4.115121e-01 s
213.2s 1333 Corrected dt: 2.571950e-01 s
213.2s 1334 Correction factor: 1.6x
213.2s 1335 Max wave speed detected: 19.44 m/s
213.3s 1336 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
213.3s 1337 [A
213.3s 1338 Stored output at t = 60.0000 s (Step 231)
213.3s 1339 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.13s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 25.13s/s]
213.3s 1340 
213.3s 1341 Simulation finished at t = 60.0000 s after 231 steps.
213.3s 1342 Total runtime: 2.39 seconds.
213.3s 1343 Running simulation until t = 120.00 s, outputting every 60.00 s
213.3s 1344 
213.5s 1345 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
214.0s 1346 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
214.2s 1347 [WARNING] Automatic CFL correction applied (count: 7300):
214.2s 1348 Calculated CFL: 0.800 > Limit: 0.500
214.2s 1349 Original dt: 4.114983e-01 s
214.2s 1350 Corrected dt: 2.571865e-01 s
214.2s 1351 Correction factor: 1.6x
214.2s 1352 Max wave speed detected: 19.44 m/s
214.4s 1353 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
214.9s 1354 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
215.1s 1355 [WARNING] Automatic CFL correction applied (count: 7400):
215.1s 1356 Calculated CFL: 0.800 > Limit: 0.500
215.1s 1357 Original dt: 4.114980e-01 s
215.1s 1358 Corrected dt: 2.571863e-01 s
215.1s 1359 Correction factor: 1.6x
215.1s 1360 Max wave speed detected: 19.44 m/s
215.4s 1361 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
215.5s 1362 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
215.5s 1363 [A
215.5s 1364 Stored output at t = 120.0000 s (Step 465)
215.5s 1365 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.65s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.65s/s]
215.5s 1366 
215.5s 1367 Simulation finished at t = 120.0000 s after 465 steps.
215.5s 1368 Total runtime: 2.25 seconds.
215.5s 1369 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
215.5s 1370 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
215.5s 1371 Using device: gpu
215.5s 1372 DEBUG PARAMS: Reading K_m_kmh = 10.0
215.5s 1373 DEBUG PARAMS: Reading K_c_kmh = 15.0
215.5s 1374 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
215.5s 1375 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
215.5s 1376 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
215.5s 1377 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
215.5s 1378 Loading road quality type: uniform
215.5s 1379 Uniform road quality value: 2
215.5s 1380 Road quality loaded.
215.5s 1381 Initial state created.
215.5s 1382 Transferring initial state and road quality to GPU...
215.5s 1383 GPU data transfer complete.
215.5s 1384 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
215.5s 1385 Initial boundary conditions applied.
215.5s 1386 [BC UPDATE] left → phase 0 RED (reduced inflow)
215.5s 1387 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
215.6s 1388 [BC UPDATE] left → phase 1 GREEN (normal inflow)
215.6s 1389 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
215.6s 1390 Running simulation until t = 60.00 s, outputting every 60.00 s
215.6s 1391 
216.0s 1392 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
216.1s 1393 [WARNING] Automatic CFL correction applied (count: 7500):
216.1s 1394 Calculated CFL: 0.800 > Limit: 0.500
216.1s 1395 Original dt: 4.295897e-01 s
216.1s 1396 Corrected dt: 2.684936e-01 s
216.1s 1397 Correction factor: 1.6x
216.1s 1398 Max wave speed detected: 18.62 m/s
216.5s 1399 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
217.0s 1400 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
217.1s 1401 [WARNING] Automatic CFL correction applied (count: 7600):
217.1s 1402 Calculated CFL: 0.800 > Limit: 0.500
217.1s 1403 Original dt: 4.117215e-01 s
217.1s 1404 Corrected dt: 2.573259e-01 s
217.1s 1405 Correction factor: 1.6x
217.1s 1406 Max wave speed detected: 19.43 m/s
217.5s 1407 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
217.8s 1408 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
217.8s 1409 Stored output at t = 60.0000 s (Step 231)
217.8s 1410 [A
217.8s 1411 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.16s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.16s/s]
217.8s 1412 
217.8s 1413 Simulation finished at t = 60.0000 s after 231 steps.
217.8s 1414 Total runtime: 2.21 seconds.
217.8s 1415 Running simulation until t = 120.00 s, outputting every 60.00 s
217.8s 1416 
217.9s 1417 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
218.0s 1418 [WARNING] Automatic CFL correction applied (count: 7700):
218.0s 1419 Calculated CFL: 0.800 > Limit: 0.500
218.0s 1420 Original dt: 4.115016e-01 s
218.0s 1421 Corrected dt: 2.571885e-01 s
218.0s 1422 Correction factor: 1.6x
218.0s 1423 Max wave speed detected: 19.44 m/s
218.4s 1424 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
218.9s 1425 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
219.0s 1426 [WARNING] Automatic CFL correction applied (count: 7800):
219.0s 1427 Calculated CFL: 0.800 > Limit: 0.500
219.0s 1428 Original dt: 4.114981e-01 s
219.0s 1429 Corrected dt: 2.571863e-01 s
219.0s 1430 Correction factor: 1.6x
219.0s 1431 Max wave speed detected: 19.44 m/s
219.4s 1432 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
219.9s 1433 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
220.0s 1434 [WARNING] Automatic CFL correction applied (count: 7900):
220.0s 1435 Calculated CFL: 0.800 > Limit: 0.500
220.0s 1436 Original dt: 4.114980e-01 s
220.0s 1437 Corrected dt: 2.571863e-01 s
220.0s 1438 Correction factor: 1.6x
220.0s 1439 Max wave speed detected: 19.44 m/s
220.0s 1440 Stored output at t = 120.0000 s (Step 465)
220.0s 1441 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
220.0s 1442 [A
220.0s 1443 
220.0s 1444 Simulation finished at t = 120.0000 s after 465 steps.
220.0s 1445 Total runtime: 2.26 seconds.
220.0s 1446 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.60s/s]
220.0s 1447 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
220.0s 1448 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
220.0s 1449 Using device: gpu
220.0s 1450 DEBUG PARAMS: Reading K_m_kmh = 10.0
220.0s 1451 DEBUG PARAMS: Reading K_c_kmh = 15.0
220.0s 1452 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
220.0s 1453 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
220.0s 1454 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
220.0s 1455 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
220.0s 1456 Loading road quality type: uniform
220.0s 1457 Uniform road quality value: 2
220.0s 1458 Road quality loaded.
220.0s 1459 Initial state created.
220.0s 1460 Transferring initial state and road quality to GPU...
220.0s 1461 GPU data transfer complete.
220.0s 1462 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
220.0s 1463 Initial boundary conditions applied.
220.0s 1464 [BC UPDATE] left → phase 0 RED (reduced inflow)
220.0s 1465 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
220.0s 1466 [BC UPDATE] left → phase 1 GREEN (normal inflow)
220.0s 1467 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
220.0s 1468 Running simulation until t = 60.00 s, outputting every 60.00 s
220.0s 1469 
220.5s 1470 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
220.9s 1471 [WARNING] Automatic CFL correction applied (count: 8000):
220.9s 1472 Calculated CFL: 0.800 > Limit: 0.500
220.9s 1473 Original dt: 4.151534e-01 s
220.9s 1474 Corrected dt: 2.594709e-01 s
220.9s 1475 Correction factor: 1.6x
220.9s 1476 Max wave speed detected: 19.27 m/s
221.0s 1477 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
221.5s 1478 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
221.9s 1479 [WARNING] Automatic CFL correction applied (count: 8100):
221.9s 1480 Calculated CFL: 0.800 > Limit: 0.500
221.9s 1481 Original dt: 4.115470e-01 s
221.9s 1482 Corrected dt: 2.572169e-01 s
221.9s 1483 Correction factor: 1.6x
221.9s 1484 Max wave speed detected: 19.44 m/s
222.0s 1485 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
222.3s 1486 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
222.3s 1487 [A
222.3s 1488 Stored output at t = 60.0000 s (Step 231)
222.3s 1489 
222.3s 1490 Simulation finished at t = 60.0000 s after 231 steps.
222.3s 1491 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.74s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 26.74s/s]
222.3s 1492 Total runtime: 2.24 seconds.
222.3s 1493 [BC UPDATE] left → phase 0 RED (reduced inflow)
222.3s 1494 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
222.3s 1495 Running simulation until t = 120.00 s, outputting every 60.00 s
222.3s 1496 
222.5s 1497 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
222.9s 1498 [WARNING] Automatic CFL correction applied (count: 8200):
222.9s 1499 Calculated CFL: 0.800 > Limit: 0.500
222.9s 1500 Original dt: 4.114990e-01 s
222.9s 1501 Corrected dt: 2.571869e-01 s
222.9s 1502 Correction factor: 1.6x
222.9s 1503 Max wave speed detected: 19.44 m/s
222.9s 1504 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
223.4s 1505 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
223.8s 1506 [WARNING] Automatic CFL correction applied (count: 8300):
223.8s 1507 Calculated CFL: 0.800 > Limit: 0.500
223.8s 1508 Original dt: 4.114980e-01 s
223.8s 1509 Corrected dt: 2.571863e-01 s
223.8s 1510 Correction factor: 1.6x
223.8s 1511 Max wave speed detected: 19.44 m/s
223.9s 1512 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
224.3s 1513 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
224.5s 1514 Stored output at t = 120.0000 s (Step 465)
224.5s 1515 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
224.5s 1516 [A
224.5s 1517 
224.5s 1518 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.36s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.36s/s]
224.5s 1519 Simulation finished at t = 120.0000 s after 465 steps.
224.5s 1520 Total runtime: 2.19 seconds.
224.5s 1521 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
224.5s 1522 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
224.5s 1523 Using device: gpu
224.5s 1524 DEBUG PARAMS: Reading K_m_kmh = 10.0
224.5s 1525 DEBUG PARAMS: Reading K_c_kmh = 15.0
224.5s 1526 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
224.5s 1527 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
224.5s 1528 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
224.5s 1529 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
224.5s 1530 Loading road quality type: uniform
224.5s 1531 Uniform road quality value: 2
224.5s 1532 Road quality loaded.
224.5s 1533 Initial state created.
224.5s 1534 Transferring initial state and road quality to GPU...
224.5s 1535 GPU data transfer complete.
224.5s 1536 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
224.5s 1537 Initial boundary conditions applied.
224.5s 1538 [BC UPDATE] left → phase 0 RED (reduced inflow)
224.5s 1539 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
224.5s 1540 [BC UPDATE] left → phase 1 GREEN (normal inflow)
224.5s 1541 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
224.5s 1542 Running simulation until t = 60.00 s, outputting every 60.00 s
224.5s 1543 
224.8s 1544 [WARNING] Automatic CFL correction applied (count: 8400):
224.8s 1545 Calculated CFL: 0.800 > Limit: 0.500
224.8s 1546 Original dt: 4.768783e-01 s
224.8s 1547 Corrected dt: 2.980490e-01 s
224.8s 1548 Correction factor: 1.6x
224.8s 1549 Max wave speed detected: 16.78 m/s
225.0s 1550 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
225.4s 1551 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
225.7s 1552 [WARNING] Automatic CFL correction applied (count: 8500):
225.7s 1553 Calculated CFL: 0.800 > Limit: 0.500
225.7s 1554 Original dt: 4.123385e-01 s
225.7s 1555 Corrected dt: 2.577116e-01 s
225.7s 1556 Correction factor: 1.6x
225.7s 1557 Max wave speed detected: 19.40 m/s
225.9s 1558 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
226.4s 1559 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
226.6s 1560 [WARNING] Automatic CFL correction applied (count: 8600):
226.6s 1561 Calculated CFL: 0.800 > Limit: 0.500
226.6s 1562 Original dt: 4.115097e-01 s
226.6s 1563 Corrected dt: 2.571935e-01 s
226.6s 1564 Correction factor: 1.6x
226.6s 1565 Max wave speed detected: 19.44 m/s
226.6s 1566 Stored output at t = 60.0000 s (Step 231)
226.6s 1567 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
226.6s 1568 [A
226.6s 1569 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s]
226.6s 1570 
226.6s 1571 Simulation finished at t = 60.0000 s after 231 steps.
226.6s 1572 Total runtime: 2.15 seconds.
226.6s 1573 Running simulation until t = 120.00 s, outputting every 60.00 s
226.6s 1574 
226.8s 1575 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
227.3s 1576 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
227.5s 1577 [WARNING] Automatic CFL correction applied (count: 8700):
227.5s 1578 Calculated CFL: 0.800 > Limit: 0.500
227.5s 1579 Original dt: 4.114983e-01 s
227.5s 1580 Corrected dt: 2.571864e-01 s
227.5s 1581 Correction factor: 1.6x
227.5s 1582 Max wave speed detected: 19.44 m/s
227.7s 1583 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
228.2s 1584 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
228.5s 1585 [WARNING] Automatic CFL correction applied (count: 8800):
228.5s 1586 Calculated CFL: 0.800 > Limit: 0.500
228.5s 1587 Original dt: 4.114980e-01 s
228.5s 1588 Corrected dt: 2.571863e-01 s
228.5s 1589 Correction factor: 1.6x
228.5s 1590 Max wave speed detected: 19.44 m/s
228.7s 1591 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
228.8s 1592 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
228.8s 1593 [A
228.8s 1594 Stored output at t = 120.0000 s (Step 465)
228.8s 1595 
228.8s 1596 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.61s/s]
228.8s 1597 Simulation finished at t = 120.0000 s after 465 steps.
228.8s 1598 Total runtime: 2.17 seconds.
228.8s 1599 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
228.8s 1600 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
228.8s 1601 Using device: gpu
228.8s 1602 DEBUG PARAMS: Reading K_m_kmh = 10.0
228.8s 1603 DEBUG PARAMS: Reading K_c_kmh = 15.0
228.8s 1604 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
228.8s 1605 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
228.8s 1606 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
228.8s 1607 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
228.8s 1608 Loading road quality type: uniform
228.8s 1609 Uniform road quality value: 2
228.8s 1610 Road quality loaded.
228.8s 1611 Initial state created.
228.8s 1612 Transferring initial state and road quality to GPU...
228.8s 1613 GPU data transfer complete.
228.8s 1614 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
228.8s 1615 Initial boundary conditions applied.
228.8s 1616 [BC UPDATE] left → phase 0 RED (reduced inflow)
228.8s 1617 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
228.8s 1618 Running simulation until t = 60.00 s, outputting every 60.00 s
228.8s 1619 
229.3s 1620 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
229.4s 1621 [WARNING] Automatic CFL correction applied (count: 8900):
229.4s 1622 Calculated CFL: 0.800 > Limit: 0.500
229.4s 1623 Original dt: 4.254608e-01 s
229.4s 1624 Corrected dt: 2.659130e-01 s
229.4s 1625 Correction factor: 1.6x
229.4s 1626 Max wave speed detected: 18.80 m/s
229.8s 1627 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
230.2s 1628 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
230.4s 1629 [WARNING] Automatic CFL correction applied (count: 9000):
230.4s 1630 Calculated CFL: 0.800 > Limit: 0.500
230.4s 1631 Original dt: 4.116742e-01 s
230.4s 1632 Corrected dt: 2.572964e-01 s
230.4s 1633 Correction factor: 1.6x
230.4s 1634 Max wave speed detected: 19.43 m/s
230.7s 1635 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
231.0s 1636 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
231.0s 1637 Stored output at t = 60.0000 s (Step 231)
231.0s 1638 [A
231.0s 1639 
231.0s 1640 Simulation finished at t = 60.0000 s after 231 steps.
231.0s 1641 Total runtime: 2.16 seconds.
231.0s 1642 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.75s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.75s/s]
231.0s 1643 Running simulation until t = 120.00 s, outputting every 60.00 s
231.0s 1644 
231.2s 1645 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
231.3s 1646 [WARNING] Automatic CFL correction applied (count: 9100):
231.3s 1647 Calculated CFL: 0.800 > Limit: 0.500
231.3s 1648 Original dt: 4.115011e-01 s
231.3s 1649 Corrected dt: 2.571882e-01 s
231.3s 1650 Correction factor: 1.6x
231.3s 1651 Max wave speed detected: 19.44 m/s
231.7s 1652 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
232.2s 1653 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
232.3s 1654 [WARNING] Automatic CFL correction applied (count: 9200):
232.3s 1655 Calculated CFL: 0.800 > Limit: 0.500
232.3s 1656 Original dt: 4.114981e-01 s
232.3s 1657 Corrected dt: 2.571863e-01 s
232.3s 1658 Correction factor: 1.6x
232.3s 1659 Max wave speed detected: 19.44 m/s
232.7s 1660 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
233.2s 1661 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
233.4s 1662 [WARNING] Automatic CFL correction applied (count: 9300):
233.4s 1663 Calculated CFL: 0.800 > Limit: 0.500
233.4s 1664 Original dt: 4.114980e-01 s
233.4s 1665 Corrected dt: 2.571863e-01 s
233.4s 1666 Correction factor: 1.6x
233.4s 1667 Max wave speed detected: 19.44 m/s
233.4s 1668 Stored output at t = 120.0000 s (Step 465)
233.4s 1669 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
233.4s 1670 [A
233.4s 1671 
233.4s 1672 Simulation finished at t = 120.0000 s after 465 steps.
233.4s 1673 Total runtime: 2.36 seconds.
233.4s 1674 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 25.39s/s]
233.4s 1675 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
233.4s 1676 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
233.4s 1677 Using device: gpu
233.4s 1678 DEBUG PARAMS: Reading K_m_kmh = 10.0
233.4s 1679 DEBUG PARAMS: Reading K_c_kmh = 15.0
233.4s 1680 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
233.4s 1681 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
233.4s 1682 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
233.4s 1683 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
233.4s 1684 Loading road quality type: uniform
233.4s 1685 Uniform road quality value: 2
233.4s 1686 Road quality loaded.
233.4s 1687 Initial state created.
233.4s 1688 Transferring initial state and road quality to GPU...
233.4s 1689 GPU data transfer complete.
233.4s 1690 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
233.4s 1691 Initial boundary conditions applied.
233.4s 1692 [BC UPDATE] left → phase 0 RED (reduced inflow)
233.4s 1693 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
233.4s 1694 [BC UPDATE] left → phase 1 GREEN (normal inflow)
233.4s 1695 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
233.4s 1696 Running simulation until t = 60.00 s, outputting every 60.00 s
233.4s 1697 
233.9s 1698 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
234.3s 1699 [WARNING] Automatic CFL correction applied (count: 9400):
234.3s 1700 Calculated CFL: 0.800 > Limit: 0.500
234.3s 1701 Original dt: 4.145004e-01 s
234.3s 1702 Corrected dt: 2.590627e-01 s
234.3s 1703 Correction factor: 1.6x
234.3s 1704 Max wave speed detected: 19.30 m/s
234.3s 1705 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
234.8s 1706 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
235.3s 1707 [WARNING] Automatic CFL correction applied (count: 9500):
235.3s 1708 Calculated CFL: 0.800 > Limit: 0.500
235.3s 1709 Original dt: 4.115380e-01 s
235.3s 1710 Corrected dt: 2.572113e-01 s
235.3s 1711 Correction factor: 1.6x
235.3s 1712 Max wave speed detected: 19.44 m/s
235.3s 1713 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
235.6s 1714 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
235.6s 1715 [A
235.6s 1716 Stored output at t = 60.0000 s (Step 231)
235.6s 1717 
235.6s 1718 Simulation finished at t = 60.0000 s after 231 steps.
235.6s 1719 Total runtime: 2.17 seconds.
235.6s 1720 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.66s/s]
235.6s 1721 Running simulation until t = 120.00 s, outputting every 60.00 s
235.6s 1722 
235.7s 1723 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
236.2s 1724 [WARNING] Automatic CFL correction applied (count: 9600):
236.2s 1725 Calculated CFL: 0.800 > Limit: 0.500
236.2s 1726 Original dt: 4.114988e-01 s
236.2s 1727 Corrected dt: 2.571867e-01 s
236.2s 1728 Correction factor: 1.6x
236.2s 1729 Max wave speed detected: 19.44 m/s
236.2s 1730 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
236.7s 1731 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
237.1s 1732 [WARNING] Automatic CFL correction applied (count: 9700):
237.1s 1733 Calculated CFL: 0.800 > Limit: 0.500
237.1s 1734 Original dt: 4.114980e-01 s
237.1s 1735 Corrected dt: 2.571863e-01 s
237.1s 1736 Correction factor: 1.6x
237.1s 1737 Max wave speed detected: 19.44 m/s
237.2s 1738 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
237.6s 1739 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
237.8s 1740 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
237.8s 1741 [A
237.8s 1742 Stored output at t = 120.0000 s (Step 465)
237.8s 1743 
237.8s 1744 Simulation finished at t = 120.0000 s after 465 steps.
237.8s 1745 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.31s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.30s/s]
237.8s 1746 Total runtime: 2.20 seconds.
237.8s 1747 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
237.8s 1748 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
237.8s 1749 Using device: gpu
237.8s 1750 DEBUG PARAMS: Reading K_m_kmh = 10.0
237.8s 1751 DEBUG PARAMS: Reading K_c_kmh = 15.0
237.8s 1752 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
237.8s 1753 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
237.8s 1754 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
237.8s 1755 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
237.8s 1756 Loading road quality type: uniform
237.8s 1757 Uniform road quality value: 2
237.8s 1758 Road quality loaded.
237.8s 1759 Initial state created.
237.8s 1760 Transferring initial state and road quality to GPU...
237.8s 1761 GPU data transfer complete.
237.8s 1762 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
237.8s 1763 Initial boundary conditions applied.
237.8s 1764 [BC UPDATE] left → phase 0 RED (reduced inflow)
237.8s 1765 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
237.8s 1766 [BC UPDATE] left → phase 1 GREEN (normal inflow)
237.8s 1767 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
237.8s 1768 Running simulation until t = 60.00 s, outputting every 60.00 s
237.8s 1769 
238.1s 1770 [WARNING] Automatic CFL correction applied (count: 9800):
238.1s 1771 Calculated CFL: 0.800 > Limit: 0.500
238.1s 1772 Original dt: 4.758816e-01 s
238.1s 1773 Corrected dt: 2.974260e-01 s
238.1s 1774 Correction factor: 1.6x
238.1s 1775 Max wave speed detected: 16.81 m/s
238.2s 1776 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
238.7s 1777 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
239.0s 1778 [WARNING] Automatic CFL correction applied (count: 9900):
239.0s 1779 Calculated CFL: 0.800 > Limit: 0.500
239.0s 1780 Original dt: 4.121510e-01 s
239.0s 1781 Corrected dt: 2.575944e-01 s
239.0s 1782 Correction factor: 1.6x
239.0s 1783 Max wave speed detected: 19.41 m/s
239.2s 1784 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
239.6s 1785 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
239.9s 1786 Stored output at t = 60.0000 s (Step 231)
239.9s 1787 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
239.9s 1788 [A
239.9s 1789 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.88s/s]
239.9s 1790 
239.9s 1791 Simulation finished at t = 60.0000 s after 231 steps.
239.9s 1792 Total runtime: 2.15 seconds.
239.9s 1793 
239.9s 1794 [BC UPDATE] left → phase 0 RED (reduced inflow)
239.9s 1795 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
239.9s 1796 Running simulation until t = 120.00 s, outputting every 60.00 s
240.0s 1797 [WARNING] Automatic CFL correction applied (count: 10000):
240.0s 1798 Calculated CFL: 0.800 > Limit: 0.500
240.0s 1799 Original dt: 4.115082e-01 s
240.0s 1800 Corrected dt: 2.571926e-01 s
240.0s 1801 Correction factor: 1.6x
240.0s 1802 Max wave speed detected: 19.44 m/s
240.1s 1803 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
240.6s 1804 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
240.9s 1805 [WARNING] Automatic CFL correction applied (count: 10100):
240.9s 1806 Calculated CFL: 0.800 > Limit: 0.500
240.9s 1807 Original dt: 4.114982e-01 s
240.9s 1808 Corrected dt: 2.571864e-01 s
240.9s 1809 Correction factor: 1.6x
240.9s 1810 Max wave speed detected: 19.44 m/s
241.0s 1811 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
241.6s 1812 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
241.9s 1813 [WARNING] Automatic CFL correction applied (count: 10200):
241.9s 1814 Calculated CFL: 0.800 > Limit: 0.500
241.9s 1815 Original dt: 4.114980e-01 s
241.9s 1816 Corrected dt: 2.571863e-01 s
241.9s 1817 Correction factor: 1.6x
241.9s 1818 Max wave speed detected: 19.44 m/s
242.0s 1819 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
242.2s 1820 Stored output at t = 120.0000 s (Step 465)
242.2s 1821 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
242.2s 1822 [A
242.2s 1823 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.68s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.68s/s]
242.2s 1824 
242.2s 1825 Simulation finished at t = 120.0000 s after 465 steps.
242.2s 1826 Total runtime: 2.25 seconds.
242.2s 1827 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
242.2s 1828 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
242.2s 1829 Using device: gpu
242.2s 1830 DEBUG PARAMS: Reading K_m_kmh = 10.0
242.2s 1831 DEBUG PARAMS: Reading K_c_kmh = 15.0
242.2s 1832 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
242.2s 1833 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
242.2s 1834 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
242.2s 1835 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
242.2s 1836 Loading road quality type: uniform
242.2s 1837 Uniform road quality value: 2
242.2s 1838 Road quality loaded.
242.2s 1839 Initial state created.
242.2s 1840 Transferring initial state and road quality to GPU...
242.2s 1841 GPU data transfer complete.
242.2s 1842 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
242.2s 1843 Initial boundary conditions applied.
242.2s 1844 [BC UPDATE] left → phase 0 RED (reduced inflow)
242.2s 1845 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
242.2s 1846 Running simulation until t = 60.00 s, outputting every 60.00 s
242.2s 1847 
242.7s 1848 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
242.9s 1849 [WARNING] Automatic CFL correction applied (count: 10300):
242.9s 1850 Calculated CFL: 0.800 > Limit: 0.500
242.9s 1851 Original dt: 4.225636e-01 s
242.9s 1852 Corrected dt: 2.641023e-01 s
242.9s 1853 Correction factor: 1.6x
242.9s 1854 Max wave speed detected: 18.93 m/s
243.2s 1855 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
243.6s 1856 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
243.8s 1857 [WARNING] Automatic CFL correction applied (count: 10400):
243.8s 1858 Calculated CFL: 0.800 > Limit: 0.500
243.8s 1859 Original dt: 4.116395e-01 s
243.8s 1860 Corrected dt: 2.572747e-01 s
243.8s 1861 Correction factor: 1.6x
243.8s 1862 Max wave speed detected: 19.43 m/s
244.1s 1863 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
244.4s 1864 Stored output at t = 60.0000 s (Step 231)
244.4s 1865 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
244.4s 1866 [A
244.4s 1867 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.57s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.57s/s]
244.4s 1868 
244.4s 1869 Simulation finished at t = 60.0000 s after 231 steps.
244.4s 1870 Total runtime: 2.18 seconds.
244.4s 1871 
244.4s 1872 [BC UPDATE] left → phase 1 GREEN (normal inflow)
244.4s 1873 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
244.4s 1874 Running simulation until t = 120.00 s, outputting every 60.00 s
244.5s 1875 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
244.7s 1876 [WARNING] Automatic CFL correction applied (count: 10500):
244.7s 1877 Calculated CFL: 0.800 > Limit: 0.500
244.7s 1878 Original dt: 4.115005e-01 s
244.7s 1879 Corrected dt: 2.571878e-01 s
244.7s 1880 Correction factor: 1.6x
244.7s 1881 Max wave speed detected: 19.44 m/s
245.0s 1882 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
245.5s 1883 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
245.6s 1884 [WARNING] Automatic CFL correction applied (count: 10600):
245.6s 1885 Calculated CFL: 0.800 > Limit: 0.500
245.6s 1886 Original dt: 4.114981e-01 s
245.6s 1887 Corrected dt: 2.571863e-01 s
245.6s 1888 Correction factor: 1.6x
245.6s 1889 Max wave speed detected: 19.44 m/s
245.9s 1890 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
246.4s 1891 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
246.5s 1892 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
246.5s 1893 [A
246.5s 1894 Stored output at t = 120.0000 s (Step 465)
246.5s 1895 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.03s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.03s/s]
246.5s 1896 
246.5s 1897 Simulation finished at t = 120.0000 s after 465 steps.
246.5s 1898 Total runtime: 2.14 seconds.
246.5s 1899 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
246.5s 1900 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
246.5s 1901 Using device: gpu
246.5s 1902 DEBUG PARAMS: Reading K_m_kmh = 10.0
246.5s 1903 DEBUG PARAMS: Reading K_c_kmh = 15.0
246.5s 1904 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
246.5s 1905 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
246.5s 1906 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
246.5s 1907 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
246.5s 1908 Loading road quality type: uniform
246.5s 1909 Uniform road quality value: 2
246.5s 1910 Road quality loaded.
246.5s 1911 Initial state created.
246.5s 1912 Transferring initial state and road quality to GPU...
246.5s 1913 GPU data transfer complete.
246.5s 1914 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
246.5s 1915 Initial boundary conditions applied.
246.5s 1916 [BC UPDATE] left → phase 0 RED (reduced inflow)
246.5s 1917 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
246.5s 1918 [BC UPDATE] left → phase 1 GREEN (normal inflow)
246.5s 1919 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
246.5s 1920 Running simulation until t = 60.00 s, outputting every 60.00 s
246.5s 1921 
246.6s 1922 [WARNING] Automatic CFL correction applied (count: 10700):
246.6s 1923 Calculated CFL: 0.800 > Limit: 0.500
246.6s 1924 Original dt: 3.451280e-01 s
246.6s 1925 Corrected dt: 2.157050e-01 s
246.6s 1926 Correction factor: 1.6x
246.6s 1927 Max wave speed detected: 23.18 m/s
247.0s 1928 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
247.5s 1929 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
247.5s 1930 [WARNING] Automatic CFL correction applied (count: 10800):
247.5s 1931 Calculated CFL: 0.800 > Limit: 0.500
247.5s 1932 Original dt: 4.139892e-01 s
247.5s 1933 Corrected dt: 2.587433e-01 s
247.5s 1934 Correction factor: 1.6x
247.5s 1935 Max wave speed detected: 19.32 m/s
247.9s 1936 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
248.4s 1937 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
248.4s 1938 [WARNING] Automatic CFL correction applied (count: 10900):
248.4s 1939 Calculated CFL: 0.800 > Limit: 0.500
248.4s 1940 Original dt: 4.115314e-01 s
248.4s 1941 Corrected dt: 2.572071e-01 s
248.4s 1942 Correction factor: 1.6x
248.4s 1943 Max wave speed detected: 19.44 m/s
248.7s 1944 Stored output at t = 60.0000 s (Step 231)
248.7s 1945 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
248.7s 1946 [A
248.7s 1947 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.89s/s]
248.7s 1948 
248.7s 1949 Simulation finished at t = 60.0000 s after 231 steps.
248.7s 1950 Total runtime: 2.15 seconds.
248.7s 1951 Running simulation until t = 120.00 s, outputting every 60.00 s
248.7s 1952 
248.9s 1953 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
249.3s 1954 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
249.4s 1955 [WARNING] Automatic CFL correction applied (count: 11000):
249.4s 1956 Calculated CFL: 0.800 > Limit: 0.500
249.4s 1957 Original dt: 4.114986e-01 s
249.4s 1958 Corrected dt: 2.571866e-01 s
249.4s 1959 Correction factor: 1.6x
249.4s 1960 Max wave speed detected: 19.44 m/s
249.8s 1961 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
250.2s 1962 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
250.3s 1963 [WARNING] Automatic CFL correction applied (count: 11100):
250.3s 1964 Calculated CFL: 0.800 > Limit: 0.500
250.3s 1965 Original dt: 4.114980e-01 s
250.3s 1966 Corrected dt: 2.571863e-01 s
250.3s 1967 Correction factor: 1.6x
250.3s 1968 Max wave speed detected: 19.44 m/s
250.7s 1969 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
250.8s 1970 Stored output at t = 120.0000 s (Step 465)
250.8s 1971 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
250.8s 1972 [A
250.8s 1973 
250.8s 1974 Simulation finished at t = 120.0000 s after 465 steps.
250.8s 1975 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.70s/s]
250.8s 1976 Total runtime: 2.17 seconds.
250.8s 1977 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
250.8s 1978 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
250.8s 1979 Using device: gpu
250.9s 1980 DEBUG PARAMS: Reading K_m_kmh = 10.0
250.9s 1981 DEBUG PARAMS: Reading K_c_kmh = 15.0
250.9s 1982 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
250.9s 1983 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
250.9s 1984 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
250.9s 1985 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
250.9s 1986 Loading road quality type: uniform
250.9s 1987 Uniform road quality value: 2
250.9s 1988 Road quality loaded.
250.9s 1989 Initial state created.
250.9s 1990 Transferring initial state and road quality to GPU...
250.9s 1991 GPU data transfer complete.
250.9s 1992 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
250.9s 1993 Initial boundary conditions applied.
250.9s 1994 [BC UPDATE] left → phase 0 RED (reduced inflow)
250.9s 1995 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
250.9s 1996 Running simulation until t = 60.00 s, outputting every 60.00 s
250.9s 1997 
251.2s 1998 [WARNING] Automatic CFL correction applied (count: 11200):
251.2s 1999 Calculated CFL: 0.800 > Limit: 0.500
251.2s 2000 Original dt: 4.583403e-01 s
251.2s 2001 Corrected dt: 2.864627e-01 s
251.2s 2002 Correction factor: 1.6x
251.2s 2003 Max wave speed detected: 17.45 m/s
251.3s 2004 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
251.8s 2005 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
252.2s 2006 [WARNING] Automatic CFL correction applied (count: 11300):
252.2s 2007 Calculated CFL: 0.800 > Limit: 0.500
252.2s 2008 Original dt: 4.120137e-01 s
252.2s 2009 Corrected dt: 2.575085e-01 s
252.2s 2010 Correction factor: 1.6x
252.2s 2011 Max wave speed detected: 19.42 m/s
252.3s 2012 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
252.7s 2013 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
253.0s 2014 Stored output at t = 60.0000 s (Step 231)
253.0s 2015 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
253.0s 2016 [A
253.0s 2017 
253.0s 2018 Simulation finished at t = 60.0000 s after 231 steps.
253.0s 2019 Total runtime: 2.14 seconds.
253.0s 2020 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.04s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.04s/s]
253.0s 2021 [BC UPDATE] left → phase 1 GREEN (normal inflow)
253.0s 2022 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
253.0s 2023 Running simulation until t = 120.00 s, outputting every 60.00 s
253.0s 2024 
253.1s 2025 [WARNING] Automatic CFL correction applied (count: 11400):
253.1s 2026 Calculated CFL: 0.800 > Limit: 0.500
253.1s 2027 Original dt: 4.115064e-01 s
253.1s 2028 Corrected dt: 2.571915e-01 s
253.1s 2029 Correction factor: 1.6x
253.1s 2030 Max wave speed detected: 19.44 m/s
253.2s 2031 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
253.7s 2032 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
254.0s 2033 [WARNING] Automatic CFL correction applied (count: 11500):
254.0s 2034 Calculated CFL: 0.800 > Limit: 0.500
254.0s 2035 Original dt: 4.114982e-01 s
254.0s 2036 Corrected dt: 2.571864e-01 s
254.0s 2037 Correction factor: 1.6x
254.0s 2038 Max wave speed detected: 19.44 m/s
254.1s 2039 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
254.6s 2040 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
254.9s 2041 [WARNING] Automatic CFL correction applied (count: 11600):
254.9s 2042 Calculated CFL: 0.800 > Limit: 0.500
254.9s 2043 Original dt: 4.114980e-01 s
254.9s 2044 Corrected dt: 2.571863e-01 s
254.9s 2045 Correction factor: 1.6x
254.9s 2046 Max wave speed detected: 19.44 m/s
255.0s 2047 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
255.2s 2048 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
255.2s 2049 Stored output at t = 120.0000 s (Step 465)
255.2s 2050 [A
255.2s 2051 
255.2s 2052 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.60s/s]
255.2s 2053 Simulation finished at t = 120.0000 s after 465 steps.
255.2s 2054 Total runtime: 2.17 seconds.
255.2s 2055 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
255.2s 2056 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
255.2s 2057 Using device: gpu
255.2s 2058 DEBUG PARAMS: Reading K_m_kmh = 10.0
255.2s 2059 DEBUG PARAMS: Reading K_c_kmh = 15.0
255.2s 2060 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
255.2s 2061 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
255.2s 2062 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
255.2s 2063 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
255.2s 2064 Loading road quality type: uniform
255.2s 2065 Uniform road quality value: 2
255.2s 2066 Road quality loaded.
255.2s 2067 Initial state created.
255.2s 2068 Transferring initial state and road quality to GPU...
255.2s 2069 GPU data transfer complete.
255.2s 2070 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
255.2s 2071 Initial boundary conditions applied.
255.2s 2072 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.2s 2073 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
255.2s 2074 📊 Progress: 50/100 (50.0%) | ETA: 1.9 min | Speed: 0.4 steps/s
255.2s 2075 Running simulation until t = 60.00 s, outputting every 60.00 s
255.2s 2076 
255.7s 2077 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
255.9s 2078 [WARNING] Automatic CFL correction applied (count: 11700):
255.9s 2079 Calculated CFL: 0.800 > Limit: 0.500
255.9s 2080 Original dt: 4.205139e-01 s
255.9s 2081 Corrected dt: 2.628212e-01 s
255.9s 2082 Correction factor: 1.6x
255.9s 2083 Max wave speed detected: 19.02 m/s
256.1s 2084 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
256.6s 2085 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
256.8s 2086 [WARNING] Automatic CFL correction applied (count: 11800):
256.8s 2087 Calculated CFL: 0.800 > Limit: 0.500
256.8s 2088 Original dt: 4.116141e-01 s
256.8s 2089 Corrected dt: 2.572588e-01 s
256.8s 2090 Correction factor: 1.6x
256.8s 2091 Max wave speed detected: 19.44 m/s
257.1s 2092 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
257.3s 2093 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
257.3s 2094 [A
257.3s 2095 Stored output at t = 60.0000 s (Step 231)
257.3s 2096 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.03s/s]
257.3s 2097 
257.3s 2098 Simulation finished at t = 60.0000 s after 231 steps.
257.3s 2099 Total runtime: 2.14 seconds.
257.3s 2100 [BC UPDATE] left → phase 1 GREEN (normal inflow)
257.3s 2101 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
257.3s 2102 Running simulation until t = 120.00 s, outputting every 60.00 s
257.3s 2103 
257.5s 2104 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
257.7s 2105 [WARNING] Automatic CFL correction applied (count: 11900):
257.7s 2106 Calculated CFL: 0.800 > Limit: 0.500
257.7s 2107 Original dt: 4.115000e-01 s
257.7s 2108 Corrected dt: 2.571875e-01 s
257.7s 2109 Correction factor: 1.6x
257.7s 2110 Max wave speed detected: 19.44 m/s
258.0s 2111 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
258.5s 2112 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
258.7s 2113 [WARNING] Automatic CFL correction applied (count: 12000):
258.7s 2114 Calculated CFL: 0.800 > Limit: 0.500
258.7s 2115 Original dt: 4.114981e-01 s
258.7s 2116 Corrected dt: 2.571863e-01 s
258.7s 2117 Correction factor: 1.6x
258.7s 2118 Max wave speed detected: 19.44 m/s
258.9s 2119 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
259.4s 2120 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
259.5s 2121 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
259.5s 2122 [A
259.5s 2123 Stored output at t = 120.0000 s (Step 465)
259.5s 2124 
259.5s 2125 Simulation finished at t = 120.0000 s after 465 steps.
259.5s 2126 Total runtime: 2.18 seconds.
259.5s 2127 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.50s/s]
259.5s 2128 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
259.5s 2129 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
259.5s 2130 Using device: gpu
259.5s 2131 DEBUG PARAMS: Reading K_m_kmh = 10.0
259.5s 2132 DEBUG PARAMS: Reading K_c_kmh = 15.0
259.5s 2133 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
259.5s 2134 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
259.5s 2135 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
259.5s 2136 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
259.5s 2137 Loading road quality type: uniform
259.5s 2138 Uniform road quality value: 2
259.5s 2139 Road quality loaded.
259.5s 2140 Initial state created.
259.5s 2141 Transferring initial state and road quality to GPU...
259.5s 2142 GPU data transfer complete.
259.5s 2143 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
259.5s 2144 Initial boundary conditions applied.
259.5s 2145 [BC UPDATE] left → phase 0 RED (reduced inflow)
259.5s 2146 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
259.5s 2147 Running simulation until t = 60.00 s, outputting every 60.00 s
259.5s 2148 
259.6s 2149 [WARNING] Automatic CFL correction applied (count: 12100):
259.6s 2150 Calculated CFL: 0.800 > Limit: 0.500
259.6s 2151 Original dt: 3.737254e-01 s
259.6s 2152 Corrected dt: 2.335784e-01 s
259.6s 2153 Correction factor: 1.6x
259.6s 2154 Max wave speed detected: 21.41 m/s
260.0s 2155 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
260.5s 2156 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
260.6s 2157 [WARNING] Automatic CFL correction applied (count: 12200):
260.6s 2158 Calculated CFL: 0.800 > Limit: 0.500
260.6s 2159 Original dt: 4.134305e-01 s
260.6s 2160 Corrected dt: 2.583941e-01 s
260.6s 2161 Correction factor: 1.6x
260.6s 2162 Max wave speed detected: 19.35 m/s
260.9s 2163 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
261.4s 2164 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
261.5s 2165 [WARNING] Automatic CFL correction applied (count: 12300):
261.5s 2166 Calculated CFL: 0.800 > Limit: 0.500
261.5s 2167 Original dt: 4.115259e-01 s
261.5s 2168 Corrected dt: 2.572037e-01 s
261.5s 2169 Correction factor: 1.6x
261.5s 2170 Max wave speed detected: 19.44 m/s
261.7s 2171 Stored output at t = 60.0000 s (Step 231)
261.7s 2172 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
261.7s 2173 [A
261.7s 2174 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.49s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.48s/s]
261.7s 2175 
261.7s 2176 Simulation finished at t = 60.0000 s after 231 steps.
261.7s 2177 Total runtime: 2.18 seconds.
261.7s 2178 [BC UPDATE] left → phase 1 GREEN (normal inflow)
261.7s 2179 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
261.7s 2180 Running simulation until t = 120.00 s, outputting every 60.00 s
261.7s 2181 
261.9s 2182 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
262.4s 2183 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
262.4s 2184 [WARNING] Automatic CFL correction applied (count: 12400):
262.4s 2185 Calculated CFL: 0.800 > Limit: 0.500
262.4s 2186 Original dt: 4.114985e-01 s
262.4s 2187 Corrected dt: 2.571866e-01 s
262.4s 2188 Correction factor: 1.6x
262.4s 2189 Max wave speed detected: 19.44 m/s
262.8s 2190 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
263.3s 2191 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
263.4s 2192 [WARNING] Automatic CFL correction applied (count: 12500):
263.4s 2193 Calculated CFL: 0.800 > Limit: 0.500
263.4s 2194 Original dt: 4.114980e-01 s
263.4s 2195 Corrected dt: 2.571863e-01 s
263.4s 2196 Correction factor: 1.6x
263.4s 2197 Max wave speed detected: 19.44 m/s
263.7s 2198 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
263.9s 2199 Stored output at t = 120.0000 s (Step 465)
263.9s 2200 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
263.9s 2201 [A
263.9s 2202 
263.9s 2203 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.98s/s]
263.9s 2204 Simulation finished at t = 120.0000 s after 465 steps.
263.9s 2205 Total runtime: 2.14 seconds.
263.9s 2206 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
263.9s 2207 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
263.9s 2208 Using device: gpu
263.9s 2209 DEBUG PARAMS: Reading K_m_kmh = 10.0
263.9s 2210 DEBUG PARAMS: Reading K_c_kmh = 15.0
263.9s 2211 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
263.9s 2212 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
263.9s 2213 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
263.9s 2214 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
263.9s 2215 Loading road quality type: uniform
263.9s 2216 Uniform road quality value: 2
263.9s 2217 Road quality loaded.
263.9s 2218 Initial state created.
263.9s 2219 Transferring initial state and road quality to GPU...
263.9s 2220 GPU data transfer complete.
263.9s 2221 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
263.9s 2222 Initial boundary conditions applied.
263.9s 2223 [BC UPDATE] left → phase 0 RED (reduced inflow)
263.9s 2224 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
263.9s 2225 Running simulation until t = 60.00 s, outputting every 60.00 s
263.9s 2226 
264.3s 2227 [WARNING] Automatic CFL correction applied (count: 12600):
264.3s 2228 Calculated CFL: 0.800 > Limit: 0.500
264.3s 2229 Original dt: 4.470525e-01 s
264.3s 2230 Corrected dt: 2.794078e-01 s
264.3s 2231 Correction factor: 1.6x
264.3s 2232 Max wave speed detected: 17.89 m/s
264.3s 2233 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
264.8s 2234 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
265.2s 2235 [WARNING] Automatic CFL correction applied (count: 12700):
265.2s 2236 Calculated CFL: 0.800 > Limit: 0.500
265.2s 2237 Original dt: 4.119130e-01 s
265.2s 2238 Corrected dt: 2.574456e-01 s
265.2s 2239 Correction factor: 1.6x
265.2s 2240 Max wave speed detected: 19.42 m/s
265.3s 2241 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
265.7s 2242 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
266.0s 2243 Stored output at t = 60.0000 s (Step 231)
266.0s 2244 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
266.0s 2245 [A
266.0s 2246 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.54s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.54s/s]
266.0s 2247 
266.0s 2248 Simulation finished at t = 60.0000 s after 231 steps.
266.0s 2249 Total runtime: 2.10 seconds.
266.0s 2250 Running simulation until t = 120.00 s, outputting every 60.00 s
266.0s 2251 
266.1s 2252 [WARNING] Automatic CFL correction applied (count: 12800):
266.1s 2253 Calculated CFL: 0.800 > Limit: 0.500
266.1s 2254 Original dt: 4.115046e-01 s
266.1s 2255 Corrected dt: 2.571904e-01 s
266.1s 2256 Correction factor: 1.6x
266.1s 2257 Max wave speed detected: 19.44 m/s
266.2s 2258 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
266.6s 2259 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
267.0s 2260 [WARNING] Automatic CFL correction applied (count: 12900):
267.0s 2261 Calculated CFL: 0.800 > Limit: 0.500
267.0s 2262 Original dt: 4.114982e-01 s
267.0s 2263 Corrected dt: 2.571863e-01 s
267.0s 2264 Correction factor: 1.6x
267.0s 2265 Max wave speed detected: 19.44 m/s
267.1s 2266 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
267.5s 2267 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
268.0s 2268 [WARNING] Automatic CFL correction applied (count: 13000):
268.0s 2269 Calculated CFL: 0.800 > Limit: 0.500
268.0s 2270 Original dt: 4.114980e-01 s
268.0s 2271 Corrected dt: 2.571863e-01 s
268.0s 2272 Correction factor: 1.6x
268.0s 2273 Max wave speed detected: 19.44 m/s
268.0s 2274 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
268.1s 2275 Stored output at t = 120.0000 s (Step 465)
268.1s 2276 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
268.1s 2277 [A
268.1s 2278 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s]
268.1s 2279 
268.1s 2280 Simulation finished at t = 120.0000 s after 465 steps.
268.1s 2281 Total runtime: 2.15 seconds.
268.1s 2282 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
268.1s 2283 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
268.1s 2284 Using device: gpu
268.2s 2285 DEBUG PARAMS: Reading K_m_kmh = 10.0
268.2s 2286 DEBUG PARAMS: Reading K_c_kmh = 15.0
268.2s 2287 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
268.2s 2288 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
268.2s 2289 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
268.2s 2290 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
268.2s 2291 Loading road quality type: uniform
268.2s 2292 Uniform road quality value: 2
268.2s 2293 Road quality loaded.
268.2s 2294 Initial state created.
268.2s 2295 Transferring initial state and road quality to GPU...
268.2s 2296 GPU data transfer complete.
268.2s 2297 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
268.2s 2298 Initial boundary conditions applied.
268.2s 2299 [BC UPDATE] left → phase 0 RED (reduced inflow)
268.2s 2300 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
268.2s 2301 Running simulation until t = 60.00 s, outputting every 60.00 s
268.2s 2302 
268.6s 2303 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
268.9s 2304 [WARNING] Automatic CFL correction applied (count: 13100):
268.9s 2305 Calculated CFL: 0.800 > Limit: 0.500
268.9s 2306 Original dt: 4.190346e-01 s
268.9s 2307 Corrected dt: 2.618967e-01 s
268.9s 2308 Correction factor: 1.6x
268.9s 2309 Max wave speed detected: 19.09 m/s
269.1s 2310 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
269.6s 2311 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
269.8s 2312 [WARNING] Automatic CFL correction applied (count: 13200):
269.8s 2313 Calculated CFL: 0.800 > Limit: 0.500
269.8s 2314 Original dt: 4.115954e-01 s
269.8s 2315 Corrected dt: 2.572472e-01 s
269.8s 2316 Correction factor: 1.6x
269.8s 2317 Max wave speed detected: 19.44 m/s
270.0s 2318 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
270.3s 2319 Stored output at t = 60.0000 s (Step 231)
270.3s 2320 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
270.3s 2321 [A
270.3s 2322 
270.3s 2323 Simulation finished at t = 60.0000 s after 231 steps.
270.3s 2324 Total runtime: 2.17 seconds.
270.3s 2325 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.71s/s]
270.3s 2326 Running simulation until t = 120.00 s, outputting every 60.00 s
270.3s 2327 
270.5s 2328 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
270.8s 2329 [WARNING] Automatic CFL correction applied (count: 13300):
270.8s 2330 Calculated CFL: 0.800 > Limit: 0.500
270.8s 2331 Original dt: 4.114996e-01 s
270.8s 2332 Corrected dt: 2.571873e-01 s
270.8s 2333 Correction factor: 1.6x
270.8s 2334 Max wave speed detected: 19.44 m/s
271.0s 2335 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
271.4s 2336 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
271.7s 2337 [WARNING] Automatic CFL correction applied (count: 13400):
271.7s 2338 Calculated CFL: 0.800 > Limit: 0.500
271.7s 2339 Original dt: 4.114981e-01 s
271.7s 2340 Corrected dt: 2.571863e-01 s
271.7s 2341 Correction factor: 1.6x
271.7s 2342 Max wave speed detected: 19.44 m/s
271.9s 2343 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
272.4s 2344 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
272.5s 2345 Stored output at t = 120.0000 s (Step 465)
272.5s 2346 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
272.5s 2347 [A
272.5s 2348 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.39s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.38s/s]
272.5s 2349 
272.5s 2350 Simulation finished at t = 120.0000 s after 465 steps.
272.5s 2351 Total runtime: 2.19 seconds.
272.5s 2352 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
272.5s 2353 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
272.5s 2354 Using device: gpu
272.5s 2355 DEBUG PARAMS: Reading K_m_kmh = 10.0
272.5s 2356 DEBUG PARAMS: Reading K_c_kmh = 15.0
272.5s 2357 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
272.5s 2358 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
272.5s 2359 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
272.5s 2360 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
272.5s 2361 Loading road quality type: uniform
272.5s 2362 Uniform road quality value: 2
272.5s 2363 Road quality loaded.
272.5s 2364 Initial state created.
272.5s 2365 Transferring initial state and road quality to GPU...
272.5s 2366 GPU data transfer complete.
272.5s 2367 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
272.5s 2368 Initial boundary conditions applied.
272.5s 2369 [BC UPDATE] left → phase 0 RED (reduced inflow)
272.5s 2370 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
272.5s 2371 [BC UPDATE] left → phase 1 GREEN (normal inflow)
272.5s 2372 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
272.5s 2373 Running simulation until t = 60.00 s, outputting every 60.00 s
272.5s 2374 
272.7s 2375 [WARNING] Automatic CFL correction applied (count: 13500):
272.7s 2376 Calculated CFL: 0.800 > Limit: 0.500
272.7s 2377 Original dt: 4.022422e-01 s
272.7s 2378 Corrected dt: 2.514014e-01 s
272.7s 2379 Correction factor: 1.6x
272.7s 2380 Max wave speed detected: 19.89 m/s
273.1s 2381 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
273.6s 2382 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
273.7s 2383 [WARNING] Automatic CFL correction applied (count: 13600):
273.7s 2384 Calculated CFL: 0.800 > Limit: 0.500
273.7s 2385 Original dt: 4.130229e-01 s
273.7s 2386 Corrected dt: 2.581393e-01 s
273.7s 2387 Correction factor: 1.6x
273.7s 2388 Max wave speed detected: 19.37 m/s
274.0s 2389 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
274.5s 2390 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
274.6s 2391 [WARNING] Automatic CFL correction applied (count: 13700):
274.6s 2392 Calculated CFL: 0.800 > Limit: 0.500
274.6s 2393 Original dt: 4.115198e-01 s
274.6s 2394 Corrected dt: 2.571999e-01 s
274.6s 2395 Correction factor: 1.6x
274.6s 2396 Max wave speed detected: 19.44 m/s
274.7s 2397 Stored output at t = 60.0000 s (Step 231)
274.7s 2398 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
274.7s 2399 [A
274.7s 2400 
274.7s 2401 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.24s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.24s/s]
274.7s 2402 Simulation finished at t = 60.0000 s after 231 steps.
274.7s 2403 Total runtime: 2.20 seconds.
274.7s 2404 Running simulation until t = 120.00 s, outputting every 60.00 s
274.7s 2405 
274.9s 2406 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
275.4s 2407 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
275.5s 2408 [WARNING] Automatic CFL correction applied (count: 13800):
275.5s 2409 Calculated CFL: 0.800 > Limit: 0.500
275.5s 2410 Original dt: 4.114984e-01 s
275.5s 2411 Corrected dt: 2.571865e-01 s
275.5s 2412 Correction factor: 1.6x
275.5s 2413 Max wave speed detected: 19.44 m/s
275.8s 2414 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
276.3s 2415 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
276.4s 2416 [WARNING] Automatic CFL correction applied (count: 13900):
276.4s 2417 Calculated CFL: 0.800 > Limit: 0.500
276.4s 2418 Original dt: 4.114980e-01 s
276.4s 2419 Corrected dt: 2.571863e-01 s
276.4s 2420 Correction factor: 1.6x
276.4s 2421 Max wave speed detected: 19.44 m/s
276.7s 2422 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
276.9s 2423 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
276.9s 2424 [A
276.9s 2425 Stored output at t = 120.0000 s (Step 465)
276.9s 2426 
276.9s 2427 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.40s/s]
276.9s 2428 Simulation finished at t = 120.0000 s after 465 steps.
276.9s 2429 Total runtime: 2.11 seconds.
276.9s 2430 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
276.9s 2431 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
276.9s 2432 Using device: gpu
276.9s 2433 DEBUG PARAMS: Reading K_m_kmh = 10.0
276.9s 2434 DEBUG PARAMS: Reading K_c_kmh = 15.0
276.9s 2435 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
276.9s 2436 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
276.9s 2437 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
276.9s 2438 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
276.9s 2439 Loading road quality type: uniform
276.9s 2440 Uniform road quality value: 2
276.9s 2441 Road quality loaded.
276.9s 2442 Initial state created.
276.9s 2443 Transferring initial state and road quality to GPU...
276.9s 2444 GPU data transfer complete.
276.9s 2445 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
276.9s 2446 Initial boundary conditions applied.
276.9s 2447 [BC UPDATE] left → phase 0 RED (reduced inflow)
276.9s 2448 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
276.9s 2449 [BC UPDATE] left → phase 1 GREEN (normal inflow)
276.9s 2450 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
276.9s 2451 Running simulation until t = 60.00 s, outputting every 60.00 s
276.9s 2452 
277.3s 2453 [WARNING] Automatic CFL correction applied (count: 14000):
277.3s 2454 Calculated CFL: 0.800 > Limit: 0.500
277.3s 2455 Original dt: 4.396418e-01 s
277.3s 2456 Corrected dt: 2.747761e-01 s
277.3s 2457 Correction factor: 1.6x
277.3s 2458 Max wave speed detected: 18.20 m/s
277.3s 2459 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
277.8s 2460 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
278.2s 2461 [WARNING] Automatic CFL correction applied (count: 14100):
278.2s 2462 Calculated CFL: 0.800 > Limit: 0.500
278.2s 2463 Original dt: 4.118393e-01 s
278.2s 2464 Corrected dt: 2.573996e-01 s
278.2s 2465 Correction factor: 1.6x
278.2s 2466 Max wave speed detected: 19.43 m/s
278.2s 2467 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
278.7s 2468 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
278.9s 2469 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
278.9s 2470 [A
278.9s 2471 Stored output at t = 60.0000 s (Step 231)
278.9s 2472 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.97s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.97s/s]
278.9s 2473 
278.9s 2474 Simulation finished at t = 60.0000 s after 231 steps.
278.9s 2475 Total runtime: 2.07 seconds.
278.9s 2476 [BC UPDATE] left → phase 0 RED (reduced inflow)
278.9s 2477 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
278.9s 2478 Running simulation until t = 120.00 s, outputting every 60.00 s
278.9s 2479 
279.1s 2480 [WARNING] Automatic CFL correction applied (count: 14200):
279.1s 2481 Calculated CFL: 0.800 > Limit: 0.500
279.1s 2482 Original dt: 4.115033e-01 s
279.1s 2483 Corrected dt: 2.571896e-01 s
279.1s 2484 Correction factor: 1.6x
279.1s 2485 Max wave speed detected: 19.44 m/s
279.1s 2486 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
279.6s 2487 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
280.0s 2488 [WARNING] Automatic CFL correction applied (count: 14300):
280.0s 2489 Calculated CFL: 0.800 > Limit: 0.500
280.0s 2490 Original dt: 4.114981e-01 s
280.0s 2491 Corrected dt: 2.571863e-01 s
280.0s 2492 Correction factor: 1.6x
280.0s 2493 Max wave speed detected: 19.44 m/s
280.0s 2494 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
280.5s 2495 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
280.9s 2496 [WARNING] Automatic CFL correction applied (count: 14400):
280.9s 2497 Calculated CFL: 0.800 > Limit: 0.500
280.9s 2498 Original dt: 4.114980e-01 s
280.9s 2499 Corrected dt: 2.571863e-01 s
280.9s 2500 Correction factor: 1.6x
280.9s 2501 Max wave speed detected: 19.44 m/s
280.9s 2502 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
281.1s 2503 Stored output at t = 120.0000 s (Step 465)
281.1s 2504 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
281.1s 2505 [A
281.1s 2506 
281.1s 2507 Simulation finished at t = 120.0000 s after 465 steps.
281.1s 2508 Total runtime: 2.11 seconds.
281.1s 2509 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s]
281.1s 2510 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
281.1s 2511 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
281.1s 2512 Using device: gpu
281.1s 2513 DEBUG PARAMS: Reading K_m_kmh = 10.0
281.1s 2514 DEBUG PARAMS: Reading K_c_kmh = 15.0
281.1s 2515 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
281.1s 2516 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
281.1s 2517 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
281.1s 2518 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
281.1s 2519 Loading road quality type: uniform
281.1s 2520 Uniform road quality value: 2
281.1s 2521 Road quality loaded.
281.1s 2522 Initial state created.
281.1s 2523 Transferring initial state and road quality to GPU...
281.1s 2524 GPU data transfer complete.
281.1s 2525 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
281.1s 2526 Initial boundary conditions applied.
281.1s 2527 [BC UPDATE] left → phase 0 RED (reduced inflow)
281.1s 2528 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
281.1s 2529 
281.1s 2530 Running simulation until t = 60.00 s, outputting every 60.00 s
281.6s 2531 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
281.9s 2532 [WARNING] Automatic CFL correction applied (count: 14500):
281.9s 2533 Calculated CFL: 0.800 > Limit: 0.500
281.9s 2534 Original dt: 4.173029e-01 s
281.9s 2535 Corrected dt: 2.608143e-01 s
281.9s 2536 Correction factor: 1.6x
281.9s 2537 Max wave speed detected: 19.17 m/s
282.0s 2538 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
282.5s 2539 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
282.8s 2540 [WARNING] Automatic CFL correction applied (count: 14600):
282.8s 2541 Calculated CFL: 0.800 > Limit: 0.500
282.8s 2542 Original dt: 4.115760e-01 s
282.8s 2543 Corrected dt: 2.572350e-01 s
282.8s 2544 Correction factor: 1.6x
282.8s 2545 Max wave speed detected: 19.44 m/s
283.0s 2546 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
283.2s 2547 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
283.2s 2548 Stored output at t = 60.0000 s (Step 231)
283.2s 2549 [A
283.2s 2550 
283.2s 2551 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.61s/s]
283.2s 2552 Simulation finished at t = 60.0000 s after 231 steps.
283.2s 2553 Total runtime: 2.17 seconds.
283.2s 2554 [BC UPDATE] left → phase 1 GREEN (normal inflow)
283.2s 2555 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
283.2s 2556 Running simulation until t = 120.00 s, outputting every 60.00 s
283.2s 2557 
283.4s 2558 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
283.8s 2559 [WARNING] Automatic CFL correction applied (count: 14700):
283.8s 2560 Calculated CFL: 0.800 > Limit: 0.500
283.8s 2561 Original dt: 4.114993e-01 s
283.8s 2562 Corrected dt: 2.571871e-01 s
283.8s 2563 Correction factor: 1.6x
283.8s 2564 Max wave speed detected: 19.44 m/s
283.9s 2565 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
284.4s 2566 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
284.7s 2567 [WARNING] Automatic CFL correction applied (count: 14800):
284.7s 2568 Calculated CFL: 0.800 > Limit: 0.500
284.7s 2569 Original dt: 4.114981e-01 s
284.7s 2570 Corrected dt: 2.571863e-01 s
284.7s 2571 Correction factor: 1.6x
284.7s 2572 Max wave speed detected: 19.44 m/s
284.8s 2573 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
285.3s 2574 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
285.4s 2575 Stored output at t = 120.0000 s (Step 465)
285.4s 2576 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
285.4s 2577 [A
285.4s 2578 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.67s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.67s/s]
285.4s 2579 
285.4s 2580 Simulation finished at t = 120.0000 s after 465 steps.
285.4s 2581 Total runtime: 2.17 seconds.
285.4s 2582 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
285.4s 2583 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
285.4s 2584 Using device: gpu
285.4s 2585 DEBUG PARAMS: Reading K_m_kmh = 10.0
285.4s 2586 DEBUG PARAMS: Reading K_c_kmh = 15.0
285.4s 2587 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
285.4s 2588 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
285.4s 2589 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
285.4s 2590 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
285.4s 2591 Loading road quality type: uniform
285.4s 2592 Uniform road quality value: 2
285.4s 2593 Road quality loaded.
285.4s 2594 Initial state created.
285.4s 2595 Transferring initial state and road quality to GPU...
285.4s 2596 GPU data transfer complete.
285.4s 2597 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
285.4s 2598 Initial boundary conditions applied.
285.4s 2599 [BC UPDATE] left → phase 0 RED (reduced inflow)
285.4s 2600 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
285.4s 2601 Running simulation until t = 60.00 s, outputting every 60.00 s
285.4s 2602 
285.6s 2603 [WARNING] Automatic CFL correction applied (count: 14900):
285.6s 2604 Calculated CFL: 0.800 > Limit: 0.500
285.6s 2605 Original dt: 4.295974e-01 s
285.6s 2606 Corrected dt: 2.684983e-01 s
285.6s 2607 Correction factor: 1.6x
285.6s 2608 Max wave speed detected: 18.62 m/s
285.9s 2609 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
286.4s 2610 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
286.5s 2611 [WARNING] Automatic CFL correction applied (count: 15000):
286.5s 2612 Calculated CFL: 0.800 > Limit: 0.500
286.5s 2613 Original dt: 4.127253e-01 s
286.5s 2614 Corrected dt: 2.579533e-01 s
286.5s 2615 Correction factor: 1.6x
286.5s 2616 Max wave speed detected: 19.38 m/s
286.8s 2617 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
287.3s 2618 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
287.5s 2619 [WARNING] Automatic CFL correction applied (count: 15100):
287.5s 2620 Calculated CFL: 0.800 > Limit: 0.500
287.5s 2621 Original dt: 4.115153e-01 s
287.5s 2622 Corrected dt: 2.571971e-01 s
287.5s 2623 Correction factor: 1.6x
287.5s 2624 Max wave speed detected: 19.44 m/s
287.6s 2625 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
287.6s 2626 [A
287.6s 2627 Stored output at t = 60.0000 s (Step 231)
287.6s 2628 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.15s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.15s/s]
287.6s 2629 
287.6s 2630 Simulation finished at t = 60.0000 s after 231 steps.
287.6s 2631 Total runtime: 2.13 seconds.
287.6s 2632 [BC UPDATE] left → phase 1 GREEN (normal inflow)
287.6s 2633 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
287.6s 2634 Running simulation until t = 120.00 s, outputting every 60.00 s
287.6s 2635 
287.7s 2636 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
288.2s 2637 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
288.4s 2638 [WARNING] Automatic CFL correction applied (count: 15200):
288.4s 2639 Calculated CFL: 0.800 > Limit: 0.500
288.4s 2640 Original dt: 4.114984e-01 s
288.4s 2641 Corrected dt: 2.571865e-01 s
288.4s 2642 Correction factor: 1.6x
288.4s 2643 Max wave speed detected: 19.44 m/s
288.7s 2644 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
289.1s 2645 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
289.3s 2646 [WARNING] Automatic CFL correction applied (count: 15300):
289.3s 2647 Calculated CFL: 0.800 > Limit: 0.500
289.3s 2648 Original dt: 4.114980e-01 s
289.3s 2649 Corrected dt: 2.571863e-01 s
289.3s 2650 Correction factor: 1.6x
289.3s 2651 Max wave speed detected: 19.44 m/s
289.6s 2652 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
289.7s 2653 Stored output at t = 120.0000 s (Step 465)
289.7s 2654 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
289.7s 2655 [A
289.7s 2656 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s]
289.7s 2657 
289.7s 2658 Simulation finished at t = 120.0000 s after 465 steps.
289.7s 2659 Total runtime: 2.15 seconds.
289.7s 2660 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
289.7s 2661 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
289.7s 2662 Using device: gpu
289.7s 2663 DEBUG PARAMS: Reading K_m_kmh = 10.0
289.7s 2664 DEBUG PARAMS: Reading K_c_kmh = 15.0
289.7s 2665 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
289.7s 2666 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
289.7s 2667 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
289.7s 2668 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
289.7s 2669 Loading road quality type: uniform
289.7s 2670 Uniform road quality value: 2
289.7s 2671 Road quality loaded.
289.7s 2672 Initial state created.
289.7s 2673 Transferring initial state and road quality to GPU...
289.7s 2674 GPU data transfer complete.
289.7s 2675 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
289.7s 2676 Initial boundary conditions applied.
289.7s 2677 [BC UPDATE] left → phase 0 RED (reduced inflow)
289.7s 2678 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
289.7s 2679 Running simulation until t = 60.00 s, outputting every 60.00 s
289.7s 2680 
290.2s 2681 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
290.2s 2682 [WARNING] Automatic CFL correction applied (count: 15400):
290.2s 2683 Calculated CFL: 0.800 > Limit: 0.500
290.2s 2684 Original dt: 4.346596e-01 s
290.2s 2685 Corrected dt: 2.716622e-01 s
290.2s 2686 Correction factor: 1.6x
290.2s 2687 Max wave speed detected: 18.41 m/s
290.6s 2688 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
291.1s 2689 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
291.1s 2690 [WARNING] Automatic CFL correction applied (count: 15500):
291.1s 2691 Calculated CFL: 0.800 > Limit: 0.500
291.1s 2692 Original dt: 4.117853e-01 s
291.1s 2693 Corrected dt: 2.573658e-01 s
291.1s 2694 Correction factor: 1.6x
291.1s 2695 Max wave speed detected: 19.43 m/s
292.0s 2696 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
292.3s 2697 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
292.3s 2698 [A
292.3s 2699 Stored output at t = 60.0000 s (Step 231)
292.3s 2700 
292.3s 2701 Simulation finished at t = 60.0000 s after 231 steps.
292.3s 2702 Total runtime: 2.56 seconds.
292.3s 2703 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.43s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 23.43s/s]
292.3s 2704 
292.3s 2705 [BC UPDATE] left → phase 1 GREEN (normal inflow)
292.3s 2706 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
292.3s 2707 Running simulation until t = 120.00 s, outputting every 60.00 s
292.5s 2708 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
292.5s 2709 [WARNING] Automatic CFL correction applied (count: 15600):
292.5s 2710 Calculated CFL: 0.800 > Limit: 0.500
292.5s 2711 Original dt: 4.115023e-01 s
292.5s 2712 Corrected dt: 2.571890e-01 s
292.5s 2713 Correction factor: 1.6x
292.5s 2714 Max wave speed detected: 19.44 m/s
292.9s 2715 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
293.4s 2716 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
293.4s 2717 [WARNING] Automatic CFL correction applied (count: 15700):
293.4s 2718 Calculated CFL: 0.800 > Limit: 0.500
293.4s 2719 Original dt: 4.114981e-01 s
293.4s 2720 Corrected dt: 2.571863e-01 s
293.4s 2721 Correction factor: 1.6x
293.4s 2722 Max wave speed detected: 19.44 m/s
293.9s 2723 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
294.3s 2724 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
294.4s 2725 [WARNING] Automatic CFL correction applied (count: 15800):
294.4s 2726 Calculated CFL: 0.800 > Limit: 0.500
294.4s 2727 Original dt: 4.114980e-01 s
294.4s 2728 Corrected dt: 2.571863e-01 s
294.4s 2729 Correction factor: 1.6x
294.4s 2730 Max wave speed detected: 19.44 m/s
294.5s 2731 Stored output at t = 120.0000 s (Step 465)
294.5s 2732 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
294.5s 2733 [A
294.5s 2734 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.58s/s]
294.5s 2735 
294.5s 2736 Simulation finished at t = 120.0000 s after 465 steps.
294.5s 2737 Total runtime: 2.18 seconds.
294.5s 2738 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
294.5s 2739 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
294.5s 2740 Using device: gpu
294.5s 2741 DEBUG PARAMS: Reading K_m_kmh = 10.0
294.5s 2742 DEBUG PARAMS: Reading K_c_kmh = 15.0
294.5s 2743 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
294.5s 2744 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
294.5s 2745 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
294.5s 2746 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
294.5s 2747 Loading road quality type: uniform
294.5s 2748 Uniform road quality value: 2
294.5s 2749 Road quality loaded.
294.5s 2750 Initial state created.
294.5s 2751 Transferring initial state and road quality to GPU...
294.5s 2752 GPU data transfer complete.
294.5s 2753 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
294.5s 2754 Initial boundary conditions applied.
294.5s 2755 [BC UPDATE] left → phase 0 RED (reduced inflow)
294.5s 2756 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
294.5s 2757 Running simulation until t = 60.00 s, outputting every 60.00 s
294.5s 2758 
295.0s 2759 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
295.3s 2760 [WARNING] Automatic CFL correction applied (count: 15900):
295.3s 2761 Calculated CFL: 0.800 > Limit: 0.500
295.3s 2762 Original dt: 4.160552e-01 s
295.3s 2763 Corrected dt: 2.600345e-01 s
295.3s 2764 Correction factor: 1.6x
295.3s 2765 Max wave speed detected: 19.23 m/s
295.4s 2766 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
295.9s 2767 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
296.3s 2768 [WARNING] Automatic CFL correction applied (count: 16000):
296.3s 2769 Calculated CFL: 0.800 > Limit: 0.500
296.3s 2770 Original dt: 4.115592e-01 s
296.3s 2771 Corrected dt: 2.572245e-01 s
296.3s 2772 Correction factor: 1.6x
296.3s 2773 Max wave speed detected: 19.44 m/s
296.4s 2774 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
296.7s 2775 Stored output at t = 60.0000 s (Step 231)
296.7s 2776 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
296.7s 2777 [A
296.7s 2778 
296.7s 2779 Simulation finished at t = 60.0000 s after 231 steps.
296.7s 2780 Total runtime: 2.17 seconds.
296.7s 2781 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.68s/s]
296.7s 2782 
296.7s 2783 [BC UPDATE] left → phase 1 GREEN (normal inflow)
296.7s 2784 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
296.7s 2785 Running simulation until t = 120.00 s, outputting every 60.00 s
296.8s 2786 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
297.2s 2787 [WARNING] Automatic CFL correction applied (count: 16100):
297.2s 2788 Calculated CFL: 0.800 > Limit: 0.500
297.2s 2789 Original dt: 4.114991e-01 s
297.2s 2790 Corrected dt: 2.571870e-01 s
297.2s 2791 Correction factor: 1.6x
297.2s 2792 Max wave speed detected: 19.44 m/s
297.3s 2793 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
297.7s 2794 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
298.1s 2795 [WARNING] Automatic CFL correction applied (count: 16200):
298.1s 2796 Calculated CFL: 0.800 > Limit: 0.500
298.1s 2797 Original dt: 4.114980e-01 s
298.1s 2798 Corrected dt: 2.571863e-01 s
298.1s 2799 Correction factor: 1.6x
298.1s 2800 Max wave speed detected: 19.44 m/s
298.2s 2801 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
298.6s 2802 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
298.8s 2803 Stored output at t = 120.0000 s (Step 465)
298.8s 2804 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
298.8s 2805 [A
298.8s 2806 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.26s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.26s/s]
298.8s 2807 
298.8s 2808 Simulation finished at t = 120.0000 s after 465 steps.
298.8s 2809 Total runtime: 2.12 seconds.
298.8s 2810 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
298.8s 2811 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
298.8s 2812 Using device: gpu
298.8s 2813 DEBUG PARAMS: Reading K_m_kmh = 10.0
298.8s 2814 DEBUG PARAMS: Reading K_c_kmh = 15.0
298.8s 2815 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
298.8s 2816 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
298.8s 2817 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
298.8s 2818 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
298.8s 2819 Loading road quality type: uniform
298.8s 2820 Uniform road quality value: 2
298.8s 2821 Road quality loaded.
298.8s 2822 Initial state created.
298.8s 2823 Transferring initial state and road quality to GPU...
298.8s 2824 GPU data transfer complete.
298.8s 2825 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
298.8s 2826 Initial boundary conditions applied.
298.8s 2827 [BC UPDATE] left → phase 0 RED (reduced inflow)
298.8s 2828 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
298.8s 2829 [BC UPDATE] left → phase 1 GREEN (normal inflow)
298.8s 2830 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
298.8s 2831 Running simulation until t = 60.00 s, outputting every 60.00 s
298.8s 2832 
299.0s 2833 [WARNING] Automatic CFL correction applied (count: 16300):
299.0s 2834 Calculated CFL: 0.800 > Limit: 0.500
299.0s 2835 Original dt: 4.547467e-01 s
299.0s 2836 Corrected dt: 2.842167e-01 s
299.0s 2837 Correction factor: 1.6x
299.0s 2838 Max wave speed detected: 17.59 m/s
299.3s 2839 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
299.7s 2840 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
300.0s 2841 [WARNING] Automatic CFL correction applied (count: 16400):
300.0s 2842 Calculated CFL: 0.800 > Limit: 0.500
300.0s 2843 Original dt: 4.125079e-01 s
300.0s 2844 Corrected dt: 2.578175e-01 s
300.0s 2845 Correction factor: 1.6x
300.0s 2846 Max wave speed detected: 19.39 m/s
300.2s 2847 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
300.7s 2848 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
300.9s 2849 [WARNING] Automatic CFL correction applied (count: 16500):
300.9s 2850 Calculated CFL: 0.800 > Limit: 0.500
300.9s 2851 Original dt: 4.115121e-01 s
300.9s 2852 Corrected dt: 2.571950e-01 s
300.9s 2853 Correction factor: 1.6x
300.9s 2854 Max wave speed detected: 19.44 m/s
301.0s 2855 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
301.0s 2856 [A
301.0s 2857 Stored output at t = 60.0000 s (Step 231)
301.0s 2858 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.70s/s]
301.0s 2859 
301.0s 2860 Simulation finished at t = 60.0000 s after 231 steps.
301.0s 2861 Total runtime: 2.17 seconds.
301.0s 2862 [BC UPDATE] left → phase 0 RED (reduced inflow)
301.0s 2863 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
301.0s 2864 Running simulation until t = 120.00 s, outputting every 60.00 s
301.0s 2865 
301.1s 2866 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
301.7s 2867 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
301.9s 2868 [WARNING] Automatic CFL correction applied (count: 16600):
301.9s 2869 Calculated CFL: 0.800 > Limit: 0.500
301.9s 2870 Original dt: 4.114983e-01 s
301.9s 2871 Corrected dt: 2.571865e-01 s
301.9s 2872 Correction factor: 1.6x
301.9s 2873 Max wave speed detected: 19.44 m/s
302.1s 2874 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
302.6s 2875 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
302.8s 2876 [WARNING] Automatic CFL correction applied (count: 16700):
302.8s 2877 Calculated CFL: 0.800 > Limit: 0.500
302.8s 2878 Original dt: 4.114980e-01 s
302.8s 2879 Corrected dt: 2.571863e-01 s
302.8s 2880 Correction factor: 1.6x
302.8s 2881 Max wave speed detected: 19.44 m/s
303.0s 2882 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
303.2s 2883 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
303.2s 2884 Stored output at t = 120.0000 s (Step 465)
303.2s 2885 [A
303.2s 2886 
303.2s 2887 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.07s/s]
303.2s 2888 Simulation finished at t = 120.0000 s after 465 steps.
303.2s 2889 Total runtime: 2.22 seconds.
303.2s 2890 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
303.2s 2891 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
303.2s 2892 Using device: gpu
303.2s 2893 DEBUG PARAMS: Reading K_m_kmh = 10.0
303.2s 2894 DEBUG PARAMS: Reading K_c_kmh = 15.0
303.2s 2895 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
303.2s 2896 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
303.2s 2897 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
303.2s 2898 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
303.2s 2899 Loading road quality type: uniform
303.2s 2900 Uniform road quality value: 2
303.2s 2901 Road quality loaded.
303.2s 2902 Initial state created.
303.2s 2903 Transferring initial state and road quality to GPU...
303.2s 2904 GPU data transfer complete.
303.2s 2905 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
303.2s 2906 Initial boundary conditions applied.
303.2s 2907 [BC UPDATE] left → phase 0 RED (reduced inflow)
303.2s 2908 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
303.2s 2909 [BC UPDATE] left → phase 1 GREEN (normal inflow)
303.2s 2910 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
303.2s 2911 Running simulation until t = 60.00 s, outputting every 60.00 s
303.2s 2912 
303.7s 2913 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
303.8s 2914 [WARNING] Automatic CFL correction applied (count: 16800):
303.8s 2915 Calculated CFL: 0.800 > Limit: 0.500
303.8s 2916 Original dt: 4.295897e-01 s
303.8s 2917 Corrected dt: 2.684936e-01 s
303.8s 2918 Correction factor: 1.6x
303.8s 2919 Max wave speed detected: 18.62 m/s
304.1s 2920 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
304.6s 2921 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
304.7s 2922 [WARNING] Automatic CFL correction applied (count: 16900):
304.7s 2923 Calculated CFL: 0.800 > Limit: 0.500
304.7s 2924 Original dt: 4.117215e-01 s
304.7s 2925 Corrected dt: 2.573259e-01 s
304.7s 2926 Correction factor: 1.6x
304.7s 2927 Max wave speed detected: 19.43 m/s
305.0s 2928 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
305.3s 2929 Stored output at t = 60.0000 s (Step 231)
305.3s 2930 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
305.3s 2931 [A
305.3s 2932 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.09s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.09s/s]
305.3s 2933 
305.3s 2934 Simulation finished at t = 60.0000 s after 231 steps.
305.3s 2935 Total runtime: 2.14 seconds.
305.3s 2936 [BC UPDATE] left → phase 0 RED (reduced inflow)
305.3s 2937 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
305.3s 2938 
305.3s 2939 Running simulation until t = 120.00 s, outputting every 60.00 s
305.5s 2940 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
305.6s 2941 [WARNING] Automatic CFL correction applied (count: 17000):
305.6s 2942 Calculated CFL: 0.800 > Limit: 0.500
305.6s 2943 Original dt: 4.115016e-01 s
305.6s 2944 Corrected dt: 2.571885e-01 s
305.6s 2945 Correction factor: 1.6x
305.6s 2946 Max wave speed detected: 19.44 m/s
306.0s 2947 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
306.4s 2948 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
306.5s 2949 [WARNING] Automatic CFL correction applied (count: 17100):
306.5s 2950 Calculated CFL: 0.800 > Limit: 0.500
306.5s 2951 Original dt: 4.114981e-01 s
306.5s 2952 Corrected dt: 2.571863e-01 s
306.5s 2953 Correction factor: 1.6x
306.5s 2954 Max wave speed detected: 19.44 m/s
306.9s 2955 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
307.4s 2956 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
307.4s 2957 [WARNING] Automatic CFL correction applied (count: 17200):
307.4s 2958 Calculated CFL: 0.800 > Limit: 0.500
307.4s 2959 Original dt: 4.114980e-01 s
307.4s 2960 Corrected dt: 2.571863e-01 s
307.4s 2961 Correction factor: 1.6x
307.4s 2962 Max wave speed detected: 19.44 m/s
307.5s 2963 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
307.5s 2964 Stored output at t = 120.0000 s (Step 465)
307.5s 2965 [A
307.5s 2966 
307.5s 2967 Simulation finished at t = 120.0000 s after 465 steps.
307.5s 2968 Total runtime: 2.15 seconds.
307.5s 2969 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s]
307.5s 2970 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
307.5s 2971 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
307.5s 2972 Using device: gpu
307.5s 2973 DEBUG PARAMS: Reading K_m_kmh = 10.0
307.5s 2974 DEBUG PARAMS: Reading K_c_kmh = 15.0
307.5s 2975 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
307.5s 2976 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
307.5s 2977 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
307.5s 2978 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
307.5s 2979 Loading road quality type: uniform
307.5s 2980 Uniform road quality value: 2
307.5s 2981 Road quality loaded.
307.5s 2982 Initial state created.
307.5s 2983 Transferring initial state and road quality to GPU...
307.5s 2984 GPU data transfer complete.
307.5s 2985 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
307.5s 2986 Initial boundary conditions applied.
307.5s 2987 [BC UPDATE] left → phase 0 RED (reduced inflow)
307.5s 2988 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
307.5s 2989 Running simulation until t = 60.00 s, outputting every 60.00 s
307.5s 2990 
308.0s 2991 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
308.4s 2992 [WARNING] Automatic CFL correction applied (count: 17300):
308.4s 2993 Calculated CFL: 0.800 > Limit: 0.500
308.4s 2994 Original dt: 4.151534e-01 s
308.4s 2995 Corrected dt: 2.594709e-01 s
308.4s 2996 Correction factor: 1.6x
308.4s 2997 Max wave speed detected: 19.27 m/s
308.4s 2998 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
308.9s 2999 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
309.3s 3000 [WARNING] Automatic CFL correction applied (count: 17400):
309.3s 3001 Calculated CFL: 0.800 > Limit: 0.500
309.3s 3002 Original dt: 4.115470e-01 s
309.3s 3003 Corrected dt: 2.572169e-01 s
309.3s 3004 Correction factor: 1.6x
309.3s 3005 Max wave speed detected: 19.44 m/s
309.4s 3006 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
309.6s 3007 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
309.6s 3008 [A
309.6s 3009 Stored output at t = 60.0000 s (Step 231)
309.6s 3010 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.05s/s]
309.6s 3011 
309.6s 3012 Simulation finished at t = 60.0000 s after 231 steps.
309.6s 3013 Total runtime: 2.14 seconds.
309.6s 3014 Running simulation until t = 120.00 s, outputting every 60.00 s
309.6s 3015 
309.8s 3016 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
310.2s 3017 [WARNING] Automatic CFL correction applied (count: 17500):
310.2s 3018 Calculated CFL: 0.800 > Limit: 0.500
310.2s 3019 Original dt: 4.114990e-01 s
310.2s 3020 Corrected dt: 2.571869e-01 s
310.2s 3021 Correction factor: 1.6x
310.2s 3022 Max wave speed detected: 19.44 m/s
310.3s 3023 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
310.8s 3024 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
311.2s 3025 [WARNING] Automatic CFL correction applied (count: 17600):
311.2s 3026 Calculated CFL: 0.800 > Limit: 0.500
311.2s 3027 Original dt: 4.114980e-01 s
311.2s 3028 Corrected dt: 2.571863e-01 s
311.2s 3029 Correction factor: 1.6x
311.2s 3030 Max wave speed detected: 19.44 m/s
311.2s 3031 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
311.7s 3032 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
311.9s 3033 Stored output at t = 120.0000 s (Step 465)
311.9s 3034 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
311.9s 3035 [A
311.9s 3036 
311.9s 3037 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.19s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.19s/s]
311.9s 3038 Simulation finished at t = 120.0000 s after 465 steps.
311.9s 3039 Total runtime: 2.21 seconds.
311.9s 3040 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
311.9s 3041 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
311.9s 3042 Using device: gpu
311.9s 3043 DEBUG PARAMS: Reading K_m_kmh = 10.0
311.9s 3044 DEBUG PARAMS: Reading K_c_kmh = 15.0
311.9s 3045 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
311.9s 3046 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
311.9s 3047 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
311.9s 3048 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
311.9s 3049 Loading road quality type: uniform
311.9s 3050 Uniform road quality value: 2
311.9s 3051 Road quality loaded.
311.9s 3052 Initial state created.
311.9s 3053 Transferring initial state and road quality to GPU...
311.9s 3054 GPU data transfer complete.
311.9s 3055 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
311.9s 3056 Initial boundary conditions applied.
311.9s 3057 [BC UPDATE] left → phase 0 RED (reduced inflow)
311.9s 3058 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
311.9s 3059 Running simulation until t = 60.00 s, outputting every 60.00 s
311.9s 3060 
312.1s 3061 [WARNING] Automatic CFL correction applied (count: 17700):
312.1s 3062 Calculated CFL: 0.800 > Limit: 0.500
312.1s 3063 Original dt: 4.768783e-01 s
312.1s 3064 Corrected dt: 2.980490e-01 s
312.1s 3065 Correction factor: 1.6x
312.1s 3066 Max wave speed detected: 16.78 m/s
312.3s 3067 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
312.8s 3068 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
313.1s 3069 [WARNING] Automatic CFL correction applied (count: 17800):
313.1s 3070 Calculated CFL: 0.800 > Limit: 0.500
313.1s 3071 Original dt: 4.123385e-01 s
313.1s 3072 Corrected dt: 2.577116e-01 s
313.1s 3073 Correction factor: 1.6x
313.1s 3074 Max wave speed detected: 19.40 m/s
313.3s 3075 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
313.7s 3076 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
314.0s 3077 [WARNING] Automatic CFL correction applied (count: 17900):
314.0s 3078 Calculated CFL: 0.800 > Limit: 0.500
314.0s 3079 Original dt: 4.115097e-01 s
314.0s 3080 Corrected dt: 2.571935e-01 s
314.0s 3081 Correction factor: 1.6x
314.0s 3082 Max wave speed detected: 19.44 m/s
314.0s 3083 Stored output at t = 60.0000 s (Step 231)
314.0s 3084 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
314.0s 3085 [A
314.0s 3086 
314.0s 3087 Simulation finished at t = 60.0000 s after 231 steps.
314.0s 3088 Total runtime: 2.13 seconds.
314.0s 3089 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.15s/s]
314.0s 3090 Running simulation until t = 120.00 s, outputting every 60.00 s
314.0s 3091 
314.2s 3092 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
314.6s 3093 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
314.9s 3094 [WARNING] Automatic CFL correction applied (count: 18000):
314.9s 3095 Calculated CFL: 0.800 > Limit: 0.500
314.9s 3096 Original dt: 4.114983e-01 s
314.9s 3097 Corrected dt: 2.571864e-01 s
314.9s 3098 Correction factor: 1.6x
314.9s 3099 Max wave speed detected: 19.44 m/s
315.1s 3100 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
315.6s 3101 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
315.9s 3102 [WARNING] Automatic CFL correction applied (count: 18100):
315.9s 3103 Calculated CFL: 0.800 > Limit: 0.500
315.9s 3104 Original dt: 4.114980e-01 s
315.9s 3105 Corrected dt: 2.571863e-01 s
315.9s 3106 Correction factor: 1.6x
315.9s 3107 Max wave speed detected: 19.44 m/s
316.1s 3108 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
316.2s 3109 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
316.2s 3110 Stored output at t = 120.0000 s (Step 465)
316.2s 3111 [A
316.2s 3112 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.45s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.45s/s]
316.2s 3113 
316.2s 3114 Simulation finished at t = 120.0000 s after 465 steps.
316.2s 3115 Total runtime: 2.19 seconds.
316.2s 3116 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
316.2s 3117 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
316.2s 3118 Using device: gpu
316.2s 3119 DEBUG PARAMS: Reading K_m_kmh = 10.0
316.2s 3120 DEBUG PARAMS: Reading K_c_kmh = 15.0
316.2s 3121 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
316.2s 3122 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
316.2s 3123 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
316.2s 3124 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
316.2s 3125 Loading road quality type: uniform
316.2s 3126 Uniform road quality value: 2
316.2s 3127 Road quality loaded.
316.2s 3128 Initial state created.
316.2s 3129 Transferring initial state and road quality to GPU...
316.2s 3130 GPU data transfer complete.
316.2s 3131 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
316.2s 3132 Initial boundary conditions applied.
316.2s 3133 [BC UPDATE] left → phase 0 RED (reduced inflow)
316.2s 3134 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
316.2s 3135 Running simulation until t = 60.00 s, outputting every 60.00 s
316.2s 3136 
316.7s 3137 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
316.8s 3138 [WARNING] Automatic CFL correction applied (count: 18200):
316.8s 3139 Calculated CFL: 0.800 > Limit: 0.500
316.8s 3140 Original dt: 4.254608e-01 s
316.8s 3141 Corrected dt: 2.659130e-01 s
316.8s 3142 Correction factor: 1.6x
316.8s 3143 Max wave speed detected: 18.80 m/s
317.2s 3144 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
317.7s 3145 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
317.8s 3146 [WARNING] Automatic CFL correction applied (count: 18300):
317.8s 3147 Calculated CFL: 0.800 > Limit: 0.500
317.8s 3148 Original dt: 4.116742e-01 s
317.8s 3149 Corrected dt: 2.572964e-01 s
317.8s 3150 Correction factor: 1.6x
317.8s 3151 Max wave speed detected: 19.43 m/s
318.1s 3152 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
318.4s 3153 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
318.4s 3154 [A
318.4s 3155 Stored output at t = 60.0000 s (Step 231)
318.4s 3156 
318.4s 3157 Simulation finished at t = 60.0000 s after 231 steps.
318.4s 3158 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.01s/s]
318.4s 3159 Total runtime: 2.22 seconds.
318.4s 3160 
318.4s 3161 Running simulation until t = 120.00 s, outputting every 60.00 s
318.6s 3162 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
318.7s 3163 [WARNING] Automatic CFL correction applied (count: 18400):
318.7s 3164 Calculated CFL: 0.800 > Limit: 0.500
318.7s 3165 Original dt: 4.115011e-01 s
318.7s 3166 Corrected dt: 2.571882e-01 s
318.7s 3167 Correction factor: 1.6x
318.7s 3168 Max wave speed detected: 19.44 m/s
319.1s 3169 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
319.5s 3170 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
319.7s 3171 [WARNING] Automatic CFL correction applied (count: 18500):
319.7s 3172 Calculated CFL: 0.800 > Limit: 0.500
319.7s 3173 Original dt: 4.114981e-01 s
319.7s 3174 Corrected dt: 2.571863e-01 s
319.7s 3175 Correction factor: 1.6x
319.7s 3176 Max wave speed detected: 19.44 m/s
320.0s 3177 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
320.5s 3178 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
320.6s 3179 [WARNING] Automatic CFL correction applied (count: 18600):
320.6s 3180 Calculated CFL: 0.800 > Limit: 0.500
320.6s 3181 Original dt: 4.114980e-01 s
320.6s 3182 Corrected dt: 2.571863e-01 s
320.6s 3183 Correction factor: 1.6x
320.6s 3184 Max wave speed detected: 19.44 m/s
320.6s 3185 Stored output at t = 120.0000 s (Step 465)
320.6s 3186 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
320.6s 3187 [A
320.6s 3188 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.52s/s]
320.6s 3189 
320.6s 3190 Simulation finished at t = 120.0000 s after 465 steps.
320.6s 3191 Total runtime: 2.18 seconds.
320.6s 3192 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
320.6s 3193 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
320.6s 3194 Using device: gpu
320.6s 3195 DEBUG PARAMS: Reading K_m_kmh = 10.0
320.6s 3196 DEBUG PARAMS: Reading K_c_kmh = 15.0
320.6s 3197 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
320.6s 3198 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
320.6s 3199 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
320.6s 3200 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
320.6s 3201 Loading road quality type: uniform
320.6s 3202 Uniform road quality value: 2
320.6s 3203 Road quality loaded.
320.6s 3204 Initial state created.
320.6s 3205 Transferring initial state and road quality to GPU...
320.6s 3206 GPU data transfer complete.
320.6s 3207 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
320.6s 3208 Initial boundary conditions applied.
320.6s 3209 [BC UPDATE] left → phase 0 RED (reduced inflow)
320.6s 3210 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
320.6s 3211 [BC UPDATE] left → phase 1 GREEN (normal inflow)
320.6s 3212 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
320.6s 3213 Running simulation until t = 60.00 s, outputting every 60.00 s
320.6s 3214 
321.1s 3215 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
321.6s 3216 [WARNING] Automatic CFL correction applied (count: 18700):
321.6s 3217 Calculated CFL: 0.800 > Limit: 0.500
321.6s 3218 Original dt: 4.145004e-01 s
321.6s 3219 Corrected dt: 2.590627e-01 s
321.6s 3220 Correction factor: 1.6x
321.6s 3221 Max wave speed detected: 19.30 m/s
321.6s 3222 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
322.0s 3223 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
322.5s 3224 [WARNING] Automatic CFL correction applied (count: 18800):
322.5s 3225 Calculated CFL: 0.800 > Limit: 0.500
322.5s 3226 Original dt: 4.115380e-01 s
322.5s 3227 Corrected dt: 2.572113e-01 s
322.5s 3228 Correction factor: 1.6x
322.5s 3229 Max wave speed detected: 19.44 m/s
322.5s 3230 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
322.8s 3231 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
322.8s 3232 [A
322.8s 3233 Stored output at t = 60.0000 s (Step 231)
322.8s 3234 
322.8s 3235 Simulation finished at t = 60.0000 s after 231 steps.
322.8s 3236 Total runtime: 2.14 seconds.
322.8s 3237 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.00s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.99s/s]
322.8s 3238 [BC UPDATE] left → phase 0 RED (reduced inflow)
322.8s 3239 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
322.8s 3240 Running simulation until t = 120.00 s, outputting every 60.00 s
322.8s 3241 
322.9s 3242 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
323.4s 3243 [WARNING] Automatic CFL correction applied (count: 18900):
323.4s 3244 Calculated CFL: 0.800 > Limit: 0.500
323.4s 3245 Original dt: 4.114988e-01 s
323.4s 3246 Corrected dt: 2.571867e-01 s
323.4s 3247 Correction factor: 1.6x
323.4s 3248 Max wave speed detected: 19.44 m/s
323.4s 3249 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
323.9s 3250 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
324.3s 3251 [WARNING] Automatic CFL correction applied (count: 19000):
324.3s 3252 Calculated CFL: 0.800 > Limit: 0.500
324.3s 3253 Original dt: 4.114980e-01 s
324.3s 3254 Corrected dt: 2.571863e-01 s
324.3s 3255 Correction factor: 1.6x
324.3s 3256 Max wave speed detected: 19.44 m/s
324.3s 3257 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
324.8s 3258 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
324.9s 3259 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
324.9s 3260 [A
324.9s 3261 Stored output at t = 120.0000 s (Step 465)
324.9s 3262 
324.9s 3263 Simulation finished at t = 120.0000 s after 465 steps.
324.9s 3264 Total runtime: 2.13 seconds.
324.9s 3265 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.11s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.11s/s]
324.9s 3266 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
324.9s 3267 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
324.9s 3268 Using device: gpu
324.9s 3269 DEBUG PARAMS: Reading K_m_kmh = 10.0
324.9s 3270 DEBUG PARAMS: Reading K_c_kmh = 15.0
324.9s 3271 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
324.9s 3272 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
324.9s 3273 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
324.9s 3274 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
324.9s 3275 Loading road quality type: uniform
324.9s 3276 Uniform road quality value: 2
324.9s 3277 Road quality loaded.
324.9s 3278 Initial state created.
324.9s 3279 Transferring initial state and road quality to GPU...
324.9s 3280 GPU data transfer complete.
324.9s 3281 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
324.9s 3282 Initial boundary conditions applied.
324.9s 3283 [BC UPDATE] left → phase 0 RED (reduced inflow)
324.9s 3284 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
324.9s 3285 [BC UPDATE] left → phase 1 GREEN (normal inflow)
324.9s 3286 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
324.9s 3287 Running simulation until t = 60.00 s, outputting every 60.00 s
324.9s 3288 
325.2s 3289 [WARNING] Automatic CFL correction applied (count: 19100):
325.2s 3290 Calculated CFL: 0.800 > Limit: 0.500
325.2s 3291 Original dt: 4.758816e-01 s
325.2s 3292 Corrected dt: 2.974260e-01 s
325.2s 3293 Correction factor: 1.6x
325.2s 3294 Max wave speed detected: 16.81 m/s
325.4s 3295 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
325.8s 3296 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
326.2s 3297 [WARNING] Automatic CFL correction applied (count: 19200):
326.2s 3298 Calculated CFL: 0.800 > Limit: 0.500
326.2s 3299 Original dt: 4.121510e-01 s
326.2s 3300 Corrected dt: 2.575944e-01 s
326.2s 3301 Correction factor: 1.6x
326.2s 3302 Max wave speed detected: 19.41 m/s
326.3s 3303 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
326.8s 3304 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
327.1s 3305 Stored output at t = 60.0000 s (Step 231)
327.1s 3306 
327.1s 3307 Simulation finished at t = 60.0000 s after 231 steps.
327.1s 3308 Total runtime: 2.14 seconds.
327.1s 3309 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
327.1s 3310 [A
327.1s 3311 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.04s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.04s/s]
327.1s 3312 [BC UPDATE] left → phase 0 RED (reduced inflow)
327.1s 3313 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
327.1s 3314 Running simulation until t = 120.00 s, outputting every 60.00 s
327.1s 3315 
327.1s 3316 [WARNING] Automatic CFL correction applied (count: 19300):
327.1s 3317 Calculated CFL: 0.800 > Limit: 0.500
327.1s 3318 Original dt: 4.115082e-01 s
327.1s 3319 Corrected dt: 2.571926e-01 s
327.1s 3320 Correction factor: 1.6x
327.1s 3321 Max wave speed detected: 19.44 m/s
327.2s 3322 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
327.7s 3323 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
328.0s 3324 [WARNING] Automatic CFL correction applied (count: 19400):
328.0s 3325 Calculated CFL: 0.800 > Limit: 0.500
328.0s 3326 Original dt: 4.114982e-01 s
328.0s 3327 Corrected dt: 2.571864e-01 s
328.0s 3328 Correction factor: 1.6x
328.0s 3329 Max wave speed detected: 19.44 m/s
328.2s 3330 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
328.6s 3331 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
328.9s 3332 [WARNING] Automatic CFL correction applied (count: 19500):
328.9s 3333 Calculated CFL: 0.800 > Limit: 0.500
328.9s 3334 Original dt: 4.114980e-01 s
328.9s 3335 Corrected dt: 2.571863e-01 s
328.9s 3336 Correction factor: 1.6x
328.9s 3337 Max wave speed detected: 19.44 m/s
329.1s 3338 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
329.2s 3339 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
329.2s 3340 [A
329.2s 3341 Stored output at t = 120.0000 s (Step 465)
329.2s 3342 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.61s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.61s/s]
329.2s 3343 
329.2s 3344 Simulation finished at t = 120.0000 s after 465 steps.
329.2s 3345 Total runtime: 2.17 seconds.
329.2s 3346 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
329.2s 3347 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
329.2s 3348 Using device: gpu
329.3s 3349 DEBUG PARAMS: Reading K_m_kmh = 10.0
329.3s 3350 DEBUG PARAMS: Reading K_c_kmh = 15.0
329.3s 3351 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
329.3s 3352 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
329.3s 3353 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
329.3s 3354 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
329.3s 3355 Loading road quality type: uniform
329.3s 3356 Uniform road quality value: 2
329.3s 3357 Road quality loaded.
329.3s 3358 Initial state created.
329.3s 3359 Transferring initial state and road quality to GPU...
329.3s 3360 GPU data transfer complete.
329.3s 3361 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
329.3s 3362 Initial boundary conditions applied.
329.3s 3363 [BC UPDATE] left → phase 0 RED (reduced inflow)
329.3s 3364 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
329.3s 3365 Running simulation until t = 60.00 s, outputting every 60.00 s
329.3s 3366 
329.7s 3367 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
329.9s 3368 [WARNING] Automatic CFL correction applied (count: 19600):
329.9s 3369 Calculated CFL: 0.800 > Limit: 0.500
329.9s 3370 Original dt: 4.225636e-01 s
329.9s 3371 Corrected dt: 2.641023e-01 s
329.9s 3372 Correction factor: 1.6x
329.9s 3373 Max wave speed detected: 18.93 m/s
330.2s 3374 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
330.7s 3375 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
330.9s 3376 [WARNING] Automatic CFL correction applied (count: 19700):
330.9s 3377 Calculated CFL: 0.800 > Limit: 0.500
330.9s 3378 Original dt: 4.116395e-01 s
330.9s 3379 Corrected dt: 2.572747e-01 s
330.9s 3380 Correction factor: 1.6x
330.9s 3381 Max wave speed detected: 19.43 m/s
331.1s 3382 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
331.4s 3383 Stored output at t = 60.0000 s (Step 231)
331.4s 3384 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
331.4s 3385 [A
331.4s 3386 
331.4s 3387 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.44s/s]
331.4s 3388 Simulation finished at t = 60.0000 s after 231 steps.
331.4s 3389 Total runtime: 2.19 seconds.
331.4s 3390 [BC UPDATE] left → phase 1 GREEN (normal inflow)
331.4s 3391 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
331.4s 3392 Running simulation until t = 120.00 s, outputting every 60.00 s
331.4s 3393 
331.7s 3394 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
331.8s 3395 [WARNING] Automatic CFL correction applied (count: 19800):
331.8s 3396 Calculated CFL: 0.800 > Limit: 0.500
331.8s 3397 Original dt: 4.115005e-01 s
331.8s 3398 Corrected dt: 2.571878e-01 s
331.8s 3399 Correction factor: 1.6x
331.8s 3400 Max wave speed detected: 19.44 m/s
332.1s 3401 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
332.6s 3402 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
332.8s 3403 [WARNING] Automatic CFL correction applied (count: 19900):
332.8s 3404 Calculated CFL: 0.800 > Limit: 0.500
332.8s 3405 Original dt: 4.114981e-01 s
332.8s 3406 Corrected dt: 2.571863e-01 s
332.8s 3407 Correction factor: 1.6x
332.8s 3408 Max wave speed detected: 19.44 m/s
333.1s 3409 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
333.5s 3410 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
333.7s 3411 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
333.7s 3412 [A
333.7s 3413 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.86s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.86s/s]
333.7s 3414 Stored output at t = 120.0000 s (Step 465)
333.7s 3415 
333.7s 3416 Simulation finished at t = 120.0000 s after 465 steps.
333.7s 3417 Total runtime: 2.23 seconds.
333.7s 3418 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
333.7s 3419 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
333.7s 3420 Using device: gpu
333.7s 3421 DEBUG PARAMS: Reading K_m_kmh = 10.0
333.7s 3422 DEBUG PARAMS: Reading K_c_kmh = 15.0
333.7s 3423 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
333.7s 3424 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
333.7s 3425 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
333.7s 3426 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
333.7s 3427 Loading road quality type: uniform
333.7s 3428 Uniform road quality value: 2
333.7s 3429 Road quality loaded.
333.7s 3430 Initial state created.
333.7s 3431 Transferring initial state and road quality to GPU...
333.7s 3432 GPU data transfer complete.
333.7s 3433 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
333.7s 3434 Initial boundary conditions applied.
333.7s 3435 [BC UPDATE] left → phase 0 RED (reduced inflow)
333.7s 3436 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
333.7s 3437 [BC UPDATE] left → phase 1 GREEN (normal inflow)
333.7s 3438 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
333.7s 3439 Running simulation until t = 60.00 s, outputting every 60.00 s
333.7s 3440 
333.7s 3441 [WARNING] Automatic CFL correction applied (count: 20000):
333.7s 3442 Calculated CFL: 0.800 > Limit: 0.500
333.7s 3443 Original dt: 3.451280e-01 s
333.7s 3444 Corrected dt: 2.157050e-01 s
333.7s 3445 Correction factor: 1.6x
333.7s 3446 Max wave speed detected: 23.18 m/s
334.2s 3447 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
334.6s 3448 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
334.7s 3449 [WARNING] Automatic CFL correction applied (count: 20100):
334.7s 3450 Calculated CFL: 0.800 > Limit: 0.500
334.7s 3451 Original dt: 4.139892e-01 s
334.7s 3452 Corrected dt: 2.587433e-01 s
334.7s 3453 Correction factor: 1.6x
334.7s 3454 Max wave speed detected: 19.32 m/s
335.1s 3455 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
335.6s 3456 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
335.6s 3457 [WARNING] Automatic CFL correction applied (count: 20200):
335.6s 3458 Calculated CFL: 0.800 > Limit: 0.500
335.6s 3459 Original dt: 4.115314e-01 s
335.6s 3460 Corrected dt: 2.572071e-01 s
335.6s 3461 Correction factor: 1.6x
335.6s 3462 Max wave speed detected: 19.44 m/s
335.9s 3463 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
335.9s 3464 [A
335.9s 3465 Stored output at t = 60.0000 s (Step 231)
335.9s 3466 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.78s/s]
335.9s 3467 
335.9s 3468 Simulation finished at t = 60.0000 s after 231 steps.
335.9s 3469 Total runtime: 2.16 seconds.
335.9s 3470 Running simulation until t = 120.00 s, outputting every 60.00 s
335.9s 3471 
336.0s 3472 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
336.5s 3473 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
336.5s 3474 [WARNING] Automatic CFL correction applied (count: 20300):
336.5s 3475 Calculated CFL: 0.800 > Limit: 0.500
336.5s 3476 Original dt: 4.114986e-01 s
336.5s 3477 Corrected dt: 2.571866e-01 s
336.5s 3478 Correction factor: 1.6x
336.5s 3479 Max wave speed detected: 19.44 m/s
337.0s 3480 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
337.4s 3481 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
337.5s 3482 [WARNING] Automatic CFL correction applied (count: 20400):
337.5s 3483 Calculated CFL: 0.800 > Limit: 0.500
337.5s 3484 Original dt: 4.114980e-01 s
337.5s 3485 Corrected dt: 2.571863e-01 s
337.5s 3486 Correction factor: 1.6x
337.5s 3487 Max wave speed detected: 19.44 m/s
337.9s 3488 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
338.0s 3489 Stored output at t = 120.0000 s (Step 465)
338.0s 3490 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
338.0s 3491 [A
338.0s 3492 
338.0s 3493 Simulation finished at t = 120.0000 s after 465 steps.
338.0s 3494 Total runtime: 2.18 seconds.
338.0s 3495 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.47s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.47s/s]
338.0s 3496 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
338.0s 3497 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
338.0s 3498 Using device: gpu
338.1s 3499 DEBUG PARAMS: Reading K_m_kmh = 10.0
338.1s 3500 DEBUG PARAMS: Reading K_c_kmh = 15.0
338.1s 3501 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
338.1s 3502 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
338.1s 3503 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
338.1s 3504 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
338.1s 3505 Loading road quality type: uniform
338.1s 3506 Uniform road quality value: 2
338.1s 3507 Road quality loaded.
338.1s 3508 Initial state created.
338.1s 3509 Transferring initial state and road quality to GPU...
338.1s 3510 GPU data transfer complete.
338.1s 3511 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
338.1s 3512 Initial boundary conditions applied.
338.1s 3513 [BC UPDATE] left → phase 0 RED (reduced inflow)
338.1s 3514 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
338.1s 3515 [BC UPDATE] left → phase 1 GREEN (normal inflow)
338.1s 3516 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
338.1s 3517 Running simulation until t = 60.00 s, outputting every 60.00 s
338.1s 3518 
338.4s 3519 [WARNING] Automatic CFL correction applied (count: 20500):
338.4s 3520 Calculated CFL: 0.800 > Limit: 0.500
338.4s 3521 Original dt: 4.583403e-01 s
338.4s 3522 Corrected dt: 2.864627e-01 s
338.4s 3523 Correction factor: 1.6x
338.4s 3524 Max wave speed detected: 17.45 m/s
338.5s 3525 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
339.0s 3526 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
339.4s 3527 [WARNING] Automatic CFL correction applied (count: 20600):
339.4s 3528 Calculated CFL: 0.800 > Limit: 0.500
339.4s 3529 Original dt: 4.120137e-01 s
339.4s 3530 Corrected dt: 2.575085e-01 s
339.4s 3531 Correction factor: 1.6x
339.4s 3532 Max wave speed detected: 19.42 m/s
339.5s 3533 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
339.9s 3534 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
340.2s 3535 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
340.2s 3536 [A
340.2s 3537 Stored output at t = 60.0000 s (Step 231)
340.2s 3538 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.81s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.81s/s]
340.2s 3539 
340.2s 3540 Simulation finished at t = 60.0000 s after 231 steps.
340.2s 3541 Total runtime: 2.16 seconds.
340.2s 3542 [BC UPDATE] left → phase 0 RED (reduced inflow)
340.2s 3543 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
340.2s 3544 Running simulation until t = 120.00 s, outputting every 60.00 s
340.2s 3545 
340.3s 3546 [WARNING] Automatic CFL correction applied (count: 20700):
340.3s 3547 Calculated CFL: 0.800 > Limit: 0.500
340.3s 3548 Original dt: 4.115064e-01 s
340.3s 3549 Corrected dt: 2.571915e-01 s
340.3s 3550 Correction factor: 1.6x
340.3s 3551 Max wave speed detected: 19.44 m/s
340.4s 3552 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
340.9s 3553 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
341.2s 3554 [WARNING] Automatic CFL correction applied (count: 20800):
341.2s 3555 Calculated CFL: 0.800 > Limit: 0.500
341.2s 3556 Original dt: 4.114982e-01 s
341.2s 3557 Corrected dt: 2.571864e-01 s
341.2s 3558 Correction factor: 1.6x
341.2s 3559 Max wave speed detected: 19.44 m/s
341.4s 3560 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
341.8s 3561 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
342.2s 3562 [WARNING] Automatic CFL correction applied (count: 20900):
342.2s 3563 Calculated CFL: 0.800 > Limit: 0.500
342.2s 3564 Original dt: 4.114980e-01 s
342.2s 3565 Corrected dt: 2.571863e-01 s
342.2s 3566 Correction factor: 1.6x
342.2s 3567 Max wave speed detected: 19.44 m/s
342.3s 3568 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
342.5s 3569 Stored output at t = 120.0000 s (Step 465)
342.5s 3570 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
342.5s 3571 [A
342.5s 3572 
342.5s 3573 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.90s/s]
342.5s 3574 Simulation finished at t = 120.0000 s after 465 steps.
342.5s 3575 Total runtime: 2.23 seconds.
342.5s 3576 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
342.5s 3577 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
342.5s 3578 Using device: gpu
342.5s 3579 DEBUG PARAMS: Reading K_m_kmh = 10.0
342.5s 3580 DEBUG PARAMS: Reading K_c_kmh = 15.0
342.5s 3581 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
342.5s 3582 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
342.5s 3583 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
342.5s 3584 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
342.5s 3585 Loading road quality type: uniform
342.5s 3586 Uniform road quality value: 2
342.5s 3587 Road quality loaded.
342.5s 3588 Initial state created.
342.5s 3589 Transferring initial state and road quality to GPU...
342.5s 3590 GPU data transfer complete.
342.5s 3591 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
342.5s 3592 Initial boundary conditions applied.
342.5s 3593 [BC UPDATE] left → phase 0 RED (reduced inflow)
342.5s 3594 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
342.5s 3595 Running simulation until t = 60.00 s, outputting every 60.00 s
342.5s 3596 
342.9s 3597 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
343.2s 3598 [WARNING] Automatic CFL correction applied (count: 21000):
343.2s 3599 Calculated CFL: 0.800 > Limit: 0.500
343.2s 3600 Original dt: 4.205139e-01 s
343.2s 3601 Corrected dt: 2.628212e-01 s
343.2s 3602 Correction factor: 1.6x
343.2s 3603 Max wave speed detected: 19.02 m/s
343.4s 3604 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
343.9s 3605 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
344.1s 3606 [WARNING] Automatic CFL correction applied (count: 21100):
344.1s 3607 Calculated CFL: 0.800 > Limit: 0.500
344.1s 3608 Original dt: 4.116141e-01 s
344.1s 3609 Corrected dt: 2.572588e-01 s
344.1s 3610 Correction factor: 1.6x
344.1s 3611 Max wave speed detected: 19.44 m/s
344.3s 3612 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
344.6s 3613 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
344.6s 3614 [A
344.6s 3615 Stored output at t = 60.0000 s (Step 231)
344.6s 3616 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.00s/s]
344.6s 3617 
344.6s 3618 Simulation finished at t = 60.0000 s after 231 steps.
344.6s 3619 Total runtime: 2.14 seconds.
344.6s 3620 [BC UPDATE] left → phase 1 GREEN (normal inflow)
344.6s 3621 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
344.6s 3622 Running simulation until t = 120.00 s, outputting every 60.00 s
344.6s 3623 
344.8s 3624 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
345.0s 3625 [WARNING] Automatic CFL correction applied (count: 21200):
345.0s 3626 Calculated CFL: 0.800 > Limit: 0.500
345.0s 3627 Original dt: 4.115000e-01 s
345.0s 3628 Corrected dt: 2.571875e-01 s
345.0s 3629 Correction factor: 1.6x
345.0s 3630 Max wave speed detected: 19.44 m/s
345.3s 3631 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
345.7s 3632 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
346.0s 3633 [WARNING] Automatic CFL correction applied (count: 21300):
346.0s 3634 Calculated CFL: 0.800 > Limit: 0.500
346.0s 3635 Original dt: 4.114981e-01 s
346.0s 3636 Corrected dt: 2.571863e-01 s
346.0s 3637 Correction factor: 1.6x
346.0s 3638 Max wave speed detected: 19.44 m/s
346.2s 3639 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
346.7s 3640 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
346.8s 3641 Stored output at t = 120.0000 s (Step 465)
346.8s 3642 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
346.8s 3643 [A
346.8s 3644 
346.8s 3645 Simulation finished at t = 120.0000 s after 465 steps.
346.8s 3646 Total runtime: 2.21 seconds.
346.8s 3647 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.14s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.14s/s]
346.8s 3648 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
346.8s 3649 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.8s 3650 Using device: gpu
346.8s 3651 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.8s 3652 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.8s 3653 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.8s 3654 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.8s 3655 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.8s 3656 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.8s 3657 Loading road quality type: uniform
346.8s 3658 Uniform road quality value: 2
346.8s 3659 Road quality loaded.
346.8s 3660 Initial state created.
346.8s 3661 Transferring initial state and road quality to GPU...
346.8s 3662 GPU data transfer complete.
346.8s 3663 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.8s 3664 Initial boundary conditions applied.
346.8s 3665 [BC UPDATE] left → phase 0 RED (reduced inflow)
346.8s 3666 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
346.8s 3667 Running simulation until t = 60.00 s, outputting every 60.00 s
346.8s 3668 
346.9s 3669 [WARNING] Automatic CFL correction applied (count: 21400):
346.9s 3670 Calculated CFL: 0.800 > Limit: 0.500
346.9s 3671 Original dt: 3.737254e-01 s
346.9s 3672 Corrected dt: 2.335784e-01 s
346.9s 3673 Correction factor: 1.6x
346.9s 3674 Max wave speed detected: 21.41 m/s
347.3s 3675 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
347.8s 3676 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
347.9s 3677 [WARNING] Automatic CFL correction applied (count: 21500):
347.9s 3678 Calculated CFL: 0.800 > Limit: 0.500
347.9s 3679 Original dt: 4.134305e-01 s
347.9s 3680 Corrected dt: 2.583941e-01 s
347.9s 3681 Correction factor: 1.6x
347.9s 3682 Max wave speed detected: 19.35 m/s
348.2s 3683 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
348.7s 3684 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
348.8s 3685 [WARNING] Automatic CFL correction applied (count: 21600):
348.8s 3686 Calculated CFL: 0.800 > Limit: 0.500
348.8s 3687 Original dt: 4.115259e-01 s
348.8s 3688 Corrected dt: 2.572037e-01 s
348.8s 3689 Correction factor: 1.6x
348.8s 3690 Max wave speed detected: 19.44 m/s
349.0s 3691 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
349.0s 3692 [A
349.0s 3693 Stored output at t = 60.0000 s (Step 231)
349.0s 3694 
349.0s 3695 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.18s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.17s/s]
349.0s 3696 Simulation finished at t = 60.0000 s after 231 steps.
349.0s 3697 Total runtime: 2.13 seconds.
349.0s 3698 [BC UPDATE] left → phase 1 GREEN (normal inflow)
349.0s 3699 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
349.0s 3700 Running simulation until t = 120.00 s, outputting every 60.00 s
349.0s 3701 
349.1s 3702 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
349.6s 3703 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
349.7s 3704 [WARNING] Automatic CFL correction applied (count: 21700):
349.7s 3705 Calculated CFL: 0.800 > Limit: 0.500
349.7s 3706 Original dt: 4.114985e-01 s
349.7s 3707 Corrected dt: 2.571866e-01 s
349.7s 3708 Correction factor: 1.6x
349.7s 3709 Max wave speed detected: 19.44 m/s
350.1s 3710 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
350.5s 3711 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
350.6s 3712 [WARNING] Automatic CFL correction applied (count: 21800):
350.6s 3713 Calculated CFL: 0.800 > Limit: 0.500
350.6s 3714 Original dt: 4.114980e-01 s
350.6s 3715 Corrected dt: 2.571863e-01 s
350.6s 3716 Correction factor: 1.6x
350.6s 3717 Max wave speed detected: 19.44 m/s
351.0s 3718 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
351.1s 3719 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
351.1s 3720 [A
351.1s 3721 Stored output at t = 120.0000 s (Step 465)
351.1s 3722 
351.1s 3723 Simulation finished at t = 120.0000 s after 465 steps.
351.1s 3724 Total runtime: 2.13 seconds.
351.1s 3725 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.20s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.20s/s]
351.1s 3726 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
351.1s 3727 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
351.1s 3728 Using device: gpu
351.1s 3729 DEBUG PARAMS: Reading K_m_kmh = 10.0
351.1s 3730 DEBUG PARAMS: Reading K_c_kmh = 15.0
351.1s 3731 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
351.1s 3732 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
351.1s 3733 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
351.1s 3734 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
351.1s 3735 Loading road quality type: uniform
351.1s 3736 Uniform road quality value: 2
351.1s 3737 Road quality loaded.
351.1s 3738 Initial state created.
351.1s 3739 Transferring initial state and road quality to GPU...
351.1s 3740 GPU data transfer complete.
351.1s 3741 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
351.1s 3742 Initial boundary conditions applied.
351.1s 3743 [BC UPDATE] left → phase 0 RED (reduced inflow)
351.1s 3744 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
351.1s 3745 
351.1s 3746 Running simulation until t = 60.00 s, outputting every 60.00 s
351.6s 3747 [WARNING] Automatic CFL correction applied (count: 21900):
351.6s 3748 Calculated CFL: 0.800 > Limit: 0.500
351.6s 3749 Original dt: 4.470525e-01 s
351.6s 3750 Corrected dt: 2.794078e-01 s
351.6s 3751 Correction factor: 1.6x
351.6s 3752 Max wave speed detected: 17.89 m/s
351.6s 3753 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
352.1s 3754 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
352.5s 3755 [WARNING] Automatic CFL correction applied (count: 22000):
352.5s 3756 Calculated CFL: 0.800 > Limit: 0.500
352.5s 3757 Original dt: 4.119130e-01 s
352.5s 3758 Corrected dt: 2.574456e-01 s
352.5s 3759 Correction factor: 1.6x
352.5s 3760 Max wave speed detected: 19.42 m/s
352.5s 3761 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
353.0s 3762 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
353.2s 3763 Stored output at t = 60.0000 s (Step 231)
353.2s 3764 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
353.2s 3765 [A
353.2s 3766 
353.2s 3767 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.26s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.26s/s]
353.2s 3768 Simulation finished at t = 60.0000 s after 231 steps.
353.2s 3769 Total runtime: 2.12 seconds.
353.2s 3770 [BC UPDATE] left → phase 1 GREEN (normal inflow)
353.2s 3771 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
353.2s 3772 Running simulation until t = 120.00 s, outputting every 60.00 s
353.2s 3773 
353.4s 3774 [WARNING] Automatic CFL correction applied (count: 22100):
353.4s 3775 Calculated CFL: 0.800 > Limit: 0.500
353.4s 3776 Original dt: 4.115046e-01 s
353.4s 3777 Corrected dt: 2.571904e-01 s
353.4s 3778 Correction factor: 1.6x
353.4s 3779 Max wave speed detected: 19.44 m/s
353.4s 3780 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
353.9s 3781 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
354.3s 3782 [WARNING] Automatic CFL correction applied (count: 22200):
354.3s 3783 Calculated CFL: 0.800 > Limit: 0.500
354.3s 3784 Original dt: 4.114982e-01 s
354.3s 3785 Corrected dt: 2.571863e-01 s
354.3s 3786 Correction factor: 1.6x
354.3s 3787 Max wave speed detected: 19.44 m/s
354.4s 3788 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
354.9s 3789 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
355.2s 3790 [WARNING] Automatic CFL correction applied (count: 22300):
355.2s 3791 Calculated CFL: 0.800 > Limit: 0.500
355.2s 3792 Original dt: 4.114980e-01 s
355.2s 3793 Corrected dt: 2.571863e-01 s
355.2s 3794 Correction factor: 1.6x
355.2s 3795 Max wave speed detected: 19.44 m/s
355.3s 3796 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
355.4s 3797 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
355.4s 3798 [A
355.4s 3799 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.43s/s]
355.4s 3800 Stored output at t = 120.0000 s (Step 465)
355.4s 3801 
355.4s 3802 Simulation finished at t = 120.0000 s after 465 steps.
355.4s 3803 Total runtime: 2.19 seconds.
355.4s 3804 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
355.4s 3805 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
355.4s 3806 Using device: gpu
355.4s 3807 DEBUG PARAMS: Reading K_m_kmh = 10.0
355.4s 3808 DEBUG PARAMS: Reading K_c_kmh = 15.0
355.4s 3809 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
355.4s 3810 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
355.4s 3811 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
355.4s 3812 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
355.4s 3813 Loading road quality type: uniform
355.4s 3814 Uniform road quality value: 2
355.4s 3815 Road quality loaded.
355.4s 3816 Initial state created.
355.4s 3817 Transferring initial state and road quality to GPU...
355.4s 3818 GPU data transfer complete.
355.4s 3819 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
355.4s 3820 Initial boundary conditions applied.
355.4s 3821 [BC UPDATE] left → phase 0 RED (reduced inflow)
355.4s 3822 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
355.4s 3823 Running simulation until t = 60.00 s, outputting every 60.00 s
355.4s 3824 
355.9s 3825 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
356.2s 3826 [WARNING] Automatic CFL correction applied (count: 22400):
356.2s 3827 Calculated CFL: 0.800 > Limit: 0.500
356.2s 3828 Original dt: 4.190346e-01 s
356.2s 3829 Corrected dt: 2.618967e-01 s
356.2s 3830 Correction factor: 1.6x
356.2s 3831 Max wave speed detected: 19.09 m/s
356.4s 3832 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
356.8s 3833 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
357.1s 3834 [WARNING] Automatic CFL correction applied (count: 22500):
357.1s 3835 Calculated CFL: 0.800 > Limit: 0.500
357.1s 3836 Original dt: 4.115954e-01 s
357.1s 3837 Corrected dt: 2.572472e-01 s
357.1s 3838 Correction factor: 1.6x
357.1s 3839 Max wave speed detected: 19.44 m/s
357.3s 3840 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
357.5s 3841 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
357.5s 3842 [A
357.5s 3843 Stored output at t = 60.0000 s (Step 231)
357.5s 3844 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.75s/s]
357.5s 3845 
357.5s 3846 Simulation finished at t = 60.0000 s after 231 steps.
357.5s 3847 Total runtime: 2.09 seconds.
357.5s 3848 [BC UPDATE] left → phase 1 GREEN (normal inflow)
357.5s 3849 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
357.5s 3850 Running simulation until t = 120.00 s, outputting every 60.00 s
357.5s 3851 
357.7s 3852 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
358.0s 3853 [WARNING] Automatic CFL correction applied (count: 22600):
358.0s 3854 Calculated CFL: 0.800 > Limit: 0.500
358.0s 3855 Original dt: 4.114996e-01 s
358.0s 3856 Corrected dt: 2.571873e-01 s
358.0s 3857 Correction factor: 1.6x
358.0s 3858 Max wave speed detected: 19.44 m/s
358.2s 3859 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
358.6s 3860 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
358.9s 3861 [WARNING] Automatic CFL correction applied (count: 22700):
358.9s 3862 Calculated CFL: 0.800 > Limit: 0.500
358.9s 3863 Original dt: 4.114981e-01 s
358.9s 3864 Corrected dt: 2.571863e-01 s
358.9s 3865 Correction factor: 1.6x
358.9s 3866 Max wave speed detected: 19.44 m/s
359.1s 3867 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
359.5s 3868 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
359.6s 3869 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
359.6s 3870 [A
359.6s 3871 Stored output at t = 120.0000 s (Step 465)
359.6s 3872 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.44s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s]
359.6s 3873 
359.6s 3874 Simulation finished at t = 120.0000 s after 465 steps.
359.6s 3875 Total runtime: 2.11 seconds.
359.7s 3876 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
359.7s 3877 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
359.7s 3878 Using device: gpu
359.7s 3879 DEBUG PARAMS: Reading K_m_kmh = 10.0
359.7s 3880 DEBUG PARAMS: Reading K_c_kmh = 15.0
359.7s 3881 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
359.7s 3882 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
359.7s 3883 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
359.7s 3884 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
359.7s 3885 Loading road quality type: uniform
359.7s 3886 Uniform road quality value: 2
359.7s 3887 Road quality loaded.
359.7s 3888 Initial state created.
359.7s 3889 Transferring initial state and road quality to GPU...
359.7s 3890 GPU data transfer complete.
359.7s 3891 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
359.7s 3892 Initial boundary conditions applied.
359.7s 3893 [BC UPDATE] left → phase 0 RED (reduced inflow)
359.7s 3894 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
359.7s 3895 Running simulation until t = 60.00 s, outputting every 60.00 s
359.7s 3896 
359.8s 3897 [WARNING] Automatic CFL correction applied (count: 22800):
359.8s 3898 Calculated CFL: 0.800 > Limit: 0.500
359.8s 3899 Original dt: 4.022422e-01 s
359.8s 3900 Corrected dt: 2.514014e-01 s
359.8s 3901 Correction factor: 1.6x
359.8s 3902 Max wave speed detected: 19.89 m/s
360.1s 3903 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
360.6s 3904 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
360.7s 3905 [WARNING] Automatic CFL correction applied (count: 22900):
360.7s 3906 Calculated CFL: 0.800 > Limit: 0.500
360.7s 3907 Original dt: 4.130229e-01 s
360.7s 3908 Corrected dt: 2.581393e-01 s
360.7s 3909 Correction factor: 1.6x
360.7s 3910 Max wave speed detected: 19.37 m/s
361.0s 3911 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
361.5s 3912 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
361.7s 3913 [WARNING] Automatic CFL correction applied (count: 23000):
361.7s 3914 Calculated CFL: 0.800 > Limit: 0.500
361.7s 3915 Original dt: 4.115198e-01 s
361.7s 3916 Corrected dt: 2.571999e-01 s
361.7s 3917 Correction factor: 1.6x
361.7s 3918 Max wave speed detected: 19.44 m/s
361.8s 3919 Stored output at t = 60.0000 s (Step 231)
361.8s 3920 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
361.8s 3921 [A
361.8s 3922 
361.8s 3923 Simulation finished at t = 60.0000 s after 231 steps.
361.8s 3924 Total runtime: 2.15 seconds.
361.8s 3925 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.94s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.93s/s]
361.8s 3926 [BC UPDATE] left → phase 1 GREEN (normal inflow)
361.8s 3927 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
361.8s 3928 Running simulation until t = 120.00 s, outputting every 60.00 s
361.8s 3929 
362.0s 3930 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
362.4s 3931 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
362.6s 3932 [WARNING] Automatic CFL correction applied (count: 23100):
362.6s 3933 Calculated CFL: 0.800 > Limit: 0.500
362.6s 3934 Original dt: 4.114984e-01 s
362.6s 3935 Corrected dt: 2.571865e-01 s
362.6s 3936 Correction factor: 1.6x
362.6s 3937 Max wave speed detected: 19.44 m/s
362.9s 3938 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
363.3s 3939 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
363.5s 3940 [WARNING] Automatic CFL correction applied (count: 23200):
363.5s 3941 Calculated CFL: 0.800 > Limit: 0.500
363.5s 3942 Original dt: 4.114980e-01 s
363.5s 3943 Corrected dt: 2.571863e-01 s
363.5s 3944 Correction factor: 1.6x
363.5s 3945 Max wave speed detected: 19.44 m/s
363.8s 3946 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
363.9s 3947 Stored output at t = 120.0000 s (Step 465)
363.9s 3948 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
363.9s 3949 [A
363.9s 3950 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s]
363.9s 3951 
363.9s 3952 Simulation finished at t = 120.0000 s after 465 steps.
363.9s 3953 Total runtime: 2.12 seconds.
363.9s 3954 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
363.9s 3955 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
363.9s 3956 Using device: gpu
363.9s 3957 DEBUG PARAMS: Reading K_m_kmh = 10.0
363.9s 3958 DEBUG PARAMS: Reading K_c_kmh = 15.0
363.9s 3959 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
363.9s 3960 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
363.9s 3961 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
363.9s 3962 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
363.9s 3963 Loading road quality type: uniform
363.9s 3964 Uniform road quality value: 2
363.9s 3965 Road quality loaded.
363.9s 3966 Initial state created.
363.9s 3967 Transferring initial state and road quality to GPU...
363.9s 3968 GPU data transfer complete.
363.9s 3969 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
363.9s 3970 Initial boundary conditions applied.
363.9s 3971 [BC UPDATE] left → phase 0 RED (reduced inflow)
363.9s 3972 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
364.0s 3973 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.4 steps/s
364.0s 3974 ---------------------------------
364.0s 3975 | rollout/           |          |
364.0s 3976 |    ep_len_mean     | 2        |
364.0s 3977 |    ep_rew_mean     | -0.0796  |
364.0s 3978 | time/              |          |
364.0s 3979 |    fps             | 0        |
364.0s 3980 |    iterations      | 1        |
364.0s 3981 |    time_elapsed    | 224      |
364.0s 3982 |    total_timesteps | 100      |
364.0s 3983 ---------------------------------
364.6s 3984 
364.6s 3985 ✅ Training completed in 3.8 minutes (225.5s)
364.6s 3986 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:44 < 0:00:00 , 0 it/s ]
364.6s 3987 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
364.6s 3988 
364.6s 3989 [PHASE 2/2] Running performance comparisons...
364.6s 3990 [QUICK TEST] Testing only: traffic_light_control
364.6s 3991 
364.6s 3992 Testing scenario: traffic_light_control (device=gpu)
364.6s 3993 2025-10-10 12:08:17 - INFO - run_performance_comparison:698 - ================================================================================
364.6s 3994 2025-10-10 12:08:17 - INFO - run_performance_comparison:699 - Starting run_performance_comparison for scenario: traffic_light_control
364.6s 3995 2025-10-10 12:08:17 - INFO - run_performance_comparison:700 - Device: gpu
364.6s 3996 2025-10-10 12:08:17 - INFO - run_performance_comparison:701 - ================================================================================
364.6s 3997 2025-10-10 12:08:17 - INFO - run_performance_comparison:702 - ================================================================================
364.6s 3998 2025-10-10 12:08:17 - INFO - run_performance_comparison:703 - Starting run_performance_comparison for scenario: traffic_light_control
364.6s 3999 2025-10-10 12:08:17 - INFO - run_performance_comparison:704 - Device: gpu
364.6s 4000 2025-10-10 12:08:17 - INFO - run_performance_comparison:705 - ================================================================================
364.6s 4001 2025-10-10 12:08:17 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
364.6s 4002 2025-10-10 12:08:17 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
364.6s 4003 2025-10-10 12:08:17 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
364.6s 4004 2025-10-10 12:08:17 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
364.6s 4005 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
364.6s 4006 Running baseline controller...
364.6s 4007 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
364.6s 4008 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
364.6s 4009 2025-10-10 12:08:17 - INFO - run_control_simulation:286 - ================================================================================
364.6s 4010 2025-10-10 12:08:17 - INFO - run_control_simulation:287 - Starting run_control_simulation:
364.6s 4011 2025-10-10 12:08:17 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
364.6s 4012 2025-10-10 12:08:17 - INFO - run_control_simulation:289 -   - duration: 600.0s
364.6s 4013 2025-10-10 12:08:17 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
364.6s 4014 2025-10-10 12:08:17 - INFO - run_control_simulation:291 -   - device: gpu
364.6s 4015 2025-10-10 12:08:17 - INFO - run_control_simulation:292 -   - controller: BaselineController
364.6s 4016 2025-10-10 12:08:17 - INFO - run_control_simulation:293 -   - max_control_steps: 11
364.6s 4017 2025-10-10 12:08:17 - INFO - run_control_simulation:294 - ================================================================================
364.6s 4018 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
364.6s 4019 2025-10-10 12:08:17 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
364.6s 4020 DEBUG PARAMS: Reading K_m_kmh = 10.0
364.6s 4021 DEBUG PARAMS: Reading K_c_kmh = 15.0
364.6s 4022 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
364.6s 4023 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
364.6s 4024 2025-10-10 12:08:17 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
364.6s 4025 2025-10-10 12:08:17 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
364.6s 4026 [INFO] Calling env.reset()...
364.6s 4027 2025-10-10 12:08:17 - INFO - run_control_simulation:329 - Calling env.reset()...
364.6s 4028 DEBUG PARAMS: Reading K_m_kmh = 10.0
364.6s 4029 DEBUG PARAMS: Reading K_c_kmh = 15.0
364.6s 4030 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
364.6s 4031 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
364.6s 4032 2025-10-10 12:08:17 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
364.6s 4033 2025-10-10 12:08:17 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
364.6s 4034 2025-10-10 12:08:17 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
364.6s 4035 [INFO] Starting simulation loop (max 11 control steps)
364.6s 4036 2025-10-10 12:08:17 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
364.6s 4037 2025-10-10 12:08:17 - INFO - run_control_simulation:366 - ================================================================================
364.6s 4038 2025-10-10 12:08:17 - INFO - run_control_simulation:367 - STEP 0 START:
364.6s 4039 2025-10-10 12:08:17 - INFO - run_control_simulation:368 -   Controller: BaselineController
364.6s 4040 2025-10-10 12:08:17 - INFO - run_control_simulation:369 -   Action: 1.000000
364.6s 4041 2025-10-10 12:08:17 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
365.1s 4042 [WARNING] Automatic CFL correction applied (count: 23300):
365.1s 4043 Calculated CFL: 0.800 > Limit: 0.500
365.1s 4044 Original dt: 4.396418e-01 s
365.1s 4045 Corrected dt: 2.747761e-01 s
365.1s 4046 Correction factor: 1.6x
365.1s 4047 Max wave speed detected: 18.20 m/s
366.0s 4048 [WARNING] Automatic CFL correction applied (count: 23400):
366.0s 4049 Calculated CFL: 0.800 > Limit: 0.500
366.0s 4050 Original dt: 4.118393e-01 s
366.0s 4051 Corrected dt: 2.573996e-01 s
366.0s 4052 Correction factor: 1.6x
366.0s 4053 Max wave speed detected: 19.43 m/s
366.8s 4054 2025-10-10 12:08:19 - INFO - run_control_simulation:382 -   Reward: -0.084799
366.8s 4055 2025-10-10 12:08:19 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
366.8s 4056 2025-10-10 12:08:19 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
366.8s 4057 2025-10-10 12:08:19 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
366.8s 4058 2025-10-10 12:08:19 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
366.8s 4059 2025-10-10 12:08:19 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.036794, rho_c=0.049919
366.8s 4060 2025-10-10 12:08:19 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.406686, w_c=11.325496
366.8s 4061 2025-10-10 12:08:19 - INFO - run_control_simulation:416 -   State hash: 543979149478343729
366.8s 4062 2025-10-10 12:08:19 - INFO - run_control_simulation:418 - ================================================================================
366.8s 4063 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
366.8s 4064 2025-10-10 12:08:19 - INFO - run_control_simulation:366 - ================================================================================
366.8s 4065 2025-10-10 12:08:19 - INFO - run_control_simulation:367 - STEP 1 START:
366.8s 4066 2025-10-10 12:08:19 - INFO - run_control_simulation:368 -   Controller: BaselineController
366.8s 4067 2025-10-10 12:08:19 - INFO - run_control_simulation:369 -   Action: 0.000000
366.8s 4068 2025-10-10 12:08:19 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
367.0s 4069 [WARNING] Automatic CFL correction applied (count: 23500):
367.0s 4070 Calculated CFL: 0.800 > Limit: 0.500
367.0s 4071 Original dt: 4.115033e-01 s
367.0s 4072 Corrected dt: 2.571896e-01 s
367.0s 4073 Correction factor: 1.6x
367.0s 4074 Max wave speed detected: 19.44 m/s
367.9s 4075 [WARNING] Automatic CFL correction applied (count: 23600):
367.9s 4076 Calculated CFL: 0.800 > Limit: 0.500
367.9s 4077 Original dt: 4.114981e-01 s
367.9s 4078 Corrected dt: 2.571863e-01 s
367.9s 4079 Correction factor: 1.6x
367.9s 4080 Max wave speed detected: 19.44 m/s
368.8s 4081 [WARNING] Automatic CFL correction applied (count: 23700):
368.8s 4082 Calculated CFL: 0.800 > Limit: 0.500
368.8s 4083 Original dt: 4.114980e-01 s
368.8s 4084 Corrected dt: 2.571863e-01 s
368.8s 4085 Correction factor: 1.6x
368.8s 4086 Max wave speed detected: 19.44 m/s
369.0s 4087 2025-10-10 12:08:21 - INFO - run_control_simulation:382 -   Reward: 0.015200
369.0s 4088 2025-10-10 12:08:21 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
369.0s 4089 2025-10-10 12:08:21 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
369.0s 4090 2025-10-10 12:08:21 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
369.0s 4091 2025-10-10 12:08:21 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
369.0s 4092 2025-10-10 12:08:21 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.008375, rho_c=0.025617
369.0s 4093 2025-10-10 12:08:21 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.918019, w_c=14.101648
369.0s 4094 2025-10-10 12:08:21 - INFO - run_control_simulation:416 -   State hash: 2800819597889458202
369.0s 4095 2025-10-10 12:08:21 - INFO - run_control_simulation:418 - ================================================================================
369.0s 4096 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
369.0s 4097 2025-10-10 12:08:21 - INFO - run_control_simulation:366 - ================================================================================
369.0s 4098 2025-10-10 12:08:21 - INFO - run_control_simulation:367 - STEP 2 START:
369.0s 4099 2025-10-10 12:08:21 - INFO - run_control_simulation:368 -   Controller: BaselineController
369.0s 4100 2025-10-10 12:08:21 - INFO - run_control_simulation:369 -   Action: 1.000000
369.0s 4101 2025-10-10 12:08:21 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
369.8s 4102 [WARNING] Automatic CFL correction applied (count: 23800):
369.8s 4103 Calculated CFL: 0.800 > Limit: 0.500
369.8s 4104 Original dt: 4.114980e-01 s
369.8s 4105 Corrected dt: 2.571863e-01 s
369.8s 4106 Correction factor: 1.6x
369.8s 4107 Max wave speed detected: 19.44 m/s
370.7s 4108 [WARNING] Automatic CFL correction applied (count: 23900):
370.7s 4109 Calculated CFL: 0.800 > Limit: 0.500
370.7s 4110 Original dt: 4.114980e-01 s
370.7s 4111 Corrected dt: 2.571863e-01 s
370.7s 4112 Correction factor: 1.6x
370.7s 4113 Max wave speed detected: 19.44 m/s
371.1s 4114 2025-10-10 12:08:23 - INFO - run_control_simulation:382 -   Reward: -0.084800
371.1s 4115 2025-10-10 12:08:23 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
371.1s 4116 2025-10-10 12:08:23 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
371.1s 4117 2025-10-10 12:08:23 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
371.1s 4118 2025-10-10 12:08:23 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.241080e+00, max=7.500000e+00, std=2.066254e+00
371.1s 4119 2025-10-10 12:08:23 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002332
371.1s 4120 2025-10-10 12:08:23 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.137456, w_c=16.297585
371.1s 4121 2025-10-10 12:08:23 - INFO - run_control_simulation:416 -   State hash: 8056282197138341533
371.1s 4122 2025-10-10 12:08:23 - INFO - run_control_simulation:418 - ================================================================================
371.1s 4123 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.241080e+00
371.1s 4124 2025-10-10 12:08:23 - INFO - run_control_simulation:366 - ================================================================================
371.1s 4125 2025-10-10 12:08:23 - INFO - run_control_simulation:367 - STEP 3 START:
371.1s 4126 2025-10-10 12:08:23 - INFO - run_control_simulation:368 -   Controller: BaselineController
371.1s 4127 2025-10-10 12:08:23 - INFO - run_control_simulation:369 -   Action: 0.000000
371.1s 4128 2025-10-10 12:08:23 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
371.6s 4129 [WARNING] Automatic CFL correction applied (count: 24000):
371.6s 4130 Calculated CFL: 0.800 > Limit: 0.500
371.6s 4131 Original dt: 4.114980e-01 s
371.6s 4132 Corrected dt: 2.571863e-01 s
371.6s 4133 Correction factor: 1.6x
371.6s 4134 Max wave speed detected: 19.44 m/s
372.5s 4135 [WARNING] Automatic CFL correction applied (count: 24100):
372.5s 4136 Calculated CFL: 0.800 > Limit: 0.500
372.5s 4137 Original dt: 4.114980e-01 s
372.5s 4138 Corrected dt: 2.571863e-01 s
372.5s 4139 Correction factor: 1.6x
372.5s 4140 Max wave speed detected: 19.44 m/s
373.3s 4141 2025-10-10 12:08:25 - INFO - run_control_simulation:382 -   Reward: 0.015200
373.3s 4142 2025-10-10 12:08:25 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
373.3s 4143 2025-10-10 12:08:25 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
373.3s 4144 2025-10-10 12:08:25 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
373.3s 4145 2025-10-10 12:08:25 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
373.3s 4146 2025-10-10 12:08:25 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
373.3s 4147 2025-10-10 12:08:25 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331146
373.3s 4148 2025-10-10 12:08:25 - INFO - run_control_simulation:416 -   State hash: 7511559135772164331
373.3s 4149 2025-10-10 12:08:25 - INFO - run_control_simulation:418 - ================================================================================
373.3s 4150 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
373.3s 4151 2025-10-10 12:08:25 - INFO - run_control_simulation:366 - ================================================================================
373.3s 4152 2025-10-10 12:08:25 - INFO - run_control_simulation:367 - STEP 4 START:
373.3s 4153 2025-10-10 12:08:25 - INFO - run_control_simulation:368 -   Controller: BaselineController
373.3s 4154 2025-10-10 12:08:25 - INFO - run_control_simulation:369 -   Action: 1.000000
373.3s 4155 2025-10-10 12:08:25 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
373.4s 4156 [WARNING] Automatic CFL correction applied (count: 24200):
373.4s 4157 Calculated CFL: 0.800 > Limit: 0.500
373.4s 4158 Original dt: 4.114980e-01 s
373.4s 4159 Corrected dt: 2.571863e-01 s
373.4s 4160 Correction factor: 1.6x
373.4s 4161 Max wave speed detected: 19.44 m/s
374.5s 4162 [WARNING] Automatic CFL correction applied (count: 24300):
374.5s 4163 Calculated CFL: 0.800 > Limit: 0.500
374.5s 4164 Original dt: 4.114980e-01 s
374.5s 4165 Corrected dt: 2.571863e-01 s
374.5s 4166 Correction factor: 1.6x
374.5s 4167 Max wave speed detected: 19.44 m/s
375.5s 4168 [WARNING] Automatic CFL correction applied (count: 24400):
375.5s 4169 Calculated CFL: 0.800 > Limit: 0.500
375.5s 4170 Original dt: 4.114980e-01 s
375.5s 4171 Corrected dt: 2.571863e-01 s
375.5s 4172 Correction factor: 1.6x
375.5s 4173 Max wave speed detected: 19.44 m/s
375.6s 4174 2025-10-10 12:08:28 - INFO - run_control_simulation:382 -   Reward: -0.084800
375.6s 4175 2025-10-10 12:08:28 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
375.6s 4176 2025-10-10 12:08:28 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
375.6s 4177 2025-10-10 12:08:28 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
375.6s 4178 2025-10-10 12:08:28 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.491564e-02, max=7.500000e+00, std=6.627938e-01
375.6s 4179 2025-10-10 12:08:28 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
375.6s 4180 2025-10-10 12:08:28 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
375.6s 4181 2025-10-10 12:08:28 - INFO - run_control_simulation:416 -   State hash: 610540346863559943
375.6s 4182 2025-10-10 12:08:28 - INFO - run_control_simulation:418 - ================================================================================
375.6s 4183 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=6.491564e-02
375.6s 4184 2025-10-10 12:08:28 - INFO - run_control_simulation:366 - ================================================================================
375.6s 4185 2025-10-10 12:08:28 - INFO - run_control_simulation:367 - STEP 5 START:
375.6s 4186 2025-10-10 12:08:28 - INFO - run_control_simulation:368 -   Controller: BaselineController
375.6s 4187 2025-10-10 12:08:28 - INFO - run_control_simulation:369 -   Action: 0.000000
375.6s 4188 2025-10-10 12:08:28 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
376.4s 4189 [WARNING] Automatic CFL correction applied (count: 24500):
376.4s 4190 Calculated CFL: 0.800 > Limit: 0.500
376.4s 4191 Original dt: 4.114980e-01 s
376.4s 4192 Corrected dt: 2.571863e-01 s
376.4s 4193 Correction factor: 1.6x
376.4s 4194 Max wave speed detected: 19.44 m/s
377.3s 4195 [WARNING] Automatic CFL correction applied (count: 24600):
377.3s 4196 Calculated CFL: 0.800 > Limit: 0.500
377.3s 4197 Original dt: 4.114980e-01 s
377.3s 4198 Corrected dt: 2.571863e-01 s
377.3s 4199 Correction factor: 1.6x
377.3s 4200 Max wave speed detected: 19.44 m/s
377.8s 4201 2025-10-10 12:08:30 - INFO - run_control_simulation:382 -   Reward: 0.015200
377.8s 4202 2025-10-10 12:08:30 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
377.8s 4203 2025-10-10 12:08:30 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
377.8s 4204 2025-10-10 12:08:30 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
377.8s 4205 2025-10-10 12:08:30 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
377.8s 4206 2025-10-10 12:08:30 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
377.8s 4207 2025-10-10 12:08:30 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
377.8s 4208 2025-10-10 12:08:30 - INFO - run_control_simulation:416 -   State hash: 3512778687321924725
377.8s 4209 2025-10-10 12:08:30 - INFO - run_control_simulation:418 - ================================================================================
377.8s 4210 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
377.8s 4211 2025-10-10 12:08:30 - INFO - run_control_simulation:366 - ================================================================================
377.8s 4212 2025-10-10 12:08:30 - INFO - run_control_simulation:367 - STEP 6 START:
377.8s 4213 2025-10-10 12:08:30 - INFO - run_control_simulation:368 -   Controller: BaselineController
377.8s 4214 2025-10-10 12:08:30 - INFO - run_control_simulation:369 -   Action: 1.000000
377.8s 4215 2025-10-10 12:08:30 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
378.2s 4216 [WARNING] Automatic CFL correction applied (count: 24700):
378.2s 4217 Calculated CFL: 0.800 > Limit: 0.500
378.2s 4218 Original dt: 4.114980e-01 s
378.2s 4219 Corrected dt: 2.571863e-01 s
378.2s 4220 Correction factor: 1.6x
378.2s 4221 Max wave speed detected: 19.44 m/s
379.2s 4222 [WARNING] Automatic CFL correction applied (count: 24800):
379.2s 4223 Calculated CFL: 0.800 > Limit: 0.500
379.2s 4224 Original dt: 4.114980e-01 s
379.2s 4225 Corrected dt: 2.571863e-01 s
379.2s 4226 Correction factor: 1.6x
379.2s 4227 Max wave speed detected: 19.44 m/s
379.9s 4228 2025-10-10 12:08:32 - INFO - run_control_simulation:382 -   Reward: -0.084800
379.9s 4229 2025-10-10 12:08:32 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
379.9s 4230 2025-10-10 12:08:32 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
379.9s 4231 2025-10-10 12:08:32 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
379.9s 4232 2025-10-10 12:08:32 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
379.9s 4233 2025-10-10 12:08:32 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
379.9s 4234 2025-10-10 12:08:32 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
379.9s 4235 2025-10-10 12:08:32 - INFO - run_control_simulation:416 -   State hash: -700290633409212778
379.9s 4236 2025-10-10 12:08:32 - INFO - run_control_simulation:418 - ================================================================================
379.9s 4237 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=6.490385e-02
379.9s 4238 2025-10-10 12:08:32 - INFO - run_control_simulation:366 - ================================================================================
379.9s 4239 2025-10-10 12:08:32 - INFO - run_control_simulation:367 - STEP 7 START:
379.9s 4240 2025-10-10 12:08:32 - INFO - run_control_simulation:368 -   Controller: BaselineController
379.9s 4241 2025-10-10 12:08:32 - INFO - run_control_simulation:369 -   Action: 0.000000
379.9s 4242 2025-10-10 12:08:32 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
380.1s 4243 [WARNING] Automatic CFL correction applied (count: 24900):
380.1s 4244 Calculated CFL: 0.800 > Limit: 0.500
380.1s 4245 Original dt: 4.114980e-01 s
380.1s 4246 Corrected dt: 2.571863e-01 s
380.1s 4247 Correction factor: 1.6x
380.1s 4248 Max wave speed detected: 19.44 m/s
381.0s 4249 [WARNING] Automatic CFL correction applied (count: 25000):
381.0s 4250 Calculated CFL: 0.800 > Limit: 0.500
381.0s 4251 Original dt: 4.114980e-01 s
381.0s 4252 Corrected dt: 2.571863e-01 s
381.0s 4253 Correction factor: 1.6x
381.0s 4254 Max wave speed detected: 19.44 m/s
381.9s 4255 [WARNING] Automatic CFL correction applied (count: 25100):
381.9s 4256 Calculated CFL: 0.800 > Limit: 0.500
381.9s 4257 Original dt: 4.114980e-01 s
381.9s 4258 Corrected dt: 2.571863e-01 s
381.9s 4259 Correction factor: 1.6x
381.9s 4260 Max wave speed detected: 19.44 m/s
382.1s 4261 2025-10-10 12:08:34 - INFO - run_control_simulation:382 -   Reward: 0.015200
382.1s 4262 2025-10-10 12:08:34 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
382.1s 4263 2025-10-10 12:08:34 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
382.1s 4264 2025-10-10 12:08:34 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
382.1s 4265 2025-10-10 12:08:34 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
382.1s 4266 2025-10-10 12:08:34 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
382.1s 4267 2025-10-10 12:08:34 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
382.1s 4268 2025-10-10 12:08:34 - INFO - run_control_simulation:416 -   State hash: -6676541803206114058
382.1s 4269 2025-10-10 12:08:34 - INFO - run_control_simulation:418 - ================================================================================
382.1s 4270 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
382.1s 4271 2025-10-10 12:08:34 - INFO - run_control_simulation:366 - ================================================================================
382.1s 4272 2025-10-10 12:08:34 - INFO - run_control_simulation:367 - STEP 8 START:
382.1s 4273 2025-10-10 12:08:34 - INFO - run_control_simulation:368 -   Controller: BaselineController
382.1s 4274 2025-10-10 12:08:34 - INFO - run_control_simulation:369 -   Action: 1.000000
382.1s 4275 2025-10-10 12:08:34 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
382.8s 4276 [WARNING] Automatic CFL correction applied (count: 25200):
382.8s 4277 Calculated CFL: 0.800 > Limit: 0.500
382.8s 4278 Original dt: 4.114980e-01 s
382.8s 4279 Corrected dt: 2.571863e-01 s
382.8s 4280 Correction factor: 1.6x
382.8s 4281 Max wave speed detected: 19.44 m/s
383.7s 4282 [WARNING] Automatic CFL correction applied (count: 25300):
383.7s 4283 Calculated CFL: 0.800 > Limit: 0.500
383.7s 4284 Original dt: 4.114980e-01 s
383.7s 4285 Corrected dt: 2.571863e-01 s
383.7s 4286 Correction factor: 1.6x
383.7s 4287 Max wave speed detected: 19.44 m/s
384.2s 4288 2025-10-10 12:08:36 - INFO - run_control_simulation:382 -   Reward: -0.084800
384.2s 4289 2025-10-10 12:08:36 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
384.2s 4290 2025-10-10 12:08:36 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
384.2s 4291 2025-10-10 12:08:36 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
384.2s 4292 2025-10-10 12:08:36 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
384.2s 4293 2025-10-10 12:08:36 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
384.2s 4294 2025-10-10 12:08:36 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
384.2s 4295 2025-10-10 12:08:36 - INFO - run_control_simulation:416 -   State hash: 1282338777257316007
384.2s 4296 2025-10-10 12:08:36 - INFO - run_control_simulation:418 - ================================================================================
384.2s 4297 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=6.490385e-02
384.2s 4298 2025-10-10 12:08:36 - INFO - run_control_simulation:366 - ================================================================================
384.2s 4299 2025-10-10 12:08:36 - INFO - run_control_simulation:367 - STEP 9 START:
384.2s 4300 2025-10-10 12:08:36 - INFO - run_control_simulation:368 -   Controller: BaselineController
384.2s 4301 2025-10-10 12:08:36 - INFO - run_control_simulation:369 -   Action: 0.000000
384.2s 4302 2025-10-10 12:08:36 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
384.6s 4303 [WARNING] Automatic CFL correction applied (count: 25400):
384.6s 4304 Calculated CFL: 0.800 > Limit: 0.500
384.6s 4305 Original dt: 4.114980e-01 s
384.6s 4306 Corrected dt: 2.571863e-01 s
384.6s 4307 Correction factor: 1.6x
384.6s 4308 Max wave speed detected: 19.44 m/s
385.5s 4309 [WARNING] Automatic CFL correction applied (count: 25500):
385.5s 4310 Calculated CFL: 0.800 > Limit: 0.500
385.5s 4311 Original dt: 4.114980e-01 s
385.5s 4312 Corrected dt: 2.571863e-01 s
385.5s 4313 Correction factor: 1.6x
385.5s 4314 Max wave speed detected: 19.44 m/s
386.3s 4315 2025-10-10 12:08:38 - INFO - run_control_simulation:382 -   Reward: 0.015200
386.3s 4316 2025-10-10 12:08:38 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
386.3s 4317 2025-10-10 12:08:38 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
386.3s 4318 2025-10-10 12:08:38 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
386.3s 4319 2025-10-10 12:08:38 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
386.3s 4320 2025-10-10 12:08:38 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
386.3s 4321 2025-10-10 12:08:38 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.283245, w_c=16.446577
386.3s 4322 2025-10-10 12:08:38 - INFO - run_control_simulation:416 -   State hash: 4849595776057575445
386.3s 4323 2025-10-10 12:08:38 - INFO - run_control_simulation:418 - ================================================================================
386.3s 4324 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
386.3s 4325 
386.3s 4326 [SIMULATION COMPLETED] Summary:
386.3s 4327 - Total control steps: 10
386.3s 4328 - Total reward: -0.35
386.3s 4329 - Avg step time: 2.169s (device=gpu)
386.3s 4330 - Simulated time: 600.0s / 600.0s
386.3s 4331 - Wallclock time: 21.7s
386.3s 4332 - Speed ratio: 27.67x real-time
386.3s 4333 
386.3s 4334 2025-10-10 12:08:38 - INFO - run_control_simulation:453 -
386.3s 4335 [SIMULATION COMPLETED] Summary:
386.3s 4336 - Total control steps: 10
386.3s 4337 - Total reward: -0.35
386.3s 4338 - Avg step time: 2.169s (device=gpu)
386.3s 4339 - Simulated time: 600.0s / 600.0s
386.3s 4340 - Wallclock time: 21.7s
386.3s 4341 - Speed ratio: 27.67x real-time
386.3s 4342 
386.3s 4343 2025-10-10 12:08:38 - INFO - run_control_simulation:454 - Returning 10 state snapshots
386.3s 4344 2025-10-10 12:08:38 - INFO - run_performance_comparison:723 - Baseline states copied: 10 snapshots
386.3s 4345 2025-10-10 12:08:38 - INFO - run_performance_comparison:724 - Baseline FIRST state hash: 543979149478343729
386.3s 4346 2025-10-10 12:08:38 - INFO - run_performance_comparison:725 - Baseline LAST state hash: 4849595776057575445
386.3s 4347 2025-10-10 12:08:38 - INFO - run_performance_comparison:726 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
386.3s 4348 2.14351577e-05]
386.3s 4349 2025-10-10 12:08:38 - INFO - run_performance_comparison:727 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
386.3s 4350 2.14319923e-05]
386.3s 4351 2025-10-10 12:08:38 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
386.3s 4352 2025-10-10 12:08:38 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=543979149478343729, last=4849595776057575445
386.3s 4353 2025-10-10 12:08:38 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
386.3s 4354 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
386.3s 4355 2025-10-10 12:08:38 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
386.3s 4356 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
386.3s 4357 2025-10-10 12:08:38 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
386.3s 4358 Running RL controller...
386.3s 4359 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
386.3s 4360 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
386.3s 4361 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
386.3s 4362 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
386.3s 4363 2025-10-10 12:08:38 - INFO - run_control_simulation:286 - ================================================================================
386.3s 4364 2025-10-10 12:08:38 - INFO - run_control_simulation:287 - Starting run_control_simulation:
386.3s 4365 2025-10-10 12:08:38 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
386.3s 4366 2025-10-10 12:08:38 - INFO - run_control_simulation:289 -   - duration: 600.0s
386.3s 4367 2025-10-10 12:08:38 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
386.3s 4368 2025-10-10 12:08:38 - INFO - run_control_simulation:291 -   - device: gpu
386.3s 4369 2025-10-10 12:08:38 - INFO - run_control_simulation:292 -   - controller: RLController
386.3s 4370 2025-10-10 12:08:38 - INFO - run_control_simulation:293 -   - max_control_steps: 11
386.3s 4371 2025-10-10 12:08:38 - INFO - run_control_simulation:294 - ================================================================================
386.3s 4372 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
386.3s 4373 2025-10-10 12:08:38 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
386.4s 4374 DEBUG PARAMS: Reading K_m_kmh = 10.0
386.4s 4375 DEBUG PARAMS: Reading K_c_kmh = 15.0
386.4s 4376 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
386.4s 4377 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
386.4s 4378 2025-10-10 12:08:38 - INFO - run_control_simulation:312 - TrafficSignalEnvDirect created successfully
386.4s 4379 2025-10-10 12:08:38 - INFO - run_control_simulation:313 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
386.4s 4380 [INFO] Calling env.reset()...
386.4s 4381 2025-10-10 12:08:38 - INFO - run_control_simulation:329 - Calling env.reset()...
386.4s 4382 DEBUG PARAMS: Reading K_m_kmh = 10.0
386.4s 4383 DEBUG PARAMS: Reading K_c_kmh = 15.0
386.4s 4384 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
386.4s 4385 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
386.4s 4386 2025-10-10 12:08:38 - INFO - run_control_simulation:331 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
386.4s 4387 2025-10-10 12:08:38 - INFO - run_control_simulation:335 - INITIAL STATE shape: (4, 104), dtype: float64
386.4s 4388 2025-10-10 12:08:38 - INFO - run_control_simulation:336 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
386.4s 4389 [INFO] Starting simulation loop (max 11 control steps)
386.4s 4390 2025-10-10 12:08:38 - INFO - run_control_simulation:352 - Starting simulation loop - max 11 control steps
386.4s 4391 2025-10-10 12:08:38 - INFO - run_control_simulation:366 - ================================================================================
386.4s 4392 2025-10-10 12:08:38 - INFO - run_control_simulation:367 - STEP 0 START:
386.4s 4393 2025-10-10 12:08:38 - INFO - run_control_simulation:368 -   Controller: RLController
386.4s 4394 2025-10-10 12:08:38 - INFO - run_control_simulation:369 -   Action: 0.000000
386.4s 4395 2025-10-10 12:08:38 - INFO - run_control_simulation:370 -   Simulation time: 0.00s
386.5s 4396 [WARNING] Automatic CFL correction applied (count: 25600):
386.5s 4397 Calculated CFL: 0.800 > Limit: 0.500
386.5s 4398 Original dt: 3.909130e-01 s
386.5s 4399 Corrected dt: 2.443206e-01 s
386.5s 4400 Correction factor: 1.6x
386.5s 4401 Max wave speed detected: 20.46 m/s
387.4s 4402 [WARNING] Automatic CFL correction applied (count: 25700):
387.4s 4403 Calculated CFL: 0.800 > Limit: 0.500
387.4s 4404 Original dt: 4.131708e-01 s
387.4s 4405 Corrected dt: 2.582317e-01 s
387.4s 4406 Correction factor: 1.6x
387.4s 4407 Max wave speed detected: 19.36 m/s
388.3s 4408 [WARNING] Automatic CFL correction applied (count: 25800):
388.3s 4409 Calculated CFL: 0.800 > Limit: 0.500
388.3s 4410 Original dt: 4.115220e-01 s
388.3s 4411 Corrected dt: 2.572013e-01 s
388.3s 4412 Correction factor: 1.6x
388.3s 4413 Max wave speed detected: 19.44 m/s
388.5s 4414 2025-10-10 12:08:40 - INFO - run_control_simulation:382 -   Reward: 0.015201
388.5s 4415 2025-10-10 12:08:40 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
388.5s 4416 2025-10-10 12:08:40 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
388.5s 4417 2025-10-10 12:08:40 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
388.5s 4418 2025-10-10 12:08:40 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.609084e+00, max=1.233795e+01, std=4.039166e+00
388.5s 4419 2025-10-10 12:08:40 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.036794, rho_c=0.049919
388.5s 4420 2025-10-10 12:08:40 - INFO - run_control_simulation:412 -     Mean velocities: w_m=13.262455, w_c=11.210112
388.5s 4421 2025-10-10 12:08:40 - INFO - run_control_simulation:416 -   State hash: -1808388645998814200
388.5s 4422 2025-10-10 12:08:40 - INFO - run_control_simulation:418 - ================================================================================
388.5s 4423 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.609084e+00
388.5s 4424 2025-10-10 12:08:40 - INFO - run_control_simulation:366 - ================================================================================
388.5s 4425 2025-10-10 12:08:40 - INFO - run_control_simulation:367 - STEP 1 START:
388.5s 4426 2025-10-10 12:08:40 - INFO - run_control_simulation:368 -   Controller: RLController
388.5s 4427 2025-10-10 12:08:40 - INFO - run_control_simulation:369 -   Action: 0.000000
388.5s 4428 2025-10-10 12:08:40 - INFO - run_control_simulation:370 -   Simulation time: 60.00s
389.2s 4429 [WARNING] Automatic CFL correction applied (count: 25900):
389.2s 4430 Calculated CFL: 0.800 > Limit: 0.500
389.2s 4431 Original dt: 4.114985e-01 s
389.2s 4432 Corrected dt: 2.571865e-01 s
389.2s 4433 Correction factor: 1.6x
389.2s 4434 Max wave speed detected: 19.44 m/s
390.2s 4435 [WARNING] Automatic CFL correction applied (count: 26000):
390.2s 4436 Calculated CFL: 0.800 > Limit: 0.500
390.2s 4437 Original dt: 4.114980e-01 s
390.2s 4438 Corrected dt: 2.571863e-01 s
390.2s 4439 Correction factor: 1.6x
390.2s 4440 Max wave speed detected: 19.44 m/s
390.8s 4441 2025-10-10 12:08:43 - INFO - run_control_simulation:382 -   Reward: 0.015200
390.8s 4442 2025-10-10 12:08:43 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
390.8s 4443 2025-10-10 12:08:43 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
390.8s 4444 2025-10-10 12:08:43 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
390.8s 4445 2025-10-10 12:08:43 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
390.8s 4446 2025-10-10 12:08:43 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.008375, rho_c=0.025617
390.8s 4447 2025-10-10 12:08:43 - INFO - run_control_simulation:412 -     Mean velocities: w_m=16.773789, w_c=13.986264
390.8s 4448 2025-10-10 12:08:43 - INFO - run_control_simulation:416 -   State hash: -8655151732529003739
390.8s 4449 2025-10-10 12:08:43 - INFO - run_control_simulation:418 - ================================================================================
390.8s 4450 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
390.8s 4451 2025-10-10 12:08:43 - INFO - run_control_simulation:366 - ================================================================================
390.8s 4452 2025-10-10 12:08:43 - INFO - run_control_simulation:367 - STEP 2 START:
390.8s 4453 2025-10-10 12:08:43 - INFO - run_control_simulation:368 -   Controller: RLController
390.8s 4454 2025-10-10 12:08:43 - INFO - run_control_simulation:369 -   Action: 0.000000
390.8s 4455 2025-10-10 12:08:43 - INFO - run_control_simulation:370 -   Simulation time: 120.00s
391.4s 4456 [WARNING] Automatic CFL correction applied (count: 26100):
391.4s 4457 Calculated CFL: 0.800 > Limit: 0.500
391.4s 4458 Original dt: 4.114980e-01 s
391.4s 4459 Corrected dt: 2.571863e-01 s
391.4s 4460 Correction factor: 1.6x
391.4s 4461 Max wave speed detected: 19.44 m/s
392.3s 4462 [WARNING] Automatic CFL correction applied (count: 26200):
392.3s 4463 Calculated CFL: 0.800 > Limit: 0.500
392.3s 4464 Original dt: 4.114980e-01 s
392.3s 4465 Corrected dt: 2.571863e-01 s
392.3s 4466 Correction factor: 1.6x
392.3s 4467 Max wave speed detected: 19.44 m/s
393.1s 4468 2025-10-10 12:08:45 - INFO - run_control_simulation:382 -   Reward: 0.015200
393.1s 4469 2025-10-10 12:08:45 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
393.1s 4470 2025-10-10 12:08:45 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
393.1s 4471 2025-10-10 12:08:45 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
393.1s 4472 2025-10-10 12:08:45 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
393.1s 4473 2025-10-10 12:08:45 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002332
393.1s 4474 2025-10-10 12:08:45 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.137456, w_c=16.297585
393.1s 4475 2025-10-10 12:08:45 - INFO - run_control_simulation:416 -   State hash: 8056282197138341533
393.1s 4476 2025-10-10 12:08:45 - INFO - run_control_simulation:418 - ================================================================================
393.1s 4477 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
393.1s 4478 2025-10-10 12:08:45 - INFO - run_control_simulation:366 - ================================================================================
393.1s 4479 2025-10-10 12:08:45 - INFO - run_control_simulation:367 - STEP 3 START:
393.1s 4480 2025-10-10 12:08:45 - INFO - run_control_simulation:368 -   Controller: RLController
393.1s 4481 2025-10-10 12:08:45 - INFO - run_control_simulation:369 -   Action: 0.000000
393.1s 4482 2025-10-10 12:08:45 - INFO - run_control_simulation:370 -   Simulation time: 180.00s
393.2s 4483 [WARNING] Automatic CFL correction applied (count: 26300):
393.2s 4484 Calculated CFL: 0.800 > Limit: 0.500
393.2s 4485 Original dt: 4.114980e-01 s
393.2s 4486 Corrected dt: 2.571863e-01 s
393.2s 4487 Correction factor: 1.6x
393.2s 4488 Max wave speed detected: 19.44 m/s
394.1s 4489 [WARNING] Automatic CFL correction applied (count: 26400):
394.1s 4490 Calculated CFL: 0.800 > Limit: 0.500
394.1s 4491 Original dt: 4.114980e-01 s
394.1s 4492 Corrected dt: 2.571863e-01 s
394.1s 4493 Correction factor: 1.6x
394.1s 4494 Max wave speed detected: 19.44 m/s
395.1s 4495 [WARNING] Automatic CFL correction applied (count: 26500):
395.1s 4496 Calculated CFL: 0.800 > Limit: 0.500
395.1s 4497 Original dt: 4.114980e-01 s
395.1s 4498 Corrected dt: 2.571863e-01 s
395.1s 4499 Correction factor: 1.6x
395.1s 4500 Max wave speed detected: 19.44 m/s
395.3s 4501 2025-10-10 12:08:47 - INFO - run_control_simulation:382 -   Reward: 0.015200
395.3s 4502 2025-10-10 12:08:47 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
395.3s 4503 2025-10-10 12:08:47 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
395.3s 4504 2025-10-10 12:08:47 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
395.3s 4505 2025-10-10 12:08:47 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
395.3s 4506 2025-10-10 12:08:47 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
395.3s 4507 2025-10-10 12:08:47 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331146
395.3s 4508 2025-10-10 12:08:47 - INFO - run_control_simulation:416 -   State hash: 7511559135772164331
395.3s 4509 2025-10-10 12:08:47 - INFO - run_control_simulation:418 - ================================================================================
395.3s 4510 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
395.3s 4511 2025-10-10 12:08:47 - INFO - run_control_simulation:366 - ================================================================================
395.3s 4512 2025-10-10 12:08:47 - INFO - run_control_simulation:367 - STEP 4 START:
395.3s 4513 2025-10-10 12:08:47 - INFO - run_control_simulation:368 -   Controller: RLController
395.3s 4514 2025-10-10 12:08:47 - INFO - run_control_simulation:369 -   Action: 0.000000
395.3s 4515 2025-10-10 12:08:47 - INFO - run_control_simulation:370 -   Simulation time: 240.00s
396.0s 4516 [WARNING] Automatic CFL correction applied (count: 26600):
396.0s 4517 Calculated CFL: 0.800 > Limit: 0.500
396.0s 4518 Original dt: 4.114980e-01 s
396.0s 4519 Corrected dt: 2.571863e-01 s
396.0s 4520 Correction factor: 1.6x
396.0s 4521 Max wave speed detected: 19.44 m/s
396.9s 4522 [WARNING] Automatic CFL correction applied (count: 26700):
396.9s 4523 Calculated CFL: 0.800 > Limit: 0.500
396.9s 4524 Original dt: 4.114980e-01 s
396.9s 4525 Corrected dt: 2.571863e-01 s
396.9s 4526 Correction factor: 1.6x
396.9s 4527 Max wave speed detected: 19.44 m/s
397.4s 4528 2025-10-10 12:08:49 - INFO - run_control_simulation:382 -   Reward: 0.015200
397.4s 4529 2025-10-10 12:08:49 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
397.4s 4530 2025-10-10 12:08:49 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
397.4s 4531 2025-10-10 12:08:49 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
397.4s 4532 2025-10-10 12:08:49 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
397.4s 4533 2025-10-10 12:08:49 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
397.4s 4534 2025-10-10 12:08:49 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
397.4s 4535 2025-10-10 12:08:49 - INFO - run_control_simulation:416 -   State hash: -1424915609077674245
397.4s 4536 2025-10-10 12:08:49 - INFO - run_control_simulation:418 - ================================================================================
397.4s 4537 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
397.4s 4538 2025-10-10 12:08:49 - INFO - run_control_simulation:366 - ================================================================================
397.4s 4539 2025-10-10 12:08:49 - INFO - run_control_simulation:367 - STEP 5 START:
397.4s 4540 2025-10-10 12:08:49 - INFO - run_control_simulation:368 -   Controller: RLController
397.4s 4541 2025-10-10 12:08:49 - INFO - run_control_simulation:369 -   Action: 0.000000
397.4s 4542 2025-10-10 12:08:49 - INFO - run_control_simulation:370 -   Simulation time: 300.00s
397.8s 4543 [WARNING] Automatic CFL correction applied (count: 26800):
397.8s 4544 Calculated CFL: 0.800 > Limit: 0.500
397.8s 4545 Original dt: 4.114980e-01 s
397.8s 4546 Corrected dt: 2.571863e-01 s
397.8s 4547 Correction factor: 1.6x
397.8s 4548 Max wave speed detected: 19.44 m/s
398.7s 4549 [WARNING] Automatic CFL correction applied (count: 26900):
398.7s 4550 Calculated CFL: 0.800 > Limit: 0.500
398.7s 4551 Original dt: 4.114980e-01 s
398.7s 4552 Corrected dt: 2.571863e-01 s
398.7s 4553 Correction factor: 1.6x
398.7s 4554 Max wave speed detected: 19.44 m/s
399.5s 4555 2025-10-10 12:08:51 - INFO - run_control_simulation:382 -   Reward: 0.015200
399.5s 4556 2025-10-10 12:08:51 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
399.5s 4557 2025-10-10 12:08:51 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
399.5s 4558 2025-10-10 12:08:51 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
399.5s 4559 2025-10-10 12:08:51 - INFO - run_control_simulation:401 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
399.5s 4560 2025-10-10 12:08:51 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
399.5s 4561 2025-10-10 12:08:51 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
399.5s 4562 2025-10-10 12:08:51 - INFO - run_control_simulation:416 -   State hash: -2677608120098360573
399.5s 4563 2025-10-10 12:08:51 - INFO - run_control_simulation:418 - ================================================================================
399.5s 4564 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
399.5s 4565 2025-10-10 12:08:51 - INFO - run_control_simulation:366 - ================================================================================
399.5s 4566 2025-10-10 12:08:51 - INFO - run_control_simulation:367 - STEP 6 START:
399.5s 4567 2025-10-10 12:08:51 - INFO - run_control_simulation:368 -   Controller: RLController
399.5s 4568 2025-10-10 12:08:51 - INFO - run_control_simulation:369 -   Action: 0.000000
399.5s 4569 2025-10-10 12:08:51 - INFO - run_control_simulation:370 -   Simulation time: 360.00s
399.6s 4570 [WARNING] Automatic CFL correction applied (count: 27000):
399.6s 4571 Calculated CFL: 0.800 > Limit: 0.500
399.6s 4572 Original dt: 4.114980e-01 s
399.6s 4573 Corrected dt: 2.571863e-01 s
399.6s 4574 Correction factor: 1.6x
399.6s 4575 Max wave speed detected: 19.44 m/s
400.6s 4576 [WARNING] Automatic CFL correction applied (count: 27100):
400.6s 4577 Calculated CFL: 0.800 > Limit: 0.500
400.6s 4578 Original dt: 4.114980e-01 s
400.6s 4579 Corrected dt: 2.571863e-01 s
400.6s 4580 Correction factor: 1.6x
400.6s 4581 Max wave speed detected: 19.44 m/s
401.5s 4582 [WARNING] Automatic CFL correction applied (count: 27200):
401.5s 4583 Calculated CFL: 0.800 > Limit: 0.500
401.5s 4584 Original dt: 4.114980e-01 s
401.5s 4585 Corrected dt: 2.571863e-01 s
401.5s 4586 Correction factor: 1.6x
401.5s 4587 Max wave speed detected: 19.44 m/s
401.7s 4588 2025-10-10 12:08:54 - INFO - run_control_simulation:382 -   Reward: 0.015200
401.7s 4589 2025-10-10 12:08:54 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
401.7s 4590 2025-10-10 12:08:54 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
401.7s 4591 2025-10-10 12:08:54 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
401.7s 4592 2025-10-10 12:08:54 - INFO - run_control_simulation:401 -     Diff statistics: mean=2.295402e-11, max=7.384955e-10, std=9.818588e-11
401.7s 4593 2025-10-10 12:08:54 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
401.7s 4594 2025-10-10 12:08:54 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
401.7s 4595 2025-10-10 12:08:54 - INFO - run_control_simulation:416 -   State hash: -700290633409212778
401.7s 4596 2025-10-10 12:08:54 - INFO - run_control_simulation:418 - ================================================================================
401.7s 4597 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295402e-11
401.7s 4598 2025-10-10 12:08:54 - INFO - run_control_simulation:366 - ================================================================================
401.7s 4599 2025-10-10 12:08:54 - INFO - run_control_simulation:367 - STEP 7 START:
401.7s 4600 2025-10-10 12:08:54 - INFO - run_control_simulation:368 -   Controller: RLController
401.7s 4601 2025-10-10 12:08:54 - INFO - run_control_simulation:369 -   Action: 0.000000
401.7s 4602 2025-10-10 12:08:54 - INFO - run_control_simulation:370 -   Simulation time: 420.00s
402.5s 4603 [WARNING] Automatic CFL correction applied (count: 27300):
402.5s 4604 Calculated CFL: 0.800 > Limit: 0.500
402.5s 4605 Original dt: 4.114980e-01 s
402.5s 4606 Corrected dt: 2.571863e-01 s
402.5s 4607 Correction factor: 1.6x
402.5s 4608 Max wave speed detected: 19.44 m/s
403.4s 4609 [WARNING] Automatic CFL correction applied (count: 27400):
403.4s 4610 Calculated CFL: 0.800 > Limit: 0.500
403.4s 4611 Original dt: 4.114980e-01 s
403.4s 4612 Corrected dt: 2.571863e-01 s
403.4s 4613 Correction factor: 1.6x
403.4s 4614 Max wave speed detected: 19.44 m/s
403.9s 4615 2025-10-10 12:08:56 - INFO - run_control_simulation:382 -   Reward: 0.015200
403.9s 4616 2025-10-10 12:08:56 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
403.9s 4617 2025-10-10 12:08:56 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
403.9s 4618 2025-10-10 12:08:56 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
403.9s 4619 2025-10-10 12:08:56 - INFO - run_control_simulation:401 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
403.9s 4620 2025-10-10 12:08:56 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
403.9s 4621 2025-10-10 12:08:56 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
403.9s 4622 2025-10-10 12:08:56 - INFO - run_control_simulation:416 -   State hash: -6676541803206114058
403.9s 4623 2025-10-10 12:08:56 - INFO - run_control_simulation:418 - ================================================================================
403.9s 4624 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
403.9s 4625 2025-10-10 12:08:56 - INFO - run_control_simulation:366 - ================================================================================
403.9s 4626 2025-10-10 12:08:56 - INFO - run_control_simulation:367 - STEP 8 START:
403.9s 4627 2025-10-10 12:08:56 - INFO - run_control_simulation:368 -   Controller: RLController
403.9s 4628 2025-10-10 12:08:56 - INFO - run_control_simulation:369 -   Action: 0.000000
403.9s 4629 2025-10-10 12:08:56 - INFO - run_control_simulation:370 -   Simulation time: 480.00s
404.3s 4630 [WARNING] Automatic CFL correction applied (count: 27500):
404.3s 4631 Calculated CFL: 0.800 > Limit: 0.500
404.3s 4632 Original dt: 4.114980e-01 s
404.3s 4633 Corrected dt: 2.571863e-01 s
404.3s 4634 Correction factor: 1.6x
404.3s 4635 Max wave speed detected: 19.44 m/s
405.2s 4636 [WARNING] Automatic CFL correction applied (count: 27600):
405.2s 4637 Calculated CFL: 0.800 > Limit: 0.500
405.2s 4638 Original dt: 4.114980e-01 s
405.2s 4639 Corrected dt: 2.571863e-01 s
405.2s 4640 Correction factor: 1.6x
405.2s 4641 Max wave speed detected: 19.44 m/s
406.0s 4642 2025-10-10 12:08:58 - INFO - run_control_simulation:382 -   Reward: 0.015200
406.0s 4643 2025-10-10 12:08:58 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: False
406.0s 4644 2025-10-10 12:08:58 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
406.0s 4645 2025-10-10 12:08:58 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
406.0s 4646 2025-10-10 12:08:58 - INFO - run_control_simulation:401 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
406.0s 4647 2025-10-10 12:08:58 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
406.0s 4648 2025-10-10 12:08:58 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
406.0s 4649 2025-10-10 12:08:58 - INFO - run_control_simulation:416 -   State hash: 1427622408212949084
406.0s 4650 2025-10-10 12:08:58 - INFO - run_control_simulation:418 - ================================================================================
406.0s 4651 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
406.0s 4652 2025-10-10 12:08:58 - INFO - run_control_simulation:366 - ================================================================================
406.0s 4653 2025-10-10 12:08:58 - INFO - run_control_simulation:367 - STEP 9 START:
406.0s 4654 2025-10-10 12:08:58 - INFO - run_control_simulation:368 -   Controller: RLController
406.0s 4655 2025-10-10 12:08:58 - INFO - run_control_simulation:369 -   Action: 0.000000
406.0s 4656 2025-10-10 12:08:58 - INFO - run_control_simulation:370 -   Simulation time: 540.00s
406.1s 4657 [WARNING] Automatic CFL correction applied (count: 27700):
406.1s 4658 Calculated CFL: 0.800 > Limit: 0.500
406.1s 4659 Original dt: 4.114980e-01 s
406.1s 4660 Corrected dt: 2.571863e-01 s
406.1s 4661 Correction factor: 1.6x
406.1s 4662 Max wave speed detected: 19.44 m/s
407.0s 4663 [WARNING] Automatic CFL correction applied (count: 27800):
407.0s 4664 Calculated CFL: 0.800 > Limit: 0.500
407.0s 4665 Original dt: 4.114980e-01 s
407.0s 4666 Corrected dt: 2.571863e-01 s
407.0s 4667 Correction factor: 1.6x
407.0s 4668 Max wave speed detected: 19.44 m/s
407.9s 4669 [WARNING] Automatic CFL correction applied (count: 27900):
407.9s 4670 Calculated CFL: 0.800 > Limit: 0.500
407.9s 4671 Original dt: 4.114980e-01 s
407.9s 4672 Corrected dt: 2.571863e-01 s
407.9s 4673 Correction factor: 1.6x
407.9s 4674 Max wave speed detected: 19.44 m/s
408.1s 4675 2025-10-10 12:09:00 - INFO - run_control_simulation:382 -   Reward: 0.015200
408.1s 4676 2025-10-10 12:09:00 - INFO - run_control_simulation:383 -   Terminated: False, Truncated: True
408.1s 4677 2025-10-10 12:09:00 - INFO - run_control_simulation:399 -   STATE EVOLUTION:
408.1s 4678 2025-10-10 12:09:00 - INFO - run_control_simulation:400 -     Before shape: (4, 104), After shape: (4, 104)
408.1s 4679 2025-10-10 12:09:00 - INFO - run_control_simulation:401 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
408.1s 4680 2025-10-10 12:09:00 - INFO - run_control_simulation:411 -     Mean densities: rho_m=0.001944, rho_c=0.002331
408.1s 4681 2025-10-10 12:09:00 - INFO - run_control_simulation:412 -     Mean velocities: w_m=19.139014, w_c=16.331193
408.1s 4682 2025-10-10 12:09:00 - INFO - run_control_simulation:416 -   State hash: 9010973302779729330
408.1s 4683 2025-10-10 12:09:00 - INFO - run_control_simulation:418 - ================================================================================
408.1s 4684 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
408.1s 4685 
408.1s 4686 [SIMULATION COMPLETED] Summary:
408.1s 4687 - Total control steps: 10
408.1s 4688 - Total reward: 0.15
408.1s 4689 - Avg step time: 2.177s (device=gpu)
408.1s 4690 - Simulated time: 600.0s / 600.0s
408.1s 4691 - Wallclock time: 21.8s
408.1s 4692 - Speed ratio: 27.56x real-time
408.1s 4693 
408.1s 4694 2025-10-10 12:09:00 - INFO - run_control_simulation:453 -
408.1s 4695 [SIMULATION COMPLETED] Summary:
408.1s 4696 - Total control steps: 10
408.1s 4697 - Total reward: 0.15
408.1s 4698 - Avg step time: 2.177s (device=gpu)
408.1s 4699 - Simulated time: 600.0s / 600.0s
408.1s 4700 - Wallclock time: 21.8s
408.1s 4701 - Speed ratio: 27.56x real-time
408.1s 4702 
408.1s 4703 2025-10-10 12:09:00 - INFO - run_control_simulation:454 - Returning 10 state snapshots
408.1s 4704 2025-10-10 12:09:00 - INFO - run_performance_comparison:760 - RL states copied: 10 snapshots
408.1s 4705 2025-10-10 12:09:00 - INFO - run_performance_comparison:761 - RL FIRST state hash: -1808388645998814200
408.1s 4706 2025-10-10 12:09:00 - INFO - run_performance_comparison:762 - RL LAST state hash: 9010973302779729330
408.1s 4707 2025-10-10 12:09:00 - INFO - run_performance_comparison:763 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
408.1s 4708 2.14351577e-05]
408.1s 4709 2025-10-10 12:09:00 - INFO - run_performance_comparison:764 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
408.1s 4710 2.14319923e-05]
408.1s 4711 2025-10-10 12:09:00 - INFO - evaluate_traffic_performance:468 - Evaluating performance with 10 state snapshots
408.1s 4712 2025-10-10 12:09:00 - INFO - evaluate_traffic_performance:469 -   HASH CHECK - first=-1808388645998814200, last=9010973302779729330
408.1s 4713 2025-10-10 12:09:00 - INFO - evaluate_traffic_performance:478 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
408.1s 4714 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
408.1s 4715 2025-10-10 12:09:00 - INFO - evaluate_traffic_performance:480 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
408.1s 4716 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
408.1s 4717 2025-10-10 12:09:00 - INFO - evaluate_traffic_performance:534 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
408.1s 4718 2025-10-10 12:09:00 - WARNING - run_performance_comparison:772 - States comparison - Identical: False, baseline_hash=543979149478343729, rl_hash=-1808388645998814200
408.1s 4719 2025-10-10 12:09:00 - INFO - run_performance_comparison:781 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
408.1s 4720 2025-10-10 12:09:00 - INFO - run_performance_comparison:782 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
408.1s 4721 2025-10-10 12:09:00 - INFO - run_performance_comparison:790 - Flow improvement: 0.000%
408.1s 4722 2025-10-10 12:09:00 - INFO - run_performance_comparison:791 - Efficiency improvement: 0.000%
408.1s 4723 2025-10-10 12:09:00 - INFO - run_performance_comparison:792 - Delay reduction: -0.000%
408.1s 4724 Flow improvement: 0.0%
408.1s 4725 Efficiency improvement: 0.0%
408.1s 4726 Delay reduction: -0.0%
408.1s 4727 Result: FAILED
408.1s 4728 
408.1s 4729 [FIGURES] Generating RL performance figures...
408.7s 4730 [OK] fig_rl_performance_improvements.png
409.3s 4731 [OK] fig_rl_learning_curve.png
409.3s 4732 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
409.3s 4733 
409.3s 4734 [METRICS] Saving RL performance metrics...
409.3s 4735 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
409.3s 4736 
409.3s 4737 [LATEX] Generating content for Section 7.6...
409.3s 4738 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
409.3s 4739 
409.3s 4740 === RL Performance Validation Summary ===
409.3s 4741 Scenarios passed: 0/1 (0.0%)
409.3s 4742 Average flow improvement: 0.00%
409.3s 4743 Average efficiency improvement: 0.00%
409.3s 4744 Average delay reduction: 0.00%
409.3s 4745 Overall validation: FAILED
409.3s 4746 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
412.1s 4747 [WARNING] Tests returned code: 1
412.1s 4748 
412.1s 4749 [STEP 4/4] Copying artifacts and cleaning up...
412.1s 4750 [ARTIFACTS] Copying results for section_7_6_rl_performance...
412.1s 4751 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
412.1s 4752 [ARTIFACTS] NPZ files: 0
412.1s 4753 [ARTIFACTS] PNG figures: 2
412.1s 4754 [ARTIFACTS] YAML scenarios: 1
412.1s 4755 [ARTIFACTS] TEX files: 1
412.1s 4756 [ARTIFACTS] JSON files: 1
412.1s 4757 [ARTIFACTS] CSV metrics: 1
412.1s 4758 TRACKING_SUCCESS: Artifacts copied
412.1s 4759 [SUCCESS] All artifacts organized and copied
412.1s 4760 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
412.2s 4761 [OK] Cleanup completed - only validation results remain
412.2s 4762 TRACKING_SUCCESS: Cleanup completed
412.2s 4763 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
412.2s 4764 TRACKING_SUCCESS: Session summary created
412.2s 4765 
412.2s 4766 [FINAL] Validation workflow completed
412.2s 4767 Remote logging finalized - ready for download
412.2s 4768 
412.2s 4769 ================================================================================
412.2s 4770 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
412.2s 4771 Output ready at: /kaggle/working/validation_results/
412.2s 4772 ================================================================================
415.9s 4773 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
415.9s 4774 warn(
415.9s 4775 [NbConvertApp] Converting notebook __script__.ipynb to html
416.7s 4776 [NbConvertApp] Writing 321270 bytes to __results__.html