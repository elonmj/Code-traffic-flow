[{"stream_name":"stdout","time":0.575801381,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.575848301,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.575854883,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.575858766,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.575863938,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.576042276,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.084118028,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.084266221,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.130576565,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.151706707,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.151727856,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.151796519,"data":"\n"}
,{"stream_name":"stdout","time":5.151804527,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.151909768,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.050288686,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.05031544,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.050320493,"data":"\n"}
,{"stream_name":"stdout","time":9.050324139,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.050327855,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":12.795726211,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":15.777100041,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":18.73228097,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":21.707467502,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":24.603138438,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":27.575956011,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":102.078663748,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":102.07881836,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":102.078927161,"data":"\n"}
,{"stream_name":"stdout","time":102.078946335,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":102.079276665,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":102.079358763,"data":"[SCENARIO] Single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":102.079461759,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":102.079554506,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":102.079652408,"data":"============================================================\n"}
,{"stream_name":"stderr","time":112.686217861,"data":"2025-10-15 19:48:26.941898: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":112.84973912,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":112.849775135,"data":"E0000 00:00:1760557707.105399     104 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":112.901589999,"data":"E0000 00:00:1760557707.157307     104 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":123.951769488,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":123.951808541,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":123.951816704,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":123.951822954,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":123.951828712,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":123.951836085,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":123.95184042,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":123.951922054,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":123.951936157,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":123.951942398,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":123.951950761,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":123.951955138,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":123.951959086,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":123.952540026,"data":"2025-10-15 19:48:38 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.952699503,"data":"2025-10-15 19:48:38 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":123.952859789,"data":"2025-10-15 19:48:38 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":123.952939931,"data":"2025-10-15 19:48:38 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":123.953060627,"data":"2025-10-15 19:48:38 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.953071071,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":123.953078092,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":123.953084472,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":124.068454523,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":124.164052149,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":124.164096582,"data":"\n"}
,{"stream_name":"stdout","time":124.164100909,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":124.164124554,"data":"[SCENARIO] Single scenario mode (CLI): traffic_light_control\n"}
,{"stream_name":"stdout","time":124.164129601,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":124.164134205,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":124.164164898,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":124.164304346,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":124.164387112,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":124.164524132,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":124.164557074,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":124.164691861,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":124.164741382,"data":"2025-10-15 19:48:38 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":124.164810055,"data":"\n"}
,{"stream_name":"stdout","time":124.164816027,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":124.164820402,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":124.164824427,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":124.164828103,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":124.165002029,"data":"2025-10-15 19:48:38 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":124.165141856,"data":"2025-10-15 19:48:38 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":124.165220946,"data":"2025-10-15 19:48:38 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":124.165611205,"data":"2025-10-15 19:48:38 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":124.170038564,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":124.170119991,"data":"2025-10-15 19:48:38 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":124.170238327,"data":"2025-10-15 19:48:38 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":124.170310479,"data":"2025-10-15 19:48:38 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":124.170384991,"data":"2025-10-15 19:48:38 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":124.170441697,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":124.170451213,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":124.170555835,"data":"2025-10-15 19:48:38 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":124.170707007,"data":"2025-10-15 19:48:38 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":124.170892137,"data":"2025-10-15 19:48:38 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":124.17103117,"data":"2025-10-15 19:48:38 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config a6721e38\n"}
,{"stream_name":"stdout","time":124.171042168,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":124.17152878,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":124.171541553,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":124.178617696,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":124.178635613,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":124.178641058,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":124.178645357,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":124.178649456,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":124.178659273,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":124.178664059,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":124.178668408,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":124.178693654,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":124.178727715,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":124.178732798,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":124.178744118,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":124.181915101,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":124.181928814,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":124.182403699,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":124.18241094,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":125.541830742,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":125.541858108,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":125.54186308,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":125.541866653,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":125.54187008,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":125.541873786,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":125.541877179,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":125.541880851,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":125.542222898,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":125.543116961,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":125.543196052,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":125.543213225,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":130.01987612,"data":"2025-10-15 19:48:44 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":130.020182359,"data":"\n"}
,{"stream_name":"stdout","time":130.020200169,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":130.020206122,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":130.020211134,"data":"\n"}
,{"stream_name":"stdout","time":130.020215845,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":130.02022108,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":130.020226283,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":130.020231076,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":130.020236568,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":130.020241891,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":130.020247268,"data":"\n"}
,{"stream_name":"stdout","time":130.020274306,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":130.020308215,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":130.029773366,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":130.029791857,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":130.029797877,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":130.029802915,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":130.02980781,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":130.029988867,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":130.030001058,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":130.030006113,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":130.030011333,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":130.030016023,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":130.030030032,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":130.030035077,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":130.030865236,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":130.030882036,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":130.031994762,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":130.032011149,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":130.032017778,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.032037347,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":130.036907141,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":130.037102494,"data":"\n"}
,{"stream_name":"stdout","time":130.03711256,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":130.038756596,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":130.038772894,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":130.038777504,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":130.03878142,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.039164446,"data":"\n"}
,{"stream_name":"stderr","time":130.074764305,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.074786348,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":130.823802988,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":130.823826994,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":130.823833304,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":130.823837736,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":130.823841679,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":130.823845431,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":131.009669907,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.009701474,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.270182932,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.270217556,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.330269501,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.330299698,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.38773904,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.387768379,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.807236694,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.807275988,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.88309063,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.883119648,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.968234072,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.968260937,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.065341338,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.065373107,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.165281874,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.165314882,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.222955867,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.222981609,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.278888079,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.278913099,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.65060607,"data":"\n"}
,{"stream_name":"stdout","time":132.650634337,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":132.650640169,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.650888449,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.74s/s]\n"}
,{"stream_name":"stdout","time":132.650894267,"data":"\n"}
,{"stream_name":"stdout","time":132.650907099,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":132.650912088,"data":"Total runtime: 2.61 seconds.\n"}
,{"stream_name":"stdout","time":132.652579127,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":132.652963705,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":132.65297505,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.652980015,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":132.652983943,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.653165582,"data":"\n"}
,{"stream_name":"stdout","time":132.724611997,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":133.118723767,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.11875288,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.118751626,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":133.118955332,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.22s/s]\n"}
,{"stream_name":"stdout","time":133.118956911,"data":"\n"}
,{"stream_name":"stdout","time":133.118977467,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":133.118982206,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":133.120619529,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":133.120893806,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.12090278,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.120907463,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.120911362,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.121091951,"data":"\n"}
,{"stream_name":"stdout","time":133.168816799,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":133.16883705,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":133.16884217,"data":"  Original dt: 4.547586e-01 s\n"}
,{"stream_name":"stdout","time":133.168845999,"data":"  Corrected dt: 2.842241e-01 s\n"}
,{"stream_name":"stdout","time":133.168849722,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":133.168853985,"data":"  Max wave speed detected: 17.59 m/s\n"}
,{"stream_name":"stdout","time":133.177069242,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":133.604241389,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":133.604246241,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":133.604273107,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.60454841,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.05s/s]\n"}
,{"stream_name":"stdout","time":133.60457761,"data":"\n"}
,{"stream_name":"stdout","time":133.604586172,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":133.604591103,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":133.606175597,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":133.606592607,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.606612789,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.606617582,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.606622415,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.606793792,"data":"\n"}
,{"stream_name":"stdout","time":133.634212115,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":134.074098162,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":134.074127874,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.0741343,"data":"  Original dt: 4.525311e-01 s\n"}
,{"stream_name":"stdout","time":134.074138298,"data":"  Corrected dt: 2.828319e-01 s\n"}
,{"stream_name":"stdout","time":134.074142221,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.074146817,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":134.082208776,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":134.091293283,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.091313446,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.091314013,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":134.091539735,"data":"\n"}
,{"stream_name":"stdout","time":134.091554541,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":134.09155937,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":134.091574181,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.96s/s]\n"}
,{"stream_name":"stdout","time":134.093273003,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":134.093716246,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.093728937,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":134.093734236,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":134.093738693,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.093890333,"data":"\n"}
,{"stream_name":"stdout","time":134.531331722,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":134.576426589,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.576451181,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.576435776,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":134.576777028,"data":"\n"}
,{"stream_name":"stderr","time":134.576783347,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.08s/s]\n"}
,{"stream_name":"stdout","time":134.576791256,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":134.576810075,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":134.578380569,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":134.578783426,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.578795424,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.578800019,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":134.57880397,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.578988037,"data":"\n"}
,{"stream_name":"stdout","time":134.976474759,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":134.976497369,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.976522254,"data":"  Original dt: 4.524790e-01 s\n"}
,{"stream_name":"stdout","time":134.976530346,"data":"  Corrected dt: 2.827993e-01 s\n"}
,{"stream_name":"stdout","time":134.976534846,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.976539234,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":134.98435722,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":135.064598002,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.064619034,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.064597537,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":135.064808233,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.89s/s]\n"}
,{"stream_name":"stdout","time":135.064844806,"data":"\n"}
,{"stream_name":"stdout","time":135.064849958,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":135.064854583,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":135.067030336,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.06741633,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.067426593,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.067445456,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":135.067449688,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.067671402,"data":"\n"}
,{"stream_name":"stdout","time":135.431342391,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":135.547903039,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":135.547900326,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.54793595,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.548141555,"data":"\n"}
,{"stream_name":"stdout","time":135.548156547,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":135.548163024,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":135.548141547,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.24s/s]\n"}
,{"stream_name":"stdout","time":135.549752201,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.550065183,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.550076245,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.5500824,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":135.550087498,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.550260482,"data":"\n"}
,{"stream_name":"stdout","time":135.873150593,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":135.873180908,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.873188566,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":135.873194647,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":135.873199672,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.87320459,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":135.881471553,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":136.034676766,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":136.034676566,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.034714312,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.034874952,"data":"\n"}
,{"stream_name":"stdout","time":136.034895823,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":136.034902419,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":136.03492258,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":136.036543257,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.036561827,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":136.036567029,"data":"\n"}
,{"stream_name":"stdout","time":136.03657145,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.036575877,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.02 | Avg Reward/Step: 0.003\n"}
,{"stream_name":"stdout","time":136.03658033,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.036584859,"data":"\n"}
,{"stream_name":"stdout","time":136.036590647,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":136.036594762,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":136.043677663,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":136.043698529,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":136.043704595,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":136.043708873,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":136.04371312,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":136.043738453,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":136.043752232,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":136.043756378,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":136.043760148,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":136.043766083,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.043770098,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":136.043773644,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":136.04433987,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":136.044348434,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":136.044613773,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":136.044843355,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.044851012,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.044855835,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":136.04691197,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.046926079,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.046941471,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":136.046945557,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.047064952,"data":"\n"}
,{"stream_name":"stdout","time":136.427664559,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":136.427693898,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.427710846,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":136.427916524,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.41s/s]\n"}
,{"stream_name":"stdout","time":136.427950537,"data":"\n"}
,{"stream_name":"stdout","time":136.427961915,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":136.427966249,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":136.429660498,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.429847038,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.42985531,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.429859662,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":136.429863756,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.43003112,"data":"\n"}
,{"stream_name":"stdout","time":136.503395469,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":136.790222135,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":136.790246701,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.790251923,"data":"  Original dt: 4.571011e-01 s\n"}
,{"stream_name":"stdout","time":136.790255656,"data":"  Corrected dt: 2.856882e-01 s\n"}
,{"stream_name":"stdout","time":136.790259541,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.790263272,"data":"  Max wave speed detected: 17.50 m/s\n"}
,{"stream_name":"stdout","time":136.896345391,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":136.896375898,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.896383636,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":136.896698581,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.16s/s]\n"}
,{"stream_name":"stdout","time":136.896705528,"data":"\n"}
,{"stream_name":"stdout","time":136.896725237,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":136.8967304,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":136.898375793,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.898699027,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.898710832,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.898715259,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":136.898719126,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.898895458,"data":"\n"}
,{"stream_name":"stdout","time":136.953104382,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":137.368529252,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":137.368533669,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.368638388,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.368645792,"data":"\n"}
,{"stream_name":"stdout","time":137.368660011,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stderr","time":137.368659856,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.95s/s]\n"}
,{"stream_name":"stdout","time":137.368664096,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":137.370300484,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.370448285,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.370457996,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.370463075,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":137.37046697,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.370699938,"data":"\n"}
,{"stream_name":"stdout","time":137.39816321,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":137.706260959,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":137.706289774,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.706296402,"data":"  Original dt: 4.525738e-01 s\n"}
,{"stream_name":"stdout","time":137.706301258,"data":"  Corrected dt: 2.828586e-01 s\n"}
,{"stream_name":"stdout","time":137.706305907,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.706310546,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":137.875276525,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":137.885219336,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.885260052,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.885227274,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":137.885367602,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.15s/s]\n"}
,{"stream_name":"stdout","time":137.885396118,"data":"\n"}
,{"stream_name":"stdout","time":137.885401481,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":137.885405815,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":137.887076924,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.887514851,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.887527856,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.887533168,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":137.887537641,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.88769712,"data":"\n"}
,{"stream_name":"stdout","time":138.325454929,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":138.379467621,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":138.379521657,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.379531611,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.379786173,"data":"\n"}
,{"stream_name":"stdout","time":138.37979838,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":138.379803095,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":138.379812,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.50s/s]\n"}
,{"stream_name":"stdout","time":138.382584372,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.383063769,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.383075554,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.383081074,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":138.3830982,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.383246775,"data":"\n"}
,{"stream_name":"stdout","time":138.626663078,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":138.626710407,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.626717583,"data":"  Original dt: 4.524808e-01 s\n"}
,{"stream_name":"stdout","time":138.62672332,"data":"  Corrected dt: 2.828005e-01 s\n"}
,{"stream_name":"stdout","time":138.626727184,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.626731131,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":138.787569967,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":138.867808613,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":138.867804947,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.86783664,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.868095308,"data":"\n"}
,{"stream_name":"stderr","time":138.868096575,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.95s/s]\n"}
,{"stream_name":"stdout","time":138.8681042,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":138.868113082,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":138.869744034,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.869949711,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.869958919,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.869963939,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":138.869968262,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.87012395,"data":"\n"}
,{"stream_name":"stdout","time":139.239216458,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":139.354563648,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.35459151,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.35456261,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":139.354830455,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.96s/s]\n"}
,{"stream_name":"stdout","time":139.354853995,"data":"\n"}
,{"stream_name":"stdout","time":139.354870235,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":139.354874648,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":139.35649037,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.356815125,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.356827433,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.35683168,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":139.356835433,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.357008758,"data":"\n"}
,{"stream_name":"stdout","time":139.52733941,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":139.527364443,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.527380461,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":139.527385004,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":139.527389054,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.527393096,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":139.689282212,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":139.84197297,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.841998899,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.841989411,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":139.842208724,"data":"\n"}
,{"stream_name":"stdout","time":139.842222823,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":139.84222778,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":139.842219197,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.93s/s]\n"}
,{"stream_name":"stdout","time":139.843760736,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.843779975,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":139.843784407,"data":"\n"}
,{"stream_name":"stdout","time":139.84378852,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.843792914,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":139.843796487,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.843800079,"data":"\n"}
,{"stream_name":"stdout","time":139.843812995,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.843822655,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":139.851432077,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":139.851458833,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":139.851464341,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":139.85148238,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":139.851486821,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":139.851491423,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":139.851495918,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":139.851500155,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":139.85153969,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":139.851558426,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.851564127,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":139.851568428,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":139.852111523,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":139.852122254,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":139.852353581,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":139.852573674,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.852588362,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.85259333,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.854415967,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.854432033,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.854436901,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.854440668,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.854568814,"data":"\n"}
,{"stream_name":"stderr","time":140.229867467,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":140.229926728,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":140.229937482,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.230158746,"data":"\n"}
,{"stream_name":"stderr","time":140.230159275,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.96s/s]\n"}
,{"stream_name":"stdout","time":140.230168857,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":140.23017952,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":140.231754258,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.231967107,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.231990626,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.231994926,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":140.231997547,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.232156448,"data":"\n"}
,{"stream_name":"stdout","time":140.302934615,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":140.441790437,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":140.441817459,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.441823062,"data":"  Original dt: 4.622455e-01 s\n"}
,{"stream_name":"stdout","time":140.441827101,"data":"  Corrected dt: 2.889034e-01 s\n"}
,{"stream_name":"stdout","time":140.441832237,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.441835971,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stderr","time":140.707795571,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.707821737,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.70785669,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":140.708106586,"data":"\n"}
,{"stream_name":"stderr","time":140.708107855,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.53s/s]\n"}
,{"stream_name":"stdout","time":140.7081163,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":140.70812384,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":140.70976007,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.709957016,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.709966431,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.709971441,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":140.709975496,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.710137116,"data":"\n"}
,{"stream_name":"stdout","time":140.764598425,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":141.222886625,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":141.22290886,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":141.22291774,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.222994204,"data":"\n"}
,{"stream_name":"stdout","time":141.223004647,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":141.223010859,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":141.223025914,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.26s/s]\n"}
,{"stream_name":"stdout","time":141.224674017,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.224884672,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.224895211,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.224900414,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":141.224904972,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.225045556,"data":"\n"}
,{"stream_name":"stdout","time":141.252055081,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":141.389583324,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":141.38960785,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.389613172,"data":"  Original dt: 4.526561e-01 s\n"}
,{"stream_name":"stdout","time":141.389616962,"data":"  Corrected dt: 2.829101e-01 s\n"}
,{"stream_name":"stdout","time":141.389622354,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.389626229,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":141.702856527,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":141.712811433,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.712832434,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.712815164,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":141.713042223,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":141.71304707,"data":"\n"}
,{"stream_name":"stdout","time":141.713058324,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":141.713063451,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":141.714672156,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.715044482,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.7150555,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.715060492,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":141.715064831,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.715219009,"data":"\n"}
,{"stream_name":"stdout","time":142.15213636,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":142.196149303,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.19617182,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.196184341,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":142.196286699,"data":"\n"}
,{"stream_name":"stdout","time":142.196295126,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stderr","time":142.196293935,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":142.196299133,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":142.198051845,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.198249889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.1982577,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.198261843,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":142.198265622,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.198442507,"data":"\n"}
,{"stream_name":"stdout","time":142.28855262,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":142.288574057,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.288579878,"data":"  Original dt: 4.524838e-01 s\n"}
,{"stream_name":"stdout","time":142.288584466,"data":"  Corrected dt: 2.828024e-01 s\n"}
,{"stream_name":"stdout","time":142.288588252,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.288591977,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":142.596267428,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":142.676538333,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.676565855,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.676545017,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":142.676851586,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.37s/s]\n"}
,{"stream_name":"stdout","time":142.676860339,"data":"\n"}
,{"stream_name":"stdout","time":142.676873482,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":142.67687792,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":142.678452699,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.678774198,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.678790786,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.678796041,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":142.678800058,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.678940989,"data":"\n"}
,{"stream_name":"stdout","time":143.056386281,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":143.170397279,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":143.170397117,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.170426165,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.170664481,"data":"\n"}
,{"stream_name":"stderr","time":143.170669342,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.52s/s]\n"}
,{"stream_name":"stdout","time":143.17068049,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":143.170694951,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":143.172376035,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.172710464,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.172726568,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.17273167,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":143.172735506,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.172891223,"data":"\n"}
,{"stream_name":"stdout","time":143.192105142,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":143.192122184,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.19212709,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":143.192131078,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":143.192135162,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.192138986,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":143.514085052,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":143.670347374,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.670375019,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.670412034,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":143.670411306,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.16s/s]\n"}
,{"stream_name":"stdout","time":143.67052247,"data":"\n"}
,{"stream_name":"stdout","time":143.670536348,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":143.670540543,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":143.672008794,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":143.672027653,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":143.672077537,"data":"\n"}
,{"stream_name":"stdout","time":143.672089766,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":143.672094662,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":143.672098986,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":143.672103512,"data":"\n"}
,{"stream_name":"stdout","time":143.672107729,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":143.672112382,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":143.679637233,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":143.679656379,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":143.679662205,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":143.679666819,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":143.679671088,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":143.679675828,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":143.679680436,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":143.679685165,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":143.679692561,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":143.679696929,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.679705588,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":143.679709383,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":143.680264869,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":143.680271294,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":143.680592752,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":143.680837647,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.680844335,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.680848635,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":143.682736552,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.682750076,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.682754514,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":143.682758394,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.682907797,"data":"\n"}
,{"stream_name":"stderr","time":144.055613136,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.055635761,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.055674189,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":144.055886232,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.24s/s]\n"}
,{"stream_name":"stdout","time":144.055905012,"data":"\n"}
,{"stream_name":"stdout","time":144.055909797,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":144.05591441,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":144.058066269,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.058359154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.058367053,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.058371866,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":144.058376137,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.058561937,"data":"\n"}
,{"stream_name":"stdout","time":144.112458122,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":144.112479815,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.112485473,"data":"  Original dt: 4.733134e-01 s\n"}
,{"stream_name":"stdout","time":144.11248978,"data":"  Corrected dt: 2.958209e-01 s\n"}
,{"stream_name":"stdout","time":144.112493581,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.112497166,"data":"  Max wave speed detected: 16.90 m/s\n"}
,{"stream_name":"stdout","time":144.129644713,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":144.516669493,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.51670015,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.51666561,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":144.516957802,"data":"\n"}
,{"stream_name":"stdout","time":144.51697362,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":144.5169784,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":144.51701487,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.74s/s]\n"}
,{"stream_name":"stdout","time":144.518570867,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.518867893,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.518879384,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.518884004,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":144.518887765,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.519020683,"data":"\n"}
,{"stream_name":"stdout","time":144.571996243,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":144.989038738,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":144.989067091,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.989073668,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.989296638,"data":"\n"}
,{"stream_name":"stdout","time":144.989308289,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":144.989312379,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":144.989331318,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.91s/s]\n"}
,{"stream_name":"stdout","time":144.990890537,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.99118505,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.991196108,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.991201322,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":144.991204969,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.991353441,"data":"\n"}
,{"stream_name":"stdout","time":145.000888955,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":145.000905205,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.000910022,"data":"  Original dt: 4.528082e-01 s\n"}
,{"stream_name":"stdout","time":145.000913801,"data":"  Corrected dt: 2.830051e-01 s\n"}
,{"stream_name":"stdout","time":145.000917697,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.000921368,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":145.017732469,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":145.459126885,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":145.468054064,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":145.468096984,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.468111289,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.468217794,"data":"\n"}
,{"stream_name":"stdout","time":145.468227874,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":145.468235219,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":145.468259763,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.47s/s]\n"}
,{"stream_name":"stdout","time":145.469789873,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.470210268,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.470217681,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.47022277,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":145.47022735,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.470375678,"data":"\n"}
,{"stream_name":"stdout","time":145.886167961,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":145.886195212,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.88620152,"data":"  Original dt: 4.524884e-01 s\n"}
,{"stream_name":"stdout","time":145.886206076,"data":"  Corrected dt: 2.828052e-01 s\n"}
,{"stream_name":"stdout","time":145.886210154,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.886214497,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":145.902582203,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":145.946722499,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":145.946729395,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.946772574,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.947015933,"data":"\n"}
,{"stream_name":"stdout","time":145.947030798,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":145.947036002,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":145.947038113,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.49s/s]\n"}
,{"stream_name":"stdout","time":145.948647312,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.948928332,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.948939891,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.948944145,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":145.948948333,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.949086685,"data":"\n"}
,{"stream_name":"stdout","time":146.347203084,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":146.425473786,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.425500769,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.425473576,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":146.425760199,"data":"\n"}
,{"stream_name":"stdout","time":146.425774939,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":146.425779399,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":146.425793875,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.48s/s]\n"}
,{"stream_name":"stdout","time":146.427400608,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.427759435,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.427771372,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.427775656,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":146.427779581,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.427928994,"data":"\n"}
,{"stream_name":"stdout","time":146.773069378,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":146.773098585,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.773105751,"data":"  Original dt: 4.524768e-01 s\n"}
,{"stream_name":"stdout","time":146.773110713,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":146.773115642,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.773121968,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":146.789573234,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":146.903466724,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.903490862,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.903536877,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":146.903595753,"data":"\n"}
,{"stream_name":"stdout","time":146.903604048,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":146.903608498,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":146.903609239,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":146.905244962,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.905540357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.905550405,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.905555064,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":146.905558809,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.905725543,"data":"\n"}
,{"stream_name":"stdout","time":147.234615337,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":147.381910264,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":147.381925907,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":147.381935852,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":147.382006122,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.52s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.51s/s]\n"}
,{"stream_name":"stdout","time":147.382018015,"data":"\n"}
,{"stream_name":"stdout","time":147.382027155,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":147.382031899,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":147.383774309,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.383792059,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":147.383796487,"data":"\n"}
,{"stream_name":"stdout","time":147.383800227,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.383804307,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":147.38380813,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.383812031,"data":"\n"}
,{"stream_name":"stdout","time":147.383815636,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":147.383819885,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":147.391228564,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":147.391244645,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":147.391249897,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":147.391254273,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":147.39125849,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":147.39126329,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":147.391267196,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":147.391270821,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":147.391297497,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":147.391325463,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.391330689,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":147.391334371,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":147.391885537,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":147.391899581,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":147.392167026,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":147.392826195,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.392839026,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.392844574,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":147.394629726,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":147.394641529,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":147.394646377,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":147.394650751,"data":"|    ep_rew_mean      | 0.103    |\n"}
,{"stream_name":"stdout","time":147.394654496,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":147.394658329,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":147.394661943,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":147.394667388,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":147.394670975,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":147.394673806,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":147.394676291,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":147.39578555,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.395797275,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.395802354,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":147.395806404,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.395961802,"data":"\n"}
,{"stream_name":"stdout","time":147.689612806,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":147.68964385,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.689649947,"data":"  Original dt: 4.993670e-01 s\n"}
,{"stream_name":"stdout","time":147.689654063,"data":"  Corrected dt: 3.121044e-01 s\n"}
,{"stream_name":"stdout","time":147.689658205,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.689661997,"data":"  Max wave speed detected: 16.02 m/s\n"}
,{"stream_name":"stdout","time":147.78860705,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":147.788612564,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.788638807,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.788801889,"data":"\n"}
,{"stream_name":"stdout","time":147.788809172,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":147.788813698,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":147.788811707,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.21s/s]\n"}
,{"stream_name":"stdout","time":147.790413279,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":147.790764738,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.790776645,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.790781378,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":147.79078535,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.790954288,"data":"\n"}
,{"stream_name":"stdout","time":147.863794843,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":148.263437681,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.263467399,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.26343348,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":148.263665722,"data":"\n"}
,{"stream_name":"stderr","time":148.263667709,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.75s/s]\n"}
,{"stream_name":"stdout","time":148.263680285,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":148.263703781,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":148.265352606,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.26555173,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.265575529,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.265580429,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":148.265584285,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.265765991,"data":"\n"}
,{"stream_name":"stdout","time":148.319436418,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":148.591878879,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":148.591903357,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.591909022,"data":"  Original dt: 4.531092e-01 s\n"}
,{"stream_name":"stdout","time":148.591913327,"data":"  Corrected dt: 2.831933e-01 s\n"}
,{"stream_name":"stdout","time":148.591917014,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.59192066,"data":"  Max wave speed detected: 17.66 m/s\n"}
,{"stream_name":"stderr","time":148.754403532,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.754449582,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.754403529,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":148.754677795,"data":"\n"}
,{"stream_name":"stdout","time":148.754699377,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":148.754705379,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":148.754679223,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.70s/s]\n"}
,{"stream_name":"stdout","time":148.756242186,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":148.756547814,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.756559701,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.756564406,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":148.756568289,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.756735304,"data":"\n"}
,{"stream_name":"stdout","time":148.784054081,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":149.230194693,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":149.239052761,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":149.239095105,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.239105594,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.239298355,"data":"\n"}
,{"stream_name":"stdout","time":149.239318163,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stderr","time":149.2393139,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":149.239322408,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":149.240881888,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.24118017,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.241190892,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.241195478,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":149.24119918,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.241346026,"data":"\n"}
,{"stream_name":"stdout","time":149.507101903,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":149.50713223,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.507138207,"data":"  Original dt: 4.524965e-01 s\n"}
,{"stream_name":"stdout","time":149.507143082,"data":"  Corrected dt: 2.828103e-01 s\n"}
,{"stream_name":"stdout","time":149.507147424,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.507151928,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":149.674165198,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":149.720315343,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":149.720326837,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.720347878,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":149.720689873,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.31s/s]\n"}
,{"stream_name":"stdout","time":149.720710897,"data":"\n"}
,{"stream_name":"stdout","time":149.720727925,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":149.720732738,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":149.722401709,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.72271029,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.72272687,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.722732246,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":149.722736048,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.722872706,"data":"\n"}
,{"stream_name":"stdout","time":150.146570038,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":150.226582134,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.226606523,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.226583145,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":150.226825381,"data":"\n"}
,{"stream_name":"stdout","time":150.226840009,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":150.226844639,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":150.226846763,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.78s/s]\n"}
,{"stream_name":"stdout","time":150.228705294,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":150.228881701,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.228889687,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.228894049,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":150.228898005,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.229084408,"data":"\n"}
,{"stream_name":"stdout","time":150.427877146,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":150.427901419,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.427907357,"data":"  Original dt: 4.524774e-01 s\n"}
,{"stream_name":"stdout","time":150.427911983,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":150.427916151,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.427920259,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":150.597765527,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":150.724451616,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":150.724451612,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.724481825,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":150.724676471,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.28s/s]\n"}
,{"stream_name":"stdout","time":150.724715077,"data":"\n"}
,{"stream_name":"stdout","time":150.724732329,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":150.724736806,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":150.726240608,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.726632045,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.726643379,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.726648868,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":150.726655617,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.72681763,"data":"\n"}
,{"stream_name":"stdout","time":151.089453066,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":151.238907728,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.238930056,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.238968412,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":151.239233639,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.29s/s]\n"}
,{"stream_name":"stdout","time":151.239239203,"data":"\n"}
,{"stream_name":"stdout","time":151.23925046,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":151.239254986,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":151.240822166,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.240838563,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":151.240895881,"data":"\n"}
,{"stream_name":"stdout","time":151.240908747,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.240913922,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":151.240918244,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.240922275,"data":"\n"}
,{"stream_name":"stdout","time":151.240926005,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":151.240930462,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":151.248172781,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":151.248185148,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":151.248190181,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":151.248194579,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":151.248252791,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":151.248385975,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":151.248412301,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":151.248416928,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":151.248420837,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":151.248424451,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.248460746,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":151.248468353,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":151.249055032,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":151.249071666,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":151.24933966,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":151.249571357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.249589477,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.249604045,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":151.251369385,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.251385955,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.25139123,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":151.251395206,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.251521422,"data":"\n"}
,{"stream_name":"stdout","time":151.379767784,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":151.379789754,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.379796484,"data":"  Original dt: 5.619376e-01 s\n"}
,{"stream_name":"stdout","time":151.379801978,"data":"  Corrected dt: 3.512110e-01 s\n"}
,{"stream_name":"stdout","time":151.379806436,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.379810445,"data":"  Max wave speed detected: 14.24 m/s\n"}
,{"stream_name":"stdout","time":151.623110582,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":151.623147132,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.623156523,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.623341996,"data":"\n"}
,{"stream_name":"stdout","time":151.623355447,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":151.62336032,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":151.623378467,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.37s/s]\n"}
,{"stream_name":"stdout","time":151.624912162,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.625189874,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.625200905,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.6252062,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":151.625210014,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.62537463,"data":"\n"}
,{"stream_name":"stdout","time":151.696312047,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":152.093690971,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.093722357,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.093690857,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":152.093868642,"data":"\n"}
,{"stream_name":"stderr","time":152.093874897,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.03s/s]\n"}
,{"stream_name":"stdout","time":152.093882374,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":152.093890127,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":152.095402675,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.095717303,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.09572858,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.095732959,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":152.095736895,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.095901086,"data":"\n"}
,{"stream_name":"stdout","time":152.149691928,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":152.273984097,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":152.27401153,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.27401912,"data":"  Original dt: 4.537314e-01 s\n"}
,{"stream_name":"stdout","time":152.274024085,"data":"  Corrected dt: 2.835821e-01 s\n"}
,{"stream_name":"stdout","time":152.27402898,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.274035571,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":152.561770822,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.56180419,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.561770874,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":152.561944377,"data":"\n"}
,{"stream_name":"stdout","time":152.561978955,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":152.561985778,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":152.561942139,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.20s/s]\n"}
,{"stream_name":"stdout","time":152.563567228,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.563736848,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.563744649,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.563748904,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":152.563752768,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.563927006,"data":"\n"}
,{"stream_name":"stdout","time":152.59123309,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":153.03547424,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":153.044644884,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":153.044663509,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.044683673,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.044893514,"data":"\n"}
,{"stream_name":"stderr","time":153.044894811,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":153.044902836,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":153.044912083,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":153.046532866,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.046935226,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.046942315,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.046946676,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":153.046950512,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.047127287,"data":"\n"}
,{"stream_name":"stdout","time":153.162496703,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":153.162538374,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.16254404,"data":"  Original dt: 4.525114e-01 s\n"}
,{"stream_name":"stdout","time":153.162548344,"data":"  Corrected dt: 2.828196e-01 s\n"}
,{"stream_name":"stdout","time":153.162563643,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.162567509,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":153.480533682,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":153.52397512,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":153.523974579,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.524009378,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.524207168,"data":"\n"}
,{"stream_name":"stdout","time":153.524220312,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":153.524224979,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":153.524263137,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.46s/s]\n"}
,{"stream_name":"stdout","time":153.525878824,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.526062921,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.526071035,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.526075487,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":153.52607934,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.526243663,"data":"\n"}
,{"stream_name":"stdout","time":153.947010047,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":154.029536217,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":154.029544102,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.029573008,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.029882853,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.80s/s]\n"}
,{"stream_name":"stdout","time":154.029887138,"data":"\n"}
,{"stream_name":"stdout","time":154.029904038,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":154.029909372,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":154.03154856,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.03187441,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.031881973,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.031899896,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":154.031904027,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.03205094,"data":"\n"}
,{"stream_name":"stdout","time":154.078012631,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":154.078032616,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.078038172,"data":"  Original dt: 4.524781e-01 s\n"}
,{"stream_name":"stdout","time":154.07804265,"data":"  Corrected dt: 2.827988e-01 s\n"}
,{"stream_name":"stdout","time":154.078046964,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.078050631,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":154.392300197,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":154.507148435,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":154.50715707,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":154.507173403,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.507459067,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.57s/s]\n"}
,{"stream_name":"stdout","time":154.507468056,"data":"\n"}
,{"stream_name":"stdout","time":154.507484014,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":154.507488967,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":154.509296847,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.509543143,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.509556503,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.509562198,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":154.50956617,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.509731359,"data":"\n"}
,{"stream_name":"stdout","time":154.846170259,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":154.973355365,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":154.973389821,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.97339626,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":154.973407423,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":154.97341148,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.973416331,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":155.000188733,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":155.000211405,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.000239968,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.00054632,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":155.000583736,"data":"\n"}
,{"stream_name":"stdout","time":155.000590643,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":155.000595138,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":155.002129257,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.002140705,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":155.00218898,"data":"\n"}
,{"stream_name":"stdout","time":155.002194771,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.002199165,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":155.002203726,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.002208077,"data":"\n"}
,{"stream_name":"stdout","time":155.002212025,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":155.002217028,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":155.009729272,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":155.009747036,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":155.009752416,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":155.009756429,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":155.009760102,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":155.00976451,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":155.009768792,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":155.009772962,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":155.009806613,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":155.009815273,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.009835099,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":155.009841817,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":155.010434753,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":155.010441388,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":155.010751517,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":155.01100262,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.011020291,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.011024942,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.012884646,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.012903615,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.01290977,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.012914322,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.012934634,"data":"\n"}
,{"stream_name":"stdout","time":155.387778192,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":155.387811937,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.387828765,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.387993229,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.02s/s]\n"}
,{"stream_name":"stdout","time":155.387997175,"data":"\n"}
,{"stream_name":"stdout","time":155.388010646,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":155.388014795,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":155.389533667,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.389817158,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.389828163,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.389832903,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":155.389836766,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.38999953,"data":"\n"}
,{"stream_name":"stdout","time":155.461257797,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":155.862436194,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.862460655,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.862435609,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":155.86273369,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.74s/s]\n"}
,{"stream_name":"stdout","time":155.862738592,"data":"\n"}
,{"stream_name":"stdout","time":155.862753224,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":155.862757797,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":155.864391326,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.883372347,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":155.883569561,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.883582046,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.883586581,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.883590544,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.88377368,"data":"\n"}
,{"stream_name":"stdout","time":155.912254134,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":155.912273806,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.91227866,"data":"  Original dt: 4.549596e-01 s\n"}
,{"stream_name":"stdout","time":155.912282407,"data":"  Corrected dt: 2.843498e-01 s\n"}
,{"stream_name":"stdout","time":155.91228612,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.912289679,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":155.937349652,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":156.368693386,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":156.368720349,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.36873719,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.368905489,"data":"\n"}
,{"stream_name":"stdout","time":156.368914624,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":156.368919525,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":156.368926807,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.93s/s]\n"}
,{"stream_name":"stdout","time":156.370556524,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.370785031,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.370795918,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.370801165,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":156.370805723,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.37096608,"data":"\n"}
,{"stream_name":"stdout","time":156.397725472,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":156.811214045,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":156.811257971,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.81126397,"data":"  Original dt: 4.525349e-01 s\n"}
,{"stream_name":"stdout","time":156.81126754,"data":"  Corrected dt: 2.828343e-01 s\n"}
,{"stream_name":"stdout","time":156.811271201,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.811276271,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":156.836002826,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":156.844853155,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.844872305,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.844853172,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":156.845026263,"data":"\n"}
,{"stream_name":"stdout","time":156.845035521,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":156.845040314,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":156.845057962,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.66s/s]\n"}
,{"stream_name":"stdout","time":156.84655202,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.846982836,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.846990457,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.846995247,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":156.846999447,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.847152588,"data":"\n"}
,{"stream_name":"stdout","time":157.281575019,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":157.325248782,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":157.325251702,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":157.325275746,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.325355091,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.39s/s]\n"}
,{"stream_name":"stdout","time":157.325362078,"data":"\n"}
,{"stream_name":"stdout","time":157.325384911,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":157.325391398,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":157.326892838,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.327209433,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.327232885,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.327237701,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":157.327241465,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.327388676,"data":"\n"}
,{"stream_name":"stdout","time":157.699089831,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":157.699116342,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.699122162,"data":"  Original dt: 4.524791e-01 s\n"}
,{"stream_name":"stdout","time":157.699126341,"data":"  Corrected dt: 2.827995e-01 s\n"}
,{"stream_name":"stdout","time":157.699130592,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.699134233,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":157.725918802,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":157.806532252,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":157.806549737,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.806566223,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.80684387,"data":"\n"}
,{"stream_name":"stderr","time":157.806845805,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.30s/s]\n"}
,{"stream_name":"stdout","time":157.806854183,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":157.806866674,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":157.808644256,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.808944417,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.808950933,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.808955175,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":157.808959093,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.80915025,"data":"\n"}
,{"stream_name":"stdout","time":158.176380859,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":158.290450773,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":158.290473011,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.290487986,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.290709624,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.17s/s]\n"}
,{"stream_name":"stdout","time":158.290714574,"data":"\n"}
,{"stream_name":"stdout","time":158.290756579,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":158.290762294,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.29234207,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.292691749,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.292706791,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.292712544,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":158.292716821,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.292837284,"data":"\n"}
,{"stream_name":"stdout","time":158.594416628,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":158.594442283,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.594448431,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":158.594452563,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":158.594456322,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.594459878,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":158.62182961,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":158.773804738,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":158.773802482,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.77382958,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.774075509,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.18s/s]\n"}
,{"stream_name":"stdout","time":158.774093127,"data":"\n"}
,{"stream_name":"stdout","time":158.774100248,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":158.774104575,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.775621025,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.775634442,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":158.775680742,"data":"\n"}
,{"stream_name":"stdout","time":158.775686687,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":158.775690917,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":158.775695394,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":158.775713617,"data":"\n"}
,{"stream_name":"stdout","time":158.775717712,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":158.775721612,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":158.782973665,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":158.782986508,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":158.782990892,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":158.782995117,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":158.783001442,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":158.783151251,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":158.783157928,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":158.783162379,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":158.783166214,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":158.78316978,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.783212036,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":158.783219963,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":158.783811333,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":158.783822258,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":158.784091274,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":158.784316318,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.784324979,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.784330135,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":158.786154061,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.78616843,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.786173445,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":158.786177791,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.78631832,"data":"\n"}
,{"stream_name":"stderr","time":159.181727737,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.181762887,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.181727075,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":159.182044955,"data":"\n"}
,{"stream_name":"stderr","time":159.182045683,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.93s/s]\n"}
,{"stream_name":"stdout","time":159.182058752,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":159.182093125,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":159.183572125,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.183876158,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.183888866,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.183893954,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.18389764,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.184042302,"data":"\n"}
,{"stream_name":"stdout","time":159.255346313,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":159.523526089,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":159.523551719,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.523556059,"data":"  Original dt: 4.575046e-01 s\n"}
,{"stream_name":"stdout","time":159.523558726,"data":"  Corrected dt: 2.859404e-01 s\n"}
,{"stream_name":"stdout","time":159.523561388,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.523563883,"data":"  Max wave speed detected: 17.49 m/s\n"}
,{"stream_name":"stderr","time":159.647206693,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.647229388,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.647236284,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":159.647396258,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.39s/s]\n"}
,{"stream_name":"stdout","time":159.647420013,"data":"\n"}
,{"stream_name":"stdout","time":159.647430343,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":159.647434823,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":159.649214824,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.649456825,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.649467917,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.64947272,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.64947738,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.649659698,"data":"\n"}
,{"stream_name":"stdout","time":159.703059139,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":160.125053912,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":160.125053908,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.125085205,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.125194683,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":160.125216641,"data":"\n"}
,{"stream_name":"stdout","time":160.125225508,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":160.125230331,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":160.12682341,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.127102822,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.127113644,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.127118276,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":160.127122369,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.127268989,"data":"\n"}
,{"stream_name":"stdout","time":160.153860623,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":160.420661615,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":160.420687931,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.420693249,"data":"  Original dt: 4.525806e-01 s\n"}
,{"stream_name":"stdout","time":160.420696971,"data":"  Corrected dt: 2.828629e-01 s\n"}
,{"stream_name":"stdout","time":160.420700561,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.420704066,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":160.598362913,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":160.610062562,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":160.61007614,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.610093357,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.61039992,"data":"\n"}
,{"stream_name":"stdout","time":160.610410872,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":160.610415313,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":160.610428336,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.06s/s]\n"}
,{"stream_name":"stdout","time":160.61201048,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.612431342,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.612438803,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.612442987,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":160.612446809,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.612655166,"data":"\n"}
,{"stream_name":"stdout","time":161.076990843,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":161.121829387,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.121851128,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.121829383,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":161.122040201,"data":"\n"}
,{"stream_name":"stderr","time":161.122040309,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.46s/s]\n"}
,{"stream_name":"stdout","time":161.122048267,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":161.122056126,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":161.124141006,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.124457914,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.12446649,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.124471395,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":161.124475647,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.12466817,"data":"\n"}
,{"stream_name":"stdout","time":161.35007102,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":161.350098036,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.35010439,"data":"  Original dt: 4.524811e-01 s\n"}
,{"stream_name":"stdout","time":161.35010852,"data":"  Corrected dt: 2.828007e-01 s\n"}
,{"stream_name":"stdout","time":161.350112959,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.350117172,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":161.53382292,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":161.616890822,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":161.616944378,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.616964442,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":161.61721552,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.47s/s]\n"}
,{"stream_name":"stdout","time":161.617222062,"data":"\n"}
,{"stream_name":"stdout","time":161.61724906,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":161.617253533,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":161.618956984,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.619298501,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.619305954,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.619310965,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":161.61931527,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.619493571,"data":"\n"}
,{"stream_name":"stdout","time":161.983528898,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.100007802,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.10004559,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.100007018,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":162.10020782,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.22s/s]\n"}
,{"stream_name":"stdout","time":162.100216638,"data":"\n"}
,{"stream_name":"stdout","time":162.100228865,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":162.100233482,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":162.101858845,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.102058911,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.102069585,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.102074546,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.102078772,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.102238831,"data":"\n"}
,{"stream_name":"stdout","time":162.254363477,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":162.25438818,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.254394522,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":162.254398527,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":162.254402147,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.254418798,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":162.431630307,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.581725718,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.581752288,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.581737281,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":162.581915988,"data":"\n"}
,{"stream_name":"stderr","time":162.581921565,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.28s/s]\n"}
,{"stream_name":"stdout","time":162.581927786,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":162.581940445,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":162.583458541,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.583474708,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":162.583481261,"data":"\n"}
,{"stream_name":"stdout","time":162.58348716,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.58349293,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":162.583499595,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.583523456,"data":"\n"}
,{"stream_name":"stdout","time":162.583548768,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":162.583566398,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":162.591273949,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":162.591287116,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":162.591293421,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":162.591298726,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":162.59136504,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":162.591482188,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":162.591492842,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":162.591498056,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":162.591518722,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":162.591538589,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.591544993,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":162.591549865,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":162.592252576,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":162.592259979,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":162.592587091,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":162.593226951,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.593233615,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.593238291,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":162.595111186,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":162.595121507,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":162.595125839,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":162.595129978,"data":"|    ep_rew_mean      | 0.104    |\n"}
,{"stream_name":"stdout","time":162.595134144,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":162.595137764,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":162.595141391,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":162.595145029,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":162.595150116,"data":"|    time_elapsed     | 32       |\n"}
,{"stream_name":"stdout","time":162.595155368,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":162.595159509,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":162.596267229,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.596277504,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.596282303,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":162.596286567,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.59644297,"data":"\n"}
,{"stream_name":"stdout","time":162.969787667,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":162.969787662,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.969816685,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.969989025,"data":"\n"}
,{"stream_name":"stderr","time":162.969986488,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.18s/s]\n"}
,{"stream_name":"stdout","time":162.970002282,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":162.97001993,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":162.97168638,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.971932275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.971956183,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.97196216,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.971966959,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.972100929,"data":"\n"}
,{"stream_name":"stdout","time":163.043091376,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":163.156795053,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":163.156817267,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.156823432,"data":"  Original dt: 4.631167e-01 s\n"}
,{"stream_name":"stdout","time":163.156827578,"data":"  Corrected dt: 2.894480e-01 s\n"}
,{"stream_name":"stdout","time":163.156831831,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.156836574,"data":"  Max wave speed detected: 17.27 m/s\n"}
,{"stream_name":"stderr","time":163.427682278,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.427708748,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.427724376,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":163.427917468,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.93s/s]\n"}
,{"stream_name":"stdout","time":163.427928964,"data":"\n"}
,{"stream_name":"stdout","time":163.427941961,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":163.427946006,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":163.429618637,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.429914069,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.429922713,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.429927689,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":163.429931663,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.430075033,"data":"\n"}
,{"stream_name":"stdout","time":163.483050637,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":163.896825884,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.896870307,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.896825537,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":163.897035483,"data":"\n"}
,{"stream_name":"stdout","time":163.897044258,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":163.897049494,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":163.897067921,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.14s/s]\n"}
,{"stream_name":"stdout","time":163.898605949,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.898953382,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.898961101,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.898965412,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":163.898969797,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.899133551,"data":"\n"}
,{"stream_name":"stdout","time":163.925282734,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":164.05211054,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":164.052135642,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.052142217,"data":"  Original dt: 4.526702e-01 s\n"}
,{"stream_name":"stdout","time":164.05214601,"data":"  Corrected dt: 2.829189e-01 s\n"}
,{"stream_name":"stdout","time":164.052150268,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.052154265,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":164.376658767,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":164.386091971,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.386113799,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.386122209,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":164.386252168,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":164.38632069,"data":"\n"}
,{"stream_name":"stdout","time":164.386352474,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":164.386358463,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":164.388342935,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.388682559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.388695404,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.388699825,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":164.388703765,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.388875796,"data":"\n"}
,{"stream_name":"stdout","time":164.824119649,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":164.868755191,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.868778217,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.868759347,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":164.869046085,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.26s/s]\n"}
,{"stream_name":"stdout","time":164.869054129,"data":"\n"}
,{"stream_name":"stdout","time":164.86906375,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":164.869068422,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":164.870696377,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.870937586,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.870946717,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.87095164,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":164.870955973,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.871117289,"data":"\n"}
,{"stream_name":"stdout","time":164.943136783,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":164.94315923,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.943165429,"data":"  Original dt: 4.524843e-01 s\n"}
,{"stream_name":"stdout","time":164.943170162,"data":"  Corrected dt: 2.828027e-01 s\n"}
,{"stream_name":"stdout","time":164.943174182,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.943178447,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":165.27058464,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":165.35180726,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":165.351807563,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.351843105,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.352107593,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":165.352127937,"data":"\n"}
,{"stream_name":"stdout","time":165.352136708,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":165.352140817,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":165.353955813,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.354303706,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.354311188,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.354315818,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":165.354320313,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.354534815,"data":"\n"}
,{"stream_name":"stdout","time":165.726640943,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":165.845904652,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":165.845950042,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.845961089,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.846174752,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.53s/s]\n"}
,{"stream_name":"stdout","time":165.846181053,"data":"\n"}
,{"stream_name":"stdout","time":165.846197378,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":165.846202391,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":165.847962204,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":165.848150355,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.848160424,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.848165197,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":165.848169168,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.848334745,"data":"\n"}
,{"stream_name":"stdout","time":165.849551897,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":165.849580039,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.849592352,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":165.849596067,"data":"  Corrected dt: 2.827979e-01 s\n"}
,{"stream_name":"stdout","time":165.849600057,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.849603783,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":166.201095454,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":166.356072062,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":166.356061261,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.356102164,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.356314918,"data":"\n"}
,{"stream_name":"stdout","time":166.356323796,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stderr","time":166.356317314,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.54s/s]\n"}
,{"stream_name":"stdout","time":166.356328108,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":166.358332277,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.358351141,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":166.358355514,"data":"\n"}
,{"stream_name":"stdout","time":166.358360799,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.358364927,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":166.358368746,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.358371998,"data":"\n"}
,{"stream_name":"stdout","time":166.358374494,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":166.358383946,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":166.365944149,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":166.365962853,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":166.365966575,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":166.365969127,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":166.365971672,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":166.36597421,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":166.365976787,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":166.36597917,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":166.365989187,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":166.365992945,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.365998401,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":166.366009885,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":166.366656276,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":166.366669098,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":166.366905403,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":166.367157742,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.367164556,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.367168619,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.369100329,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.369113167,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.369117628,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.369121505,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.369296011,"data":"\n"}
,{"stream_name":"stderr","time":166.742378303,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.74240516,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.742444138,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":166.742462588,"data":"\n"}
,{"stream_name":"stdout","time":166.742467177,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":166.742471288,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":166.742465618,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.22s/s]\n"}
,{"stream_name":"stdout","time":166.744115111,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.744328305,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.744338778,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.744343634,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":166.744348317,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.744538219,"data":"\n"}
,{"stream_name":"stdout","time":166.780829504,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":166.780848454,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.780854016,"data":"  Original dt: 4.753954e-01 s\n"}
,{"stream_name":"stdout","time":166.780858222,"data":"  Corrected dt: 2.971221e-01 s\n"}
,{"stream_name":"stdout","time":166.780861776,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.780865465,"data":"  Max wave speed detected: 16.83 m/s\n"}
,{"stream_name":"stdout","time":166.814251614,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":167.200332405,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":167.200352315,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":167.200360605,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":167.200444665,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.92s/s]\n"}
,{"stream_name":"stdout","time":167.200488038,"data":"\n"}
,{"stream_name":"stdout","time":167.200494865,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":167.200498715,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":167.202157917,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.20234442,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.202356003,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.202360328,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":167.202373448,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.202537868,"data":"\n"}
,{"stream_name":"stdout","time":167.255054889,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":167.661304888,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":167.661331878,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.66133993,"data":"  Original dt: 4.528333e-01 s\n"}
,{"stream_name":"stdout","time":167.661345765,"data":"  Corrected dt: 2.830208e-01 s\n"}
,{"stream_name":"stdout","time":167.661351114,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.661356352,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":167.670117674,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":167.670130541,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.670145025,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.670415942,"data":"\n"}
,{"stream_name":"stdout","time":167.670427565,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stderr","time":167.670426093,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.09s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.07s/s]\n"}
,{"stream_name":"stdout","time":167.670433022,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":167.67212529,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.672451936,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.67246145,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.672466726,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":167.672471681,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.672664726,"data":"\n"}
,{"stream_name":"stdout","time":167.700702934,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":168.144527715,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":168.153803912,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":168.153807298,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.153839727,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.15408007,"data":"\n"}
,{"stream_name":"stdout","time":168.154093504,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":168.154098032,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":168.154104274,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.17s/s]\n"}
,{"stream_name":"stdout","time":168.155545982,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.155984511,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.15599183,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.155995896,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":168.156001461,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.156168455,"data":"\n"}
,{"stream_name":"stdout","time":168.548219664,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":168.548245297,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.548251667,"data":"  Original dt: 4.524892e-01 s\n"}
,{"stream_name":"stdout","time":168.548255902,"data":"  Corrected dt: 2.828057e-01 s\n"}
,{"stream_name":"stdout","time":168.548259606,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.548263175,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":168.582300434,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":168.627732977,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":168.627756004,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.627765508,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.628033448,"data":"\n"}
,{"stream_name":"stdout","time":168.628042333,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":168.628046954,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":168.628043297,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.80s/s]\n"}
,{"stream_name":"stdout","time":168.62981626,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.630154438,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.630161795,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.63016598,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":168.63016972,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.630364958,"data":"\n"}
,{"stream_name":"stdout","time":169.049091847,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":169.128932732,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":169.128933536,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.128960233,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.129271398,"data":"\n"}
,{"stream_name":"stdout","time":169.129285984,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":169.129291252,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":169.129291571,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.08s/s]\n"}
,{"stream_name":"stdout","time":169.13105498,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.13130825,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.131318828,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.131323874,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":169.131328139,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.13149648,"data":"\n"}
,{"stream_name":"stdout","time":169.471215235,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":169.471242144,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.471247629,"data":"  Original dt: 4.524769e-01 s\n"}
,{"stream_name":"stdout","time":169.471251714,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":169.471255976,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.471259643,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":169.505414219,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":169.620801567,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.620872474,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.620854519,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":169.621080364,"data":"\n"}
,{"stream_name":"stdout","time":169.621090596,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":169.621094882,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":169.621106826,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.65s/s]\n"}
,{"stream_name":"stdout","time":169.622777792,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.622966558,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.622976335,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.622981249,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":169.62298584,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.623149841,"data":"\n"}
,{"stream_name":"stdout","time":169.952789594,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":170.10341892,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":170.10341923,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.103466733,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.103529921,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.24s/s]\n"}
,{"stream_name":"stdout","time":170.103557197,"data":"\n"}
,{"stream_name":"stdout","time":170.103569137,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":170.103573789,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":170.105198452,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.105214676,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":170.105219172,"data":"\n"}
,{"stream_name":"stdout","time":170.105222974,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.10522693,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":170.105230788,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.105234737,"data":"\n"}
,{"stream_name":"stdout","time":170.1052385,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":170.10524261,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":170.112839644,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":170.112856941,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":170.112861346,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":170.112865253,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":170.112868691,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":170.11287228,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":170.112876063,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":170.112879483,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":170.112883078,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":170.112886862,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.112895766,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":170.112899583,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":170.113477754,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":170.11348851,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":170.113748657,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":170.113959213,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.113969046,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.113973476,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.115765568,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.115781842,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.115786472,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":170.115790117,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.115938282,"data":"\n"}
,{"stream_name":"stdout","time":170.370811532,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":170.370837503,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.370843626,"data":"  Original dt: 5.044045e-01 s\n"}
,{"stream_name":"stdout","time":170.370847583,"data":"  Corrected dt: 3.152528e-01 s\n"}
,{"stream_name":"stdout","time":170.370851243,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.370854815,"data":"  Max wave speed detected: 15.86 m/s\n"}
,{"stream_name":"stdout","time":170.487329373,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":170.487364283,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.487375017,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.487586846,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.38s/s]\n"}
,{"stream_name":"stdout","time":170.487604071,"data":"\n"}
,{"stream_name":"stdout","time":170.487618089,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":170.487621916,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":170.489236903,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.489546707,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.489559153,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.489563971,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.489567702,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.489764994,"data":"\n"}
,{"stream_name":"stdout","time":170.560012293,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":170.978827533,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":170.978875518,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.978897276,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.979077644,"data":"\n"}
,{"stream_name":"stdout","time":170.979088173,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":170.979092688,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":170.979089809,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.67s/s]\n"}
,{"stream_name":"stdout","time":170.980794998,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.981014091,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.981023039,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.981028254,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":170.981032894,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.981190751,"data":"\n"}
,{"stream_name":"stdout","time":171.036117698,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":171.298203429,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":171.298229424,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.298235183,"data":"  Original dt: 4.531593e-01 s\n"}
,{"stream_name":"stdout","time":171.298239387,"data":"  Corrected dt: 2.832246e-01 s\n"}
,{"stream_name":"stdout","time":171.298260958,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.298265859,"data":"  Max wave speed detected: 17.65 m/s\n"}
,{"stream_name":"stderr","time":171.456139407,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.456165922,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.456150615,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":171.456243602,"data":"\n"}
,{"stream_name":"stdout","time":171.456250614,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":171.456255258,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":171.456259805,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.59s/s]\n"}
,{"stream_name":"stdout","time":171.457864411,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":171.458064557,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.458073336,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.458078204,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":171.458082284,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.458256059,"data":"\n"}
,{"stream_name":"stdout","time":171.485540934,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":171.930656828,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":171.939855898,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":171.939873037,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":171.939879508,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":171.940215371,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":171.940230151,"data":"\n"}
,{"stream_name":"stdout","time":171.940243735,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":171.940262406,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":171.941895472,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.942300525,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.942309321,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.942325697,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":171.942330055,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.94252741,"data":"\n"}
,{"stream_name":"stdout","time":172.198380909,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":172.198406842,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.198411964,"data":"  Original dt: 4.524978e-01 s\n"}
,{"stream_name":"stdout","time":172.198416412,"data":"  Corrected dt: 2.828112e-01 s\n"}
,{"stream_name":"stdout","time":172.198420148,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.198423879,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":172.384589972,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":172.430177286,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":172.43019103,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":172.430198147,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":172.4304602,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.76s/s]\n"}
,{"stream_name":"stdout","time":172.430460875,"data":"\n"}
,{"stream_name":"stdout","time":172.430477898,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":172.430482566,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":172.43214242,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.432332319,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.432344065,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.432352672,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":172.432356686,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.432526819,"data":"\n"}
,{"stream_name":"stdout","time":172.832838877,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":172.912204859,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.912227455,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.91223046,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":172.912348026,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.28s/s]\n"}
,{"stream_name":"stdout","time":172.912358262,"data":"\n"}
,{"stream_name":"stdout","time":172.91236848,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":172.9123851,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":172.913971688,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.914156584,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.9141671,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.914171739,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":172.914175527,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.914317236,"data":"\n"}
,{"stream_name":"stdout","time":173.094458446,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":173.094485393,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.094491077,"data":"  Original dt: 4.524775e-01 s\n"}
,{"stream_name":"stdout","time":173.094495767,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":173.094499989,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.094522824,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":173.279029763,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":173.394876023,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.394920748,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.394875399,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":173.395106087,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.21s/s]\n"}
,{"stream_name":"stdout","time":173.395112697,"data":"\n"}
,{"stream_name":"stdout","time":173.395129461,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":173.395135793,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":173.396850786,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.397105247,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.397117576,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.397124356,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":173.397129659,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.397299652,"data":"\n"}
,{"stream_name":"stdout","time":173.735458649,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":173.886418706,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":173.886459521,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.886470884,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":173.886573017,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.67s/s]\n"}
,{"stream_name":"stdout","time":173.886612167,"data":"\n"}
,{"stream_name":"stdout","time":173.886626891,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":173.886631301,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":173.888214889,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.888234295,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":173.88823995,"data":"\n"}
,{"stream_name":"stdout","time":173.88824368,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.888247495,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":173.888252179,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.888256,"data":"\n"}
,{"stream_name":"stdout","time":173.888260113,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":173.888264746,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":173.895747225,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":173.895765861,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":173.895771916,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":173.895775723,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":173.895779315,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":173.89582918,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":173.895837085,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":173.895841431,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":173.895891143,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":173.895897168,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.895901289,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":173.895904885,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":173.896463326,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":173.896474686,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":173.896731007,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":173.896935102,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.896945345,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.896950003,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":173.898684963,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.898701302,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.898706058,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":173.898713712,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.898842405,"data":"\n"}
,{"stream_name":"stdout","time":174.006097585,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":174.00611712,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.006122105,"data":"  Original dt: 5.781369e-01 s\n"}
,{"stream_name":"stdout","time":174.006124758,"data":"  Corrected dt: 3.613356e-01 s\n"}
,{"stream_name":"stdout","time":174.006127999,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.006131701,"data":"  Max wave speed detected: 13.84 m/s\n"}
,{"stream_name":"stderr","time":174.268810773,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.268840555,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.268811968,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":174.268939328,"data":"\n"}
,{"stream_name":"stdout","time":174.268953294,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":174.268958926,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":174.26897326,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.55s/s]\n"}
,{"stream_name":"stdout","time":174.270594328,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.270893745,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.270900758,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.270905068,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":174.270908977,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.271075579,"data":"\n"}
,{"stream_name":"stdout","time":174.339704607,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":174.731815661,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.731844741,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.731827485,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":174.731993678,"data":"\n"}
,{"stream_name":"stdout","time":174.7320048,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":174.732009005,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":174.732031983,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.56s/s]\n"}
,{"stream_name":"stdout","time":174.733525989,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.733824381,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.733836021,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.733840407,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":174.733844479,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.73397731,"data":"\n"}
,{"stream_name":"stdout","time":174.786631469,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":174.893649504,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":174.893667221,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.893672239,"data":"  Original dt: 4.538353e-01 s\n"}
,{"stream_name":"stdout","time":174.89367594,"data":"  Corrected dt: 2.836471e-01 s\n"}
,{"stream_name":"stdout","time":174.893679921,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.893683764,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":175.203472552,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.203496747,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.203479525,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":175.203576717,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.95s/s]\n"}
,{"stream_name":"stdout","time":175.203604483,"data":"\n"}
,{"stream_name":"stdout","time":175.203609195,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":175.203613442,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":175.205265061,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.205555745,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.205571944,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.205590173,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":175.205603489,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.205735508,"data":"\n"}
,{"stream_name":"stdout","time":175.232015499,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":175.672500251,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":175.681706778,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.681732495,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.68170677,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":175.681882234,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.52s/s]\n"}
,{"stream_name":"stdout","time":175.681894757,"data":"\n"}
,{"stream_name":"stdout","time":175.681912006,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":175.681916939,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":175.683534438,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.683974798,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.683984371,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.683988951,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":175.683992918,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.684164404,"data":"\n"}
,{"stream_name":"stdout","time":175.786732863,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":175.78675345,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.786758525,"data":"  Original dt: 4.525136e-01 s\n"}
,{"stream_name":"stdout","time":175.786761606,"data":"  Corrected dt: 2.828210e-01 s\n"}
,{"stream_name":"stdout","time":175.786764076,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.786766706,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":176.126346079,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":176.170871893,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.17089236,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.170870725,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":176.171111014,"data":"\n"}
,{"stream_name":"stdout","time":176.171125184,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":176.171130073,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":176.171137251,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.82s/s]\n"}
,{"stream_name":"stdout","time":176.173165304,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.173478935,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.173490131,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.173494586,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":176.173498906,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.173667264,"data":"\n"}
,{"stream_name":"stdout","time":176.572706629,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":176.653996162,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.654022055,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.654029119,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":176.654245489,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.23s/s]\n"}
,{"stream_name":"stdout","time":176.65424835,"data":"\n"}
,{"stream_name":"stdout","time":176.654262929,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":176.654267308,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":176.655789721,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.656071006,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.656077604,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.656081638,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":176.65608577,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.656253816,"data":"\n"}
,{"stream_name":"stdout","time":176.684263168,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":176.684282783,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.684288527,"data":"  Original dt: 4.524782e-01 s\n"}
,{"stream_name":"stdout","time":176.684292784,"data":"  Corrected dt: 2.827989e-01 s\n"}
,{"stream_name":"stdout","time":176.684296505,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.684300077,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":177.014386053,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":177.131729342,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":177.131739777,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":177.131753892,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.131847847,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":177.131916805,"data":"\n"}
,{"stream_name":"stdout","time":177.131924539,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":177.131929328,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":177.13337018,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.133687352,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.133698646,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.133703097,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":177.133707087,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.133860858,"data":"\n"}
,{"stream_name":"stdout","time":177.465285055,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":177.578569551,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":177.578594053,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.578599038,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":177.578603009,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":177.578606619,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.578610741,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":177.622921657,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":177.622955937,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.62297307,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.623498753,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.65s/s]\n"}
,{"stream_name":"stdout","time":177.623519601,"data":"\n"}
,{"stream_name":"stdout","time":177.623542366,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":177.623547762,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":177.625053825,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.625083816,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":177.625093228,"data":"\n"}
,{"stream_name":"stdout","time":177.625098018,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.625102584,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":177.625106798,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.625111174,"data":"\n"}
,{"stream_name":"stdout","time":177.625115953,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.625120449,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.632359221,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.632382194,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.632387082,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.632391164,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.632396207,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.632545308,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.632557249,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.632561828,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.632571382,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.632593054,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.632625363,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.63263065,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.633191975,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.633204372,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.633464676,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.633706548,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.633721399,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.63372632,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":177.635535417,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":177.63555144,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":177.635555619,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":177.635559671,"data":"|    ep_rew_mean      | 0.106    |\n"}
,{"stream_name":"stdout","time":177.635563128,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":177.635566843,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":177.635570784,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":177.635574389,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":177.635597599,"data":"|    time_elapsed     | 47       |\n"}
,{"stream_name":"stdout","time":177.635601701,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":177.635605393,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":177.636539626,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.636555959,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.636560955,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":177.636564792,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.636707252,"data":"\n"}
,{"stream_name":"stdout","time":178.018856268,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":178.018901581,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.018907757,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.019107712,"data":"\n"}
,{"stream_name":"stderr","time":178.019108517,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.25s/s]\n"}
,{"stream_name":"stdout","time":178.019120971,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":178.019130542,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":178.020893223,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.021102889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.02111279,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.021117102,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":178.021120681,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.021287359,"data":"\n"}
,{"stream_name":"stdout","time":178.093641176,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":178.487207581,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":178.487222384,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.487248074,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.487471047,"data":"\n"}
,{"stream_name":"stdout","time":178.487483375,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":178.48749515,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":178.487481044,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.19s/s]\n"}
,{"stream_name":"stdout","time":178.489174245,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.489379024,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.489387543,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.489392722,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":178.48939712,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.489573732,"data":"\n"}
,{"stream_name":"stdout","time":178.499883191,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":178.499902736,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.499908311,"data":"  Original dt: 4.551811e-01 s\n"}
,{"stream_name":"stdout","time":178.499911988,"data":"  Corrected dt: 2.844882e-01 s\n"}
,{"stream_name":"stdout","time":178.499916334,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.499920233,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":178.543730639,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":178.967465281,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.967494221,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.967520193,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":178.967778885,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.39s/s]\n"}
,{"stream_name":"stdout","time":178.967784089,"data":"\n"}
,{"stream_name":"stdout","time":178.967800783,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":178.967805878,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":178.969562578,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.969871651,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.969883773,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.969888959,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":178.969893455,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.970046279,"data":"\n"}
,{"stream_name":"stdout","time":178.999169419,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":179.401113508,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":179.401137253,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.401142653,"data":"  Original dt: 4.525391e-01 s\n"}
,{"stream_name":"stdout","time":179.401160783,"data":"  Corrected dt: 2.828370e-01 s\n"}
,{"stream_name":"stdout","time":179.401164956,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.401168648,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":179.444102322,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":179.453113966,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":179.453116135,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.453153919,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.453236747,"data":"\n"}
,{"stream_name":"stdout","time":179.453244845,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stderr","time":179.453242368,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.06s/s]\n"}
,{"stream_name":"stdout","time":179.453249622,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":179.454828878,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":179.468861835,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":179.469007863,"data":"\n"}
,{"stream_name":"stdout","time":179.469018259,"data":"✅ Training completed in 0.8 minutes (49.4s)\n"}
,{"stream_name":"stdout","time":179.472545955,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:49 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":179.472565583,"data":"\n"}
,{"stream_name":"stdout","time":179.472571145,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.472602393,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":179.472607285,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.472611583,"data":"\n"}
,{"stream_name":"stdout","time":179.477372136,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":179.477553345,"data":"2025-10-15 19:49:33 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":179.477793742,"data":"2025-10-15 19:49:33 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":179.478011541,"data":"2025-10-15 19:49:33 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":179.478237437,"data":"2025-10-15 19:49:33 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_a6721e38_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":179.478247232,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_a6721e38_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":179.478468507,"data":"\n"}
,{"stream_name":"stdout","time":179.478490362,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":179.478494788,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":179.478498944,"data":"\n"}
,{"stream_name":"stdout","time":179.478522135,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":179.478526775,"data":"2025-10-15 19:49:33 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.478600263,"data":"2025-10-15 19:49:33 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":179.478684134,"data":"2025-10-15 19:49:33 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":179.478764132,"data":"2025-10-15 19:49:33 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.483158992,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.483272774,"data":"2025-10-15 19:49:33 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.483351067,"data":"2025-10-15 19:49:33 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":179.483470744,"data":"2025-10-15 19:49:33 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":179.483531437,"data":"2025-10-15 19:49:33 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":179.483590997,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":179.483600604,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":179.483812636,"data":"2025-10-15 19:49:33 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":179.48397273,"data":"2025-10-15 19:49:33 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":179.484375048,"data":"2025-10-15 19:49:33 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":179.484499736,"data":"2025-10-15 19:49:33 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":179.484532725,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":179.484538722,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":179.484542713,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":179.484546832,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":179.484656408,"data":"2025-10-15 19:49:33 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":179.484667044,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":179.484671642,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":179.484676136,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":179.484695275,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":179.484862314,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.484872487,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":179.484976305,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.485036561,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":179.485117995,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.48519815,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":179.485293518,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":179.485452193,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":179.485516767,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.485542388,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":179.485656798,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":179.486052102,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.486061511,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.495471087,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.495487485,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.495492204,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.495498486,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.495527602,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.495669635,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.495677178,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.495682182,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.495687086,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.495692102,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.495750705,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.495763867,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.496421668,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.496434284,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.496816147,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.496833547,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":179.496839297,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.496843675,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":179.496848202,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":179.496852744,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":179.496857241,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":179.496980421,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":179.497065616,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":179.497073153,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.497190028,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.497221028,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.497230388,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.505253181,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.505270925,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.505276263,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.505280983,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.505285262,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.505404323,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.50541392,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.5054198,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.505424453,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.505428481,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.505442932,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.50544726,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.506131286,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.50614999,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.506403907,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.50667278,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.506700509,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.50670655,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":179.508612072,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":179.508642893,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":179.508756414,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":179.509369109,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":179.509656727,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":179.51000673,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":179.510019461,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":179.510067034,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":179.51016621,"data":"\n"}
,{"stream_name":"stdout","time":179.510178611,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":179.51018445,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":179.510189576,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":179.510194624,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":179.51019943,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":179.51020413,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":179.510209181,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":179.510214456,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":179.510219507,"data":"\n"}
,{"stream_name":"stdout","time":179.510263422,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":179.510271026,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":179.510275396,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":179.510279578,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":179.510283876,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":179.510290784,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":179.510294359,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":179.510297501,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":179.510300465,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":179.510303417,"data":"\n"}
,{"stream_name":"stdout","time":179.510396314,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":179.510690691,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":179.510847386,"data":"2025-10-15 19:49:33 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":179.511014451,"data":"2025-10-15 19:49:33 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":179.511832857,"data":"2025-10-15 19:49:33 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":179.511888901,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":179.512134247,"data":"2025-10-15 19:49:33 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":179.512226982,"data":"2025-10-15 19:49:33 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-5608539115477123787, last=-4334752233410370048\n"}
,{"stream_name":"stdout","time":179.512829594,"data":"2025-10-15 19:49:33 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":179.519182429,"data":"2025-10-15 19:49:33 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":179.519593177,"data":"2025-10-15 19:49:33 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":179.519661349,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":179.519749982,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":179.519776929,"data":"\n"}
,{"stream_name":"stdout","time":179.519782927,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.519787754,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":179.519792631,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":179.519797457,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":179.519801466,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":179.519805676,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.519809845,"data":"\n"}
,{"stream_name":"stdout","time":179.519815857,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":179.529054061,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.529070406,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.529075269,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.529079622,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.530162978,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":179.536961242,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":179.536975375,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":179.541283821,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":179.541297265,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":179.541429285,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.541570714,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":179.541728961,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.541821768,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":179.54194612,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.542032192,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":179.542120486,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":179.542225054,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":179.542339078,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.542391104,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":179.542476031,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":179.542842967,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.542857184,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.551736945,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.551753052,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.551758516,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.551763665,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.551813149,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.551911044,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.551933557,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.551939176,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.551944609,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.551999607,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.552005794,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.552010038,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.55274243,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.552755087,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.553093668,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.553101299,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":179.553106464,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.55312261,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":179.553127022,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":179.5531333,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":179.553137976,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":179.553295414,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":179.553449608,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":179.553456483,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.553556163,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.55361804,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.553631334,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.562516894,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.562531041,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.56253585,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.562541087,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.562557492,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.562710516,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.562718584,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.562723377,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.56272813,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.562733121,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.562801679,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.562816042,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.563484738,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.563498231,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.563799931,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.564548281,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.564568902,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.564575196,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":179.566414603,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":179.566733107,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":179.566749826,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":179.566812765,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":179.65284242,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":179.652866273,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.65292337099999,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":179.65299371,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":179.653124703,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":179.653171811,"data":"2025-10-15 19:49:33 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":179.653257106,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.65326455,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.653269881,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":179.653274073,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.024756771,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":180.024852032,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.43s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.42s/s]\n"}
,{"stream_name":"stdout","time":180.024867554,"data":"\n"}
,{"stream_name":"stdout","time":180.024876962,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":180.024882667,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":180.02643368,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.026574882,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.02671294,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.027054839,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.02710898,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.027242597,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.417732e+00, max=8.689480e+00, std=3.624158e+00\n"}
,{"stream_name":"stdout","time":180.027409021,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029864, rho_c=0.012787\n"}
,{"stream_name":"stdout","time":180.027491378,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.999614, w_c=12.284332\n"}
,{"stream_name":"stdout","time":180.027663788,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:887 -   State hash: -4124692324826083347\n"}
,{"stream_name":"stdout","time":180.027740365,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.027932225,"data":"    [RL] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=3.417732e+00\n"}
,{"stream_name":"stdout","time":180.028963665,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.029038997,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.029165117,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":180.029253099,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.029334936,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.029473529,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":180.02948012,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.029484889,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.029489589,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":180.029529184,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.102129216,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":180.486280508,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":180.486531595,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.87s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.86s/s]\n"}
,{"stream_name":"stdout","time":180.486535466,"data":"\n"}
,{"stream_name":"stdout","time":180.486556847,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":180.486561991,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":180.48805492,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.488110501,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.488294005,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.48864328,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.488656184,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.488787047,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.426928e-01, max=1.817399e+00, std=5.601639e-01\n"}
,{"stream_name":"stdout","time":180.488947559,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029531, rho_c=0.010996\n"}
,{"stream_name":"stdout","time":180.489007888,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.500373, w_c=13.549250\n"}
,{"stream_name":"stdout","time":180.489098899,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:887 -   State hash: 2558496093930192431\n"}
,{"stream_name":"stdout","time":180.48917461,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.489355825,"data":"    [RL] [STEP 2/41] action=0.0000, reward=0.0000, t=30.0s, state_diff=4.426928e-01\n"}
,{"stream_name":"stdout","time":180.490346905,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.490481355,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.490628194,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":180.490720405,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.490806846,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.490921868,"data":"2025-10-15 19:49:34 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":180.490971294,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.49097726,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.490981816,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":180.491027839,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.492370141,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":180.492382309,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.492387161,"data":"  Original dt: 4.553001e-01 s\n"}
,{"stream_name":"stdout","time":180.492391043,"data":"  Corrected dt: 2.845625e-01 s\n"}
,{"stream_name":"stdout","time":180.492396601,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.492400102,"data":"  Max wave speed detected: 17.57 m/s\n"}
,{"stream_name":"stdout","time":180.546041231,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":181.015078209,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":181.015270989,"data":"\n"}
,{"stream_name":"stderr","time":181.01527215,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.64s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.63s/s]\n"}
,{"stream_name":"stdout","time":181.015286188,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":181.015296681,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":181.01695617,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.016986959,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.017009708,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.01739043,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.017400072,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.017555619,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.477755e-01, max=7.978900e-01, std=2.282541e-01\n"}
,{"stream_name":"stdout","time":181.017724868,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029120, rho_c=0.009077\n"}
,{"stream_name":"stdout","time":181.017805071,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.676297, w_c=13.935918\n"}
,{"stream_name":"stdout","time":181.017898387,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:887 -   State hash: -2981833219809276510\n"}
,{"stream_name":"stdout","time":181.018007653,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.018165164,"data":"    [RL] [STEP 3/41] action=0.0000, reward=0.0000, t=45.0s, state_diff=1.477755e-01\n"}
,{"stream_name":"stdout","time":181.01915987,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.019280927,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.019385972,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":181.019432509,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.019561562,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.019696076,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":181.019705928,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.019728535,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.019737893,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":181.019771819,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.047598105,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":181.438558863,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":181.438585452,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.438590882,"data":"  Original dt: 4.525414e-01 s\n"}
,{"stream_name":"stdout","time":181.438605501,"data":"  Corrected dt: 2.828383e-01 s\n"}
,{"stream_name":"stdout","time":181.438623419,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.43862746,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":181.491459738,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":181.500274668,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":181.500682183,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.24s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.23s/s]\n"}
,{"stream_name":"stdout","time":181.500701259,"data":"\n"}
,{"stream_name":"stdout","time":181.500713966,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":181.500718545,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":181.502267138,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.502320269,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.502497142,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.502830533,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.502863832,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.502989387,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.011433e-01, max=6.602001e-01, std=1.740564e-01\n"}
,{"stream_name":"stdout","time":181.503143732,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.028651, rho_c=0.007139\n"}
,{"stream_name":"stdout","time":181.5032138,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.841759, w_c=14.135773\n"}
,{"stream_name":"stdout","time":181.503299364,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:887 -   State hash: 4177580131777351041\n"}
,{"stream_name":"stdout","time":181.503387442,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.50357451,"data":"    [RL] [STEP 4/41] action=0.0000, reward=0.0000, t=60.0s, state_diff=1.011433e-01\n"}
,{"stream_name":"stdout","time":181.504495105,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.504585622,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.504707589,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":181.504813596,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.504895995,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.505000133,"data":"2025-10-15 19:49:35 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":181.505033713,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.505050491,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.505058329,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":181.505062558,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.936533898,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":181.980673916,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":181.980943198,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.56s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":181.980955235,"data":"\n"}
,{"stream_name":"stdout","time":181.980968647,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":181.980973413,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":181.982583306,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.982601793,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.982618738,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.983003754,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.983037583,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.983178142,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.036117e-02, max=6.122320e-01, std=1.605183e-01\n"}
,{"stream_name":"stdout","time":181.983331947,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.027675, rho_c=0.005389\n"}
,{"stream_name":"stdout","time":181.983430024,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.024580, w_c=14.307743\n"}
,{"stream_name":"stdout","time":181.983523818,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:887 -   State hash: 6835712946611113072\n"}
,{"stream_name":"stdout","time":181.983635733,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.983806789,"data":"    [RL] [STEP 5/41] action=0.0000, reward=0.0000, t=75.0s, state_diff=9.036117e-02\n"}
,{"stream_name":"stdout","time":181.984766118,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.98481757,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.984956863,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":181.985066074,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.985138038,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.985220817,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":181.985260259,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.985266279,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.985308218,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":181.985315444,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.328681889,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":182.328707856,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.328714634,"data":"  Original dt: 4.524794e-01 s\n"}
,{"stream_name":"stdout","time":182.328719011,"data":"  Corrected dt: 2.827996e-01 s\n"}
,{"stream_name":"stdout","time":182.328723118,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.328727436,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":182.379855135,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.458032301,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":182.458164845,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.76s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.74s/s]\n"}
,{"stream_name":"stdout","time":182.458210744,"data":"\n"}
,{"stream_name":"stdout","time":182.458225588,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":182.458230175,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":182.459844401,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.459859934,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.459990467,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.460354862,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.460489385,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.460583081,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.248062e-02, max=5.779055e-01, std=1.479756e-01\n"}
,{"stream_name":"stdout","time":182.460799943,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026795, rho_c=0.004615\n"}
,{"stream_name":"stdout","time":182.460864855,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.168017, w_c=14.452574\n"}
,{"stream_name":"stdout","time":182.460979877,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:887 -   State hash: -8869375082367700016\n"}
,{"stream_name":"stdout","time":182.461054669,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.46125498,"data":"    [RL] [STEP 6/41] action=0.0000, reward=0.0000, t=90.0s, state_diff=7.248062e-02\n"}
,{"stream_name":"stdout","time":182.462208232,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.462264677,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.462429017,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":182.462437956,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.462572065,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.462689035,"data":"2025-10-15 19:49:36 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":182.462697304,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.462701961,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.462717682,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":182.462722496,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.820206692,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.933273309,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":182.933397792,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.91s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.90s/s]\n"}
,{"stream_name":"stdout","time":182.933415658,"data":"\n"}
,{"stream_name":"stdout","time":182.933430878,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":182.933435101,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":182.934987748,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.935047141,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.935210339,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.935581843,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.935688046,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.935816709,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.716801e-02, max=3.347270e-01, std=6.831511e-02\n"}
,{"stream_name":"stdout","time":182.93600751,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026564, rho_c=0.004510\n"}
,{"stream_name":"stdout","time":182.936061477,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.211811, w_c=14.517115\n"}
,{"stream_name":"stdout","time":182.936173518,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:887 -   State hash: -7714492776328135051\n"}
,{"stream_name":"stdout","time":182.936241714,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.936430256,"data":"    [RL] [STEP 7/41] action=0.0000, reward=0.0000, t=105.0s, state_diff=2.716801e-02\n"}
,{"stream_name":"stdout","time":182.937496093,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.937536774,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.937723458,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":182.937771251,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.937917984,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.938023778,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":182.938042573,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.938062511,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.938069314,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":182.938074298,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.210811527,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":183.210838517,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.210844298,"data":"  Original dt: 4.524764e-01 s\n"}
,{"stream_name":"stdout","time":183.210848534,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":183.210852674,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.210856615,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":183.261364825,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.409330778,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":183.409591485,"data":"\n"}
,{"stream_name":"stdout","time":183.409606682,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":183.409610849,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":183.409608627,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.85s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.84s/s]\n"}
,{"stream_name":"stdout","time":183.411232357,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.411348671,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.41146419,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.411830193,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.411877065,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.412002314,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.694845e-03, max=1.151665e-01, std=1.868427e-02\n"}
,{"stream_name":"stdout","time":183.412171671,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026527, rho_c=0.004492\n"}
,{"stream_name":"stdout","time":183.412261743,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.219777, w_c=14.535875\n"}
,{"stream_name":"stdout","time":183.412334911,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:887 -   State hash: -8457820387337595535\n"}
,{"stream_name":"stdout","time":183.412417634,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.412614184,"data":"    [RL] [STEP 8/41] action=0.0000, reward=0.0000, t=120.0s, state_diff=6.694845e-03\n"}
,{"stream_name":"stdout","time":183.413519335,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.413641423,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.413737866,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":183.413825365,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.413917123,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.413990259,"data":"2025-10-15 19:49:37 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":183.414037678,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.414058649,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.414065829,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":183.414069908,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.707144297,"data":"[PROGRESS] Step 450: t=129.33/135.00s (95.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.891700245,"data":"  Stored output at t = 135.0000 s (Step 471)\n"}
,{"stream_name":"stdout","time":183.891944573,"data":"\n"}
,{"stream_name":"stdout","time":183.891970624,"data":"Simulation finished at t = 135.0000 s after 471 steps.\n"}
,{"stream_name":"stdout","time":183.891975773,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":183.891948885,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.43s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.41s/s]\n"}
,{"stream_name":"stdout","time":183.893550971,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.893659409,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.893779639,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.894094774,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.894150199,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.894249056,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.531779e-03, max=3.087735e-02, std=4.623905e-03\n"}
,{"stream_name":"stdout","time":183.894418527,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026522, rho_c=0.004488\n"}
,{"stream_name":"stdout","time":183.89452084,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221177, w_c=14.540591\n"}
,{"stream_name":"stdout","time":183.894659118,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:887 -   State hash: 4959297401076585644\n"}
,{"stream_name":"stdout","time":183.894734276,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.894892163,"data":"    [RL] [STEP 9/41] action=0.0000, reward=0.0000, t=135.0s, state_diff=1.531779e-03\n"}
,{"stream_name":"stdout","time":183.89584905,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.895962672,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.896075969,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":183.896152036,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.896227787,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.896314575,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":183.896389745,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.896397184,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.896401325,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":183.896415442,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.109311011,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":184.109343574,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.109349402,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":184.109354122,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":184.109361835,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.109384799,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":184.176595109,"data":"[PROGRESS] Step 500: t=143.20/150.00s (95.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":184.427324017,"data":"  Stored output at t = 150.0000 s (Step 525)\n"}
,{"stream_name":"stderr","time":184.427578483,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 28.27s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 28.26s/s]\n"}
,{"stream_name":"stdout","time":184.427589272,"data":"\n"}
,{"stream_name":"stdout","time":184.427633392,"data":"Simulation finished at t = 150.0000 s after 525 steps.\n"}
,{"stream_name":"stdout","time":184.427640876,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":184.42915925,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.429176317,"data":"[STEP   10] t=  150.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":184.429222586,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.429402687,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.429724505,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.429825197,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.429899546,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.452806e-04, max=7.575118e-03, std=1.097898e-03\n"}
,{"stream_name":"stdout","time":184.430071472,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":184.430162416,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221439, w_c=14.541709\n"}
,{"stream_name":"stdout","time":184.430297226,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:887 -   State hash: -48155292809085765\n"}
,{"stream_name":"stdout","time":184.430382184,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.430559391,"data":"    [RL] [STEP 10/41] action=0.0000, reward=0.0000, t=150.0s, state_diff=3.452806e-04\n"}
,{"stream_name":"stdout","time":184.431539885,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.431650618,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.431756112,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":184.431830458,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.431957371,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.432023314,"data":"2025-10-15 19:49:38 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":184.432070045,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.432077681,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.432082584,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":184.432094041,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.652411805,"data":"[PROGRESS] Step 550: t=157.07/165.00s (95.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":184.904348452,"data":"  Stored output at t = 165.0000 s (Step 579)\n"}
,{"stream_name":"stdout","time":184.904598099,"data":"\n"}
,{"stream_name":"stderr","time":184.904596339,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 31.79s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 31.77s/s]\n"}
,{"stream_name":"stdout","time":184.904617473,"data":"Simulation finished at t = 165.0000 s after 579 steps.\n"}
,{"stream_name":"stdout","time":184.904629966,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":184.906101833,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.906209215,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.906344314,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.906727357,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.906807169,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.906913561,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.730641e-05, max=1.782899e-03, std=2.541467e-04\n"}
,{"stream_name":"stdout","time":184.907056024,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":184.907160341,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221491, w_c=14.541966\n"}
,{"stream_name":"stdout","time":184.907235288,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:887 -   State hash: -3934209965719545380\n"}
,{"stream_name":"stdout","time":184.907330297,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.907536415,"data":"    [RL] [STEP 11/41] action=0.0000, reward=0.0000, t=165.0s, state_diff=7.730641e-05\n"}
,{"stream_name":"stdout","time":184.90839387,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.908499053,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.908659938,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":184.908713408,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.90881423,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.908877835,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":184.908927358,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.908933479,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.908937864,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":184.908948972,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.040911199,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":185.040937862,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.040944802,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":185.040948899,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":185.040952964,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.040957056,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":185.095692432,"data":"[PROGRESS] Step 600: t=170.94/180.00s (95.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.386258947,"data":"  Stored output at t = 180.0000 s (Step 633)\n"}
,{"stream_name":"stderr","time":185.386478124,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 31.45s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 31.44s/s]\n"}
,{"stream_name":"stdout","time":185.386486215,"data":"\n"}
,{"stream_name":"stdout","time":185.386538272,"data":"Simulation finished at t = 180.0000 s after 633 steps.\n"}
,{"stream_name":"stdout","time":185.386544018,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":185.388104815,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.388244289,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.388341006,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.388734815,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.388779681,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.388915346,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.720545e-05, max=4.102117e-04, std=5.786927e-05\n"}
,{"stream_name":"stdout","time":185.389089143,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":185.389166431,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221502, w_c=14.542024\n"}
,{"stream_name":"stdout","time":185.38928316,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:887 -   State hash: -7243948581826371265\n"}
,{"stream_name":"stdout","time":185.389352819,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.389573076,"data":"    [RL] [STEP 12/41] action=0.0000, reward=0.0000, t=180.0s, state_diff=1.720545e-05\n"}
,{"stream_name":"stdout","time":185.390514599,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.39060273,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.390736286,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":185.390821773,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.390938011,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.391032913,"data":"2025-10-15 19:49:39 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":185.391102914,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.391114379,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.391119717,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":185.391123866,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.539715373,"data":"[PROGRESS] Step 650: t=184.81/195.00s (94.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.872109339,"data":"  Stored output at t = 195.0000 s (Step 687)\n"}
,{"stream_name":"stdout","time":185.872348052,"data":"\n"}
,{"stream_name":"stdout","time":185.872359885,"data":"Simulation finished at t = 195.0000 s after 687 steps.\n"}
,{"stream_name":"stdout","time":185.872363871,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":185.872376476,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 31.21s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":185.873894796,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.873940513,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.874097185,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.874410302,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.874456716,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.874600577,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.806005e-06, max=9.303081e-05, std=1.302380e-05\n"}
,{"stream_name":"stdout","time":185.874763044,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":185.874839759,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542037\n"}
,{"stream_name":"stdout","time":185.874929216,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:887 -   State hash: -4295592036151171739\n"}
,{"stream_name":"stdout","time":185.875034545,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.87522471,"data":"    [RL] [STEP 13/41] action=0.0000, reward=0.0000, t=195.0s, state_diff=3.806005e-06\n"}
,{"stream_name":"stdout","time":185.876175551,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.876309258,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.87645641,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":185.876556483,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.876684425,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.876754018,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":185.876819564,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.876825735,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.876830953,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":185.876835343,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.940559998,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":185.94057838,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.940583957,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":185.940588289,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":185.940592228,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.940595837,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":185.993414403,"data":"[PROGRESS] Step 700: t=198.68/210.00s (94.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.374847185,"data":"  Stored output at t = 210.0000 s (Step 741)\n"}
,{"stream_name":"stderr","time":186.375021568,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 30.14s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 30.13s/s]\n"}
,{"stream_name":"stdout","time":186.375049283,"data":"\n"}
,{"stream_name":"stdout","time":186.375062275,"data":"Simulation finished at t = 210.0000 s after 741 steps.\n"}
,{"stream_name":"stdout","time":186.375066488,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":186.376652033,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.376670767,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.376766261,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.37707735,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.377141511,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.377264386,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.368694e-07, max=2.087843e-05, std=2.904567e-06\n"}
,{"stream_name":"stdout","time":186.377429312,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":186.377552743,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542040\n"}
,{"stream_name":"stdout","time":186.377638695,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:887 -   State hash: -1312190332604511692\n"}
,{"stream_name":"stdout","time":186.377724245,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.377902054,"data":"    [RL] [STEP 14/41] action=0.0000, reward=0.0000, t=210.0s, state_diff=8.368694e-07\n"}
,{"stream_name":"stdout","time":186.378890764,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.37899763,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.379138222,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":186.379226297,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.379299091,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.379447175,"data":"2025-10-15 19:49:40 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":186.379454569,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.379479152,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.379522698,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":186.379543366,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.461037026,"data":"[PROGRESS] Step 750: t=212.55/225.00s (94.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.846176087,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":186.846203813,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.846210273,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":186.846214915,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":186.846219993,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.84622401,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":186.854257705,"data":"  Stored output at t = 225.0000 s (Step 795)\n"}
,{"stream_name":"stdout","time":186.854447566,"data":"\n"}
,{"stream_name":"stdout","time":186.854456973,"data":"Simulation finished at t = 225.0000 s after 795 steps.\n"}
,{"stream_name":"stdout","time":186.854461738,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":186.854469666,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 31.62s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 31.61s/s]\n"}
,{"stream_name":"stdout","time":186.856105783,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.856124585,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.856253245,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.856670904,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.856735851,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.856886656,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.829616e-07, max=4.646584e-06, std=6.429022e-07\n"}
,{"stream_name":"stdout","time":186.857052502,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":186.857143937,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542040\n"}
,{"stream_name":"stdout","time":186.857268408,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:887 -   State hash: -6192884078529971549\n"}
,{"stream_name":"stdout","time":186.857347676,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.857576707,"data":"    [RL] [STEP 15/41] action=0.0000, reward=0.0000, t=225.0s, state_diff=1.829616e-07\n"}
,{"stream_name":"stdout","time":186.858494371,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.858628565,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.858716667,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":186.858835033,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.858882092,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.859010889,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":186.859056901,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.859064014,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.859080905,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":186.859147045,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.90298185,"data":"[PROGRESS] Step 800: t=226.41/240.00s (94.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":187.333813175,"data":"  Stored output at t = 240.0000 s (Step 849)\n"}
,{"stream_name":"stdout","time":187.333985355,"data":"\n"}
,{"stream_name":"stderr","time":187.333984736,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 31.63s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 31.62s/s]\n"}
,{"stream_name":"stdout","time":187.333996279,"data":"Simulation finished at t = 240.0000 s after 849 steps.\n"}
,{"stream_name":"stdout","time":187.334004513,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":187.335570301,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.335702198,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.335802408,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.336121324,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.336196266,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.336303698,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.978507e-08, max=1.026794e-06, std=1.413697e-07\n"}
,{"stream_name":"stdout","time":187.336476113,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.336540762,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":187.33667784,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:887 -   State hash: -9220071919838076010\n"}
,{"stream_name":"stdout","time":187.336739299,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.336921977,"data":"    [RL] [STEP 16/41] action=0.0000, reward=0.0000, t=240.0s, state_diff=3.978507e-08\n"}
,{"stream_name":"stdout","time":187.337879052,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.337993534,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.338105103,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":187.338194845,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.338270317,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.338375925,"data":"2025-10-15 19:49:41 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":187.338408797,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.338414944,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.338443004,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":187.338450141,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.347852655,"data":"[PROGRESS] Step 850: t=240.28/255.00s (94.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":187.727010889,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":187.72703648,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.72704234,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":187.727046844,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":187.72705111,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.727054794,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":187.777569875,"data":"[PROGRESS] Step 900: t=254.42/255.00s (99.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":187.803455186,"data":"  Stored output at t = 255.0000 s (Step 903)\n"}
,{"stream_name":"stderr","time":187.80366391,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.29s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.27s/s]\n"}
,{"stream_name":"stdout","time":187.803670473,"data":"\n"}
,{"stream_name":"stdout","time":187.803707446,"data":"Simulation finished at t = 255.0000 s after 903 steps.\n"}
,{"stream_name":"stdout","time":187.803712583,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":187.805227767,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.805258796,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.80533719,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.805709879,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.805782236,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.805894497,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.607088e-09, max=2.254755e-07, std=3.090290e-08\n"}
,{"stream_name":"stdout","time":187.80606275,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.806137792,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":187.806228219,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:887 -   State hash: 7708297719911612152\n"}
,{"stream_name":"stdout","time":187.806316031,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.806534631,"data":"    [RL] [STEP 17/41] action=0.0000, reward=0.0000, t=255.0s, state_diff=8.607088e-09\n"}
,{"stream_name":"stdout","time":187.807412355,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.807516966,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.807675361,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":187.807759639,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.807859004,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.807943782,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":187.807996138,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.808003308,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.808007791,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":187.808013062,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.212562787,"data":"[PROGRESS] Step 950: t=268.29/270.00s (99.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.273207867,"data":"  Stored output at t = 270.0000 s (Step 957)\n"}
,{"stream_name":"stdout","time":188.273367073,"data":"\n"}
,{"stream_name":"stdout","time":188.273377296,"data":"Simulation finished at t = 270.0000 s after 957 steps.\n"}
,{"stream_name":"stdout","time":188.273382129,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":188.273384765,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.27s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.26s/s]\n"}
,{"stream_name":"stdout","time":188.274981075,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.275007229,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.27515083,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.275489514,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.275563003,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.275707068,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.852997e-09, max=4.922894e-08, std=6.718483e-09\n"}
,{"stream_name":"stdout","time":188.275836525,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.275959028,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":188.276033756,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:887 -   State hash: -5565613928803807377\n"}
,{"stream_name":"stdout","time":188.276108357,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.276307407,"data":"    [RL] [STEP 18/41] action=0.0000, reward=0.0000, t=270.0s, state_diff=1.852997e-09\n"}
,{"stream_name":"stdout","time":188.277205275,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.277323342,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.27744077,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":188.277495807,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.277619571,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.277715417,"data":"2025-10-15 19:49:42 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":188.277795131,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.277803118,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.277807915,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":188.277812733,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.599270647,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":188.599293264,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.599309823,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":188.599314037,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":188.599317719,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.599321539,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":188.650736766,"data":"[PROGRESS] Step 1000: t=282.16/285.00s (99.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.746737457,"data":"  Stored output at t = 285.0000 s (Step 1011)\n"}
,{"stream_name":"stderr","time":188.746958475,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 32.01s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 32.00s/s]\n"}
,{"stream_name":"stdout","time":188.746969232,"data":"\n"}
,{"stream_name":"stdout","time":188.746983518,"data":"Simulation finished at t = 285.0000 s after 1011 steps.\n"}
,{"stream_name":"stdout","time":188.746988479,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":188.748553551,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.748573551,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.748665278,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.748976423,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.749047169,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.749165088,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.970844e-10, max=1.069122e-08, std=1.453212e-09\n"}
,{"stream_name":"stdout","time":188.7493194,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.749424262,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":188.749535878,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:887 -   State hash: -1739506175152733492\n"}
,{"stream_name":"stdout","time":188.74967246,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.749832231,"data":"    [RL] [STEP 19/41] action=0.0000, reward=0.0000, t=285.0s, state_diff=3.970844e-10\n"}
,{"stream_name":"stdout","time":188.750736494,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.750786598,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.750915771,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":188.75097619,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.751080742,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.751190683,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":188.751201756,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.751206137,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.751228915,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":188.751233657,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.098667625,"data":"[PROGRESS] Step 1050: t=296.03/300.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":189.230521609,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 31.33s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 31.32s/s]\n"}
,{"stream_name":"stdout","time":189.230537709,"data":"  Stored output at t = 300.0000 s (Step 1065)\n"}
,{"stream_name":"stdout","time":189.23056195,"data":"\n"}
,{"stream_name":"stdout","time":189.230566635,"data":"Simulation finished at t = 300.0000 s after 1065 steps.\n"}
,{"stream_name":"stdout","time":189.230570991,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":189.232227924,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.232245328,"data":"[STEP   20] t=  300.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":189.232326206,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.232465282,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.23284055,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.232873607,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.233024512,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.472035e-11, max=2.310315e-09, std=3.128290e-10\n"}
,{"stream_name":"stdout","time":189.233181152,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.233247313,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":189.233356782,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:887 -   State hash: -6884186419839258386\n"}
,{"stream_name":"stdout","time":189.233424902,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.233636181,"data":"    [RL] [STEP 20/41] action=0.0000, reward=0.0000, t=300.0s, state_diff=8.472035e-11\n"}
,{"stream_name":"stdout","time":189.234554184,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.23461749,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.234738158,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":189.234844455,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.23491306,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.235000453,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":189.235052357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.235059577,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.235064524,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":189.23508541,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.488770894,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":189.488795619,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.488801804,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":189.488806119,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":189.488810056,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.488814301,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":189.540605115,"data":"[PROGRESS] Step 1100: t=309.90/315.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":189.706379444,"data":"  Stored output at t = 315.0000 s (Step 1119)\n"}
,{"stream_name":"stderr","time":189.706631117,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 31.85s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 31.84s/s]\n"}
,{"stream_name":"stdout","time":189.706635126,"data":"\n"}
,{"stream_name":"stdout","time":189.706665421,"data":"Simulation finished at t = 315.0000 s after 1119 steps.\n"}
,{"stream_name":"stdout","time":189.706672047,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":189.708144895,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.708218597,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.708341676,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.708731357,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.708806711,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.708930877,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.800023e-11, max=4.969092e-10, std=6.703790e-11\n"}
,{"stream_name":"stdout","time":189.709088569,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.709147898,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":189.709263311,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:887 -   State hash: -1071397373104675552\n"}
,{"stream_name":"stdout","time":189.709332277,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.709548891,"data":"    [RL] [STEP 21/41] action=0.0000, reward=0.0000, t=315.0s, state_diff=1.800023e-11\n"}
,{"stream_name":"stdout","time":189.710425046,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.710535195,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.71068581,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":189.710751836,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.710871601,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.71094372,"data":"2025-10-15 19:49:43 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":189.711003134,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.711009613,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.711018638,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":189.711031363,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.983898316,"data":"[PROGRESS] Step 1150: t=323.77/330.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.187180044,"data":"  Stored output at t = 330.0000 s (Step 1173)\n"}
,{"stream_name":"stdout","time":190.18742736,"data":"\n"}
,{"stream_name":"stdout","time":190.187440178,"data":"Simulation finished at t = 330.0000 s after 1173 steps.\n"}
,{"stream_name":"stdout","time":190.187445426,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":190.187443549,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.53s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.51s/s]\n"}
,{"stream_name":"stdout","time":190.189078468,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.189093568,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.189214089,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.18956246,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.189692279,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.189781309,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.809539e-12, max=1.064127e-10, std=1.430516e-11\n"}
,{"stream_name":"stdout","time":190.189942158,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.190017368,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":190.190136141,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:887 -   State hash: -4420541533505393837\n"}
,{"stream_name":"stdout","time":190.190200441,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.190391048,"data":"    [RL] [STEP 22/41] action=0.0000, reward=0.0000, t=330.0s, state_diff=3.809539e-12\n"}
,{"stream_name":"stdout","time":190.191332126,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.191453179,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.191587406,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":190.191690457,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.19179433,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.191864327,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":190.191933659,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.19193987,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.191945231,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":190.191949707,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.375337549,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":190.375361395,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.375366659,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":190.375378801,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":190.375383455,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.375387636,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":190.426773406,"data":"[PROGRESS] Step 1200: t=337.64/345.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.668311138,"data":"  Stored output at t = 345.0000 s (Step 1227)\n"}
,{"stream_name":"stdout","time":190.668488905,"data":"\n"}
,{"stream_name":"stdout","time":190.668535698,"data":"Simulation finished at t = 345.0000 s after 1227 steps.\n"}
,{"stream_name":"stdout","time":190.668547625,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":190.668491242,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 31.52s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 31.50s/s]\n"}
,{"stream_name":"stdout","time":190.670071994,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.670182121,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.670253618,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.670725183,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.670806777,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.670943133,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.033112e-13, max=2.269473e-11, std=3.040188e-12\n"}
,{"stream_name":"stdout","time":190.671143695,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.671200193,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":190.671344416,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:887 -   State hash: -818848171433010327\n"}
,{"stream_name":"stdout","time":190.671445722,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.671670334,"data":"    [RL] [STEP 23/41] action=0.0000, reward=0.0000, t=345.0s, state_diff=8.033112e-13\n"}
,{"stream_name":"stdout","time":190.672617557,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.672675126,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.672811352,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":190.67284883,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.672971459,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.67303363,"data":"2025-10-15 19:49:44 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":190.673093791,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.673100951,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.673105286,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":190.673119346,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.897555449,"data":"[PROGRESS] Step 1250: t=351.50/360.00s (97.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":191.172629382,"data":"  Stored output at t = 360.0000 s (Step 1281)\n"}
,{"stream_name":"stderr","time":191.172741507,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 30.05s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 30.04s/s]\n"}
,{"stream_name":"stdout","time":191.172765542,"data":"\n"}
,{"stream_name":"stdout","time":191.17277401,"data":"Simulation finished at t = 360.0000 s after 1281 steps.\n"}
,{"stream_name":"stdout","time":191.172778666,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":191.174416403,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.174436419,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.174568285,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.174928239,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.175003306,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.175122853,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.687630e-13, max=4.812151e-12, std=6.429026e-13\n"}
,{"stream_name":"stdout","time":191.175278509,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.175367489,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":191.175477876,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:887 -   State hash: -3452687619482621061\n"}
,{"stream_name":"stdout","time":191.175574259,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.175767341,"data":"    [RL] [STEP 24/41] action=0.0000, reward=0.0000, t=360.0s, state_diff=1.687630e-13\n"}
,{"stream_name":"stdout","time":191.17671126,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.176828962,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.176922442,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":191.177035257,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.177085509,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.177186847,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":191.177238852,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.177246385,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.177253189,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":191.177258057,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.293915112,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":191.293936335,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.293941946,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":191.293945589,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":191.293949629,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.293953628,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":191.345174686,"data":"[PROGRESS] Step 1300: t=365.37/375.00s (97.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":191.651637269,"data":"  Stored output at t = 375.0000 s (Step 1335)\n"}
,{"stream_name":"stdout","time":191.651886511,"data":"\n"}
,{"stream_name":"stdout","time":191.651895095,"data":"Simulation finished at t = 375.0000 s after 1335 steps.\n"}
,{"stream_name":"stderr","time":191.651887214,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.65s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.63s/s]\n"}
,{"stream_name":"stdout","time":191.651898959,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":191.653479761,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.653500009,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.653653306,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.653954093,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.654050525,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.654146188,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.531257e-14, max=1.024958e-12, std=1.363964e-13\n"}
,{"stream_name":"stdout","time":191.654331245,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.654454369,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":191.654562147,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:887 -   State hash: 1427377349226078542\n"}
,{"stream_name":"stdout","time":191.654669641,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.654863532,"data":"    [RL] [STEP 25/41] action=0.0000, reward=0.0000, t=375.0s, state_diff=3.531257e-14\n"}
,{"stream_name":"stdout","time":191.65588538,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.6560037,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.656117479,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":191.656212031,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.65629068,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.656392515,"data":"2025-10-15 19:49:45 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":191.656440877,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.656459629,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.656466172,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":191.656485366,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.789820297,"data":"[PROGRESS] Step 1350: t=379.24/390.00s (97.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.134785372,"data":"  Stored output at t = 390.0000 s (Step 1389)\n"}
,{"stream_name":"stdout","time":192.134966356,"data":"\n"}
,{"stream_name":"stderr","time":192.13496416,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 31.39s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 31.38s/s]\n"}
,{"stream_name":"stdout","time":192.134978026,"data":"Simulation finished at t = 390.0000 s after 1389 steps.\n"}
,{"stream_name":"stdout","time":192.134989816,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":192.136641434,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.136702053,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.136835978,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.137168753,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.137217174,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.137392801,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.431160e-15, max=2.113865e-13, std=2.849219e-14\n"}
,{"stream_name":"stdout","time":192.137576404,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.137722625,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":192.137813099,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:887 -   State hash: -5051907408092541668\n"}
,{"stream_name":"stdout","time":192.13789421,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.138109644,"data":"    [RL] [STEP 26/41] action=0.0000, reward=0.0000, t=390.0s, state_diff=7.431160e-15\n"}
,{"stream_name":"stdout","time":192.139100752,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.139192011,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.139332339,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":192.13940777,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.139560706,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.139646172,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":192.139698415,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.139705971,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.139710882,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":192.139761878,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.185889696,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":192.185908175,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.185913653,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":192.185917752,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":192.185921269,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.185924746,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":192.238749201,"data":"[PROGRESS] Step 1400: t=393.11/405.00s (97.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.613999025,"data":"  Stored output at t = 405.0000 s (Step 1443)\n"}
,{"stream_name":"stderr","time":192.614132835,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 31.66s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 31.65s/s]\n"}
,{"stream_name":"stdout","time":192.614136245,"data":"\n"}
,{"stream_name":"stdout","time":192.614155776,"data":"Simulation finished at t = 405.0000 s after 1443 steps.\n"}
,{"stream_name":"stdout","time":192.614160561,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":192.615772739,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.61579766,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.615913366,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.616249451,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.616292302,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.61644486,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.380187e-15, max=4.796163e-14, std=5.884982e-15\n"}
,{"stream_name":"stdout","time":192.616638186,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.616712374,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":192.616827651,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:887 -   State hash: -5466214112886604129\n"}
,{"stream_name":"stdout","time":192.616900056,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.617103734,"data":"    [RL] [STEP 27/41] action=0.0000, reward=0.0000, t=405.0s, state_diff=1.380187e-15\n"}
,{"stream_name":"stdout","time":192.618028901,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.618106176,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.618250944,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":192.618312438,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.61842047,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.618494249,"data":"2025-10-15 19:49:46 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":192.618570204,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.61858175,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.61858594,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":192.618604739,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.680531845,"data":"[PROGRESS] Step 1450: t=406.98/420.00s (96.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.065735631,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":193.06577585,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.065781583,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":193.065785712,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":193.065790093,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.065800139,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":193.09105779,"data":"  Stored output at t = 420.0000 s (Step 1497)\n"}
,{"stream_name":"stdout","time":193.091302148,"data":"\n"}
,{"stream_name":"stderr","time":193.091308355,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 31.77s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 31.76s/s]\n"}
,{"stream_name":"stdout","time":193.091315111,"data":"Simulation finished at t = 420.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":193.091325923,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":193.093074576,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.093093557,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.093217334,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.093543189,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.093616059,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.093728074,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.481687e-16, max=1.065814e-14, std=1.348906e-15\n"}
,{"stream_name":"stdout","time":193.093889021,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.093964793,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":193.094078993,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:887 -   State hash: -1698917457426995834\n"}
,{"stream_name":"stdout","time":193.094152224,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.094331563,"data":"    [RL] [STEP 28/41] action=0.0000, reward=0.0000, t=420.0s, state_diff=2.481687e-16\n"}
,{"stream_name":"stdout","time":193.0952421,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.095364501,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.095457879,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":193.095542975,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.095692003,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.095759118,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":193.095815066,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.095832375,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.095836974,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":193.095840661,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.124300881,"data":"[PROGRESS] Step 1500: t=420.85/435.00s (96.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.561754531,"data":"[PROGRESS] Step 1550: t=434.99/435.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.571010851,"data":"  Stored output at t = 435.0000 s (Step 1551)\n"}
,{"stream_name":"stdout","time":193.571182796,"data":"\n"}
,{"stream_name":"stdout","time":193.571192626,"data":"Simulation finished at t = 435.0000 s after 1551 steps.\n"}
,{"stream_name":"stdout","time":193.571197377,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":193.571212528,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 31.59s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 31.58s/s]\n"}
,{"stream_name":"stdout","time":193.572940279,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.57295554,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.573071597,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.573425216,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.573485222,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.57365489,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.153883e-16, max=7.105427e-15, std=8.319311e-16\n"}
,{"stream_name":"stdout","time":193.573833594,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.573894378,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":193.573974541,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:887 -   State hash: 2164022095125070157\n"}
,{"stream_name":"stdout","time":193.574060978,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.574251401,"data":"    [RL] [STEP 29/41] action=0.0000, reward=0.0000, t=435.0s, state_diff=1.153883e-16\n"}
,{"stream_name":"stdout","time":193.575272408,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.575329369,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.575459885,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":193.57554184,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.575695234,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.575742695,"data":"2025-10-15 19:49:47 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":193.575794898,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.575801283,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.57580564,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":193.575816083,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.953167113,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":193.953190912,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.953195893,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":193.953200093,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":193.953203913,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.953207742,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":194.004578754,"data":"[PROGRESS] Step 1600: t=448.86/450.00s (99.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.048237096,"data":"  Stored output at t = 450.0000 s (Step 1605)\n"}
,{"stream_name":"stdout","time":194.048378145,"data":"\n"}
,{"stream_name":"stdout","time":194.048388895,"data":"Simulation finished at t = 450.0000 s after 1605 steps.\n"}
,{"stream_name":"stdout","time":194.048393011,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":194.048408084,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 31.78s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 31.77s/s]\n"}
,{"stream_name":"stdout","time":194.049987311,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.050002651,"data":"[STEP   30] t=  450.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":194.050008089,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.05006298,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.050448731,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.050518641,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.050712313,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.135774e-17, max=5.329071e-15, std=2.880643e-16\n"}
,{"stream_name":"stdout","time":194.050830208,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.050948052,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":194.051032737,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:887 -   State hash: 4084206687744565181\n"}
,{"stream_name":"stdout","time":194.051165735,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.05135736,"data":"    [RL] [STEP 30/41] action=0.0000, reward=0.0000, t=450.0s, state_diff=2.135774e-17\n"}
,{"stream_name":"stdout","time":194.052380472,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.052461369,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.052602469,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":194.052650743,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.052758191,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":194.052889151,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":194.052897376,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.052903008,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.052908051,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":194.052913829,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.443837783,"data":"[PROGRESS] Step 1650: t=462.73/465.00s (99.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.522161285,"data":"  Stored output at t = 465.0000 s (Step 1659)\n"}
,{"stream_name":"stderr","time":194.52242817,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 31.99s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 31.97s/s]\n"}
,{"stream_name":"stdout","time":194.52243566,"data":"\n"}
,{"stream_name":"stdout","time":194.522451471,"data":"Simulation finished at t = 465.0000 s after 1659 steps.\n"}
,{"stream_name":"stdout","time":194.522457045,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":194.524029008,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.524043979,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.524098533,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.524431718,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.524519844,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.524655055,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.524829864,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.52488355,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":194.52499586,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:887 -   State hash: 4084206687744565181\n"}
,{"stream_name":"stdout","time":194.525074937,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.525258393,"data":"    [RL] [STEP 31/41] action=0.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.526159204,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.526205757,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.52636593,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":194.526415863,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.526551437,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":194.526629585,"data":"2025-10-15 19:49:48 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":194.526686924,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.526693878,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.526699584,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":194.52671231,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.836189459,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":194.836213945,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.83621878,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":194.836223905,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":194.836227491,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.836231773,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":194.88682871,"data":"[PROGRESS] Step 1700: t=476.59/480.00s (99.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.000354525,"data":"  Stored output at t = 480.0000 s (Step 1713)\n"}
,{"stream_name":"stdout","time":195.000470876,"data":"\n"}
,{"stream_name":"stdout","time":195.000480229,"data":"Simulation finished at t = 480.0000 s after 1713 steps.\n"}
,{"stream_name":"stdout","time":195.000484029,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":195.000520698,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 31.70s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 31.69s/s]\n"}
,{"stream_name":"stdout","time":195.002130224,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.002204292,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.002373934,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.002753924,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.002823557,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.002948768,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.003108438,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.003176472,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":195.003283797,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:887 -   State hash: 4084206687744565181\n"}
,{"stream_name":"stdout","time":195.003347074,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.003549655,"data":"    [RL] [STEP 32/41] action=0.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.004439642,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.004546977,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.004669806,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":195.004749239,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.004814829,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.00492289,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":195.00493858,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.004943497,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.004975898,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":195.004983072,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.326936926,"data":"[PROGRESS] Step 1750: t=490.46/495.00s (99.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.474665392,"data":"  Stored output at t = 495.0000 s (Step 1767)\n"}
,{"stream_name":"stderr","time":195.47480151,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.97s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.95s/s]\n"}
,{"stream_name":"stdout","time":195.474862435,"data":"\n"}
,{"stream_name":"stdout","time":195.474873738,"data":"Simulation finished at t = 495.0000 s after 1767 steps.\n"}
,{"stream_name":"stdout","time":195.474878527,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":195.476563336,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.476578528,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.476625311,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.47696584,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.477014944,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.47712511,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.477299257,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.477415259,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":195.47753921,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:887 -   State hash: 4084206687744565181\n"}
,{"stream_name":"stdout","time":195.477670105,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.477846119,"data":"    [RL] [STEP 33/41] action=0.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.478775317,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.478896975,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.478986235,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":195.479059188,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.479141658,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.479225979,"data":"2025-10-15 19:49:49 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":195.479275103,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.47928159,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.479301498,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":195.47930819,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.715470137,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":195.715496471,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.715520314,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":195.715528142,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":195.715532775,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.715536986,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":195.766869443,"data":"[PROGRESS] Step 1800: t=504.33/510.00s (98.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.948486875,"data":"  Stored output at t = 510.0000 s (Step 1821)\n"}
,{"stream_name":"stdout","time":195.948773268,"data":"\n"}
,{"stream_name":"stderr","time":195.9487838,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.99s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.98s/s]\n"}
,{"stream_name":"stdout","time":195.948791833,"data":"Simulation finished at t = 510.0000 s after 1821 steps.\n"}
,{"stream_name":"stdout","time":195.94880337,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":195.950265051,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.950370209,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.950541522,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.950931567,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.950981907,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.951129743,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.951292446,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.951430322,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":195.951541573,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:887 -   State hash: 4084206687744565181\n"}
,{"stream_name":"stdout","time":195.951628467,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.951819553,"data":"    [RL] [STEP 34/41] action=0.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.952761926,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.952818254,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.952936794,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":195.952995557,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.953098898,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.953170857,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":195.953231284,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.953239902,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.953245351,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":195.9532577,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.206014606,"data":"[PROGRESS] Step 1850: t=518.20/525.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.427001402,"data":"  Stored output at t = 525.0000 s (Step 1875)\n"}
,{"stream_name":"stdout","time":196.427255606,"data":"\n"}
,{"stream_name":"stderr","time":196.427256043,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.69s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.67s/s]\n"}
,{"stream_name":"stdout","time":196.427266004,"data":"Simulation finished at t = 525.0000 s after 1875 steps.\n"}
,{"stream_name":"stdout","time":196.427275506,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":196.428970867,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.4289903,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.42903479,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.429367712,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.42944658,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.42960425,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.931605e-17, max=7.105427e-15, std=6.503592e-16\n"}
,{"stream_name":"stdout","time":196.429783745,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.429840794,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":196.429934954,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:887 -   State hash: 8200671094216287603\n"}
,{"stream_name":"stdout","time":196.430033014,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.430208099,"data":"    [RL] [STEP 35/41] action=0.0000, reward=0.0000, t=525.0s, state_diff=9.931605e-17\n"}
,{"stream_name":"stdout","time":196.431122342,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.431167522,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.431406522,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":196.431576157,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.431753596,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.431827996,"data":"2025-10-15 19:49:50 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":196.43188051,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.431887411,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.431908482,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":196.43191903,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.598448474,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":196.598467714,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.598473111,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":196.598477226,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":196.598481437,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.598485555,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":196.649421646,"data":"[PROGRESS] Step 1900: t=532.07/540.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.902602881,"data":"  Stored output at t = 540.0000 s (Step 1929)\n"}
,{"stream_name":"stdout","time":196.902853194,"data":"\n"}
,{"stream_name":"stderr","time":196.90285547,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 31.89s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 31.88s/s]\n"}
,{"stream_name":"stdout","time":196.902864713,"data":"Simulation finished at t = 540.0000 s after 1929 steps.\n"}
,{"stream_name":"stdout","time":196.902880327,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":196.904374492,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.904447462,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.904596549,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.904964652,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.9050428,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.905127642,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.728573e-17, max=7.105427e-15, std=3.479448e-16\n"}
,{"stream_name":"stdout","time":196.905283752,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.905381627,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":196.905498778,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:887 -   State hash: -3625480744619259184\n"}
,{"stream_name":"stdout","time":196.90557255,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.905779859,"data":"    [RL] [STEP 36/41] action=0.0000, reward=0.0000, t=540.0s, state_diff=1.728573e-17\n"}
,{"stream_name":"stdout","time":196.906804816,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.906882151,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.907039001,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":196.907118858,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.907221012,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.907347817,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":196.907356889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.907362263,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.907376363,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":196.907381245,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.093136787,"data":"[PROGRESS] Step 1950: t=545.94/555.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.386194119,"data":"  Stored output at t = 555.0000 s (Step 1983)\n"}
,{"stream_name":"stdout","time":197.386445511,"data":"\n"}
,{"stream_name":"stderr","time":197.386445726,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.35s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.34s/s]\n"}
,{"stream_name":"stdout","time":197.386458972,"data":"Simulation finished at t = 555.0000 s after 1983 steps.\n"}
,{"stream_name":"stdout","time":197.386474451,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":197.387998907,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.388087364,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.388249552,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.388651848,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.38873374,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.388839392,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.310008e-17, max=3.552714e-15, std=1.943100e-16\n"}
,{"stream_name":"stdout","time":197.388993185,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.38908216,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":197.389167591,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:887 -   State hash: -187174648826458524\n"}
,{"stream_name":"stdout","time":197.389273757,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.389447047,"data":"    [RL] [STEP 37/41] action=0.0000, reward=0.0000, t=555.0s, state_diff=1.310008e-17\n"}
,{"stream_name":"stdout","time":197.390362767,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.39046684,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.390565423,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":197.390691454,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.390769093,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.390875136,"data":"2025-10-15 19:49:51 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":197.390883284,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":197.390888536,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.390896174,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":197.390901214,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.489741202,"data":"[WARNING] Automatic CFL correction applied (count: 7200):\n"}
,{"stream_name":"stdout","time":197.489761136,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.489767729,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":197.489770521,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":197.48977294,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.489775485,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":197.541005247,"data":"[PROGRESS] Step 2000: t=559.81/570.00s (98.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.867388323,"data":"  Stored output at t = 570.0000 s (Step 2037)\n"}
,{"stream_name":"stdout","time":197.867607311,"data":"\n"}
,{"stream_name":"stderr","time":197.867620539,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.50s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.49s/s]\n"}
,{"stream_name":"stdout","time":197.867627653,"data":"Simulation finished at t = 570.0000 s after 2037 steps.\n"}
,{"stream_name":"stdout","time":197.867637107,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":197.869071236,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.869191237,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.869295717,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.869709534,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.869793452,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.86992574,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.308966e-17, max=3.552714e-15, std=1.943104e-16\n"}
,{"stream_name":"stdout","time":197.870098923,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.870188401,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":197.870292236,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:887 -   State hash: 4139285469710800876\n"}
,{"stream_name":"stdout","time":197.870380018,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.870565159,"data":"    [RL] [STEP 38/41] action=0.0000, reward=0.0000, t=570.0s, state_diff=1.308966e-17\n"}
,{"stream_name":"stdout","time":197.871530106,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.871632116,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.87172983,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":197.871844847,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.871898113,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.872043353,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":197.872050967,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":197.872080091,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.872114915,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":197.872123846,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.988437054,"data":"[PROGRESS] Step 2050: t=573.68/585.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":198.34441218,"data":"  Stored output at t = 585.0000 s (Step 2091)\n"}
,{"stream_name":"stdout","time":198.344467511,"data":"\n"}
,{"stream_name":"stdout","time":198.344474326,"data":"Simulation finished at t = 585.0000 s after 2091 steps.\n"}
,{"stream_name":"stdout","time":198.344478347,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":198.344519221,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 31.79s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 31.78s/s]\n"}
,{"stream_name":"stdout","time":198.346048506,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.346134831,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.346268126,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.346650199,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.346731042,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.346819252,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.657578e-19, max=1.040834e-17, std=1.004599e-18\n"}
,{"stream_name":"stdout","time":198.346979647,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":198.347049628,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":198.347143486,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:887 -   State hash: 1192476968844402983\n"}
,{"stream_name":"stdout","time":198.347217713,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.347394116,"data":"    [RL] [STEP 39/41] action=0.0000, reward=0.0000, t=585.0s, state_diff=1.657578e-19\n"}
,{"stream_name":"stdout","time":198.348291639,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.348395636,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.348526318,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":198.348606602,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.34869525,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":198.34878012,"data":"2025-10-15 19:49:52 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":198.3488255,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":198.34883212,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.348836205,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":198.348860687,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.376590125,"data":"[WARNING] Automatic CFL correction applied (count: 7300):\n"}
,{"stream_name":"stdout","time":198.376607452,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.376614598,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":198.376617491,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":198.376619908,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.37662297,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":198.427546033,"data":"[PROGRESS] Step 2100: t=587.55/600.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":198.81643706,"data":"  Stored output at t = 600.0000 s (Step 2145)\n"}
,{"stream_name":"stdout","time":198.816486869,"data":"\n"}
,{"stream_name":"stderr","time":198.816480222,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.11s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.10s/s]\n"}
,{"stream_name":"stdout","time":198.81649259,"data":"Simulation finished at t = 600.0000 s after 2145 steps.\n"}
,{"stream_name":"stdout","time":198.816527267,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":198.81799707,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.818014254,"data":"[STEP   40] t=  600.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":198.818019013,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":198.818133093,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.818265153,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":198.818657946,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.818762349,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.818873771,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.819038577,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":198.819127779,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.221504, w_c=14.542041\n"}
,{"stream_name":"stdout","time":198.819229025,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:887 -   State hash: 1192476968844402983\n"}
,{"stream_name":"stdout","time":198.819332699,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.819486848,"data":"    [RL] [STEP 40/41] action=0.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.819589419,"data":"\n"}
,{"stream_name":"stdout","time":198.819600059,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":198.819603853,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":198.819607469,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":198.819610929,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":198.819614366,"data":"    - Avg step time: 0.481s (device=gpu)\n"}
,{"stream_name":"stdout","time":198.819617915,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":198.819621404,"data":"    - Wallclock time: 19.2s\n"}
,{"stream_name":"stdout","time":198.819625196,"data":"    - Speed ratio: 31.17x real-time\n"}
,{"stream_name":"stdout","time":198.819629457,"data":"\n"}
,{"stream_name":"stdout","time":198.819675956,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":198.819682135,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":198.819686037,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":198.819690277,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":198.819694659,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":198.81969882,"data":"    - Avg step time: 0.481s (device=gpu)\n"}
,{"stream_name":"stdout","time":198.819703134,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":198.819706859,"data":"    - Wallclock time: 19.2s\n"}
,{"stream_name":"stdout","time":198.819710356,"data":"    - Speed ratio: 31.17x real-time\n"}
,{"stream_name":"stdout","time":198.819713889,"data":"\n"}
,{"stream_name":"stdout","time":198.819786879,"data":"2025-10-15 19:49:53 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":198.820172698,"data":"\n"}
,{"stream_name":"stdout","time":198.820184243,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.820189014,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":198.820192566,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.820196476,"data":"\n"}
,{"stream_name":"stdout","time":198.820298508,"data":"2025-10-15 19:49:53 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":198.820391683,"data":"2025-10-15 19:49:53 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-4124692324826083347, last=1192476968844402983\n"}
,{"stream_name":"stdout","time":198.820916401,"data":"2025-10-15 19:49:53 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.02598921 0.02656696 0.02717803 0.02779986 0.02840156], w_m[10:15]=[16.58094357 16.52130442 16.46653825 16.4189181  16.3802789 ]\n"}
,{"stream_name":"stdout","time":198.826948143,"data":"2025-10-15 19:49:53 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02209535 0.02209194 0.02209061 0.02209007 0.02208984], w_m[10:15]=[17.75361676 17.7563278  17.75738546 17.75781042 17.75798681]\n"}
,{"stream_name":"stdout","time":198.82718033,"data":"2025-10-15 19:49:53 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=32.425207, efficiency=5.188033, delay=-175.97s\n"}
,{"stream_name":"stdout","time":198.827226071,"data":"2025-10-15 19:49:53 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":198.827349094,"data":"2025-10-15 19:49:53 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 32.42520699763865, 'avg_speed': 1285.401091376977, 'avg_density': 0.025475069317121752, 'efficiency': 5.188033119622183, 'delay': -175.96627867200107, 'throughput': 162126.03498819322}\n"}
,{"stream_name":"stdout","time":198.827428586,"data":"2025-10-15 19:49:53 - INFO - run_performance_comparison:1430 - Flow improvement: 14.616%\n"}
,{"stream_name":"stdout","time":198.827516239,"data":"2025-10-15 19:49:53 - INFO - run_performance_comparison:1431 - Efficiency improvement: 14.616%\n"}
,{"stream_name":"stdout","time":198.827611334,"data":"2025-10-15 19:49:53 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":198.827680296,"data":"  Flow improvement: 14.6%\n"}
,{"stream_name":"stdout","time":198.827686951,"data":"  Efficiency improvement: 14.6%\n"}
,{"stream_name":"stdout","time":198.827691223,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":198.827695604,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":198.828190955,"data":"\n"}
,{"stream_name":"stdout","time":198.828197631,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":199.420651272,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":199.935529608,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":199.935557003,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":199.935562715,"data":"\n"}
,{"stream_name":"stdout","time":199.935566806,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":199.943776482,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":199.943794375,"data":"\n"}
,{"stream_name":"stdout","time":199.943799052,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":199.943993919,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":199.944002989,"data":"\n"}
,{"stream_name":"stdout","time":199.944006708,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":199.944010295,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":199.94401433,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":199.944017808,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":199.944021246,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":199.944035217,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":199.944957669,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":202.536495504,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":202.536645321,"data":"\n"}
,{"stream_name":"stdout","time":202.536656767,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":202.536789401,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":202.540116814,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":202.541085953,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":202.541194266,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":202.541287827,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":202.541347541,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":202.541446093,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":202.541517224,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":202.541676072,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":202.54173943199999,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":202.541823332,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":202.609455065,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":202.609566961,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":202.610037343,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":202.610095058,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":202.610221991,"data":"\n"}
,{"stream_name":"stdout","time":202.610232716,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":202.610244499,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":202.610356708,"data":"\n"}
,{"stream_name":"stdout","time":202.610366133,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":202.61037636,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":202.610381559,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":202.610399951,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":205.984340581,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":205.984376352,"data":"  warn(\n"}
,{"stream_name":"stderr","time":206.02330482,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":206.757101068,"data":"[NbConvertApp] Writing 322230 bytes to __results__.html\n"}
]