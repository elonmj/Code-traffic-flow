2025-10-09 14:12:29 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-09 14:12:29 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-09 14:12:29 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-09 14:12:29 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-09 14:12:29 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-09 14:12:29 - INFO - train_rl_agent:521 - ================================================================================
2025-10-09 14:12:29 - INFO - train_rl_agent:522 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-09 14:12:29 - INFO - train_rl_agent:523 -   - Device: gpu
2025-10-09 14:12:29 - INFO - train_rl_agent:524 -   - Total timesteps: 100
2025-10-09 14:12:29 - INFO - train_rl_agent:525 -   - Episode max time: 120.0s
2025-10-09 14:12:29 - INFO - train_rl_agent:526 -   - Checkpoint frequency: 50
2025-10-09 14:12:29 - INFO - train_rl_agent:527 - ================================================================================
2025-10-09 14:12:29 - INFO - _create_scenario_config:179 - Created scenario config: traffic_light_control.yml
2025-10-09 14:12:29 - INFO - _create_scenario_config:180 -   Initial densities (veh/km): rho_m=45.0, rho_c=50.0
2025-10-09 14:12:29 - INFO - _create_scenario_config:181 -   Initial densities (veh/m): rho_m=0.0450, rho_c=0.0500
2025-10-09 14:12:29 - INFO - _create_scenario_config:182 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 14:14:04 - INFO - run_performance_comparison:658 - ================================================================================
2025-10-09 14:14:04 - INFO - run_performance_comparison:659 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 14:14:04 - INFO - run_performance_comparison:660 - Device: gpu
2025-10-09 14:14:04 - INFO - run_performance_comparison:661 - ================================================================================
2025-10-09 14:14:04 - INFO - run_performance_comparison:662 - ================================================================================
2025-10-09 14:14:04 - INFO - run_performance_comparison:663 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 14:14:04 - INFO - run_performance_comparison:664 - Device: gpu
2025-10-09 14:14:04 - INFO - run_performance_comparison:665 - ================================================================================
2025-10-09 14:14:04 - INFO - _create_scenario_config:179 - Created scenario config: traffic_light_control.yml
2025-10-09 14:14:04 - INFO - _create_scenario_config:180 -   Initial densities (veh/km): rho_m=45.0, rho_c=50.0
2025-10-09 14:14:04 - INFO - _create_scenario_config:181 -   Initial densities (veh/m): rho_m=0.0450, rho_c=0.0500
2025-10-09 14:14:04 - INFO - _create_scenario_config:182 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 14:14:04 - INFO - run_control_simulation:261 - ================================================================================
2025-10-09 14:14:04 - INFO - run_control_simulation:262 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 14:14:04 - INFO - run_control_simulation:263 - Starting run_control_simulation:
2025-10-09 14:14:04 - INFO - run_control_simulation:264 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 14:14:04 - INFO - run_control_simulation:265 -   - duration: 600.0s
2025-10-09 14:14:04 - INFO - run_control_simulation:266 -   - control_interval: 60.0s
2025-10-09 14:14:04 - INFO - run_control_simulation:267 -   - device: gpu
2025-10-09 14:14:04 - INFO - run_control_simulation:268 -   - controller: BaselineController
2025-10-09 14:14:04 - INFO - run_control_simulation:269 - ================================================================================
2025-10-09 14:14:04 - INFO - run_control_simulation:274 - Creating TrafficSignalEnvDirect instance...
2025-10-09 14:14:04 - INFO - run_control_simulation:284 - TrafficSignalEnvDirect created successfully
2025-10-09 14:14:04 - INFO - run_control_simulation:300 - Calling env.reset()...
2025-10-09 14:14:04 - INFO - run_control_simulation:302 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 14:14:04 - INFO - run_control_simulation:306 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 14:14:04 - INFO - run_control_simulation:307 - INITIAL STATE statistics: mean=5.995166e+00, std=5.990711e+00, min=4.500000e-05, max=1.295160e+01
2025-10-09 14:14:04 - INFO - run_control_simulation:323 - Starting simulation loop - max 10 steps
2025-10-09 14:14:04 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:04 - INFO - run_control_simulation:338 - STEP 0 START:
2025-10-09 14:14:04 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:04 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:04 - INFO - run_control_simulation:341 -   Simulation time: 0.00s
2025-10-09 14:14:05 - INFO - run_control_simulation:353 -   Reward: -0.024212
2025-10-09 14:14:05 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:05 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:05 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:05 - INFO - run_control_simulation:372 -     Diff statistics: mean=3.955129e-01, max=6.485954e+00, std=1.423222e+00
2025-10-09 14:14:05 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.038348, rho_c=0.043931
2025-10-09 14:14:05 - INFO - run_control_simulation:383 -     Mean velocities: w_m=13.816428, w_c=11.638331
2025-10-09 14:14:05 - INFO - run_control_simulation:387 -   State hash: 7364168260573208
2025-10-09 14:14:05 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:05 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:05 - INFO - run_control_simulation:338 - STEP 1 START:
2025-10-09 14:14:05 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:05 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:05 - INFO - run_control_simulation:341 -   Simulation time: 60.00s
2025-10-09 14:14:06 - INFO - run_control_simulation:353 -   Reward: -0.024666
2025-10-09 14:14:06 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:06 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:06 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:06 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.116414e-01, max=6.454981e+00, std=1.355361e+00
2025-10-09 14:14:06 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.031256, rho_c=0.037372
2025-10-09 14:14:06 - INFO - run_control_simulation:383 -     Mean velocities: w_m=14.682633, w_c=12.404052
2025-10-09 14:14:06 - INFO - run_control_simulation:387 -   State hash: -5775865394934898495
2025-10-09 14:14:06 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:06 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:06 - INFO - run_control_simulation:338 - STEP 2 START:
2025-10-09 14:14:06 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:06 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:06 - INFO - run_control_simulation:341 -   Simulation time: 120.00s
2025-10-09 14:14:07 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:07 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:07 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:07 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:07 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.119366e-01, max=6.384165e+00, std=1.327570e+00
2025-10-09 14:14:07 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.025045, rho_c=0.031793
2025-10-09 14:14:07 - INFO - run_control_simulation:383 -     Mean velocities: w_m=15.548859, w_c=13.170011
2025-10-09 14:14:07 - INFO - run_control_simulation:387 -   State hash: -8339573376487568058
2025-10-09 14:14:07 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:07 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:07 - INFO - run_control_simulation:338 - STEP 3 START:
2025-10-09 14:14:07 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:07 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:07 - INFO - run_control_simulation:341 -   Simulation time: 180.00s
2025-10-09 14:14:07 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:07 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:07 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:07 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:07 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.122143e-01, max=6.274938e+00, std=1.302440e+00
2025-10-09 14:14:07 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.017953, rho_c=0.025235
2025-10-09 14:14:07 - INFO - run_control_simulation:383 -     Mean velocities: w_m=16.415099, w_c=13.936082
2025-10-09 14:14:07 - INFO - run_control_simulation:387 -   State hash: -6554015712345364437
2025-10-09 14:14:07 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:07 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:07 - INFO - run_control_simulation:338 - STEP 4 START:
2025-10-09 14:14:07 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:07 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:07 - INFO - run_control_simulation:341 -   Simulation time: 240.00s
2025-10-09 14:14:08 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:08 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:08 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:08 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:08 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.124781e-01, max=6.135711e+00, std=1.279057e+00
2025-10-09 14:14:08 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.011742, rho_c=0.019656
2025-10-09 14:14:08 - INFO - run_control_simulation:383 -     Mean velocities: w_m=17.281352, w_c=14.702211
2025-10-09 14:14:08 - INFO - run_control_simulation:387 -   State hash: -3834273448568463944
2025-10-09 14:14:08 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:08 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:08 - INFO - run_control_simulation:338 - STEP 5 START:
2025-10-09 14:14:08 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:08 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:08 - INFO - run_control_simulation:341 -   Simulation time: 300.00s
2025-10-09 14:14:09 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:09 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:09 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:09 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:09 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.126826e-01, max=5.988003e+00, std=1.257786e+00
2025-10-09 14:14:09 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.004657, rho_c=0.013094
2025-10-09 14:14:09 - INFO - run_control_simulation:383 -     Mean velocities: w_m=18.147514, w_c=15.468303
2025-10-09 14:14:09 - INFO - run_control_simulation:387 -   State hash: 2456440914507228556
2025-10-09 14:14:09 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:09 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:09 - INFO - run_control_simulation:338 - STEP 6 START:
2025-10-09 14:14:09 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:09 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:09 - INFO - run_control_simulation:341 -   Simulation time: 360.00s
2025-10-09 14:14:10 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:10 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:10 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:10 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:10 - INFO - run_control_simulation:372 -     Diff statistics: mean=3.961559e-01, max=5.863552e+00, std=1.242187e+00
2025-10-09 14:14:10 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000609, rho_c=0.006111
2025-10-09 14:14:10 - INFO - run_control_simulation:383 -     Mean velocities: w_m=18.978635, w_c=16.205988
2025-10-09 14:14:10 - INFO - run_control_simulation:387 -   State hash: 6408013263197389288
2025-10-09 14:14:10 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:10 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:10 - INFO - run_control_simulation:338 - STEP 7 START:
2025-10-09 14:14:10 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:10 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:10 - INFO - run_control_simulation:341 -   Simulation time: 420.00s
2025-10-09 14:14:11 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:11 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:11 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:11 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:11 - INFO - run_control_simulation:372 -     Diff statistics: mean=2.284862e-01, max=5.782999e+00, std=9.938082e-01
2025-10-09 14:14:11 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 14:14:11 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437283, w_c=16.654659
2025-10-09 14:14:11 - INFO - run_control_simulation:387 -   State hash: 2130814556310301104
2025-10-09 14:14:11 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:11 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:11 - INFO - run_control_simulation:338 - STEP 8 START:
2025-10-09 14:14:11 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:11 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:11 - INFO - run_control_simulation:341 -   Simulation time: 480.00s
2025-10-09 14:14:12 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:12 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:12 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:12 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:12 - INFO - run_control_simulation:372 -     Diff statistics: mean=1.727325e-03, max=1.781517e-01, std=1.351598e-02
2025-10-09 14:14:12 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000486, rho_c=0.000540
2025-10-09 14:14:12 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437595, w_c=16.660326
2025-10-09 14:14:12 - INFO - run_control_simulation:387 -   State hash: -9221641774073267483
2025-10-09 14:14:12 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:12 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:12 - INFO - run_control_simulation:338 - STEP 9 START:
2025-10-09 14:14:12 - INFO - run_control_simulation:339 -   Controller: BaselineController
2025-10-09 14:14:12 - INFO - run_control_simulation:340 -   Action: 1.000000
2025-10-09 14:14:12 - INFO - run_control_simulation:341 -   Simulation time: 540.00s
2025-10-09 14:14:12 - INFO - run_control_simulation:353 -   Reward: -0.024667
2025-10-09 14:14:12 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: True
2025-10-09 14:14:12 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:12 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:12 - INFO - run_control_simulation:372 -     Diff statistics: mean=2.345093e-04, max=4.995000e-02, std=3.318709e-03
2025-10-09 14:14:12 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 14:14:12 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 14:14:12 - INFO - run_control_simulation:387 -   State hash: 4102365659413344714
2025-10-09 14:14:12 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:12 - INFO - run_control_simulation:421 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: -0.25
    - Avg step time: 0.849s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 8.5s
    - Speed ratio: 70.66x real-time

2025-10-09 14:14:12 - INFO - run_control_simulation:422 - Returning 10 state snapshots
2025-10-09 14:14:12 - INFO - evaluate_traffic_performance:433 - Evaluating performance with 10 state snapshots
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 0: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - INFO - evaluate_traffic_performance:441 - First state sample - rho_m[10:15]=[4.50084888e-05 4.50154317e-05 4.50276365e-05 4.50490007e-05
 4.50864725e-05], w_m[10:15]=[19.43605515 19.4349691  19.43313084 19.43002587 19.42479384]
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 1: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 2: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 3: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 4: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 5: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 6: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 7: shape=(4, 204), dtype=float64
2025-10-09 14:14:12 - DEBUG - evaluate_traffic_performance:438 - State 8: shape=(4, 204), dtype=float64
2025-10-09 14:14:13 - DEBUG - evaluate_traffic_performance:438 - State 9: shape=(4, 204), dtype=float64
2025-10-09 14:14:13 - INFO - evaluate_traffic_performance:495 - Calculated metrics: flow=32.074019, efficiency=5.131843, delay=-179.81s
2025-10-09 14:14:13 - INFO - run_control_simulation:261 - ================================================================================
2025-10-09 14:14:13 - INFO - run_control_simulation:262 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 14:14:13 - INFO - run_control_simulation:263 - Starting run_control_simulation:
2025-10-09 14:14:13 - INFO - run_control_simulation:264 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 14:14:13 - INFO - run_control_simulation:265 -   - duration: 600.0s
2025-10-09 14:14:13 - INFO - run_control_simulation:266 -   - control_interval: 60.0s
2025-10-09 14:14:13 - INFO - run_control_simulation:267 -   - device: gpu
2025-10-09 14:14:13 - INFO - run_control_simulation:268 -   - controller: RLController
2025-10-09 14:14:13 - INFO - run_control_simulation:269 - ================================================================================
2025-10-09 14:14:13 - INFO - run_control_simulation:274 - Creating TrafficSignalEnvDirect instance...
2025-10-09 14:14:13 - INFO - run_control_simulation:284 - TrafficSignalEnvDirect created successfully
2025-10-09 14:14:13 - INFO - run_control_simulation:300 - Calling env.reset()...
2025-10-09 14:14:13 - INFO - run_control_simulation:302 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 14:14:13 - INFO - run_control_simulation:306 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 14:14:13 - INFO - run_control_simulation:307 - INITIAL STATE statistics: mean=5.995166e+00, std=5.990711e+00, min=4.500000e-05, max=1.295160e+01
2025-10-09 14:14:13 - INFO - run_control_simulation:323 - Starting simulation loop - max 10 steps
2025-10-09 14:14:13 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:13 - INFO - run_control_simulation:338 - STEP 0 START:
2025-10-09 14:14:13 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:13 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:13 - INFO - run_control_simulation:341 -   Simulation time: 0.00s
2025-10-09 14:14:13 - INFO - run_control_simulation:353 -   Reward: 0.075788
2025-10-09 14:14:13 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:13 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:13 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:13 - INFO - run_control_simulation:372 -     Diff statistics: mean=3.952803e-01, max=6.485954e+00, std=1.423283e+00
2025-10-09 14:14:13 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.037907, rho_c=0.043441
2025-10-09 14:14:13 - INFO - run_control_simulation:383 -     Mean velocities: w_m=13.816428, w_c=11.638331
2025-10-09 14:14:13 - INFO - run_control_simulation:387 -   State hash: -4345058563689295588
2025-10-09 14:14:13 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:13 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:13 - INFO - run_control_simulation:338 - STEP 1 START:
2025-10-09 14:14:13 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:13 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:13 - INFO - run_control_simulation:341 -   Simulation time: 60.00s
2025-10-09 14:14:14 - INFO - run_control_simulation:353 -   Reward: 0.075334
2025-10-09 14:14:14 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:14 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:14 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:14 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.114088e-01, max=6.454981e+00, std=1.355427e+00
2025-10-09 14:14:14 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.031256, rho_c=0.037372
2025-10-09 14:14:14 - INFO - run_control_simulation:383 -     Mean velocities: w_m=14.682633, w_c=12.404052
2025-10-09 14:14:14 - INFO - run_control_simulation:387 -   State hash: -5775865394934898495
2025-10-09 14:14:14 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:14 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:14 - INFO - run_control_simulation:338 - STEP 2 START:
2025-10-09 14:14:14 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:14 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:14 - INFO - run_control_simulation:341 -   Simulation time: 120.00s
2025-10-09 14:14:15 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:15 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:15 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:15 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:15 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.117040e-01, max=6.384165e+00, std=1.327638e+00
2025-10-09 14:14:15 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.024604, rho_c=0.031304
2025-10-09 14:14:15 - INFO - run_control_simulation:383 -     Mean velocities: w_m=15.548859, w_c=13.170011
2025-10-09 14:14:15 - INFO - run_control_simulation:387 -   State hash: 3409525597762877669
2025-10-09 14:14:15 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:15 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:15 - INFO - run_control_simulation:338 - STEP 3 START:
2025-10-09 14:14:15 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:15 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:15 - INFO - run_control_simulation:341 -   Simulation time: 180.00s
2025-10-09 14:14:16 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:16 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:16 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:16 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:16 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.119817e-01, max=6.274938e+00, std=1.302509e+00
2025-10-09 14:14:16 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.017953, rho_c=0.025235
2025-10-09 14:14:16 - INFO - run_control_simulation:383 -     Mean velocities: w_m=16.415099, w_c=13.936082
2025-10-09 14:14:16 - INFO - run_control_simulation:387 -   State hash: -6554015712345364437
2025-10-09 14:14:16 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:16 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:16 - INFO - run_control_simulation:338 - STEP 4 START:
2025-10-09 14:14:16 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:16 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:16 - INFO - run_control_simulation:341 -   Simulation time: 240.00s
2025-10-09 14:14:17 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:17 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:17 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:17 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:17 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.122455e-01, max=6.135711e+00, std=1.279127e+00
2025-10-09 14:14:17 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.011301, rho_c=0.019166
2025-10-09 14:14:17 - INFO - run_control_simulation:383 -     Mean velocities: w_m=17.281352, w_c=14.702211
2025-10-09 14:14:17 - INFO - run_control_simulation:387 -   State hash: -8848072453344504044
2025-10-09 14:14:17 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:17 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:17 - INFO - run_control_simulation:338 - STEP 5 START:
2025-10-09 14:14:17 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:17 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:17 - INFO - run_control_simulation:341 -   Simulation time: 300.00s
2025-10-09 14:14:18 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:18 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:18 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:18 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:18 - INFO - run_control_simulation:372 -     Diff statistics: mean=4.124500e-01, max=5.988003e+00, std=1.257858e+00
2025-10-09 14:14:18 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.004657, rho_c=0.013094
2025-10-09 14:14:18 - INFO - run_control_simulation:383 -     Mean velocities: w_m=18.147514, w_c=15.468303
2025-10-09 14:14:18 - INFO - run_control_simulation:387 -   State hash: 2456440914507228556
2025-10-09 14:14:18 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:18 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:18 - INFO - run_control_simulation:338 - STEP 6 START:
2025-10-09 14:14:18 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:18 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:18 - INFO - run_control_simulation:341 -   Simulation time: 360.00s
2025-10-09 14:14:18 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:18 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:18 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:18 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:18 - INFO - run_control_simulation:372 -     Diff statistics: mean=3.959233e-01, max=5.863552e+00, std=1.242256e+00
2025-10-09 14:14:18 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000168, rho_c=0.005622
2025-10-09 14:14:18 - INFO - run_control_simulation:383 -     Mean velocities: w_m=18.978635, w_c=16.205988
2025-10-09 14:14:18 - INFO - run_control_simulation:387 -   State hash: 3303797616209535968
2025-10-09 14:14:18 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:18 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:18 - INFO - run_control_simulation:338 - STEP 7 START:
2025-10-09 14:14:18 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:18 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:18 - INFO - run_control_simulation:341 -   Simulation time: 420.00s
2025-10-09 14:14:19 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:19 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:19 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:19 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:19 - INFO - run_control_simulation:372 -     Diff statistics: mean=2.282536e-01, max=5.782999e+00, std=9.938561e-01
2025-10-09 14:14:19 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 14:14:19 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437283, w_c=16.654659
2025-10-09 14:14:19 - INFO - run_control_simulation:387 -   State hash: 2130814556310301104
2025-10-09 14:14:19 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:19 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:19 - INFO - run_control_simulation:338 - STEP 8 START:
2025-10-09 14:14:19 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:19 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:19 - INFO - run_control_simulation:341 -   Simulation time: 480.00s
2025-10-09 14:14:20 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:20 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: False
2025-10-09 14:14:20 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:20 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:20 - INFO - run_control_simulation:372 -     Diff statistics: mean=1.494715e-03, max=1.781517e-01, std=1.312870e-02
2025-10-09 14:14:20 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 14:14:20 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437595, w_c=16.660326
2025-10-09 14:14:20 - INFO - run_control_simulation:387 -   State hash: -6608757459029518062
2025-10-09 14:14:20 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:20 - INFO - run_control_simulation:337 - ================================================================================
2025-10-09 14:14:20 - INFO - run_control_simulation:338 - STEP 9 START:
2025-10-09 14:14:20 - INFO - run_control_simulation:339 -   Controller: RLController
2025-10-09 14:14:20 - INFO - run_control_simulation:340 -   Action: 0.000000
2025-10-09 14:14:20 - INFO - run_control_simulation:341 -   Simulation time: 540.00s
2025-10-09 14:14:21 - INFO - run_control_simulation:353 -   Reward: 0.075333
2025-10-09 14:14:21 - INFO - run_control_simulation:354 -   Terminated: False, Truncated: True
2025-10-09 14:14:21 - INFO - run_control_simulation:370 -   STATE EVOLUTION:
2025-10-09 14:14:21 - INFO - run_control_simulation:371 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:14:21 - INFO - run_control_simulation:372 -     Diff statistics: mean=1.899032e-06, max=2.384087e-04, std=1.753523e-05
2025-10-09 14:14:21 - INFO - run_control_simulation:382 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 14:14:21 - INFO - run_control_simulation:383 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 14:14:21 - INFO - run_control_simulation:387 -   State hash: 4102365659413344714
2025-10-09 14:14:21 - INFO - run_control_simulation:389 - ================================================================================
2025-10-09 14:14:21 - INFO - run_control_simulation:421 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: 0.75
    - Avg step time: 0.846s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 8.5s
    - Speed ratio: 70.93x real-time

2025-10-09 14:14:21 - INFO - run_control_simulation:422 - Returning 10 state snapshots
2025-10-09 14:14:21 - INFO - evaluate_traffic_performance:433 - Evaluating performance with 10 state snapshots
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 0: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - INFO - evaluate_traffic_performance:441 - First state sample - rho_m[10:15]=[4.50084888e-05 4.50154317e-05 4.50276365e-05 4.50490007e-05
 4.50864725e-05], w_m[10:15]=[19.43605515 19.4349691  19.43313084 19.43002587 19.42479384]
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 1: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 2: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 3: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 4: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 5: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 6: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 7: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 8: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - DEBUG - evaluate_traffic_performance:438 - State 9: shape=(4, 204), dtype=float64
2025-10-09 14:14:21 - INFO - evaluate_traffic_performance:495 - Calculated metrics: flow=32.074019, efficiency=5.131843, delay=-179.81s
2025-10-09 14:14:21 - WARNING - run_performance_comparison:716 - States comparison - Identical: False, baseline_hash=7364168260573208, rl_hash=-4345058563689295588
2025-10-09 14:14:21 - INFO - run_performance_comparison:719 - Baseline performance: {'total_flow': 32.07401924204339, 'avg_speed': 115215.7768773796, 'avg_density': 0.030266830720844955, 'efficiency': 5.131843078726943, 'delay': -179.8127182734218, 'throughput': 160370.09621021696}
2025-10-09 14:14:21 - INFO - run_performance_comparison:720 - RL performance: {'total_flow': 32.07401924204339, 'avg_speed': 115215.7768773796, 'avg_density': 0.030266830720844955, 'efficiency': 5.131843078726943, 'delay': -179.8127182734218, 'throughput': 160370.09621021696}
2025-10-09 14:14:21 - INFO - run_performance_comparison:728 - Flow improvement: 0.000%
2025-10-09 14:14:21 - INFO - run_performance_comparison:729 - Efficiency improvement: 0.000%
2025-10-09 14:14:21 - INFO - run_performance_comparison:730 - Delay reduction: -0.000%
