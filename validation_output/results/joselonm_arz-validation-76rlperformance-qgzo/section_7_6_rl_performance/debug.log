2025-10-10 16:17:08 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-10 16:17:08 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-10 16:17:08 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-10 16:17:08 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-10 16:17:08 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-10 16:17:08 - INFO - train_rl_agent:564 - ================================================================================
2025-10-10 16:17:08 - INFO - train_rl_agent:565 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-10 16:17:08 - INFO - train_rl_agent:566 -   - Device: gpu
2025-10-10 16:17:08 - INFO - train_rl_agent:567 -   - Total timesteps: 100
2025-10-10 16:17:08 - INFO - train_rl_agent:568 -   - Episode max time: 120.0s
2025-10-10 16:17:08 - INFO - train_rl_agent:569 -   - Checkpoint frequency: 50
2025-10-10 16:17:08 - INFO - train_rl_agent:570 - ================================================================================
2025-10-10 16:17:08 - INFO - _create_scenario_config:205 - Created scenario config: traffic_light_control.yml
2025-10-10 16:17:08 - INFO - _create_scenario_config:206 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-10 16:17:08 - INFO - _create_scenario_config:207 -   Uniform density: rho_m=80.0 veh/km, rho_c=100.0 veh/km
2025-10-10 16:17:08 - INFO - _create_scenario_config:208 -   Uniform velocity: w_m=12.0 m/s, w_c=10.0 m/s
2025-10-10 16:17:08 - ERROR - train_rl_agent:694 - Training failed for traffic_light_control: could not convert string to float: 'rho_m_veh_m'
Traceback (most recent call last):
  File "/kaggle/working/Code-traffic-flow/validation_ch7/scripts/test_section_7_6_rl_performance.py", line 589, in train_rl_agent
    env = TrafficSignalEnvDirect(
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 141, in __init__
    self._initialize_simulator()
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 158, in _initialize_simulator
    self.runner = SimulationRunner(
                  ^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 97, in __init__
    self.U = self._create_initial_state()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 283, in _create_initial_state
    U_init = initial_conditions.uniform_state(self.grid, *state_vals)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/initial_conditions.py", line 22, in uniform_state
    U_initial[0, :] = rho_m_val
    ~~~~~~~~~^^^^^^
ValueError: could not convert string to float: 'rho_m_veh_m'
2025-10-10 16:17:08 - INFO - run_performance_comparison:702 - ================================================================================
2025-10-10 16:17:08 - INFO - run_performance_comparison:703 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-10 16:17:08 - INFO - run_performance_comparison:704 - Device: gpu
2025-10-10 16:17:08 - INFO - run_performance_comparison:705 - ================================================================================
2025-10-10 16:17:08 - INFO - run_performance_comparison:706 - ================================================================================
2025-10-10 16:17:08 - INFO - run_performance_comparison:707 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-10 16:17:08 - INFO - run_performance_comparison:708 - Device: gpu
2025-10-10 16:17:08 - INFO - run_performance_comparison:709 - ================================================================================
2025-10-10 16:17:08 - INFO - _create_scenario_config:205 - Created scenario config: traffic_light_control.yml
2025-10-10 16:17:08 - INFO - _create_scenario_config:206 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-10 16:17:08 - INFO - _create_scenario_config:207 -   Uniform density: rho_m=80.0 veh/km, rho_c=100.0 veh/km
2025-10-10 16:17:08 - INFO - _create_scenario_config:208 -   Uniform velocity: w_m=12.0 m/s, w_c=10.0 m/s
2025-10-10 16:17:08 - INFO - run_control_simulation:288 - ================================================================================
2025-10-10 16:17:08 - INFO - run_control_simulation:289 - Starting run_control_simulation:
2025-10-10 16:17:08 - INFO - run_control_simulation:290 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-10 16:17:08 - INFO - run_control_simulation:291 -   - duration: 600.0s
2025-10-10 16:17:08 - INFO - run_control_simulation:292 -   - control_interval: 60.0s
2025-10-10 16:17:08 - INFO - run_control_simulation:293 -   - device: gpu
2025-10-10 16:17:08 - INFO - run_control_simulation:294 -   - controller: BaselineController
2025-10-10 16:17:08 - INFO - run_control_simulation:295 -   - max_control_steps: 11
2025-10-10 16:17:08 - INFO - run_control_simulation:296 - ================================================================================
2025-10-10 16:17:08 - INFO - run_control_simulation:301 - Creating TrafficSignalEnvDirect instance...
2025-10-10 16:17:08 - ERROR - run_control_simulation:321 - Failed to initialize TrafficSignalEnvDirect: could not convert string to float: 'rho_m_veh_m'
Traceback (most recent call last):
  File "/kaggle/working/Code-traffic-flow/validation_ch7/scripts/test_section_7_6_rl_performance.py", line 308, in run_control_simulation
    env = TrafficSignalEnvDirect(
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 141, in __init__
    self._initialize_simulator()
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 158, in _initialize_simulator
    self.runner = SimulationRunner(
                  ^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 97, in __init__
    self.U = self._create_initial_state()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 283, in _create_initial_state
    U_init = initial_conditions.uniform_state(self.grid, *state_vals)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/initial_conditions.py", line 22, in uniform_state
    U_initial[0, :] = rho_m_val
    ~~~~~~~~~^^^^^^
ValueError: could not convert string to float: 'rho_m_veh_m'
2025-10-10 16:17:08 - ERROR - run_performance_comparison:828 - Performance comparison failed for traffic_light_control: cannot access local variable 'traceback' where it is not associated with a value
Traceback (most recent call last):
  File "/kaggle/working/Code-traffic-flow/validation_ch7/scripts/test_section_7_6_rl_performance.py", line 308, in run_control_simulation
    env = TrafficSignalEnvDirect(
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 141, in __init__
    self._initialize_simulator()
  File "/kaggle/working/Code-traffic-flow/Code_RL/src/env/traffic_signal_env_direct.py", line 158, in _initialize_simulator
    self.runner = SimulationRunner(
                  ^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 97, in __init__
    self.U = self._create_initial_state()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/runner.py", line 283, in _create_initial_state
    U_init = initial_conditions.uniform_state(self.grid, *state_vals)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/arz_model/simulation/initial_conditions.py", line 22, in uniform_state
    U_initial[0, :] = rho_m_val
    ~~~~~~~~~^^^^^^
ValueError: could not convert string to float: 'rho_m_veh_m'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/kaggle/working/Code-traffic-flow/validation_ch7/scripts/test_section_7_6_rl_performance.py", line 717, in run_performance_comparison
    baseline_states, _ = self.run_control_simulation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/Code-traffic-flow/validation_ch7/scripts/test_section_7_6_rl_performance.py", line 323, in run_control_simulation
    traceback.print_exc()
    ^^^^^^^^^
UnboundLocalError: cannot access local variable 'traceback' where it is not associated with a value
