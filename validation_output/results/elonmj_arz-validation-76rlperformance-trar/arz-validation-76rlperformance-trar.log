[{"stream_name":"stdout","time":0.636695669,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.636760807,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.636766558,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.636770342,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.636916821,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.637145534,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.511422611,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.511569838,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.607388653,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.628875343,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.629032123,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.629109334,"data":"\n"}
,{"stream_name":"stdout","time":5.629122531,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.629283974,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.13546275,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.13559223,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.135670744,"data":"\n"}
,{"stream_name":"stdout","time":9.135677706,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.135757312,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":12.998507326,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":15.991892754,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":18.951570857,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":21.930076537,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":24.855453019,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":27.812135753,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":107.319987534,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":107.320251879,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":107.320303307,"data":"\n"}
,{"stream_name":"stdout","time":107.320317245,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":107.320688918,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":107.320794009,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":107.320856605,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":107.320942123,"data":"============================================================\n"}
,{"stream_name":"stderr","time":118.414258138,"data":"2025-10-15 22:35:19.769277: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":118.612133769,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":118.61218422,"data":"E0000 00:00:1760567719.967087     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":118.674077879,"data":"E0000 00:00:1760567720.029129     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":130.218938732,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":130.218970744,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":130.218976908,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":130.218981435,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":130.218985393,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":130.218989191,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":130.218993251,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":130.219169387,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":130.219191809,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":130.219196641,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":130.219201027,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":130.219205273,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":130.219209061,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":130.219800793,"data":"2025-10-15 22:35:31 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":130.219886415,"data":"2025-10-15 22:35:31 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":130.220056444,"data":"2025-10-15 22:35:31 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":130.220200448,"data":"2025-10-15 22:35:31 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":130.220341059,"data":"2025-10-15 22:35:31 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":130.22034998,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":130.220374341,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":130.220378927,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":130.32956475,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":130.425629613,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":130.425659066,"data":"\n"}
,{"stream_name":"stdout","time":130.425664484,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":130.425668692,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":130.425692109,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":130.425696711,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":130.425707172,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":130.42586747000001,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":130.425913808,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":130.426010824,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":130.426094603,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":130.426170283,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":130.426271002,"data":"2025-10-15 22:35:31 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":130.426279267,"data":"\n"}
,{"stream_name":"stdout","time":130.426283486,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":130.426287847,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":130.426291458,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":130.426298163,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":130.426501527,"data":"2025-10-15 22:35:31 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":130.426626509,"data":"2025-10-15 22:35:31 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":130.426709423,"data":"2025-10-15 22:35:31 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":130.42702456,"data":"2025-10-15 22:35:31 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":130.431372756,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":130.431440369,"data":"2025-10-15 22:35:31 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":130.431554322,"data":"2025-10-15 22:35:31 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":130.431636486,"data":"2025-10-15 22:35:31 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":130.431714375,"data":"2025-10-15 22:35:31 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":130.431737958,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":130.431747628,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":130.431866103,"data":"2025-10-15 22:35:31 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":130.43199362,"data":"2025-10-15 22:35:31 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":130.432189413,"data":"2025-10-15 22:35:31 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":130.43232939,"data":"2025-10-15 22:35:31 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config 25b78b90\n"}
,{"stream_name":"stdout","time":130.43233802,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":130.432794337,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":130.432804946,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":130.439830896,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":130.439846259,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":130.439850951,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":130.439855066,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":130.439859416,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":130.439863643,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":130.439867433,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":130.439871284,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":130.439928796,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":130.439940481,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":130.439959843,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":130.439964734,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":130.443303938,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":130.443319308,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":130.44377679,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.443784564,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":131.892968641,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":131.892997285,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":131.893001639,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":131.893005552,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":131.893009135,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":131.893012911,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":131.893016598,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":131.893023588,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":131.893379874,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":131.894186603,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":131.894241537,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":131.894303792,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":136.218808322,"data":"2025-10-15 22:35:37 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":136.219144632,"data":"\n"}
,{"stream_name":"stdout","time":136.219159269,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":136.219162911,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":136.219165672,"data":"\n"}
,{"stream_name":"stdout","time":136.219168124,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.219170793,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":136.219173267,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":136.219175691,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":136.219178174,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":136.219180623,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.219183126,"data":"\n"}
,{"stream_name":"stdout","time":136.219253788,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":136.219261921,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":136.228504504,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":136.228523704,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":136.228528839,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":136.228533305,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":136.22853708,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":136.228667112,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":136.228676447,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":136.228680982,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":136.228685037,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":136.228703474,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.228710974,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":136.228715463,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":136.22954931,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":136.229560582,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":136.23070988,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":136.23071954,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.230724174,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.230728748,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.235737729,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":136.235940493,"data":"\n"}
,{"stream_name":"stdout","time":136.235946986,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":136.237618747,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.237633655,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.237638735,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.237643862,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.237999133,"data":"\n"}
,{"stream_name":"stderr","time":136.273722808,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":136.27374721,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":136.608751985,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":136.608800151,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.608810087,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":136.608814197,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":136.608818503,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.608822779,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":136.785623899,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":136.785654096,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":137.45458238,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":137.454613295,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":137.514393784,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":137.514416231,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":137.57158241,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":137.571608261,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":137.99161541,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":137.991642466,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.06513829,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.065167104,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.148743919,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.14877229,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.245670526,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.245698929,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.342725848,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.34275948,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.402144965,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.402174033,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":138.458545286,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":138.458574714,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":138.832298972,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":138.832333991,"data":"\n"}
,{"stream_name":"stderr","time":138.832356463,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.832638924,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.78s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.78s/s]\n"}
,{"stream_name":"stdout","time":138.832650197,"data":"\n"}
,{"stream_name":"stdout","time":138.832666151,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":138.832671892,"data":"Total runtime: 2.60 seconds.\n"}
,{"stream_name":"stdout","time":138.834226498,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":138.834243126,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":138.834464327,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":138.834477541,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":138.834648688,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":138.834833403,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":138.835001059,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":138.835214176,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":138.83522805,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":138.835266891,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":138.835366674,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":138.835396992,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":138.83548056,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":138.835488695,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":138.835502007,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":138.835914134,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.835924681,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.835929114,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.835932978,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.83610193,"data":"\n"}
,{"stream_name":"stdout","time":138.906647559,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":139.284984985,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":139.284984983,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.285015298,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.285402109,"data":"\n"}
,{"stream_name":"stdout","time":139.285416717,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":139.285421818,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":139.285402122,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.41s/s]\n"}
,{"stream_name":"stdout","time":139.287119732,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":139.287136358,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":139.287371944,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14732532 1.         0.01512134 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":139.287379207,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":139.287599145,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":139.287787852,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":139.2879736,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0441976  0.03246922 0.02964819 0.02877944 0.02850045 0.02842542]\n"}
,{"stream_name":"stdout","time":139.288198772,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022682  0.00147918 0.00125801 0.0011752  0.00114374 0.00113409]\n"}
,{"stream_name":"stdout","time":139.288210494,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":139.288269278,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":139.288342745,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":139.288407574,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":139.288413603,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":139.288457142,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":139.288500026,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":139.288896776,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.288903778,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.288907861,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.288911726,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.28912723,"data":"\n"}
,{"stream_name":"stdout","time":139.343822592,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":139.343840687,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.34384595,"data":"  Original dt: 4.633756e-01 s\n"}
,{"stream_name":"stdout","time":139.343850602,"data":"  Corrected dt: 2.896098e-01 s\n"}
,{"stream_name":"stdout","time":139.343854726,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.343858876,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stdout","time":139.356909423,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":139.785072693,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.785104354,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.785088556,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":139.785572845,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.24s/s]\n"}
,{"stream_name":"stdout","time":139.785576935,"data":"\n"}
,{"stream_name":"stdout","time":139.785599109,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":139.785604962,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":139.787091438,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":139.787110401,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":139.787310831,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741239 1.         0.01513268 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":139.787320871,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":139.787504089,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":139.787677877,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":139.787848968,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422372 0.03248503 0.02964484 0.02874772 0.02843718 0.02832831]\n"}
,{"stream_name":"stdout","time":139.788023472,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022699  0.00147934 0.00125354 0.00116332 0.00112318 0.00110507]\n"}
,{"stream_name":"stdout","time":139.788033078,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":139.788086153,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":139.788172866,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":139.788200665,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":139.788242543,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":139.788290703,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":139.788341206,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":139.788751049,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.788761688,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.788766209,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.788770372,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.788939616,"data":"\n"}
,{"stream_name":"stdout","time":139.833536911,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":140.258076617,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":140.258076615,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.258119795,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":140.258354345,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.97s/s]\n"}
,{"stream_name":"stdout","time":140.258389935,"data":"\n"}
,{"stream_name":"stdout","time":140.258399245,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":140.258404281,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":140.259934126,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":140.259949231,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":140.260228924,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474163  1.         0.01513357 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":140.260239869,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":140.260437732,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":140.260594634,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":140.260789055,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422489 0.03248531 0.02964581 0.02874856 0.02843571 0.02832439]\n"}
,{"stream_name":"stdout","time":140.260969121,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147945 0.00125344 0.00116259 0.00112129 0.00110166]\n"}
,{"stream_name":"stdout","time":140.260975935,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":140.261073817,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.261151199,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.261193752,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.261200845,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.261279875,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":140.261347492,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":140.261870088,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.261877016,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.261881299,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.261885094,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.262090286,"data":"\n"}
,{"stream_name":"stdout","time":140.281280827,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":140.281310304,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.28131578,"data":"  Original dt: 4.617817e-01 s\n"}
,{"stream_name":"stdout","time":140.281320256,"data":"  Corrected dt: 2.886135e-01 s\n"}
,{"stream_name":"stdout","time":140.281324345,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.281328731,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":140.289377325,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":140.733163043,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.733190546,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.73319795,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":140.733515587,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.83s/s]\n"}
,{"stream_name":"stdout","time":140.733527849,"data":"\n"}
,{"stream_name":"stdout","time":140.733570271,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":140.733575553,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":140.735097192,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":140.735112293,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":140.735327208,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474164  1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":140.735334753,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":140.735519836,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":140.735685859,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":140.735857867,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248525 0.02964588 0.02874873 0.02843574 0.02832427]\n"}
,{"stream_name":"stdout","time":140.736021679,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.00110133]\n"}
,{"stream_name":"stdout","time":140.736027847,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":140.736115198,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.736175397,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.736219633,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.736305991,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.736318667,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":140.736396962,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.736791779,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.736800322,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.7368053,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.736809281,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.737024118,"data":"\n"}
,{"stream_name":"stdout","time":140.746432458,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":141.216592939,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":141.216622775,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.216628956,"data":"  Original dt: 4.617543e-01 s\n"}
,{"stream_name":"stdout","time":141.216633341,"data":"  Corrected dt: 2.885965e-01 s\n"}
,{"stream_name":"stdout","time":141.216651435,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.216662634,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":141.224323271,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":141.233963492,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":141.234002376,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.234018078,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.234286156,"data":"\n"}
,{"stream_name":"stderr","time":141.234295631,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.18s/s]\n"}
,{"stream_name":"stdout","time":141.234300185,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":141.234312637,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":141.23581515,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":141.235908925,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.235979137,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.236011734,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.236039532,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.236118652,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":141.236163547,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.23657271,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.236580543,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.236586305,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.236590636,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.23679612,"data":"\n"}
,{"stream_name":"stdout","time":141.675681285,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":141.703154667,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.703182371,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.7032129,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":141.703492889,"data":"\n"}
,{"stream_name":"stdout","time":141.703504175,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":141.70350854,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":141.703496825,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.16s/s]\n"}
,{"stream_name":"stdout","time":141.705050423,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":141.705105288,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.705210256,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.705218041,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.705241925,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.70531589,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":141.705367356,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.705782429,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.705789064,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.705793669,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.705798265,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.705967276,"data":"\n"}
,{"stream_name":"stdout","time":142.117412804,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":142.117440667,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.11744788,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":142.117451619,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":142.117454082,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.117456902,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":142.125433859,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":142.170448123,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":142.170445369,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.170479347,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.170775471,"data":"\n"}
,{"stream_name":"stdout","time":142.170784367,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":142.170788943,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":142.170798758,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.29s/s]\n"}
,{"stream_name":"stdout","time":142.172243354,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":142.172360516,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.172381066,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.172429247,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.172463934,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.172538241,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.172553906,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.172595301,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":142.172687161,"data":"\n"}
,{"stream_name":"stdout","time":142.172695788,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":142.172700064,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.03 | Avg Reward/Step: 0.004\n"}
,{"stream_name":"stdout","time":142.172703704,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":142.172707065,"data":"\n"}
,{"stream_name":"stdout","time":142.172710586,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":142.172715354,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":142.180258309,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":142.180276036,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":142.180280905,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":142.180285141,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":142.180306454,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":142.180457206,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":142.180466456,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":142.180470358,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":142.180473944,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":142.180477476,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.180490967,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":142.180493923,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":142.181084159,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":142.181096359,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":142.181409542,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":142.181674442,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.181681662,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.181686399,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.18370515,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.183732403,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.183737129,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.183741008,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.183873271,"data":"\n"}
,{"stream_name":"stderr","time":142.558462809,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.558491201,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.558468997,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":142.558722861,"data":"\n"}
,{"stream_name":"stdout","time":142.558733519,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":142.55873723,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":142.558747132,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.04s/s]\n"}
,{"stream_name":"stdout","time":142.560371889,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":142.560387356,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":142.560618648,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":142.56062624,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":142.560811397,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":142.560996502,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":142.561202885,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":142.561367163,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":142.561377146,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":142.561447735,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.561512326,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.561528682,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.561570435,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.561609836,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.561663093,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.562016699,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.562023214,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.562039679,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.562043834,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.562237437,"data":"\n"}
,{"stream_name":"stdout","time":142.634571878,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":143.023503714,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":143.02350245,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.023544741,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":143.023794339,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.52s/s]\n"}
,{"stream_name":"stdout","time":143.023802707,"data":"\n"}
,{"stream_name":"stdout","time":143.023813624,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":143.023817727,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":143.025299153,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":143.025604906,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.025615954,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.025620746,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.025624478,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.025771493,"data":"\n"}
,{"stream_name":"stdout","time":143.0357433,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":143.035758877,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.035763584,"data":"  Original dt: 4.637575e-01 s\n"}
,{"stream_name":"stdout","time":143.035767526,"data":"  Corrected dt: 2.898484e-01 s\n"}
,{"stream_name":"stdout","time":143.035771144,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.035774829,"data":"  Max wave speed detected: 17.25 m/s\n"}
,{"stream_name":"stdout","time":143.087989789,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":143.488716291,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.488746628,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.488742211,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":143.488911361,"data":"\n"}
,{"stream_name":"stderr","time":143.488910641,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.40s/s]\n"}
,{"stream_name":"stdout","time":143.488922522,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":143.48894732,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":143.49048648,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":143.490773635,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.490785786,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.490790615,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.490794442,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.490952424,"data":"\n"}
,{"stream_name":"stdout","time":143.535519203,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":143.928804044,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":143.928830315,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.928835649,"data":"  Original dt: 4.617872e-01 s\n"}
,{"stream_name":"stdout","time":143.928839635,"data":"  Corrected dt: 2.886170e-01 s\n"}
,{"stream_name":"stdout","time":143.928843278,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.928847059,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":143.956455087,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.956490017,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.956453795,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":143.956797376,"data":"\n"}
,{"stream_name":"stdout","time":143.956806609,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stderr","time":143.956802229,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":143.956811554,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":143.958403932,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.958847345,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.958855091,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.958859216,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.958863219,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.95904579,"data":"\n"}
,{"stream_name":"stdout","time":143.986317411,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":144.423563617,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":144.423569122,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.423615364,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":144.423839217,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.29s/s]\n"}
,{"stream_name":"stdout","time":144.423847397,"data":"\n"}
,{"stream_name":"stdout","time":144.423863938,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":144.423868311,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":144.425420075,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.425701574,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.425711175,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.425716506,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.425721501,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.425885354,"data":"\n"}
,{"stream_name":"stdout","time":144.435241334,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":144.843151643,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":144.84318355,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.843188859,"data":"  Original dt: 4.617545e-01 s\n"}
,{"stream_name":"stdout","time":144.843192688,"data":"  Corrected dt: 2.885966e-01 s\n"}
,{"stream_name":"stdout","time":144.843196537,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.843202182,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":144.896881546,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":144.906369201,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":144.906374179,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.906399029,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.906752831,"data":"\n"}
,{"stream_name":"stdout","time":144.90676057,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":144.906765079,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":144.906778371,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.21s/s]\n"}
,{"stream_name":"stdout","time":144.908396078,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.90868618,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.908692889,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.908697018,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.908700994,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.908860969,"data":"\n"}
,{"stream_name":"stdout","time":145.348440109,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":145.375829481,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":145.375829603,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.375873272,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.376080411,"data":"\n"}
,{"stream_name":"stdout","time":145.376100726,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":145.37610627,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":145.376088171,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.12s/s]\n"}
,{"stream_name":"stdout","time":145.377665352,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":145.377959984,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.377967661,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.377971871,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.377975823,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.378160632,"data":"\n"}
,{"stream_name":"stdout","time":145.744017439,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":145.744042112,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.744047166,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":145.744051169,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":145.744054842,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.744084958,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":145.797129034,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":145.841840576,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":145.841880276,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.84189113,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":145.841960742,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.35s/s]\n"}
,{"stream_name":"stdout","time":145.842004563,"data":"\n"}
,{"stream_name":"stdout","time":145.842019227,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":145.842023878,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":145.843579689,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":145.843594597,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":145.843599408,"data":"\n"}
,{"stream_name":"stdout","time":145.84360324,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.843607347,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":145.843614147,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.843618396,"data":"\n"}
,{"stream_name":"stdout","time":145.84362722,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.843631851,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.850885082,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.850903357,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.850908469,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.850912845,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.850916554,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.850977059,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.850983573,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.850987888,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.851022734,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.851030253,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.851049283,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.851054656,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.851676274,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.851684181,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":145.851968982,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.852247094,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.852258438,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.852263238,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.854108364,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.854120577,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.854125604,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.854130124,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.854324818,"data":"\n"}
,{"stream_name":"stderr","time":146.253207193,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":146.253228621,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":146.25323574,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":146.25332394,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.61s/s]\n"}
,{"stream_name":"stdout","time":146.253357885,"data":"\n"}
,{"stream_name":"stdout","time":146.253381667,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":146.253386732,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":146.254953812,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":146.254971068,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":146.255019897,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":146.255030427,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":146.255244407,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":146.255401519,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":146.255565886,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":146.255727495,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":146.255734075,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":146.255811055,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.25586041,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":146.255913337,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.255921796,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":146.255996948,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":146.256003635,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.256415472,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.256449369,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":146.256455066,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.256459198,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.256595354,"data":"\n"}
,{"stream_name":"stdout","time":146.327831869,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":146.684051492,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":146.684098778,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.684104833,"data":"  Original dt: 4.642550e-01 s\n"}
,{"stream_name":"stdout","time":146.684108663,"data":"  Corrected dt: 2.901594e-01 s\n"}
,{"stream_name":"stdout","time":146.684112275,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.684115953,"data":"  Max wave speed detected: 17.23 m/s\n"}
,{"stream_name":"stdout","time":146.719514734,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":146.719607101,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.719624312,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.71985325,"data":"\n"}
,{"stream_name":"stderr","time":146.71985684,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.40s/s]\n"}
,{"stream_name":"stdout","time":146.719865764,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":146.719889288,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":146.721440069,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.721750265,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.721758031,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.721762597,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.72176695,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.721923782,"data":"\n"}
,{"stream_name":"stdout","time":146.785106883,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":147.188411724,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.188444769,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.188458312,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":147.188720857,"data":"\n"}
,{"stream_name":"stdout","time":147.18873049,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stderr","time":147.188724617,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":147.188735117,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":147.19049186,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.190822638,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.190830508,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.190835435,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.190839242,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.191005417,"data":"\n"}
,{"stream_name":"stdout","time":147.236460593,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":147.58822146,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":147.58825178,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.588257993,"data":"  Original dt: 4.617937e-01 s\n"}
,{"stream_name":"stdout","time":147.588262209,"data":"  Corrected dt: 2.886210e-01 s\n"}
,{"stream_name":"stdout","time":147.588265962,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.58827138,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":147.659354219,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":147.659371637,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.659383761,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.659690396,"data":"\n"}
,{"stream_name":"stdout","time":147.659698889,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":147.659703441,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":147.659716557,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":147.661387645,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.661800333,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.661807922,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.661812633,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.661817229,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.661956992,"data":"\n"}
,{"stream_name":"stdout","time":147.689324987,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.134308537,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":148.134308545,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.134342519,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":148.134534891,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.76s/s]\n"}
,{"stream_name":"stdout","time":148.134543492,"data":"\n"}
,{"stream_name":"stdout","time":148.134558573,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":148.134563376,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":148.136113902,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.136430249,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.136441476,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.13644603,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.136450128,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.136574145,"data":"\n"}
,{"stream_name":"stdout","time":148.145692108,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.497650344,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":148.497676803,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.497682079,"data":"  Original dt: 4.617547e-01 s\n"}
,{"stream_name":"stdout","time":148.497685995,"data":"  Corrected dt: 2.885967e-01 s\n"}
,{"stream_name":"stdout","time":148.497689753,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.497693526,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":148.597056934,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.606170339,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":148.606170251,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.606197624,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.606458354,"data":"\n"}
,{"stream_name":"stdout","time":148.606472474,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":148.606477049,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":148.606478603,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.94s/s]\n"}
,{"stream_name":"stdout","time":148.608077289,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.608424005,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.60843513,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.608439753,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.60844346,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.608588819,"data":"\n"}
,{"stream_name":"stdout","time":149.047760417,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":149.076142606,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":149.07614332,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.076181488,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":149.076444762,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.09s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.08s/s]\n"}
,{"stream_name":"stdout","time":149.076470194,"data":"\n"}
,{"stream_name":"stdout","time":149.076479769,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":149.076484393,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":149.078117429,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.078421689,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.0784323,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.078437126,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.078441146,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.078586344,"data":"\n"}
,{"stream_name":"stdout","time":149.398724703,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":149.398751457,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.398756678,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":149.39876056,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":149.398764253,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.398768073,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":149.497014629,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":149.54086261,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.540899512,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.540871085,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":149.541022422,"data":"\n"}
,{"stream_name":"stdout","time":149.541029164,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":149.541033517,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":149.54102979,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.45s/s]\n"}
,{"stream_name":"stdout","time":149.542690944,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.542709757,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":149.542714996,"data":"\n"}
,{"stream_name":"stdout","time":149.54271935,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.54272321,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":149.542727455,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.542732017,"data":"\n"}
,{"stream_name":"stdout","time":149.542736058,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":149.542740575,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":149.549892215,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":149.54991042,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":149.549916003,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":149.54991987,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":149.549924436,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":149.549930721,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":149.54993524,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":149.54995249,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":149.549993018,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":149.550045955,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.55005257,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":149.550057068,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":149.550698102,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":149.550704394,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":149.551015133,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":149.551627112,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.551638659,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.551654054,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.553567395,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.553585683,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.553591323,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.553595663,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.553618312,"data":"\n"}
,{"stream_name":"stderr","time":149.937416235,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.937447502,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.937421622,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":149.937675448,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.08s/s]\n"}
,{"stream_name":"stdout","time":149.937676875,"data":"\n"}
,{"stream_name":"stdout","time":149.937693748,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":149.937698162,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":149.939147524,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":149.939163606,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":149.939381185,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":149.939388665,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":149.939586961,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":149.939758032,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":149.939959598,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":149.94015357,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":149.940164268,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":149.940272401,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":149.94031081,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":149.940386077,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":149.940394291,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":149.940454378,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":149.940500169,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.94085765,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.940869889,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.940874871,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.940879454,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.941043246,"data":"\n"}
,{"stream_name":"stdout","time":150.01243264,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":150.312410661,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":150.312432562,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.312437545,"data":"  Original dt: 4.649032e-01 s\n"}
,{"stream_name":"stdout","time":150.312441342,"data":"  Corrected dt: 2.905645e-01 s\n"}
,{"stream_name":"stdout","time":150.312445073,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.312448762,"data":"  Max wave speed detected: 17.21 m/s\n"}
,{"stream_name":"stdout","time":150.391141834,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":150.391191477,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.391206436,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":150.391304995,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.33s/s]\n"}
,{"stream_name":"stdout","time":150.391324833,"data":"\n"}
,{"stream_name":"stdout","time":150.391330021,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":150.391334177,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":150.392864161,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.393196309,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.393207,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.39321135,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.393215198,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.393416877,"data":"\n"}
,{"stream_name":"stdout","time":150.455818887,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":150.884484241,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.884511185,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.884484297,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":150.884674445,"data":"\n"}
,{"stream_name":"stdout","time":150.884700059,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":150.884705102,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":150.884705484,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.55s/s]\n"}
,{"stream_name":"stdout","time":150.886329532,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.88651588,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.886526066,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.8865304,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.88653436,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.88673982,"data":"\n"}
,{"stream_name":"stdout","time":150.932253017,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":151.244388756,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":151.244416686,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.244423884,"data":"  Original dt: 4.618018e-01 s\n"}
,{"stream_name":"stdout","time":151.244428469,"data":"  Corrected dt: 2.886261e-01 s\n"}
,{"stream_name":"stdout","time":151.24443307,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.244436756,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":151.35977861,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":151.359790986,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":151.359807272,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.359990491,"data":"\n"}
,{"stream_name":"stdout","time":151.359999667,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":151.360004602,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":151.360011357,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.70s/s]\n"}
,{"stream_name":"stdout","time":151.361591314,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.362025157,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.362032765,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.362037128,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.362041064,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.362261245,"data":"\n"}
,{"stream_name":"stdout","time":151.389849931,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":151.8330068,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.833032284,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.833006968,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":151.833208398,"data":"\n"}
,{"stream_name":"stdout","time":151.833221762,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":151.833225968,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":151.833208412,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.87s/s]\n"}
,{"stream_name":"stdout","time":151.835011843,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":151.835230695,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.835241736,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.835246219,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.835250096,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.835417163,"data":"\n"}
,{"stream_name":"stdout","time":151.84435453,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":152.152527293,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":152.152562939,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.152568688,"data":"  Original dt: 4.617549e-01 s\n"}
,{"stream_name":"stdout","time":152.152572539,"data":"  Corrected dt: 2.885968e-01 s\n"}
,{"stream_name":"stdout","time":152.152576094,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.152580138,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":152.294548843,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":152.30415269,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":152.304195096,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.304212323,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.304445211,"data":"\n"}
,{"stream_name":"stdout","time":152.304455991,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":152.304460432,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":152.304459411,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.00s/s]\n"}
,{"stream_name":"stdout","time":152.306057286,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.306375221,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.306385727,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.306390309,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.306394599,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.306564684,"data":"\n"}
,{"stream_name":"stdout","time":152.750266267,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":152.777687392,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":152.777690908,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.777718027,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":152.777931292,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.84s/s]\n"}
,{"stream_name":"stdout","time":152.77794359,"data":"\n"}
,{"stream_name":"stdout","time":152.777954074,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":152.777958358,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":152.779604178,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.779790305,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.779800857,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.779805171,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.779809404,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.779973426,"data":"\n"}
,{"stream_name":"stdout","time":153.059350101,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":153.059373843,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.059378786,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":153.059383071,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":153.059386715,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.05939037,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":153.20252017,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":153.247170718,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.247216134,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.247179206,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":153.247458192,"data":"\n"}
,{"stream_name":"stderr","time":153.247460165,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.10s/s]\n"}
,{"stream_name":"stdout","time":153.247470564,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":153.247481233,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":153.249102934,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.249117904,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":153.249191598,"data":"\n"}
,{"stream_name":"stdout","time":153.249199773,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":153.24920459,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":153.249209273,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":153.249213063,"data":"\n"}
,{"stream_name":"stdout","time":153.249216766,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":153.249220994,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":153.256800738,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":153.256817207,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":153.256822028,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":153.256826452,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":153.256848945,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":153.256989417,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":153.256997606,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":153.25700204,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":153.257006073,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":153.25701047,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.257028687,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":153.257032691,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":153.25763644,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":153.257649032,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":153.257901273,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":153.258166138,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.258186532,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.258190786,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.26002201,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":153.260034353,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":153.260038902,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":153.260042977,"data":"|    ep_rew_mean      | 0.0825   |\n"}
,{"stream_name":"stdout","time":153.260047549,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":153.260051069,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":153.260054867,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":153.26007344,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":153.26007848,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":153.260084955,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":153.260089124,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":153.261207332,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.261222925,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.261227447,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.261232816,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.261382267,"data":"\n"}
,{"stream_name":"stdout","time":153.637730916,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":153.63773088,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.637758905,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.637981007,"data":"\n"}
,{"stream_name":"stdout","time":153.637990017,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":153.637994441,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":153.638000207,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.85s/s]\n"}
,{"stream_name":"stdout","time":153.639461968,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":153.639474802,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":153.639699663,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":153.639707198,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":153.639883598,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":153.640086406,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":153.640276493,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":153.640464723,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":153.640471863,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":153.6405634,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":153.64066398,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":153.640670522,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":153.640761075,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":153.640775832,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":153.640814294,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.641190594,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.641202019,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.641206466,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.641210539,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.641382211,"data":"\n"}
,{"stream_name":"stdout","time":153.714700294,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":153.975437048,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":153.975462333,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.975467455,"data":"  Original dt: 4.657469e-01 s\n"}
,{"stream_name":"stdout","time":153.975471232,"data":"  Corrected dt: 2.910918e-01 s\n"}
,{"stream_name":"stdout","time":153.97547485,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.975480187,"data":"  Max wave speed detected: 17.18 m/s\n"}
,{"stream_name":"stderr","time":154.105195362,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.105222899,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.105221892,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":154.105519202,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.34s/s]\n"}
,{"stream_name":"stdout","time":154.105530615,"data":"\n"}
,{"stream_name":"stdout","time":154.105552406,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":154.105557948,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":154.10714869,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.107454961,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.107465403,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.107469671,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.107473898,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.107624607,"data":"\n"}
,{"stream_name":"stdout","time":154.170751441,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":154.569464855,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":154.569480356,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":154.569492608,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.569655574,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.48s/s]\n"}
,{"stream_name":"stdout","time":154.569672712,"data":"\n"}
,{"stream_name":"stdout","time":154.569677193,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":154.569680776,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":154.571359966,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.571666096,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.571678551,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.571683056,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.571686962,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.571853223,"data":"\n"}
,{"stream_name":"stdout","time":154.616319581,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":154.898593128,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":154.898623414,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.898629022,"data":"  Original dt: 4.618121e-01 s\n"}
,{"stream_name":"stdout","time":154.898633319,"data":"  Corrected dt: 2.886326e-01 s\n"}
,{"stream_name":"stdout","time":154.898637631,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.898641637,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":155.058135119,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":155.058136708,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.058178601,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.058504418,"data":"\n"}
,{"stream_name":"stdout","time":155.05853192,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":155.058537067,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":155.058501335,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.84s/s]\n"}
,{"stream_name":"stdout","time":155.060048179,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.060522617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.060534779,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.060540031,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.060544673,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.060711241,"data":"\n"}
,{"stream_name":"stdout","time":155.088347537,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":155.524103945,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.524134549,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.524103191,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":155.524195421,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.38s/s]\n"}
,{"stream_name":"stdout","time":155.52419485,"data":"\n"}
,{"stream_name":"stdout","time":155.524208367,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":155.524213099,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":155.525776915,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.526053828,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.526109982,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.526115168,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.526119477,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.52624792,"data":"\n"}
,{"stream_name":"stdout","time":155.535250946,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":155.793978405,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":155.79400198,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.794007444,"data":"  Original dt: 4.617553e-01 s\n"}
,{"stream_name":"stdout","time":155.794011615,"data":"  Corrected dt: 2.885970e-01 s\n"}
,{"stream_name":"stdout","time":155.794027473,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.79403151100001,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":155.983148557,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":155.99322278,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":155.99325173,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.99326155,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.993543115,"data":"\n"}
,{"stream_name":"stdout","time":155.993552588,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":155.99355692,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":155.993557301,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.11s/s]\n"}
,{"stream_name":"stdout","time":155.995156359,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.995472559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.995479456,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.995484386,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.995488977,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.99565793,"data":"\n"}
,{"stream_name":"stdout","time":156.434506855,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":156.46121472,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":156.461214716,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.461243756,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":156.461541085,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":156.46155634,"data":"\n"}
,{"stream_name":"stdout","time":156.46156317,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":156.461581576,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":156.463172588,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.463487135,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.46349565,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.46351695,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.463522835,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.463679762,"data":"\n"}
,{"stream_name":"stdout","time":156.699090683,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":156.6991175,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.699122538,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":156.699126278,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":156.699130001,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.69913456,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":156.889717794,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":156.935308946,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":156.935348831,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.93536042,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":156.93563155,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.80s/s]\n"}
,{"stream_name":"stdout","time":156.935661043,"data":"\n"}
,{"stream_name":"stdout","time":156.935674853,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":156.935679634,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":156.937278817,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":156.937308061,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":156.937313427,"data":"\n"}
,{"stream_name":"stdout","time":156.937317595,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.937322206,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":156.937326284,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.937331021,"data":"\n"}
,{"stream_name":"stdout","time":156.937354154,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":156.937366883,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":156.944307579,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":156.944327641,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":156.944332731,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":156.944343347,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":156.944347329,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":156.944456905,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":156.944464053,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":156.944468377,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":156.944491569,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":156.944498952,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.94453486,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":156.944540693,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":156.945129683,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":156.945141273,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":156.945408263,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":156.945654471,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.945661466,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.945666511,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.947546191,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.947558469,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.947563487,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.947567578,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.947700953,"data":"\n"}
,{"stream_name":"stderr","time":157.319370311,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.319397033,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.319369278,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":157.31969311,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.35s/s]\n"}
,{"stream_name":"stdout","time":157.319695256,"data":"\n"}
,{"stream_name":"stdout","time":157.319708932,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":157.3197139,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":157.321333782,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":157.321350584,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":157.32158294,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":157.321590213,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":157.321756795,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":157.321922598,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":157.322093583,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":157.322267942,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":157.322274371,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":157.322356648,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":157.322404903,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":157.322473546,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":157.322481048,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":157.322518973,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":157.322534908,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.32286186,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.322868651,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.322873614,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.322878314,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.323038132,"data":"\n"}
,{"stream_name":"stdout","time":157.395090209,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":157.611036403,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":157.611076013,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.611085093,"data":"  Original dt: 4.667575e-01 s\n"}
,{"stream_name":"stdout","time":157.611089701,"data":"  Corrected dt: 2.917234e-01 s\n"}
,{"stream_name":"stdout","time":157.611093948,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.611098569,"data":"  Max wave speed detected: 17.14 m/s\n"}
,{"stream_name":"stderr","time":157.780702524,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.780729982,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.780705811,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":157.781009021,"data":"\n"}
,{"stream_name":"stdout","time":157.781020197,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":157.781024905,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":157.781027766,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.77s/s]\n"}
,{"stream_name":"stdout","time":157.782558871,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.782855772,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.782863497,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.782868029,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.782871755,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.783027198,"data":"\n"}
,{"stream_name":"stdout","time":157.845760608,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":158.254754358,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":158.254769443,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.254791952,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.255019409,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.80s/s]\n"}
,{"stream_name":"stdout","time":158.255019847,"data":"\n"}
,{"stream_name":"stdout","time":158.255035681,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":158.25503999,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":158.256688034,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.256989534,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.256996707,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.257001513,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.257005961,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.257203259,"data":"\n"}
,{"stream_name":"stdout","time":158.303335111,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":158.528329734,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":158.528355693,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.528361383,"data":"  Original dt: 4.618253e-01 s\n"}
,{"stream_name":"stdout","time":158.528365581,"data":"  Corrected dt: 2.886408e-01 s\n"}
,{"stream_name":"stdout","time":158.528369654,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.5283737,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":158.734763439,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":158.734784674,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.734804968,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.734998658,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.41s/s]\n"}
,{"stream_name":"stdout","time":158.734998481,"data":"\n"}
,{"stream_name":"stdout","time":158.735013157,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":158.73501786,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.737116429,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.737544997,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.737553903,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.737559162,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.737563655,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.737751448,"data":"\n"}
,{"stream_name":"stdout","time":158.765639818,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":159.211172613,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.211202937,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.211238323,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":159.211523899,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.68s/s]\n"}
,{"stream_name":"stdout","time":159.211527222,"data":"\n"}
,{"stream_name":"stdout","time":159.211544102,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":159.211548394,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":159.213217043,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.213534079,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.21355481,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.213560092,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.213564552,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.213717188,"data":"\n"}
,{"stream_name":"stdout","time":159.222853267,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":159.436140307,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":159.436161205,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.436177245,"data":"  Original dt: 4.617556e-01 s\n"}
,{"stream_name":"stdout","time":159.436181518,"data":"  Corrected dt: 2.885973e-01 s\n"}
,{"stream_name":"stdout","time":159.436185093,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.436188599,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":159.673740881,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":159.683484836,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":159.683523866,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.68354207,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.683811513,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.92s/s]\n"}
,{"stream_name":"stdout","time":159.683832649,"data":"\n"}
,{"stream_name":"stdout","time":159.683841589,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":159.683846037,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":159.685419773,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.685790574,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.685802425,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.685807518,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.685812345,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.685888408,"data":"\n"}
,{"stream_name":"stdout","time":160.155578318,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":160.18277785,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":160.182780519,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.18280912,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.183046474,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.18s/s]\n"}
,{"stream_name":"stdout","time":160.183056499,"data":"\n"}
,{"stream_name":"stdout","time":160.183113026,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":160.183118227,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":160.184678652,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.184973598,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.184994833,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.184999458,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.185003355,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.185170623,"data":"\n"}
,{"stream_name":"stdout","time":160.372487983,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":160.372515716,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.372521605,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":160.372525617,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":160.372538184,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.372542283,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":160.608908222,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":160.654156362,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.654187279,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.654156364,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":160.654345903,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.99s/s]\n"}
,{"stream_name":"stdout","time":160.654379386,"data":"\n"}
,{"stream_name":"stdout","time":160.654397477,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":160.654402477,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":160.655940885,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.655952009,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":160.655985491,"data":"\n"}
,{"stream_name":"stdout","time":160.656000196,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.656005053,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":160.656008959,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.656012723,"data":"\n"}
,{"stream_name":"stdout","time":160.656077794,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":160.656089274,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":160.663022371,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":160.663038205,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":160.663042574,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":160.663046382,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":160.663080831,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":160.66321109,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":160.663219043,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":160.66322337,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":160.663227707,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":160.663231205,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.663245699,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":160.663249536,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":160.663835691,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":160.663846158,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":160.66408062,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":160.664288066,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.664297116,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.664301547,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.66610787,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.666123512,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.666128072,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.666132006,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.666297961,"data":"\n"}
,{"stream_name":"stdout","time":161.067927179,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":161.067984695,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.068000445,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.068107206,"data":"\n"}
,{"stream_name":"stderr","time":161.06811341,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.35s/s]\n"}
,{"stream_name":"stdout","time":161.068121868,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":161.068132391,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":161.069789111,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":161.069806297,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":161.070041826,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":161.070052124,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":161.070254906,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":161.070433826,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":161.070612496,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":161.070796512,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":161.070806296,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":161.070852434,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":161.070934836,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":161.070965369,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":161.070996599,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":161.071087484,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":161.071099931,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.071501559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.071513641,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.071518435,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.07152325,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.071690783,"data":"\n"}
,{"stream_name":"stdout","time":161.147114706,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":161.319078164,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":161.31910522,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.319110746,"data":"  Original dt: 4.680303e-01 s\n"}
,{"stream_name":"stdout","time":161.319115056,"data":"  Corrected dt: 2.925189e-01 s\n"}
,{"stream_name":"stdout","time":161.319119249,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.319123687,"data":"  Max wave speed detected: 17.09 m/s\n"}
,{"stream_name":"stdout","time":161.532377032,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":161.532435122,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.532451538,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":161.532636022,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.56s/s]\n"}
,{"stream_name":"stdout","time":161.532643544,"data":"\n"}
,{"stream_name":"stdout","time":161.532655135,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":161.532659424,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":161.534154244,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.553092876,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":161.553294131,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.553302265,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.553306623,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.553310456,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.553476562,"data":"\n"}
,{"stream_name":"stdout","time":161.617922165,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":162.032053118,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":162.032120928,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.032128536,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.032364736,"data":"\n"}
,{"stream_name":"stderr","time":162.03236668,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.34s/s]\n"}
,{"stream_name":"stdout","time":162.032373517,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":162.032381263,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":162.034512254,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.034837654,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.034844697,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.034849438,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.034853967,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.035020603,"data":"\n"}
,{"stream_name":"stdout","time":162.080459983,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":162.251872014,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":162.251900248,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.251907442,"data":"  Original dt: 4.618406e-01 s\n"}
,{"stream_name":"stdout","time":162.251910818,"data":"  Corrected dt: 2.886504e-01 s\n"}
,{"stream_name":"stdout","time":162.251913466,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.251916028,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":162.510271772,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":162.510288465,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.510326361,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.510582417,"data":"\n"}
,{"stream_name":"stdout","time":162.510592786,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":162.510597557,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":162.510590404,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.56s/s]\n"}
,{"stream_name":"stdout","time":162.51224477,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.512678951,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.512686566,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.512691431,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.51269582,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.512840814,"data":"\n"}
,{"stream_name":"stdout","time":162.539903492,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":162.979856314,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.979885415,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.979893648,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":162.980081138,"data":"\n"}
,{"stream_name":"stderr","time":162.980087628,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.12s/s]\n"}
,{"stream_name":"stdout","time":162.980096128,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":162.980104186,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":162.98184783,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.982157985,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.98217384,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.982178522,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.982182647,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.98232851,"data":"\n"}
,{"stream_name":"stdout","time":162.991025941,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":163.163385741,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":163.163413561,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.16341952,"data":"  Original dt: 4.617560e-01 s\n"}
,{"stream_name":"stdout","time":163.163427535,"data":"  Corrected dt: 2.885975e-01 s\n"}
,{"stream_name":"stdout","time":163.163431191,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.163434766,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":163.437368797,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":163.446216672,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":163.44624069,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.446248378,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.446536124,"data":"\n"}
,{"stream_name":"stdout","time":163.446552096,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":163.446557195,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":163.44654732,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.33s/s]\n"}
,{"stream_name":"stdout","time":163.44813105,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.448479705,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.448487336,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.448491454,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.448495473,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.448671881,"data":"\n"}
,{"stream_name":"stdout","time":163.881104773,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":163.908175436,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":163.908184221,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.908203709,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":163.908685053,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.64s/s]\n"}
,{"stream_name":"stdout","time":163.908706553,"data":"\n"}
,{"stream_name":"stdout","time":163.908712416,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":163.908717513,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":163.910361086,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.910692364,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.910701359,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.910705952,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.910710365,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.910908454,"data":"\n"}
,{"stream_name":"stdout","time":164.056851726,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":164.056871576,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.056877202,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":164.056881593,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":164.05688605,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.056889758,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":164.331838827,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":164.377529532,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":164.37753857,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.377553765,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.377814209,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.14s/s]\n"}
,{"stream_name":"stdout","time":164.377832958,"data":"\n"}
,{"stream_name":"stdout","time":164.377837706,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":164.377841992,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":164.379343341,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.379365864,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":164.379370462,"data":"\n"}
,{"stream_name":"stdout","time":164.379374094,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.379378154,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":164.379382783,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.379386805,"data":"\n"}
,{"stream_name":"stdout","time":164.379390875,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":164.379397308,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":164.386681658,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":164.386711137,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":164.386716885,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":164.386721678,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":164.386725614,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":164.386766306,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":164.38677962,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":164.386784469,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":164.386808708,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":164.386816338,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.386849951,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":164.38685849,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":164.387463097,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":164.387476291,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":164.387731235,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":164.388311435,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.38832329,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.388328264,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.390078448,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.390090518,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.390095463,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.390099413,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.390274468,"data":"\n"}
,{"stream_name":"stderr","time":164.77552273,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.775561249,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.775532226,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":164.775733462,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.94s/s]\n"}
,{"stream_name":"stdout","time":164.775742835,"data":"\n"}
,{"stream_name":"stdout","time":164.775752219,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":164.775757243,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":164.777217653,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":164.777235051,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":164.777447864,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":164.777470165,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":164.777623953,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":164.777780488,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":164.777947909,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":164.778108579,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":164.778122157,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":164.778207395,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":164.778273222,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":164.778298941,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":164.778351077,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":164.778366644,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":164.778455265,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.778780712,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.778788999,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.778793881,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.778797847,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.778967624,"data":"\n"}
,{"stream_name":"stdout","time":164.84901599,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":164.99388459,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":164.993907392,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.993912211,"data":"  Original dt: 4.697057e-01 s\n"}
,{"stream_name":"stdout","time":164.993916057,"data":"  Corrected dt: 2.935661e-01 s\n"}
,{"stream_name":"stdout","time":164.993919742,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.993923673,"data":"  Max wave speed detected: 17.03 m/s\n"}
,{"stream_name":"stdout","time":165.254441047,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":165.25446541,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.254478372,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.254708489,"data":"\n"}
,{"stream_name":"stdout","time":165.254717125,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stderr","time":165.254725502,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.54s/s]\n"}
,{"stream_name":"stdout","time":165.25473375,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":165.256240744,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.256623187,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.256630741,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.256635409,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.256639304,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.256804529,"data":"\n"}
,{"stream_name":"stdout","time":165.318857912,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":165.718129378,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":165.718133304,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.718172558,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.718422406,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.51s/s]\n"}
,{"stream_name":"stdout","time":165.718430764,"data":"\n"}
,{"stream_name":"stdout","time":165.718439451,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":165.718444042,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":165.720029937,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.720355709,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.72036676,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.720371412,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.720377026,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.720548552,"data":"\n"}
,{"stream_name":"stdout","time":165.766738095,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":165.894479713,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":165.894504164,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.894509798,"data":"  Original dt: 4.618586e-01 s\n"}
,{"stream_name":"stdout","time":165.894514222,"data":"  Corrected dt: 2.886616e-01 s\n"}
,{"stream_name":"stdout","time":165.894518232,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.894536422,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":166.188908469,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":166.18891432,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.188942514,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.189183408,"data":"\n"}
,{"stream_name":"stderr","time":166.1891862,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":166.189194767,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":166.189203935,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":166.190754999,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.191248782,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.191258485,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.191268241,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.191272184,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.191488291,"data":"\n"}
,{"stream_name":"stdout","time":166.219467283,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":166.65753794,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":166.657543845,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.657571476,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.657766747,"data":"\n"}
,{"stream_name":"stdout","time":166.657776114,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":166.657781003,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":166.657795415,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.19s/s]\n"}
,{"stream_name":"stdout","time":166.65932748,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.659642862,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.659653492,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.659658229,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.659662126,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.659822642,"data":"\n"}
,{"stream_name":"stdout","time":166.668544481,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":166.794230861,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":166.79424864,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.7942538,"data":"  Original dt: 4.617565e-01 s\n"}
,{"stream_name":"stdout","time":166.794259527,"data":"  Corrected dt: 2.885978e-01 s\n"}
,{"stream_name":"stdout","time":166.794262152,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.79426475,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":167.112198659,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":167.121386682,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.121408031,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.121436861,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":167.121752148,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.49s/s]\n"}
,{"stream_name":"stdout","time":167.121754494,"data":"\n"}
,{"stream_name":"stdout","time":167.121768001,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":167.121772754,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":167.123451148,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.123754178,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.12376203,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.123766253,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.123770075,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.123931552,"data":"\n"}
,{"stream_name":"stdout","time":167.560821671,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":167.588201928,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":167.588208183,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.588232602,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.588608884,"data":"\n"}
,{"stream_name":"stderr","time":167.588611664,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.30s/s]\n"}
,{"stream_name":"stdout","time":167.588622829,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":167.588632464,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":167.590175242,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.590781529,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.590793347,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.590797988,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.590802094,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.590944705,"data":"\n"}
,{"stream_name":"stdout","time":167.690680294,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":167.690706552,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.690711914,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":167.690717386,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":167.690720616,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.690723496,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":168.014883602,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":168.060237388,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":168.060246226,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.060274038,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.060594322,"data":"\n"}
,{"stream_name":"stdout","time":168.060609653,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":168.060614497,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":168.060626611,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.96s/s]\n"}
,{"stream_name":"stdout","time":168.062282426,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.06229667,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":168.062302027,"data":"\n"}
,{"stream_name":"stdout","time":168.062306312,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.062347303,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":168.062355202,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.062360703,"data":"\n"}
,{"stream_name":"stdout","time":168.062364499,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":168.062367384,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":168.069382059,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":168.069396484,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":168.069401155,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":168.069405644,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":168.06943758,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":168.069595969,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":168.069607815,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":168.069611994,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":168.069615637,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":168.069619502,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.069623348,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":168.069626959,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":168.070218369,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":168.070235735,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":168.07050774,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":168.070741169,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.07075125,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.070755494,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.072678902,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":168.072695472,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":168.072699934,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":168.072703771,"data":"|    ep_rew_mean      | 0.095    |\n"}
,{"stream_name":"stdout","time":168.072707284,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":168.072710801,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":168.072714792,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":168.072718898,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":168.072722422,"data":"|    time_elapsed     | 31       |\n"}
,{"stream_name":"stdout","time":168.072726224,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":168.072729537,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":168.073776486,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.073792567,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.073797596,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.07380138,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.073965711,"data":"\n"}
,{"stream_name":"stderr","time":168.449149963,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.449177596,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.449145288,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":168.449420603,"data":"\n"}
,{"stream_name":"stdout","time":168.449429556,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":168.449435586,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":168.449420348,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.97s/s]\n"}
,{"stream_name":"stdout","time":168.450943778,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":168.450965105,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":168.451191755,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":168.451207714,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":168.451364329,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":168.451508176,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":168.45169038,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":168.451855087,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":168.45186249099999,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":168.451935713,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":168.451995134,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":168.452077541,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":168.452090736,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":168.452114588,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":168.452172481,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.452508745,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.45251615,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.452520918,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.452524752,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.452698241,"data":"\n"}
,{"stream_name":"stdout","time":168.524959255,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":168.607918673,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":168.607945326,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.607951609,"data":"  Original dt: 4.719124e-01 s\n"}
,{"stream_name":"stdout","time":168.607955574,"data":"  Corrected dt: 2.949452e-01 s\n"}
,{"stream_name":"stdout","time":168.607959207,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.607962851,"data":"  Max wave speed detected: 16.95 m/s\n"}
,{"stream_name":"stdout","time":168.908268395,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":168.908274681,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.908300896,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":168.908611783,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.92s/s]\n"}
,{"stream_name":"stdout","time":168.908616335,"data":"\n"}
,{"stream_name":"stdout","time":168.908629601,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":168.908634501,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":168.910232579,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.910540761,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.910558262,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.910562568,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.910566756,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.910708137,"data":"\n"}
,{"stream_name":"stdout","time":168.971736588,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":169.369615198,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":169.369633207,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.369654844,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.369783455,"data":"\n"}
,{"stream_name":"stdout","time":169.36979685,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":169.369802987,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":169.369816357,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.69s/s]\n"}
,{"stream_name":"stdout","time":169.371484529,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.37174201,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.371750373,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.371755663,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.371760233,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.371932053,"data":"\n"}
,{"stream_name":"stdout","time":169.416303769,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":169.496049352,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":169.496094145,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.496100115,"data":"  Original dt: 4.618816e-01 s\n"}
,{"stream_name":"stdout","time":169.496104463,"data":"  Corrected dt: 2.886760e-01 s\n"}
,{"stream_name":"stdout","time":169.496108616,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.496113167,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":169.837716103,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":169.83775518,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.837766275,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.8379679,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.20s/s]\n"}
,{"stream_name":"stdout","time":169.837971423,"data":"\n"}
,{"stream_name":"stdout","time":169.837982938,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":169.837987806,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":169.839697265,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.840035447,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.840044204,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.840049035,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.840053688,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.840229676,"data":"\n"}
,{"stream_name":"stdout","time":169.867675818,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":170.310638474,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":170.310638469,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.310672476,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.3108725,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.89s/s]\n"}
,{"stream_name":"stdout","time":170.310897438,"data":"\n"}
,{"stream_name":"stdout","time":170.310913812,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":170.31091867,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":170.312661725,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.312967272,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.312979079,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.31298375,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.312987895,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.313152803,"data":"\n"}
,{"stream_name":"stdout","time":170.322581753,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":170.403649405,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":170.403665347,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.403670111,"data":"  Original dt: 4.617570e-01 s\n"}
,{"stream_name":"stdout","time":170.403673899,"data":"  Corrected dt: 2.885981e-01 s\n"}
,{"stream_name":"stdout","time":170.403677738,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.403681419,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":170.778073705,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":170.793044989,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":170.793122808,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.793151076,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.793414597,"data":"\n"}
,{"stream_name":"stdout","time":170.793427298,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":170.793506418,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":170.79347671,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.25s/s]\n"}
,{"stream_name":"stdout","time":170.795993332,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.79649757,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.79651453,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.796519062,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.796533086,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.796697775,"data":"\n"}
,{"stream_name":"stdout","time":171.254204233,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":171.280999526,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":171.281037776,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.28107575,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.281291902,"data":"\n"}
,{"stream_name":"stdout","time":171.281301958,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":171.281306293,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":171.28132279,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":171.282961815,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":171.283296173,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.283312407,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.283317616,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.283321581,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.283459909,"data":"\n"}
,{"stream_name":"stdout","time":171.338039064,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":171.338056499,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.338083268,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":171.338088403,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":171.338092662,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.338096788,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":171.700968706,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":171.746113537,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.746141489,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.7461391,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":171.746354249,"data":"\n"}
,{"stream_name":"stderr","time":171.746354297,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.42s/s]\n"}
,{"stream_name":"stdout","time":171.746363966,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":171.746372237,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":171.748127214,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.748149345,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":171.748154569,"data":"\n"}
,{"stream_name":"stdout","time":171.748158882,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.748163417,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":171.748168306,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.74817253,"data":"\n"}
,{"stream_name":"stdout","time":171.748176507,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":171.74818132,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":171.756108067,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":171.7561279,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":171.756131516,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":171.756134252,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":171.7561369,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":171.756298492,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":171.756305954,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":171.756310695,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":171.756326018,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":171.75633935,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.756422272,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":171.756430067,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":171.757109243,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":171.757122692,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":171.757478593,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":171.75779144,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.757799504,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.757804666,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.759791362,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.759805709,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.759810577,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.759815018,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.759969117,"data":"\n"}
,{"stream_name":"stdout","time":172.138206458,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":172.138206514,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.138238616,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.138540647,"data":"\n"}
,{"stream_name":"stderr","time":172.138540797,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.65s/s]\n"}
,{"stream_name":"stdout","time":172.13854921,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":172.138558443,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":172.140109646,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":172.1401264,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":172.140356617,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":172.140364281,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":172.140557386,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":172.140715439,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":172.140898781,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":172.141075866,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":172.141088478,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":172.141168077,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":172.141221414,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":172.141295238,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":172.141333821,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":172.141354528,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":172.14139699,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.1417832,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.141791384,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.141795947,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.141799909,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.141983238,"data":"\n"}
,{"stream_name":"stdout","time":172.21344989,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":172.250682803,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":172.250710554,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.25071593,"data":"  Original dt: 4.747258e-01 s\n"}
,{"stream_name":"stdout","time":172.250720146,"data":"  Corrected dt: 2.967036e-01 s\n"}
,{"stream_name":"stdout","time":172.250724732,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.250728857,"data":"  Max wave speed detected: 16.85 m/s\n"}
,{"stream_name":"stdout","time":172.599146537,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":172.599229501,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.599246227,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.599423114,"data":"\n"}
,{"stream_name":"stdout","time":172.59943373,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":172.599438412,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":172.599472155,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.81s/s]\n"}
,{"stream_name":"stdout","time":172.601031965,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.601354358,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.601366027,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.601370802,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.6013747,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.601566609,"data":"\n"}
,{"stream_name":"stdout","time":172.665079979,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":173.067250202,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":173.067249297,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.067285377,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":173.067521055,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":173.06752291,"data":"\n"}
,{"stream_name":"stdout","time":173.06754611,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":173.067550292,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":173.069043626,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.06936694,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.069377492,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.069381833,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.069385614,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.069553025,"data":"\n"}
,{"stream_name":"stdout","time":173.114493922,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":173.152371176,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":173.152387988,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.152392714,"data":"  Original dt: 4.619107e-01 s\n"}
,{"stream_name":"stdout","time":173.152398029,"data":"  Corrected dt: 2.886942e-01 s\n"}
,{"stream_name":"stdout","time":173.152400772,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.152403227,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":173.536140848,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":173.536157705,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":173.536166447,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":173.53642763,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":173.536434067,"data":"\n"}
,{"stream_name":"stdout","time":173.536448357,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":173.536453129,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":173.538112767,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.538549582,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.538558913,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.538563416,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.538567475,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.538761544,"data":"\n"}
,{"stream_name":"stdout","time":173.567336884,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":174.014965559,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":174.01496704,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.014998427,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.015187382,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.50s/s]\n"}
,{"stream_name":"stdout","time":174.015193833,"data":"\n"}
,{"stream_name":"stdout","time":174.015212604,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":174.015217488,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":174.016882139,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.017200381,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.017217076,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.0172221,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.017226227,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.017364087,"data":"\n"}
,{"stream_name":"stdout","time":174.027690312,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":174.065054211,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":174.065089806,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.065095243,"data":"  Original dt: 4.617577e-01 s\n"}
,{"stream_name":"stdout","time":174.065098967,"data":"  Corrected dt: 2.885985e-01 s\n"}
,{"stream_name":"stdout","time":174.065102819,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.065108189,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":174.472027658,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":174.481086694,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":174.481086905,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.481114743,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.481275396,"data":"\n"}
,{"stream_name":"stdout","time":174.481306747,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":174.481311729,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":174.481377687,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.35s/s]\n"}
,{"stream_name":"stdout","time":174.482995875,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.483327653,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.48334508,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.48336284,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.483367071,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.483495588,"data":"\n"}
,{"stream_name":"stdout","time":174.923874694,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":174.95082468,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":174.95085448,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.950873273,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.951094891,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.09s/s]\n"}
,{"stream_name":"stdout","time":174.951103141,"data":"\n"}
,{"stream_name":"stdout","time":174.951117353,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":174.951121847,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":174.952696994,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.953030187,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.953037562,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.953041782,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.953045625,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.953255111,"data":"\n"}
,{"stream_name":"stdout","time":174.962741791,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":174.962757336,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.962761953,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":174.962765708,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":174.962769535,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.962773121,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":175.37029696,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":175.414441035,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":175.414468874,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.414487429,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.414716848,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.52s/s]\n"}
,{"stream_name":"stdout","time":175.41472012,"data":"\n"}
,{"stream_name":"stdout","time":175.414734086,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":175.414759401,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":175.416297865,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.416311226,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":175.416367636,"data":"\n"}
,{"stream_name":"stdout","time":175.41637897,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.416383842,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":175.41638825,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.416392514,"data":"\n"}
,{"stream_name":"stdout","time":175.416396651,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":175.416401144,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":175.423342995,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":175.423359843,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":175.423364523,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":175.423368572,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":175.423372508,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":175.423489276,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":175.423498943,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":175.423503293,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":175.423507437,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":175.423512355,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.423536507,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":175.423557009,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":175.424140528,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":175.424155637,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":175.424386116,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":175.424627034,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.424637037,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.424641472,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.426415571,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.426431353,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.426449868,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.426454133,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.42656837,"data":"\n"}
,{"stream_name":"stdout","time":175.803489282,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":175.803522028,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.803546342,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.803743093,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.79s/s]\n"}
,{"stream_name":"stdout","time":175.803747468,"data":"\n"}
,{"stream_name":"stdout","time":175.803758382,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":175.803763089,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":175.805326408,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":175.805340115,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":175.805573014,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":175.805580563,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":175.805778069,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":175.805968893,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":175.806165107,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":175.806359715,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":175.806366743,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":175.806467434,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":175.806504078,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":175.806567686,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":175.806574095,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":175.806620794,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":175.806637293,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.80699022,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.806997464,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.807002745,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.807021274,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.807198721,"data":"\n"}
,{"stream_name":"stdout","time":175.871267319,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":175.871285294,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.871290369,"data":"  Original dt: 4.782068e-01 s\n"}
,{"stream_name":"stdout","time":175.871295867,"data":"  Corrected dt: 2.988793e-01 s\n"}
,{"stream_name":"stdout","time":175.871298368,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.871300925,"data":"  Max wave speed detected: 16.73 m/s\n"}
,{"stream_name":"stdout","time":175.879097673,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":176.266181253,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":176.266233587,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.266245623,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.266503787,"data":"\n"}
,{"stream_name":"stdout","time":176.266547353,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":176.266553997,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":176.266506769,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.68s/s]\n"}
,{"stream_name":"stdout","time":176.268025021,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.268327491,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.268343291,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.268348316,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.268352406,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.268510093,"data":"\n"}
,{"stream_name":"stdout","time":176.331477763,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":176.737253275,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.737280506,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.737253157,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":176.737478067,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.00s/s]\n"}
,{"stream_name":"stdout","time":176.737482057,"data":"\n"}
,{"stream_name":"stdout","time":176.737495889,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":176.737504168,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":176.739105602,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":176.739411014,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.739423434,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.7394278,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.739431423,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.739574076,"data":"\n"}
,{"stream_name":"stdout","time":176.77788919,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":176.77790563,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.77791044,"data":"  Original dt: 4.619479e-01 s\n"}
,{"stream_name":"stdout","time":176.777914195,"data":"  Corrected dt: 2.887174e-01 s\n"}
,{"stream_name":"stdout","time":176.777918241,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.777922157,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":176.786261797,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":177.219435025,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.219464687,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.219445714,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":177.219761783,"data":"\n"}
,{"stream_name":"stdout","time":177.219778679,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":177.219783782,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":177.219781386,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.25s/s]\n"}
,{"stream_name":"stdout","time":177.221448449,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.221915065,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.221923976,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.221928808,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.221933666,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.222155464,"data":"\n"}
,{"stream_name":"stdout","time":177.25360618,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":177.706452739,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":177.706452722,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.706529212,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.70668327,"data":"\n"}
,{"stream_name":"stdout","time":177.706692092,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":177.706697274,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":177.706705861,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":177.708205165,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.708548682,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.708558224,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.708562544,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.708566532,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.708707349,"data":"\n"}
,{"stream_name":"stdout","time":177.709794988,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":177.709808635,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.709812955,"data":"  Original dt: 4.617584e-01 s\n"}
,{"stream_name":"stdout","time":177.709816667,"data":"  Corrected dt: 2.885990e-01 s\n"}
,{"stream_name":"stdout","time":177.709822013,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.709824756,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":177.717743725,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":178.166375129,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":178.175924131,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":178.175926826,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.175958156,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":178.176100819,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.11s/s]\n"}
,{"stream_name":"stdout","time":178.176119668,"data":"\n"}
,{"stream_name":"stdout","time":178.17612995,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":178.176134358,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":178.177674226,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.177998361,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.178025179,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.178034092,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.178037943,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.178209154,"data":"\n"}
,{"stream_name":"stdout","time":178.609122748,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":178.609151572,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.60915696,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":178.609159722,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":178.609162423,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.609165828,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":178.617458442,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":178.644472109,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.644493693,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.644472106,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":178.644737981,"data":"\n"}
,{"stream_name":"stderr","time":178.644739225,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.16s/s]\n"}
,{"stream_name":"stdout","time":178.64474535,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":178.644753178,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":178.646337115,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.646651959,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.646659321,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.646663727,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.646667648,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.646829622,"data":"\n"}
,{"stream_name":"stdout","time":179.070279309,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":179.115708822,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":179.115710483,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.115738998,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":179.116035166,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.99s/s]\n"}
,{"stream_name":"stdout","time":179.116037278,"data":"\n"}
,{"stream_name":"stdout","time":179.116096191,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":179.116101215,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":179.117692116,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":179.117708056,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":179.117754864,"data":"\n"}
,{"stream_name":"stdout","time":179.117770108,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.117775246,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":179.117779741,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.117783777,"data":"\n"}
,{"stream_name":"stdout","time":179.117787292,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.117791613,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.124809857,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.124825888,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.124830855,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.124835278,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.124852336,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.124994787,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.125004836,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.125008774,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.125011391,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.125013855,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.125022336,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.125025327,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.125640255,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.125651665,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.125905801,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.126156427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.126167909,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.126173049,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.127994678,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.128015765,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.1280203,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.128025833,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.12819985,"data":"\n"}
,{"stream_name":"stderr","time":179.505768522,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.505800168,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.505773438,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":179.505980636,"data":"\n"}
,{"stream_name":"stdout","time":179.505990627,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":179.505995323,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":179.506033528,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.73s/s]\n"}
,{"stream_name":"stdout","time":179.507517398,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":179.507544182,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":179.50771579,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":179.507725904,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":179.507894044,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":179.508051727,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":179.508237256,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":179.508413096,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":179.508422548,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":179.50847092,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.508542375,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.508563191,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.508631451,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.508638634,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":179.508685696,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.509044952,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.509052174,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.509083025,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.509092997,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.509236847,"data":"\n"}
,{"stream_name":"stdout","time":179.529000309,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":179.529016789,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.529020241,"data":"  Original dt: 4.828960e-01 s\n"}
,{"stream_name":"stdout","time":179.529022665,"data":"  Corrected dt: 3.018100e-01 s\n"}
,{"stream_name":"stdout","time":179.529025532,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.529028291,"data":"  Max wave speed detected: 16.57 m/s\n"}
,{"stream_name":"stdout","time":179.581716961,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stderr","time":179.97116446,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.971197032,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.971170099,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":179.971340216,"data":"\n"}
,{"stream_name":"stdout","time":179.971348266,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":179.971352242,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":179.971355787,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.48s/s]\n"}
,{"stream_name":"stdout","time":179.972998075,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.973336473,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.973348625,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.973353961,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.973358182,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.973520643,"data":"\n"}
,{"stream_name":"stdout","time":180.035963908,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":180.43152927,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":180.431567805,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.43157404,"data":"  Original dt: 4.619895e-01 s\n"}
,{"stream_name":"stdout","time":180.431578705,"data":"  Corrected dt: 2.887434e-01 s\n"}
,{"stream_name":"stdout","time":180.431583484,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.431587814,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":180.440026264,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":180.44003749,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.440077167,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":180.440343261,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":180.440381756,"data":"\n"}
,{"stream_name":"stdout","time":180.440395361,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":180.440404168,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":180.441997468,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":180.442336768,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.442347393,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.442351773,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.442355604,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.44256759,"data":"\n"}
,{"stream_name":"stdout","time":180.488748191,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":180.953867844,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.953894217,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":180.953867846,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":180.954110894,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.33s/s]\n"}
,{"stream_name":"stdout","time":180.954136206,"data":"\n"}
,{"stream_name":"stdout","time":180.954143776,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":180.95414823,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":180.955709866,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":180.956168004,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.956180086,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.956185362,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.956237135,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.956470849,"data":"\n"}
,{"stream_name":"stdout","time":180.983661707,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":181.380908149,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":181.380947514,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.380953251,"data":"  Original dt: 4.617593e-01 s\n"}
,{"stream_name":"stdout","time":181.380957058,"data":"  Corrected dt: 2.885996e-01 s\n"}
,{"stream_name":"stdout","time":181.380960799,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.380964739,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":181.42470801,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":181.424733488,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.424751875,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.424997382,"data":"\n"}
,{"stream_name":"stderr","time":181.42500257,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.03s/s]\n"}
,{"stream_name":"stdout","time":181.425006735,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":181.425014804,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":181.426591694,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":181.426902893,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.42691004,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.426914225,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.42691848,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.427108297,"data":"\n"}
,{"stream_name":"stdout","time":181.43617947,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":181.881116912,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":181.890486001,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":181.890486027,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.890530846,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.890752816,"data":"\n"}
,{"stream_name":"stderr","time":181.890754659,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.37s/s]\n"}
,{"stream_name":"stdout","time":181.890761231,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":181.890777016,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":181.892363131,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":181.892712286,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.892720576,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.892724712,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.892728431,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.89293576,"data":"\n"}
,{"stream_name":"stdout","time":182.280580701,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":182.28061015,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.280614601,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":182.280617305,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":182.280619784,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.280622327,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":182.332799445,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":182.359572113,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":182.35961577,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.359633412,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":182.359788876,"data":"\n"}
,{"stream_name":"stdout","time":182.359797288,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stderr","time":182.359796101,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":182.359801895,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":182.361338188,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":182.361635407,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.36164323,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.361647426,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.361651246,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.361820842,"data":"\n"}
,{"stream_name":"stdout","time":182.78444338,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":182.829146515,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":182.829178126,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.829194604,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":182.829437766,"data":"\n"}
,{"stream_name":"stdout","time":182.829454496,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":182.829473258,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":182.829437606,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.09s/s]\n"}
,{"stream_name":"stdout","time":182.831037471,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.831054471,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":182.831091655,"data":"\n"}
,{"stream_name":"stdout","time":182.83109656,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.831100703,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.017\n"}
,{"stream_name":"stdout","time":182.831105017,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.831109453,"data":"\n"}
,{"stream_name":"stdout","time":182.831113279,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.831117436,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":182.838005681,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.838020261,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.838024875,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.838028964,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.838034414,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":182.838206533,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":182.838217529,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":182.83822129,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":182.838224951,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":182.838228442,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.838239233,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":182.838243398,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":182.838821226,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":182.838827586,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":182.839092848,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":182.839407757,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.839415223,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.839420284,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.841347662,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":182.84135845,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":182.841363195,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":182.841367248,"data":"|    ep_rew_mean      | 0.103    |\n"}
,{"stream_name":"stdout","time":182.841371387,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":182.841375108,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":182.841378732,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":182.841386815,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":182.841392148,"data":"|    time_elapsed     | 46       |\n"}
,{"stream_name":"stdout","time":182.841397496,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":182.841401655,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":182.842464639,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.84247926,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.842484446,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.84248917,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.842657486,"data":"\n"}
,{"stream_name":"stdout","time":183.192825521,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":183.192853623,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.192858973,"data":"  Original dt: 4.888611e-01 s\n"}
,{"stream_name":"stdout","time":183.192862826,"data":"  Corrected dt: 3.055382e-01 s\n"}
,{"stream_name":"stdout","time":183.192869154,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.192871992,"data":"  Max wave speed detected: 16.36 m/s\n"}
,{"stream_name":"stdout","time":183.218707031,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":183.21873926,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.218748564,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":183.21904197,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.88s/s]\n"}
,{"stream_name":"stdout","time":183.219044018,"data":"\n"}
,{"stream_name":"stdout","time":183.219086887,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":183.219092785,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":183.220557516,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":183.220574687,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":183.220790171,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":183.220797914,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":183.220966934,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":183.221150167,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":183.221330395,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":183.221521147,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":183.221528348,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":183.22159286,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.221672748,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.221679747,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.221744227,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.221766802,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":183.221799282,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":183.222176591,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.222208593,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.222214053,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.222218258,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.222390209,"data":"\n"}
,{"stream_name":"stdout","time":183.294270664,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stderr","time":183.677740549,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.67776808,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":183.677740802,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":183.678002177,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.94s/s]\n"}
,{"stream_name":"stdout","time":183.67802773,"data":"\n"}
,{"stream_name":"stdout","time":183.678039342,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":183.67804368,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":183.679578368,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":183.679922177,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.679929598,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.679944972,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.679947723,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.680056288,"data":"\n"}
,{"stream_name":"stdout","time":183.744608469,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":184.095969082,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":184.095991725,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.095995571,"data":"  Original dt: 4.620409e-01 s\n"}
,{"stream_name":"stdout","time":184.095998615,"data":"  Corrected dt: 2.887756e-01 s\n"}
,{"stream_name":"stdout","time":184.0960012,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.096003784,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stdout","time":184.147827417,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":184.147832029,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.147853198,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":184.148128369,"data":"\n"}
,{"stream_name":"stdout","time":184.148143997,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":184.148148522,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":184.148149172,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.08s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.07s/s]\n"}
,{"stream_name":"stdout","time":184.149640949,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":184.149954433,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.149962208,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.14996653,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.149970493,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":184.15014405,"data":"\n"}
,{"stream_name":"stdout","time":184.194673508,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":184.61588661,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":184.615957231,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.615970021,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":184.616145429,"data":"\n"}
,{"stream_name":"stdout","time":184.616156686,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":184.616161744,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":184.616144107,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.20s/s]\n"}
,{"stream_name":"stdout","time":184.617823793,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":184.630884136,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.1 steps/s\n"}
,{"stream_name":"stdout","time":184.631045174,"data":"\n"}
,{"stream_name":"stdout","time":184.631053008,"data":"✅ Training completed in 0.8 minutes (48.4s)\n"}
,{"stream_name":"stdout","time":184.634397888,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:48 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":184.634414873,"data":"\n"}
,{"stream_name":"stdout","time":184.634418917,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.634422938,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":184.634426737,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.634430546,"data":"\n"}
,{"stream_name":"stdout","time":184.638606155,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":184.638735995,"data":"2025-10-15 22:36:25 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":184.638941908,"data":"2025-10-15 22:36:25 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":184.639133306,"data":"2025-10-15 22:36:25 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":184.639371972,"data":"2025-10-15 22:36:25 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_25b78b90_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":184.639398129,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_25b78b90_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":184.639654301,"data":"\n"}
,{"stream_name":"stdout","time":184.639663259,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":184.639667184,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":184.639671025,"data":"\n"}
,{"stream_name":"stdout","time":184.639674768,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":184.639705631,"data":"2025-10-15 22:36:25 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.639789906,"data":"2025-10-15 22:36:25 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":184.639861262,"data":"2025-10-15 22:36:25 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":184.639939478,"data":"2025-10-15 22:36:25 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.64413478,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.644204912,"data":"2025-10-15 22:36:25 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.644269269,"data":"2025-10-15 22:36:25 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":184.644392447,"data":"2025-10-15 22:36:25 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":184.644475979,"data":"2025-10-15 22:36:25 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":184.644484343,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":184.644489115,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":184.644629777,"data":"2025-10-15 22:36:25 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":184.644785937,"data":"2025-10-15 22:36:25 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":184.645201208,"data":"2025-10-15 22:36:26 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":184.6452654,"data":"2025-10-15 22:36:26 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":184.645342163,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":184.645348905,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":184.645353466,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":184.64535788,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":184.645474493,"data":"2025-10-15 22:36:26 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":184.645480033,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":184.645483872,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":184.645494342,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":184.645504492,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":184.645632713,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.645706697,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":184.645801752,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.645887557,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":184.645976952,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":184.646073824,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":184.646177004,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":184.64626658,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":184.646354526,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.64639064,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":184.646435826,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":184.646794519,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.64680555,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":184.653718017,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.653736473,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.653742078,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.653746085,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.653749979,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":184.653874858,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":184.653882208,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":184.653886623,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":184.653890554,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":184.65390933,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.653914201,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":184.65391857,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":184.654562519,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":184.654575003,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":184.654853695,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":184.654863956,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":184.654868809,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":184.654873146,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":184.6548773,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":184.654881623,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":184.654885113,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":184.654998694,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":184.655160208,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":184.655183954,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":184.65528702699999,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":184.655326283,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.655348416,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":184.662538815,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.662556666,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.662562192,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.662566565,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.662571099,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":184.662658245,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":184.662666508,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":184.662671098,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":184.662684588,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":184.662749765,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.66275666,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":184.662761001,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":184.663435725,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":184.663452888,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":184.663689922,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":184.663891051,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.663901188,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.663905676,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.665390667,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":184.66540477,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":184.665419087,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":184.665946171,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":184.66615075,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":184.666518357,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":184.666528586,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":184.666533136,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":184.666546887,"data":"\n"}
,{"stream_name":"stdout","time":184.666550921,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":184.666565745,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":184.666569874,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":184.666573645,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":184.666577599,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":184.666581767,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":184.666585772,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":184.66659041,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":184.666594419,"data":"\n"}
,{"stream_name":"stdout","time":184.666661945,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":184.666673116,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":184.666677688,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":184.66668264,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":184.666686903,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":184.666691246,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":184.66669507,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":184.666710035,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":184.666714504,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":184.666718871,"data":"\n"}
,{"stream_name":"stdout","time":184.666802103,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":184.66699242,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":184.667095806,"data":"2025-10-15 22:36:26 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":184.667288414,"data":"2025-10-15 22:36:26 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":184.667926182,"data":"2025-10-15 22:36:26 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":184.667937244,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":184.668128155,"data":"2025-10-15 22:36:26 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":184.668238446,"data":"2025-10-15 22:36:26 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=3713278633818892104, last=1235597604831635230\n"}
,{"stream_name":"stdout","time":184.668767842,"data":"2025-10-15 22:36:26 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":184.6740197,"data":"2025-10-15 22:36:26 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":184.6743059,"data":"2025-10-15 22:36:26 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":184.674330353,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":184.674408329,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":184.6744205,"data":"\n"}
,{"stream_name":"stdout","time":184.6744256,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.674431016,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":184.67443593,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":184.67444027,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":184.674444191,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":184.674448162,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.674453804,"data":"\n"}
,{"stream_name":"stdout","time":184.674462655,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":184.681887294,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.681903913,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.681908605,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.681912639,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.682777897,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":184.688386173,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":184.688404154,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":184.692364579,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":184.692380914,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":184.692443888,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.692589474,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":184.692674239,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.692746324,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":184.692846009,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":184.692914863,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":184.692990863,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":184.693088321,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":184.693191957,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.693218132,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":184.693304124,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":184.693634103,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.693640983,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":184.700383406,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.700397507,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.700401805,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.700405527,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.7004093,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":184.700496678,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":184.700503362,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":184.700507841,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":184.700511934,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":184.70057796,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.700585864,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":184.700590529,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":184.701190407,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":184.701201334,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":184.701529654,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":184.701536107,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":184.701540477,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":184.701544741,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":184.701548717,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":184.70155283,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":184.701556653,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":184.701688987,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":184.701783646,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":184.7018052,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":184.701905256,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":184.70194136,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.701947859,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":184.709209999,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.709236493,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.709243095,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.709245992,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.709248561,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":184.709329468,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":184.709337023,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":184.709341144,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":184.709345175,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":184.709358417,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.709363173,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":184.709366717,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":184.709931358,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":184.709938338,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":184.710220042,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":184.710436643,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.71044325,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.710447295,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.712029758,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":184.712299925,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":184.712333223,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":184.712349732,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":184.798553789,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.798657362,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.798798471,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":184.798901104,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.798990591,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.799106271,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":184.799124469,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.79912919,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.799151965,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.799156347,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.229042139,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":185.229282082,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 34.93s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 34.91s/s]\n"}
,{"stream_name":"stdout","time":185.229311816,"data":"\n"}
,{"stream_name":"stdout","time":185.229341224,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":185.229345895,"data":"Total runtime: 0.43 seconds.\n"}
,{"stream_name":"stdout","time":185.23077878,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":185.230793384,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":185.230986411,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":185.230994108,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":185.23120407,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":185.231400088,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":185.231585509,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":185.231774974,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":185.231781996,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":185.231833868,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.231896036,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.231959999,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.231965347,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.232034758,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":185.232085916,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":185.232213774,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":185.232354658,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.232748373,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.232799252,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.23293771,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.397608e+00, max=8.547104e+00, std=3.615433e+00\n"}
,{"stream_name":"stdout","time":185.233119924,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033390, rho_c=0.012308\n"}
,{"stream_name":"stdout","time":185.23325022,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.954114, w_c=12.251116\n"}
,{"stream_name":"stdout","time":185.233383394,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:887 -   State hash: -866345908066439449\n"}
,{"stream_name":"stdout","time":185.233442409,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.23371717,"data":"    [RL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=3.397608e+00\n"}
,{"stream_name":"stdout","time":185.234702436,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.234726772,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.234863245,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":185.234910556,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.235023658,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.23512399,"data":"2025-10-15 22:36:26 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":185.235182262,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.23518853,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.23519262,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.235206446,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.23682689,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":185.236841494,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.236846046,"data":"  Original dt: 4.852056e-01 s\n"}
,{"stream_name":"stdout","time":185.236849794,"data":"  Corrected dt: 3.032535e-01 s\n"}
,{"stream_name":"stdout","time":185.23685349,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.236857312,"data":"  Max wave speed detected: 16.49 m/s\n"}
,{"stream_name":"stdout","time":185.30636271,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":185.691452956,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":185.691626999,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.91s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.89s/s]\n"}
,{"stream_name":"stdout","time":185.691628138,"data":"\n"}
,{"stream_name":"stdout","time":185.691643238,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":185.69166496,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":185.69319515,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":185.693207147,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":185.693446592,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14732532 1.         0.01512134 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":185.693455137,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":185.693657877,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":185.693845158,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":185.693977168,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0441976  0.03246922 0.02964819 0.02877944 0.02850045 0.02842542]\n"}
,{"stream_name":"stdout","time":185.694189088,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022682  0.00147918 0.00125801 0.0011752  0.00114374 0.00113409]\n"}
,{"stream_name":"stdout","time":185.694204616,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":185.694244597,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.694321958,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":185.694396178,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.694406291,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":185.694438001,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":185.694457418,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.694626185,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.694734271,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.695104571,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.695185752,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.695321064,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.121422e-01, max=1.677267e+00, std=5.314570e-01\n"}
,{"stream_name":"stdout","time":185.695489847,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.034444, rho_c=0.010223\n"}
,{"stream_name":"stdout","time":185.695552914,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.387120, w_c=13.458675\n"}
,{"stream_name":"stdout","time":185.695640675,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:887 -   State hash: 2769351578703520990\n"}
,{"stream_name":"stdout","time":185.695747076,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.695914038,"data":"    [RL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=4.121422e-01\n"}
,{"stream_name":"stdout","time":185.696933482,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.696987937,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.697148921,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":185.697204567,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.697339889,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.697461757,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":185.697485784,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.697523664,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.697542581,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.697547163,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.761166766,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":186.136824197,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":186.136851876,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.13685765,"data":"  Original dt: 4.620085e-01 s\n"}
,{"stream_name":"stdout","time":186.136862385,"data":"  Corrected dt: 2.887553e-01 s\n"}
,{"stream_name":"stdout","time":186.136866366,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.136869988,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":186.162587493,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":186.162863686,"data":"\n"}
,{"stream_name":"stdout","time":186.162873058,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":186.162878166,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":186.16287365,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.28s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.26s/s]\n"}
,{"stream_name":"stdout","time":186.164435154,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":186.164449081,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":186.164668426,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741239 1.         0.01513268 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":186.16467629,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":186.164846859,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":186.165010147,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":186.165192618,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422372 0.03248503 0.02964484 0.02874772 0.02843718 0.02832831]\n"}
,{"stream_name":"stdout","time":186.165376606,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022699  0.00147934 0.00125354 0.00116332 0.00112318 0.00110507]\n"}
,{"stream_name":"stdout","time":186.165383338,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":186.16544787,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":186.165525449,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":186.165561292,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":186.165569302,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":186.165634507,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":186.165643326,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.165829028,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.165892823,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.166268972,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.166362536,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.166476919,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.251041e-01, max=6.802830e-01, std=1.885268e-01\n"}
,{"stream_name":"stdout","time":186.166653408,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035459, rho_c=0.008026\n"}
,{"stream_name":"stdout","time":186.16672403,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.487844, w_c=13.776733\n"}
,{"stream_name":"stdout","time":186.166812302,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:887 -   State hash: 4043805499952834607\n"}
,{"stream_name":"stdout","time":186.166907368,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.167082036,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=1.251041e-01\n"}
,{"stream_name":"stdout","time":186.167998349,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.168133836,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.168214435,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":186.168306049,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.168383122,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.16847552,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":186.16853998,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.168550528,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.168554997,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.168558852,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.213907068,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":186.63797987,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":186.638222727,"data":"\n"}
,{"stream_name":"stderr","time":186.638227638,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.98s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.96s/s]\n"}
,{"stream_name":"stdout","time":186.638238389,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":186.638247487,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":186.64003033,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":186.640042692,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":186.640274479,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474163  1.         0.01513357 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":186.640284212,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":186.64047793,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":186.640655806,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":186.640832161,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422489 0.03248531 0.02964581 0.02874856 0.02843571 0.02832439]\n"}
,{"stream_name":"stdout","time":186.641009329,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147945 0.00125344 0.00116259 0.00112129 0.00110166]\n"}
,{"stream_name":"stdout","time":186.641015275,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":186.6410856,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":186.641156298,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":186.641207525,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":186.64121579,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":186.641266894,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":186.641324793,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.64147926,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.641595244,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.641949764,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.641986717,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.642142265,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.833548e-02, max=5.610049e-01, std=1.405242e-01\n"}
,{"stream_name":"stdout","time":186.642313369,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036376, rho_c=0.005816\n"}
,{"stream_name":"stdout","time":186.642377809,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.578423, w_c=13.905640\n"}
,{"stream_name":"stdout","time":186.642517801,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:887 -   State hash: -8482869861848477554\n"}
,{"stream_name":"stdout","time":186.64259198,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.642804251,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=8.833548e-02\n"}
,{"stream_name":"stdout","time":186.643813469,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.643881226,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.644016428,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":186.644118387,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.644224411,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.644350757,"data":"2025-10-15 22:36:27 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":186.644358057,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.644363437,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.64437792,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.644382676,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.671418893,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":187.041789681,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":187.041820216,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.041825867,"data":"  Original dt: 4.617597e-01 s\n"}
,{"stream_name":"stdout","time":187.041830347,"data":"  Corrected dt: 2.885998e-01 s\n"}
,{"stream_name":"stdout","time":187.041834501,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.041838791,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":187.103301563,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":187.103425903,"data":"\n"}
,{"stream_name":"stdout","time":187.103434925,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":187.103439575,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":187.103439944,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.71s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.70s/s]\n"}
,{"stream_name":"stdout","time":187.104873911,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":187.104887521,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":187.105111568,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1474164  1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":187.105122257,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":187.105313892,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":187.105473717,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":187.105641969,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248525 0.02964588 0.02874873 0.02843574 0.02832427]\n"}
,{"stream_name":"stdout","time":187.105805672,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.00110133]\n"}
,{"stream_name":"stdout","time":187.105812346,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":187.105872519,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":187.105963469,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":187.105992462,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":187.105999711,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":187.106051209,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":187.106073479,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.106268442,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.106373871,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.106734757,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.106793538,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.106933623,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.478507e-02, max=5.273854e-01, std=1.305134e-01\n"}
,{"stream_name":"stdout","time":187.107056867,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036222, rho_c=0.003917\n"}
,{"stream_name":"stdout","time":187.107189677,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.705534, w_c=14.018867\n"}
,{"stream_name":"stdout","time":187.107270907,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:887 -   State hash: 8025594664730576546\n"}
,{"stream_name":"stdout","time":187.107388657,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.107568732,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=7.478507e-02\n"}
,{"stream_name":"stdout","time":187.108528297,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.108559109,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.10870067,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":187.108749285,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.108867281,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.108931575,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":187.108987075,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.108993641,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.108998368,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.109002903,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.117980871,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":187.559074104,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":187.568718525,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stdout","time":187.568968424,"data":"\n"}
,{"stream_name":"stdout","time":187.568982381,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":187.568987872,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":187.56898868,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.65s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.64s/s]\n"}
,{"stream_name":"stdout","time":187.570673727,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":187.570700268,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":187.570823258,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":187.570831463,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":187.570835512,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":187.570915667,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":187.570931954,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.571101378,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.571188865,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.57156924,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.571588457,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.571768941,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.167747e-02, max=5.048404e-01, std=1.259331e-01\n"}
,{"stream_name":"stdout","time":187.57192821,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035351, rho_c=0.003229\n"}
,{"stream_name":"stdout","time":187.572001245,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.832169, w_c=14.137383\n"}
,{"stream_name":"stdout","time":187.572155423,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:887 -   State hash: -8428013438904415977\n"}
,{"stream_name":"stdout","time":187.572221874,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.572453305,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=6.167747e-02\n"}
,{"stream_name":"stdout","time":187.573494442,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.573573228,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.573794621,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":187.573823678,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.573970382,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.574029609,"data":"2025-10-15 22:36:28 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":187.574123241,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.574136459,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.574140958,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.574144876,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.939555892,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":187.939581329,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.939586388,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":187.939590258,"data":"  Corrected dt: 2.885960e-01 s\n"}
,{"stream_name":"stdout","time":187.939605152,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.93960905,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":188.008393437,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":188.034876823,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":188.034988237,"data":"\n"}
,{"stream_name":"stdout","time":188.03499738,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":188.035001659,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":188.035007885,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.58s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.58s/s]\n"}
,{"stream_name":"stdout","time":188.036642758,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":188.036692569,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.036750734,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.036832033,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.036840921,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.036880248,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":188.036926595,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.037123017,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.037353647,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.037727656,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.03777333,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.037890307,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.521459e-02, max=3.120188e-01, std=6.417648e-02\n"}
,{"stream_name":"stdout","time":188.03807316,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035068, rho_c=0.003175\n"}
,{"stream_name":"stdout","time":188.038172115,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.874419, w_c=14.195654\n"}
,{"stream_name":"stdout","time":188.038276992,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:887 -   State hash: -74086708852020966\n"}
,{"stream_name":"stdout","time":188.038349535,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.038548483,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.521459e-02\n"}
,{"stream_name":"stdout","time":188.039595914,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.039694126,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.039829046,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":188.039883588,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.040007725,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.04011033,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":188.040171366,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.040182041,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.040186768,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.040190721,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.450789969,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":188.496594767,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":188.496831056,"data":"\n"}
,{"stream_name":"stdout","time":188.496847709,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":188.49685319,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":188.496829656,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.89s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.88s/s]\n"}
,{"stream_name":"stdout","time":188.498579932,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":188.498600965,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.49860628,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.498611378,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.498625473,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.498630191,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":188.498639297,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.498764014,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.498846689,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.499216976,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.499301241,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.49945791,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.296586e-03, max=1.122077e-01, std=1.794181e-02\n"}
,{"stream_name":"stdout","time":188.499648213,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035023, rho_c=0.003167\n"}
,{"stream_name":"stdout","time":188.499713716,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.882162, w_c=14.213044\n"}
,{"stream_name":"stdout","time":188.499859432,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:887 -   State hash: 4248656624515956726\n"}
,{"stream_name":"stdout","time":188.499901726,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.500103284,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=6.296586e-03\n"}
,{"stream_name":"stdout","time":188.501035107,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.501168697,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.501267644,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":188.501392214,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.501474311,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.501567522,"data":"2025-10-15 22:36:29 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":188.50162514,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.501632669,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.501638092,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.501655417,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.830530795,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":188.830567152,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.830572617,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":188.830576338,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":188.830580002,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.830583892,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":188.900353561,"data":"[PROGRESS] Step 450: t=132.99/135.00s (98.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":188.962315632,"data":"  Stored output at t = 135.0000 s (Step 457)\n"}
,{"stream_name":"stderr","time":188.962507426,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 32.59s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 32.58s/s]\n"}
,{"stream_name":"stdout","time":188.962511719,"data":"\n"}
,{"stream_name":"stdout","time":188.962556082,"data":"Simulation finished at t = 135.0000 s after 457 steps.\n"}
,{"stream_name":"stdout","time":188.962563411,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":188.964235092,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":188.964254455,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.964259266,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":188.964263093,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.964266754,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":188.96432211,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":188.964337134,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.964506299,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.964567077,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.964963202,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.964983081,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.96514975,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.408427e-03, max=3.036733e-02, std=4.401753e-03\n"}
,{"stream_name":"stdout","time":188.965343765,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035016, rho_c=0.003165\n"}
,{"stream_name":"stdout","time":188.965425346,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883439, w_c=14.217392\n"}
,{"stream_name":"stdout","time":188.96553106,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:887 -   State hash: 282820096765794655\n"}
,{"stream_name":"stdout","time":188.965603982,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.965763344,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.408427e-03\n"}
,{"stream_name":"stdout","time":188.966743694,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.966857809,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.966938499,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":188.967039547,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.967114991,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.967249902,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":188.96725858,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.967279389,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.967304646,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.967309516,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.346875109,"data":"[PROGRESS] Step 500: t=147.41/150.00s (98.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":189.426716628,"data":"  Stored output at t = 150.0000 s (Step 509)\n"}
,{"stream_name":"stderr","time":189.426865215,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 32.68s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 32.67s/s]\n"}
,{"stream_name":"stdout","time":189.426878246,"data":"\n"}
,{"stream_name":"stdout","time":189.42688988,"data":"Simulation finished at t = 150.0000 s after 509 steps.\n"}
,{"stream_name":"stdout","time":189.426894355,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":189.428391829,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":189.428451064,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.428559259,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.428571846,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.428601303,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.428661936,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":189.428682882,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.428760049,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":189.428885423,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.42898581,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.429382004,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.429488589,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.429590151,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.039691e-04, max=7.310802e-03, std=1.016559e-03\n"}
,{"stream_name":"stdout","time":189.429747808,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":189.429825504,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883651, w_c=14.218394\n"}
,{"stream_name":"stdout","time":189.42991447,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:887 -   State hash: -7607152797570695712\n"}
,{"stream_name":"stdout","time":189.429998187,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.430202882,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=3.039691e-04\n"}
,{"stream_name":"stdout","time":189.43112608,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.431211086,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.431354941,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":189.431447933,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.431527461,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.431604244,"data":"2025-10-15 22:36:30 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":189.431688638,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.431695761,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.431700044,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.431704607,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.726815506,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":189.726844988,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.726850674,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":189.726854924,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":189.726858573,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.72686212,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":189.79719871,"data":"[PROGRESS] Step 550: t=161.83/165.00s (98.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":189.893936292,"data":"  Stored output at t = 165.0000 s (Step 561)\n"}
,{"stream_name":"stdout","time":189.894223452,"data":"\n"}
,{"stream_name":"stdout","time":189.894238954,"data":"Simulation finished at t = 165.0000 s after 561 steps.\n"}
,{"stream_name":"stdout","time":189.894244276,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":189.894223292,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 32.47s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 32.46s/s]\n"}
,{"stream_name":"stdout","time":189.895709089,"data":"[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====\n"}
,{"stream_name":"stdout","time":189.895724282,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":189.895941588,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":189.895948392,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":189.89613211,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":189.896335926,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":189.896526711,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":189.896696663,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":189.896703426,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":189.896775261,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.896849938,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.896879123,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.896895561,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.8969496,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":189.896976617,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.897169069,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.897291329,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.897635261,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.897741169,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.897827464,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.460893e-05, max=1.659553e-03, std=2.261282e-04\n"}
,{"stream_name":"stdout","time":189.898003999,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":189.898103515,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883687, w_c=14.218616\n"}
,{"stream_name":"stdout","time":189.898203766,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:887 -   State hash: 7039105167710365524\n"}
,{"stream_name":"stdout","time":189.898299326,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.898479801,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=6.460893e-05\n"}
,{"stream_name":"stdout","time":189.899483023,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.899569697,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.899677451,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":189.899782544,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.899849394,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.899944248,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":189.900008173,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.900015343,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.900019833,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.900023768,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.248531981,"data":"[PROGRESS] Step 600: t=176.26/180.00s (97.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":190.388932889,"data":"  Stored output at t = 180.0000 s (Step 613)\n"}
,{"stream_name":"stdout","time":190.389247728,"data":"\n"}
,{"stream_name":"stdout","time":190.389264202,"data":"Simulation finished at t = 180.0000 s after 613 steps.\n"}
,{"stream_name":"stdout","time":190.389269519,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":190.38926347,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.70s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.69s/s]\n"}
,{"stream_name":"stdout","time":190.391227179,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.391301647,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.391518975,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.391936079,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.391948601,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.392111063,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.363054e-05, max=3.647833e-04, std=4.914669e-05\n"}
,{"stream_name":"stdout","time":190.392326111,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":190.392476389,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883694, w_c=14.218664\n"}
,{"stream_name":"stdout","time":190.392581738,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:887 -   State hash: -4373157166856532053\n"}
,{"stream_name":"stdout","time":190.392723627,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.392936508,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.363054e-05\n"}
,{"stream_name":"stdout","time":190.39400247,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.394091624,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.39424341,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":190.394397092,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.394495106,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.394634974,"data":"2025-10-15 22:36:31 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":190.394696849,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.394722135,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.394728217,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.394733003,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.658666956,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":190.658689065,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.658694721,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":190.658698582,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":190.658702768,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.658706799,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":190.728858627,"data":"[PROGRESS] Step 650: t=190.68/195.00s (97.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":190.889353634,"data":"  Stored output at t = 195.0000 s (Step 665)\n"}
,{"stream_name":"stderr","time":190.889569475,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.35s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.34s/s]\n"}
,{"stream_name":"stdout","time":190.889603411,"data":"\n"}
,{"stream_name":"stdout","time":190.889617347,"data":"Simulation finished at t = 195.0000 s after 665 steps.\n"}
,{"stream_name":"stdout","time":190.889621756,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":190.891224546,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.891243529,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.891386224,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.89174978,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.891844231,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.891933803,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.862432e-06, max=7.870081e-05, std=1.052756e-05\n"}
,{"stream_name":"stdout","time":190.892130982,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":190.892251015,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883695, w_c=14.218674\n"}
,{"stream_name":"stdout","time":190.892358495,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:887 -   State hash: 1049130417471958538\n"}
,{"stream_name":"stdout","time":190.892449046,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.892666705,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=2.862432e-06\n"}
,{"stream_name":"stdout","time":190.893729334,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.893817508,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.893955656,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":190.894028707,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.894138205,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.894254601,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":190.89426377,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.894267986,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.894300899,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.894310815,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.210535306,"data":"[PROGRESS] Step 700: t=205.10/210.00s (97.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":191.361932933,"data":"  Stored output at t = 210.0000 s (Step 717)\n"}
,{"stream_name":"stdout","time":191.362127474,"data":"\n"}
,{"stream_name":"stderr","time":191.362142252,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.10s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.09s/s]\n"}
,{"stream_name":"stdout","time":191.362150547,"data":"Simulation finished at t = 210.0000 s after 717 steps.\n"}
,{"stream_name":"stdout","time":191.362162138,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":191.363859189,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.363953564,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.36410831,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.364478599,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.364582747,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.364704918,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.988992e-07, max=1.678477e-05, std=2.233747e-06\n"}
,{"stream_name":"stdout","time":191.364878646,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":191.364948817,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218676\n"}
,{"stream_name":"stdout","time":191.365075359,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:887 -   State hash: -2443049250711092852\n"}
,{"stream_name":"stdout","time":191.365158567,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.365337666,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=5.988992e-07\n"}
,{"stream_name":"stdout","time":191.366296184,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.36640711,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.366492021,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":191.366577165,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.366688109,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.366761505,"data":"2025-10-15 22:36:32 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":191.366817802,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.366826227,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.366831466,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.366850194,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.592473683,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":191.592503077,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.592508574,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":191.592512646,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":191.592517434,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.592521082,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":191.662707195,"data":"[PROGRESS] Step 750: t=219.52/225.00s (97.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":191.832729635,"data":"  Stored output at t = 225.0000 s (Step 769)\n"}
,{"stream_name":"stdout","time":191.83296041,"data":"\n"}
,{"stream_name":"stdout","time":191.832974374,"data":"Simulation finished at t = 225.0000 s after 769 steps.\n"}
,{"stream_name":"stdout","time":191.832996657,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":191.832976515,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 32.22s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":191.834618441,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.834709801,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.83482486,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.835205303,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.835294069,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.835422923,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.248735e-07, max=3.551999e-06, std=4.707803e-07\n"}
,{"stream_name":"stdout","time":191.835570663,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":191.835657755,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":191.835753758,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:887 -   State hash: 473297051445142836\n"}
,{"stream_name":"stdout","time":191.835829941,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.836019244,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.248735e-07\n"}
,{"stream_name":"stdout","time":191.83701611,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.837051945,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.837235421,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":191.837280002,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.837417425,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.837501047,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":191.837548189,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.837556796,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.837581808,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.837588743,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.114509803,"data":"[PROGRESS] Step 800: t=233.95/240.00s (97.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":192.302993775,"data":"  Stored output at t = 240.0000 s (Step 821)\n"}
,{"stream_name":"stdout","time":192.303283397,"data":"\n"}
,{"stream_name":"stdout","time":192.303307753,"data":"Simulation finished at t = 240.0000 s after 821 steps.\n"}
,{"stream_name":"stdout","time":192.303313878,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":192.303279784,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 32.25s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 32.24s/s]\n"}
,{"stream_name":"stdout","time":192.304963492,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.305014474,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.305208699,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.305544617,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.305563394,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.305706247,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.594896e-08, max=7.473341e-07, std=9.870491e-08\n"}
,{"stream_name":"stdout","time":192.305868175,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":192.305934523,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":192.30603223,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:887 -   State hash: 2854949830001503894\n"}
,{"stream_name":"stdout","time":192.306132878,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.306332844,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=2.594896e-08\n"}
,{"stream_name":"stdout","time":192.307403039,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.307529337,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.307640484,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":192.307729502,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.307803794,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.307914131,"data":"2025-10-15 22:36:33 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":192.307931887,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.307952741,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.307965803,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.307969824,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.495144831,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":192.495168691,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.49517345,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":192.495177204,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":192.495180916,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.495185074,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":192.565638788,"data":"[PROGRESS] Step 850: t=248.37/255.00s (97.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":192.768706319,"data":"  Stored output at t = 255.0000 s (Step 873)\n"}
,{"stream_name":"stderr","time":192.768938068,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.58s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 32.57s/s]\n"}
,{"stream_name":"stdout","time":192.768947076,"data":"\n"}
,{"stream_name":"stdout","time":192.76897551,"data":"Simulation finished at t = 255.0000 s after 873 steps.\n"}
,{"stream_name":"stdout","time":192.768980712,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":192.770710574,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.770737132,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.770896974,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.771251107,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.771299137,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.771415971,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.374553e-09, max=1.564994e-07, std=2.060470e-08\n"}
,{"stream_name":"stdout","time":192.771585581,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":192.771668958,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":192.771778519,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:887 -   State hash: 418161420103850072\n"}
,{"stream_name":"stdout","time":192.771837022,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.772037727,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=5.374553e-09\n"}
,{"stream_name":"stdout","time":192.772968095,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.773027139,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.773233374,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":192.773274968,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.773408305,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.773468637,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":192.773557363,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.773567994,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.773573206,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.773577708,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.014229667,"data":"[PROGRESS] Step 900: t=262.79/270.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.235931453,"data":"  Stored output at t = 270.0000 s (Step 925)\n"}
,{"stream_name":"stderr","time":193.236257762,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.46s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 32.45s/s]\n"}
,{"stream_name":"stdout","time":193.236264671,"data":"\n"}
,{"stream_name":"stdout","time":193.236295022,"data":"Simulation finished at t = 270.0000 s after 925 steps.\n"}
,{"stream_name":"stdout","time":193.236313203,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":193.237899747,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.238020741,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.238149313,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.238498723,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.238573749,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.238696184,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.109661e-09, max=3.263938e-08, std=4.284751e-09\n"}
,{"stream_name":"stdout","time":193.238847768,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":193.23905598,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":193.239097134,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:887 -   State hash: 6176860291080979033\n"}
,{"stream_name":"stdout","time":193.239206157,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.239414267,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.109661e-09\n"}
,{"stream_name":"stdout","time":193.240435465,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.24051847,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.240668935,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":193.240805301,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.240848406,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.240939748,"data":"2025-10-15 22:36:34 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":193.241000175,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.241006292,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.241010765,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.241015488,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.392562532,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":193.392591816,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.392597922,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":193.392601855,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":193.392605496,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.392610836,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":193.461301212,"data":"[PROGRESS] Step 950: t=277.21/285.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.6951073,"data":"  Stored output at t = 285.0000 s (Step 977)\n"}
,{"stream_name":"stderr","time":193.695305358,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 33.06s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 33.05s/s]\n"}
,{"stream_name":"stdout","time":193.695343306,"data":"\n"}
,{"stream_name":"stdout","time":193.695353376,"data":"Simulation finished at t = 285.0000 s after 977 steps.\n"}
,{"stream_name":"stdout","time":193.695358893,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":193.696851363,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.696961667,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.697094256,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.697406437,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.69747243,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.697599869,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.284143e-10, max=6.782328e-09, std=8.879027e-10\n"}
,{"stream_name":"stdout","time":193.697756075,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":193.697846042,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":193.697935182,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:887 -   State hash: -7375497465986450253\n"}
,{"stream_name":"stdout","time":193.698026061,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.698218887,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=2.284143e-10\n"}
,{"stream_name":"stdout","time":193.699129174,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.699222945,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.699330124,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":193.699430094,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.699506478,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.699608838,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":193.699649418,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.699656849,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.699662944,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.699667474,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.902259465,"data":"[PROGRESS] Step 1000: t=291.64/300.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.159143658,"data":"  Stored output at t = 300.0000 s (Step 1029)\n"}
,{"stream_name":"stdout","time":194.159397951,"data":"\n"}
,{"stream_name":"stderr","time":194.159394602,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.67s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.66s/s]\n"}
,{"stream_name":"stdout","time":194.15940657,"data":"Simulation finished at t = 300.0000 s after 1029 steps.\n"}
,{"stream_name":"stdout","time":194.159426585,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":194.160882828,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.160896242,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":194.161014468,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.161132036,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.161475387,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.161546807,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.161666875,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.688165e-11, max=1.404574e-09, std=1.833974e-10\n"}
,{"stream_name":"stdout","time":194.161855094,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":194.161937055,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":194.162044039,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:887 -   State hash: -8047855112775539323\n"}
,{"stream_name":"stdout","time":194.162156937,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.162344461,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=4.688165e-11\n"}
,{"stream_name":"stdout","time":194.163332829,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.163473933,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.163595123,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":194.16370717,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.16382706,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.163899837,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":194.163978328,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.163990114,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.163995711,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.164000138,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.28070711,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":194.280724652,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.280741005,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":194.280745133,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":194.28074875,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.28075249,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":194.350135426,"data":"[PROGRESS] Step 1050: t=306.06/315.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.624146518,"data":"  Stored output at t = 315.0000 s (Step 1081)\n"}
,{"stream_name":"stdout","time":194.624365189,"data":"\n"}
,{"stream_name":"stdout","time":194.624374986,"data":"Simulation finished at t = 315.0000 s after 1081 steps.\n"}
,{"stream_name":"stdout","time":194.624379647,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":194.624385947,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.63s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.62s/s]\n"}
,{"stream_name":"stdout","time":194.625964932,"data":"[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====\n"}
,{"stream_name":"stdout","time":194.625981863,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":194.626163173,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":194.626178244,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":194.626375283,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":194.626536272,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":194.626854493,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":194.62702727,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":194.627038638,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":194.627093751,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.627185575,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":194.627194759,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.627240804,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":194.627282095,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":194.627315238,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.627473166,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.627602697,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.627925774,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.628020825,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.628122903,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.595821e-12, max=2.899601e-10, std=3.776549e-11\n"}
,{"stream_name":"stdout","time":194.628317072,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":194.628418351,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":194.628524654,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:887 -   State hash: -7222620276549966693\n"}
,{"stream_name":"stdout","time":194.628591804,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.628775954,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=9.595821e-12\n"}
,{"stream_name":"stdout","time":194.629761832,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.62985417,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.629985522,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":194.630110571,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.630220518,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.630300717,"data":"2025-10-15 22:36:35 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":194.630379575,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.630388246,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.630393611,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.630398245,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.806107303,"data":"[PROGRESS] Step 1100: t=320.48/330.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.101442193,"data":"  Stored output at t = 330.0000 s (Step 1133)\n"}
,{"stream_name":"stdout","time":195.101720971,"data":"\n"}
,{"stream_name":"stderr","time":195.101725206,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.86s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.85s/s]\n"}
,{"stream_name":"stdout","time":195.101732078,"data":"Simulation finished at t = 330.0000 s after 1133 steps.\n"}
,{"stream_name":"stdout","time":195.1017403,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":195.103527639,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.103634289,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.103781884,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.104164015,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.104248827,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.104398427,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.958695e-12, max=5.968026e-11, std=7.754176e-12\n"}
,{"stream_name":"stdout","time":195.104588401,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.104619142,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":195.104757996,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:887 -   State hash: 4804927265608485795\n"}
,{"stream_name":"stdout","time":195.10481938,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.105029658,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=1.958695e-12\n"}
,{"stream_name":"stdout","time":195.106002903,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.106027798,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.106228365,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":195.10624965,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.106396877,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.106476211,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":195.106537512,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.106549151,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.106554831,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.106561017,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.187403745,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":195.187422608,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.187429319,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":195.187432037,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":195.187434656,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.187437373,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":195.256971641,"data":"[PROGRESS] Step 1150: t=334.91/345.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.570875702,"data":"  Stored output at t = 345.0000 s (Step 1185)\n"}
,{"stream_name":"stdout","time":195.571015464,"data":"\n"}
,{"stream_name":"stdout","time":195.571026134,"data":"Simulation finished at t = 345.0000 s after 1185 steps.\n"}
,{"stream_name":"stdout","time":195.571031287,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":195.571042878,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 32.33s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 32.32s/s]\n"}
,{"stream_name":"stdout","time":195.572567761,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.572649834,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.572785728,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.573193095,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.573281324,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.573445871,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.990405e-13, max=1.225509e-11, std=1.588785e-12\n"}
,{"stream_name":"stdout","time":195.573651857,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.573740723,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":195.573874499,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:887 -   State hash: -5519864305074778402\n"}
,{"stream_name":"stdout","time":195.573952822,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.574188223,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=3.990405e-13\n"}
,{"stream_name":"stdout","time":195.575239719,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.575294323,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.575435833,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":195.575520651,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.575623472,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.575695395,"data":"2025-10-15 22:36:36 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":195.575761663,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.57578414,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.575789238,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.575794713,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.711568923,"data":"[PROGRESS] Step 1200: t=349.33/360.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.042515156,"data":"  Stored output at t = 360.0000 s (Step 1237)\n"}
,{"stream_name":"stdout","time":196.042692021,"data":"\n"}
,{"stream_name":"stdout","time":196.042702108,"data":"Simulation finished at t = 360.0000 s after 1237 steps.\n"}
,{"stream_name":"stdout","time":196.04270723,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":196.042702029,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 32.16s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":196.044411681,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.044484152,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.044598311,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.044922739,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.044962715,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.04510755,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.093729e-14, max=2.506440e-12, std=3.239125e-13\n"}
,{"stream_name":"stdout","time":196.045284219,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.045336511,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":196.045477399,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:887 -   State hash: -6801973907744199187\n"}
,{"stream_name":"stdout","time":196.045530948,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.045706838,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=8.093729e-14\n"}
,{"stream_name":"stdout","time":196.046872778,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.04690499,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.047098944,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":196.047248226,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.047362802,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.047486201,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":196.047563226,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.04757003,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.047575007,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.047579613,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.093891232,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":196.093909196,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.093915589,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":196.093918369,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":196.093920857,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.093923285,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":196.164274135,"data":"[PROGRESS] Step 1250: t=363.75/375.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.509576374,"data":"  Stored output at t = 375.0000 s (Step 1289)\n"}
,{"stream_name":"stdout","time":196.509813509,"data":"\n"}
,{"stream_name":"stderr","time":196.50981076,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 32.49s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 32.48s/s]\n"}
,{"stream_name":"stdout","time":196.509824695,"data":"Simulation finished at t = 375.0000 s after 1289 steps.\n"}
,{"stream_name":"stdout","time":196.509848258,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":196.511313846,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.511383509,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.511511111,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.511849299,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.511911578,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.512033018,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.630333e-14, max=5.098144e-13, std=6.574957e-14\n"}
,{"stream_name":"stdout","time":196.512217054,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.512327529,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":196.512381079,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:887 -   State hash: -8269215881956887723\n"}
,{"stream_name":"stdout","time":196.512489614,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.512648341,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=1.630333e-14\n"}
,{"stream_name":"stdout","time":196.513646095,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.513771839,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.513869334,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":196.513973738,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.514087297,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.514179605,"data":"2025-10-15 22:36:37 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":196.514230701,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.514237288,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.514250791,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.514255695,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.612448869,"data":"[PROGRESS] Step 1300: t=378.17/390.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.976183765,"data":"  Stored output at t = 390.0000 s (Step 1341)\n"}
,{"stream_name":"stdout","time":196.976459475,"data":"\n"}
,{"stream_name":"stderr","time":196.97646,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 32.50s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 32.49s/s]\n"}
,{"stream_name":"stdout","time":196.976468365,"data":"Simulation finished at t = 390.0000 s after 1341 steps.\n"}
,{"stream_name":"stdout","time":196.9764776,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":196.978077768,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.978207776,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.978325581,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.97870203,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.97882141,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.978898312,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.204002e-15, max=1.030287e-13, std=1.371947e-14\n"}
,{"stream_name":"stdout","time":196.979112099,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.979226973,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":196.979334151,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:887 -   State hash: 4287429665529757938\n"}
,{"stream_name":"stdout","time":196.97946868,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.979751171,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=3.204002e-15\n"}
,{"stream_name":"stdout","time":196.980735613,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.980839133,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.980969865,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":196.9810191,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.98114759,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.981250668,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":196.981305285,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.981311975,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.981317672,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.98132957,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.991410283,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":196.991424579,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.991429241,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":196.991432866,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":196.991438517,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.991441219,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":197.062809098,"data":"[PROGRESS] Step 1350: t=392.60/405.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.444769398,"data":"  Stored output at t = 405.0000 s (Step 1393)\n"}
,{"stream_name":"stdout","time":197.44503625,"data":"\n"}
,{"stream_name":"stdout","time":197.445046865,"data":"Simulation finished at t = 405.0000 s after 1393 steps.\n"}
,{"stream_name":"stderr","time":197.445040687,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 32.39s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 32.38s/s]\n"}
,{"stream_name":"stdout","time":197.445050516,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":197.446624546,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.44669911,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.446859206,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.447233624,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.447321535,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.447432522,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.179905e-16, max=2.309264e-14, std=3.049549e-15\n"}
,{"stream_name":"stdout","time":197.44762663,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.4476826,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":197.447793454,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:887 -   State hash: -1419651904487731467\n"}
,{"stream_name":"stdout","time":197.447867914,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.448044647,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=7.179905e-16\n"}
,{"stream_name":"stdout","time":197.448976516,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.449052845,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.449213901,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":197.449306047,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.449426035,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.44948752,"data":"2025-10-15 22:36:38 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":197.44954199,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.449548639,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.44955374,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.449584974,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.511580049,"data":"[PROGRESS] Step 1400: t=407.02/420.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.882118577,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":197.882142289,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.882163376,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":197.882168074,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":197.882172179,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.882176362,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":197.907544511,"data":"  Stored output at t = 420.0000 s (Step 1445)\n"}
,{"stream_name":"stdout","time":197.907808168,"data":"\n"}
,{"stream_name":"stdout","time":197.907824002,"data":"Simulation finished at t = 420.0000 s after 1445 steps.\n"}
,{"stream_name":"stdout","time":197.907828595,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":197.907847506,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.78s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.76s/s]\n"}
,{"stream_name":"stdout","time":197.909349569,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.909430696,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.909567264,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.909904964,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.909932241,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.91004519,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.409432e-16, max=1.065814e-14, std=8.725885e-16\n"}
,{"stream_name":"stdout","time":197.91027162,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.910390772,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":197.910500438,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:887 -   State hash: 1201179857939683093\n"}
,{"stream_name":"stdout","time":197.910587929,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.910772925,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=1.409432e-16\n"}
,{"stream_name":"stdout","time":197.911693303,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.911765373,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.911881505,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":197.911977,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.912085676,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.91216599,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":197.912232048,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.91223819,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.912242949,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.912248339,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.95632425,"data":"[PROGRESS] Step 1450: t=421.44/435.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.37356495,"data":"  Stored output at t = 435.0000 s (Step 1497)\n"}
,{"stream_name":"stdout","time":198.373824247,"data":"\n"}
,{"stream_name":"stdout","time":198.373839214,"data":"Simulation finished at t = 435.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":198.373844505,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":198.373845519,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 32.54s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 32.53s/s]\n"}
,{"stream_name":"stdout","time":198.375518536,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.375584902,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.3758623,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.376106465,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.376178632,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.376323783,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.281035e-18, max=1.776357e-15, std=8.698780e-17\n"}
,{"stream_name":"stdout","time":198.376525494,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.376649393,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":198.376737634,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":198.376857999,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.377048355,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=4.281035e-18\n"}
,{"stream_name":"stdout","time":198.378107161,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.378211109,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.378312807,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":198.378451777,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.378565376,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.378651704,"data":"2025-10-15 22:36:39 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":198.378701997,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.378708196,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.378713023,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.378718433,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.40597141,"data":"[PROGRESS] Step 1500: t=435.87/450.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.784785226,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":198.784811666,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.784817347,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":198.784821343,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":198.784825084,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.784828829,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":198.846989699,"data":"  Stored output at t = 450.0000 s (Step 1549)\n"}
,{"stream_name":"stderr","time":198.847226498,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 32.06s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 32.04s/s]\n"}
,{"stream_name":"stdout","time":198.847230518,"data":"\n"}
,{"stream_name":"stdout","time":198.847264062,"data":"Simulation finished at t = 450.0000 s after 1549 steps.\n"}
,{"stream_name":"stdout","time":198.847268979,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":198.848733459,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.848747902,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":198.84879906,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.84896302800001,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.849307152,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.849416232,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.849510244,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.849681887,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.849772443,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":198.849880498,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":198.849948808,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.850134033,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.851048588,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.851194638,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.851275976,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":198.851347431,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.851430232,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.851537253,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":198.851553228,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.851557982,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.851564388,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.851597062,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.861076934,"data":"[PROGRESS] Step 1550: t=450.29/465.00s (96.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":199.30635201,"data":"[PROGRESS] Step 1600: t=464.72/465.00s (99.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":199.315641951,"data":"  Stored output at t = 465.0000 s (Step 1601)\n"}
,{"stream_name":"stdout","time":199.315886906,"data":"\n"}
,{"stream_name":"stderr","time":199.31588416,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 32.35s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 32.33s/s]\n"}
,{"stream_name":"stdout","time":199.315895993,"data":"Simulation finished at t = 465.0000 s after 1601 steps.\n"}
,{"stream_name":"stdout","time":199.315903793,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":199.31747424899999,"data":"[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====\n"}
,{"stream_name":"stdout","time":199.317487867,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":199.317697934,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741638 1.         0.01513363 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":199.317705023,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":199.317878412,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":199.31804603,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":199.318237082,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422492 0.03248522 0.02964588 0.02874875 0.02843575 0.02832426]\n"}
,{"stream_name":"stdout","time":199.31839932,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00227004 0.00147946 0.00125345 0.00116256 0.00112115 0.0011013 ]\n"}
,{"stream_name":"stdout","time":199.318406054,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":199.318467661,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":199.318547053,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":199.318586423,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":199.318594193,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":199.318647047,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":199.318686315,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.31883513,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.318939351,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.319311559,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.31939321,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.319513411,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.319699221,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":199.319820956,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":199.319891342,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":199.319984504,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.320201417,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.321248467,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.321338626,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.321459742,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":199.32155448,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.321658866,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.321745877,"data":"2025-10-15 22:36:40 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":199.321810031,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":199.321818664,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.321823395,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":199.321827976,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.681562351,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":199.681592113,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":199.681598014,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":199.681602333,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":199.681606932,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":199.681610548,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":199.750010325,"data":"[PROGRESS] Step 1650: t=479.14/480.00s (99.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":199.777455757,"data":"  Stored output at t = 480.0000 s (Step 1653)\n"}
,{"stream_name":"stdout","time":199.777759072,"data":"\n"}
,{"stream_name":"stderr","time":199.777758801,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 32.94s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 32.93s/s]\n"}
,{"stream_name":"stdout","time":199.777769867,"data":"Simulation finished at t = 480.0000 s after 1653 steps.\n"}
,{"stream_name":"stdout","time":199.777786329,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":199.77946414,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.779564517,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.779712159,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.780079083,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.780115238,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.780268962,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.780439264,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":199.78051665,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":199.780648549,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":199.780696169,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.78091441,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.78189763,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.781986574,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.782136308,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":199.782282316,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.78236367,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.782501706,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":199.782509489,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":199.782514644,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.782528252,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":199.7825328,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.206158151,"data":"[PROGRESS] Step 1700: t=493.56/495.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":200.250927264,"data":"  Stored output at t = 495.0000 s (Step 1705)\n"}
,{"stream_name":"stderr","time":200.251151656,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 32.05s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 32.04s/s]\n"}
,{"stream_name":"stdout","time":200.251185903,"data":"\n"}
,{"stream_name":"stdout","time":200.251213298,"data":"Simulation finished at t = 495.0000 s after 1705 steps.\n"}
,{"stream_name":"stdout","time":200.251218881,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":200.252709526,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.252843206,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.252950562,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.253324741,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.253417692,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.253564476,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":200.253750374,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":200.253835098,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":200.253943035,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":200.254031945,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.254280041,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":200.25529391,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.255394454,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.255507242,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":200.25561331,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.255706044,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.255796437,"data":"2025-10-15 22:36:41 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":200.255873918,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":200.255880636,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.255886381,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":200.255894884,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.598254218,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":200.598291915,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":200.598298839,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":200.598303933,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":200.598309133,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":200.598314342,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":200.670601242,"data":"[PROGRESS] Step 1750: t=507.99/510.00s (99.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":200.733940739,"data":"  Stored output at t = 510.0000 s (Step 1757)\n"}
,{"stream_name":"stdout","time":200.734032221,"data":"\n"}
,{"stream_name":"stdout","time":200.734047866,"data":"Simulation finished at t = 510.0000 s after 1757 steps.\n"}
,{"stream_name":"stderr","time":200.734048301,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.41s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.40s/s]\n"}
,{"stream_name":"stdout","time":200.734053451,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":200.735697232,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.735785243,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.735911447,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.736383048,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.736451766,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.736724766,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":200.73692311,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":200.736975842,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":200.737109981,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:887 -   State hash: 5967042319193818206\n"}
,{"stream_name":"stdout","time":200.737192934,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.737384098,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":200.73838109,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.738519768,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.738596306,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":200.738700418,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.738787267,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.738898131,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":200.738948588,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":200.73895792,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.738962348,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":200.738965937,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.147800508,"data":"[PROGRESS] Step 1800: t=522.41/525.00s (99.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":201.227979393,"data":"  Stored output at t = 525.0000 s (Step 1809)\n"}
,{"stream_name":"stdout","time":201.228259525,"data":"\n"}
,{"stream_name":"stdout","time":201.228286076,"data":"Simulation finished at t = 525.0000 s after 1809 steps.\n"}
,{"stream_name":"stdout","time":201.22829111,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":201.228290794,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 30.70s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 30.69s/s]\n"}
,{"stream_name":"stdout","time":201.229974816,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":201.229989597,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":201.230134899,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":201.230504174,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":201.230600622,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":201.230709927,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.059243e-17, max=3.552714e-15, std=3.144142e-16\n"}
,{"stream_name":"stdout","time":201.230873854,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":201.230958861,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":201.231072091,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:887 -   State hash: -8256596889932448615\n"}
,{"stream_name":"stdout","time":201.231160164,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.231330751,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=4.059243e-17\n"}
,{"stream_name":"stdout","time":201.232255412,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":201.232370963,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.232464252,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":201.232539491,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":201.232639717,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":201.232741957,"data":"2025-10-15 22:36:42 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":201.23279123,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":201.232798227,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.232804196,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":201.232823486,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.522283066,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":201.522303779,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":201.522307846,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":201.522310536,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":201.522313388,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":201.522316363,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":201.592114645,"data":"[PROGRESS] Step 1850: t=536.83/540.00s (99.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":201.689502971,"data":"  Stored output at t = 540.0000 s (Step 1861)\n"}
,{"stream_name":"stdout","time":201.689717199,"data":"\n"}
,{"stream_name":"stdout","time":201.689729465,"data":"Simulation finished at t = 540.0000 s after 1861 steps.\n"}
,{"stream_name":"stdout","time":201.689734335,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":201.689746709,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 32.87s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 32.86s/s]\n"}
,{"stream_name":"stdout","time":201.691224961,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":201.691345331,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":201.691443973,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":201.691772841,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":201.691851923,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":201.691974172,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.299632e-17, max=3.552714e-15, std=4.247902e-16\n"}
,{"stream_name":"stdout","time":201.69213232,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":201.692251771,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":201.692337461,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:887 -   State hash: -1304674051287963961\n"}
,{"stream_name":"stdout","time":201.692427082,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.692602251,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=6.299632e-17\n"}
,{"stream_name":"stdout","time":201.693527619,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":201.693671179,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.693798361,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":201.693851233,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":201.693964464,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":201.694093719,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":201.694135286,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":201.694145931,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.69416175,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":201.694169363,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.044123718,"data":"[PROGRESS] Step 1900: t=551.26/555.00s (99.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":202.162206362,"data":"  Stored output at t = 555.0000 s (Step 1913)\n"}
,{"stream_name":"stderr","time":202.162498487,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 32.07s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 32.06s/s]\n"}
,{"stream_name":"stdout","time":202.162500421,"data":"\n"}
,{"stream_name":"stdout","time":202.162527451,"data":"Simulation finished at t = 555.0000 s after 1913 steps.\n"}
,{"stream_name":"stdout","time":202.162532302,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":202.164150652,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.164282326,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.164414449,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.164808586,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.164829584,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.164974356,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.576083e-17, max=7.105427e-15, std=5.815726e-16\n"}
,{"stream_name":"stdout","time":202.165135945,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":202.165267847,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":202.165361094,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:887 -   State hash: -5573215845121356900\n"}
,{"stream_name":"stdout","time":202.165448104,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.165615104,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=5.576083e-17\n"}
,{"stream_name":"stdout","time":202.166626981,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.166731704,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.166820425,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":202.166899544,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.166977575,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.167087915,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":202.167159392,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":202.167170441,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.167175222,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":202.167180814,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.426011717,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":202.426033406,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":202.426039654,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":202.426043908,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":202.426048023,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":202.426052125,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":202.499603935,"data":"[PROGRESS] Step 1950: t=565.68/570.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":202.63345082,"data":"  Stored output at t = 570.0000 s (Step 1965)\n"}
,{"stream_name":"stderr","time":202.633726486,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 32.20s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 32.18s/s]\n"}
,{"stream_name":"stdout","time":202.633789827,"data":"\n"}
,{"stream_name":"stdout","time":202.633799191,"data":"Simulation finished at t = 570.0000 s after 1965 steps.\n"}
,{"stream_name":"stdout","time":202.633804091,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":202.63537287,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.635467625,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.635589615,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.635901098,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.635999255,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.636120186,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.194820e-17, max=7.105427e-15, std=4.696656e-16\n"}
,{"stream_name":"stdout","time":202.636318395,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":202.636391953,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":202.636475574,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:887 -   State hash: 3041391742349320797\n"}
,{"stream_name":"stdout","time":202.636567122,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.636743453,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=4.194820e-17\n"}
,{"stream_name":"stdout","time":202.637701317,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.637788398,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.637913303,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":202.637978853,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.638075242,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.638207982,"data":"2025-10-15 22:36:43 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":202.638215539,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":202.638220763,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.638225963,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":202.63823188,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.951948859,"data":"[PROGRESS] Step 2000: t=580.10/585.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":203.105777193,"data":"  Stored output at t = 585.0000 s (Step 2017)\n"}
,{"stream_name":"stderr","time":203.106046119,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 32.10s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 32.09s/s]\n"}
,{"stream_name":"stdout","time":203.106082857,"data":"\n"}
,{"stream_name":"stdout","time":203.106096493,"data":"Simulation finished at t = 585.0000 s after 2017 steps.\n"}
,{"stream_name":"stdout","time":203.106100789,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":203.107729079,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.107883602,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.108012876,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":203.10842506,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.108476428,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.108601204,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.673216e-19, max=1.040834e-17, std=8.253824e-19\n"}
,{"stream_name":"stdout","time":203.10878295,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":203.108907973,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":203.108992682,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:887 -   State hash: 7453386933420652394\n"}
,{"stream_name":"stdout","time":203.109084677,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.109311045,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=1.673216e-19\n"}
,{"stream_name":"stdout","time":203.110298115,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":203.110444344,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.110559771,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":203.110673308,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":203.110746979,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":203.110855663,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":203.110920894,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":203.110927324,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":203.110932211,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":203.110937286,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":203.342234575,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":203.342260418,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":203.342266365,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":203.34227016,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":203.342273757,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":203.342277371,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":203.417981594,"data":"[PROGRESS] Step 2050: t=594.52/600.00s (99.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":203.591135305,"data":"  Stored output at t = 600.0000 s (Step 2069)\n"}
,{"stream_name":"stdout","time":203.591333846,"data":"\n"}
,{"stream_name":"stderr","time":203.591331978,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 31.27s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 31.25s/s]\n"}
,{"stream_name":"stdout","time":203.591342964,"data":"Simulation finished at t = 600.0000 s after 2069 steps.\n"}
,{"stream_name":"stdout","time":203.591352013,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":203.592877892,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.592890355,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":203.592894892,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":203.593035026,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.593150575,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":203.593538281,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.593613456,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.593738575,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.916869e-17, max=5.329071e-15, std=3.282021e-16\n"}
,{"stream_name":"stdout","time":203.593922812,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":203.594094103,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.883696, w_c=14.218677\n"}
,{"stream_name":"stdout","time":203.594201255,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:887 -   State hash: 6461379301301993119\n"}
,{"stream_name":"stdout","time":203.594305611,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.594514816,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=2.916869e-17\n"}
,{"stream_name":"stdout","time":203.594580313,"data":"\n"}
,{"stream_name":"stdout","time":203.594586329,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":203.594590082,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":203.594593628,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":203.594597356,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":203.594600987,"data":"    - Avg step time: 0.472s (device=gpu)\n"}
,{"stream_name":"stdout","time":203.59460473,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":203.594608346,"data":"    - Wallclock time: 18.9s\n"}
,{"stream_name":"stdout","time":203.594623013,"data":"    - Speed ratio: 31.79x real-time\n"}
,{"stream_name":"stdout","time":203.594642326,"data":"\n"}
,{"stream_name":"stdout","time":203.59477342899999,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":203.594788094,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":203.594793499,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":203.5948111,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":203.594815469,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":203.594820235,"data":"    - Avg step time: 0.472s (device=gpu)\n"}
,{"stream_name":"stdout","time":203.594824778,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":203.594828989,"data":"    - Wallclock time: 18.9s\n"}
,{"stream_name":"stdout","time":203.594833068,"data":"    - Speed ratio: 31.79x real-time\n"}
,{"stream_name":"stdout","time":203.594837798,"data":"\n"}
,{"stream_name":"stdout","time":203.594844522,"data":"2025-10-15 22:36:44 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":203.59527337,"data":"\n"}
,{"stream_name":"stdout","time":203.59528682,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.595291798,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":203.595296023,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.595300412,"data":"\n"}
,{"stream_name":"stdout","time":203.595450883,"data":"2025-10-15 22:36:44 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":203.595538116,"data":"2025-10-15 22:36:44 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-866345908066439449, last=6461379301301993119\n"}
,{"stream_name":"stdout","time":203.596087603,"data":"2025-10-15 22:36:44 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.03122336 0.03168972 0.03217945 0.03267153 0.03313596], w_m[10:15]=[16.46560214 16.40817721 16.35330629 16.30413114 16.26362536]\n"}
,{"stream_name":"stdout","time":203.601012474,"data":"2025-10-15 22:36:44 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02826931 0.02826386 0.02826182 0.02826104 0.02826073], w_m[10:15]=[17.42793983 17.43125511 17.43249708 17.43297014 17.43315409]\n"}
,{"stream_name":"stdout","time":203.601290695,"data":"2025-10-15 22:36:44 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=31.787073, efficiency=5.085932, delay=-175.12s\n"}
,{"stream_name":"stdout","time":203.601385451,"data":"2025-10-15 22:36:44 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":203.60147934,"data":"2025-10-15 22:36:44 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 31.787073312784855, 'avg_speed': 1055.4375174172515, 'avg_density': 0.03023631435669528, 'efficiency': 5.085931730045576, 'delay': -175.118743243177, 'throughput': 158935.36656392427}\n"}
,{"stream_name":"stdout","time":203.60157693,"data":"2025-10-15 22:36:44 - INFO - run_performance_comparison:1430 - Flow improvement: 12.361%\n"}
,{"stream_name":"stdout","time":203.601659495,"data":"2025-10-15 22:36:44 - INFO - run_performance_comparison:1431 - Efficiency improvement: 12.361%\n"}
,{"stream_name":"stdout","time":203.601742712,"data":"2025-10-15 22:36:44 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":203.601805056,"data":"  Flow improvement: 12.4%\n"}
,{"stream_name":"stdout","time":203.601811223,"data":"  Efficiency improvement: 12.4%\n"}
,{"stream_name":"stdout","time":203.601815111,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":203.601818444,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":203.602382852,"data":"\n"}
,{"stream_name":"stdout","time":203.60239764,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":204.229051021,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":204.742035287,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":204.742081068,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":204.742089691,"data":"\n"}
,{"stream_name":"stdout","time":204.742094214,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":204.749999199,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":204.750022657,"data":"\n"}
,{"stream_name":"stdout","time":204.750027542,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":204.750201812,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":204.750212692,"data":"\n"}
,{"stream_name":"stdout","time":204.750216937,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":204.750221087,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":204.750224801,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":204.750228582,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":204.750232154,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":204.750235702,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":204.751139647,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":207.392325274,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":207.392511097,"data":"\n"}
,{"stream_name":"stdout","time":207.392519893,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":207.392598508,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":207.396095581,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":207.396989506,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":207.397099916,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":207.397181393,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":207.397258775,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":207.397350403,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":207.397403738,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":207.39750781,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":207.397563464,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":207.397647014,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":207.449730777,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":207.449768504,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":207.4501227,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":207.451264484,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":207.451373543,"data":"\n"}
,{"stream_name":"stdout","time":207.451380979,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":207.451450528,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":207.451591481,"data":"\n"}
,{"stream_name":"stdout","time":207.451604363,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":207.451609459,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":207.451613816,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":207.451618171,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":210.903252259,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":210.903286913,"data":"  warn(\n"}
,{"stream_name":"stderr","time":210.944998105,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":211.69521177,"data":"[NbConvertApp] Writing 322209 bytes to __results__.html\n"}
]