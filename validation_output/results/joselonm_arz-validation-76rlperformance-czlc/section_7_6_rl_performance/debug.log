2025-10-10 14:16:48 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-10 14:16:48 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-10 14:16:48 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-10 14:16:48 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-10 14:16:48 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-10 14:16:49 - INFO - train_rl_agent:562 - ================================================================================
2025-10-10 14:16:49 - INFO - train_rl_agent:563 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-10 14:16:49 - INFO - train_rl_agent:564 -   - Device: gpu
2025-10-10 14:16:49 - INFO - train_rl_agent:565 -   - Total timesteps: 100
2025-10-10 14:16:49 - INFO - train_rl_agent:566 -   - Episode max time: 120.0s
2025-10-10 14:16:49 - INFO - train_rl_agent:567 -   - Checkpoint frequency: 50
2025-10-10 14:16:49 - INFO - train_rl_agent:568 - ================================================================================
2025-10-10 14:16:49 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
2025-10-10 14:16:49 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
2025-10-10 14:16:49 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
2025-10-10 14:16:49 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
2025-10-10 14:20:33 - INFO - run_performance_comparison:700 - ================================================================================
2025-10-10 14:20:33 - INFO - run_performance_comparison:701 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-10 14:20:33 - INFO - run_performance_comparison:702 - Device: gpu
2025-10-10 14:20:33 - INFO - run_performance_comparison:703 - ================================================================================
2025-10-10 14:20:33 - INFO - run_performance_comparison:704 - ================================================================================
2025-10-10 14:20:33 - INFO - run_performance_comparison:705 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-10 14:20:33 - INFO - run_performance_comparison:706 - Device: gpu
2025-10-10 14:20:33 - INFO - run_performance_comparison:707 - ================================================================================
2025-10-10 14:20:33 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
2025-10-10 14:20:33 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
2025-10-10 14:20:33 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
2025-10-10 14:20:33 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
2025-10-10 14:20:33 - INFO - run_control_simulation:286 - ================================================================================
2025-10-10 14:20:33 - INFO - run_control_simulation:287 - Starting run_control_simulation:
2025-10-10 14:20:33 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-10 14:20:33 - INFO - run_control_simulation:289 -   - duration: 600.0s
2025-10-10 14:20:33 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
2025-10-10 14:20:33 - INFO - run_control_simulation:291 -   - device: gpu
2025-10-10 14:20:33 - INFO - run_control_simulation:292 -   - controller: BaselineController
2025-10-10 14:20:33 - INFO - run_control_simulation:293 -   - max_control_steps: 11
2025-10-10 14:20:33 - INFO - run_control_simulation:294 - ================================================================================
2025-10-10 14:20:33 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
2025-10-10 14:20:33 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
2025-10-10 14:20:33 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] â‰ˆ 30-80m from boundary
2025-10-10 14:20:33 - INFO - run_control_simulation:331 - Calling env.reset()...
2025-10-10 14:20:33 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-10 14:20:33 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-10 14:20:33 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
2025-10-10 14:20:33 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
2025-10-10 14:20:33 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:33 - INFO - run_control_simulation:369 - STEP 0 START:
2025-10-10 14:20:33 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:33 - INFO - run_control_simulation:371 -   Action: 1.000000
2025-10-10 14:20:33 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
2025-10-10 14:20:35 - INFO - run_control_simulation:384 -   Reward: -0.084799
2025-10-10 14:20:35 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:35 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:35 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:35 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
2025-10-10 14:20:35 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
2025-10-10 14:20:35 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.406686, w_c=11.325496
2025-10-10 14:20:35 - INFO - run_control_simulation:418 -   State hash: 8409791264894250498
2025-10-10 14:20:35 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:35 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:35 - INFO - run_control_simulation:369 - STEP 1 START:
2025-10-10 14:20:35 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:35 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:35 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
2025-10-10 14:20:37 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:37 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:37 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:37 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:37 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
2025-10-10 14:20:37 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
2025-10-10 14:20:37 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.918019, w_c=14.101648
2025-10-10 14:20:37 - INFO - run_control_simulation:418 -   State hash: -9011138807261462523
2025-10-10 14:20:37 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:37 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:37 - INFO - run_control_simulation:369 - STEP 2 START:
2025-10-10 14:20:37 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:37 - INFO - run_control_simulation:371 -   Action: 1.000000
2025-10-10 14:20:37 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
2025-10-10 14:20:39 - INFO - run_control_simulation:384 -   Reward: -0.084800
2025-10-10 14:20:39 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:39 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:39 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:39 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.241080e+00, max=7.500000e+00, std=2.066254e+00
2025-10-10 14:20:39 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
2025-10-10 14:20:39 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
2025-10-10 14:20:39 - INFO - run_control_simulation:418 -   State hash: -5882412441307498058
2025-10-10 14:20:39 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:39 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:39 - INFO - run_control_simulation:369 - STEP 3 START:
2025-10-10 14:20:39 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:39 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:39 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
2025-10-10 14:20:41 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:41 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:41 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:41 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:41 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
2025-10-10 14:20:41 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:41 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
2025-10-10 14:20:41 - INFO - run_control_simulation:418 -   State hash: 1877001135921852328
2025-10-10 14:20:41 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:41 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:41 - INFO - run_control_simulation:369 - STEP 4 START:
2025-10-10 14:20:41 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:41 - INFO - run_control_simulation:371 -   Action: 1.000000
2025-10-10 14:20:41 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
2025-10-10 14:20:43 - INFO - run_control_simulation:384 -   Reward: -0.084800
2025-10-10 14:20:43 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:43 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:43 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:43 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.491564e-02, max=7.500000e+00, std=6.627938e-01
2025-10-10 14:20:43 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:43 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
2025-10-10 14:20:43 - INFO - run_control_simulation:418 -   State hash: 8884419899463617860
2025-10-10 14:20:43 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:43 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:43 - INFO - run_control_simulation:369 - STEP 5 START:
2025-10-10 14:20:43 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:43 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:43 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
2025-10-10 14:20:46 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:46 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:46 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:46 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:46 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
2025-10-10 14:20:46 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:46 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
2025-10-10 14:20:46 - INFO - run_control_simulation:418 -   State hash: -4454480815268356441
2025-10-10 14:20:46 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:46 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:46 - INFO - run_control_simulation:369 - STEP 6 START:
2025-10-10 14:20:46 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:46 - INFO - run_control_simulation:371 -   Action: 1.000000
2025-10-10 14:20:46 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
2025-10-10 14:20:48 - INFO - run_control_simulation:384 -   Reward: -0.084800
2025-10-10 14:20:48 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:48 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:48 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:48 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
2025-10-10 14:20:48 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:48 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:20:48 - INFO - run_control_simulation:418 -   State hash: 744103476397897073
2025-10-10 14:20:48 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:48 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:48 - INFO - run_control_simulation:369 - STEP 7 START:
2025-10-10 14:20:48 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:48 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:48 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
2025-10-10 14:20:50 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:50 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:50 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:50 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:50 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
2025-10-10 14:20:50 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:50 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:20:50 - INFO - run_control_simulation:418 -   State hash: 9066405651374024830
2025-10-10 14:20:50 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:50 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:50 - INFO - run_control_simulation:369 - STEP 8 START:
2025-10-10 14:20:50 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:50 - INFO - run_control_simulation:371 -   Action: 1.000000
2025-10-10 14:20:50 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
2025-10-10 14:20:52 - INFO - run_control_simulation:384 -   Reward: -0.084800
2025-10-10 14:20:52 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:52 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:52 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:52 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
2025-10-10 14:20:52 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:52 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
2025-10-10 14:20:52 - INFO - run_control_simulation:418 -   State hash: 777075297544755862
2025-10-10 14:20:52 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:52 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:52 - INFO - run_control_simulation:369 - STEP 9 START:
2025-10-10 14:20:52 - INFO - run_control_simulation:370 -   Controller: BaselineController
2025-10-10 14:20:52 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:52 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
2025-10-10 14:20:54 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:54 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
2025-10-10 14:20:54 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:54 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:54 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
2025-10-10 14:20:54 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:20:54 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
2025-10-10 14:20:54 - INFO - run_control_simulation:418 -   State hash: 2817111464974324198
2025-10-10 14:20:54 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:54 - INFO - run_control_simulation:455 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: -0.35
    - Avg step time: 2.119s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 21.2s
    - Speed ratio: 28.31x real-time

2025-10-10 14:20:54 - INFO - run_control_simulation:456 - Returning 10 state snapshots
2025-10-10 14:20:54 - INFO - run_performance_comparison:725 - Baseline states copied: 10 snapshots
2025-10-10 14:20:54 - INFO - run_performance_comparison:726 - Baseline FIRST state hash: 8409791264894250498
2025-10-10 14:20:54 - INFO - run_performance_comparison:727 - Baseline LAST state hash: 2817111464974324198
2025-10-10 14:20:54 - INFO - run_performance_comparison:728 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
 2.14351577e-05]
2025-10-10 14:20:54 - INFO - run_performance_comparison:729 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
 2.14319923e-05]
2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=8409791264894250498, last=2817111464974324198
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 0: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 1: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 2: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 3: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 4: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 5: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 6: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 7: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 8: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - DEBUG - evaluate_traffic_performance:477 - State 9: shape=(4, 104), dtype=float64
2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
2025-10-10 14:20:54 - INFO - run_control_simulation:286 - ================================================================================
2025-10-10 14:20:54 - INFO - run_control_simulation:287 - Starting run_control_simulation:
2025-10-10 14:20:54 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-10 14:20:54 - INFO - run_control_simulation:289 -   - duration: 600.0s
2025-10-10 14:20:54 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
2025-10-10 14:20:54 - INFO - run_control_simulation:291 -   - device: gpu
2025-10-10 14:20:54 - INFO - run_control_simulation:292 -   - controller: RLController
2025-10-10 14:20:54 - INFO - run_control_simulation:293 -   - max_control_steps: 11
2025-10-10 14:20:54 - INFO - run_control_simulation:294 - ================================================================================
2025-10-10 14:20:54 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
2025-10-10 14:20:54 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
2025-10-10 14:20:54 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] â‰ˆ 30-80m from boundary
2025-10-10 14:20:54 - INFO - run_control_simulation:331 - Calling env.reset()...
2025-10-10 14:20:54 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-10 14:20:54 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-10 14:20:54 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
2025-10-10 14:20:54 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
2025-10-10 14:20:54 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:54 - INFO - run_control_simulation:369 - STEP 0 START:
2025-10-10 14:20:54 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:20:54 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:54 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
2025-10-10 14:20:56 - INFO - run_control_simulation:384 -   Reward: 0.015201
2025-10-10 14:20:56 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:56 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:56 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:56 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.609084e+00, max=1.233795e+01, std=4.039166e+00
2025-10-10 14:20:56 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
2025-10-10 14:20:56 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.262455, w_c=11.210112
2025-10-10 14:20:56 - INFO - run_control_simulation:418 -   State hash: 3083460243079229549
2025-10-10 14:20:56 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:56 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:56 - INFO - run_control_simulation:369 - STEP 1 START:
2025-10-10 14:20:56 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:20:56 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:56 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
2025-10-10 14:20:58 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:20:58 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:20:58 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:20:58 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:20:58 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
2025-10-10 14:20:58 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
2025-10-10 14:20:58 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.773789, w_c=13.986264
2025-10-10 14:20:58 - INFO - run_control_simulation:418 -   State hash: -5730942638293569198
2025-10-10 14:20:58 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:20:58 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:20:58 - INFO - run_control_simulation:369 - STEP 2 START:
2025-10-10 14:20:58 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:20:58 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:20:58 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
2025-10-10 14:21:00 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:00 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:00 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:00 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:00 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
2025-10-10 14:21:00 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
2025-10-10 14:21:00 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
2025-10-10 14:21:00 - INFO - run_control_simulation:418 -   State hash: -5882412441307498058
2025-10-10 14:21:00 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:00 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:00 - INFO - run_control_simulation:369 - STEP 3 START:
2025-10-10 14:21:00 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:00 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:00 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
2025-10-10 14:21:03 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:03 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:03 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:03 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:03 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
2025-10-10 14:21:03 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:03 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
2025-10-10 14:21:03 - INFO - run_control_simulation:418 -   State hash: 1877001135921852328
2025-10-10 14:21:03 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:03 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:03 - INFO - run_control_simulation:369 - STEP 4 START:
2025-10-10 14:21:03 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:03 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:03 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
2025-10-10 14:21:05 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:05 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:05 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:05 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:05 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
2025-10-10 14:21:05 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:05 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:05 - INFO - run_control_simulation:418 -   State hash: -3911155490279929027
2025-10-10 14:21:05 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:05 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:05 - INFO - run_control_simulation:369 - STEP 5 START:
2025-10-10 14:21:05 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:05 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:05 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
2025-10-10 14:21:07 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:07 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:07 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:07 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:07 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
2025-10-10 14:21:07 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:07 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:07 - INFO - run_control_simulation:418 -   State hash: 7477816241282538612
2025-10-10 14:21:07 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:07 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:07 - INFO - run_control_simulation:369 - STEP 6 START:
2025-10-10 14:21:07 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:07 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:07 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
2025-10-10 14:21:09 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:09 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:09 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:09 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:09 - INFO - run_control_simulation:403 -     Diff statistics: mean=2.295402e-11, max=7.384955e-10, std=9.818588e-11
2025-10-10 14:21:09 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:09 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:09 - INFO - run_control_simulation:418 -   State hash: 744103476397897073
2025-10-10 14:21:09 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:09 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:09 - INFO - run_control_simulation:369 - STEP 7 START:
2025-10-10 14:21:09 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:09 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:09 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
2025-10-10 14:21:11 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:11 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:11 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:11 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:11 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
2025-10-10 14:21:11 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:11 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:11 - INFO - run_control_simulation:418 -   State hash: 9066405651374024830
2025-10-10 14:21:11 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:11 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:11 - INFO - run_control_simulation:369 - STEP 8 START:
2025-10-10 14:21:11 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:11 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:11 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
2025-10-10 14:21:13 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:13 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
2025-10-10 14:21:13 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:13 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:13 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
2025-10-10 14:21:13 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:13 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:13 - INFO - run_control_simulation:418 -   State hash: -2198400194523866312
2025-10-10 14:21:13 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:13 - INFO - run_control_simulation:368 - ================================================================================
2025-10-10 14:21:13 - INFO - run_control_simulation:369 - STEP 9 START:
2025-10-10 14:21:13 - INFO - run_control_simulation:370 -   Controller: RLController
2025-10-10 14:21:13 - INFO - run_control_simulation:371 -   Action: 0.000000
2025-10-10 14:21:13 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
2025-10-10 14:21:15 - INFO - run_control_simulation:384 -   Reward: 0.015200
2025-10-10 14:21:15 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
2025-10-10 14:21:15 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
2025-10-10 14:21:15 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-10 14:21:15 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
2025-10-10 14:21:15 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
2025-10-10 14:21:15 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
2025-10-10 14:21:15 - INFO - run_control_simulation:418 -   State hash: -4213464003087667011
2025-10-10 14:21:15 - INFO - run_control_simulation:420 - ================================================================================
2025-10-10 14:21:15 - INFO - run_control_simulation:455 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: 0.15
    - Avg step time: 2.123s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 21.2s
    - Speed ratio: 28.26x real-time

2025-10-10 14:21:15 - INFO - run_control_simulation:456 - Returning 10 state snapshots
2025-10-10 14:21:15 - INFO - run_performance_comparison:762 - RL states copied: 10 snapshots
2025-10-10 14:21:15 - INFO - run_performance_comparison:763 - RL FIRST state hash: 3083460243079229549
2025-10-10 14:21:15 - INFO - run_performance_comparison:764 - RL LAST state hash: -4213464003087667011
2025-10-10 14:21:15 - INFO - run_performance_comparison:765 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
 2.14351577e-05]
2025-10-10 14:21:15 - INFO - run_performance_comparison:766 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
 2.14319923e-05]
2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=3083460243079229549, last=-4213464003087667011
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 0: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 1: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 2: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 3: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 4: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 5: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 6: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 7: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 8: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - DEBUG - evaluate_traffic_performance:477 - State 9: shape=(4, 104), dtype=float64
2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
2025-10-10 14:21:15 - WARNING - run_performance_comparison:774 - States comparison - Identical: False, baseline_hash=8409791264894250498, rl_hash=3083460243079229549
2025-10-10 14:21:15 - INFO - run_performance_comparison:783 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
2025-10-10 14:21:15 - INFO - run_performance_comparison:784 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
2025-10-10 14:21:15 - INFO - run_performance_comparison:792 - Flow improvement: 0.000%
2025-10-10 14:21:15 - INFO - run_performance_comparison:793 - Efficiency improvement: 0.000%
2025-10-10 14:21:15 - INFO - run_performance_comparison:794 - Delay reduction: -0.000%
