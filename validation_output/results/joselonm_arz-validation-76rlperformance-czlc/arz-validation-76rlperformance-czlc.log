0.6s 1 ================================================================================
0.6s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.6s 3 Revendications: R5
0.6s 4 ================================================================================
0.6s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.6s 6 Branch: main
5.5s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.5s 8 PyTorch: 2.6.0+cu124
5.6s 9 CUDA available: True
5.6s 10 CUDA device: Tesla P100-PCIE-16GB
5.6s 11 CUDA version: 12.4
5.6s 12 
5.6s 13 [STEP 1/4] Cloning repository from GitHub...
5.6s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
8.8s 15 [OK] Repository cloned successfully
8.8s 16 TRACKING_SUCCESS: Repository cloned
8.8s 17 
8.8s 18 [STEP 2/4] Installing dependencies...
8.8s 19 Installing PyYAML...
12.7s 20 Installing matplotlib...
15.7s 21 Installing pandas...
18.6s 22 Installing scipy...
21.6s 23 Installing numpy...
24.5s 24 Installing gymnasium...
27.4s 25 Installing stable-baselines3...
100.1s 26 [OK] Dependencies installed
100.1s 27 TRACKING_SUCCESS: Dependencies ready
100.1s 28 
100.1s 29 [STEP 3/4] Running validation tests...
100.1s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
100.1s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
100.1s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
100.1s 33 ============================================================
111.0s 34 2025-10-10 14:16:37.548601: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
111.2s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
111.2s 36 E0000 00:00:1760105797.743320      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
111.3s 37 E0000 00:00:1760105797.796388      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
122.4s 38 ================================================================================
122.4s 39 QUICK TEST MODE ENABLED
122.4s 40 - Training: 2 timesteps only
122.4s 41 - Duration: 2 minutes simulated time
122.4s 42 - Scenarios: 1 scenario only
122.4s 43 - Expected runtime: ~5 minutes on GPU
122.4s 44 ================================================================================
122.4s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
122.4s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
122.4s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
122.4s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
122.4s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
122.4s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
122.4s 51 2025-10-10 14:16:48 - INFO - _setup_debug_logging:119 - ================================================================================
122.4s 52 2025-10-10 14:16:48 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
122.4s 53 2025-10-10 14:16:48 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
122.4s 54 2025-10-10 14:16:48 - INFO - _setup_debug_logging:122 - Quick test mode: True
122.4s 55 2025-10-10 14:16:48 - INFO - _setup_debug_logging:123 - ================================================================================
122.4s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
122.4s 57 === Section 7.6: RL Performance Validation ===
122.4s 58 Testing RL agent performance vs baseline controllers...
122.5s 59 [DEVICE] Detected: GPU
122.6s 60 [GPU INFO] Tesla P100-PCIE-16GB
122.6s 61 
122.6s 62 [PHASE 1/2] Training RL agents...
122.6s 63 [QUICK TEST] Training only: traffic_light_control
122.6s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
122.6s 65 2025-10-10 14:16:49 - INFO - train_rl_agent:562 - ================================================================================
122.6s 66 2025-10-10 14:16:49 - INFO - train_rl_agent:563 - Starting train_rl_agent for scenario: traffic_light_control
122.6s 67 2025-10-10 14:16:49 - INFO - train_rl_agent:564 -   - Device: gpu
122.6s 68 2025-10-10 14:16:49 - INFO - train_rl_agent:565 -   - Total timesteps: 100
122.6s 69 2025-10-10 14:16:49 - INFO - train_rl_agent:566 -   - Episode max time: 120.0s
122.6s 70 2025-10-10 14:16:49 - INFO - train_rl_agent:567 -   - Checkpoint frequency: 50
122.6s 71 2025-10-10 14:16:49 - INFO - train_rl_agent:568 - ================================================================================
122.6s 72 
122.6s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
122.6s 74 Device: gpu
122.6s 75 Total timesteps: 100
122.6s 76 Episode max time: 120.0s
122.6s 77 Checkpoint frequency: 50 steps
122.6s 78 2025-10-10 14:16:49 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
122.6s 79 2025-10-10 14:16:49 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
122.6s 80 2025-10-10 14:16:49 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
122.6s 81 2025-10-10 14:16:49 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
122.6s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
122.6s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
122.6s 84 Using device: gpu
122.6s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
122.6s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
122.6s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
122.6s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
122.6s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
122.6s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
122.6s 91 Loading road quality type: uniform
122.6s 92 Uniform road quality value: 2
122.6s 93 Road quality loaded.
122.6s 94 Initial state created.
122.6s 95 Transferring initial state and road quality to GPU...
122.6s 96 GPU data transfer complete.
122.6s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
122.6s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
122.6s 99 warn(NumbaPerformanceWarning(msg))
124.0s 100 Initial boundary conditions applied.
124.0s 101 TrafficSignalEnvDirect initialized:
124.0s 102 Decision interval: 60.0s
124.0s 103 Observation segments: 6
124.0s 104 Observation space: (26,)
124.0s 105 Action space: 2
124.0s 106 Device: gpu
124.0s 107 [INFO] Environment created: obs_space=(26,), action_space=2
124.0s 108 [INFO] Initializing PPO agent from scratch...
124.0s 109 Using cuda device
124.0s 110 Wrapping the env with a `Monitor` wrapper
124.0s 111 Wrapping the env in a DummyVecEnv.
124.0s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
124.0s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
124.0s 114 Info: (n_steps=100 and n_envs=1)
124.0s 115 warnings.warn(
128.6s 116 
128.6s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
128.6s 118 [INFO] Training for 100 timesteps...
128.6s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
128.6s 120 Using device: gpu
128.6s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
128.6s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
128.6s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
128.6s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
128.6s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
128.6s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
128.6s 127 Loading road quality type: uniform
128.6s 128 Uniform road quality value: 2
128.6s 129 Road quality loaded.
128.6s 130 Initial state created.
128.6s 131 Transferring initial state and road quality to GPU...
128.6s 132 GPU data transfer complete.
128.6s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
128.6s 134 Initial boundary conditions applied.
128.6s 135 [BC UPDATE] left → phase 0 RED (reduced inflow)
128.6s 136 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
128.6s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
128.6s 138 
128.6s 139 🚀 Training started: 100 total timesteps
129.1s 140 [BC UPDATE] left → phase 0 RED (reduced inflow)
129.1s 141 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
129.1s 142 Running simulation until t = 60.00 s, outputting every 60.00 s
129.1s 143 
129.2s 144 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
129.2s 145 warn(NumbaPerformanceWarning(msg))
129.5s 146 [WARNING] Automatic CFL correction applied (count: 1):
129.5s 147 Calculated CFL: 0.800 > Limit: 0.500
129.5s 148 Original dt: 3.228311e-01 s
129.5s 149 Corrected dt: 2.017695e-01 s
129.5s 150 Correction factor: 1.6x
129.5s 151 Max wave speed detected: 24.78 m/s
130.1s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
130.1s 153 warn(NumbaPerformanceWarning(msg))
130.3s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
130.3s 155 warn(NumbaPerformanceWarning(msg))
130.4s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
130.4s 157 warn(NumbaPerformanceWarning(msg))
131.6s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
131.6s 159 warn(NumbaPerformanceWarning(msg))
132.0s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.0s 161 warn(NumbaPerformanceWarning(msg))
132.1s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.1s 163 warn(NumbaPerformanceWarning(msg))
132.2s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.2s 165 warn(NumbaPerformanceWarning(msg))
132.3s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.3s 167 warn(NumbaPerformanceWarning(msg))
132.4s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.4s 169 warn(NumbaPerformanceWarning(msg))
132.5s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.5s 171 warn(NumbaPerformanceWarning(msg))
132.5s 172 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
132.5s 173 warn(NumbaPerformanceWarning(msg))
133.0s 174 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
133.4s 175 [WARNING] Automatic CFL correction applied (count: 100):
133.4s 176 Calculated CFL: 0.800 > Limit: 0.500
133.4s 177 Original dt: 4.145004e-01 s
133.4s 178 Corrected dt: 2.590627e-01 s
133.4s 179 Correction factor: 1.6x
133.4s 180 Max wave speed detected: 19.30 m/s
133.5s 181 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
133.9s 182 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
134.4s 183 [WARNING] Automatic CFL correction applied (count: 200):
134.4s 184 Calculated CFL: 0.800 > Limit: 0.500
134.4s 185 Original dt: 4.115380e-01 s
134.4s 186 Corrected dt: 2.572113e-01 s
134.4s 187 Correction factor: 1.6x
134.4s 188 Max wave speed detected: 19.44 m/s
134.4s 189 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
134.7s 190 
134.7s 191 [A
134.7s 192 Stored output at t = 60.0000 s (Step 231)
134.7s 193 Running Simulation: 100%|██████████| 60.0/60.0 [00:05<00:00, 10.86s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:05<00:00, 10.86s/s]
134.7s 194 
134.7s 195 Simulation finished at t = 60.0000 s after 231 steps.
134.7s 196 Total runtime: 5.52 seconds.
134.7s 197 [BC UPDATE] left → phase 0 RED (reduced inflow)
134.7s 198 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
134.7s 199 Running simulation until t = 120.00 s, outputting every 60.00 s
134.7s 200 
134.8s 201 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
135.3s 202 [WARNING] Automatic CFL correction applied (count: 300):
135.3s 203 Calculated CFL: 0.800 > Limit: 0.500
135.3s 204 Original dt: 4.114988e-01 s
135.3s 205 Corrected dt: 2.571867e-01 s
135.3s 206 Correction factor: 1.6x
135.3s 207 Max wave speed detected: 19.44 m/s
135.3s 208 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
135.8s 209 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
136.3s 210 [WARNING] Automatic CFL correction applied (count: 400):
136.3s 211 Calculated CFL: 0.800 > Limit: 0.500
136.3s 212 Original dt: 4.114980e-01 s
136.3s 213 Corrected dt: 2.571863e-01 s
136.3s 214 Correction factor: 1.6x
136.3s 215 Max wave speed detected: 19.44 m/s
136.3s 216 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
136.7s 217 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
136.9s 218 Stored output at t = 120.0000 s (Step 465)
136.9s 219 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
136.9s 220 [A
136.9s 221 
136.9s 222 Simulation finished at t = 120.0000 s after 465 steps.
136.9s 223 Total runtime: 2.20 seconds.
136.9s 224 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.28s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.27s/s]
136.9s 225 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
136.9s 226 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
136.9s 227 Using device: gpu
136.9s 228 DEBUG PARAMS: Reading K_m_kmh = 10.0
136.9s 229 DEBUG PARAMS: Reading K_c_kmh = 15.0
136.9s 230 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
136.9s 231 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
136.9s 232 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
136.9s 233 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
136.9s 234 Loading road quality type: uniform
136.9s 235 Uniform road quality value: 2
136.9s 236 Road quality loaded.
136.9s 237 Initial state created.
136.9s 238 Transferring initial state and road quality to GPU...
136.9s 239 GPU data transfer complete.
136.9s 240 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
136.9s 241 Initial boundary conditions applied.
136.9s 242 [BC UPDATE] left → phase 0 RED (reduced inflow)
136.9s 243 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
136.9s 244 [BC UPDATE] left → phase 0 RED (reduced inflow)
136.9s 245 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
136.9s 246 Running simulation until t = 60.00 s, outputting every 60.00 s
136.9s 247 
137.2s 248 [WARNING] Automatic CFL correction applied (count: 500):
137.2s 249 Calculated CFL: 0.800 > Limit: 0.500
137.2s 250 Original dt: 4.758816e-01 s
137.2s 251 Corrected dt: 2.974260e-01 s
137.2s 252 Correction factor: 1.6x
137.2s 253 Max wave speed detected: 16.81 m/s
137.4s 254 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
137.8s 255 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
138.1s 256 [WARNING] Automatic CFL correction applied (count: 600):
138.1s 257 Calculated CFL: 0.800 > Limit: 0.500
138.1s 258 Original dt: 4.121510e-01 s
138.1s 259 Corrected dt: 2.575944e-01 s
138.1s 260 Correction factor: 1.6x
138.1s 261 Max wave speed detected: 19.41 m/s
138.3s 262 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
138.7s 263 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
139.0s 264 Stored output at t = 60.0000 s (Step 231)
139.0s 265 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
139.0s 266 [A
139.0s 267 
139.0s 268 Simulation finished at t = 60.0000 s after 231 steps.
139.0s 269 Total runtime: 2.12 seconds.
139.0s 270 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.35s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.34s/s]
139.0s 271 [BC UPDATE] left → phase 0 RED (reduced inflow)
139.0s 272 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
139.0s 273 Running simulation until t = 120.00 s, outputting every 60.00 s
139.0s 274 
139.0s 275 [WARNING] Automatic CFL correction applied (count: 700):
139.0s 276 Calculated CFL: 0.800 > Limit: 0.500
139.0s 277 Original dt: 4.115082e-01 s
139.0s 278 Corrected dt: 2.571926e-01 s
139.0s 279 Correction factor: 1.6x
139.0s 280 Max wave speed detected: 19.44 m/s
139.2s 281 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
139.6s 282 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
139.9s 283 [WARNING] Automatic CFL correction applied (count: 800):
139.9s 284 Calculated CFL: 0.800 > Limit: 0.500
139.9s 285 Original dt: 4.114982e-01 s
139.9s 286 Corrected dt: 2.571864e-01 s
139.9s 287 Correction factor: 1.6x
139.9s 288 Max wave speed detected: 19.44 m/s
140.1s 289 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
140.5s 290 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
140.9s 291 [WARNING] Automatic CFL correction applied (count: 900):
140.9s 292 Calculated CFL: 0.800 > Limit: 0.500
140.9s 293 Original dt: 4.114980e-01 s
140.9s 294 Corrected dt: 2.571863e-01 s
140.9s 295 Correction factor: 1.6x
140.9s 296 Max wave speed detected: 19.44 m/s
141.0s 297 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
141.1s 298 Stored output at t = 120.0000 s (Step 465)
141.1s 299 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
141.1s 300 [A
141.1s 301 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
141.1s 302 
141.1s 303 Simulation finished at t = 120.0000 s after 465 steps.
141.1s 304 Total runtime: 2.14 seconds.
141.1s 305 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
141.1s 306 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
141.1s 307 Using device: gpu
141.2s 308 DEBUG PARAMS: Reading K_m_kmh = 10.0
141.2s 309 DEBUG PARAMS: Reading K_c_kmh = 15.0
141.2s 310 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
141.2s 311 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
141.2s 312 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
141.2s 313 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
141.2s 314 Loading road quality type: uniform
141.2s 315 Uniform road quality value: 2
141.2s 316 Road quality loaded.
141.2s 317 Initial state created.
141.2s 318 Transferring initial state and road quality to GPU...
141.2s 319 GPU data transfer complete.
141.2s 320 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
141.2s 321 Initial boundary conditions applied.
141.2s 322 [BC UPDATE] left → phase 0 RED (reduced inflow)
141.2s 323 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
141.2s 324 [BC UPDATE] left → phase 0 RED (reduced inflow)
141.2s 325 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
141.2s 326 Running simulation until t = 60.00 s, outputting every 60.00 s
141.2s 327 
141.6s 328 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
141.8s 329 [WARNING] Automatic CFL correction applied (count: 1000):
141.8s 330 Calculated CFL: 0.800 > Limit: 0.500
141.8s 331 Original dt: 4.225636e-01 s
141.8s 332 Corrected dt: 2.641023e-01 s
141.8s 333 Correction factor: 1.6x
141.8s 334 Max wave speed detected: 18.93 m/s
142.1s 335 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
142.5s 336 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
142.7s 337 [WARNING] Automatic CFL correction applied (count: 1100):
142.7s 338 Calculated CFL: 0.800 > Limit: 0.500
142.7s 339 Original dt: 4.116395e-01 s
142.7s 340 Corrected dt: 2.572747e-01 s
142.7s 341 Correction factor: 1.6x
142.7s 342 Max wave speed detected: 19.43 m/s
143.0s 343 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
143.2s 344 Stored output at t = 60.0000 s (Step 231)
143.2s 345 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
143.2s 346 [A
143.2s 347 
143.2s 348 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.78s/s]
143.2s 349 Simulation finished at t = 60.0000 s after 231 steps.
143.2s 350 Total runtime: 2.09 seconds.
143.3s 351 [BC UPDATE] left → phase 1 GREEN (normal inflow)
143.3s 352 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
143.3s 353 Running simulation until t = 120.00 s, outputting every 60.00 s
143.3s 354 
143.4s 355 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
143.6s 356 [WARNING] Automatic CFL correction applied (count: 1200):
143.6s 357 Calculated CFL: 0.800 > Limit: 0.500
143.6s 358 Original dt: 4.115005e-01 s
143.6s 359 Corrected dt: 2.571878e-01 s
143.6s 360 Correction factor: 1.6x
143.6s 361 Max wave speed detected: 19.44 m/s
143.9s 362 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
144.3s 363 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
144.5s 364 [WARNING] Automatic CFL correction applied (count: 1300):
144.5s 365 Calculated CFL: 0.800 > Limit: 0.500
144.5s 366 Original dt: 4.114981e-01 s
144.5s 367 Corrected dt: 2.571863e-01 s
144.5s 368 Correction factor: 1.6x
144.5s 369 Max wave speed detected: 19.44 m/s
144.8s 370 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
145.2s 371 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
145.4s 372 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
145.4s 373 [A
145.4s 374 Stored output at t = 120.0000 s (Step 465)
145.4s 375 
145.4s 376 Simulation finished at t = 120.0000 s after 465 steps.
145.4s 377 Total runtime: 2.11 seconds.
145.4s 378 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.51s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s]
145.4s 379 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
145.4s 380 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
145.4s 381 Using device: gpu
145.4s 382 DEBUG PARAMS: Reading K_m_kmh = 10.0
145.4s 383 DEBUG PARAMS: Reading K_c_kmh = 15.0
145.4s 384 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
145.4s 385 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
145.4s 386 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
145.4s 387 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
145.4s 388 Loading road quality type: uniform
145.4s 389 Uniform road quality value: 2
145.4s 390 Road quality loaded.
145.4s 391 Initial state created.
145.4s 392 Transferring initial state and road quality to GPU...
145.4s 393 GPU data transfer complete.
145.4s 394 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
145.4s 395 Initial boundary conditions applied.
145.4s 396 [BC UPDATE] left → phase 0 RED (reduced inflow)
145.4s 397 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
145.4s 398 [BC UPDATE] left → phase 0 RED (reduced inflow)
145.4s 399 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
145.4s 400 Running simulation until t = 60.00 s, outputting every 60.00 s
145.4s 401 
145.4s 402 [WARNING] Automatic CFL correction applied (count: 1400):
145.4s 403 Calculated CFL: 0.800 > Limit: 0.500
145.4s 404 Original dt: 3.451280e-01 s
145.4s 405 Corrected dt: 2.157050e-01 s
145.4s 406 Correction factor: 1.6x
145.4s 407 Max wave speed detected: 23.18 m/s
145.8s 408 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
146.3s 409 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
146.3s 410 [WARNING] Automatic CFL correction applied (count: 1500):
146.3s 411 Calculated CFL: 0.800 > Limit: 0.500
146.3s 412 Original dt: 4.139892e-01 s
146.3s 413 Corrected dt: 2.587433e-01 s
146.3s 414 Correction factor: 1.6x
146.3s 415 Max wave speed detected: 19.32 m/s
146.7s 416 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
147.2s 417 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
147.2s 418 [WARNING] Automatic CFL correction applied (count: 1600):
147.2s 419 Calculated CFL: 0.800 > Limit: 0.500
147.2s 420 Original dt: 4.115314e-01 s
147.2s 421 Corrected dt: 2.572071e-01 s
147.2s 422 Correction factor: 1.6x
147.2s 423 Max wave speed detected: 19.44 m/s
147.5s 424 Stored output at t = 60.0000 s (Step 231)
147.5s 425 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
147.5s 426 [A
147.5s 427 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s]
147.5s 428 
147.5s 429 Simulation finished at t = 60.0000 s after 231 steps.
147.5s 430 Total runtime: 2.10 seconds.
147.5s 431 [BC UPDATE] left → phase 0 RED (reduced inflow)
147.5s 432 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
147.5s 433 Running simulation until t = 120.00 s, outputting every 60.00 s
147.5s 434 
147.6s 435 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
148.1s 436 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
148.1s 437 [WARNING] Automatic CFL correction applied (count: 1700):
148.1s 438 Calculated CFL: 0.800 > Limit: 0.500
148.1s 439 Original dt: 4.114986e-01 s
148.1s 440 Corrected dt: 2.571866e-01 s
148.1s 441 Correction factor: 1.6x
148.1s 442 Max wave speed detected: 19.44 m/s
148.5s 443 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
149.0s 444 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
149.0s 445 [WARNING] Automatic CFL correction applied (count: 1800):
149.0s 446 Calculated CFL: 0.800 > Limit: 0.500
149.0s 447 Original dt: 4.114980e-01 s
149.0s 448 Corrected dt: 2.571863e-01 s
149.0s 449 Correction factor: 1.6x
149.0s 450 Max wave speed detected: 19.44 m/s
149.4s 451 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
149.6s 452 Stored output at t = 120.0000 s (Step 465)
149.6s 453 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
149.6s 454 [A
149.6s 455 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s]
149.6s 456 
149.6s 457 Simulation finished at t = 120.0000 s after 465 steps.
149.6s 458 Total runtime: 2.11 seconds.
149.6s 459 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
149.6s 460 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
149.6s 461 Using device: gpu
149.6s 462 DEBUG PARAMS: Reading K_m_kmh = 10.0
149.6s 463 DEBUG PARAMS: Reading K_c_kmh = 15.0
149.6s 464 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
149.6s 465 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
149.6s 466 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
149.6s 467 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
149.6s 468 Loading road quality type: uniform
149.6s 469 Uniform road quality value: 2
149.6s 470 Road quality loaded.
149.6s 471 Initial state created.
149.6s 472 Transferring initial state and road quality to GPU...
149.6s 473 GPU data transfer complete.
149.6s 474 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
149.6s 475 Initial boundary conditions applied.
149.6s 476 [BC UPDATE] left → phase 0 RED (reduced inflow)
149.6s 477 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
149.6s 478 [BC UPDATE] left → phase 1 GREEN (normal inflow)
149.6s 479 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
149.6s 480 Running simulation until t = 60.00 s, outputting every 60.00 s
149.6s 481 
149.9s 482 [WARNING] Automatic CFL correction applied (count: 1900):
149.9s 483 Calculated CFL: 0.800 > Limit: 0.500
149.9s 484 Original dt: 4.583403e-01 s
149.9s 485 Corrected dt: 2.864627e-01 s
149.9s 486 Correction factor: 1.6x
149.9s 487 Max wave speed detected: 17.45 m/s
150.0s 488 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
150.5s 489 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
150.9s 490 [WARNING] Automatic CFL correction applied (count: 2000):
150.9s 491 Calculated CFL: 0.800 > Limit: 0.500
150.9s 492 Original dt: 4.120137e-01 s
150.9s 493 Corrected dt: 2.575085e-01 s
150.9s 494 Correction factor: 1.6x
150.9s 495 Max wave speed detected: 19.42 m/s
151.0s 496 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
151.4s 497 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
151.7s 498 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
151.7s 499 [A
151.7s 500 Stored output at t = 60.0000 s (Step 231)
151.7s 501 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s]
151.7s 502 
151.7s 503 Simulation finished at t = 60.0000 s after 231 steps.
151.7s 504 Total runtime: 2.10 seconds.
151.7s 505 [BC UPDATE] left → phase 0 RED (reduced inflow)
151.7s 506 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
151.7s 507 Running simulation until t = 120.00 s, outputting every 60.00 s
151.7s 508 
151.8s 509 [WARNING] Automatic CFL correction applied (count: 2100):
151.8s 510 Calculated CFL: 0.800 > Limit: 0.500
151.8s 511 Original dt: 4.115064e-01 s
151.8s 512 Corrected dt: 2.571915e-01 s
151.8s 513 Correction factor: 1.6x
151.8s 514 Max wave speed detected: 19.44 m/s
151.9s 515 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
152.3s 516 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
152.7s 517 [WARNING] Automatic CFL correction applied (count: 2200):
152.7s 518 Calculated CFL: 0.800 > Limit: 0.500
152.7s 519 Original dt: 4.114982e-01 s
152.7s 520 Corrected dt: 2.571864e-01 s
152.7s 521 Correction factor: 1.6x
152.7s 522 Max wave speed detected: 19.44 m/s
152.8s 523 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
153.2s 524 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
153.6s 525 [WARNING] Automatic CFL correction applied (count: 2300):
153.6s 526 Calculated CFL: 0.800 > Limit: 0.500
153.6s 527 Original dt: 4.114980e-01 s
153.6s 528 Corrected dt: 2.571863e-01 s
153.6s 529 Correction factor: 1.6x
153.6s 530 Max wave speed detected: 19.44 m/s
153.7s 531 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
153.8s 532 Stored output at t = 120.0000 s (Step 465)
153.8s 533 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
153.8s 534 [A
153.8s 535 
153.8s 536 Simulation finished at t = 120.0000 s after 465 steps.
153.8s 537 Total runtime: 2.12 seconds.
153.8s 538 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.25s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.25s/s]
153.8s 539 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
153.8s 540 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
153.8s 541 Using device: gpu
153.8s 542 DEBUG PARAMS: Reading K_m_kmh = 10.0
153.8s 543 DEBUG PARAMS: Reading K_c_kmh = 15.0
153.8s 544 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
153.8s 545 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
153.8s 546 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
153.8s 547 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
153.8s 548 Loading road quality type: uniform
153.8s 549 Uniform road quality value: 2
153.8s 550 Road quality loaded.
153.8s 551 Initial state created.
153.8s 552 Transferring initial state and road quality to GPU...
153.8s 553 GPU data transfer complete.
153.8s 554 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
153.8s 555 Initial boundary conditions applied.
153.8s 556 [BC UPDATE] left → phase 0 RED (reduced inflow)
153.8s 557 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
153.8s 558 [BC UPDATE] left → phase 1 GREEN (normal inflow)
153.8s 559 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
153.8s 560 Running simulation until t = 60.00 s, outputting every 60.00 s
153.8s 561 
154.3s 562 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
154.5s 563 [WARNING] Automatic CFL correction applied (count: 2400):
154.5s 564 Calculated CFL: 0.800 > Limit: 0.500
154.5s 565 Original dt: 4.205139e-01 s
154.5s 566 Corrected dt: 2.628212e-01 s
154.5s 567 Correction factor: 1.6x
154.5s 568 Max wave speed detected: 19.02 m/s
154.7s 569 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
155.2s 570 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
155.4s 571 [WARNING] Automatic CFL correction applied (count: 2500):
155.4s 572 Calculated CFL: 0.800 > Limit: 0.500
155.4s 573 Original dt: 4.116141e-01 s
155.4s 574 Corrected dt: 2.572588e-01 s
155.4s 575 Correction factor: 1.6x
155.4s 576 Max wave speed detected: 19.44 m/s
155.6s 577 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
155.9s 578 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
155.9s 579 [A
155.9s 580 Stored output at t = 60.0000 s (Step 231)
155.9s 581 
155.9s 582 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.95s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.95s/s]
155.9s 583 Simulation finished at t = 60.0000 s after 231 steps.
155.9s 584 Total runtime: 2.07 seconds.
155.9s 585 
155.9s 586 [BC UPDATE] left → phase 1 GREEN (normal inflow)
155.9s 587 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
155.9s 588 Running simulation until t = 120.00 s, outputting every 60.00 s
156.1s 589 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
156.3s 590 [WARNING] Automatic CFL correction applied (count: 2600):
156.3s 591 Calculated CFL: 0.800 > Limit: 0.500
156.3s 592 Original dt: 4.115000e-01 s
156.3s 593 Corrected dt: 2.571875e-01 s
156.3s 594 Correction factor: 1.6x
156.3s 595 Max wave speed detected: 19.44 m/s
156.5s 596 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
157.0s 597 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
157.2s 598 [WARNING] Automatic CFL correction applied (count: 2700):
157.2s 599 Calculated CFL: 0.800 > Limit: 0.500
157.2s 600 Original dt: 4.114981e-01 s
157.2s 601 Corrected dt: 2.571863e-01 s
157.2s 602 Correction factor: 1.6x
157.2s 603 Max wave speed detected: 19.44 m/s
157.4s 604 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
157.9s 605 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
158.0s 606 Stored output at t = 120.0000 s (Step 465)
158.0s 607 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
158.0s 608 [A
158.0s 609 
158.0s 610 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.42s/s]
158.0s 611 Simulation finished at t = 120.0000 s after 465 steps.
158.0s 612 Total runtime: 2.11 seconds.
158.0s 613 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
158.0s 614 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
158.0s 615 Using device: gpu
158.0s 616 DEBUG PARAMS: Reading K_m_kmh = 10.0
158.0s 617 DEBUG PARAMS: Reading K_c_kmh = 15.0
158.0s 618 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
158.0s 619 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
158.0s 620 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
158.0s 621 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
158.0s 622 Loading road quality type: uniform
158.0s 623 Uniform road quality value: 2
158.0s 624 Road quality loaded.
158.0s 625 Initial state created.
158.0s 626 Transferring initial state and road quality to GPU...
158.0s 627 GPU data transfer complete.
158.0s 628 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
158.0s 629 Initial boundary conditions applied.
158.0s 630 [BC UPDATE] left → phase 0 RED (reduced inflow)
158.0s 631 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
158.0s 632 [BC UPDATE] left → phase 1 GREEN (normal inflow)
158.0s 633 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
158.0s 634 Running simulation until t = 60.00 s, outputting every 60.00 s
158.0s 635 
158.1s 636 [WARNING] Automatic CFL correction applied (count: 2800):
158.1s 637 Calculated CFL: 0.800 > Limit: 0.500
158.1s 638 Original dt: 3.737254e-01 s
158.1s 639 Corrected dt: 2.335784e-01 s
158.1s 640 Correction factor: 1.6x
158.1s 641 Max wave speed detected: 21.41 m/s
158.5s 642 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
158.9s 643 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
159.0s 644 [WARNING] Automatic CFL correction applied (count: 2900):
159.0s 645 Calculated CFL: 0.800 > Limit: 0.500
159.0s 646 Original dt: 4.134305e-01 s
159.0s 647 Corrected dt: 2.583941e-01 s
159.0s 648 Correction factor: 1.6x
159.0s 649 Max wave speed detected: 19.35 m/s
159.4s 650 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
159.8s 651 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
159.9s 652 [WARNING] Automatic CFL correction applied (count: 3000):
159.9s 653 Calculated CFL: 0.800 > Limit: 0.500
159.9s 654 Original dt: 4.115259e-01 s
159.9s 655 Corrected dt: 2.572037e-01 s
159.9s 656 Correction factor: 1.6x
159.9s 657 Max wave speed detected: 19.44 m/s
160.1s 658 Stored output at t = 60.0000 s (Step 231)
160.1s 659 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
160.1s 660 [A
160.1s 661 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.97s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.96s/s]
160.1s 662 
160.1s 663 Simulation finished at t = 60.0000 s after 231 steps.
160.1s 664 Total runtime: 2.07 seconds.
160.1s 665 [BC UPDATE] left → phase 1 GREEN (normal inflow)
160.1s 666 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
160.1s 667 Running simulation until t = 120.00 s, outputting every 60.00 s
160.1s 668 
160.3s 669 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
160.7s 670 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
160.8s 671 [WARNING] Automatic CFL correction applied (count: 3100):
160.8s 672 Calculated CFL: 0.800 > Limit: 0.500
160.8s 673 Original dt: 4.114985e-01 s
160.8s 674 Corrected dt: 2.571866e-01 s
160.8s 675 Correction factor: 1.6x
160.8s 676 Max wave speed detected: 19.44 m/s
161.2s 677 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
161.7s 678 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
161.8s 679 [WARNING] Automatic CFL correction applied (count: 3200):
161.8s 680 Calculated CFL: 0.800 > Limit: 0.500
161.8s 681 Original dt: 4.114980e-01 s
161.8s 682 Corrected dt: 2.571863e-01 s
161.8s 683 Correction factor: 1.6x
161.8s 684 Max wave speed detected: 19.44 m/s
162.1s 685 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
162.3s 686 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
162.3s 687 [A
162.3s 688 Stored output at t = 120.0000 s (Step 465)
162.3s 689 
162.3s 690 Simulation finished at t = 120.0000 s after 465 steps.
162.3s 691 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.79s/s]
162.3s 692 Total runtime: 2.16 seconds.
162.3s 693 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
162.3s 694 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
162.3s 695 Using device: gpu
162.3s 696 DEBUG PARAMS: Reading K_m_kmh = 10.0
162.3s 697 DEBUG PARAMS: Reading K_c_kmh = 15.0
162.3s 698 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
162.3s 699 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
162.3s 700 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
162.3s 701 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
162.3s 702 Loading road quality type: uniform
162.3s 703 Uniform road quality value: 2
162.3s 704 Road quality loaded.
162.3s 705 Initial state created.
162.3s 706 Transferring initial state and road quality to GPU...
162.3s 707 GPU data transfer complete.
162.3s 708 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
162.3s 709 Initial boundary conditions applied.
162.3s 710 [BC UPDATE] left → phase 0 RED (reduced inflow)
162.3s 711 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
162.3s 712 [BC UPDATE] left → phase 1 GREEN (normal inflow)
162.3s 713 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
162.3s 714 Running simulation until t = 60.00 s, outputting every 60.00 s
162.3s 715 
162.7s 716 [WARNING] Automatic CFL correction applied (count: 3300):
162.7s 717 Calculated CFL: 0.800 > Limit: 0.500
162.7s 718 Original dt: 4.470525e-01 s
162.7s 719 Corrected dt: 2.794078e-01 s
162.7s 720 Correction factor: 1.6x
162.7s 721 Max wave speed detected: 17.89 m/s
162.8s 722 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
163.2s 723 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
163.6s 724 [WARNING] Automatic CFL correction applied (count: 3400):
163.6s 725 Calculated CFL: 0.800 > Limit: 0.500
163.6s 726 Original dt: 4.119130e-01 s
163.6s 727 Corrected dt: 2.574456e-01 s
163.6s 728 Correction factor: 1.6x
163.6s 729 Max wave speed detected: 19.42 m/s
163.7s 730 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
164.1s 731 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
164.4s 732 Stored output at t = 60.0000 s (Step 231)
164.4s 733 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
164.4s 734 [A
164.4s 735 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.55s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.54s/s]
164.4s 736 
164.4s 737 Simulation finished at t = 60.0000 s after 231 steps.
164.4s 738 Total runtime: 2.10 seconds.
164.4s 739 [BC UPDATE] left → phase 1 GREEN (normal inflow)
164.4s 740 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
164.4s 741 Running simulation until t = 120.00 s, outputting every 60.00 s
164.4s 742 
164.5s 743 [WARNING] Automatic CFL correction applied (count: 3500):
164.5s 744 Calculated CFL: 0.800 > Limit: 0.500
164.5s 745 Original dt: 4.115046e-01 s
164.5s 746 Corrected dt: 2.571904e-01 s
164.5s 747 Correction factor: 1.6x
164.5s 748 Max wave speed detected: 19.44 m/s
164.6s 749 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
165.0s 750 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
165.4s 751 [WARNING] Automatic CFL correction applied (count: 3600):
165.4s 752 Calculated CFL: 0.800 > Limit: 0.500
165.4s 753 Original dt: 4.114982e-01 s
165.4s 754 Corrected dt: 2.571863e-01 s
165.4s 755 Correction factor: 1.6x
165.4s 756 Max wave speed detected: 19.44 m/s
165.5s 757 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
165.9s 758 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
166.3s 759 [WARNING] Automatic CFL correction applied (count: 3700):
166.3s 760 Calculated CFL: 0.800 > Limit: 0.500
166.3s 761 Original dt: 4.114980e-01 s
166.3s 762 Corrected dt: 2.571863e-01 s
166.3s 763 Correction factor: 1.6x
166.3s 764 Max wave speed detected: 19.44 m/s
166.4s 765 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
166.5s 766 Stored output at t = 120.0000 s (Step 465)
166.5s 767 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
166.5s 768 [A
166.5s 769 
166.5s 770 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s]
166.5s 771 Simulation finished at t = 120.0000 s after 465 steps.
166.5s 772 Total runtime: 2.12 seconds.
166.5s 773 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
166.5s 774 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
166.5s 775 Using device: gpu
166.5s 776 DEBUG PARAMS: Reading K_m_kmh = 10.0
166.5s 777 DEBUG PARAMS: Reading K_c_kmh = 15.0
166.5s 778 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
166.5s 779 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
166.5s 780 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
166.5s 781 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
166.5s 782 Loading road quality type: uniform
166.5s 783 Uniform road quality value: 2
166.5s 784 Road quality loaded.
166.5s 785 Initial state created.
166.5s 786 Transferring initial state and road quality to GPU...
166.5s 787 GPU data transfer complete.
166.5s 788 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
166.5s 789 Initial boundary conditions applied.
166.5s 790 [BC UPDATE] left → phase 0 RED (reduced inflow)
166.5s 791 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
166.5s 792 [BC UPDATE] left → phase 1 GREEN (normal inflow)
166.5s 793 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
166.5s 794 Running simulation until t = 60.00 s, outputting every 60.00 s
166.5s 795 
167.0s 796 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
167.2s 797 [WARNING] Automatic CFL correction applied (count: 3800):
167.2s 798 Calculated CFL: 0.800 > Limit: 0.500
167.2s 799 Original dt: 4.190346e-01 s
167.2s 800 Corrected dt: 2.618967e-01 s
167.2s 801 Correction factor: 1.6x
167.2s 802 Max wave speed detected: 19.09 m/s
167.4s 803 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
167.9s 804 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
168.1s 805 [WARNING] Automatic CFL correction applied (count: 3900):
168.1s 806 Calculated CFL: 0.800 > Limit: 0.500
168.1s 807 Original dt: 4.115954e-01 s
168.1s 808 Corrected dt: 2.572472e-01 s
168.1s 809 Correction factor: 1.6x
168.1s 810 Max wave speed detected: 19.44 m/s
168.3s 811 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
168.6s 812 Stored output at t = 60.0000 s (Step 231)
168.6s 813 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
168.6s 814 [A
168.6s 815 
168.6s 816 Simulation finished at t = 60.0000 s after 231 steps.
168.6s 817 Total runtime: 2.08 seconds.
168.6s 818 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.83s/s]
168.6s 819 [BC UPDATE] left → phase 1 GREEN (normal inflow)
168.6s 820 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
168.6s 821 Running simulation until t = 120.00 s, outputting every 60.00 s
168.6s 822 
168.8s 823 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
169.0s 824 [WARNING] Automatic CFL correction applied (count: 4000):
169.0s 825 Calculated CFL: 0.800 > Limit: 0.500
169.0s 826 Original dt: 4.114996e-01 s
169.0s 827 Corrected dt: 2.571873e-01 s
169.0s 828 Correction factor: 1.6x
169.0s 829 Max wave speed detected: 19.44 m/s
169.2s 830 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
169.7s 831 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
169.9s 832 [WARNING] Automatic CFL correction applied (count: 4100):
169.9s 833 Calculated CFL: 0.800 > Limit: 0.500
169.9s 834 Original dt: 4.114981e-01 s
169.9s 835 Corrected dt: 2.571863e-01 s
169.9s 836 Correction factor: 1.6x
169.9s 837 Max wave speed detected: 19.44 m/s
170.1s 838 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
170.6s 839 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
170.7s 840 Stored output at t = 120.0000 s (Step 465)
170.7s 841 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
170.7s 842 [A
170.7s 843 
170.7s 844 Simulation finished at t = 120.0000 s after 465 steps.
170.7s 845 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.51s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s]
170.7s 846 Total runtime: 2.11 seconds.
170.7s 847 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
170.7s 848 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
170.7s 849 Using device: gpu
170.7s 850 DEBUG PARAMS: Reading K_m_kmh = 10.0
170.7s 851 DEBUG PARAMS: Reading K_c_kmh = 15.0
170.7s 852 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
170.7s 853 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
170.7s 854 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
170.7s 855 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
170.7s 856 Loading road quality type: uniform
170.7s 857 Uniform road quality value: 2
170.7s 858 Road quality loaded.
170.7s 859 Initial state created.
170.7s 860 Transferring initial state and road quality to GPU...
170.7s 861 GPU data transfer complete.
170.7s 862 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
170.7s 863 Initial boundary conditions applied.
170.7s 864 [BC UPDATE] left → phase 0 RED (reduced inflow)
170.7s 865 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
170.7s 866 [BC UPDATE] left → phase 0 RED (reduced inflow)
170.7s 867 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
170.7s 868 Running simulation until t = 60.00 s, outputting every 60.00 s
170.7s 869 
170.9s 870 [WARNING] Automatic CFL correction applied (count: 4200):
170.9s 871 Calculated CFL: 0.800 > Limit: 0.500
170.9s 872 Original dt: 4.022422e-01 s
170.9s 873 Corrected dt: 2.514014e-01 s
170.9s 874 Correction factor: 1.6x
170.9s 875 Max wave speed detected: 19.89 m/s
171.2s 876 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
171.7s 877 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
171.8s 878 [WARNING] Automatic CFL correction applied (count: 4300):
171.8s 879 Calculated CFL: 0.800 > Limit: 0.500
171.8s 880 Original dt: 4.130229e-01 s
171.8s 881 Corrected dt: 2.581393e-01 s
171.8s 882 Correction factor: 1.6x
171.8s 883 Max wave speed detected: 19.37 m/s
172.1s 884 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
172.6s 885 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
172.7s 886 [WARNING] Automatic CFL correction applied (count: 4400):
172.7s 887 Calculated CFL: 0.800 > Limit: 0.500
172.7s 888 Original dt: 4.115198e-01 s
172.7s 889 Corrected dt: 2.571999e-01 s
172.7s 890 Correction factor: 1.6x
172.7s 891 Max wave speed detected: 19.44 m/s
172.9s 892 Stored output at t = 60.0000 s (Step 231)
172.9s 893 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
172.9s 894 [A
172.9s 895 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.27s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.27s/s]
172.9s 896 
172.9s 897 Simulation finished at t = 60.0000 s after 231 steps.
172.9s 898 Total runtime: 2.12 seconds.
172.9s 899 [BC UPDATE] left → phase 1 GREEN (normal inflow)
172.9s 900 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
172.9s 901 Running simulation until t = 120.00 s, outputting every 60.00 s
172.9s 902 
173.0s 903 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
173.5s 904 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
173.6s 905 [WARNING] Automatic CFL correction applied (count: 4500):
173.6s 906 Calculated CFL: 0.800 > Limit: 0.500
173.6s 907 Original dt: 4.114984e-01 s
173.6s 908 Corrected dt: 2.571865e-01 s
173.6s 909 Correction factor: 1.6x
173.6s 910 Max wave speed detected: 19.44 m/s
174.0s 911 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
174.4s 912 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
174.5s 913 [WARNING] Automatic CFL correction applied (count: 4600):
174.5s 914 Calculated CFL: 0.800 > Limit: 0.500
174.5s 915 Original dt: 4.114980e-01 s
174.5s 916 Corrected dt: 2.571863e-01 s
174.5s 917 Correction factor: 1.6x
174.5s 918 Max wave speed detected: 19.44 m/s
174.9s 919 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
175.0s 920 Stored output at t = 120.0000 s (Step 465)
175.0s 921 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
175.0s 922 [A
175.0s 923 
175.0s 924 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.97s/s]
175.0s 925 Simulation finished at t = 120.0000 s after 465 steps.
175.0s 926 Total runtime: 2.15 seconds.
175.0s 927 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
175.0s 928 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
175.0s 929 Using device: gpu
175.0s 930 DEBUG PARAMS: Reading K_m_kmh = 10.0
175.0s 931 DEBUG PARAMS: Reading K_c_kmh = 15.0
175.0s 932 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
175.0s 933 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
175.0s 934 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
175.0s 935 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
175.0s 936 Loading road quality type: uniform
175.0s 937 Uniform road quality value: 2
175.0s 938 Road quality loaded.
175.0s 939 Initial state created.
175.0s 940 Transferring initial state and road quality to GPU...
175.0s 941 GPU data transfer complete.
175.0s 942 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
175.0s 943 Initial boundary conditions applied.
175.0s 944 [BC UPDATE] left → phase 0 RED (reduced inflow)
175.0s 945 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
175.0s 946 [BC UPDATE] left → phase 0 RED (reduced inflow)
175.0s 947 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
175.0s 948 Running simulation until t = 60.00 s, outputting every 60.00 s
175.0s 949 
175.5s 950 [WARNING] Automatic CFL correction applied (count: 4700):
175.5s 951 Calculated CFL: 0.800 > Limit: 0.500
175.5s 952 Original dt: 4.396418e-01 s
175.5s 953 Corrected dt: 2.747761e-01 s
175.5s 954 Correction factor: 1.6x
175.5s 955 Max wave speed detected: 18.20 m/s
175.5s 956 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
175.9s 957 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
176.4s 958 [WARNING] Automatic CFL correction applied (count: 4800):
176.4s 959 Calculated CFL: 0.800 > Limit: 0.500
176.4s 960 Original dt: 4.118393e-01 s
176.4s 961 Corrected dt: 2.573996e-01 s
176.4s 962 Correction factor: 1.6x
176.4s 963 Max wave speed detected: 19.43 m/s
176.4s 964 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
176.8s 965 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
177.1s 966 Stored output at t = 60.0000 s (Step 231)
177.1s 967 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
177.1s 968 [A
177.1s 969 
177.1s 970 Simulation finished at t = 60.0000 s after 231 steps.
177.1s 971 Total runtime: 2.07 seconds.
177.1s 972 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.01s/s]
177.1s 973 [BC UPDATE] left → phase 0 RED (reduced inflow)
177.1s 974 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
177.1s 975 Running simulation until t = 120.00 s, outputting every 60.00 s
177.1s 976 
177.3s 977 [WARNING] Automatic CFL correction applied (count: 4900):
177.3s 978 Calculated CFL: 0.800 > Limit: 0.500
177.3s 979 Original dt: 4.115033e-01 s
177.3s 980 Corrected dt: 2.571896e-01 s
177.3s 981 Correction factor: 1.6x
177.3s 982 Max wave speed detected: 19.44 m/s
177.3s 983 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
177.7s 984 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
178.2s 985 [WARNING] Automatic CFL correction applied (count: 5000):
178.2s 986 Calculated CFL: 0.800 > Limit: 0.500
178.2s 987 Original dt: 4.114981e-01 s
178.2s 988 Corrected dt: 2.571863e-01 s
178.2s 989 Correction factor: 1.6x
178.2s 990 Max wave speed detected: 19.44 m/s
178.2s 991 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
178.6s 992 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
179.0s 993 [WARNING] Automatic CFL correction applied (count: 5100):
179.0s 994 Calculated CFL: 0.800 > Limit: 0.500
179.0s 995 Original dt: 4.114980e-01 s
179.0s 996 Corrected dt: 2.571863e-01 s
179.0s 997 Correction factor: 1.6x
179.0s 998 Max wave speed detected: 19.44 m/s
179.1s 999 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
179.2s 1000 Stored output at t = 120.0000 s (Step 465)
179.2s 1001 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
179.2s 1002 [A
179.2s 1003 
179.2s 1004 Simulation finished at t = 120.0000 s after 465 steps.
179.2s 1005 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.58s/s]
179.2s 1006 Total runtime: 2.10 seconds.
179.2s 1007 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
179.2s 1008 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
179.2s 1009 Using device: gpu
179.2s 1010 DEBUG PARAMS: Reading K_m_kmh = 10.0
179.2s 1011 DEBUG PARAMS: Reading K_c_kmh = 15.0
179.2s 1012 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
179.2s 1013 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
179.2s 1014 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
179.2s 1015 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
179.2s 1016 Loading road quality type: uniform
179.2s 1017 Uniform road quality value: 2
179.2s 1018 Road quality loaded.
179.2s 1019 Initial state created.
179.2s 1020 Transferring initial state and road quality to GPU...
179.2s 1021 GPU data transfer complete.
179.2s 1022 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
179.2s 1023 Initial boundary conditions applied.
179.2s 1024 [BC UPDATE] left → phase 0 RED (reduced inflow)
179.2s 1025 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
179.2s 1026 [BC UPDATE] left → phase 1 GREEN (normal inflow)
179.2s 1027 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
179.2s 1028 Running simulation until t = 60.00 s, outputting every 60.00 s
179.2s 1029 
179.6s 1030 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
180.0s 1031 [WARNING] Automatic CFL correction applied (count: 5200):
180.0s 1032 Calculated CFL: 0.800 > Limit: 0.500
180.0s 1033 Original dt: 4.173029e-01 s
180.0s 1034 Corrected dt: 2.608143e-01 s
180.0s 1035 Correction factor: 1.6x
180.0s 1036 Max wave speed detected: 19.17 m/s
180.1s 1037 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
180.5s 1038 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
180.9s 1039 [WARNING] Automatic CFL correction applied (count: 5300):
180.9s 1040 Calculated CFL: 0.800 > Limit: 0.500
180.9s 1041 Original dt: 4.115760e-01 s
180.9s 1042 Corrected dt: 2.572350e-01 s
180.9s 1043 Correction factor: 1.6x
180.9s 1044 Max wave speed detected: 19.44 m/s
181.0s 1045 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
181.3s 1046 Stored output at t = 60.0000 s (Step 231)
181.3s 1047 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
181.3s 1048 [A
181.3s 1049 
181.3s 1050 Simulation finished at t = 60.0000 s after 231 steps.
181.3s 1051 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.67s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.67s/s]
181.3s 1052 Total runtime: 2.09 seconds.
181.3s 1053 [BC UPDATE] left → phase 0 RED (reduced inflow)
181.3s 1054 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
181.3s 1055 Running simulation until t = 120.00 s, outputting every 60.00 s
181.3s 1056 
181.5s 1057 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
181.8s 1058 [WARNING] Automatic CFL correction applied (count: 5400):
181.8s 1059 Calculated CFL: 0.800 > Limit: 0.500
181.8s 1060 Original dt: 4.114993e-01 s
181.8s 1061 Corrected dt: 2.571871e-01 s
181.8s 1062 Correction factor: 1.6x
181.8s 1063 Max wave speed detected: 19.44 m/s
181.9s 1064 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
182.4s 1065 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
182.7s 1066 [WARNING] Automatic CFL correction applied (count: 5500):
182.7s 1067 Calculated CFL: 0.800 > Limit: 0.500
182.7s 1068 Original dt: 4.114981e-01 s
182.7s 1069 Corrected dt: 2.571863e-01 s
182.7s 1070 Correction factor: 1.6x
182.7s 1071 Max wave speed detected: 19.44 m/s
182.8s 1072 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
183.3s 1073 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
183.4s 1074 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
183.4s 1075 [A
183.4s 1076 Stored output at t = 120.0000 s (Step 465)
183.4s 1077 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.31s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.31s/s]
183.4s 1078 
183.4s 1079 Simulation finished at t = 120.0000 s after 465 steps.
183.4s 1080 Total runtime: 2.12 seconds.
183.4s 1081 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
183.4s 1082 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
183.4s 1083 Using device: gpu
183.4s 1084 DEBUG PARAMS: Reading K_m_kmh = 10.0
183.4s 1085 DEBUG PARAMS: Reading K_c_kmh = 15.0
183.4s 1086 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
183.4s 1087 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
183.4s 1088 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
183.4s 1089 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
183.4s 1090 Loading road quality type: uniform
183.4s 1091 Uniform road quality value: 2
183.4s 1092 Road quality loaded.
183.4s 1093 Initial state created.
183.4s 1094 Transferring initial state and road quality to GPU...
183.4s 1095 GPU data transfer complete.
183.4s 1096 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
183.4s 1097 Initial boundary conditions applied.
183.4s 1098 [BC UPDATE] left → phase 0 RED (reduced inflow)
183.4s 1099 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
183.4s 1100 
183.4s 1101 [BC UPDATE] left → phase 1 GREEN (normal inflow)
183.4s 1102 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
183.4s 1103 Running simulation until t = 60.00 s, outputting every 60.00 s
183.6s 1104 [WARNING] Automatic CFL correction applied (count: 5600):
183.6s 1105 Calculated CFL: 0.800 > Limit: 0.500
183.6s 1106 Original dt: 4.295974e-01 s
183.6s 1107 Corrected dt: 2.684983e-01 s
183.6s 1108 Correction factor: 1.6x
183.6s 1109 Max wave speed detected: 18.62 m/s
183.9s 1110 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
184.3s 1111 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
184.5s 1112 [WARNING] Automatic CFL correction applied (count: 5700):
184.5s 1113 Calculated CFL: 0.800 > Limit: 0.500
184.5s 1114 Original dt: 4.127253e-01 s
184.5s 1115 Corrected dt: 2.579533e-01 s
184.5s 1116 Correction factor: 1.6x
184.5s 1117 Max wave speed detected: 19.38 m/s
184.8s 1118 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
185.2s 1119 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
185.4s 1120 [WARNING] Automatic CFL correction applied (count: 5800):
185.4s 1121 Calculated CFL: 0.800 > Limit: 0.500
185.4s 1122 Original dt: 4.115153e-01 s
185.4s 1123 Corrected dt: 2.571971e-01 s
185.4s 1124 Correction factor: 1.6x
185.4s 1125 Max wave speed detected: 19.44 m/s
185.5s 1126 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
185.5s 1127 [A
185.5s 1128 Stored output at t = 60.0000 s (Step 231)
185.5s 1129 
185.5s 1130 Simulation finished at t = 60.0000 s after 231 steps.
185.5s 1131 Total runtime: 2.07 seconds.
185.5s 1132 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.99s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.99s/s]
185.5s 1133 [BC UPDATE] left → phase 1 GREEN (normal inflow)
185.5s 1134 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
185.5s 1135 Running simulation until t = 120.00 s, outputting every 60.00 s
185.5s 1136 
185.7s 1137 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
186.1s 1138 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
186.3s 1139 [WARNING] Automatic CFL correction applied (count: 5900):
186.3s 1140 Calculated CFL: 0.800 > Limit: 0.500
186.3s 1141 Original dt: 4.114984e-01 s
186.3s 1142 Corrected dt: 2.571865e-01 s
186.3s 1143 Correction factor: 1.6x
186.3s 1144 Max wave speed detected: 19.44 m/s
186.6s 1145 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
187.0s 1146 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
187.2s 1147 [WARNING] Automatic CFL correction applied (count: 6000):
187.2s 1148 Calculated CFL: 0.800 > Limit: 0.500
187.2s 1149 Original dt: 4.114980e-01 s
187.2s 1150 Corrected dt: 2.571863e-01 s
187.2s 1151 Correction factor: 1.6x
187.2s 1152 Max wave speed detected: 19.44 m/s
187.5s 1153 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
187.6s 1154 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
187.6s 1155 [A
187.6s 1156 Stored output at t = 120.0000 s (Step 465)
187.6s 1157 
187.6s 1158 Simulation finished at t = 120.0000 s after 465 steps.
187.6s 1159 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.58s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.57s/s]
187.6s 1160 Total runtime: 2.10 seconds.
187.6s 1161 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
187.6s 1162 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
187.6s 1163 Using device: gpu
187.6s 1164 DEBUG PARAMS: Reading K_m_kmh = 10.0
187.6s 1165 DEBUG PARAMS: Reading K_c_kmh = 15.0
187.6s 1166 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
187.6s 1167 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
187.6s 1168 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
187.6s 1169 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
187.6s 1170 Loading road quality type: uniform
187.6s 1171 Uniform road quality value: 2
187.6s 1172 Road quality loaded.
187.6s 1173 Initial state created.
187.6s 1174 Transferring initial state and road quality to GPU...
187.6s 1175 GPU data transfer complete.
187.6s 1176 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
187.6s 1177 Initial boundary conditions applied.
187.6s 1178 [BC UPDATE] left → phase 0 RED (reduced inflow)
187.6s 1179 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
187.6s 1180 [BC UPDATE] left → phase 1 GREEN (normal inflow)
187.6s 1181 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
187.6s 1182 Running simulation until t = 60.00 s, outputting every 60.00 s
187.6s 1183 
188.1s 1184 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
188.1s 1185 [WARNING] Automatic CFL correction applied (count: 6100):
188.1s 1186 Calculated CFL: 0.800 > Limit: 0.500
188.1s 1187 Original dt: 4.346596e-01 s
188.1s 1188 Corrected dt: 2.716622e-01 s
188.1s 1189 Correction factor: 1.6x
188.1s 1190 Max wave speed detected: 18.41 m/s
188.5s 1191 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
189.0s 1192 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
189.0s 1193 [WARNING] Automatic CFL correction applied (count: 6200):
189.0s 1194 Calculated CFL: 0.800 > Limit: 0.500
189.0s 1195 Original dt: 4.117853e-01 s
189.0s 1196 Corrected dt: 2.573658e-01 s
189.0s 1197 Correction factor: 1.6x
189.0s 1198 Max wave speed detected: 19.43 m/s
189.4s 1199 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
189.7s 1200 Stored output at t = 60.0000 s (Step 231)
189.7s 1201 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
189.7s 1202 [A
189.7s 1203 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.74s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.74s/s]
189.7s 1204 
189.7s 1205 Simulation finished at t = 60.0000 s after 231 steps.
189.7s 1206 Total runtime: 2.09 seconds.
189.7s 1207 [BC UPDATE] left → phase 0 RED (reduced inflow)
189.7s 1208 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
189.7s 1209 Running simulation until t = 120.00 s, outputting every 60.00 s
189.7s 1210 
189.9s 1211 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
189.9s 1212 [WARNING] Automatic CFL correction applied (count: 6300):
189.9s 1213 Calculated CFL: 0.800 > Limit: 0.500
189.9s 1214 Original dt: 4.115023e-01 s
189.9s 1215 Corrected dt: 2.571890e-01 s
189.9s 1216 Correction factor: 1.6x
189.9s 1217 Max wave speed detected: 19.44 m/s
190.3s 1218 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
190.8s 1219 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
190.9s 1220 [WARNING] Automatic CFL correction applied (count: 6400):
190.9s 1221 Calculated CFL: 0.800 > Limit: 0.500
190.9s 1222 Original dt: 4.114981e-01 s
190.9s 1223 Corrected dt: 2.571863e-01 s
190.9s 1224 Correction factor: 1.6x
190.9s 1225 Max wave speed detected: 19.44 m/s
191.3s 1226 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
191.7s 1227 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
191.7s 1228 [WARNING] Automatic CFL correction applied (count: 6500):
191.7s 1229 Calculated CFL: 0.800 > Limit: 0.500
191.7s 1230 Original dt: 4.114980e-01 s
191.7s 1231 Corrected dt: 2.571863e-01 s
191.7s 1232 Correction factor: 1.6x
191.7s 1233 Max wave speed detected: 19.44 m/s
191.8s 1234 Stored output at t = 120.0000 s (Step 465)
191.8s 1235 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
191.8s 1236 [A
191.8s 1237 
191.8s 1238 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.12s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.12s/s]
191.8s 1239 Simulation finished at t = 120.0000 s after 465 steps.
191.8s 1240 Total runtime: 2.13 seconds.
191.8s 1241 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
191.8s 1242 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
191.8s 1243 Using device: gpu
191.9s 1244 DEBUG PARAMS: Reading K_m_kmh = 10.0
191.9s 1245 DEBUG PARAMS: Reading K_c_kmh = 15.0
191.9s 1246 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
191.9s 1247 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
191.9s 1248 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
191.9s 1249 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
191.9s 1250 Loading road quality type: uniform
191.9s 1251 Uniform road quality value: 2
191.9s 1252 Road quality loaded.
191.9s 1253 Initial state created.
191.9s 1254 Transferring initial state and road quality to GPU...
191.9s 1255 GPU data transfer complete.
191.9s 1256 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
191.9s 1257 Initial boundary conditions applied.
191.9s 1258 [BC UPDATE] left → phase 0 RED (reduced inflow)
191.9s 1259 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
191.9s 1260 [BC UPDATE] left → phase 0 RED (reduced inflow)
191.9s 1261 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
191.9s 1262 Running simulation until t = 60.00 s, outputting every 60.00 s
191.9s 1263 
192.3s 1264 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
192.7s 1265 [WARNING] Automatic CFL correction applied (count: 6600):
192.7s 1266 Calculated CFL: 0.800 > Limit: 0.500
192.7s 1267 Original dt: 4.160552e-01 s
192.7s 1268 Corrected dt: 2.600345e-01 s
192.7s 1269 Correction factor: 1.6x
192.7s 1270 Max wave speed detected: 19.23 m/s
192.8s 1271 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
193.2s 1272 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
193.6s 1273 [WARNING] Automatic CFL correction applied (count: 6700):
193.6s 1274 Calculated CFL: 0.800 > Limit: 0.500
193.6s 1275 Original dt: 4.115592e-01 s
193.6s 1276 Corrected dt: 2.572245e-01 s
193.6s 1277 Correction factor: 1.6x
193.6s 1278 Max wave speed detected: 19.44 m/s
193.7s 1279 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
194.0s 1280 Stored output at t = 60.0000 s (Step 231)
194.0s 1281 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
194.0s 1282 [A
194.0s 1283 
194.0s 1284 Simulation finished at t = 60.0000 s after 231 steps.
194.0s 1285 Total runtime: 2.10 seconds.
194.0s 1286 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.56s/s]
194.0s 1287 [BC UPDATE] left → phase 0 RED (reduced inflow)
194.0s 1288 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
194.0s 1289 Running simulation until t = 120.00 s, outputting every 60.00 s
194.0s 1290 
194.1s 1291 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
194.5s 1292 [WARNING] Automatic CFL correction applied (count: 6800):
194.5s 1293 Calculated CFL: 0.800 > Limit: 0.500
194.5s 1294 Original dt: 4.114991e-01 s
194.5s 1295 Corrected dt: 2.571870e-01 s
194.5s 1296 Correction factor: 1.6x
194.5s 1297 Max wave speed detected: 19.44 m/s
194.6s 1298 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
195.0s 1299 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
195.4s 1300 [WARNING] Automatic CFL correction applied (count: 6900):
195.4s 1301 Calculated CFL: 0.800 > Limit: 0.500
195.4s 1302 Original dt: 4.114980e-01 s
195.4s 1303 Corrected dt: 2.571863e-01 s
195.4s 1304 Correction factor: 1.6x
195.4s 1305 Max wave speed detected: 19.44 m/s
195.5s 1306 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
195.9s 1307 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
196.1s 1308 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
196.1s 1309 Stored output at t = 120.0000 s (Step 465)
196.1s 1310 [A
196.1s 1311 
196.1s 1312 Simulation finished at t = 120.0000 s after 465 steps.
196.1s 1313 Total runtime: 2.11 seconds.
196.1s 1314 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s]
196.1s 1315 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
196.1s 1316 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
196.1s 1317 Using device: gpu
196.1s 1318 DEBUG PARAMS: Reading K_m_kmh = 10.0
196.1s 1319 DEBUG PARAMS: Reading K_c_kmh = 15.0
196.1s 1320 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
196.1s 1321 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
196.1s 1322 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
196.1s 1323 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
196.1s 1324 Loading road quality type: uniform
196.1s 1325 Uniform road quality value: 2
196.1s 1326 Road quality loaded.
196.1s 1327 Initial state created.
196.1s 1328 Transferring initial state and road quality to GPU...
196.1s 1329 GPU data transfer complete.
196.1s 1330 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
196.1s 1331 Initial boundary conditions applied.
196.1s 1332 [BC UPDATE] left → phase 0 RED (reduced inflow)
196.1s 1333 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
196.1s 1334 [BC UPDATE] left → phase 0 RED (reduced inflow)
196.1s 1335 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
196.1s 1336 Running simulation until t = 60.00 s, outputting every 60.00 s
196.1s 1337 
196.3s 1338 [WARNING] Automatic CFL correction applied (count: 7000):
196.3s 1339 Calculated CFL: 0.800 > Limit: 0.500
196.3s 1340 Original dt: 4.547467e-01 s
196.3s 1341 Corrected dt: 2.842167e-01 s
196.3s 1342 Correction factor: 1.6x
196.3s 1343 Max wave speed detected: 17.59 m/s
196.5s 1344 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
197.0s 1345 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
197.2s 1346 [WARNING] Automatic CFL correction applied (count: 7100):
197.2s 1347 Calculated CFL: 0.800 > Limit: 0.500
197.2s 1348 Original dt: 4.125079e-01 s
197.2s 1349 Corrected dt: 2.578175e-01 s
197.2s 1350 Correction factor: 1.6x
197.2s 1351 Max wave speed detected: 19.39 m/s
197.5s 1352 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
197.9s 1353 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
198.1s 1354 [WARNING] Automatic CFL correction applied (count: 7200):
198.1s 1355 Calculated CFL: 0.800 > Limit: 0.500
198.1s 1356 Original dt: 4.115121e-01 s
198.1s 1357 Corrected dt: 2.571950e-01 s
198.1s 1358 Correction factor: 1.6x
198.1s 1359 Max wave speed detected: 19.44 m/s
198.2s 1360 Stored output at t = 60.0000 s (Step 231)
198.2s 1361 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
198.2s 1362 [A
198.2s 1363 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.61s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.61s/s]
198.2s 1364 
198.2s 1365 Simulation finished at t = 60.0000 s after 231 steps.
198.2s 1366 Total runtime: 2.10 seconds.
198.2s 1367 [BC UPDATE] left → phase 1 GREEN (normal inflow)
198.2s 1368 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
198.2s 1369 Running simulation until t = 120.00 s, outputting every 60.00 s
198.2s 1370 
198.4s 1371 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
198.8s 1372 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
199.0s 1373 [WARNING] Automatic CFL correction applied (count: 7300):
199.0s 1374 Calculated CFL: 0.800 > Limit: 0.500
199.0s 1375 Original dt: 4.114983e-01 s
199.0s 1376 Corrected dt: 2.571865e-01 s
199.0s 1377 Correction factor: 1.6x
199.0s 1378 Max wave speed detected: 19.44 m/s
199.3s 1379 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
199.7s 1380 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
199.9s 1381 [WARNING] Automatic CFL correction applied (count: 7400):
199.9s 1382 Calculated CFL: 0.800 > Limit: 0.500
199.9s 1383 Original dt: 4.114980e-01 s
199.9s 1384 Corrected dt: 2.571863e-01 s
199.9s 1385 Correction factor: 1.6x
199.9s 1386 Max wave speed detected: 19.44 m/s
200.2s 1387 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
200.3s 1388 Stored output at t = 120.0000 s (Step 465)
200.3s 1389 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
200.3s 1390 [A
200.3s 1391 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s]
200.3s 1392 
200.3s 1393 Simulation finished at t = 120.0000 s after 465 steps.
200.3s 1394 Total runtime: 2.12 seconds.
200.3s 1395 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
200.3s 1396 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
200.3s 1397 Using device: gpu
200.3s 1398 DEBUG PARAMS: Reading K_m_kmh = 10.0
200.3s 1399 DEBUG PARAMS: Reading K_c_kmh = 15.0
200.3s 1400 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
200.3s 1401 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
200.3s 1402 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
200.3s 1403 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
200.3s 1404 Loading road quality type: uniform
200.3s 1405 Uniform road quality value: 2
200.3s 1406 Road quality loaded.
200.3s 1407 Initial state created.
200.3s 1408 Transferring initial state and road quality to GPU...
200.3s 1409 GPU data transfer complete.
200.3s 1410 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
200.3s 1411 Initial boundary conditions applied.
200.3s 1412 [BC UPDATE] left → phase 0 RED (reduced inflow)
200.3s 1413 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
200.3s 1414 [BC UPDATE] left → phase 1 GREEN (normal inflow)
200.3s 1415 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
200.3s 1416 Running simulation until t = 60.00 s, outputting every 60.00 s
200.3s 1417 
200.8s 1418 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
200.9s 1419 [WARNING] Automatic CFL correction applied (count: 7500):
200.9s 1420 Calculated CFL: 0.800 > Limit: 0.500
200.9s 1421 Original dt: 4.295897e-01 s
200.9s 1422 Corrected dt: 2.684936e-01 s
200.9s 1423 Correction factor: 1.6x
200.9s 1424 Max wave speed detected: 18.62 m/s
201.3s 1425 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
201.7s 1426 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
201.8s 1427 [WARNING] Automatic CFL correction applied (count: 7600):
201.8s 1428 Calculated CFL: 0.800 > Limit: 0.500
201.8s 1429 Original dt: 4.117215e-01 s
201.8s 1430 Corrected dt: 2.573259e-01 s
201.8s 1431 Correction factor: 1.6x
201.8s 1432 Max wave speed detected: 19.43 m/s
202.2s 1433 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
202.5s 1434 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
202.5s 1435 [A
202.5s 1436 Stored output at t = 60.0000 s (Step 231)
202.5s 1437 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.15s/s]
202.5s 1438 
202.5s 1439 Simulation finished at t = 60.0000 s after 231 steps.
202.5s 1440 Total runtime: 2.13 seconds.
202.5s 1441 [BC UPDATE] left → phase 1 GREEN (normal inflow)
202.5s 1442 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
202.5s 1443 Running simulation until t = 120.00 s, outputting every 60.00 s
202.5s 1444 
202.6s 1445 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
202.7s 1446 [WARNING] Automatic CFL correction applied (count: 7700):
202.7s 1447 Calculated CFL: 0.800 > Limit: 0.500
202.7s 1448 Original dt: 4.115016e-01 s
202.7s 1449 Corrected dt: 2.571885e-01 s
202.7s 1450 Correction factor: 1.6x
202.7s 1451 Max wave speed detected: 19.44 m/s
203.1s 1452 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
203.7s 1453 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
203.8s 1454 [WARNING] Automatic CFL correction applied (count: 7800):
203.8s 1455 Calculated CFL: 0.800 > Limit: 0.500
203.8s 1456 Original dt: 4.114981e-01 s
203.8s 1457 Corrected dt: 2.571863e-01 s
203.8s 1458 Correction factor: 1.6x
203.8s 1459 Max wave speed detected: 19.44 m/s
204.1s 1460 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
204.6s 1461 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
204.7s 1462 [WARNING] Automatic CFL correction applied (count: 7900):
204.7s 1463 Calculated CFL: 0.800 > Limit: 0.500
204.7s 1464 Original dt: 4.114980e-01 s
204.7s 1465 Corrected dt: 2.571863e-01 s
204.7s 1466 Correction factor: 1.6x
204.7s 1467 Max wave speed detected: 19.44 m/s
204.7s 1468 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
204.7s 1469 [A
204.7s 1470 Stored output at t = 120.0000 s (Step 465)
204.7s 1471 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.60s/s]
204.7s 1472 
204.7s 1473 Simulation finished at t = 120.0000 s after 465 steps.
204.7s 1474 Total runtime: 2.26 seconds.
204.7s 1475 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
204.7s 1476 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
204.7s 1477 Using device: gpu
204.7s 1478 DEBUG PARAMS: Reading K_m_kmh = 10.0
204.7s 1479 DEBUG PARAMS: Reading K_c_kmh = 15.0
204.7s 1480 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
204.7s 1481 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
204.7s 1482 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
204.7s 1483 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
204.7s 1484 Loading road quality type: uniform
204.7s 1485 Uniform road quality value: 2
204.7s 1486 Road quality loaded.
204.7s 1487 Initial state created.
204.7s 1488 Transferring initial state and road quality to GPU...
204.7s 1489 GPU data transfer complete.
204.7s 1490 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
204.7s 1491 Initial boundary conditions applied.
204.7s 1492 [BC UPDATE] left → phase 0 RED (reduced inflow)
204.7s 1493 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
204.7s 1494 [BC UPDATE] left → phase 0 RED (reduced inflow)
204.7s 1495 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
204.7s 1496 Running simulation until t = 60.00 s, outputting every 60.00 s
204.7s 1497 
205.2s 1498 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
205.6s 1499 [WARNING] Automatic CFL correction applied (count: 8000):
205.6s 1500 Calculated CFL: 0.800 > Limit: 0.500
205.6s 1501 Original dt: 4.151534e-01 s
205.6s 1502 Corrected dt: 2.594709e-01 s
205.6s 1503 Correction factor: 1.6x
205.6s 1504 Max wave speed detected: 19.27 m/s
205.6s 1505 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
206.1s 1506 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
206.5s 1507 [WARNING] Automatic CFL correction applied (count: 8100):
206.5s 1508 Calculated CFL: 0.800 > Limit: 0.500
206.5s 1509 Original dt: 4.115470e-01 s
206.5s 1510 Corrected dt: 2.572169e-01 s
206.5s 1511 Correction factor: 1.6x
206.5s 1512 Max wave speed detected: 19.44 m/s
206.6s 1513 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
206.8s 1514 Stored output at t = 60.0000 s (Step 231)
206.8s 1515 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
206.8s 1516 [A
206.8s 1517 
206.8s 1518 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.48s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.48s/s]
206.8s 1519 Simulation finished at t = 60.0000 s after 231 steps.
206.8s 1520 Total runtime: 2.11 seconds.
206.8s 1521 [BC UPDATE] left → phase 0 RED (reduced inflow)
206.8s 1522 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
206.8s 1523 Running simulation until t = 120.00 s, outputting every 60.00 s
206.8s 1524 
207.0s 1525 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
207.4s 1526 [WARNING] Automatic CFL correction applied (count: 8200):
207.4s 1527 Calculated CFL: 0.800 > Limit: 0.500
207.4s 1528 Original dt: 4.114990e-01 s
207.4s 1529 Corrected dt: 2.571869e-01 s
207.4s 1530 Correction factor: 1.6x
207.4s 1531 Max wave speed detected: 19.44 m/s
207.5s 1532 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
207.9s 1533 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
208.3s 1534 [WARNING] Automatic CFL correction applied (count: 8300):
208.3s 1535 Calculated CFL: 0.800 > Limit: 0.500
208.3s 1536 Original dt: 4.114980e-01 s
208.3s 1537 Corrected dt: 2.571863e-01 s
208.3s 1538 Correction factor: 1.6x
208.3s 1539 Max wave speed detected: 19.44 m/s
208.4s 1540 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
208.8s 1541 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
209.0s 1542 Stored output at t = 120.0000 s (Step 465)
209.0s 1543 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
209.0s 1544 [A
209.0s 1545 
209.0s 1546 Simulation finished at t = 120.0000 s after 465 steps.
209.0s 1547 Total runtime: 2.11 seconds.
209.0s 1548 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.38s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.38s/s]
209.0s 1549 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
209.0s 1550 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
209.0s 1551 Using device: gpu
209.0s 1552 DEBUG PARAMS: Reading K_m_kmh = 10.0
209.0s 1553 DEBUG PARAMS: Reading K_c_kmh = 15.0
209.0s 1554 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
209.0s 1555 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
209.0s 1556 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
209.0s 1557 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
209.0s 1558 Loading road quality type: uniform
209.0s 1559 Uniform road quality value: 2
209.0s 1560 Road quality loaded.
209.0s 1561 Initial state created.
209.0s 1562 Transferring initial state and road quality to GPU...
209.0s 1563 GPU data transfer complete.
209.0s 1564 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
209.0s 1565 Initial boundary conditions applied.
209.0s 1566 [BC UPDATE] left → phase 0 RED (reduced inflow)
209.0s 1567 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
209.0s 1568 [BC UPDATE] left → phase 0 RED (reduced inflow)
209.0s 1569 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
209.0s 1570 Running simulation until t = 60.00 s, outputting every 60.00 s
209.0s 1571 
209.2s 1572 [WARNING] Automatic CFL correction applied (count: 8400):
209.2s 1573 Calculated CFL: 0.800 > Limit: 0.500
209.2s 1574 Original dt: 4.768783e-01 s
209.2s 1575 Corrected dt: 2.980490e-01 s
209.2s 1576 Correction factor: 1.6x
209.2s 1577 Max wave speed detected: 16.78 m/s
209.4s 1578 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
209.9s 1579 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
210.1s 1580 [WARNING] Automatic CFL correction applied (count: 8500):
210.1s 1581 Calculated CFL: 0.800 > Limit: 0.500
210.1s 1582 Original dt: 4.123385e-01 s
210.1s 1583 Corrected dt: 2.577116e-01 s
210.1s 1584 Correction factor: 1.6x
210.1s 1585 Max wave speed detected: 19.40 m/s
210.3s 1586 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
210.8s 1587 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
211.0s 1588 [WARNING] Automatic CFL correction applied (count: 8600):
211.0s 1589 Calculated CFL: 0.800 > Limit: 0.500
211.0s 1590 Original dt: 4.115097e-01 s
211.0s 1591 Corrected dt: 2.571935e-01 s
211.0s 1592 Correction factor: 1.6x
211.0s 1593 Max wave speed detected: 19.44 m/s
211.1s 1594 Stored output at t = 60.0000 s (Step 231)
211.1s 1595 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
211.1s 1596 [A
211.1s 1597 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.74s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.73s/s]
211.1s 1598 
211.1s 1599 Simulation finished at t = 60.0000 s after 231 steps.
211.1s 1600 Total runtime: 2.09 seconds.
211.1s 1601 [BC UPDATE] left → phase 1 GREEN (normal inflow)
211.1s 1602 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
211.1s 1603 Running simulation until t = 120.00 s, outputting every 60.00 s
211.1s 1604 
211.2s 1605 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
211.7s 1606 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
212.0s 1607 [WARNING] Automatic CFL correction applied (count: 8700):
212.0s 1608 Calculated CFL: 0.800 > Limit: 0.500
212.0s 1609 Original dt: 4.114983e-01 s
212.0s 1610 Corrected dt: 2.571864e-01 s
212.0s 1611 Correction factor: 1.6x
212.0s 1612 Max wave speed detected: 19.44 m/s
212.1s 1613 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
212.6s 1614 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
212.9s 1615 [WARNING] Automatic CFL correction applied (count: 8800):
212.9s 1616 Calculated CFL: 0.800 > Limit: 0.500
212.9s 1617 Original dt: 4.114980e-01 s
212.9s 1618 Corrected dt: 2.571863e-01 s
212.9s 1619 Correction factor: 1.6x
212.9s 1620 Max wave speed detected: 19.44 m/s
213.1s 1621 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
213.2s 1622 Stored output at t = 120.0000 s (Step 465)
213.2s 1623 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
213.2s 1624 [A
213.2s 1625 
213.2s 1626 Simulation finished at t = 120.0000 s after 465 steps.
213.2s 1627 Total runtime: 2.14 seconds.
213.2s 1628 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
213.2s 1629 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
213.2s 1630 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
213.2s 1631 Using device: gpu
213.2s 1632 DEBUG PARAMS: Reading K_m_kmh = 10.0
213.2s 1633 DEBUG PARAMS: Reading K_c_kmh = 15.0
213.2s 1634 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
213.2s 1635 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
213.2s 1636 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
213.2s 1637 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
213.2s 1638 Loading road quality type: uniform
213.2s 1639 Uniform road quality value: 2
213.2s 1640 Road quality loaded.
213.2s 1641 Initial state created.
213.2s 1642 Transferring initial state and road quality to GPU...
213.2s 1643 GPU data transfer complete.
213.2s 1644 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
213.2s 1645 Initial boundary conditions applied.
213.2s 1646 [BC UPDATE] left → phase 0 RED (reduced inflow)
213.2s 1647 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
213.2s 1648 [BC UPDATE] left → phase 0 RED (reduced inflow)
213.2s 1649 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
213.2s 1650 Running simulation until t = 60.00 s, outputting every 60.00 s
213.2s 1651 
213.7s 1652 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
213.8s 1653 [WARNING] Automatic CFL correction applied (count: 8900):
213.8s 1654 Calculated CFL: 0.800 > Limit: 0.500
213.8s 1655 Original dt: 4.254608e-01 s
213.8s 1656 Corrected dt: 2.659130e-01 s
213.8s 1657 Correction factor: 1.6x
213.8s 1658 Max wave speed detected: 18.80 m/s
214.1s 1659 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
214.6s 1660 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
214.7s 1661 [WARNING] Automatic CFL correction applied (count: 9000):
214.7s 1662 Calculated CFL: 0.800 > Limit: 0.500
214.7s 1663 Original dt: 4.116742e-01 s
214.7s 1664 Corrected dt: 2.572964e-01 s
214.7s 1665 Correction factor: 1.6x
214.7s 1666 Max wave speed detected: 19.43 m/s
215.0s 1667 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
215.3s 1668 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
215.3s 1669 [A
215.3s 1670 Stored output at t = 60.0000 s (Step 231)
215.3s 1671 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.64s/s]
215.3s 1672 
215.3s 1673 Simulation finished at t = 60.0000 s after 231 steps.
215.3s 1674 Total runtime: 2.10 seconds.
215.3s 1675 [BC UPDATE] left → phase 1 GREEN (normal inflow)
215.3s 1676 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
215.3s 1677 Running simulation until t = 120.00 s, outputting every 60.00 s
215.3s 1678 
215.5s 1679 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
215.6s 1680 [WARNING] Automatic CFL correction applied (count: 9100):
215.6s 1681 Calculated CFL: 0.800 > Limit: 0.500
215.6s 1682 Original dt: 4.115011e-01 s
215.6s 1683 Corrected dt: 2.571882e-01 s
215.6s 1684 Correction factor: 1.6x
215.6s 1685 Max wave speed detected: 19.44 m/s
215.9s 1686 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
216.4s 1687 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
216.5s 1688 [WARNING] Automatic CFL correction applied (count: 9200):
216.5s 1689 Calculated CFL: 0.800 > Limit: 0.500
216.5s 1690 Original dt: 4.114981e-01 s
216.5s 1691 Corrected dt: 2.571863e-01 s
216.5s 1692 Correction factor: 1.6x
216.5s 1693 Max wave speed detected: 19.44 m/s
216.8s 1694 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
217.3s 1695 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
217.4s 1696 [WARNING] Automatic CFL correction applied (count: 9300):
217.4s 1697 Calculated CFL: 0.800 > Limit: 0.500
217.4s 1698 Original dt: 4.114980e-01 s
217.4s 1699 Corrected dt: 2.571863e-01 s
217.4s 1700 Correction factor: 1.6x
217.4s 1701 Max wave speed detected: 19.44 m/s
217.4s 1702 Stored output at t = 120.0000 s (Step 465)
217.4s 1703 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
217.4s 1704 [A
217.4s 1705 
217.4s 1706 Simulation finished at t = 120.0000 s after 465 steps.
217.4s 1707 Total runtime: 2.11 seconds.
217.4s 1708 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s]
217.4s 1709 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
217.4s 1710 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
217.4s 1711 Using device: gpu
217.4s 1712 DEBUG PARAMS: Reading K_m_kmh = 10.0
217.4s 1713 DEBUG PARAMS: Reading K_c_kmh = 15.0
217.4s 1714 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
217.4s 1715 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
217.4s 1716 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
217.4s 1717 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
217.4s 1718 Loading road quality type: uniform
217.4s 1719 Uniform road quality value: 2
217.4s 1720 Road quality loaded.
217.4s 1721 Initial state created.
217.4s 1722 Transferring initial state and road quality to GPU...
217.4s 1723 GPU data transfer complete.
217.4s 1724 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
217.4s 1725 Initial boundary conditions applied.
217.4s 1726 [BC UPDATE] left → phase 0 RED (reduced inflow)
217.4s 1727 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
217.4s 1728 [BC UPDATE] left → phase 0 RED (reduced inflow)
217.4s 1729 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
217.4s 1730 Running simulation until t = 60.00 s, outputting every 60.00 s
217.4s 1731 
217.9s 1732 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
218.3s 1733 [WARNING] Automatic CFL correction applied (count: 9400):
218.3s 1734 Calculated CFL: 0.800 > Limit: 0.500
218.3s 1735 Original dt: 4.145004e-01 s
218.3s 1736 Corrected dt: 2.590627e-01 s
218.3s 1737 Correction factor: 1.6x
218.3s 1738 Max wave speed detected: 19.30 m/s
218.3s 1739 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
218.8s 1740 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
219.2s 1741 [WARNING] Automatic CFL correction applied (count: 9500):
219.2s 1742 Calculated CFL: 0.800 > Limit: 0.500
219.2s 1743 Original dt: 4.115380e-01 s
219.2s 1744 Corrected dt: 2.572113e-01 s
219.2s 1745 Correction factor: 1.6x
219.2s 1746 Max wave speed detected: 19.44 m/s
219.2s 1747 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
219.5s 1748 Stored output at t = 60.0000 s (Step 231)
219.5s 1749 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
219.5s 1750 [A
219.5s 1751 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.20s/s]
219.5s 1752 
219.5s 1753 Simulation finished at t = 60.0000 s after 231 steps.
219.5s 1754 Total runtime: 2.06 seconds.
219.5s 1755 [BC UPDATE] left → phase 1 GREEN (normal inflow)
219.5s 1756 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
219.5s 1757 Running simulation until t = 120.00 s, outputting every 60.00 s
219.5s 1758 
219.7s 1759 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
220.1s 1760 [WARNING] Automatic CFL correction applied (count: 9600):
220.1s 1761 Calculated CFL: 0.800 > Limit: 0.500
220.1s 1762 Original dt: 4.114988e-01 s
220.1s 1763 Corrected dt: 2.571867e-01 s
220.1s 1764 Correction factor: 1.6x
220.1s 1765 Max wave speed detected: 19.44 m/s
220.1s 1766 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
220.6s 1767 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
221.0s 1768 [WARNING] Automatic CFL correction applied (count: 9700):
221.0s 1769 Calculated CFL: 0.800 > Limit: 0.500
221.0s 1770 Original dt: 4.114980e-01 s
221.0s 1771 Corrected dt: 2.571863e-01 s
221.0s 1772 Correction factor: 1.6x
221.0s 1773 Max wave speed detected: 19.44 m/s
221.0s 1774 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
221.5s 1775 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
221.6s 1776 Stored output at t = 120.0000 s (Step 465)
221.6s 1777 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
221.6s 1778 [A
221.6s 1779 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.14s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.13s/s]
221.6s 1780 
221.6s 1781 Simulation finished at t = 120.0000 s after 465 steps.
221.6s 1782 Total runtime: 2.13 seconds.
221.6s 1783 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
221.6s 1784 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
221.6s 1785 Using device: gpu
221.6s 1786 DEBUG PARAMS: Reading K_m_kmh = 10.0
221.6s 1787 DEBUG PARAMS: Reading K_c_kmh = 15.0
221.6s 1788 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
221.6s 1789 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
221.6s 1790 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
221.6s 1791 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
221.6s 1792 Loading road quality type: uniform
221.6s 1793 Uniform road quality value: 2
221.6s 1794 Road quality loaded.
221.6s 1795 Initial state created.
221.6s 1796 Transferring initial state and road quality to GPU...
221.6s 1797 GPU data transfer complete.
221.6s 1798 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
221.6s 1799 Initial boundary conditions applied.
221.6s 1800 [BC UPDATE] left → phase 0 RED (reduced inflow)
221.6s 1801 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
221.6s 1802 [BC UPDATE] left → phase 1 GREEN (normal inflow)
221.6s 1803 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
221.6s 1804 Running simulation until t = 60.00 s, outputting every 60.00 s
221.6s 1805 
222.0s 1806 [WARNING] Automatic CFL correction applied (count: 9800):
222.0s 1807 Calculated CFL: 0.800 > Limit: 0.500
222.0s 1808 Original dt: 4.758816e-01 s
222.0s 1809 Corrected dt: 2.974260e-01 s
222.0s 1810 Correction factor: 1.6x
222.0s 1811 Max wave speed detected: 16.81 m/s
222.1s 1812 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
222.5s 1813 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
222.9s 1814 [WARNING] Automatic CFL correction applied (count: 9900):
222.9s 1815 Calculated CFL: 0.800 > Limit: 0.500
222.9s 1816 Original dt: 4.121510e-01 s
222.9s 1817 Corrected dt: 2.575944e-01 s
222.9s 1818 Correction factor: 1.6x
222.9s 1819 Max wave speed detected: 19.41 m/s
223.0s 1820 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
223.4s 1821 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
223.7s 1822 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
223.7s 1823 [A
223.7s 1824 Stored output at t = 60.0000 s (Step 231)
223.7s 1825 
223.7s 1826 Simulation finished at t = 60.0000 s after 231 steps.
223.7s 1827 Total runtime: 2.07 seconds.
223.7s 1828 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.95s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.94s/s]
223.7s 1829 [BC UPDATE] left → phase 1 GREEN (normal inflow)
223.7s 1830 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
223.7s 1831 Running simulation until t = 120.00 s, outputting every 60.00 s
223.7s 1832 
223.8s 1833 [WARNING] Automatic CFL correction applied (count: 10000):
223.8s 1834 Calculated CFL: 0.800 > Limit: 0.500
223.8s 1835 Original dt: 4.115082e-01 s
223.8s 1836 Corrected dt: 2.571926e-01 s
223.8s 1837 Correction factor: 1.6x
223.8s 1838 Max wave speed detected: 19.44 m/s
223.9s 1839 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
224.4s 1840 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
224.7s 1841 [WARNING] Automatic CFL correction applied (count: 10100):
224.7s 1842 Calculated CFL: 0.800 > Limit: 0.500
224.7s 1843 Original dt: 4.114982e-01 s
224.7s 1844 Corrected dt: 2.571864e-01 s
224.7s 1845 Correction factor: 1.6x
224.7s 1846 Max wave speed detected: 19.44 m/s
224.8s 1847 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
225.3s 1848 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
225.6s 1849 [WARNING] Automatic CFL correction applied (count: 10200):
225.6s 1850 Calculated CFL: 0.800 > Limit: 0.500
225.6s 1851 Original dt: 4.114980e-01 s
225.6s 1852 Corrected dt: 2.571863e-01 s
225.6s 1853 Correction factor: 1.6x
225.6s 1854 Max wave speed detected: 19.44 m/s
225.7s 1855 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
225.8s 1856 Stored output at t = 120.0000 s (Step 465)
225.8s 1857 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
225.8s 1858 [A
225.8s 1859 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s]
225.8s 1860 
225.8s 1861 Simulation finished at t = 120.0000 s after 465 steps.
225.8s 1862 Total runtime: 2.11 seconds.
225.8s 1863 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
225.8s 1864 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
225.8s 1865 Using device: gpu
225.8s 1866 DEBUG PARAMS: Reading K_m_kmh = 10.0
225.8s 1867 DEBUG PARAMS: Reading K_c_kmh = 15.0
225.8s 1868 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
225.8s 1869 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
225.8s 1870 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
225.8s 1871 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
225.8s 1872 Loading road quality type: uniform
225.8s 1873 Uniform road quality value: 2
225.8s 1874 Road quality loaded.
225.8s 1875 Initial state created.
225.8s 1876 Transferring initial state and road quality to GPU...
225.8s 1877 GPU data transfer complete.
225.8s 1878 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
225.8s 1879 Initial boundary conditions applied.
225.8s 1880 [BC UPDATE] left → phase 0 RED (reduced inflow)
225.8s 1881 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
225.9s 1882 [BC UPDATE] left → phase 0 RED (reduced inflow)
225.9s 1883 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
225.9s 1884 Running simulation until t = 60.00 s, outputting every 60.00 s
225.9s 1885 
226.3s 1886 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
226.5s 1887 [WARNING] Automatic CFL correction applied (count: 10300):
226.5s 1888 Calculated CFL: 0.800 > Limit: 0.500
226.5s 1889 Original dt: 4.225636e-01 s
226.5s 1890 Corrected dt: 2.641023e-01 s
226.5s 1891 Correction factor: 1.6x
226.5s 1892 Max wave speed detected: 18.93 m/s
226.7s 1893 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
227.2s 1894 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
227.4s 1895 [WARNING] Automatic CFL correction applied (count: 10400):
227.4s 1896 Calculated CFL: 0.800 > Limit: 0.500
227.4s 1897 Original dt: 4.116395e-01 s
227.4s 1898 Corrected dt: 2.572747e-01 s
227.4s 1899 Correction factor: 1.6x
227.4s 1900 Max wave speed detected: 19.43 m/s
227.6s 1901 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
227.9s 1902 Stored output at t = 60.0000 s (Step 231)
227.9s 1903 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
227.9s 1904 [A
227.9s 1905 
227.9s 1906 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.02s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.02s/s]
227.9s 1907 Simulation finished at t = 60.0000 s after 231 steps.
227.9s 1908 Total runtime: 2.07 seconds.
227.9s 1909 [BC UPDATE] left → phase 1 GREEN (normal inflow)
227.9s 1910 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
227.9s 1911 Running simulation until t = 120.00 s, outputting every 60.00 s
227.9s 1912 
228.1s 1913 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
228.3s 1914 [WARNING] Automatic CFL correction applied (count: 10500):
228.3s 1915 Calculated CFL: 0.800 > Limit: 0.500
228.3s 1916 Original dt: 4.115005e-01 s
228.3s 1917 Corrected dt: 2.571878e-01 s
228.3s 1918 Correction factor: 1.6x
228.3s 1919 Max wave speed detected: 19.44 m/s
228.5s 1920 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
229.0s 1921 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
229.2s 1922 [WARNING] Automatic CFL correction applied (count: 10600):
229.2s 1923 Calculated CFL: 0.800 > Limit: 0.500
229.2s 1924 Original dt: 4.114981e-01 s
229.2s 1925 Corrected dt: 2.571863e-01 s
229.2s 1926 Correction factor: 1.6x
229.2s 1927 Max wave speed detected: 19.44 m/s
229.5s 1928 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
230.0s 1929 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
230.2s 1930 Stored output at t = 120.0000 s (Step 465)
230.2s 1931 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
230.2s 1932 [A
230.2s 1933 
230.2s 1934 Simulation finished at t = 120.0000 s after 465 steps.
230.2s 1935 Total runtime: 2.29 seconds.
230.2s 1936 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.17s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 26.17s/s]
230.2s 1937 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
230.2s 1938 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
230.2s 1939 Using device: gpu
230.2s 1940 DEBUG PARAMS: Reading K_m_kmh = 10.0
230.2s 1941 DEBUG PARAMS: Reading K_c_kmh = 15.0
230.2s 1942 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
230.2s 1943 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
230.2s 1944 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
230.2s 1945 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
230.2s 1946 Loading road quality type: uniform
230.2s 1947 Uniform road quality value: 2
230.2s 1948 Road quality loaded.
230.2s 1949 Initial state created.
230.2s 1950 Transferring initial state and road quality to GPU...
230.2s 1951 GPU data transfer complete.
230.2s 1952 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
230.2s 1953 Initial boundary conditions applied.
230.2s 1954 [BC UPDATE] left → phase 0 RED (reduced inflow)
230.2s 1955 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
230.2s 1956 [BC UPDATE] left → phase 1 GREEN (normal inflow)
230.2s 1957 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
230.2s 1958 Running simulation until t = 60.00 s, outputting every 60.00 s
230.2s 1959 
230.3s 1960 [WARNING] Automatic CFL correction applied (count: 10700):
230.3s 1961 Calculated CFL: 0.800 > Limit: 0.500
230.3s 1962 Original dt: 3.451280e-01 s
230.3s 1963 Corrected dt: 2.157050e-01 s
230.3s 1964 Correction factor: 1.6x
230.3s 1965 Max wave speed detected: 23.18 m/s
230.7s 1966 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
231.2s 1967 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
231.2s 1968 [WARNING] Automatic CFL correction applied (count: 10800):
231.2s 1969 Calculated CFL: 0.800 > Limit: 0.500
231.2s 1970 Original dt: 4.139892e-01 s
231.2s 1971 Corrected dt: 2.587433e-01 s
231.2s 1972 Correction factor: 1.6x
231.2s 1973 Max wave speed detected: 19.32 m/s
231.7s 1974 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
232.1s 1975 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
232.2s 1976 [WARNING] Automatic CFL correction applied (count: 10900):
232.2s 1977 Calculated CFL: 0.800 > Limit: 0.500
232.2s 1978 Original dt: 4.115314e-01 s
232.2s 1979 Corrected dt: 2.572071e-01 s
232.2s 1980 Correction factor: 1.6x
232.2s 1981 Max wave speed detected: 19.44 m/s
232.4s 1982 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
232.4s 1983 [A
232.4s 1984 Stored output at t = 60.0000 s (Step 231)
232.4s 1985 
232.4s 1986 Simulation finished at t = 60.0000 s after 231 steps.
232.4s 1987 Total runtime: 2.18 seconds.
232.4s 1988 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.58s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.58s/s]
232.4s 1989 [BC UPDATE] left → phase 0 RED (reduced inflow)
232.4s 1990 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
232.4s 1991 Running simulation until t = 120.00 s, outputting every 60.00 s
232.4s 1992 
232.6s 1993 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
233.0s 1994 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
233.1s 1995 [WARNING] Automatic CFL correction applied (count: 11000):
233.1s 1996 Calculated CFL: 0.800 > Limit: 0.500
233.1s 1997 Original dt: 4.114986e-01 s
233.1s 1998 Corrected dt: 2.571866e-01 s
233.1s 1999 Correction factor: 1.6x
233.1s 2000 Max wave speed detected: 19.44 m/s
233.5s 2001 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
233.9s 2002 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
234.0s 2003 [WARNING] Automatic CFL correction applied (count: 11100):
234.0s 2004 Calculated CFL: 0.800 > Limit: 0.500
234.0s 2005 Original dt: 4.114980e-01 s
234.0s 2006 Corrected dt: 2.571863e-01 s
234.0s 2007 Correction factor: 1.6x
234.0s 2008 Max wave speed detected: 19.44 m/s
234.4s 2009 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
234.6s 2010 Stored output at t = 120.0000 s (Step 465)
234.6s 2011 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
234.6s 2012 [A
234.6s 2013 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.99s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.99s/s]
234.6s 2014 
234.6s 2015 Simulation finished at t = 120.0000 s after 465 steps.
234.6s 2016 Total runtime: 2.14 seconds.
234.6s 2017 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
234.6s 2018 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
234.6s 2019 Using device: gpu
234.6s 2020 DEBUG PARAMS: Reading K_m_kmh = 10.0
234.6s 2021 DEBUG PARAMS: Reading K_c_kmh = 15.0
234.6s 2022 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
234.6s 2023 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
234.6s 2024 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
234.6s 2025 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
234.6s 2026 Loading road quality type: uniform
234.6s 2027 Uniform road quality value: 2
234.6s 2028 Road quality loaded.
234.6s 2029 Initial state created.
234.6s 2030 Transferring initial state and road quality to GPU...
234.6s 2031 GPU data transfer complete.
234.6s 2032 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
234.6s 2033 Initial boundary conditions applied.
234.6s 2034 [BC UPDATE] left → phase 0 RED (reduced inflow)
234.6s 2035 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
234.6s 2036 [BC UPDATE] left → phase 1 GREEN (normal inflow)
234.6s 2037 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
234.6s 2038 Running simulation until t = 60.00 s, outputting every 60.00 s
234.6s 2039 
234.9s 2040 [WARNING] Automatic CFL correction applied (count: 11200):
234.9s 2041 Calculated CFL: 0.800 > Limit: 0.500
234.9s 2042 Original dt: 4.583403e-01 s
234.9s 2043 Corrected dt: 2.864627e-01 s
234.9s 2044 Correction factor: 1.6x
234.9s 2045 Max wave speed detected: 17.45 m/s
235.0s 2046 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
235.5s 2047 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
235.8s 2048 [WARNING] Automatic CFL correction applied (count: 11300):
235.8s 2049 Calculated CFL: 0.800 > Limit: 0.500
235.8s 2050 Original dt: 4.120137e-01 s
235.8s 2051 Corrected dt: 2.575085e-01 s
235.8s 2052 Correction factor: 1.6x
235.8s 2053 Max wave speed detected: 19.42 m/s
235.9s 2054 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
236.4s 2055 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
236.7s 2056 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
236.7s 2057 Stored output at t = 60.0000 s (Step 231)
236.7s 2058 [A
236.7s 2059 
236.7s 2060 Simulation finished at t = 60.0000 s after 231 steps.
236.7s 2061 Total runtime: 2.09 seconds.
236.7s 2062 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.73s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.72s/s]
236.7s 2063 [BC UPDATE] left → phase 1 GREEN (normal inflow)
236.7s 2064 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
236.7s 2065 Running simulation until t = 120.00 s, outputting every 60.00 s
236.7s 2066 
236.7s 2067 [WARNING] Automatic CFL correction applied (count: 11400):
236.7s 2068 Calculated CFL: 0.800 > Limit: 0.500
236.7s 2069 Original dt: 4.115064e-01 s
236.7s 2070 Corrected dt: 2.571915e-01 s
236.7s 2071 Correction factor: 1.6x
236.7s 2072 Max wave speed detected: 19.44 m/s
236.8s 2073 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
237.3s 2074 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
237.7s 2075 [WARNING] Automatic CFL correction applied (count: 11500):
237.7s 2076 Calculated CFL: 0.800 > Limit: 0.500
237.7s 2077 Original dt: 4.114982e-01 s
237.7s 2078 Corrected dt: 2.571864e-01 s
237.7s 2079 Correction factor: 1.6x
237.7s 2080 Max wave speed detected: 19.44 m/s
237.8s 2081 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
238.2s 2082 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
238.6s 2083 [WARNING] Automatic CFL correction applied (count: 11600):
238.6s 2084 Calculated CFL: 0.800 > Limit: 0.500
238.6s 2085 Original dt: 4.114980e-01 s
238.6s 2086 Corrected dt: 2.571863e-01 s
238.6s 2087 Correction factor: 1.6x
238.6s 2088 Max wave speed detected: 19.44 m/s
238.7s 2089 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
238.8s 2090 Stored output at t = 120.0000 s (Step 465)
238.8s 2091 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
238.8s 2092 [A
238.8s 2093 
238.8s 2094 Simulation finished at t = 120.0000 s after 465 steps.
238.8s 2095 Total runtime: 2.13 seconds.
238.8s 2096 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.15s/s]
238.8s 2097 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
238.8s 2098 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
238.8s 2099 Using device: gpu
238.8s 2100 DEBUG PARAMS: Reading K_m_kmh = 10.0
238.8s 2101 DEBUG PARAMS: Reading K_c_kmh = 15.0
238.8s 2102 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
238.8s 2103 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
238.8s 2104 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
238.8s 2105 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
238.8s 2106 Loading road quality type: uniform
238.8s 2107 Uniform road quality value: 2
238.8s 2108 Road quality loaded.
238.8s 2109 Initial state created.
238.8s 2110 Transferring initial state and road quality to GPU...
238.8s 2111 GPU data transfer complete.
238.8s 2112 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
238.8s 2113 Initial boundary conditions applied.
238.8s 2114 [BC UPDATE] left → phase 0 RED (reduced inflow)
238.8s 2115 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
238.8s 2116 📊 Progress: 50/100 (50.0%) | ETA: 1.8 min | Speed: 0.5 steps/s
238.8s 2117 
238.8s 2118 [BC UPDATE] left → phase 1 GREEN (normal inflow)
238.8s 2119 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
238.8s 2120 Running simulation until t = 60.00 s, outputting every 60.00 s
239.3s 2121 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
239.5s 2122 [WARNING] Automatic CFL correction applied (count: 11700):
239.5s 2123 Calculated CFL: 0.800 > Limit: 0.500
239.5s 2124 Original dt: 4.205139e-01 s
239.5s 2125 Corrected dt: 2.628212e-01 s
239.5s 2126 Correction factor: 1.6x
239.5s 2127 Max wave speed detected: 19.02 m/s
239.8s 2128 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
240.2s 2129 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
240.4s 2130 [WARNING] Automatic CFL correction applied (count: 11800):
240.4s 2131 Calculated CFL: 0.800 > Limit: 0.500
240.4s 2132 Original dt: 4.116141e-01 s
240.4s 2133 Corrected dt: 2.572588e-01 s
240.4s 2134 Correction factor: 1.6x
240.4s 2135 Max wave speed detected: 19.44 m/s
240.7s 2136 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
241.0s 2137 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
241.0s 2138 [A
241.0s 2139 Stored output at t = 60.0000 s (Step 231)
241.0s 2140 
241.0s 2141 Simulation finished at t = 60.0000 s after 231 steps.
241.0s 2142 Total runtime: 2.16 seconds.
241.0s 2143 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.80s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.79s/s]
241.0s 2144 [BC UPDATE] left → phase 0 RED (reduced inflow)
241.0s 2145 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
241.0s 2146 Running simulation until t = 120.00 s, outputting every 60.00 s
241.0s 2147 
241.2s 2148 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
241.4s 2149 [WARNING] Automatic CFL correction applied (count: 11900):
241.4s 2150 Calculated CFL: 0.800 > Limit: 0.500
241.4s 2151 Original dt: 4.115000e-01 s
241.4s 2152 Corrected dt: 2.571875e-01 s
241.4s 2153 Correction factor: 1.6x
241.4s 2154 Max wave speed detected: 19.44 m/s
241.6s 2155 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
242.1s 2156 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
242.3s 2157 [WARNING] Automatic CFL correction applied (count: 12000):
242.3s 2158 Calculated CFL: 0.800 > Limit: 0.500
242.3s 2159 Original dt: 4.114981e-01 s
242.3s 2160 Corrected dt: 2.571863e-01 s
242.3s 2161 Correction factor: 1.6x
242.3s 2162 Max wave speed detected: 19.44 m/s
242.5s 2163 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
243.0s 2164 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
243.1s 2165 Stored output at t = 120.0000 s (Step 465)
243.1s 2166 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
243.1s 2167 [A
243.1s 2168 
243.1s 2169 Simulation finished at t = 120.0000 s after 465 steps.
243.1s 2170 Total runtime: 2.14 seconds.
243.1s 2171 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.04s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.04s/s]
243.1s 2172 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
243.1s 2173 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
243.1s 2174 Using device: gpu
243.1s 2175 DEBUG PARAMS: Reading K_m_kmh = 10.0
243.1s 2176 DEBUG PARAMS: Reading K_c_kmh = 15.0
243.1s 2177 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
243.1s 2178 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
243.1s 2179 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
243.1s 2180 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
243.1s 2181 Loading road quality type: uniform
243.1s 2182 Uniform road quality value: 2
243.1s 2183 Road quality loaded.
243.1s 2184 Initial state created.
243.1s 2185 Transferring initial state and road quality to GPU...
243.1s 2186 GPU data transfer complete.
243.1s 2187 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
243.1s 2188 Initial boundary conditions applied.
243.1s 2189 [BC UPDATE] left → phase 0 RED (reduced inflow)
243.1s 2190 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
243.1s 2191 [BC UPDATE] left → phase 0 RED (reduced inflow)
243.1s 2192 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
243.1s 2193 Running simulation until t = 60.00 s, outputting every 60.00 s
243.1s 2194 
243.2s 2195 [WARNING] Automatic CFL correction applied (count: 12100):
243.2s 2196 Calculated CFL: 0.800 > Limit: 0.500
243.2s 2197 Original dt: 3.737254e-01 s
243.2s 2198 Corrected dt: 2.335784e-01 s
243.2s 2199 Correction factor: 1.6x
243.2s 2200 Max wave speed detected: 21.41 m/s
243.6s 2201 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
244.1s 2202 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
244.1s 2203 [WARNING] Automatic CFL correction applied (count: 12200):
244.1s 2204 Calculated CFL: 0.800 > Limit: 0.500
244.1s 2205 Original dt: 4.134305e-01 s
244.1s 2206 Corrected dt: 2.583941e-01 s
244.1s 2207 Correction factor: 1.6x
244.1s 2208 Max wave speed detected: 19.35 m/s
244.5s 2209 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
245.0s 2210 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
245.0s 2211 [WARNING] Automatic CFL correction applied (count: 12300):
245.0s 2212 Calculated CFL: 0.800 > Limit: 0.500
245.0s 2213 Original dt: 4.115259e-01 s
245.0s 2214 Corrected dt: 2.572037e-01 s
245.0s 2215 Correction factor: 1.6x
245.0s 2216 Max wave speed detected: 19.44 m/s
245.2s 2217 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
245.2s 2218 [A
245.2s 2219 Stored output at t = 60.0000 s (Step 231)
245.2s 2220 
245.2s 2221 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.48s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.48s/s]
245.2s 2222 Simulation finished at t = 60.0000 s after 231 steps.
245.2s 2223 Total runtime: 2.11 seconds.
245.3s 2224 [BC UPDATE] left → phase 1 GREEN (normal inflow)
245.3s 2225 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
245.3s 2226 Running simulation until t = 120.00 s, outputting every 60.00 s
245.3s 2227 
245.4s 2228 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
245.9s 2229 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
246.0s 2230 [WARNING] Automatic CFL correction applied (count: 12400):
246.0s 2231 Calculated CFL: 0.800 > Limit: 0.500
246.0s 2232 Original dt: 4.114985e-01 s
246.0s 2233 Corrected dt: 2.571866e-01 s
246.0s 2234 Correction factor: 1.6x
246.0s 2235 Max wave speed detected: 19.44 m/s
246.3s 2236 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
246.8s 2237 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
246.9s 2238 [WARNING] Automatic CFL correction applied (count: 12500):
246.9s 2239 Calculated CFL: 0.800 > Limit: 0.500
246.9s 2240 Original dt: 4.114980e-01 s
246.9s 2241 Corrected dt: 2.571863e-01 s
246.9s 2242 Correction factor: 1.6x
246.9s 2243 Max wave speed detected: 19.44 m/s
247.2s 2244 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
247.4s 2245 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
247.4s 2246 [A
247.4s 2247 Stored output at t = 120.0000 s (Step 465)
247.4s 2248 
247.4s 2249 Simulation finished at t = 120.0000 s after 465 steps.
247.4s 2250 Total runtime: 2.11 seconds.
247.4s 2251 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.43s/s]
247.4s 2252 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
247.4s 2253 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
247.4s 2254 Using device: gpu
247.4s 2255 DEBUG PARAMS: Reading K_m_kmh = 10.0
247.4s 2256 DEBUG PARAMS: Reading K_c_kmh = 15.0
247.4s 2257 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
247.4s 2258 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
247.4s 2259 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
247.4s 2260 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
247.4s 2261 Loading road quality type: uniform
247.4s 2262 Uniform road quality value: 2
247.4s 2263 Road quality loaded.
247.4s 2264 Initial state created.
247.4s 2265 Transferring initial state and road quality to GPU...
247.4s 2266 GPU data transfer complete.
247.4s 2267 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
247.4s 2268 Initial boundary conditions applied.
247.4s 2269 [BC UPDATE] left → phase 0 RED (reduced inflow)
247.4s 2270 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
247.4s 2271 [BC UPDATE] left → phase 0 RED (reduced inflow)
247.4s 2272 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
247.4s 2273 Running simulation until t = 60.00 s, outputting every 60.00 s
247.4s 2274 
247.8s 2275 [WARNING] Automatic CFL correction applied (count: 12600):
247.8s 2276 Calculated CFL: 0.800 > Limit: 0.500
247.8s 2277 Original dt: 4.470525e-01 s
247.8s 2278 Corrected dt: 2.794078e-01 s
247.8s 2279 Correction factor: 1.6x
247.8s 2280 Max wave speed detected: 17.89 m/s
247.8s 2281 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
248.3s 2282 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
248.7s 2283 [WARNING] Automatic CFL correction applied (count: 12700):
248.7s 2284 Calculated CFL: 0.800 > Limit: 0.500
248.7s 2285 Original dt: 4.119130e-01 s
248.7s 2286 Corrected dt: 2.574456e-01 s
248.7s 2287 Correction factor: 1.6x
248.7s 2288 Max wave speed detected: 19.42 m/s
248.7s 2289 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
249.2s 2290 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
249.5s 2291 Stored output at t = 60.0000 s (Step 231)
249.5s 2292 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
249.5s 2293 [A
249.5s 2294 
249.5s 2295 Simulation finished at t = 60.0000 s after 231 steps.
249.5s 2296 Total runtime: 2.09 seconds.
249.5s 2297 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.76s/s]
249.5s 2298 [BC UPDATE] left → phase 0 RED (reduced inflow)
249.5s 2299 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
249.5s 2300 Running simulation until t = 120.00 s, outputting every 60.00 s
249.5s 2301 
249.6s 2302 [WARNING] Automatic CFL correction applied (count: 12800):
249.6s 2303 Calculated CFL: 0.800 > Limit: 0.500
249.6s 2304 Original dt: 4.115046e-01 s
249.6s 2305 Corrected dt: 2.571904e-01 s
249.6s 2306 Correction factor: 1.6x
249.6s 2307 Max wave speed detected: 19.44 m/s
249.6s 2308 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
250.1s 2309 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
250.5s 2310 [WARNING] Automatic CFL correction applied (count: 12900):
250.5s 2311 Calculated CFL: 0.800 > Limit: 0.500
250.5s 2312 Original dt: 4.114982e-01 s
250.5s 2313 Corrected dt: 2.571863e-01 s
250.5s 2314 Correction factor: 1.6x
250.5s 2315 Max wave speed detected: 19.44 m/s
250.5s 2316 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
251.0s 2317 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
251.4s 2318 [WARNING] Automatic CFL correction applied (count: 13000):
251.4s 2319 Calculated CFL: 0.800 > Limit: 0.500
251.4s 2320 Original dt: 4.114980e-01 s
251.4s 2321 Corrected dt: 2.571863e-01 s
251.4s 2322 Correction factor: 1.6x
251.4s 2323 Max wave speed detected: 19.44 m/s
251.5s 2324 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
251.6s 2325 Stored output at t = 120.0000 s (Step 465)
251.6s 2326 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
251.6s 2327 [A
251.6s 2328 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.92s/s]
251.6s 2329 
251.6s 2330 Simulation finished at t = 120.0000 s after 465 steps.
251.6s 2331 Total runtime: 2.15 seconds.
251.6s 2332 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
251.6s 2333 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
251.6s 2334 Using device: gpu
251.6s 2335 DEBUG PARAMS: Reading K_m_kmh = 10.0
251.6s 2336 DEBUG PARAMS: Reading K_c_kmh = 15.0
251.6s 2337 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
251.6s 2338 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
251.6s 2339 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
251.6s 2340 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
251.6s 2341 Loading road quality type: uniform
251.6s 2342 Uniform road quality value: 2
251.6s 2343 Road quality loaded.
251.6s 2344 Initial state created.
251.6s 2345 Transferring initial state and road quality to GPU...
251.6s 2346 GPU data transfer complete.
251.6s 2347 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
251.6s 2348 Initial boundary conditions applied.
251.6s 2349 [BC UPDATE] left → phase 0 RED (reduced inflow)
251.6s 2350 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
251.6s 2351 [BC UPDATE] left → phase 0 RED (reduced inflow)
251.6s 2352 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
251.6s 2353 Running simulation until t = 60.00 s, outputting every 60.00 s
251.6s 2354 
252.1s 2355 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
252.4s 2356 [WARNING] Automatic CFL correction applied (count: 13100):
252.4s 2357 Calculated CFL: 0.800 > Limit: 0.500
252.4s 2358 Original dt: 4.190346e-01 s
252.4s 2359 Corrected dt: 2.618967e-01 s
252.4s 2360 Correction factor: 1.6x
252.4s 2361 Max wave speed detected: 19.09 m/s
252.6s 2362 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
253.0s 2363 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
253.3s 2364 [WARNING] Automatic CFL correction applied (count: 13200):
253.3s 2365 Calculated CFL: 0.800 > Limit: 0.500
253.3s 2366 Original dt: 4.115954e-01 s
253.3s 2367 Corrected dt: 2.572472e-01 s
253.3s 2368 Correction factor: 1.6x
253.3s 2369 Max wave speed detected: 19.44 m/s
253.5s 2370 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
253.8s 2371 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
253.8s 2372 Stored output at t = 60.0000 s (Step 231)
253.8s 2373 [A
253.8s 2374 
253.8s 2375 Simulation finished at t = 60.0000 s after 231 steps.
253.8s 2376 Total runtime: 2.13 seconds.
253.8s 2377 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.17s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.17s/s]
253.8s 2378 [BC UPDATE] left → phase 0 RED (reduced inflow)
253.8s 2379 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
253.8s 2380 Running simulation until t = 120.00 s, outputting every 60.00 s
253.8s 2381 
253.9s 2382 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
254.2s 2383 [WARNING] Automatic CFL correction applied (count: 13300):
254.2s 2384 Calculated CFL: 0.800 > Limit: 0.500
254.2s 2385 Original dt: 4.114996e-01 s
254.2s 2386 Corrected dt: 2.571873e-01 s
254.2s 2387 Correction factor: 1.6x
254.2s 2388 Max wave speed detected: 19.44 m/s
254.4s 2389 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
254.9s 2390 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
255.2s 2391 [WARNING] Automatic CFL correction applied (count: 13400):
255.2s 2392 Calculated CFL: 0.800 > Limit: 0.500
255.2s 2393 Original dt: 4.114981e-01 s
255.2s 2394 Corrected dt: 2.571863e-01 s
255.2s 2395 Correction factor: 1.6x
255.2s 2396 Max wave speed detected: 19.44 m/s
255.3s 2397 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
255.8s 2398 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
255.9s 2399 Stored output at t = 120.0000 s (Step 465)
255.9s 2400 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
255.9s 2401 [A
255.9s 2402 
255.9s 2403 Simulation finished at t = 120.0000 s after 465 steps.
255.9s 2404 Total runtime: 2.17 seconds.
255.9s 2405 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.63s/s]
255.9s 2406 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
255.9s 2407 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
255.9s 2408 Using device: gpu
255.9s 2409 DEBUG PARAMS: Reading K_m_kmh = 10.0
255.9s 2410 DEBUG PARAMS: Reading K_c_kmh = 15.0
255.9s 2411 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
255.9s 2412 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
255.9s 2413 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
255.9s 2414 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
255.9s 2415 Loading road quality type: uniform
255.9s 2416 Uniform road quality value: 2
255.9s 2417 Road quality loaded.
255.9s 2418 Initial state created.
255.9s 2419 Transferring initial state and road quality to GPU...
255.9s 2420 GPU data transfer complete.
255.9s 2421 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
255.9s 2422 Initial boundary conditions applied.
255.9s 2423 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.9s 2424 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
255.9s 2425 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.9s 2426 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
255.9s 2427 Running simulation until t = 60.00 s, outputting every 60.00 s
255.9s 2428 
256.1s 2429 [WARNING] Automatic CFL correction applied (count: 13500):
256.1s 2430 Calculated CFL: 0.800 > Limit: 0.500
256.1s 2431 Original dt: 4.022422e-01 s
256.1s 2432 Corrected dt: 2.514014e-01 s
256.1s 2433 Correction factor: 1.6x
256.1s 2434 Max wave speed detected: 19.89 m/s
256.4s 2435 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
256.9s 2436 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
257.0s 2437 [WARNING] Automatic CFL correction applied (count: 13600):
257.0s 2438 Calculated CFL: 0.800 > Limit: 0.500
257.0s 2439 Original dt: 4.130229e-01 s
257.0s 2440 Corrected dt: 2.581393e-01 s
257.0s 2441 Correction factor: 1.6x
257.0s 2442 Max wave speed detected: 19.37 m/s
257.3s 2443 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
257.8s 2444 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
258.0s 2445 [WARNING] Automatic CFL correction applied (count: 13700):
258.0s 2446 Calculated CFL: 0.800 > Limit: 0.500
258.0s 2447 Original dt: 4.115198e-01 s
258.0s 2448 Corrected dt: 2.571999e-01 s
258.0s 2449 Correction factor: 1.6x
258.0s 2450 Max wave speed detected: 19.44 m/s
258.1s 2451 Stored output at t = 60.0000 s (Step 231)
258.1s 2452 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
258.1s 2453 [A
258.1s 2454 
258.1s 2455 Simulation finished at t = 60.0000 s after 231 steps.
258.1s 2456 Total runtime: 2.18 seconds.
258.1s 2457 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.56s/s]
258.1s 2458 [BC UPDATE] left → phase 0 RED (reduced inflow)
258.1s 2459 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
258.1s 2460 Running simulation until t = 120.00 s, outputting every 60.00 s
258.1s 2461 
258.3s 2462 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
258.8s 2463 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
258.9s 2464 [WARNING] Automatic CFL correction applied (count: 13800):
258.9s 2465 Calculated CFL: 0.800 > Limit: 0.500
258.9s 2466 Original dt: 4.114984e-01 s
258.9s 2467 Corrected dt: 2.571865e-01 s
258.9s 2468 Correction factor: 1.6x
258.9s 2469 Max wave speed detected: 19.44 m/s
259.2s 2470 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
259.7s 2471 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
259.8s 2472 [WARNING] Automatic CFL correction applied (count: 13900):
259.8s 2473 Calculated CFL: 0.800 > Limit: 0.500
259.8s 2474 Original dt: 4.114980e-01 s
259.8s 2475 Corrected dt: 2.571863e-01 s
259.8s 2476 Correction factor: 1.6x
259.8s 2477 Max wave speed detected: 19.44 m/s
260.1s 2478 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
260.3s 2479 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
260.3s 2480 [A
260.3s 2481 Stored output at t = 120.0000 s (Step 465)
260.3s 2482 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.20s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.20s/s]
260.3s 2483 
260.3s 2484 Simulation finished at t = 120.0000 s after 465 steps.
260.3s 2485 Total runtime: 2.13 seconds.
260.3s 2486 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
260.3s 2487 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
260.3s 2488 Using device: gpu
260.3s 2489 DEBUG PARAMS: Reading K_m_kmh = 10.0
260.3s 2490 DEBUG PARAMS: Reading K_c_kmh = 15.0
260.3s 2491 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
260.3s 2492 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
260.3s 2493 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
260.3s 2494 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
260.3s 2495 Loading road quality type: uniform
260.3s 2496 Uniform road quality value: 2
260.3s 2497 Road quality loaded.
260.3s 2498 Initial state created.
260.3s 2499 Transferring initial state and road quality to GPU...
260.3s 2500 GPU data transfer complete.
260.3s 2501 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
260.3s 2502 Initial boundary conditions applied.
260.3s 2503 [BC UPDATE] left → phase 0 RED (reduced inflow)
260.3s 2504 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
260.3s 2505 [BC UPDATE] left → phase 0 RED (reduced inflow)
260.3s 2506 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
260.3s 2507 Running simulation until t = 60.00 s, outputting every 60.00 s
260.3s 2508 
260.7s 2509 [WARNING] Automatic CFL correction applied (count: 14000):
260.7s 2510 Calculated CFL: 0.800 > Limit: 0.500
260.7s 2511 Original dt: 4.396418e-01 s
260.7s 2512 Corrected dt: 2.747761e-01 s
260.7s 2513 Correction factor: 1.6x
260.7s 2514 Max wave speed detected: 18.20 m/s
260.7s 2515 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
261.2s 2516 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
261.6s 2517 [WARNING] Automatic CFL correction applied (count: 14100):
261.6s 2518 Calculated CFL: 0.800 > Limit: 0.500
261.6s 2519 Original dt: 4.118393e-01 s
261.6s 2520 Corrected dt: 2.573996e-01 s
261.6s 2521 Correction factor: 1.6x
261.6s 2522 Max wave speed detected: 19.43 m/s
261.6s 2523 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
262.1s 2524 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
262.4s 2525 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
262.4s 2526 [A
262.4s 2527 Stored output at t = 60.0000 s (Step 231)
262.4s 2528 
262.4s 2529 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.38s/s]
262.4s 2530 Simulation finished at t = 60.0000 s after 231 steps.
262.4s 2531 Total runtime: 2.11 seconds.
262.4s 2532 [BC UPDATE] left → phase 1 GREEN (normal inflow)
262.4s 2533 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
262.4s 2534 Running simulation until t = 120.00 s, outputting every 60.00 s
262.4s 2535 
262.6s 2536 [WARNING] Automatic CFL correction applied (count: 14200):
262.6s 2537 Calculated CFL: 0.800 > Limit: 0.500
262.6s 2538 Original dt: 4.115033e-01 s
262.6s 2539 Corrected dt: 2.571896e-01 s
262.6s 2540 Correction factor: 1.6x
262.6s 2541 Max wave speed detected: 19.44 m/s
262.6s 2542 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
263.0s 2543 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
263.5s 2544 [WARNING] Automatic CFL correction applied (count: 14300):
263.5s 2545 Calculated CFL: 0.800 > Limit: 0.500
263.5s 2546 Original dt: 4.114981e-01 s
263.5s 2547 Corrected dt: 2.571863e-01 s
263.5s 2548 Correction factor: 1.6x
263.5s 2549 Max wave speed detected: 19.44 m/s
263.5s 2550 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
263.9s 2551 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
264.4s 2552 [WARNING] Automatic CFL correction applied (count: 14400):
264.4s 2553 Calculated CFL: 0.800 > Limit: 0.500
264.4s 2554 Original dt: 4.114980e-01 s
264.4s 2555 Corrected dt: 2.571863e-01 s
264.4s 2556 Correction factor: 1.6x
264.4s 2557 Max wave speed detected: 19.44 m/s
264.4s 2558 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
264.5s 2559 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
264.5s 2560 [A
264.5s 2561 Stored output at t = 120.0000 s (Step 465)
264.5s 2562 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.40s/s]
264.5s 2563 
264.5s 2564 Simulation finished at t = 120.0000 s after 465 steps.
264.5s 2565 Total runtime: 2.11 seconds.
264.5s 2566 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
264.5s 2567 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
264.5s 2568 Using device: gpu
264.5s 2569 DEBUG PARAMS: Reading K_m_kmh = 10.0
264.5s 2570 DEBUG PARAMS: Reading K_c_kmh = 15.0
264.5s 2571 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
264.5s 2572 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
264.5s 2573 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
264.5s 2574 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
264.5s 2575 Loading road quality type: uniform
264.5s 2576 Uniform road quality value: 2
264.5s 2577 Road quality loaded.
264.5s 2578 Initial state created.
264.5s 2579 Transferring initial state and road quality to GPU...
264.5s 2580 GPU data transfer complete.
264.5s 2581 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
264.5s 2582 Initial boundary conditions applied.
264.5s 2583 [BC UPDATE] left → phase 0 RED (reduced inflow)
264.5s 2584 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
264.5s 2585 [BC UPDATE] left → phase 0 RED (reduced inflow)
264.5s 2586 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
264.5s 2587 Running simulation until t = 60.00 s, outputting every 60.00 s
264.5s 2588 
265.0s 2589 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
265.3s 2590 [WARNING] Automatic CFL correction applied (count: 14500):
265.3s 2591 Calculated CFL: 0.800 > Limit: 0.500
265.3s 2592 Original dt: 4.173029e-01 s
265.3s 2593 Corrected dt: 2.608143e-01 s
265.3s 2594 Correction factor: 1.6x
265.3s 2595 Max wave speed detected: 19.17 m/s
265.4s 2596 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
265.9s 2597 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
266.2s 2598 [WARNING] Automatic CFL correction applied (count: 14600):
266.2s 2599 Calculated CFL: 0.800 > Limit: 0.500
266.2s 2600 Original dt: 4.115760e-01 s
266.2s 2601 Corrected dt: 2.572350e-01 s
266.2s 2602 Correction factor: 1.6x
266.2s 2603 Max wave speed detected: 19.44 m/s
266.3s 2604 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
266.6s 2605 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
266.6s 2606 [A
266.6s 2607 Stored output at t = 60.0000 s (Step 231)
266.6s 2608 
266.6s 2609 Simulation finished at t = 60.0000 s after 231 steps.
266.6s 2610 Total runtime: 2.07 seconds.
266.6s 2611 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.99s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.99s/s]
266.6s 2612 [BC UPDATE] left → phase 0 RED (reduced inflow)
266.6s 2613 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
266.6s 2614 Running simulation until t = 120.00 s, outputting every 60.00 s
266.6s 2615 
266.8s 2616 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
267.5s 2617 [WARNING] Automatic CFL correction applied (count: 14700):
267.5s 2618 Calculated CFL: 0.800 > Limit: 0.500
267.5s 2619 Original dt: 4.114993e-01 s
267.5s 2620 Corrected dt: 2.571871e-01 s
267.5s 2621 Correction factor: 1.6x
267.5s 2622 Max wave speed detected: 19.44 m/s
267.6s 2623 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
268.1s 2624 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
268.4s 2625 [WARNING] Automatic CFL correction applied (count: 14800):
268.4s 2626 Calculated CFL: 0.800 > Limit: 0.500
268.4s 2627 Original dt: 4.114981e-01 s
268.4s 2628 Corrected dt: 2.571863e-01 s
268.4s 2629 Correction factor: 1.6x
268.4s 2630 Max wave speed detected: 19.44 m/s
268.5s 2631 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
269.0s 2632 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
269.1s 2633 Stored output at t = 120.0000 s (Step 465)
269.1s 2634 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
269.1s 2635 [A
269.1s 2636 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 23.66s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 23.66s/s]
269.1s 2637 
269.1s 2638 Simulation finished at t = 120.0000 s after 465 steps.
269.1s 2639 Total runtime: 2.54 seconds.
269.1s 2640 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
269.1s 2641 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
269.1s 2642 Using device: gpu
269.1s 2643 DEBUG PARAMS: Reading K_m_kmh = 10.0
269.1s 2644 DEBUG PARAMS: Reading K_c_kmh = 15.0
269.1s 2645 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
269.1s 2646 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
269.1s 2647 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
269.1s 2648 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
269.1s 2649 Loading road quality type: uniform
269.1s 2650 Uniform road quality value: 2
269.1s 2651 Road quality loaded.
269.1s 2652 Initial state created.
269.1s 2653 Transferring initial state and road quality to GPU...
269.1s 2654 GPU data transfer complete.
269.1s 2655 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
269.1s 2656 Initial boundary conditions applied.
269.1s 2657 [BC UPDATE] left → phase 0 RED (reduced inflow)
269.1s 2658 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
269.1s 2659 [BC UPDATE] left → phase 1 GREEN (normal inflow)
269.1s 2660 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
269.1s 2661 Running simulation until t = 60.00 s, outputting every 60.00 s
269.1s 2662 
269.3s 2663 [WARNING] Automatic CFL correction applied (count: 14900):
269.3s 2664 Calculated CFL: 0.800 > Limit: 0.500
269.3s 2665 Original dt: 4.295974e-01 s
269.3s 2666 Corrected dt: 2.684983e-01 s
269.3s 2667 Correction factor: 1.6x
269.3s 2668 Max wave speed detected: 18.62 m/s
269.6s 2669 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
270.0s 2670 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
270.2s 2671 [WARNING] Automatic CFL correction applied (count: 15000):
270.2s 2672 Calculated CFL: 0.800 > Limit: 0.500
270.2s 2673 Original dt: 4.127253e-01 s
270.2s 2674 Corrected dt: 2.579533e-01 s
270.2s 2675 Correction factor: 1.6x
270.2s 2676 Max wave speed detected: 19.38 m/s
270.5s 2677 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
271.0s 2678 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
271.2s 2679 [WARNING] Automatic CFL correction applied (count: 15100):
271.2s 2680 Calculated CFL: 0.800 > Limit: 0.500
271.2s 2681 Original dt: 4.115153e-01 s
271.2s 2682 Corrected dt: 2.571971e-01 s
271.2s 2683 Correction factor: 1.6x
271.2s 2684 Max wave speed detected: 19.44 m/s
271.3s 2685 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
271.3s 2686 [A
271.3s 2687 Stored output at t = 60.0000 s (Step 231)
271.3s 2688 
271.3s 2689 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.32s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.31s/s]
271.3s 2690 Simulation finished at t = 60.0000 s after 231 steps.
271.3s 2691 Total runtime: 2.12 seconds.
271.3s 2692 [BC UPDATE] left → phase 0 RED (reduced inflow)
271.3s 2693 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
271.3s 2694 Running simulation until t = 120.00 s, outputting every 60.00 s
271.3s 2695 
271.4s 2696 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
271.9s 2697 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
272.1s 2698 [WARNING] Automatic CFL correction applied (count: 15200):
272.1s 2699 Calculated CFL: 0.800 > Limit: 0.500
272.1s 2700 Original dt: 4.114984e-01 s
272.1s 2701 Corrected dt: 2.571865e-01 s
272.1s 2702 Correction factor: 1.6x
272.1s 2703 Max wave speed detected: 19.44 m/s
272.4s 2704 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
272.8s 2705 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
273.0s 2706 [WARNING] Automatic CFL correction applied (count: 15300):
273.0s 2707 Calculated CFL: 0.800 > Limit: 0.500
273.0s 2708 Original dt: 4.114980e-01 s
273.0s 2709 Corrected dt: 2.571863e-01 s
273.0s 2710 Correction factor: 1.6x
273.0s 2711 Max wave speed detected: 19.44 m/s
273.3s 2712 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
273.4s 2713 Stored output at t = 120.0000 s (Step 465)
273.4s 2714 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
273.4s 2715 [A
273.4s 2716 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.04s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.04s/s]
273.4s 2717 
273.4s 2718 Simulation finished at t = 120.0000 s after 465 steps.
273.4s 2719 Total runtime: 2.14 seconds.
273.4s 2720 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
273.4s 2721 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
273.4s 2722 Using device: gpu
273.4s 2723 DEBUG PARAMS: Reading K_m_kmh = 10.0
273.4s 2724 DEBUG PARAMS: Reading K_c_kmh = 15.0
273.4s 2725 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
273.4s 2726 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
273.4s 2727 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
273.4s 2728 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
273.4s 2729 Loading road quality type: uniform
273.4s 2730 Uniform road quality value: 2
273.4s 2731 Road quality loaded.
273.4s 2732 Initial state created.
273.4s 2733 Transferring initial state and road quality to GPU...
273.4s 2734 GPU data transfer complete.
273.4s 2735 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
273.4s 2736 Initial boundary conditions applied.
273.4s 2737 [BC UPDATE] left → phase 0 RED (reduced inflow)
273.4s 2738 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
273.4s 2739 [BC UPDATE] left → phase 0 RED (reduced inflow)
273.4s 2740 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
273.4s 2741 Running simulation until t = 60.00 s, outputting every 60.00 s
273.4s 2742 
273.9s 2743 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
273.9s 2744 [WARNING] Automatic CFL correction applied (count: 15400):
273.9s 2745 Calculated CFL: 0.800 > Limit: 0.500
273.9s 2746 Original dt: 4.346596e-01 s
273.9s 2747 Corrected dt: 2.716622e-01 s
273.9s 2748 Correction factor: 1.6x
273.9s 2749 Max wave speed detected: 18.41 m/s
274.3s 2750 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
274.8s 2751 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
274.8s 2752 [WARNING] Automatic CFL correction applied (count: 15500):
274.8s 2753 Calculated CFL: 0.800 > Limit: 0.500
274.8s 2754 Original dt: 4.117853e-01 s
274.8s 2755 Corrected dt: 2.573658e-01 s
274.8s 2756 Correction factor: 1.6x
274.8s 2757 Max wave speed detected: 19.43 m/s
275.2s 2758 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
275.5s 2759 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
275.5s 2760 [A
275.5s 2761 Stored output at t = 60.0000 s (Step 231)
275.5s 2762 
275.5s 2763 Simulation finished at t = 60.0000 s after 231 steps.
275.5s 2764 Total runtime: 2.11 seconds.
275.5s 2765 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.51s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.50s/s]
275.5s 2766 [BC UPDATE] left → phase 1 GREEN (normal inflow)
275.5s 2767 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
275.5s 2768 Running simulation until t = 120.00 s, outputting every 60.00 s
275.5s 2769 
275.7s 2770 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
275.7s 2771 [WARNING] Automatic CFL correction applied (count: 15600):
275.7s 2772 Calculated CFL: 0.800 > Limit: 0.500
275.7s 2773 Original dt: 4.115023e-01 s
275.7s 2774 Corrected dt: 2.571890e-01 s
275.7s 2775 Correction factor: 1.6x
275.7s 2776 Max wave speed detected: 19.44 m/s
276.2s 2777 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
276.6s 2778 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
276.7s 2779 [WARNING] Automatic CFL correction applied (count: 15700):
276.7s 2780 Calculated CFL: 0.800 > Limit: 0.500
276.7s 2781 Original dt: 4.114981e-01 s
276.7s 2782 Corrected dt: 2.571863e-01 s
276.7s 2783 Correction factor: 1.6x
276.7s 2784 Max wave speed detected: 19.44 m/s
277.1s 2785 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
277.5s 2786 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
277.6s 2787 [WARNING] Automatic CFL correction applied (count: 15800):
277.6s 2788 Calculated CFL: 0.800 > Limit: 0.500
277.6s 2789 Original dt: 4.114980e-01 s
277.6s 2790 Corrected dt: 2.571863e-01 s
277.6s 2791 Correction factor: 1.6x
277.6s 2792 Max wave speed detected: 19.44 m/s
277.7s 2793 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
277.7s 2794 [A
277.7s 2795 Stored output at t = 120.0000 s (Step 465)
277.7s 2796 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.89s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.89s/s]
277.7s 2797 
277.7s 2798 Simulation finished at t = 120.0000 s after 465 steps.
277.7s 2799 Total runtime: 2.15 seconds.
277.7s 2800 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
277.7s 2801 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
277.7s 2802 Using device: gpu
277.7s 2803 DEBUG PARAMS: Reading K_m_kmh = 10.0
277.7s 2804 DEBUG PARAMS: Reading K_c_kmh = 15.0
277.7s 2805 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
277.7s 2806 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
277.7s 2807 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
277.7s 2808 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
277.7s 2809 Loading road quality type: uniform
277.7s 2810 Uniform road quality value: 2
277.7s 2811 Road quality loaded.
277.7s 2812 Initial state created.
277.7s 2813 Transferring initial state and road quality to GPU...
277.7s 2814 GPU data transfer complete.
277.7s 2815 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
277.7s 2816 Initial boundary conditions applied.
277.7s 2817 [BC UPDATE] left → phase 0 RED (reduced inflow)
277.7s 2818 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
277.7s 2819 [BC UPDATE] left → phase 0 RED (reduced inflow)
277.7s 2820 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
277.7s 2821 Running simulation until t = 60.00 s, outputting every 60.00 s
277.7s 2822 
278.1s 2823 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
278.5s 2824 [WARNING] Automatic CFL correction applied (count: 15900):
278.5s 2825 Calculated CFL: 0.800 > Limit: 0.500
278.5s 2826 Original dt: 4.160552e-01 s
278.5s 2827 Corrected dt: 2.600345e-01 s
278.5s 2828 Correction factor: 1.6x
278.5s 2829 Max wave speed detected: 19.23 m/s
278.6s 2830 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
279.1s 2831 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
279.4s 2832 [WARNING] Automatic CFL correction applied (count: 16000):
279.4s 2833 Calculated CFL: 0.800 > Limit: 0.500
279.4s 2834 Original dt: 4.115592e-01 s
279.4s 2835 Corrected dt: 2.572245e-01 s
279.4s 2836 Correction factor: 1.6x
279.4s 2837 Max wave speed detected: 19.44 m/s
279.5s 2838 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
279.8s 2839 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
279.8s 2840 [A
279.8s 2841 Stored output at t = 60.0000 s (Step 231)
279.8s 2842 
279.8s 2843 Simulation finished at t = 60.0000 s after 231 steps.
279.8s 2844 Total runtime: 2.11 seconds.
279.8s 2845 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.37s/s]
279.8s 2846 [BC UPDATE] left → phase 0 RED (reduced inflow)
279.8s 2847 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
279.8s 2848 Running simulation until t = 120.00 s, outputting every 60.00 s
279.8s 2849 
280.0s 2850 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
280.4s 2851 [WARNING] Automatic CFL correction applied (count: 16100):
280.4s 2852 Calculated CFL: 0.800 > Limit: 0.500
280.4s 2853 Original dt: 4.114991e-01 s
280.4s 2854 Corrected dt: 2.571870e-01 s
280.4s 2855 Correction factor: 1.6x
280.4s 2856 Max wave speed detected: 19.44 m/s
280.5s 2857 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
280.9s 2858 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
281.3s 2859 [WARNING] Automatic CFL correction applied (count: 16200):
281.3s 2860 Calculated CFL: 0.800 > Limit: 0.500
281.3s 2861 Original dt: 4.114980e-01 s
281.3s 2862 Corrected dt: 2.571863e-01 s
281.3s 2863 Correction factor: 1.6x
281.3s 2864 Max wave speed detected: 19.44 m/s
281.4s 2865 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
281.9s 2866 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
282.0s 2867 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
282.0s 2868 Stored output at t = 120.0000 s (Step 465)
282.0s 2869 [A
282.0s 2870 
282.0s 2871 Simulation finished at t = 120.0000 s after 465 steps.
282.0s 2872 Total runtime: 2.18 seconds.
282.0s 2873 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.53s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.53s/s]
282.0s 2874 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
282.0s 2875 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
282.0s 2876 Using device: gpu
282.0s 2877 DEBUG PARAMS: Reading K_m_kmh = 10.0
282.0s 2878 DEBUG PARAMS: Reading K_c_kmh = 15.0
282.0s 2879 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
282.0s 2880 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
282.0s 2881 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
282.0s 2882 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
282.0s 2883 Loading road quality type: uniform
282.0s 2884 Uniform road quality value: 2
282.0s 2885 Road quality loaded.
282.0s 2886 Initial state created.
282.0s 2887 Transferring initial state and road quality to GPU...
282.0s 2888 GPU data transfer complete.
282.0s 2889 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
282.0s 2890 Initial boundary conditions applied.
282.0s 2891 [BC UPDATE] left → phase 0 RED (reduced inflow)
282.0s 2892 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
282.0s 2893 [BC UPDATE] left → phase 0 RED (reduced inflow)
282.0s 2894 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
282.0s 2895 Running simulation until t = 60.00 s, outputting every 60.00 s
282.0s 2896 
282.2s 2897 [WARNING] Automatic CFL correction applied (count: 16300):
282.2s 2898 Calculated CFL: 0.800 > Limit: 0.500
282.2s 2899 Original dt: 4.547467e-01 s
282.2s 2900 Corrected dt: 2.842167e-01 s
282.2s 2901 Correction factor: 1.6x
282.2s 2902 Max wave speed detected: 17.59 m/s
282.5s 2903 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
282.9s 2904 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
283.1s 2905 [WARNING] Automatic CFL correction applied (count: 16400):
283.1s 2906 Calculated CFL: 0.800 > Limit: 0.500
283.1s 2907 Original dt: 4.125079e-01 s
283.1s 2908 Corrected dt: 2.578175e-01 s
283.1s 2909 Correction factor: 1.6x
283.1s 2910 Max wave speed detected: 19.39 m/s
283.4s 2911 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
283.8s 2912 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
284.1s 2913 [WARNING] Automatic CFL correction applied (count: 16500):
284.1s 2914 Calculated CFL: 0.800 > Limit: 0.500
284.1s 2915 Original dt: 4.115121e-01 s
284.1s 2916 Corrected dt: 2.571950e-01 s
284.1s 2917 Correction factor: 1.6x
284.1s 2918 Max wave speed detected: 19.44 m/s
284.1s 2919 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
284.1s 2920 Stored output at t = 60.0000 s (Step 231)
284.1s 2921 [A
284.1s 2922 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.33s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.32s/s]
284.1s 2923 
284.1s 2924 Simulation finished at t = 60.0000 s after 231 steps.
284.1s 2925 Total runtime: 2.12 seconds.
284.1s 2926 [BC UPDATE] left → phase 0 RED (reduced inflow)
284.1s 2927 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
284.1s 2928 Running simulation until t = 120.00 s, outputting every 60.00 s
284.1s 2929 
284.3s 2930 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
284.8s 2931 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
285.0s 2932 [WARNING] Automatic CFL correction applied (count: 16600):
285.0s 2933 Calculated CFL: 0.800 > Limit: 0.500
285.0s 2934 Original dt: 4.114983e-01 s
285.0s 2935 Corrected dt: 2.571865e-01 s
285.0s 2936 Correction factor: 1.6x
285.0s 2937 Max wave speed detected: 19.44 m/s
285.2s 2938 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
285.7s 2939 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
285.9s 2940 [WARNING] Automatic CFL correction applied (count: 16700):
285.9s 2941 Calculated CFL: 0.800 > Limit: 0.500
285.9s 2942 Original dt: 4.114980e-01 s
285.9s 2943 Corrected dt: 2.571863e-01 s
285.9s 2944 Correction factor: 1.6x
285.9s 2945 Max wave speed detected: 19.44 m/s
286.1s 2946 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
286.3s 2947 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
286.3s 2948 [A
286.3s 2949 Stored output at t = 120.0000 s (Step 465)
286.3s 2950 
286.3s 2951 Simulation finished at t = 120.0000 s after 465 steps.
286.3s 2952 Total runtime: 2.15 seconds.
286.3s 2953 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.87s/s]
286.3s 2954 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
286.3s 2955 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
286.3s 2956 Using device: gpu
286.3s 2957 DEBUG PARAMS: Reading K_m_kmh = 10.0
286.3s 2958 DEBUG PARAMS: Reading K_c_kmh = 15.0
286.3s 2959 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
286.3s 2960 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
286.3s 2961 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
286.3s 2962 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
286.3s 2963 Loading road quality type: uniform
286.3s 2964 Uniform road quality value: 2
286.3s 2965 Road quality loaded.
286.3s 2966 Initial state created.
286.3s 2967 Transferring initial state and road quality to GPU...
286.3s 2968 GPU data transfer complete.
286.3s 2969 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
286.3s 2970 Initial boundary conditions applied.
286.3s 2971 [BC UPDATE] left → phase 0 RED (reduced inflow)
286.3s 2972 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
286.3s 2973 [BC UPDATE] left → phase 0 RED (reduced inflow)
286.3s 2974 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
286.3s 2975 Running simulation until t = 60.00 s, outputting every 60.00 s
286.3s 2976 
286.8s 2977 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
286.8s 2978 [WARNING] Automatic CFL correction applied (count: 16800):
286.8s 2979 Calculated CFL: 0.800 > Limit: 0.500
286.8s 2980 Original dt: 4.295897e-01 s
286.8s 2981 Corrected dt: 2.684936e-01 s
286.8s 2982 Correction factor: 1.6x
286.8s 2983 Max wave speed detected: 18.62 m/s
287.2s 2984 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
287.7s 2985 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
287.8s 2986 [WARNING] Automatic CFL correction applied (count: 16900):
287.8s 2987 Calculated CFL: 0.800 > Limit: 0.500
287.8s 2988 Original dt: 4.117215e-01 s
287.8s 2989 Corrected dt: 2.573259e-01 s
287.8s 2990 Correction factor: 1.6x
287.8s 2991 Max wave speed detected: 19.43 m/s
288.1s 2992 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
288.4s 2993 Stored output at t = 60.0000 s (Step 231)
288.4s 2994 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
288.4s 2995 [A
288.4s 2996 
288.4s 2997 Simulation finished at t = 60.0000 s after 231 steps.
288.4s 2998 Total runtime: 2.12 seconds.
288.4s 2999 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.30s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.29s/s]
288.4s 3000 [BC UPDATE] left → phase 1 GREEN (normal inflow)
288.4s 3001 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
288.4s 3002 Running simulation until t = 120.00 s, outputting every 60.00 s
288.4s 3003 
288.6s 3004 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
288.7s 3005 [WARNING] Automatic CFL correction applied (count: 17000):
288.7s 3006 Calculated CFL: 0.800 > Limit: 0.500
288.7s 3007 Original dt: 4.115016e-01 s
288.7s 3008 Corrected dt: 2.571885e-01 s
288.7s 3009 Correction factor: 1.6x
288.7s 3010 Max wave speed detected: 19.44 m/s
289.1s 3011 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
289.5s 3012 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
289.6s 3013 [WARNING] Automatic CFL correction applied (count: 17100):
289.6s 3014 Calculated CFL: 0.800 > Limit: 0.500
289.6s 3015 Original dt: 4.114981e-01 s
289.6s 3016 Corrected dt: 2.571863e-01 s
289.6s 3017 Correction factor: 1.6x
289.6s 3018 Max wave speed detected: 19.44 m/s
290.0s 3019 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
290.4s 3020 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
290.5s 3021 [WARNING] Automatic CFL correction applied (count: 17200):
290.5s 3022 Calculated CFL: 0.800 > Limit: 0.500
290.5s 3023 Original dt: 4.114980e-01 s
290.5s 3024 Corrected dt: 2.571863e-01 s
290.5s 3025 Correction factor: 1.6x
290.5s 3026 Max wave speed detected: 19.44 m/s
290.6s 3027 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
290.6s 3028 Stored output at t = 120.0000 s (Step 465)
290.6s 3029 [A
290.6s 3030 
290.6s 3031 Simulation finished at t = 120.0000 s after 465 steps.
290.6s 3032 Total runtime: 2.17 seconds.
290.6s 3033 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.62s/s]
290.6s 3034 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
290.6s 3035 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
290.6s 3036 Using device: gpu
290.6s 3037 DEBUG PARAMS: Reading K_m_kmh = 10.0
290.6s 3038 DEBUG PARAMS: Reading K_c_kmh = 15.0
290.6s 3039 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
290.6s 3040 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
290.6s 3041 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
290.6s 3042 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
290.6s 3043 Loading road quality type: uniform
290.6s 3044 Uniform road quality value: 2
290.6s 3045 Road quality loaded.
290.6s 3046 Initial state created.
290.6s 3047 Transferring initial state and road quality to GPU...
290.6s 3048 GPU data transfer complete.
290.6s 3049 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
290.6s 3050 Initial boundary conditions applied.
290.6s 3051 [BC UPDATE] left → phase 0 RED (reduced inflow)
290.6s 3052 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
290.6s 3053 [BC UPDATE] left → phase 1 GREEN (normal inflow)
290.6s 3054 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
290.6s 3055 Running simulation until t = 60.00 s, outputting every 60.00 s
290.6s 3056 
291.1s 3057 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
291.5s 3058 [WARNING] Automatic CFL correction applied (count: 17300):
291.5s 3059 Calculated CFL: 0.800 > Limit: 0.500
291.5s 3060 Original dt: 4.151534e-01 s
291.5s 3061 Corrected dt: 2.594709e-01 s
291.5s 3062 Correction factor: 1.6x
291.5s 3063 Max wave speed detected: 19.27 m/s
291.6s 3064 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
292.0s 3065 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
292.4s 3066 [WARNING] Automatic CFL correction applied (count: 17400):
292.4s 3067 Calculated CFL: 0.800 > Limit: 0.500
292.4s 3068 Original dt: 4.115470e-01 s
292.4s 3069 Corrected dt: 2.572169e-01 s
292.4s 3070 Correction factor: 1.6x
292.4s 3071 Max wave speed detected: 19.44 m/s
292.5s 3072 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
292.8s 3073 Stored output at t = 60.0000 s (Step 231)
292.8s 3074 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
292.8s 3075 [A
292.8s 3076 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.63s/s]
292.8s 3077 
292.8s 3078 Simulation finished at t = 60.0000 s after 231 steps.
292.8s 3079 Total runtime: 2.17 seconds.
292.8s 3080 [BC UPDATE] left → phase 0 RED (reduced inflow)
292.8s 3081 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
292.8s 3082 Running simulation until t = 120.00 s, outputting every 60.00 s
292.8s 3083 
293.0s 3084 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
293.4s 3085 [WARNING] Automatic CFL correction applied (count: 17500):
293.4s 3086 Calculated CFL: 0.800 > Limit: 0.500
293.4s 3087 Original dt: 4.114990e-01 s
293.4s 3088 Corrected dt: 2.571869e-01 s
293.4s 3089 Correction factor: 1.6x
293.4s 3090 Max wave speed detected: 19.44 m/s
293.4s 3091 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
293.9s 3092 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
294.3s 3093 [WARNING] Automatic CFL correction applied (count: 17600):
294.3s 3094 Calculated CFL: 0.800 > Limit: 0.500
294.3s 3095 Original dt: 4.114980e-01 s
294.3s 3096 Corrected dt: 2.571863e-01 s
294.3s 3097 Correction factor: 1.6x
294.3s 3098 Max wave speed detected: 19.44 m/s
294.4s 3099 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
294.8s 3100 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
295.0s 3101 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
295.0s 3102 [A
295.0s 3103 Stored output at t = 120.0000 s (Step 465)
295.0s 3104 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.41s/s]
295.0s 3105 
295.0s 3106 Simulation finished at t = 120.0000 s after 465 steps.
295.0s 3107 Total runtime: 2.19 seconds.
295.0s 3108 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
295.0s 3109 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
295.0s 3110 Using device: gpu
295.0s 3111 DEBUG PARAMS: Reading K_m_kmh = 10.0
295.0s 3112 DEBUG PARAMS: Reading K_c_kmh = 15.0
295.0s 3113 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
295.0s 3114 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
295.0s 3115 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
295.0s 3116 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
295.0s 3117 Loading road quality type: uniform
295.0s 3118 Uniform road quality value: 2
295.0s 3119 Road quality loaded.
295.0s 3120 Initial state created.
295.0s 3121 Transferring initial state and road quality to GPU...
295.0s 3122 GPU data transfer complete.
295.0s 3123 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
295.0s 3124 Initial boundary conditions applied.
295.0s 3125 [BC UPDATE] left → phase 0 RED (reduced inflow)
295.0s 3126 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
295.0s 3127 [BC UPDATE] left → phase 0 RED (reduced inflow)
295.0s 3128 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
295.0s 3129 Running simulation until t = 60.00 s, outputting every 60.00 s
295.0s 3130 
295.3s 3131 [WARNING] Automatic CFL correction applied (count: 17700):
295.3s 3132 Calculated CFL: 0.800 > Limit: 0.500
295.3s 3133 Original dt: 4.768783e-01 s
295.3s 3134 Corrected dt: 2.980490e-01 s
295.3s 3135 Correction factor: 1.6x
295.3s 3136 Max wave speed detected: 16.78 m/s
295.5s 3137 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
295.9s 3138 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
296.2s 3139 [WARNING] Automatic CFL correction applied (count: 17800):
296.2s 3140 Calculated CFL: 0.800 > Limit: 0.500
296.2s 3141 Original dt: 4.123385e-01 s
296.2s 3142 Corrected dt: 2.577116e-01 s
296.2s 3143 Correction factor: 1.6x
296.2s 3144 Max wave speed detected: 19.40 m/s
296.4s 3145 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
296.8s 3146 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
297.1s 3147 [WARNING] Automatic CFL correction applied (count: 17900):
297.1s 3148 Calculated CFL: 0.800 > Limit: 0.500
297.1s 3149 Original dt: 4.115097e-01 s
297.1s 3150 Corrected dt: 2.571935e-01 s
297.1s 3151 Correction factor: 1.6x
297.1s 3152 Max wave speed detected: 19.44 m/s
297.1s 3153 Stored output at t = 60.0000 s (Step 231)
297.1s 3154 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
297.1s 3155 [A
297.1s 3156 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.23s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.23s/s]
297.1s 3157 
297.1s 3158 Simulation finished at t = 60.0000 s after 231 steps.
297.1s 3159 Total runtime: 2.13 seconds.
297.1s 3160 [BC UPDATE] left → phase 0 RED (reduced inflow)
297.1s 3161 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
297.1s 3162 Running simulation until t = 120.00 s, outputting every 60.00 s
297.1s 3163 
297.3s 3164 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
297.8s 3165 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
298.0s 3166 [WARNING] Automatic CFL correction applied (count: 18000):
298.0s 3167 Calculated CFL: 0.800 > Limit: 0.500
298.0s 3168 Original dt: 4.114983e-01 s
298.0s 3169 Corrected dt: 2.571864e-01 s
298.0s 3170 Correction factor: 1.6x
298.0s 3171 Max wave speed detected: 19.44 m/s
298.2s 3172 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
298.7s 3173 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
298.9s 3174 [WARNING] Automatic CFL correction applied (count: 18100):
298.9s 3175 Calculated CFL: 0.800 > Limit: 0.500
298.9s 3176 Original dt: 4.114980e-01 s
298.9s 3177 Corrected dt: 2.571863e-01 s
298.9s 3178 Correction factor: 1.6x
298.9s 3179 Max wave speed detected: 19.44 m/s
299.1s 3180 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
299.3s 3181 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
299.3s 3182 [A
299.3s 3183 Stored output at t = 120.0000 s (Step 465)
299.3s 3184 
299.3s 3185 Simulation finished at t = 120.0000 s after 465 steps.
299.3s 3186 Total runtime: 2.15 seconds.
299.3s 3187 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.97s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.97s/s]
299.3s 3188 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
299.3s 3189 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
299.3s 3190 Using device: gpu
299.3s 3191 DEBUG PARAMS: Reading K_m_kmh = 10.0
299.3s 3192 DEBUG PARAMS: Reading K_c_kmh = 15.0
299.3s 3193 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
299.3s 3194 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
299.3s 3195 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
299.3s 3196 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
299.3s 3197 Loading road quality type: uniform
299.3s 3198 Uniform road quality value: 2
299.3s 3199 Road quality loaded.
299.3s 3200 Initial state created.
299.3s 3201 Transferring initial state and road quality to GPU...
299.3s 3202 GPU data transfer complete.
299.3s 3203 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
299.3s 3204 Initial boundary conditions applied.
299.3s 3205 [BC UPDATE] left → phase 0 RED (reduced inflow)
299.3s 3206 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
299.3s 3207 [BC UPDATE] left → phase 0 RED (reduced inflow)
299.3s 3208 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
299.3s 3209 Running simulation until t = 60.00 s, outputting every 60.00 s
299.3s 3210 
299.7s 3211 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
299.9s 3212 [WARNING] Automatic CFL correction applied (count: 18200):
299.9s 3213 Calculated CFL: 0.800 > Limit: 0.500
299.9s 3214 Original dt: 4.254608e-01 s
299.9s 3215 Corrected dt: 2.659130e-01 s
299.9s 3216 Correction factor: 1.6x
299.9s 3217 Max wave speed detected: 18.80 m/s
300.2s 3218 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
300.7s 3219 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
300.8s 3220 [WARNING] Automatic CFL correction applied (count: 18300):
300.8s 3221 Calculated CFL: 0.800 > Limit: 0.500
300.8s 3222 Original dt: 4.116742e-01 s
300.8s 3223 Corrected dt: 2.572964e-01 s
300.8s 3224 Correction factor: 1.6x
300.8s 3225 Max wave speed detected: 19.43 m/s
301.2s 3226 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
301.4s 3227 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
301.4s 3228 [A
301.4s 3229 Stored output at t = 60.0000 s (Step 231)
301.4s 3230 
301.4s 3231 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.72s/s]
301.4s 3232 Simulation finished at t = 60.0000 s after 231 steps.
301.4s 3233 Total runtime: 2.17 seconds.
301.4s 3234 [BC UPDATE] left → phase 0 RED (reduced inflow)
301.4s 3235 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
301.4s 3236 Running simulation until t = 120.00 s, outputting every 60.00 s
301.4s 3237 
301.6s 3238 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
301.7s 3239 [WARNING] Automatic CFL correction applied (count: 18400):
301.7s 3240 Calculated CFL: 0.800 > Limit: 0.500
301.7s 3241 Original dt: 4.115011e-01 s
301.7s 3242 Corrected dt: 2.571882e-01 s
301.7s 3243 Correction factor: 1.6x
301.7s 3244 Max wave speed detected: 19.44 m/s
302.1s 3245 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
302.5s 3246 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
302.6s 3247 [WARNING] Automatic CFL correction applied (count: 18500):
302.6s 3248 Calculated CFL: 0.800 > Limit: 0.500
302.6s 3249 Original dt: 4.114981e-01 s
302.6s 3250 Corrected dt: 2.571863e-01 s
302.6s 3251 Correction factor: 1.6x
302.6s 3252 Max wave speed detected: 19.44 m/s
303.0s 3253 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
303.4s 3254 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
303.6s 3255 [WARNING] Automatic CFL correction applied (count: 18600):
303.6s 3256 Calculated CFL: 0.800 > Limit: 0.500
303.6s 3257 Original dt: 4.114980e-01 s
303.6s 3258 Corrected dt: 2.571863e-01 s
303.6s 3259 Correction factor: 1.6x
303.6s 3260 Max wave speed detected: 19.44 m/s
303.6s 3261 Stored output at t = 120.0000 s (Step 465)
303.6s 3262 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
303.6s 3263 [A
303.6s 3264 
303.6s 3265 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.13s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.13s/s]
303.6s 3266 Simulation finished at t = 120.0000 s after 465 steps.
303.6s 3267 Total runtime: 2.13 seconds.
303.6s 3268 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
303.6s 3269 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
303.6s 3270 Using device: gpu
303.6s 3271 DEBUG PARAMS: Reading K_m_kmh = 10.0
303.6s 3272 DEBUG PARAMS: Reading K_c_kmh = 15.0
303.6s 3273 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
303.6s 3274 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
303.6s 3275 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
303.6s 3276 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
303.6s 3277 Loading road quality type: uniform
303.6s 3278 Uniform road quality value: 2
303.6s 3279 Road quality loaded.
303.6s 3280 Initial state created.
303.6s 3281 Transferring initial state and road quality to GPU...
303.6s 3282 GPU data transfer complete.
303.6s 3283 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
303.6s 3284 Initial boundary conditions applied.
303.6s 3285 [BC UPDATE] left → phase 0 RED (reduced inflow)
303.6s 3286 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
303.6s 3287 [BC UPDATE] left → phase 0 RED (reduced inflow)
303.6s 3288 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
303.6s 3289 Running simulation until t = 60.00 s, outputting every 60.00 s
303.6s 3290 
304.1s 3291 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
304.5s 3292 [WARNING] Automatic CFL correction applied (count: 18700):
304.5s 3293 Calculated CFL: 0.800 > Limit: 0.500
304.5s 3294 Original dt: 4.145004e-01 s
304.5s 3295 Corrected dt: 2.590627e-01 s
304.5s 3296 Correction factor: 1.6x
304.5s 3297 Max wave speed detected: 19.30 m/s
304.5s 3298 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
305.0s 3299 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
305.4s 3300 [WARNING] Automatic CFL correction applied (count: 18800):
305.4s 3301 Calculated CFL: 0.800 > Limit: 0.500
305.4s 3302 Original dt: 4.115380e-01 s
305.4s 3303 Corrected dt: 2.572113e-01 s
305.4s 3304 Correction factor: 1.6x
305.4s 3305 Max wave speed detected: 19.44 m/s
305.4s 3306 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
305.7s 3307 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
305.7s 3308 [A
305.7s 3309 Stored output at t = 60.0000 s (Step 231)
305.7s 3310 
305.7s 3311 Simulation finished at t = 60.0000 s after 231 steps.
305.7s 3312 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.34s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.34s/s]
305.7s 3313 Total runtime: 2.12 seconds.
305.7s 3314 [BC UPDATE] left → phase 0 RED (reduced inflow)
305.7s 3315 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
305.7s 3316 Running simulation until t = 120.00 s, outputting every 60.00 s
305.7s 3317 
305.9s 3318 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
306.3s 3319 [WARNING] Automatic CFL correction applied (count: 18900):
306.3s 3320 Calculated CFL: 0.800 > Limit: 0.500
306.3s 3321 Original dt: 4.114988e-01 s
306.3s 3322 Corrected dt: 2.571867e-01 s
306.3s 3323 Correction factor: 1.6x
306.3s 3324 Max wave speed detected: 19.44 m/s
306.3s 3325 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
306.8s 3326 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
307.2s 3327 [WARNING] Automatic CFL correction applied (count: 19000):
307.2s 3328 Calculated CFL: 0.800 > Limit: 0.500
307.2s 3329 Original dt: 4.114980e-01 s
307.2s 3330 Corrected dt: 2.571863e-01 s
307.2s 3331 Correction factor: 1.6x
307.2s 3332 Max wave speed detected: 19.44 m/s
307.3s 3333 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
307.7s 3334 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
307.8s 3335 Stored output at t = 120.0000 s (Step 465)
307.8s 3336 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
307.8s 3337 [A
307.8s 3338 
307.8s 3339 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.27s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.27s/s]
307.8s 3340 Simulation finished at t = 120.0000 s after 465 steps.
307.8s 3341 Total runtime: 2.12 seconds.
307.8s 3342 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
307.8s 3343 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
307.8s 3344 Using device: gpu
307.8s 3345 DEBUG PARAMS: Reading K_m_kmh = 10.0
307.8s 3346 DEBUG PARAMS: Reading K_c_kmh = 15.0
307.8s 3347 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
307.8s 3348 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
307.8s 3349 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
307.8s 3350 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
307.8s 3351 Loading road quality type: uniform
307.8s 3352 Uniform road quality value: 2
307.8s 3353 Road quality loaded.
307.8s 3354 Initial state created.
307.8s 3355 Transferring initial state and road quality to GPU...
307.8s 3356 GPU data transfer complete.
307.8s 3357 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
307.8s 3358 Initial boundary conditions applied.
307.8s 3359 [BC UPDATE] left → phase 0 RED (reduced inflow)
307.8s 3360 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
307.9s 3361 
307.9s 3362 [BC UPDATE] left → phase 0 RED (reduced inflow)
307.9s 3363 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
307.9s 3364 Running simulation until t = 60.00 s, outputting every 60.00 s
308.2s 3365 [WARNING] Automatic CFL correction applied (count: 19100):
308.2s 3366 Calculated CFL: 0.800 > Limit: 0.500
308.2s 3367 Original dt: 4.758816e-01 s
308.2s 3368 Corrected dt: 2.974260e-01 s
308.2s 3369 Correction factor: 1.6x
308.2s 3370 Max wave speed detected: 16.81 m/s
308.3s 3371 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
308.8s 3372 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
309.1s 3373 [WARNING] Automatic CFL correction applied (count: 19200):
309.1s 3374 Calculated CFL: 0.800 > Limit: 0.500
309.1s 3375 Original dt: 4.121510e-01 s
309.1s 3376 Corrected dt: 2.575944e-01 s
309.1s 3377 Correction factor: 1.6x
309.1s 3378 Max wave speed detected: 19.41 m/s
309.2s 3379 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
309.7s 3380 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
310.0s 3381 Stored output at t = 60.0000 s (Step 231)
310.0s 3382 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
310.0s 3383 [A
310.0s 3384 
310.0s 3385 Simulation finished at t = 60.0000 s after 231 steps.
310.0s 3386 Total runtime: 2.11 seconds.
310.0s 3387 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.39s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.38s/s]
310.0s 3388 [BC UPDATE] left → phase 0 RED (reduced inflow)
310.0s 3389 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
310.0s 3390 Running simulation until t = 120.00 s, outputting every 60.00 s
310.0s 3391 
310.0s 3392 [WARNING] Automatic CFL correction applied (count: 19300):
310.0s 3393 Calculated CFL: 0.800 > Limit: 0.500
310.0s 3394 Original dt: 4.115082e-01 s
310.0s 3395 Corrected dt: 2.571926e-01 s
310.0s 3396 Correction factor: 1.6x
310.0s 3397 Max wave speed detected: 19.44 m/s
310.2s 3398 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
310.6s 3399 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
310.9s 3400 [WARNING] Automatic CFL correction applied (count: 19400):
310.9s 3401 Calculated CFL: 0.800 > Limit: 0.500
310.9s 3402 Original dt: 4.114982e-01 s
310.9s 3403 Corrected dt: 2.571864e-01 s
310.9s 3404 Correction factor: 1.6x
310.9s 3405 Max wave speed detected: 19.44 m/s
311.1s 3406 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
311.5s 3407 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
311.9s 3408 [WARNING] Automatic CFL correction applied (count: 19500):
311.9s 3409 Calculated CFL: 0.800 > Limit: 0.500
311.9s 3410 Original dt: 4.114980e-01 s
311.9s 3411 Corrected dt: 2.571863e-01 s
311.9s 3412 Correction factor: 1.6x
311.9s 3413 Max wave speed detected: 19.44 m/s
312.0s 3414 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
312.1s 3415 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
312.1s 3416 [A
312.1s 3417 Stored output at t = 120.0000 s (Step 465)
312.1s 3418 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.67s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.67s/s]
312.1s 3419 
312.1s 3420 Simulation finished at t = 120.0000 s after 465 steps.
312.1s 3421 Total runtime: 2.17 seconds.
312.1s 3422 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
312.1s 3423 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
312.1s 3424 Using device: gpu
312.1s 3425 DEBUG PARAMS: Reading K_m_kmh = 10.0
312.1s 3426 DEBUG PARAMS: Reading K_c_kmh = 15.0
312.1s 3427 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
312.1s 3428 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
312.1s 3429 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
312.1s 3430 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
312.1s 3431 Loading road quality type: uniform
312.1s 3432 Uniform road quality value: 2
312.1s 3433 Road quality loaded.
312.1s 3434 Initial state created.
312.1s 3435 Transferring initial state and road quality to GPU...
312.1s 3436 GPU data transfer complete.
312.1s 3437 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
312.1s 3438 Initial boundary conditions applied.
312.1s 3439 [BC UPDATE] left → phase 0 RED (reduced inflow)
312.1s 3440 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
312.2s 3441 [BC UPDATE] left → phase 0 RED (reduced inflow)
312.2s 3442 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
312.2s 3443 Running simulation until t = 60.00 s, outputting every 60.00 s
312.2s 3444 
312.7s 3445 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
312.9s 3446 [WARNING] Automatic CFL correction applied (count: 19600):
312.9s 3447 Calculated CFL: 0.800 > Limit: 0.500
312.9s 3448 Original dt: 4.225636e-01 s
312.9s 3449 Corrected dt: 2.641023e-01 s
312.9s 3450 Correction factor: 1.6x
312.9s 3451 Max wave speed detected: 18.93 m/s
313.1s 3452 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
313.6s 3453 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
313.8s 3454 [WARNING] Automatic CFL correction applied (count: 19700):
313.8s 3455 Calculated CFL: 0.800 > Limit: 0.500
313.8s 3456 Original dt: 4.116395e-01 s
313.8s 3457 Corrected dt: 2.572747e-01 s
313.8s 3458 Correction factor: 1.6x
313.8s 3459 Max wave speed detected: 19.43 m/s
314.0s 3460 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
314.3s 3461 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
314.3s 3462 [A
314.3s 3463 Stored output at t = 60.0000 s (Step 231)
314.3s 3464 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 27.67s/s]
314.3s 3465 
314.3s 3466 Simulation finished at t = 60.0000 s after 231 steps.
314.3s 3467 Total runtime: 2.17 seconds.
314.3s 3468 [BC UPDATE] left → phase 0 RED (reduced inflow)
314.3s 3469 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
314.3s 3470 Running simulation until t = 120.00 s, outputting every 60.00 s
314.3s 3471 
314.5s 3472 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
314.7s 3473 [WARNING] Automatic CFL correction applied (count: 19800):
314.7s 3474 Calculated CFL: 0.800 > Limit: 0.500
314.7s 3475 Original dt: 4.115005e-01 s
314.7s 3476 Corrected dt: 2.571878e-01 s
314.7s 3477 Correction factor: 1.6x
314.7s 3478 Max wave speed detected: 19.44 m/s
314.9s 3479 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
315.4s 3480 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
315.6s 3481 [WARNING] Automatic CFL correction applied (count: 19900):
315.6s 3482 Calculated CFL: 0.800 > Limit: 0.500
315.6s 3483 Original dt: 4.114981e-01 s
315.6s 3484 Corrected dt: 2.571863e-01 s
315.6s 3485 Correction factor: 1.6x
315.6s 3486 Max wave speed detected: 19.44 m/s
315.9s 3487 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
316.3s 3488 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
316.5s 3489 Stored output at t = 120.0000 s (Step 465)
316.5s 3490 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
316.5s 3491 [A
316.5s 3492 
316.5s 3493 Simulation finished at t = 120.0000 s after 465 steps.
316.5s 3494 Total runtime: 2.14 seconds.
316.5s 3495 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.08s/s]
316.5s 3496 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
316.5s 3497 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
316.5s 3498 Using device: gpu
316.5s 3499 DEBUG PARAMS: Reading K_m_kmh = 10.0
316.5s 3500 DEBUG PARAMS: Reading K_c_kmh = 15.0
316.5s 3501 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
316.5s 3502 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
316.5s 3503 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
316.5s 3504 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
316.5s 3505 Loading road quality type: uniform
316.5s 3506 Uniform road quality value: 2
316.5s 3507 Road quality loaded.
316.5s 3508 Initial state created.
316.5s 3509 Transferring initial state and road quality to GPU...
316.5s 3510 GPU data transfer complete.
316.5s 3511 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
316.5s 3512 Initial boundary conditions applied.
316.5s 3513 [BC UPDATE] left → phase 0 RED (reduced inflow)
316.5s 3514 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
316.5s 3515 [BC UPDATE] left → phase 1 GREEN (normal inflow)
316.5s 3516 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
316.5s 3517 Running simulation until t = 60.00 s, outputting every 60.00 s
316.5s 3518 
316.5s 3519 [WARNING] Automatic CFL correction applied (count: 20000):
316.5s 3520 Calculated CFL: 0.800 > Limit: 0.500
316.5s 3521 Original dt: 3.451280e-01 s
316.5s 3522 Corrected dt: 2.157050e-01 s
316.5s 3523 Correction factor: 1.6x
316.5s 3524 Max wave speed detected: 23.18 m/s
316.9s 3525 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
317.4s 3526 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
317.4s 3527 [WARNING] Automatic CFL correction applied (count: 20100):
317.4s 3528 Calculated CFL: 0.800 > Limit: 0.500
317.4s 3529 Original dt: 4.139892e-01 s
317.4s 3530 Corrected dt: 2.587433e-01 s
317.4s 3531 Correction factor: 1.6x
317.4s 3532 Max wave speed detected: 19.32 m/s
317.8s 3533 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
318.3s 3534 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
318.3s 3535 [WARNING] Automatic CFL correction applied (count: 20200):
318.3s 3536 Calculated CFL: 0.800 > Limit: 0.500
318.3s 3537 Original dt: 4.115314e-01 s
318.3s 3538 Corrected dt: 2.572071e-01 s
318.3s 3539 Correction factor: 1.6x
318.3s 3540 Max wave speed detected: 19.44 m/s
318.6s 3541 Stored output at t = 60.0000 s (Step 231)
318.6s 3542 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
318.6s 3543 [A
318.6s 3544 
318.6s 3545 Simulation finished at t = 60.0000 s after 231 steps.
318.6s 3546 Total runtime: 2.09 seconds.
318.6s 3547 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.68s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.68s/s]
318.6s 3548 
318.6s 3549 [BC UPDATE] left → phase 1 GREEN (normal inflow)
318.6s 3550 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
318.6s 3551 Running simulation until t = 120.00 s, outputting every 60.00 s
318.7s 3552 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
319.2s 3553 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
319.2s 3554 [WARNING] Automatic CFL correction applied (count: 20300):
319.2s 3555 Calculated CFL: 0.800 > Limit: 0.500
319.2s 3556 Original dt: 4.114986e-01 s
319.2s 3557 Corrected dt: 2.571866e-01 s
319.2s 3558 Correction factor: 1.6x
319.2s 3559 Max wave speed detected: 19.44 m/s
319.7s 3560 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
320.1s 3561 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
320.1s 3562 [WARNING] Automatic CFL correction applied (count: 20400):
320.1s 3563 Calculated CFL: 0.800 > Limit: 0.500
320.1s 3564 Original dt: 4.114980e-01 s
320.1s 3565 Corrected dt: 2.571863e-01 s
320.1s 3566 Correction factor: 1.6x
320.1s 3567 Max wave speed detected: 19.44 m/s
320.6s 3568 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
320.7s 3569 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
320.7s 3570 [A
320.7s 3571 Stored output at t = 120.0000 s (Step 465)
320.7s 3572 
320.7s 3573 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.84s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.84s/s]
320.7s 3574 Simulation finished at t = 120.0000 s after 465 steps.
320.7s 3575 Total runtime: 2.16 seconds.
320.7s 3576 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
320.7s 3577 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
320.7s 3578 Using device: gpu
320.7s 3579 DEBUG PARAMS: Reading K_m_kmh = 10.0
320.7s 3580 DEBUG PARAMS: Reading K_c_kmh = 15.0
320.7s 3581 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
320.7s 3582 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
320.7s 3583 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
320.7s 3584 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
320.7s 3585 Loading road quality type: uniform
320.7s 3586 Uniform road quality value: 2
320.7s 3587 Road quality loaded.
320.7s 3588 Initial state created.
320.7s 3589 Transferring initial state and road quality to GPU...
320.7s 3590 GPU data transfer complete.
320.7s 3591 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
320.7s 3592 Initial boundary conditions applied.
320.7s 3593 [BC UPDATE] left → phase 0 RED (reduced inflow)
320.7s 3594 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
320.7s 3595 [BC UPDATE] left → phase 0 RED (reduced inflow)
320.7s 3596 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
320.7s 3597 Running simulation until t = 60.00 s, outputting every 60.00 s
320.7s 3598 
321.1s 3599 [WARNING] Automatic CFL correction applied (count: 20500):
321.1s 3600 Calculated CFL: 0.800 > Limit: 0.500
321.1s 3601 Original dt: 4.583403e-01 s
321.1s 3602 Corrected dt: 2.864627e-01 s
321.1s 3603 Correction factor: 1.6x
321.1s 3604 Max wave speed detected: 17.45 m/s
321.2s 3605 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
321.7s 3606 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
322.0s 3607 [WARNING] Automatic CFL correction applied (count: 20600):
322.0s 3608 Calculated CFL: 0.800 > Limit: 0.500
322.0s 3609 Original dt: 4.120137e-01 s
322.0s 3610 Corrected dt: 2.575085e-01 s
322.0s 3611 Correction factor: 1.6x
322.0s 3612 Max wave speed detected: 19.42 m/s
322.1s 3613 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
322.6s 3614 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
322.9s 3615 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
322.9s 3616 [A
322.9s 3617 Stored output at t = 60.0000 s (Step 231)
322.9s 3618 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.06s/s]
322.9s 3619 
322.9s 3620 Simulation finished at t = 60.0000 s after 231 steps.
322.9s 3621 Total runtime: 2.14 seconds.
322.9s 3622 [BC UPDATE] left → phase 0 RED (reduced inflow)
322.9s 3623 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
322.9s 3624 Running simulation until t = 120.00 s, outputting every 60.00 s
322.9s 3625 
323.0s 3626 [WARNING] Automatic CFL correction applied (count: 20700):
323.0s 3627 Calculated CFL: 0.800 > Limit: 0.500
323.0s 3628 Original dt: 4.115064e-01 s
323.0s 3629 Corrected dt: 2.571915e-01 s
323.0s 3630 Correction factor: 1.6x
323.0s 3631 Max wave speed detected: 19.44 m/s
323.1s 3632 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
323.5s 3633 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
323.9s 3634 [WARNING] Automatic CFL correction applied (count: 20800):
323.9s 3635 Calculated CFL: 0.800 > Limit: 0.500
323.9s 3636 Original dt: 4.114982e-01 s
323.9s 3637 Corrected dt: 2.571864e-01 s
323.9s 3638 Correction factor: 1.6x
323.9s 3639 Max wave speed detected: 19.44 m/s
324.0s 3640 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
324.4s 3641 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
324.8s 3642 [WARNING] Automatic CFL correction applied (count: 20900):
324.8s 3643 Calculated CFL: 0.800 > Limit: 0.500
324.8s 3644 Original dt: 4.114980e-01 s
324.8s 3645 Corrected dt: 2.571863e-01 s
324.8s 3646 Correction factor: 1.6x
324.8s 3647 Max wave speed detected: 19.44 m/s
324.9s 3648 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
325.0s 3649 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
325.0s 3650 [A
325.0s 3651 Stored output at t = 120.0000 s (Step 465)
325.0s 3652 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.02s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.02s/s]
325.0s 3653 
325.0s 3654 Simulation finished at t = 120.0000 s after 465 steps.
325.0s 3655 Total runtime: 2.14 seconds.
325.0s 3656 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
325.0s 3657 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
325.0s 3658 Using device: gpu
325.0s 3659 DEBUG PARAMS: Reading K_m_kmh = 10.0
325.0s 3660 DEBUG PARAMS: Reading K_c_kmh = 15.0
325.0s 3661 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
325.0s 3662 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
325.0s 3663 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
325.0s 3664 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
325.0s 3665 Loading road quality type: uniform
325.0s 3666 Uniform road quality value: 2
325.0s 3667 Road quality loaded.
325.0s 3668 Initial state created.
325.0s 3669 Transferring initial state and road quality to GPU...
325.0s 3670 GPU data transfer complete.
325.0s 3671 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
325.0s 3672 Initial boundary conditions applied.
325.0s 3673 [BC UPDATE] left → phase 0 RED (reduced inflow)
325.0s 3674 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
325.0s 3675 [BC UPDATE] left → phase 1 GREEN (normal inflow)
325.0s 3676 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
325.0s 3677 Running simulation until t = 60.00 s, outputting every 60.00 s
325.0s 3678 
325.5s 3679 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
325.7s 3680 [WARNING] Automatic CFL correction applied (count: 21000):
325.7s 3681 Calculated CFL: 0.800 > Limit: 0.500
325.7s 3682 Original dt: 4.205139e-01 s
325.7s 3683 Corrected dt: 2.628212e-01 s
325.7s 3684 Correction factor: 1.6x
325.7s 3685 Max wave speed detected: 19.02 m/s
326.0s 3686 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
326.4s 3687 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
326.6s 3688 [WARNING] Automatic CFL correction applied (count: 21100):
326.6s 3689 Calculated CFL: 0.800 > Limit: 0.500
326.6s 3690 Original dt: 4.116141e-01 s
326.6s 3691 Corrected dt: 2.572588e-01 s
326.6s 3692 Correction factor: 1.6x
326.6s 3693 Max wave speed detected: 19.44 m/s
326.9s 3694 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
327.2s 3695 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
327.2s 3696 [A
327.2s 3697 Stored output at t = 60.0000 s (Step 231)
327.2s 3698 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.45s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.45s/s]
327.2s 3699 
327.2s 3700 Simulation finished at t = 60.0000 s after 231 steps.
327.2s 3701 Total runtime: 2.11 seconds.
327.2s 3702 [BC UPDATE] left → phase 1 GREEN (normal inflow)
327.2s 3703 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
327.2s 3704 Running simulation until t = 120.00 s, outputting every 60.00 s
327.2s 3705 
327.3s 3706 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
327.5s 3707 [WARNING] Automatic CFL correction applied (count: 21200):
327.5s 3708 Calculated CFL: 0.800 > Limit: 0.500
327.5s 3709 Original dt: 4.115000e-01 s
327.5s 3710 Corrected dt: 2.571875e-01 s
327.5s 3711 Correction factor: 1.6x
327.5s 3712 Max wave speed detected: 19.44 m/s
327.8s 3713 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
328.2s 3714 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
328.4s 3715 [WARNING] Automatic CFL correction applied (count: 21300):
328.4s 3716 Calculated CFL: 0.800 > Limit: 0.500
328.4s 3717 Original dt: 4.114981e-01 s
328.4s 3718 Corrected dt: 2.571863e-01 s
328.4s 3719 Correction factor: 1.6x
328.4s 3720 Max wave speed detected: 19.44 m/s
328.7s 3721 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
329.1s 3722 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
329.3s 3723 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
329.3s 3724 [A
329.3s 3725 Stored output at t = 120.0000 s (Step 465)
329.3s 3726 
329.3s 3727 Simulation finished at t = 120.0000 s after 465 steps.
329.3s 3728 Total runtime: 2.12 seconds.
329.3s 3729 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.29s/s]
329.3s 3730 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
329.3s 3731 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
329.3s 3732 Using device: gpu
329.3s 3733 DEBUG PARAMS: Reading K_m_kmh = 10.0
329.3s 3734 DEBUG PARAMS: Reading K_c_kmh = 15.0
329.3s 3735 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
329.3s 3736 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
329.3s 3737 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
329.3s 3738 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
329.3s 3739 Loading road quality type: uniform
329.3s 3740 Uniform road quality value: 2
329.3s 3741 Road quality loaded.
329.3s 3742 Initial state created.
329.3s 3743 Transferring initial state and road quality to GPU...
329.3s 3744 GPU data transfer complete.
329.3s 3745 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
329.3s 3746 Initial boundary conditions applied.
329.3s 3747 [BC UPDATE] left → phase 0 RED (reduced inflow)
329.3s 3748 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
329.3s 3749 [BC UPDATE] left → phase 0 RED (reduced inflow)
329.3s 3750 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
329.3s 3751 Running simulation until t = 60.00 s, outputting every 60.00 s
329.3s 3752 
329.4s 3753 [WARNING] Automatic CFL correction applied (count: 21400):
329.4s 3754 Calculated CFL: 0.800 > Limit: 0.500
329.4s 3755 Original dt: 3.737254e-01 s
329.4s 3756 Corrected dt: 2.335784e-01 s
329.4s 3757 Correction factor: 1.6x
329.4s 3758 Max wave speed detected: 21.41 m/s
329.7s 3759 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
330.2s 3760 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
330.3s 3761 [WARNING] Automatic CFL correction applied (count: 21500):
330.3s 3762 Calculated CFL: 0.800 > Limit: 0.500
330.3s 3763 Original dt: 4.134305e-01 s
330.3s 3764 Corrected dt: 2.583941e-01 s
330.3s 3765 Correction factor: 1.6x
330.3s 3766 Max wave speed detected: 19.35 m/s
330.7s 3767 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
331.1s 3768 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
331.2s 3769 [WARNING] Automatic CFL correction applied (count: 21600):
331.2s 3770 Calculated CFL: 0.800 > Limit: 0.500
331.2s 3771 Original dt: 4.115259e-01 s
331.2s 3772 Corrected dt: 2.572037e-01 s
331.2s 3773 Correction factor: 1.6x
331.2s 3774 Max wave speed detected: 19.44 m/s
331.4s 3775 Stored output at t = 60.0000 s (Step 231)
331.4s 3776 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
331.4s 3777 [A
331.4s 3778 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.28s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.28s/s]
331.4s 3779 
331.4s 3780 Simulation finished at t = 60.0000 s after 231 steps.
331.4s 3781 Total runtime: 2.12 seconds.
331.4s 3782 [BC UPDATE] left → phase 1 GREEN (normal inflow)
331.4s 3783 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
331.4s 3784 Running simulation until t = 120.00 s, outputting every 60.00 s
331.4s 3785 
331.6s 3786 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
332.0s 3787 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
332.1s 3788 [WARNING] Automatic CFL correction applied (count: 21700):
332.1s 3789 Calculated CFL: 0.800 > Limit: 0.500
332.1s 3790 Original dt: 4.114985e-01 s
332.1s 3791 Corrected dt: 2.571866e-01 s
332.1s 3792 Correction factor: 1.6x
332.1s 3793 Max wave speed detected: 19.44 m/s
332.5s 3794 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
332.9s 3795 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
333.0s 3796 [WARNING] Automatic CFL correction applied (count: 21800):
333.0s 3797 Calculated CFL: 0.800 > Limit: 0.500
333.0s 3798 Original dt: 4.114980e-01 s
333.0s 3799 Corrected dt: 2.571863e-01 s
333.0s 3800 Correction factor: 1.6x
333.0s 3801 Max wave speed detected: 19.44 m/s
333.4s 3802 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
333.5s 3803 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
333.5s 3804 [A
333.5s 3805 Stored output at t = 120.0000 s (Step 465)
333.5s 3806 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.21s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.21s/s]
333.5s 3807 
333.5s 3808 Simulation finished at t = 120.0000 s after 465 steps.
333.5s 3809 Total runtime: 2.13 seconds.
333.5s 3810 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
333.5s 3811 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
333.5s 3812 Using device: gpu
333.6s 3813 DEBUG PARAMS: Reading K_m_kmh = 10.0
333.6s 3814 DEBUG PARAMS: Reading K_c_kmh = 15.0
333.6s 3815 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
333.6s 3816 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
333.6s 3817 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
333.6s 3818 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
333.6s 3819 Loading road quality type: uniform
333.6s 3820 Uniform road quality value: 2
333.6s 3821 Road quality loaded.
333.6s 3822 Initial state created.
333.6s 3823 Transferring initial state and road quality to GPU...
333.6s 3824 GPU data transfer complete.
333.6s 3825 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
333.6s 3826 Initial boundary conditions applied.
333.6s 3827 [BC UPDATE] left → phase 0 RED (reduced inflow)
333.6s 3828 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
333.6s 3829 [BC UPDATE] left → phase 1 GREEN (normal inflow)
333.6s 3830 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
333.6s 3831 Running simulation until t = 60.00 s, outputting every 60.00 s
333.6s 3832 
334.0s 3833 [WARNING] Automatic CFL correction applied (count: 21900):
334.0s 3834 Calculated CFL: 0.800 > Limit: 0.500
334.0s 3835 Original dt: 4.470525e-01 s
334.0s 3836 Corrected dt: 2.794078e-01 s
334.0s 3837 Correction factor: 1.6x
334.0s 3838 Max wave speed detected: 17.89 m/s
334.0s 3839 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
334.5s 3840 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
334.8s 3841 [WARNING] Automatic CFL correction applied (count: 22000):
334.8s 3842 Calculated CFL: 0.800 > Limit: 0.500
334.8s 3843 Original dt: 4.119130e-01 s
334.8s 3844 Corrected dt: 2.574456e-01 s
334.8s 3845 Correction factor: 1.6x
334.8s 3846 Max wave speed detected: 19.42 m/s
334.9s 3847 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
335.4s 3848 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
335.6s 3849 Stored output at t = 60.0000 s (Step 231)
335.6s 3850 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
335.6s 3851 [A
335.6s 3852 
335.6s 3853 Simulation finished at t = 60.0000 s after 231 steps.
335.6s 3854 Total runtime: 2.09 seconds.
335.6s 3855 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.78s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.78s/s]
335.6s 3856 [BC UPDATE] left → phase 1 GREEN (normal inflow)
335.6s 3857 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
335.6s 3858 Running simulation until t = 120.00 s, outputting every 60.00 s
335.6s 3859 
335.8s 3860 [WARNING] Automatic CFL correction applied (count: 22100):
335.8s 3861 Calculated CFL: 0.800 > Limit: 0.500
335.8s 3862 Original dt: 4.115046e-01 s
335.8s 3863 Corrected dt: 2.571904e-01 s
335.8s 3864 Correction factor: 1.6x
335.8s 3865 Max wave speed detected: 19.44 m/s
335.8s 3866 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
336.3s 3867 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
336.7s 3868 [WARNING] Automatic CFL correction applied (count: 22200):
336.7s 3869 Calculated CFL: 0.800 > Limit: 0.500
336.7s 3870 Original dt: 4.114982e-01 s
336.7s 3871 Corrected dt: 2.571863e-01 s
336.7s 3872 Correction factor: 1.6x
336.7s 3873 Max wave speed detected: 19.44 m/s
336.7s 3874 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
337.2s 3875 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
337.6s 3876 [WARNING] Automatic CFL correction applied (count: 22300):
337.6s 3877 Calculated CFL: 0.800 > Limit: 0.500
337.6s 3878 Original dt: 4.114980e-01 s
337.6s 3879 Corrected dt: 2.571863e-01 s
337.6s 3880 Correction factor: 1.6x
337.6s 3881 Max wave speed detected: 19.44 m/s
337.6s 3882 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
337.8s 3883 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
337.8s 3884 [A
337.8s 3885 Stored output at t = 120.0000 s (Step 465)
337.8s 3886 
337.8s 3887 Simulation finished at t = 120.0000 s after 465 steps.
337.8s 3888 Total runtime: 2.12 seconds.
337.8s 3889 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.33s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.33s/s]
337.8s 3890 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
337.8s 3891 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
337.8s 3892 Using device: gpu
337.8s 3893 DEBUG PARAMS: Reading K_m_kmh = 10.0
337.8s 3894 DEBUG PARAMS: Reading K_c_kmh = 15.0
337.8s 3895 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
337.8s 3896 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
337.8s 3897 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
337.8s 3898 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
337.8s 3899 Loading road quality type: uniform
337.8s 3900 Uniform road quality value: 2
337.8s 3901 Road quality loaded.
337.8s 3902 Initial state created.
337.8s 3903 Transferring initial state and road quality to GPU...
337.8s 3904 GPU data transfer complete.
337.8s 3905 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
337.8s 3906 Initial boundary conditions applied.
337.8s 3907 [BC UPDATE] left → phase 0 RED (reduced inflow)
337.8s 3908 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
337.8s 3909 [BC UPDATE] left → phase 0 RED (reduced inflow)
337.8s 3910 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
337.8s 3911 Running simulation until t = 60.00 s, outputting every 60.00 s
337.8s 3912 
338.2s 3913 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
338.5s 3914 [WARNING] Automatic CFL correction applied (count: 22400):
338.5s 3915 Calculated CFL: 0.800 > Limit: 0.500
338.5s 3916 Original dt: 4.190346e-01 s
338.5s 3917 Corrected dt: 2.618967e-01 s
338.5s 3918 Correction factor: 1.6x
338.5s 3919 Max wave speed detected: 19.09 m/s
338.7s 3920 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
339.1s 3921 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
339.4s 3922 [WARNING] Automatic CFL correction applied (count: 22500):
339.4s 3923 Calculated CFL: 0.800 > Limit: 0.500
339.4s 3924 Original dt: 4.115954e-01 s
339.4s 3925 Corrected dt: 2.572472e-01 s
339.4s 3926 Correction factor: 1.6x
339.4s 3927 Max wave speed detected: 19.44 m/s
339.6s 3928 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
339.9s 3929 Stored output at t = 60.0000 s (Step 231)
339.9s 3930 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
339.9s 3931 [A
339.9s 3932 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.95s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.95s/s]
339.9s 3933 
339.9s 3934 Simulation finished at t = 60.0000 s after 231 steps.
339.9s 3935 Total runtime: 2.07 seconds.
339.9s 3936 
339.9s 3937 [BC UPDATE] left → phase 0 RED (reduced inflow)
339.9s 3938 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
339.9s 3939 Running simulation until t = 120.00 s, outputting every 60.00 s
340.0s 3940 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
340.3s 3941 [WARNING] Automatic CFL correction applied (count: 22600):
340.3s 3942 Calculated CFL: 0.800 > Limit: 0.500
340.3s 3943 Original dt: 4.114996e-01 s
340.3s 3944 Corrected dt: 2.571873e-01 s
340.3s 3945 Correction factor: 1.6x
340.3s 3946 Max wave speed detected: 19.44 m/s
340.5s 3947 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
341.0s 3948 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
341.2s 3949 [WARNING] Automatic CFL correction applied (count: 22700):
341.2s 3950 Calculated CFL: 0.800 > Limit: 0.500
341.2s 3951 Original dt: 4.114981e-01 s
341.2s 3952 Corrected dt: 2.571863e-01 s
341.2s 3953 Correction factor: 1.6x
341.2s 3954 Max wave speed detected: 19.44 m/s
341.4s 3955 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
341.9s 3956 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
342.0s 3957 Stored output at t = 120.0000 s (Step 465)
342.0s 3958 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
342.0s 3959 [A
342.0s 3960 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.03s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.03s/s]
342.0s 3961 
342.0s 3962 Simulation finished at t = 120.0000 s after 465 steps.
342.0s 3963 Total runtime: 2.14 seconds.
342.0s 3964 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
342.0s 3965 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
342.0s 3966 Using device: gpu
342.0s 3967 DEBUG PARAMS: Reading K_m_kmh = 10.0
342.0s 3968 DEBUG PARAMS: Reading K_c_kmh = 15.0
342.0s 3969 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
342.0s 3970 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
342.0s 3971 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
342.0s 3972 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
342.0s 3973 Loading road quality type: uniform
342.0s 3974 Uniform road quality value: 2
342.0s 3975 Road quality loaded.
342.0s 3976 Initial state created.
342.0s 3977 Transferring initial state and road quality to GPU...
342.0s 3978 GPU data transfer complete.
342.0s 3979 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
342.0s 3980 Initial boundary conditions applied.
342.0s 3981 [BC UPDATE] left → phase 0 RED (reduced inflow)
342.0s 3982 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
342.0s 3983 [BC UPDATE] left → phase 0 RED (reduced inflow)
342.0s 3984 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
342.0s 3985 Running simulation until t = 60.00 s, outputting every 60.00 s
342.0s 3986 
342.1s 3987 [WARNING] Automatic CFL correction applied (count: 22800):
342.1s 3988 Calculated CFL: 0.800 > Limit: 0.500
342.1s 3989 Original dt: 4.022422e-01 s
342.1s 3990 Corrected dt: 2.514014e-01 s
342.1s 3991 Correction factor: 1.6x
342.1s 3992 Max wave speed detected: 19.89 m/s
342.5s 3993 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
342.9s 3994 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
343.0s 3995 [WARNING] Automatic CFL correction applied (count: 22900):
343.0s 3996 Calculated CFL: 0.800 > Limit: 0.500
343.0s 3997 Original dt: 4.130229e-01 s
343.0s 3998 Corrected dt: 2.581393e-01 s
343.0s 3999 Correction factor: 1.6x
343.0s 4000 Max wave speed detected: 19.37 m/s
343.4s 4001 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
343.8s 4002 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
343.9s 4003 [WARNING] Automatic CFL correction applied (count: 23000):
343.9s 4004 Calculated CFL: 0.800 > Limit: 0.500
343.9s 4005 Original dt: 4.115198e-01 s
343.9s 4006 Corrected dt: 2.571999e-01 s
343.9s 4007 Correction factor: 1.6x
343.9s 4008 Max wave speed detected: 19.44 m/s
344.1s 4009 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
344.1s 4010 [A
344.1s 4011 Stored output at t = 60.0000 s (Step 231)
344.1s 4012 
344.1s 4013 Simulation finished at t = 60.0000 s after 231 steps.
344.1s 4014 Total runtime: 2.07 seconds.
344.1s 4015 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.93s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.93s/s]
344.1s 4016 [BC UPDATE] left → phase 1 GREEN (normal inflow)
344.1s 4017 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
344.1s 4018 Running simulation until t = 120.00 s, outputting every 60.00 s
344.1s 4019 
344.3s 4020 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
344.7s 4021 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
344.8s 4022 [WARNING] Automatic CFL correction applied (count: 23100):
344.8s 4023 Calculated CFL: 0.800 > Limit: 0.500
344.8s 4024 Original dt: 4.114984e-01 s
344.8s 4025 Corrected dt: 2.571865e-01 s
344.8s 4026 Correction factor: 1.6x
344.8s 4027 Max wave speed detected: 19.44 m/s
345.2s 4028 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
345.6s 4029 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
345.7s 4030 [WARNING] Automatic CFL correction applied (count: 23200):
345.7s 4031 Calculated CFL: 0.800 > Limit: 0.500
345.7s 4032 Original dt: 4.114980e-01 s
345.7s 4033 Corrected dt: 2.571863e-01 s
345.7s 4034 Correction factor: 1.6x
345.7s 4035 Max wave speed detected: 19.44 m/s
346.1s 4036 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
346.2s 4037 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
346.2s 4038 [A
346.2s 4039 Stored output at t = 120.0000 s (Step 465)
346.2s 4040 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.59s/s]
346.2s 4041 
346.2s 4042 Simulation finished at t = 120.0000 s after 465 steps.
346.2s 4043 Total runtime: 2.10 seconds.
346.2s 4044 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
346.2s 4045 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.2s 4046 Using device: gpu
346.2s 4047 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.2s 4048 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.2s 4049 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.2s 4050 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.2s 4051 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.2s 4052 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.2s 4053 Loading road quality type: uniform
346.2s 4054 Uniform road quality value: 2
346.2s 4055 Road quality loaded.
346.2s 4056 Initial state created.
346.2s 4057 Transferring initial state and road quality to GPU...
346.2s 4058 GPU data transfer complete.
346.2s 4059 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.2s 4060 Initial boundary conditions applied.
346.2s 4061 [BC UPDATE] left → phase 0 RED (reduced inflow)
346.2s 4062 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
346.2s 4063 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.5 steps/s
346.2s 4064 ---------------------------------
346.2s 4065 | rollout/           |          |
346.2s 4066 |    ep_len_mean     | 2        |
346.2s 4067 |    ep_rew_mean     | -0.0456  |
346.2s 4068 | time/              |          |
346.2s 4069 |    fps             | 0        |
346.2s 4070 |    iterations      | 1        |
346.2s 4071 |    time_elapsed    | 217      |
346.2s 4072 |    total_timesteps | 100      |
346.2s 4073 ---------------------------------
346.8s 4074 
346.8s 4075 ✅ Training completed in 3.6 minutes (218.2s)
346.8s 4076 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:37 < 0:00:00 , 0 it/s ]
346.8s 4077 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
346.8s 4078 
346.8s 4079 [PHASE 2/2] Running performance comparisons...
346.8s 4080 [QUICK TEST] Testing only: traffic_light_control
346.8s 4081 
346.8s 4082 Testing scenario: traffic_light_control (device=gpu)
346.8s 4083 2025-10-10 14:20:33 - INFO - run_performance_comparison:700 - ================================================================================
346.8s 4084 2025-10-10 14:20:33 - INFO - run_performance_comparison:701 - Starting run_performance_comparison for scenario: traffic_light_control
346.8s 4085 2025-10-10 14:20:33 - INFO - run_performance_comparison:702 - Device: gpu
346.8s 4086 2025-10-10 14:20:33 - INFO - run_performance_comparison:703 - ================================================================================
346.8s 4087 2025-10-10 14:20:33 - INFO - run_performance_comparison:704 - ================================================================================
346.8s 4088 2025-10-10 14:20:33 - INFO - run_performance_comparison:705 - Starting run_performance_comparison for scenario: traffic_light_control
346.8s 4089 2025-10-10 14:20:33 - INFO - run_performance_comparison:706 - Device: gpu
346.8s 4090 2025-10-10 14:20:33 - INFO - run_performance_comparison:707 - ================================================================================
346.8s 4091 2025-10-10 14:20:33 - INFO - _create_scenario_config:203 - Created scenario config: traffic_light_control.yml
346.8s 4092 2025-10-10 14:20:33 - INFO - _create_scenario_config:204 -   SENSITIVITY FIX: Domain=1km, Riemann IC with shock at 500m
346.8s 4093 2025-10-10 14:20:33 - INFO - _create_scenario_config:205 -   High density (left): rho_m=100.0 veh/km, rho_c=120.0 veh/km
346.8s 4094 2025-10-10 14:20:33 - INFO - _create_scenario_config:206 -   Low density (right): rho_m=30.0 veh/km, rho_c=40.0 veh/km
346.8s 4095 [SCENARIO] Generated: traffic_light_control.yml (1km domain, Riemann IC)
346.8s 4096 Running baseline controller...
346.8s 4097 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
346.8s 4098 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
346.8s 4099 2025-10-10 14:20:33 - INFO - run_control_simulation:286 - ================================================================================
346.8s 4100 2025-10-10 14:20:33 - INFO - run_control_simulation:287 - Starting run_control_simulation:
346.8s 4101 2025-10-10 14:20:33 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.8s 4102 2025-10-10 14:20:33 - INFO - run_control_simulation:289 -   - duration: 600.0s
346.8s 4103 2025-10-10 14:20:33 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
346.8s 4104 2025-10-10 14:20:33 - INFO - run_control_simulation:291 -   - device: gpu
346.8s 4105 2025-10-10 14:20:33 - INFO - run_control_simulation:292 -   - controller: BaselineController
346.8s 4106 2025-10-10 14:20:33 - INFO - run_control_simulation:293 -   - max_control_steps: 11
346.8s 4107 2025-10-10 14:20:33 - INFO - run_control_simulation:294 - ================================================================================
346.8s 4108 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
346.8s 4109 2025-10-10 14:20:33 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
346.8s 4110 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.8s 4111 Using device: gpu
346.8s 4112 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.8s 4113 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.8s 4114 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.8s 4115 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.8s 4116 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.8s 4117 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.8s 4118 Loading road quality type: uniform
346.8s 4119 Uniform road quality value: 2
346.8s 4120 Road quality loaded.
346.8s 4121 Initial state created.
346.8s 4122 Transferring initial state and road quality to GPU...
346.8s 4123 GPU data transfer complete.
346.8s 4124 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.8s 4125 Initial boundary conditions applied.
346.8s 4126 TrafficSignalEnvDirect initialized:
346.8s 4127 Decision interval: 60.0s
346.8s 4128 Observation segments: 6
346.8s 4129 Observation space: (26,)
346.8s 4130 Action space: 2
346.8s 4131 Device: gpu
346.8s 4132 2025-10-10 14:20:33 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
346.8s 4133 2025-10-10 14:20:33 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
346.8s 4134 [INFO] Calling env.reset()...
346.8s 4135 2025-10-10 14:20:33 - INFO - run_control_simulation:331 - Calling env.reset()...
346.8s 4136 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
346.8s 4137 Using device: gpu
346.8s 4138 DEBUG PARAMS: Reading K_m_kmh = 10.0
346.8s 4139 DEBUG PARAMS: Reading K_c_kmh = 15.0
346.8s 4140 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
346.8s 4141 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
346.8s 4142 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
346.8s 4143 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
346.8s 4144 Loading road quality type: uniform
346.8s 4145 Uniform road quality value: 2
346.8s 4146 Road quality loaded.
346.8s 4147 Initial state created.
346.8s 4148 Transferring initial state and road quality to GPU...
346.8s 4149 GPU data transfer complete.
346.8s 4150 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
346.8s 4151 Initial boundary conditions applied.
346.8s 4152 [BC UPDATE] left → phase 0 RED (reduced inflow)
346.8s 4153 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
346.8s 4154 2025-10-10 14:20:33 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
346.8s 4155 2025-10-10 14:20:33 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
346.8s 4156 2025-10-10 14:20:33 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
346.8s 4157 [INFO] Starting simulation loop (max 11 control steps)
346.8s 4158 2025-10-10 14:20:33 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
346.8s 4159 2025-10-10 14:20:33 - INFO - run_control_simulation:368 - ================================================================================
346.8s 4160 2025-10-10 14:20:33 - INFO - run_control_simulation:369 - STEP 0 START:
346.8s 4161 2025-10-10 14:20:33 - INFO - run_control_simulation:370 -   Controller: BaselineController
346.8s 4162 2025-10-10 14:20:33 - INFO - run_control_simulation:371 -   Action: 1.000000
346.8s 4163 2025-10-10 14:20:33 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
346.8s 4164 [BC UPDATE] left → phase 1 GREEN (normal inflow)
346.8s 4165 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
346.8s 4166 Running simulation until t = 60.00 s, outputting every 60.00 s
347.3s 4167 [WARNING] Automatic CFL correction applied (count: 23300):
347.3s 4168 Calculated CFL: 0.800 > Limit: 0.500
347.3s 4169 Original dt: 4.396418e-01 s
347.3s 4170 Corrected dt: 2.747761e-01 s
347.3s 4171 Correction factor: 1.6x
347.3s 4172 Max wave speed detected: 18.20 m/s
347.3s 4173 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
347.7s 4174 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
348.2s 4175 [WARNING] Automatic CFL correction applied (count: 23400):
348.2s 4176 Calculated CFL: 0.800 > Limit: 0.500
348.2s 4177 Original dt: 4.118393e-01 s
348.2s 4178 Corrected dt: 2.573996e-01 s
348.2s 4179 Correction factor: 1.6x
348.2s 4180 Max wave speed detected: 19.43 m/s
348.2s 4181 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
348.6s 4182 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
348.9s 4183 Stored output at t = 60.0000 s (Step 231)
348.9s 4184 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.81s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.81s/s]
348.9s 4185 
348.9s 4186 Simulation finished at t = 60.0000 s after 231 steps.
348.9s 4187 Total runtime: 2.08 seconds.
348.9s 4188 2025-10-10 14:20:35 - INFO - run_control_simulation:384 -   Reward: -0.084799
348.9s 4189 2025-10-10 14:20:35 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
348.9s 4190 2025-10-10 14:20:35 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
348.9s 4191 2025-10-10 14:20:35 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
348.9s 4192 2025-10-10 14:20:35 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.673988e+00, max=1.233795e+01, std=4.084103e+00
348.9s 4193 2025-10-10 14:20:35 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
348.9s 4194 2025-10-10 14:20:35 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.406686, w_c=11.325496
348.9s 4195 2025-10-10 14:20:35 - INFO - run_control_simulation:418 -   State hash: 8409791264894250498
348.9s 4196 2025-10-10 14:20:35 - INFO - run_control_simulation:420 - ================================================================================
348.9s 4197 [STEP 1/11] action=1.0000, reward=-0.0848, t=60.0s, state_diff=3.673988e+00
348.9s 4198 2025-10-10 14:20:35 - INFO - run_control_simulation:368 - ================================================================================
348.9s 4199 2025-10-10 14:20:35 - INFO - run_control_simulation:369 - STEP 1 START:
348.9s 4200 2025-10-10 14:20:35 - INFO - run_control_simulation:370 -   Controller: BaselineController
348.9s 4201 2025-10-10 14:20:35 - INFO - run_control_simulation:371 -   Action: 0.000000
348.9s 4202 2025-10-10 14:20:35 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
348.9s 4203 [BC UPDATE] left → phase 1 GREEN (normal inflow)
348.9s 4204 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
348.9s 4205 Running simulation until t = 120.00 s, outputting every 60.00 s
349.1s 4206 [WARNING] Automatic CFL correction applied (count: 23500):
349.1s 4207 Calculated CFL: 0.800 > Limit: 0.500
349.1s 4208 Original dt: 4.115033e-01 s
349.1s 4209 Corrected dt: 2.571896e-01 s
349.1s 4210 Correction factor: 1.6x
349.1s 4211 Max wave speed detected: 19.44 m/s
349.1s 4212 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
349.5s 4213 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
350.0s 4214 [WARNING] Automatic CFL correction applied (count: 23600):
350.0s 4215 Calculated CFL: 0.800 > Limit: 0.500
350.0s 4216 Original dt: 4.114981e-01 s
350.0s 4217 Corrected dt: 2.571863e-01 s
350.0s 4218 Correction factor: 1.6x
350.0s 4219 Max wave speed detected: 19.44 m/s
350.0s 4220 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
350.4s 4221 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
350.9s 4222 [WARNING] Automatic CFL correction applied (count: 23700):
350.9s 4223 Calculated CFL: 0.800 > Limit: 0.500
350.9s 4224 Original dt: 4.114980e-01 s
350.9s 4225 Corrected dt: 2.571863e-01 s
350.9s 4226 Correction factor: 1.6x
350.9s 4227 Max wave speed detected: 19.44 m/s
350.9s 4228 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
351.0s 4229 Stored output at t = 120.0000 s (Step 465)
351.0s 4230 
351.0s 4231 Simulation finished at t = 120.0000 s after 465 steps.
351.0s 4232 Total runtime: 2.14 seconds.
351.0s 4233 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.01s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.01s/s]
351.0s 4234 2025-10-10 14:20:37 - INFO - run_control_simulation:384 -   Reward: 0.015200
351.0s 4235 2025-10-10 14:20:37 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
351.0s 4236 2025-10-10 14:20:37 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
351.0s 4237 2025-10-10 14:20:37 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
351.0s 4238 2025-10-10 14:20:37 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
351.0s 4239 2025-10-10 14:20:37 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
351.0s 4240 2025-10-10 14:20:37 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.918019, w_c=14.101648
351.0s 4241 2025-10-10 14:20:37 - INFO - run_control_simulation:418 -   State hash: -9011138807261462523
351.0s 4242 2025-10-10 14:20:37 - INFO - run_control_simulation:420 - ================================================================================
351.0s 4243 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
351.0s 4244 2025-10-10 14:20:37 - INFO - run_control_simulation:368 - ================================================================================
351.0s 4245 2025-10-10 14:20:37 - INFO - run_control_simulation:369 - STEP 2 START:
351.0s 4246 2025-10-10 14:20:37 - INFO - run_control_simulation:370 -   Controller: BaselineController
351.0s 4247 2025-10-10 14:20:37 - INFO - run_control_simulation:371 -   Action: 1.000000
351.0s 4248 2025-10-10 14:20:37 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
351.0s 4249 [BC UPDATE] left → phase 0 RED (reduced inflow)
351.0s 4250 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
351.0s 4251 Running simulation until t = 180.00 s, outputting every 60.00 s
351.4s 4252 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
351.8s 4253 [WARNING] Automatic CFL correction applied (count: 23800):
351.8s 4254 Calculated CFL: 0.800 > Limit: 0.500
351.8s 4255 Original dt: 4.114980e-01 s
351.8s 4256 Corrected dt: 2.571863e-01 s
351.8s 4257 Correction factor: 1.6x
351.8s 4258 Max wave speed detected: 19.44 m/s
351.8s 4259 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
352.3s 4260 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
352.7s 4261 [WARNING] Automatic CFL correction applied (count: 23900):
352.7s 4262 Calculated CFL: 0.800 > Limit: 0.500
352.7s 4263 Original dt: 4.114980e-01 s
352.7s 4264 Corrected dt: 2.571863e-01 s
352.7s 4265 Correction factor: 1.6x
352.7s 4266 Max wave speed detected: 19.44 m/s
352.7s 4267 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
353.2s 4268 Stored output at t = 180.0000 s (Step 699)
353.2s 4269 
353.2s 4270 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.51s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.50s/s]
353.2s 4271 Simulation finished at t = 180.0000 s after 699 steps.
353.2s 4272 Total runtime: 2.11 seconds.
353.2s 4273 2025-10-10 14:20:39 - INFO - run_control_simulation:384 -   Reward: -0.084800
353.2s 4274 2025-10-10 14:20:39 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
353.2s 4275 2025-10-10 14:20:39 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
353.2s 4276 2025-10-10 14:20:39 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
353.2s 4277 2025-10-10 14:20:39 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.241080e+00, max=7.500000e+00, std=2.066254e+00
353.2s 4278 2025-10-10 14:20:39 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
353.2s 4279 2025-10-10 14:20:39 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
353.2s 4280 2025-10-10 14:20:39 - INFO - run_control_simulation:418 -   State hash: -5882412441307498058
353.2s 4281 2025-10-10 14:20:39 - INFO - run_control_simulation:420 - ================================================================================
353.2s 4282 [STEP 3/11] action=1.0000, reward=-0.0848, t=180.0s, state_diff=1.241080e+00
353.2s 4283 2025-10-10 14:20:39 - INFO - run_control_simulation:368 - ================================================================================
353.2s 4284 2025-10-10 14:20:39 - INFO - run_control_simulation:369 - STEP 3 START:
353.2s 4285 2025-10-10 14:20:39 - INFO - run_control_simulation:370 -   Controller: BaselineController
353.2s 4286 2025-10-10 14:20:39 - INFO - run_control_simulation:371 -   Action: 0.000000
353.2s 4287 2025-10-10 14:20:39 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
353.2s 4288 [BC UPDATE] left → phase 0 RED (reduced inflow)
353.2s 4289 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
353.2s 4290 Running simulation until t = 240.00 s, outputting every 60.00 s
353.2s 4291 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
353.6s 4292 [WARNING] Automatic CFL correction applied (count: 24000):
353.6s 4293 Calculated CFL: 0.800 > Limit: 0.500
353.6s 4294 Original dt: 4.114980e-01 s
353.6s 4295 Corrected dt: 2.571863e-01 s
353.6s 4296 Correction factor: 1.6x
353.6s 4297 Max wave speed detected: 19.44 m/s
353.6s 4298 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
354.1s 4299 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
354.5s 4300 [WARNING] Automatic CFL correction applied (count: 24100):
354.5s 4301 Calculated CFL: 0.800 > Limit: 0.500
354.5s 4302 Original dt: 4.114980e-01 s
354.5s 4303 Corrected dt: 2.571863e-01 s
354.5s 4304 Correction factor: 1.6x
354.5s 4305 Max wave speed detected: 19.44 m/s
354.5s 4306 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
355.0s 4307 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
355.3s 4308 Stored output at t = 240.0000 s (Step 933)
355.3s 4309 
355.3s 4310 Simulation finished at t = 240.0000 s after 933 steps.
355.3s 4311 Total runtime: 2.10 seconds.
355.3s 4312 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.53s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.53s/s]
355.3s 4313 2025-10-10 14:20:41 - INFO - run_control_simulation:384 -   Reward: 0.015200
355.3s 4314 2025-10-10 14:20:41 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
355.3s 4315 2025-10-10 14:20:41 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
355.3s 4316 2025-10-10 14:20:41 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
355.3s 4317 2025-10-10 14:20:41 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
355.3s 4318 2025-10-10 14:20:41 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
355.3s 4319 2025-10-10 14:20:41 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
355.3s 4320 2025-10-10 14:20:41 - INFO - run_control_simulation:418 -   State hash: 1877001135921852328
355.3s 4321 2025-10-10 14:20:41 - INFO - run_control_simulation:420 - ================================================================================
355.3s 4322 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
355.3s 4323 2025-10-10 14:20:41 - INFO - run_control_simulation:368 - ================================================================================
355.3s 4324 2025-10-10 14:20:41 - INFO - run_control_simulation:369 - STEP 4 START:
355.3s 4325 2025-10-10 14:20:41 - INFO - run_control_simulation:370 -   Controller: BaselineController
355.3s 4326 2025-10-10 14:20:41 - INFO - run_control_simulation:371 -   Action: 1.000000
355.3s 4327 2025-10-10 14:20:41 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
355.3s 4328 [BC UPDATE] left → phase 1 GREEN (normal inflow)
355.3s 4329 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
355.3s 4330 Running simulation until t = 300.00 s, outputting every 60.00 s
355.4s 4331 [WARNING] Automatic CFL correction applied (count: 24200):
355.4s 4332 Calculated CFL: 0.800 > Limit: 0.500
355.4s 4333 Original dt: 4.114980e-01 s
355.4s 4334 Corrected dt: 2.571863e-01 s
355.4s 4335 Correction factor: 1.6x
355.4s 4336 Max wave speed detected: 19.44 m/s
355.4s 4337 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
355.9s 4338 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
356.3s 4339 [WARNING] Automatic CFL correction applied (count: 24300):
356.3s 4340 Calculated CFL: 0.800 > Limit: 0.500
356.3s 4341 Original dt: 4.114980e-01 s
356.3s 4342 Corrected dt: 2.571863e-01 s
356.3s 4343 Correction factor: 1.6x
356.3s 4344 Max wave speed detected: 19.44 m/s
356.3s 4345 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
356.8s 4346 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
357.2s 4347 [WARNING] Automatic CFL correction applied (count: 24400):
357.2s 4348 Calculated CFL: 0.800 > Limit: 0.500
357.2s 4349 Original dt: 4.114980e-01 s
357.2s 4350 Corrected dt: 2.571863e-01 s
357.2s 4351 Correction factor: 1.6x
357.2s 4352 Max wave speed detected: 19.44 m/s
357.2s 4353 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
357.4s 4354 Stored output at t = 300.0000 s (Step 1167)
357.4s 4355 
357.4s 4356 Simulation finished at t = 300.0000 s after 1167 steps.
357.4s 4357 Total runtime: 2.13 seconds.
357.4s 4358 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.20s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.20s/s]
357.4s 4359 2025-10-10 14:20:43 - INFO - run_control_simulation:384 -   Reward: -0.084800
357.4s 4360 2025-10-10 14:20:43 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
357.4s 4361 2025-10-10 14:20:43 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
357.4s 4362 2025-10-10 14:20:43 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
357.4s 4363 2025-10-10 14:20:43 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.491564e-02, max=7.500000e+00, std=6.627938e-01
357.4s 4364 2025-10-10 14:20:43 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
357.4s 4365 2025-10-10 14:20:43 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
357.4s 4366 2025-10-10 14:20:43 - INFO - run_control_simulation:418 -   State hash: 8884419899463617860
357.4s 4367 2025-10-10 14:20:43 - INFO - run_control_simulation:420 - ================================================================================
357.4s 4368 [STEP 5/11] action=1.0000, reward=-0.0848, t=300.0s, state_diff=6.491564e-02
357.4s 4369 2025-10-10 14:20:43 - INFO - run_control_simulation:368 - ================================================================================
357.4s 4370 2025-10-10 14:20:43 - INFO - run_control_simulation:369 - STEP 5 START:
357.4s 4371 2025-10-10 14:20:43 - INFO - run_control_simulation:370 -   Controller: BaselineController
357.4s 4372 2025-10-10 14:20:43 - INFO - run_control_simulation:371 -   Action: 0.000000
357.4s 4373 2025-10-10 14:20:43 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
357.4s 4374 [BC UPDATE] left → phase 1 GREEN (normal inflow)
357.4s 4375 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
357.4s 4376 Running simulation until t = 360.00 s, outputting every 60.00 s
357.7s 4377 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
358.1s 4378 [WARNING] Automatic CFL correction applied (count: 24500):
358.1s 4379 Calculated CFL: 0.800 > Limit: 0.500
358.1s 4380 Original dt: 4.114980e-01 s
358.1s 4381 Corrected dt: 2.571863e-01 s
358.1s 4382 Correction factor: 1.6x
358.1s 4383 Max wave speed detected: 19.44 m/s
358.2s 4384 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
358.6s 4385 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
359.0s 4386 [WARNING] Automatic CFL correction applied (count: 24600):
359.0s 4387 Calculated CFL: 0.800 > Limit: 0.500
359.0s 4388 Original dt: 4.114980e-01 s
359.0s 4389 Corrected dt: 2.571863e-01 s
359.0s 4390 Correction factor: 1.6x
359.0s 4391 Max wave speed detected: 19.44 m/s
359.1s 4392 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
359.5s 4393 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
359.5s 4394 Stored output at t = 360.0000 s (Step 1401)
359.5s 4395 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.39s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.39s/s]
359.5s 4396 
359.5s 4397 Simulation finished at t = 360.0000 s after 1401 steps.
359.5s 4398 Total runtime: 2.11 seconds.
359.5s 4399 2025-10-10 14:20:46 - INFO - run_control_simulation:384 -   Reward: 0.015200
359.5s 4400 2025-10-10 14:20:46 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
359.5s 4401 2025-10-10 14:20:46 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
359.5s 4402 2025-10-10 14:20:46 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
359.5s 4403 2025-10-10 14:20:46 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
359.5s 4404 2025-10-10 14:20:46 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
359.5s 4405 2025-10-10 14:20:46 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
359.5s 4406 2025-10-10 14:20:46 - INFO - run_control_simulation:418 -   State hash: -4454480815268356441
359.5s 4407 2025-10-10 14:20:46 - INFO - run_control_simulation:420 - ================================================================================
359.5s 4408 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
359.5s 4409 2025-10-10 14:20:46 - INFO - run_control_simulation:368 - ================================================================================
359.5s 4410 2025-10-10 14:20:46 - INFO - run_control_simulation:369 - STEP 6 START:
359.5s 4411 2025-10-10 14:20:46 - INFO - run_control_simulation:370 -   Controller: BaselineController
359.5s 4412 2025-10-10 14:20:46 - INFO - run_control_simulation:371 -   Action: 1.000000
359.5s 4413 2025-10-10 14:20:46 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
359.5s 4414 [BC UPDATE] left → phase 0 RED (reduced inflow)
359.5s 4415 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
359.5s 4416 Running simulation until t = 420.00 s, outputting every 60.00 s
360.0s 4417 [WARNING] Automatic CFL correction applied (count: 24700):
360.0s 4418 Calculated CFL: 0.800 > Limit: 0.500
360.0s 4419 Original dt: 4.114980e-01 s
360.0s 4420 Corrected dt: 2.571863e-01 s
360.0s 4421 Correction factor: 1.6x
360.0s 4422 Max wave speed detected: 19.44 m/s
360.0s 4423 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
360.4s 4424 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
360.9s 4425 [WARNING] Automatic CFL correction applied (count: 24800):
360.9s 4426 Calculated CFL: 0.800 > Limit: 0.500
360.9s 4427 Original dt: 4.114980e-01 s
360.9s 4428 Corrected dt: 2.571863e-01 s
360.9s 4429 Correction factor: 1.6x
360.9s 4430 Max wave speed detected: 19.44 m/s
360.9s 4431 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
361.4s 4432 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
361.7s 4433 Stored output at t = 420.0000 s (Step 1635)
361.7s 4434 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 27.70s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 27.70s/s]
361.7s 4435 
361.7s 4436 Simulation finished at t = 420.0000 s after 1635 steps.
361.7s 4437 Total runtime: 2.17 seconds.
361.7s 4438 2025-10-10 14:20:48 - INFO - run_control_simulation:384 -   Reward: -0.084800
361.7s 4439 2025-10-10 14:20:48 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
361.7s 4440 2025-10-10 14:20:48 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
361.7s 4441 2025-10-10 14:20:48 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
361.7s 4442 2025-10-10 14:20:48 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
361.7s 4443 2025-10-10 14:20:48 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
361.7s 4444 2025-10-10 14:20:48 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
361.7s 4445 2025-10-10 14:20:48 - INFO - run_control_simulation:418 -   State hash: 744103476397897073
361.7s 4446 2025-10-10 14:20:48 - INFO - run_control_simulation:420 - ================================================================================
361.7s 4447 [STEP 7/11] action=1.0000, reward=-0.0848, t=420.0s, state_diff=6.490385e-02
361.7s 4448 2025-10-10 14:20:48 - INFO - run_control_simulation:368 - ================================================================================
361.7s 4449 2025-10-10 14:20:48 - INFO - run_control_simulation:369 - STEP 7 START:
361.7s 4450 2025-10-10 14:20:48 - INFO - run_control_simulation:370 -   Controller: BaselineController
361.7s 4451 2025-10-10 14:20:48 - INFO - run_control_simulation:371 -   Action: 0.000000
361.7s 4452 2025-10-10 14:20:48 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
361.7s 4453 [BC UPDATE] left → phase 0 RED (reduced inflow)
361.7s 4454 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
361.7s 4455 Running simulation until t = 480.00 s, outputting every 60.00 s
361.8s 4456 [WARNING] Automatic CFL correction applied (count: 24900):
361.8s 4457 Calculated CFL: 0.800 > Limit: 0.500
361.8s 4458 Original dt: 4.114980e-01 s
361.8s 4459 Corrected dt: 2.571863e-01 s
361.8s 4460 Correction factor: 1.6x
361.8s 4461 Max wave speed detected: 19.44 m/s
361.8s 4462 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
362.3s 4463 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
362.7s 4464 [WARNING] Automatic CFL correction applied (count: 25000):
362.7s 4465 Calculated CFL: 0.800 > Limit: 0.500
362.7s 4466 Original dt: 4.114980e-01 s
362.7s 4467 Corrected dt: 2.571863e-01 s
362.7s 4468 Correction factor: 1.6x
362.7s 4469 Max wave speed detected: 19.44 m/s
362.7s 4470 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
363.2s 4471 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
363.6s 4472 [WARNING] Automatic CFL correction applied (count: 25100):
363.6s 4473 Calculated CFL: 0.800 > Limit: 0.500
363.6s 4474 Original dt: 4.114980e-01 s
363.6s 4475 Corrected dt: 2.571863e-01 s
363.6s 4476 Correction factor: 1.6x
363.6s 4477 Max wave speed detected: 19.44 m/s
363.6s 4478 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
363.8s 4479 Stored output at t = 480.0000 s (Step 1869)
363.8s 4480 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.52s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.52s/s]
363.8s 4481 
363.8s 4482 Simulation finished at t = 480.0000 s after 1869 steps.
363.8s 4483 Total runtime: 2.10 seconds.
363.8s 4484 2025-10-10 14:20:50 - INFO - run_control_simulation:384 -   Reward: 0.015200
363.8s 4485 2025-10-10 14:20:50 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
363.8s 4486 2025-10-10 14:20:50 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
363.8s 4487 2025-10-10 14:20:50 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
363.8s 4488 2025-10-10 14:20:50 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
363.8s 4489 2025-10-10 14:20:50 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
363.8s 4490 2025-10-10 14:20:50 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
363.8s 4491 2025-10-10 14:20:50 - INFO - run_control_simulation:418 -   State hash: 9066405651374024830
363.8s 4492 2025-10-10 14:20:50 - INFO - run_control_simulation:420 - ================================================================================
363.8s 4493 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
363.8s 4494 2025-10-10 14:20:50 - INFO - run_control_simulation:368 - ================================================================================
363.8s 4495 2025-10-10 14:20:50 - INFO - run_control_simulation:369 - STEP 8 START:
363.8s 4496 2025-10-10 14:20:50 - INFO - run_control_simulation:370 -   Controller: BaselineController
363.8s 4497 2025-10-10 14:20:50 - INFO - run_control_simulation:371 -   Action: 1.000000
363.8s 4498 2025-10-10 14:20:50 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
363.8s 4499 [BC UPDATE] left → phase 1 GREEN (normal inflow)
363.8s 4500 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
363.8s 4501 Running simulation until t = 540.00 s, outputting every 60.00 s
364.1s 4502 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
364.5s 4503 [WARNING] Automatic CFL correction applied (count: 25200):
364.5s 4504 Calculated CFL: 0.800 > Limit: 0.500
364.5s 4505 Original dt: 4.114980e-01 s
364.5s 4506 Corrected dt: 2.571863e-01 s
364.5s 4507 Correction factor: 1.6x
364.5s 4508 Max wave speed detected: 19.44 m/s
364.5s 4509 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
365.0s 4510 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
365.4s 4511 [WARNING] Automatic CFL correction applied (count: 25300):
365.4s 4512 Calculated CFL: 0.800 > Limit: 0.500
365.4s 4513 Original dt: 4.114980e-01 s
365.4s 4514 Corrected dt: 2.571863e-01 s
365.4s 4515 Correction factor: 1.6x
365.4s 4516 Max wave speed detected: 19.44 m/s
365.4s 4517 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
365.9s 4518 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
365.9s 4519 Stored output at t = 540.0000 s (Step 2103)
365.9s 4520 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.55s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.55s/s]
365.9s 4521 
365.9s 4522 Simulation finished at t = 540.0000 s after 2103 steps.
365.9s 4523 Total runtime: 2.10 seconds.
365.9s 4524 2025-10-10 14:20:52 - INFO - run_control_simulation:384 -   Reward: -0.084800
365.9s 4525 2025-10-10 14:20:52 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
365.9s 4526 2025-10-10 14:20:52 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
365.9s 4527 2025-10-10 14:20:52 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
365.9s 4528 2025-10-10 14:20:52 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.490385e-02, max=7.500000e+00, std=6.627949e-01
365.9s 4529 2025-10-10 14:20:52 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
365.9s 4530 2025-10-10 14:20:52 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
365.9s 4531 2025-10-10 14:20:52 - INFO - run_control_simulation:418 -   State hash: 777075297544755862
365.9s 4532 2025-10-10 14:20:52 - INFO - run_control_simulation:420 - ================================================================================
365.9s 4533 [STEP 9/11] action=1.0000, reward=-0.0848, t=540.0s, state_diff=6.490385e-02
365.9s 4534 2025-10-10 14:20:52 - INFO - run_control_simulation:368 - ================================================================================
365.9s 4535 2025-10-10 14:20:52 - INFO - run_control_simulation:369 - STEP 9 START:
365.9s 4536 2025-10-10 14:20:52 - INFO - run_control_simulation:370 -   Controller: BaselineController
365.9s 4537 2025-10-10 14:20:52 - INFO - run_control_simulation:371 -   Action: 0.000000
365.9s 4538 2025-10-10 14:20:52 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
365.9s 4539 [BC UPDATE] left → phase 1 GREEN (normal inflow)
365.9s 4540 └─ Inflow state: rho_m=0.1000, w_m=15.0, rho_c=0.1200, w_c=12.0
365.9s 4541 Running simulation until t = 600.00 s, outputting every 60.00 s
366.3s 4542 [WARNING] Automatic CFL correction applied (count: 25400):
366.3s 4543 Calculated CFL: 0.800 > Limit: 0.500
366.3s 4544 Original dt: 4.114980e-01 s
366.3s 4545 Corrected dt: 2.571863e-01 s
366.3s 4546 Correction factor: 1.6x
366.3s 4547 Max wave speed detected: 19.44 m/s
366.3s 4548 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
366.8s 4549 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
367.2s 4550 [WARNING] Automatic CFL correction applied (count: 25500):
367.2s 4551 Calculated CFL: 0.800 > Limit: 0.500
367.2s 4552 Original dt: 4.114980e-01 s
367.2s 4553 Corrected dt: 2.571863e-01 s
367.2s 4554 Correction factor: 1.6x
367.2s 4555 Max wave speed detected: 19.44 m/s
367.2s 4556 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
367.7s 4557 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
368.0s 4558 Stored output at t = 600.0000 s (Step 2337)
368.0s 4559 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.44s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.44s/s]
368.0s 4560 
368.0s 4561 Simulation finished at t = 600.0000 s after 2337 steps.
368.0s 4562 Total runtime: 2.11 seconds.
368.0s 4563 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
368.0s 4564 2025-10-10 14:20:54 - INFO - run_control_simulation:384 -   Reward: 0.015200
368.0s 4565 2025-10-10 14:20:54 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
368.0s 4566 2025-10-10 14:20:54 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
368.0s 4567 2025-10-10 14:20:54 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
368.0s 4568 2025-10-10 14:20:54 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
368.0s 4569 2025-10-10 14:20:54 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
368.0s 4570 2025-10-10 14:20:54 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.283245, w_c=16.446577
368.0s 4571 2025-10-10 14:20:54 - INFO - run_control_simulation:418 -   State hash: 2817111464974324198
368.0s 4572 2025-10-10 14:20:54 - INFO - run_control_simulation:420 - ================================================================================
368.0s 4573 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
368.0s 4574 
368.0s 4575 [SIMULATION COMPLETED] Summary:
368.0s 4576 - Total control steps: 10
368.0s 4577 - Total reward: -0.35
368.0s 4578 - Avg step time: 2.119s (device=gpu)
368.0s 4579 - Simulated time: 600.0s / 600.0s
368.0s 4580 - Wallclock time: 21.2s
368.0s 4581 - Speed ratio: 28.31x real-time
368.0s 4582 
368.0s 4583 2025-10-10 14:20:54 - INFO - run_control_simulation:455 -
368.0s 4584 [SIMULATION COMPLETED] Summary:
368.0s 4585 - Total control steps: 10
368.0s 4586 - Total reward: -0.35
368.0s 4587 - Avg step time: 2.119s (device=gpu)
368.0s 4588 - Simulated time: 600.0s / 600.0s
368.0s 4589 - Wallclock time: 21.2s
368.0s 4590 - Speed ratio: 28.31x real-time
368.0s 4591 
368.0s 4592 2025-10-10 14:20:54 - INFO - run_control_simulation:456 - Returning 10 state snapshots
368.0s 4593 2025-10-10 14:20:54 - INFO - run_performance_comparison:725 - Baseline states copied: 10 snapshots
368.0s 4594 2025-10-10 14:20:54 - INFO - run_performance_comparison:726 - Baseline FIRST state hash: 8409791264894250498
368.0s 4595 2025-10-10 14:20:54 - INFO - run_performance_comparison:727 - Baseline LAST state hash: 2817111464974324198
368.0s 4596 2025-10-10 14:20:54 - INFO - run_performance_comparison:728 - Baseline first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
368.0s 4597 2.14351577e-05]
368.0s 4598 2025-10-10 14:20:54 - INFO - run_performance_comparison:729 - Baseline last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
368.0s 4599 2.14319923e-05]
368.0s 4600 2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
368.0s 4601 2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=8409791264894250498, last=2817111464974324198
368.0s 4602 2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
368.0s 4603 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
368.0s 4604 2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
368.0s 4605 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
368.0s 4606 2025-10-10 14:20:54 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
368.0s 4607 Running RL controller...
368.0s 4608 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
368.0s 4609 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
368.0s 4610 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
368.0s 4611 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
368.0s 4612 2025-10-10 14:20:54 - INFO - run_control_simulation:286 - ================================================================================
368.0s 4613 2025-10-10 14:20:54 - INFO - run_control_simulation:287 - Starting run_control_simulation:
368.0s 4614 2025-10-10 14:20:54 - INFO - run_control_simulation:288 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
368.0s 4615 2025-10-10 14:20:54 - INFO - run_control_simulation:289 -   - duration: 600.0s
368.0s 4616 2025-10-10 14:20:54 - INFO - run_control_simulation:290 -   - control_interval: 60.0s
368.0s 4617 2025-10-10 14:20:54 - INFO - run_control_simulation:291 -   - device: gpu
368.0s 4618 2025-10-10 14:20:54 - INFO - run_control_simulation:292 -   - controller: RLController
368.0s 4619 2025-10-10 14:20:54 - INFO - run_control_simulation:293 -   - max_control_steps: 11
368.0s 4620 2025-10-10 14:20:54 - INFO - run_control_simulation:294 - ================================================================================
368.0s 4621 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
368.0s 4622 2025-10-10 14:20:54 - INFO - run_control_simulation:299 - Creating TrafficSignalEnvDirect instance...
368.0s 4623 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
368.0s 4624 Using device: gpu
368.0s 4625 DEBUG PARAMS: Reading K_m_kmh = 10.0
368.0s 4626 DEBUG PARAMS: Reading K_c_kmh = 15.0
368.0s 4627 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
368.0s 4628 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
368.0s 4629 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
368.0s 4630 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
368.0s 4631 Loading road quality type: uniform
368.0s 4632 Uniform road quality value: 2
368.0s 4633 Road quality loaded.
368.0s 4634 Initial state created.
368.0s 4635 Transferring initial state and road quality to GPU...
368.0s 4636 GPU data transfer complete.
368.0s 4637 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
368.0s 4638 Initial boundary conditions applied.
368.0s 4639 TrafficSignalEnvDirect initialized:
368.0s 4640 Decision interval: 60.0s
368.0s 4641 Observation segments: 6
368.0s 4642 Observation space: (26,)
368.0s 4643 Action space: 2
368.0s 4644 Device: gpu
368.0s 4645 2025-10-10 14:20:54 - INFO - run_control_simulation:314 - TrafficSignalEnvDirect created successfully
368.0s 4646 2025-10-10 14:20:54 - INFO - run_control_simulation:315 -   SENSITIVITY FIX: Observation segments [3-8] ≈ 30-80m from boundary
368.0s 4647 [INFO] Calling env.reset()...
368.0s 4648 2025-10-10 14:20:54 - INFO - run_control_simulation:331 - Calling env.reset()...
368.0s 4649 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
368.0s 4650 Using device: gpu
368.0s 4651 DEBUG PARAMS: Reading K_m_kmh = 10.0
368.0s 4652 DEBUG PARAMS: Reading K_c_kmh = 15.0
368.0s 4653 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
368.0s 4654 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
368.0s 4655 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
368.0s 4656 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
368.0s 4657 Loading road quality type: uniform
368.0s 4658 Uniform road quality value: 2
368.0s 4659 Road quality loaded.
368.0s 4660 Initial state created.
368.0s 4661 Transferring initial state and road quality to GPU...
368.0s 4662 GPU data transfer complete.
368.0s 4663 DEBUG BC Init: Calculated initial_equilibrium_state = [0.1, 15.0, 0.12, 12.0]
368.0s 4664 Initial boundary conditions applied.
368.0s 4665 [BC UPDATE] left → phase 0 RED (reduced inflow)
368.0s 4666 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
368.0s 4667 2025-10-10 14:20:54 - INFO - run_control_simulation:333 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
368.0s 4668 2025-10-10 14:20:54 - INFO - run_control_simulation:337 - INITIAL STATE shape: (4, 104), dtype: float64
368.0s 4669 2025-10-10 14:20:54 - INFO - run_control_simulation:338 - INITIAL STATE statistics: mean=8.941443e+00, std=9.626354e+00, min=1.000000e-04, max=2.500000e+01
368.0s 4670 [INFO] Starting simulation loop (max 11 control steps)
368.0s 4671 2025-10-10 14:20:54 - INFO - run_control_simulation:354 - Starting simulation loop - max 11 control steps
368.1s 4672 2025-10-10 14:20:54 - INFO - run_control_simulation:368 - ================================================================================
368.1s 4673 2025-10-10 14:20:54 - INFO - run_control_simulation:369 - STEP 0 START:
368.1s 4674 2025-10-10 14:20:54 - INFO - run_control_simulation:370 -   Controller: RLController
368.1s 4675 2025-10-10 14:20:54 - INFO - run_control_simulation:371 -   Action: 0.000000
368.1s 4676 2025-10-10 14:20:54 - INFO - run_control_simulation:372 -   Simulation time: 0.00s
368.1s 4677 [BC UPDATE] left → phase 0 RED (reduced inflow)
368.1s 4678 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
368.1s 4679 Running simulation until t = 60.00 s, outputting every 60.00 s
368.2s 4680 [WARNING] Automatic CFL correction applied (count: 25600):
368.2s 4681 Calculated CFL: 0.800 > Limit: 0.500
368.2s 4682 Original dt: 3.909130e-01 s
368.2s 4683 Corrected dt: 2.443206e-01 s
368.2s 4684 Correction factor: 1.6x
368.2s 4685 Max wave speed detected: 20.46 m/s
368.5s 4686 [PROGRESS] Step 50: t=13.30/60.00s (22.2%) | dt=0.2748s
368.9s 4687 [PROGRESS] Step 100: t=26.51/60.00s (44.2%) | dt=0.2591s
369.0s 4688 [WARNING] Automatic CFL correction applied (count: 25700):
369.0s 4689 Calculated CFL: 0.800 > Limit: 0.500
369.0s 4690 Original dt: 4.131708e-01 s
369.0s 4691 Corrected dt: 2.582317e-01 s
369.0s 4692 Correction factor: 1.6x
369.0s 4693 Max wave speed detected: 19.36 m/s
369.4s 4694 [PROGRESS] Step 150: t=39.40/60.00s (65.7%) | dt=0.2574s
369.8s 4695 [PROGRESS] Step 200: t=52.27/60.00s (87.1%) | dt=0.2572s
369.9s 4696 [WARNING] Automatic CFL correction applied (count: 25800):
369.9s 4697 Calculated CFL: 0.800 > Limit: 0.500
369.9s 4698 Original dt: 4.115220e-01 s
369.9s 4699 Corrected dt: 2.572013e-01 s
369.9s 4700 Correction factor: 1.6x
369.9s 4701 Max wave speed detected: 19.44 m/s
370.1s 4702 Stored output at t = 60.0000 s (Step 231)
370.1s 4703 
370.1s 4704 Simulation finished at t = 60.0000 s after 231 steps.
370.1s 4705 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.00s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.00s/s]
370.1s 4706 Total runtime: 2.07 seconds.
370.1s 4707 2025-10-10 14:20:56 - INFO - run_control_simulation:384 -   Reward: 0.015201
370.1s 4708 2025-10-10 14:20:56 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
370.1s 4709 2025-10-10 14:20:56 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
370.1s 4710 2025-10-10 14:20:56 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
370.1s 4711 2025-10-10 14:20:56 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.609084e+00, max=1.233795e+01, std=4.039166e+00
370.1s 4712 2025-10-10 14:20:56 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.036794, rho_c=0.049919
370.1s 4713 2025-10-10 14:20:56 - INFO - run_control_simulation:414 -     Mean velocities: w_m=13.262455, w_c=11.210112
370.1s 4714 2025-10-10 14:20:56 - INFO - run_control_simulation:418 -   State hash: 3083460243079229549
370.1s 4715 2025-10-10 14:20:56 - INFO - run_control_simulation:420 - ================================================================================
370.1s 4716 [STEP 1/11] action=0.0000, reward=0.0152, t=60.0s, state_diff=3.609084e+00
370.1s 4717 2025-10-10 14:20:56 - INFO - run_control_simulation:368 - ================================================================================
370.1s 4718 2025-10-10 14:20:56 - INFO - run_control_simulation:369 - STEP 1 START:
370.1s 4719 2025-10-10 14:20:56 - INFO - run_control_simulation:370 -   Controller: RLController
370.1s 4720 2025-10-10 14:20:56 - INFO - run_control_simulation:371 -   Action: 0.000000
370.1s 4721 2025-10-10 14:20:56 - INFO - run_control_simulation:372 -   Simulation time: 60.00s
370.1s 4722 [BC UPDATE] left → phase 0 RED (reduced inflow)
370.1s 4723 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
370.1s 4724 Running simulation until t = 120.00 s, outputting every 60.00 s
370.3s 4725 [PROGRESS] Step 250: t=64.89/120.00s (54.1%) | dt=0.2572s
370.8s 4726 [PROGRESS] Step 300: t=77.75/120.00s (64.8%) | dt=0.2572s
370.9s 4727 [WARNING] Automatic CFL correction applied (count: 25900):
370.9s 4728 Calculated CFL: 0.800 > Limit: 0.500
370.9s 4729 Original dt: 4.114985e-01 s
370.9s 4730 Corrected dt: 2.571865e-01 s
370.9s 4731 Correction factor: 1.6x
370.9s 4732 Max wave speed detected: 19.44 m/s
371.2s 4733 [PROGRESS] Step 350: t=90.61/120.00s (75.5%) | dt=0.2572s
371.7s 4734 [PROGRESS] Step 400: t=103.46/120.00s (86.2%) | dt=0.2572s
371.8s 4735 [WARNING] Automatic CFL correction applied (count: 26000):
371.8s 4736 Calculated CFL: 0.800 > Limit: 0.500
371.8s 4737 Original dt: 4.114980e-01 s
371.8s 4738 Corrected dt: 2.571863e-01 s
371.8s 4739 Correction factor: 1.6x
371.8s 4740 Max wave speed detected: 19.44 m/s
372.1s 4741 [PROGRESS] Step 450: t=116.32/120.00s (96.9%) | dt=0.2572s
372.3s 4742 Stored output at t = 120.0000 s (Step 465)
372.3s 4743 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
372.3s 4744 
372.3s 4745 Simulation finished at t = 120.0000 s after 465 steps.
372.3s 4746 Total runtime: 2.14 seconds.
372.3s 4747 2025-10-10 14:20:58 - INFO - run_control_simulation:384 -   Reward: 0.015200
372.3s 4748 2025-10-10 14:20:58 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
372.3s 4749 2025-10-10 14:20:58 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
372.3s 4750 2025-10-10 14:20:58 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
372.3s 4751 2025-10-10 14:20:58 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.857588e+00, max=1.460993e+01, std=3.873582e+00
372.3s 4752 2025-10-10 14:20:58 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.008375, rho_c=0.025617
372.3s 4753 2025-10-10 14:20:58 - INFO - run_control_simulation:414 -     Mean velocities: w_m=16.773789, w_c=13.986264
372.3s 4754 2025-10-10 14:20:58 - INFO - run_control_simulation:418 -   State hash: -5730942638293569198
372.3s 4755 2025-10-10 14:20:58 - INFO - run_control_simulation:420 - ================================================================================
372.3s 4756 [STEP 2/11] action=0.0000, reward=0.0152, t=120.0s, state_diff=1.857588e+00
372.3s 4757 2025-10-10 14:20:58 - INFO - run_control_simulation:368 - ================================================================================
372.3s 4758 2025-10-10 14:20:58 - INFO - run_control_simulation:369 - STEP 2 START:
372.3s 4759 2025-10-10 14:20:58 - INFO - run_control_simulation:370 -   Controller: RLController
372.3s 4760 2025-10-10 14:20:58 - INFO - run_control_simulation:371 -   Action: 0.000000
372.3s 4761 2025-10-10 14:20:58 - INFO - run_control_simulation:372 -   Simulation time: 120.00s
372.3s 4762 [BC UPDATE] left → phase 0 RED (reduced inflow)
372.3s 4763 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
372.3s 4764 Running simulation until t = 180.00 s, outputting every 60.00 s
372.6s 4765 [PROGRESS] Step 500: t=129.00/180.00s (71.7%) | dt=0.2572s
372.7s 4766 [WARNING] Automatic CFL correction applied (count: 26100):
372.7s 4767 Calculated CFL: 0.800 > Limit: 0.500
372.7s 4768 Original dt: 4.114980e-01 s
372.7s 4769 Corrected dt: 2.571863e-01 s
372.7s 4770 Correction factor: 1.6x
372.7s 4771 Max wave speed detected: 19.44 m/s
373.1s 4772 [PROGRESS] Step 550: t=141.86/180.00s (78.8%) | dt=0.2572s
373.5s 4773 [PROGRESS] Step 600: t=154.72/180.00s (86.0%) | dt=0.2572s
373.6s 4774 [WARNING] Automatic CFL correction applied (count: 26200):
373.6s 4775 Calculated CFL: 0.800 > Limit: 0.500
373.6s 4776 Original dt: 4.114980e-01 s
373.6s 4777 Corrected dt: 2.571863e-01 s
373.6s 4778 Correction factor: 1.6x
373.6s 4779 Max wave speed detected: 19.44 m/s
374.0s 4780 [PROGRESS] Step 650: t=167.58/180.00s (93.1%) | dt=0.2572s
374.4s 4781 Stored output at t = 180.0000 s (Step 699)
374.4s 4782 
374.4s 4783 Simulation finished at t = 180.0000 s after 699 steps.
374.4s 4784 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.34s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.34s/s]
374.4s 4785 Total runtime: 2.12 seconds.
374.4s 4786 2025-10-10 14:21:00 - INFO - run_control_simulation:384 -   Reward: 0.015200
374.4s 4787 2025-10-10 14:21:00 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
374.4s 4788 2025-10-10 14:21:00 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
374.4s 4789 2025-10-10 14:21:00 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
374.4s 4790 2025-10-10 14:21:00 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.176176e+00, max=5.474976e+00, std=1.995692e+00
374.4s 4791 2025-10-10 14:21:00 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002332
374.4s 4792 2025-10-10 14:21:00 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.137456, w_c=16.297585
374.4s 4793 2025-10-10 14:21:00 - INFO - run_control_simulation:418 -   State hash: -5882412441307498058
374.4s 4794 2025-10-10 14:21:00 - INFO - run_control_simulation:420 - ================================================================================
374.4s 4795 [STEP 3/11] action=0.0000, reward=0.0152, t=180.0s, state_diff=1.176176e+00
374.4s 4796 2025-10-10 14:21:00 - INFO - run_control_simulation:368 - ================================================================================
374.4s 4797 2025-10-10 14:21:00 - INFO - run_control_simulation:369 - STEP 3 START:
374.4s 4798 2025-10-10 14:21:00 - INFO - run_control_simulation:370 -   Controller: RLController
374.4s 4799 2025-10-10 14:21:00 - INFO - run_control_simulation:371 -   Action: 0.000000
374.4s 4800 2025-10-10 14:21:00 - INFO - run_control_simulation:372 -   Simulation time: 180.00s
374.4s 4801 [BC UPDATE] left → phase 0 RED (reduced inflow)
374.4s 4802 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
374.4s 4803 Running simulation until t = 240.00 s, outputting every 60.00 s
374.4s 4804 [PROGRESS] Step 700: t=180.26/240.00s (75.1%) | dt=0.2572s
374.5s 4805 [WARNING] Automatic CFL correction applied (count: 26300):
374.5s 4806 Calculated CFL: 0.800 > Limit: 0.500
374.5s 4807 Original dt: 4.114980e-01 s
374.5s 4808 Corrected dt: 2.571863e-01 s
374.5s 4809 Correction factor: 1.6x
374.5s 4810 Max wave speed detected: 19.44 m/s
374.8s 4811 [PROGRESS] Step 750: t=193.12/240.00s (80.5%) | dt=0.2572s
375.3s 4812 [PROGRESS] Step 800: t=205.98/240.00s (85.8%) | dt=0.2572s
375.4s 4813 [WARNING] Automatic CFL correction applied (count: 26400):
375.4s 4814 Calculated CFL: 0.800 > Limit: 0.500
375.4s 4815 Original dt: 4.114980e-01 s
375.4s 4816 Corrected dt: 2.571863e-01 s
375.4s 4817 Correction factor: 1.6x
375.4s 4818 Max wave speed detected: 19.44 m/s
375.7s 4819 [PROGRESS] Step 850: t=218.84/240.00s (91.2%) | dt=0.2572s
376.2s 4820 [PROGRESS] Step 900: t=231.69/240.00s (96.5%) | dt=0.2572s
376.3s 4821 [WARNING] Automatic CFL correction applied (count: 26500):
376.3s 4822 Calculated CFL: 0.800 > Limit: 0.500
376.3s 4823 Original dt: 4.114980e-01 s
376.3s 4824 Corrected dt: 2.571863e-01 s
376.3s 4825 Correction factor: 1.6x
376.3s 4826 Max wave speed detected: 19.44 m/s
376.5s 4827 Stored output at t = 240.0000 s (Step 933)
376.5s 4828 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.60s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.60s/s]
376.5s 4829 
376.5s 4830 Simulation finished at t = 240.0000 s after 933 steps.
376.5s 4831 Total runtime: 2.10 seconds.
376.5s 4832 2025-10-10 14:21:03 - INFO - run_control_simulation:384 -   Reward: 0.015200
376.5s 4833 2025-10-10 14:21:03 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
376.5s 4834 2025-10-10 14:21:03 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
376.5s 4835 2025-10-10 14:21:03 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
376.5s 4836 2025-10-10 14:21:03 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.779824e-03, max=2.637589e-01, std=3.528727e-02
376.5s 4837 2025-10-10 14:21:03 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
376.5s 4838 2025-10-10 14:21:03 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331146
376.5s 4839 2025-10-10 14:21:03 - INFO - run_control_simulation:418 -   State hash: 1877001135921852328
376.5s 4840 2025-10-10 14:21:03 - INFO - run_control_simulation:420 - ================================================================================
376.5s 4841 [STEP 4/11] action=0.0000, reward=0.0152, t=240.0s, state_diff=8.779824e-03
376.5s 4842 2025-10-10 14:21:03 - INFO - run_control_simulation:368 - ================================================================================
376.5s 4843 2025-10-10 14:21:03 - INFO - run_control_simulation:369 - STEP 4 START:
376.5s 4844 2025-10-10 14:21:03 - INFO - run_control_simulation:370 -   Controller: RLController
376.5s 4845 2025-10-10 14:21:03 - INFO - run_control_simulation:371 -   Action: 0.000000
376.5s 4846 2025-10-10 14:21:03 - INFO - run_control_simulation:372 -   Simulation time: 240.00s
376.5s 4847 [BC UPDATE] left → phase 0 RED (reduced inflow)
376.5s 4848 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
376.5s 4849 Running simulation until t = 300.00 s, outputting every 60.00 s
376.6s 4850 [PROGRESS] Step 950: t=244.37/300.00s (81.5%) | dt=0.2572s
377.1s 4851 [PROGRESS] Step 1000: t=257.23/300.00s (85.7%) | dt=0.2572s
377.2s 4852 [WARNING] Automatic CFL correction applied (count: 26600):
377.2s 4853 Calculated CFL: 0.800 > Limit: 0.500
377.2s 4854 Original dt: 4.114980e-01 s
377.2s 4855 Corrected dt: 2.571863e-01 s
377.2s 4856 Correction factor: 1.6x
377.2s 4857 Max wave speed detected: 19.44 m/s
377.5s 4858 [PROGRESS] Step 1050: t=270.09/300.00s (90.0%) | dt=0.2572s
378.0s 4859 [PROGRESS] Step 1100: t=282.95/300.00s (94.3%) | dt=0.2572s
378.1s 4860 [WARNING] Automatic CFL correction applied (count: 26700):
378.1s 4861 Calculated CFL: 0.800 > Limit: 0.500
378.1s 4862 Original dt: 4.114980e-01 s
378.1s 4863 Corrected dt: 2.571863e-01 s
378.1s 4864 Correction factor: 1.6x
378.1s 4865 Max wave speed detected: 19.44 m/s
378.4s 4866 [PROGRESS] Step 1150: t=295.81/300.00s (98.6%) | dt=0.2572s
378.6s 4867 Stored output at t = 300.0000 s (Step 1167)
378.6s 4868 
378.6s 4869 Simulation finished at t = 300.0000 s after 1167 steps.
378.6s 4870 Total runtime: 2.10 seconds.
378.6s 4871 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.57s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.56s/s]
378.6s 4872 2025-10-10 14:21:05 - INFO - run_control_simulation:384 -   Reward: 0.015200
378.6s 4873 2025-10-10 14:21:05 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
378.6s 4874 2025-10-10 14:21:05 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
378.6s 4875 2025-10-10 14:21:05 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
378.6s 4876 2025-10-10 14:21:05 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.179622e-05, max=3.731510e-04, std=4.983819e-05
378.6s 4877 2025-10-10 14:21:05 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
378.6s 4878 2025-10-10 14:21:05 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
378.6s 4879 2025-10-10 14:21:05 - INFO - run_control_simulation:418 -   State hash: -3911155490279929027
378.6s 4880 2025-10-10 14:21:05 - INFO - run_control_simulation:420 - ================================================================================
378.6s 4881 [STEP 5/11] action=0.0000, reward=0.0152, t=300.0s, state_diff=1.179622e-05
378.6s 4882 2025-10-10 14:21:05 - INFO - run_control_simulation:368 - ================================================================================
378.6s 4883 2025-10-10 14:21:05 - INFO - run_control_simulation:369 - STEP 5 START:
378.6s 4884 2025-10-10 14:21:05 - INFO - run_control_simulation:370 -   Controller: RLController
378.6s 4885 2025-10-10 14:21:05 - INFO - run_control_simulation:371 -   Action: 0.000000
378.6s 4886 2025-10-10 14:21:05 - INFO - run_control_simulation:372 -   Simulation time: 300.00s
378.6s 4887 [BC UPDATE] left → phase 0 RED (reduced inflow)
378.6s 4888 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
378.6s 4889 Running simulation until t = 360.00 s, outputting every 60.00 s
378.9s 4890 [PROGRESS] Step 1200: t=308.49/360.00s (85.7%) | dt=0.2572s
379.0s 4891 [WARNING] Automatic CFL correction applied (count: 26800):
379.0s 4892 Calculated CFL: 0.800 > Limit: 0.500
379.0s 4893 Original dt: 4.114980e-01 s
379.0s 4894 Corrected dt: 2.571863e-01 s
379.0s 4895 Correction factor: 1.6x
379.0s 4896 Max wave speed detected: 19.44 m/s
379.3s 4897 [PROGRESS] Step 1250: t=321.35/360.00s (89.3%) | dt=0.2572s
379.8s 4898 [PROGRESS] Step 1300: t=334.21/360.00s (92.8%) | dt=0.2572s
379.9s 4899 [WARNING] Automatic CFL correction applied (count: 26900):
379.9s 4900 Calculated CFL: 0.800 > Limit: 0.500
379.9s 4901 Original dt: 4.114980e-01 s
379.9s 4902 Corrected dt: 2.571863e-01 s
379.9s 4903 Correction factor: 1.6x
379.9s 4904 Max wave speed detected: 19.44 m/s
380.2s 4905 [PROGRESS] Step 1350: t=347.07/360.00s (96.4%) | dt=0.2572s
380.7s 4906 [PROGRESS] Step 1400: t=359.92/360.00s (100.0%) | dt=0.2572s
380.7s 4907 Stored output at t = 360.0000 s (Step 1401)
380.7s 4908 
380.7s 4909 Simulation finished at t = 360.0000 s after 1401 steps.
380.7s 4910 Total runtime: 2.11 seconds.
380.7s 4911 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.49s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.49s/s]
380.7s 4912 2025-10-10 14:21:07 - INFO - run_control_simulation:384 -   Reward: 0.015200
380.7s 4913 2025-10-10 14:21:07 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
380.7s 4914 2025-10-10 14:21:07 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
380.7s 4915 2025-10-10 14:21:07 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
380.7s 4916 2025-10-10 14:21:07 - INFO - run_control_simulation:403 -     Diff statistics: mean=1.649700e-08, max=5.259947e-07, std=7.009071e-08
380.7s 4917 2025-10-10 14:21:07 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
380.7s 4918 2025-10-10 14:21:07 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
380.7s 4919 2025-10-10 14:21:07 - INFO - run_control_simulation:418 -   State hash: 7477816241282538612
380.7s 4920 2025-10-10 14:21:07 - INFO - run_control_simulation:420 - ================================================================================
380.7s 4921 [STEP 6/11] action=0.0000, reward=0.0152, t=360.0s, state_diff=1.649700e-08
380.7s 4922 2025-10-10 14:21:07 - INFO - run_control_simulation:368 - ================================================================================
380.7s 4923 2025-10-10 14:21:07 - INFO - run_control_simulation:369 - STEP 6 START:
380.7s 4924 2025-10-10 14:21:07 - INFO - run_control_simulation:370 -   Controller: RLController
380.7s 4925 2025-10-10 14:21:07 - INFO - run_control_simulation:371 -   Action: 0.000000
380.7s 4926 2025-10-10 14:21:07 - INFO - run_control_simulation:372 -   Simulation time: 360.00s
380.7s 4927 [BC UPDATE] left → phase 0 RED (reduced inflow)
380.7s 4928 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
380.7s 4929 Running simulation until t = 420.00 s, outputting every 60.00 s
380.8s 4930 [WARNING] Automatic CFL correction applied (count: 27000):
380.8s 4931 Calculated CFL: 0.800 > Limit: 0.500
380.8s 4932 Original dt: 4.114980e-01 s
380.8s 4933 Corrected dt: 2.571863e-01 s
380.8s 4934 Correction factor: 1.6x
380.8s 4935 Max wave speed detected: 19.44 m/s
381.2s 4936 [PROGRESS] Step 1450: t=372.60/420.00s (88.7%) | dt=0.2572s
381.6s 4937 [PROGRESS] Step 1500: t=385.46/420.00s (91.8%) | dt=0.2572s
381.7s 4938 [WARNING] Automatic CFL correction applied (count: 27100):
381.7s 4939 Calculated CFL: 0.800 > Limit: 0.500
381.7s 4940 Original dt: 4.114980e-01 s
381.7s 4941 Corrected dt: 2.571863e-01 s
381.7s 4942 Correction factor: 1.6x
381.7s 4943 Max wave speed detected: 19.44 m/s
382.1s 4944 [PROGRESS] Step 1550: t=398.32/420.00s (94.8%) | dt=0.2572s
382.5s 4945 [PROGRESS] Step 1600: t=411.18/420.00s (97.9%) | dt=0.2572s
382.6s 4946 [WARNING] Automatic CFL correction applied (count: 27200):
382.6s 4947 Calculated CFL: 0.800 > Limit: 0.500
382.6s 4948 Original dt: 4.114980e-01 s
382.6s 4949 Corrected dt: 2.571863e-01 s
382.6s 4950 Correction factor: 1.6x
382.6s 4951 Max wave speed detected: 19.44 m/s
382.8s 4952 Stored output at t = 420.0000 s (Step 1635)
382.8s 4953 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.57s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.57s/s]
382.8s 4954 
382.8s 4955 Simulation finished at t = 420.0000 s after 1635 steps.
382.8s 4956 Total runtime: 2.10 seconds.
382.8s 4957 2025-10-10 14:21:09 - INFO - run_control_simulation:384 -   Reward: 0.015200
382.8s 4958 2025-10-10 14:21:09 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
382.8s 4959 2025-10-10 14:21:09 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
382.8s 4960 2025-10-10 14:21:09 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
382.8s 4961 2025-10-10 14:21:09 - INFO - run_control_simulation:403 -     Diff statistics: mean=2.295402e-11, max=7.384955e-10, std=9.818588e-11
382.8s 4962 2025-10-10 14:21:09 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
382.8s 4963 2025-10-10 14:21:09 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
382.8s 4964 2025-10-10 14:21:09 - INFO - run_control_simulation:418 -   State hash: 744103476397897073
382.8s 4965 2025-10-10 14:21:09 - INFO - run_control_simulation:420 - ================================================================================
382.8s 4966 [STEP 7/11] action=0.0000, reward=0.0152, t=420.0s, state_diff=2.295402e-11
382.8s 4967 2025-10-10 14:21:09 - INFO - run_control_simulation:368 - ================================================================================
382.8s 4968 2025-10-10 14:21:09 - INFO - run_control_simulation:369 - STEP 7 START:
382.8s 4969 2025-10-10 14:21:09 - INFO - run_control_simulation:370 -   Controller: RLController
382.8s 4970 2025-10-10 14:21:09 - INFO - run_control_simulation:371 -   Action: 0.000000
382.8s 4971 2025-10-10 14:21:09 - INFO - run_control_simulation:372 -   Simulation time: 420.00s
382.8s 4972 [BC UPDATE] left → phase 0 RED (reduced inflow)
382.8s 4973 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
382.8s 4974 Running simulation until t = 480.00 s, outputting every 60.00 s
383.0s 4975 [PROGRESS] Step 1650: t=423.86/480.00s (88.3%) | dt=0.2572s
383.4s 4976 [PROGRESS] Step 1700: t=436.72/480.00s (91.0%) | dt=0.2572s
383.5s 4977 [WARNING] Automatic CFL correction applied (count: 27300):
383.5s 4978 Calculated CFL: 0.800 > Limit: 0.500
383.5s 4979 Original dt: 4.114980e-01 s
383.5s 4980 Corrected dt: 2.571863e-01 s
383.5s 4981 Correction factor: 1.6x
383.5s 4982 Max wave speed detected: 19.44 m/s
383.9s 4983 [PROGRESS] Step 1750: t=449.58/480.00s (93.7%) | dt=0.2572s
384.3s 4984 [PROGRESS] Step 1800: t=462.44/480.00s (96.3%) | dt=0.2572s
384.4s 4985 [WARNING] Automatic CFL correction applied (count: 27400):
384.4s 4986 Calculated CFL: 0.800 > Limit: 0.500
384.4s 4987 Original dt: 4.114980e-01 s
384.4s 4988 Corrected dt: 2.571863e-01 s
384.4s 4989 Correction factor: 1.6x
384.4s 4990 Max wave speed detected: 19.44 m/s
384.8s 4991 [PROGRESS] Step 1850: t=475.30/480.00s (99.0%) | dt=0.2572s
385.0s 4992 Stored output at t = 480.0000 s (Step 1869)
385.0s 4993 
385.0s 4994 Simulation finished at t = 480.0000 s after 1869 steps.
385.0s 4995 Total runtime: 2.15 seconds.
385.0s 4996 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.96s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.96s/s]
385.0s 4997 2025-10-10 14:21:11 - INFO - run_control_simulation:384 -   Reward: 0.015200
385.0s 4998 2025-10-10 14:21:11 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
385.0s 4999 2025-10-10 14:21:11 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
385.0s 5000 2025-10-10 14:21:11 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
385.0s 5001 2025-10-10 14:21:11 - INFO - run_control_simulation:403 -     Diff statistics: mean=3.177812e-14, max=1.019629e-12, std=1.360814e-13
385.0s 5002 2025-10-10 14:21:11 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
385.0s 5003 2025-10-10 14:21:11 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
385.0s 5004 2025-10-10 14:21:11 - INFO - run_control_simulation:418 -   State hash: 9066405651374024830
385.0s 5005 2025-10-10 14:21:11 - INFO - run_control_simulation:420 - ================================================================================
385.0s 5006 [STEP 8/11] action=0.0000, reward=0.0152, t=480.0s, state_diff=3.177812e-14
385.0s 5007 2025-10-10 14:21:11 - INFO - run_control_simulation:368 - ================================================================================
385.0s 5008 2025-10-10 14:21:11 - INFO - run_control_simulation:369 - STEP 8 START:
385.0s 5009 2025-10-10 14:21:11 - INFO - run_control_simulation:370 -   Controller: RLController
385.0s 5010 2025-10-10 14:21:11 - INFO - run_control_simulation:371 -   Action: 0.000000
385.0s 5011 2025-10-10 14:21:11 - INFO - run_control_simulation:372 -   Simulation time: 480.00s
385.0s 5012 [BC UPDATE] left → phase 0 RED (reduced inflow)
385.0s 5013 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
385.0s 5014 Running simulation until t = 540.00 s, outputting every 60.00 s
385.3s 5015 [PROGRESS] Step 1900: t=487.97/540.00s (90.4%) | dt=0.2572s
385.4s 5016 [WARNING] Automatic CFL correction applied (count: 27500):
385.4s 5017 Calculated CFL: 0.800 > Limit: 0.500
385.4s 5018 Original dt: 4.114980e-01 s
385.4s 5019 Corrected dt: 2.571863e-01 s
385.4s 5020 Correction factor: 1.6x
385.4s 5021 Max wave speed detected: 19.44 m/s
385.7s 5022 [PROGRESS] Step 1950: t=500.83/540.00s (92.7%) | dt=0.2572s
386.2s 5023 [PROGRESS] Step 2000: t=513.69/540.00s (95.1%) | dt=0.2572s
386.3s 5024 [WARNING] Automatic CFL correction applied (count: 27600):
386.3s 5025 Calculated CFL: 0.800 > Limit: 0.500
386.3s 5026 Original dt: 4.114980e-01 s
386.3s 5027 Corrected dt: 2.571863e-01 s
386.3s 5028 Correction factor: 1.6x
386.3s 5029 Max wave speed detected: 19.44 m/s
386.7s 5030 [PROGRESS] Step 2050: t=526.55/540.00s (97.5%) | dt=0.2572s
387.1s 5031 [PROGRESS] Step 2100: t=539.41/540.00s (99.9%) | dt=0.2572s
387.1s 5032 Stored output at t = 540.0000 s (Step 2103)
387.1s 5033 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 27.59s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 27.59s/s]
387.1s 5034 
387.1s 5035 Simulation finished at t = 540.0000 s after 2103 steps.
387.1s 5036 Total runtime: 2.18 seconds.
387.1s 5037 2025-10-10 14:21:13 - INFO - run_control_simulation:384 -   Reward: 0.015200
387.1s 5038 2025-10-10 14:21:13 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: False
387.1s 5039 2025-10-10 14:21:13 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
387.1s 5040 2025-10-10 14:21:13 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
387.1s 5041 2025-10-10 14:21:13 - INFO - run_control_simulation:403 -     Diff statistics: mean=8.967213e-17, max=1.065814e-14, std=7.283599e-16
387.1s 5042 2025-10-10 14:21:13 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
387.1s 5043 2025-10-10 14:21:13 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
387.1s 5044 2025-10-10 14:21:13 - INFO - run_control_simulation:418 -   State hash: -2198400194523866312
387.1s 5045 2025-10-10 14:21:13 - INFO - run_control_simulation:420 - ================================================================================
387.1s 5046 [STEP 9/11] action=0.0000, reward=0.0152, t=540.0s, state_diff=8.967213e-17
387.1s 5047 2025-10-10 14:21:13 - INFO - run_control_simulation:368 - ================================================================================
387.1s 5048 2025-10-10 14:21:13 - INFO - run_control_simulation:369 - STEP 9 START:
387.1s 5049 2025-10-10 14:21:13 - INFO - run_control_simulation:370 -   Controller: RLController
387.1s 5050 2025-10-10 14:21:13 - INFO - run_control_simulation:371 -   Action: 0.000000
387.1s 5051 2025-10-10 14:21:13 - INFO - run_control_simulation:372 -   Simulation time: 540.00s
387.1s 5052 [BC UPDATE] left → phase 0 RED (reduced inflow)
387.1s 5053 └─ Inflow state: rho_m=0.1000, w_m=7.5, rho_c=0.1200, w_c=6.0
387.1s 5054 Running simulation until t = 600.00 s, outputting every 60.00 s
387.2s 5055 [WARNING] Automatic CFL correction applied (count: 27700):
387.2s 5056 Calculated CFL: 0.800 > Limit: 0.500
387.2s 5057 Original dt: 4.114980e-01 s
387.2s 5058 Corrected dt: 2.571863e-01 s
387.2s 5059 Correction factor: 1.6x
387.2s 5060 Max wave speed detected: 19.44 m/s
387.6s 5061 [PROGRESS] Step 2150: t=552.09/600.00s (92.0%) | dt=0.2572s
388.0s 5062 [PROGRESS] Step 2200: t=564.95/600.00s (94.2%) | dt=0.2572s
388.1s 5063 [WARNING] Automatic CFL correction applied (count: 27800):
388.1s 5064 Calculated CFL: 0.800 > Limit: 0.500
388.1s 5065 Original dt: 4.114980e-01 s
388.1s 5066 Corrected dt: 2.571863e-01 s
388.1s 5067 Correction factor: 1.6x
388.1s 5068 Max wave speed detected: 19.44 m/s
388.5s 5069 [PROGRESS] Step 2250: t=577.81/600.00s (96.3%) | dt=0.2572s
388.9s 5070 [PROGRESS] Step 2300: t=590.67/600.00s (98.4%) | dt=0.2572s
389.1s 5071 [WARNING] Automatic CFL correction applied (count: 27900):
389.1s 5072 Calculated CFL: 0.800 > Limit: 0.500
389.1s 5073 Original dt: 4.114980e-01 s
389.1s 5074 Corrected dt: 2.571863e-01 s
389.1s 5075 Correction factor: 1.6x
389.1s 5076 Max wave speed detected: 19.44 m/s
389.3s 5077 Stored output at t = 600.0000 s (Step 2337)
389.3s 5078 
389.3s 5079 Simulation finished at t = 600.0000 s after 2337 steps.
389.3s 5080 Total runtime: 2.13 seconds.
389.3s 5081 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.19s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.19s/s]
389.3s 5082 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
389.3s 5083 2025-10-10 14:21:15 - INFO - run_control_simulation:384 -   Reward: 0.015200
389.3s 5084 2025-10-10 14:21:15 - INFO - run_control_simulation:385 -   Terminated: False, Truncated: True
389.3s 5085 2025-10-10 14:21:15 - INFO - run_control_simulation:401 -   STATE EVOLUTION:
389.3s 5086 2025-10-10 14:21:15 - INFO - run_control_simulation:402 -     Before shape: (4, 104), After shape: (4, 104)
389.3s 5087 2025-10-10 14:21:15 - INFO - run_control_simulation:403 -     Diff statistics: mean=6.832193e-17, max=3.552714e-15, std=4.879124e-16
389.3s 5088 2025-10-10 14:21:15 - INFO - run_control_simulation:413 -     Mean densities: rho_m=0.001944, rho_c=0.002331
389.3s 5089 2025-10-10 14:21:15 - INFO - run_control_simulation:414 -     Mean velocities: w_m=19.139014, w_c=16.331193
389.3s 5090 2025-10-10 14:21:15 - INFO - run_control_simulation:418 -   State hash: -4213464003087667011
389.3s 5091 2025-10-10 14:21:15 - INFO - run_control_simulation:420 - ================================================================================
389.3s 5092 [STEP 10/11] action=0.0000, reward=0.0152, t=600.0s, state_diff=6.832193e-17
389.3s 5093 
389.3s 5094 [SIMULATION COMPLETED] Summary:
389.3s 5095 - Total control steps: 10
389.3s 5096 - Total reward: 0.15
389.3s 5097 - Avg step time: 2.123s (device=gpu)
389.3s 5098 - Simulated time: 600.0s / 600.0s
389.3s 5099 - Wallclock time: 21.2s
389.3s 5100 - Speed ratio: 28.26x real-time
389.3s 5101 
389.3s 5102 2025-10-10 14:21:15 - INFO - run_control_simulation:455 -
389.3s 5103 [SIMULATION COMPLETED] Summary:
389.3s 5104 - Total control steps: 10
389.3s 5105 - Total reward: 0.15
389.3s 5106 - Avg step time: 2.123s (device=gpu)
389.3s 5107 - Simulated time: 600.0s / 600.0s
389.3s 5108 - Wallclock time: 21.2s
389.3s 5109 - Speed ratio: 28.26x real-time
389.3s 5110 
389.3s 5111 2025-10-10 14:21:15 - INFO - run_control_simulation:456 - Returning 10 state snapshots
389.3s 5112 2025-10-10 14:21:15 - INFO - run_performance_comparison:762 - RL states copied: 10 snapshots
389.3s 5113 2025-10-10 14:21:15 - INFO - run_performance_comparison:763 - RL FIRST state hash: 3083460243079229549
389.3s 5114 2025-10-10 14:21:15 - INFO - run_performance_comparison:764 - RL LAST state hash: -4213464003087667011
389.3s 5115 2025-10-10 14:21:15 - INFO - run_performance_comparison:765 - RL first state sample: rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
389.3s 5116 2.14351577e-05]
389.3s 5117 2025-10-10 14:21:15 - INFO - run_performance_comparison:766 - RL last state sample: rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
389.3s 5118 2.14319923e-05]
389.3s 5119 2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:470 - Evaluating performance with 10 state snapshots
389.3s 5120 2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:471 -   HASH CHECK - first=3083460243079229549, last=-4213464003087667011
389.3s 5121 2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:480 - First state sample - rho_m[10:15]=[2.14330333e-05 2.14326924e-05 2.14328734e-05 2.14335496e-05
389.3s 5122 2.14351577e-05], w_m[10:15]=[19.44027283 19.44063592 19.44056466 19.44013042 19.43904629]
389.3s 5123 2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:482 - Last state sample - rho_m[10:15]=[2.14327742e-05 2.14322452e-05 2.14320699e-05 2.14320117e-05
389.3s 5124 2.14319923e-05], w_m[10:15]=[19.44044335 19.44092683 19.44108704 19.44114021 19.44115789]
389.3s 5125 2025-10-10 14:21:15 - INFO - evaluate_traffic_performance:536 - Calculated metrics: flow=34.400771, efficiency=5.504123, delay=-179.85s
389.3s 5126 2025-10-10 14:21:15 - WARNING - run_performance_comparison:774 - States comparison - Identical: False, baseline_hash=8409791264894250498, rl_hash=3083460243079229549
389.3s 5127 2025-10-10 14:21:15 - INFO - run_performance_comparison:783 - Baseline performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
389.3s 5128 2025-10-10 14:21:15 - INFO - run_performance_comparison:784 - RL performance: {'total_flow': 34.40077120076587, 'avg_speed': 631930.1184463983, 'avg_density': 0.01150449841373579, 'efficiency': 5.504123392122539, 'delay': -179.84820284063275, 'throughput': 172003.85600382934}
389.3s 5129 2025-10-10 14:21:15 - INFO - run_performance_comparison:792 - Flow improvement: 0.000%
389.3s 5130 2025-10-10 14:21:15 - INFO - run_performance_comparison:793 - Efficiency improvement: 0.000%
389.3s 5131 2025-10-10 14:21:15 - INFO - run_performance_comparison:794 - Delay reduction: -0.000%
389.3s 5132 Flow improvement: 0.0%
389.3s 5133 Efficiency improvement: 0.0%
389.3s 5134 Delay reduction: -0.0%
389.3s 5135 Result: FAILED
389.3s 5136 
389.3s 5137 [FIGURES] Generating RL performance figures...
389.9s 5138 [OK] fig_rl_performance_improvements.png
390.4s 5139 [OK] fig_rl_learning_curve.png
390.4s 5140 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
390.4s 5141 
390.4s 5142 [METRICS] Saving RL performance metrics...
390.4s 5143 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
390.4s 5144 
390.4s 5145 [LATEX] Generating content for Section 7.6...
390.4s 5146 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
390.4s 5147 
390.4s 5148 === RL Performance Validation Summary ===
390.4s 5149 Scenarios passed: 0/1 (0.0%)
390.4s 5150 Average flow improvement: 0.00%
390.4s 5151 Average efficiency improvement: 0.00%
390.4s 5152 Average delay reduction: 0.00%
390.4s 5153 Overall validation: FAILED
390.4s 5154 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
393.0s 5155 [WARNING] Tests returned code: 1
393.0s 5156 
393.0s 5157 [STEP 4/4] Copying artifacts and cleaning up...
393.0s 5158 [ARTIFACTS] Copying results for section_7_6_rl_performance...
393.0s 5159 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
393.0s 5160 [ARTIFACTS] NPZ files: 0
393.0s 5161 [ARTIFACTS] PNG figures: 2
393.0s 5162 [ARTIFACTS] YAML scenarios: 1
393.0s 5163 [ARTIFACTS] TEX files: 1
393.0s 5164 [ARTIFACTS] JSON files: 1
393.0s 5165 [ARTIFACTS] CSV metrics: 1
393.0s 5166 TRACKING_SUCCESS: Artifacts copied
393.0s 5167 [SUCCESS] All artifacts organized and copied
393.0s 5168 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
393.1s 5169 [OK] Cleanup completed - only validation results remain
393.1s 5170 TRACKING_SUCCESS: Cleanup completed
393.1s 5171 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
393.1s 5172 TRACKING_SUCCESS: Session summary created
393.1s 5173 
393.1s 5174 [FINAL] Validation workflow completed
393.1s 5175 Remote logging finalized - ready for download
393.1s 5176 
393.1s 5177 ================================================================================
393.1s 5178 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
393.1s 5179 Output ready at: /kaggle/working/validation_results/
393.1s 5180 ================================================================================
396.5s 5181 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
396.5s 5182 warn(
396.5s 5183 [NbConvertApp] Converting notebook __script__.ipynb to html
397.3s 5184 [NbConvertApp] Writing 321270 bytes to __results__.html