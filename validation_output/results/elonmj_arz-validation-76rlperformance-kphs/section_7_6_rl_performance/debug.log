2025-10-11 12:04:35 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-11 12:04:35 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-11 12:04:35 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-11 12:04:35 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-11 12:04:35 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-11 12:04:35 - INFO - train_rl_agent:580 - ================================================================================
2025-10-11 12:04:35 - INFO - train_rl_agent:581 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-11 12:04:35 - INFO - train_rl_agent:582 -   - Device: gpu
2025-10-11 12:04:35 - INFO - train_rl_agent:583 -   - Total timesteps: 100
2025-10-11 12:04:35 - INFO - train_rl_agent:584 -   - Episode max time: 120.0s
2025-10-11 12:04:35 - INFO - train_rl_agent:585 -   - Checkpoint frequency: 50
2025-10-11 12:04:35 - INFO - train_rl_agent:586 - ================================================================================
2025-10-11 12:04:35 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
2025-10-11 12:04:35 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-11 12:04:35 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
2025-10-11 12:04:35 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
2025-10-11 12:04:35 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
2025-10-11 12:07:56 - INFO - run_performance_comparison:718 - ================================================================================
2025-10-11 12:07:56 - INFO - run_performance_comparison:719 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-11 12:07:56 - INFO - run_performance_comparison:720 - Device: gpu
2025-10-11 12:07:56 - INFO - run_performance_comparison:721 - ================================================================================
2025-10-11 12:07:56 - INFO - run_performance_comparison:722 - ================================================================================
2025-10-11 12:07:56 - INFO - run_performance_comparison:723 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-11 12:07:56 - INFO - run_performance_comparison:724 - Device: gpu
2025-10-11 12:07:56 - INFO - run_performance_comparison:725 - ================================================================================
2025-10-11 12:07:56 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
2025-10-11 12:07:56 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-11 12:07:56 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
2025-10-11 12:07:56 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
2025-10-11 12:07:56 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
2025-10-11 12:07:56 - INFO - run_control_simulation:298 - ================================================================================
2025-10-11 12:07:56 - INFO - run_control_simulation:299 - Starting run_control_simulation:
2025-10-11 12:07:56 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-11 12:07:56 - INFO - run_control_simulation:301 -   - duration: 600.0s
2025-10-11 12:07:56 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
2025-10-11 12:07:56 - INFO - run_control_simulation:303 -   - device: gpu
2025-10-11 12:07:56 - INFO - run_control_simulation:304 -   - controller: BaselineController
2025-10-11 12:07:56 - INFO - run_control_simulation:305 -   - max_control_steps: 11
2025-10-11 12:07:56 - INFO - run_control_simulation:306 - ================================================================================
2025-10-11 12:07:56 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
2025-10-11 12:07:56 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
2025-10-11 12:07:56 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
2025-10-11 12:07:56 - INFO - run_control_simulation:343 - Calling env.reset()...
2025-10-11 12:07:56 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-11 12:07:56 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-11 12:07:56 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.907447e+00, std=6.995086e+00, min=4.000000e-02, max=1.500000e+01
2025-10-11 12:07:56 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
2025-10-11 12:07:56 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:07:56 - INFO - run_control_simulation:381 - STEP 0 START:
2025-10-11 12:07:56 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:07:56 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:07:56 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
2025-10-11 12:07:58 - INFO - run_control_simulation:396 -   Reward: 9.787752
2025-10-11 12:07:58 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:07:58 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:07:58 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:07:58 - INFO - run_control_simulation:415 -     Diff statistics: mean=8.619968e-01, max=1.005688e+01, std=1.113245e+00
2025-10-11 12:07:58 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.032403, rho_c=0.028677
2025-10-11 12:07:58 - INFO - run_control_simulation:426 -     Mean velocities: w_m=15.007668, w_c=12.482000
2025-10-11 12:07:58 - INFO - run_control_simulation:430 -   State hash: 1851909982427449296
2025-10-11 12:07:58 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:07:58 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:07:58 - INFO - run_control_simulation:381 - STEP 1 START:
2025-10-11 12:07:58 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:07:58 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 12:07:58 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
2025-10-11 12:08:00 - INFO - run_control_simulation:396 -   Reward: 9.888568
2025-10-11 12:08:00 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:00 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:00 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:00 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.172071e-01, max=4.163177e+00, std=1.476236e+00
2025-10-11 12:08:00 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.023042, rho_c=0.012327
2025-10-11 12:08:00 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.877726, w_c=14.179976
2025-10-11 12:08:00 - INFO - run_control_simulation:430 -   State hash: 4391127687009678368
2025-10-11 12:08:00 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:00 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:00 - INFO - run_control_simulation:381 - STEP 2 START:
2025-10-11 12:08:00 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:00 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:00 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
2025-10-11 12:08:02 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:02 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:02 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:02 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:02 - INFO - run_control_simulation:415 -     Diff statistics: mean=4.838870e-02, max=1.111111e+00, std=1.573226e-01
2025-10-11 12:08:02 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012122
2025-10-11 12:08:02 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947606, w_c=14.303308
2025-10-11 12:08:02 - INFO - run_control_simulation:430 -   State hash: 3581876939126460546
2025-10-11 12:08:02 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:02 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:02 - INFO - run_control_simulation:381 - STEP 3 START:
2025-10-11 12:08:02 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:02 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 12:08:02 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
2025-10-11 12:08:03 - INFO - run_control_simulation:396 -   Reward: 9.888570
2025-10-11 12:08:03 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:03 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:03 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:03 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.464630e-03, max=1.111111e+00, std=9.583689e-02
2025-10-11 12:08:03 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:03 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.926339, w_c=14.287647
2025-10-11 12:08:03 - INFO - run_control_simulation:430 -   State hash: 2718523319931028362
2025-10-11 12:08:03 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:03 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:03 - INFO - run_control_simulation:381 - STEP 4 START:
2025-10-11 12:08:03 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:03 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:03 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
2025-10-11 12:08:05 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:05 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:05 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:05 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:05 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348626e-03, max=1.111111e+00, std=9.584728e-02
2025-10-11 12:08:05 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:05 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:05 - INFO - run_control_simulation:430 -   State hash: -2138066457514312309
2025-10-11 12:08:05 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:05 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:05 - INFO - run_control_simulation:381 - STEP 5 START:
2025-10-11 12:08:05 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:05 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 12:08:05 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
2025-10-11 12:08:07 - INFO - run_control_simulation:396 -   Reward: 9.888570
2025-10-11 12:08:07 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:07 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:07 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:07 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348292e-03, max=1.111111e+00, std=9.584731e-02
2025-10-11 12:08:07 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:07 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.926339, w_c=14.287648
2025-10-11 12:08:07 - INFO - run_control_simulation:430 -   State hash: 3139341824050272052
2025-10-11 12:08:07 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:07 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:07 - INFO - run_control_simulation:381 - STEP 6 START:
2025-10-11 12:08:07 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:07 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:07 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
2025-10-11 12:08:09 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:09 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:09 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:09 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:09 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
2025-10-11 12:08:09 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:09 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:09 - INFO - run_control_simulation:430 -   State hash: 9115037911887300149
2025-10-11 12:08:09 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:09 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:09 - INFO - run_control_simulation:381 - STEP 7 START:
2025-10-11 12:08:09 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:09 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 12:08:09 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
2025-10-11 12:08:11 - INFO - run_control_simulation:396 -   Reward: 9.888570
2025-10-11 12:08:11 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:11 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:11 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:11 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
2025-10-11 12:08:11 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:11 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.926339, w_c=14.287648
2025-10-11 12:08:11 - INFO - run_control_simulation:430 -   State hash: 5406657113567480149
2025-10-11 12:08:11 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:11 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:11 - INFO - run_control_simulation:381 - STEP 8 START:
2025-10-11 12:08:11 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:11 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:11 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
2025-10-11 12:08:13 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:13 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:13 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:13 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:13 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
2025-10-11 12:08:13 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:13 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:13 - INFO - run_control_simulation:430 -   State hash: 9142667880907768474
2025-10-11 12:08:13 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:13 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:13 - INFO - run_control_simulation:381 - STEP 9 START:
2025-10-11 12:08:13 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 12:08:13 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 12:08:13 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
2025-10-11 12:08:15 - INFO - run_control_simulation:396 -   Reward: 9.888570
2025-10-11 12:08:15 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
2025-10-11 12:08:15 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:15 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:15 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
2025-10-11 12:08:15 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:15 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.926339, w_c=14.287648
2025-10-11 12:08:15 - INFO - run_control_simulation:430 -   State hash: 4603397241440497231
2025-10-11 12:08:15 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:15 - INFO - run_control_simulation:469 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: 98.38
    - Avg step time: 1.926s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 19.3s
    - Speed ratio: 31.16x real-time

2025-10-11 12:08:15 - INFO - run_control_simulation:470 - Returning 10 state snapshots
2025-10-11 12:08:15 - INFO - run_performance_comparison:743 - Baseline states copied: 10 snapshots
2025-10-11 12:08:15 - INFO - run_performance_comparison:744 - Baseline FIRST state hash: 1851909982427449296
2025-10-11 12:08:15 - INFO - run_performance_comparison:745 - Baseline LAST state hash: 4603397241440497231
2025-10-11 12:08:15 - INFO - run_performance_comparison:746 - Baseline first state sample: rho_m[10:15]=[0.02025646 0.02025153 0.02024988 0.02024973 0.02025033]
2025-10-11 12:08:15 - INFO - run_performance_comparison:747 - Baseline last state sample: rho_m[10:15]=[0.02025667 0.02025106 0.02024857 0.02024743 0.02024689]
2025-10-11 12:08:15 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
2025-10-11 12:08:15 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=1851909982427449296, last=4603397241440497231
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 0: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[0.02025646 0.02025153 0.02024988 0.02024973 0.02025033], w_m[10:15]=[17.43145435 17.43569326 17.4372029  17.43750496 17.43723442]
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 1: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 2: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 3: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 4: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 5: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 6: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 7: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 8: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - DEBUG - evaluate_traffic_performance:495 - State 9: shape=(4, 104), dtype=float64
2025-10-11 12:08:15 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[0.02025667 0.02025106 0.02024857 0.02024743 0.02024689], w_m[10:15]=[17.43153217 17.43628254 17.43839198 17.43935825 17.43981272]
2025-10-11 12:08:15 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=31.626612, efficiency=5.060258, delay=-175.05s
2025-10-11 12:08:15 - INFO - run_control_simulation:298 - ================================================================================
2025-10-11 12:08:15 - INFO - run_control_simulation:299 - Starting run_control_simulation:
2025-10-11 12:08:15 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-11 12:08:15 - INFO - run_control_simulation:301 -   - duration: 600.0s
2025-10-11 12:08:15 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
2025-10-11 12:08:15 - INFO - run_control_simulation:303 -   - device: gpu
2025-10-11 12:08:15 - INFO - run_control_simulation:304 -   - controller: RLController
2025-10-11 12:08:15 - INFO - run_control_simulation:305 -   - max_control_steps: 11
2025-10-11 12:08:15 - INFO - run_control_simulation:306 - ================================================================================
2025-10-11 12:08:15 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
2025-10-11 12:08:15 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
2025-10-11 12:08:15 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
2025-10-11 12:08:15 - INFO - run_control_simulation:343 - Calling env.reset()...
2025-10-11 12:08:15 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-11 12:08:15 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-11 12:08:15 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.907447e+00, std=6.995086e+00, min=4.000000e-02, max=1.500000e+01
2025-10-11 12:08:15 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
2025-10-11 12:08:15 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:15 - INFO - run_control_simulation:381 - STEP 0 START:
2025-10-11 12:08:15 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:15 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:15 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
2025-10-11 12:08:17 - INFO - run_control_simulation:396 -   Reward: 9.787752
2025-10-11 12:08:17 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:17 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:17 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:17 - INFO - run_control_simulation:415 -     Diff statistics: mean=8.619968e-01, max=1.005688e+01, std=1.113245e+00
2025-10-11 12:08:17 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.032403, rho_c=0.028677
2025-10-11 12:08:17 - INFO - run_control_simulation:426 -     Mean velocities: w_m=15.007668, w_c=12.482000
2025-10-11 12:08:17 - INFO - run_control_simulation:430 -   State hash: 1851909982427449296
2025-10-11 12:08:17 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:17 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:17 - INFO - run_control_simulation:381 - STEP 1 START:
2025-10-11 12:08:17 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:17 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:17 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
2025-10-11 12:08:19 - INFO - run_control_simulation:396 -   Reward: 9.788568
2025-10-11 12:08:19 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:19 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:19 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:19 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.078588e-01, max=4.163177e+00, std=1.478872e+00
2025-10-11 12:08:19 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.023042, rho_c=0.012327
2025-10-11 12:08:19 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.899094, w_c=14.196002
2025-10-11 12:08:19 - INFO - run_control_simulation:430 -   State hash: 8433031648788256017
2025-10-11 12:08:19 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:19 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:19 - INFO - run_control_simulation:381 - STEP 2 START:
2025-10-11 12:08:19 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:19 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:19 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
2025-10-11 12:08:21 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:21 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:21 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:21 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:21 - INFO - run_control_simulation:415 -     Diff statistics: mean=3.904041e-02, max=8.769475e-01, std=1.276464e-01
2025-10-11 12:08:21 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012122
2025-10-11 12:08:21 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947606, w_c=14.303308
2025-10-11 12:08:21 - INFO - run_control_simulation:430 -   State hash: 3581876939126460546
2025-10-11 12:08:21 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:21 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:21 - INFO - run_control_simulation:381 - STEP 3 START:
2025-10-11 12:08:21 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:21 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:21 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
2025-10-11 12:08:23 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:23 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:23 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:23 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:23 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.163389e-04, max=3.209188e-03, std=4.220445e-04
2025-10-11 12:08:23 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:23 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303673
2025-10-11 12:08:23 - INFO - run_control_simulation:430 -   State hash: -2779841414885198115
2025-10-11 12:08:23 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:23 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:23 - INFO - run_control_simulation:381 - STEP 4 START:
2025-10-11 12:08:23 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:23 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:23 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
2025-10-11 12:08:25 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:25 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:25 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:25 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:25 - INFO - run_control_simulation:415 -     Diff statistics: mean=3.350502e-07, max=9.746694e-06, std=1.259000e-06
2025-10-11 12:08:25 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:25 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:25 - INFO - run_control_simulation:430 -   State hash: -2138066457514312309
2025-10-11 12:08:25 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:25 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:25 - INFO - run_control_simulation:381 - STEP 5 START:
2025-10-11 12:08:25 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:25 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:25 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
2025-10-11 12:08:27 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:27 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:27 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:27 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:27 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.779269e-10, max=2.741896e-08, std=3.512802e-09
2025-10-11 12:08:27 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:27 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:27 - INFO - run_control_simulation:430 -   State hash: -1032692301178796389
2025-10-11 12:08:27 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:27 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:27 - INFO - run_control_simulation:381 - STEP 6 START:
2025-10-11 12:08:27 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:27 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:27 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
2025-10-11 12:08:29 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:29 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:29 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:29 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:29 - INFO - run_control_simulation:415 -     Diff statistics: mean=8.228763e-12, max=1.002789e-10, std=1.784003e-11
2025-10-11 12:08:29 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:29 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:29 - INFO - run_control_simulation:430 -   State hash: 9115037911887300149
2025-10-11 12:08:29 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:29 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:29 - INFO - run_control_simulation:381 - STEP 7 START:
2025-10-11 12:08:29 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:29 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:29 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
2025-10-11 12:08:31 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:31 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:31 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:31 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:31 - INFO - run_control_simulation:415 -     Diff statistics: mean=5.021346e-14, max=9.396928e-13, std=1.393706e-13
2025-10-11 12:08:31 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:31 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:31 - INFO - run_control_simulation:430 -   State hash: 2738623805623749615
2025-10-11 12:08:31 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:31 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:31 - INFO - run_control_simulation:381 - STEP 8 START:
2025-10-11 12:08:31 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:31 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:31 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
2025-10-11 12:08:32 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:32 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 12:08:32 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:32 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:32 - INFO - run_control_simulation:415 -     Diff statistics: mean=4.178098e-16, max=1.065814e-14, std=1.435852e-15
2025-10-11 12:08:32 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:32 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:32 - INFO - run_control_simulation:430 -   State hash: 9142667880907768474
2025-10-11 12:08:32 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:32 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 12:08:32 - INFO - run_control_simulation:381 - STEP 9 START:
2025-10-11 12:08:32 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 12:08:32 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 12:08:32 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
2025-10-11 12:08:34 - INFO - run_control_simulation:396 -   Reward: 9.788570
2025-10-11 12:08:34 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
2025-10-11 12:08:34 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 12:08:34 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 12:08:34 - INFO - run_control_simulation:415 -     Diff statistics: mean=2.715134e-16, max=1.065814e-14, std=1.184898e-15
2025-10-11 12:08:34 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.022905, rho_c=0.012121
2025-10-11 12:08:34 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.947706, w_c=14.303674
2025-10-11 12:08:34 - INFO - run_control_simulation:430 -   State hash: -1309938924041919171
2025-10-11 12:08:34 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 12:08:34 - INFO - run_control_simulation:469 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: 97.88
    - Avg step time: 1.921s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 19.2s
    - Speed ratio: 31.23x real-time

2025-10-11 12:08:34 - INFO - run_control_simulation:470 - Returning 10 state snapshots
2025-10-11 12:08:34 - INFO - run_performance_comparison:780 - RL states copied: 10 snapshots
2025-10-11 12:08:34 - INFO - run_performance_comparison:781 - RL FIRST state hash: 1851909982427449296
2025-10-11 12:08:34 - INFO - run_performance_comparison:782 - RL LAST state hash: -1309938924041919171
2025-10-11 12:08:34 - INFO - run_performance_comparison:783 - RL first state sample: rho_m[10:15]=[0.02025646 0.02025153 0.02024988 0.02024973 0.02025033]
2025-10-11 12:08:34 - INFO - run_performance_comparison:784 - RL last state sample: rho_m[10:15]=[0.02025667 0.02025106 0.02024857 0.02024743 0.02024689]
2025-10-11 12:08:34 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
2025-10-11 12:08:34 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=1851909982427449296, last=-1309938924041919171
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 0: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[0.02025646 0.02025153 0.02024988 0.02024973 0.02025033], w_m[10:15]=[17.43145435 17.43569326 17.4372029  17.43750496 17.43723442]
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 1: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 2: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 3: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 4: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 5: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 6: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 7: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 8: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - DEBUG - evaluate_traffic_performance:495 - State 9: shape=(4, 104), dtype=float64
2025-10-11 12:08:34 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[0.02025667 0.02025106 0.02024857 0.02024743 0.02024689], w_m[10:15]=[17.43153217 17.43628254 17.43839198 17.43935825 17.43981272]
2025-10-11 12:08:34 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=31.626612, efficiency=5.060258, delay=-175.05s
2025-10-11 12:08:34 - WARNING - run_performance_comparison:792 - States comparison - Identical: True, baseline_hash=1851909982427449296, rl_hash=1851909982427449296
2025-10-11 12:08:34 - ERROR - run_performance_comparison:796 - BUG CONFIRMED: States are identical despite different simulations!
2025-10-11 12:08:34 - ERROR - run_performance_comparison:797 - baseline_states_copy[0] sample: [0.02025646 0.02025153 0.02024988 0.02024973 0.02025033]
2025-10-11 12:08:34 - ERROR - run_performance_comparison:798 - rl_states_copy[0] sample: [0.02025646 0.02025153 0.02024988 0.02024973 0.02025033]
2025-10-11 12:08:34 - INFO - run_performance_comparison:801 - Baseline performance: {'total_flow': 31.626612262070374, 'avg_speed': 1039.378538404155, 'avg_density': 0.03172837546975386, 'efficiency': 5.060257961931259, 'delay': -175.04554820158046, 'throughput': 158133.06131035188}
2025-10-11 12:08:34 - INFO - run_performance_comparison:802 - RL performance: {'total_flow': 31.626612262070374, 'avg_speed': 1039.378538404155, 'avg_density': 0.03172837546975386, 'efficiency': 5.060257961931259, 'delay': -175.04554820158046, 'throughput': 158133.06131035188}
2025-10-11 12:08:34 - INFO - run_performance_comparison:810 - Flow improvement: 0.000%
2025-10-11 12:08:34 - INFO - run_performance_comparison:811 - Efficiency improvement: 0.000%
2025-10-11 12:08:34 - INFO - run_performance_comparison:812 - Delay reduction: -0.000%
