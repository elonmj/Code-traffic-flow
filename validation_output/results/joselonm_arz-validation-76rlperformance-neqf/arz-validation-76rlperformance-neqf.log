0.6s 1 ================================================================================
0.6s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.6s 3 Revendications: R5
0.6s 4 ================================================================================
0.6s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.6s 6 Branch: main
5.4s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.4s 8 PyTorch: 2.6.0+cu124
5.4s 9 CUDA available: True
5.5s 10 CUDA device: Tesla P100-PCIE-16GB
5.5s 11 CUDA version: 12.4
5.5s 12 
5.5s 13 [STEP 1/4] Cloning repository from GitHub...
5.5s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
8.2s 15 [OK] Repository cloned successfully
8.2s 16 TRACKING_SUCCESS: Repository cloned
8.2s 17 
8.2s 18 [STEP 2/4] Installing dependencies...
8.2s 19 Installing PyYAML...
12.1s 20 Installing matplotlib...
15.1s 21 Installing pandas...
18.0s 22 Installing scipy...
21.0s 23 Installing numpy...
23.9s 24 Installing gymnasium...
26.9s 25 Installing stable-baselines3...
95.6s 26 [OK] Dependencies installed
95.6s 27 TRACKING_SUCCESS: Dependencies ready
95.6s 28 
95.6s 29 [STEP 3/4] Running validation tests...
95.6s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
95.6s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
95.6s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
95.6s 33 ============================================================
106.3s 34 2025-10-11 06:57:16.387220: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
106.5s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
106.5s 36 E0000 00:00:1760165836.579354      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
106.5s 37 E0000 00:00:1760165836.634123      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
117.9s 38 ================================================================================
117.9s 39 QUICK TEST MODE ENABLED
117.9s 40 - Training: 2 timesteps only
117.9s 41 - Duration: 2 minutes simulated time
117.9s 42 - Scenarios: 1 scenario only
117.9s 43 - Expected runtime: ~5 minutes on GPU
117.9s 44 ================================================================================
117.9s 45 [ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance
117.9s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
117.9s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
117.9s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
117.9s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
117.9s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
117.9s 51 2025-10-11 06:57:28 - INFO - _setup_debug_logging:119 - ================================================================================
117.9s 52 2025-10-11 06:57:28 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
117.9s 53 2025-10-11 06:57:28 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
117.9s 54 2025-10-11 06:57:28 - INFO - _setup_debug_logging:122 - Quick test mode: True
117.9s 55 2025-10-11 06:57:28 - INFO - _setup_debug_logging:123 - ================================================================================
117.9s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
117.9s 57 === Section 7.6: RL Performance Validation ===
117.9s 58 Testing RL agent performance vs baseline controllers...
118.1s 59 [DEVICE] Detected: GPU
118.1s 60 [GPU INFO] Tesla P100-PCIE-16GB
118.1s 61 
118.1s 62 [PHASE 1/2] Training RL agents...
118.1s 63 [QUICK TEST] Training only: traffic_light_control
118.1s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
118.1s 65 2025-10-11 06:57:28 - INFO - train_rl_agent:561 - ================================================================================
118.1s 66 2025-10-11 06:57:28 - INFO - train_rl_agent:562 - Starting train_rl_agent for scenario: traffic_light_control
118.1s 67 2025-10-11 06:57:28 - INFO - train_rl_agent:563 -   - Device: gpu
118.1s 68 2025-10-11 06:57:28 - INFO - train_rl_agent:564 -   - Total timesteps: 100
118.1s 69 2025-10-11 06:57:28 - INFO - train_rl_agent:565 -   - Episode max time: 120.0s
118.1s 70 2025-10-11 06:57:28 - INFO - train_rl_agent:566 -   - Checkpoint frequency: 50
118.1s 71 2025-10-11 06:57:28 - INFO - train_rl_agent:567 - ================================================================================
118.1s 72 
118.1s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
118.1s 74 Device: gpu
118.1s 75 Total timesteps: 100
118.1s 76 Episode max time: 120.0s
118.1s 77 Checkpoint frequency: 50 steps
118.1s 78 2025-10-11 06:57:28 - INFO - _create_scenario_config:202 - Created scenario config: traffic_light_control.yml
118.1s 79 2025-10-11 06:57:28 - INFO - _create_scenario_config:203 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
118.1s 80 2025-10-11 06:57:28 - INFO - _create_scenario_config:204 -   Uniform density: rho_m=80.0 veh/km, rho_c=100.0 veh/km
118.1s 81 2025-10-11 06:57:28 - INFO - _create_scenario_config:205 -   Uniform velocity: w_m=12.0 m/s, w_c=10.0 m/s
118.1s 82 [SCENARIO] Generated: traffic_light_control.yml (1km domain, UNIFORM congestion IC)
118.2s 83 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
118.2s 84 Using device: gpu
118.2s 85 DEBUG PARAMS: Reading K_m_kmh = 10.0
118.2s 86 DEBUG PARAMS: Reading K_c_kmh = 15.0
118.2s 87 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
118.2s 88 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
118.2s 89 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
118.2s 90 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
118.2s 91 Loading road quality type: uniform
118.2s 92 Uniform road quality value: 2
118.2s 93 Road quality loaded.
118.2s 94 Initial state created.
118.2s 95 Transferring initial state and road quality to GPU...
118.2s 96 GPU data transfer complete.
118.2s 97 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
118.2s 98 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
118.2s 99 warn(NumbaPerformanceWarning(msg))
119.5s 100 Initial boundary conditions applied.
119.5s 101 TrafficSignalEnvDirect initialized:
119.5s 102 Decision interval: 60.0s
119.5s 103 Observation segments: 6
119.5s 104 Observation space: (26,)
119.5s 105 Action space: 2
119.5s 106 Device: gpu
119.5s 107 [INFO] Environment created: obs_space=(26,), action_space=2
119.5s 108 [INFO] Initializing PPO agent from scratch...
119.5s 109 Using cuda device
119.5s 110 Wrapping the env with a `Monitor` wrapper
119.5s 111 Wrapping the env in a DummyVecEnv.
119.5s 112 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
119.5s 113 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
119.5s 114 Info: (n_steps=100 and n_envs=1)
119.5s 115 warnings.warn(
124.1s 116 
124.1s 117 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
124.1s 118 [INFO] Training for 100 timesteps...
124.1s 119 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
124.1s 120 Using device: gpu
124.1s 121 DEBUG PARAMS: Reading K_m_kmh = 10.0
124.1s 122 DEBUG PARAMS: Reading K_c_kmh = 15.0
124.1s 123 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
124.1s 124 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
124.1s 125 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
124.1s 126 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
124.1s 127 Loading road quality type: uniform
124.1s 128 Uniform road quality value: 2
124.1s 129 Road quality loaded.
124.1s 130 Initial state created.
124.1s 131 Transferring initial state and road quality to GPU...
124.1s 132 GPU data transfer complete.
124.1s 133 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
124.1s 134 Initial boundary conditions applied.
124.1s 135 [BC UPDATE] left → phase 0 RED (reduced inflow)
124.1s 136 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
124.1s 137 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
124.1s 138 
124.1s 139 🚀 Training started: 100 total timesteps
124.6s 140 [BC UPDATE] left → phase 0 RED (reduced inflow)
124.6s 141 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
124.6s 142 Running simulation until t = 60.00 s, outputting every 60.00 s
124.6s 143 
124.6s 144 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
124.6s 145 warn(NumbaPerformanceWarning(msg))
125.4s 146 [WARNING] Automatic CFL correction applied (count: 1):
125.4s 147 Calculated CFL: 0.800 > Limit: 0.500
125.4s 148 Original dt: 7.222668e-01 s
125.4s 149 Corrected dt: 4.514167e-01 s
125.4s 150 Correction factor: 1.6x
125.4s 151 Max wave speed detected: 11.08 m/s
125.6s 152 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.6s 153 warn(NumbaPerformanceWarning(msg))
125.8s 154 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.8s 155 warn(NumbaPerformanceWarning(msg))
125.9s 156 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.9s 157 warn(NumbaPerformanceWarning(msg))
125.9s 158 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.9s 159 warn(NumbaPerformanceWarning(msg))
126.4s 160 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.4s 161 warn(NumbaPerformanceWarning(msg))
126.4s 162 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.4s 163 warn(NumbaPerformanceWarning(msg))
126.5s 164 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.5s 165 warn(NumbaPerformanceWarning(msg))
126.6s 166 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.6s 167 warn(NumbaPerformanceWarning(msg))
126.8s 168 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.8s 169 warn(NumbaPerformanceWarning(msg))
126.8s 170 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.8s 171 warn(NumbaPerformanceWarning(msg))
126.9s 172 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.9s 173 warn(NumbaPerformanceWarning(msg))
127.4s 174 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
127.8s 175 [WARNING] Automatic CFL correction applied (count: 100):
127.8s 176 Calculated CFL: 0.800 > Limit: 0.500
127.8s 177 Original dt: 4.134204e-01 s
127.8s 178 Corrected dt: 2.583878e-01 s
127.8s 179 Correction factor: 1.6x
127.8s 180 Max wave speed detected: 19.35 m/s
127.8s 181 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
128.3s 182 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
128.7s 183 [WARNING] Automatic CFL correction applied (count: 200):
128.7s 184 Calculated CFL: 0.800 > Limit: 0.500
128.7s 185 Original dt: 4.114972e-01 s
128.7s 186 Corrected dt: 2.571857e-01 s
128.7s 187 Correction factor: 1.6x
128.7s 188 Max wave speed detected: 19.44 m/s
128.7s 189 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
128.9s 190 
128.9s 191 [A
128.9s 192 Stored output at t = 60.0000 s (Step 220)
128.9s 193 
128.9s 194 Running Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:04<00:00, 13.82s/s]
128.9s 195 Simulation finished at t = 60.0000 s after 220 steps.
128.9s 196 Total runtime: 4.34 seconds.
128.9s 197 [BC UPDATE] left → phase 0 RED (reduced inflow)
128.9s 198 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
128.9s 199 Running simulation until t = 120.00 s, outputting every 60.00 s
128.9s 200 
129.2s 201 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
129.7s 202 [WARNING] Automatic CFL correction applied (count: 300):
129.7s 203 Calculated CFL: 0.800 > Limit: 0.500
129.7s 204 Original dt: 4.114753e-01 s
129.7s 205 Corrected dt: 2.571721e-01 s
129.7s 206 Correction factor: 1.6x
129.7s 207 Max wave speed detected: 19.44 m/s
129.7s 208 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
130.1s 209 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
130.6s 210 [WARNING] Automatic CFL correction applied (count: 400):
130.6s 211 Calculated CFL: 0.800 > Limit: 0.500
130.6s 212 Original dt: 4.114750e-01 s
130.6s 213 Corrected dt: 2.571719e-01 s
130.6s 214 Correction factor: 1.6x
130.6s 215 Max wave speed detected: 19.44 m/s
130.6s 216 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
131.1s 217 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
131.1s 218 Stored output at t = 120.0000 s (Step 454)
131.1s 219 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
131.1s 220 [A
131.1s 221 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.65s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.65s/s]
131.1s 222 
131.1s 223 Simulation finished at t = 120.0000 s after 454 steps.
131.1s 224 Total runtime: 2.17 seconds.
131.1s 225 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
131.1s 226 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
131.1s 227 Using device: gpu
131.1s 228 DEBUG PARAMS: Reading K_m_kmh = 10.0
131.1s 229 DEBUG PARAMS: Reading K_c_kmh = 15.0
131.1s 230 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
131.1s 231 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
131.1s 232 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
131.1s 233 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
131.1s 234 Loading road quality type: uniform
131.1s 235 Uniform road quality value: 2
131.1s 236 Road quality loaded.
131.1s 237 Initial state created.
131.1s 238 Transferring initial state and road quality to GPU...
131.1s 239 GPU data transfer complete.
131.1s 240 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
131.1s 241 Initial boundary conditions applied.
131.1s 242 [BC UPDATE] left → phase 0 RED (reduced inflow)
131.1s 243 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
131.1s 244 [BC UPDATE] left → phase 1 GREEN (normal inflow)
131.1s 245 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
131.1s 246 Running simulation until t = 60.00 s, outputting every 60.00 s
131.1s 247 
131.5s 248 [WARNING] Automatic CFL correction applied (count: 500):
131.5s 249 Calculated CFL: 0.800 > Limit: 0.500
131.5s 250 Original dt: 4.360026e-01 s
131.5s 251 Corrected dt: 2.725016e-01 s
131.5s 252 Correction factor: 1.6x
131.5s 253 Max wave speed detected: 18.35 m/s
131.6s 254 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
132.0s 255 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
132.4s 256 [WARNING] Automatic CFL correction applied (count: 600):
132.4s 257 Calculated CFL: 0.800 > Limit: 0.500
132.4s 258 Original dt: 4.117246e-01 s
132.4s 259 Corrected dt: 2.573279e-01 s
132.4s 260 Correction factor: 1.6x
132.4s 261 Max wave speed detected: 19.43 m/s
132.5s 262 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
133.0s 263 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
133.1s 264 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
133.1s 265 Stored output at t = 60.0000 s (Step 220)
133.1s 266 [A
133.1s 267 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.12s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.11s/s]
133.1s 268 
133.1s 269 Simulation finished at t = 60.0000 s after 220 steps.
133.1s 270 Total runtime: 1.99 seconds.
133.1s 271 [BC UPDATE] left → phase 1 GREEN (normal inflow)
133.1s 272 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
133.1s 273 Running simulation until t = 120.00 s, outputting every 60.00 s
133.1s 274 
133.4s 275 [WARNING] Automatic CFL correction applied (count: 700):
133.4s 276 Calculated CFL: 0.800 > Limit: 0.500
133.4s 277 Original dt: 4.114781e-01 s
133.4s 278 Corrected dt: 2.571738e-01 s
133.4s 279 Correction factor: 1.6x
133.4s 280 Max wave speed detected: 19.44 m/s
133.4s 281 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
133.9s 282 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
134.3s 283 [WARNING] Automatic CFL correction applied (count: 800):
134.3s 284 Calculated CFL: 0.800 > Limit: 0.500
134.3s 285 Original dt: 4.114751e-01 s
134.3s 286 Corrected dt: 2.571719e-01 s
134.3s 287 Correction factor: 1.6x
134.3s 288 Max wave speed detected: 19.44 m/s
134.3s 289 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
134.8s 290 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
135.2s 291 [WARNING] Automatic CFL correction applied (count: 900):
135.2s 292 Calculated CFL: 0.800 > Limit: 0.500
135.2s 293 Original dt: 4.114750e-01 s
135.2s 294 Corrected dt: 2.571719e-01 s
135.2s 295 Correction factor: 1.6x
135.2s 296 Max wave speed detected: 19.44 m/s
135.2s 297 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
135.3s 298 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
135.3s 299 [A
135.3s 300 Stored output at t = 120.0000 s (Step 454)
135.3s 301 
135.3s 302 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.96s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.96s/s]
135.3s 303 Simulation finished at t = 120.0000 s after 454 steps.
135.3s 304 Total runtime: 2.15 seconds.
135.3s 305 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
135.3s 306 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
135.3s 307 Using device: gpu
135.3s 308 DEBUG PARAMS: Reading K_m_kmh = 10.0
135.3s 309 DEBUG PARAMS: Reading K_c_kmh = 15.0
135.3s 310 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
135.3s 311 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
135.3s 312 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
135.3s 313 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
135.3s 314 Loading road quality type: uniform
135.3s 315 Uniform road quality value: 2
135.3s 316 Road quality loaded.
135.3s 317 Initial state created.
135.3s 318 Transferring initial state and road quality to GPU...
135.3s 319 GPU data transfer complete.
135.3s 320 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
135.3s 321 Initial boundary conditions applied.
135.3s 322 [BC UPDATE] left → phase 0 RED (reduced inflow)
135.3s 323 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
135.3s 324 [BC UPDATE] left → phase 0 RED (reduced inflow)
135.3s 325 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
135.3s 326 Running simulation until t = 60.00 s, outputting every 60.00 s
135.3s 327 
135.8s 328 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
136.1s 329 [WARNING] Automatic CFL correction applied (count: 1000):
136.1s 330 Calculated CFL: 0.800 > Limit: 0.500
136.1s 331 Original dt: 4.143805e-01 s
136.1s 332 Corrected dt: 2.589878e-01 s
136.1s 333 Correction factor: 1.6x
136.1s 334 Max wave speed detected: 19.31 m/s
136.2s 335 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
136.7s 336 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
137.1s 337 [WARNING] Automatic CFL correction applied (count: 1100):
137.1s 338 Calculated CFL: 0.800 > Limit: 0.500
137.1s 339 Original dt: 4.115075e-01 s
137.1s 340 Corrected dt: 2.571922e-01 s
137.1s 341 Correction factor: 1.6x
137.1s 342 Max wave speed detected: 19.44 m/s
137.1s 343 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
137.3s 344 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
137.3s 345 [A
137.3s 346 Stored output at t = 60.0000 s (Step 220)
137.3s 347 
137.3s 348 Simulation finished at t = 60.0000 s after 220 steps.
137.3s 349 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.45s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.44s/s]
137.3s 350 Total runtime: 2.04 seconds.
137.3s 351 [BC UPDATE] left → phase 0 RED (reduced inflow)
137.3s 352 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
137.3s 353 Running simulation until t = 120.00 s, outputting every 60.00 s
137.3s 354 
137.6s 355 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
138.0s 356 [WARNING] Automatic CFL correction applied (count: 1200):
138.0s 357 Calculated CFL: 0.800 > Limit: 0.500
138.0s 358 Original dt: 4.114754e-01 s
138.0s 359 Corrected dt: 2.571721e-01 s
138.0s 360 Correction factor: 1.6x
138.0s 361 Max wave speed detected: 19.44 m/s
138.1s 362 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
138.5s 363 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
138.9s 364 [WARNING] Automatic CFL correction applied (count: 1300):
138.9s 365 Calculated CFL: 0.800 > Limit: 0.500
138.9s 366 Original dt: 4.114750e-01 s
138.9s 367 Corrected dt: 2.571719e-01 s
138.9s 368 Correction factor: 1.6x
138.9s 369 Max wave speed detected: 19.44 m/s
139.0s 370 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
139.4s 371 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
139.5s 372 Stored output at t = 120.0000 s (Step 454)
139.5s 373 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
139.5s 374 [A
139.5s 375 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.89s/s]
139.5s 376 
139.5s 377 Simulation finished at t = 120.0000 s after 454 steps.
139.5s 378 Total runtime: 2.15 seconds.
139.5s 379 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
139.5s 380 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
139.5s 381 Using device: gpu
139.5s 382 DEBUG PARAMS: Reading K_m_kmh = 10.0
139.5s 383 DEBUG PARAMS: Reading K_c_kmh = 15.0
139.5s 384 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
139.5s 385 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
139.5s 386 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
139.5s 387 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
139.5s 388 Loading road quality type: uniform
139.5s 389 Uniform road quality value: 2
139.5s 390 Road quality loaded.
139.5s 391 Initial state created.
139.5s 392 Transferring initial state and road quality to GPU...
139.5s 393 GPU data transfer complete.
139.5s 394 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
139.5s 395 Initial boundary conditions applied.
139.5s 396 [BC UPDATE] left → phase 0 RED (reduced inflow)
139.5s 397 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
139.5s 398 [BC UPDATE] left → phase 0 RED (reduced inflow)
139.5s 399 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
139.5s 400 Running simulation until t = 60.00 s, outputting every 60.00 s
139.5s 401 
139.8s 402 [WARNING] Automatic CFL correction applied (count: 1400):
139.8s 403 Calculated CFL: 0.800 > Limit: 0.500
139.8s 404 Original dt: 4.463168e-01 s
139.8s 405 Corrected dt: 2.789480e-01 s
139.8s 406 Correction factor: 1.6x
139.8s 407 Max wave speed detected: 17.92 m/s
140.0s 408 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
140.4s 409 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
140.7s 410 [WARNING] Automatic CFL correction applied (count: 1500):
140.7s 411 Calculated CFL: 0.800 > Limit: 0.500
140.7s 412 Original dt: 4.118415e-01 s
140.7s 413 Corrected dt: 2.574009e-01 s
140.7s 414 Correction factor: 1.6x
140.7s 415 Max wave speed detected: 19.42 m/s
140.9s 416 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
141.3s 417 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
141.5s 418 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
141.5s 419 [A
141.5s 420 Stored output at t = 60.0000 s (Step 220)
141.5s 421 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.07s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.07s/s]
141.5s 422 
141.5s 423 Simulation finished at t = 60.0000 s after 220 steps.
141.5s 424 Total runtime: 2.00 seconds.
141.5s 425 [BC UPDATE] left → phase 1 GREEN (normal inflow)
141.5s 426 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
141.5s 427 Running simulation until t = 120.00 s, outputting every 60.00 s
141.5s 428 
141.7s 429 [WARNING] Automatic CFL correction applied (count: 1600):
141.7s 430 Calculated CFL: 0.800 > Limit: 0.500
141.7s 431 Original dt: 4.114795e-01 s
141.7s 432 Corrected dt: 2.571747e-01 s
141.7s 433 Correction factor: 1.6x
141.7s 434 Max wave speed detected: 19.44 m/s
141.8s 435 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
142.2s 436 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
142.6s 437 [WARNING] Automatic CFL correction applied (count: 1700):
142.6s 438 Calculated CFL: 0.800 > Limit: 0.500
142.6s 439 Original dt: 4.114751e-01 s
142.6s 440 Corrected dt: 2.571719e-01 s
142.6s 441 Correction factor: 1.6x
142.6s 442 Max wave speed detected: 19.44 m/s
142.7s 443 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
143.1s 444 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
143.5s 445 [WARNING] Automatic CFL correction applied (count: 1800):
143.5s 446 Calculated CFL: 0.800 > Limit: 0.500
143.5s 447 Original dt: 4.114750e-01 s
143.5s 448 Corrected dt: 2.571719e-01 s
143.5s 449 Correction factor: 1.6x
143.5s 450 Max wave speed detected: 19.44 m/s
143.6s 451 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
143.6s 452 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
143.6s 453 [A
143.6s 454 Stored output at t = 120.0000 s (Step 454)
143.6s 455 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.40s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.40s/s]
143.6s 456 
143.6s 457 Simulation finished at t = 120.0000 s after 454 steps.
143.6s 458 Total runtime: 2.11 seconds.
143.6s 459 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
143.6s 460 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
143.6s 461 Using device: gpu
143.6s 462 DEBUG PARAMS: Reading K_m_kmh = 10.0
143.6s 463 DEBUG PARAMS: Reading K_c_kmh = 15.0
143.6s 464 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
143.6s 465 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
143.6s 466 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
143.6s 467 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
143.6s 468 Loading road quality type: uniform
143.6s 469 Uniform road quality value: 2
143.6s 470 Road quality loaded.
143.6s 471 Initial state created.
143.6s 472 Transferring initial state and road quality to GPU...
143.6s 473 GPU data transfer complete.
143.6s 474 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
143.6s 475 Initial boundary conditions applied.
143.6s 476 [BC UPDATE] left → phase 0 RED (reduced inflow)
143.6s 477 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
143.6s 478 [BC UPDATE] left → phase 0 RED (reduced inflow)
143.6s 479 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
143.6s 480 Running simulation until t = 60.00 s, outputting every 60.00 s
143.6s 481 
144.1s 482 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
144.4s 483 [WARNING] Automatic CFL correction applied (count: 1900):
144.4s 484 Calculated CFL: 0.800 > Limit: 0.500
144.4s 485 Original dt: 4.154822e-01 s
144.4s 486 Corrected dt: 2.596764e-01 s
144.4s 487 Correction factor: 1.6x
144.4s 488 Max wave speed detected: 19.25 m/s
144.5s 489 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
145.0s 490 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
145.3s 491 [WARNING] Automatic CFL correction applied (count: 2000):
145.3s 492 Calculated CFL: 0.800 > Limit: 0.500
145.3s 493 Original dt: 4.115210e-01 s
145.3s 494 Corrected dt: 2.572006e-01 s
145.3s 495 Correction factor: 1.6x
145.3s 496 Max wave speed detected: 19.44 m/s
145.5s 497 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
145.6s 498 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
145.6s 499 [A
145.6s 500 Stored output at t = 60.0000 s (Step 220)
145.6s 501 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.87s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.87s/s]
145.6s 502 
145.6s 503 Simulation finished at t = 60.0000 s after 220 steps.
145.6s 504 Total runtime: 2.01 seconds.
145.6s 505 [BC UPDATE] left → phase 0 RED (reduced inflow)
145.6s 506 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
145.6s 507 Running simulation until t = 120.00 s, outputting every 60.00 s
145.6s 508 
145.9s 509 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
146.2s 510 [WARNING] Automatic CFL correction applied (count: 2100):
146.2s 511 Calculated CFL: 0.800 > Limit: 0.500
146.2s 512 Original dt: 4.114756e-01 s
146.2s 513 Corrected dt: 2.571722e-01 s
146.2s 514 Correction factor: 1.6x
146.2s 515 Max wave speed detected: 19.44 m/s
146.4s 516 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
146.8s 517 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
147.1s 518 [WARNING] Automatic CFL correction applied (count: 2200):
147.1s 519 Calculated CFL: 0.800 > Limit: 0.500
147.1s 520 Original dt: 4.114750e-01 s
147.1s 521 Corrected dt: 2.571719e-01 s
147.1s 522 Correction factor: 1.6x
147.1s 523 Max wave speed detected: 19.44 m/s
147.3s 524 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
147.7s 525 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
147.8s 526 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
147.8s 527 [A
147.8s 528 Stored output at t = 120.0000 s (Step 454)
147.8s 529 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
147.8s 530 
147.8s 531 Simulation finished at t = 120.0000 s after 454 steps.
147.8s 532 Total runtime: 2.14 seconds.
147.8s 533 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
147.8s 534 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
147.8s 535 Using device: gpu
147.8s 536 DEBUG PARAMS: Reading K_m_kmh = 10.0
147.8s 537 DEBUG PARAMS: Reading K_c_kmh = 15.0
147.8s 538 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
147.8s 539 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
147.8s 540 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
147.8s 541 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
147.8s 542 Loading road quality type: uniform
147.8s 543 Uniform road quality value: 2
147.8s 544 Road quality loaded.
147.8s 545 Initial state created.
147.8s 546 Transferring initial state and road quality to GPU...
147.8s 547 GPU data transfer complete.
147.8s 548 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
147.8s 549 Initial boundary conditions applied.
147.8s 550 [BC UPDATE] left → phase 0 RED (reduced inflow)
147.8s 551 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
147.8s 552 [BC UPDATE] left → phase 1 GREEN (normal inflow)
147.8s 553 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
147.8s 554 Running simulation until t = 60.00 s, outputting every 60.00 s
147.8s 555 
148.1s 556 [WARNING] Automatic CFL correction applied (count: 2300):
148.1s 557 Calculated CFL: 0.800 > Limit: 0.500
148.1s 558 Original dt: 4.653019e-01 s
148.1s 559 Corrected dt: 2.908137e-01 s
148.1s 560 Correction factor: 1.6x
148.1s 561 Max wave speed detected: 17.19 m/s
148.3s 562 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
148.7s 563 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
149.0s 564 [WARNING] Automatic CFL correction applied (count: 2400):
149.0s 565 Calculated CFL: 0.800 > Limit: 0.500
149.0s 566 Original dt: 4.119798e-01 s
149.0s 567 Corrected dt: 2.574874e-01 s
149.0s 568 Correction factor: 1.6x
149.0s 569 Max wave speed detected: 19.42 m/s
149.2s 570 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
149.6s 571 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
149.8s 572 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
149.8s 573 [A
149.8s 574 Stored output at t = 60.0000 s (Step 220)
149.8s 575 
149.8s 576 Simulation finished at t = 60.0000 s after 220 steps.
149.8s 577 Total runtime: 2.02 seconds.
149.8s 578 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.75s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.75s/s]
149.8s 579 [BC UPDATE] left → phase 0 RED (reduced inflow)
149.8s 580 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
149.8s 581 Running simulation until t = 120.00 s, outputting every 60.00 s
149.8s 582 
149.9s 583 [WARNING] Automatic CFL correction applied (count: 2500):
149.9s 584 Calculated CFL: 0.800 > Limit: 0.500
149.9s 585 Original dt: 4.114811e-01 s
149.9s 586 Corrected dt: 2.571757e-01 s
149.9s 587 Correction factor: 1.6x
149.9s 588 Max wave speed detected: 19.44 m/s
150.1s 589 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
150.6s 590 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
150.8s 591 [WARNING] Automatic CFL correction applied (count: 2600):
150.8s 592 Calculated CFL: 0.800 > Limit: 0.500
150.8s 593 Original dt: 4.114751e-01 s
150.8s 594 Corrected dt: 2.571719e-01 s
150.8s 595 Correction factor: 1.6x
150.8s 596 Max wave speed detected: 19.44 m/s
151.0s 597 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
151.5s 598 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
151.7s 599 [WARNING] Automatic CFL correction applied (count: 2700):
151.7s 600 Calculated CFL: 0.800 > Limit: 0.500
151.7s 601 Original dt: 4.114750e-01 s
151.7s 602 Corrected dt: 2.571719e-01 s
151.7s 603 Correction factor: 1.6x
151.7s 604 Max wave speed detected: 19.44 m/s
151.9s 605 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
152.0s 606 Stored output at t = 120.0000 s (Step 454)
152.0s 607 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
152.0s 608 [A
152.0s 609 
152.0s 610 Simulation finished at t = 120.0000 s after 454 steps.
152.0s 611 Total runtime: 2.16 seconds.
152.0s 612 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.78s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.77s/s]
152.0s 613 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
152.0s 614 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
152.0s 615 Using device: gpu
152.0s 616 DEBUG PARAMS: Reading K_m_kmh = 10.0
152.0s 617 DEBUG PARAMS: Reading K_c_kmh = 15.0
152.0s 618 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
152.0s 619 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
152.0s 620 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
152.0s 621 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
152.0s 622 Loading road quality type: uniform
152.0s 623 Uniform road quality value: 2
152.0s 624 Road quality loaded.
152.0s 625 Initial state created.
152.0s 626 Transferring initial state and road quality to GPU...
152.0s 627 GPU data transfer complete.
152.0s 628 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
152.0s 629 Initial boundary conditions applied.
152.0s 630 [BC UPDATE] left → phase 0 RED (reduced inflow)
152.0s 631 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
152.0s 632 [BC UPDATE] left → phase 0 RED (reduced inflow)
152.0s 633 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
152.0s 634 Running simulation until t = 60.00 s, outputting every 60.00 s
152.0s 635 
152.4s 636 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
152.7s 637 [WARNING] Automatic CFL correction applied (count: 2800):
152.7s 638 Calculated CFL: 0.800 > Limit: 0.500
152.7s 639 Original dt: 4.172367e-01 s
152.7s 640 Corrected dt: 2.607729e-01 s
152.7s 641 Correction factor: 1.6x
152.7s 642 Max wave speed detected: 19.17 m/s
152.9s 643 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
153.4s 644 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
153.6s 645 [WARNING] Automatic CFL correction applied (count: 2900):
153.6s 646 Calculated CFL: 0.800 > Limit: 0.500
153.6s 647 Original dt: 4.115395e-01 s
153.6s 648 Corrected dt: 2.572122e-01 s
153.6s 649 Correction factor: 1.6x
153.6s 650 Max wave speed detected: 19.44 m/s
153.8s 651 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
154.0s 652 Stored output at t = 60.0000 s (Step 220)
154.0s 653 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
154.0s 654 [A
154.0s 655 
154.0s 656 Simulation finished at t = 60.0000 s after 220 steps.
154.0s 657 Total runtime: 2.02 seconds.
154.0s 658 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.70s/s]
154.0s 659 [BC UPDATE] left → phase 0 RED (reduced inflow)
154.0s 660 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
154.0s 661 Running simulation until t = 120.00 s, outputting every 60.00 s
154.0s 662 
154.3s 663 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
154.5s 664 [WARNING] Automatic CFL correction applied (count: 3000):
154.5s 665 Calculated CFL: 0.800 > Limit: 0.500
154.5s 666 Original dt: 4.114758e-01 s
154.5s 667 Corrected dt: 2.571724e-01 s
154.5s 668 Correction factor: 1.6x
154.5s 669 Max wave speed detected: 19.44 m/s
154.8s 670 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
155.2s 671 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
155.5s 672 [WARNING] Automatic CFL correction applied (count: 3100):
155.5s 673 Calculated CFL: 0.800 > Limit: 0.500
155.5s 674 Original dt: 4.114750e-01 s
155.5s 675 Corrected dt: 2.571719e-01 s
155.5s 676 Correction factor: 1.6x
155.5s 677 Max wave speed detected: 19.44 m/s
155.7s 678 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
156.1s 679 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
156.2s 680 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
156.2s 681 [A
156.2s 682 Stored output at t = 120.0000 s (Step 454)
156.2s 683 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.80s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.80s/s]
156.2s 684 
156.2s 685 Simulation finished at t = 120.0000 s after 454 steps.
156.2s 686 Total runtime: 2.16 seconds.
156.2s 687 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
156.2s 688 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
156.2s 689 Using device: gpu
156.2s 690 DEBUG PARAMS: Reading K_m_kmh = 10.0
156.2s 691 DEBUG PARAMS: Reading K_c_kmh = 15.0
156.2s 692 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
156.2s 693 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
156.2s 694 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
156.2s 695 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
156.2s 696 Loading road quality type: uniform
156.2s 697 Uniform road quality value: 2
156.2s 698 Road quality loaded.
156.2s 699 Initial state created.
156.2s 700 Transferring initial state and road quality to GPU...
156.2s 701 GPU data transfer complete.
156.2s 702 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
156.2s 703 Initial boundary conditions applied.
156.2s 704 [BC UPDATE] left → phase 0 RED (reduced inflow)
156.2s 705 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
156.2s 706 [BC UPDATE] left → phase 0 RED (reduced inflow)
156.2s 707 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
156.2s 708 Running simulation until t = 60.00 s, outputting every 60.00 s
156.2s 709 
156.4s 710 [WARNING] Automatic CFL correction applied (count: 3200):
156.4s 711 Calculated CFL: 0.800 > Limit: 0.500
156.4s 712 Original dt: 4.983662e-01 s
156.4s 713 Corrected dt: 3.114789e-01 s
156.4s 714 Correction factor: 1.6x
156.4s 715 Max wave speed detected: 16.05 m/s
156.6s 716 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
157.1s 717 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
157.3s 718 [WARNING] Automatic CFL correction applied (count: 3300):
157.3s 719 Calculated CFL: 0.800 > Limit: 0.500
157.3s 720 Original dt: 4.122050e-01 s
157.3s 721 Corrected dt: 2.576281e-01 s
157.3s 722 Correction factor: 1.6x
157.3s 723 Max wave speed detected: 19.41 m/s
157.5s 724 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
158.0s 725 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
158.2s 726 Stored output at t = 60.0000 s (Step 220)
158.2s 727 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
158.2s 728 [A
158.2s 729 
158.2s 730 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.31s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.31s/s]
158.2s 731 Simulation finished at t = 60.0000 s after 220 steps.
158.2s 732 Total runtime: 1.98 seconds.
158.2s 733 [BC UPDATE] left → phase 0 RED (reduced inflow)
158.2s 734 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
158.2s 735 Running simulation until t = 120.00 s, outputting every 60.00 s
158.2s 736 
158.2s 737 [WARNING] Automatic CFL correction applied (count: 3400):
158.2s 738 Calculated CFL: 0.800 > Limit: 0.500
158.2s 739 Original dt: 4.114838e-01 s
158.2s 740 Corrected dt: 2.571774e-01 s
158.2s 741 Correction factor: 1.6x
158.2s 742 Max wave speed detected: 19.44 m/s
158.4s 743 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
158.9s 744 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
159.1s 745 [WARNING] Automatic CFL correction applied (count: 3500):
159.1s 746 Calculated CFL: 0.800 > Limit: 0.500
159.1s 747 Original dt: 4.114751e-01 s
159.1s 748 Corrected dt: 2.571720e-01 s
159.1s 749 Correction factor: 1.6x
159.1s 750 Max wave speed detected: 19.44 m/s
159.3s 751 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
159.8s 752 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
160.0s 753 [WARNING] Automatic CFL correction applied (count: 3600):
160.0s 754 Calculated CFL: 0.800 > Limit: 0.500
160.0s 755 Original dt: 4.114750e-01 s
160.0s 756 Corrected dt: 2.571719e-01 s
160.0s 757 Correction factor: 1.6x
160.0s 758 Max wave speed detected: 19.44 m/s
160.2s 759 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
160.3s 760 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
160.3s 761 Stored output at t = 120.0000 s (Step 454)
160.3s 762 [A
160.3s 763 
160.3s 764 Simulation finished at t = 120.0000 s after 454 steps.
160.3s 765 Total runtime: 2.12 seconds.
160.3s 766 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.37s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.36s/s]
160.3s 767 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
160.3s 768 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
160.3s 769 Using device: gpu
160.3s 770 DEBUG PARAMS: Reading K_m_kmh = 10.0
160.3s 771 DEBUG PARAMS: Reading K_c_kmh = 15.0
160.3s 772 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
160.3s 773 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
160.3s 774 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
160.3s 775 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
160.3s 776 Loading road quality type: uniform
160.3s 777 Uniform road quality value: 2
160.3s 778 Road quality loaded.
160.3s 779 Initial state created.
160.3s 780 Transferring initial state and road quality to GPU...
160.3s 781 GPU data transfer complete.
160.3s 782 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
160.3s 783 Initial boundary conditions applied.
160.3s 784 [BC UPDATE] left → phase 0 RED (reduced inflow)
160.3s 785 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
160.3s 786 
160.3s 787 [BC UPDATE] left → phase 1 GREEN (normal inflow)
160.3s 788 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
160.3s 789 Running simulation until t = 60.00 s, outputting every 60.00 s
160.8s 790 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
160.9s 791 [WARNING] Automatic CFL correction applied (count: 3700):
160.9s 792 Calculated CFL: 0.800 > Limit: 0.500
160.9s 793 Original dt: 4.201734e-01 s
160.9s 794 Corrected dt: 2.626084e-01 s
160.9s 795 Correction factor: 1.6x
160.9s 796 Max wave speed detected: 19.04 m/s
161.2s 797 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
161.7s 798 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
161.8s 799 [WARNING] Automatic CFL correction applied (count: 3800):
161.8s 800 Calculated CFL: 0.800 > Limit: 0.500
161.8s 801 Original dt: 4.115695e-01 s
161.8s 802 Corrected dt: 2.572309e-01 s
161.8s 803 Correction factor: 1.6x
161.8s 804 Max wave speed detected: 19.44 m/s
162.1s 805 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
162.3s 806 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
162.3s 807 [A
162.3s 808 Stored output at t = 60.0000 s (Step 220)
162.3s 809 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.76s/s]
162.3s 810 
162.3s 811 Simulation finished at t = 60.0000 s after 220 steps.
162.3s 812 Total runtime: 2.02 seconds.
162.3s 813 [BC UPDATE] left → phase 0 RED (reduced inflow)
162.3s 814 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
162.3s 815 Running simulation until t = 120.00 s, outputting every 60.00 s
162.3s 816 
162.6s 817 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
162.7s 818 [WARNING] Automatic CFL correction applied (count: 3900):
162.7s 819 Calculated CFL: 0.800 > Limit: 0.500
162.7s 820 Original dt: 4.114762e-01 s
162.7s 821 Corrected dt: 2.571726e-01 s
162.7s 822 Correction factor: 1.6x
162.7s 823 Max wave speed detected: 19.44 m/s
163.0s 824 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
163.5s 825 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
163.7s 826 [WARNING] Automatic CFL correction applied (count: 4000):
163.7s 827 Calculated CFL: 0.800 > Limit: 0.500
163.7s 828 Original dt: 4.114750e-01 s
163.7s 829 Corrected dt: 2.571719e-01 s
163.7s 830 Correction factor: 1.6x
163.7s 831 Max wave speed detected: 19.44 m/s
164.0s 832 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
164.4s 833 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
164.4s 834 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
164.4s 835 [A
164.4s 836 Stored output at t = 120.0000 s (Step 454)
164.4s 837 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.21s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.20s/s]
164.4s 838 
164.4s 839 Simulation finished at t = 120.0000 s after 454 steps.
164.4s 840 Total runtime: 2.13 seconds.
164.4s 841 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
164.4s 842 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
164.4s 843 Using device: gpu
164.5s 844 DEBUG PARAMS: Reading K_m_kmh = 10.0
164.5s 845 DEBUG PARAMS: Reading K_c_kmh = 15.0
164.5s 846 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
164.5s 847 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
164.5s 848 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
164.5s 849 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
164.5s 850 Loading road quality type: uniform
164.5s 851 Uniform road quality value: 2
164.5s 852 Road quality loaded.
164.5s 853 Initial state created.
164.5s 854 Transferring initial state and road quality to GPU...
164.5s 855 GPU data transfer complete.
164.5s 856 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
164.5s 857 Initial boundary conditions applied.
164.5s 858 [BC UPDATE] left → phase 0 RED (reduced inflow)
164.5s 859 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
164.5s 860 [BC UPDATE] left → phase 0 RED (reduced inflow)
164.5s 861 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
164.5s 862 Running simulation until t = 60.00 s, outputting every 60.00 s
164.5s 863 
164.6s 864 [WARNING] Automatic CFL correction applied (count: 4100):
164.6s 865 Calculated CFL: 0.800 > Limit: 0.500
164.6s 866 Original dt: 5.543972e-01 s
164.6s 867 Corrected dt: 3.464983e-01 s
164.6s 868 Correction factor: 1.6x
164.6s 869 Max wave speed detected: 14.43 m/s
164.9s 870 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
165.4s 871 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
165.5s 872 [WARNING] Automatic CFL correction applied (count: 4200):
165.5s 873 Calculated CFL: 0.800 > Limit: 0.500
165.5s 874 Original dt: 4.125515e-01 s
165.5s 875 Corrected dt: 2.578447e-01 s
165.5s 876 Correction factor: 1.6x
165.5s 877 Max wave speed detected: 19.39 m/s
165.8s 878 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
166.3s 879 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
166.4s 880 [WARNING] Automatic CFL correction applied (count: 4300):
166.4s 881 Calculated CFL: 0.800 > Limit: 0.500
166.4s 882 Original dt: 4.114875e-01 s
166.4s 883 Corrected dt: 2.571797e-01 s
166.4s 884 Correction factor: 1.6x
166.4s 885 Max wave speed detected: 19.44 m/s
166.5s 886 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
166.5s 887 [A
166.5s 888 Stored output at t = 60.0000 s (Step 220)
166.5s 889 
166.5s 890 Simulation finished at t = 60.0000 s after 220 steps.
166.5s 891 Total runtime: 2.01 seconds.
166.5s 892 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.83s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.83s/s]
166.5s 893 [BC UPDATE] left → phase 1 GREEN (normal inflow)
166.5s 894 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
166.5s 895 Running simulation until t = 120.00 s, outputting every 60.00 s
166.5s 896 
166.7s 897 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
167.2s 898 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
167.3s 899 [WARNING] Automatic CFL correction applied (count: 4400):
167.3s 900 Calculated CFL: 0.800 > Limit: 0.500
167.3s 901 Original dt: 4.114752e-01 s
167.3s 902 Corrected dt: 2.571720e-01 s
167.3s 903 Correction factor: 1.6x
167.3s 904 Max wave speed detected: 19.44 m/s
167.6s 905 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
168.1s 906 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
168.2s 907 [WARNING] Automatic CFL correction applied (count: 4500):
168.2s 908 Calculated CFL: 0.800 > Limit: 0.500
168.2s 909 Original dt: 4.114750e-01 s
168.2s 910 Corrected dt: 2.571719e-01 s
168.2s 911 Correction factor: 1.6x
168.2s 912 Max wave speed detected: 19.44 m/s
168.5s 913 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
168.6s 914 Stored output at t = 120.0000 s (Step 454)
168.6s 915 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
168.6s 916 [A
168.6s 917 
168.6s 918 Simulation finished at t = 120.0000 s after 454 steps.
168.6s 919 Total runtime: 2.11 seconds.
168.6s 920 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.49s/s]
168.6s 921 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
168.6s 922 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
168.6s 923 Using device: gpu
168.6s 924 DEBUG PARAMS: Reading K_m_kmh = 10.0
168.6s 925 DEBUG PARAMS: Reading K_c_kmh = 15.0
168.6s 926 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
168.6s 927 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
168.6s 928 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
168.6s 929 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
168.6s 930 Loading road quality type: uniform
168.6s 931 Uniform road quality value: 2
168.6s 932 Road quality loaded.
168.6s 933 Initial state created.
168.6s 934 Transferring initial state and road quality to GPU...
168.6s 935 GPU data transfer complete.
168.6s 936 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
168.6s 937 Initial boundary conditions applied.
168.6s 938 [BC UPDATE] left → phase 0 RED (reduced inflow)
168.6s 939 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
168.6s 940 [BC UPDATE] left → phase 1 GREEN (normal inflow)
168.6s 941 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
168.6s 942 Running simulation until t = 60.00 s, outputting every 60.00 s
168.6s 943 
169.0s 944 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
169.1s 945 [WARNING] Automatic CFL correction applied (count: 4600):
169.1s 946 Calculated CFL: 0.800 > Limit: 0.500
169.1s 947 Original dt: 4.234823e-01 s
169.1s 948 Corrected dt: 2.646765e-01 s
169.1s 949 Correction factor: 1.6x
169.1s 950 Max wave speed detected: 18.89 m/s
169.5s 951 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
169.9s 952 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
170.0s 953 [WARNING] Automatic CFL correction applied (count: 4700):
170.0s 954 Calculated CFL: 0.800 > Limit: 0.500
170.0s 955 Original dt: 4.116097e-01 s
170.0s 956 Corrected dt: 2.572560e-01 s
170.0s 957 Correction factor: 1.6x
170.0s 958 Max wave speed detected: 19.44 m/s
170.4s 959 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
170.6s 960 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
170.6s 961 Stored output at t = 60.0000 s (Step 220)
170.6s 962 [A
170.6s 963 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.02s/s]
170.6s 964 
170.6s 965 Simulation finished at t = 60.0000 s after 220 steps.
170.6s 966 Total runtime: 2.00 seconds.
170.6s 967 [BC UPDATE] left → phase 1 GREEN (normal inflow)
170.6s 968 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
170.6s 969 Running simulation until t = 120.00 s, outputting every 60.00 s
170.6s 970 
170.9s 971 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
171.0s 972 [WARNING] Automatic CFL correction applied (count: 4800):
171.0s 973 Calculated CFL: 0.800 > Limit: 0.500
171.0s 974 Original dt: 4.114767e-01 s
171.0s 975 Corrected dt: 2.571729e-01 s
171.0s 976 Correction factor: 1.6x
171.0s 977 Max wave speed detected: 19.44 m/s
171.4s 978 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
171.8s 979 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
171.9s 980 [WARNING] Automatic CFL correction applied (count: 4900):
171.9s 981 Calculated CFL: 0.800 > Limit: 0.500
171.9s 982 Original dt: 4.114750e-01 s
171.9s 983 Corrected dt: 2.571719e-01 s
171.9s 984 Correction factor: 1.6x
171.9s 985 Max wave speed detected: 19.44 m/s
172.3s 986 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
172.7s 987 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
172.7s 988 Stored output at t = 120.0000 s (Step 454)
172.7s 989 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
172.7s 990 [A
172.7s 991 
172.7s 992 Simulation finished at t = 120.0000 s after 454 steps.
172.7s 993 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.91s/s]
172.7s 994 Total runtime: 2.15 seconds.
172.8s 995 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
172.8s 996 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
172.8s 997 Using device: gpu
172.8s 998 DEBUG PARAMS: Reading K_m_kmh = 10.0
172.8s 999 DEBUG PARAMS: Reading K_c_kmh = 15.0
172.8s 1000 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
172.8s 1001 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
172.8s 1002 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
172.8s 1003 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
172.8s 1004 Loading road quality type: uniform
172.8s 1005 Uniform road quality value: 2
172.8s 1006 Road quality loaded.
172.8s 1007 Initial state created.
172.8s 1008 Transferring initial state and road quality to GPU...
172.8s 1009 GPU data transfer complete.
172.8s 1010 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
172.8s 1011 Initial boundary conditions applied.
172.8s 1012 [BC UPDATE] left → phase 0 RED (reduced inflow)
172.8s 1013 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
172.8s 1014 [BC UPDATE] left → phase 1 GREEN (normal inflow)
172.8s 1015 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
172.8s 1016 Running simulation until t = 60.00 s, outputting every 60.00 s
172.8s 1017 
172.8s 1018 [WARNING] Automatic CFL correction applied (count: 5000):
172.8s 1019 Calculated CFL: 0.800 > Limit: 0.500
172.8s 1020 Original dt: 6.937279e-01 s
172.8s 1021 Corrected dt: 4.335799e-01 s
172.8s 1022 Correction factor: 1.6x
172.8s 1023 Max wave speed detected: 11.53 m/s
173.2s 1024 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
173.7s 1025 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
173.7s 1026 [WARNING] Automatic CFL correction applied (count: 5100):
173.7s 1027 Calculated CFL: 0.800 > Limit: 0.500
173.7s 1028 Original dt: 4.129556e-01 s
173.7s 1029 Corrected dt: 2.580973e-01 s
173.7s 1030 Correction factor: 1.6x
173.7s 1031 Max wave speed detected: 19.37 m/s
174.1s 1032 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
174.6s 1033 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
174.6s 1034 [WARNING] Automatic CFL correction applied (count: 5200):
174.6s 1035 Calculated CFL: 0.800 > Limit: 0.500
174.6s 1036 Original dt: 4.114921e-01 s
174.6s 1037 Corrected dt: 2.571825e-01 s
174.6s 1038 Correction factor: 1.6x
174.6s 1039 Max wave speed detected: 19.44 m/s
174.8s 1040 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
174.8s 1041 [A
174.8s 1042 Stored output at t = 60.0000 s (Step 220)
174.8s 1043 
174.8s 1044 Simulation finished at t = 60.0000 s after 220 steps.
174.8s 1045 Total runtime: 1.99 seconds.
174.8s 1046 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.08s/s]
174.8s 1047 [BC UPDATE] left → phase 1 GREEN (normal inflow)
174.8s 1048 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
174.8s 1049 Running simulation until t = 120.00 s, outputting every 60.00 s
174.8s 1050 
175.0s 1051 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
175.5s 1052 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
175.5s 1053 [WARNING] Automatic CFL correction applied (count: 5300):
175.5s 1054 Calculated CFL: 0.800 > Limit: 0.500
175.5s 1055 Original dt: 4.114752e-01 s
175.5s 1056 Corrected dt: 2.571720e-01 s
175.5s 1057 Correction factor: 1.6x
175.5s 1058 Max wave speed detected: 19.44 m/s
175.9s 1059 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
176.4s 1060 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
176.4s 1061 [WARNING] Automatic CFL correction applied (count: 5400):
176.4s 1062 Calculated CFL: 0.800 > Limit: 0.500
176.4s 1063 Original dt: 4.114750e-01 s
176.4s 1064 Corrected dt: 2.571719e-01 s
176.4s 1065 Correction factor: 1.6x
176.4s 1066 Max wave speed detected: 19.44 m/s
176.9s 1067 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
176.9s 1068 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
176.9s 1069 [A
176.9s 1070 Stored output at t = 120.0000 s (Step 454)
176.9s 1071 
176.9s 1072 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.25s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.24s/s]
176.9s 1073 Simulation finished at t = 120.0000 s after 454 steps.
176.9s 1074 Total runtime: 2.12 seconds.
176.9s 1075 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
176.9s 1076 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
176.9s 1077 Using device: gpu
176.9s 1078 DEBUG PARAMS: Reading K_m_kmh = 10.0
176.9s 1079 DEBUG PARAMS: Reading K_c_kmh = 15.0
176.9s 1080 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
176.9s 1081 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
176.9s 1082 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
176.9s 1083 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
176.9s 1084 Loading road quality type: uniform
176.9s 1085 Uniform road quality value: 2
176.9s 1086 Road quality loaded.
176.9s 1087 Initial state created.
176.9s 1088 Transferring initial state and road quality to GPU...
176.9s 1089 GPU data transfer complete.
176.9s 1090 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
176.9s 1091 Initial boundary conditions applied.
176.9s 1092 [BC UPDATE] left → phase 0 RED (reduced inflow)
176.9s 1093 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
176.9s 1094 [BC UPDATE] left → phase 0 RED (reduced inflow)
176.9s 1095 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
176.9s 1096 Running simulation until t = 60.00 s, outputting every 60.00 s
176.9s 1097 
177.3s 1098 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
177.4s 1099 [WARNING] Automatic CFL correction applied (count: 5500):
177.4s 1100 Calculated CFL: 0.800 > Limit: 0.500
177.4s 1101 Original dt: 4.291001e-01 s
177.4s 1102 Corrected dt: 2.681876e-01 s
177.4s 1103 Correction factor: 1.6x
177.4s 1104 Max wave speed detected: 18.64 m/s
177.8s 1105 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
178.2s 1106 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
178.3s 1107 [WARNING] Automatic CFL correction applied (count: 5600):
178.3s 1108 Calculated CFL: 0.800 > Limit: 0.500
178.3s 1109 Original dt: 4.116634e-01 s
178.3s 1110 Corrected dt: 2.572896e-01 s
178.3s 1111 Correction factor: 1.6x
178.3s 1112 Max wave speed detected: 19.43 m/s
178.7s 1113 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
178.9s 1114 Stored output at t = 60.0000 s (Step 220)
178.9s 1115 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
178.9s 1116 [A
178.9s 1117 
178.9s 1118 Simulation finished at t = 60.0000 s after 220 steps.
178.9s 1119 Total runtime: 1.98 seconds.
178.9s 1120 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.38s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.38s/s]
178.9s 1121 [BC UPDATE] left → phase 1 GREEN (normal inflow)
178.9s 1122 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
178.9s 1123 Running simulation until t = 120.00 s, outputting every 60.00 s
178.9s 1124 
179.1s 1125 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
179.2s 1126 [WARNING] Automatic CFL correction applied (count: 5700):
179.2s 1127 Calculated CFL: 0.800 > Limit: 0.500
179.2s 1128 Original dt: 4.114773e-01 s
179.2s 1129 Corrected dt: 2.571733e-01 s
179.2s 1130 Correction factor: 1.6x
179.2s 1131 Max wave speed detected: 19.44 m/s
179.6s 1132 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
180.0s 1133 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
180.0s 1134 [WARNING] Automatic CFL correction applied (count: 5800):
180.0s 1135 Calculated CFL: 0.800 > Limit: 0.500
180.0s 1136 Original dt: 4.114750e-01 s
180.0s 1137 Corrected dt: 2.571719e-01 s
180.0s 1138 Correction factor: 1.6x
180.0s 1139 Max wave speed detected: 19.44 m/s
180.5s 1140 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
181.0s 1141 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
181.0s 1142 [WARNING] Automatic CFL correction applied (count: 5900):
181.0s 1143 Calculated CFL: 0.800 > Limit: 0.500
181.0s 1144 Original dt: 4.114750e-01 s
181.0s 1145 Corrected dt: 2.571719e-01 s
181.0s 1146 Correction factor: 1.6x
181.0s 1147 Max wave speed detected: 19.44 m/s
181.0s 1148 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
181.0s 1149 [A
181.0s 1150 Stored output at t = 120.0000 s (Step 454)
181.0s 1151 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.30s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.30s/s]
181.0s 1152 
181.0s 1153 Simulation finished at t = 120.0000 s after 454 steps.
181.0s 1154 Total runtime: 2.12 seconds.
181.0s 1155 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
181.0s 1156 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
181.0s 1157 Using device: gpu
181.0s 1158 DEBUG PARAMS: Reading K_m_kmh = 10.0
181.0s 1159 DEBUG PARAMS: Reading K_c_kmh = 15.0
181.0s 1160 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
181.0s 1161 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
181.0s 1162 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
181.0s 1163 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
181.0s 1164 Loading road quality type: uniform
181.0s 1165 Uniform road quality value: 2
181.0s 1166 Road quality loaded.
181.0s 1167 Initial state created.
181.0s 1168 Transferring initial state and road quality to GPU...
181.0s 1169 GPU data transfer complete.
181.0s 1170 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
181.0s 1171 Initial boundary conditions applied.
181.0s 1172 [BC UPDATE] left → phase 0 RED (reduced inflow)
181.0s 1173 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
181.0s 1174 [BC UPDATE] left → phase 0 RED (reduced inflow)
181.0s 1175 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
181.0s 1176 Running simulation until t = 60.00 s, outputting every 60.00 s
181.0s 1177 
181.5s 1178 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
181.9s 1179 [WARNING] Automatic CFL correction applied (count: 6000):
181.9s 1180 Calculated CFL: 0.800 > Limit: 0.500
181.9s 1181 Original dt: 4.136178e-01 s
181.9s 1182 Corrected dt: 2.585111e-01 s
181.9s 1183 Correction factor: 1.6x
181.9s 1184 Max wave speed detected: 19.34 m/s
181.9s 1185 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
182.4s 1186 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
182.8s 1187 [WARNING] Automatic CFL correction applied (count: 6100):
182.8s 1188 Calculated CFL: 0.800 > Limit: 0.500
182.8s 1189 Original dt: 4.114993e-01 s
182.8s 1190 Corrected dt: 2.571871e-01 s
182.8s 1191 Correction factor: 1.6x
182.8s 1192 Max wave speed detected: 19.44 m/s
182.8s 1193 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
183.0s 1194 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
183.0s 1195 [A
183.0s 1196 Stored output at t = 60.0000 s (Step 220)
183.0s 1197 
183.0s 1198 Simulation finished at t = 60.0000 s after 220 steps.
183.0s 1199 Total runtime: 1.97 seconds.
183.0s 1200 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.39s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.39s/s]
183.0s 1201 [BC UPDATE] left → phase 0 RED (reduced inflow)
183.0s 1202 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
183.0s 1203 Running simulation until t = 120.00 s, outputting every 60.00 s
183.0s 1204 
183.3s 1205 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
183.7s 1206 [WARNING] Automatic CFL correction applied (count: 6200):
183.7s 1207 Calculated CFL: 0.800 > Limit: 0.500
183.7s 1208 Original dt: 4.114753e-01 s
183.7s 1209 Corrected dt: 2.571721e-01 s
183.7s 1210 Correction factor: 1.6x
183.7s 1211 Max wave speed detected: 19.44 m/s
183.7s 1212 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
184.2s 1213 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
184.6s 1214 [WARNING] Automatic CFL correction applied (count: 6300):
184.6s 1215 Calculated CFL: 0.800 > Limit: 0.500
184.6s 1216 Original dt: 4.114750e-01 s
184.6s 1217 Corrected dt: 2.571719e-01 s
184.6s 1218 Correction factor: 1.6x
184.6s 1219 Max wave speed detected: 19.44 m/s
184.6s 1220 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
185.1s 1221 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
185.1s 1222 Stored output at t = 120.0000 s (Step 454)
185.1s 1223 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
185.1s 1224 [A
185.1s 1225 
185.1s 1226 Simulation finished at t = 120.0000 s after 454 steps.
185.1s 1227 Total runtime: 2.11 seconds.
185.1s 1228 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.50s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.49s/s]
185.1s 1229 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
185.1s 1230 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
185.1s 1231 Using device: gpu
185.1s 1232 DEBUG PARAMS: Reading K_m_kmh = 10.0
185.1s 1233 DEBUG PARAMS: Reading K_c_kmh = 15.0
185.1s 1234 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
185.1s 1235 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
185.1s 1236 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
185.1s 1237 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
185.1s 1238 Loading road quality type: uniform
185.1s 1239 Uniform road quality value: 2
185.1s 1240 Road quality loaded.
185.1s 1241 Initial state created.
185.1s 1242 Transferring initial state and road quality to GPU...
185.1s 1243 GPU data transfer complete.
185.1s 1244 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
185.1s 1245 Initial boundary conditions applied.
185.1s 1246 [BC UPDATE] left → phase 0 RED (reduced inflow)
185.1s 1247 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
185.1s 1248 [BC UPDATE] left → phase 1 GREEN (normal inflow)
185.1s 1249 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
185.1s 1250 Running simulation until t = 60.00 s, outputting every 60.00 s
185.1s 1251 
185.5s 1252 [WARNING] Automatic CFL correction applied (count: 6400):
185.5s 1253 Calculated CFL: 0.800 > Limit: 0.500
185.5s 1254 Original dt: 4.383955e-01 s
185.5s 1255 Corrected dt: 2.739972e-01 s
185.5s 1256 Correction factor: 1.6x
185.5s 1257 Max wave speed detected: 18.25 m/s
185.6s 1258 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
186.0s 1259 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
186.4s 1260 [WARNING] Automatic CFL correction applied (count: 6500):
186.4s 1261 Calculated CFL: 0.800 > Limit: 0.500
186.4s 1262 Original dt: 4.117505e-01 s
186.4s 1263 Corrected dt: 2.573441e-01 s
186.4s 1264 Correction factor: 1.6x
186.4s 1265 Max wave speed detected: 19.43 m/s
186.5s 1266 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
186.9s 1267 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
187.1s 1268 Stored output at t = 60.0000 s (Step 220)
187.1s 1269 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
187.1s 1270 [A
187.1s 1271 
187.1s 1272 Simulation finished at t = 60.0000 s after 220 steps.
187.1s 1273 Total runtime: 2.00 seconds.
187.1s 1274 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.96s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.95s/s]
187.1s 1275 [BC UPDATE] left → phase 0 RED (reduced inflow)
187.1s 1276 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
187.1s 1277 Running simulation until t = 120.00 s, outputting every 60.00 s
187.1s 1278 
187.3s 1279 [WARNING] Automatic CFL correction applied (count: 6600):
187.3s 1280 Calculated CFL: 0.800 > Limit: 0.500
187.3s 1281 Original dt: 4.114784e-01 s
187.3s 1282 Corrected dt: 2.571740e-01 s
187.3s 1283 Correction factor: 1.6x
187.3s 1284 Max wave speed detected: 19.44 m/s
187.4s 1285 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
187.8s 1286 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
188.2s 1287 [WARNING] Automatic CFL correction applied (count: 6700):
188.2s 1288 Calculated CFL: 0.800 > Limit: 0.500
188.2s 1289 Original dt: 4.114751e-01 s
188.2s 1290 Corrected dt: 2.571719e-01 s
188.2s 1291 Correction factor: 1.6x
188.2s 1292 Max wave speed detected: 19.44 m/s
188.3s 1293 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
188.8s 1294 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
189.1s 1295 [WARNING] Automatic CFL correction applied (count: 6800):
189.1s 1296 Calculated CFL: 0.800 > Limit: 0.500
189.1s 1297 Original dt: 4.114750e-01 s
189.1s 1298 Corrected dt: 2.571719e-01 s
189.1s 1299 Correction factor: 1.6x
189.1s 1300 Max wave speed detected: 19.44 m/s
189.2s 1301 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
189.2s 1302 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
189.2s 1303 [A
189.2s 1304 Stored output at t = 120.0000 s (Step 454)
189.2s 1305 
189.2s 1306 Simulation finished at t = 120.0000 s after 454 steps.
189.2s 1307 Total runtime: 2.12 seconds.
189.2s 1308 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.32s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.32s/s]
189.2s 1309 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
189.2s 1310 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
189.2s 1311 Using device: gpu
189.2s 1312 DEBUG PARAMS: Reading K_m_kmh = 10.0
189.2s 1313 DEBUG PARAMS: Reading K_c_kmh = 15.0
189.2s 1314 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
189.2s 1315 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
189.2s 1316 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
189.2s 1317 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
189.2s 1318 Loading road quality type: uniform
189.2s 1319 Uniform road quality value: 2
189.2s 1320 Road quality loaded.
189.2s 1321 Initial state created.
189.2s 1322 Transferring initial state and road quality to GPU...
189.2s 1323 GPU data transfer complete.
189.2s 1324 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
189.2s 1325 Initial boundary conditions applied.
189.2s 1326 [BC UPDATE] left → phase 0 RED (reduced inflow)
189.2s 1327 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
189.3s 1328 [BC UPDATE] left → phase 0 RED (reduced inflow)
189.3s 1329 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
189.3s 1330 Running simulation until t = 60.00 s, outputting every 60.00 s
189.3s 1331 
189.7s 1332 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
190.0s 1333 [WARNING] Automatic CFL correction applied (count: 6900):
190.0s 1334 Calculated CFL: 0.800 > Limit: 0.500
190.0s 1335 Original dt: 4.146430e-01 s
190.0s 1336 Corrected dt: 2.591518e-01 s
190.0s 1337 Correction factor: 1.6x
190.0s 1338 Max wave speed detected: 19.29 m/s
190.1s 1339 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
190.6s 1340 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
191.0s 1341 [WARNING] Automatic CFL correction applied (count: 7000):
191.0s 1342 Calculated CFL: 0.800 > Limit: 0.500
191.0s 1343 Original dt: 4.115110e-01 s
191.0s 1344 Corrected dt: 2.571944e-01 s
191.0s 1345 Correction factor: 1.6x
191.0s 1346 Max wave speed detected: 19.44 m/s
191.1s 1347 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
191.2s 1348 Stored output at t = 60.0000 s (Step 220)
191.2s 1349 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
191.2s 1350 [A
191.2s 1351 
191.2s 1352 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.03s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.02s/s]
191.2s 1353 Simulation finished at t = 60.0000 s after 220 steps.
191.2s 1354 Total runtime: 2.00 seconds.
191.3s 1355 [BC UPDATE] left → phase 0 RED (reduced inflow)
191.3s 1356 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
191.3s 1357 Running simulation until t = 120.00 s, outputting every 60.00 s
191.3s 1358 
191.5s 1359 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
191.9s 1360 [WARNING] Automatic CFL correction applied (count: 7100):
191.9s 1361 Calculated CFL: 0.800 > Limit: 0.500
191.9s 1362 Original dt: 4.114755e-01 s
191.9s 1363 Corrected dt: 2.571722e-01 s
191.9s 1364 Correction factor: 1.6x
191.9s 1365 Max wave speed detected: 19.44 m/s
192.0s 1366 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
192.4s 1367 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
192.8s 1368 [WARNING] Automatic CFL correction applied (count: 7200):
192.8s 1369 Calculated CFL: 0.800 > Limit: 0.500
192.8s 1370 Original dt: 4.114750e-01 s
192.8s 1371 Corrected dt: 2.571719e-01 s
192.8s 1372 Correction factor: 1.6x
192.8s 1373 Max wave speed detected: 19.44 m/s
192.9s 1374 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
193.3s 1375 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
193.4s 1376 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
193.4s 1377 [A
193.4s 1378 Stored output at t = 120.0000 s (Step 454)
193.4s 1379 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.22s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.21s/s]
193.4s 1380 
193.4s 1381 Simulation finished at t = 120.0000 s after 454 steps.
193.4s 1382 Total runtime: 2.13 seconds.
193.4s 1383 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
193.4s 1384 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
193.4s 1385 Using device: gpu
193.4s 1386 DEBUG PARAMS: Reading K_m_kmh = 10.0
193.4s 1387 DEBUG PARAMS: Reading K_c_kmh = 15.0
193.4s 1388 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
193.4s 1389 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
193.4s 1390 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
193.4s 1391 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
193.4s 1392 Loading road quality type: uniform
193.4s 1393 Uniform road quality value: 2
193.4s 1394 Road quality loaded.
193.4s 1395 Initial state created.
193.4s 1396 Transferring initial state and road quality to GPU...
193.4s 1397 GPU data transfer complete.
193.4s 1398 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
193.4s 1399 Initial boundary conditions applied.
193.4s 1400 [BC UPDATE] left → phase 0 RED (reduced inflow)
193.4s 1401 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
193.4s 1402 [BC UPDATE] left → phase 1 GREEN (normal inflow)
193.4s 1403 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
193.4s 1404 Running simulation until t = 60.00 s, outputting every 60.00 s
193.4s 1405 
193.7s 1406 [WARNING] Automatic CFL correction applied (count: 7300):
193.7s 1407 Calculated CFL: 0.800 > Limit: 0.500
193.7s 1408 Original dt: 4.499240e-01 s
193.7s 1409 Corrected dt: 2.812025e-01 s
193.7s 1410 Correction factor: 1.6x
193.7s 1411 Max wave speed detected: 17.78 m/s
193.8s 1412 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
194.3s 1413 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
194.6s 1414 [WARNING] Automatic CFL correction applied (count: 7400):
194.6s 1415 Calculated CFL: 0.800 > Limit: 0.500
194.6s 1416 Original dt: 4.118700e-01 s
194.6s 1417 Corrected dt: 2.574188e-01 s
194.6s 1418 Correction factor: 1.6x
194.6s 1419 Max wave speed detected: 19.42 m/s
194.8s 1420 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
195.2s 1421 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
195.4s 1422 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
195.4s 1423 [A
195.4s 1424 Stored output at t = 60.0000 s (Step 220)
195.4s 1425 
195.4s 1426 Simulation finished at t = 60.0000 s after 220 steps.
195.4s 1427 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.23s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.23s/s]
195.4s 1428 Total runtime: 1.99 seconds.
195.4s 1429 [BC UPDATE] left → phase 0 RED (reduced inflow)
195.4s 1430 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
195.4s 1431 Running simulation until t = 120.00 s, outputting every 60.00 s
195.4s 1432 
195.5s 1433 [WARNING] Automatic CFL correction applied (count: 7500):
195.5s 1434 Calculated CFL: 0.800 > Limit: 0.500
195.5s 1435 Original dt: 4.114798e-01 s
195.5s 1436 Corrected dt: 2.571749e-01 s
195.5s 1437 Correction factor: 1.6x
195.5s 1438 Max wave speed detected: 19.44 m/s
195.7s 1439 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
196.1s 1440 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
196.4s 1441 [WARNING] Automatic CFL correction applied (count: 7600):
196.4s 1442 Calculated CFL: 0.800 > Limit: 0.500
196.4s 1443 Original dt: 4.114751e-01 s
196.4s 1444 Corrected dt: 2.571719e-01 s
196.4s 1445 Correction factor: 1.6x
196.4s 1446 Max wave speed detected: 19.44 m/s
196.6s 1447 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
197.0s 1448 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
197.3s 1449 [WARNING] Automatic CFL correction applied (count: 7700):
197.3s 1450 Calculated CFL: 0.800 > Limit: 0.500
197.3s 1451 Original dt: 4.114750e-01 s
197.3s 1452 Corrected dt: 2.571719e-01 s
197.3s 1453 Correction factor: 1.6x
197.3s 1454 Max wave speed detected: 19.44 m/s
197.5s 1455 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
197.5s 1456 Stored output at t = 120.0000 s (Step 454)
197.5s 1457 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
197.5s 1458 [A
197.5s 1459 
197.5s 1460 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.37s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.37s/s]
197.5s 1461 Simulation finished at t = 120.0000 s after 454 steps.
197.5s 1462 Total runtime: 2.12 seconds.
197.5s 1463 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
197.5s 1464 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
197.5s 1465 Using device: gpu
197.5s 1466 DEBUG PARAMS: Reading K_m_kmh = 10.0
197.5s 1467 DEBUG PARAMS: Reading K_c_kmh = 15.0
197.5s 1468 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
197.5s 1469 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
197.5s 1470 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
197.5s 1471 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
197.5s 1472 Loading road quality type: uniform
197.5s 1473 Uniform road quality value: 2
197.5s 1474 Road quality loaded.
197.5s 1475 Initial state created.
197.5s 1476 Transferring initial state and road quality to GPU...
197.5s 1477 GPU data transfer complete.
197.5s 1478 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
197.5s 1479 Initial boundary conditions applied.
197.5s 1480 [BC UPDATE] left → phase 0 RED (reduced inflow)
197.5s 1481 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
197.5s 1482 [BC UPDATE] left → phase 0 RED (reduced inflow)
197.5s 1483 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
197.5s 1484 Running simulation until t = 60.00 s, outputting every 60.00 s
197.5s 1485 
198.0s 1486 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
198.2s 1487 [WARNING] Automatic CFL correction applied (count: 7800):
198.2s 1488 Calculated CFL: 0.800 > Limit: 0.500
198.2s 1489 Original dt: 4.158408e-01 s
198.2s 1490 Corrected dt: 2.599005e-01 s
198.2s 1491 Correction factor: 1.6x
198.2s 1492 Max wave speed detected: 19.24 m/s
198.4s 1493 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
198.9s 1494 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
199.1s 1495 [WARNING] Automatic CFL correction applied (count: 7900):
199.1s 1496 Calculated CFL: 0.800 > Limit: 0.500
199.1s 1497 Original dt: 4.115248e-01 s
199.1s 1498 Corrected dt: 2.572030e-01 s
199.1s 1499 Correction factor: 1.6x
199.1s 1500 Max wave speed detected: 19.44 m/s
199.3s 1501 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
199.5s 1502 Stored output at t = 60.0000 s (Step 220)
199.5s 1503 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
199.5s 1504 [A
199.5s 1505 
199.5s 1506 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.18s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.18s/s]
199.5s 1507 Simulation finished at t = 60.0000 s after 220 steps.
199.5s 1508 Total runtime: 1.99 seconds.
199.5s 1509 [BC UPDATE] left → phase 1 GREEN (normal inflow)
199.5s 1510 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
199.5s 1511 Running simulation until t = 120.00 s, outputting every 60.00 s
199.5s 1512 
199.8s 1513 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
200.0s 1514 [WARNING] Automatic CFL correction applied (count: 8000):
200.0s 1515 Calculated CFL: 0.800 > Limit: 0.500
200.0s 1516 Original dt: 4.114756e-01 s
200.0s 1517 Corrected dt: 2.571723e-01 s
200.0s 1518 Correction factor: 1.6x
200.0s 1519 Max wave speed detected: 19.44 m/s
200.2s 1520 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
200.7s 1521 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
201.0s 1522 [WARNING] Automatic CFL correction applied (count: 8100):
201.0s 1523 Calculated CFL: 0.800 > Limit: 0.500
201.0s 1524 Original dt: 4.114750e-01 s
201.0s 1525 Corrected dt: 2.571719e-01 s
201.0s 1526 Correction factor: 1.6x
201.0s 1527 Max wave speed detected: 19.44 m/s
201.1s 1528 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
201.6s 1529 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
201.6s 1530 Stored output at t = 120.0000 s (Step 454)
201.6s 1531 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
201.6s 1532 [A
201.6s 1533 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.55s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.54s/s]
201.6s 1534 
201.6s 1535 Simulation finished at t = 120.0000 s after 454 steps.
201.6s 1536 Total runtime: 2.10 seconds.
201.6s 1537 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
201.6s 1538 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
201.6s 1539 Using device: gpu
201.6s 1540 DEBUG PARAMS: Reading K_m_kmh = 10.0
201.6s 1541 DEBUG PARAMS: Reading K_c_kmh = 15.0
201.6s 1542 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
201.6s 1543 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
201.6s 1544 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
201.6s 1545 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
201.6s 1546 Loading road quality type: uniform
201.6s 1547 Uniform road quality value: 2
201.6s 1548 Road quality loaded.
201.6s 1549 Initial state created.
201.6s 1550 Transferring initial state and road quality to GPU...
201.6s 1551 GPU data transfer complete.
201.6s 1552 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
201.6s 1553 Initial boundary conditions applied.
201.6s 1554 [BC UPDATE] left → phase 0 RED (reduced inflow)
201.6s 1555 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
201.6s 1556 
201.6s 1557 [BC UPDATE] left → phase 1 GREEN (normal inflow)
201.6s 1558 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
201.6s 1559 Running simulation until t = 60.00 s, outputting every 60.00 s
201.9s 1560 [WARNING] Automatic CFL correction applied (count: 8200):
201.9s 1561 Calculated CFL: 0.800 > Limit: 0.500
201.9s 1562 Original dt: 4.725886e-01 s
201.9s 1563 Corrected dt: 2.953679e-01 s
201.9s 1564 Correction factor: 1.6x
201.9s 1565 Max wave speed detected: 16.93 m/s
202.1s 1566 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
202.5s 1567 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
202.8s 1568 [WARNING] Automatic CFL correction applied (count: 8300):
202.8s 1569 Calculated CFL: 0.800 > Limit: 0.500
202.8s 1570 Original dt: 4.120263e-01 s
202.8s 1571 Corrected dt: 2.575164e-01 s
202.8s 1572 Correction factor: 1.6x
202.8s 1573 Max wave speed detected: 19.42 m/s
203.0s 1574 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
203.4s 1575 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
203.6s 1576 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
203.6s 1577 [A
203.6s 1578 Stored output at t = 60.0000 s (Step 220)
203.6s 1579 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.39s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.39s/s]
203.6s 1580 
203.6s 1581 Simulation finished at t = 60.0000 s after 220 steps.
203.6s 1582 Total runtime: 1.97 seconds.
203.6s 1583 [BC UPDATE] left → phase 1 GREEN (normal inflow)
203.6s 1584 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
203.6s 1585 Running simulation until t = 120.00 s, outputting every 60.00 s
203.6s 1586 
203.7s 1587 [WARNING] Automatic CFL correction applied (count: 8400):
203.7s 1588 Calculated CFL: 0.800 > Limit: 0.500
203.7s 1589 Original dt: 4.114817e-01 s
203.7s 1590 Corrected dt: 2.571761e-01 s
203.7s 1591 Correction factor: 1.6x
203.7s 1592 Max wave speed detected: 19.44 m/s
203.9s 1593 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
204.3s 1594 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
204.6s 1595 [WARNING] Automatic CFL correction applied (count: 8500):
204.6s 1596 Calculated CFL: 0.800 > Limit: 0.500
204.6s 1597 Original dt: 4.114751e-01 s
204.6s 1598 Corrected dt: 2.571719e-01 s
204.6s 1599 Correction factor: 1.6x
204.6s 1600 Max wave speed detected: 19.44 m/s
204.8s 1601 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
205.2s 1602 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
205.5s 1603 [WARNING] Automatic CFL correction applied (count: 8600):
205.5s 1604 Calculated CFL: 0.800 > Limit: 0.500
205.5s 1605 Original dt: 4.114750e-01 s
205.5s 1606 Corrected dt: 2.571719e-01 s
205.5s 1607 Correction factor: 1.6x
205.5s 1608 Max wave speed detected: 19.44 m/s
205.7s 1609 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
205.7s 1610 Stored output at t = 120.0000 s (Step 454)
205.7s 1611 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
205.7s 1612 [A
205.7s 1613 
205.7s 1614 Simulation finished at t = 120.0000 s after 454 steps.
205.7s 1615 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.46s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.46s/s]
205.7s 1616 Total runtime: 2.11 seconds.
205.7s 1617 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
205.7s 1618 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
205.7s 1619 Using device: gpu
205.7s 1620 DEBUG PARAMS: Reading K_m_kmh = 10.0
205.7s 1621 DEBUG PARAMS: Reading K_c_kmh = 15.0
205.7s 1622 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
205.7s 1623 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
205.7s 1624 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
205.7s 1625 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
205.7s 1626 Loading road quality type: uniform
205.7s 1627 Uniform road quality value: 2
205.7s 1628 Road quality loaded.
205.7s 1629 Initial state created.
205.7s 1630 Transferring initial state and road quality to GPU...
205.7s 1631 GPU data transfer complete.
205.7s 1632 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
205.7s 1633 Initial boundary conditions applied.
205.7s 1634 [BC UPDATE] left → phase 0 RED (reduced inflow)
205.7s 1635 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
205.7s 1636 [BC UPDATE] left → phase 0 RED (reduced inflow)
205.7s 1637 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
205.7s 1638 Running simulation until t = 60.00 s, outputting every 60.00 s
205.7s 1639 
206.2s 1640 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
206.4s 1641 [WARNING] Automatic CFL correction applied (count: 8700):
206.4s 1642 Calculated CFL: 0.800 > Limit: 0.500
206.4s 1643 Original dt: 4.178347e-01 s
206.4s 1644 Corrected dt: 2.611467e-01 s
206.4s 1645 Correction factor: 1.6x
206.4s 1646 Max wave speed detected: 19.15 m/s
206.6s 1647 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
207.1s 1648 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
207.3s 1649 [WARNING] Automatic CFL correction applied (count: 8800):
207.3s 1650 Calculated CFL: 0.800 > Limit: 0.500
207.3s 1651 Original dt: 4.115457e-01 s
207.3s 1652 Corrected dt: 2.572161e-01 s
207.3s 1653 Correction factor: 1.6x
207.3s 1654 Max wave speed detected: 19.44 m/s
207.5s 1655 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
207.7s 1656 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
207.7s 1657 Stored output at t = 60.0000 s (Step 220)
207.7s 1658 [A
207.7s 1659 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.28s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.28s/s]
207.7s 1660 
207.7s 1661 Simulation finished at t = 60.0000 s after 220 steps.
207.7s 1662 Total runtime: 1.98 seconds.
207.7s 1663 [BC UPDATE] left → phase 1 GREEN (normal inflow)
207.7s 1664 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
207.7s 1665 Running simulation until t = 120.00 s, outputting every 60.00 s
207.7s 1666 
208.0s 1667 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
208.2s 1668 [WARNING] Automatic CFL correction applied (count: 8900):
208.2s 1669 Calculated CFL: 0.800 > Limit: 0.500
208.2s 1670 Original dt: 4.114759e-01 s
208.2s 1671 Corrected dt: 2.571724e-01 s
208.2s 1672 Correction factor: 1.6x
208.2s 1673 Max wave speed detected: 19.44 m/s
208.4s 1674 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
208.9s 1675 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
209.1s 1676 [WARNING] Automatic CFL correction applied (count: 9000):
209.1s 1677 Calculated CFL: 0.800 > Limit: 0.500
209.1s 1678 Original dt: 4.114750e-01 s
209.1s 1679 Corrected dt: 2.571719e-01 s
209.1s 1680 Correction factor: 1.6x
209.1s 1681 Max wave speed detected: 19.44 m/s
209.3s 1682 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
209.8s 1683 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
209.8s 1684 Stored output at t = 120.0000 s (Step 454)
209.8s 1685 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
209.8s 1686 [A
209.8s 1687 
209.8s 1688 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.42s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.42s/s]
209.8s 1689 Simulation finished at t = 120.0000 s after 454 steps.
209.8s 1690 Total runtime: 2.11 seconds.
209.8s 1691 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
209.8s 1692 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
209.8s 1693 Using device: gpu
209.8s 1694 DEBUG PARAMS: Reading K_m_kmh = 10.0
209.8s 1695 DEBUG PARAMS: Reading K_c_kmh = 15.0
209.8s 1696 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
209.8s 1697 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
209.8s 1698 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
209.8s 1699 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
209.8s 1700 Loading road quality type: uniform
209.8s 1701 Uniform road quality value: 2
209.8s 1702 Road quality loaded.
209.8s 1703 Initial state created.
209.8s 1704 Transferring initial state and road quality to GPU...
209.8s 1705 GPU data transfer complete.
209.8s 1706 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
209.8s 1707 Initial boundary conditions applied.
209.8s 1708 [BC UPDATE] left → phase 0 RED (reduced inflow)
209.8s 1709 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
209.8s 1710 [BC UPDATE] left → phase 0 RED (reduced inflow)
209.8s 1711 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
209.8s 1712 Running simulation until t = 60.00 s, outputting every 60.00 s
209.8s 1713 
210.0s 1714 [WARNING] Automatic CFL correction applied (count: 9100):
210.0s 1715 Calculated CFL: 0.800 > Limit: 0.500
210.0s 1716 Original dt: 5.079162e-01 s
210.0s 1717 Corrected dt: 3.174477e-01 s
210.0s 1718 Correction factor: 1.6x
210.0s 1719 Max wave speed detected: 15.75 m/s
210.3s 1720 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
210.7s 1721 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
210.9s 1722 [WARNING] Automatic CFL correction applied (count: 9200):
210.9s 1723 Calculated CFL: 0.800 > Limit: 0.500
210.9s 1724 Original dt: 4.122806e-01 s
210.9s 1725 Corrected dt: 2.576754e-01 s
210.9s 1726 Correction factor: 1.6x
210.9s 1727 Max wave speed detected: 19.40 m/s
211.2s 1728 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
211.7s 1729 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
211.8s 1730 [WARNING] Automatic CFL correction applied (count: 9300):
211.8s 1731 Calculated CFL: 0.800 > Limit: 0.500
211.8s 1732 Original dt: 4.114842e-01 s
211.8s 1733 Corrected dt: 2.571776e-01 s
211.8s 1734 Correction factor: 1.6x
211.8s 1735 Max wave speed detected: 19.44 m/s
211.8s 1736 Stored output at t = 60.0000 s (Step 220)
211.8s 1737 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
211.8s 1738 [A
211.8s 1739 
211.8s 1740 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.93s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.93s/s]
211.8s 1741 Simulation finished at t = 60.0000 s after 220 steps.
211.8s 1742 Total runtime: 2.01 seconds.
211.8s 1743 [BC UPDATE] left → phase 0 RED (reduced inflow)
211.8s 1744 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
211.8s 1745 Running simulation until t = 120.00 s, outputting every 60.00 s
211.8s 1746 
212.1s 1747 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
212.6s 1748 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
212.7s 1749 [WARNING] Automatic CFL correction applied (count: 9400):
212.7s 1750 Calculated CFL: 0.800 > Limit: 0.500
212.7s 1751 Original dt: 4.114751e-01 s
212.7s 1752 Corrected dt: 2.571720e-01 s
212.7s 1753 Correction factor: 1.6x
212.7s 1754 Max wave speed detected: 19.44 m/s
213.0s 1755 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
213.5s 1756 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
213.6s 1757 [WARNING] Automatic CFL correction applied (count: 9500):
213.6s 1758 Calculated CFL: 0.800 > Limit: 0.500
213.6s 1759 Original dt: 4.114750e-01 s
213.6s 1760 Corrected dt: 2.571719e-01 s
213.6s 1761 Correction factor: 1.6x
213.6s 1762 Max wave speed detected: 19.44 m/s
213.9s 1763 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
214.0s 1764 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
214.0s 1765 [A
214.0s 1766 Stored output at t = 120.0000 s (Step 454)
214.0s 1767 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.34s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.34s/s]
214.0s 1768 
214.0s 1769 Simulation finished at t = 120.0000 s after 454 steps.
214.0s 1770 Total runtime: 2.12 seconds.
214.0s 1771 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
214.0s 1772 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
214.0s 1773 Using device: gpu
214.0s 1774 DEBUG PARAMS: Reading K_m_kmh = 10.0
214.0s 1775 DEBUG PARAMS: Reading K_c_kmh = 15.0
214.0s 1776 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
214.0s 1777 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
214.0s 1778 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
214.0s 1779 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
214.0s 1780 Loading road quality type: uniform
214.0s 1781 Uniform road quality value: 2
214.0s 1782 Road quality loaded.
214.0s 1783 Initial state created.
214.0s 1784 Transferring initial state and road quality to GPU...
214.0s 1785 GPU data transfer complete.
214.0s 1786 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
214.0s 1787 Initial boundary conditions applied.
214.0s 1788 [BC UPDATE] left → phase 0 RED (reduced inflow)
214.0s 1789 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
214.0s 1790 [BC UPDATE] left → phase 1 GREEN (normal inflow)
214.0s 1791 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
214.0s 1792 Running simulation until t = 60.00 s, outputting every 60.00 s
214.0s 1793 
214.4s 1794 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
214.6s 1795 [WARNING] Automatic CFL correction applied (count: 9600):
214.6s 1796 Calculated CFL: 0.800 > Limit: 0.500
214.6s 1797 Original dt: 4.208904e-01 s
214.6s 1798 Corrected dt: 2.630565e-01 s
214.6s 1799 Correction factor: 1.6x
214.6s 1800 Max wave speed detected: 19.01 m/s
214.9s 1801 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
215.3s 1802 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
215.5s 1803 [WARNING] Automatic CFL correction applied (count: 9700):
215.5s 1804 Calculated CFL: 0.800 > Limit: 0.500
215.5s 1805 Original dt: 4.115795e-01 s
215.5s 1806 Corrected dt: 2.572372e-01 s
215.5s 1807 Correction factor: 1.6x
215.5s 1808 Max wave speed detected: 19.44 m/s
215.8s 1809 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
216.0s 1810 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
216.0s 1811 [A
216.0s 1812 Stored output at t = 60.0000 s (Step 220)
216.0s 1813 
216.0s 1814 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.01s/s]
216.0s 1815 Simulation finished at t = 60.0000 s after 220 steps.
216.0s 1816 Total runtime: 2.00 seconds.
216.0s 1817 
216.0s 1818 [BC UPDATE] left → phase 1 GREEN (normal inflow)
216.0s 1819 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
216.0s 1820 Running simulation until t = 120.00 s, outputting every 60.00 s
216.2s 1821 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
216.4s 1822 [WARNING] Automatic CFL correction applied (count: 9800):
216.4s 1823 Calculated CFL: 0.800 > Limit: 0.500
216.4s 1824 Original dt: 4.114763e-01 s
216.4s 1825 Corrected dt: 2.571727e-01 s
216.4s 1826 Correction factor: 1.6x
216.4s 1827 Max wave speed detected: 19.44 m/s
216.7s 1828 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
217.2s 1829 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
217.3s 1830 [WARNING] Automatic CFL correction applied (count: 9900):
217.3s 1831 Calculated CFL: 0.800 > Limit: 0.500
217.3s 1832 Original dt: 4.114750e-01 s
217.3s 1833 Corrected dt: 2.571719e-01 s
217.3s 1834 Correction factor: 1.6x
217.3s 1835 Max wave speed detected: 19.44 m/s
217.6s 1836 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
218.1s 1837 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
218.1s 1838 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
218.1s 1839 Stored output at t = 120.0000 s (Step 454)
218.1s 1840 [A
218.1s 1841 
218.1s 1842 Simulation finished at t = 120.0000 s after 454 steps.
218.1s 1843 Total runtime: 2.16 seconds.
218.1s 1844 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.82s/s]
218.1s 1845 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
218.1s 1846 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
218.1s 1847 Using device: gpu
218.1s 1848 DEBUG PARAMS: Reading K_m_kmh = 10.0
218.1s 1849 DEBUG PARAMS: Reading K_c_kmh = 15.0
218.1s 1850 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
218.1s 1851 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
218.1s 1852 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
218.1s 1853 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
218.1s 1854 Loading road quality type: uniform
218.1s 1855 Uniform road quality value: 2
218.1s 1856 Road quality loaded.
218.1s 1857 Initial state created.
218.1s 1858 Transferring initial state and road quality to GPU...
218.1s 1859 GPU data transfer complete.
218.1s 1860 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
218.1s 1861 Initial boundary conditions applied.
218.1s 1862 [BC UPDATE] left → phase 0 RED (reduced inflow)
218.1s 1863 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
218.1s 1864 [BC UPDATE] left → phase 0 RED (reduced inflow)
218.1s 1865 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
218.1s 1866 Running simulation until t = 60.00 s, outputting every 60.00 s
218.1s 1867 
218.2s 1868 [WARNING] Automatic CFL correction applied (count: 10000):
218.2s 1869 Calculated CFL: 0.800 > Limit: 0.500
218.2s 1870 Original dt: 5.794714e-01 s
218.2s 1871 Corrected dt: 3.621696e-01 s
218.2s 1872 Correction factor: 1.6x
218.2s 1873 Max wave speed detected: 13.81 m/s
218.6s 1874 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
219.1s 1875 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
219.2s 1876 [WARNING] Automatic CFL correction applied (count: 10100):
219.2s 1877 Calculated CFL: 0.800 > Limit: 0.500
219.2s 1878 Original dt: 4.126347e-01 s
219.2s 1879 Corrected dt: 2.578967e-01 s
219.2s 1880 Correction factor: 1.6x
219.2s 1881 Max wave speed detected: 19.39 m/s
219.5s 1882 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
219.9s 1883 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
220.0s 1884 [WARNING] Automatic CFL correction applied (count: 10200):
220.0s 1885 Calculated CFL: 0.800 > Limit: 0.500
220.0s 1886 Original dt: 4.114885e-01 s
220.0s 1887 Corrected dt: 2.571803e-01 s
220.0s 1888 Correction factor: 1.6x
220.0s 1889 Max wave speed detected: 19.44 m/s
220.1s 1890 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
220.1s 1891 [A
220.1s 1892 Stored output at t = 60.0000 s (Step 220)
220.1s 1893 
220.1s 1894 Simulation finished at t = 60.0000 s after 220 steps.
220.1s 1895 Total runtime: 1.97 seconds.
220.1s 1896 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.47s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.47s/s]
220.1s 1897 [BC UPDATE] left → phase 0 RED (reduced inflow)
220.1s 1898 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
220.1s 1899 Running simulation until t = 120.00 s, outputting every 60.00 s
220.1s 1900 
220.4s 1901 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
220.8s 1902 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
220.9s 1903 [WARNING] Automatic CFL correction applied (count: 10300):
220.9s 1904 Calculated CFL: 0.800 > Limit: 0.500
220.9s 1905 Original dt: 4.114752e-01 s
220.9s 1906 Corrected dt: 2.571720e-01 s
220.9s 1907 Correction factor: 1.6x
220.9s 1908 Max wave speed detected: 19.44 m/s
221.3s 1909 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
221.8s 1910 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
221.9s 1911 [WARNING] Automatic CFL correction applied (count: 10400):
221.9s 1912 Calculated CFL: 0.800 > Limit: 0.500
221.9s 1913 Original dt: 4.114750e-01 s
221.9s 1914 Corrected dt: 2.571719e-01 s
221.9s 1915 Correction factor: 1.6x
221.9s 1916 Max wave speed detected: 19.44 m/s
222.2s 1917 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
222.2s 1918 Stored output at t = 120.0000 s (Step 454)
222.2s 1919 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
222.2s 1920 [A
222.2s 1921 
222.2s 1922 Simulation finished at t = 120.0000 s after 454 steps.
222.2s 1923 Total runtime: 2.13 seconds.
222.2s 1924 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.23s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.23s/s]
222.2s 1925 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
222.2s 1926 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
222.2s 1927 Using device: gpu
222.3s 1928 DEBUG PARAMS: Reading K_m_kmh = 10.0
222.3s 1929 DEBUG PARAMS: Reading K_c_kmh = 15.0
222.3s 1930 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
222.3s 1931 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
222.3s 1932 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
222.3s 1933 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
222.3s 1934 Loading road quality type: uniform
222.3s 1935 Uniform road quality value: 2
222.3s 1936 Road quality loaded.
222.3s 1937 Initial state created.
222.3s 1938 Transferring initial state and road quality to GPU...
222.3s 1939 GPU data transfer complete.
222.3s 1940 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
222.3s 1941 Initial boundary conditions applied.
222.3s 1942 [BC UPDATE] left → phase 0 RED (reduced inflow)
222.3s 1943 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
222.3s 1944 [BC UPDATE] left → phase 0 RED (reduced inflow)
222.3s 1945 
222.3s 1946 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
222.3s 1947 Running simulation until t = 60.00 s, outputting every 60.00 s
222.7s 1948 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
222.8s 1949 [WARNING] Automatic CFL correction applied (count: 10500):
222.8s 1950 Calculated CFL: 0.800 > Limit: 0.500
222.8s 1951 Original dt: 4.246092e-01 s
222.8s 1952 Corrected dt: 2.653807e-01 s
222.8s 1953 Correction factor: 1.6x
222.8s 1954 Max wave speed detected: 18.84 m/s
223.2s 1955 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
223.6s 1956 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
223.7s 1957 [WARNING] Automatic CFL correction applied (count: 10600):
223.7s 1958 Calculated CFL: 0.800 > Limit: 0.500
223.7s 1959 Original dt: 4.116208e-01 s
223.7s 1960 Corrected dt: 2.572630e-01 s
223.7s 1961 Correction factor: 1.6x
223.7s 1962 Max wave speed detected: 19.44 m/s
224.0s 1963 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
224.2s 1964 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
224.2s 1965 [A
224.2s 1966 Stored output at t = 60.0000 s (Step 220)
224.2s 1967 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.53s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.53s/s]
224.2s 1968 
224.2s 1969 Simulation finished at t = 60.0000 s after 220 steps.
224.2s 1970 Total runtime: 1.97 seconds.
224.2s 1971 
224.2s 1972 [BC UPDATE] left → phase 1 GREEN (normal inflow)
224.2s 1973 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
224.2s 1974 Running simulation until t = 120.00 s, outputting every 60.00 s
224.5s 1975 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
224.6s 1976 [WARNING] Automatic CFL correction applied (count: 10700):
224.6s 1977 Calculated CFL: 0.800 > Limit: 0.500
224.6s 1978 Original dt: 4.114768e-01 s
224.6s 1979 Corrected dt: 2.571730e-01 s
224.6s 1980 Correction factor: 1.6x
224.6s 1981 Max wave speed detected: 19.44 m/s
224.9s 1982 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
225.4s 1983 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
225.4s 1984 [WARNING] Automatic CFL correction applied (count: 10800):
225.4s 1985 Calculated CFL: 0.800 > Limit: 0.500
225.4s 1986 Original dt: 4.114750e-01 s
225.4s 1987 Corrected dt: 2.571719e-01 s
225.4s 1988 Correction factor: 1.6x
225.4s 1989 Max wave speed detected: 19.44 m/s
225.8s 1990 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
226.3s 1991 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
226.3s 1992 Stored output at t = 120.0000 s (Step 454)
226.3s 1993 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
226.3s 1994 [A
226.3s 1995 
226.3s 1996 Simulation finished at t = 120.0000 s after 454 steps.
226.3s 1997 Total runtime: 2.08 seconds.
226.3s 1998 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.87s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.86s/s]
226.3s 1999 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
226.3s 2000 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
226.3s 2001 Using device: gpu
226.3s 2002 DEBUG PARAMS: Reading K_m_kmh = 10.0
226.3s 2003 DEBUG PARAMS: Reading K_c_kmh = 15.0
226.3s 2004 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
226.3s 2005 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
226.3s 2006 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
226.3s 2007 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
226.3s 2008 Loading road quality type: uniform
226.3s 2009 Uniform road quality value: 2
226.3s 2010 Road quality loaded.
226.3s 2011 Initial state created.
226.3s 2012 Transferring initial state and road quality to GPU...
226.3s 2013 GPU data transfer complete.
226.3s 2014 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
226.3s 2015 Initial boundary conditions applied.
226.3s 2016 [BC UPDATE] left → phase 0 RED (reduced inflow)
226.3s 2017 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
226.3s 2018 [BC UPDATE] left → phase 0 RED (reduced inflow)
226.3s 2019 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
226.3s 2020 Running simulation until t = 60.00 s, outputting every 60.00 s
226.3s 2021 
226.3s 2022 [WARNING] Automatic CFL correction applied (count: 10900):
226.3s 2023 Calculated CFL: 0.800 > Limit: 0.500
226.3s 2024 Original dt: 7.206378e-01 s
226.3s 2025 Corrected dt: 4.503986e-01 s
226.3s 2026 Correction factor: 1.6x
226.3s 2027 Max wave speed detected: 11.10 m/s
226.8s 2028 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
227.2s 2029 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
227.2s 2030 [WARNING] Automatic CFL correction applied (count: 11000):
227.2s 2031 Calculated CFL: 0.800 > Limit: 0.500
227.2s 2032 Original dt: 4.130919e-01 s
227.2s 2033 Corrected dt: 2.581824e-01 s
227.2s 2034 Correction factor: 1.6x
227.2s 2035 Max wave speed detected: 19.37 m/s
227.7s 2036 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
228.1s 2037 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
228.1s 2038 [WARNING] Automatic CFL correction applied (count: 11100):
228.1s 2039 Calculated CFL: 0.800 > Limit: 0.500
228.1s 2040 Original dt: 4.114936e-01 s
228.1s 2041 Corrected dt: 2.571835e-01 s
228.1s 2042 Correction factor: 1.6x
228.1s 2043 Max wave speed detected: 19.44 m/s
228.3s 2044 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
228.3s 2045 [A
228.3s 2046 Stored output at t = 60.0000 s (Step 220)
228.3s 2047 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.60s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.60s/s]
228.3s 2048 
228.3s 2049 Simulation finished at t = 60.0000 s after 220 steps.
228.3s 2050 Total runtime: 1.96 seconds.
228.3s 2051 [BC UPDATE] left → phase 0 RED (reduced inflow)
228.3s 2052 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
228.3s 2053 Running simulation until t = 120.00 s, outputting every 60.00 s
228.3s 2054 
228.5s 2055 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
229.0s 2056 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
229.0s 2057 [WARNING] Automatic CFL correction applied (count: 11200):
229.0s 2058 Calculated CFL: 0.800 > Limit: 0.500
229.0s 2059 Original dt: 4.114753e-01 s
229.0s 2060 Corrected dt: 2.571720e-01 s
229.0s 2061 Correction factor: 1.6x
229.0s 2062 Max wave speed detected: 19.44 m/s
229.4s 2063 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
229.9s 2064 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
229.9s 2065 [WARNING] Automatic CFL correction applied (count: 11300):
229.9s 2066 Calculated CFL: 0.800 > Limit: 0.500
229.9s 2067 Original dt: 4.114750e-01 s
229.9s 2068 Corrected dt: 2.571719e-01 s
229.9s 2069 Correction factor: 1.6x
229.9s 2070 Max wave speed detected: 19.44 m/s
230.3s 2071 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
230.4s 2072 Stored output at t = 120.0000 s (Step 454)
230.4s 2073 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
230.4s 2074 [A
230.4s 2075 
230.4s 2076 Simulation finished at t = 120.0000 s after 454 steps.
230.4s 2077 Total runtime: 2.07 seconds.
230.4s 2078 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.97s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.96s/s]
230.4s 2079 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
230.4s 2080 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
230.4s 2081 Using device: gpu
230.4s 2082 DEBUG PARAMS: Reading K_m_kmh = 10.0
230.4s 2083 DEBUG PARAMS: Reading K_c_kmh = 15.0
230.4s 2084 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
230.4s 2085 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
230.4s 2086 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
230.4s 2087 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
230.4s 2088 Loading road quality type: uniform
230.4s 2089 Uniform road quality value: 2
230.4s 2090 Road quality loaded.
230.4s 2091 Initial state created.
230.4s 2092 Transferring initial state and road quality to GPU...
230.4s 2093 GPU data transfer complete.
230.4s 2094 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
230.4s 2095 Initial boundary conditions applied.
230.4s 2096 [BC UPDATE] left → phase 0 RED (reduced inflow)
230.4s 2097 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
230.4s 2098 📊 Progress: 50/100 (50.0%) | ETA: 1.8 min | Speed: 0.5 steps/s
230.4s 2099 [BC UPDATE] left → phase 0 RED (reduced inflow)
230.4s 2100 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
230.4s 2101 Running simulation until t = 60.00 s, outputting every 60.00 s
230.4s 2102 
230.8s 2103 [WARNING] Automatic CFL correction applied (count: 11400):
230.8s 2104 Calculated CFL: 0.800 > Limit: 0.500
230.8s 2105 Original dt: 4.310741e-01 s
230.8s 2106 Corrected dt: 2.694213e-01 s
230.8s 2107 Correction factor: 1.6x
230.8s 2108 Max wave speed detected: 18.56 m/s
230.9s 2109 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
231.3s 2110 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
231.7s 2111 [WARNING] Automatic CFL correction applied (count: 11500):
231.7s 2112 Calculated CFL: 0.800 > Limit: 0.500
231.7s 2113 Original dt: 4.116814e-01 s
231.7s 2114 Corrected dt: 2.573009e-01 s
231.7s 2115 Correction factor: 1.6x
231.7s 2116 Max wave speed detected: 19.43 m/s
231.7s 2117 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
232.2s 2118 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
232.4s 2119 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
232.4s 2120 [A
232.4s 2121 Stored output at t = 60.0000 s (Step 220)
232.4s 2122 
232.4s 2123 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.07s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.07s/s]
232.4s 2124 Simulation finished at t = 60.0000 s after 220 steps.
232.4s 2125 Total runtime: 2.00 seconds.
232.4s 2126 [BC UPDATE] left → phase 0 RED (reduced inflow)
232.4s 2127 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
232.4s 2128 Running simulation until t = 120.00 s, outputting every 60.00 s
232.4s 2129 
232.6s 2130 [WARNING] Automatic CFL correction applied (count: 11600):
232.6s 2131 Calculated CFL: 0.800 > Limit: 0.500
232.6s 2132 Original dt: 4.114775e-01 s
232.6s 2133 Corrected dt: 2.571735e-01 s
232.6s 2134 Correction factor: 1.6x
232.6s 2135 Max wave speed detected: 19.44 m/s
232.6s 2136 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
233.1s 2137 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
233.5s 2138 [WARNING] Automatic CFL correction applied (count: 11700):
233.5s 2139 Calculated CFL: 0.800 > Limit: 0.500
233.5s 2140 Original dt: 4.114750e-01 s
233.5s 2141 Corrected dt: 2.571719e-01 s
233.5s 2142 Correction factor: 1.6x
233.5s 2143 Max wave speed detected: 19.44 m/s
233.5s 2144 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
234.0s 2145 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
234.4s 2146 [WARNING] Automatic CFL correction applied (count: 11800):
234.4s 2147 Calculated CFL: 0.800 > Limit: 0.500
234.4s 2148 Original dt: 4.114750e-01 s
234.4s 2149 Corrected dt: 2.571719e-01 s
234.4s 2150 Correction factor: 1.6x
234.4s 2151 Max wave speed detected: 19.44 m/s
234.4s 2152 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
234.5s 2153 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
234.5s 2154 [A
234.5s 2155 Stored output at t = 120.0000 s (Step 454)
234.5s 2156 
234.5s 2157 Simulation finished at t = 120.0000 s after 454 steps.
234.5s 2158 Total runtime: 2.10 seconds.
234.5s 2159 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.63s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.63s/s]
234.5s 2160 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
234.5s 2161 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
234.5s 2162 Using device: gpu
234.5s 2163 DEBUG PARAMS: Reading K_m_kmh = 10.0
234.5s 2164 DEBUG PARAMS: Reading K_c_kmh = 15.0
234.5s 2165 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
234.5s 2166 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
234.5s 2167 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
234.5s 2168 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
234.5s 2169 Loading road quality type: uniform
234.5s 2170 Uniform road quality value: 2
234.5s 2171 Road quality loaded.
234.5s 2172 Initial state created.
234.5s 2173 Transferring initial state and road quality to GPU...
234.5s 2174 GPU data transfer complete.
234.5s 2175 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
234.5s 2176 Initial boundary conditions applied.
234.5s 2177 [BC UPDATE] left → phase 0 RED (reduced inflow)
234.5s 2178 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
234.5s 2179 [BC UPDATE] left → phase 1 GREEN (normal inflow)
234.5s 2180 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
234.5s 2181 Running simulation until t = 60.00 s, outputting every 60.00 s
234.5s 2182 
234.9s 2183 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
235.3s 2184 [WARNING] Automatic CFL correction applied (count: 11900):
235.3s 2185 Calculated CFL: 0.800 > Limit: 0.500
235.3s 2186 Original dt: 4.138412e-01 s
235.3s 2187 Corrected dt: 2.586508e-01 s
235.3s 2188 Correction factor: 1.6x
235.3s 2189 Max wave speed detected: 19.33 m/s
235.4s 2190 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
235.8s 2191 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
236.2s 2192 [WARNING] Automatic CFL correction applied (count: 12000):
236.2s 2193 Calculated CFL: 0.800 > Limit: 0.500
236.2s 2194 Original dt: 4.115017e-01 s
236.2s 2195 Corrected dt: 2.571886e-01 s
236.2s 2196 Correction factor: 1.6x
236.2s 2197 Max wave speed detected: 19.44 m/s
236.3s 2198 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
236.5s 2199 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
236.5s 2200 [A
236.5s 2201 Stored output at t = 60.0000 s (Step 220)
236.5s 2202 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.19s/s]
236.5s 2203 
236.5s 2204 Simulation finished at t = 60.0000 s after 220 steps.
236.5s 2205 Total runtime: 1.99 seconds.
236.5s 2206 [BC UPDATE] left → phase 1 GREEN (normal inflow)
236.5s 2207 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
236.5s 2208 Running simulation until t = 120.00 s, outputting every 60.00 s
236.5s 2209 
236.7s 2210 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
237.1s 2211 [WARNING] Automatic CFL correction applied (count: 12100):
237.1s 2212 Calculated CFL: 0.800 > Limit: 0.500
237.1s 2213 Original dt: 4.114754e-01 s
237.1s 2214 Corrected dt: 2.571721e-01 s
237.1s 2215 Correction factor: 1.6x
237.1s 2216 Max wave speed detected: 19.44 m/s
237.2s 2217 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
237.6s 2218 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
238.0s 2219 [WARNING] Automatic CFL correction applied (count: 12200):
238.0s 2220 Calculated CFL: 0.800 > Limit: 0.500
238.0s 2221 Original dt: 4.114750e-01 s
238.0s 2222 Corrected dt: 2.571719e-01 s
238.0s 2223 Correction factor: 1.6x
238.0s 2224 Max wave speed detected: 19.44 m/s
238.1s 2225 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
238.5s 2226 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
238.6s 2227 Stored output at t = 120.0000 s (Step 454)
238.6s 2228 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
238.6s 2229 [A
238.6s 2230 
238.6s 2231 Simulation finished at t = 120.0000 s after 454 steps.
238.6s 2232 Total runtime: 2.10 seconds.
238.6s 2233 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.55s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.55s/s]
238.6s 2234 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
238.6s 2235 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
238.6s 2236 Using device: gpu
238.6s 2237 DEBUG PARAMS: Reading K_m_kmh = 10.0
238.6s 2238 DEBUG PARAMS: Reading K_c_kmh = 15.0
238.6s 2239 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
238.6s 2240 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
238.6s 2241 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
238.6s 2242 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
238.6s 2243 Loading road quality type: uniform
238.6s 2244 Uniform road quality value: 2
238.6s 2245 Road quality loaded.
238.6s 2246 Initial state created.
238.6s 2247 Transferring initial state and road quality to GPU...
238.6s 2248 GPU data transfer complete.
238.6s 2249 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
238.6s 2250 Initial boundary conditions applied.
238.6s 2251 [BC UPDATE] left → phase 0 RED (reduced inflow)
238.6s 2252 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
238.6s 2253 [BC UPDATE] left → phase 0 RED (reduced inflow)
238.6s 2254 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
238.6s 2255 Running simulation until t = 60.00 s, outputting every 60.00 s
238.6s 2256 
239.0s 2257 [WARNING] Automatic CFL correction applied (count: 12300):
239.0s 2258 Calculated CFL: 0.800 > Limit: 0.500
239.0s 2259 Original dt: 4.406346e-01 s
239.0s 2260 Corrected dt: 2.753966e-01 s
239.0s 2261 Correction factor: 1.6x
239.0s 2262 Max wave speed detected: 18.16 m/s
239.0s 2263 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
239.5s 2264 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
239.9s 2265 [WARNING] Automatic CFL correction applied (count: 12400):
239.9s 2266 Calculated CFL: 0.800 > Limit: 0.500
239.9s 2267 Original dt: 4.117797e-01 s
239.9s 2268 Corrected dt: 2.573623e-01 s
239.9s 2269 Correction factor: 1.6x
239.9s 2270 Max wave speed detected: 19.43 m/s
239.9s 2271 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
240.4s 2272 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
240.6s 2273 Stored output at t = 60.0000 s (Step 220)
240.6s 2274 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
240.6s 2275 [A
240.6s 2276 
240.6s 2277 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.56s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.55s/s]
240.6s 2278 Simulation finished at t = 60.0000 s after 220 steps.
240.6s 2279 Total runtime: 1.96 seconds.
240.6s 2280 [BC UPDATE] left → phase 0 RED (reduced inflow)
240.6s 2281 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
240.6s 2282 Running simulation until t = 120.00 s, outputting every 60.00 s
240.6s 2283 
240.8s 2284 [WARNING] Automatic CFL correction applied (count: 12500):
240.8s 2285 Calculated CFL: 0.800 > Limit: 0.500
240.8s 2286 Original dt: 4.114787e-01 s
240.8s 2287 Corrected dt: 2.571742e-01 s
240.8s 2288 Correction factor: 1.6x
240.8s 2289 Max wave speed detected: 19.44 m/s
240.9s 2290 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
241.3s 2291 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
241.7s 2292 [WARNING] Automatic CFL correction applied (count: 12600):
241.7s 2293 Calculated CFL: 0.800 > Limit: 0.500
241.7s 2294 Original dt: 4.114751e-01 s
241.7s 2295 Corrected dt: 2.571719e-01 s
241.7s 2296 Correction factor: 1.6x
241.7s 2297 Max wave speed detected: 19.44 m/s
241.8s 2298 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
242.2s 2299 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
242.6s 2300 [WARNING] Automatic CFL correction applied (count: 12700):
242.6s 2301 Calculated CFL: 0.800 > Limit: 0.500
242.6s 2302 Original dt: 4.114750e-01 s
242.6s 2303 Corrected dt: 2.571719e-01 s
242.6s 2304 Correction factor: 1.6x
242.6s 2305 Max wave speed detected: 19.44 m/s
242.6s 2306 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
242.7s 2307 Stored output at t = 120.0000 s (Step 454)
242.7s 2308 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
242.7s 2309 [A
242.7s 2310 
242.7s 2311 Simulation finished at t = 120.0000 s after 454 steps.
242.7s 2312 Total runtime: 2.12 seconds.
242.7s 2313 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.28s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.28s/s]
242.7s 2314 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
242.7s 2315 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
242.7s 2316 Using device: gpu
242.7s 2317 DEBUG PARAMS: Reading K_m_kmh = 10.0
242.7s 2318 DEBUG PARAMS: Reading K_c_kmh = 15.0
242.7s 2319 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
242.7s 2320 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
242.7s 2321 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
242.7s 2322 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
242.7s 2323 Loading road quality type: uniform
242.7s 2324 Uniform road quality value: 2
242.7s 2325 Road quality loaded.
242.7s 2326 Initial state created.
242.7s 2327 Transferring initial state and road quality to GPU...
242.7s 2328 GPU data transfer complete.
242.7s 2329 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
242.7s 2330 Initial boundary conditions applied.
242.7s 2331 [BC UPDATE] left → phase 0 RED (reduced inflow)
242.7s 2332 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
242.7s 2333 [BC UPDATE] left → phase 0 RED (reduced inflow)
242.7s 2334 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
242.7s 2335 Running simulation until t = 60.00 s, outputting every 60.00 s
242.7s 2336 
243.1s 2337 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
243.5s 2338 [WARNING] Automatic CFL correction applied (count: 12800):
243.5s 2339 Calculated CFL: 0.800 > Limit: 0.500
243.5s 2340 Original dt: 4.148881e-01 s
243.5s 2341 Corrected dt: 2.593051e-01 s
243.5s 2342 Correction factor: 1.6x
243.5s 2343 Max wave speed detected: 19.28 m/s
243.6s 2344 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
244.0s 2345 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
244.3s 2346 [WARNING] Automatic CFL correction applied (count: 12900):
244.3s 2347 Calculated CFL: 0.800 > Limit: 0.500
244.3s 2348 Original dt: 4.115146e-01 s
244.3s 2349 Corrected dt: 2.571966e-01 s
244.3s 2350 Correction factor: 1.6x
244.3s 2351 Max wave speed detected: 19.44 m/s
244.5s 2352 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
244.6s 2353 Stored output at t = 60.0000 s (Step 220)
244.6s 2354 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
244.6s 2355 [A
244.6s 2356 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.96s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.96s/s]
244.6s 2357 
244.6s 2358 Simulation finished at t = 60.0000 s after 220 steps.
244.6s 2359 Total runtime: 1.94 seconds.
244.6s 2360 [BC UPDATE] left → phase 1 GREEN (normal inflow)
244.6s 2361 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
244.6s 2362 Running simulation until t = 120.00 s, outputting every 60.00 s
244.6s 2363 
244.9s 2364 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
245.2s 2365 [WARNING] Automatic CFL correction applied (count: 13000):
245.2s 2366 Calculated CFL: 0.800 > Limit: 0.500
245.2s 2367 Original dt: 4.114755e-01 s
245.2s 2368 Corrected dt: 2.571722e-01 s
245.2s 2369 Correction factor: 1.6x
245.2s 2370 Max wave speed detected: 19.44 m/s
245.3s 2371 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
245.8s 2372 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
246.1s 2373 [WARNING] Automatic CFL correction applied (count: 13100):
246.1s 2374 Calculated CFL: 0.800 > Limit: 0.500
246.1s 2375 Original dt: 4.114750e-01 s
246.1s 2376 Corrected dt: 2.571719e-01 s
246.1s 2377 Correction factor: 1.6x
246.1s 2378 Max wave speed detected: 19.44 m/s
246.2s 2379 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
246.7s 2380 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
246.7s 2381 Stored output at t = 120.0000 s (Step 454)
246.7s 2382 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
246.7s 2383 [A
246.7s 2384 
246.7s 2385 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.64s/s]
246.7s 2386 Simulation finished at t = 120.0000 s after 454 steps.
246.7s 2387 Total runtime: 2.10 seconds.
246.7s 2388 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
246.7s 2389 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
246.7s 2390 Using device: gpu
246.7s 2391 DEBUG PARAMS: Reading K_m_kmh = 10.0
246.7s 2392 DEBUG PARAMS: Reading K_c_kmh = 15.0
246.7s 2393 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
246.7s 2394 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
246.7s 2395 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
246.7s 2396 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
246.7s 2397 Loading road quality type: uniform
246.7s 2398 Uniform road quality value: 2
246.7s 2399 Road quality loaded.
246.7s 2400 Initial state created.
246.7s 2401 Transferring initial state and road quality to GPU...
246.7s 2402 GPU data transfer complete.
246.7s 2403 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
246.7s 2404 Initial boundary conditions applied.
246.7s 2405 [BC UPDATE] left → phase 0 RED (reduced inflow)
246.7s 2406 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
246.7s 2407 [BC UPDATE] left → phase 0 RED (reduced inflow)
246.7s 2408 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
246.7s 2409 Running simulation until t = 60.00 s, outputting every 60.00 s
246.7s 2410 
247.0s 2411 [WARNING] Automatic CFL correction applied (count: 13200):
247.0s 2412 Calculated CFL: 0.800 > Limit: 0.500
247.0s 2413 Original dt: 4.541865e-01 s
247.0s 2414 Corrected dt: 2.838666e-01 s
247.0s 2415 Correction factor: 1.6x
247.0s 2416 Max wave speed detected: 17.61 m/s
247.2s 2417 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
247.6s 2418 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
247.9s 2419 [WARNING] Automatic CFL correction applied (count: 13300):
247.9s 2420 Calculated CFL: 0.800 > Limit: 0.500
247.9s 2421 Original dt: 4.119023e-01 s
247.9s 2422 Corrected dt: 2.574389e-01 s
247.9s 2423 Correction factor: 1.6x
247.9s 2424 Max wave speed detected: 19.42 m/s
248.1s 2425 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
248.5s 2426 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
248.7s 2427 Stored output at t = 60.0000 s (Step 220)
248.7s 2428 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
248.7s 2429 [A
248.7s 2430 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.76s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.76s/s]
248.7s 2431 
248.7s 2432 Simulation finished at t = 60.0000 s after 220 steps.
248.7s 2433 Total runtime: 1.95 seconds.
248.7s 2434 [BC UPDATE] left → phase 0 RED (reduced inflow)
248.7s 2435 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
248.7s 2436 Running simulation until t = 120.00 s, outputting every 60.00 s
248.7s 2437 
248.8s 2438 [WARNING] Automatic CFL correction applied (count: 13400):
248.8s 2439 Calculated CFL: 0.800 > Limit: 0.500
248.8s 2440 Original dt: 4.114802e-01 s
248.8s 2441 Corrected dt: 2.571751e-01 s
248.8s 2442 Correction factor: 1.6x
248.8s 2443 Max wave speed detected: 19.44 m/s
249.0s 2444 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
249.4s 2445 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
249.7s 2446 [WARNING] Automatic CFL correction applied (count: 13500):
249.7s 2447 Calculated CFL: 0.800 > Limit: 0.500
249.7s 2448 Original dt: 4.114751e-01 s
249.7s 2449 Corrected dt: 2.571719e-01 s
249.7s 2450 Correction factor: 1.6x
249.7s 2451 Max wave speed detected: 19.44 m/s
249.9s 2452 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
250.3s 2453 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
250.6s 2454 [WARNING] Automatic CFL correction applied (count: 13600):
250.6s 2455 Calculated CFL: 0.800 > Limit: 0.500
250.6s 2456 Original dt: 4.114750e-01 s
250.6s 2457 Corrected dt: 2.571719e-01 s
250.6s 2458 Correction factor: 1.6x
250.6s 2459 Max wave speed detected: 19.44 m/s
250.8s 2460 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
250.8s 2461 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
250.8s 2462 [A
250.8s 2463 Stored output at t = 120.0000 s (Step 454)
250.8s 2464 
250.8s 2465 Simulation finished at t = 120.0000 s after 454 steps.
250.8s 2466 Total runtime: 2.15 seconds.
250.8s 2467 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.94s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s]
250.8s 2468 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
250.8s 2469 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
250.8s 2470 Using device: gpu
250.9s 2471 DEBUG PARAMS: Reading K_m_kmh = 10.0
250.9s 2472 DEBUG PARAMS: Reading K_c_kmh = 15.0
250.9s 2473 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
250.9s 2474 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
250.9s 2475 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
250.9s 2476 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
250.9s 2477 Loading road quality type: uniform
250.9s 2478 Uniform road quality value: 2
250.9s 2479 Road quality loaded.
250.9s 2480 Initial state created.
250.9s 2481 Transferring initial state and road quality to GPU...
250.9s 2482 GPU data transfer complete.
250.9s 2483 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
250.9s 2484 Initial boundary conditions applied.
250.9s 2485 [BC UPDATE] left → phase 0 RED (reduced inflow)
250.9s 2486 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
250.9s 2487 [BC UPDATE] left → phase 1 GREEN (normal inflow)
250.9s 2488 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
250.9s 2489 Running simulation until t = 60.00 s, outputting every 60.00 s
250.9s 2490 
251.3s 2491 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
252.0s 2492 [WARNING] Automatic CFL correction applied (count: 13700):
252.0s 2493 Calculated CFL: 0.800 > Limit: 0.500
252.0s 2494 Original dt: 4.162480e-01 s
252.0s 2495 Corrected dt: 2.601550e-01 s
252.0s 2496 Correction factor: 1.6x
252.0s 2497 Max wave speed detected: 19.22 m/s
252.2s 2498 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
252.7s 2499 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
252.9s 2500 [WARNING] Automatic CFL correction applied (count: 13800):
252.9s 2501 Calculated CFL: 0.800 > Limit: 0.500
252.9s 2502 Original dt: 4.115291e-01 s
252.9s 2503 Corrected dt: 2.572057e-01 s
252.9s 2504 Correction factor: 1.6x
252.9s 2505 Max wave speed detected: 19.44 m/s
253.1s 2506 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
253.3s 2507 Stored output at t = 60.0000 s (Step 220)
253.3s 2508 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
253.3s 2509 [A
253.3s 2510 
253.3s 2511 Simulation finished at t = 60.0000 s after 220 steps.
253.3s 2512 Total runtime: 2.43 seconds.
253.3s 2513 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 24.74s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 24.74s/s]
253.3s 2514 
253.3s 2515 [BC UPDATE] left → phase 1 GREEN (normal inflow)
253.3s 2516 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
253.3s 2517 Running simulation until t = 120.00 s, outputting every 60.00 s
253.6s 2518 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
253.8s 2519 [WARNING] Automatic CFL correction applied (count: 13900):
253.8s 2520 Calculated CFL: 0.800 > Limit: 0.500
253.8s 2521 Original dt: 4.114757e-01 s
253.8s 2522 Corrected dt: 2.571723e-01 s
253.8s 2523 Correction factor: 1.6x
253.8s 2524 Max wave speed detected: 19.44 m/s
254.0s 2525 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
254.5s 2526 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
254.8s 2527 [WARNING] Automatic CFL correction applied (count: 14000):
254.8s 2528 Calculated CFL: 0.800 > Limit: 0.500
254.8s 2529 Original dt: 4.114750e-01 s
254.8s 2530 Corrected dt: 2.571719e-01 s
254.8s 2531 Correction factor: 1.6x
254.8s 2532 Max wave speed detected: 19.44 m/s
254.9s 2533 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
255.4s 2534 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
255.4s 2535 Stored output at t = 120.0000 s (Step 454)
255.4s 2536 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
255.4s 2537 [A
255.4s 2538 
255.4s 2539 Simulation finished at t = 120.0000 s after 454 steps.
255.4s 2540 Total runtime: 2.15 seconds.
255.4s 2541 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s]
255.4s 2542 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
255.4s 2543 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
255.4s 2544 Using device: gpu
255.4s 2545 DEBUG PARAMS: Reading K_m_kmh = 10.0
255.4s 2546 DEBUG PARAMS: Reading K_c_kmh = 15.0
255.4s 2547 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
255.4s 2548 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
255.4s 2549 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
255.4s 2550 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
255.4s 2551 Loading road quality type: uniform
255.4s 2552 Uniform road quality value: 2
255.4s 2553 Road quality loaded.
255.4s 2554 Initial state created.
255.4s 2555 Transferring initial state and road quality to GPU...
255.4s 2556 GPU data transfer complete.
255.4s 2557 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
255.4s 2558 Initial boundary conditions applied.
255.4s 2559 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.4s 2560 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
255.5s 2561 [BC UPDATE] left → phase 0 RED (reduced inflow)
255.5s 2562 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
255.5s 2563 Running simulation until t = 60.00 s, outputting every 60.00 s
255.5s 2564 
255.7s 2565 [WARNING] Automatic CFL correction applied (count: 14100):
255.7s 2566 Calculated CFL: 0.800 > Limit: 0.500
255.7s 2567 Original dt: 4.814374e-01 s
255.7s 2568 Corrected dt: 3.008984e-01 s
255.7s 2569 Correction factor: 1.6x
255.7s 2570 Max wave speed detected: 16.62 m/s
255.9s 2571 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
256.4s 2572 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
256.6s 2573 [WARNING] Automatic CFL correction applied (count: 14200):
256.6s 2574 Calculated CFL: 0.800 > Limit: 0.500
256.6s 2575 Original dt: 4.120787e-01 s
256.6s 2576 Corrected dt: 2.575492e-01 s
256.6s 2577 Correction factor: 1.6x
256.6s 2578 Max wave speed detected: 19.41 m/s
256.8s 2579 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
257.3s 2580 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
257.4s 2581 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
257.4s 2582 [A
257.4s 2583 Stored output at t = 60.0000 s (Step 220)
257.4s 2584 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.14s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.14s/s]
257.4s 2585 
257.4s 2586 Simulation finished at t = 60.0000 s after 220 steps.
257.4s 2587 Total runtime: 1.99 seconds.
257.4s 2588 [BC UPDATE] left → phase 1 GREEN (normal inflow)
257.4s 2589 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
257.4s 2590 Running simulation until t = 120.00 s, outputting every 60.00 s
257.4s 2591 
257.5s 2592 [WARNING] Automatic CFL correction applied (count: 14300):
257.5s 2593 Calculated CFL: 0.800 > Limit: 0.500
257.5s 2594 Original dt: 4.114823e-01 s
257.5s 2595 Corrected dt: 2.571764e-01 s
257.5s 2596 Correction factor: 1.6x
257.5s 2597 Max wave speed detected: 19.44 m/s
257.7s 2598 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
258.2s 2599 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
258.4s 2600 [WARNING] Automatic CFL correction applied (count: 14400):
258.4s 2601 Calculated CFL: 0.800 > Limit: 0.500
258.4s 2602 Original dt: 4.114751e-01 s
258.4s 2603 Corrected dt: 2.571719e-01 s
258.4s 2604 Correction factor: 1.6x
258.4s 2605 Max wave speed detected: 19.44 m/s
258.6s 2606 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
259.1s 2607 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
259.3s 2608 [WARNING] Automatic CFL correction applied (count: 14500):
259.3s 2609 Calculated CFL: 0.800 > Limit: 0.500
259.3s 2610 Original dt: 4.114750e-01 s
259.3s 2611 Corrected dt: 2.571719e-01 s
259.3s 2612 Correction factor: 1.6x
259.3s 2613 Max wave speed detected: 19.44 m/s
259.5s 2614 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
259.5s 2615 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
259.5s 2616 [A
259.5s 2617 Stored output at t = 120.0000 s (Step 454)
259.5s 2618 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.76s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.76s/s]
259.5s 2619 
259.5s 2620 Simulation finished at t = 120.0000 s after 454 steps.
259.5s 2621 Total runtime: 2.09 seconds.
259.5s 2622 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
259.5s 2623 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
259.5s 2624 Using device: gpu
259.5s 2625 DEBUG PARAMS: Reading K_m_kmh = 10.0
259.5s 2626 DEBUG PARAMS: Reading K_c_kmh = 15.0
259.5s 2627 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
259.5s 2628 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
259.5s 2629 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
259.5s 2630 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
259.5s 2631 Loading road quality type: uniform
259.5s 2632 Uniform road quality value: 2
259.5s 2633 Road quality loaded.
259.5s 2634 Initial state created.
259.5s 2635 Transferring initial state and road quality to GPU...
259.5s 2636 GPU data transfer complete.
259.5s 2637 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
259.5s 2638 Initial boundary conditions applied.
259.5s 2639 [BC UPDATE] left → phase 0 RED (reduced inflow)
259.5s 2640 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
259.5s 2641 [BC UPDATE] left → phase 0 RED (reduced inflow)
259.5s 2642 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
259.5s 2643 Running simulation until t = 60.00 s, outputting every 60.00 s
259.5s 2644 
260.0s 2645 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
260.2s 2646 [WARNING] Automatic CFL correction applied (count: 14600):
260.2s 2647 Calculated CFL: 0.800 > Limit: 0.500
260.2s 2648 Original dt: 4.185153e-01 s
260.2s 2649 Corrected dt: 2.615721e-01 s
260.2s 2650 Correction factor: 1.6x
260.2s 2651 Max wave speed detected: 19.12 m/s
260.4s 2652 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
260.9s 2653 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
261.1s 2654 [WARNING] Automatic CFL correction applied (count: 14700):
261.1s 2655 Calculated CFL: 0.800 > Limit: 0.500
261.1s 2656 Original dt: 4.115527e-01 s
261.1s 2657 Corrected dt: 2.572204e-01 s
261.1s 2658 Correction factor: 1.6x
261.1s 2659 Max wave speed detected: 19.44 m/s
261.4s 2660 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
261.6s 2661 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
261.6s 2662 [A
261.6s 2663 Stored output at t = 60.0000 s (Step 220)
261.6s 2664 
261.6s 2665 Simulation finished at t = 60.0000 s after 220 steps.
261.6s 2666 Total runtime: 2.01 seconds.
261.6s 2667 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.93s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.92s/s]
261.6s 2668 
261.6s 2669 [BC UPDATE] left → phase 1 GREEN (normal inflow)
261.6s 2670 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
261.6s 2671 Running simulation until t = 120.00 s, outputting every 60.00 s
261.8s 2672 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
262.0s 2673 [WARNING] Automatic CFL correction applied (count: 14800):
262.0s 2674 Calculated CFL: 0.800 > Limit: 0.500
262.0s 2675 Original dt: 4.114760e-01 s
262.0s 2676 Corrected dt: 2.571725e-01 s
262.0s 2677 Correction factor: 1.6x
262.0s 2678 Max wave speed detected: 19.44 m/s
262.3s 2679 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
262.7s 2680 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
262.9s 2681 [WARNING] Automatic CFL correction applied (count: 14900):
262.9s 2682 Calculated CFL: 0.800 > Limit: 0.500
262.9s 2683 Original dt: 4.114750e-01 s
262.9s 2684 Corrected dt: 2.571719e-01 s
262.9s 2685 Correction factor: 1.6x
262.9s 2686 Max wave speed detected: 19.44 m/s
263.2s 2687 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
263.6s 2688 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
263.7s 2689 Stored output at t = 120.0000 s (Step 454)
263.7s 2690 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
263.7s 2691 [A
263.7s 2692 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.52s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.52s/s]
263.7s 2693 
263.7s 2694 Simulation finished at t = 120.0000 s after 454 steps.
263.7s 2695 Total runtime: 2.10 seconds.
263.7s 2696 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
263.7s 2697 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
263.7s 2698 Using device: gpu
263.7s 2699 DEBUG PARAMS: Reading K_m_kmh = 10.0
263.7s 2700 DEBUG PARAMS: Reading K_c_kmh = 15.0
263.7s 2701 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
263.7s 2702 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
263.7s 2703 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
263.7s 2704 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
263.7s 2705 Loading road quality type: uniform
263.7s 2706 Uniform road quality value: 2
263.7s 2707 Road quality loaded.
263.7s 2708 Initial state created.
263.7s 2709 Transferring initial state and road quality to GPU...
263.7s 2710 GPU data transfer complete.
263.7s 2711 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
263.7s 2712 Initial boundary conditions applied.
263.7s 2713 [BC UPDATE] left → phase 0 RED (reduced inflow)
263.7s 2714 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
263.7s 2715 [BC UPDATE] left → phase 0 RED (reduced inflow)
263.7s 2716 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
263.7s 2717 Running simulation until t = 60.00 s, outputting every 60.00 s
263.7s 2718 
263.8s 2719 [WARNING] Automatic CFL correction applied (count: 15000):
263.8s 2720 Calculated CFL: 0.800 > Limit: 0.500
263.8s 2721 Original dt: 5.198704e-01 s
263.8s 2722 Corrected dt: 3.249190e-01 s
263.8s 2723 Correction factor: 1.6x
263.8s 2724 Max wave speed detected: 15.39 m/s
264.1s 2725 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
264.6s 2726 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
264.7s 2727 [WARNING] Automatic CFL correction applied (count: 15100):
264.7s 2728 Calculated CFL: 0.800 > Limit: 0.500
264.7s 2729 Original dt: 4.123660e-01 s
264.7s 2730 Corrected dt: 2.577287e-01 s
264.7s 2731 Correction factor: 1.6x
264.7s 2732 Max wave speed detected: 19.40 m/s
265.0s 2733 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
265.5s 2734 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
265.6s 2735 [WARNING] Automatic CFL correction applied (count: 15200):
265.6s 2736 Calculated CFL: 0.800 > Limit: 0.500
265.6s 2737 Original dt: 4.114852e-01 s
265.6s 2738 Corrected dt: 2.571782e-01 s
265.6s 2739 Correction factor: 1.6x
265.6s 2740 Max wave speed detected: 19.44 m/s
265.7s 2741 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
265.7s 2742 [A
265.7s 2743 Stored output at t = 60.0000 s (Step 220)
265.7s 2744 
265.7s 2745 Simulation finished at t = 60.0000 s after 220 steps.
265.7s 2746 Total runtime: 2.00 seconds.
265.7s 2747 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.02s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.02s/s]
265.7s 2748 [BC UPDATE] left → phase 0 RED (reduced inflow)
265.7s 2749 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
265.7s 2750 
265.7s 2751 Running simulation until t = 120.00 s, outputting every 60.00 s
265.9s 2752 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
266.4s 2753 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
266.5s 2754 [WARNING] Automatic CFL correction applied (count: 15300):
266.5s 2755 Calculated CFL: 0.800 > Limit: 0.500
266.5s 2756 Original dt: 4.114752e-01 s
266.5s 2757 Corrected dt: 2.571720e-01 s
266.5s 2758 Correction factor: 1.6x
266.5s 2759 Max wave speed detected: 19.44 m/s
266.8s 2760 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
267.3s 2761 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
267.5s 2762 [WARNING] Automatic CFL correction applied (count: 15400):
267.5s 2763 Calculated CFL: 0.800 > Limit: 0.500
267.5s 2764 Original dt: 4.114750e-01 s
267.5s 2765 Corrected dt: 2.571719e-01 s
267.5s 2766 Correction factor: 1.6x
267.5s 2767 Max wave speed detected: 19.44 m/s
267.7s 2768 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
267.8s 2769 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
267.8s 2770 [A
267.8s 2771 Stored output at t = 120.0000 s (Step 454)
267.8s 2772 
267.8s 2773 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.48s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.48s/s]
267.8s 2774 Simulation finished at t = 120.0000 s after 454 steps.
267.8s 2775 Total runtime: 2.11 seconds.
267.8s 2776 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
267.8s 2777 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
267.8s 2778 Using device: gpu
267.8s 2779 DEBUG PARAMS: Reading K_m_kmh = 10.0
267.8s 2780 DEBUG PARAMS: Reading K_c_kmh = 15.0
267.8s 2781 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
267.8s 2782 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
267.8s 2783 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
267.8s 2784 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
267.8s 2785 Loading road quality type: uniform
267.8s 2786 Uniform road quality value: 2
267.8s 2787 Road quality loaded.
267.8s 2788 Initial state created.
267.8s 2789 Transferring initial state and road quality to GPU...
267.8s 2790 GPU data transfer complete.
267.8s 2791 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
267.8s 2792 Initial boundary conditions applied.
267.8s 2793 [BC UPDATE] left → phase 0 RED (reduced inflow)
267.8s 2794 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
267.8s 2795 [BC UPDATE] left → phase 0 RED (reduced inflow)
267.8s 2796 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
267.8s 2797 Running simulation until t = 60.00 s, outputting every 60.00 s
267.8s 2798 
268.3s 2799 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
268.4s 2800 [WARNING] Automatic CFL correction applied (count: 15500):
268.4s 2801 Calculated CFL: 0.800 > Limit: 0.500
268.4s 2802 Original dt: 4.216408e-01 s
268.4s 2803 Corrected dt: 2.635255e-01 s
268.4s 2804 Correction factor: 1.6x
268.4s 2805 Max wave speed detected: 18.97 m/s
268.7s 2806 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
269.2s 2807 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
269.3s 2808 [WARNING] Automatic CFL correction applied (count: 15600):
269.3s 2809 Calculated CFL: 0.800 > Limit: 0.500
269.3s 2810 Original dt: 4.115909e-01 s
269.3s 2811 Corrected dt: 2.572443e-01 s
269.3s 2812 Correction factor: 1.6x
269.3s 2813 Max wave speed detected: 19.44 m/s
269.6s 2814 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
269.8s 2815 Stored output at t = 60.0000 s (Step 220)
269.8s 2816 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
269.8s 2817 [A
269.8s 2818 
269.8s 2819 Simulation finished at t = 60.0000 s after 220 steps.
269.8s 2820 Total runtime: 2.02 seconds.
269.8s 2821 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.77s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.77s/s]
269.8s 2822 
269.8s 2823 [BC UPDATE] left → phase 1 GREEN (normal inflow)
269.8s 2824 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
269.8s 2825 Running simulation until t = 120.00 s, outputting every 60.00 s
270.1s 2826 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
270.2s 2827 [WARNING] Automatic CFL correction applied (count: 15700):
270.2s 2828 Calculated CFL: 0.800 > Limit: 0.500
270.2s 2829 Original dt: 4.114765e-01 s
270.2s 2830 Corrected dt: 2.571728e-01 s
270.2s 2831 Correction factor: 1.6x
270.2s 2832 Max wave speed detected: 19.44 m/s
270.6s 2833 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
271.0s 2834 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
271.2s 2835 [WARNING] Automatic CFL correction applied (count: 15800):
271.2s 2836 Calculated CFL: 0.800 > Limit: 0.500
271.2s 2837 Original dt: 4.114750e-01 s
271.2s 2838 Corrected dt: 2.571719e-01 s
271.2s 2839 Correction factor: 1.6x
271.2s 2840 Max wave speed detected: 19.44 m/s
271.5s 2841 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
272.0s 2842 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
272.0s 2843 Stored output at t = 120.0000 s (Step 454)
272.0s 2844 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
272.0s 2845 [A
272.0s 2846 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.66s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.66s/s]
272.0s 2847 
272.0s 2848 Simulation finished at t = 120.0000 s after 454 steps.
272.0s 2849 Total runtime: 2.17 seconds.
272.0s 2850 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
272.0s 2851 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
272.0s 2852 Using device: gpu
272.0s 2853 DEBUG PARAMS: Reading K_m_kmh = 10.0
272.0s 2854 DEBUG PARAMS: Reading K_c_kmh = 15.0
272.0s 2855 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
272.0s 2856 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
272.0s 2857 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
272.0s 2858 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
272.0s 2859 Loading road quality type: uniform
272.0s 2860 Uniform road quality value: 2
272.0s 2861 Road quality loaded.
272.0s 2862 Initial state created.
272.0s 2863 Transferring initial state and road quality to GPU...
272.0s 2864 GPU data transfer complete.
272.0s 2865 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
272.0s 2866 Initial boundary conditions applied.
272.0s 2867 [BC UPDATE] left → phase 0 RED (reduced inflow)
272.0s 2868 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
272.0s 2869 [BC UPDATE] left → phase 0 RED (reduced inflow)
272.0s 2870 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
272.0s 2871 Running simulation until t = 60.00 s, outputting every 60.00 s
272.0s 2872 
272.1s 2873 [WARNING] Automatic CFL correction applied (count: 15900):
272.1s 2874 Calculated CFL: 0.800 > Limit: 0.500
272.1s 2875 Original dt: 6.119199e-01 s
272.1s 2876 Corrected dt: 3.824499e-01 s
272.1s 2877 Correction factor: 1.6x
272.1s 2878 Max wave speed detected: 13.07 m/s
272.5s 2879 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
272.9s 2880 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
273.0s 2881 [WARNING] Automatic CFL correction applied (count: 16000):
273.0s 2882 Calculated CFL: 0.800 > Limit: 0.500
273.0s 2883 Original dt: 4.127288e-01 s
273.0s 2884 Corrected dt: 2.579555e-01 s
273.0s 2885 Correction factor: 1.6x
273.0s 2886 Max wave speed detected: 19.38 m/s
273.4s 2887 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
273.8s 2888 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
273.9s 2889 [WARNING] Automatic CFL correction applied (count: 16100):
273.9s 2890 Calculated CFL: 0.800 > Limit: 0.500
273.9s 2891 Original dt: 4.114896e-01 s
273.9s 2892 Corrected dt: 2.571810e-01 s
273.9s 2893 Correction factor: 1.6x
273.9s 2894 Max wave speed detected: 19.44 m/s
274.0s 2895 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
274.0s 2896 [A
274.0s 2897 Stored output at t = 60.0000 s (Step 220)
274.0s 2898 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.26s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.25s/s]
274.0s 2899 
274.0s 2900 Simulation finished at t = 60.0000 s after 220 steps.
274.0s 2901 Total runtime: 1.98 seconds.
274.0s 2902 [BC UPDATE] left → phase 0 RED (reduced inflow)
274.0s 2903 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
274.0s 2904 Running simulation until t = 120.00 s, outputting every 60.00 s
274.0s 2905 
274.3s 2906 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
274.7s 2907 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
274.8s 2908 [WARNING] Automatic CFL correction applied (count: 16200):
274.8s 2909 Calculated CFL: 0.800 > Limit: 0.500
274.8s 2910 Original dt: 4.114752e-01 s
274.8s 2911 Corrected dt: 2.571720e-01 s
274.8s 2912 Correction factor: 1.6x
274.8s 2913 Max wave speed detected: 19.44 m/s
275.2s 2914 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
275.6s 2915 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
275.7s 2916 [WARNING] Automatic CFL correction applied (count: 16300):
275.7s 2917 Calculated CFL: 0.800 > Limit: 0.500
275.7s 2918 Original dt: 4.114750e-01 s
275.7s 2919 Corrected dt: 2.571719e-01 s
275.7s 2920 Correction factor: 1.6x
275.7s 2921 Max wave speed detected: 19.44 m/s
276.1s 2922 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
276.1s 2923 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
276.1s 2924 [A
276.1s 2925 Stored output at t = 120.0000 s (Step 454)
276.1s 2926 
276.1s 2927 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.93s/s]
276.1s 2928 Simulation finished at t = 120.0000 s after 454 steps.
276.1s 2929 Total runtime: 2.15 seconds.
276.1s 2930 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
276.1s 2931 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
276.1s 2932 Using device: gpu
276.1s 2933 DEBUG PARAMS: Reading K_m_kmh = 10.0
276.1s 2934 DEBUG PARAMS: Reading K_c_kmh = 15.0
276.1s 2935 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
276.1s 2936 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
276.1s 2937 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
276.1s 2938 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
276.1s 2939 Loading road quality type: uniform
276.1s 2940 Uniform road quality value: 2
276.1s 2941 Road quality loaded.
276.1s 2942 Initial state created.
276.1s 2943 Transferring initial state and road quality to GPU...
276.1s 2944 GPU data transfer complete.
276.1s 2945 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
276.1s 2946 Initial boundary conditions applied.
276.1s 2947 [BC UPDATE] left → phase 0 RED (reduced inflow)
276.1s 2948 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
276.2s 2949 [BC UPDATE] left → phase 1 GREEN (normal inflow)
276.2s 2950 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
276.2s 2951 Running simulation until t = 60.00 s, outputting every 60.00 s
276.2s 2952 
276.6s 2953 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
276.7s 2954 [WARNING] Automatic CFL correction applied (count: 16400):
276.7s 2955 Calculated CFL: 0.800 > Limit: 0.500
276.7s 2956 Original dt: 4.259025e-01 s
276.7s 2957 Corrected dt: 2.661890e-01 s
276.7s 2958 Correction factor: 1.6x
276.7s 2959 Max wave speed detected: 18.78 m/s
277.1s 2960 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
277.6s 2961 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
277.6s 2962 [WARNING] Automatic CFL correction applied (count: 16500):
277.6s 2963 Calculated CFL: 0.800 > Limit: 0.500
277.6s 2964 Original dt: 4.116333e-01 s
277.6s 2965 Corrected dt: 2.572708e-01 s
277.6s 2966 Correction factor: 1.6x
277.6s 2967 Max wave speed detected: 19.43 m/s
278.0s 2968 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
278.2s 2969 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
278.2s 2970 [A
278.2s 2971 Stored output at t = 60.0000 s (Step 220)
278.2s 2972 
278.2s 2973 Simulation finished at t = 60.0000 s after 220 steps.
278.2s 2974 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.08s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.08s/s]
278.2s 2975 Total runtime: 2.06 seconds.
278.2s 2976 [BC UPDATE] left → phase 1 GREEN (normal inflow)
278.2s 2977 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
278.2s 2978 Running simulation until t = 120.00 s, outputting every 60.00 s
278.2s 2979 
278.5s 2980 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
278.5s 2981 [WARNING] Automatic CFL correction applied (count: 16600):
278.5s 2982 Calculated CFL: 0.800 > Limit: 0.500
278.5s 2983 Original dt: 4.114770e-01 s
278.5s 2984 Corrected dt: 2.571731e-01 s
278.5s 2985 Correction factor: 1.6x
278.5s 2986 Max wave speed detected: 19.44 m/s
278.9s 2987 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
279.4s 2988 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
279.4s 2989 [WARNING] Automatic CFL correction applied (count: 16700):
279.4s 2990 Calculated CFL: 0.800 > Limit: 0.500
279.4s 2991 Original dt: 4.114750e-01 s
279.4s 2992 Corrected dt: 2.571719e-01 s
279.4s 2993 Correction factor: 1.6x
279.4s 2994 Max wave speed detected: 19.44 m/s
279.9s 2995 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
280.3s 2996 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
280.3s 2997 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
280.3s 2998 Stored output at t = 120.0000 s (Step 454)
280.3s 2999 [A
280.3s 3000 
280.3s 3001 Simulation finished at t = 120.0000 s after 454 steps.
280.3s 3002 Total runtime: 2.13 seconds.
280.3s 3003 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.22s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.22s/s]
280.3s 3004 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
280.3s 3005 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
280.3s 3006 Using device: gpu
280.4s 3007 DEBUG PARAMS: Reading K_m_kmh = 10.0
280.4s 3008 DEBUG PARAMS: Reading K_c_kmh = 15.0
280.4s 3009 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
280.4s 3010 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
280.4s 3011 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
280.4s 3012 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
280.4s 3013 Loading road quality type: uniform
280.4s 3014 Uniform road quality value: 2
280.4s 3015 Road quality loaded.
280.4s 3016 Initial state created.
280.4s 3017 Transferring initial state and road quality to GPU...
280.4s 3018 GPU data transfer complete.
280.4s 3019 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
280.4s 3020 Initial boundary conditions applied.
280.4s 3021 [BC UPDATE] left → phase 0 RED (reduced inflow)
280.4s 3022 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
280.4s 3023 [BC UPDATE] left → phase 1 GREEN (normal inflow)
280.4s 3024 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
280.4s 3025 Running simulation until t = 60.00 s, outputting every 60.00 s
280.4s 3026 
280.4s 3027 [WARNING] Automatic CFL correction applied (count: 16800):
280.4s 3028 Calculated CFL: 0.800 > Limit: 0.500
280.4s 3029 Original dt: 7.305445e-01 s
280.4s 3030 Corrected dt: 4.565903e-01 s
280.4s 3031 Correction factor: 1.6x
280.4s 3032 Max wave speed detected: 10.95 m/s
280.8s 3033 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
281.3s 3034 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
281.3s 3035 [WARNING] Automatic CFL correction applied (count: 16900):
281.3s 3036 Calculated CFL: 0.800 > Limit: 0.500
281.3s 3037 Original dt: 4.132460e-01 s
281.3s 3038 Corrected dt: 2.582788e-01 s
281.3s 3039 Correction factor: 1.6x
281.3s 3040 Max wave speed detected: 19.36 m/s
281.7s 3041 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
282.2s 3042 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
282.2s 3043 [WARNING] Automatic CFL correction applied (count: 17000):
282.2s 3044 Calculated CFL: 0.800 > Limit: 0.500
282.2s 3045 Original dt: 4.114953e-01 s
282.2s 3046 Corrected dt: 2.571845e-01 s
282.2s 3047 Correction factor: 1.6x
282.2s 3048 Max wave speed detected: 19.44 m/s
282.4s 3049 Stored output at t = 60.0000 s (Step 220)
282.4s 3050 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
282.4s 3051 [A
282.4s 3052 
282.4s 3053 Simulation finished at t = 60.0000 s after 220 steps.
282.4s 3054 Total runtime: 1.99 seconds.
282.4s 3055 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.14s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.14s/s]
282.4s 3056 [BC UPDATE] left → phase 0 RED (reduced inflow)
282.4s 3057 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
282.4s 3058 Running simulation until t = 120.00 s, outputting every 60.00 s
282.4s 3059 
282.6s 3060 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
283.1s 3061 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
283.1s 3062 [WARNING] Automatic CFL correction applied (count: 17100):
283.1s 3063 Calculated CFL: 0.800 > Limit: 0.500
283.1s 3064 Original dt: 4.114753e-01 s
283.1s 3065 Corrected dt: 2.571720e-01 s
283.1s 3066 Correction factor: 1.6x
283.1s 3067 Max wave speed detected: 19.44 m/s
283.5s 3068 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
284.0s 3069 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
284.0s 3070 [WARNING] Automatic CFL correction applied (count: 17200):
284.0s 3071 Calculated CFL: 0.800 > Limit: 0.500
284.0s 3072 Original dt: 4.114750e-01 s
284.0s 3073 Corrected dt: 2.571719e-01 s
284.0s 3074 Correction factor: 1.6x
284.0s 3075 Max wave speed detected: 19.44 m/s
284.4s 3076 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
284.5s 3077 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
284.5s 3078 [A
284.5s 3079 Stored output at t = 120.0000 s (Step 454)
284.5s 3080 
284.5s 3081 Simulation finished at t = 120.0000 s after 454 steps.
284.5s 3082 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.36s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.36s/s]
284.5s 3083 Total runtime: 2.12 seconds.
284.5s 3084 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
284.5s 3085 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
284.5s 3086 Using device: gpu
284.5s 3087 DEBUG PARAMS: Reading K_m_kmh = 10.0
284.5s 3088 DEBUG PARAMS: Reading K_c_kmh = 15.0
284.5s 3089 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
284.5s 3090 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
284.5s 3091 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
284.5s 3092 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
284.5s 3093 Loading road quality type: uniform
284.5s 3094 Uniform road quality value: 2
284.5s 3095 Road quality loaded.
284.5s 3096 Initial state created.
284.5s 3097 Transferring initial state and road quality to GPU...
284.5s 3098 GPU data transfer complete.
284.5s 3099 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
284.5s 3100 Initial boundary conditions applied.
284.5s 3101 [BC UPDATE] left → phase 0 RED (reduced inflow)
284.5s 3102 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
284.5s 3103 [BC UPDATE] left → phase 0 RED (reduced inflow)
284.5s 3104 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
284.5s 3105 Running simulation until t = 60.00 s, outputting every 60.00 s
284.5s 3106 
284.9s 3107 [WARNING] Automatic CFL correction applied (count: 17300):
284.9s 3108 Calculated CFL: 0.800 > Limit: 0.500
284.9s 3109 Original dt: 4.333565e-01 s
284.9s 3110 Corrected dt: 2.708478e-01 s
284.9s 3111 Correction factor: 1.6x
284.9s 3112 Max wave speed detected: 18.46 m/s
284.9s 3113 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
285.4s 3114 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
285.8s 3115 [WARNING] Automatic CFL correction applied (count: 17400):
285.8s 3116 Calculated CFL: 0.800 > Limit: 0.500
285.8s 3117 Original dt: 4.117017e-01 s
285.8s 3118 Corrected dt: 2.573136e-01 s
285.8s 3119 Correction factor: 1.6x
285.8s 3120 Max wave speed detected: 19.43 m/s
285.9s 3121 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
286.3s 3122 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
286.5s 3123 Stored output at t = 60.0000 s (Step 220)
286.5s 3124 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
286.5s 3125 [A
286.5s 3126 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.94s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.93s/s]
286.5s 3127 
286.5s 3128 Simulation finished at t = 60.0000 s after 220 steps.
286.5s 3129 Total runtime: 2.00 seconds.
286.5s 3130 [BC UPDATE] left → phase 0 RED (reduced inflow)
286.5s 3131 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
286.5s 3132 Running simulation until t = 120.00 s, outputting every 60.00 s
286.5s 3133 
286.7s 3134 [WARNING] Automatic CFL correction applied (count: 17500):
286.7s 3135 Calculated CFL: 0.800 > Limit: 0.500
286.7s 3136 Original dt: 4.114778e-01 s
286.7s 3137 Corrected dt: 2.571736e-01 s
286.7s 3138 Correction factor: 1.6x
286.7s 3139 Max wave speed detected: 19.44 m/s
286.8s 3140 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
287.2s 3141 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
287.7s 3142 [WARNING] Automatic CFL correction applied (count: 17600):
287.7s 3143 Calculated CFL: 0.800 > Limit: 0.500
287.7s 3144 Original dt: 4.114751e-01 s
287.7s 3145 Corrected dt: 2.571719e-01 s
287.7s 3146 Correction factor: 1.6x
287.7s 3147 Max wave speed detected: 19.44 m/s
287.7s 3148 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
288.1s 3149 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
288.6s 3150 [WARNING] Automatic CFL correction applied (count: 17700):
288.6s 3151 Calculated CFL: 0.800 > Limit: 0.500
288.6s 3152 Original dt: 4.114750e-01 s
288.6s 3153 Corrected dt: 2.571719e-01 s
288.6s 3154 Correction factor: 1.6x
288.6s 3155 Max wave speed detected: 19.44 m/s
288.6s 3156 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
288.6s 3157 Stored output at t = 120.0000 s (Step 454)
288.6s 3158 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
288.6s 3159 [A
288.6s 3160 
288.6s 3161 Simulation finished at t = 120.0000 s after 454 steps.
288.6s 3162 Total runtime: 2.14 seconds.
288.6s 3163 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.08s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.08s/s]
288.6s 3164 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
288.6s 3165 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
288.6s 3166 Using device: gpu
288.6s 3167 DEBUG PARAMS: Reading K_m_kmh = 10.0
288.6s 3168 DEBUG PARAMS: Reading K_c_kmh = 15.0
288.6s 3169 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
288.6s 3170 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
288.6s 3171 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
288.6s 3172 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
288.6s 3173 Loading road quality type: uniform
288.6s 3174 Uniform road quality value: 2
288.6s 3175 Road quality loaded.
288.6s 3176 Initial state created.
288.6s 3177 Transferring initial state and road quality to GPU...
288.6s 3178 GPU data transfer complete.
288.6s 3179 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
288.6s 3180 Initial boundary conditions applied.
288.6s 3181 [BC UPDATE] left → phase 0 RED (reduced inflow)
288.6s 3182 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
288.6s 3183 [BC UPDATE] left → phase 0 RED (reduced inflow)
288.6s 3184 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
288.6s 3185 Running simulation until t = 60.00 s, outputting every 60.00 s
288.6s 3186 
289.1s 3187 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
289.5s 3188 [WARNING] Automatic CFL correction applied (count: 17800):
289.5s 3189 Calculated CFL: 0.800 > Limit: 0.500
289.5s 3190 Original dt: 4.140941e-01 s
289.5s 3191 Corrected dt: 2.588088e-01 s
289.5s 3192 Correction factor: 1.6x
289.5s 3193 Max wave speed detected: 19.32 m/s
289.5s 3194 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
290.0s 3195 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
290.4s 3196 [WARNING] Automatic CFL correction applied (count: 17900):
290.4s 3197 Calculated CFL: 0.800 > Limit: 0.500
290.4s 3198 Original dt: 4.115044e-01 s
290.4s 3199 Corrected dt: 2.571903e-01 s
290.4s 3200 Correction factor: 1.6x
290.4s 3201 Max wave speed detected: 19.44 m/s
290.5s 3202 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
290.7s 3203 Stored output at t = 60.0000 s (Step 220)
290.7s 3204 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
290.7s 3205 [A
290.7s 3206 
290.7s 3207 Simulation finished at t = 60.0000 s after 220 steps.
290.7s 3208 Total runtime: 2.01 seconds.
290.7s 3209 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.84s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.84s/s]
290.7s 3210 [BC UPDATE] left → phase 0 RED (reduced inflow)
290.7s 3211 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
290.7s 3212 Running simulation until t = 120.00 s, outputting every 60.00 s
290.7s 3213 
291.0s 3214 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
291.3s 3215 [WARNING] Automatic CFL correction applied (count: 18000):
291.3s 3216 Calculated CFL: 0.800 > Limit: 0.500
291.3s 3217 Original dt: 4.114754e-01 s
291.3s 3218 Corrected dt: 2.571721e-01 s
291.3s 3219 Correction factor: 1.6x
291.3s 3220 Max wave speed detected: 19.44 m/s
291.4s 3221 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
291.9s 3222 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
292.3s 3223 [WARNING] Automatic CFL correction applied (count: 18100):
292.3s 3224 Calculated CFL: 0.800 > Limit: 0.500
292.3s 3225 Original dt: 4.114750e-01 s
292.3s 3226 Corrected dt: 2.571719e-01 s
292.3s 3227 Correction factor: 1.6x
292.3s 3228 Max wave speed detected: 19.44 m/s
292.3s 3229 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
292.8s 3230 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
292.8s 3231 Stored output at t = 120.0000 s (Step 454)
292.8s 3232 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
292.8s 3233 [A
292.8s 3234 
292.8s 3235 Simulation finished at t = 120.0000 s after 454 steps.
292.8s 3236 Total runtime: 2.15 seconds.
292.8s 3237 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.91s/s]
292.8s 3238 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
292.8s 3239 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
292.8s 3240 Using device: gpu
292.8s 3241 DEBUG PARAMS: Reading K_m_kmh = 10.0
292.8s 3242 DEBUG PARAMS: Reading K_c_kmh = 15.0
292.8s 3243 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
292.8s 3244 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
292.8s 3245 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
292.8s 3246 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
292.8s 3247 Loading road quality type: uniform
292.8s 3248 Uniform road quality value: 2
292.8s 3249 Road quality loaded.
292.8s 3250 Initial state created.
292.8s 3251 Transferring initial state and road quality to GPU...
292.8s 3252 GPU data transfer complete.
292.8s 3253 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
292.8s 3254 Initial boundary conditions applied.
292.8s 3255 [BC UPDATE] left → phase 0 RED (reduced inflow)
292.8s 3256 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
292.8s 3257 [BC UPDATE] left → phase 0 RED (reduced inflow)
292.8s 3258 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
292.8s 3259 Running simulation until t = 60.00 s, outputting every 60.00 s
292.8s 3260 
293.2s 3261 [WARNING] Automatic CFL correction applied (count: 18200):
293.2s 3262 Calculated CFL: 0.800 > Limit: 0.500
293.2s 3263 Original dt: 4.432506e-01 s
293.2s 3264 Corrected dt: 2.770316e-01 s
293.2s 3265 Correction factor: 1.6x
293.2s 3266 Max wave speed detected: 18.05 m/s
293.3s 3267 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
293.7s 3268 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
294.1s 3269 [WARNING] Automatic CFL correction applied (count: 18300):
294.1s 3270 Calculated CFL: 0.800 > Limit: 0.500
294.1s 3271 Original dt: 4.118127e-01 s
294.1s 3272 Corrected dt: 2.573829e-01 s
294.1s 3273 Correction factor: 1.6x
294.1s 3274 Max wave speed detected: 19.43 m/s
294.2s 3275 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
294.6s 3276 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
294.8s 3277 Stored output at t = 60.0000 s (Step 220)
294.8s 3278 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
294.8s 3279 [A
294.8s 3280 
294.8s 3281 Simulation finished at t = 60.0000 s after 220 steps.
294.8s 3282 Total runtime: 2.00 seconds.
294.8s 3283 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.02s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.01s/s]
294.8s 3284 [BC UPDATE] left → phase 1 GREEN (normal inflow)
294.8s 3285 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
294.8s 3286 Running simulation until t = 120.00 s, outputting every 60.00 s
294.8s 3287 
295.0s 3288 [WARNING] Automatic CFL correction applied (count: 18400):
295.0s 3289 Calculated CFL: 0.800 > Limit: 0.500
295.0s 3290 Original dt: 4.114791e-01 s
295.0s 3291 Corrected dt: 2.571745e-01 s
295.0s 3292 Correction factor: 1.6x
295.0s 3293 Max wave speed detected: 19.44 m/s
295.1s 3294 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
295.6s 3295 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
295.9s 3296 [WARNING] Automatic CFL correction applied (count: 18500):
295.9s 3297 Calculated CFL: 0.800 > Limit: 0.500
295.9s 3298 Original dt: 4.114751e-01 s
295.9s 3299 Corrected dt: 2.571719e-01 s
295.9s 3300 Correction factor: 1.6x
295.9s 3301 Max wave speed detected: 19.44 m/s
296.0s 3302 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
296.5s 3303 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
296.8s 3304 [WARNING] Automatic CFL correction applied (count: 18600):
296.8s 3305 Calculated CFL: 0.800 > Limit: 0.500
296.8s 3306 Original dt: 4.114750e-01 s
296.8s 3307 Corrected dt: 2.571719e-01 s
296.8s 3308 Correction factor: 1.6x
296.8s 3309 Max wave speed detected: 19.44 m/s
296.9s 3310 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
297.0s 3311 Stored output at t = 120.0000 s (Step 454)
297.0s 3312 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
297.0s 3313 [A
297.0s 3314 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.14s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.13s/s]
297.0s 3315 
297.0s 3316 Simulation finished at t = 120.0000 s after 454 steps.
297.0s 3317 Total runtime: 2.13 seconds.
297.0s 3318 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
297.0s 3319 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
297.0s 3320 Using device: gpu
297.0s 3321 DEBUG PARAMS: Reading K_m_kmh = 10.0
297.0s 3322 DEBUG PARAMS: Reading K_c_kmh = 15.0
297.0s 3323 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
297.0s 3324 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
297.0s 3325 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
297.0s 3326 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
297.0s 3327 Loading road quality type: uniform
297.0s 3328 Uniform road quality value: 2
297.0s 3329 Road quality loaded.
297.0s 3330 Initial state created.
297.0s 3331 Transferring initial state and road quality to GPU...
297.0s 3332 GPU data transfer complete.
297.0s 3333 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
297.0s 3334 Initial boundary conditions applied.
297.0s 3335 [BC UPDATE] left → phase 0 RED (reduced inflow)
297.0s 3336 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
297.0s 3337 [BC UPDATE] left → phase 1 GREEN (normal inflow)
297.0s 3338 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
297.0s 3339 Running simulation until t = 60.00 s, outputting every 60.00 s
297.0s 3340 
297.5s 3341 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
297.8s 3342 [WARNING] Automatic CFL correction applied (count: 18700):
297.8s 3343 Calculated CFL: 0.800 > Limit: 0.500
297.8s 3344 Original dt: 4.151664e-01 s
297.8s 3345 Corrected dt: 2.594790e-01 s
297.8s 3346 Correction factor: 1.6x
297.8s 3347 Max wave speed detected: 19.27 m/s
297.9s 3348 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
298.4s 3349 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
298.7s 3350 [WARNING] Automatic CFL correction applied (count: 18800):
298.7s 3351 Calculated CFL: 0.800 > Limit: 0.500
298.7s 3352 Original dt: 4.115176e-01 s
298.7s 3353 Corrected dt: 2.571985e-01 s
298.7s 3354 Correction factor: 1.6x
298.7s 3355 Max wave speed detected: 19.44 m/s
298.8s 3356 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
299.0s 3357 Stored output at t = 60.0000 s (Step 220)
299.0s 3358 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
299.0s 3359 [A
299.0s 3360 
299.0s 3361 Simulation finished at t = 60.0000 s after 220 steps.
299.0s 3362 Total runtime: 2.03 seconds.
299.0s 3363 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.53s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.53s/s]
299.0s 3364 [BC UPDATE] left → phase 0 RED (reduced inflow)
299.0s 3365 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
299.0s 3366 Running simulation until t = 120.00 s, outputting every 60.00 s
299.0s 3367 
299.3s 3368 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
299.6s 3369 [WARNING] Automatic CFL correction applied (count: 18900):
299.6s 3370 Calculated CFL: 0.800 > Limit: 0.500
299.6s 3371 Original dt: 4.114756e-01 s
299.6s 3372 Corrected dt: 2.571722e-01 s
299.6s 3373 Correction factor: 1.6x
299.6s 3374 Max wave speed detected: 19.44 m/s
299.7s 3375 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
300.2s 3376 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
300.5s 3377 [WARNING] Automatic CFL correction applied (count: 19000):
300.5s 3378 Calculated CFL: 0.800 > Limit: 0.500
300.5s 3379 Original dt: 4.114750e-01 s
300.5s 3380 Corrected dt: 2.571719e-01 s
300.5s 3381 Correction factor: 1.6x
300.5s 3382 Max wave speed detected: 19.44 m/s
300.6s 3383 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
301.1s 3384 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
301.1s 3385 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
301.1s 3386 [A
301.1s 3387 Stored output at t = 120.0000 s (Step 454)
301.1s 3388 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.06s/s]
301.1s 3389 
301.1s 3390 Simulation finished at t = 120.0000 s after 454 steps.
301.1s 3391 Total runtime: 2.14 seconds.
301.1s 3392 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
301.1s 3393 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
301.1s 3394 Using device: gpu
301.2s 3395 DEBUG PARAMS: Reading K_m_kmh = 10.0
301.2s 3396 DEBUG PARAMS: Reading K_c_kmh = 15.0
301.2s 3397 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
301.2s 3398 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
301.2s 3399 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
301.2s 3400 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
301.2s 3401 Loading road quality type: uniform
301.2s 3402 Uniform road quality value: 2
301.2s 3403 Road quality loaded.
301.2s 3404 Initial state created.
301.2s 3405 Transferring initial state and road quality to GPU...
301.2s 3406 GPU data transfer complete.
301.2s 3407 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
301.2s 3408 Initial boundary conditions applied.
301.2s 3409 [BC UPDATE] left → phase 0 RED (reduced inflow)
301.2s 3410 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
301.2s 3411 [BC UPDATE] left → phase 0 RED (reduced inflow)
301.2s 3412 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
301.2s 3413 Running simulation until t = 60.00 s, outputting every 60.00 s
301.2s 3414 
301.4s 3415 [WARNING] Automatic CFL correction applied (count: 19100):
301.4s 3416 Calculated CFL: 0.800 > Limit: 0.500
301.4s 3417 Original dt: 4.592499e-01 s
301.4s 3418 Corrected dt: 2.870312e-01 s
301.4s 3419 Correction factor: 1.6x
301.4s 3420 Max wave speed detected: 17.42 m/s
301.6s 3421 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
302.1s 3422 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
302.4s 3423 [WARNING] Automatic CFL correction applied (count: 19200):
302.4s 3424 Calculated CFL: 0.800 > Limit: 0.500
302.4s 3425 Original dt: 4.119387e-01 s
302.4s 3426 Corrected dt: 2.574617e-01 s
302.4s 3427 Correction factor: 1.6x
302.4s 3428 Max wave speed detected: 19.42 m/s
302.5s 3429 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
303.0s 3430 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
303.1s 3431 Stored output at t = 60.0000 s (Step 220)
303.1s 3432 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
303.1s 3433 [A
303.1s 3434 
303.1s 3435 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.20s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.20s/s]
303.1s 3436 Simulation finished at t = 60.0000 s after 220 steps.
303.1s 3437 Total runtime: 1.99 seconds.
303.2s 3438 [BC UPDATE] left → phase 1 GREEN (normal inflow)
303.2s 3439 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
303.2s 3440 Running simulation until t = 120.00 s, outputting every 60.00 s
303.2s 3441 
303.3s 3442 [WARNING] Automatic CFL correction applied (count: 19300):
303.3s 3443 Calculated CFL: 0.800 > Limit: 0.500
303.3s 3444 Original dt: 4.114806e-01 s
303.3s 3445 Corrected dt: 2.571754e-01 s
303.3s 3446 Correction factor: 1.6x
303.3s 3447 Max wave speed detected: 19.44 m/s
303.4s 3448 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
303.9s 3449 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
304.1s 3450 [WARNING] Automatic CFL correction applied (count: 19400):
304.1s 3451 Calculated CFL: 0.800 > Limit: 0.500
304.1s 3452 Original dt: 4.114751e-01 s
304.1s 3453 Corrected dt: 2.571719e-01 s
304.1s 3454 Correction factor: 1.6x
304.1s 3455 Max wave speed detected: 19.44 m/s
304.3s 3456 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
304.8s 3457 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
305.0s 3458 [WARNING] Automatic CFL correction applied (count: 19500):
305.0s 3459 Calculated CFL: 0.800 > Limit: 0.500
305.0s 3460 Original dt: 4.114750e-01 s
305.0s 3461 Corrected dt: 2.571719e-01 s
305.0s 3462 Correction factor: 1.6x
305.0s 3463 Max wave speed detected: 19.44 m/s
305.2s 3464 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
305.2s 3465 Stored output at t = 120.0000 s (Step 454)
305.2s 3466 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
305.2s 3467 [A
305.2s 3468 
305.2s 3469 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.71s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.70s/s]
305.2s 3470 Simulation finished at t = 120.0000 s after 454 steps.
305.2s 3471 Total runtime: 2.09 seconds.
305.2s 3472 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
305.2s 3473 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
305.2s 3474 Using device: gpu
305.3s 3475 DEBUG PARAMS: Reading K_m_kmh = 10.0
305.3s 3476 DEBUG PARAMS: Reading K_c_kmh = 15.0
305.3s 3477 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
305.3s 3478 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
305.3s 3479 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
305.3s 3480 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
305.3s 3481 Loading road quality type: uniform
305.3s 3482 Uniform road quality value: 2
305.3s 3483 Road quality loaded.
305.3s 3484 Initial state created.
305.3s 3485 Transferring initial state and road quality to GPU...
305.3s 3486 GPU data transfer complete.
305.3s 3487 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
305.3s 3488 Initial boundary conditions applied.
305.3s 3489 [BC UPDATE] left → phase 0 RED (reduced inflow)
305.3s 3490 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
305.3s 3491 
305.3s 3492 [BC UPDATE] left → phase 0 RED (reduced inflow)
305.3s 3493 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
305.3s 3494 Running simulation until t = 60.00 s, outputting every 60.00 s
305.7s 3495 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
306.0s 3496 [WARNING] Automatic CFL correction applied (count: 19600):
306.0s 3497 Calculated CFL: 0.800 > Limit: 0.500
306.0s 3498 Original dt: 4.167107e-01 s
306.0s 3499 Corrected dt: 2.604442e-01 s
306.0s 3500 Correction factor: 1.6x
306.0s 3501 Max wave speed detected: 19.20 m/s
306.2s 3502 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
306.6s 3503 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
306.9s 3504 [WARNING] Automatic CFL correction applied (count: 19700):
306.9s 3505 Calculated CFL: 0.800 > Limit: 0.500
306.9s 3506 Original dt: 4.115340e-01 s
306.9s 3507 Corrected dt: 2.572087e-01 s
306.9s 3508 Correction factor: 1.6x
306.9s 3509 Max wave speed detected: 19.44 m/s
307.1s 3510 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
307.3s 3511 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
307.3s 3512 [A
307.3s 3513 Stored output at t = 60.0000 s (Step 220)
307.3s 3514 
307.3s 3515 Simulation finished at t = 60.0000 s after 220 steps.
307.3s 3516 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.31s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.31s/s]
307.3s 3517 Total runtime: 2.05 seconds.
307.3s 3518 [BC UPDATE] left → phase 1 GREEN (normal inflow)
307.3s 3519 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
307.3s 3520 Running simulation until t = 120.00 s, outputting every 60.00 s
307.3s 3521 
307.6s 3522 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
307.8s 3523 [WARNING] Automatic CFL correction applied (count: 19800):
307.8s 3524 Calculated CFL: 0.800 > Limit: 0.500
307.8s 3525 Original dt: 4.114758e-01 s
307.8s 3526 Corrected dt: 2.571723e-01 s
307.8s 3527 Correction factor: 1.6x
307.8s 3528 Max wave speed detected: 19.44 m/s
308.0s 3529 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
308.5s 3530 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
308.7s 3531 [WARNING] Automatic CFL correction applied (count: 19900):
308.7s 3532 Calculated CFL: 0.800 > Limit: 0.500
308.7s 3533 Original dt: 4.114750e-01 s
308.7s 3534 Corrected dt: 2.571719e-01 s
308.7s 3535 Correction factor: 1.6x
308.7s 3536 Max wave speed detected: 19.44 m/s
308.9s 3537 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
309.4s 3538 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
309.4s 3539 Stored output at t = 120.0000 s (Step 454)
309.4s 3540 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
309.4s 3541 [A
309.4s 3542 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.56s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.55s/s]
309.4s 3543 
309.4s 3544 Simulation finished at t = 120.0000 s after 454 steps.
309.4s 3545 Total runtime: 2.10 seconds.
309.4s 3546 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
309.4s 3547 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
309.4s 3548 Using device: gpu
309.4s 3549 DEBUG PARAMS: Reading K_m_kmh = 10.0
309.4s 3550 DEBUG PARAMS: Reading K_c_kmh = 15.0
309.4s 3551 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
309.4s 3552 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
309.4s 3553 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
309.4s 3554 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
309.4s 3555 Loading road quality type: uniform
309.4s 3556 Uniform road quality value: 2
309.4s 3557 Road quality loaded.
309.4s 3558 Initial state created.
309.4s 3559 Transferring initial state and road quality to GPU...
309.4s 3560 GPU data transfer complete.
309.4s 3561 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
309.4s 3562 Initial boundary conditions applied.
309.4s 3563 [BC UPDATE] left → phase 0 RED (reduced inflow)
309.4s 3564 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
309.4s 3565 
309.4s 3566 [BC UPDATE] left → phase 0 RED (reduced inflow)
309.4s 3567 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
309.4s 3568 Running simulation until t = 60.00 s, outputting every 60.00 s
309.6s 3569 [WARNING] Automatic CFL correction applied (count: 20000):
309.6s 3570 Calculated CFL: 0.800 > Limit: 0.500
309.6s 3571 Original dt: 4.906572e-01 s
309.6s 3572 Corrected dt: 3.066607e-01 s
309.6s 3573 Correction factor: 1.6x
309.6s 3574 Max wave speed detected: 16.30 m/s
309.9s 3575 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
310.3s 3576 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
310.5s 3577 [WARNING] Automatic CFL correction applied (count: 20100):
310.5s 3578 Calculated CFL: 0.800 > Limit: 0.500
310.5s 3579 Original dt: 4.121380e-01 s
310.5s 3580 Corrected dt: 2.575863e-01 s
310.5s 3581 Correction factor: 1.6x
310.5s 3582 Max wave speed detected: 19.41 m/s
310.8s 3583 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
311.3s 3584 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
311.5s 3585 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
311.5s 3586 [A
311.5s 3587 Stored output at t = 60.0000 s (Step 220)
311.5s 3588 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.55s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.55s/s]
311.5s 3589 
311.5s 3590 Simulation finished at t = 60.0000 s after 220 steps.
311.5s 3591 Total runtime: 2.03 seconds.
311.5s 3592 [BC UPDATE] left → phase 0 RED (reduced inflow)
311.5s 3593 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
311.5s 3594 Running simulation until t = 120.00 s, outputting every 60.00 s
311.5s 3595 
311.5s 3596 [WARNING] Automatic CFL correction applied (count: 20200):
311.5s 3597 Calculated CFL: 0.800 > Limit: 0.500
311.5s 3598 Original dt: 4.114830e-01 s
311.5s 3599 Corrected dt: 2.571769e-01 s
311.5s 3600 Correction factor: 1.6x
311.5s 3601 Max wave speed detected: 19.44 m/s
311.7s 3602 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
312.2s 3603 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
312.4s 3604 [WARNING] Automatic CFL correction applied (count: 20300):
312.4s 3605 Calculated CFL: 0.800 > Limit: 0.500
312.4s 3606 Original dt: 4.114751e-01 s
312.4s 3607 Corrected dt: 2.571719e-01 s
312.4s 3608 Correction factor: 1.6x
312.4s 3609 Max wave speed detected: 19.44 m/s
312.7s 3610 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
313.1s 3611 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
313.3s 3612 [WARNING] Automatic CFL correction applied (count: 20400):
313.3s 3613 Calculated CFL: 0.800 > Limit: 0.500
313.3s 3614 Original dt: 4.114750e-01 s
313.3s 3615 Corrected dt: 2.571719e-01 s
313.3s 3616 Correction factor: 1.6x
313.3s 3617 Max wave speed detected: 19.44 m/s
313.6s 3618 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
313.6s 3619 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
313.6s 3620 [A
313.6s 3621 Stored output at t = 120.0000 s (Step 454)
313.6s 3622 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.16s/s]
313.6s 3623 
313.6s 3624 Simulation finished at t = 120.0000 s after 454 steps.
313.6s 3625 Total runtime: 2.13 seconds.
313.6s 3626 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
313.6s 3627 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
313.6s 3628 Using device: gpu
313.6s 3629 DEBUG PARAMS: Reading K_m_kmh = 10.0
313.6s 3630 DEBUG PARAMS: Reading K_c_kmh = 15.0
313.6s 3631 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
313.6s 3632 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
313.6s 3633 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
313.6s 3634 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
313.6s 3635 Loading road quality type: uniform
313.6s 3636 Uniform road quality value: 2
313.6s 3637 Road quality loaded.
313.6s 3638 Initial state created.
313.6s 3639 Transferring initial state and road quality to GPU...
313.6s 3640 GPU data transfer complete.
313.6s 3641 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
313.6s 3642 Initial boundary conditions applied.
313.6s 3643 [BC UPDATE] left → phase 0 RED (reduced inflow)
313.6s 3644 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
313.6s 3645 [BC UPDATE] left → phase 1 GREEN (normal inflow)
313.6s 3646 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
313.6s 3647 Running simulation until t = 60.00 s, outputting every 60.00 s
313.6s 3648 
314.1s 3649 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
314.2s 3650 [WARNING] Automatic CFL correction applied (count: 20500):
314.2s 3651 Calculated CFL: 0.800 > Limit: 0.500
314.2s 3652 Original dt: 4.192902e-01 s
314.2s 3653 Corrected dt: 2.620564e-01 s
314.2s 3654 Correction factor: 1.6x
314.2s 3655 Max wave speed detected: 19.08 m/s
314.5s 3656 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
315.0s 3657 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
315.1s 3658 [WARNING] Automatic CFL correction applied (count: 20600):
315.1s 3659 Calculated CFL: 0.800 > Limit: 0.500
315.1s 3660 Original dt: 4.115606e-01 s
315.1s 3661 Corrected dt: 2.572254e-01 s
315.1s 3662 Correction factor: 1.6x
315.1s 3663 Max wave speed detected: 19.44 m/s
315.4s 3664 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
315.6s 3665 Stored output at t = 60.0000 s (Step 220)
315.6s 3666 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
315.6s 3667 [A
315.6s 3668 
315.6s 3669 Simulation finished at t = 60.0000 s after 220 steps.
315.6s 3670 Total runtime: 1.98 seconds.
315.6s 3671 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.32s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.32s/s]
315.6s 3672 [BC UPDATE] left → phase 1 GREEN (normal inflow)
315.6s 3673 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
315.6s 3674 Running simulation until t = 120.00 s, outputting every 60.00 s
315.6s 3675 
315.9s 3676 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
316.0s 3677 [WARNING] Automatic CFL correction applied (count: 20700):
316.0s 3678 Calculated CFL: 0.800 > Limit: 0.500
316.0s 3679 Original dt: 4.114761e-01 s
316.0s 3680 Corrected dt: 2.571726e-01 s
316.0s 3681 Correction factor: 1.6x
316.0s 3682 Max wave speed detected: 19.44 m/s
316.3s 3683 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
316.8s 3684 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
316.9s 3685 [WARNING] Automatic CFL correction applied (count: 20800):
316.9s 3686 Calculated CFL: 0.800 > Limit: 0.500
316.9s 3687 Original dt: 4.114750e-01 s
316.9s 3688 Corrected dt: 2.571719e-01 s
316.9s 3689 Correction factor: 1.6x
316.9s 3690 Max wave speed detected: 19.44 m/s
317.2s 3691 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
317.7s 3692 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
317.7s 3693 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
317.7s 3694 [A
317.7s 3695 Stored output at t = 120.0000 s (Step 454)
317.7s 3696 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.98s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.98s/s]
317.7s 3697 
317.7s 3698 Simulation finished at t = 120.0000 s after 454 steps.
317.7s 3699 Total runtime: 2.14 seconds.
317.7s 3700 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
317.7s 3701 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
317.7s 3702 Using device: gpu
317.7s 3703 DEBUG PARAMS: Reading K_m_kmh = 10.0
317.7s 3704 DEBUG PARAMS: Reading K_c_kmh = 15.0
317.7s 3705 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
317.7s 3706 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
317.7s 3707 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
317.7s 3708 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
317.7s 3709 Loading road quality type: uniform
317.7s 3710 Uniform road quality value: 2
317.7s 3711 Road quality loaded.
317.7s 3712 Initial state created.
317.7s 3713 Transferring initial state and road quality to GPU...
317.7s 3714 GPU data transfer complete.
317.7s 3715 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
317.7s 3716 Initial boundary conditions applied.
317.7s 3717 [BC UPDATE] left → phase 0 RED (reduced inflow)
317.7s 3718 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
317.7s 3719 [BC UPDATE] left → phase 0 RED (reduced inflow)
317.7s 3720 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
317.7s 3721 Running simulation until t = 60.00 s, outputting every 60.00 s
317.7s 3722 
317.9s 3723 [WARNING] Automatic CFL correction applied (count: 20900):
317.9s 3724 Calculated CFL: 0.800 > Limit: 0.500
317.9s 3725 Original dt: 5.350067e-01 s
317.9s 3726 Corrected dt: 3.343792e-01 s
317.9s 3727 Correction factor: 1.6x
317.9s 3728 Max wave speed detected: 14.95 m/s
318.2s 3729 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
318.6s 3730 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
318.8s 3731 [WARNING] Automatic CFL correction applied (count: 21000):
318.8s 3732 Calculated CFL: 0.800 > Limit: 0.500
318.8s 3733 Original dt: 4.124625e-01 s
318.8s 3734 Corrected dt: 2.577891e-01 s
318.8s 3735 Correction factor: 1.6x
318.8s 3736 Max wave speed detected: 19.40 m/s
319.1s 3737 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
319.5s 3738 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
319.7s 3739 [WARNING] Automatic CFL correction applied (count: 21100):
319.7s 3740 Calculated CFL: 0.800 > Limit: 0.500
319.7s 3741 Original dt: 4.114863e-01 s
319.7s 3742 Corrected dt: 2.571789e-01 s
319.7s 3743 Correction factor: 1.6x
319.7s 3744 Max wave speed detected: 19.44 m/s
319.7s 3745 Stored output at t = 60.0000 s (Step 220)
319.7s 3746 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
319.7s 3747 [A
319.7s 3748 
319.7s 3749 Simulation finished at t = 60.0000 s after 220 steps.
319.7s 3750 Total runtime: 1.98 seconds.
319.7s 3751 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.35s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.35s/s]
319.7s 3752 [BC UPDATE] left → phase 0 RED (reduced inflow)
319.7s 3753 
319.7s 3754 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
319.7s 3755 Running simulation until t = 120.00 s, outputting every 60.00 s
320.0s 3756 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
320.5s 3757 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
320.6s 3758 [WARNING] Automatic CFL correction applied (count: 21200):
320.6s 3759 Calculated CFL: 0.800 > Limit: 0.500
320.6s 3760 Original dt: 4.114752e-01 s
320.6s 3761 Corrected dt: 2.571720e-01 s
320.6s 3762 Correction factor: 1.6x
320.6s 3763 Max wave speed detected: 19.44 m/s
320.9s 3764 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
321.4s 3765 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
321.5s 3766 [WARNING] Automatic CFL correction applied (count: 21300):
321.5s 3767 Calculated CFL: 0.800 > Limit: 0.500
321.5s 3768 Original dt: 4.114750e-01 s
321.5s 3769 Corrected dt: 2.571719e-01 s
321.5s 3770 Correction factor: 1.6x
321.5s 3771 Max wave speed detected: 19.44 m/s
321.8s 3772 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
321.9s 3773 Stored output at t = 120.0000 s (Step 454)
321.9s 3774 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
321.9s 3775 [A
321.9s 3776 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 27.90s/s]
321.9s 3777 
321.9s 3778 Simulation finished at t = 120.0000 s after 454 steps.
321.9s 3779 Total runtime: 2.15 seconds.
321.9s 3780 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
321.9s 3781 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
321.9s 3782 Using device: gpu
321.9s 3783 DEBUG PARAMS: Reading K_m_kmh = 10.0
321.9s 3784 DEBUG PARAMS: Reading K_c_kmh = 15.0
321.9s 3785 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
321.9s 3786 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
321.9s 3787 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
321.9s 3788 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
321.9s 3789 Loading road quality type: uniform
321.9s 3790 Uniform road quality value: 2
321.9s 3791 Road quality loaded.
321.9s 3792 Initial state created.
321.9s 3793 Transferring initial state and road quality to GPU...
321.9s 3794 GPU data transfer complete.
321.9s 3795 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
321.9s 3796 Initial boundary conditions applied.
321.9s 3797 [BC UPDATE] left → phase 0 RED (reduced inflow)
321.9s 3798 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
321.9s 3799 [BC UPDATE] left → phase 1 GREEN (normal inflow)
321.9s 3800 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
321.9s 3801 
321.9s 3802 Running simulation until t = 60.00 s, outputting every 60.00 s
322.3s 3803 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
322.4s 3804 [WARNING] Automatic CFL correction applied (count: 21400):
322.4s 3805 Calculated CFL: 0.800 > Limit: 0.500
322.4s 3806 Original dt: 4.224993e-01 s
322.4s 3807 Corrected dt: 2.640621e-01 s
322.4s 3808 Correction factor: 1.6x
322.4s 3809 Max wave speed detected: 18.93 m/s
322.8s 3810 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
323.3s 3811 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
323.4s 3812 [WARNING] Automatic CFL correction applied (count: 21500):
323.4s 3813 Calculated CFL: 0.800 > Limit: 0.500
323.4s 3814 Original dt: 4.115998e-01 s
323.4s 3815 Corrected dt: 2.572499e-01 s
323.4s 3816 Correction factor: 1.6x
323.4s 3817 Max wave speed detected: 19.44 m/s
323.7s 3818 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
323.9s 3819 Stored output at t = 60.0000 s (Step 220)
323.9s 3820 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
323.9s 3821 [A
323.9s 3822 Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.86s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 29.85s/s]
323.9s 3823 
323.9s 3824 Simulation finished at t = 60.0000 s after 220 steps.
323.9s 3825 Total runtime: 2.01 seconds.
323.9s 3826 [BC UPDATE] left → phase 1 GREEN (normal inflow)
323.9s 3827 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
323.9s 3828 Running simulation until t = 120.00 s, outputting every 60.00 s
323.9s 3829 
324.2s 3830 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
324.3s 3831 [WARNING] Automatic CFL correction applied (count: 21600):
324.3s 3832 Calculated CFL: 0.800 > Limit: 0.500
324.3s 3833 Original dt: 4.114766e-01 s
324.3s 3834 Corrected dt: 2.571728e-01 s
324.3s 3835 Correction factor: 1.6x
324.3s 3836 Max wave speed detected: 19.44 m/s
324.6s 3837 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
325.1s 3838 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
325.2s 3839 [WARNING] Automatic CFL correction applied (count: 21700):
325.2s 3840 Calculated CFL: 0.800 > Limit: 0.500
325.2s 3841 Original dt: 4.114750e-01 s
325.2s 3842 Corrected dt: 2.571719e-01 s
325.2s 3843 Correction factor: 1.6x
325.2s 3844 Max wave speed detected: 19.44 m/s
325.5s 3845 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
326.0s 3846 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
326.0s 3847 Stored output at t = 120.0000 s (Step 454)
326.0s 3848 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
326.0s 3849 [A
326.0s 3850 
326.0s 3851 Simulation finished at t = 120.0000 s after 454 steps.
326.0s 3852 Total runtime: 2.11 seconds.
326.0s 3853 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.42s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.41s/s]
326.0s 3854 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
326.0s 3855 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
326.0s 3856 Using device: gpu
326.0s 3857 DEBUG PARAMS: Reading K_m_kmh = 10.0
326.0s 3858 DEBUG PARAMS: Reading K_c_kmh = 15.0
326.0s 3859 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
326.0s 3860 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
326.0s 3861 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
326.0s 3862 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
326.0s 3863 Loading road quality type: uniform
326.0s 3864 Uniform road quality value: 2
326.0s 3865 Road quality loaded.
326.0s 3866 Initial state created.
326.0s 3867 Transferring initial state and road quality to GPU...
326.0s 3868 GPU data transfer complete.
326.0s 3869 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
326.0s 3870 Initial boundary conditions applied.
326.0s 3871 [BC UPDATE] left → phase 0 RED (reduced inflow)
326.0s 3872 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
326.0s 3873 [BC UPDATE] left → phase 0 RED (reduced inflow)
326.0s 3874 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
326.0s 3875 Running simulation until t = 60.00 s, outputting every 60.00 s
326.0s 3876 
326.1s 3877 [WARNING] Automatic CFL correction applied (count: 21800):
326.1s 3878 Calculated CFL: 0.800 > Limit: 0.500
326.1s 3879 Original dt: 6.529080e-01 s
326.1s 3880 Corrected dt: 4.080675e-01 s
326.1s 3881 Correction factor: 1.6x
326.1s 3882 Max wave speed detected: 12.25 m/s
326.5s 3883 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
326.9s 3884 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
327.0s 3885 [WARNING] Automatic CFL correction applied (count: 21900):
327.0s 3886 Calculated CFL: 0.800 > Limit: 0.500
327.0s 3887 Original dt: 4.128352e-01 s
327.0s 3888 Corrected dt: 2.580220e-01 s
327.0s 3889 Correction factor: 1.6x
327.0s 3890 Max wave speed detected: 19.38 m/s
327.4s 3891 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
327.8s 3892 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
327.9s 3893 [WARNING] Automatic CFL correction applied (count: 22000):
327.9s 3894 Calculated CFL: 0.800 > Limit: 0.500
327.9s 3895 Original dt: 4.114907e-01 s
327.9s 3896 Corrected dt: 2.571817e-01 s
327.9s 3897 Correction factor: 1.6x
327.9s 3898 Max wave speed detected: 19.44 m/s
328.0s 3899 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
328.0s 3900 [A
328.0s 3901 Stored output at t = 60.0000 s (Step 220)
328.0s 3902 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.28s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.28s/s]
328.0s 3903 
328.0s 3904 Simulation finished at t = 60.0000 s after 220 steps.
328.0s 3905 Total runtime: 1.98 seconds.
328.0s 3906 [BC UPDATE] left → phase 0 RED (reduced inflow)
328.0s 3907 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
328.0s 3908 Running simulation until t = 120.00 s, outputting every 60.00 s
328.0s 3909 
328.3s 3910 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
328.7s 3911 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
328.8s 3912 [WARNING] Automatic CFL correction applied (count: 22100):
328.8s 3913 Calculated CFL: 0.800 > Limit: 0.500
328.8s 3914 Original dt: 4.114752e-01 s
328.8s 3915 Corrected dt: 2.571720e-01 s
328.8s 3916 Correction factor: 1.6x
328.8s 3917 Max wave speed detected: 19.44 m/s
329.2s 3918 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
329.6s 3919 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
329.7s 3920 [WARNING] Automatic CFL correction applied (count: 22200):
329.7s 3921 Calculated CFL: 0.800 > Limit: 0.500
329.7s 3922 Original dt: 4.114750e-01 s
329.7s 3923 Corrected dt: 2.571719e-01 s
329.7s 3924 Correction factor: 1.6x
329.7s 3925 Max wave speed detected: 19.44 m/s
330.1s 3926 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
330.1s 3927 Stored output at t = 120.0000 s (Step 454)
330.1s 3928 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
330.1s 3929 [A
330.1s 3930 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.27s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.27s/s]
330.1s 3931 
330.1s 3932 Simulation finished at t = 120.0000 s after 454 steps.
330.1s 3933 Total runtime: 2.12 seconds.
330.1s 3934 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
330.1s 3935 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
330.1s 3936 Using device: gpu
330.1s 3937 DEBUG PARAMS: Reading K_m_kmh = 10.0
330.1s 3938 DEBUG PARAMS: Reading K_c_kmh = 15.0
330.1s 3939 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
330.1s 3940 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
330.1s 3941 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
330.1s 3942 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
330.1s 3943 Loading road quality type: uniform
330.1s 3944 Uniform road quality value: 2
330.1s 3945 Road quality loaded.
330.1s 3946 Initial state created.
330.1s 3947 Transferring initial state and road quality to GPU...
330.1s 3948 GPU data transfer complete.
330.1s 3949 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
330.1s 3950 Initial boundary conditions applied.
330.1s 3951 [BC UPDATE] left → phase 0 RED (reduced inflow)
330.1s 3952 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
330.1s 3953 [BC UPDATE] left → phase 1 GREEN (normal inflow)
330.1s 3954 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
330.1s 3955 Running simulation until t = 60.00 s, outputting every 60.00 s
330.1s 3956 
330.6s 3957 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
330.6s 3958 [WARNING] Automatic CFL correction applied (count: 22300):
330.6s 3959 Calculated CFL: 0.800 > Limit: 0.500
330.6s 3960 Original dt: 4.273889e-01 s
330.6s 3961 Corrected dt: 2.671180e-01 s
330.6s 3962 Correction factor: 1.6x
330.6s 3963 Max wave speed detected: 18.72 m/s
331.1s 3964 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
331.5s 3965 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
331.5s 3966 [WARNING] Automatic CFL correction applied (count: 22400):
331.5s 3967 Calculated CFL: 0.800 > Limit: 0.500
331.5s 3968 Original dt: 4.116474e-01 s
331.5s 3969 Corrected dt: 2.572796e-01 s
331.5s 3970 Correction factor: 1.6x
331.5s 3971 Max wave speed detected: 19.43 m/s
332.0s 3972 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
332.1s 3973 Stored output at t = 60.0000 s (Step 220)
332.1s 3974 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
332.1s 3975 [A
332.1s 3976 Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.01s/s][ARunning Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.01s/s]
332.1s 3977 
332.1s 3978 Simulation finished at t = 60.0000 s after 220 steps.
332.1s 3979 Total runtime: 2.00 seconds.
332.2s 3980 [BC UPDATE] left → phase 0 RED (reduced inflow)
332.2s 3981 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
332.2s 3982 Running simulation until t = 120.00 s, outputting every 60.00 s
332.2s 3983 
332.4s 3984 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
332.5s 3985 [WARNING] Automatic CFL correction applied (count: 22500):
332.5s 3986 Calculated CFL: 0.800 > Limit: 0.500
332.5s 3987 Original dt: 4.114771e-01 s
332.5s 3988 Corrected dt: 2.571732e-01 s
332.5s 3989 Correction factor: 1.6x
332.5s 3990 Max wave speed detected: 19.44 m/s
332.9s 3991 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
333.3s 3992 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
333.4s 3993 [WARNING] Automatic CFL correction applied (count: 22600):
333.4s 3994 Calculated CFL: 0.800 > Limit: 0.500
333.4s 3995 Original dt: 4.114750e-01 s
333.4s 3996 Corrected dt: 2.571719e-01 s
333.4s 3997 Correction factor: 1.6x
333.4s 3998 Max wave speed detected: 19.44 m/s
333.8s 3999 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
334.2s 4000 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
334.2s 4001 [WARNING] Automatic CFL correction applied (count: 22700):
334.2s 4002 Calculated CFL: 0.800 > Limit: 0.500
334.2s 4003 Original dt: 4.114750e-01 s
334.2s 4004 Corrected dt: 2.571719e-01 s
334.2s 4005 Correction factor: 1.6x
334.2s 4006 Max wave speed detected: 19.44 m/s
334.3s 4007 Stored output at t = 120.0000 s (Step 454)
334.3s 4008 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s][A
334.3s 4009 [A
334.3s 4010 
334.3s 4011 Simulation finished at t = 120.0000 s after 454 steps.
334.3s 4012 Total runtime: 2.10 seconds.
334.3s 4013 Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.60s/s][ARunning Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.59s/s]
334.3s 4014 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
334.3s 4015 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.3s 4016 Using device: gpu
334.3s 4017 DEBUG PARAMS: Reading K_m_kmh = 10.0
334.3s 4018 DEBUG PARAMS: Reading K_c_kmh = 15.0
334.3s 4019 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
334.3s 4020 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
334.3s 4021 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
334.3s 4022 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
334.3s 4023 Loading road quality type: uniform
334.3s 4024 Uniform road quality value: 2
334.3s 4025 Road quality loaded.
334.3s 4026 Initial state created.
334.3s 4027 Transferring initial state and road quality to GPU...
334.3s 4028 GPU data transfer complete.
334.3s 4029 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
334.3s 4030 Initial boundary conditions applied.
334.3s 4031 [BC UPDATE] left → phase 0 RED (reduced inflow)
334.3s 4032 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
334.3s 4033 📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.5 steps/s
334.3s 4034 ---------------------------------
334.3s 4035 | rollout/           |          |
334.3s 4036 |    ep_len_mean     | 2        |
334.3s 4037 |    ep_rew_mean     | -0.0595  |
334.3s 4038 | time/              |          |
334.3s 4039 |    fps             | 0        |
334.3s 4040 |    iterations      | 1        |
334.3s 4041 |    time_elapsed    | 210      |
334.3s 4042 |    total_timesteps | 100      |
334.3s 4043 ---------------------------------
334.8s 4044 
334.8s 4045 ✅ Training completed in 3.5 minutes (210.7s)
334.8s 4046 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:03:30 < 0:00:00 , 0 it/s ]
334.8s 4047 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
334.8s 4048 
334.8s 4049 [PHASE 2/2] Running performance comparisons...
334.8s 4050 [QUICK TEST] Testing only: traffic_light_control
334.8s 4051 
334.8s 4052 Testing scenario: traffic_light_control (device=gpu)
334.8s 4053 2025-10-11 07:01:04 - INFO - run_performance_comparison:699 - ================================================================================
334.8s 4054 2025-10-11 07:01:04 - INFO - run_performance_comparison:700 - Starting run_performance_comparison for scenario: traffic_light_control
334.8s 4055 2025-10-11 07:01:04 - INFO - run_performance_comparison:701 - Device: gpu
334.8s 4056 2025-10-11 07:01:04 - INFO - run_performance_comparison:702 - ================================================================================
334.8s 4057 2025-10-11 07:01:04 - INFO - run_performance_comparison:703 - ================================================================================
334.8s 4058 2025-10-11 07:01:04 - INFO - run_performance_comparison:704 - Starting run_performance_comparison for scenario: traffic_light_control
334.8s 4059 2025-10-11 07:01:04 - INFO - run_performance_comparison:705 - Device: gpu
334.8s 4060 2025-10-11 07:01:04 - INFO - run_performance_comparison:706 - ================================================================================
334.8s 4061 2025-10-11 07:01:04 - INFO - _create_scenario_config:202 - Created scenario config: traffic_light_control.yml
334.8s 4062 2025-10-11 07:01:04 - INFO - _create_scenario_config:203 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
334.8s 4063 2025-10-11 07:01:04 - INFO - _create_scenario_config:204 -   Uniform density: rho_m=80.0 veh/km, rho_c=100.0 veh/km
334.8s 4064 2025-10-11 07:01:04 - INFO - _create_scenario_config:205 -   Uniform velocity: w_m=12.0 m/s, w_c=10.0 m/s
334.8s 4065 [SCENARIO] Generated: traffic_light_control.yml (1km domain, UNIFORM congestion IC)
334.8s 4066 Running baseline controller...
334.8s 4067 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
334.8s 4068 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
334.8s 4069 2025-10-11 07:01:04 - INFO - run_control_simulation:285 - ================================================================================
334.8s 4070 2025-10-11 07:01:04 - INFO - run_control_simulation:286 - Starting run_control_simulation:
334.8s 4071 2025-10-11 07:01:04 - INFO - run_control_simulation:287 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.8s 4072 2025-10-11 07:01:04 - INFO - run_control_simulation:288 -   - duration: 600.0s
334.8s 4073 2025-10-11 07:01:04 - INFO - run_control_simulation:289 -   - control_interval: 60.0s
334.8s 4074 2025-10-11 07:01:04 - INFO - run_control_simulation:290 -   - device: gpu
334.8s 4075 2025-10-11 07:01:04 - INFO - run_control_simulation:291 -   - controller: BaselineController
334.8s 4076 2025-10-11 07:01:04 - INFO - run_control_simulation:292 -   - max_control_steps: 11
334.8s 4077 2025-10-11 07:01:04 - INFO - run_control_simulation:293 - ================================================================================
334.8s 4078 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
334.8s 4079 2025-10-11 07:01:04 - INFO - run_control_simulation:298 - Creating TrafficSignalEnvDirect instance...
334.8s 4080 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.8s 4081 Using device: gpu
334.8s 4082 DEBUG PARAMS: Reading K_m_kmh = 10.0
334.8s 4083 DEBUG PARAMS: Reading K_c_kmh = 15.0
334.8s 4084 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
334.8s 4085 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
334.8s 4086 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
334.8s 4087 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
334.8s 4088 Loading road quality type: uniform
334.8s 4089 Uniform road quality value: 2
334.8s 4090 Road quality loaded.
334.8s 4091 Initial state created.
334.8s 4092 Transferring initial state and road quality to GPU...
334.8s 4093 GPU data transfer complete.
334.8s 4094 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
334.8s 4095 Initial boundary conditions applied.
334.8s 4096 TrafficSignalEnvDirect initialized:
334.8s 4097 Decision interval: 60.0s
334.8s 4098 Observation segments: 6
334.8s 4099 Observation space: (26,)
334.8s 4100 Action space: 2
334.8s 4101 Device: gpu
334.8s 4102 2025-10-11 07:01:04 - INFO - run_control_simulation:313 - TrafficSignalEnvDirect created successfully
334.8s 4103 2025-10-11 07:01:04 - INFO - run_control_simulation:314 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
334.8s 4104 [INFO] Calling env.reset()...
334.8s 4105 2025-10-11 07:01:04 - INFO - run_control_simulation:330 - Calling env.reset()...
334.8s 4106 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
334.8s 4107 Using device: gpu
334.8s 4108 DEBUG PARAMS: Reading K_m_kmh = 10.0
334.8s 4109 DEBUG PARAMS: Reading K_c_kmh = 15.0
334.8s 4110 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
334.8s 4111 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
334.8s 4112 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
334.8s 4113 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
334.8s 4114 Loading road quality type: uniform
334.8s 4115 Uniform road quality value: 2
334.8s 4116 Road quality loaded.
334.8s 4117 Initial state created.
334.8s 4118 Transferring initial state and road quality to GPU...
334.8s 4119 GPU data transfer complete.
334.8s 4120 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
334.8s 4121 Initial boundary conditions applied.
334.8s 4122 [BC UPDATE] left → phase 0 RED (reduced inflow)
334.8s 4123 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
334.8s 4124 2025-10-11 07:01:04 - INFO - run_control_simulation:332 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
334.8s 4125 2025-10-11 07:01:04 - INFO - run_control_simulation:336 - INITIAL STATE shape: (4, 104), dtype: float64
334.8s 4126 2025-10-11 07:01:04 - INFO - run_control_simulation:337 - INITIAL STATE statistics: mean=5.467747e+00, std=5.479526e+00, min=8.000000e-05, max=1.200000e+01
334.8s 4127 [INFO] Starting simulation loop (max 11 control steps)
334.8s 4128 2025-10-11 07:01:04 - INFO - run_control_simulation:353 - Starting simulation loop - max 11 control steps
334.8s 4129 2025-10-11 07:01:04 - INFO - run_control_simulation:367 - ================================================================================
334.8s 4130 2025-10-11 07:01:04 - INFO - run_control_simulation:368 - STEP 0 START:
334.8s 4131 2025-10-11 07:01:04 - INFO - run_control_simulation:369 -   Controller: BaselineController
334.8s 4132 2025-10-11 07:01:04 - INFO - run_control_simulation:370 -   Action: 1.000000
334.8s 4133 2025-10-11 07:01:04 - INFO - run_control_simulation:371 -   Simulation time: 0.00s
334.8s 4134 [BC UPDATE] left → phase 1 GREEN (normal inflow)
334.8s 4135 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
334.8s 4136 Running simulation until t = 60.00 s, outputting every 60.00 s
335.3s 4137 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
335.7s 4138 [WARNING] Automatic CFL correction applied (count: 22800):
335.7s 4139 Calculated CFL: 0.800 > Limit: 0.500
335.7s 4140 Original dt: 4.134204e-01 s
335.7s 4141 Corrected dt: 2.583878e-01 s
335.7s 4142 Correction factor: 1.6x
335.7s 4143 Max wave speed detected: 19.35 m/s
335.7s 4144 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
336.2s 4145 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
336.6s 4146 [WARNING] Automatic CFL correction applied (count: 22900):
336.6s 4147 Calculated CFL: 0.800 > Limit: 0.500
336.6s 4148 Original dt: 4.114972e-01 s
336.6s 4149 Corrected dt: 2.571857e-01 s
336.6s 4150 Correction factor: 1.6x
336.6s 4151 Max wave speed detected: 19.44 m/s
336.6s 4152 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
336.8s 4153 Stored output at t = 60.0000 s (Step 220)
336.8s 4154 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.04s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:01<00:00, 30.04s/s]
336.8s 4155 
336.8s 4156 Simulation finished at t = 60.0000 s after 220 steps.
336.8s 4157 Total runtime: 2.00 seconds.
336.8s 4158 2025-10-11 07:01:06 - INFO - run_control_simulation:383 -   Reward: -0.089743
336.8s 4159 2025-10-11 07:01:06 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
336.8s 4160 2025-10-11 07:01:06 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
336.8s 4161 2025-10-11 07:01:06 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
336.8s 4162 2025-10-11 07:01:06 - INFO - run_control_simulation:402 -     Diff statistics: mean=2.319017e+00, max=8.666667e+00, std=2.569328e+00
336.8s 4163 2025-10-11 07:01:06 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.048525, rho_c=0.070075
336.8s 4164 2025-10-11 07:01:06 - INFO - run_control_simulation:413 -     Mean velocities: w_m=11.216783, w_c=9.679220
336.8s 4165 2025-10-11 07:01:06 - INFO - run_control_simulation:417 -   State hash: 515523449572979520
336.8s 4166 2025-10-11 07:01:06 - INFO - run_control_simulation:419 - ================================================================================
336.8s 4167 [STEP 1/11] action=1.0000, reward=-0.0897, t=60.0s, state_diff=2.319017e+00
336.8s 4168 2025-10-11 07:01:06 - INFO - run_control_simulation:367 - ================================================================================
336.8s 4169 2025-10-11 07:01:06 - INFO - run_control_simulation:368 - STEP 1 START:
336.8s 4170 2025-10-11 07:01:06 - INFO - run_control_simulation:369 -   Controller: BaselineController
336.8s 4171 2025-10-11 07:01:06 - INFO - run_control_simulation:370 -   Action: 0.000000
336.8s 4172 2025-10-11 07:01:06 - INFO - run_control_simulation:371 -   Simulation time: 60.00s
336.8s 4173 [BC UPDATE] left → phase 0 RED (reduced inflow)
336.8s 4174 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
336.8s 4175 Running simulation until t = 120.00 s, outputting every 60.00 s
337.1s 4176 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
337.5s 4177 [WARNING] Automatic CFL correction applied (count: 23000):
337.5s 4178 Calculated CFL: 0.800 > Limit: 0.500
337.5s 4179 Original dt: 4.114753e-01 s
337.5s 4180 Corrected dt: 2.571721e-01 s
337.5s 4181 Correction factor: 1.6x
337.5s 4182 Max wave speed detected: 19.44 m/s
337.5s 4183 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
338.0s 4184 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
338.4s 4185 [WARNING] Automatic CFL correction applied (count: 23100):
338.4s 4186 Calculated CFL: 0.800 > Limit: 0.500
338.4s 4187 Original dt: 4.114750e-01 s
338.4s 4188 Corrected dt: 2.571719e-01 s
338.4s 4189 Correction factor: 1.6x
338.4s 4190 Max wave speed detected: 19.44 m/s
338.4s 4191 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
338.9s 4192 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
338.9s 4193 Stored output at t = 120.0000 s (Step 454)
338.9s 4194 
338.9s 4195 Simulation finished at t = 120.0000 s after 454 steps.
338.9s 4196 Total runtime: 2.10 seconds.
338.9s 4197 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.56s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.56s/s]
338.9s 4198 2025-10-11 07:01:09 - INFO - run_control_simulation:383 -   Reward: 0.010256
338.9s 4199 2025-10-11 07:01:09 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
338.9s 4200 2025-10-11 07:01:09 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
338.9s 4201 2025-10-11 07:01:09 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
338.9s 4202 2025-10-11 07:01:09 - INFO - run_control_simulation:402 -     Diff statistics: mean=1.784427e+00, max=1.206300e+01, std=3.708282e+00
338.9s 4203 2025-10-11 07:01:09 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.018797, rho_c=0.043161
338.9s 4204 2025-10-11 07:01:09 - INFO - run_control_simulation:413 -     Mean velocities: w_m=14.872570, w_c=12.665503
338.9s 4205 2025-10-11 07:01:09 - INFO - run_control_simulation:417 -   State hash: -2408677622564959416
338.9s 4206 2025-10-11 07:01:09 - INFO - run_control_simulation:419 - ================================================================================
338.9s 4207 [STEP 2/11] action=0.0000, reward=0.0103, t=120.0s, state_diff=1.784427e+00
338.9s 4208 2025-10-11 07:01:09 - INFO - run_control_simulation:367 - ================================================================================
338.9s 4209 2025-10-11 07:01:09 - INFO - run_control_simulation:368 - STEP 2 START:
338.9s 4210 2025-10-11 07:01:09 - INFO - run_control_simulation:369 -   Controller: BaselineController
338.9s 4211 2025-10-11 07:01:09 - INFO - run_control_simulation:370 -   Action: 1.000000
338.9s 4212 2025-10-11 07:01:09 - INFO - run_control_simulation:371 -   Simulation time: 120.00s
338.9s 4213 [BC UPDATE] left → phase 1 GREEN (normal inflow)
338.9s 4214 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
338.9s 4215 Running simulation until t = 180.00 s, outputting every 60.00 s
339.3s 4216 [WARNING] Automatic CFL correction applied (count: 23200):
339.3s 4217 Calculated CFL: 0.800 > Limit: 0.500
339.3s 4218 Original dt: 4.114750e-01 s
339.3s 4219 Corrected dt: 2.571719e-01 s
339.3s 4220 Correction factor: 1.6x
339.3s 4221 Max wave speed detected: 19.44 m/s
339.3s 4222 [PROGRESS] Step 500: t=131.83/180.00s (73.2%) | dt=0.2572s
339.8s 4223 [PROGRESS] Step 550: t=144.69/180.00s (80.4%) | dt=0.2572s
340.2s 4224 [WARNING] Automatic CFL correction applied (count: 23300):
340.2s 4225 Calculated CFL: 0.800 > Limit: 0.500
340.2s 4226 Original dt: 4.114750e-01 s
340.2s 4227 Corrected dt: 2.571719e-01 s
340.2s 4228 Correction factor: 1.6x
340.2s 4229 Max wave speed detected: 19.44 m/s
340.2s 4230 [PROGRESS] Step 600: t=157.55/180.00s (87.5%) | dt=0.2572s
340.7s 4231 [PROGRESS] Step 650: t=170.41/180.00s (94.7%) | dt=0.2572s
341.0s 4232 Stored output at t = 180.0000 s (Step 688)
341.0s 4233 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.32s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.32s/s]
341.0s 4234 
341.0s 4235 Simulation finished at t = 180.0000 s after 688 steps.
341.0s 4236 Total runtime: 2.12 seconds.
341.0s 4237 2025-10-11 07:01:11 - INFO - run_control_simulation:383 -   Reward: -0.089744
341.0s 4238 2025-10-11 07:01:11 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
341.0s 4239 2025-10-11 07:01:11 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
341.0s 4240 2025-10-11 07:01:11 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
341.0s 4241 2025-10-11 07:01:11 - INFO - run_control_simulation:402 -     Diff statistics: mean=1.766070e+00, max=1.201906e+01, std=3.689780e+00
341.0s 4242 2025-10-11 07:01:11 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001555, rho_c=0.004287
341.0s 4243 2025-10-11 07:01:11 - INFO - run_control_simulation:413 -     Mean velocities: w_m=18.743570, w_c=15.802665
341.0s 4244 2025-10-11 07:01:11 - INFO - run_control_simulation:417 -   State hash: -5943357550333840104
341.0s 4245 2025-10-11 07:01:11 - INFO - run_control_simulation:419 - ================================================================================
341.0s 4246 [STEP 3/11] action=1.0000, reward=-0.0897, t=180.0s, state_diff=1.766070e+00
341.0s 4247 2025-10-11 07:01:11 - INFO - run_control_simulation:367 - ================================================================================
341.0s 4248 2025-10-11 07:01:11 - INFO - run_control_simulation:368 - STEP 3 START:
341.0s 4249 2025-10-11 07:01:11 - INFO - run_control_simulation:369 -   Controller: BaselineController
341.0s 4250 2025-10-11 07:01:11 - INFO - run_control_simulation:370 -   Action: 0.000000
341.0s 4251 2025-10-11 07:01:11 - INFO - run_control_simulation:371 -   Simulation time: 180.00s
341.0s 4252 [BC UPDATE] left → phase 0 RED (reduced inflow)
341.0s 4253 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
341.0s 4254 Running simulation until t = 240.00 s, outputting every 60.00 s
341.1s 4255 [WARNING] Automatic CFL correction applied (count: 23400):
341.1s 4256 Calculated CFL: 0.800 > Limit: 0.500
341.1s 4257 Original dt: 4.114750e-01 s
341.1s 4258 Corrected dt: 2.571719e-01 s
341.1s 4259 Correction factor: 1.6x
341.1s 4260 Max wave speed detected: 19.44 m/s
341.2s 4261 [PROGRESS] Step 700: t=183.09/240.00s (76.3%) | dt=0.2572s
341.6s 4262 [PROGRESS] Step 750: t=195.94/240.00s (81.6%) | dt=0.2572s
342.0s 4263 [WARNING] Automatic CFL correction applied (count: 23500):
342.0s 4264 Calculated CFL: 0.800 > Limit: 0.500
342.0s 4265 Original dt: 4.114750e-01 s
342.0s 4266 Corrected dt: 2.571719e-01 s
342.0s 4267 Correction factor: 1.6x
342.0s 4268 Max wave speed detected: 19.44 m/s
342.1s 4269 [PROGRESS] Step 800: t=208.80/240.00s (87.0%) | dt=0.2572s
342.5s 4270 [PROGRESS] Step 850: t=221.66/240.00s (92.4%) | dt=0.2572s
342.9s 4271 [WARNING] Automatic CFL correction applied (count: 23600):
342.9s 4272 Calculated CFL: 0.800 > Limit: 0.500
342.9s 4273 Original dt: 4.114750e-01 s
342.9s 4274 Corrected dt: 2.571719e-01 s
342.9s 4275 Correction factor: 1.6x
342.9s 4276 Max wave speed detected: 19.44 m/s
343.0s 4277 [PROGRESS] Step 900: t=234.52/240.00s (97.7%) | dt=0.2572s
343.2s 4278 Stored output at t = 240.0000 s (Step 922)
343.2s 4279 
343.2s 4280 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.50s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.50s/s]
343.2s 4281 Simulation finished at t = 240.0000 s after 922 steps.
343.2s 4282 Total runtime: 2.11 seconds.
343.2s 4283 2025-10-11 07:01:13 - INFO - run_control_simulation:383 -   Reward: 0.010256
343.2s 4284 2025-10-11 07:01:13 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
343.2s 4285 2025-10-11 07:01:13 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
343.2s 4286 2025-10-11 07:01:13 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
343.2s 4287 2025-10-11 07:01:13 - INFO - run_control_simulation:402 -     Diff statistics: mean=3.234136e-01, max=9.644774e+00, std=1.399038e+00
343.2s 4288 2025-10-11 07:01:13 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
343.2s 4289 2025-10-11 07:01:13 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.107279, w_c=16.307183
343.2s 4290 2025-10-11 07:01:13 - INFO - run_control_simulation:417 -   State hash: 8081835444743237291
343.2s 4291 2025-10-11 07:01:13 - INFO - run_control_simulation:419 - ================================================================================
343.2s 4292 [STEP 4/11] action=0.0000, reward=0.0103, t=240.0s, state_diff=3.234136e-01
343.2s 4293 2025-10-11 07:01:13 - INFO - run_control_simulation:367 - ================================================================================
343.2s 4294 2025-10-11 07:01:13 - INFO - run_control_simulation:368 - STEP 4 START:
343.2s 4295 2025-10-11 07:01:13 - INFO - run_control_simulation:369 -   Controller: BaselineController
343.2s 4296 2025-10-11 07:01:13 - INFO - run_control_simulation:370 -   Action: 1.000000
343.2s 4297 2025-10-11 07:01:13 - INFO - run_control_simulation:371 -   Simulation time: 240.00s
343.2s 4298 [BC UPDATE] left → phase 1 GREEN (normal inflow)
343.2s 4299 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
343.2s 4300 Running simulation until t = 300.00 s, outputting every 60.00 s
343.4s 4301 [PROGRESS] Step 950: t=247.20/300.00s (82.4%) | dt=0.2572s
343.9s 4302 [WARNING] Automatic CFL correction applied (count: 23700):
343.9s 4303 Calculated CFL: 0.800 > Limit: 0.500
343.9s 4304 Original dt: 4.114750e-01 s
343.9s 4305 Corrected dt: 2.571719e-01 s
343.9s 4306 Correction factor: 1.6x
343.9s 4307 Max wave speed detected: 19.44 m/s
343.9s 4308 [PROGRESS] Step 1000: t=260.06/300.00s (86.7%) | dt=0.2572s
344.3s 4309 [PROGRESS] Step 1050: t=272.92/300.00s (91.0%) | dt=0.2572s
344.8s 4310 [WARNING] Automatic CFL correction applied (count: 23800):
344.8s 4311 Calculated CFL: 0.800 > Limit: 0.500
344.8s 4312 Original dt: 4.114750e-01 s
344.8s 4313 Corrected dt: 2.571719e-01 s
344.8s 4314 Correction factor: 1.6x
344.8s 4315 Max wave speed detected: 19.44 m/s
344.8s 4316 [PROGRESS] Step 1100: t=285.78/300.00s (95.3%) | dt=0.2572s
345.2s 4317 [PROGRESS] Step 1150: t=298.64/300.00s (99.5%) | dt=0.2572s
345.3s 4318 Stored output at t = 300.0000 s (Step 1156)
345.3s 4319 
345.3s 4320 Simulation finished at t = 300.0000 s after 1156 steps.
345.3s 4321 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.41s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 28.41s/s]
345.3s 4322 Total runtime: 2.11 seconds.
345.3s 4323 2025-10-11 07:01:15 - INFO - run_control_simulation:383 -   Reward: -0.089744
345.3s 4324 2025-10-11 07:01:15 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
345.3s 4325 2025-10-11 07:01:15 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
345.3s 4326 2025-10-11 07:01:15 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
345.3s 4327 2025-10-11 07:01:15 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.299787e-02, max=6.000000e+00, std=5.389443e-01
345.3s 4328 2025-10-11 07:01:15 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
345.3s 4329 2025-10-11 07:01:15 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
345.3s 4330 2025-10-11 07:01:15 - INFO - run_control_simulation:417 -   State hash: 4402679159049512588
345.3s 4331 2025-10-11 07:01:15 - INFO - run_control_simulation:419 - ================================================================================
345.3s 4332 [STEP 5/11] action=1.0000, reward=-0.0897, t=300.0s, state_diff=5.299787e-02
345.3s 4333 2025-10-11 07:01:15 - INFO - run_control_simulation:367 - ================================================================================
345.3s 4334 2025-10-11 07:01:15 - INFO - run_control_simulation:368 - STEP 5 START:
345.3s 4335 2025-10-11 07:01:15 - INFO - run_control_simulation:369 -   Controller: BaselineController
345.3s 4336 2025-10-11 07:01:15 - INFO - run_control_simulation:370 -   Action: 0.000000
345.3s 4337 2025-10-11 07:01:15 - INFO - run_control_simulation:371 -   Simulation time: 300.00s
345.3s 4338 [BC UPDATE] left → phase 0 RED (reduced inflow)
345.3s 4339 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
345.3s 4340 Running simulation until t = 360.00 s, outputting every 60.00 s
345.7s 4341 [WARNING] Automatic CFL correction applied (count: 23900):
345.7s 4342 Calculated CFL: 0.800 > Limit: 0.500
345.7s 4343 Original dt: 4.114750e-01 s
345.7s 4344 Corrected dt: 2.571719e-01 s
345.7s 4345 Correction factor: 1.6x
345.7s 4346 Max wave speed detected: 19.44 m/s
345.7s 4347 [PROGRESS] Step 1200: t=311.32/360.00s (86.5%) | dt=0.2572s
346.1s 4348 [PROGRESS] Step 1250: t=324.17/360.00s (90.0%) | dt=0.2572s
346.6s 4349 [WARNING] Automatic CFL correction applied (count: 24000):
346.6s 4350 Calculated CFL: 0.800 > Limit: 0.500
346.6s 4351 Original dt: 4.114750e-01 s
346.6s 4352 Corrected dt: 2.571719e-01 s
346.6s 4353 Correction factor: 1.6x
346.6s 4354 Max wave speed detected: 19.44 m/s
346.6s 4355 [PROGRESS] Step 1300: t=337.03/360.00s (93.6%) | dt=0.2572s
347.0s 4356 [PROGRESS] Step 1350: t=349.89/360.00s (97.2%) | dt=0.2572s
347.4s 4357 Stored output at t = 360.0000 s (Step 1390)
347.4s 4358 
347.4s 4359 Simulation finished at t = 360.0000 s after 1390 steps.
347.4s 4360 Total runtime: 2.11 seconds.
347.4s 4361 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.41s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.41s/s]
347.4s 4362 2025-10-11 07:01:17 - INFO - run_control_simulation:383 -   Reward: 0.010256
347.4s 4363 2025-10-11 07:01:17 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
347.4s 4364 2025-10-11 07:01:17 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
347.4s 4365 2025-10-11 07:01:17 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
347.4s 4366 2025-10-11 07:01:17 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.288470e-02, max=6.000000e+00, std=5.389550e-01
347.4s 4367 2025-10-11 07:01:17 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
347.4s 4368 2025-10-11 07:01:17 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.107280, w_c=16.307636
347.4s 4369 2025-10-11 07:01:17 - INFO - run_control_simulation:417 -   State hash: 6907852170294014838
347.4s 4370 2025-10-11 07:01:17 - INFO - run_control_simulation:419 - ================================================================================
347.4s 4371 [STEP 6/11] action=0.0000, reward=0.0103, t=360.0s, state_diff=5.288470e-02
347.4s 4372 2025-10-11 07:01:17 - INFO - run_control_simulation:367 - ================================================================================
347.4s 4373 2025-10-11 07:01:17 - INFO - run_control_simulation:368 - STEP 6 START:
347.4s 4374 2025-10-11 07:01:17 - INFO - run_control_simulation:369 -   Controller: BaselineController
347.4s 4375 2025-10-11 07:01:17 - INFO - run_control_simulation:370 -   Action: 1.000000
347.4s 4376 2025-10-11 07:01:17 - INFO - run_control_simulation:371 -   Simulation time: 360.00s
347.4s 4377 [BC UPDATE] left → phase 1 GREEN (normal inflow)
347.4s 4378 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
347.4s 4379 Running simulation until t = 420.00 s, outputting every 60.00 s
347.5s 4380 [WARNING] Automatic CFL correction applied (count: 24100):
347.5s 4381 Calculated CFL: 0.800 > Limit: 0.500
347.5s 4382 Original dt: 4.114750e-01 s
347.5s 4383 Corrected dt: 2.571719e-01 s
347.5s 4384 Correction factor: 1.6x
347.5s 4385 Max wave speed detected: 19.44 m/s
347.5s 4386 [PROGRESS] Step 1400: t=362.57/420.00s (86.3%) | dt=0.2572s
347.9s 4387 [PROGRESS] Step 1450: t=375.43/420.00s (89.4%) | dt=0.2572s
348.4s 4388 [WARNING] Automatic CFL correction applied (count: 24200):
348.4s 4389 Calculated CFL: 0.800 > Limit: 0.500
348.4s 4390 Original dt: 4.114750e-01 s
348.4s 4391 Corrected dt: 2.571719e-01 s
348.4s 4392 Correction factor: 1.6x
348.4s 4393 Max wave speed detected: 19.44 m/s
348.4s 4394 [PROGRESS] Step 1500: t=388.29/420.00s (92.4%) | dt=0.2572s
348.8s 4395 [PROGRESS] Step 1550: t=401.15/420.00s (95.5%) | dt=0.2572s
349.3s 4396 [WARNING] Automatic CFL correction applied (count: 24300):
349.3s 4397 Calculated CFL: 0.800 > Limit: 0.500
349.3s 4398 Original dt: 4.114750e-01 s
349.3s 4399 Corrected dt: 2.571719e-01 s
349.3s 4400 Correction factor: 1.6x
349.3s 4401 Max wave speed detected: 19.44 m/s
349.3s 4402 [PROGRESS] Step 1600: t=414.01/420.00s (98.6%) | dt=0.2572s
349.5s 4403 Stored output at t = 420.0000 s (Step 1624)
349.5s 4404 
349.5s 4405 Simulation finished at t = 420.0000 s after 1624 steps.
349.5s 4406 Total runtime: 2.09 seconds.
349.5s 4407 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.71s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.70s/s]
349.5s 4408 2025-10-11 07:01:19 - INFO - run_control_simulation:383 -   Reward: -0.089744
349.5s 4409 2025-10-11 07:01:19 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
349.5s 4410 2025-10-11 07:01:19 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
349.5s 4411 2025-10-11 07:01:19 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
349.5s 4412 2025-10-11 07:01:19 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.288462e-02, max=6.000000e+00, std=5.389550e-01
349.5s 4413 2025-10-11 07:01:19 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
349.5s 4414 2025-10-11 07:01:19 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
349.5s 4415 2025-10-11 07:01:19 - INFO - run_control_simulation:417 -   State hash: -4153833715237115081
349.5s 4416 2025-10-11 07:01:19 - INFO - run_control_simulation:419 - ================================================================================
349.5s 4417 [STEP 7/11] action=1.0000, reward=-0.0897, t=420.0s, state_diff=5.288462e-02
349.5s 4418 2025-10-11 07:01:19 - INFO - run_control_simulation:367 - ================================================================================
349.5s 4419 2025-10-11 07:01:19 - INFO - run_control_simulation:368 - STEP 7 START:
349.5s 4420 2025-10-11 07:01:19 - INFO - run_control_simulation:369 -   Controller: BaselineController
349.5s 4421 2025-10-11 07:01:19 - INFO - run_control_simulation:370 -   Action: 0.000000
349.5s 4422 2025-10-11 07:01:19 - INFO - run_control_simulation:371 -   Simulation time: 420.00s
349.5s 4423 [BC UPDATE] left → phase 0 RED (reduced inflow)
349.5s 4424 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
349.5s 4425 Running simulation until t = 480.00 s, outputting every 60.00 s
349.7s 4426 [PROGRESS] Step 1650: t=426.69/480.00s (88.9%) | dt=0.2572s
350.2s 4427 [WARNING] Automatic CFL correction applied (count: 24400):
350.2s 4428 Calculated CFL: 0.800 > Limit: 0.500
350.2s 4429 Original dt: 4.114750e-01 s
350.2s 4430 Corrected dt: 2.571719e-01 s
350.2s 4431 Correction factor: 1.6x
350.2s 4432 Max wave speed detected: 19.44 m/s
350.2s 4433 [PROGRESS] Step 1700: t=439.55/480.00s (91.6%) | dt=0.2572s
350.6s 4434 [PROGRESS] Step 1750: t=452.40/480.00s (94.3%) | dt=0.2572s
351.1s 4435 [WARNING] Automatic CFL correction applied (count: 24500):
351.1s 4436 Calculated CFL: 0.800 > Limit: 0.500
351.1s 4437 Original dt: 4.114750e-01 s
351.1s 4438 Corrected dt: 2.571719e-01 s
351.1s 4439 Correction factor: 1.6x
351.1s 4440 Max wave speed detected: 19.44 m/s
351.1s 4441 [PROGRESS] Step 1800: t=465.26/480.00s (96.9%) | dt=0.2572s
351.6s 4442 [PROGRESS] Step 1850: t=478.12/480.00s (99.6%) | dt=0.2572s
351.6s 4443 Stored output at t = 480.0000 s (Step 1858)
351.6s 4444 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.86s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 27.86s/s]
351.6s 4445 
351.6s 4446 Simulation finished at t = 480.0000 s after 1858 steps.
351.6s 4447 Total runtime: 2.15 seconds.
351.6s 4448 2025-10-11 07:01:21 - INFO - run_control_simulation:383 -   Reward: 0.010256
351.6s 4449 2025-10-11 07:01:21 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
351.6s 4450 2025-10-11 07:01:21 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
351.6s 4451 2025-10-11 07:01:21 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
351.6s 4452 2025-10-11 07:01:21 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.288462e-02, max=6.000000e+00, std=5.389550e-01
351.6s 4453 2025-10-11 07:01:21 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
351.6s 4454 2025-10-11 07:01:21 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.107280, w_c=16.307636
351.6s 4455 2025-10-11 07:01:21 - INFO - run_control_simulation:417 -   State hash: -5865074700498561283
351.6s 4456 2025-10-11 07:01:21 - INFO - run_control_simulation:419 - ================================================================================
351.6s 4457 [STEP 8/11] action=0.0000, reward=0.0103, t=480.0s, state_diff=5.288462e-02
351.6s 4458 2025-10-11 07:01:21 - INFO - run_control_simulation:367 - ================================================================================
351.6s 4459 2025-10-11 07:01:21 - INFO - run_control_simulation:368 - STEP 8 START:
351.6s 4460 2025-10-11 07:01:21 - INFO - run_control_simulation:369 -   Controller: BaselineController
351.6s 4461 2025-10-11 07:01:21 - INFO - run_control_simulation:370 -   Action: 1.000000
351.6s 4462 2025-10-11 07:01:21 - INFO - run_control_simulation:371 -   Simulation time: 480.00s
351.6s 4463 [BC UPDATE] left → phase 1 GREEN (normal inflow)
351.6s 4464 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
351.6s 4465 Running simulation until t = 540.00 s, outputting every 60.00 s
352.0s 4466 [WARNING] Automatic CFL correction applied (count: 24600):
352.0s 4467 Calculated CFL: 0.800 > Limit: 0.500
352.0s 4468 Original dt: 4.114750e-01 s
352.0s 4469 Corrected dt: 2.571719e-01 s
352.0s 4470 Correction factor: 1.6x
352.0s 4471 Max wave speed detected: 19.44 m/s
352.0s 4472 [PROGRESS] Step 1900: t=490.80/540.00s (90.9%) | dt=0.2572s
352.5s 4473 [PROGRESS] Step 1950: t=503.66/540.00s (93.3%) | dt=0.2572s
352.9s 4474 [WARNING] Automatic CFL correction applied (count: 24700):
352.9s 4475 Calculated CFL: 0.800 > Limit: 0.500
352.9s 4476 Original dt: 4.114750e-01 s
352.9s 4477 Corrected dt: 2.571719e-01 s
352.9s 4478 Correction factor: 1.6x
352.9s 4479 Max wave speed detected: 19.44 m/s
352.9s 4480 [PROGRESS] Step 2000: t=516.52/540.00s (95.7%) | dt=0.2572s
353.4s 4481 [PROGRESS] Step 2050: t=529.38/540.00s (98.0%) | dt=0.2572s
353.8s 4482 Stored output at t = 540.0000 s (Step 2092)
353.8s 4483 
353.8s 4484 Simulation finished at t = 540.0000 s after 2092 steps.
353.8s 4485 Total runtime: 2.13 seconds.
353.8s 4486 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.20s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.20s/s]
353.8s 4487 2025-10-11 07:01:23 - INFO - run_control_simulation:383 -   Reward: -0.089744
353.8s 4488 2025-10-11 07:01:23 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
353.8s 4489 2025-10-11 07:01:23 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
353.8s 4490 2025-10-11 07:01:23 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
353.8s 4491 2025-10-11 07:01:23 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.288462e-02, max=6.000000e+00, std=5.389550e-01
353.8s 4492 2025-10-11 07:01:23 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
353.8s 4493 2025-10-11 07:01:23 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
353.8s 4494 2025-10-11 07:01:23 - INFO - run_control_simulation:417 -   State hash: 332413424154743299
353.8s 4495 2025-10-11 07:01:23 - INFO - run_control_simulation:419 - ================================================================================
353.8s 4496 [STEP 9/11] action=1.0000, reward=-0.0897, t=540.0s, state_diff=5.288462e-02
353.8s 4497 2025-10-11 07:01:23 - INFO - run_control_simulation:367 - ================================================================================
353.8s 4498 2025-10-11 07:01:23 - INFO - run_control_simulation:368 - STEP 9 START:
353.8s 4499 2025-10-11 07:01:23 - INFO - run_control_simulation:369 -   Controller: BaselineController
353.8s 4500 2025-10-11 07:01:23 - INFO - run_control_simulation:370 -   Action: 0.000000
353.8s 4501 2025-10-11 07:01:23 - INFO - run_control_simulation:371 -   Simulation time: 540.00s
353.8s 4502 [BC UPDATE] left → phase 0 RED (reduced inflow)
353.8s 4503 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
353.8s 4504 Running simulation until t = 600.00 s, outputting every 60.00 s
353.8s 4505 [WARNING] Automatic CFL correction applied (count: 24800):
353.8s 4506 Calculated CFL: 0.800 > Limit: 0.500
353.8s 4507 Original dt: 4.114750e-01 s
353.8s 4508 Corrected dt: 2.571719e-01 s
353.8s 4509 Correction factor: 1.6x
353.8s 4510 Max wave speed detected: 19.44 m/s
353.8s 4511 [PROGRESS] Step 2100: t=542.06/600.00s (90.3%) | dt=0.2572s
354.3s 4512 [PROGRESS] Step 2150: t=554.92/600.00s (92.5%) | dt=0.2572s
354.7s 4513 [WARNING] Automatic CFL correction applied (count: 24900):
354.7s 4514 Calculated CFL: 0.800 > Limit: 0.500
354.7s 4515 Original dt: 4.114750e-01 s
354.7s 4516 Corrected dt: 2.571719e-01 s
354.7s 4517 Correction factor: 1.6x
354.7s 4518 Max wave speed detected: 19.44 m/s
354.7s 4519 [PROGRESS] Step 2200: t=567.77/600.00s (94.6%) | dt=0.2572s
355.2s 4520 [PROGRESS] Step 2250: t=580.63/600.00s (96.8%) | dt=0.2572s
355.6s 4521 [WARNING] Automatic CFL correction applied (count: 25000):
355.6s 4522 Calculated CFL: 0.800 > Limit: 0.500
355.6s 4523 Original dt: 4.114750e-01 s
355.6s 4524 Corrected dt: 2.571719e-01 s
355.6s 4525 Correction factor: 1.6x
355.6s 4526 Max wave speed detected: 19.44 m/s
355.7s 4527 [PROGRESS] Step 2300: t=593.49/600.00s (98.9%) | dt=0.2572s
355.9s 4528 Stored output at t = 600.0000 s (Step 2326)
355.9s 4529 
355.9s 4530 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.39s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.39s/s]
355.9s 4531 Simulation finished at t = 600.0000 s after 2326 steps.
355.9s 4532 Total runtime: 2.11 seconds.
355.9s 4533 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
355.9s 4534 2025-10-11 07:01:25 - INFO - run_control_simulation:383 -   Reward: 0.010256
355.9s 4535 2025-10-11 07:01:25 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: True
355.9s 4536 2025-10-11 07:01:25 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
355.9s 4537 2025-10-11 07:01:25 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
355.9s 4538 2025-10-11 07:01:25 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.288462e-02, max=6.000000e+00, std=5.389550e-01
355.9s 4539 2025-10-11 07:01:25 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
355.9s 4540 2025-10-11 07:01:25 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.107280, w_c=16.307636
355.9s 4541 2025-10-11 07:01:25 - INFO - run_control_simulation:417 -   State hash: -2048612247790917129
355.9s 4542 2025-10-11 07:01:25 - INFO - run_control_simulation:419 - ================================================================================
355.9s 4543 [STEP 10/11] action=0.0000, reward=0.0103, t=600.0s, state_diff=5.288462e-02
355.9s 4544 
355.9s 4545 [SIMULATION COMPLETED] Summary:
355.9s 4546 - Total control steps: 10
355.9s 4547 - Total reward: -0.40
355.9s 4548 - Avg step time: 2.107s (device=gpu)
355.9s 4549 - Simulated time: 600.0s / 600.0s
355.9s 4550 - Wallclock time: 21.1s
355.9s 4551 - Speed ratio: 28.48x real-time
355.9s 4552 
355.9s 4553 2025-10-11 07:01:25 - INFO - run_control_simulation:454 -
355.9s 4554 [SIMULATION COMPLETED] Summary:
355.9s 4555 - Total control steps: 10
355.9s 4556 - Total reward: -0.40
355.9s 4557 - Avg step time: 2.107s (device=gpu)
355.9s 4558 - Simulated time: 600.0s / 600.0s
355.9s 4559 - Wallclock time: 21.1s
355.9s 4560 - Speed ratio: 28.48x real-time
355.9s 4561 
355.9s 4562 2025-10-11 07:01:25 - INFO - run_control_simulation:455 - Returning 10 state snapshots
355.9s 4563 2025-10-11 07:01:25 - INFO - run_performance_comparison:724 - Baseline states copied: 10 snapshots
355.9s 4564 2025-10-11 07:01:25 - INFO - run_performance_comparison:725 - Baseline FIRST state hash: 515523449572979520
355.9s 4565 2025-10-11 07:01:25 - INFO - run_performance_comparison:726 - Baseline LAST state hash: -2048612247790917129
355.9s 4566 2025-10-11 07:01:25 - INFO - run_performance_comparison:727 - Baseline first state sample: rho_m[10:15]=[1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
355.9s 4567 1.37165472e-05]
355.9s 4568 2025-10-11 07:01:25 - INFO - run_performance_comparison:728 - Baseline last state sample: rho_m[10:15]=[1.37162463e-05 1.37158900e-05 1.37157720e-05 1.37157329e-05
355.9s 4569 1.37157199e-05]
355.9s 4570 2025-10-11 07:01:25 - INFO - evaluate_traffic_performance:469 - Evaluating performance with 10 state snapshots
355.9s 4571 2025-10-11 07:01:25 - INFO - evaluate_traffic_performance:470 -   HASH CHECK - first=515523449572979520, last=-2048612247790917129
355.9s 4572 2025-10-11 07:01:25 - INFO - evaluate_traffic_performance:479 - First state sample - rho_m[10:15]=[1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
355.9s 4573 1.37165472e-05], w_m[10:15]=[19.44133062 19.441761   19.44181657 19.44170663 19.44147774]
355.9s 4574 2025-10-11 07:01:25 - INFO - evaluate_traffic_performance:481 - Last state sample - rho_m[10:15]=[1.37162463e-05 1.37158900e-05 1.37157720e-05 1.37157329e-05
355.9s 4575 1.37157199e-05], w_m[10:15]=[19.44149097 19.44199992 19.44216842 19.44222426 19.4422428 ]
355.9s 4576 2025-10-11 07:01:25 - INFO - evaluate_traffic_performance:535 - Calculated metrics: flow=33.685560, efficiency=5.389690, delay=-179.85s
355.9s 4577 Running RL controller...
355.9s 4578 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
355.9s 4579 [INFO] Chargement du modèle RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
355.9s 4580 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
355.9s 4581 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
355.9s 4582 2025-10-11 07:01:25 - INFO - run_control_simulation:285 - ================================================================================
355.9s 4583 2025-10-11 07:01:25 - INFO - run_control_simulation:286 - Starting run_control_simulation:
355.9s 4584 2025-10-11 07:01:25 - INFO - run_control_simulation:287 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
355.9s 4585 2025-10-11 07:01:25 - INFO - run_control_simulation:288 -   - duration: 600.0s
355.9s 4586 2025-10-11 07:01:25 - INFO - run_control_simulation:289 -   - control_interval: 60.0s
355.9s 4587 2025-10-11 07:01:25 - INFO - run_control_simulation:290 -   - device: gpu
355.9s 4588 2025-10-11 07:01:25 - INFO - run_control_simulation:291 -   - controller: RLController
355.9s 4589 2025-10-11 07:01:25 - INFO - run_control_simulation:292 -   - max_control_steps: 11
355.9s 4590 2025-10-11 07:01:25 - INFO - run_control_simulation:293 - ================================================================================
355.9s 4591 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
355.9s 4592 2025-10-11 07:01:25 - INFO - run_control_simulation:298 - Creating TrafficSignalEnvDirect instance...
355.9s 4593 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
355.9s 4594 Using device: gpu
355.9s 4595 DEBUG PARAMS: Reading K_m_kmh = 10.0
355.9s 4596 DEBUG PARAMS: Reading K_c_kmh = 15.0
355.9s 4597 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
355.9s 4598 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
355.9s 4599 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
355.9s 4600 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
355.9s 4601 Loading road quality type: uniform
355.9s 4602 Uniform road quality value: 2
355.9s 4603 Road quality loaded.
355.9s 4604 Initial state created.
355.9s 4605 Transferring initial state and road quality to GPU...
355.9s 4606 GPU data transfer complete.
355.9s 4607 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
355.9s 4608 Initial boundary conditions applied.
355.9s 4609 TrafficSignalEnvDirect initialized:
355.9s 4610 Decision interval: 60.0s
355.9s 4611 Observation segments: 6
355.9s 4612 Observation space: (26,)
355.9s 4613 Action space: 2
355.9s 4614 Device: gpu
355.9s 4615 2025-10-11 07:01:26 - INFO - run_control_simulation:313 - TrafficSignalEnvDirect created successfully
355.9s 4616 2025-10-11 07:01:26 - INFO - run_control_simulation:314 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
355.9s 4617 [INFO] Calling env.reset()...
355.9s 4618 2025-10-11 07:01:26 - INFO - run_control_simulation:330 - Calling env.reset()...
355.9s 4619 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
355.9s 4620 Using device: gpu
355.9s 4621 DEBUG PARAMS: Reading K_m_kmh = 10.0
355.9s 4622 DEBUG PARAMS: Reading K_c_kmh = 15.0
355.9s 4623 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
355.9s 4624 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
355.9s 4625 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
355.9s 4626 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
355.9s 4627 Loading road quality type: uniform
355.9s 4628 Uniform road quality value: 2
355.9s 4629 Road quality loaded.
355.9s 4630 Initial state created.
355.9s 4631 Transferring initial state and road quality to GPU...
355.9s 4632 GPU data transfer complete.
355.9s 4633 DEBUG BC Init: Calculated initial_equilibrium_state = [0.08, 12.0, 0.1, 10.0]
355.9s 4634 Initial boundary conditions applied.
355.9s 4635 [BC UPDATE] left → phase 0 RED (reduced inflow)
355.9s 4636 └─ Inflow state: rho_m=0.0800, w_m=6.0, rho_c=0.1000, w_c=5.0
355.9s 4637 2025-10-11 07:01:26 - INFO - run_control_simulation:332 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
355.9s 4638 2025-10-11 07:01:26 - INFO - run_control_simulation:336 - INITIAL STATE shape: (4, 104), dtype: float64
355.9s 4639 2025-10-11 07:01:26 - INFO - run_control_simulation:337 - INITIAL STATE statistics: mean=5.467747e+00, std=5.479526e+00, min=8.000000e-05, max=1.200000e+01
355.9s 4640 [INFO] Starting simulation loop (max 11 control steps)
355.9s 4641 2025-10-11 07:01:26 - INFO - run_control_simulation:353 - Starting simulation loop - max 11 control steps
355.9s 4642 2025-10-11 07:01:26 - INFO - run_control_simulation:367 - ================================================================================
355.9s 4643 2025-10-11 07:01:26 - INFO - run_control_simulation:368 - STEP 0 START:
355.9s 4644 2025-10-11 07:01:26 - INFO - run_control_simulation:369 -   Controller: RLController
355.9s 4645 2025-10-11 07:01:26 - INFO - run_control_simulation:370 -   Action: 1.000000
355.9s 4646 2025-10-11 07:01:26 - INFO - run_control_simulation:371 -   Simulation time: 0.00s
355.9s 4647 [BC UPDATE] left → phase 1 GREEN (normal inflow)
355.9s 4648 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
355.9s 4649 Running simulation until t = 60.00 s, outputting every 60.00 s
356.4s 4650 [PROGRESS] Step 50: t=16.27/60.00s (27.1%) | dt=0.2694s
356.6s 4651 [WARNING] Automatic CFL correction applied (count: 25100):
356.6s 4652 Calculated CFL: 0.800 > Limit: 0.500
356.6s 4653 Original dt: 4.178347e-01 s
356.6s 4654 Corrected dt: 2.611467e-01 s
356.6s 4655 Correction factor: 1.6x
356.6s 4656 Max wave speed detected: 19.15 m/s
356.8s 4657 [PROGRESS] Step 100: t=29.36/60.00s (48.9%) | dt=0.2584s
357.3s 4658 [PROGRESS] Step 150: t=42.25/60.00s (70.4%) | dt=0.2573s
357.6s 4659 [WARNING] Automatic CFL correction applied (count: 25200):
357.6s 4660 Calculated CFL: 0.800 > Limit: 0.500
357.6s 4661 Original dt: 4.115457e-01 s
357.6s 4662 Corrected dt: 2.572161e-01 s
357.6s 4663 Correction factor: 1.6x
357.6s 4664 Max wave speed detected: 19.44 m/s
357.8s 4665 [PROGRESS] Step 200: t=55.11/60.00s (91.8%) | dt=0.2572s
358.0s 4666 Stored output at t = 60.0000 s (Step 220)
358.0s 4667 
358.0s 4668 Simulation finished at t = 60.0000 s after 220 steps.
358.0s 4669 Total runtime: 2.08 seconds.
358.0s 4670 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.80s/s]Running Simulation: 100%|██████████| 60.0/60.0 [00:02<00:00, 28.80s/s]
358.0s 4671 2025-10-11 07:01:28 - INFO - run_control_simulation:383 -   Reward: -0.089743
358.0s 4672 2025-10-11 07:01:28 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
358.0s 4673 2025-10-11 07:01:28 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
358.0s 4674 2025-10-11 07:01:28 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
358.0s 4675 2025-10-11 07:01:28 - INFO - run_control_simulation:402 -     Diff statistics: mean=2.319017e+00, max=8.666667e+00, std=2.569328e+00
358.0s 4676 2025-10-11 07:01:28 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.048525, rho_c=0.070075
358.0s 4677 2025-10-11 07:01:28 - INFO - run_control_simulation:413 -     Mean velocities: w_m=11.216783, w_c=9.679220
358.0s 4678 2025-10-11 07:01:28 - INFO - run_control_simulation:417 -   State hash: 515523449572979520
358.0s 4679 2025-10-11 07:01:28 - INFO - run_control_simulation:419 - ================================================================================
358.0s 4680 [STEP 1/11] action=1.0000, reward=-0.0897, t=60.0s, state_diff=2.319017e+00
358.0s 4681 2025-10-11 07:01:28 - INFO - run_control_simulation:367 - ================================================================================
358.0s 4682 2025-10-11 07:01:28 - INFO - run_control_simulation:368 - STEP 1 START:
358.0s 4683 2025-10-11 07:01:28 - INFO - run_control_simulation:369 -   Controller: RLController
358.0s 4684 2025-10-11 07:01:28 - INFO - run_control_simulation:370 -   Action: 1.000000
358.0s 4685 2025-10-11 07:01:28 - INFO - run_control_simulation:371 -   Simulation time: 60.00s
358.0s 4686 [BC UPDATE] left → phase 1 GREEN (normal inflow)
358.0s 4687 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
358.0s 4688 Running simulation until t = 120.00 s, outputting every 60.00 s
358.3s 4689 [PROGRESS] Step 250: t=67.72/120.00s (56.4%) | dt=0.2572s
358.5s 4690 [WARNING] Automatic CFL correction applied (count: 25300):
358.5s 4691 Calculated CFL: 0.800 > Limit: 0.500
358.5s 4692 Original dt: 4.114759e-01 s
358.5s 4693 Corrected dt: 2.571724e-01 s
358.5s 4694 Correction factor: 1.6x
358.5s 4695 Max wave speed detected: 19.44 m/s
358.7s 4696 [PROGRESS] Step 300: t=80.57/120.00s (67.1%) | dt=0.2572s
359.2s 4697 [PROGRESS] Step 350: t=93.43/120.00s (77.9%) | dt=0.2572s
359.4s 4698 [WARNING] Automatic CFL correction applied (count: 25400):
359.4s 4699 Calculated CFL: 0.800 > Limit: 0.500
359.4s 4700 Original dt: 4.114750e-01 s
359.4s 4701 Corrected dt: 2.571719e-01 s
359.4s 4702 Correction factor: 1.6x
359.4s 4703 Max wave speed detected: 19.44 m/s
359.6s 4704 [PROGRESS] Step 400: t=106.29/120.00s (88.6%) | dt=0.2572s
360.1s 4705 [PROGRESS] Step 450: t=119.15/120.00s (99.3%) | dt=0.2572s
360.1s 4706 Stored output at t = 120.0000 s (Step 454)
360.1s 4707 
360.1s 4708 Running Simulation:  50%|█████     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.77s/s]Running Simulation: 100%|██████████| 120.0/120.0 [00:02<00:00, 28.77s/s]
360.1s 4709 Simulation finished at t = 120.0000 s after 454 steps.
360.1s 4710 Total runtime: 2.09 seconds.
360.1s 4711 2025-10-11 07:01:30 - INFO - run_control_simulation:383 -   Reward: -0.089744
360.1s 4712 2025-10-11 07:01:30 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
360.1s 4713 2025-10-11 07:01:30 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
360.1s 4714 2025-10-11 07:01:30 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
360.1s 4715 2025-10-11 07:01:30 - INFO - run_control_simulation:402 -     Diff statistics: mean=1.731542e+00, max=1.206300e+01, std=3.693782e+00
360.1s 4716 2025-10-11 07:01:30 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.018797, rho_c=0.043161
360.1s 4717 2025-10-11 07:01:30 - INFO - run_control_simulation:413 -     Mean velocities: w_m=14.987955, w_c=12.761657
360.1s 4718 2025-10-11 07:01:30 - INFO - run_control_simulation:417 -   State hash: -7306390826449926476
360.1s 4719 2025-10-11 07:01:30 - INFO - run_control_simulation:419 - ================================================================================
360.1s 4720 [STEP 2/11] action=1.0000, reward=-0.0897, t=120.0s, state_diff=1.731542e+00
360.1s 4721 2025-10-11 07:01:30 - INFO - run_control_simulation:367 - ================================================================================
360.1s 4722 2025-10-11 07:01:30 - INFO - run_control_simulation:368 - STEP 2 START:
360.1s 4723 2025-10-11 07:01:30 - INFO - run_control_simulation:369 -   Controller: RLController
360.1s 4724 2025-10-11 07:01:30 - INFO - run_control_simulation:370 -   Action: 1.000000
360.1s 4725 2025-10-11 07:01:30 - INFO - run_control_simulation:371 -   Simulation time: 120.00s
360.1s 4726 [BC UPDATE] left → phase 1 GREEN (normal inflow)
360.1s 4727 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
360.1s 4728 Running simulation until t = 180.00 s, outputting every 60.00 s
360.3s 4729 [WARNING] Automatic CFL correction applied (count: 25500):
360.3s 4730 Calculated CFL: 0.800 > Limit: 0.500
360.3s 4731 Original dt: 4.114750e-01 s
360.3s 4732 Corrected dt: 2.571719e-01 s
360.3s 4733 Correction factor: 1.6x
360.3s 4734 Max wave speed detected: 19.44 m/s
360.5s 4735 [PROGRESS] Step 500: t=131.83/180.00s (73.2%) | dt=0.2572s
361.0s 4736 [PROGRESS] Step 550: t=144.69/180.00s (80.4%) | dt=0.2572s
361.2s 4737 [WARNING] Automatic CFL correction applied (count: 25600):
361.2s 4738 Calculated CFL: 0.800 > Limit: 0.500
361.2s 4739 Original dt: 4.114750e-01 s
361.2s 4740 Corrected dt: 2.571719e-01 s
361.2s 4741 Correction factor: 1.6x
361.2s 4742 Max wave speed detected: 19.44 m/s
361.5s 4743 [PROGRESS] Step 600: t=157.55/180.00s (87.5%) | dt=0.2572s
361.9s 4744 [PROGRESS] Step 650: t=170.41/180.00s (94.7%) | dt=0.2572s
362.1s 4745 [WARNING] Automatic CFL correction applied (count: 25700):
362.1s 4746 Calculated CFL: 0.800 > Limit: 0.500
362.1s 4747 Original dt: 4.114750e-01 s
362.1s 4748 Corrected dt: 2.571719e-01 s
362.1s 4749 Correction factor: 1.6x
362.1s 4750 Max wave speed detected: 19.44 m/s
362.3s 4751 Stored output at t = 180.0000 s (Step 688)
362.3s 4752 Running Simulation:  67%|██████▋   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.00s/s]Running Simulation: 100%|██████████| 180.0/180.0 [00:02<00:00, 28.00s/s]
362.3s 4753 
362.3s 4754 Simulation finished at t = 180.0000 s after 688 steps.
362.3s 4755 Total runtime: 2.14 seconds.
362.3s 4756 2025-10-11 07:01:32 - INFO - run_control_simulation:383 -   Reward: -0.089744
362.3s 4757 2025-10-11 07:01:32 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
362.3s 4758 2025-10-11 07:01:32 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
362.3s 4759 2025-10-11 07:01:32 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
362.3s 4760 2025-10-11 07:01:32 - INFO - run_control_simulation:402 -     Diff statistics: mean=1.713185e+00, max=1.201906e+01, std=3.674943e+00
362.3s 4761 2025-10-11 07:01:32 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001555, rho_c=0.004287
362.3s 4762 2025-10-11 07:01:32 - INFO - run_control_simulation:413 -     Mean velocities: w_m=18.743570, w_c=15.802665
362.3s 4763 2025-10-11 07:01:32 - INFO - run_control_simulation:417 -   State hash: -5943357550333840104
362.3s 4764 2025-10-11 07:01:32 - INFO - run_control_simulation:419 - ================================================================================
362.3s 4765 [STEP 3/11] action=1.0000, reward=-0.0897, t=180.0s, state_diff=1.713185e+00
362.3s 4766 2025-10-11 07:01:32 - INFO - run_control_simulation:367 - ================================================================================
362.3s 4767 2025-10-11 07:01:32 - INFO - run_control_simulation:368 - STEP 3 START:
362.3s 4768 2025-10-11 07:01:32 - INFO - run_control_simulation:369 -   Controller: RLController
362.3s 4769 2025-10-11 07:01:32 - INFO - run_control_simulation:370 -   Action: 1.000000
362.3s 4770 2025-10-11 07:01:32 - INFO - run_control_simulation:371 -   Simulation time: 180.00s
362.3s 4771 [BC UPDATE] left → phase 1 GREEN (normal inflow)
362.3s 4772 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
362.3s 4773 Running simulation until t = 240.00 s, outputting every 60.00 s
362.4s 4774 [PROGRESS] Step 700: t=183.09/240.00s (76.3%) | dt=0.2572s
362.8s 4775 [PROGRESS] Step 750: t=195.94/240.00s (81.6%) | dt=0.2572s
363.0s 4776 [WARNING] Automatic CFL correction applied (count: 25800):
363.0s 4777 Calculated CFL: 0.800 > Limit: 0.500
363.0s 4778 Original dt: 4.114750e-01 s
363.0s 4779 Corrected dt: 2.571719e-01 s
363.0s 4780 Correction factor: 1.6x
363.0s 4781 Max wave speed detected: 19.44 m/s
363.3s 4782 [PROGRESS] Step 800: t=208.80/240.00s (87.0%) | dt=0.2572s
363.7s 4783 [PROGRESS] Step 850: t=221.66/240.00s (92.4%) | dt=0.2572s
363.9s 4784 [WARNING] Automatic CFL correction applied (count: 25900):
363.9s 4785 Calculated CFL: 0.800 > Limit: 0.500
363.9s 4786 Original dt: 4.114750e-01 s
363.9s 4787 Corrected dt: 2.571719e-01 s
363.9s 4788 Correction factor: 1.6x
363.9s 4789 Max wave speed detected: 19.44 m/s
364.2s 4790 [PROGRESS] Step 900: t=234.52/240.00s (97.7%) | dt=0.2572s
364.4s 4791 Stored output at t = 240.0000 s (Step 922)
364.4s 4792 
364.4s 4793 Simulation finished at t = 240.0000 s after 922 steps.
364.4s 4794 Total runtime: 2.12 seconds.
364.4s 4795 Running Simulation:  75%|███████▌  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.24s/s]Running Simulation: 100%|██████████| 240.0/240.0 [00:02<00:00, 28.24s/s]
364.4s 4796 2025-10-11 07:01:34 - INFO - run_control_simulation:383 -   Reward: -0.089744
364.4s 4797 2025-10-11 07:01:34 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
364.4s 4798 2025-10-11 07:01:34 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
364.4s 4799 2025-10-11 07:01:34 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
364.4s 4800 2025-10-11 07:01:34 - INFO - run_control_simulation:402 -     Diff statistics: mean=2.705290e-01, max=9.644774e+00, std=1.302093e+00
364.4s 4801 2025-10-11 07:01:34 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
364.4s 4802 2025-10-11 07:01:34 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403336
364.4s 4803 2025-10-11 07:01:34 - INFO - run_control_simulation:417 -   State hash: 4805708831056837438
364.4s 4804 2025-10-11 07:01:34 - INFO - run_control_simulation:419 - ================================================================================
364.4s 4805 [STEP 4/11] action=1.0000, reward=-0.0897, t=240.0s, state_diff=2.705290e-01
364.4s 4806 2025-10-11 07:01:34 - INFO - run_control_simulation:367 - ================================================================================
364.4s 4807 2025-10-11 07:01:34 - INFO - run_control_simulation:368 - STEP 4 START:
364.4s 4808 2025-10-11 07:01:34 - INFO - run_control_simulation:369 -   Controller: RLController
364.4s 4809 2025-10-11 07:01:34 - INFO - run_control_simulation:370 -   Action: 1.000000
364.4s 4810 2025-10-11 07:01:34 - INFO - run_control_simulation:371 -   Simulation time: 240.00s
364.4s 4811 [BC UPDATE] left → phase 1 GREEN (normal inflow)
364.4s 4812 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
364.4s 4813 Running simulation until t = 300.00 s, outputting every 60.00 s
364.6s 4814 [PROGRESS] Step 950: t=247.20/300.00s (82.4%) | dt=0.2572s
364.9s 4815 [WARNING] Automatic CFL correction applied (count: 26000):
364.9s 4816 Calculated CFL: 0.800 > Limit: 0.500
364.9s 4817 Original dt: 4.114750e-01 s
364.9s 4818 Corrected dt: 2.571719e-01 s
364.9s 4819 Correction factor: 1.6x
364.9s 4820 Max wave speed detected: 19.44 m/s
365.1s 4821 [PROGRESS] Step 1000: t=260.06/300.00s (86.7%) | dt=0.2572s
365.5s 4822 [PROGRESS] Step 1050: t=272.92/300.00s (91.0%) | dt=0.2572s
365.8s 4823 [WARNING] Automatic CFL correction applied (count: 26100):
365.8s 4824 Calculated CFL: 0.800 > Limit: 0.500
365.8s 4825 Original dt: 4.114750e-01 s
365.8s 4826 Corrected dt: 2.571719e-01 s
365.8s 4827 Correction factor: 1.6x
365.8s 4828 Max wave speed detected: 19.44 m/s
366.0s 4829 [PROGRESS] Step 1100: t=285.78/300.00s (95.3%) | dt=0.2572s
366.5s 4830 [PROGRESS] Step 1150: t=298.64/300.00s (99.5%) | dt=0.2572s
366.5s 4831 Stored output at t = 300.0000 s (Step 1156)
366.5s 4832 
366.5s 4833 Simulation finished at t = 300.0000 s after 1156 steps.
366.5s 4834 Total runtime: 2.15 seconds.
366.5s 4835 Running Simulation:  80%|████████  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 27.95s/s]Running Simulation: 100%|██████████| 300.0/300.0 [00:02<00:00, 27.95s/s]
366.5s 4836 2025-10-11 07:01:36 - INFO - run_control_simulation:383 -   Reward: -0.089744
366.5s 4837 2025-10-11 07:01:36 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
366.5s 4838 2025-10-11 07:01:36 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
366.5s 4839 2025-10-11 07:01:36 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
366.5s 4840 2025-10-11 07:01:36 - INFO - run_control_simulation:402 -     Diff statistics: mean=1.132558e-04, max=6.783560e-03, std=7.135300e-04
366.5s 4841 2025-10-11 07:01:36 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
366.5s 4842 2025-10-11 07:01:36 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
366.5s 4843 2025-10-11 07:01:36 - INFO - run_control_simulation:417 -   State hash: 4402679159049512588
366.5s 4844 2025-10-11 07:01:36 - INFO - run_control_simulation:419 - ================================================================================
366.5s 4845 [STEP 5/11] action=1.0000, reward=-0.0897, t=300.0s, state_diff=1.132558e-04
366.5s 4846 2025-10-11 07:01:36 - INFO - run_control_simulation:367 - ================================================================================
366.5s 4847 2025-10-11 07:01:36 - INFO - run_control_simulation:368 - STEP 5 START:
366.5s 4848 2025-10-11 07:01:36 - INFO - run_control_simulation:369 -   Controller: RLController
366.5s 4849 2025-10-11 07:01:36 - INFO - run_control_simulation:370 -   Action: 1.000000
366.5s 4850 2025-10-11 07:01:36 - INFO - run_control_simulation:371 -   Simulation time: 300.00s
366.5s 4851 [BC UPDATE] left → phase 1 GREEN (normal inflow)
366.5s 4852 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
366.5s 4853 Running simulation until t = 360.00 s, outputting every 60.00 s
366.7s 4854 [WARNING] Automatic CFL correction applied (count: 26200):
366.7s 4855 Calculated CFL: 0.800 > Limit: 0.500
366.7s 4856 Original dt: 4.114750e-01 s
366.7s 4857 Corrected dt: 2.571719e-01 s
366.7s 4858 Correction factor: 1.6x
366.7s 4859 Max wave speed detected: 19.44 m/s
366.9s 4860 [PROGRESS] Step 1200: t=311.32/360.00s (86.5%) | dt=0.2572s
367.4s 4861 [PROGRESS] Step 1250: t=324.17/360.00s (90.0%) | dt=0.2572s
367.6s 4862 [WARNING] Automatic CFL correction applied (count: 26300):
367.6s 4863 Calculated CFL: 0.800 > Limit: 0.500
367.6s 4864 Original dt: 4.114750e-01 s
367.6s 4865 Corrected dt: 2.571719e-01 s
367.6s 4866 Correction factor: 1.6x
367.6s 4867 Max wave speed detected: 19.44 m/s
367.8s 4868 [PROGRESS] Step 1300: t=337.03/360.00s (93.6%) | dt=0.2572s
368.3s 4869 [PROGRESS] Step 1350: t=349.89/360.00s (97.2%) | dt=0.2572s
368.5s 4870 [WARNING] Automatic CFL correction applied (count: 26400):
368.5s 4871 Calculated CFL: 0.800 > Limit: 0.500
368.5s 4872 Original dt: 4.114750e-01 s
368.5s 4873 Corrected dt: 2.571719e-01 s
368.5s 4874 Correction factor: 1.6x
368.5s 4875 Max wave speed detected: 19.44 m/s
368.6s 4876 Stored output at t = 360.0000 s (Step 1390)
368.6s 4877 
368.6s 4878 Running Simulation:  83%|████████▎ | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.63s/s]Running Simulation: 100%|██████████| 360.0/360.0 [00:02<00:00, 28.63s/s]
368.6s 4879 Simulation finished at t = 360.0000 s after 1390 steps.
368.6s 4880 Total runtime: 2.10 seconds.
368.6s 4881 2025-10-11 07:01:38 - INFO - run_control_simulation:383 -   Reward: -0.089744
368.6s 4882 2025-10-11 07:01:38 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
368.6s 4883 2025-10-11 07:01:38 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
368.6s 4884 2025-10-11 07:01:38 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
368.6s 4885 2025-10-11 07:01:38 - INFO - run_control_simulation:402 -     Diff statistics: mean=8.103935e-08, max=4.857589e-06, std=5.109573e-07
368.6s 4886 2025-10-11 07:01:38 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
368.6s 4887 2025-10-11 07:01:38 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
368.6s 4888 2025-10-11 07:01:38 - INFO - run_control_simulation:417 -   State hash: -1193561054279021194
368.6s 4889 2025-10-11 07:01:38 - INFO - run_control_simulation:419 - ================================================================================
368.6s 4890 [STEP 6/11] action=1.0000, reward=-0.0897, t=360.0s, state_diff=8.103935e-08
368.6s 4891 2025-10-11 07:01:38 - INFO - run_control_simulation:367 - ================================================================================
368.6s 4892 2025-10-11 07:01:38 - INFO - run_control_simulation:368 - STEP 6 START:
368.6s 4893 2025-10-11 07:01:38 - INFO - run_control_simulation:369 -   Controller: RLController
368.6s 4894 2025-10-11 07:01:38 - INFO - run_control_simulation:370 -   Action: 1.000000
368.6s 4895 2025-10-11 07:01:38 - INFO - run_control_simulation:371 -   Simulation time: 360.00s
368.6s 4896 [BC UPDATE] left → phase 1 GREEN (normal inflow)
368.6s 4897 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
368.6s 4898 Running simulation until t = 420.00 s, outputting every 60.00 s
368.7s 4899 [PROGRESS] Step 1400: t=362.57/420.00s (86.3%) | dt=0.2572s
369.2s 4900 [PROGRESS] Step 1450: t=375.43/420.00s (89.4%) | dt=0.2572s
369.4s 4901 [WARNING] Automatic CFL correction applied (count: 26500):
369.4s 4902 Calculated CFL: 0.800 > Limit: 0.500
369.4s 4903 Original dt: 4.114750e-01 s
369.4s 4904 Corrected dt: 2.571719e-01 s
369.4s 4905 Correction factor: 1.6x
369.4s 4906 Max wave speed detected: 19.44 m/s
369.6s 4907 [PROGRESS] Step 1500: t=388.29/420.00s (92.4%) | dt=0.2572s
370.1s 4908 [PROGRESS] Step 1550: t=401.15/420.00s (95.5%) | dt=0.2572s
370.3s 4909 [WARNING] Automatic CFL correction applied (count: 26600):
370.3s 4910 Calculated CFL: 0.800 > Limit: 0.500
370.3s 4911 Original dt: 4.114750e-01 s
370.3s 4912 Corrected dt: 2.571719e-01 s
370.3s 4913 Correction factor: 1.6x
370.3s 4914 Max wave speed detected: 19.44 m/s
370.5s 4915 [PROGRESS] Step 1600: t=414.01/420.00s (98.6%) | dt=0.2572s
370.7s 4916 Stored output at t = 420.0000 s (Step 1624)
370.7s 4917 
370.7s 4918 Running Simulation:  86%|████████▌ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.62s/s]Running Simulation: 100%|██████████| 420.0/420.0 [00:02<00:00, 28.62s/s]
370.7s 4919 Simulation finished at t = 420.0000 s after 1624 steps.
370.7s 4920 Total runtime: 2.10 seconds.
370.7s 4921 2025-10-11 07:01:40 - INFO - run_control_simulation:383 -   Reward: -0.089744
370.7s 4922 2025-10-11 07:01:40 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
370.7s 4923 2025-10-11 07:01:40 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
370.7s 4924 2025-10-11 07:01:40 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
370.7s 4925 2025-10-11 07:01:40 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.803585e-11, max=3.478490e-09, std=3.658944e-10
370.7s 4926 2025-10-11 07:01:40 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
370.7s 4927 2025-10-11 07:01:40 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
370.7s 4928 2025-10-11 07:01:40 - INFO - run_control_simulation:417 -   State hash: -4153833715237115081
370.7s 4929 2025-10-11 07:01:40 - INFO - run_control_simulation:419 - ================================================================================
370.7s 4930 [STEP 7/11] action=1.0000, reward=-0.0897, t=420.0s, state_diff=5.803585e-11
370.7s 4931 2025-10-11 07:01:40 - INFO - run_control_simulation:367 - ================================================================================
370.7s 4932 2025-10-11 07:01:40 - INFO - run_control_simulation:368 - STEP 7 START:
370.7s 4933 2025-10-11 07:01:40 - INFO - run_control_simulation:369 -   Controller: RLController
370.7s 4934 2025-10-11 07:01:40 - INFO - run_control_simulation:370 -   Action: 1.000000
370.7s 4935 2025-10-11 07:01:40 - INFO - run_control_simulation:371 -   Simulation time: 420.00s
370.7s 4936 [BC UPDATE] left → phase 1 GREEN (normal inflow)
370.7s 4937 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
370.7s 4938 Running simulation until t = 480.00 s, outputting every 60.00 s
371.0s 4939 [PROGRESS] Step 1650: t=426.69/480.00s (88.9%) | dt=0.2572s
371.2s 4940 [WARNING] Automatic CFL correction applied (count: 26700):
371.2s 4941 Calculated CFL: 0.800 > Limit: 0.500
371.2s 4942 Original dt: 4.114750e-01 s
371.2s 4943 Corrected dt: 2.571719e-01 s
371.2s 4944 Correction factor: 1.6x
371.2s 4945 Max wave speed detected: 19.44 m/s
371.4s 4946 [PROGRESS] Step 1700: t=439.55/480.00s (91.6%) | dt=0.2572s
371.9s 4947 [PROGRESS] Step 1750: t=452.40/480.00s (94.3%) | dt=0.2572s
372.1s 4948 [WARNING] Automatic CFL correction applied (count: 26800):
372.1s 4949 Calculated CFL: 0.800 > Limit: 0.500
372.1s 4950 Original dt: 4.114750e-01 s
372.1s 4951 Corrected dt: 2.571719e-01 s
372.1s 4952 Correction factor: 1.6x
372.1s 4953 Max wave speed detected: 19.44 m/s
372.3s 4954 [PROGRESS] Step 1800: t=465.26/480.00s (96.9%) | dt=0.2572s
372.8s 4955 [PROGRESS] Step 1850: t=478.12/480.00s (99.6%) | dt=0.2572s
372.9s 4956 Stored output at t = 480.0000 s (Step 1858)
372.9s 4957 Running Simulation:  88%|████████▊ | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.40s/s]Running Simulation: 100%|██████████| 480.0/480.0 [00:02<00:00, 28.40s/s]
372.9s 4958 
372.9s 4959 Simulation finished at t = 480.0000 s after 1858 steps.
372.9s 4960 Total runtime: 2.11 seconds.
372.9s 4961 2025-10-11 07:01:42 - INFO - run_control_simulation:383 -   Reward: -0.089744
372.9s 4962 2025-10-11 07:01:42 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
372.9s 4963 2025-10-11 07:01:42 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
372.9s 4964 2025-10-11 07:01:42 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
372.9s 4965 2025-10-11 07:01:42 - INFO - run_control_simulation:402 -     Diff statistics: mean=4.188536e-14, max=2.501110e-12, std=2.629420e-13
372.9s 4966 2025-10-11 07:01:42 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
372.9s 4967 2025-10-11 07:01:42 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
372.9s 4968 2025-10-11 07:01:42 - INFO - run_control_simulation:417 -   State hash: 332413424154743299
372.9s 4969 2025-10-11 07:01:42 - INFO - run_control_simulation:419 - ================================================================================
372.9s 4970 [STEP 8/11] action=1.0000, reward=-0.0897, t=480.0s, state_diff=4.188536e-14
372.9s 4971 2025-10-11 07:01:42 - INFO - run_control_simulation:367 - ================================================================================
372.9s 4972 2025-10-11 07:01:42 - INFO - run_control_simulation:368 - STEP 8 START:
372.9s 4973 2025-10-11 07:01:42 - INFO - run_control_simulation:369 -   Controller: RLController
372.9s 4974 2025-10-11 07:01:42 - INFO - run_control_simulation:370 -   Action: 1.000000
372.9s 4975 2025-10-11 07:01:42 - INFO - run_control_simulation:371 -   Simulation time: 480.00s
372.9s 4976 [BC UPDATE] left → phase 1 GREEN (normal inflow)
372.9s 4977 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
372.9s 4978 Running simulation until t = 540.00 s, outputting every 60.00 s
373.0s 4979 [WARNING] Automatic CFL correction applied (count: 26900):
373.0s 4980 Calculated CFL: 0.800 > Limit: 0.500
373.0s 4981 Original dt: 4.114750e-01 s
373.0s 4982 Corrected dt: 2.571719e-01 s
373.0s 4983 Correction factor: 1.6x
373.0s 4984 Max wave speed detected: 19.44 m/s
373.2s 4985 [PROGRESS] Step 1900: t=490.80/540.00s (90.9%) | dt=0.2572s
373.7s 4986 [PROGRESS] Step 1950: t=503.66/540.00s (93.3%) | dt=0.2572s
373.9s 4987 [WARNING] Automatic CFL correction applied (count: 27000):
373.9s 4988 Calculated CFL: 0.800 > Limit: 0.500
373.9s 4989 Original dt: 4.114750e-01 s
373.9s 4990 Corrected dt: 2.571719e-01 s
373.9s 4991 Correction factor: 1.6x
373.9s 4992 Max wave speed detected: 19.44 m/s
374.1s 4993 [PROGRESS] Step 2000: t=516.52/540.00s (95.7%) | dt=0.2572s
374.6s 4994 [PROGRESS] Step 2050: t=529.38/540.00s (98.0%) | dt=0.2572s
374.8s 4995 [WARNING] Automatic CFL correction applied (count: 27100):
374.8s 4996 Calculated CFL: 0.800 > Limit: 0.500
374.8s 4997 Original dt: 4.114750e-01 s
374.8s 4998 Corrected dt: 2.571719e-01 s
374.8s 4999 Correction factor: 1.6x
374.8s 5000 Max wave speed detected: 19.44 m/s
375.0s 5001 Stored output at t = 540.0000 s (Step 2092)
375.0s 5002 
375.0s 5003 Simulation finished at t = 540.0000 s after 2092 steps.
375.0s 5004 Total runtime: 2.09 seconds.
375.0s 5005 Running Simulation:  89%|████████▉ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.72s/s]Running Simulation: 100%|██████████| 540.0/540.0 [00:02<00:00, 28.72s/s]
375.0s 5006 2025-10-11 07:01:45 - INFO - run_control_simulation:383 -   Reward: -0.089744
375.0s 5007 2025-10-11 07:01:45 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: False
375.0s 5008 2025-10-11 07:01:45 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
375.0s 5009 2025-10-11 07:01:45 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
375.0s 5010 2025-10-11 07:01:45 - INFO - run_control_simulation:402 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
375.0s 5011 2025-10-11 07:01:45 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
375.0s 5012 2025-10-11 07:01:45 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
375.0s 5013 2025-10-11 07:01:45 - INFO - run_control_simulation:417 -   State hash: 332413424154743299
375.0s 5014 2025-10-11 07:01:45 - INFO - run_control_simulation:419 - ================================================================================
375.0s 5015 [STEP 9/11] action=1.0000, reward=-0.0897, t=540.0s, state_diff=0.000000e+00
375.0s 5016 2025-10-11 07:01:45 - INFO - run_control_simulation:367 - ================================================================================
375.0s 5017 2025-10-11 07:01:45 - INFO - run_control_simulation:368 - STEP 9 START:
375.0s 5018 2025-10-11 07:01:45 - INFO - run_control_simulation:369 -   Controller: RLController
375.0s 5019 2025-10-11 07:01:45 - INFO - run_control_simulation:370 -   Action: 1.000000
375.0s 5020 2025-10-11 07:01:45 - INFO - run_control_simulation:371 -   Simulation time: 540.00s
375.0s 5021 [BC UPDATE] left → phase 1 GREEN (normal inflow)
375.0s 5022 └─ Inflow state: rho_m=0.0800, w_m=12.0, rho_c=0.1000, w_c=10.0
375.0s 5023 Running simulation until t = 600.00 s, outputting every 60.00 s
375.0s 5024 [PROGRESS] Step 2100: t=542.06/600.00s (90.3%) | dt=0.2572s
375.5s 5025 [PROGRESS] Step 2150: t=554.92/600.00s (92.5%) | dt=0.2572s
375.7s 5026 [WARNING] Automatic CFL correction applied (count: 27200):
375.7s 5027 Calculated CFL: 0.800 > Limit: 0.500
375.7s 5028 Original dt: 4.114750e-01 s
375.7s 5029 Corrected dt: 2.571719e-01 s
375.7s 5030 Correction factor: 1.6x
375.7s 5031 Max wave speed detected: 19.44 m/s
375.9s 5032 [PROGRESS] Step 2200: t=567.77/600.00s (94.6%) | dt=0.2572s
376.4s 5033 [PROGRESS] Step 2250: t=580.63/600.00s (96.8%) | dt=0.2572s
376.6s 5034 [WARNING] Automatic CFL correction applied (count: 27300):
376.6s 5035 Calculated CFL: 0.800 > Limit: 0.500
376.6s 5036 Original dt: 4.114750e-01 s
376.6s 5037 Corrected dt: 2.571719e-01 s
376.6s 5038 Correction factor: 1.6x
376.6s 5039 Max wave speed detected: 19.44 m/s
376.8s 5040 [PROGRESS] Step 2300: t=593.49/600.00s (98.9%) | dt=0.2572s
377.0s 5041 Stored output at t = 600.0000 s (Step 2326)
377.0s 5042 Running Simulation:  90%|█████████ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.78s/s]Running Simulation: 100%|██████████| 600.0/600.0 [00:02<00:00, 28.78s/s]
377.0s 5043 
377.0s 5044 Simulation finished at t = 600.0000 s after 2326 steps.
377.0s 5045 Total runtime: 2.09 seconds.
377.0s 5046 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
377.0s 5047 2025-10-11 07:01:47 - INFO - run_control_simulation:383 -   Reward: -0.089744
377.0s 5048 2025-10-11 07:01:47 - INFO - run_control_simulation:384 -   Terminated: False, Truncated: True
377.0s 5049 2025-10-11 07:01:47 - INFO - run_control_simulation:400 -   STATE EVOLUTION:
377.0s 5050 2025-10-11 07:01:47 - INFO - run_control_simulation:401 -     Before shape: (4, 104), After shape: (4, 104)
377.0s 5051 2025-10-11 07:01:47 - INFO - run_control_simulation:402 -     Diff statistics: mean=5.978126e-17, max=7.105427e-15, std=5.043045e-16
377.0s 5052 2025-10-11 07:01:47 - INFO - run_control_simulation:412 -     Mean densities: rho_m=0.001552, rho_c=0.001940
377.0s 5053 2025-10-11 07:01:47 - INFO - run_control_simulation:413 -     Mean velocities: w_m=19.222664, w_c=16.403789
377.0s 5054 2025-10-11 07:01:47 - INFO - run_control_simulation:417 -   State hash: 5145748981927051296
377.0s 5055 2025-10-11 07:01:47 - INFO - run_control_simulation:419 - ================================================================================
377.0s 5056 [STEP 10/11] action=1.0000, reward=-0.0897, t=600.0s, state_diff=5.978126e-17
377.0s 5057 
377.0s 5058 [SIMULATION COMPLETED] Summary:
377.0s 5059 - Total control steps: 10
377.0s 5060 - Total reward: -0.90
377.0s 5061 - Avg step time: 2.111s (device=gpu)
377.0s 5062 - Simulated time: 600.0s / 600.0s
377.0s 5063 - Wallclock time: 21.1s
377.0s 5064 - Speed ratio: 28.42x real-time
377.0s 5065 
377.0s 5066 2025-10-11 07:01:47 - INFO - run_control_simulation:454 -
377.0s 5067 [SIMULATION COMPLETED] Summary:
377.0s 5068 - Total control steps: 10
377.0s 5069 - Total reward: -0.90
377.0s 5070 - Avg step time: 2.111s (device=gpu)
377.0s 5071 - Simulated time: 600.0s / 600.0s
377.0s 5072 - Wallclock time: 21.1s
377.0s 5073 - Speed ratio: 28.42x real-time
377.0s 5074 
377.0s 5075 2025-10-11 07:01:47 - INFO - run_control_simulation:455 - Returning 10 state snapshots
377.0s 5076 2025-10-11 07:01:47 - INFO - run_performance_comparison:761 - RL states copied: 10 snapshots
377.0s 5077 2025-10-11 07:01:47 - INFO - run_performance_comparison:762 - RL FIRST state hash: 515523449572979520
377.0s 5078 2025-10-11 07:01:47 - INFO - run_performance_comparison:763 - RL LAST state hash: 5145748981927051296
377.0s 5079 2025-10-11 07:01:47 - INFO - run_performance_comparison:764 - RL first state sample: rho_m[10:15]=[1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
377.0s 5080 1.37165472e-05]
377.0s 5081 2025-10-11 07:01:47 - INFO - run_performance_comparison:765 - RL last state sample: rho_m[10:15]=[1.37162463e-05 1.37158900e-05 1.37157720e-05 1.37157329e-05
377.0s 5082 1.37157199e-05]
377.0s 5083 2025-10-11 07:01:47 - INFO - evaluate_traffic_performance:469 - Evaluating performance with 10 state snapshots
377.0s 5084 2025-10-11 07:01:47 - INFO - evaluate_traffic_performance:470 -   HASH CHECK - first=515523449572979520, last=5145748981927051296
377.0s 5085 2025-10-11 07:01:47 - INFO - evaluate_traffic_performance:479 - First state sample - rho_m[10:15]=[1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
377.0s 5086 1.37165472e-05], w_m[10:15]=[19.44133062 19.441761   19.44181657 19.44170663 19.44147774]
377.0s 5087 2025-10-11 07:01:47 - INFO - evaluate_traffic_performance:481 - Last state sample - rho_m[10:15]=[1.37162463e-05 1.37158900e-05 1.37157720e-05 1.37157329e-05
377.0s 5088 1.37157199e-05], w_m[10:15]=[19.44149097 19.44199992 19.44216842 19.44222426 19.4422428 ]
377.0s 5089 2025-10-11 07:01:47 - INFO - evaluate_traffic_performance:535 - Calculated metrics: flow=33.685560, efficiency=5.389690, delay=-179.85s
377.0s 5090 2025-10-11 07:01:47 - WARNING - run_performance_comparison:773 - States comparison - Identical: True, baseline_hash=515523449572979520, rl_hash=515523449572979520
377.0s 5091 2025-10-11 07:01:47 - ERROR - run_performance_comparison:777 - BUG CONFIRMED: States are identical despite different simulations!
377.1s 5092 2025-10-11 07:01:47 - ERROR - run_performance_comparison:778 - baseline_states_copy[0] sample: [1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
377.1s 5093 1.37165472e-05]
377.1s 5094 2025-10-11 07:01:47 - ERROR - run_performance_comparison:779 - rl_states_copy[0] sample: [1.37164069e-05 1.37161354e-05 1.37161414e-05 1.37162858e-05
377.1s 5095 1.37165472e-05]
377.1s 5096 2025-10-11 07:01:47 - INFO - run_performance_comparison:782 - Baseline performance: {'total_flow': 33.68556018412094, 'avg_speed': 837226.4381610423, 'avg_density': 0.017380190776388138, 'efficiency': 5.38968962945935, 'delay': -179.85014300792722, 'throughput': 168427.8009206047}
377.1s 5097 2025-10-11 07:01:47 - INFO - run_performance_comparison:783 - RL performance: {'total_flow': 33.68556018412094, 'avg_speed': 837226.4381610423, 'avg_density': 0.017380190776388138, 'efficiency': 5.38968962945935, 'delay': -179.85014300792722, 'throughput': 168427.8009206047}
377.1s 5098 2025-10-11 07:01:47 - INFO - run_performance_comparison:791 - Flow improvement: 0.000%
377.1s 5099 2025-10-11 07:01:47 - INFO - run_performance_comparison:792 - Efficiency improvement: 0.000%
377.1s 5100 2025-10-11 07:01:47 - INFO - run_performance_comparison:793 - Delay reduction: -0.000%
377.1s 5101 Flow improvement: 0.0%
377.1s 5102 Efficiency improvement: 0.0%
377.1s 5103 Delay reduction: -0.0%
377.1s 5104 Result: FAILED
377.1s 5105 
377.1s 5106 [FIGURES] Generating RL performance figures...
377.6s 5107 [OK] fig_rl_performance_improvements.png
378.2s 5108 [OK] fig_rl_learning_curve.png
378.2s 5109 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
378.2s 5110 
378.2s 5111 [METRICS] Saving RL performance metrics...
378.2s 5112 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
378.2s 5113 
378.2s 5114 [LATEX] Generating content for Section 7.6...
378.2s 5115 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
378.2s 5116 
378.2s 5117 === RL Performance Validation Summary ===
378.2s 5118 Scenarios passed: 0/1 (0.0%)
378.2s 5119 Average flow improvement: 0.00%
378.2s 5120 Average efficiency improvement: 0.00%
378.2s 5121 Average delay reduction: 0.00%
378.2s 5122 Overall validation: FAILED
378.2s 5123 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
380.9s 5124 [WARNING] Tests returned code: 1
380.9s 5125 
380.9s 5126 [STEP 4/4] Copying artifacts and cleaning up...
380.9s 5127 [ARTIFACTS] Copying results for section_7_6_rl_performance...
380.9s 5128 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
380.9s 5129 [ARTIFACTS] NPZ files: 0
380.9s 5130 [ARTIFACTS] PNG figures: 2
380.9s 5131 [ARTIFACTS] YAML scenarios: 1
380.9s 5132 [ARTIFACTS] TEX files: 1
380.9s 5133 [ARTIFACTS] JSON files: 1
380.9s 5134 [ARTIFACTS] CSV metrics: 1
380.9s 5135 TRACKING_SUCCESS: Artifacts copied
380.9s 5136 [SUCCESS] All artifacts organized and copied
380.9s 5137 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
381.0s 5138 [OK] Cleanup completed - only validation results remain
381.0s 5139 TRACKING_SUCCESS: Cleanup completed
381.0s 5140 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
381.0s 5141 TRACKING_SUCCESS: Session summary created
381.0s 5142 
381.0s 5143 [FINAL] Validation workflow completed
381.0s 5144 Remote logging finalized - ready for download
381.0s 5145 
381.0s 5146 ================================================================================
381.0s 5147 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
381.0s 5148 Output ready at: /kaggle/working/validation_results/
381.0s 5149 ================================================================================
384.4s 5150 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
384.4s 5151 warn(
384.4s 5152 [NbConvertApp] Converting notebook __script__.ipynb to html
385.2s 5153 [NbConvertApp] Writing 321270 bytes to __results__.html