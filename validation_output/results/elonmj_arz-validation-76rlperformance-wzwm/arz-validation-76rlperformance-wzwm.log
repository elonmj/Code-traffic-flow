[{"stream_name":"stdout","time":0.524492965,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.524603827,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.524611881,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.524615867,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.524621013,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.524816008,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.180019134,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.18021367,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.227808333,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.249425081,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.249613176,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.249683685,"data":"\n"}
,{"stream_name":"stdout","time":5.249692884,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.249837744,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":8.511629794,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":8.511762459,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":8.511853929,"data":"\n"}
,{"stream_name":"stdout","time":8.511868319,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":8.511928682,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":12.28495096,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":15.240369507,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":18.233138554,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":21.239146471,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":24.154868373,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":27.105285586,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":98.726856225,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":98.727140261,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":98.727161124,"data":"\n"}
,{"stream_name":"stdout","time":98.727167906,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":98.727590142,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":98.727688166,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":98.727802725,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":98.727865951,"data":"============================================================\n"}
,{"stream_name":"stderr","time":109.586527974,"data":"2025-10-21 10:48:30.979713: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":109.772145658,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":109.772187612,"data":"E0000 00:00:1761043711.165320     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":109.826396611,"data":"E0000 00:00:1761043711.219629     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":121.196840854,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":121.196868495,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":121.19687366,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":121.196877527,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":121.196880979,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":121.196884408,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":121.196887863,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":121.196896973,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":121.196901959,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":121.196905641,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":121.196909165,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":121.196912594,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":121.196916285,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":121.197441599,"data":"2025-10-21 10:48:42 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.197601088,"data":"2025-10-21 10:48:42 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":121.197730003,"data":"2025-10-21 10:48:42 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":121.197796695,"data":"2025-10-21 10:48:42 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":121.197878299,"data":"2025-10-21 10:48:42 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.197917534,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":121.197924877,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":121.197929236,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":121.311764873,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":121.406638624,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":121.406668989,"data":"\n"}
,{"stream_name":"stdout","time":121.406673295,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":121.406677839,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.406696687,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":121.406701641,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":121.406780652,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1073 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.406906273,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1074 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.40699507,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1075 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":121.40708968,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1076 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":121.40714918,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1077 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":121.407228807,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1078 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":121.407303321,"data":"2025-10-21 10:48:42 - INFO - train_rl_agent:1079 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.407343931,"data":"\n"}
,{"stream_name":"stdout","time":121.407351048,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.407355731,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":121.407359376,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":121.407362911,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":121.407575404,"data":"2025-10-21 10:48:42 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":121.407738854,"data":"2025-10-21 10:48:42 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":121.407819638,"data":"2025-10-21 10:48:42 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":121.408185455,"data":"2025-10-21 10:48:42 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":121.412570805,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.412713085,"data":"2025-10-21 10:48:42 - INFO - _create_scenario_config:614 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.412733116,"data":"2025-10-21 10:48:42 - INFO - _create_scenario_config:615 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":121.412907323,"data":"2025-10-21 10:48:42 - INFO - _create_scenario_config:616 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":121.412971772,"data":"2025-10-21 10:48:42 - INFO - _create_scenario_config:617 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":121.412979393,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":121.412983735,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":121.413110862,"data":"2025-10-21 10:48:42 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":121.413244908,"data":"2025-10-21 10:48:42 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":121.413450315,"data":"2025-10-21 10:48:42 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":121.413580994,"data":"2025-10-21 10:48:42 - INFO - _load_rl_cache:548 - [CACHE RL] No cache found for traffic_light_control with config 25b78b90\n"}
,{"stream_name":"stdout","time":121.413611212,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":121.414112971,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.41412117,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":121.420925375,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":121.42094409,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":121.420949551,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":121.420954003,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":121.420969958,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":121.421155529,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":121.421167724,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":121.421172783,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":121.421189533,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":121.421193666,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":121.421199506,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":121.421203308,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":121.424076842,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":121.424091061,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":121.424592467,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":121.424606989,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":122.799817428,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":122.799842861,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":122.799847497,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":122.799851683,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":122.799856013,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":122.799859926,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":122.799863825,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":122.799867953,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":122.80018228,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":122.800960119,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":122.801008764,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":122.801061023,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":127.329855186,"data":"2025-10-21 10:48:48 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":127.330174414,"data":"\n"}
,{"stream_name":"stdout","time":127.330182287,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 3 checkpoints (2 latest + 1 best)\n"}
,{"stream_name":"stdout","time":127.330186404,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":127.330190156,"data":"\n"}
,{"stream_name":"stdout","time":127.330193651,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":127.330197462,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":127.330201071,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":127.330205227,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":127.330209314,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":127.330213254,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":127.330217784,"data":"\n"}
,{"stream_name":"stdout","time":127.330258855,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":127.330274674,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":127.339379211,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":127.33940363,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":127.339408771,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":127.339413108,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":127.339416935,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":127.339440023,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":127.339453826,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":127.339458418,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":127.339508122,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":127.339516746,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":127.339540355,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":127.339545263,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":127.340315053,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":127.340327369,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":127.341413478,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":127.341441695,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":127.341447044,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":127.34147613,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":127.346849197,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":127.347074886,"data":"\n"}
,{"stream_name":"stdout","time":127.347082841,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":127.348762917,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":127.348777313,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":127.348781622,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":127.348785696,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":127.34913766,"data":"\n"}
,{"stream_name":"stderr","time":127.385614806,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.38564908,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":128.118433064,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":128.118468736,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":128.11847472,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":128.1184787,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":128.118482285,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":128.11848765,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":128.304160986,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.304194686,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.584583234,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.584612485,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.646599846,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.64662947,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.708434098,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.708470685,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.148770983,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.148800615,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.226770156,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.226798887,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.314581786,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.314611838,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.417476506,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.417507381,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.519683482,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.519713993,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.578652016,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.578681315,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.635384551,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.635414971,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":130.026701617,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":130.026701619,"data":"\n"}
,{"stream_name":"stderr","time":130.026738909,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.027037392,"data":"\n"}
,{"stream_name":"stdout","time":130.027048711,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":130.027053664,"data":"Total runtime: 2.68 seconds.\n"}
,{"stream_name":"stderr","time":130.027053423,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.60s/s]\n"}
,{"stream_name":"stdout","time":130.028725435,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":130.028738449,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":130.028963588,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":130.028970602,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":130.029160786,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":130.029335492,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":130.029527056,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":130.02976483,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":130.029776653,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":130.029879523,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.029952779,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.030001243,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.030008889,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.030062802,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":130.030097903,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":130.030543388,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":130.030551163,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":130.030556173,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.030581788,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.030803629,"data":"\n"}
,{"stream_name":"stdout","time":130.105176159,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":130.507915168,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":130.507915166,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.507962221,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.508188655,"data":"\n"}
,{"stream_name":"stderr","time":130.50819335,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.43s/s]\n"}
,{"stream_name":"stdout","time":130.508202087,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":130.508214668,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":130.509859057,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":130.509872393,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":130.510107784,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14732532 1.         0.01512134 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":130.510117891,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":130.510324381,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":130.510514566,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":130.510771862,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0441976  0.03246922 0.02964819 0.02877944 0.02850045 0.02842542]\n"}
,{"stream_name":"stdout","time":130.510945046,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022682  0.00147918 0.00125801 0.0011752  0.00114374 0.00113409]\n"}
,{"stream_name":"stdout","time":130.510953164,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":130.511044605,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.511130751,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.511191564,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.511209741,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.511260748,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":130.511318458,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.511786025,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":130.511798698,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":130.511804128,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.511808089,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.512003601,"data":"\n"}
,{"stream_name":"stdout","time":130.574137564,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":130.574160413,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":130.57416547,"data":"  Original dt: 4.633756e-01 s\n"}
,{"stream_name":"stdout","time":130.574169286,"data":"  Corrected dt: 2.896098e-01 s\n"}
,{"stream_name":"stdout","time":130.574172922,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":130.57417681,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stdout","time":130.58255703,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":131.033180553,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":131.03320362,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.033222451,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.033533586,"data":"\n"}
,{"stream_name":"stderr","time":131.033538231,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.78s/s]\n"}
,{"stream_name":"stdout","time":131.033546369,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":131.033556558,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":131.035167726,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":131.035181732,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":131.03539984,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14741239 1.         0.01513268 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":131.035406957,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":131.035597884,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":131.035772597,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":131.035951383,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04422372 0.03248503 0.02964484 0.02874772 0.02843718 0.02832831]\n"}
,{"stream_name":"stdout","time":131.036118357,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0022699  0.00147934 0.00125354 0.00116332 0.00112318 0.00110507]\n"}
,{"stream_name":"stdout","time":131.036124877,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":131.036206398,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.036269338,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.036314206,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.036333588,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.036419964,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":131.036427141,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":131.036888468,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":131.036901266,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.036905708,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":131.036909496,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.037110449,"data":"\n"}
,{"stream_name":"stdout","time":131.084791788,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":131.525435607,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.525463446,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.52546287,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":131.525591709,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.72s/s]\n"}
,{"stream_name":"stdout","time":131.525596767,"data":"\n"}
,{"stream_name":"stdout","time":131.52561413,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":131.525618846,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":131.527126716,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":131.527143596,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":131.527354498,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.1440919  1.         0.01497653 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":131.527364587,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":131.527544554,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":131.527750364,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":131.527923452,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04322757 0.03180963 0.02905052 0.02818116 0.02788023 0.02777602]\n"}
,{"stream_name":"stdout","time":131.528114559,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224648 0.00146785 0.00124481 0.00115512 0.00111438 0.00109507]\n"}
,{"stream_name":"stdout","time":131.528141202,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":131.528230964,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.528323992,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.528339264,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.528379851,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.528437408,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":131.528470304,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":131.529049261,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":131.529061693,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.529066001,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":131.529071409,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.529255108,"data":"\n"}
,{"stream_name":"stdout","time":131.549386498,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":131.549404082,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":131.549409364,"data":"  Original dt: 4.609884e-01 s\n"}
,{"stream_name":"stdout","time":131.549413781,"data":"  Corrected dt: 2.881178e-01 s\n"}
,{"stream_name":"stdout","time":131.549417779,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":131.549422278,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":131.558253312,"data":"[PROGRESS] Step 200: t=60.86/75.00s (81.2%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":132.025080045,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #1000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":132.025110174,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":132.025115544,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.025131034,"data":"[PERIODIC:1000] BC_GPU [Call #1000] About to launch kernel\n"}
,{"stream_name":"stdout","time":132.025135142,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.025138897,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":132.025142547,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":132.031223369,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.0208s\n"}
,{"stream_name":"stdout","time":132.031526413,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":132.031543331,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.031607292,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.031971283,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.85s/s]\n"}
,{"stream_name":"stdout","time":132.031978792,"data":"\n"}
,{"stream_name":"stdout","time":132.031990708,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":132.031995366,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":132.0335268,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":132.033540584,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":132.033788102,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14737713 1.         0.01513138 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":132.033797818,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":132.033992043,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":132.034174948,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":132.034376592,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04421314 0.03247168 0.02962986 0.02873074 0.02841522 0.02830032]\n"}
,{"stream_name":"stdout","time":132.034546766,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00226971 0.00147875 0.00125264 0.00116175 0.00112035 0.00110048]\n"}
,{"stream_name":"stdout","time":132.034553773,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":132.034664874,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.034720996,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.034789928,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.034801919,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.034856212,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":132.034900563,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":132.035306603,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.035331962,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.035337112,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.035341612,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.035511731,"data":"\n"}
,{"stream_name":"stdout","time":132.490101523,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":132.490126428,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.490130165,"data":"  Original dt: 4.610226e-01 s\n"}
,{"stream_name":"stdout","time":132.490132734,"data":"  Corrected dt: 2.881391e-01 s\n"}
,{"stream_name":"stdout","time":132.490135279,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.49013781,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":132.498238853,"data":"[PROGRESS] Step 300: t=89.41/90.00s (99.3%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":132.526002732,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.526025302,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.526025165,"data":"  Stored output at t = 90.0000 s (Step 303)\n"}
,{"stream_name":"stdout","time":132.526112184,"data":"\n"}
,{"stream_name":"stdout","time":132.526120244,"data":"Simulation finished at t = 90.0000 s after 303 steps.\n"}
,{"stream_name":"stdout","time":132.526124699,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":132.526133656,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.59s/s]\n"}
,{"stream_name":"stdout","time":132.527741022,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":132.527821152,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.527937311,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.527952556,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.527967565,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.528035614,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":132.528058985,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":132.528481825,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.528502413,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.52850669,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.528510772,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.528737641,"data":"\n"}
,{"stream_name":"stdout","time":132.968577035,"data":"[PROGRESS] Step 350: t=103.54/105.00s (98.6%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":133.024816613,"data":"  Stored output at t = 105.0000 s (Step 356)\n"}
,{"stream_name":"stderr","time":133.024839645,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.024856,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.025037473,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.24s/s]\n"}
,{"stream_name":"stdout","time":133.025045438,"data":"\n"}
,{"stream_name":"stdout","time":133.02505509,"data":"Simulation finished at t = 105.0000 s after 356 steps.\n"}
,{"stream_name":"stdout","time":133.025059833,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":133.02655783,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":133.02668358,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.026728153,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.026832015,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.026844707,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.026851148,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":133.02693179,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.027342283,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":133.027350159,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.027354475,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.027358301,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.027547967,"data":"\n"}
,{"stream_name":"stdout","time":133.431530857,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":133.43157928,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":133.431589,"data":"  Original dt: 4.609891e-01 s\n"}
,{"stream_name":"stdout","time":133.4315938,"data":"  Corrected dt: 2.881182e-01 s\n"}
,{"stream_name":"stdout","time":133.431597985,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":133.4316021,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":133.440235099,"data":"[PROGRESS] Step 400: t=117.68/120.00s (98.1%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":133.522456926,"data":"  Stored output at t = 120.0000 s (Step 409)\n"}
,{"stream_name":"stderr","time":133.52245686,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.522510097,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.522714827,"data":"\n"}
,{"stream_name":"stdout","time":133.522729062,"data":"Simulation finished at t = 120.0000 s after 409 steps.\n"}
,{"stream_name":"stderr","time":133.522726164,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.31s/s]\n"}
,{"stream_name":"stdout","time":133.522733874,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":133.524256849,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":133.52436884,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.524381386,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.524432538,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.524440275,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.524487863,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":133.524576557,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":133.524588133,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":133.52465384,"data":"\n"}
,{"stream_name":"stdout","time":133.524659465,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.52466397,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.03 | Avg Reward/Step: 0.004\n"}
,{"stream_name":"stdout","time":133.524667755,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.524672288,"data":"\n"}
,{"stream_name":"stdout","time":133.524676412,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":133.524680437,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":133.532685261,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":133.532703205,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":133.532707976,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":133.532713295,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":133.532716968,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":133.532826249,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":133.532833893,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":133.532838501,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":133.532842893,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":133.532850301,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":133.532854431,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":133.532859279,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":133.533498266,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":133.533504892,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":133.533850617,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":133.534128124,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":133.534135413,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.534140194,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.536339222,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":133.536357419,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.536362824,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.536367375,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.536390915,"data":"\n"}
,{"stream_name":"stderr","time":133.924328515,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.924357736,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.924327917,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":133.924463668,"data":"\n"}
,{"stream_name":"stdout","time":133.924473007,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":133.924477823,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":133.924475548,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.68s/s]\n"}
,{"stream_name":"stdout","time":133.926164966,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":133.926178927,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":133.926403827,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":133.926412442,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":133.926605319,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":133.926799808,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":133.92698571,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":133.927170888,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":133.927178094,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":133.927259208,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.927317407,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.927386272,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.927392832,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.927451151,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":133.927471296,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.92785649,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":133.927869561,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.927874336,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.927880146,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.928051191,"data":"\n"}
,{"stream_name":"stdout","time":134.002103188,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":134.37296048,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #2000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":134.372990634,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":134.37299621,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":134.373000587,"data":"[PERIODIC:1000] BC_GPU [Call #2000] About to launch kernel\n"}
,{"stream_name":"stdout","time":134.373004915,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":134.373009452,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":134.373013215,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":134.37383645,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":134.373848566,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.373853057,"data":"  Original dt: 4.641447e-01 s\n"}
,{"stream_name":"stdout","time":134.373856606,"data":"  Corrected dt: 2.900904e-01 s\n"}
,{"stream_name":"stdout","time":134.373860176,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.373865565,"data":"  Max wave speed detected: 17.24 m/s\n"}
,{"stream_name":"stderr","time":134.401543431,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.401584016,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.401580022,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":134.401753273,"data":"\n"}
,{"stream_name":"stderr","time":134.40175327,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.68s/s]\n"}
,{"stream_name":"stdout","time":134.401762122,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":134.401770266,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":134.40333557,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.403667842,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":134.403681454,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.403686309,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.403690592,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.403853756,"data":"\n"}
,{"stream_name":"stdout","time":134.467981126,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":134.89972771,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":134.899752452,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.899762864,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.899833877,"data":"\n"}
,{"stream_name":"stdout","time":134.899840697,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":134.899846097,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":134.899851705,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":134.901395986,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":134.901700357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":134.901711948,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.901716063,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.901719795,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.901894709,"data":"\n"}
,{"stream_name":"stdout","time":134.949024708,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":135.319275491,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":135.319310516,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.319317592,"data":"  Original dt: 4.607281e-01 s\n"}
,{"stream_name":"stdout","time":135.319321783,"data":"  Corrected dt: 2.879551e-01 s\n"}
,{"stream_name":"stdout","time":135.31932584,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.319329672,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stderr","time":135.395281447,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.395339563,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.395297421,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":135.395469303,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.40s/s]\n"}
,{"stream_name":"stdout","time":135.395490424,"data":"\n"}
,{"stream_name":"stdout","time":135.395499605,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":135.395503608,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":135.397229681,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":135.397679708,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.397696441,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.397702008,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.397706075,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.397852152,"data":"\n"}
,{"stream_name":"stdout","time":135.416743984,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":135.880780771,"data":"[PROGRESS] Step 250: t=74.97/75.00s (100.0%) | dt=0.2880s\n"}
,{"stream_name":"stderr","time":135.890821298,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.890853382,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.890823055,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stdout","time":135.891062751,"data":"\n"}
,{"stream_name":"stderr","time":135.891059756,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":135.891071104,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":135.891089016,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":135.892672895,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.892969993,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.892980976,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.892985664,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.892989703,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.893135386,"data":"\n"}
,{"stream_name":"stdout","time":136.245924765,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":136.245964125,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.24596992,"data":"  Original dt: 4.608455e-01 s\n"}
,{"stream_name":"stdout","time":136.245973959,"data":"  Corrected dt: 2.880285e-01 s\n"}
,{"stream_name":"stdout","time":136.245977609,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.245981299,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":136.337494297,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":136.374957229,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":136.374957437,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.374997465,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.375125604,"data":"\n"}
,{"stream_name":"stdout","time":136.37513325,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":136.375137988,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":136.375178231,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":136.376829911,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.377028234,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.377040675,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.377044993,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.377048838,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.377239745,"data":"\n"}
,{"stream_name":"stdout","time":136.706477306,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #3000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":136.706507054,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":136.706512746,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":136.706517139,"data":"[PERIODIC:1000] BC_GPU [Call #3000] About to launch kernel\n"}
,{"stream_name":"stdout","time":136.706521354,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":136.706525197,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":136.706528854,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":136.797260057,"data":"[PROGRESS] Step 350: t=103.25/105.00s (98.3%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":136.86270088,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":136.86270094,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.862762013,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.862848736,"data":"\n"}
,{"stream_name":"stdout","time":136.862855846,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":136.862859903,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":136.86286412,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.90s/s]\n"}
,{"stream_name":"stdout","time":136.864456048,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.864805057,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.864817207,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.86482202,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.864825831,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.86500382,"data":"\n"}
,{"stream_name":"stdout","time":137.167446436,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":137.167474857,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.167492093,"data":"  Original dt: 4.607325e-01 s\n"}
,{"stream_name":"stdout","time":137.167496682,"data":"  Corrected dt: 2.879578e-01 s\n"}
,{"stream_name":"stdout","time":137.16750035,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.167503957,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":137.258703265,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":137.354649134,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.354678211,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.354711433,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":137.354969676,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.64s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.63s/s]\n"}
,{"stream_name":"stdout","time":137.354969947,"data":"\n"}
,{"stream_name":"stdout","time":137.354987893,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":137.354992413,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":137.35672446,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.356742583,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":137.356747632,"data":"\n"}
,{"stream_name":"stdout","time":137.356751681,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.356778406,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":137.356783291,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.356787523,"data":"\n"}
,{"stream_name":"stdout","time":137.356794606,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":137.356799311,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":137.364439292,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":137.364454895,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":137.36445949,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":137.364463121,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":137.364466559,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":137.364652144,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":137.364666902,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":137.364671293,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":137.364675117,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":137.364679231,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.364696434,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":137.364707514,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":137.365305252,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":137.365317245,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":137.365556064,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":137.365827356,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.365838474,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.365843408,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.367834263,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.367851193,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.367856511,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.367860754,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.367990858,"data":"\n"}
,{"stream_name":"stdout","time":137.752513967,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":137.752514248,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.752548916,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.752623037,"data":"\n"}
,{"stream_name":"stdout","time":137.752652889,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":137.752658911,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":137.752630822,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.02s/s]\n"}
,{"stream_name":"stdout","time":137.754515068,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":137.75453041,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":137.754819362,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":137.754831243,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":137.755046419,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":137.755235328,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":137.755416897,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":137.755617599,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":137.755628865,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":137.755717018,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":137.755800235,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":137.75582291,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":137.755873855,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":137.755911281,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":137.755945992,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.756314594,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.756325156,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.756329862,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.756333486,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.75647842,"data":"\n"}
,{"stream_name":"stdout","time":137.831137636,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":138.105083807,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":138.105111999,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.105118023,"data":"  Original dt: 4.644179e-01 s\n"}
,{"stream_name":"stdout","time":138.105122455,"data":"  Corrected dt: 2.902612e-01 s\n"}
,{"stream_name":"stdout","time":138.105144007,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.105147178,"data":"  Max wave speed detected: 17.23 m/s\n"}
,{"stream_name":"stderr","time":138.23244395,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.232469882,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.232465924,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":138.232712281,"data":"\n"}
,{"stream_name":"stdout","time":138.232728785,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":138.232733598,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":138.232717069,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.52s/s]\n"}
,{"stream_name":"stdout","time":138.234336713,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.234668697,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.234678785,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.234683613,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.234687904,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.234877313,"data":"\n"}
,{"stream_name":"stdout","time":138.289437384,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":138.718802475,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":138.718831124,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.718841314,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.719162886,"data":"\n"}
,{"stream_name":"stderr","time":138.719162571,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.99s/s]\n"}
,{"stream_name":"stdout","time":138.719170615,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":138.719187413,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":138.720815297,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":138.721130342,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.721142942,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.721147871,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.721166637,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.721310833,"data":"\n"}
,{"stream_name":"stdout","time":138.74974759,"data":"[PROGRESS] Step 150: t=45.86/60.00s (76.4%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":139.025823135,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #4000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":139.025850909,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":139.02585621,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":139.025861127,"data":"[PERIODIC:1000] BC_GPU [Call #4000] About to launch kernel\n"}
,{"stream_name":"stdout","time":139.025864921,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":139.025868723,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":139.025872378,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":139.030151895,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":139.030170868,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.030176413,"data":"  Original dt: 4.607016e-01 s\n"}
,{"stream_name":"stdout","time":139.03018058,"data":"  Corrected dt: 2.879385e-01 s\n"}
,{"stream_name":"stdout","time":139.030184709,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.030189065,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":139.213715761,"data":"[PROGRESS] Step 200: t=60.00/60.00s (100.0%) | dt=0.0260s\n"}
,{"stream_name":"stdout","time":139.213956995,"data":"  Stored output at t = 60.0000 s (Step 200)\n"}
,{"stream_name":"stderr","time":139.213961958,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.213972075,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.214269099,"data":"\n"}
,{"stream_name":"stdout","time":139.214276931,"data":"Simulation finished at t = 60.0000 s after 200 steps.\n"}
,{"stream_name":"stderr","time":139.214275287,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.44s/s]\n"}
,{"stream_name":"stdout","time":139.214280956,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":139.216311896,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":139.216638499,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.216649845,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.216654314,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.216658407,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.216830432,"data":"\n"}
,{"stream_name":"stdout","time":139.675470769,"data":"[PROGRESS] Step 250: t=74.40/75.00s (99.2%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":139.703076006,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":139.703092769,"data":"  Stored output at t = 75.0000 s (Step 253)\n"}
,{"stream_name":"stderr","time":139.703102476,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.703224574,"data":"\n"}
,{"stream_name":"stderr","time":139.703224615,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.86s/s]\n"}
,{"stream_name":"stdout","time":139.703233647,"data":"Simulation finished at t = 75.0000 s after 253 steps.\n"}
,{"stream_name":"stdout","time":139.703242612,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":139.704902592,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":139.705083998,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.70509414,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.705098671,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.705103063,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.705342154,"data":"\n"}
,{"stream_name":"stdout","time":139.967656261,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":139.967684647,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.967696478,"data":"  Original dt: 4.606469e-01 s\n"}
,{"stream_name":"stdout","time":139.967700741,"data":"  Corrected dt: 2.879043e-01 s\n"}
,{"stream_name":"stdout","time":139.967704864,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.967708713,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":140.154347833,"data":"[PROGRESS] Step 300: t=88.53/90.00s (98.4%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":140.210022665,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":140.210022668,"data":"  Stored output at t = 90.0000 s (Step 306)\n"}
,{"stream_name":"stderr","time":140.210051771,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.210122062,"data":"\n"}
,{"stream_name":"stdout","time":140.210137673,"data":"Simulation finished at t = 90.0000 s after 306 steps.\n"}
,{"stream_name":"stdout","time":140.210142657,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":140.210141684,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.73s/s]\n"}
,{"stream_name":"stdout","time":140.212012509,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.212252447,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.212261687,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.212266951,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.21227093,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.212435825,"data":"\n"}
,{"stream_name":"stdout","time":140.633742915,"data":"[PROGRESS] Step 350: t=102.67/105.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":140.71821126,"data":"  Stored output at t = 105.0000 s (Step 359)\n"}
,{"stream_name":"stderr","time":140.718215759,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.718243696,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":140.718987227,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.63s/s]\n"}
,{"stream_name":"stdout","time":140.718991833,"data":"\n"}
,{"stream_name":"stdout","time":140.7190103,"data":"Simulation finished at t = 105.0000 s after 359 steps.\n"}
,{"stream_name":"stdout","time":140.719015235,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":140.720670992,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.720996886,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.721009802,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.721015246,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.721019301,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.721164053,"data":"\n"}
,{"stream_name":"stdout","time":140.949028165,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":140.949054452,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.949060329,"data":"  Original dt: 4.607092e-01 s\n"}
,{"stream_name":"stdout","time":140.949064107,"data":"  Corrected dt: 2.879432e-01 s\n"}
,{"stream_name":"stdout","time":140.949068505,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.949072487,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":141.134233398,"data":"[PROGRESS] Step 400: t=116.81/120.00s (97.3%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":141.244494961,"data":"  Stored output at t = 120.0000 s (Step 412)\n"}
,{"stream_name":"stderr","time":141.244535129,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.244552913,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.244656792,"data":"\n"}
,{"stream_name":"stdout","time":141.244686354,"data":"Simulation finished at t = 120.0000 s after 412 steps.\n"}
,{"stream_name":"stdout","time":141.244692605,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":141.244695369,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.67s/s]\n"}
,{"stream_name":"stdout","time":141.246260592,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.246273745,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":141.246278174,"data":"\n"}
,{"stream_name":"stdout","time":141.246281716,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.246286061,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.08 | Avg Reward/Step: 0.010\n"}
,{"stream_name":"stdout","time":141.246290241,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.2462949,"data":"\n"}
,{"stream_name":"stdout","time":141.246301339,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.246306077,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.25349581,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.253513848,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.253519061,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.253523446,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.253527236,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":141.253630137,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.253640952,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.253644961,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":141.253648613,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.253692569,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.25369822,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.253701968,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.254231807,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.254237702,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":141.25448136,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.254747731,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.254759643,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.254764047,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.256590296,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.256602923,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.256607126,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.256612632,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.256814054,"data":"\n"}
,{"stream_name":"stdout","time":141.414926535,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #5000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":141.414957212,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":141.414962711,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":141.414967175,"data":"[PERIODIC:1000] BC_GPU [Call #5000] About to launch kernel\n"}
,{"stream_name":"stdout","time":141.414970881,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":141.414974632,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":141.414978977,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stderr","time":141.638083366,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.638112932,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.638098707,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":141.638331548,"data":"\n"}
,{"stream_name":"stderr","time":141.638332424,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.34s/s]\n"}
,{"stream_name":"stdout","time":141.638339771,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":141.638348069,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":141.640062434,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":141.640080779,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":141.640175815,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":141.640183929,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":141.640376118,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":141.640547032,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":141.640726855,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":141.640897488,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":141.640904684,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":141.640952158,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.641019069,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.641092734,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.641098761,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.64113561,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":141.64119135,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.64151824,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.641525386,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.641537017,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.641543186,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.641740753,"data":"\n"}
,{"stream_name":"stdout","time":141.715592327,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":141.88131649,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":141.881345531,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.881351615,"data":"  Original dt: 4.671675e-01 s\n"}
,{"stream_name":"stdout","time":141.88135589,"data":"  Corrected dt: 2.919797e-01 s\n"}
,{"stream_name":"stdout","time":141.88135981,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.881364045,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stderr","time":142.12595738,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.125982232,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.125956039,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":142.126104927,"data":"\n"}
,{"stream_name":"stdout","time":142.12611503,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":142.126119282,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":142.126126426,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.98s/s]\n"}
,{"stream_name":"stdout","time":142.128154747,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.128472164,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.128480548,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.128491842,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.128509708,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.128704927,"data":"\n"}
,{"stream_name":"stdout","time":142.1835105,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":142.617439127,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":142.617436914,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.617473071,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.617576839,"data":"\n"}
,{"stream_name":"stdout","time":142.61759955,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":142.617604681,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":142.617578156,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.70s/s]\n"}
,{"stream_name":"stdout","time":142.619326889,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.619637636,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.619650105,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.619655003,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.619659347,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.619829081,"data":"\n"}
,{"stream_name":"stdout","time":142.647905012,"data":"[PROGRESS] Step 150: t=45.86/60.00s (76.4%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":142.813843164,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":142.813870873,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.813877444,"data":"  Original dt: 4.607776e-01 s\n"}
,{"stream_name":"stdout","time":142.813881347,"data":"  Corrected dt: 2.879860e-01 s\n"}
,{"stream_name":"stdout","time":142.813885357,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.813889164,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":143.108202935,"data":"[PROGRESS] Step 200: t=60.00/60.00s (100.0%) | dt=0.0231s\n"}
,{"stream_name":"stdout","time":143.108529392,"data":"  Stored output at t = 60.0000 s (Step 200)\n"}
,{"stream_name":"stderr","time":143.10859114,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.108617388,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.108930085,"data":"\n"}
,{"stream_name":"stdout","time":143.108938934,"data":"Simulation finished at t = 60.0000 s after 200 steps.\n"}
,{"stream_name":"stderr","time":143.108935993,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.68s/s]\n"}
,{"stream_name":"stdout","time":143.108943654,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":143.110632828,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.111091899,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.111099495,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.111104656,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.111109023,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.111298045,"data":"\n"}
,{"stream_name":"stdout","time":143.573737646,"data":"[PROGRESS] Step 250: t=74.41/75.00s (99.2%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":143.601711575,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.601739772,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.601711573,"data":"  Stored output at t = 75.0000 s (Step 253)\n"}
,{"stream_name":"stdout","time":143.601947945,"data":"\n"}
,{"stream_name":"stderr","time":143.601945823,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.59s/s]\n"}
,{"stream_name":"stdout","time":143.601956391,"data":"Simulation finished at t = 75.0000 s after 253 steps.\n"}
,{"stream_name":"stdout","time":143.601973896,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":143.603685982,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.603907052,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.603915211,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.603919438,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.603923265,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.604086254,"data":"\n"}
,{"stream_name":"stdout","time":143.740555622,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #6000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":143.74060277,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":143.740608369,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":143.740612347,"data":"[PERIODIC:1000] BC_GPU [Call #6000] About to launch kernel\n"}
,{"stream_name":"stdout","time":143.74061618,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":143.740620087,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":143.740625518,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":143.746161733,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":143.74618013,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.746185639,"data":"  Original dt: 4.608193e-01 s\n"}
,{"stream_name":"stdout","time":143.746189758,"data":"  Corrected dt: 2.880121e-01 s\n"}
,{"stream_name":"stdout","time":143.746193335,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.746196755,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":144.041839478,"data":"[PROGRESS] Step 300: t=88.54/90.00s (98.4%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":144.097725574,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.097756608,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.09773117,"data":"  Stored output at t = 90.0000 s (Step 306)\n"}
,{"stream_name":"stdout","time":144.097961022,"data":"\n"}
,{"stream_name":"stdout","time":144.097972259,"data":"Simulation finished at t = 90.0000 s after 306 steps.\n"}
,{"stream_name":"stderr","time":144.097966053,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.39s/s]\n"}
,{"stream_name":"stdout","time":144.097977392,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":144.09982398,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.100115689,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.100127385,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.10013222,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.100136387,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.100296336,"data":"\n"}
,{"stream_name":"stdout","time":144.505129898,"data":"[PROGRESS] Step 350: t=102.67/105.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":144.588286736,"data":"  Stored output at t = 105.0000 s (Step 359)\n"}
,{"stream_name":"stderr","time":144.588290232,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.588322666,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.588400475,"data":"\n"}
,{"stream_name":"stdout","time":144.58841055,"data":"Simulation finished at t = 105.0000 s after 359 steps.\n"}
,{"stream_name":"stdout","time":144.588415516,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":144.588417253,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":144.590162928,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.5903418,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.590353639,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.590357911,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.590361791,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.590518732,"data":"\n"}
,{"stream_name":"stdout","time":144.675942775,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":144.675967551,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.675972077,"data":"  Original dt: 4.607048e-01 s\n"}
,{"stream_name":"stdout","time":144.675977585,"data":"  Corrected dt: 2.879405e-01 s\n"}
,{"stream_name":"stdout","time":144.675981499,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.675985714,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":144.974741649,"data":"[PROGRESS] Step 400: t=116.81/120.00s (97.3%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":145.103296671,"data":"  Stored output at t = 120.0000 s (Step 412)\n"}
,{"stream_name":"stderr","time":145.103306372,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.103332143,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.103752079,"data":"\n"}
,{"stream_name":"stdout","time":145.103769659,"data":"Simulation finished at t = 120.0000 s after 412 steps.\n"}
,{"stream_name":"stdout","time":145.103774314,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":145.103797682,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.24s/s]\n"}
,{"stream_name":"stdout","time":145.105371692,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":145.105390259,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":145.105395016,"data":"\n"}
,{"stream_name":"stdout","time":145.105399625,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.105404938,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":145.105409039,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.105413443,"data":"\n"}
,{"stream_name":"stdout","time":145.105419594,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.105424178,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.113920012,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.113944242,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.11400879,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.114018121,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.114024132,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.11416635,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.11417367,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.114177875,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.114182156,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.114194877,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.114306047,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.114317779,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.11541378,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.115441997,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":145.115892378,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.116331437,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.116340186,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.116373624,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.119102566,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":145.11913121,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":145.11913625,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":145.119140505,"data":"|    ep_rew_mean      | 0.09     |\n"}
,{"stream_name":"stdout","time":145.11914464,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":145.119149023,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":145.119153652,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":145.119158093,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":145.119162392,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":145.119166735,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":145.119170744,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":145.120630292,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.120647131,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.120652749,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.120657853,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.120931835,"data":"\n"}
,{"stream_name":"stderr","time":145.57018551,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.570234915,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.570185437,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":145.57038134,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 33.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 33.40s/s]\n"}
,{"stream_name":"stdout","time":145.570406473,"data":"\n"}
,{"stream_name":"stdout","time":145.57041168,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":145.570416026,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":145.572086622,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":145.572106557,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":145.572252445,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":145.572261589,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":145.572449621,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":145.572652771,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":145.572882393,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":145.573064288,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":145.573071046,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":145.573172984,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.573224884,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.573300217,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.573313808,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.573352725,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":145.573400363,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.573786792,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.573799818,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.57380526,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.573817548,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.574218237,"data":"\n"}
,{"stream_name":"stdout","time":145.666878454,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":145.729070018,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":145.729115949,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.729122164,"data":"  Original dt: 4.735607e-01 s\n"}
,{"stream_name":"stdout","time":145.729128094,"data":"  Corrected dt: 2.959754e-01 s\n"}
,{"stream_name":"stdout","time":145.729131874,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.729137405,"data":"  Max wave speed detected: 16.89 m/s\n"}
,{"stream_name":"stderr","time":146.097453594,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":146.097456755,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":146.097483489,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":146.097674476,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.66s/s]\n"}
,{"stream_name":"stdout","time":146.097677638,"data":"\n"}
,{"stream_name":"stdout","time":146.09771017,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":146.097715961,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":146.099441041,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.099799383,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.099810768,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.099816057,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.099821052,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.099986552,"data":"\n"}
,{"stream_name":"stdout","time":146.166088456,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":146.21658151,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #7000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":146.216606731,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":146.216612451,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.21661704,"data":"[PERIODIC:1000] BC_GPU [Call #7000] About to launch kernel\n"}
,{"stream_name":"stdout","time":146.216621065,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.216624842,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":146.216628464,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":146.579022808,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":146.579020607,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.579060477,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.579266933,"data":"\n"}
,{"stream_name":"stdout","time":146.579288694,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":146.579293147,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":146.579312894,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.31s/s]\n"}
,{"stream_name":"stdout","time":146.580925885,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.581095836,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.581106122,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.58111036,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.581114541,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.581281603,"data":"\n"}
,{"stream_name":"stdout","time":146.626445223,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":146.681896064,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":146.681921066,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.681925172,"data":"  Original dt: 4.618982e-01 s\n"}
,{"stream_name":"stdout","time":146.681927749,"data":"  Corrected dt: 2.886864e-01 s\n"}
,{"stream_name":"stdout","time":146.681930472,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.681933594,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":147.060434148,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.060464228,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.060432544,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":147.060747417,"data":"\n"}
,{"stream_name":"stdout","time":147.060768058,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":147.060772755,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":147.060877092,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.30s/s]\n"}
,{"stream_name":"stdout","time":147.062418333,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":147.062866253,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.062883833,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.062888969,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.062893706,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.063036282,"data":"\n"}
,{"stream_name":"stdout","time":147.090915293,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":147.550281954,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":147.550301567,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":147.550311065,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.550365387,"data":"\n"}
,{"stream_name":"stdout","time":147.550372869,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":147.550376439,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":147.55038562,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":147.55208903,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":147.552405694,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.552413591,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.552417819,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.552421742,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.552615028,"data":"\n"}
,{"stream_name":"stdout","time":147.563609801,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":147.622603541,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":147.622627193,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.622634696,"data":"  Original dt: 4.617574e-01 s\n"}
,{"stream_name":"stdout","time":147.622637581,"data":"  Corrected dt: 2.885984e-01 s\n"}
,{"stream_name":"stdout","time":147.622640473,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.622643006,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":148.03506925,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.045098809,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":148.045100509,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.04512294,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.045376693,"data":"\n"}
,{"stream_name":"stdout","time":148.045384707,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":148.045389303,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":148.045390109,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.46s/s]\n"}
,{"stream_name":"stdout","time":148.047232984,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":148.047574323,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.047586202,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.047591219,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.047595648,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.047769402,"data":"\n"}
,{"stream_name":"stdout","time":148.515869928,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":148.543911969,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":148.543979,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":148.543986886,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":148.544192143,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.23s/s]\n"}
,{"stream_name":"stdout","time":148.544205507,"data":"\n"}
,{"stream_name":"stdout","time":148.544215737,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":148.544219918,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":148.545950776,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":148.546203898,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.546213578,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.546219035,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.546223455,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.546389926,"data":"\n"}
,{"stream_name":"stdout","time":148.569474213,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #8000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":148.569495521,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":148.569501258,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.56950613,"data":"[PERIODIC:1000] BC_GPU [Call #8000] About to launch kernel\n"}
,{"stream_name":"stdout","time":148.569510593,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.569514467,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":148.569520015,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":148.57676094,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":148.576779732,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.57678494499999,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":148.576789279,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":148.576793475,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.576797074,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":148.986054993,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":149.032905412,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":149.032905542,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.032945165,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":149.033072962,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.84s/s]\n"}
,{"stream_name":"stdout","time":149.033075252,"data":"\n"}
,{"stream_name":"stdout","time":149.033092012,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":149.033097849,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":149.035007883,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":149.035026093,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":149.035030753,"data":"\n"}
,{"stream_name":"stdout","time":149.035035135,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.035039079,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.03 | Avg Reward/Step: 0.004\n"}
,{"stream_name":"stdout","time":149.035042994,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.035046847,"data":"\n"}
,{"stream_name":"stdout","time":149.035050301,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":149.035054358,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":149.042380776,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":149.04239947,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":149.042404266,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":149.042408118,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":149.042412047,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":149.042416314,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":149.042420993,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":149.042425852,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":149.042447044,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":149.04245116,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.042456,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":149.042459848,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":149.043148365,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":149.043165212,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":149.043393992,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":149.04404753,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.044063515,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.044068298,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.046064753,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.046082598,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.046087763,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.046092087,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.046234514,"data":"\n"}
,{"stream_name":"stderr","time":149.440334402,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.440361663,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.440364941,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":149.440456382,"data":"\n"}
,{"stream_name":"stderr","time":149.440456237,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.09s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.07s/s]\n"}
,{"stream_name":"stdout","time":149.440464022,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":149.440474889,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":149.441956463,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":149.441975506,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":149.442188431,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":149.442197539,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":149.442379131,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":149.442593274,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":149.442822239,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":149.443038629,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":149.443062385,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":149.44310617,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":149.443152204,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":149.443216522,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":149.443227559,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":149.443307315,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":149.44331452,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.443675335,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.443690117,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.44369493,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.443698981,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.443889554,"data":"\n"}
,{"stream_name":"stdout","time":149.518548762,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":149.528378011,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":149.52840014,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.528405446,"data":"  Original dt: 4.754722e-01 s\n"}
,{"stream_name":"stdout","time":149.528409315,"data":"  Corrected dt: 2.971701e-01 s\n"}
,{"stream_name":"stdout","time":149.528413072,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.528416829,"data":"  Max wave speed detected: 16.83 m/s\n"}
,{"stream_name":"stdout","time":149.931229907,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":149.931239178,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.931269872,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.931442095,"data":"\n"}
,{"stream_name":"stdout","time":149.931451664,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":149.931461707,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":149.931454367,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":149.933021456,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.933341211,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.93336502,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.933369634,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.933375251,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.933553202,"data":"\n"}
,{"stream_name":"stdout","time":149.99206583,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stderr","time":150.456259092,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.456287384,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.456266914,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":150.456505023,"data":"\n"}
,{"stream_name":"stdout","time":150.456519712,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":150.456524411,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":150.456524612,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.70s/s]\n"}
,{"stream_name":"stdout","time":150.458479504,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.458861228,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.45887355,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.45887916,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.458884062,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.459085474,"data":"\n"}
,{"stream_name":"stdout","time":150.502634981,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2885s\n"}
,{"stream_name":"stdout","time":150.512961897,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":150.512980165,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.512985732,"data":"  Original dt: 4.616341e-01 s\n"}
,{"stream_name":"stdout","time":150.5129902,"data":"  Corrected dt: 2.885213e-01 s\n"}
,{"stream_name":"stdout","time":150.512994162,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.512998061,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":150.992117006,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stderr","time":150.992139295,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.99215209,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.992286373,"data":"\n"}
,{"stream_name":"stdout","time":150.992295278,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":150.992299838,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":150.992310904,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.14s/s]\n"}
,{"stream_name":"stdout","time":150.994001956,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.994343206,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.99435215,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.994357176,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.994361618,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.994527446,"data":"\n"}
,{"stream_name":"stdout","time":151.004043272,"data":"[PROGRESS] Step 200: t=60.29/75.00s (80.4%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":151.004105373,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #9000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":151.004114164,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":151.004118685,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":151.004212501,"data":"[PERIODIC:1000] BC_GPU [Call #9000] About to launch kernel\n"}
,{"stream_name":"stdout","time":151.004229684,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":151.00423548,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":151.004240126,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":151.466787156,"data":"[PROGRESS] Step 250: t=74.69/75.00s (99.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":151.476899391,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":151.476919003,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.476924195,"data":"  Original dt: 4.606836e-01 s\n"}
,{"stream_name":"stdout","time":151.476928072,"data":"  Corrected dt: 2.879273e-01 s\n"}
,{"stream_name":"stdout","time":151.476931839,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.476935511,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stderr","time":151.485167763,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.485188559,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.485173026,"data":"  Stored output at t = 75.0000 s (Step 252)\n"}
,{"stream_name":"stdout","time":151.485517717,"data":"\n"}
,{"stream_name":"stdout","time":151.485527287,"data":"Simulation finished at t = 75.0000 s after 252 steps.\n"}
,{"stream_name":"stderr","time":151.485525214,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.57s/s]\n"}
,{"stream_name":"stdout","time":151.485531558,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":151.487174419,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.487468977,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.487477609,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.48748169,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.487485491,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.48767565,"data":"\n"}
,{"stream_name":"stdout","time":151.931369969,"data":"[PROGRESS] Step 300: t=88.82/90.00s (98.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":151.978746135,"data":"  Stored output at t = 90.0000 s (Step 305)\n"}
,{"stream_name":"stderr","time":151.978759032,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.97877497,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":151.979042243,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.54s/s]\n"}
,{"stream_name":"stdout","time":151.979082919,"data":"\n"}
,{"stream_name":"stdout","time":151.979111403,"data":"Simulation finished at t = 90.0000 s after 305 steps.\n"}
,{"stream_name":"stdout","time":151.979116567,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":151.980774124,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.981092592,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.981100366,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.981104441,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.981108365,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.981291448,"data":"\n"}
,{"stream_name":"stdout","time":152.396017729,"data":"[PROGRESS] Step 350: t=102.96/105.00s (98.1%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":152.405962494,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":152.405982176,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.405988891,"data":"  Original dt: 4.607599e-01 s\n"}
,{"stream_name":"stdout","time":152.405992401,"data":"  Corrected dt: 2.879749e-01 s\n"}
,{"stream_name":"stdout","time":152.405997647,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.406001699,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stderr","time":152.470148386,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":152.470174637,"data":"  Stored output at t = 105.0000 s (Step 358)\n"}
,{"stream_name":"stderr","time":152.47018687,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":152.470263613,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.69s/s]\n"}
,{"stream_name":"stdout","time":152.470270859,"data":"\n"}
,{"stream_name":"stdout","time":152.470281627,"data":"Simulation finished at t = 105.0000 s after 358 steps.\n"}
,{"stream_name":"stdout","time":152.470285689,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":152.471878415,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.472083455,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.472092924,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.472098136,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.47210212,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.472271883,"data":"\n"}
,{"stream_name":"stdout","time":152.865340691,"data":"[PROGRESS] Step 400: t=117.09/120.00s (97.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":152.966376662,"data":"  Stored output at t = 120.0000 s (Step 411)\n"}
,{"stream_name":"stderr","time":152.966376704,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.966410379,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.966704016,"data":"\n"}
,{"stream_name":"stdout","time":152.966716063,"data":"Simulation finished at t = 120.0000 s after 411 steps.\n"}
,{"stream_name":"stdout","time":152.966721049,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":152.966719975,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.35s/s]\n"}
,{"stream_name":"stdout","time":152.968316392,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.968331752,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":152.968337023,"data":"\n"}
,{"stream_name":"stdout","time":152.96834113,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.968345524,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":152.968349878,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.96835574,"data":"\n"}
,{"stream_name":"stdout","time":152.968388901,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":152.96840889,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":152.975486408,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":152.975505995,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":152.975511655,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":152.975515374,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":152.975519015,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":152.975598613,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":152.975608481,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":152.975612789,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":152.975689279,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":152.97570217,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.975707135,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":152.97571122,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":152.976303429,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":152.97631415,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":152.976535128,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":152.977145791,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.977161437,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.9771662,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.978939548,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.978956908,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.97896224,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.978966681,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.979085664,"data":"\n"}
,{"stream_name":"stdout","time":153.338542697,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #10000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":153.338590124,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":153.338596384,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":153.338600544,"data":"[PERIODIC:1000] BC_GPU [Call #10000] About to launch kernel\n"}
,{"stream_name":"stdout","time":153.338604561,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":153.338608738,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":153.33861404,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":153.353674886,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":153.353696099,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.353701644,"data":"  Original dt: 4.862163e-01 s\n"}
,{"stream_name":"stdout","time":153.35370601,"data":"  Corrected dt: 3.038852e-01 s\n"}
,{"stream_name":"stdout","time":153.353709754,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.353713682,"data":"  Max wave speed detected: 16.45 m/s\n"}
,{"stream_name":"stderr","time":153.371882892,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.371914536,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.37188561,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":153.371965792,"data":"\n"}
,{"stream_name":"stdout","time":153.371970923,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stderr","time":153.37197993,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.20s/s]\n"}
,{"stream_name":"stdout","time":153.372002275,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":153.373607852,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":153.37362559,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":153.373713767,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":153.373720991,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":153.373921397,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":153.374071898,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":153.374246419,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":153.374421121,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":153.374427379,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":153.374503039,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":153.37460106,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":153.37466482,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":153.374672087,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":153.374763043,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":153.374773043,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.375141208,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.375168132,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.375173528,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.375177752,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.375327749,"data":"\n"}
,{"stream_name":"stdout","time":153.448396762,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":153.850813237,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":153.850815837,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.850846305,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.85101614,"data":"\n"}
,{"stream_name":"stdout","time":153.851028145,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":153.851033359,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":153.851054042,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":153.852579551,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.87166593,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":153.871893072,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.871901855,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.871906804,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.87191081,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.87208298,"data":"\n"}
,{"stream_name":"stdout","time":153.928098889,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":154.296310468,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":154.296339999,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.296346095,"data":"  Original dt: 4.615798e-01 s\n"}
,{"stream_name":"stdout","time":154.296350356,"data":"  Corrected dt: 2.884874e-01 s\n"}
,{"stream_name":"stdout","time":154.296354314,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.296358589,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":154.350534634,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.350577302,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.350576902,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":154.350648792,"data":"\n"}
,{"stream_name":"stderr","time":154.350652865,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.36s/s]\n"}
,{"stream_name":"stdout","time":154.350656996,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":154.350690623,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":154.35246844,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.352814456,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.352830742,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.352835686,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.352839512,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.352980857,"data":"\n"}
,{"stream_name":"stdout","time":154.390000316,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2885s\n"}
,{"stream_name":"stderr","time":154.832472256,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.832501633,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.832472003,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":154.832713614,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.29s/s]\n"}
,{"stream_name":"stdout","time":154.832730993,"data":"\n"}
,{"stream_name":"stdout","time":154.832767588,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":154.832773225,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":154.83425579,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.834710178,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.834726505,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.834731649,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.834735469,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.834886985,"data":"\n"}
,{"stream_name":"stdout","time":154.852949286,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":155.231617848,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":155.231643122,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.231648325,"data":"  Original dt: 4.611825e-01 s\n"}
,{"stream_name":"stdout","time":155.231651713,"data":"  Corrected dt: 2.882390e-01 s\n"}
,{"stream_name":"stdout","time":155.231667735,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.231670367,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":155.33528954,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":155.34746632,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.347490734,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.347490677,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stdout","time":155.347853195,"data":"\n"}
,{"stream_name":"stderr","time":155.347858234,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.25s/s]\n"}
,{"stream_name":"stdout","time":155.347868377,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":155.347876488,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":155.349632001,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.349996896,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.350008791,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.350013644,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.350017776,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.350148597,"data":"\n"}
,{"stream_name":"stdout","time":155.699902463,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #11000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":155.699939801,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":155.699944618,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.699948728,"data":"[PERIODIC:1000] BC_GPU [Call #11000] About to launch kernel\n"}
,{"stream_name":"stdout","time":155.699952607,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.69995661,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":155.699960273,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":155.808019169,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":155.845989867,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":155.845991466,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.846030292,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.846223217,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.25s/s]\n"}
,{"stream_name":"stdout","time":155.846229154,"data":"\n"}
,{"stream_name":"stdout","time":155.846263953,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":155.846269055,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":155.847941161,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.848121921,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.84813337,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.848138181,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.848141875,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.848333016,"data":"\n"}
,{"stream_name":"stdout","time":156.187915029,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":156.187941376,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.187947181,"data":"  Original dt: 4.610150e-01 s\n"}
,{"stream_name":"stdout","time":156.187951123,"data":"  Corrected dt: 2.881344e-01 s\n"}
,{"stream_name":"stdout","time":156.187955154,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.187958989,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":156.280959569,"data":"[PROGRESS] Step 350: t=103.25/105.00s (98.3%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":156.346045824,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.346073607,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.346045821,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stdout","time":156.346225072,"data":"\n"}
,{"stream_name":"stdout","time":156.346234958,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":156.346267671,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":156.346234185,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.14s/s]\n"}
,{"stream_name":"stdout","time":156.347878598,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.348075947,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.348084453,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.348089519,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.348094101,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.34826889,"data":"\n"}
,{"stream_name":"stdout","time":156.750813522,"data":"[PROGRESS] Step 400: t=117.39/120.00s (97.8%) | dt=0.2880s\n"}
,{"stream_name":"stderr","time":156.845385016,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.845410972,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.845385014,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stdout","time":156.845496708,"data":"\n"}
,{"stream_name":"stdout","time":156.845504927,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":156.845509556,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":156.845529144,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.18s/s]\n"}
,{"stream_name":"stdout","time":156.847249317,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.847267021,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":156.847271554,"data":"\n"}
,{"stream_name":"stdout","time":156.847275283,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.847279309,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":156.84728318,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.84728701,"data":"\n"}
,{"stream_name":"stdout","time":156.847290524,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":156.84729479,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":156.854660355,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":156.854677908,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":156.85468294,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":156.854687735,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":156.854692195,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":156.854695845,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":156.854700028,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":156.854703647,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":156.854707343,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":156.854713042,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.854720061,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":156.854723688,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":156.855323647,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":156.855335689,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":156.855582809,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":156.8558303,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.855840421,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.855844768,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.85765338,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.85767,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.857674828,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.857679293,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.857864567,"data":"\n"}
,{"stream_name":"stdout","time":157.143035458,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":157.143061241,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.143066252,"data":"  Original dt: 5.029871e-01 s\n"}
,{"stream_name":"stdout","time":157.143070681,"data":"  Corrected dt: 3.143669e-01 s\n"}
,{"stream_name":"stdout","time":157.143074594,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.14307831,"data":"  Max wave speed detected: 15.90 m/s\n"}
,{"stream_name":"stderr","time":157.255402829,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.255430302,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.2554036,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":157.25548166,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.74s/s]\n"}
,{"stream_name":"stdout","time":157.255506152,"data":"\n"}
,{"stream_name":"stdout","time":157.255510988,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":157.255515241,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":157.25716739,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":157.257184583,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":157.257389434,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":157.257399131,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":157.257591116,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":157.257779193,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":157.257919216,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":157.258091542,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":157.258115534,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":157.258146779,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":157.25821046,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":157.258239243,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":157.258275345,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":157.258329515,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":157.258357329,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.258761746,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.258777339,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.25878524,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.258789309,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.258952088,"data":"\n"}
,{"stream_name":"stdout","time":157.333955874,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":157.74681721,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":157.746817212,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.746847987,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.747050368,"data":"\n"}
,{"stream_name":"stderr","time":157.747050315,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":157.747058927,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":157.747066583,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":157.748773416,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.749128684,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.749138374,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.749143793,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.749149133,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.749330944,"data":"\n"}
,{"stream_name":"stdout","time":157.805628487,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":158.075502547,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #12000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":158.075541928,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":158.075547789,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.075552159,"data":"[PERIODIC:1000] BC_GPU [Call #12000] About to launch kernel\n"}
,{"stream_name":"stdout","time":158.075556665,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.075587547,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":158.075592252,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":158.090643754,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":158.090668024,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.090673427,"data":"  Original dt: 4.615301e-01 s\n"}
,{"stream_name":"stdout","time":158.090677698,"data":"  Corrected dt: 2.884563e-01 s\n"}
,{"stream_name":"stdout","time":158.090681875,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.090685882,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":158.241378936,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":158.241404436,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":158.241409637,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":158.241483661,"data":"\n"}
,{"stream_name":"stdout","time":158.241491812,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":158.241497099,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":158.24151192,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.49s/s]\n"}
,{"stream_name":"stdout","time":158.243346166,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.243700791,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.243718754,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.243724336,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.243728797,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.243907913,"data":"\n"}
,{"stream_name":"stdout","time":158.282261944,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2885s\n"}
,{"stream_name":"stdout","time":158.758687055,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stderr","time":158.758735964,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.758755035,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.758993717,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.13s/s]\n"}
,{"stream_name":"stdout","time":158.759023301,"data":"\n"}
,{"stream_name":"stdout","time":158.759037476,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":158.759042093,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":158.761096154,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.761632964,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.761654653,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.761658714,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.761661891,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.761889173,"data":"\n"}
,{"stream_name":"stdout","time":158.773690676,"data":"[PROGRESS] Step 200: t=60.29/75.00s (80.4%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":159.082313325,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":159.08234194,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.08234775,"data":"  Original dt: 4.607393e-01 s\n"}
,{"stream_name":"stdout","time":159.082351943,"data":"  Corrected dt: 2.879621e-01 s\n"}
,{"stream_name":"stdout","time":159.082356177,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.082360496,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":159.271216572,"data":"[PROGRESS] Step 250: t=74.69/75.00s (99.6%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":159.290460461,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.29048661,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.290462752,"data":"  Stored output at t = 75.0000 s (Step 252)\n"}
,{"stream_name":"stdout","time":159.29065115,"data":"\n"}
,{"stream_name":"stdout","time":159.29066465,"data":"Simulation finished at t = 75.0000 s after 252 steps.\n"}
,{"stream_name":"stdout","time":159.29066877,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":159.290683327,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.38s/s]\n"}
,{"stream_name":"stdout","time":159.292340699,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.292678211,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.292708697,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.29273534,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.292739722,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.292871887,"data":"\n"}
,{"stream_name":"stdout","time":159.750860847,"data":"[PROGRESS] Step 300: t=88.82/90.00s (98.7%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":159.798325577,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.798353241,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.798358974,"data":"  Stored output at t = 90.0000 s (Step 305)\n"}
,{"stream_name":"stdout","time":159.798486727,"data":"\n"}
,{"stream_name":"stdout","time":159.798496366,"data":"Simulation finished at t = 90.0000 s after 305 steps.\n"}
,{"stream_name":"stderr","time":159.79849575,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.68s/s]\n"}
,{"stream_name":"stdout","time":159.798500475,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":159.800257534,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.800622814,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.800635379,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.800640436,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.800644257,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.800842238,"data":"\n"}
,{"stream_name":"stdout","time":160.039088928,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":160.039115176,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.039121054,"data":"  Original dt: 4.606462e-01 s\n"}
,{"stream_name":"stdout","time":160.039125462,"data":"  Corrected dt: 2.879039e-01 s\n"}
,{"stream_name":"stdout","time":160.039129676,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.039133702,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":160.227345281,"data":"[PROGRESS] Step 350: t=102.96/105.00s (98.1%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":160.304268067,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.30429714,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.304278868,"data":"  Stored output at t = 105.0000 s (Step 358)\n"}
,{"stream_name":"stderr","time":160.304449593,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.80s/s]\n"}
,{"stream_name":"stdout","time":160.30446791,"data":"\n"}
,{"stream_name":"stdout","time":160.304472657,"data":"Simulation finished at t = 105.0000 s after 358 steps.\n"}
,{"stream_name":"stdout","time":160.304492668,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":160.306303041,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.306528599,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.306547185,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.306553461,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.30657161,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.306752769,"data":"\n"}
,{"stream_name":"stdout","time":160.504546793,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #13000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":160.504592158,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":160.504598242,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":160.50460205,"data":"[PERIODIC:1000] BC_GPU [Call #13000] About to launch kernel\n"}
,{"stream_name":"stdout","time":160.504605754,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":160.504609495,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":160.504613297,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":160.711959816,"data":"[PROGRESS] Step 400: t=117.09/120.00s (97.6%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":160.841540824,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.841580023,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.841581228,"data":"  Stored output at t = 120.0000 s (Step 411)\n"}
,{"stream_name":"stderr","time":160.841859189,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.04s/s]\n"}
,{"stream_name":"stdout","time":160.841873362,"data":"\n"}
,{"stream_name":"stdout","time":160.841884402,"data":"Simulation finished at t = 120.0000 s after 411 steps.\n"}
,{"stream_name":"stdout","time":160.841888313,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":160.84350593,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.843524048,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":160.843528583,"data":"\n"}
,{"stream_name":"stdout","time":160.843532294,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.84353615,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":160.843540681,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.843574157,"data":"\n"}
,{"stream_name":"stdout","time":160.843582417,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":160.84358704,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":160.851281601,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":160.851300235,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":160.851305945,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":160.851310161,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":160.851314356,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":160.851318636,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":160.851322438,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":160.851325948,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":160.851330978,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":160.851334858,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.851403394,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":160.851411729,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":160.8520237,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":160.852037767,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":160.852289337,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":160.852545202,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.852552516,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.852579287,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.854544923,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":160.854555603,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":160.854573638,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":160.854577849,"data":"|    ep_rew_mean      | 0.0925   |\n"}
,{"stream_name":"stdout","time":160.854581955,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":160.854585973,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":160.854590044,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":160.854594142,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":160.854598054,"data":"|    time_elapsed     | 33       |\n"}
,{"stream_name":"stdout","time":160.854602544,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":160.854607029,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":160.855633162,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.855660494,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.855665541,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.85566928,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.855797463,"data":"\n"}
,{"stream_name":"stdout","time":161.036048757,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":161.036073248,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.036078592,"data":"  Original dt: 5.338865e-01 s\n"}
,{"stream_name":"stdout","time":161.036082598,"data":"  Corrected dt: 3.336791e-01 s\n"}
,{"stream_name":"stdout","time":161.036086467,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.036090252,"data":"  Max wave speed detected: 14.98 m/s\n"}
,{"stream_name":"stdout","time":161.246725313,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":161.246753903,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.246771775,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.246944526,"data":"\n"}
,{"stream_name":"stdout","time":161.24695238,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":161.24695694,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":161.24695443,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.37s/s]\n"}
,{"stream_name":"stdout","time":161.248460302,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":161.248476127,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":161.248813161,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":161.248822936,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":161.249036513,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":161.249256413,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":161.249467554,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":161.249715512,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":161.249729355,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":161.249833573,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":161.249906839,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":161.249972459,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":161.250041654,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":161.250048739,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":161.250103226,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.250482505,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.250493242,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.250497587,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.250501705,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.250655825,"data":"\n"}
,{"stream_name":"stdout","time":161.324787117,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":161.72455357,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":161.724631829,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.724654818,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":161.724940589,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.64s/s]\n"}
,{"stream_name":"stdout","time":161.724963291,"data":"\n"}
,{"stream_name":"stdout","time":161.724984075,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":161.724990539,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":161.726796169,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.727138022,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.727148444,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.727155645,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.72716505,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.727319095,"data":"\n"}
,{"stream_name":"stdout","time":161.794451527,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":161.972928799,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":161.972954551,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.972961033,"data":"  Original dt: 4.621613e-01 s\n"}
,{"stream_name":"stdout","time":161.972966428,"data":"  Corrected dt: 2.888508e-01 s\n"}
,{"stream_name":"stdout","time":161.972971508,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.972976451,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stdout","time":162.218167834,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":162.218228869,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.218264825,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":162.218507339,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.56s/s]\n"}
,{"stream_name":"stdout","time":162.218520064,"data":"\n"}
,{"stream_name":"stdout","time":162.218532456,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":162.218537121,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":162.220340947,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.220665026,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.220682127,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.220686979,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.220690969,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.220868508,"data":"\n"}
,{"stream_name":"stdout","time":162.271480461,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":162.730991673,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":162.731002949,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.731027487,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.731264762,"data":"\n"}
,{"stream_name":"stdout","time":162.731273574,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":162.731278187,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":162.731264734,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.40s/s]\n"}
,{"stream_name":"stdout","time":162.733198061,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.733531804,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.733540832,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.733545165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.733549024,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.7337235,"data":"\n"}
,{"stream_name":"stdout","time":162.753169489,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":162.916863488,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #14000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":162.916907828,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":162.916913846,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":162.916917888,"data":"[PERIODIC:1000] BC_GPU [Call #14000] About to launch kernel\n"}
,{"stream_name":"stdout","time":162.916921762,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":162.916925481,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":162.916929438,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":162.933768135,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":162.933792217,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.933797703,"data":"  Original dt: 4.606706e-01 s\n"}
,{"stream_name":"stdout","time":162.933801735,"data":"  Corrected dt: 2.879191e-01 s\n"}
,{"stream_name":"stdout","time":162.933805877,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.93380984,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":163.22426076,"data":"[PROGRESS] Step 250: t=74.97/75.00s (100.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":163.233673082,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.233698625,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.233709474,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stdout","time":163.233827929,"data":"\n"}
,{"stream_name":"stdout","time":163.233836814,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stderr","time":163.233836157,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.02s/s]\n"}
,{"stream_name":"stdout","time":163.233841198,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":163.235581714,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.235929465,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.235937247,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.235941772,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.235946298,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.236099332,"data":"\n"}
,{"stream_name":"stdout","time":163.704230857,"data":"[PROGRESS] Step 300: t=89.11/90.00s (99.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":163.745016625,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.745045882,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.74504794,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stdout","time":163.745236867,"data":"\n"}
,{"stream_name":"stdout","time":163.745247205,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":163.745252116,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":163.745280587,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.48s/s]\n"}
,{"stream_name":"stdout","time":163.747109133,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.747325419,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.747337246,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.747341808,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.747345911,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.747514843,"data":"\n"}
,{"stream_name":"stdout","time":163.898525325,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":163.898574446,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.898581365,"data":"  Original dt: 4.606739e-01 s\n"}
,{"stream_name":"stdout","time":163.898585998,"data":"  Corrected dt: 2.879212e-01 s\n"}
,{"stream_name":"stdout","time":163.89859018800001,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.898597321,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":164.197738547,"data":"[PROGRESS] Step 350: t=103.24/105.00s (98.3%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":164.266083031,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":164.266082814,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":164.266108621,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.266259419,"data":"\n"}
,{"stream_name":"stdout","time":164.266274421,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":164.266279753,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":164.266293648,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.93s/s]\n"}
,{"stream_name":"stdout","time":164.268066536,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.268369359,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.268382777,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.268387662,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.268406376,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.268616285,"data":"\n"}
,{"stream_name":"stdout","time":164.675006005,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":164.77445548,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stderr","time":164.774454603,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.774501124,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.774717708,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.66s/s]\n"}
,{"stream_name":"stdout","time":164.774734891,"data":"\n"}
,{"stream_name":"stdout","time":164.774756504,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":164.774762212,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":164.77647994,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.77649331,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":164.776497653,"data":"\n"}
,{"stream_name":"stdout","time":164.776501335,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.77650513,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":164.776509101,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.776513094,"data":"\n"}
,{"stream_name":"stdout","time":164.776516661,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":164.77652114,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":164.784050473,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":164.784065786,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":164.784069997,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":164.784074037,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":164.784077832,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":164.784244017,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":164.784258188,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":164.784263046,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":164.784267305,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":164.784271155,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.784275303,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":164.784295637,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":164.785007091,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":164.785024439,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":164.785249917,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":164.786400087,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.786416749,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.786421776,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.788335786,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.788353358,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.788358449,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.788362441,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.788576592,"data":"\n"}
,{"stream_name":"stdout","time":164.877449507,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":164.877475217,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.877480891,"data":"  Original dt: 6.115282e-01 s\n"}
,{"stream_name":"stdout","time":164.877485014,"data":"  Corrected dt: 3.822051e-01 s\n"}
,{"stream_name":"stdout","time":164.877488621,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.877492742,"data":"  Max wave speed detected: 13.08 m/s\n"}
,{"stream_name":"stdout","time":165.210896305,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":165.210896307,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.210949868,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.211067601,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 35.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 35.52s/s]\n"}
,{"stream_name":"stdout","time":165.211110902,"data":"\n"}
,{"stream_name":"stdout","time":165.211127904,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":165.211133525,"data":"Total runtime: 0.42 seconds.\n"}
,{"stream_name":"stdout","time":165.212842036,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":165.212859844,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":165.212973192,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":165.212985707,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":165.213163117,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":165.213322452,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":165.213519573,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":165.213733507,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":165.213747724,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":165.213839247,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":165.213915998,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":165.213962476,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":165.213981239,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":165.214045514,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":165.21408185,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.214445728,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.214452599,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.214457532,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.214461932,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.21465065,"data":"\n"}
,{"stream_name":"stdout","time":165.300324194,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":165.367233423,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #15000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":165.367262662,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":165.36726824,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":165.367272554,"data":"[PERIODIC:1000] BC_GPU [Call #15000] About to launch kernel\n"}
,{"stream_name":"stdout","time":165.367277334,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":165.367281512,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":165.36728537,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":165.71922484,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":165.719224944,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.719256775,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.71938321,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 29.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 29.73s/s]\n"}
,{"stream_name":"stdout","time":165.719396404,"data":"\n"}
,{"stream_name":"stdout","time":165.719405462,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":165.71942384,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":165.721152296,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.721439606,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.721451101,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.721455753,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.721459511,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.721621446,"data":"\n"}
,{"stream_name":"stdout","time":165.781241431,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":165.871294025,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":165.871323597,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.871329543,"data":"  Original dt: 4.617024e-01 s\n"}
,{"stream_name":"stdout","time":165.871333282,"data":"  Corrected dt: 2.885640e-01 s\n"}
,{"stream_name":"stdout","time":165.871336928,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.871340533,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":166.277404141,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":166.277416573,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":166.277432149,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.277645741,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 27.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.99s/s]\n"}
,{"stream_name":"stdout","time":166.277695318,"data":"\n"}
,{"stream_name":"stdout","time":166.277720788,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":166.277725444,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":166.279486894,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.27986554699999,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.27988379,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.279900376,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.279904947,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.280047642,"data":"\n"}
,{"stream_name":"stdout","time":166.310613513,"data":"[PROGRESS] Step 150: t=45.86/60.00s (76.4%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":166.794641057,"data":"[PROGRESS] Step 200: t=60.00/60.00s (100.0%) | dt=0.0260s\n"}
,{"stream_name":"stdout","time":166.794949133,"data":"  Stored output at t = 60.0000 s (Step 200)\n"}
,{"stream_name":"stderr","time":166.7949535,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.794963133,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.795349639,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.12s/s]\n"}
,{"stream_name":"stdout","time":166.795352498,"data":"\n"}
,{"stream_name":"stdout","time":166.795368419,"data":"Simulation finished at t = 60.0000 s after 200 steps.\n"}
,{"stream_name":"stdout","time":166.795373303,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":166.797042201,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.797502982,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.797513671,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.797518669,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.797523089,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.797720808,"data":"\n"}
,{"stream_name":"stdout","time":166.884334632,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":166.884362526,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.884368937,"data":"  Original dt: 4.606627e-01 s\n"}
,{"stream_name":"stdout","time":166.884372876,"data":"  Corrected dt: 2.879142e-01 s\n"}
,{"stream_name":"stdout","time":166.884376868,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.884380812,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":167.28330523,"data":"[PROGRESS] Step 250: t=74.40/75.00s (99.2%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":167.314475981,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.314503044,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.314475983,"data":"  Stored output at t = 75.0000 s (Step 253)\n"}
,{"stream_name":"stdout","time":167.314739342,"data":"\n"}
,{"stream_name":"stdout","time":167.314753534,"data":"Simulation finished at t = 75.0000 s after 253 steps.\n"}
,{"stream_name":"stdout","time":167.314758728,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":167.314739067,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.03s/s]\n"}
,{"stream_name":"stdout","time":167.316512068,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":167.31680509,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.316817733,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.316823043,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.316827751,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.316993985,"data":"\n"}
,{"stream_name":"stdout","time":167.775716476,"data":"[PROGRESS] Step 300: t=88.53/90.00s (98.4%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":167.834210489,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.834239443,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.834210487,"data":"  Stored output at t = 90.0000 s (Step 306)\n"}
,{"stream_name":"stdout","time":167.83433339,"data":"\n"}
,{"stream_name":"stderr","time":167.834340236,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.01s/s]\n"}
,{"stream_name":"stdout","time":167.834345307,"data":"Simulation finished at t = 90.0000 s after 306 steps.\n"}
,{"stream_name":"stdout","time":167.834353142,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":167.836136707,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":167.836359193,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.836369695,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.836374482,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.836379492,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.836551604,"data":"\n"}
,{"stream_name":"stdout","time":167.846310494,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #16000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":167.846328814,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":167.846333708,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":167.846339441,"data":"[PERIODIC:1000] BC_GPU [Call #16000] About to launch kernel\n"}
,{"stream_name":"stdout","time":167.846343212,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":167.846349039,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":167.846353003,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":167.866221322,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":167.866246665,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.866252669,"data":"  Original dt: 4.606417e-01 s\n"}
,{"stream_name":"stdout","time":167.866269765,"data":"  Corrected dt: 2.879011e-01 s\n"}
,{"stream_name":"stdout","time":167.866273927,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.866277727,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":168.265084291,"data":"[PROGRESS] Step 350: t=102.67/105.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":168.354335288,"data":"  Stored output at t = 105.0000 s (Step 359)\n"}
,{"stream_name":"stderr","time":168.354334104,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.354374916,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":168.354636901,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.97s/s]\n"}
,{"stream_name":"stdout","time":168.354639225,"data":"\n"}
,{"stream_name":"stdout","time":168.354676722,"data":"Simulation finished at t = 105.0000 s after 359 steps.\n"}
,{"stream_name":"stdout","time":168.354681498,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":168.356463428,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":168.356772637,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.356789655,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.356794769,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.356798692,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.35694751,"data":"\n"}
,{"stream_name":"stdout","time":168.751946646,"data":"[PROGRESS] Step 400: t=116.80/120.00s (97.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":168.838098898,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":168.838125736,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.838131056,"data":"  Original dt: 4.606415e-01 s\n"}
,{"stream_name":"stdout","time":168.838135144,"data":"  Corrected dt: 2.879009e-01 s\n"}
,{"stream_name":"stdout","time":168.838139403,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.838143078,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stderr","time":168.866260245,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.866294449,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.866262585,"data":"  Stored output at t = 120.0000 s (Step 412)\n"}
,{"stream_name":"stdout","time":168.866381143,"data":"\n"}
,{"stream_name":"stderr","time":168.86638114,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.46s/s]\n"}
,{"stream_name":"stdout","time":168.866388908,"data":"Simulation finished at t = 120.0000 s after 412 steps.\n"}
,{"stream_name":"stdout","time":168.866412534,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":168.868116392,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.868134073,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":168.868138996,"data":"\n"}
,{"stream_name":"stdout","time":168.868142798,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.868146536,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":168.868154363,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.868158195,"data":"\n"}
,{"stream_name":"stdout","time":168.868161836,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":168.868166094,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":168.875642813,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":168.875660114,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":168.875664816,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":168.875668861,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":168.875673069,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":168.875677045,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":168.875680931,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":168.875684616,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":168.875688574,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":168.875692548,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.875701101,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":168.875705257,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":168.876314753,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":168.876326959,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":168.876605416,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":168.876871889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.876879701,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.876883886,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.879055586,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.879073148,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.879079213,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stderr","time":168.879087589,"data":"\n"}
,{"stream_name":"stdout","time":168.879095641,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":169.276775208,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":169.276806616,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.276823539,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.277017546,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.72s/s]\n"}
,{"stream_name":"stdout","time":169.277033616,"data":"\n"}
,{"stream_name":"stdout","time":169.277038316,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":169.277042985,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":169.278705754,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":169.278721846,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":169.278871192,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":169.278882572,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":169.279034798,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":169.279212013,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":169.279378808,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":169.279550653,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":169.279577041,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":169.279667161,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":169.279726683,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":169.27974575,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":169.279798949,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":169.279874221,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":169.279881896,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.280264231,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.280275375,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.280280258,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.28030069,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.280439273,"data":"\n"}
,{"stream_name":"stdout","time":169.355604494,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stderr","time":169.758966751,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.758999072,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.758982583,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":169.759018325,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.37s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.36s/s]\n"}
,{"stream_name":"stdout","time":169.759019885,"data":"\n"}
,{"stream_name":"stdout","time":169.759033557,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":169.759038267,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":169.760749913,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.761090132,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.761098033,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.761102215,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.761106208,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.76126985,"data":"\n"}
,{"stream_name":"stdout","time":169.802074994,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":169.802100987,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.802106518,"data":"  Original dt: 4.635163e-01 s\n"}
,{"stream_name":"stdout","time":169.802111428,"data":"  Corrected dt: 2.896977e-01 s\n"}
,{"stream_name":"stdout","time":169.802115205,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.802118928,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stdout","time":169.830365804,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":170.26691835,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #17000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":170.266948356,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":170.266953668,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":170.266957781,"data":"[PERIODIC:1000] BC_GPU [Call #17000] About to launch kernel\n"}
,{"stream_name":"stdout","time":170.266961968,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":170.266966826,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":170.2669706,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":170.270754245,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":170.270785358,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.270792416,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.271117564,"data":"\n"}
,{"stream_name":"stdout","time":170.271126859,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":170.271146743,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":170.271121345,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.43s/s]\n"}
,{"stream_name":"stdout","time":170.272828067,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.273157697,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.273167622,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.273172076,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.273176377,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.273321822,"data":"\n"}
,{"stream_name":"stdout","time":170.321372851,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":170.793138346,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":170.793196819,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.793202951,"data":"  Original dt: 4.610997e-01 s\n"}
,{"stream_name":"stdout","time":170.793207353,"data":"  Corrected dt: 2.881873e-01 s\n"}
,{"stream_name":"stdout","time":170.793211341,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.79321555799999,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stderr","time":170.803914332,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.803951131,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.803967601,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":170.804234786,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.26s/s]\n"}
,{"stream_name":"stdout","time":170.804247668,"data":"\n"}
,{"stream_name":"stdout","time":170.804250578,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":170.804253308,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":170.806110642,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.806575759,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.80660335,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.806608881,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.806613196,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.806792651,"data":"\n"}
,{"stream_name":"stdout","time":170.832599478,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":171.297606102,"data":"[PROGRESS] Step 250: t=74.99/75.00s (100.0%) | dt=0.2884s\n"}
,{"stream_name":"stdout","time":171.307805155,"data":"  Stored output at t = 75.0000 s (Step 251)\n"}
,{"stream_name":"stderr","time":171.307804652,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.30783711,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":171.308038661,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.94s/s]\n"}
,{"stream_name":"stdout","time":171.308043295,"data":"\n"}
,{"stream_name":"stdout","time":171.30806306,"data":"Simulation finished at t = 75.0000 s after 251 steps.\n"}
,{"stream_name":"stdout","time":171.308080725,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":171.309544682,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.30991958,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.309930649,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.309934894,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.309938782,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.310110114,"data":"\n"}
,{"stream_name":"stdout","time":171.743399856,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":171.743427585,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.743433559,"data":"  Original dt: 4.611006e-01 s\n"}
,{"stream_name":"stdout","time":171.743437967,"data":"  Corrected dt: 2.881879e-01 s\n"}
,{"stream_name":"stdout","time":171.7434417,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.743445435,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":171.771858881,"data":"[PROGRESS] Step 300: t=89.13/90.00s (99.0%) | dt=0.2882s\n"}
,{"stream_name":"stdout","time":171.811117526,"data":"  Stored output at t = 90.0000 s (Step 304)\n"}
,{"stream_name":"stderr","time":171.811117261,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.811148029,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":171.811449144,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.93s/s]\n"}
,{"stream_name":"stdout","time":171.811450957,"data":"\n"}
,{"stream_name":"stdout","time":171.811482636,"data":"Simulation finished at t = 90.0000 s after 304 steps.\n"}
,{"stream_name":"stdout","time":171.811487301,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":171.813202037,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":171.813433622,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.813445181,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.813450139,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.813454228,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.813616988,"data":"\n"}
,{"stream_name":"stdout","time":172.248086475,"data":"[PROGRESS] Step 350: t=103.25/105.00s (98.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":172.315152425,"data":"  Stored output at t = 105.0000 s (Step 357)\n"}
,{"stream_name":"stderr","time":172.315152412,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.315183819,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":172.31539703,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.91s/s]\n"}
,{"stream_name":"stdout","time":172.315401047,"data":"\n"}
,{"stream_name":"stdout","time":172.315418803,"data":"Simulation finished at t = 105.0000 s after 357 steps.\n"}
,{"stream_name":"stdout","time":172.31542291,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":172.317091531,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.317392205,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.317400784,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.317405353,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.317409249,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.3175892,"data":"\n"}
,{"stream_name":"stdout","time":172.67084768,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #18000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":172.670877967,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":172.670883672,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.67088743,"data":"[PERIODIC:1000] BC_GPU [Call #18000] About to launch kernel\n"}
,{"stream_name":"stdout","time":172.670905823,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.670909977,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":172.670914045,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":172.69388553,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":172.693911669,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.693917337,"data":"  Original dt: 4.606878e-01 s\n"}
,{"stream_name":"stdout","time":172.693921501,"data":"  Corrected dt: 2.879299e-01 s\n"}
,{"stream_name":"stdout","time":172.693925553,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.693932832,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":172.721268212,"data":"[PROGRESS] Step 400: t=117.38/120.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":172.817310422,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.817345711,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.817310299,"data":"  Stored output at t = 120.0000 s (Step 410)\n"}
,{"stream_name":"stdout","time":172.817423981,"data":"\n"}
,{"stream_name":"stdout","time":172.817436057,"data":"Simulation finished at t = 120.0000 s after 410 steps.\n"}
,{"stream_name":"stdout","time":172.817440371,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":172.817440815,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.03s/s]\n"}
,{"stream_name":"stdout","time":172.819143015,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.819160828,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":172.819166546,"data":"\n"}
,{"stream_name":"stdout","time":172.819170521,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":172.819174946,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":172.819179341,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":172.819183965,"data":"\n"}
,{"stream_name":"stdout","time":172.819188163,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":172.819192814,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":172.82788794,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":172.827904363,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":172.827909075,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":172.827913262,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":172.827917051,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":172.828022563,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":172.8280376,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":172.828043726,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":172.828058033,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":172.828064969,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.828069351,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":172.828073209,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":172.828762483,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":172.828780045,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":172.829024128,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":172.82965156,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.829668555,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.829673764,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.831659275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.831676264,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.831681798,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.83168614,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.831881105,"data":"\n"}
,{"stream_name":"stderr","time":173.226519105,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":173.226516951,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":173.226544689,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":173.226610092,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.02s/s]\n"}
,{"stream_name":"stdout","time":173.226635405,"data":"\n"}
,{"stream_name":"stdout","time":173.226644057,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":173.226647798,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":173.22828943,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":173.228307632,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":173.228422803,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14603168 1.         0.01493883 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":173.228430133,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":173.228730558,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":173.228928222,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":173.229123976,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.0438095  0.03262903 0.03034418 0.02996341 0.03010527 0.03041322]\n"}
,{"stream_name":"stdout","time":173.229319766,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224082 0.00150904 0.00135055 0.00132992 0.00136401 0.00144202]\n"}
,{"stream_name":"stdout","time":173.229327031,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":173.229403664,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":173.229476604,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":173.22954354,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":173.229549596,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":173.229631123,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":173.229658953,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.230079313,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.230085907,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.23009024,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.230095593,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.230292856,"data":"\n"}
,{"stream_name":"stdout","time":173.306777815,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":173.657967555,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":173.65799737,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.65800313,"data":"  Original dt: 4.636925e-01 s\n"}
,{"stream_name":"stdout","time":173.658007738,"data":"  Corrected dt: 2.898078e-01 s\n"}
,{"stream_name":"stdout","time":173.658011698,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.658015357,"data":"  Max wave speed detected: 17.25 m/s\n"}
,{"stream_name":"stdout","time":173.723326568,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":173.723326664,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.723357839,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.723609907,"data":"\n"}
,{"stream_name":"stdout","time":173.723622699,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":173.723626846,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":173.723620839,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.42s/s]\n"}
,{"stream_name":"stdout","time":173.725557656,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.725941756,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.725950353,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.72595548,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.725959636,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.726117784,"data":"\n"}
,{"stream_name":"stdout","time":173.78340119,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2891s\n"}
,{"stream_name":"stdout","time":174.225380837,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":174.225380917,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.225413797,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.22565715,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.05s/s]\n"}
,{"stream_name":"stdout","time":174.225676229,"data":"\n"}
,{"stream_name":"stdout","time":174.225696453,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":174.225701366,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":174.227514797,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.227761041,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.227777407,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.227782418,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.227787011,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.227943595,"data":"\n"}
,{"stream_name":"stdout","time":174.266615071,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2885s\n"}
,{"stream_name":"stdout","time":174.613010106,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":174.613039708,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.613045394,"data":"  Original dt: 4.611883e-01 s\n"}
,{"stream_name":"stdout","time":174.613049718,"data":"  Corrected dt: 2.882427e-01 s\n"}
,{"stream_name":"stdout","time":174.61305384,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.613057974,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stderr","time":174.723980158,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.724013395,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.723979156,"data":"  Stored output at t = 60.0000 s (Step 199)\n"}
,{"stream_name":"stderr","time":174.724059146,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.25s/s]\n"}
,{"stream_name":"stdout","time":174.724058788,"data":"\n"}
,{"stream_name":"stdout","time":174.724070185,"data":"Simulation finished at t = 60.0000 s after 199 steps.\n"}
,{"stream_name":"stdout","time":174.724074858,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":174.725802733,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.726127952,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.72613686,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.72614134,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.726145113,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.726311603,"data":"\n"}
,{"stream_name":"stdout","time":174.736827931,"data":"[PROGRESS] Step 200: t=60.29/75.00s (80.4%) | dt=0.2881s\n"}
,{"stream_name":"stdout","time":175.069164699,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #19000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":175.069191784,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":175.069198969,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.069202386,"data":"[PERIODIC:1000] BC_GPU [Call #19000] About to launch kernel\n"}
,{"stream_name":"stdout","time":175.069205328,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.069208081,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":175.069214526,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":175.213270051,"data":"[PROGRESS] Step 250: t=74.69/75.00s (99.6%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":175.232610765,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.232640555,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.232610767,"data":"  Stored output at t = 75.0000 s (Step 252)\n"}
,{"stream_name":"stderr","time":175.232917982,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.64s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.62s/s]\n"}
,{"stream_name":"stdout","time":175.232926582,"data":"\n"}
,{"stream_name":"stdout","time":175.232933565,"data":"Simulation finished at t = 75.0000 s after 252 steps.\n"}
,{"stream_name":"stdout","time":175.23293838,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":175.234748298,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.23503181,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.235040899,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.235045987,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.235050666,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.235213574,"data":"\n"}
,{"stream_name":"stdout","time":175.560593808,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":175.560622336,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.560628536,"data":"  Original dt: 4.610317e-01 s\n"}
,{"stream_name":"stdout","time":175.560632338,"data":"  Corrected dt: 2.881448e-01 s\n"}
,{"stream_name":"stdout","time":175.560636056,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.560641359,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":175.682590847,"data":"[PROGRESS] Step 300: t=88.83/90.00s (98.7%) | dt=0.2882s\n"}
,{"stream_name":"stderr","time":175.73040256,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.730429004,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.730465458,"data":"  Stored output at t = 90.0000 s (Step 305)\n"}
,{"stream_name":"stderr","time":175.730832124,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.28s/s]\n"}
,{"stream_name":"stdout","time":175.73084579,"data":"\n"}
,{"stream_name":"stdout","time":175.730858318,"data":"Simulation finished at t = 90.0000 s after 305 steps.\n"}
,{"stream_name":"stdout","time":175.730863345,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":175.732455691,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.732835888,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.732852605,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.732858048,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.732863112,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.733022326,"data":"\n"}
,{"stream_name":"stdout","time":176.152747127,"data":"[PROGRESS] Step 350: t=102.97/105.00s (98.1%) | dt=0.2882s\n"}
,{"stream_name":"stderr","time":176.22901077,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.229045014,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.22901042,"data":"  Stored output at t = 105.0000 s (Step 358)\n"}
,{"stream_name":"stdout","time":176.229285042,"data":"\n"}
,{"stream_name":"stderr","time":176.22928228,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.24s/s]\n"}
,{"stream_name":"stdout","time":176.229294793,"data":"Simulation finished at t = 105.0000 s after 358 steps.\n"}
,{"stream_name":"stdout","time":176.229313153,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":176.230995956,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.231333498,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.231340922,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":176.231345079,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.231348812,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.231529548,"data":"\n"}
,{"stream_name":"stdout","time":176.502629954,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":176.502651047,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.502654857,"data":"  Original dt: 4.608553e-01 s\n"}
,{"stream_name":"stdout","time":176.502657581,"data":"  Corrected dt: 2.880346e-01 s\n"}
,{"stream_name":"stdout","time":176.502660189,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.502662743,"data":"  Max wave speed detected: 17.36 m/s\n"}
,{"stream_name":"stdout","time":176.620621122,"data":"[PROGRESS] Step 400: t=117.10/120.00s (97.6%) | dt=0.2881s\n"}
,{"stream_name":"stderr","time":176.72202343,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.722052881,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":176.722082013,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.60s/s]\n"}
,{"stream_name":"stdout","time":176.722082081,"data":"  Stored output at t = 120.0000 s (Step 411)\n"}
,{"stream_name":"stdout","time":176.722111318,"data":"\n"}
,{"stream_name":"stdout","time":176.722115718,"data":"Simulation finished at t = 120.0000 s after 411 steps.\n"}
,{"stream_name":"stdout","time":176.722119461,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":176.723902217,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.723919263,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":176.723923955,"data":"\n"}
,{"stream_name":"stdout","time":176.723927733,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":176.723931947,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":176.723949079,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":176.723953016,"data":"\n"}
,{"stream_name":"stdout","time":176.723956603,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":176.7239605,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":176.731576884,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":176.731593415,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":176.731598322,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":176.731601985,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":176.73160554,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":176.73176445000001,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":176.73177316,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":176.731777025,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":176.731780445,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":176.731784305,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.731788268,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":176.731792259,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":176.732365902,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":176.732376731,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":176.73263941,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":176.733212244,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.7332228,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.733227413,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.735188133,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":176.735204694,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":176.735209036,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":176.735213313,"data":"|    ep_rew_mean      | 0.095    |\n"}
,{"stream_name":"stdout","time":176.735217432,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":176.735221126,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":176.735225342,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":176.735229194,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":176.735233029,"data":"|    time_elapsed     | 49       |\n"}
,{"stream_name":"stdout","time":176.735236637,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":176.735240388,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":176.736215941,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.736247365,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.73625289,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.736257114,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.736392483,"data":"\n"}
,{"stream_name":"stderr","time":177.128656087,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.128685135,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.128658974,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":177.128946162,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.24s/s]\n"}
,{"stream_name":"stdout","time":177.128949905,"data":"\n"}
,{"stream_name":"stdout","time":177.128970559,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":177.128975195,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":177.130573924,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":177.13058891,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":177.130828543,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":177.130836283,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":177.131031382,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":177.131204024,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":177.13138708,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":177.131583887,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":177.131594748,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":177.131691119,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":177.13174401,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":177.131831792,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":177.131839052,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":177.131857812,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":177.131929881,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.132289326,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.132316866,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.132322041,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.132325783,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.132462364,"data":"\n"}
,{"stream_name":"stdout","time":177.206863309,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":177.426682476,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #20000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":177.426709978,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":177.426716026,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.426720343,"data":"[PERIODIC:1000] BC_GPU [Call #20000] About to launch kernel\n"}
,{"stream_name":"stdout","time":177.426724392,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.426728559,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":177.42673429,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":177.453058685,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":177.453085321,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.453090948,"data":"  Original dt: 4.657999e-01 s\n"}
,{"stream_name":"stdout","time":177.453096292,"data":"  Corrected dt: 2.911249e-01 s\n"}
,{"stream_name":"stdout","time":177.453099952,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.453103521,"data":"  Max wave speed detected: 17.17 m/s\n"}
,{"stream_name":"stdout","time":177.620360403,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":177.62036069,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.620395661,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.6204955,"data":"\n"}
,{"stream_name":"stdout","time":177.620503378,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":177.620508216,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":177.620545613,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":177.62233035,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.622665343,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.62267722,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.622681857,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.622685842,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.622893045,"data":"\n"}
,{"stream_name":"stdout","time":177.679712703,"data":"[PROGRESS] Step 100: t=31.74/45.00s (70.5%) | dt=0.2895s\n"}
,{"stream_name":"stdout","time":178.122318122,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":178.122375304,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.122387974,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.122416484,"data":"\n"}
,{"stream_name":"stdout","time":178.1224215,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":178.122425978,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":178.122438606,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.04s/s]\n"}
,{"stream_name":"stdout","time":178.124163779,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.124375519,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.124384323,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.124388652,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.124392856,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.124554802,"data":"\n"}
,{"stream_name":"stdout","time":178.161431106,"data":"[PROGRESS] Step 150: t=46.15/60.00s (76.9%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":178.413935998,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":178.413964741,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.413970554,"data":"  Original dt: 4.615251e-01 s\n"}
,{"stream_name":"stdout","time":178.413974213,"data":"  Corrected dt: 2.884532e-01 s\n"}
,{"stream_name":"stdout","time":178.413978079,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.413981699,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":178.617902591,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.617931341,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.617935094,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":178.618123473,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":178.618126775,"data":"\n"}
,{"stream_name":"stdout","time":178.618142358,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":178.618146375,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":178.619908441,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.633465208,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":178.633518271,"data":"\n"}
,{"stream_name":"stdout","time":178.633530797,"data":"✅ Training completed in 0.9 minutes (51.3s)\n"}
,{"stream_name":"stdout","time":178.637143179,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:51 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":178.637161032,"data":"\n"}
,{"stream_name":"stdout","time":178.637165176,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.637169035,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":178.637173101,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.637176722,"data":"\n"}
,{"stream_name":"stdout","time":178.641640805,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":178.641821298,"data":"2025-10-21 10:49:40 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":178.642096124,"data":"2025-10-21 10:49:40 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":178.642334502,"data":"2025-10-21 10:49:40 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":178.642638734,"data":"2025-10-21 10:49:40 - INFO - _save_rl_cache:528 - [CACHE RL] Saved metadata to traffic_light_control_25b78b90_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":178.642650409,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_25b78b90_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":178.642883307,"data":"\n"}
,{"stream_name":"stdout","time":178.642890761,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":178.642895686,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":178.642900219,"data":"\n"}
,{"stream_name":"stdout","time":178.642904383,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":178.642981087,"data":"2025-10-21 10:49:40 - INFO - run_performance_comparison:1305 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.643069403,"data":"2025-10-21 10:49:40 - INFO - run_performance_comparison:1306 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":178.643139855,"data":"2025-10-21 10:49:40 - INFO - run_performance_comparison:1307 - Device: gpu\n"}
,{"stream_name":"stdout","time":178.643243932,"data":"2025-10-21 10:49:40 - INFO - run_performance_comparison:1308 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.647264518,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.647303029,"data":"2025-10-21 10:49:40 - INFO - _create_scenario_config:614 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.647432544,"data":"2025-10-21 10:49:40 - INFO - _create_scenario_config:615 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":178.647526127,"data":"2025-10-21 10:49:40 - INFO - _create_scenario_config:616 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":178.647633252,"data":"2025-10-21 10:49:40 - INFO - _create_scenario_config:617 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":178.647645737,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":178.647651534,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":178.647817356,"data":"2025-10-21 10:49:40 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":178.647927771,"data":"2025-10-21 10:49:40 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":178.648309918,"data":"2025-10-21 10:49:40 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":178.648411035,"data":"2025-10-21 10:49:40 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":178.648418937,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":178.648424156,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":178.648428619,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":178.648449122,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s (40 steps) → 615.0s (41 steps) [+1 steps]\n"}
,{"stream_name":"stdout","time":178.648544545,"data":"2025-10-21 10:49:40 - INFO - _extend_baseline_cache:452 - [CACHE] Extending cache additively: 40 steps → target 41 steps (missing 1 steps = 15.0s)\n"}
,{"stream_name":"stdout","time":178.648596885,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":178.648607806,"data":"  [CACHE] Running ONLY extension: 15.0s...\n"}
,{"stream_name":"stdout","time":178.648635525,"data":"  [QUICK TEST] Reduced duration to 15.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":178.648642613,"data":"  [INFO] Expected control steps: 2 (duration=15.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":178.648741296,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:746 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.648819204,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:747 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":178.648891201,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:748 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.648981233,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:749 -   - duration: 15.0s\n"}
,{"stream_name":"stdout","time":178.649053118,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:750 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":178.649148018,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:751 -   - device: gpu\n"}
,{"stream_name":"stdout","time":178.649210351,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:752 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":178.649292091,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:753 -   - max_control_steps: 2\n"}
,{"stream_name":"stdout","time":178.649366897,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:754 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.649406821,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":178.649469989,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:759 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":178.649868196,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.649880323,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":178.657400216,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":178.657419281,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":178.657424862,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":178.657428768,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":178.657432662,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":178.657479689,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":178.657488318,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":178.65749337,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":178.657592247,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":178.657610121,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.657615277,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":178.657618985,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":178.658257901,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":178.658265836,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":178.658625428,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":178.658636146,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":178.658640722,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":178.658644838,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":178.658648695,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":178.658693578,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":178.658707077,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":178.658826481,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:774 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":178.658901752,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:775 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":178.658908772,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":178.659013036,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:791 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":178.659019385,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.659039773,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":178.6661495,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":178.666168687,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":178.666174083,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":178.66617836,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":178.66618265,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":178.666186923,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":178.666191754,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":178.666195781,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":178.666200049,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":178.666204144,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.666210679,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":178.666214367,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":178.666829683,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":178.666840784,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":178.66707279,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":178.667281436,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.667288676,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.667292746,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.668885675,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:793 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":178.668897718,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":178.66898857,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:798 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":178.669426622,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:808 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":178.669690823,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:812 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":178.669996656,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:815 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":178.670004205,"data":"  [INFO] Starting simulation loop (max 2 control steps)\n"}
,{"stream_name":"stdout","time":178.670095661,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:832 - Starting simulation loop - max 2 control steps\n"}
,{"stream_name":"stdout","time":178.670321006,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.670442132,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:847 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":178.670544674,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:848 -   Controller: BaselineController\n"}
,{"stream_name":"stdout","time":178.670699423,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:849 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":178.670797093,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:850 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":178.670834957,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.670840947,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.670864651,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.670870266,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":179.13877778,"data":"[PROGRESS] Step 50: t=14.17/15.00s (94.5%) | dt=0.2834s\n"}
,{"stream_name":"stdout","time":179.166503507,"data":"  Stored output at t = 15.0000 s (Step 53)\n"}
,{"stream_name":"stderr","time":179.166515619,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 30.29s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 30.29s/s]\n"}
,{"stream_name":"stdout","time":179.166552233,"data":"\n"}
,{"stream_name":"stdout","time":179.166579496,"data":"Simulation finished at t = 15.0000 s after 53 steps.\n"}
,{"stream_name":"stdout","time":179.166588355,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":179.1682475,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":179.168265207,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":179.168369321,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14634389 1.         0.01534385 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":179.168377135,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":179.168601604,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":179.168825896,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":179.169010575,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04390317 0.03216904 0.02933648 0.02844456 0.02812289 0.02798464]\n"}
,{"stream_name":"stdout","time":179.169221484,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00230158 0.00149844 0.00127755 0.00119743 0.00116876 0.00116291]\n"}
,{"stream_name":"stdout","time":179.169229097,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":179.169287755,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.169364056,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.169413331,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.169418693,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.169505329,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":179.169521884,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":179.169579518,"data":"DEBUG: Truncation - runner.t=15.0, episode_max_time=15.0\n"}
,{"stream_name":"stdout","time":179.169737054,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:865 -   [BASELINE] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":179.16982446,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":179.170225702,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":179.170281283,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":179.170422654,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.817353e-02, max=1.479784e+00, std=1.175295e-01\n"}
,{"stream_name":"stdout","time":179.170613036,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.030335, rho_c=0.004437\n"}
,{"stream_name":"stdout","time":179.170749502,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:895 -     Mean velocities: w_m=17.127696, w_c=14.466874\n"}
,{"stream_name":"stdout","time":179.170877232,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:899 -   State hash: 1889905575410315592\n"}
,{"stream_name":"stdout","time":179.170971658,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.17117054,"data":"    [BASELINE] [STEP 1/2] action=1.0000, reward=-0.0100, t=15.0s, state_diff=2.817353e-02\n"}
,{"stream_name":"stdout","time":179.171191584,"data":"\n"}
,{"stream_name":"stdout","time":179.171196569,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":179.171201063,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":179.171205125,"data":"    - Total control steps: 1\n"}
,{"stream_name":"stdout","time":179.171209154,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":179.171213504,"data":"    - Avg step time: 0.501s (device=gpu)\n"}
,{"stream_name":"stdout","time":179.17121784,"data":"    - Simulated time: 15.0s / 15.0s\n"}
,{"stream_name":"stdout","time":179.171222215,"data":"    - Wallclock time: 0.5s\n"}
,{"stream_name":"stdout","time":179.171226337,"data":"    - Speed ratio: 29.95x real-time\n"}
,{"stream_name":"stdout","time":179.171230478,"data":"\n"}
,{"stream_name":"stdout","time":179.171343603,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:941 - \n"}
,{"stream_name":"stdout","time":179.171351498,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":179.171355536,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":179.171359536,"data":"    - Total control steps: 1\n"}
,{"stream_name":"stdout","time":179.171363282,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":179.171367066,"data":"    - Avg step time: 0.501s (device=gpu)\n"}
,{"stream_name":"stdout","time":179.171370876,"data":"    - Simulated time: 15.0s / 15.0s\n"}
,{"stream_name":"stdout","time":179.171374692,"data":"    - Wallclock time: 0.5s\n"}
,{"stream_name":"stdout","time":179.171378421,"data":"    - Speed ratio: 29.95x real-time\n"}
,{"stream_name":"stdout","time":179.171400256,"data":"\n"}
,{"stream_name":"stdout","time":179.171466506,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:942 - Returning 1 state snapshots\n"}
,{"stream_name":"stdout","time":179.171736038,"data":"  [CACHE] ✅ Combined: 40 cached + 1 new = 41 total\n"}
,{"stream_name":"stdout","time":179.171887792,"data":"2025-10-21 10:49:40 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":179.172043277,"data":"2025-10-21 10:49:40 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":179.172770401,"data":"2025-10-21 10:49:40 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 41 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":179.172824653,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (41 steps)\n"}
,{"stream_name":"stdout","time":179.173022874,"data":"2025-10-21 10:49:40 - INFO - evaluate_traffic_performance:965 - Evaluating performance with 41 state snapshots\n"}
,{"stream_name":"stdout","time":179.173080109,"data":"2025-10-21 10:49:40 - INFO - evaluate_traffic_performance:966 -   HASH CHECK - first=8818748475076648081, last=1889905575410315592\n"}
,{"stream_name":"stdout","time":179.173525055,"data":"2025-10-21 10:49:40 - INFO - evaluate_traffic_performance:975 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":179.178552967,"data":"2025-10-21 10:49:40 - INFO - evaluate_traffic_performance:977 - Last state sample - rho_m[10:15]=[0.02783493 0.0277646  0.02768481 0.02759085 0.02747856], w_m[10:15]=[17.5094238  17.5206654  17.5308725  17.54111021 17.55175554]\n"}
,{"stream_name":"stdout","time":179.178708907,"data":"2025-10-21 10:49:40 - INFO - evaluate_traffic_performance:1031 - Calculated metrics: flow=28.391673, efficiency=4.542668, delay=-174.14s\n"}
,{"stream_name":"stdout","time":179.178717725,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":179.178824019,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":179.178836266,"data":"\n"}
,{"stream_name":"stdout","time":179.178841903,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.178846825,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":179.178851587,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":179.178855645,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":179.178859403,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":179.178863339,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":179.178867285,"data":"\n"}
,{"stream_name":"stdout","time":179.178875143,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":179.186599727,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.186615701,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.186620045,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.186635488,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.187422788,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":179.19363275,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":179.193649533,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":179.19744277,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":179.197457187,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":179.197486483,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:746 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.19766622,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:747 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":179.19768883,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:748 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.197826353,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:749 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":179.19788435,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:750 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.197975331,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:751 -   - device: gpu\n"}
,{"stream_name":"stdout","time":179.198043153,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:752 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":179.198127861,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:753 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":179.198199691,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:754 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.198237155,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":179.198339491,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:759 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":179.198656945,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.198671329,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.206156886,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.206172908,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.206177273,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.206180969,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.206184608,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.206188207,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.206192116,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.206195706,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.206199555,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.20621286,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.206218748,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.206222545,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.206809078,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.206824593,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.207110303,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.207122125,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":179.207126228,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":179.207130141,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":179.207133898,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":179.207137498,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":179.207141634,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":179.207266981,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:774 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":179.207343343,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:775 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":179.207371431,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.20745058,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:791 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":179.207471149,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":179.207476685,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":179.214832284,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":179.214850097,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":179.214855441,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":179.214860093,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":179.214864103,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":179.214965465,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":179.214974992,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":179.214992195,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":179.214995996,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":179.214999941,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.215013003,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":179.215017152,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":179.215645376,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":179.21569465,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":179.215969638,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":179.216550853,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.216595822,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.216602548,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.218192903,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:793 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":179.218369512,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:812 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":179.218379017,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":179.218454142,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:832 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":179.303045298,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":179.303070048,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.303142845,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:847 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":179.303205324,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":179.303320173,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":179.303380661,"data":"2025-10-21 10:49:40 - INFO - run_control_simulation:850 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":179.303453932,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.303464122,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.303469912,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.30347422,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":179.53604311,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":179.536066821,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.536071958,"data":"  Original dt: 5.136792e-01 s\n"}
,{"stream_name":"stdout","time":179.536075805,"data":"  Corrected dt: 3.210495e-01 s\n"}
,{"stream_name":"stdout","time":179.536079482,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.53608308,"data":"  Max wave speed detected: 15.57 m/s\n"}
,{"stream_name":"stdout","time":179.691657194,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":179.691887043,"data":"\n"}
,{"stream_name":"stderr","time":179.691897174,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.68s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.66s/s]\n"}
,{"stream_name":"stdout","time":179.691902932,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":179.691910957,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":179.693641261,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":179.693660206,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":179.693756249,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14272536 1.         0.01478073 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":179.693763373,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":179.693939389,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":179.694084788,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":179.694261474,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04281761 0.03194087 0.02971938 0.02935045 0.02949001 0.02979158]\n"}
,{"stream_name":"stdout","time":179.694430436,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00221711 0.00149635 0.00134004 0.00131979 0.00135367 0.00143124]\n"}
,{"stream_name":"stdout","time":179.694436896,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":179.694505941,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.694586886,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":179.694638794,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.694660508,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":179.694710685,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":179.694788701,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":179.694919392,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":179.695021153,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":179.695370585,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":179.695482924,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":179.695556945,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:884 -     Diff statistics: mean=3.400996e+00, max=8.586313e+00, std=3.616739e+00\n"}
,{"stream_name":"stdout","time":179.695740119,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.033254, rho_c=0.012307\n"}
,{"stream_name":"stdout","time":179.69581766,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:895 -     Mean velocities: w_m=15.956662, w_c=12.253615\n"}
,{"stream_name":"stdout","time":179.695919418,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:899 -   State hash: 6087162599444164357\n"}
,{"stream_name":"stdout","time":179.69600576,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.696190395,"data":"    [RL] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=3.400996e+00\n"}
,{"stream_name":"stdout","time":179.697204411,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":179.697318182,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.697412525,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:847 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":179.697522959,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":179.697612447,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":179.697733982,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:850 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":179.697773697,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.697779651,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.697784277,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.697788745,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":179.772974798,"data":"[PROGRESS] Step 50: t=17.40/30.00s (58.0%) | dt=0.2981s\n"}
,{"stream_name":"stdout","time":179.96597984,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #21000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":179.966007306,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":179.966013039,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":179.966017358,"data":"[PERIODIC:1000] BC_GPU [Call #21000] About to launch kernel\n"}
,{"stream_name":"stdout","time":179.966021437,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":179.966026004,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":179.966029679,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":180.181075409,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":180.181213103,"data":"\n"}
,{"stream_name":"stderr","time":180.181217097,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.06s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.05s/s]\n"}
,{"stream_name":"stdout","time":180.18122207,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":180.18123008,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":180.182870256,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":180.182882851,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":180.1830858,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14396815 1.         0.0149623  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":180.183092681,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":180.183284882,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":180.18343729,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":180.183613458,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04319045 0.03178189 0.02903663 0.02819181 0.0279215  0.0278488 ]\n"}
,{"stream_name":"stdout","time":180.183793468,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224435 0.00146688 0.00124846 0.00116668 0.00113564 0.00112614]\n"}
,{"stream_name":"stdout","time":180.183800176,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":180.183883194,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":180.18392473,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":180.183962204,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":180.183993225,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":180.184022129,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":180.184090039,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.184252317,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.184345931,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.184775422,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.184871584,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.1849861,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:884 -     Diff statistics: mean=4.159752e-01, max=1.693151e+00, std=5.350512e-01\n"}
,{"stream_name":"stdout","time":180.185171415,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034182, rho_c=0.010221\n"}
,{"stream_name":"stdout","time":180.185241314,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.397978, w_c=13.468337\n"}
,{"stream_name":"stdout","time":180.185344187,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:899 -   State hash: 3473885885354630287\n"}
,{"stream_name":"stdout","time":180.18541843,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.185618905,"data":"    [RL] [STEP 2/41] action=0.0000, reward=0.0000, t=30.0s, state_diff=4.159752e-01\n"}
,{"stream_name":"stdout","time":180.186603712,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.186707917,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.186831836,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:847 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":180.186916662,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.186992815,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.187083614,"data":"2025-10-21 10:49:41 - INFO - run_control_simulation:850 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":180.187149251,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.187156061,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.187160857,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.187166591,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.243251701,"data":"[PROGRESS] Step 100: t=31.73/45.00s (70.5%) | dt=0.2889s\n"}
,{"stream_name":"stdout","time":180.473427037,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":180.473451857,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.473456913,"data":"  Original dt: 4.611800e-01 s\n"}
,{"stream_name":"stdout","time":180.473460809,"data":"  Corrected dt: 2.882375e-01 s\n"}
,{"stream_name":"stdout","time":180.473464578,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.47346852,"data":"  Max wave speed detected: 17.35 m/s\n"}
,{"stream_name":"stdout","time":180.692961751,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":180.692989093,"data":"\n"}
,{"stream_name":"stdout","time":180.692994563,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":180.692998591,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":180.692969474,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.68s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.68s/s]\n"}
,{"stream_name":"stdout","time":180.694686239,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":180.694703938,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":180.694810822,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14404522 1.         0.01497338 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":180.694930542,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":180.694996424,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":180.695154465,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":180.695336212,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04321357 0.03179408 0.02903314 0.02816238 0.02786013 0.02775447]\n"}
,{"stream_name":"stdout","time":180.695498632,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224601 0.00146692 0.00124395 0.00115485 0.00111518 0.0010973 ]\n"}
,{"stream_name":"stdout","time":180.695505685,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":180.695616195,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":180.695669592,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":180.69572661,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":180.695786586,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":180.695799669,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":180.695834806,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.696019783,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.696120638,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.696708998,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.696723724,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.696821201,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.272046e-01, max=6.947425e-01, std=1.926143e-01\n"}
,{"stream_name":"stdout","time":180.69693961,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.035072, rho_c=0.008024\n"}
,{"stream_name":"stdout","time":180.697043624,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.507159, w_c=13.794016\n"}
,{"stream_name":"stdout","time":180.697150268,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:899 -   State hash: -6147449715260910793\n"}
,{"stream_name":"stdout","time":180.697239077,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.697447913,"data":"    [RL] [STEP 3/41] action=0.0000, reward=0.0000, t=45.0s, state_diff=1.272046e-01\n"}
,{"stream_name":"stdout","time":180.698463036,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.698579401,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.69869993,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:847 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":180.698805376,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.698882153,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.698991002,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:850 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":180.699006619,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.699018463,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.699084528,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.699090588,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.728392089,"data":"[PROGRESS] Step 150: t=45.86/60.00s (76.4%) | dt=0.2880s\n"}
,{"stream_name":"stdout","time":181.218649954,"data":"[PROGRESS] Step 200: t=60.00/60.00s (100.0%) | dt=0.0260s\n"}
,{"stream_name":"stdout","time":181.218915386,"data":"  Stored output at t = 60.0000 s (Step 200)\n"}
,{"stream_name":"stderr","time":181.219182776,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.87s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.86s/s]\n"}
,{"stream_name":"stdout","time":181.21920715,"data":"\n"}
,{"stream_name":"stdout","time":181.21921415,"data":"Simulation finished at t = 60.0000 s after 200 steps.\n"}
,{"stream_name":"stdout","time":181.219218037,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":181.220804711,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":181.220821396,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":181.221054397,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14405262 1.         0.01497412 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":181.221062507,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":181.221251494,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":181.221429346,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":181.221630562,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04321579 0.03179613 0.02903387 0.02816201 0.02785851 0.02775063]\n"}
,{"stream_name":"stdout","time":181.221831117,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224612 0.00146706 0.00124385 0.00115409 0.00111329 0.0010939 ]\n"}
,{"stream_name":"stdout","time":181.221837785,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":181.221917662,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.221954568,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.221992924,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.222008043,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.222069111,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":181.222087316,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.222304212,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.222372607,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.222806358,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.222874516,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.223023537,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:884 -     Diff statistics: mean=8.910987e-02, max=5.755292e-01, std=1.440318e-01\n"}
,{"stream_name":"stdout","time":181.223209312,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.035868, rho_c=0.005811\n"}
,{"stream_name":"stdout","time":181.223277175,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.606020, w_c=13.930702\n"}
,{"stream_name":"stdout","time":181.223396793,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:899 -   State hash: 2125047979412748809\n"}
,{"stream_name":"stdout","time":181.223514906,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.223732616,"data":"    [RL] [STEP 4/41] action=0.0000, reward=0.0000, t=60.0s, state_diff=8.910987e-02\n"}
,{"stream_name":"stdout","time":181.224726673,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.224754762,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.224925089,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:847 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":181.224983689,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.225089227,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.225220767,"data":"2025-10-21 10:49:42 - INFO - run_control_simulation:850 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":181.225230805,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.225235205,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.225259731,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.225267598,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.457293024,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":181.457321271,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.457326674,"data":"  Original dt: 4.606535e-01 s\n"}
,{"stream_name":"stdout","time":181.457330742,"data":"  Corrected dt: 2.879084e-01 s\n"}
,{"stream_name":"stdout","time":181.457335084,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.457338793,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":181.689341155,"data":"[PROGRESS] Step 250: t=74.40/75.00s (99.2%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":181.71937325,"data":"  Stored output at t = 75.0000 s (Step 253)\n"}
,{"stream_name":"stderr","time":181.719494417,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.39s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.38s/s]\n"}
,{"stream_name":"stdout","time":181.719513547,"data":"\n"}
,{"stream_name":"stdout","time":181.719523626,"data":"Simulation finished at t = 75.0000 s after 253 steps.\n"}
,{"stream_name":"stdout","time":181.719529344,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":181.721109203,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":181.721127111,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":181.721340527,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14405327 1.         0.01497417 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":181.72135095,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":181.721515598,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":181.721717049,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":181.721898159,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.04321598 0.03179633 0.02903396 0.02816205 0.0278585  0.02775049]\n"}
,{"stream_name":"stdout","time":181.72206054,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224613 0.00146708 0.00124386 0.00115405 0.00111315 0.00109356]\n"}
,{"stream_name":"stdout","time":181.722069482,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":181.722125816,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.722191054,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":181.722233283,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.722240907,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":181.722306832,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":181.722323527,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.722490932,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.722606577,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.722962465,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.723071069,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.723152453,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:884 -     Diff statistics: mean=7.598575e-02, max=5.415431e-01, std=1.340333e-01\n"}
,{"stream_name":"stdout","time":181.723335567,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.035638, rho_c=0.003904\n"}
,{"stream_name":"stdout","time":181.723416926,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.739748, w_c=14.050629\n"}
,{"stream_name":"stdout","time":181.723516526,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:899 -   State hash: 7782237612795274930\n"}
,{"stream_name":"stdout","time":181.723647271,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.723839054,"data":"    [RL] [STEP 5/41] action=0.0000, reward=0.0000, t=75.0s, state_diff=7.598575e-02\n"}
,{"stream_name":"stdout","time":181.724905478,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.725014268,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.725133871,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:847 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":181.725215321,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.725295964,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.725414279,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:850 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":181.725459033,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.725467144,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.72547249,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.725499021,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.173708405,"data":"[PROGRESS] Step 300: t=88.53/90.00s (98.4%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":182.230234369,"data":"  Stored output at t = 90.0000 s (Step 306)\n"}
,{"stream_name":"stdout","time":182.23039416,"data":"\n"}
,{"stream_name":"stdout","time":182.230409365,"data":"Simulation finished at t = 90.0000 s after 306 steps.\n"}
,{"stream_name":"stdout","time":182.230412728,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":182.230430114,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.75s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.74s/s]\n"}
,{"stream_name":"stdout","time":182.232010934,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":182.232045485,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":182.232106815,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":182.232163072,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":182.232172928,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":182.232229432,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":182.23225719,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.232437914,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.232547708,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.232975228,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.23300023,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.23313824,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:884 -     Diff statistics: mean=6.288906e-02, max=5.186528e-01, std=1.292967e-01\n"}
,{"stream_name":"stdout","time":182.233326224,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034762, rho_c=0.003219\n"}
,{"stream_name":"stdout","time":182.23339837,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.868187, w_c=14.172185\n"}
,{"stream_name":"stdout","time":182.233485551,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:899 -   State hash: 8538422792958023180\n"}
,{"stream_name":"stdout","time":182.233578405,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.233791911,"data":"    [RL] [STEP 6/41] action=0.0000, reward=0.0000, t=90.0s, state_diff=6.288906e-02\n"}
,{"stream_name":"stdout","time":182.234852223,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.234879539,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.235043519,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:847 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":182.235127073,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.235252275,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.235380386,"data":"2025-10-21 10:49:43 - INFO - run_control_simulation:850 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":182.235388785,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.235393942,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.235423805,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.235433733,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.376399635,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #22000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":182.37642612,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":182.37643138,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":182.376435966,"data":"[PERIODIC:1000] BC_GPU [Call #22000] About to launch kernel\n"}
,{"stream_name":"stdout","time":182.376440212,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":182.37644442,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":182.376448601,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":182.414086693,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":182.414111748,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.414117503,"data":"  Original dt: 4.606416e-01 s\n"}
,{"stream_name":"stdout","time":182.414134817,"data":"  Corrected dt: 2.879010e-01 s\n"}
,{"stream_name":"stdout","time":182.414139417,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.414144048,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":182.647681203,"data":"[PROGRESS] Step 350: t=102.67/105.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":182.734377853,"data":"  Stored output at t = 105.0000 s (Step 359)\n"}
,{"stream_name":"stderr","time":182.734540172,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.09s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.08s/s]\n"}
,{"stream_name":"stdout","time":182.734548075,"data":"\n"}
,{"stream_name":"stdout","time":182.734631986,"data":"Simulation finished at t = 105.0000 s after 359 steps.\n"}
,{"stream_name":"stdout","time":182.734638465,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":182.73629058,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":182.736309307,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":182.73631617,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":182.736320774,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":182.736336718,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":182.736348509,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":182.736403871,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.736581898,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.73666984,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.737016159,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.737076922,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.737210036,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.496091e-02, max=3.063275e-01, std=6.377875e-02\n"}
,{"stream_name":"stdout","time":182.737361307,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034492, rho_c=0.003167\n"}
,{"stream_name":"stdout","time":182.737446091,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.909538, w_c=14.230355\n"}
,{"stream_name":"stdout","time":182.737548418,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:899 -   State hash: -9114477973457203243\n"}
,{"stream_name":"stdout","time":182.7376949,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.737890527,"data":"    [RL] [STEP 7/41] action=0.0000, reward=0.0000, t=105.0s, state_diff=2.496091e-02\n"}
,{"stream_name":"stdout","time":182.738945401,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.739061783,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.739187556,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:847 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":182.739250266,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.739336501,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.739460891,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:850 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":182.739469141,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.739474427,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.739491388,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.739498959,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.144630597,"data":"[PROGRESS] Step 400: t=116.80/120.00s (97.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":183.258135734,"data":"  Stored output at t = 120.0000 s (Step 412)\n"}
,{"stream_name":"stderr","time":183.258174739,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.95s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.94s/s]\n"}
,{"stream_name":"stdout","time":183.258200107,"data":"\n"}
,{"stream_name":"stdout","time":183.258211723,"data":"Simulation finished at t = 120.0000 s after 412 steps.\n"}
,{"stream_name":"stdout","time":183.258216629,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":183.259917996,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":183.259935884,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.259942374,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.259946599,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.259950217,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.260020943,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":183.260032841,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.260215995,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.260325496,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.260738233,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.260845599,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.260962194,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:884 -     Diff statistics: mean=6.128136e-03, max=1.085985e-01, std=1.750841e-02\n"}
,{"stream_name":"stdout","time":183.261149453,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034449, rho_c=0.003159\n"}
,{"stream_name":"stdout","time":183.261206085,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.916924, w_c=14.247431\n"}
,{"stream_name":"stdout","time":183.261350363,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:899 -   State hash: -8829337133299838949\n"}
,{"stream_name":"stdout","time":183.261422689,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.261636114,"data":"    [RL] [STEP 8/41] action=0.0000, reward=0.0000, t=120.0s, state_diff=6.128136e-03\n"}
,{"stream_name":"stdout","time":183.26263493,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.262743617,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.262856578,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:847 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":183.262984015,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.263055484,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.263183551,"data":"2025-10-21 10:49:44 - INFO - run_control_simulation:850 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":183.263191347,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.26319575,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.263259747,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.26326826,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.391616929,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":183.391646039,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.391651559,"data":"  Original dt: 4.606408e-01 s\n"}
,{"stream_name":"stdout","time":183.391655894,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":183.391659788,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.391663899,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":183.633932038,"data":"[PROGRESS] Step 450: t=130.94/135.00s (97.0%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":183.772988548,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 29.46s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 29.45s/s]\n"}
,{"stream_name":"stdout","time":183.772996447,"data":"  Stored output at t = 135.0000 s (Step 465)\n"}
,{"stream_name":"stdout","time":183.773040968,"data":"\n"}
,{"stream_name":"stdout","time":183.773046852,"data":"Simulation finished at t = 135.0000 s after 465 steps.\n"}
,{"stream_name":"stdout","time":183.773050745,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":183.774697746,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":183.774716528,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.774778553,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":183.774790552,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.774827498,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":183.774863327,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":183.774894842,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.775074827,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.775191777,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.775545574,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.775663994,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.775772866,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.358706e-03, max=2.894074e-02, std=4.255163e-03\n"}
,{"stream_name":"stdout","time":183.775959783,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034443, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":183.776021114,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918125, w_c=14.251658\n"}
,{"stream_name":"stdout","time":183.776111056,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:899 -   State hash: -6845150124596380275\n"}
,{"stream_name":"stdout","time":183.776205536,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.776378484,"data":"    [RL] [STEP 9/41] action=0.0000, reward=0.0000, t=135.0s, state_diff=1.358706e-03\n"}
,{"stream_name":"stdout","time":183.777412041,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.777530815,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.777654709,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:847 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":183.777794643,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.777877766,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.778016565,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:850 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":183.778061861,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.77807,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.778075307,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.778106351,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.117378726,"data":"[PROGRESS] Step 500: t=145.08/150.00s (96.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":184.28855269,"data":"  Stored output at t = 150.0000 s (Step 518)\n"}
,{"stream_name":"stderr","time":184.288637526,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 29.42s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 29.41s/s]\n"}
,{"stream_name":"stdout","time":184.288656642,"data":"\n"}
,{"stream_name":"stdout","time":184.288661659,"data":"Simulation finished at t = 150.0000 s after 518 steps.\n"}
,{"stream_name":"stdout","time":184.288666073,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":184.290435633,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":184.290455025,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":184.290520964,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":184.290554685,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":184.290632787,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":184.290647192,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":184.290729495,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.290740301,"data":"[STEP   10] t=  150.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":184.290895699,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.291013688,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.291374537,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.291420305,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.291577003,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.918032e-04, max=6.902497e-03, std=9.765890e-04\n"}
,{"stream_name":"stdout","time":184.291798129,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":184.291839567,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918322, w_c=14.252626\n"}
,{"stream_name":"stdout","time":184.29199555,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:899 -   State hash: 9142666543736800945\n"}
,{"stream_name":"stdout","time":184.292097147,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.292300224,"data":"    [RL] [STEP 10/41] action=0.0000, reward=0.0000, t=150.0s, state_diff=2.918032e-04\n"}
,{"stream_name":"stdout","time":184.293317127,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.293430398,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.293581564,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:847 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":184.293677281,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.293793575,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.293865002,"data":"2025-10-21 10:49:45 - INFO - run_control_simulation:850 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":184.293935674,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.293944891,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.293950329,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.293962481,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.361122657,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":184.361149228,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.361155335,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":184.361160589,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":184.361165023,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.361169561,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":184.598136074,"data":"[PROGRESS] Step 550: t=159.21/165.00s (96.5%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":184.79754862,"data":"  Stored output at t = 165.0000 s (Step 571)\n"}
,{"stream_name":"stdout","time":184.797592635,"data":"\n"}
,{"stream_name":"stdout","time":184.79759862,"data":"Simulation finished at t = 165.0000 s after 571 steps.\n"}
,{"stream_name":"stderr","time":184.797548699,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 29.82s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 29.81s/s]\n"}
,{"stream_name":"stdout","time":184.797603209,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":184.799342383,"data":"[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====\n"}
,{"stream_name":"stdout","time":184.7993616,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":184.799388818,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14405334 1.         0.01497418 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":184.799429173,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":184.7996168,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":184.799798906,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":184.800013023,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.043216   0.03179635 0.02903396 0.02816205 0.02785851 0.02775048]\n"}
,{"stream_name":"stdout","time":184.800203257,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224613 0.00146708 0.00124386 0.00115405 0.00111314 0.00109353]\n"}
,{"stream_name":"stdout","time":184.800210989,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":184.80030659,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":184.800372132,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":184.800411648,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":184.800457044,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":184.800493833,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":184.800552717,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.800742235,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.800843008,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.801223689,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.801288538,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.801416716,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:884 -     Diff statistics: mean=6.184999e-05, max=1.557501e-03, std=2.163002e-04\n"}
,{"stream_name":"stdout","time":184.801597934,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":184.801754619,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918356, w_c=14.252840\n"}
,{"stream_name":"stdout","time":184.801844923,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:899 -   State hash: 4591987937007086978\n"}
,{"stream_name":"stdout","time":184.801955608,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.802167516,"data":"    [RL] [STEP 11/41] action=0.0000, reward=0.0000, t=165.0s, state_diff=6.184999e-05\n"}
,{"stream_name":"stdout","time":184.803169832,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.803271682,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.803399422,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:847 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":184.803506804,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.803606908,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.803722671,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:850 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":184.803776032,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.803786547,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.80380097,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.80380555,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.804086399,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #23000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":184.804095005,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":184.804099291,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":184.804179961,"data":"[PERIODIC:1000] BC_GPU [Call #23000] About to launch kernel\n"}
,{"stream_name":"stdout","time":184.804190775,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":184.804195052,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":184.80419903,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":185.078972706,"data":"[PROGRESS] Step 600: t=173.35/180.00s (96.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":185.306426061,"data":"  Stored output at t = 180.0000 s (Step 624)\n"}
,{"stream_name":"stdout","time":185.306453834,"data":"\n"}
,{"stream_name":"stdout","time":185.306459355,"data":"Simulation finished at t = 180.0000 s after 624 steps.\n"}
,{"stream_name":"stdout","time":185.30646367,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":185.306480539,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 29.87s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 29.86s/s]\n"}
,{"stream_name":"stdout","time":185.308208379,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.308227371,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.308359464,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.30875309,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.308831178,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.308961252,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.302677e-05, max=3.410073e-04, std=4.686974e-05\n"}
,{"stream_name":"stdout","time":185.309121492,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":185.309239465,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918362, w_c=14.252886\n"}
,{"stream_name":"stdout","time":185.309324724,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:899 -   State hash: -7373938518637420693\n"}
,{"stream_name":"stdout","time":185.309393992,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.309632426,"data":"    [RL] [STEP 12/41] action=0.0000, reward=0.0000, t=180.0s, state_diff=1.302677e-05\n"}
,{"stream_name":"stdout","time":185.310537468,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.310667669,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.310819263,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:847 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":185.310900149,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.311016703,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.311101924,"data":"2025-10-21 10:49:46 - INFO - run_control_simulation:850 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":185.31115274,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.31116387,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.311169899,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.311176238,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.322417751,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":185.322436239,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.322442898,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":185.32244699,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":185.322449576,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.322452415,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":185.560869764,"data":"[PROGRESS] Step 650: t=187.49/195.00s (96.1%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":185.819145093,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 29.56s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 29.55s/s]\n"}
,{"stream_name":"stdout","time":185.819155382,"data":"  Stored output at t = 195.0000 s (Step 677)\n"}
,{"stream_name":"stdout","time":185.819180739,"data":"\n"}
,{"stream_name":"stdout","time":185.819185382,"data":"Simulation finished at t = 195.0000 s after 677 steps.\n"}
,{"stream_name":"stdout","time":185.819207705,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":185.82100182,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.821115278,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.82127446,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.821636975,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.821756706,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.821889617,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.732812e-06, max=7.337782e-05, std=1.001890e-05\n"}
,{"stream_name":"stdout","time":185.822086327,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":185.822196497,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252895\n"}
,{"stream_name":"stdout","time":185.822295346,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:899 -   State hash: 8538431350515362368\n"}
,{"stream_name":"stdout","time":185.822383982,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.822684707,"data":"    [RL] [STEP 13/41] action=0.0000, reward=0.0000, t=195.0s, state_diff=2.732812e-06\n"}
,{"stream_name":"stdout","time":185.823625203,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.823743722,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.823878771,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:847 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":185.823941682,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.824082783,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.824145274,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:850 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":185.824209517,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.824216658,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.824221141,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.824235088,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.046811099,"data":"[PROGRESS] Step 700: t=201.62/210.00s (96.0%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":186.290226972,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":186.29025535,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.290277196,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":186.290281822,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":186.290286075,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.290289615,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":186.338330035,"data":"  Stored output at t = 210.0000 s (Step 730)\n"}
,{"stream_name":"stdout","time":186.338437464,"data":"\n"}
,{"stream_name":"stdout","time":186.33845389,"data":"Simulation finished at t = 210.0000 s after 730 steps.\n"}
,{"stream_name":"stdout","time":186.3384588,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":186.338445461,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 29.21s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 29.20s/s]\n"}
,{"stream_name":"stdout","time":186.340244321,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.340264116,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.340391246,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.340858645,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.340910487,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.341077879,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:884 -     Diff statistics: mean=5.714274e-07, max=1.562164e-05, std=2.122769e-06\n"}
,{"stream_name":"stdout","time":186.341247504,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":186.341325875,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252897\n"}
,{"stream_name":"stdout","time":186.341449344,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:899 -   State hash: 2502114029835806486\n"}
,{"stream_name":"stdout","time":186.34153027,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.341774946,"data":"    [RL] [STEP 14/41] action=0.0000, reward=0.0000, t=210.0s, state_diff=5.714274e-07\n"}
,{"stream_name":"stdout","time":186.342748736,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.342843644,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.342985867,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:847 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":186.343075115,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.343184405,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.343269593,"data":"2025-10-21 10:49:47 - INFO - run_control_simulation:850 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":186.343335458,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.343340933,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.343346062,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.343365912,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.539223966,"data":"[PROGRESS] Step 750: t=215.76/225.00s (95.9%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":186.85619765,"data":"  Stored output at t = 225.0000 s (Step 783)\n"}
,{"stream_name":"stdout","time":186.856293796,"data":"\n"}
,{"stream_name":"stderr","time":186.856298876,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 29.28s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 29.27s/s]\n"}
,{"stream_name":"stdout","time":186.856308897,"data":"Simulation finished at t = 225.0000 s after 783 steps.\n"}
,{"stream_name":"stdout","time":186.856318201,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":186.858064742,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.858086324,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.858200297,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.858590088,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.858715103,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.858830617,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.191104e-07, max=3.301926e-06, std=4.469677e-07\n"}
,{"stream_name":"stdout","time":186.858993601,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":186.859080989,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":186.859210563,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:899 -   State hash: 3613922530301843297\n"}
,{"stream_name":"stdout","time":186.859313335,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.859500929,"data":"    [RL] [STEP 15/41] action=0.0000, reward=0.0000, t=225.0s, state_diff=1.191104e-07\n"}
,{"stream_name":"stdout","time":186.860476547,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.86061258,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.860756862,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:847 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":186.860827762,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.860929474,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.861058536,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:850 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":186.861066289,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.861071244,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.861086675,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.861091705,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.02765876,"data":"[PROGRESS] Step 800: t=229.89/240.00s (95.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":187.231261781,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #24000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":187.231291837,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":187.231297279,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":187.23130146,"data":"[PERIODIC:1000] BC_GPU [Call #24000] About to launch kernel\n"}
,{"stream_name":"stdout","time":187.231305605,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":187.231309966,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":187.231313933,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":187.270122314,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":187.27015076,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.270157014,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":187.270161538,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":187.270165832,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.27017008,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":187.375960453,"data":"  Stored output at t = 240.0000 s (Step 836)\n"}
,{"stream_name":"stdout","time":187.376000981,"data":"\n"}
,{"stream_name":"stdout","time":187.376006345,"data":"Simulation finished at t = 240.0000 s after 836 steps.\n"}
,{"stream_name":"stderr","time":187.376001267,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 29.16s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 29.15s/s]\n"}
,{"stream_name":"stdout","time":187.376010341,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":187.377805527,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.377837194,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.37794185,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.37834587,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.37835673,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.37851259,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.475002e-08, max=6.941947e-07, std=9.365896e-08\n"}
,{"stream_name":"stdout","time":187.37875584,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":187.378848175,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":187.378955471,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:899 -   State hash: 7676081095279484032\n"}
,{"stream_name":"stdout","time":187.379034148,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.37922611,"data":"    [RL] [STEP 16/41] action=0.0000, reward=0.0000, t=240.0s, state_diff=2.475002e-08\n"}
,{"stream_name":"stdout","time":187.380262392,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.380321836,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.380458879,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:847 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":187.380520798,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.380685687,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.380793943,"data":"2025-10-21 10:49:48 - INFO - run_control_simulation:850 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":187.380813998,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.380820036,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.380854934,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.380896838,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.516253904,"data":"[PROGRESS] Step 850: t=244.03/255.00s (95.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":187.886241621,"data":"  Stored output at t = 255.0000 s (Step 889)\n"}
,{"stream_name":"stdout","time":187.886349021,"data":"\n"}
,{"stream_name":"stdout","time":187.886363839,"data":"Simulation finished at t = 255.0000 s after 889 steps.\n"}
,{"stream_name":"stdout","time":187.886369198,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":187.886383829,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 29.71s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 29.70s/s]\n"}
,{"stream_name":"stdout","time":187.887957763,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.88810342,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.888197671,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.888589747,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.888715602,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.888823165,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:884 -     Diff statistics: mean=5.126775e-09, max=1.453083e-07, std=1.954571e-08\n"}
,{"stream_name":"stdout","time":187.888997297,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":187.889079216,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":187.889214057,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:899 -   State hash: -8930030510474115695\n"}
,{"stream_name":"stdout","time":187.889290091,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.889467944,"data":"    [RL] [STEP 17/41] action=0.0000, reward=0.0000, t=255.0s, state_diff=5.126775e-09\n"}
,{"stream_name":"stdout","time":187.890443742,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.890540955,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.890697391,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:847 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":187.890776729,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.890873929,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.891039557,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:850 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":187.891054157,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.891059247,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.891074985,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.891120904,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.993350889,"data":"[PROGRESS] Step 900: t=258.17/270.00s (95.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":188.233098816,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":188.233126547,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.233146386,"data":"  Original dt: 4.606408e-01 s\n"}
,{"stream_name":"stdout","time":188.233152046,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":188.233155571,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.233158784,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":188.391170117,"data":"  Stored output at t = 270.0000 s (Step 942)\n"}
,{"stream_name":"stderr","time":188.391280046,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.03s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.02s/s]\n"}
,{"stream_name":"stdout","time":188.391314461,"data":"\n"}
,{"stream_name":"stdout","time":188.391329864,"data":"Simulation finished at t = 270.0000 s after 942 steps.\n"}
,{"stream_name":"stdout","time":188.391350102,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":188.393042335,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.393057968,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.393111722,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.393512347,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.39355305,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.393720459,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.058726e-09, max=3.029920e-08, std=4.064179e-09\n"}
,{"stream_name":"stdout","time":188.393939234,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":188.394019926,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":188.394141073,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:899 -   State hash: -8064960800368084836\n"}
,{"stream_name":"stdout","time":188.394236753,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.394464756,"data":"    [RL] [STEP 18/41] action=0.0000, reward=0.0000, t=270.0s, state_diff=1.058726e-09\n"}
,{"stream_name":"stdout","time":188.395406872,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.395502576,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.395669148,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:847 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":188.395772528,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.395887969,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.395961355,"data":"2025-10-21 10:49:49 - INFO - run_control_simulation:850 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":188.396029101,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.396038503,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.396043703,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.396076123,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.470042954,"data":"[PROGRESS] Step 950: t=272.30/285.00s (95.5%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":188.886897647,"data":"  Stored output at t = 285.0000 s (Step 995)\n"}
,{"stream_name":"stdout","time":188.887121053,"data":"\n"}
,{"stream_name":"stdout","time":188.88713354,"data":"Simulation finished at t = 285.0000 s after 995 steps.\n"}
,{"stream_name":"stdout","time":188.887138186,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":188.887140287,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.58s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.57s/s]\n"}
,{"stream_name":"stdout","time":188.88867146,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.888780445,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.888905515,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.889264273,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.889331976,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.889453178,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:884 -     Diff statistics: mean=2.179904e-10, max=6.295801e-09, std=8.422415e-10\n"}
,{"stream_name":"stdout","time":188.889645858,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":188.889735568,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":188.889830227,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:899 -   State hash: 3224230941081078539\n"}
,{"stream_name":"stdout","time":188.889926301,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.890119861,"data":"    [RL] [STEP 19/41] action=0.0000, reward=0.0000, t=285.0s, state_diff=2.179904e-10\n"}
,{"stream_name":"stdout","time":188.89110303,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.891200665,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.891350446,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:847 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":188.891409333,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.891550876,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.891659529,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:850 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":188.891737933,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.891744114,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.891749306,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.891753771,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.937536314,"data":"[PROGRESS] Step 1000: t=286.44/300.00s (95.5%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":189.169980189,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":189.170006577,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.170012066,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":189.170016299,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":189.170020668,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.170024875,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":189.387854081,"data":"  Stored output at t = 300.0000 s (Step 1048)\n"}
,{"stream_name":"stderr","time":189.388083652,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.26s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.25s/s]\n"}
,{"stream_name":"stdout","time":189.388089108,"data":"\n"}
,{"stream_name":"stdout","time":189.38810967,"data":"Simulation finished at t = 300.0000 s after 1048 steps.\n"}
,{"stream_name":"stdout","time":189.38811491,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":189.389898814,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.389916345,"data":"[STEP   20] t=  300.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":189.389971083,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.390108848,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.39048011,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.390588524,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.39076914,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:884 -     Diff statistics: mean=4.475661e-11, max=1.303931e-09, std=1.739943e-10\n"}
,{"stream_name":"stdout","time":189.390994023,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":189.391016223,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":189.391134393,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:899 -   State hash: -2952915685108770493\n"}
,{"stream_name":"stdout","time":189.391218553,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.391410731,"data":"    [RL] [STEP 20/41] action=0.0000, reward=0.0000, t=300.0s, state_diff=4.475661e-11\n"}
,{"stream_name":"stdout","time":189.392408092,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.392547228,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.392674356,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:847 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":189.392787064,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.392876226,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.392997826,"data":"2025-10-21 10:49:50 - INFO - run_control_simulation:850 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":189.393011644,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.393030548,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.393036916,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.3930754,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.412855954,"data":"[PROGRESS] Step 1050: t=300.58/315.00s (95.4%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":189.612836453,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #25000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":189.612864346,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":189.612869526,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":189.61287332,"data":"[PERIODIC:1000] BC_GPU [Call #25000] About to launch kernel\n"}
,{"stream_name":"stdout","time":189.612881513,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":189.612887211,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":189.612890304,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":189.889707598,"data":"[PROGRESS] Step 1100: t=314.97/315.00s (100.0%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":189.899075541,"data":"  Stored output at t = 315.0000 s (Step 1101)\n"}
,{"stream_name":"stdout","time":189.899239161,"data":"\n"}
,{"stream_name":"stderr","time":189.899236564,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 29.67s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 29.66s/s]\n"}
,{"stream_name":"stdout","time":189.899249204,"data":"Simulation finished at t = 315.0000 s after 1101 steps.\n"}
,{"stream_name":"stdout","time":189.899288315,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":189.900956182,"data":"[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====\n"}
,{"stream_name":"stdout","time":189.900973512,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":189.901082136,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14405334 1.         0.01497418 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":189.901089267,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":189.901302427,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":189.901484654,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":189.90173867,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.043216   0.03179635 0.02903396 0.02816205 0.02785851 0.02775048]\n"}
,{"stream_name":"stdout","time":189.901906105,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224613 0.00146708 0.00124386 0.00115405 0.00111314 0.00109353]\n"}
,{"stream_name":"stdout","time":189.90191368199999,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":189.901985982,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.902063878,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":189.90208612,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.902115996,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":189.902169334,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":189.902208717,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.902392067,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.902475682,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.902897937,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.902955083,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.903107056,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:884 -     Diff statistics: mean=9.163394e-12, max=2.692158e-10, std=3.583632e-11\n"}
,{"stream_name":"stdout","time":189.90326964,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":189.903409678,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":189.903466396,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:899 -   State hash: -6869050950178747289\n"}
,{"stream_name":"stdout","time":189.903597164,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.903817604,"data":"    [RL] [STEP 21/41] action=0.0000, reward=0.0000, t=315.0s, state_diff=9.163394e-12\n"}
,{"stream_name":"stdout","time":189.904793508,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.904924194,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.90503848,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:847 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":189.905134286,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.905233236,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.905313726,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:850 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":189.905369671,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.905375859,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.905381623,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.90539356,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.13328386,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":190.133313188,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.133319793,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":190.133324408,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":190.133328306,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.13333272,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":190.366935582,"data":"[PROGRESS] Step 1150: t=329.11/330.00s (99.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":190.404727079,"data":"  Stored output at t = 330.0000 s (Step 1154)\n"}
,{"stream_name":"stderr","time":190.404958314,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 30.07s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 30.05s/s]\n"}
,{"stream_name":"stdout","time":190.404976147,"data":"\n"}
,{"stream_name":"stdout","time":190.404991848,"data":"Simulation finished at t = 330.0000 s after 1154 steps.\n"}
,{"stream_name":"stdout","time":190.404996604,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":190.40667458,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.406772438,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.406868812,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.407207118,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.4072752,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.407417465,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.871860e-12, max=5.543299e-11, std=7.361351e-12\n"}
,{"stream_name":"stdout","time":190.407606817,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":190.407776346,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":190.407836369,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:899 -   State hash: -2963729747430468852\n"}
,{"stream_name":"stdout","time":190.407954289,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.408136354,"data":"    [RL] [STEP 22/41] action=0.0000, reward=0.0000, t=330.0s, state_diff=1.871860e-12\n"}
,{"stream_name":"stdout","time":190.40919697,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.409296958,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.409409643,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:847 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":190.409541176,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.409683896,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.409793861,"data":"2025-10-21 10:49:51 - INFO - run_control_simulation:850 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":190.409841088,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.409850504,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.409866456,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.409873949,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.865800565,"data":"[PROGRESS] Step 1200: t=343.24/345.00s (99.5%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":190.931968175,"data":"  Stored output at t = 345.0000 s (Step 1207)\n"}
,{"stream_name":"stdout","time":190.932195294,"data":"\n"}
,{"stream_name":"stdout","time":190.932207734,"data":"Simulation finished at t = 345.0000 s after 1207 steps.\n"}
,{"stream_name":"stdout","time":190.932212689,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":190.932243032,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 28.75s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 28.74s/s]\n"}
,{"stream_name":"stdout","time":190.933960689,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.933981466,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.934108526,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.934476542,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.93454508,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.934710245,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:884 -     Diff statistics: mean=3.812982e-13, max=1.137757e-11, std=1.507278e-12\n"}
,{"stream_name":"stdout","time":190.934920899,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":190.934978384,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":190.93509314,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:899 -   State hash: -3475658692061378375\n"}
,{"stream_name":"stdout","time":190.935164172,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.935361117,"data":"    [RL] [STEP 23/41] action=0.0000, reward=0.0000, t=345.0s, state_diff=3.812982e-13\n"}
,{"stream_name":"stdout","time":190.936361926,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.936478612,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.936610892,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:847 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":190.936712262,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.93684134,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.936917973,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:850 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":190.936965489,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.936972802,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.936977371,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.936994004,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.108952173,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":191.108977753,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.108983774,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":191.108988141,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":191.109007532,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.109012432,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":191.349651297,"data":"[PROGRESS] Step 1250: t=357.38/360.00s (99.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":191.440343858,"data":"  Stored output at t = 360.0000 s (Step 1260)\n"}
,{"stream_name":"stdout","time":191.440417437,"data":"\n"}
,{"stream_name":"stdout","time":191.440424792,"data":"Simulation finished at t = 360.0000 s after 1260 steps.\n"}
,{"stream_name":"stdout","time":191.440430214,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":191.440343339,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 29.83s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 29.82s/s]\n"}
,{"stream_name":"stdout","time":191.442222866,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.442305459,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.442453157,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.442849867,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.442952261,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.443068484,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:884 -     Diff statistics: mean=7.741673e-14, max=2.332357e-12, std=3.082428e-13\n"}
,{"stream_name":"stdout","time":191.443261372,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":191.443329483,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":191.443453013,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:899 -   State hash: 7982044356628188602\n"}
,{"stream_name":"stdout","time":191.443529913,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.443753491,"data":"    [RL] [STEP 24/41] action=0.0000, reward=0.0000, t=360.0s, state_diff=7.741673e-14\n"}
,{"stream_name":"stdout","time":191.444720896,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.444829281,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.444959883,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:847 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":191.445031779,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.445157975,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.445234898,"data":"2025-10-21 10:49:52 - INFO - run_control_simulation:850 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":191.445261623,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.445267019,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.445280743,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.445292242,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.819609619,"data":"[PROGRESS] Step 1300: t=371.52/375.00s (99.1%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":191.942481743,"data":"  Stored output at t = 375.0000 s (Step 1313)\n"}
,{"stream_name":"stdout","time":191.942643269,"data":"\n"}
,{"stream_name":"stdout","time":191.94266025,"data":"Simulation finished at t = 375.0000 s after 1313 steps.\n"}
,{"stream_name":"stdout","time":191.942665774,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":191.942676056,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 30.20s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 30.19s/s]\n"}
,{"stream_name":"stdout","time":191.944442893,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.944460891,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.944531677,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.944918258,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.94501575,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.945117892,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.576990e-14, max=4.742873e-13, std=6.276473e-14\n"}
,{"stream_name":"stdout","time":191.94527797,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":191.945358249,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":191.945494234,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:899 -   State hash: 5074626314221765385\n"}
,{"stream_name":"stdout","time":191.945581265,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.94575204,"data":"    [RL] [STEP 25/41] action=0.0000, reward=0.0000, t=375.0s, state_diff=1.576990e-14\n"}
,{"stream_name":"stdout","time":191.946706824,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.946812119,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.946937651,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:847 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":191.947019443,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.94714347,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.94720969,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:850 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":191.947273799,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.947282209,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.94728664,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.947291672,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.023875507,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #26000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":192.023903085,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":192.023908835,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":192.023914038,"data":"[PERIODIC:1000] BC_GPU [Call #26000] About to launch kernel\n"}
,{"stream_name":"stdout","time":192.02391819,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":192.023922837,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":192.023927044,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":192.062279311,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":192.062305162,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.062310833,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":192.062315049,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":192.062318683,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.062322294,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":192.304425774,"data":"[PROGRESS] Step 1350: t=385.65/390.00s (98.9%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":192.457023382,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 29.45s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 29.45s/s]\n"}
,{"stream_name":"stdout","time":192.457032876,"data":"  Stored output at t = 390.0000 s (Step 1366)\n"}
,{"stream_name":"stdout","time":192.45706047,"data":"\n"}
,{"stream_name":"stdout","time":192.457066334,"data":"Simulation finished at t = 390.0000 s after 1366 steps.\n"}
,{"stream_name":"stdout","time":192.45707079,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":192.458790431,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.458825374,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.458891616,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.45930578,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.459366793,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.459501595,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:884 -     Diff statistics: mean=3.380037e-15, max=1.012523e-13, std=1.300484e-14\n"}
,{"stream_name":"stdout","time":192.459722731,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":192.459814804,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":192.459904497,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:899 -   State hash: -7431471187197382854\n"}
,{"stream_name":"stdout","time":192.459979788,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.460185301,"data":"    [RL] [STEP 26/41] action=0.0000, reward=0.0000, t=390.0s, state_diff=3.380037e-15\n"}
,{"stream_name":"stdout","time":192.461306662,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.461380287,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.461542835,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:847 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":192.46164676,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.461800092,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.461891784,"data":"2025-10-21 10:49:53 - INFO - run_control_simulation:850 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":192.461952432,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.461959636,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.461965169,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.461999036,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.786929396,"data":"[PROGRESS] Step 1400: t=399.79/405.00s (98.7%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":192.966374064,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 29.77s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 29.76s/s]\n"}
,{"stream_name":"stdout","time":192.966385759,"data":"  Stored output at t = 405.0000 s (Step 1419)\n"}
,{"stream_name":"stdout","time":192.966419238,"data":"\n"}
,{"stream_name":"stdout","time":192.966426002,"data":"Simulation finished at t = 405.0000 s after 1419 steps.\n"}
,{"stream_name":"stdout","time":192.966448375,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":192.968211494,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.968244328,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.968327315,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.968760896,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.968808244,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.968964847,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:884 -     Diff statistics: mean=6.799412e-16, max=1.953993e-14, std=2.808735e-15\n"}
,{"stream_name":"stdout","time":192.969134834,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":192.969221928,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":192.969330863,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:899 -   State hash: -2926651976066844181\n"}
,{"stream_name":"stdout","time":192.96942089,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.969652612,"data":"    [RL] [STEP 27/41] action=0.0000, reward=0.0000, t=405.0s, state_diff=6.799412e-16\n"}
,{"stream_name":"stdout","time":192.970646521,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.970745956,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.970857273,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:847 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":192.970936444,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.97101355,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.971116009,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:850 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":192.971135758,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.971141393,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.971161169,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.971203369,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.030629133,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":193.030657891,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.03066366,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":193.030683727,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":193.030686588,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.030688999,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":193.273763273,"data":"[PROGRESS] Step 1450: t=413.92/420.00s (98.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":193.481762446,"data":"  Stored output at t = 420.0000 s (Step 1472)\n"}
,{"stream_name":"stdout","time":193.481982179,"data":"\n"}
,{"stream_name":"stderr","time":193.481987555,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 29.41s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 29.39s/s]\n"}
,{"stream_name":"stdout","time":193.48199619,"data":"Simulation finished at t = 420.0000 s after 1472 steps.\n"}
,{"stream_name":"stdout","time":193.482007797,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":193.483649783,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.483669599,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.483828492,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.484144756,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.484231301,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.484344778,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.495923e-16, max=1.065814e-14, std=9.462727e-16\n"}
,{"stream_name":"stdout","time":193.484497786,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":193.484625474,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":193.484696407,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:899 -   State hash: 1833030229793324525\n"}
,{"stream_name":"stdout","time":193.48478657,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.484963707,"data":"    [RL] [STEP 28/41] action=0.0000, reward=0.0000, t=420.0s, state_diff=1.495923e-16\n"}
,{"stream_name":"stdout","time":193.485990975,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.486103443,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.486233084,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:847 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":193.486311181,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.486396408,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.486513,"data":"2025-10-21 10:49:54 - INFO - run_control_simulation:850 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":193.486574824,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.486588161,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.486593053,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.486625897,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.746607902,"data":"[PROGRESS] Step 1500: t=428.06/435.00s (98.4%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":193.982270234,"data":"  Stored output at t = 435.0000 s (Step 1525)\n"}
,{"stream_name":"stdout","time":193.982481513,"data":"\n"}
,{"stream_name":"stdout","time":193.982492501,"data":"Simulation finished at t = 435.0000 s after 1525 steps.\n"}
,{"stream_name":"stdout","time":193.982497227,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":193.982489323,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.29s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.28s/s]\n"}
,{"stream_name":"stdout","time":193.984211402,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.984228578,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.984292274,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.984650588,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.984793562,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.98488451,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:884 -     Diff statistics: mean=5.556745e-17, max=1.065814e-14, std=6.316075e-16\n"}
,{"stream_name":"stdout","time":193.985069219,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":193.98512691,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":193.985268001,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:899 -   State hash: -5209343499763690702\n"}
,{"stream_name":"stdout","time":193.985324334,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.985547125,"data":"    [RL] [STEP 29/41] action=0.0000, reward=0.0000, t=435.0s, state_diff=5.556745e-17\n"}
,{"stream_name":"stdout","time":193.986523027,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.986597789,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.986793721,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:847 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":193.98687441,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.986956495,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.987088797,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:850 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":193.98709852,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.987103692,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.987145397,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.987153004,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.988524254,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":193.988540523,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.988545651,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":193.988549647,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":193.98855346,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.98855747,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":194.225585866,"data":"[PROGRESS] Step 1550: t=442.20/450.00s (98.3%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":194.428405874,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #27000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":194.428434894,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":194.428440935,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":194.428445567,"data":"[PERIODIC:1000] BC_GPU [Call #27000] About to launch kernel\n"}
,{"stream_name":"stdout","time":194.42844981,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":194.42845507,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":194.428459078,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":194.494761264,"data":"  Stored output at t = 450.0000 s (Step 1578)\n"}
,{"stream_name":"stderr","time":194.494867877,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 29.58s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 29.56s/s]\n"}
,{"stream_name":"stdout","time":194.494886226,"data":"\n"}
,{"stream_name":"stdout","time":194.494894453,"data":"Simulation finished at t = 450.0000 s after 1578 steps.\n"}
,{"stream_name":"stdout","time":194.494899324,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":194.496639863,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.49667444,"data":"[STEP   30] t=  450.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":194.49669619,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.496875651,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.497223176,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.497325865,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.49746498,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:884 -     Diff statistics: mean=3.848084e-17, max=7.105427e-15, std=4.337619e-16\n"}
,{"stream_name":"stdout","time":194.497688425,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":194.497789502,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":194.497889367,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:899 -   State hash: 8467530823370352481\n"}
,{"stream_name":"stdout","time":194.497996031,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.498191767,"data":"    [RL] [STEP 30/41] action=0.0000, reward=0.0000, t=450.0s, state_diff=3.848084e-17\n"}
,{"stream_name":"stdout","time":194.499196248,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.499277475,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.499398041,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:847 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":194.49952846,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.499551925,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":194.499716789,"data":"2025-10-21 10:49:55 - INFO - run_control_simulation:850 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":194.499729998,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.499735126,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.499758184,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.49976312,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.710286516,"data":"[PROGRESS] Step 1600: t=456.33/465.00s (98.1%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":194.951306899,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":194.951334686,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.951338505,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":194.951341019,"data":"  Corrected dt: 2.879004e-01 s\n"}
,{"stream_name":"stdout","time":194.951355771,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.951358556,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":195.007504453,"data":"  Stored output at t = 465.0000 s (Step 1631)\n"}
,{"stream_name":"stderr","time":195.007729049,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 29.57s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 29.55s/s]\n"}
,{"stream_name":"stdout","time":195.007773832,"data":"\n"}
,{"stream_name":"stdout","time":195.007779273,"data":"Simulation finished at t = 465.0000 s after 1631 steps.\n"}
,{"stream_name":"stdout","time":195.007783709,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":195.009472829,"data":"[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====\n"}
,{"stream_name":"stdout","time":195.009485928,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":195.00974372,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.14405334 1.         0.01497418 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":195.009755433,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=11.11\n"}
,{"stream_name":"stdout","time":195.009955348,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [11.111111 11.111111 11.111111 11.111111 11.111111 11.111111]\n"}
,{"stream_name":"stdout","time":195.010144931,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [13.888889 13.888889 13.888889 13.888889 13.888889 13.888889]\n"}
,{"stream_name":"stdout","time":195.010330176,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.043216   0.03179635 0.02903396 0.02816205 0.02785851 0.02775048]\n"}
,{"stream_name":"stdout","time":195.010515926,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.00224613 0.00146708 0.00124386 0.00115405 0.00111314 0.00109353]\n"}
,{"stream_name":"stdout","time":195.010522569,"data":"[QUEUE_DIAGNOSTIC] Threshold: 5.0 m/s\n"}
,{"stream_name":"stdout","time":195.010648887,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.010712782,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":195.010771066,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.010777747,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":195.010870474,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":195.010886553,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.011056994,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.011168712,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.011521828,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.011654941,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.011824992,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.711267e-17, max=3.552714e-15, std=2.457415e-16\n"}
,{"stream_name":"stdout","time":195.011998783,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":195.012084492,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":195.01219222,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:899 -   State hash: -3348431131165835329\n"}
,{"stream_name":"stdout","time":195.012287495,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.012491428,"data":"    [RL] [STEP 31/41] action=0.0000, reward=0.0000, t=465.0s, state_diff=1.711267e-17\n"}
,{"stream_name":"stdout","time":195.013498956,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.013611298,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.013757889,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:847 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":195.013849792,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.013961061,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.014070297,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:850 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":195.014124874,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.014132989,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.014138065,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.014142669,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.19649703,"data":"[PROGRESS] Step 1650: t=470.47/480.00s (98.0%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":195.522429132,"data":"  Stored output at t = 480.0000 s (Step 1684)\n"}
,{"stream_name":"stderr","time":195.52265353,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 29.54s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 29.52s/s]\n"}
,{"stream_name":"stdout","time":195.522679935,"data":"\n"}
,{"stream_name":"stdout","time":195.52268854,"data":"Simulation finished at t = 480.0000 s after 1684 steps.\n"}
,{"stream_name":"stdout","time":195.522693544,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":195.524532203,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.524573302,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.524702392,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.525054337,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.52512582,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.525273679,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:884 -     Diff statistics: mean=3.648757e-21, max=6.505213e-19, std=3.815828e-20\n"}
,{"stream_name":"stdout","time":195.525485849,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":195.52555554,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":195.525689066,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:899 -   State hash: -6526365780675219246\n"}
,{"stream_name":"stdout","time":195.525787624,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.526008076,"data":"    [RL] [STEP 32/41] action=0.0000, reward=0.0000, t=480.0s, state_diff=3.648757e-21\n"}
,{"stream_name":"stdout","time":195.527084204,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.527137355,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.52730311,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:847 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":195.527320644,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.527443772,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.527586589,"data":"2025-10-21 10:49:56 - INFO - run_control_simulation:850 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":195.527600185,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.527605456,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.527611636,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.527626274,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.679552678,"data":"[PROGRESS] Step 1700: t=484.61/495.00s (97.9%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":195.917173973,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":195.917201065,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.91720693,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":195.917211431,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":195.917215597,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.917219763,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":196.028515357,"data":"  Stored output at t = 495.0000 s (Step 1737)\n"}
,{"stream_name":"stdout","time":196.028607357,"data":"\n"}
,{"stream_name":"stdout","time":196.028628236,"data":"Simulation finished at t = 495.0000 s after 1737 steps.\n"}
,{"stream_name":"stdout","time":196.028645547,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":196.028610292,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 29.98s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 29.97s/s]\n"}
,{"stream_name":"stdout","time":196.0304776,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.030496246,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.030617762,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.031006941,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.031113835,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.031224003,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:884 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.031393057,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":196.031471529,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":196.031634346,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:899 -   State hash: -6526365780675219246\n"}
,{"stream_name":"stdout","time":196.031742045,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.031959167,"data":"    [RL] [STEP 33/41] action=0.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.033008312,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.033105882,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.033224894,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:847 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":196.033330232,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.033413517,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.033515118,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:850 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":196.033610313,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.03362239,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.033627599,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.033648995,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.157506414,"data":"[PROGRESS] Step 1750: t=498.74/510.00s (97.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":196.530160857,"data":"  Stored output at t = 510.0000 s (Step 1790)\n"}
,{"stream_name":"stdout","time":196.530206316,"data":"\n"}
,{"stream_name":"stdout","time":196.530212613,"data":"Simulation finished at t = 510.0000 s after 1790 steps.\n"}
,{"stream_name":"stdout","time":196.530216754,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":196.530160889,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 30.24s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 30.23s/s]\n"}
,{"stream_name":"stdout","time":196.531940798,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.532024624,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.532181598,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.53253665,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.532662706,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.532783609,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:884 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.532958895,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":196.533059325,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":196.533161247,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:899 -   State hash: -6526365780675219246\n"}
,{"stream_name":"stdout","time":196.533255325,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.533453953,"data":"    [RL] [STEP 34/41] action=0.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.534467187,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.534613677,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.534744814,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:847 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":196.534776572,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.534943355,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.534994768,"data":"2025-10-21 10:49:57 - INFO - run_control_simulation:850 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":196.535063424,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.535073681,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.53509412,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.535099228,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.629866019,"data":"[PROGRESS] Step 1800: t=512.88/525.00s (97.7%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":196.83021909,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #28000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":196.830260213,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":196.830266434,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":196.8302712,"data":"[PERIODIC:1000] BC_GPU [Call #28000] About to launch kernel\n"}
,{"stream_name":"stdout","time":196.830275458,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":196.830279324,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":196.830283345,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":196.86817262,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":196.868195144,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.868202407,"data":"  Original dt: 4.606408e-01 s\n"}
,{"stream_name":"stdout","time":196.868206051,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":196.868210082,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.868214583,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":197.036663655,"data":"  Stored output at t = 525.0000 s (Step 1843)\n"}
,{"stream_name":"stdout","time":197.036894486,"data":"\n"}
,{"stream_name":"stdout","time":197.036908413,"data":"Simulation finished at t = 525.0000 s after 1843 steps.\n"}
,{"stream_name":"stderr","time":197.036905978,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 29.93s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 29.92s/s]\n"}
,{"stream_name":"stdout","time":197.03691391,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":197.038654274,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.038674014,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.038747293,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.039140454,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.039221191,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.039361416,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:884 -     Diff statistics: mean=4.059138e-17, max=3.552714e-15, std=3.144144e-16\n"}
,{"stream_name":"stdout","time":197.039529025,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":197.039679471,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":197.039767872,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:899 -   State hash: -256041736555219724\n"}
,{"stream_name":"stdout","time":197.039859881,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.040063156,"data":"    [RL] [STEP 35/41] action=0.0000, reward=0.0000, t=525.0s, state_diff=4.059138e-17\n"}
,{"stream_name":"stdout","time":197.041069563,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.041171572,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.041307121,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:847 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":197.041371467,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.041504503,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.041617837,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:850 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":197.0416801,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.041690143,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.041695826,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.041708668,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.108978068,"data":"[PROGRESS] Step 1850: t=527.02/540.00s (97.6%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":197.554022255,"data":"  Stored output at t = 540.0000 s (Step 1896)\n"}
,{"stream_name":"stdout","time":197.554213078,"data":"\n"}
,{"stream_name":"stdout","time":197.554227966,"data":"Simulation finished at t = 540.0000 s after 1896 steps.\n"}
,{"stream_name":"stdout","time":197.554232788,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":197.554240032,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 29.30s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 29.29s/s]\n"}
,{"stream_name":"stdout","time":197.555926085,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.556080186,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.556218228,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.556593443,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.556718111,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.556808821,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:884 -     Diff statistics: mean=6.631512e-17, max=7.105427e-15, std=4.663371e-16\n"}
,{"stream_name":"stdout","time":197.556975018,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":197.557133087,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":197.557234186,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:899 -   State hash: -8623672968294015270\n"}
,{"stream_name":"stdout","time":197.557323902,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.557551186,"data":"    [RL] [STEP 36/41] action=0.0000, reward=0.0000, t=540.0s, state_diff=6.631512e-17\n"}
,{"stream_name":"stdout","time":197.558523948,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.558675477,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.558816837,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:847 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":197.558910336,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.559034517,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.559138834,"data":"2025-10-21 10:49:58 - INFO - run_control_simulation:850 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":197.559181716,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.559188349,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.559220427,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.559231399,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.599846561,"data":"[PROGRESS] Step 1900: t=541.15/555.00s (97.5%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":197.840725699,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":197.840752862,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.840758703,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":197.840763176,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":197.840767484,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.840772008,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":198.065800808,"data":"  Stored output at t = 555.0000 s (Step 1949)\n"}
,{"stream_name":"stdout","time":198.065989437,"data":"\n"}
,{"stream_name":"stderr","time":198.065989238,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 29.64s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 29.62s/s]\n"}
,{"stream_name":"stdout","time":198.065999163,"data":"Simulation finished at t = 555.0000 s after 1949 steps.\n"}
,{"stream_name":"stdout","time":198.06601572,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":198.067655989,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.067773001,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.067915263,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.068266705,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.068351848,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.068494873,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:884 -     Diff statistics: mean=1.042502e-21, max=2.168404e-19, std=1.499899e-20\n"}
,{"stream_name":"stdout","time":198.068729536,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":198.068819275,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":198.068960917,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:899 -   State hash: -7190909958150769183\n"}
,{"stream_name":"stdout","time":198.069054697,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.06927796,"data":"    [RL] [STEP 37/41] action=0.0000, reward=0.0000, t=555.0s, state_diff=1.042502e-21\n"}
,{"stream_name":"stdout","time":198.070295066,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.070395907,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.070586688,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:847 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":198.070687623,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.070810068,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":198.070889375,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:850 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":198.070951526,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.070959572,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.070964325,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.070979583,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.081418507,"data":"[PROGRESS] Step 1950: t=555.29/570.00s (97.4%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":198.546359382,"data":"[PROGRESS] Step 2000: t=569.68/570.00s (99.9%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":198.565462793,"data":"  Stored output at t = 570.0000 s (Step 2002)\n"}
,{"stream_name":"stderr","time":198.565740521,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 30.36s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 30.34s/s]\n"}
,{"stream_name":"stdout","time":198.56575926,"data":"\n"}
,{"stream_name":"stdout","time":198.565779338,"data":"Simulation finished at t = 570.0000 s after 2002 steps.\n"}
,{"stream_name":"stdout","time":198.56578414,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":198.567399396,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.567491061,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.567638085,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.567986985,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.568070278,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.568194516,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:884 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.568348632,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":198.56843094,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":198.568609427,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:899 -   State hash: -7190909958150769183\n"}
,{"stream_name":"stdout","time":198.568710188,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.568903227,"data":"    [RL] [STEP 38/41] action=0.0000, reward=0.0000, t=570.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":198.56998149,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.570049181,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.570182122,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:847 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":198.570248779,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.570345505,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":198.570476715,"data":"2025-10-21 10:49:59 - INFO - run_control_simulation:850 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":198.570482366,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.570486313,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.570497449,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.570554689,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.785063156,"data":"[WARNING] Automatic CFL correction applied (count: 7200):\n"}
,{"stream_name":"stdout","time":198.785091148,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.785097321,"data":"  Original dt: 4.606407e-01 s\n"}
,{"stream_name":"stdout","time":198.785101519,"data":"  Corrected dt: 2.879005e-01 s\n"}
,{"stream_name":"stdout","time":198.785105566,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.785109849,"data":"  Max wave speed detected: 17.37 m/s\n"}
,{"stream_name":"stdout","time":199.014752458,"data":"[PROGRESS] Step 2050: t=583.82/585.00s (99.8%) | dt=0.2879s\n"}
,{"stream_name":"stdout","time":199.062993943,"data":"  Stored output at t = 585.0000 s (Step 2055)\n"}
,{"stream_name":"stderr","time":199.063204964,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 30.49s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 30.47s/s]\n"}
,{"stream_name":"stdout","time":199.063211127,"data":"\n"}
,{"stream_name":"stdout","time":199.063226234,"data":"Simulation finished at t = 585.0000 s after 2055 steps.\n"}
,{"stream_name":"stdout","time":199.06323087,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":199.064926847,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.064994875,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.065180414,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.065516652,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.065644087,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.065778495,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:884 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.065966017,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":199.06604204,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":199.06617588,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:899 -   State hash: -7190909958150769183\n"}
,{"stream_name":"stdout","time":199.06624553,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.066473736,"data":"    [RL] [STEP 39/41] action=0.0000, reward=0.0000, t=585.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.067458981,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.067581877,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:846 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.067723201,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:847 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":199.067812579,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:848 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.067925866,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:849 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":199.068031689,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:850 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":199.068076442,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":199.068082886,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":199.068111288,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":199.068124078,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.218120907,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #29000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":199.218148606,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":199.21815429,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":199.21815874,"data":"[PERIODIC:1000] BC_GPU [Call #29000] About to launch kernel\n"}
,{"stream_name":"stdout","time":199.218163182,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.3, 0.14089506172839514, 0.096, 0.0540123456790124]\n"}
,{"stream_name":"stdout","time":199.218167463,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":199.21817182,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":199.481033836,"data":"[PROGRESS] Step 2100: t=597.96/600.00s (99.7%) | dt=0.2879s\n"}
,{"stream_name":"stderr","time":199.556004712,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.78s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.77s/s]\n"}
,{"stream_name":"stdout","time":199.556029866,"data":"  Stored output at t = 600.0000 s (Step 2108)\n"}
,{"stream_name":"stdout","time":199.55604711,"data":"\n"}
,{"stream_name":"stdout","time":199.556051811,"data":"Simulation finished at t = 600.0000 s after 2108 steps.\n"}
,{"stream_name":"stdout","time":199.556056201,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":199.557750869,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.557790818,"data":"[STEP   40] t=  600.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":199.557797446,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":199.557801767,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:865 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.557855822,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:866 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":199.558232792,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:882 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.558309019,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:883 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.558417893,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:884 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.558621245,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:894 -     Mean densities: rho_m=0.034442, rho_c=0.003157\n"}
,{"stream_name":"stdout","time":199.55871671,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:895 -     Mean velocities: w_m=16.918363, w_c=14.252898\n"}
,{"stream_name":"stdout","time":199.558841973,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:899 -   State hash: -7190909958150769183\n"}
,{"stream_name":"stdout","time":199.558931488,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:901 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.559137341,"data":"    [RL] [STEP 40/41] action=0.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.559159418,"data":"\n"}
,{"stream_name":"stdout","time":199.559164322,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":199.559168752,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":199.559172878,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":199.55917661,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":199.559180751,"data":"    - Avg step time: 0.508s (device=gpu)\n"}
,{"stream_name":"stdout","time":199.559184807,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":199.559189384,"data":"    - Wallclock time: 20.3s\n"}
,{"stream_name":"stdout","time":199.559193606,"data":"    - Speed ratio: 29.51x real-time\n"}
,{"stream_name":"stdout","time":199.559197904,"data":"\n"}
,{"stream_name":"stdout","time":199.559280989,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:941 - \n"}
,{"stream_name":"stdout","time":199.559286414,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":199.559290752,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":199.559294958,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":199.559299244,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":199.559303446,"data":"    - Avg step time: 0.508s (device=gpu)\n"}
,{"stream_name":"stdout","time":199.559307685,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":199.559311291,"data":"    - Wallclock time: 20.3s\n"}
,{"stream_name":"stdout","time":199.559314924,"data":"    - Speed ratio: 29.51x real-time\n"}
,{"stream_name":"stdout","time":199.559318539,"data":"\n"}
,{"stream_name":"stdout","time":199.559414953,"data":"2025-10-21 10:50:00 - INFO - run_control_simulation:942 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":199.559795507,"data":"\n"}
,{"stream_name":"stdout","time":199.559810954,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":199.559815661,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":199.559819763,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":199.559824111,"data":"\n"}
,{"stream_name":"stdout","time":199.559968682,"data":"2025-10-21 10:50:00 - INFO - evaluate_traffic_performance:965 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":199.560040699,"data":"2025-10-21 10:50:00 - INFO - evaluate_traffic_performance:966 -   HASH CHECK - first=6087162599444164357, last=-7190909958150769183\n"}
,{"stream_name":"stdout","time":199.560573601,"data":"2025-10-21 10:50:00 - INFO - evaluate_traffic_performance:975 - First state sample - rho_m[10:15]=[0.03058631 0.03104602 0.03153182 0.03202472 0.03249686], w_m[10:15]=[16.50133994 16.4422263  16.38534207 16.33383997 16.29073702]\n"}
,{"stream_name":"stdout","time":199.565549135,"data":"2025-10-21 10:50:00 - INFO - evaluate_traffic_performance:977 - Last state sample - rho_m[10:15]=[0.02769736 0.0276921  0.02769013 0.02768937 0.02768906], w_m[10:15]=[17.46662287 17.46989422 17.4711183  17.47158442 17.47176599]\n"}
,{"stream_name":"stdout","time":199.565591723,"data":"2025-10-21 10:50:00 - INFO - evaluate_traffic_performance:1031 - Calculated metrics: flow=31.858443, efficiency=5.097351, delay=-175.22s\n"}
,{"stream_name":"stdout","time":199.565792979,"data":"2025-10-21 10:50:00 - INFO - run_performance_comparison:1424 - Baseline performance: {'total_flow': 28.391672904310393, 'avg_speed': 875.1900816139605, 'avg_density': 0.059057593297722415, 'efficiency': 4.542667664689663, 'delay': -174.14307047333625, 'throughput': 141958.36452155196}\n"}
,{"stream_name":"stdout","time":199.565843421,"data":"2025-10-21 10:50:00 - INFO - run_performance_comparison:1425 - RL performance: {'total_flow': 31.85844335280212, 'avg_speed': 1078.3103457179761, 'avg_density': 0.02967485668300484, 'efficiency': 5.097350936448339, 'delay': -175.21923109779985, 'throughput': 159292.2167640106}\n"}
,{"stream_name":"stdout","time":199.565971234,"data":"2025-10-21 10:50:00 - INFO - run_performance_comparison:1445 - Flow improvement: 12.211%\n"}
,{"stream_name":"stdout","time":199.566071098,"data":"2025-10-21 10:50:00 - INFO - run_performance_comparison:1446 - Efficiency improvement: 12.211%\n"}
,{"stream_name":"stdout","time":199.566142168,"data":"2025-10-21 10:50:00 - INFO - run_performance_comparison:1447 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":199.566215476,"data":"  Flow improvement: 12.2%\n"}
,{"stream_name":"stdout","time":199.566221599,"data":"  Efficiency improvement: 12.2%\n"}
,{"stream_name":"stdout","time":199.566225542,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":199.566229521,"data":"  Result: PASSED\n"}
,{"stream_name":"stdout","time":199.566921035,"data":"\n"}
,{"stream_name":"stdout","time":199.566936487,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":200.165983856,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":200.685424941,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":200.685453893,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":200.685465338,"data":"\n"}
,{"stream_name":"stdout","time":200.68546799,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":200.693409822,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":200.69342677,"data":"\n"}
,{"stream_name":"stdout","time":200.693431908,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":200.693625342,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":200.693642884,"data":"\n"}
,{"stream_name":"stdout","time":200.693647298,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":200.693651106,"data":"Scenarios passed: 1/1 (100.0%)\n"}
,{"stream_name":"stdout","time":200.693654594,"data":"Average flow improvement: 12.21%\n"}
,{"stream_name":"stdout","time":200.693658184,"data":"Average efficiency improvement: 12.21%\n"}
,{"stream_name":"stdout","time":200.693661577,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":200.693665023,"data":"Overall validation: PASSED\n"}
,{"stream_name":"stdout","time":200.694592502,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":203.350968102,"data":"[SUCCESS] Validation tests completed successfully\n"}
,{"stream_name":"stdout","time":203.352399547,"data":"TRACKING_SUCCESS: Validation execution finished\n"}
,{"stream_name":"stdout","time":203.35254814,"data":"\n"}
,{"stream_name":"stdout","time":203.352577642,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":203.352626035,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":203.356716294,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":203.357570769,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":203.357678768,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":203.357779262,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":203.357833166,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":203.357919307,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":203.35797744,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":203.358059061,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":203.358137581,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":203.358202551,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":203.428274334,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":203.428296813,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":203.428663446,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":203.428756449,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":203.428807638,"data":"\n"}
,{"stream_name":"stdout","time":203.428816702,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":203.428914404,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":203.42899847,"data":"\n"}
,{"stream_name":"stdout","time":203.429018055,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.429022049,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":203.429025972,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":203.429029582,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":206.927593687,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":206.927629183,"data":"  warn(\n"}
,{"stream_name":"stderr","time":206.967588219,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":207.735792253,"data":"[NbConvertApp] Writing 322008 bytes to __results__.html\n"}
]