[{"stream_name":"stdout","time":0.824603563,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.824666914,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.824673712,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.824678257,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.824779483,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.825085099,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":6.611104754,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":6.611289817,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":6.678492685,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":6.70218017,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":6.702278286,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":6.702440416,"data":"\n"}
,{"stream_name":"stdout","time":6.702451048,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":6.702576645,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":10.503698627,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":10.505011605,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":10.505167968,"data":"\n"}
,{"stream_name":"stdout","time":10.505193996,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":10.505317887,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":15.01666509,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":18.495765561,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":22.087457823,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":25.560585954,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":29.00860952,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":32.492012979,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":109.325824365,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":109.3260054,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":109.32609139,"data":"\n"}
,{"stream_name":"stdout","time":109.326102751,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":109.32649272,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":109.32663554,"data":"[SCENARIO] Single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":109.326689928,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":109.326783932,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":109.326849275,"data":"============================================================\n"}
,{"stream_name":"stderr","time":125.309635844,"data":"2025-10-15 19:26:47.303001: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":125.531203327,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":125.53126287,"data":"E0000 00:00:1760556407.524552     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":125.590129957,"data":"E0000 00:00:1760556407.583582     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":138.82473653,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.824799754,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":138.824807859,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":138.824814659,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":138.824821281,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":138.824828117,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":138.824834943,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.824892324,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":138.824934065,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":138.824943321,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":138.824950716,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":138.82495792,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":138.824964973,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":138.825646149,"data":"2025-10-15 19:27:00 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":138.825668634,"data":"2025-10-15 19:27:00 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":138.825849673,"data":"2025-10-15 19:27:00 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":138.825887801,"data":"2025-10-15 19:27:00 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":138.8260503,"data":"2025-10-15 19:27:00 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":138.826064093,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":138.826070106,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":138.82607558,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":138.956686341,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":139.071851827,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":139.071891287,"data":"\n"}
,{"stream_name":"stdout","time":139.071896627,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":139.071900967,"data":"[SCENARIO] Single scenario mode (CLI): traffic_light_control\n"}
,{"stream_name":"stdout","time":139.071921215,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":139.071927739,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":139.07203605,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":139.072217771,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":139.072323543,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":139.072427091,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":139.072532661,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":139.072619503,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":139.07278523,"data":"2025-10-15 19:27:01 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":139.072798548,"data":"\n"}
,{"stream_name":"stdout","time":139.072803173,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":139.07280734,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":139.072811142,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":139.072814929,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":139.072961098,"data":"2025-10-15 19:27:01 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":139.073120446,"data":"2025-10-15 19:27:01 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":139.073197699,"data":"2025-10-15 19:27:01 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":139.073622835,"data":"2025-10-15 19:27:01 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":139.078492017,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.078579577,"data":"2025-10-15 19:27:01 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.078709268,"data":"2025-10-15 19:27:01 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":139.078811883,"data":"2025-10-15 19:27:01 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":139.07891746,"data":"2025-10-15 19:27:01 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":139.078924988,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":139.078930813,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":139.079047155,"data":"2025-10-15 19:27:01 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":139.079213239,"data":"2025-10-15 19:27:01 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":139.079480929,"data":"2025-10-15 19:27:01 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 02303512\n"}
,{"stream_name":"stdout","time":139.07962301,"data":"2025-10-15 19:27:01 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config 02303512\n"}
,{"stream_name":"stdout","time":139.079630355,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":139.0802121,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.08022056,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":139.088494601,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":139.088521053,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":139.088526718,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":139.088531741,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":139.088559731,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":139.088752637,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":139.088766513,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":139.088770705,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":139.088782864,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":139.088787697,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.088869114,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":139.088874959,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":139.095437771,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":139.095467243,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stderr","time":139.096061197,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":139.096076796,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":140.695525236,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":140.695561376,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":140.695567602,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":140.695571908,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":140.695593077,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":140.695599355,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":140.695603484,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":140.695606398,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":140.695958596,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":140.696804017,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":140.696841361,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":140.696908262,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":145.798121382,"data":"2025-10-15 19:27:07 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 02303512\n"}
,{"stream_name":"stdout","time":145.79858672,"data":"\n"}
,{"stream_name":"stdout","time":145.798612782,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":145.798618431,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":145.798622919,"data":"\n"}
,{"stream_name":"stdout","time":145.798626857,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.798631788,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":145.798636751,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":145.798641637,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":145.798646577,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":145.798650691,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.798655005,"data":"\n"}
,{"stream_name":"stdout","time":145.798672774,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.798679074,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.809759244,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.809803804,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.809809739,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.809815426,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.809819537,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.809869006,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.809900666,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.80990721,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.809946809,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.809955839,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.809961716,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.809966683,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.810971473,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.810995556,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":145.812272994,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.812634059,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.812666623,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.812673214,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":145.819202702,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":145.819653805,"data":"\n"}
,{"stream_name":"stdout","time":145.819672272,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":145.821896762,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.821918839,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.821925693,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":145.821931033,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.822443643,"data":"\n"}
,{"stream_name":"stderr","time":145.866708631,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":145.866748061,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":146.695600949,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":146.695628827,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.69563476,"data":"  Original dt: 9.117254e-01 s\n"}
,{"stream_name":"stdout","time":146.695638953,"data":"  Corrected dt: 5.698284e-01 s\n"}
,{"stream_name":"stdout","time":146.69564302,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.695647216,"data":"  Max wave speed detected: 8.77 m/s\n"}
,{"stream_name":"stderr","time":146.897313659,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":146.897345803,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":147.199137448,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":147.199171906,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":147.267337317,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":147.267370202,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":147.336983087,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":147.337017498,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":147.824029133,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":147.824072365,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":147.912306261,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":147.912334277,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":148.010465267,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":148.01049712,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":148.126907894,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":148.126951321,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":148.239681079,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":148.239713374,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":148.305792987,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":148.305825572,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":148.368733343,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":148.368764455,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":148.84203043,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":148.842033117,"data":"\n"}
,{"stream_name":"stderr","time":148.842073829,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.842319478,"data":"\n"}
,{"stream_name":"stdout","time":148.842343715,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":148.842349893,"data":"Total runtime: 3.02 seconds.\n"}
,{"stream_name":"stderr","time":148.842317647,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:03\u003c00:00,  4.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:03\u003c00:00,  4.97s/s]\n"}
,{"stream_name":"stdout","time":148.84440213,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":148.84474367,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":148.844754255,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.844759861,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":148.844782391,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.845007822,"data":"\n"}
,{"stream_name":"stdout","time":148.923722522,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":149.410188543,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":149.410184571,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.410252422,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.410491772,"data":"\n"}
,{"stream_name":"stdout","time":149.410507168,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":149.410512898,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":149.410527394,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.54s/s]\n"}
,{"stream_name":"stdout","time":149.412393594,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":149.412808956,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":149.412818682,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.412823897,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":149.412829086,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.413080741,"data":"\n"}
,{"stream_name":"stdout","time":149.470970974,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":149.471001638,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.471008483,"data":"  Original dt: 4.711972e-01 s\n"}
,{"stream_name":"stdout","time":149.471013503,"data":"  Corrected dt: 2.944982e-01 s\n"}
,{"stream_name":"stdout","time":149.471022803,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.471027743,"data":"  Max wave speed detected: 16.98 m/s\n"}
,{"stream_name":"stdout","time":149.481499347,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":150.000939418,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":150.000952539,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.000982759,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.001032422,"data":"\n"}
,{"stream_name":"stdout","time":150.001041343,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":150.001046737,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":150.001067567,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.52s/s]\n"}
,{"stream_name":"stdout","time":150.003129313,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":150.003474536,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":150.003489174,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.003495134,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":150.003499661,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.00372579,"data":"\n"}
,{"stream_name":"stdout","time":150.04880191,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stderr","time":150.585283057,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.585314867,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.585284621,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stdout","time":150.585608276,"data":"\n"}
,{"stream_name":"stdout","time":150.585623591,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":150.585629793,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":150.585645483,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.79s/s]\n"}
,{"stream_name":"stdout","time":150.587721631,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":150.588301687,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":150.588321282,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.588327198,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":150.588332694,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.58857338,"data":"\n"}
,{"stream_name":"stdout","time":150.601955099,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":150.601978937,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.601985343,"data":"  Original dt: 4.674668e-01 s\n"}
,{"stream_name":"stdout","time":150.601989955,"data":"  Corrected dt: 2.921668e-01 s\n"}
,{"stream_name":"stdout","time":150.601994443,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.601999144,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stdout","time":150.613414473,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":151.189792679,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":151.190138815,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":151.190164329,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.190202431,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":151.190495983,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 24.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 24.93s/s]\n"}
,{"stream_name":"stdout","time":151.190516347,"data":"\n"}
,{"stream_name":"stdout","time":151.190529478,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":151.190534739,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":151.192340852,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.192736923,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":151.192745801,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.192751357,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":151.192755607,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.192971271,"data":"\n"}
,{"stream_name":"stdout","time":151.74117949,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":151.741208761,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.741215317,"data":"  Original dt: 4.673342e-01 s\n"}
,{"stream_name":"stdout","time":151.74121971900001,"data":"  Corrected dt: 2.920839e-01 s\n"}
,{"stream_name":"stdout","time":151.741224122,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.741269663,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":151.750921897,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":151.772272026,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.772309872,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.772272662,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stdout","time":151.772593357,"data":"\n"}
,{"stream_name":"stderr","time":151.772600566,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.89s/s]\n"}
,{"stream_name":"stdout","time":151.772617394,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":151.772629161,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":151.774434021,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.774823876,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":151.774852653,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.774857608,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":151.774861583,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.775165318,"data":"\n"}
,{"stream_name":"stdout","time":152.315582896,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":152.361288267,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.361324023,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.361288275,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stdout","time":152.361670625,"data":"\n"}
,{"stream_name":"stdout","time":152.361687095,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":152.361692443,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":152.3616676,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.59s/s]\n"}
,{"stream_name":"stdout","time":152.363786264,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.364205927,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":152.36421933,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.364225136,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":152.364255852,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.364540967,"data":"\n"}
,{"stream_name":"stdout","time":152.862927028,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":152.862956929,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.862963515,"data":"  Original dt: 4.673274e-01 s\n"}
,{"stream_name":"stdout","time":152.862968133,"data":"  Corrected dt: 2.920796e-01 s\n"}
,{"stream_name":"stdout","time":152.86297285,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.862977329,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":152.873167557,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":152.939312029,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":152.939312022,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.939357597,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.939676323,"data":"\n"}
,{"stream_name":"stdout","time":152.939688487,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stderr","time":152.939682243,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.09s/s]\n"}
,{"stream_name":"stdout","time":152.939693895,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":152.941758836,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.94178384,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":152.941789432,"data":"\n"}
,{"stream_name":"stdout","time":152.941794145,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.941798828,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.03 | Avg Reward/Step: 0.004\n"}
,{"stream_name":"stdout","time":152.941803348,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.941807836,"data":"\n"}
,{"stream_name":"stdout","time":152.941812604,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":152.941817735,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":152.951371214,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":152.951398854,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":152.951404089,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":152.951408521,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":152.951412334,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":152.95154179,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":152.951558137,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":152.951563979,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":152.951568721,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":152.951577558,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":152.951626822,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":152.951637058,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":152.952431416,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":152.952450066,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":152.95279097,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":152.953123491,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":152.953135197,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.953140618,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":152.955311816,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":152.955344855,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.955350722,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":152.95535478,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.955483232,"data":"\n"}
,{"stream_name":"stdout","time":153.435179594,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":153.435176959,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.435211133,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.435430664,"data":"\n"}
,{"stream_name":"stdout","time":153.435446164,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":153.435450924,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":153.435495871,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.27s/s]\n"}
,{"stream_name":"stdout","time":153.437570236,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.437873026,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":153.437882004,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.437887031,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":153.437891526,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.438111089,"data":"\n"}
,{"stream_name":"stdout","time":153.521487165,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":153.992529987,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":153.992562033,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.992569093,"data":"  Original dt: 4.720299e-01 s\n"}
,{"stream_name":"stdout","time":153.992574443,"data":"  Corrected dt: 2.950187e-01 s\n"}
,{"stream_name":"stdout","time":153.992579254,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.992583991,"data":"  Max wave speed detected: 16.95 m/s\n"}
,{"stream_name":"stdout","time":154.002425084,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":154.002456456,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.002474955,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.002689079,"data":"\n"}
,{"stream_name":"stdout","time":154.002701827,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":154.00270667,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":154.002705552,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.58s/s]\n"}
,{"stream_name":"stdout","time":154.004590543,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.004922385,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":154.00493439,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.004939697,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":154.004944541,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.005121896,"data":"\n"}
,{"stream_name":"stdout","time":154.072472822,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":154.584367025,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":154.584366082,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.584403285,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.584632179,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.89s/s]\n"}
,{"stream_name":"stdout","time":154.584650164,"data":"\n"}
,{"stream_name":"stdout","time":154.584664292,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":154.584669628,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":154.586709631,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.587078621,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":154.587092817,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.587099045,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":154.587104534,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.587289268,"data":"\n"}
,{"stream_name":"stdout","time":154.632962439,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":155.110383277,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":155.110411629,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.110417424,"data":"  Original dt: 4.674910e-01 s\n"}
,{"stream_name":"stdout","time":155.110422152,"data":"  Corrected dt: 2.921819e-01 s\n"}
,{"stream_name":"stdout","time":155.110425061,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.110427711,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stdout","time":155.1634138,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":155.16347522,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.163515135,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.163701393,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.04s/s]\n"}
,{"stream_name":"stdout","time":155.163714721,"data":"\n"}
,{"stream_name":"stdout","time":155.163726985,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":155.163732475,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":155.165735106,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.166215163,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":155.166252059,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.166265363,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":155.166270536,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.166454412,"data":"\n"}
,{"stream_name":"stdout","time":155.189535953,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":155.747661158,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":155.748048029,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":155.748111781,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.748134148,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.748526029,"data":"\n"}
,{"stream_name":"stdout","time":155.748546206,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":155.748551846,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":155.748525274,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.78s/s]\n"}
,{"stream_name":"stdout","time":155.750618519,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.750976972,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":155.750989343,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.750994461,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":155.750998921,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.751143897,"data":"\n"}
,{"stream_name":"stdout","time":156.242174592,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":156.242249945,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.242257956,"data":"  Original dt: 4.673353e-01 s\n"}
,{"stream_name":"stdout","time":156.242260924,"data":"  Corrected dt: 2.920846e-01 s\n"}
,{"stream_name":"stdout","time":156.24226351,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.242266254,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":156.320393208,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":156.343554119,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":156.343567242,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.343592271,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.343819054,"data":"\n"}
,{"stream_name":"stdout","time":156.343838208,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":156.343844246,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":156.343827238,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.32s/s]\n"}
,{"stream_name":"stdout","time":156.345840509,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.346223215,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":156.346261517,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.346268359,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":156.346273462,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.346476672,"data":"\n"}
,{"stream_name":"stdout","time":156.885480361,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":156.92939555,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":156.929400281,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.929432662,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":156.92969953,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.73s/s]\n"}
,{"stream_name":"stdout","time":156.929721933,"data":"\n"}
,{"stream_name":"stdout","time":156.929736022,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":156.929741352,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":156.931747407,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.93208993,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":156.932100897,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.932107085,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":156.932112076,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.932296741,"data":"\n"}
,{"stream_name":"stdout","time":157.381098968,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":157.381130711,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.381137776,"data":"  Original dt: 4.673276e-01 s\n"}
,{"stream_name":"stdout","time":157.381142313,"data":"  Corrected dt: 2.920797e-01 s\n"}
,{"stream_name":"stdout","time":157.381147791,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.381152605,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":157.462390378,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":157.532022689,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.53205324,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.532028897,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stdout","time":157.532346587,"data":"\n"}
,{"stream_name":"stderr","time":157.532349669,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.01s/s]\n"}
,{"stream_name":"stdout","time":157.532360543,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":157.532391988,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":157.534408896,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.534424485,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":157.534430377,"data":"\n"}
,{"stream_name":"stdout","time":157.534435567,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":157.534440664,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":157.534445434,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":157.53445082,"data":"\n"}
,{"stream_name":"stdout","time":157.53445729,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":157.534462747,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":157.543879033,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":157.544299588,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":157.54432053,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":157.544350135,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":157.544401748,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":157.544586933,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":157.544595935,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":157.544601393,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":157.544618538,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":157.544669688,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":157.544679164,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":157.544684087,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":157.545620165,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":157.545635266,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":157.546048954,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":157.546462013,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":157.546477702,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.546484485,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":157.548962891,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":157.548984662,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.548991422,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":157.548997072,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.549154704,"data":"\n"}
,{"stream_name":"stdout","time":158.031520631,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":158.031572626,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.031590476,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":158.031809617,"data":"\n"}
,{"stream_name":"stderr","time":158.031811423,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":158.031819754,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":158.031828486,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.033637353,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.03396692,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":158.034012948,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.034020131,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":158.034024926,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.034175528,"data":"\n"}
,{"stream_name":"stdout","time":158.112439671,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":158.526119013,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":158.526146009,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.526152489,"data":"  Original dt: 4.731358e-01 s\n"}
,{"stream_name":"stdout","time":158.526157444,"data":"  Corrected dt: 2.957099e-01 s\n"}
,{"stream_name":"stdout","time":158.526162327,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.526167566,"data":"  Max wave speed detected: 16.91 m/s\n"}
,{"stream_name":"stdout","time":158.602533593,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":158.602533591,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.602578169,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.602673373,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.40s/s]\n"}
,{"stream_name":"stdout","time":158.602677103,"data":"\n"}
,{"stream_name":"stdout","time":158.602693585,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":158.602699255,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":158.604571752,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.604859476,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":158.604872303,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.604877599,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":158.604882971,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.605075308,"data":"\n"}
,{"stream_name":"stdout","time":158.682150454,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stderr","time":159.185005612,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.18503559,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.185019097,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":159.185315462,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.86s/s]\n"}
,{"stream_name":"stdout","time":159.185321722,"data":"\n"}
,{"stream_name":"stdout","time":159.185383592,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":159.18538996,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":159.187414971,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.187788953,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":159.18780424,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.18781044,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":159.187815913,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.188078279,"data":"\n"}
,{"stream_name":"stdout","time":159.234260296,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":159.642135644,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":159.642181501,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.642187769,"data":"  Original dt: 4.675250e-01 s\n"}
,{"stream_name":"stdout","time":159.642192376,"data":"  Corrected dt: 2.922031e-01 s\n"}
,{"stream_name":"stdout","time":159.642197247,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.642201757,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stderr","time":159.762343783,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":159.762363605,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":159.762376128,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.762689549,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.12s/s]\n"}
,{"stream_name":"stdout","time":159.762697348,"data":"\n"}
,{"stream_name":"stdout","time":159.762715613,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":159.762721487,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":159.764782021,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.765251326,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":159.765272549,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.765278869,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":159.765284084,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.765453389,"data":"\n"}
,{"stream_name":"stdout","time":159.788844501,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":160.353677925,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stderr","time":160.35409939,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":160.354107554,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":160.354116286,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.354482687,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.48s/s]\n"}
,{"stream_name":"stdout","time":160.354504862,"data":"\n"}
,{"stream_name":"stdout","time":160.354517818,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":160.354523627,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":160.356563106,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":160.356939031,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":160.356948763,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.356953903,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":160.356958374,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.35716606,"data":"\n"}
,{"stream_name":"stdout","time":160.785920364,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":160.785942551,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.78594676,"data":"  Original dt: 4.673370e-01 s\n"}
,{"stream_name":"stdout","time":160.785949898,"data":"  Corrected dt: 2.920856e-01 s\n"}
,{"stream_name":"stdout","time":160.785953331,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.785957664,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":160.954802326,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":160.978161898,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":160.97817239,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.978197085,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.97848761,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 24.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 24.15s/s]\n"}
,{"stream_name":"stdout","time":160.978513463,"data":"\n"}
,{"stream_name":"stdout","time":160.978523603,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":160.978528119,"data":"Total runtime: 0.62 seconds.\n"}
,{"stream_name":"stdout","time":160.980498102,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.980830363,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":160.98084334,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.980849081,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":160.980853972,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.981064051,"data":"\n"}
,{"stream_name":"stdout","time":161.528746584,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":161.574848842,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":161.574893471,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.57492833,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.575123839,"data":"\n"}
,{"stream_name":"stderr","time":161.575125062,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.26s/s]\n"}
,{"stream_name":"stdout","time":161.575134625,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":161.575143943,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":161.577556368,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.577870558,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":161.577880939,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.577886873,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":161.577892372,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.578085277,"data":"\n"}
,{"stream_name":"stdout","time":161.946441453,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":161.946469701,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.946476705,"data":"  Original dt: 4.673279e-01 s\n"}
,{"stream_name":"stdout","time":161.946481765,"data":"  Corrected dt: 2.920799e-01 s\n"}
,{"stream_name":"stdout","time":161.946486648,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.946491437,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":162.090636478,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":162.157092838,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":162.157171645,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.157190942,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":162.157427815,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.91s/s]\n"}
,{"stream_name":"stdout","time":162.157435203,"data":"\n"}
,{"stream_name":"stdout","time":162.15745722,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":162.157463716,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":162.159451755,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.159469611,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":162.159535731,"data":"\n"}
,{"stream_name":"stdout","time":162.159549874,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.159555797,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":162.159560906,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.159566382,"data":"\n"}
,{"stream_name":"stdout","time":162.159571286,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":162.159577047,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":162.169053244,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":162.16907581,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":162.169079613,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":162.16908272,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":162.16908565,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":162.169216906,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":162.169225819,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":162.16925983,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":162.16928604,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":162.169342273,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":162.169349219,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":162.169354325,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":162.170112541,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":162.170158771,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":162.170599939,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":162.170907104,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":162.170919132,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.170943062,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":162.173179926,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":162.173200351,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.173206354,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":162.173211788,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.173405742,"data":"\n"}
,{"stream_name":"stderr","time":162.656404711,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.656438066,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.65643676,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stdout","time":162.656644268,"data":"\n"}
,{"stream_name":"stdout","time":162.656663683,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":162.656669771,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":162.65669056,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.05s/s]\n"}
,{"stream_name":"stdout","time":162.658730388,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.659050747,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":162.659060046,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.659065178,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":162.659070121,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.659274343,"data":"\n"}
,{"stream_name":"stdout","time":162.737224949,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":163.083661013,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":163.083686688,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.083693162,"data":"  Original dt: 4.745725e-01 s\n"}
,{"stream_name":"stdout","time":163.083698162,"data":"  Corrected dt: 2.966078e-01 s\n"}
,{"stream_name":"stdout","time":163.083702869,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.083707566,"data":"  Max wave speed detected: 16.86 m/s\n"}
,{"stream_name":"stderr","time":163.227369128,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.227397008,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.227419224,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":163.227694318,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.40s/s]\n"}
,{"stream_name":"stdout","time":163.227701209,"data":"\n"}
,{"stream_name":"stdout","time":163.22775529,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":163.227760557,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":163.229588445,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.229934948,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":163.229948042,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.229954368,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":163.229958807,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.230144119,"data":"\n"}
,{"stream_name":"stdout","time":163.294590521,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":163.820911406,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":163.820913765,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.820947826,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.821143161,"data":"\n"}
,{"stream_name":"stdout","time":163.821158008,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":163.821162824,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":163.821168077,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.39s/s]\n"}
,{"stream_name":"stdout","time":163.823017152,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.823355245,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":163.823366685,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.823371304,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":163.823375652,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.823554094,"data":"\n"}
,{"stream_name":"stdout","time":163.867841955,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":164.217328707,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":164.21736033,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.217368238,"data":"  Original dt: 4.675680e-01 s\n"}
,{"stream_name":"stdout","time":164.217373205,"data":"  Corrected dt: 2.922300e-01 s\n"}
,{"stream_name":"stdout","time":164.217378305,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.21740464,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stdout","time":164.403153662,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":164.403153657,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.40320696,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.403427062,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.88s/s]\n"}
,{"stream_name":"stdout","time":164.403449621,"data":"\n"}
,{"stream_name":"stdout","time":164.403455341,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":164.403473517,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":164.405425143,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":164.40591866,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":164.405932272,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.405938143,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":164.405942997,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.406064172,"data":"\n"}
,{"stream_name":"stdout","time":164.42883912,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":164.965338097,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":164.965700398,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":164.965712328,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.965821698,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.966133406,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.79s/s]\n"}
,{"stream_name":"stdout","time":164.966151304,"data":"\n"}
,{"stream_name":"stdout","time":164.96617891,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":164.966185525,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":164.968108515,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.968474757,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":164.968486358,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.968491375,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":164.968521665,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.968681383,"data":"\n"}
,{"stream_name":"stdout","time":165.315252626,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":165.315279377,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.315285574,"data":"  Original dt: 4.673391e-01 s\n"}
,{"stream_name":"stdout","time":165.315290147,"data":"  Corrected dt: 2.920869e-01 s\n"}
,{"stream_name":"stdout","time":165.315294881,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.315299534,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":165.522828917,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":165.544634514,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":165.544635079,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":165.544664531,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.544838346,"data":"\n"}
,{"stream_name":"stderr","time":165.544838924,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.05s/s]\n"}
,{"stream_name":"stdout","time":165.544847803,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":165.544856341,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":165.547001035,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":165.547263048,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":165.547285687,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.547291932,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":165.547296716,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.54745873,"data":"\n"}
,{"stream_name":"stdout","time":166.071332074,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":166.118170659,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":166.118170681,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.118204422,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.118472944,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.28s/s]\n"}
,{"stream_name":"stdout","time":166.118489047,"data":"\n"}
,{"stream_name":"stdout","time":166.118504736,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":166.118510582,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":166.120454426,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.120803446,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":166.120816073,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.120821527,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":166.120826429,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.121002038,"data":"\n"}
,{"stream_name":"stdout","time":166.424547015,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":166.424574855,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.424581172,"data":"  Original dt: 4.673282e-01 s\n"}
,{"stream_name":"stdout","time":166.424585767,"data":"  Corrected dt: 2.920802e-01 s\n"}
,{"stream_name":"stdout","time":166.424590202,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.424594888,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":166.634180147,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":166.703686121,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":166.703686132,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.703739448,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.704019763,"data":"\n"}
,{"stream_name":"stdout","time":166.704032931,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stderr","time":166.704025273,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.74s/s]\n"}
,{"stream_name":"stdout","time":166.704038452,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":166.706042699,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.706065243,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":166.706071547,"data":"\n"}
,{"stream_name":"stdout","time":166.706076081,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.706081227,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":166.706086624,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.706092228,"data":"\n"}
,{"stream_name":"stdout","time":166.706116943,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":166.70614504,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":166.715857915,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":166.715886545,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":166.715893688,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":166.715897374,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":166.715900253,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":166.716069176,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":166.716077002,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":166.716082365,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":166.716087017,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":166.716141338,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":166.716151116,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":166.716156177,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":166.717055528,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":166.717073326,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":166.717462968,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":166.718283095,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":166.718301325,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.718307591,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":166.720737937,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":166.72075235,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":166.72075792,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":166.72076267,"data":"|    ep_rew_mean      | 0.0975   |\n"}
,{"stream_name":"stdout","time":166.720768254,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":166.720772904,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":166.720777913,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":166.720782547,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":166.720787421,"data":"|    time_elapsed     | 20       |\n"}
,{"stream_name":"stdout","time":166.7208048,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":166.720809306,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":166.7223465,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":166.722366238,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.722372036,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":166.722377945,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.722554654,"data":"\n"}
,{"stream_name":"stderr","time":167.204266736,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":167.204284989,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":167.204297408,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.204506095,"data":"\n"}
,{"stream_name":"stdout","time":167.204530278,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":167.20453685,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":167.204503986,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":167.206484041,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.206827613,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":167.206837294,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.206843373,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":167.206848668,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.207064163,"data":"\n"}
,{"stream_name":"stdout","time":167.285982393,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":167.56566592,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":167.565698516,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.565705157,"data":"  Original dt: 4.764413e-01 s\n"}
,{"stream_name":"stdout","time":167.565709716,"data":"  Corrected dt: 2.977758e-01 s\n"}
,{"stream_name":"stdout","time":167.565714795,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.565722121,"data":"  Max wave speed detected: 16.79 m/s\n"}
,{"stream_name":"stderr","time":167.774692005,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.774719201,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.774692002,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":167.775061093,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.42s/s]\n"}
,{"stream_name":"stdout","time":167.77508514,"data":"\n"}
,{"stream_name":"stdout","time":167.775096566,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":167.775101655,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":167.777144429,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.777523047,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":167.777536229,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.777541337,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":167.777545847,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.777742108,"data":"\n"}
,{"stream_name":"stdout","time":167.84699491,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":168.363635879,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":168.363634728,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.363699191,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.363920695,"data":"\n"}
,{"stream_name":"stderr","time":168.363920662,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.60s/s]\n"}
,{"stream_name":"stdout","time":168.363930776,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":168.363956219,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":168.366000007,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.366292515,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":168.366310826,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.366316728,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":168.366321571,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.366514841,"data":"\n"}
,{"stream_name":"stdout","time":168.41090064,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":168.688331721,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":168.688361927,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.688368772,"data":"  Original dt: 4.676223e-01 s\n"}
,{"stream_name":"stdout","time":168.688373603,"data":"  Corrected dt: 2.922639e-01 s\n"}
,{"stream_name":"stdout","time":168.688378512,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.688383448,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stderr","time":168.968884494,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.968918677,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.968883882,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stdout","time":168.969183907,"data":"\n"}
,{"stream_name":"stderr","time":168.969183388,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 24.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 24.90s/s]\n"}
,{"stream_name":"stdout","time":168.969193809,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":168.969267589,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":168.971165358,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.971685411,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":168.971698096,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.971704823,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":168.971708277,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.971948647,"data":"\n"}
,{"stream_name":"stdout","time":168.994360511,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":169.56630933,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":169.566643573,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":169.566676423,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.56669875,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.567113813,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.22s/s]\n"}
,{"stream_name":"stdout","time":169.567116755,"data":"\n"}
,{"stream_name":"stdout","time":169.567135945,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":169.567141501,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":169.569117787,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.569483183,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":169.569495117,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.569500199,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":169.569504512,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.569700068,"data":"\n"}
,{"stream_name":"stdout","time":169.850087339,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":169.850115979,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.850122076,"data":"  Original dt: 4.673416e-01 s\n"}
,{"stream_name":"stdout","time":169.850127478,"data":"  Corrected dt: 2.920885e-01 s\n"}
,{"stream_name":"stdout","time":169.850160167,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.85016694,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":170.125307407,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":170.148627361,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":170.148652766,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":170.148658576,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.14886973,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.91s/s]\n"}
,{"stream_name":"stdout","time":170.148888216,"data":"\n"}
,{"stream_name":"stdout","time":170.148893688,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":170.148899001,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":170.150986361,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.151377821,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":170.151392678,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.151398187,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":170.151402676,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.151588213,"data":"\n"}
,{"stream_name":"stdout","time":170.687279964,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":170.737301359,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.737958778,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":170.73797684,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.61s/s]\n"}
,{"stream_name":"stdout","time":170.738011163,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stdout","time":170.738024908,"data":"\n"}
,{"stream_name":"stdout","time":170.738029335,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":170.73804524,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":170.739764181,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.740185423,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":170.740195249,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.740217919,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":170.740222675,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.74043959,"data":"\n"}
,{"stream_name":"stdout","time":170.999054027,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":170.999084786,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.99909448,"data":"  Original dt: 4.673284e-01 s\n"}
,{"stream_name":"stdout","time":170.99909925,"data":"  Corrected dt: 2.920803e-01 s\n"}
,{"stream_name":"stdout","time":170.999103485,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.999107813,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":171.266506862,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":171.331724235,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":171.331787259,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.331822348,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":171.33202288,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 25.38s/s]\n"}
,{"stream_name":"stdout","time":171.332062687,"data":"\n"}
,{"stream_name":"stdout","time":171.33207589,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":171.332081695,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":171.334048498,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.334068629,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":171.334074767,"data":"\n"}
,{"stream_name":"stdout","time":171.334079922,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.334084621,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":171.334089592,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.334094631,"data":"\n"}
,{"stream_name":"stdout","time":171.334099452,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":171.334105023,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":171.343015733,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":171.343044185,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":171.343050133,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":171.343054947,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":171.343060534,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":171.343182034,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":171.343250987,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":171.343265162,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":171.343270989,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":171.343290982,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":171.343296367,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":171.343300841,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":171.344008778,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":171.344017428,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":171.344290466,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":171.344592774,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":171.344600469,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.344605192,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":171.347446393,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":171.347460939,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.347466036,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":171.347470466,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.347662753,"data":"\n"}
,{"stream_name":"stdout","time":171.819748574,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":171.819826629,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.819843943,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.820067,"data":"\n"}
,{"stream_name":"stdout","time":171.820078672,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":171.820083946,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":171.820107824,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.77s/s]\n"}
,{"stream_name":"stdout","time":171.822143615,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.822465396,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":171.82247823,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.822483761,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":171.822488404,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.822693614,"data":"\n"}
,{"stream_name":"stdout","time":171.900632876,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":172.109907804,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":172.109935188,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.109941668,"data":"  Original dt: 4.788713e-01 s\n"}
,{"stream_name":"stdout","time":172.109947266,"data":"  Corrected dt: 2.992945e-01 s\n"}
,{"stream_name":"stdout","time":172.109952174,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.109956882,"data":"  Max wave speed detected: 16.71 m/s\n"}
,{"stream_name":"stderr","time":172.381945627,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":172.381960516,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":172.381975639,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":172.382174777,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.82s/s]\n"}
,{"stream_name":"stdout","time":172.382207156,"data":"\n"}
,{"stream_name":"stdout","time":172.382219386,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":172.38222514,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":172.384191968,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.38452908,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":172.384546904,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.384553333,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":172.384558375,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.384690544,"data":"\n"}
,{"stream_name":"stdout","time":172.448434957,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":172.961463569,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":172.961501117,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.961519136,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.961810454,"data":"\n"}
,{"stream_name":"stderr","time":172.961817194,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.00s/s]\n"}
,{"stream_name":"stdout","time":172.96182244,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":172.961835194,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":172.963641876,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.963980208,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":172.963988349,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.963993047,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":172.963997197,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.964182358,"data":"\n"}
,{"stream_name":"stdout","time":173.008387384,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":173.229089362,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":173.229119926,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.229126958,"data":"  Original dt: 4.676824e-01 s\n"}
,{"stream_name":"stdout","time":173.229131837,"data":"  Corrected dt: 2.923015e-01 s\n"}
,{"stream_name":"stdout","time":173.229136764,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.229141721,"data":"  Max wave speed detected: 17.11 m/s\n"}
,{"stream_name":"stderr","time":173.562906626,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.562938064,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.562906577,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":173.563113383,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.05s/s]\n"}
,{"stream_name":"stdout","time":173.563147888,"data":"\n"}
,{"stream_name":"stdout","time":173.563153729,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":173.563158496,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":173.565667741,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.566167548,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":173.566177487,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.566182673,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":173.566187187,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.566405802,"data":"\n"}
,{"stream_name":"stdout","time":173.588414406,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":174.155812328,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":174.156156073,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":174.156167183,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.156220082,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.156613135,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.43s/s]\n"}
,{"stream_name":"stdout","time":174.156637476,"data":"\n"}
,{"stream_name":"stdout","time":174.156651631,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":174.156657011,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":174.158692461,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.159011754,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":174.159021061,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.159026098,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":174.159030711,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.159266612,"data":"\n"}
,{"stream_name":"stdout","time":174.375003234,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":174.375035177,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.375042264,"data":"  Original dt: 4.673445e-01 s\n"}
,{"stream_name":"stdout","time":174.375046524,"data":"  Corrected dt: 2.920903e-01 s\n"}
,{"stream_name":"stdout","time":174.375051642,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.375056196,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":174.720964661,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":174.744048398,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":174.744102117,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.744121308,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.744403972,"data":"\n"}
,{"stream_name":"stdout","time":174.744420525,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":174.74442664,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":174.744441397,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.65s/s]\n"}
,{"stream_name":"stdout","time":174.746493838,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.746868396,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":174.746912129,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.746919672,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":174.746925332,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.747055914,"data":"\n"}
,{"stream_name":"stdout","time":175.263858101,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":175.306794664,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":175.3067791,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.306841877,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.307059957,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.80s/s]\n"}
,{"stream_name":"stdout","time":175.307117968,"data":"\n"}
,{"stream_name":"stdout","time":175.307130085,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":175.307135147,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":175.309394942,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.30973015,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":175.309745603,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.309752174,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":175.309756771,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.309956333,"data":"\n"}
,{"stream_name":"stdout","time":175.473115118,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":175.473145357,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.473149822,"data":"  Original dt: 4.673285e-01 s\n"}
,{"stream_name":"stdout","time":175.473152916,"data":"  Corrected dt: 2.920803e-01 s\n"}
,{"stream_name":"stdout","time":175.473155823,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.473158618,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":175.813454572,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":175.88082703,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":175.880886239,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.880906385,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.881190402,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.27s/s]\n"}
,{"stream_name":"stdout","time":175.881638556,"data":"\n"}
,{"stream_name":"stdout","time":175.88168103,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":175.881687353,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":175.88353254,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.883549174,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":175.883566652,"data":"\n"}
,{"stream_name":"stdout","time":175.883572092,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.883577476,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":175.883582315,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.883587957,"data":"\n"}
,{"stream_name":"stdout","time":175.883640845,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":175.883656037,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":175.892550906,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":175.892577505,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":175.892584254,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":175.892589199,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":175.892593996,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":175.892741529,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":175.892748479,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":175.892753745,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":175.89275836,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":175.892810666,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":175.892902077,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":175.89291043,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":175.893763924,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":175.893780904,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":175.894117956,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":175.894531302,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":175.894546478,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.894551695,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":175.896760216,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":175.896771902,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.896802541,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":175.896807559,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.89700092,"data":"\n"}
,{"stream_name":"stderr","time":176.382112804,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.382141324,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.382112916,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":176.382480963,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 30.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 30.92s/s]\n"}
,{"stream_name":"stdout","time":176.382485701,"data":"\n"}
,{"stream_name":"stdout","time":176.382520001,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":176.382525886,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":176.384565803,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":176.385311257,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":176.385330238,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.385335638,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":176.385340248,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.385548516,"data":"\n"}
,{"stream_name":"stdout","time":176.463296055,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":176.61283366,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":176.612864127,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.61287127,"data":"  Original dt: 4.801395e-01 s\n"}
,{"stream_name":"stdout","time":176.612875795,"data":"  Corrected dt: 3.000872e-01 s\n"}
,{"stream_name":"stdout","time":176.61287991,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.612884083,"data":"  Max wave speed detected: 16.66 m/s\n"}
,{"stream_name":"stdout","time":176.949482247,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":176.949536245,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.949556254,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.94975801,"data":"\n"}
,{"stream_name":"stderr","time":176.94975769,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.60s/s]\n"}
,{"stream_name":"stdout","time":176.949766131,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":176.949776527,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":176.951634324,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":176.97250117,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.5 min | Speed: 1.6 steps/s\n"}
,{"stream_name":"stdout","time":176.972694938,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":176.972705917,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.972711895,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":176.972716403,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.972924065,"data":"\n"}
,{"stream_name":"stdout","time":177.03828903,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stderr","time":177.538307423,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.538348351,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.538312746,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":177.538602628,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.53s/s]\n"}
,{"stream_name":"stdout","time":177.538613847,"data":"\n"}
,{"stream_name":"stdout","time":177.538624282,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":177.53862996,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":177.540646149,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":177.540986801,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":177.541000879,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.541006444,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":177.541011511,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.541281238,"data":"\n"}
,{"stream_name":"stdout","time":177.586190484,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":177.731573158,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":177.731605966,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.731612887,"data":"  Original dt: 4.677584e-01 s\n"}
,{"stream_name":"stdout","time":177.731617823,"data":"  Corrected dt: 2.923490e-01 s\n"}
,{"stream_name":"stdout","time":177.731622642,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.731626925,"data":"  Max wave speed detected: 17.10 m/s\n"}
,{"stream_name":"stdout","time":178.117208357,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":178.117275564,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.117299527,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.117634923,"data":"\n"}
,{"stream_name":"stderr","time":178.117635108,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.03s/s]\n"}
,{"stream_name":"stdout","time":178.117647974,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":178.11767578,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":178.119734997,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":178.120223865,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":178.12026029,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.120266377,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":178.120271588,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.120441844,"data":"\n"}
,{"stream_name":"stdout","time":178.142293469,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":178.690782222,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":178.691106307,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":178.691114056,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.69112541,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.691480138,"data":"\n"}
,{"stream_name":"stdout","time":178.691496969,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":178.691501657,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":178.691495201,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.28s/s]\n"}
,{"stream_name":"stdout","time":178.693355222,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":178.693702207,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":178.693709592,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.693713768,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":178.69371771,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.693898869,"data":"\n"}
,{"stream_name":"stdout","time":178.840208468,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":178.840257786,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.840273839,"data":"  Original dt: 4.673479e-01 s\n"}
,{"stream_name":"stdout","time":178.840282852,"data":"  Corrected dt: 2.920924e-01 s\n"}
,{"stream_name":"stdout","time":178.840287078,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.840291262,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":179.258713347,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":179.281370843,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.28140065,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.281421908,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":179.281668002,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 25.53s/s]\n"}
,{"stream_name":"stdout","time":179.281695129,"data":"\n"}
,{"stream_name":"stdout","time":179.28170312,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":179.281707197,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":179.283740515,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":179.284090828,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":179.284099784,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.284104579,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":179.284108999,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.284308233,"data":"\n"}
,{"stream_name":"stdout","time":179.816434822,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":179.861505615,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.861547753,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.861505471,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stdout","time":179.861715695,"data":"\n"}
,{"stream_name":"stderr","time":179.861718008,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.99s/s]\n"}
,{"stream_name":"stdout","time":179.861725446,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":179.861741912,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":179.863754634,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":179.864100841,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":179.864113733,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.864120183,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":179.864124723,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.864335863,"data":"\n"}
,{"stream_name":"stdout","time":179.964822119,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":179.964850133,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.964856285,"data":"  Original dt: 4.673285e-01 s\n"}
,{"stream_name":"stdout","time":179.964860761,"data":"  Corrected dt: 2.920803e-01 s\n"}
,{"stream_name":"stdout","time":179.964865418,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.964869763,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":180.374510479,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":180.439999779,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":180.440056451,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.440065207,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":180.440290321,"data":"\n"}
,{"stream_name":"stdout","time":180.440305431,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":180.440310627,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":180.440335084,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.06s/s]\n"}
,{"stream_name":"stdout","time":180.442292395,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.442313215,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":180.442318718,"data":"\n"}
,{"stream_name":"stdout","time":180.442322006,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.442325062,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.00 | Avg Reward/Step: 0.000\n"}
,{"stream_name":"stdout","time":180.442328538,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.442331509,"data":"\n"}
,{"stream_name":"stdout","time":180.442334273,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.442337275,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.45109997,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.451123194,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.451152571,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.451158271,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.451162809,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.451169333,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.451173945,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.451178546,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.451215053,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.451220337,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":180.451224532,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.451246558,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.451919041,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.451927868,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":180.452220914,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.452533845,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":180.452545962,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.452550745,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":180.454849598,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":180.454868286,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.454874438,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":180.45487928,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.454924194,"data":"\n"}
,{"stream_name":"stderr","time":180.968785313,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.968837089,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":180.968785355,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stdout","time":180.969102284,"data":"\n"}
,{"stream_name":"stdout","time":180.969115343,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":180.969120594,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":180.96912269,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 29.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 29.19s/s]\n"}
,{"stream_name":"stdout","time":180.971151313,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":180.971543118,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":180.97156256,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.971589115,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":180.971594134,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.971783581,"data":"\n"}
,{"stream_name":"stdout","time":181.047341938,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":181.127288752,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":181.127316376,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.127324285,"data":"  Original dt: 4.815506e-01 s\n"}
,{"stream_name":"stdout","time":181.127328425,"data":"  Corrected dt: 3.009692e-01 s\n"}
,{"stream_name":"stdout","time":181.127331359,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.127334125,"data":"  Max wave speed detected: 16.61 m/s\n"}
,{"stream_name":"stderr","time":181.536945522,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.536980467,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.536952934,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":181.537305238,"data":"\n"}
,{"stream_name":"stdout","time":181.537351139,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":181.537358699,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":181.537305438,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.54s/s]\n"}
,{"stream_name":"stdout","time":181.539309348,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":181.539662706,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":181.539672345,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.539677316,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":181.539683678,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.53989848,"data":"\n"}
,{"stream_name":"stdout","time":181.605726159,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":182.119678405,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":182.119705126,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.119716645,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":182.119943266,"data":"\n"}
,{"stream_name":"stdout","time":182.119953297,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":182.119983798,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":182.119958525,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.87s/s]\n"}
,{"stream_name":"stdout","time":182.1217945,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.122193772,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":182.122210545,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.122216162,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":182.122220953,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.122406748,"data":"\n"}
,{"stream_name":"stdout","time":182.16655009,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":182.247725885,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":182.247768892,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.247774602,"data":"  Original dt: 4.678547e-01 s\n"}
,{"stream_name":"stdout","time":182.2477789,"data":"  Corrected dt: 2.924092e-01 s\n"}
,{"stream_name":"stdout","time":182.247782661,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.247802996,"data":"  Max wave speed detected: 17.10 m/s\n"}
,{"stream_name":"stdout","time":182.691754805,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":182.691754887,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.691804867,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":182.692057807,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.34s/s]\n"}
,{"stream_name":"stdout","time":182.692068122,"data":"\n"}
,{"stream_name":"stdout","time":182.692078067,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":182.692082905,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":182.69392497,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":182.694406536,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":182.694425461,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.694432578,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":182.694437541,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.694641208,"data":"\n"}
,{"stream_name":"stdout","time":182.716504593,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":183.268141214,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":183.268522553,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":183.268545922,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.268601338,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":183.268921011,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.13s/s]\n"}
,{"stream_name":"stdout","time":183.268942729,"data":"\n"}
,{"stream_name":"stdout","time":183.268950748,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":183.268955313,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":183.270996862,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":183.271416352,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":183.271429288,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.271435549,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":183.271439979,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.271644747,"data":"\n"}
,{"stream_name":"stdout","time":183.349434268,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":183.349463639,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.349470399,"data":"  Original dt: 4.673519e-01 s\n"}
,{"stream_name":"stdout","time":183.349474861,"data":"  Corrected dt: 2.920949e-01 s\n"}
,{"stream_name":"stdout","time":183.349479126,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.349485366,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":183.81849686,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":183.841646318,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":183.841693726,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":183.841705832,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":183.84194454,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.31s/s]\n"}
,{"stream_name":"stdout","time":183.841948277,"data":"\n"}
,{"stream_name":"stdout","time":183.841960599,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":183.841965823,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":183.844005693,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":183.844347977,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":183.844366871,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.844373091,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":183.844379189,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":183.844562246,"data":"\n"}
,{"stream_name":"stdout","time":184.352581036,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":184.397025603,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":184.397106727,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.397124553,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":184.397325659,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.15s/s]\n"}
,{"stream_name":"stdout","time":184.397335885,"data":"\n"}
,{"stream_name":"stdout","time":184.397354886,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":184.397360493,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":184.399280431,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":184.399629466,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":184.399640317,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.399645871,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":184.399650946,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":184.399880465,"data":"\n"}
,{"stream_name":"stdout","time":184.434711778,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":184.434743794,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.434750253,"data":"  Original dt: 4.673285e-01 s\n"}
,{"stream_name":"stdout","time":184.434754866,"data":"  Corrected dt: 2.920803e-01 s\n"}
,{"stream_name":"stdout","time":184.434759651,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.434764457,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":184.887252203,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":184.949739844,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":184.949753541,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":184.949794418,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":184.950077009,"data":"\n"}
,{"stream_name":"stderr","time":184.950081817,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.28s/s]\n"}
,{"stream_name":"stdout","time":184.950086871,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":184.950096606,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":184.952004728,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":184.952023536,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":184.952028338,"data":"\n"}
,{"stream_name":"stdout","time":184.952032283,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.952042118,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":184.95204693,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":184.952051491,"data":"\n"}
,{"stream_name":"stdout","time":184.952055899,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":184.952062104,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":184.960250395,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":184.960271415,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":184.96027684,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":184.960281554,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":184.960292553,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":184.960458458,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":184.960467305,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":184.960471794,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":184.960476162,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":184.960480936,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":184.96049403,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":184.960498337,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":184.961224374,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":184.961264218,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":184.961504668,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":184.962226072,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":184.962290369,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.962310366,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":184.964378542,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":184.964394738,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":184.964399195,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":184.964405891,"data":"|    ep_rew_mean      | 0.095    |\n"}
,{"stream_name":"stdout","time":184.964408873,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":184.964411366,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":184.964414102,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":184.964416754,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":184.964419395,"data":"|    time_elapsed     | 39       |\n"}
,{"stream_name":"stdout","time":184.964421952,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":184.964424528,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":184.965611267,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":184.965623433,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.965628355,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":184.965632316,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":184.96584435,"data":"\n"}
,{"stream_name":"stderr","time":185.418746557,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":185.418778476,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":185.418755109,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stdout","time":185.419010748,"data":"\n"}
,{"stream_name":"stderr","time":185.41901074,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 33.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 33.12s/s]\n"}
,{"stream_name":"stdout","time":185.419018721,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":185.419041619,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":185.420992289,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":185.421378752,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":185.421390876,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.421395816,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":185.421400328,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":185.421623058,"data":"\n"}
,{"stream_name":"stdout","time":185.498695801,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":185.511071802,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":185.511098908,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.511105018,"data":"  Original dt: 4.836098e-01 s\n"}
,{"stream_name":"stdout","time":185.511109658,"data":"  Corrected dt: 3.022561e-01 s\n"}
,{"stream_name":"stdout","time":185.511114616,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.51112006,"data":"  Max wave speed detected: 16.54 m/s\n"}
,{"stream_name":"stdout","time":185.978858906,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":185.978858922,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":185.97889479,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":185.979260651,"data":"\n"}
,{"stream_name":"stdout","time":185.979287762,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":185.979294506,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":185.979264533,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.92s/s]\n"}
,{"stream_name":"stdout","time":185.981197342,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":185.981515567,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":185.981527654,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.98153241,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":185.981536682,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":185.981731265,"data":"\n"}
,{"stream_name":"stdout","time":186.045099254,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stderr","time":186.535073903,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":186.535124518,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":186.535082083,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":186.535448461,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 27.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 27.11s/s]\n"}
,{"stream_name":"stdout","time":186.535456816,"data":"\n"}
,{"stream_name":"stdout","time":186.535474659,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":186.535480544,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":186.537542895,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":186.537919898,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":186.537929261,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.537934487,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":186.537939965,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":186.538152264,"data":"\n"}
,{"stream_name":"stdout","time":186.584840537,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":186.596853522,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":186.596873622,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.596880737,"data":"  Original dt: 4.679769e-01 s\n"}
,{"stream_name":"stdout","time":186.596884784,"data":"  Corrected dt: 2.924856e-01 s\n"}
,{"stream_name":"stdout","time":186.596889842,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.596894751,"data":"  Max wave speed detected: 17.09 m/s\n"}
,{"stream_name":"stderr","time":187.110748711,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":187.110748774,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":187.110776699,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":187.111059689,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.20s/s]\n"}
,{"stream_name":"stdout","time":187.111080322,"data":"\n"}
,{"stream_name":"stdout","time":187.111085486,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":187.111089762,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":187.11281778,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":187.113296435,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":187.113314193,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.113317957,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":187.11332101,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":187.113542117,"data":"\n"}
,{"stream_name":"stdout","time":187.134099878,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":187.694496957,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":187.694872871,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":187.694909377,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":187.694936393,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":187.695302428,"data":"\n"}
,{"stream_name":"stdout","time":187.695327747,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":187.695333108,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":187.695301943,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.80s/s]\n"}
,{"stream_name":"stdout","time":187.697335268,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":187.697687163,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":187.697695851,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.697700698,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":187.697705082,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":187.697910487,"data":"\n"}
,{"stream_name":"stdout","time":187.710810114,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":187.710832779,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.710839157,"data":"  Original dt: 4.673563e-01 s\n"}
,{"stream_name":"stdout","time":187.710844008,"data":"  Corrected dt: 2.920977e-01 s\n"}
,{"stream_name":"stdout","time":187.710848529,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.710853579,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":188.236337532,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":188.257815862,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":188.257844959,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":188.257859015,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stdout","time":188.258116137,"data":"\n"}
,{"stream_name":"stdout","time":188.258128391,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stderr","time":188.258113739,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.79s/s]\n"}
,{"stream_name":"stdout","time":188.258133396,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":188.259994505,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":188.26035147,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":188.260369616,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.260376572,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":188.260401684,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":188.260584028,"data":"\n"}
,{"stream_name":"stdout","time":188.795546785,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":188.808119405,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":188.80814721,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.808154078,"data":"  Original dt: 4.673286e-01 s\n"}
,{"stream_name":"stdout","time":188.808159063,"data":"  Corrected dt: 2.920804e-01 s\n"}
,{"stream_name":"stdout","time":188.80816403,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.808169031,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":188.83909565,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":188.839095652,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":188.83915539,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":188.839410996,"data":"\n"}
,{"stream_name":"stderr","time":188.83941776,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.93s/s]\n"}
,{"stream_name":"stdout","time":188.839426616,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":188.839467809,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":188.841314082,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":188.841593107,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":188.841605182,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.841610103,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":188.841614508,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":188.841792395,"data":"\n"}
,{"stream_name":"stdout","time":189.339909458,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":189.404848926,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":189.40487834,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":189.404844035,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stdout","time":189.405038548,"data":"\n"}
,{"stream_name":"stderr","time":189.405042097,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.64s/s]\n"}
,{"stream_name":"stdout","time":189.405047475,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":189.405116213,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":189.406945436,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":189.406963591,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":189.406989048,"data":"\n"}
,{"stream_name":"stdout","time":189.407002711,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":189.40702193,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":189.407026703,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":189.40703162,"data":"\n"}
,{"stream_name":"stdout","time":189.40703616,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":189.407041151,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":189.415725666,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":189.415757237,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":189.415763997,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":189.415769275,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":189.415773899,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":189.415789794,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":189.415794931,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":189.41579974,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":189.415877844,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":189.415885551,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":189.415970786,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":189.415976955,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":189.416776134,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":189.41680435,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":189.41714777,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":189.417543327,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":189.417555762,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.417561213,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":189.419905637,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":189.419921312,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.41992668,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":189.41995428,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":189.420127762,"data":"\n"}
,{"stream_name":"stdout","time":189.89141609,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":189.891477301,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":189.891496369,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":189.891761681,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.83s/s]\n"}
,{"stream_name":"stdout","time":189.891764624,"data":"\n"}
,{"stream_name":"stdout","time":189.891784949,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":189.891790859,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":189.893716296,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":189.894070131,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":189.894083928,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.894089631,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":189.894094547,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":189.894265477,"data":"\n"}
,{"stream_name":"stdout","time":189.918265404,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":189.918294182,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.918302425,"data":"  Original dt: 4.866346e-01 s\n"}
,{"stream_name":"stdout","time":189.918306001,"data":"  Corrected dt: 3.041467e-01 s\n"}
,{"stream_name":"stdout","time":189.918309162,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.918312101,"data":"  Max wave speed detected: 16.44 m/s\n"}
,{"stream_name":"stdout","time":189.972673355,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stderr","time":190.456221726,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":190.456269388,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":190.456221399,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":190.456576185,"data":"\n"}
,{"stream_name":"stdout","time":190.456586551,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stderr","time":190.456580641,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.69s/s]\n"}
,{"stream_name":"stdout","time":190.456590793,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":190.45854657,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.458889069,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":190.45889801,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.45890279,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":190.458907099,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":190.459107271,"data":"\n"}
,{"stream_name":"stdout","time":190.526110972,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":191.04375922,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":191.043791976,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.043799145,"data":"  Original dt: 4.680994e-01 s\n"}
,{"stream_name":"stdout","time":191.043804001,"data":"  Corrected dt: 2.925621e-01 s\n"}
,{"stream_name":"stdout","time":191.043808878,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.043813574,"data":"  Max wave speed detected: 17.09 m/s\n"}
,{"stream_name":"stdout","time":191.054343992,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":191.054343976,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":191.054399157,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":191.054727107,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.20s/s]\n"}
,{"stream_name":"stdout","time":191.05473116,"data":"\n"}
,{"stream_name":"stdout","time":191.054750388,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":191.054756277,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":191.056715918,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.05709278,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":191.057102233,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.057107239,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":191.057112532,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":191.057309787,"data":"\n"}
,{"stream_name":"stdout","time":191.102685816,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":191.62353631,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":191.623536314,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":191.623581475,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":191.623877003,"data":"\n"}
,{"stream_name":"stdout","time":191.623889217,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":191.623894696,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":191.623910882,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.49s/s]\n"}
,{"stream_name":"stdout","time":191.625832604,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.626356168,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":191.626372188,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.626377197,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":191.626383522,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":191.62655641,"data":"\n"}
,{"stream_name":"stdout","time":191.649512858,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":192.134413928,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":192.134446618,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.134453101,"data":"  Original dt: 4.673609e-01 s\n"}
,{"stream_name":"stdout","time":192.134457892,"data":"  Corrected dt: 2.921006e-01 s\n"}
,{"stream_name":"stdout","time":192.134462364,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.134467614,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":192.189345082,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":192.189684858,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":192.189712535,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":192.189721838,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":192.190119063,"data":"\n"}
,{"stream_name":"stdout","time":192.190129587,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":192.19013517,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":192.190150125,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.64s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.63s/s]\n"}
,{"stream_name":"stdout","time":192.192177032,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.192582696,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":192.19259459,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.192621624,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":192.192627139,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":192.192790942,"data":"\n"}
,{"stream_name":"stdout","time":192.73648589,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":192.758482449,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":192.758491524,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":192.758525904,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":192.75884823,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.51s/s]\n"}
,{"stream_name":"stdout","time":192.758854754,"data":"\n"}
,{"stream_name":"stdout","time":192.758866885,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":192.758872112,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":192.760810664,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":192.761155933,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":192.761165421,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.76116981,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":192.761173721,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":192.761401859,"data":"\n"}
,{"stream_name":"stdout","time":193.244653621,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":193.244682838,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.244689156,"data":"  Original dt: 4.673289e-01 s\n"}
,{"stream_name":"stdout","time":193.244693945,"data":"  Corrected dt: 2.920806e-01 s\n"}
,{"stream_name":"stdout","time":193.244698366,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.244703095,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":193.29691415,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":193.340896362,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":193.340927292,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":193.340911767,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stdout","time":193.341227422,"data":"\n"}
,{"stream_name":"stdout","time":193.3412365,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stderr","time":193.341233946,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.88s/s]\n"}
,{"stream_name":"stdout","time":193.341259526,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":193.343089132,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":193.343491215,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":193.34350426,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.343511097,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":193.343515937,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":193.343719854,"data":"\n"}
,{"stream_name":"stdout","time":193.849639078,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":193.916252494,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":193.916256841,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":193.916298398,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":193.916511108,"data":"\n"}
,{"stream_name":"stdout","time":193.916519858,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":193.916524174,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":193.916519752,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.20s/s]\n"}
,{"stream_name":"stdout","time":193.918581042,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":193.918599723,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":193.918605308,"data":"\n"}
,{"stream_name":"stdout","time":193.918609848,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":193.91861504,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.06 | Avg Reward/Step: 0.007\n"}
,{"stream_name":"stdout","time":193.918619873,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":193.918625181,"data":"\n"}
,{"stream_name":"stdout","time":193.918629989,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":193.91863652,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":193.927472204,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":193.927491685,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":193.927496443,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":193.927500403,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":193.927504336,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":193.927653255,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":193.927660887,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":193.92766577,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":193.927669819,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":193.92767365,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":193.927720809,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":193.927728199,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":193.928541261,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":193.928558527,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":193.928955628,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":193.929289123,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":193.929301638,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.92930687,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":193.931662464,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":193.931675102,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.931680253,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":193.931684963,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":193.931864751,"data":"\n"}
,{"stream_name":"stdout","time":194.359823475,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":194.359853863,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.359858184,"data":"  Original dt: 4.907010e-01 s\n"}
,{"stream_name":"stdout","time":194.359861031,"data":"  Corrected dt: 3.066881e-01 s\n"}
,{"stream_name":"stdout","time":194.359863979,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.359866627,"data":"  Max wave speed detected: 16.30 m/s\n"}
,{"stream_name":"stdout","time":194.402364403,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":194.402368558,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":194.402405364,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":194.402757107,"data":"\n"}
,{"stream_name":"stderr","time":194.40275799,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.88s/s]\n"}
,{"stream_name":"stdout","time":194.402768744,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":194.402790995,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":194.404612789,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":194.404954892,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":194.404967724,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.404973018,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":194.404977765,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":194.405167396,"data":"\n"}
,{"stream_name":"stdout","time":194.484863351,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":194.978291433,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":194.978315393,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":194.978336105,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":194.978563426,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.17s/s]\n"}
,{"stream_name":"stdout","time":194.978565835,"data":"\n"}
,{"stream_name":"stdout","time":194.978585248,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":194.978590868,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":194.980582479,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":194.980926069,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":194.980935322,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.980940298,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":194.980944918,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":194.981146384,"data":"\n"}
,{"stream_name":"stdout","time":195.048097823,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":195.489160629,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":195.489191361,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.489197872,"data":"  Original dt: 4.682663e-01 s\n"}
,{"stream_name":"stdout","time":195.48920293,"data":"  Corrected dt: 2.926664e-01 s\n"}
,{"stream_name":"stdout","time":195.489208449,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.489213339,"data":"  Max wave speed detected: 17.08 m/s\n"}
,{"stream_name":"stdout","time":195.569461715,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stderr","time":195.569499599,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":195.569544321,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":195.569761282,"data":"\n"}
,{"stream_name":"stdout","time":195.569770723,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":195.569775492,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stderr","time":195.569798241,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.50s/s]\n"}
,{"stream_name":"stdout","time":195.571750533,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":195.572089548,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":195.572099263,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.572104303,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":195.572108678,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":195.572311639,"data":"\n"}
,{"stream_name":"stdout","time":195.617518149,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":196.140724129,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":196.140758362,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":196.140777757,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":196.141023824,"data":"\n"}
,{"stream_name":"stdout","time":196.141048083,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stderr","time":196.141023272,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.39s/s]\n"}
,{"stream_name":"stdout","time":196.141067186,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":196.142996087,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":196.143512572,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":196.143534583,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.143540307,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":196.143544741,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":196.143686404,"data":"\n"}
,{"stream_name":"stdout","time":196.16894328,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":196.598052765,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":196.598082372,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.598109465,"data":"  Original dt: 4.673674e-01 s\n"}
,{"stream_name":"stdout","time":196.598114779,"data":"  Corrected dt: 2.921046e-01 s\n"}
,{"stream_name":"stdout","time":196.598123607,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.598128502,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":196.718740667,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":196.719161549,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":196.719267391,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":196.71929403,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":196.719574069,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.06s/s]\n"}
,{"stream_name":"stdout","time":196.719582909,"data":"\n"}
,{"stream_name":"stdout","time":196.719612804,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":196.719618954,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":196.721612572,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":196.72201616,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":196.722029007,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.722034207,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":196.722038847,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":196.722264019,"data":"\n"}
,{"stream_name":"stdout","time":197.274634519,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":197.29575888,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stderr","time":197.295773202,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":197.295816598,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":197.296088302,"data":"\n"}
,{"stream_name":"stdout","time":197.296099391,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":197.296104243,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":197.29610112,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.15s/s]\n"}
,{"stream_name":"stdout","time":197.297992113,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":197.298353707,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":197.298394158,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.298401185,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":197.298406284,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":197.298576463,"data":"\n"}
,{"stream_name":"stdout","time":197.70812861,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":197.708156168,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.708162541,"data":"  Original dt: 4.673294e-01 s\n"}
,{"stream_name":"stdout","time":197.708167201,"data":"  Corrected dt: 2.920808e-01 s\n"}
,{"stream_name":"stdout","time":197.708171854,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.708176456,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":197.829875323,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":197.877799957,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":197.877831593,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":197.877851354,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":197.878079162,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 25.89s/s]\n"}
,{"stream_name":"stdout","time":197.878102244,"data":"\n"}
,{"stream_name":"stdout","time":197.878113652,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":197.878118274,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":197.880195937,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":197.880588132,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":197.880608083,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.880614569,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":197.880619884,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":197.880781086,"data":"\n"}
,{"stream_name":"stdout","time":198.387194904,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":198.4552009,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":198.455240993,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":198.455249051,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":198.455532443,"data":"\n"}
,{"stream_name":"stdout","time":198.455548751,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stderr","time":198.455561865,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.11s/s]\n"}
,{"stream_name":"stdout","time":198.455572647,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":198.457421303,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":198.457439175,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":198.457455632,"data":"\n"}
,{"stream_name":"stdout","time":198.457460303,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.457464566,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":198.457469013,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.457475772,"data":"\n"}
,{"stream_name":"stdout","time":198.457478765,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":198.457481748,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":198.466480469,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":198.466506862,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":198.466512814,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":198.466517754,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":198.46652263,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":198.466615124,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":198.466645715,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":198.466651293,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":198.466655965,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":198.46666065,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":198.466668729,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":198.466673645,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":198.467411581,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":198.467426563,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":198.467745304,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":198.468060026,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":198.468069007,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.468073986,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":198.470449506,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":198.470479225,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.470483197,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":198.470486147,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":198.470675657,"data":"\n"}
,{"stream_name":"stdout","time":198.826808721,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":198.826836225,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.826842086,"data":"  Original dt: 4.972423e-01 s\n"}
,{"stream_name":"stdout","time":198.826845199,"data":"  Corrected dt: 3.107764e-01 s\n"}
,{"stream_name":"stdout","time":198.82684799,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.826850715,"data":"  Max wave speed detected: 16.09 m/s\n"}
,{"stream_name":"stderr","time":198.933081983,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":198.933112964,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":198.933082841,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stdout","time":198.933362579,"data":"\n"}
,{"stream_name":"stdout","time":198.933376475,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":198.933381916,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":198.933362434,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 32.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 32.44s/s]\n"}
,{"stream_name":"stdout","time":198.935716019,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":198.936086847,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":198.936095903,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.93610191,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":198.936107198,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":198.93631857,"data":"\n"}
,{"stream_name":"stdout","time":199.016367577,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stderr","time":199.495896111,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":199.495921819,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":199.495926896,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":199.496144094,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.81s/s]\n"}
,{"stream_name":"stdout","time":199.496178628,"data":"\n"}
,{"stream_name":"stdout","time":199.496188861,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":199.496216843,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":199.498274183,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":199.498597063,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":199.498610935,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":199.498616673,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":199.498622201,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":199.498816677,"data":"\n"}
,{"stream_name":"stdout","time":199.566613,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":199.93169599,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":199.931725797,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":199.931732532,"data":"  Original dt: 4.684796e-01 s\n"}
,{"stream_name":"stdout","time":199.93173688,"data":"  Corrected dt: 2.927997e-01 s\n"}
,{"stream_name":"stdout","time":199.931741,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":199.931748032,"data":"  Max wave speed detected: 17.08 m/s\n"}
,{"stream_name":"stderr","time":200.075911816,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":200.07594158,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":200.07595162,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":200.076177218,"data":"\n"}
,{"stream_name":"stderr","time":200.076177489,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 26.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.99s/s]\n"}
,{"stream_name":"stdout","time":200.076185702,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":200.076195386,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":200.07819248,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":200.078554151,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":200.078566169,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.078571298,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":200.07857584,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":200.078789777,"data":"\n"}
,{"stream_name":"stdout","time":200.123592621,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":200.652125256,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":200.652133657,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":200.652177601,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":200.652455446,"data":"\n"}
,{"stream_name":"stderr","time":200.652462291,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.16s/s]\n"}
,{"stream_name":"stdout","time":200.652470197,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":200.652490041,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":200.654572148,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":200.655081154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":200.655095659,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":200.655101635,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":200.655106761,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":200.655275969,"data":"\n"}
,{"stream_name":"stdout","time":200.676608352,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":201.055368861,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":201.055400977,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":201.055408024,"data":"  Original dt: 4.673756e-01 s\n"}
,{"stream_name":"stdout","time":201.05541305,"data":"  Corrected dt: 2.921097e-01 s\n"}
,{"stream_name":"stdout","time":201.055417206,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":201.055421293,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":201.235888499,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":201.236325769,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":201.236339608,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":201.23635002,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":201.236667303,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 25.81s/s]\n"}
,{"stream_name":"stdout","time":201.236686023,"data":"\n"}
,{"stream_name":"stdout","time":201.236694164,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":201.236698456,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":201.238628416,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":201.238982995,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":201.238990021,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.238994917,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":201.238999962,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":201.239185737,"data":"\n"}
,{"stream_name":"stdout","time":201.782968753,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":201.804671383,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":201.804707774,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":201.804673243,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stdout","time":201.804928019,"data":"\n"}
,{"stream_name":"stdout","time":201.804936811,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stderr","time":201.804933869,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.53s/s]\n"}
,{"stream_name":"stdout","time":201.804941017,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":201.806780957,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":201.807112765,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":201.807120069,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.807124323,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":201.807128167,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":201.807329725,"data":"\n"}
,{"stream_name":"stdout","time":202.136608101,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":202.136636649,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":202.136643477,"data":"  Original dt: 4.673300e-01 s\n"}
,{"stream_name":"stdout","time":202.136648266,"data":"  Corrected dt: 2.920812e-01 s\n"}
,{"stream_name":"stdout","time":202.136652629,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":202.136657118,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":202.318377237,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stderr","time":202.360279118,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":202.360311464,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":202.360279115,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":202.360475461,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.13s/s]\n"}
,{"stream_name":"stdout","time":202.360503598,"data":"\n"}
,{"stream_name":"stdout","time":202.360521705,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":202.360527078,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":202.362305208,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":202.362654587,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":202.362662114,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.362666641,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":202.36267063,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":202.362875902,"data":"\n"}
,{"stream_name":"stdout","time":202.872329406,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":202.937538991,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stderr","time":202.937566438,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":202.937585047,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":202.937765291,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.10s/s]\n"}
,{"stream_name":"stdout","time":202.937802041,"data":"\n"}
,{"stream_name":"stdout","time":202.937811133,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":202.93781615,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":202.939738497,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":202.939759682,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":202.939765766,"data":"\n"}
,{"stream_name":"stdout","time":202.939771141,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":202.939776442,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":202.939781623,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":202.9397862,"data":"\n"}
,{"stream_name":"stdout","time":202.939791562,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":202.939797407,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":202.948567395,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":202.948593636,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":202.948621911,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":202.948627702,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":202.948633706,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":202.948679488,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":202.948686773,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":202.948691321,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":202.948707147,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":202.948760588,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":202.948777212,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":202.948781998,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":202.949629352,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":202.949651756,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":202.949988978,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":202.950316936,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":202.950329869,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":202.950335303,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":202.952684548,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":202.952702974,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":202.95270781,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":202.952711875,"data":"|    ep_rew_mean      | 0.0967   |\n"}
,{"stream_name":"stdout","time":202.952716837,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":202.952720935,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":202.952724969,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":202.952729615,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":202.952734177,"data":"|    time_elapsed     | 57       |\n"}
,{"stream_name":"stdout","time":202.952738289,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":202.952742746,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":202.953813201,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":202.953831774,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":202.953837649,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":202.953842362,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":202.954017916,"data":"\n"}
,{"stream_name":"stdout","time":203.254328678,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":203.254380892,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":203.254387244,"data":"  Original dt: 5.073035e-01 s\n"}
,{"stream_name":"stdout","time":203.254393391,"data":"  Corrected dt: 3.170647e-01 s\n"}
,{"stream_name":"stdout","time":203.254397552,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":203.25440148,"data":"  Max wave speed detected: 15.77 m/s\n"}
,{"stream_name":"stderr","time":203.432486895,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":203.432516421,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":203.432486901,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":203.43278113,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.35s/s]\n"}
,{"stream_name":"stdout","time":203.432787598,"data":"\n"}
,{"stream_name":"stdout","time":203.432805056,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":203.432810569,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":203.434864938,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":203.435222239,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":203.435257419,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":203.435264438,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":203.435269862,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":203.435458901,"data":"\n"}
,{"stream_name":"stdout","time":203.516170168,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":203.999135575,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":203.999143265,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":203.999179162,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":203.99946433,"data":"\n"}
,{"stream_name":"stdout","time":203.999490894,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":203.999498121,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":203.999466096,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 26.60s/s]\n"}
,{"stream_name":"stdout","time":204.001210907,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":204.001555004,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":204.00159117,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":204.001596693,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":204.001601135,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":204.001753828,"data":"\n"}
,{"stream_name":"stdout","time":204.067284128,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":204.371788124,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":204.371818959,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":204.371825742,"data":"  Original dt: 4.687525e-01 s\n"}
,{"stream_name":"stdout","time":204.371830825,"data":"  Corrected dt: 2.929703e-01 s\n"}
,{"stream_name":"stdout","time":204.371835112,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":204.371839673,"data":"  Max wave speed detected: 17.07 m/s\n"}
,{"stream_name":"stderr","time":204.581177602,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":204.581207754,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":204.581185166,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":204.581451788,"data":"\n"}
,{"stream_name":"stderr","time":204.581460536,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 25.89s/s]\n"}
,{"stream_name":"stdout","time":204.581473746,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":204.581483948,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":204.583614369,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":204.583939399,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":204.583952479,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":204.58395779,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":204.583962562,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":204.584152591,"data":"\n"}
,{"stream_name":"stdout","time":204.62989033,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":205.161392856,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stderr","time":205.161447291,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":205.161455401,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":205.161656243,"data":"\n"}
,{"stream_name":"stderr","time":205.161665588,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 25.98s/s]\n"}
,{"stream_name":"stdout","time":205.161668048,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":205.161723722,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":205.163693624,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":205.178847928,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 1.7 steps/s\n"}
,{"stream_name":"stdout","time":205.179046893,"data":"\n"}
,{"stream_name":"stdout","time":205.179059549,"data":"✅ Training completed in 1.0 minutes (59.4s)\n"}
,{"stream_name":"stdout","time":205.182930324,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:59 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":205.182947635,"data":"\n"}
,{"stream_name":"stdout","time":205.182953327,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":205.182957877,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":205.182962071,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":205.182966546,"data":"\n"}
,{"stream_name":"stdout","time":205.188391124,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":205.188601441,"data":"2025-10-15 19:28:07 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":205.188869256,"data":"2025-10-15 19:28:07 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":205.189140002,"data":"2025-10-15 19:28:07 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 02303512\n"}
,{"stream_name":"stdout","time":205.189446844,"data":"2025-10-15 19:28:07 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_02303512_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":205.18948627,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_02303512_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":205.190579882,"data":"\n"}
,{"stream_name":"stdout","time":205.190595457,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":205.190604503,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":205.190623467,"data":"\n"}
,{"stream_name":"stdout","time":205.190628348,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":205.190674544,"data":"2025-10-15 19:28:07 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.190762448,"data":"2025-10-15 19:28:07 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":205.190872048,"data":"2025-10-15 19:28:07 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":205.190963965,"data":"2025-10-15 19:28:07 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.195928009,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.195978813,"data":"2025-10-15 19:28:07 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.196150019,"data":"2025-10-15 19:28:07 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":205.196257163,"data":"2025-10-15 19:28:07 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":205.196417731,"data":"2025-10-15 19:28:07 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":205.196428299,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":205.196433733,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":205.196535364,"data":"2025-10-15 19:28:07 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":205.19675759,"data":"2025-10-15 19:28:07 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":205.197209039,"data":"2025-10-15 19:28:07 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":205.197289756,"data":"2025-10-15 19:28:07 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":205.197304372,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":205.197311058,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":205.197335421,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":205.19734541,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":205.197497858,"data":"2025-10-15 19:28:07 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":205.197506915,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":205.197511801,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":205.197517071,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":205.197535803,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":205.19765062,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.197764145,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":205.197878575,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.197945188,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":205.198041243,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":205.198145829,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":205.198262051,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":205.198376799,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":205.198471548,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.198539801,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":205.198618362,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":205.199072392,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.199084407,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":205.208025104,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":205.208051091,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":205.208056681,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":205.208061437,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":205.208088831,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":205.208210656,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":205.208222553,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":205.20824745,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":205.20825791,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":205.208262277,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.208270344,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":205.208275098,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":205.209154628,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":205.209167394,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":205.209578136,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":205.209595927,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":205.209601243,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":205.209605535,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":205.209609644,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":205.209613823,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":205.209618139,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":205.20976794,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":205.209874765,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":205.209885885,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":205.209997942,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":205.210038329,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.210044156,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":205.21875266199999,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":205.218770824,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":205.218775913,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":205.218780461,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":205.218785108,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":205.218903912,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":205.218915018,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":205.218919726,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":205.218924075,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":205.218929285,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.2189691,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":205.218979015,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":205.219717211,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":205.219734839,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":205.220022615,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":205.220281694,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.220297602,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":205.2203035,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":205.222338133,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":205.222394237,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":205.222491007,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":205.22308967,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":205.223398679,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":205.223733892,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":205.223742552,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":205.22388387,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":205.223918435,"data":"\n"}
,{"stream_name":"stdout","time":205.223924212,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":205.223928755,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":205.223933084,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":205.223937358,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":205.223941618,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":205.223946041,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":205.223950792,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":205.223955699,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":205.223960087,"data":"\n"}
,{"stream_name":"stdout","time":205.224029206,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":205.224036896,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":205.224056835,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":205.224061157,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":205.224065739,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":205.224070351,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":205.224074779,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":205.224078881,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":205.224083469,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":205.224088381,"data":"\n"}
,{"stream_name":"stdout","time":205.224147355,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":205.224412637,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":205.224553086,"data":"2025-10-15 19:28:07 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":205.224734277,"data":"2025-10-15 19:28:07 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":205.225592352,"data":"2025-10-15 19:28:07 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":205.225624363,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":205.225816648,"data":"2025-10-15 19:28:07 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":205.225917239,"data":"2025-10-15 19:28:07 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=959338740733615283, last=-3830737370903830431\n"}
,{"stream_name":"stdout","time":205.226454384,"data":"2025-10-15 19:28:07 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":205.23270659,"data":"2025-10-15 19:28:07 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":205.233031812,"data":"2025-10-15 19:28:07 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":205.233054004,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":205.233128488,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":205.23313715,"data":"\n"}
,{"stream_name":"stdout","time":205.233142225,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":205.233147334,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":205.233151678,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":205.233156654,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":205.233161253,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":205.233166994,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":205.233171336,"data":"\n"}
,{"stream_name":"stdout","time":205.233220568,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":205.242062072,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":205.242080551,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":205.24208573,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":205.242090059,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":205.243254536,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":205.250151173,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":205.250166046,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":205.25462276,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":205.254636917,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":205.254774043,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.254936787,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":205.255009157,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.255138182,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":205.2552134,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":205.255401074,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":205.255456933,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":205.255560086,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":205.255640216,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.255685861,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":205.25577913,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":205.256147832,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.25615501,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":205.264902167,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":205.264918702,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":205.264924057,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":205.264929131,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":205.264954464,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":205.265112329,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":205.265121048,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":205.265125447,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":205.2651296,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":205.265133783,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.265201985,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":205.265217251,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":205.265999741,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":205.266014592,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":205.266458536,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":205.266469774,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":205.26647502,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":205.266480076,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":205.266485651,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":205.266490628,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":205.266522556,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":205.266664637,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":205.266779663,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":205.266820615,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":205.266964813,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":205.266973152,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":205.267005229,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":205.275963189,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":205.275985555,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":205.275991954,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":205.275996913,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":205.276001807,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":205.276170708,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":205.276181243,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":205.276185961,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":205.276190908,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":205.276195829,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.276200845,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":205.276205394,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":205.276987974,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":205.27700781,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.88888888888889, 0.012, 7.777777777777778]\n"}
,{"stream_name":"stdout","time":205.277311318,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":205.277613617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.277625731,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":205.277631526,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":205.279609248,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":205.279829282,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":205.279840235,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":205.279966771,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":205.397001222,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":205.397031289,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.397129604,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":205.397211218,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":205.397334671,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":205.397415801,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":205.397476449,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.397500252,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":205.397509364,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":205.397514143,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":205.721952737,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":205.721982406,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":205.721988714,"data":"  Original dt: 5.034405e-01 s\n"}
,{"stream_name":"stdout","time":205.721993839,"data":"  Corrected dt: 3.146503e-01 s\n"}
,{"stream_name":"stdout","time":205.721998357,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":205.722002416,"data":"  Max wave speed detected: 15.89 m/s\n"}
,{"stream_name":"stdout","time":205.869905363,"data":"  Stored output at t = 15.0000 s (Step 43)\n"}
,{"stream_name":"stderr","time":205.870340128,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.79s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 31.77s/s]\n"}
,{"stream_name":"stdout","time":205.8703797,"data":"\n"}
,{"stream_name":"stdout","time":205.870394879,"data":"Simulation finished at t = 15.0000 s after 43 steps.\n"}
,{"stream_name":"stdout","time":205.87040036,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":205.872347347,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":205.872532342,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":205.872730333,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":205.873173958,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":205.873263348,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":205.873477142,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.055284e+00, max=7.621010e+00, std=3.234510e+00\n"}
,{"stream_name":"stdout","time":205.873687142,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.031473, rho_c=0.013185\n"}
,{"stream_name":"stdout","time":205.873825931,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.979225, w_c=12.428779\n"}
,{"stream_name":"stdout","time":205.87391661,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:887 -   State hash: 7303594038020368724\n"}
,{"stream_name":"stdout","time":205.874018162,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.874276627,"data":"    [RL] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=3.055284e+00\n"}
,{"stream_name":"stdout","time":205.875329616,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":205.875455379,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":205.875581986,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":205.875675972,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":205.875806433,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":205.875907394,"data":"2025-10-15 19:28:07 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":205.875957999,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":205.875974126,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":205.875979838,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":205.875984925,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":205.951168314,"data":"[PROGRESS] Step 50: t=17.13/30.00s (57.1%) | dt=0.3028s\n"}
,{"stream_name":"stdout","time":206.426113067,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":206.426342449,"data":"\n"}
,{"stream_name":"stdout","time":206.42636084,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":206.426366431,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stderr","time":206.426398276,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 27.29s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 27.28s/s]\n"}
,{"stream_name":"stdout","time":206.428366933,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":206.428501061,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":206.428696268,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":206.429176142,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":206.429188443,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":206.429220799,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.611031e-01, max=1.488925e+00, std=4.664695e-01\n"}
,{"stream_name":"stdout","time":206.429475001,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032498, rho_c=0.011769\n"}
,{"stream_name":"stdout","time":206.429498306,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.351263, w_c=13.489792\n"}
,{"stream_name":"stdout","time":206.429676529,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:887 -   State hash: 4886023181526089502\n"}
,{"stream_name":"stdout","time":206.429742207,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.429969619,"data":"    [RL] [STEP 2/41] action=1.0000, reward=-0.0100, t=30.0s, state_diff=3.611031e-01\n"}
,{"stream_name":"stdout","time":206.431103184,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":206.431135311,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.431309184,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":206.431463512,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":206.431583424,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":206.431718332,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":206.431726432,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":206.431742103,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":206.431786188,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":206.431793095,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":206.496311519,"data":"[PROGRESS] Step 100: t=31.77/45.00s (70.6%) | dt=0.2945s\n"}
,{"stream_name":"stdout","time":206.804415721,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":206.804444808,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":206.804448923,"data":"  Original dt: 4.686539e-01 s\n"}
,{"stream_name":"stdout","time":206.804452406,"data":"  Corrected dt: 2.929087e-01 s\n"}
,{"stream_name":"stdout","time":206.804455229,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":206.804457838,"data":"  Max wave speed detected: 17.07 m/s\n"}
,{"stream_name":"stdout","time":206.982575338,"data":"  Stored output at t = 45.0000 s (Step 146)\n"}
,{"stream_name":"stdout","time":206.982773335,"data":"\n"}
,{"stream_name":"stdout","time":206.982784943,"data":"Simulation finished at t = 45.0000 s after 146 steps.\n"}
,{"stream_name":"stdout","time":206.98279038,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stderr","time":206.982824891,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 27.26s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 27.25s/s]\n"}
,{"stream_name":"stdout","time":206.984891836,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":206.984910416,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":206.984969583,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":206.985426369,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":206.985452671,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":206.985639937,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.231359e-01, max=1.234568e+00, std=1.957813e-01\n"}
,{"stream_name":"stdout","time":206.985826976,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033390, rho_c=0.010214\n"}
,{"stream_name":"stdout","time":206.985950283,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.388798, w_c=13.724550\n"}
,{"stream_name":"stdout","time":206.98606481,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:887 -   State hash: -5116363542018600657\n"}
,{"stream_name":"stdout","time":206.986208719,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.986414192,"data":"    [RL] [STEP 3/41] action=0.0000, reward=-0.0100, t=45.0s, state_diff=1.231359e-01\n"}
,{"stream_name":"stdout","time":206.987506631,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":206.987566088,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":206.987770906,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":206.987889123,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":206.988061802,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":206.988139651,"data":"2025-10-15 19:28:08 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":206.988192241,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":206.98819852,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":206.988220238,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":206.988277819,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":207.031323961,"data":"[PROGRESS] Step 150: t=46.17/60.00s (77.0%) | dt=0.2925s\n"}
,{"stream_name":"stdout","time":207.547350641,"data":"  Stored output at t = 60.0000 s (Step 198)\n"}
,{"stream_name":"stdout","time":207.547622949,"data":"\n"}
,{"stream_name":"stderr","time":207.547622161,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.85s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 26.84s/s]\n"}
,{"stream_name":"stdout","time":207.54763755,"data":"Simulation finished at t = 60.0000 s after 198 steps.\n"}
,{"stream_name":"stdout","time":207.547651967,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":207.549702678,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":207.549772451,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":207.549986099,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":207.550470904,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":207.550623686,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":207.550746443,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.754236e-02, max=1.234568e+00, std=1.602766e-01\n"}
,{"stream_name":"stdout","time":207.551012286,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.034165, rho_c=0.008643\n"}
,{"stream_name":"stdout","time":207.551048594,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.467199, w_c=13.835881\n"}
,{"stream_name":"stdout","time":207.551250242,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:887 -   State hash: -2460359231949358834\n"}
,{"stream_name":"stdout","time":207.551352974,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.551609286,"data":"    [RL] [STEP 4/41] action=1.0000, reward=-0.0100, t=60.0s, state_diff=9.754236e-02\n"}
,{"stream_name":"stdout","time":207.552828772,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":207.552950371,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":207.553132824,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":207.553223974,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":207.553415116,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":207.553490404,"data":"2025-10-15 19:28:09 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":207.553567193,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":207.553579532,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":207.553585853,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":207.553601093,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":207.577782827,"data":"[PROGRESS] Step 200: t=60.58/75.00s (80.8%) | dt=0.2922s\n"}
,{"stream_name":"stdout","time":207.896652902,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":207.896684852,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":207.896691818,"data":"  Original dt: 4.673823e-01 s\n"}
,{"stream_name":"stdout","time":207.896696616,"data":"  Corrected dt: 2.921139e-01 s\n"}
,{"stream_name":"stdout","time":207.896701056,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":207.896723899,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":208.123490916,"data":"[PROGRESS] Step 250: t=75.00/75.00s (100.0%) | dt=0.1016s\n"}
,{"stream_name":"stdout","time":208.123928623,"data":"  Stored output at t = 75.0000 s (Step 250)\n"}
,{"stream_name":"stderr","time":208.124307227,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.32s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 26.31s/s]\n"}
,{"stream_name":"stdout","time":208.124327551,"data":"\n"}
,{"stream_name":"stdout","time":208.124345274,"data":"Simulation finished at t = 75.0000 s after 250 steps.\n"}
,{"stream_name":"stdout","time":208.124351022,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":208.126202109,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":208.126523652,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":208.1265508,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":208.127087146,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":208.127152422,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":208.127306844,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.063140e-02, max=1.234568e+00, std=1.503574e-01\n"}
,{"stream_name":"stdout","time":208.127546377,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033903, rho_c=0.007296\n"}
,{"stream_name":"stdout","time":208.127624722,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.537466, w_c=13.896956\n"}
,{"stream_name":"stdout","time":208.127780594,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:887 -   State hash: -8037995345822952430\n"}
,{"stream_name":"stdout","time":208.127898268,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.128113924,"data":"    [RL] [STEP 5/41] action=0.0000, reward=0.0100, t=75.0s, state_diff=8.063140e-02\n"}
,{"stream_name":"stdout","time":208.129322856,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":208.129471453,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.129617348,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":208.129715109,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":208.12985489,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":208.129946362,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":208.129999176,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":208.130010352,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":208.130029413,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":208.130038169,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":208.663899323,"data":"[PROGRESS] Step 300: t=89.60/90.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":208.687432699,"data":"  Stored output at t = 90.0000 s (Step 302)\n"}
,{"stream_name":"stdout","time":208.687761176,"data":"\n"}
,{"stream_name":"stdout","time":208.687775507,"data":"Simulation finished at t = 90.0000 s after 302 steps.\n"}
,{"stream_name":"stdout","time":208.687780905,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":208.687761939,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.93s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 26.92s/s]\n"}
,{"stream_name":"stdout","time":208.689800071,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":208.689882157,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":208.690082079,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":208.690568553,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":208.690690152,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":208.690854243,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.595230e-02, max=1.234568e+00, std=1.452373e-01\n"}
,{"stream_name":"stdout","time":208.691065497,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033045, rho_c=0.006576\n"}
,{"stream_name":"stdout","time":208.691144506,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.676893, w_c=14.019760\n"}
,{"stream_name":"stdout","time":208.691323192,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:887 -   State hash: -1479206224846679769\n"}
,{"stream_name":"stdout","time":208.691450604,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.691662319,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0100, t=90.0s, state_diff=6.595230e-02\n"}
,{"stream_name":"stdout","time":208.692820091,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":208.692972432,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":208.69310804,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":208.693200323,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":208.693377199,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":208.69346111,"data":"2025-10-15 19:28:10 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":208.693539663,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":208.693550948,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":208.69355739,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":208.69359307,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":208.991634867,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":208.99166611,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":208.991673415,"data":"  Original dt: 4.673305e-01 s\n"}
,{"stream_name":"stdout","time":208.991678111,"data":"  Corrected dt: 2.920816e-01 s\n"}
,{"stream_name":"stdout","time":208.991683139,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":208.991687796,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":209.221653805,"data":"[PROGRESS] Step 350: t=104.02/105.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":209.265785342,"data":"  Stored output at t = 105.0000 s (Step 354)\n"}
,{"stream_name":"stderr","time":209.266149402,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.24s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.22s/s]\n"}
,{"stream_name":"stdout","time":209.266163445,"data":"\n"}
,{"stream_name":"stdout","time":209.266185392,"data":"Simulation finished at t = 105.0000 s after 354 steps.\n"}
,{"stream_name":"stdout","time":209.266190372,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":209.268650448,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":209.2687375,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":209.268893524,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":209.269312728,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":209.269470756,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":209.269550813,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.270674e-02, max=1.234568e+00, std=1.300063e-01\n"}
,{"stream_name":"stdout","time":209.26975062100001,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032642, rho_c=0.006384\n"}
,{"stream_name":"stdout","time":209.26982386,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.711958, w_c=14.065894\n"}
,{"stream_name":"stdout","time":209.269975893,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:887 -   State hash: 5433348789391500111\n"}
,{"stream_name":"stdout","time":209.270075085,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":209.2703044,"data":"    [RL] [STEP 7/41] action=0.0000, reward=0.0100, t=105.0s, state_diff=4.270674e-02\n"}
,{"stream_name":"stdout","time":209.271512322,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":209.271575428,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":209.271745362,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":209.27175402,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":209.271890773,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":209.271970696,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":209.272021431,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":209.272028437,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":209.272033822,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":209.272054846,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":209.767134432,"data":"[PROGRESS] Step 400: t=118.44/120.00s (98.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":209.831789344,"data":"  Stored output at t = 120.0000 s (Step 406)\n"}
,{"stream_name":"stdout","time":209.831913003,"data":"\n"}
,{"stream_name":"stderr","time":209.831910605,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.83s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 26.82s/s]\n"}
,{"stream_name":"stdout","time":209.831923685,"data":"Simulation finished at t = 120.0000 s after 406 steps.\n"}
,{"stream_name":"stdout","time":209.831947145,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":209.83370939899999,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":209.833784362,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":209.833931599,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":209.834326625,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":209.834485602,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":209.834613722,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.204848e-02, max=1.234568e+00, std=1.153637e-01\n"}
,{"stream_name":"stdout","time":209.834800719,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032541, rho_c=0.006336\n"}
,{"stream_name":"stdout","time":209.834851808,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.752707, w_c=14.113191\n"}
,{"stream_name":"stdout","time":209.835026068,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:887 -   State hash: 7692189844986477041\n"}
,{"stream_name":"stdout","time":209.835044248,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":209.835294265,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0100, t=120.0s, state_diff=2.204848e-02\n"}
,{"stream_name":"stdout","time":209.83634783,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":209.836375535,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":209.836553892,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":209.836622341,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":209.836731964,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":209.836802539,"data":"2025-10-15 19:28:11 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":209.836886625,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":209.836894335,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":209.836900199,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":209.836916319,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":210.088682446,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":210.088711938,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":210.08871831,"data":"  Original dt: 4.673276e-01 s\n"}
,{"stream_name":"stdout","time":210.088723388,"data":"  Corrected dt: 2.920797e-01 s\n"}
,{"stream_name":"stdout","time":210.088727704,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":210.088731792,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":210.316784088,"data":"[PROGRESS] Step 450: t=132.85/135.00s (98.4%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":210.403352694,"data":"  Stored output at t = 135.0000 s (Step 458)\n"}
,{"stream_name":"stdout","time":210.403553329,"data":"\n"}
,{"stream_name":"stdout","time":210.403567332,"data":"Simulation finished at t = 135.0000 s after 458 steps.\n"}
,{"stream_name":"stdout","time":210.403572838,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":210.403582193,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 26.50s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 26.49s/s]\n"}
,{"stream_name":"stdout","time":210.405667225,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":210.405685762,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":210.405874585,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":210.406286989,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":210.40637275,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":210.406545034,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.426071e-02, max=1.234568e+00, std=1.132075e-01\n"}
,{"stream_name":"stdout","time":210.40673661,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032519, rho_c=0.006324\n"}
,{"stream_name":"stdout","time":210.406828077,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.733098, w_c=14.100777\n"}
,{"stream_name":"stdout","time":210.406991212,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:887 -   State hash: 2374929990893666508\n"}
,{"stream_name":"stdout","time":210.407072642,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":210.407294966,"data":"    [RL] [STEP 9/41] action=0.0000, reward=0.0100, t=135.0s, state_diff=1.426071e-02\n"}
,{"stream_name":"stdout","time":210.408359901,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":210.408525698,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":210.408646779,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":210.408785764,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":210.408881832,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":210.408997502,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":210.409056117,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":210.409073215,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":210.409079643,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":210.409084887,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":210.897052452,"data":"[PROGRESS] Step 500: t=147.27/150.00s (98.2%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":211.002340134,"data":"  Stored output at t = 150.0000 s (Step 510)\n"}
,{"stream_name":"stderr","time":211.002583932,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 25.31s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 25.30s/s]\n"}
,{"stream_name":"stdout","time":211.002585854,"data":"\n"}
,{"stream_name":"stdout","time":211.002626095,"data":"Simulation finished at t = 150.0000 s after 510 steps.\n"}
,{"stream_name":"stdout","time":211.002631496,"data":"Total runtime: 0.59 seconds.\n"}
,{"stream_name":"stdout","time":211.004401211,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":211.004418836,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.01 | total_reward=    0.03\n"}
,{"stream_name":"stdout","time":211.004558064,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":211.0046848,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":211.005063832,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":211.005181286,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":211.005350751,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.196318e-02, max=1.234568e+00, std=1.131426e-01\n"}
,{"stream_name":"stdout","time":211.005546779,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032515, rho_c=0.006320\n"}
,{"stream_name":"stdout","time":211.005633398,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.757805, w_c=14.123915\n"}
,{"stream_name":"stdout","time":211.005771015,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:887 -   State hash: -8678950483372603162\n"}
,{"stream_name":"stdout","time":211.005855276,"data":"2025-10-15 19:28:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":211.006059031,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0100, t=150.0s, state_diff=1.196318e-02\n"}
,{"stream_name":"stdout","time":211.007115025,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":211.007244984,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":211.007385244,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":211.00748003,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":211.00760781,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":211.00770024,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":211.007782251,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":211.007789819,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":211.007828844,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":211.007864887,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":211.217984471,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":211.218014004,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":211.218024951,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":211.218030008,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":211.218035179,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":211.218039552,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":211.443970893,"data":"[PROGRESS] Step 550: t=161.68/165.00s (98.0%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":211.583638671,"data":"  Stored output at t = 165.0000 s (Step 562)\n"}
,{"stream_name":"stdout","time":211.58382996,"data":"\n"}
,{"stream_name":"stderr","time":211.583832803,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 26.07s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 26.06s/s]\n"}
,{"stream_name":"stdout","time":211.583846571,"data":"Simulation finished at t = 165.0000 s after 562 steps.\n"}
,{"stream_name":"stdout","time":211.583859393,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":211.585922735,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":211.585941746,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":211.586150864,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":211.586569217,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":211.586677084,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":211.586823569,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.134252e-02, max=1.234568e+00, std=1.131801e-01\n"}
,{"stream_name":"stdout","time":211.587049285,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032514, rho_c=0.006320\n"}
,{"stream_name":"stdout","time":211.587127386,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734287, w_c=14.103770\n"}
,{"stream_name":"stdout","time":211.587286042,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:887 -   State hash: -178643265580103250\n"}
,{"stream_name":"stdout","time":211.587440144,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":211.587663165,"data":"    [RL] [STEP 11/41] action=0.0000, reward=0.0100, t=165.0s, state_diff=1.134252e-02\n"}
,{"stream_name":"stdout","time":211.58876356,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":211.588823389,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":211.589028401,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":211.589051812,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":211.589221901,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":211.58932665,"data":"2025-10-15 19:28:13 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":211.589418564,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":211.58942769,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":211.58943387,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":211.589456424,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":212.013332441,"data":"[PROGRESS] Step 600: t=176.10/180.00s (97.8%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":212.166091606,"data":"  Stored output at t = 180.0000 s (Step 614)\n"}
,{"stream_name":"stdout","time":212.166293413,"data":"\n"}
,{"stream_name":"stdout","time":212.166316419,"data":"Simulation finished at t = 180.0000 s after 614 steps.\n"}
,{"stream_name":"stdout","time":212.166322837,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":212.166292259,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 26.03s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 26.02s/s]\n"}
,{"stream_name":"stdout","time":212.168290825,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":212.168408496,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":212.168531179,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":212.168927273,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":212.168997739,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":212.169148733,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.118219e-02, max=1.234568e+00, std=1.131942e-01\n"}
,{"stream_name":"stdout","time":212.169328783,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":212.169484633,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758081, w_c=14.124704\n"}
,{"stream_name":"stdout","time":212.169583077,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:887 -   State hash: -4475681680411128147\n"}
,{"stream_name":"stdout","time":212.169686187,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":212.169919742,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0100, t=180.0s, state_diff=1.118219e-02\n"}
,{"stream_name":"stdout","time":212.171015787,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":212.171118627,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":212.171285904,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":212.171424202,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":212.171550998,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":212.171646134,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":212.171696686,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":212.171706226,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":212.17172579,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":212.171733979,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":212.33336183,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":212.33339145,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":212.333398019,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":212.33340373,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":212.333408199,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":212.333412326,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":212.555256682,"data":"[PROGRESS] Step 650: t=190.51/195.00s (97.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":212.729674405,"data":"  Stored output at t = 195.0000 s (Step 666)\n"}
,{"stream_name":"stdout","time":212.729855271,"data":"\n"}
,{"stream_name":"stderr","time":212.729855092,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 26.91s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 26.90s/s]\n"}
,{"stream_name":"stdout","time":212.729869727,"data":"Simulation finished at t = 195.0000 s after 666 steps.\n"}
,{"stream_name":"stdout","time":212.729881515,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":212.731713822,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":212.731834079,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":212.731998823,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":212.732453101,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":212.732593418,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":212.732735185,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.114194e-02, max=1.234568e+00, std=1.131980e-01\n"}
,{"stream_name":"stdout","time":212.732989318,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":212.733057003,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734351, w_c=14.103971\n"}
,{"stream_name":"stdout","time":212.73321175,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:887 -   State hash: 3714515994343000089\n"}
,{"stream_name":"stdout","time":212.733327857,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":212.733548636,"data":"    [RL] [STEP 13/41] action=0.0000, reward=0.0100, t=195.0s, state_diff=1.114194e-02\n"}
,{"stream_name":"stdout","time":212.734583591,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":212.734615948,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":212.734821066,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":212.734840994,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":212.734978515,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":212.735116064,"data":"2025-10-15 19:28:14 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":212.73512609,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":212.735131591,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":212.735140517,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":212.735180664,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":213.097922107,"data":"[PROGRESS] Step 700: t=204.93/210.00s (97.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":213.299256004,"data":"  Stored output at t = 210.0000 s (Step 718)\n"}
,{"stream_name":"stdout","time":213.299456587,"data":"\n"}
,{"stream_name":"stdout","time":213.299470103,"data":"Simulation finished at t = 210.0000 s after 718 steps.\n"}
,{"stream_name":"stderr","time":213.299453801,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 26.61s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 26.61s/s]\n"}
,{"stream_name":"stdout","time":213.299475856,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":213.301505254,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":213.301595102,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":213.301767207,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":213.302277824,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":213.302316974,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":213.302527916,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.113205e-02, max=1.234568e+00, std=1.131990e-01\n"}
,{"stream_name":"stdout","time":213.302732351,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":213.302807918,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758095, w_c=14.124754\n"}
,{"stream_name":"stdout","time":213.303000799,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:887 -   State hash: -3436549606410538631\n"}
,{"stream_name":"stdout","time":213.303069978,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":213.303320949,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0100, t=210.0s, state_diff=1.113205e-02\n"}
,{"stream_name":"stdout","time":213.304503309,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":213.304628041,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":213.304811516,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":213.304837466,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":213.30503647,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":213.305217838,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":213.305248818,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":213.305261988,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":213.305267492,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":213.305272482,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":213.425705605,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":213.425736582,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":213.425742922,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":213.425747646,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":213.425752719,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":213.425757007,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":213.656287711,"data":"[PROGRESS] Step 750: t=219.35/225.00s (97.5%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":213.872508775,"data":"  Stored output at t = 225.0000 s (Step 770)\n"}
,{"stream_name":"stdout","time":213.872803826,"data":"\n"}
,{"stream_name":"stdout","time":213.87282178,"data":"Simulation finished at t = 225.0000 s after 770 steps.\n"}
,{"stream_name":"stdout","time":213.872827346,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":213.872808923,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 26.46s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 26.45s/s]\n"}
,{"stream_name":"stdout","time":213.874856085,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":213.874924008,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":213.875127621,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":213.875532699,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":213.875546535,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":213.875659468,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112966e-02, max=1.234568e+00, std=1.131992e-01\n"}
,{"stream_name":"stdout","time":213.875838281,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":213.875861368,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734354, w_c=14.103983\n"}
,{"stream_name":"stdout","time":213.875990734,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:887 -   State hash: 2882059142289123686\n"}
,{"stream_name":"stdout","time":213.876169799,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":213.876314196,"data":"    [RL] [STEP 15/41] action=0.0000, reward=0.0100, t=225.0s, state_diff=1.112966e-02\n"}
,{"stream_name":"stdout","time":213.877288391,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":213.877430381,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":213.877551729,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":213.877627229,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":213.877751136,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":213.8778908,"data":"2025-10-15 19:28:15 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":213.877902477,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":213.877919138,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":213.877923838,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":213.877929352,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":214.192984411,"data":"[PROGRESS] Step 800: t=233.76/240.00s (97.4%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":214.424425515,"data":"  Stored output at t = 240.0000 s (Step 822)\n"}
,{"stream_name":"stdout","time":214.424667383,"data":"\n"}
,{"stream_name":"stdout","time":214.424676809,"data":"Simulation finished at t = 240.0000 s after 822 steps.\n"}
,{"stream_name":"stderr","time":214.424673172,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 27.47s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 27.46s/s]\n"}
,{"stream_name":"stdout","time":214.424681335,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":214.426589185,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":214.426712745,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":214.426867978,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":214.427278786,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":214.427391289,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":214.427509183,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112909e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":214.427718516,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":214.427828536,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":214.427945418,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:887 -   State hash: -6083397230456230050\n"}
,{"stream_name":"stdout","time":214.42805324,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":214.428270597,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0100, t=240.0s, state_diff=1.112909e-02\n"}
,{"stream_name":"stdout","time":214.42932234,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":214.429474827,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":214.42959959,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":214.429712463,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":214.429875976,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":214.429955719,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":214.430015245,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":214.430021285,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":214.430037583,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":214.430042678,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":214.504088991,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":214.504117467,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":214.504124336,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":214.504128422,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":214.504132758,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":214.504136743,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":214.728558213,"data":"[PROGRESS] Step 850: t=248.18/255.00s (97.3%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":214.988450491,"data":"  Stored output at t = 255.0000 s (Step 874)\n"}
,{"stream_name":"stderr","time":214.98868869,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 26.89s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 26.88s/s]\n"}
,{"stream_name":"stdout","time":214.988709694,"data":"\n"}
,{"stream_name":"stdout","time":214.988741771,"data":"Simulation finished at t = 255.0000 s after 874 steps.\n"}
,{"stream_name":"stdout","time":214.988747734,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":214.990528024,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":214.990629665,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":214.99076644,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":214.991169087,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":214.991280517,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":214.991419669,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112896e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":214.991624909,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":214.991708313,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734354, w_c=14.103983\n"}
,{"stream_name":"stdout","time":214.991836451,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:887 -   State hash: 1094348896422600604\n"}
,{"stream_name":"stdout","time":214.991925709,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":214.992178147,"data":"    [RL] [STEP 17/41] action=0.0000, reward=0.0100, t=255.0s, state_diff=1.112896e-02\n"}
,{"stream_name":"stdout","time":214.993261805,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":214.993398684,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":214.993524228,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":214.993644018,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":214.993729327,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":214.99386282,"data":"2025-10-15 19:28:16 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":214.993882907,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":214.993898086,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":214.993959286,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":214.993966509,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":215.282437717,"data":"[PROGRESS] Step 900: t=262.59/270.00s (97.3%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":215.568584734,"data":"  Stored output at t = 270.0000 s (Step 926)\n"}
,{"stream_name":"stdout","time":215.568820252,"data":"\n"}
,{"stream_name":"stderr","time":215.568822474,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 26.13s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 26.12s/s]\n"}
,{"stream_name":"stdout","time":215.568830266,"data":"Simulation finished at t = 270.0000 s after 926 steps.\n"}
,{"stream_name":"stdout","time":215.568838845,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":215.570803858,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":215.57091502,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":215.571098581,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":215.571566364,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":215.571729067,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":215.571852269,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112893e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":215.572086117,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":215.572225382,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":215.572505817,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:887 -   State hash: 4932175693277143588\n"}
,{"stream_name":"stdout","time":215.572523799,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":215.572686053,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0100, t=270.0s, state_diff=1.112893e-02\n"}
,{"stream_name":"stdout","time":215.573848638,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":215.573880659,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":215.574075517,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":215.574161107,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":215.574308024,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":215.574503218,"data":"2025-10-15 19:28:17 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":215.574517739,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":215.574523489,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":215.574529423,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":215.574536193,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":215.610134377,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":215.610163133,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":215.61016907,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":215.610173719,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":215.610178544,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":215.610183369,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":215.835856958,"data":"[PROGRESS] Step 950: t=277.01/285.00s (97.2%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":216.136665131,"data":"  Stored output at t = 285.0000 s (Step 978)\n"}
,{"stream_name":"stdout","time":216.136939557,"data":"\n"}
,{"stream_name":"stderr","time":216.136941824,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 26.71s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 26.70s/s]\n"}
,{"stream_name":"stdout","time":216.136952417,"data":"Simulation finished at t = 285.0000 s after 978 steps.\n"}
,{"stream_name":"stdout","time":216.136974922,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":216.139020149,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":216.139165349,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":216.139321552,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":216.139748496,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":216.1398461,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":216.139993985,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":216.14019713,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":216.140324282,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":216.140485572,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:887 -   State hash: -4426446300595426303\n"}
,{"stream_name":"stdout","time":216.140607838,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":216.140819513,"data":"    [RL] [STEP 19/41] action=0.0000, reward=0.0100, t=285.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":216.141953301,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":216.142072044,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":216.142253111,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":216.142406404,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":216.142481863,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":216.142602358,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":216.142663148,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":216.142671715,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":216.142677526,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":216.142683868,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":216.388177985,"data":"[PROGRESS] Step 1000: t=291.43/300.00s (97.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":216.705108089,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":216.705135314,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":216.705141412,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":216.705168779,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":216.705174554,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":216.70517891,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":216.714953613,"data":"  Stored output at t = 300.0000 s (Step 1030)\n"}
,{"stream_name":"stdout","time":216.715321429,"data":"\n"}
,{"stream_name":"stdout","time":216.715350673,"data":"Simulation finished at t = 300.0000 s after 1030 steps.\n"}
,{"stream_name":"stdout","time":216.715356974,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":216.71531902,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 26.23s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 26.22s/s]\n"}
,{"stream_name":"stdout","time":216.717302154,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":216.717324002,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.01 | total_reward=    0.13\n"}
,{"stream_name":"stdout","time":216.71743564,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":216.71758124,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":216.718046259,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":216.718100645,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":216.718279196,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":216.718508518,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":216.718582798,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":216.718734266,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:887 -   State hash: -2974236520206291378\n"}
,{"stream_name":"stdout","time":216.718861019,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":216.719076719,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0100, t=300.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":216.720177709,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":216.720264289,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":216.720431507,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":216.720526129,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":216.720614731,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":216.720742419,"data":"2025-10-15 19:28:18 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":216.720779386,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":216.720786446,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":216.720825719,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":216.720832335,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":216.932541561,"data":"[PROGRESS] Step 1050: t=305.84/315.00s (97.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":217.279774607,"data":"  Stored output at t = 315.0000 s (Step 1082)\n"}
,{"stream_name":"stdout","time":217.279980126,"data":"\n"}
,{"stream_name":"stderr","time":217.279981852,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 26.86s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 26.85s/s]\n"}
,{"stream_name":"stdout","time":217.279990747,"data":"Simulation finished at t = 315.0000 s after 1082 steps.\n"}
,{"stream_name":"stdout","time":217.280000189,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":217.281984141,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":217.282058963,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":217.282262448,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":217.282678689,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":217.282827986,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":217.282952832,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":217.283159062,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":217.283248884,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":217.283411282,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:887 -   State hash: 427369054187838823\n"}
,{"stream_name":"stdout","time":217.28352598,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":217.283745925,"data":"    [RL] [STEP 21/41] action=0.0000, reward=0.0100, t=315.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":217.284860546,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":217.28499521,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":217.285135239,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":217.285281611,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":217.285425691,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":217.285529436,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":217.285600019,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":217.285610028,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":217.285615538,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":217.285659436,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":217.485435645,"data":"[PROGRESS] Step 1100: t=320.26/330.00s (97.0%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":217.803959201,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":217.803985944,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":217.803991858,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":217.803996454,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":217.804001325,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":217.804005904,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":217.855858099,"data":"  Stored output at t = 330.0000 s (Step 1134)\n"}
,{"stream_name":"stdout","time":217.855918437,"data":"\n"}
,{"stream_name":"stdout","time":217.855925215,"data":"Simulation finished at t = 330.0000 s after 1134 steps.\n"}
,{"stream_name":"stdout","time":217.855929502,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stderr","time":217.855922993,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 26.33s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 26.32s/s]\n"}
,{"stream_name":"stdout","time":217.857882742,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":217.85790655,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":217.858024298,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":217.85855192,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":217.858635359,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":217.858814959,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":217.859014631,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":217.859145411,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":217.859302552,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:887 -   State hash: -1479738256178723437\n"}
,{"stream_name":"stdout","time":217.859420663,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":217.859642021,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0100, t=330.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":217.86075003,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":217.860896107,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":217.861000527,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":217.861150478,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":217.861207541,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":217.861379629,"data":"2025-10-15 19:28:19 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":217.86139447,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":217.861412372,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":217.861418159,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":217.861506822,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":218.035504199,"data":"[PROGRESS] Step 1150: t=334.67/345.00s (97.0%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":218.427961054,"data":"  Stored output at t = 345.0000 s (Step 1186)\n"}
,{"stream_name":"stderr","time":218.428263368,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 26.50s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 26.49s/s]\n"}
,{"stream_name":"stdout","time":218.42826949,"data":"\n"}
,{"stream_name":"stdout","time":218.428306294,"data":"Simulation finished at t = 345.0000 s after 1186 steps.\n"}
,{"stream_name":"stdout","time":218.428314419,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":218.43031958,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":218.430488144,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":218.430602969,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":218.431073242,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":218.431133398,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":218.431331753,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":218.431581732,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":218.431610359,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":218.431797303,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:887 -   State hash: -6634530217029911909\n"}
,{"stream_name":"stdout","time":218.431938241,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":218.432118744,"data":"    [RL] [STEP 23/41] action=0.0000, reward=0.0100, t=345.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":218.433289648,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":218.433385466,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":218.433574525,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":218.43366559,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":218.433784205,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":218.43394978,"data":"2025-10-15 19:28:20 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":218.433973345,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":218.433980654,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":218.434056584,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":218.43406416,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":218.592121239,"data":"[PROGRESS] Step 1200: t=349.09/360.00s (97.0%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":218.914354341,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":218.914382397,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":218.914388209,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":218.914392713,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":218.914396946,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":218.914402205,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":219.011906192,"data":"  Stored output at t = 360.0000 s (Step 1238)\n"}
,{"stream_name":"stdout","time":219.011929083,"data":"\n"}
,{"stream_name":"stdout","time":219.011934446,"data":"Simulation finished at t = 360.0000 s after 1238 steps.\n"}
,{"stream_name":"stdout","time":219.011938807,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":219.011898823,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 25.99s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 25.98s/s]\n"}
,{"stream_name":"stdout","time":219.013961494,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":219.013980869,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":219.014011613,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":219.014415591,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":219.014511625,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":219.014623554,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":219.014812178,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":219.01493677,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":219.015021121,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:887 -   State hash: 5093035343728024153\n"}
,{"stream_name":"stdout","time":219.015139774,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":219.015365492,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0100, t=360.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":219.016417767,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":219.01653958,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":219.016688537,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":219.016777916,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":219.016895354,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":219.016985627,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":219.017067278,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":219.017077863,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":219.017083525,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":219.017089628,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":219.141540964,"data":"[PROGRESS] Step 1250: t=363.50/375.00s (96.9%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":219.567341579,"data":"  Stored output at t = 375.0000 s (Step 1290)\n"}
,{"stream_name":"stderr","time":219.567571165,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 27.28s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 27.27s/s]\n"}
,{"stream_name":"stdout","time":219.56757623,"data":"\n"}
,{"stream_name":"stdout","time":219.567600659,"data":"Simulation finished at t = 375.0000 s after 1290 steps.\n"}
,{"stream_name":"stdout","time":219.567606682,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":219.569622602,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":219.569741478,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":219.569915644,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":219.570365476,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":219.570485724,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":219.57060448,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":219.570827684,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":219.570974207,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":219.571095608,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:887 -   State hash: -1792741724260566002\n"}
,{"stream_name":"stdout","time":219.571176918,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":219.571449671,"data":"    [RL] [STEP 25/41] action=0.0000, reward=0.0100, t=375.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":219.572634306,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":219.572664064,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":219.572820475,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":219.572954967,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":219.573036138,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":219.573127363,"data":"2025-10-15 19:28:21 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":219.573247126,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":219.573283144,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":219.57328894,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":219.573293482,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":219.684672323,"data":"[PROGRESS] Step 1300: t=377.92/390.00s (96.9%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":220.003379097,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":220.003405362,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":220.00341207,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":220.003417003,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":220.003421158,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":220.003425397,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":220.139413027,"data":"  Stored output at t = 390.0000 s (Step 1342)\n"}
,{"stream_name":"stderr","time":220.139506738,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 26.52s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 26.51s/s]\n"}
,{"stream_name":"stdout","time":220.139528841,"data":"\n"}
,{"stream_name":"stdout","time":220.139534315,"data":"Simulation finished at t = 390.0000 s after 1342 steps.\n"}
,{"stream_name":"stdout","time":220.139539119,"data":"Total runtime: 0.57 seconds.\n"}
,{"stream_name":"stdout","time":220.141489923,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":220.141509857,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":220.141614514,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":220.142012101,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":220.142108637,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":220.142214023,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":220.142458962,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":220.14253231,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":220.142761967,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:887 -   State hash: 1728975131863014447\n"}
,{"stream_name":"stdout","time":220.142851222,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":220.143105753,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0100, t=390.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":220.144172417,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":220.144199143,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":220.144388442,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":220.144450143,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":220.144611586,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":220.144625554,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":220.144720989,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":220.1447315,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":220.144737693,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":220.144745133,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":220.23178038,"data":"[PROGRESS] Step 1350: t=392.34/405.00s (96.9%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":220.723155665,"data":"  Stored output at t = 405.0000 s (Step 1394)\n"}
,{"stream_name":"stdout","time":220.723384574,"data":"\n"}
,{"stream_name":"stderr","time":220.72339554,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 25.95s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 25.94s/s]\n"}
,{"stream_name":"stdout","time":220.723407732,"data":"Simulation finished at t = 405.0000 s after 1394 steps.\n"}
,{"stream_name":"stdout","time":220.72342669,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":220.725662218,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":220.725703016,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":220.725902186,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":220.726292798,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":220.726353217,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":220.726524806,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":220.726686016,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":220.726794558,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":220.726923159,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:887 -   State hash: -6488859583788884330\n"}
,{"stream_name":"stdout","time":220.727003568,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":220.727253453,"data":"    [RL] [STEP 27/41] action=0.0000, reward=0.0100, t=405.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":220.728414972,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":220.728473332,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":220.728639262,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":220.728724992,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":220.728863402,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":220.729018802,"data":"2025-10-15 19:28:22 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":220.729030237,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":220.72904561000001,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":220.729053177,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":220.729057712,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":220.794818735,"data":"[PROGRESS] Step 1400: t=406.75/420.00s (96.8%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":221.133310238,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":221.133340391,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":221.133348246,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":221.13335141,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":221.133354299,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":221.133357187,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":221.324248492,"data":"  Stored output at t = 420.0000 s (Step 1446)\n"}
,{"stream_name":"stderr","time":221.324443046,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 25.22s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 25.21s/s]\n"}
,{"stream_name":"stdout","time":221.324479031,"data":"\n"}
,{"stream_name":"stdout","time":221.324486637,"data":"Simulation finished at t = 420.0000 s after 1446 steps.\n"}
,{"stream_name":"stdout","time":221.324493122,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stdout","time":221.326406532,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":221.326559902,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":221.326723856,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":221.327207486,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":221.327280596,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":221.3274321,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":221.32766132,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":221.327763112,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":221.327924897,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:887 -   State hash: -7779389843330435039\n"}
,{"stream_name":"stdout","time":221.328033662,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":221.328277439,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0100, t=420.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":221.329350725,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":221.329475973,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":221.329614073,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":221.329745574,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":221.329875575,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":221.329940532,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":221.330009562,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":221.330017968,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":221.330024217,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":221.330070978,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":221.375434474,"data":"[PROGRESS] Step 1450: t=421.17/435.00s (96.8%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":221.893381469,"data":"  Stored output at t = 435.0000 s (Step 1498)\n"}
,{"stream_name":"stderr","time":221.893667573,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 26.65s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 26.64s/s]\n"}
,{"stream_name":"stdout","time":221.893696191,"data":"\n"}
,{"stream_name":"stdout","time":221.893706806,"data":"Simulation finished at t = 435.0000 s after 1498 steps.\n"}
,{"stream_name":"stdout","time":221.893711692,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":221.895550041,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":221.895618349,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":221.895795508,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":221.896179857,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":221.896246218,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":221.896401691,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":221.89662275,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":221.896685364,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":221.896862081,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:887 -   State hash: -3582585544588196240\n"}
,{"stream_name":"stdout","time":221.896942284,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":221.897127776,"data":"    [RL] [STEP 29/41] action=0.0000, reward=0.0100, t=435.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":221.898204823,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":221.898295478,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":221.898477318,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":221.89857464,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":221.898657295,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":221.898831947,"data":"2025-10-15 19:28:23 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":221.898882015,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":221.898888844,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":221.898895693,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":221.898909349,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":221.920940845,"data":"[PROGRESS] Step 1500: t=435.58/450.00s (96.8%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":222.234536327,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":222.234565901,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":222.234571651,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":222.234591761,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":222.234594617,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":222.234597087,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":222.455880524,"data":"[PROGRESS] Step 1550: t=450.00/450.00s (100.0%) | dt=0.1040s\n"}
,{"stream_name":"stdout","time":222.456279579,"data":"  Stored output at t = 450.0000 s (Step 1550)\n"}
,{"stream_name":"stdout","time":222.45660673,"data":"\n"}
,{"stream_name":"stderr","time":222.456606972,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 26.93s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 26.92s/s]\n"}
,{"stream_name":"stdout","time":222.456617772,"data":"Simulation finished at t = 450.0000 s after 1550 steps.\n"}
,{"stream_name":"stdout","time":222.456628288,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":222.458551413,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":222.458568513,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.01 | total_reward=    0.23\n"}
,{"stream_name":"stdout","time":222.458735608,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":222.458914497,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":222.459323364,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":222.459397785,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":222.459555137,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":222.459782033,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":222.459864859,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":222.460035139,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:887 -   State hash: -9223370365010180863\n"}
,{"stream_name":"stdout","time":222.46011088,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":222.460343909,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0100, t=450.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":222.461408669,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":222.461539008,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":222.461684483,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":222.461790189,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":222.461914567,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":222.462053425,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":222.462061758,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":222.462080217,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":222.462087066,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":222.462100562,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":222.975599552,"data":"[PROGRESS] Step 1600: t=464.60/465.00s (99.9%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":222.996738464,"data":"  Stored output at t = 465.0000 s (Step 1602)\n"}
,{"stream_name":"stderr","time":222.996854313,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 28.09s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 28.08s/s]\n"}
,{"stream_name":"stdout","time":222.996872715,"data":"\n"}
,{"stream_name":"stdout","time":222.996884891,"data":"Simulation finished at t = 465.0000 s after 1602 steps.\n"}
,{"stream_name":"stdout","time":222.996889924,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":222.998655819,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":222.998715557,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":222.998906205,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":222.999265836,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":222.999393629,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":222.999571041,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":222.999750325,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":222.999879937,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":222.999976853,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:887 -   State hash: 8946182511406573673\n"}
,{"stream_name":"stdout","time":223.000107273,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":223.000300942,"data":"    [RL] [STEP 31/41] action=0.0000, reward=0.0100, t=465.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":223.001321828,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":223.001473552,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":223.001589149,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":223.001738836,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":223.001803447,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":223.001940958,"data":"2025-10-15 19:28:24 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":223.001991094,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":223.002021786,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":223.002027515,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":223.002039583,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":223.288565918,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":223.288595965,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":223.288600407,"data":"  Original dt: 4.673271e-01 s\n"}
,{"stream_name":"stdout","time":223.288603517,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":223.288606391,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":223.288609293,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":223.502005989,"data":"[PROGRESS] Step 1650: t=479.02/480.00s (99.8%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":223.54330775,"data":"  Stored output at t = 480.0000 s (Step 1654)\n"}
,{"stream_name":"stderr","time":223.543576893,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 27.74s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 27.73s/s]\n"}
,{"stream_name":"stdout","time":223.543590469,"data":"\n"}
,{"stream_name":"stdout","time":223.543603984,"data":"Simulation finished at t = 480.0000 s after 1654 steps.\n"}
,{"stream_name":"stdout","time":223.543609709,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":223.54543206,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":223.545503652,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":223.545677369,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":223.546064884,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":223.546248537,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":223.546329416,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":223.546564565,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":223.546648481,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":223.546754087,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:887 -   State hash: -9223370365010180863\n"}
,{"stream_name":"stdout","time":223.546904651,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":223.5470861,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0100, t=480.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":223.548149351,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":223.54820229,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":223.548439005,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":223.548451765,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":223.548577274,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":223.548735474,"data":"2025-10-15 19:28:25 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":223.548744735,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":223.548826094,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":223.548833663,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":223.548850113,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":224.046348938,"data":"[PROGRESS] Step 1700: t=493.44/495.00s (99.7%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":224.111705552,"data":"  Stored output at t = 495.0000 s (Step 1706)\n"}
,{"stream_name":"stderr","time":224.111974507,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 26.67s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 26.66s/s]\n"}
,{"stream_name":"stdout","time":224.111988851,"data":"\n"}
,{"stream_name":"stdout","time":224.112003798,"data":"Simulation finished at t = 495.0000 s after 1706 steps.\n"}
,{"stream_name":"stdout","time":224.112017368,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":224.113831323,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":224.113973204,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":224.114113744,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":224.114533049,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":224.114657594,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":224.114779274,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":224.115007479,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":224.115132151,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":224.11525533,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:887 -   State hash: 8946182511406573673\n"}
,{"stream_name":"stdout","time":224.115381834,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":224.11557854,"data":"    [RL] [STEP 33/41] action=0.0000, reward=0.0100, t=495.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":224.116727876,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":224.11691586,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":224.117077987,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":224.117179069,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":224.117294694,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":224.117438673,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":224.117490657,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":224.117497724,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":224.117503727,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":224.117534122,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":224.377096837,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":224.37712525,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":224.377131275,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":224.377135937,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":224.377140466,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":224.377144853,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":224.59654175,"data":"[PROGRESS] Step 1750: t=507.85/510.00s (99.6%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":224.682271597,"data":"  Stored output at t = 510.0000 s (Step 1758)\n"}
,{"stream_name":"stderr","time":224.682477714,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 26.58s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 26.57s/s]\n"}
,{"stream_name":"stdout","time":224.682497504,"data":"\n"}
,{"stream_name":"stdout","time":224.682542014,"data":"Simulation finished at t = 510.0000 s after 1758 steps.\n"}
,{"stream_name":"stdout","time":224.682549899,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":224.684456651,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":224.684488608,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":224.68469191,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":224.685072707,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":224.685145869,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":224.685323247,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":224.685527343,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":224.685630153,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":224.68575427,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:887 -   State hash: -9223370365010180863\n"}
,{"stream_name":"stdout","time":224.685875289,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":224.686072023,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0100, t=510.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":224.687192535,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":224.687252947,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":224.687453287,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":224.687518238,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":224.687646696,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":224.687731659,"data":"2025-10-15 19:28:26 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":224.687771056,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":224.687830453,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":224.687837934,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":224.687843538,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":225.128216302,"data":"[PROGRESS] Step 1800: t=522.27/525.00s (99.5%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":225.236329375,"data":"  Stored output at t = 525.0000 s (Step 1810)\n"}
,{"stream_name":"stderr","time":225.236528266,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 27.37s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 27.36s/s]\n"}
,{"stream_name":"stdout","time":225.23656524,"data":"\n"}
,{"stream_name":"stdout","time":225.236585828,"data":"Simulation finished at t = 525.0000 s after 1810 steps.\n"}
,{"stream_name":"stdout","time":225.236591737,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":225.238539035,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":225.238675181,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":225.238911915,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":225.239300014,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":225.239389337,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":225.239520059,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":225.239759036,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":225.239848826,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":225.239969544,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:887 -   State hash: 8946182511406573673\n"}
,{"stream_name":"stdout","time":225.240084367,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":225.240310677,"data":"    [RL] [STEP 35/41] action=0.0000, reward=0.0100, t=525.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":225.241326156,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":225.241471263,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":225.241590306,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":225.241685751,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":225.241801966,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":225.241903308,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":225.241955243,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":225.241981676,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":225.241989571,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":225.241994272,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":225.455630496,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":225.455657641,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":225.455663661,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":225.455668262,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":225.455673059,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":225.455677821,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":225.678584541,"data":"[PROGRESS] Step 1850: t=536.68/540.00s (99.4%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":225.804442353,"data":"  Stored output at t = 540.0000 s (Step 1862)\n"}
,{"stream_name":"stdout","time":225.804537387,"data":"\n"}
,{"stream_name":"stdout","time":225.804546631,"data":"Simulation finished at t = 540.0000 s after 1862 steps.\n"}
,{"stream_name":"stdout","time":225.804551493,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stderr","time":225.804561542,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 26.69s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 26.68s/s]\n"}
,{"stream_name":"stdout","time":225.806487924,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":225.80659753,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":225.806745541,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":225.807152693,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":225.807174807,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":225.807382694,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":225.807565465,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":225.807646287,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":225.807810705,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:887 -   State hash: 7471417222132788141\n"}
,{"stream_name":"stdout","time":225.807906117,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":225.808151121,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0100, t=540.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":225.809178872,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":225.809207842,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":225.809431009,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":225.809454,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":225.809627478,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":225.809694757,"data":"2025-10-15 19:28:27 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":225.809749787,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":225.809759106,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":225.80976439,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":225.809770479,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":226.230339009,"data":"[PROGRESS] Step 1900: t=551.10/555.00s (99.3%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":226.384778348,"data":"  Stored output at t = 555.0000 s (Step 1914)\n"}
,{"stream_name":"stdout","time":226.38500105,"data":"\n"}
,{"stream_name":"stdout","time":226.385023225,"data":"Simulation finished at t = 555.0000 s after 1914 steps.\n"}
,{"stream_name":"stdout","time":226.385030043,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stderr","time":226.385059564,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 26.11s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 26.10s/s]\n"}
,{"stream_name":"stdout","time":226.3870129,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":226.387049786,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":226.387226667,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":226.38764792,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":226.387835949,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":226.387974358,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":226.388249518,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":226.388369158,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":226.388493219,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:887 -   State hash: 1318134431952495020\n"}
,{"stream_name":"stdout","time":226.388621914,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":226.388849604,"data":"    [RL] [STEP 37/41] action=0.0000, reward=0.0100, t=555.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":226.390014287,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":226.390119624,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":226.39028583,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":226.390425216,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":226.390502186,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":226.390657212,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":226.390672678,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":226.390677326,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":226.390725884,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":226.390731917,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":226.555624978,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":226.555653186,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":226.555659837,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":226.555664816,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":226.555669668,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":226.555673928,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":226.787990302,"data":"[PROGRESS] Step 1950: t=565.51/570.00s (99.2%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":226.970437437,"data":"  Stored output at t = 570.0000 s (Step 1966)\n"}
,{"stream_name":"stdout","time":226.970737831,"data":"\n"}
,{"stream_name":"stderr","time":226.970738554,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 25.89s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 25.88s/s]\n"}
,{"stream_name":"stdout","time":226.970753402,"data":"Simulation finished at t = 570.0000 s after 1966 steps.\n"}
,{"stream_name":"stdout","time":226.970767948,"data":"Total runtime: 0.58 seconds.\n"}
,{"stream_name":"stdout","time":226.972728213,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":226.972882039,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":226.973065108,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":226.9735187,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":226.973618214,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":226.973774711,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":226.973981715,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":226.974113512,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":226.974249133,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:887 -   State hash: -7655890526402752763\n"}
,{"stream_name":"stdout","time":226.974392595,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":226.974619957,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0100, t=570.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":226.975732507,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":226.975799532,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":226.976000876,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":226.976021747,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":226.976201967,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":226.976268003,"data":"2025-10-15 19:28:28 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":226.976360298,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":226.976368161,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":226.976373989,"data":"  └─ Inflow state: rho_m=0.2000, w_m=1.2, rho_c=0.0960, w_c=1.1\n"}
,{"stream_name":"stdout","time":226.976416505,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":227.366870613,"data":"[PROGRESS] Step 2000: t=579.93/585.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":227.573281474,"data":"  Stored output at t = 585.0000 s (Step 2018)\n"}
,{"stream_name":"stdout","time":227.573482171,"data":"\n"}
,{"stream_name":"stdout","time":227.573495336,"data":"Simulation finished at t = 585.0000 s after 2018 steps.\n"}
,{"stream_name":"stdout","time":227.573501579,"data":"Total runtime: 0.60 seconds.\n"}
,{"stream_name":"stderr","time":227.573507498,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 25.15s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 25.14s/s]\n"}
,{"stream_name":"stdout","time":227.575543882,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":227.575636926,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":227.575835258,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":227.576278222,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":227.576427456,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":227.576573267,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":227.57681495,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":227.576892873,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.734355, w_c=14.103983\n"}
,{"stream_name":"stdout","time":227.577049147,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:887 -   State hash: -6029608091283055146\n"}
,{"stream_name":"stdout","time":227.57717093,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":227.577410616,"data":"    [RL] [STEP 39/41] action=0.0000, reward=0.0100, t=585.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":227.578591652,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":227.578706441,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":227.578861129,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":227.57900697,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":227.579126376,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":227.579268555,"data":"2025-10-15 19:28:29 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":227.579332992,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 2.469135802469136, 0.096, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":227.579340315,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":227.579345943,"data":"  └─ Inflow state: rho_m=0.2000, w_m=2.5, rho_c=0.0960, w_c=2.2\n"}
,{"stream_name":"stdout","time":227.579409132,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":227.700705054,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":227.700734988,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":227.70074138,"data":"  Original dt: 4.673270e-01 s\n"}
,{"stream_name":"stdout","time":227.700745807,"data":"  Corrected dt: 2.920794e-01 s\n"}
,{"stream_name":"stdout","time":227.700800234,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":227.700804014,"data":"  Max wave speed detected: 17.12 m/s\n"}
,{"stream_name":"stdout","time":227.920532511,"data":"[PROGRESS] Step 2050: t=594.35/600.00s (99.1%) | dt=0.2921s\n"}
,{"stream_name":"stdout","time":228.125852277,"data":"  Stored output at t = 600.0000 s (Step 2070)\n"}
,{"stream_name":"stdout","time":228.126010801,"data":"\n"}
,{"stream_name":"stderr","time":228.126012698,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 27.48s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 27.46s/s]\n"}
,{"stream_name":"stdout","time":228.126025082,"data":"Simulation finished at t = 600.0000 s after 2070 steps.\n"}
,{"stream_name":"stdout","time":228.126033763,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":228.127971069,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":228.127988202,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.01 | total_reward=    0.33\n"}
,{"stream_name":"stdout","time":228.127993383,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":228.128117576,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:853 -   [RL] Reward: 0.010000\n"}
,{"stream_name":"stdout","time":228.128300839,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":228.128726958,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":228.128813963,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":228.128959807,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.112892e-02, max=1.234568e+00, std=1.131993e-01\n"}
,{"stream_name":"stdout","time":228.129202086,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.032513, rho_c=0.006319\n"}
,{"stream_name":"stdout","time":228.129296981,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.758096, w_c=14.124757\n"}
,{"stream_name":"stdout","time":228.129443766,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:887 -   State hash: -7314208759933474129\n"}
,{"stream_name":"stdout","time":228.129528245,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":228.129773877,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0100, t=600.0s, state_diff=1.112892e-02\n"}
,{"stream_name":"stdout","time":228.129852078,"data":"\n"}
,{"stream_name":"stdout","time":228.129858651,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":228.129863595,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":228.129867656,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":228.129871558,"data":"    - Total reward: 0.33\n"}
,{"stream_name":"stdout","time":228.129875345,"data":"    - Avg step time: 0.571s (device=gpu)\n"}
,{"stream_name":"stdout","time":228.129890597,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":228.129894495,"data":"    - Wallclock time: 22.8s\n"}
,{"stream_name":"stdout","time":228.129902118,"data":"    - Speed ratio: 26.27x real-time\n"}
,{"stream_name":"stdout","time":228.129905953,"data":"\n"}
,{"stream_name":"stdout","time":228.129934458,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":228.129940212,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":228.129944752,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":228.129949177,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":228.129953783,"data":"    - Total reward: 0.33\n"}
,{"stream_name":"stdout","time":228.129958153,"data":"    - Avg step time: 0.571s (device=gpu)\n"}
,{"stream_name":"stdout","time":228.129962619,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":228.129966491,"data":"    - Wallclock time: 22.8s\n"}
,{"stream_name":"stdout","time":228.129970328,"data":"    - Speed ratio: 26.27x real-time\n"}
,{"stream_name":"stdout","time":228.129974156,"data":"\n"}
,{"stream_name":"stdout","time":228.130090533,"data":"2025-10-15 19:28:30 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":228.130541586,"data":"\n"}
,{"stream_name":"stdout","time":228.130560273,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":228.130579427,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":228.130584317,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":228.13058883,"data":"\n"}
,{"stream_name":"stdout","time":228.130719588,"data":"2025-10-15 19:28:30 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":228.130836912,"data":"2025-10-15 19:28:30 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=7303594038020368724, last=-7314208759933474129\n"}
,{"stream_name":"stdout","time":228.131452597,"data":"2025-10-15 19:28:30 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.03374781 0.03433393 0.03489788 0.0354064  0.03582096], w_m[10:15]=[16.06773222 16.04461574 16.03056364 16.02670613 16.03348895]\n"}
,{"stream_name":"stdout","time":228.137036661,"data":"2025-10-15 19:28:30 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02806042 0.02805471 0.02805233 0.02805129 0.02805081], w_m[10:15]=[17.2264753  17.22991053 17.23133283 17.23194061 17.23220899]\n"}
,{"stream_name":"stdout","time":228.137203095,"data":"2025-10-15 19:28:30 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=31.480619, efficiency=5.036899, delay=-174.63s\n"}
,{"stream_name":"stdout","time":228.137390711,"data":"2025-10-15 19:28:30 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":228.13746572,"data":"2025-10-15 19:28:30 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 31.480619328703096, 'avg_speed': 956.1406482003346, 'avg_density': 0.03300979212617883, 'efficiency': 5.036899092592496, 'delay': -174.62675893587863, 'throughput': 157403.09664351548}\n"}
,{"stream_name":"stdout","time":228.137610812,"data":"2025-10-15 19:28:30 - INFO - run_performance_comparison:1430 - Flow improvement: 11.277%\n"}
,{"stream_name":"stdout","time":228.13769443,"data":"2025-10-15 19:28:30 - INFO - run_performance_comparison:1431 - Efficiency improvement: 11.277%\n"}
,{"stream_name":"stdout","time":228.137815076,"data":"2025-10-15 19:28:30 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":228.137915709,"data":"  Flow improvement: 11.3%\n"}
,{"stream_name":"stdout","time":228.137921833,"data":"  Efficiency improvement: 11.3%\n"}
,{"stream_name":"stdout","time":228.137926002,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":228.137929921,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":228.13902537,"data":"\n"}
,{"stream_name":"stdout","time":228.13904023,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":228.799913108,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":229.42778181,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":229.427844909,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":229.427854037,"data":"\n"}
,{"stream_name":"stdout","time":229.427857076,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":229.438365001,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":229.438392466,"data":"\n"}
,{"stream_name":"stdout","time":229.438398439,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":229.43857786,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":229.438587596,"data":"\n"}
,{"stream_name":"stdout","time":229.438607396,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":229.438614738,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":229.438619731,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":229.438624466,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":229.438629146,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":229.438645884,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":229.439841297,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":232.481252126,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":232.481322623,"data":"\n"}
,{"stream_name":"stdout","time":232.481331536,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":232.481453976,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":232.485504487,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":232.48654204,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":232.486705658,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":232.4867909,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":232.486891805,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":232.487016619,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":232.487051906,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":232.487148732,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":232.487213364,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":232.487435803,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":232.563408562,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":232.563509004,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":232.563985978,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":232.563998505,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":232.564107544,"data":"\n"}
,{"stream_name":"stdout","time":232.564115254,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":232.564162811,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":232.564347542,"data":"\n"}
,{"stream_name":"stdout","time":232.564360513,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":232.564365535,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":232.564369789,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":232.564374038,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":236.541358366,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":236.541400205,"data":"  warn(\n"}
,{"stream_name":"stderr","time":236.587443948,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":237.477713648,"data":"[NbConvertApp] Writing 322230 bytes to __results__.html\n"}
]