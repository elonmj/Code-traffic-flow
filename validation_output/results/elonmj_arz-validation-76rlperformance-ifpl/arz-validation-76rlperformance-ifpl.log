[{"stream_name":"stdout","time":0.740704884,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.740761124,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.740766727,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.740770521,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.74085303,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.741183126,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":6.251928977,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":6.251972194,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":6.30857143,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":6.329228654,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":6.32935477,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":6.329437538,"data":"\n"}
,{"stream_name":"stdout","time":6.329445464,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":6.329592495,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.862206319,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.862238612,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.862245446,"data":"\n"}
,{"stream_name":"stdout","time":9.862250777,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.862254861,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":13.908469232,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":16.977330751,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":19.977501872,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":23.040295128,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":26.075643373,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":29.074579235,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":101.189566795,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":101.18978639,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":101.189805457,"data":"\n"}
,{"stream_name":"stdout","time":101.18981154,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":101.190175439,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":101.190285994,"data":"[SCENARIO] Single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":101.190352366,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":101.190419326,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":101.190515869,"data":"============================================================\n"}
,{"stream_name":"stderr","time":112.984800488,"data":"2025-10-15 18:58:40.075110: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":113.199410323,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":113.199445399,"data":"E0000 00:00:1760554720.289589     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":113.262560361,"data":"E0000 00:00:1760554720.352949     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":125.290630091,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":125.290701005,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":125.290708653,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":125.290715432,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":125.290719212,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":125.29072256,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":125.290726182,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":125.29073378,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":125.290741257,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":125.290744808,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":125.290748283,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":125.290751844,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":125.290755322,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":125.291314546,"data":"2025-10-15 18:58:52 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":125.291449231,"data":"2025-10-15 18:58:52 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":125.291543643,"data":"2025-10-15 18:58:52 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":125.291629606,"data":"2025-10-15 18:58:52 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":125.291755239,"data":"2025-10-15 18:58:52 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":125.291765898,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":125.291771433,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":125.291776815,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":125.431930189,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":125.531486232,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":125.531525407,"data":"\n"}
,{"stream_name":"stdout","time":125.531532699,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":125.531558937,"data":"[SCENARIO] Single scenario mode (CLI): traffic_light_control\n"}
,{"stream_name":"stdout","time":125.531563724,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":125.531567768,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":125.531637868,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":125.53180565,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":125.531847097,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":125.531960737,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":125.53202517,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":125.532124415,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":125.532205084,"data":"2025-10-15 18:58:52 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":125.532262237,"data":"\n"}
,{"stream_name":"stdout","time":125.532268091,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":125.532272188,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":125.532276017,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":125.532280073,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":125.532589433,"data":"2025-10-15 18:58:52 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":125.532604944,"data":"2025-10-15 18:58:52 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":125.532694334,"data":"2025-10-15 18:58:52 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":125.533171791,"data":"2025-10-15 18:58:52 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":125.537635578,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":125.5376618,"data":"2025-10-15 18:58:52 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":125.537800114,"data":"2025-10-15 18:58:52 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":125.537897074,"data":"2025-10-15 18:58:52 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":125.537992939,"data":"2025-10-15 18:58:52 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":125.538001648,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":125.538006506,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":125.538151954,"data":"2025-10-15 18:58:52 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":125.538327353,"data":"2025-10-15 18:58:52 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":125.538505851,"data":"2025-10-15 18:58:52 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 515c5ce5\n"}
,{"stream_name":"stdout","time":125.538637481,"data":"2025-10-15 18:58:52 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config 515c5ce5\n"}
,{"stream_name":"stdout","time":125.53864491,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":125.53915131,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":125.53916795,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":125.546532281,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":125.546547953,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":125.546552328,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":125.54655615,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":125.546559826,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":125.546687363,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":125.54670048,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":125.546706311,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":125.546714004,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":125.546720985,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":125.546795133,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":125.546804258,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":125.550214169,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":125.55024165,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stderr","time":125.550800305,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":125.550808627,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":127.132940827,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":127.132975374,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":127.132980229,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":127.132984603,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":127.132988542,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":127.132992059,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":127.132995757,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":127.132999376,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":127.13334638,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":127.134217783,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":127.13424588,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":127.134309081,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":131.789185037,"data":"2025-10-15 18:58:58 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 515c5ce5\n"}
,{"stream_name":"stdout","time":131.789613804,"data":"\n"}
,{"stream_name":"stdout","time":131.789624568,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":131.789639314,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":131.789644369,"data":"\n"}
,{"stream_name":"stdout","time":131.789648831,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":131.789653412,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":131.789657167,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":131.789661403,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":131.789665992,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":131.789670731,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":131.789676321,"data":"\n"}
,{"stream_name":"stdout","time":131.789739058,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":131.78974643,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":131.803464779,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":131.803490175,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":131.803494592,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":131.80349734,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":131.803500026,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":131.803645367,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":131.803652815,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":131.803657459,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":131.803661511,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":131.803741188,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":131.803757208,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":131.803761255,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":131.804529982,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":131.804544794,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":131.805670469,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":131.805984047,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":131.806008516,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.806013136,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":131.868606007,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":131.868771397,"data":"\n"}
,{"stream_name":"stdout","time":131.868779883,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":131.870569194,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":131.870586929,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.870590984,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":131.870593877,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.871015033,"data":"\n"}
,{"stream_name":"stderr","time":131.910849369,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.910887282,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":132.260434196,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":132.260459959,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.260465435,"data":"  Original dt: 1.972762e+00 s\n"}
,{"stream_name":"stdout","time":132.260469713,"data":"  Corrected dt: 1.232977e+00 s\n"}
,{"stream_name":"stdout","time":132.260473861,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.260477787,"data":"  Max wave speed detected: 4.06 m/s\n"}
,{"stream_name":"stderr","time":132.854372806,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.854406625,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.113202163,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.113235981,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.173653136,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.173680794,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.233710001,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.233741809,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.67270532,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.672756194,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.750220809,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.750250331,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.83632274,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.836352879,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.935785105,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.935811818,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.037546461,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.037577162,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.097734479,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.097763357,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.156582126,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.156610821,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.425747738,"data":"\n"}
,{"stream_name":"stderr","time":134.42577317,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.425747438,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stdout","time":134.425984921,"data":"\n"}
,{"stream_name":"stdout","time":134.425995886,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":134.426004216,"data":"Total runtime: 2.56 seconds.\n"}
,{"stream_name":"stderr","time":134.426037797,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.87s/s]\n"}
,{"stream_name":"stdout","time":134.42783657,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":134.428243611,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":134.428254961,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.428260155,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":134.428280684,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.42844346,"data":"\n"}
,{"stream_name":"stdout","time":134.638377039,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":134.909680714,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":134.909699938,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.909719678,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.90989571,"data":"\n"}
,{"stream_name":"stderr","time":134.909896019,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.17s/s]\n"}
,{"stream_name":"stdout","time":134.90990504,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":134.909914142,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":134.911617527,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":134.911984121,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":134.911991564,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.911995688,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":134.911999469,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.912215048,"data":"\n"}
,{"stream_name":"stdout","time":135.128814993,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":135.128842601,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.128848421,"data":"  Original dt: 4.591288e-01 s\n"}
,{"stream_name":"stdout","time":135.128853204,"data":"  Corrected dt: 2.869555e-01 s\n"}
,{"stream_name":"stdout","time":135.128857345,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.128861054,"data":"  Max wave speed detected: 17.42 m/s\n"}
,{"stream_name":"stdout","time":135.137020736,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stderr","time":135.427276011,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.427305061,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.427305929,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":135.427486503,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.12s/s]\n"}
,{"stream_name":"stdout","time":135.427521636,"data":"\n"}
,{"stream_name":"stdout","time":135.427534351,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":135.427539287,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":135.429190801,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.429571374,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":135.429582673,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.429588104,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":135.42959277,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.429760789,"data":"\n"}
,{"stream_name":"stdout","time":135.627966306,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":135.954697495,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.954747593,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.954714271,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stdout","time":135.955059383,"data":"\n"}
,{"stream_name":"stderr","time":135.955063823,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.57s/s]\n"}
,{"stream_name":"stdout","time":135.955076333,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":135.955128473,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":135.956802356,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.957357474,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":135.957376649,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.957383648,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":135.957389522,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.957563005,"data":"\n"}
,{"stream_name":"stdout","time":136.114271144,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":136.114299692,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.114306744,"data":"  Original dt: 4.540129e-01 s\n"}
,{"stream_name":"stdout","time":136.114312327,"data":"  Corrected dt: 2.837581e-01 s\n"}
,{"stream_name":"stdout","time":136.114317974,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.114324192,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stdout","time":136.12339681,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stderr","time":136.477734902,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":136.4777517,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":136.47776378,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":136.478033452,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.83s/s]\n"}
,{"stream_name":"stdout","time":136.47804254,"data":"\n"}
,{"stream_name":"stdout","time":136.478054705,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":136.4780592,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":136.479761151,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.480124737,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":136.480137089,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.480141984,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":136.480146519,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.480331124,"data":"\n"}
,{"stream_name":"stdout","time":136.620501443,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":137.002361859,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":137.002390375,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.002400721,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":137.002708972,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.73s/s]\n"}
,{"stream_name":"stdout","time":137.002757071,"data":"\n"}
,{"stream_name":"stdout","time":137.002765368,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":137.002770501,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":137.004682762,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.005053429,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":137.005065788,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.005071036,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":137.005075127,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.005298917,"data":"\n"}
,{"stream_name":"stdout","time":137.105547731,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":137.105573387,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.105579042,"data":"  Original dt: 4.538375e-01 s\n"}
,{"stream_name":"stdout","time":137.105599217,"data":"  Corrected dt: 2.836485e-01 s\n"}
,{"stream_name":"stdout","time":137.105603751,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.105607805,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":137.114323327,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":137.523513319,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":137.523513424,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":137.523540968,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.523942586,"data":"\n"}
,{"stream_name":"stdout","time":137.523958839,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":137.523963783,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":137.523943957,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.94s/s]\n"}
,{"stream_name":"stdout","time":137.525694273,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.526035807,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":137.526048289,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.52605356,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":137.526058121,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.526273057,"data":"\n"}
,{"stream_name":"stdout","time":137.617774477,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":138.055848148,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":138.055857388,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.055883278,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.056053281,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.32s/s]\n"}
,{"stream_name":"stdout","time":138.056074667,"data":"\n"}
,{"stream_name":"stdout","time":138.056089395,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":138.056127503,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":138.057783461,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.057798478,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":138.05788197,"data":"\n"}
,{"stream_name":"stdout","time":138.057910356,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.057916105,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.04 | Avg Reward/Step: 0.005\n"}
,{"stream_name":"stdout","time":138.057920815,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.057925478,"data":"\n"}
,{"stream_name":"stdout","time":138.057930053,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":138.057942085,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":138.066049307,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":138.066067094,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":138.066071662,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":138.066076064,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":138.066080138,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":138.066258253,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":138.066271849,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":138.066276544,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":138.066280389,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":138.066284098,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":138.066293157,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":138.066297404,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":138.066952523,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":138.066964493,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":138.067173047,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":138.067467653,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":138.067476604,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.067480953,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":138.069419326,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":138.069432693,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.06943724,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":138.06944111,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.069593183,"data":"\n"}
,{"stream_name":"stdout","time":138.110355481,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":138.110373499,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.1103783,"data":"  Original dt: 1.160069e+00 s\n"}
,{"stream_name":"stdout","time":138.11039361,"data":"  Corrected dt: 7.250434e-01 s\n"}
,{"stream_name":"stdout","time":138.110396362,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.110404214,"data":"  Max wave speed detected: 6.90 m/s\n"}
,{"stream_name":"stderr","time":138.344125655,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":138.34413715,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":138.344152838,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.344376842,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.64s/s]\n"}
,{"stream_name":"stdout","time":138.344383369,"data":"\n"}
,{"stream_name":"stdout","time":138.344394547,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":138.344398896,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stdout","time":138.346059367,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.346380001,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":138.34639646,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.346401848,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":138.346406065,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.346561363,"data":"\n"}
,{"stream_name":"stdout","time":138.560038648,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":138.818822188,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.818856347,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.818823443,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":138.819095678,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.76s/s]\n"}
,{"stream_name":"stdout","time":138.819129228,"data":"\n"}
,{"stream_name":"stdout","time":138.819141207,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":138.819145947,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":138.820912487,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.821534571,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":138.821555344,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.82155928,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":138.821576129,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.821698435,"data":"\n"}
,{"stream_name":"stdout","time":139.041355115,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":139.079952918,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":139.079980334,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.079985739,"data":"  Original dt: 4.583140e-01 s\n"}
,{"stream_name":"stdout","time":139.079990171,"data":"  Corrected dt: 2.864462e-01 s\n"}
,{"stream_name":"stdout","time":139.07999375,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.079998113,"data":"  Max wave speed detected: 17.46 m/s\n"}
,{"stream_name":"stdout","time":139.333176595,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":139.333176597,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.333232456,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.333500559,"data":"\n"}
,{"stream_name":"stderr","time":139.33349918,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.32s/s]\n"}
,{"stream_name":"stdout","time":139.333511928,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":139.333530507,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":139.335405529,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.335702331,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":139.335714216,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.335718902,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":139.335723462,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.335906356,"data":"\n"}
,{"stream_name":"stdout","time":139.525630211,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":139.844839948,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":139.844885865,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.844902473,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.845144979,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.47s/s]\n"}
,{"stream_name":"stdout","time":139.845148649,"data":"\n"}
,{"stream_name":"stdout","time":139.845169649,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":139.845174657,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":139.846852959,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.847299434,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":139.847317231,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.847322171,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":139.847326407,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.847480791,"data":"\n"}
,{"stream_name":"stdout","time":140.014941676,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":140.055350308,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":140.055376978,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.055382995,"data":"  Original dt: 4.539830e-01 s\n"}
,{"stream_name":"stdout","time":140.055387543,"data":"  Corrected dt: 2.837394e-01 s\n"}
,{"stream_name":"stdout","time":140.055391806,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.055396307,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stderr","time":140.373133815,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.373160157,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.37313382,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":140.373468425,"data":"\n"}
,{"stream_name":"stdout","time":140.373479308,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stderr","time":140.373472771,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.53s/s]\n"}
,{"stream_name":"stdout","time":140.373484563,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":140.375358893,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":140.37567365,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":140.37568134,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.375686,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":140.375690385,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.375894026,"data":"\n"}
,{"stream_name":"stdout","time":140.514982027,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stderr","time":140.913537281,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.913592281,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.913537294,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stdout","time":140.913797429,"data":"\n"}
,{"stream_name":"stdout","time":140.913822306,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":140.91382794,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stderr","time":140.913796147,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 27.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 27.90s/s]\n"}
,{"stream_name":"stdout","time":140.915617666,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.915943861,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":140.915955508,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.915960959,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":140.915965833,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.916100986,"data":"\n"}
,{"stream_name":"stdout","time":141.029341418,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":141.069145775,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":141.06916855,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.0691739,"data":"  Original dt: 4.538363e-01 s\n"}
,{"stream_name":"stdout","time":141.069178137,"data":"  Corrected dt: 2.836477e-01 s\n"}
,{"stream_name":"stdout","time":141.069182174,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.069186258,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":141.449399562,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":141.449399558,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":141.449425368,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.44956131,"data":"\n"}
,{"stream_name":"stdout","time":141.449568743,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":141.449573155,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":141.449609246,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.13s/s]\n"}
,{"stream_name":"stdout","time":141.451279458,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.451598657,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":141.451622348,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.451626822,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":141.451631054,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.451794615,"data":"\n"}
,{"stream_name":"stdout","time":141.527634537,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":141.97255189,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.972592082,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.972550448,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stdout","time":141.97296741,"data":"\n"}
,{"stream_name":"stdout","time":141.972992914,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":141.972998796,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":141.972968264,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.80s/s]\n"}
,{"stream_name":"stdout","time":141.974820394,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.974837511,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":141.974842174,"data":"\n"}
,{"stream_name":"stdout","time":141.974846291,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.974854226,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":141.974858795,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.974863374,"data":"\n"}
,{"stream_name":"stdout","time":141.974867846,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.974872546,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.98251412,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.982531773,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.982536705,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.982540674,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.982577136,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":141.982718969,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.982726497,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.982730602,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":141.982734557,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.98278412,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":141.982811057,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.982816486,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.983523616,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.983541681,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":141.983817476,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.984083102,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":141.984093287,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.984097686,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stderr","time":141.986142856,"data":"\n"}
,{"stream_name":"stdout","time":141.986177179,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":141.986189195,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.986193514,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":141.986197462,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.073223626,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":142.073250282,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.073256131,"data":"  Original dt: 8.437770e-01 s\n"}
,{"stream_name":"stdout","time":142.07326053,"data":"  Corrected dt: 5.273606e-01 s\n"}
,{"stream_name":"stdout","time":142.073264713,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.073269024,"data":"  Max wave speed detected: 9.48 m/s\n"}
,{"stream_name":"stderr","time":142.255959782,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.255985689,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.255983866,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":142.256100447,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.61s/s]\n"}
,{"stream_name":"stdout","time":142.256150335,"data":"\n"}
,{"stream_name":"stdout","time":142.256161188,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":142.256178644,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stdout","time":142.257841128,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.258161217,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":142.258174716,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.258191442,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":142.258195752,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.258376398,"data":"\n"}
,{"stream_name":"stdout","time":142.471906486,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":142.731469423,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":142.731469414,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":142.731495009,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":142.731668697,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.71s/s]\n"}
,{"stream_name":"stdout","time":142.731667662,"data":"\n"}
,{"stream_name":"stdout","time":142.73168728,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":142.731692343,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":142.733424046,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.733830742,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":142.733842853,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.733848885,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":142.733853509,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.73387006,"data":"\n"}
,{"stream_name":"stdout","time":142.955056324,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":143.054087155,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":143.054129684,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.054149811,"data":"  Original dt: 4.577187e-01 s\n"}
,{"stream_name":"stdout","time":143.054154405,"data":"  Corrected dt: 2.860742e-01 s\n"}
,{"stream_name":"stdout","time":143.054158179,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.054162827,"data":"  Max wave speed detected: 17.48 m/s\n"}
,{"stream_name":"stderr","time":143.255429182,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":143.25542869,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":143.255458018,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":143.255645206,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.76s/s]\n"}
,{"stream_name":"stdout","time":143.255665549,"data":"\n"}
,{"stream_name":"stdout","time":143.255669812,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":143.255699917,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":143.257257551,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.257559753,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":143.257567236,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.257571216,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":143.257575115,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.257795936,"data":"\n"}
,{"stream_name":"stdout","time":143.450626394,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":143.771508103,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.771535554,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.771507709,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stdout","time":143.771730381,"data":"\n"}
,{"stream_name":"stderr","time":143.771737589,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.20s/s]\n"}
,{"stream_name":"stdout","time":143.771746904,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":143.771758295,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":143.773491244,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.773947354,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":143.773958313,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.77396345,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":143.77396770000001,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.774150984,"data":"\n"}
,{"stream_name":"stdout","time":143.938300581,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":144.030403074,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":144.030430049,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.030435776,"data":"  Original dt: 4.539598e-01 s\n"}
,{"stream_name":"stdout","time":144.030440696,"data":"  Corrected dt: 2.837249e-01 s\n"}
,{"stream_name":"stdout","time":144.030444487,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.030448106,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stderr","time":144.284648613,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.284711635,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.284663936,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":144.284868983,"data":"\n"}
,{"stream_name":"stdout","time":144.284876766,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stderr","time":144.284876155,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.39s/s]\n"}
,{"stream_name":"stdout","time":144.284880732,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":144.286456369,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.286842533,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":144.28685223,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.286857262,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":144.286862127,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.287051586,"data":"\n"}
,{"stream_name":"stdout","time":144.422841483,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":144.799851062,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":144.799849583,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.799913675,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":144.800133959,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.25s/s]\n"}
,{"stream_name":"stdout","time":144.800142403,"data":"\n"}
,{"stream_name":"stdout","time":144.800158796,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":144.800163164,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":144.801835803,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.802149091,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":144.80216518,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.802169798,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":144.802173574,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.802328247,"data":"\n"}
,{"stream_name":"stdout","time":144.907507468,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":144.997222425,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":144.997263806,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.997268287,"data":"  Original dt: 4.538352e-01 s\n"}
,{"stream_name":"stdout","time":144.997270911,"data":"  Corrected dt: 2.836470e-01 s\n"}
,{"stream_name":"stdout","time":144.997273324,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.997275728,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":145.321312505,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.321338312,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.32131234,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stdout","time":145.321507802,"data":"\n"}
,{"stream_name":"stdout","time":145.321518975,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":145.321523744,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":145.321531841,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.91s/s]\n"}
,{"stream_name":"stdout","time":145.323175856,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.323533641,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":145.323542257,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.323546529,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":145.323550747,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.323882007,"data":"\n"}
,{"stream_name":"stdout","time":145.399938851,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":145.836832532,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":145.83686348,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.836881107,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.837045033,"data":"\n"}
,{"stream_name":"stderr","time":145.837047227,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.24s/s]\n"}
,{"stream_name":"stdout","time":145.837055725,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":145.837066529,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":145.838725763,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.838743565,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":145.838765417,"data":"\n"}
,{"stream_name":"stdout","time":145.838769504,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.838773741,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":145.838777644,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.838781439,"data":"\n"}
,{"stream_name":"stdout","time":145.838784973,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.838789166,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.846616166,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.846635042,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.846640826,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.846645866,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.846650542,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.846709198,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.846767694,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.846776801,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.84690549,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.846914671,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":145.846927493,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.846932538,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.847658114,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.847677232,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":145.848064889,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.848356107,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":145.848368424,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.848372994,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":145.850208601,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":145.8502224,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.850227659,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":145.850231585,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.850405848,"data":"\n"}
,{"stream_name":"stdout","time":145.992171648,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":145.992197298,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.992212819,"data":"  Original dt: 7.151404e-01 s\n"}
,{"stream_name":"stdout","time":145.992216893,"data":"  Corrected dt: 4.469627e-01 s\n"}
,{"stream_name":"stdout","time":145.992221316,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.992225408,"data":"  Max wave speed detected: 11.19 m/s\n"}
,{"stream_name":"stderr","time":146.128200945,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.128225808,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.128228702,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stdout","time":146.128395537,"data":"\n"}
,{"stream_name":"stderr","time":146.128401121,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.01s/s]\n"}
,{"stream_name":"stdout","time":146.128404769,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":146.128414248,"data":"Total runtime: 0.28 seconds.\n"}
,{"stream_name":"stdout","time":146.130080312,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":146.130387511,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":146.130402844,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":146.130407551,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":146.130411279,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.13059623,"data":"\n"}
,{"stream_name":"stdout","time":146.34403785,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":146.611320606,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.611349873,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.611331139,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":146.611635487,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":146.611638524,"data":"\n"}
,{"stream_name":"stdout","time":146.611650893,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":146.61165604,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":146.613579165,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":146.613921112,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":146.613932471,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.613953258,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":146.613958979,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.614137476,"data":"\n"}
,{"stream_name":"stdout","time":146.835719928,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":146.974406702,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":146.974432249,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.974438744,"data":"  Original dt: 4.570374e-01 s\n"}
,{"stream_name":"stdout","time":146.974443358,"data":"  Corrected dt: 2.856483e-01 s\n"}
,{"stream_name":"stdout","time":146.974447914,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.974451912,"data":"  Max wave speed detected: 17.50 m/s\n"}
,{"stream_name":"stderr","time":147.124607432,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.124635542,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.124615857,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":147.124991472,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.38s/s]\n"}
,{"stream_name":"stdout","time":147.125002609,"data":"\n"}
,{"stream_name":"stdout","time":147.125015541,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":147.125021139,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":147.12692228,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.127291639,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":147.127310292,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.127316547,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":147.127321545,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.127486724,"data":"\n"}
,{"stream_name":"stdout","time":147.319232232,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":147.665285199,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.665312344,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.665285201,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":147.665539724,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 27.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 27.89s/s]\n"}
,{"stream_name":"stdout","time":147.665555673,"data":"\n"}
,{"stream_name":"stdout","time":147.665589279,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":147.665594488,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":147.667417895,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.667968869,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":147.6679775,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.66798252,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":147.667987031,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.668150748,"data":"\n"}
,{"stream_name":"stdout","time":147.848553879,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":147.986117679,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":147.986144938,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.986149388,"data":"  Original dt: 4.539420e-01 s\n"}
,{"stream_name":"stdout","time":147.986152053,"data":"  Corrected dt: 2.837138e-01 s\n"}
,{"stream_name":"stdout","time":147.986154665,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.986157269,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stderr","time":148.205274181,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.205307343,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.205326087,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":148.205529984,"data":"\n"}
,{"stream_name":"stdout","time":148.205540741,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":148.2055453,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stderr","time":148.205559235,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 27.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 27.93s/s]\n"}
,{"stream_name":"stdout","time":148.207530527,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.207882884,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":148.207908438,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.207914046,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":148.20792678,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.208098204,"data":"\n"}
,{"stream_name":"stdout","time":148.34578424,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stderr","time":148.731838417,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.73188676,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.731857497,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":148.732057807,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.64s/s]\n"}
,{"stream_name":"stdout","time":148.732076673,"data":"\n"}
,{"stream_name":"stdout","time":148.732092042,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":148.732096592,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":148.733655639,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":148.734009547,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":148.734018273,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.734022962,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":148.73402708,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.734232179,"data":"\n"}
,{"stream_name":"stdout","time":148.840695483,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":148.981008984,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":148.981032714,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.981038756,"data":"  Original dt: 4.538341e-01 s\n"}
,{"stream_name":"stdout","time":148.981043283,"data":"  Corrected dt: 2.836463e-01 s\n"}
,{"stream_name":"stdout","time":148.981047286,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.981051741,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":149.2601557,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.260188341,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.260155705,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":149.260463558,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.52s/s]\n"}
,{"stream_name":"stdout","time":149.260468141,"data":"\n"}
,{"stream_name":"stdout","time":149.260499674,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":149.260505081,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":149.262336925,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.262649114,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":149.262677409,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.262682353,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":149.262686629,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.26286294,"data":"\n"}
,{"stream_name":"stdout","time":149.350743552,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":149.797303947,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":149.797306592,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.797336953,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.79747934,"data":"\n"}
,{"stream_name":"stderr","time":149.79748103,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.08s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.07s/s]\n"}
,{"stream_name":"stdout","time":149.797487611,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":149.797495512,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":149.799152426,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.799172371,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":149.799178174,"data":"\n"}
,{"stream_name":"stdout","time":149.799182389,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.799186562,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":149.799190922,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.799195146,"data":"\n"}
,{"stream_name":"stdout","time":149.799199476,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":149.799203591,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":149.806397668,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":149.806415168,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":149.806420746,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":149.806425394,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":149.806429585,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":149.80652091299999,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":149.80652901,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":149.806533259,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":149.806554959,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":149.806559214,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":149.806595653,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":149.806601077,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":149.807421129,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":149.807435321,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":149.807766652,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":149.808451371,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":149.808462426,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.808467297,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":149.810475119,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":149.810486764,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":149.810491131,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":149.810495506,"data":"|    ep_rew_mean      | 0.09     |\n"}
,{"stream_name":"stdout","time":149.810499675,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":149.810503643,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":149.810507206,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":149.810510749,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":149.810514321,"data":"|    time_elapsed     | 18       |\n"}
,{"stream_name":"stdout","time":149.81051804,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":149.810521902,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":149.811708294,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":149.811723853,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.811729161,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":149.811733981,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.811872062,"data":"\n"}
,{"stream_name":"stdout","time":149.994343782,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":149.994369345,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.994375002,"data":"  Original dt: 6.233703e-01 s\n"}
,{"stream_name":"stdout","time":149.994379026,"data":"  Corrected dt: 3.896065e-01 s\n"}
,{"stream_name":"stdout","time":149.994382882,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.994386723,"data":"  Max wave speed detected: 12.83 m/s\n"}
,{"stream_name":"stdout","time":150.077582056,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":150.077584035,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.077615564,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.077844864,"data":"\n"}
,{"stream_name":"stdout","time":150.077854868,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":150.077859655,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stderr","time":150.077867586,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.44s/s]\n"}
,{"stream_name":"stdout","time":150.07955861,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.079890167,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":150.079899428,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.079903487,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":150.07990733,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.080069593,"data":"\n"}
,{"stream_name":"stdout","time":150.296954637,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":150.600360652,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.600385017,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.600403373,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":150.600745133,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.82s/s]\n"}
,{"stream_name":"stdout","time":150.60074398,"data":"\n"}
,{"stream_name":"stdout","time":150.600767567,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":150.600773211,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":150.602728393,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.603098149,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":150.603118733,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.603128742,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":150.603133476,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.603332439,"data":"\n"}
,{"stream_name":"stdout","time":150.847447917,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":151.03223571,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":151.032262514,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.032283481,"data":"  Original dt: 4.564243e-01 s\n"}
,{"stream_name":"stdout","time":151.032287743,"data":"  Corrected dt: 2.852652e-01 s\n"}
,{"stream_name":"stdout","time":151.032291652,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.032295864,"data":"  Max wave speed detected: 17.53 m/s\n"}
,{"stream_name":"stderr","time":151.136069329,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.136097119,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.136069852,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":151.136344656,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.16s/s]\n"}
,{"stream_name":"stdout","time":151.136348711,"data":"\n"}
,{"stream_name":"stdout","time":151.136359879,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":151.136364322,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":151.13803472,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.13837951,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":151.138391464,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.138395743,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":151.138399702,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.138553784,"data":"\n"}
,{"stream_name":"stdout","time":151.33367975,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":151.645558345,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.645587676,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.645650197,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stdout","time":151.64582067,"data":"\n"}
,{"stream_name":"stdout","time":151.645830087,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":151.645835055,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":151.645837958,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.59s/s]\n"}
,{"stream_name":"stdout","time":151.647731623,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.648190546,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":151.648208207,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.648226066,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":151.648230992,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.648393003,"data":"\n"}
,{"stream_name":"stdout","time":151.81217918,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":151.999875877,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":151.999897743,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.999902945,"data":"  Original dt: 4.539282e-01 s\n"}
,{"stream_name":"stdout","time":151.999906616,"data":"  Corrected dt: 2.837052e-01 s\n"}
,{"stream_name":"stdout","time":151.999910236,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.999913993,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stdout","time":152.160459166,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":152.160496093,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.160512461,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.160665743,"data":"\n"}
,{"stream_name":"stdout","time":152.160674102,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":152.160678287,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":152.160668608,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.29s/s]\n"}
,{"stream_name":"stdout","time":152.162804496,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.163208989,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":152.163229441,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.16323575,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":152.163240872,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.163436063,"data":"\n"}
,{"stream_name":"stdout","time":152.302831871,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":152.675682921,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":152.675695902,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.675729991,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":152.675892071,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.29s/s]\n"}
,{"stream_name":"stdout","time":152.675896684,"data":"\n"}
,{"stream_name":"stdout","time":152.675908734,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":152.675938198,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":152.677529616,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.677817048,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":152.677827993,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.677836957,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":152.677841047,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.677985681,"data":"\n"}
,{"stream_name":"stdout","time":152.781973206,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":152.986236469,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":152.986265694,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.986271266,"data":"  Original dt: 4.538330e-01 s\n"}
,{"stream_name":"stdout","time":152.986275112,"data":"  Corrected dt: 2.836456e-01 s\n"}
,{"stream_name":"stdout","time":152.986278901,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.986282589,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":153.221918288,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.22194783,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.22191829,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stdout","time":153.222301232,"data":"\n"}
,{"stream_name":"stdout","time":153.222320465,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":153.22232611,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stderr","time":153.222328517,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.57s/s]\n"}
,{"stream_name":"stdout","time":153.224448637,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.224744396,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":153.224756975,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.224762279,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":153.224767259,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.224966275,"data":"\n"}
,{"stream_name":"stdout","time":153.312329585,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":153.778346885,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.778394867,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.778350071,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":153.778585084,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.11s/s]\n"}
,{"stream_name":"stdout","time":153.778593201,"data":"\n"}
,{"stream_name":"stdout","time":153.778607731,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":153.778612341,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":153.780266199,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.780284662,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":153.780311313,"data":"\n"}
,{"stream_name":"stdout","time":153.780338651,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":153.780344177,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.017\n"}
,{"stream_name":"stdout","time":153.780348333,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":153.780352066,"data":"\n"}
,{"stream_name":"stdout","time":153.78035624,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":153.780360958,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":153.789286549,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":153.789303272,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":153.789309123,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":153.789313768,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":153.789363591,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":153.789473298,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":153.789482338,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":153.789486671,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":153.789503625,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":153.789530128,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":153.789562398,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":153.789569478,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":153.790197835,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":153.790214821,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":153.790545731,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":153.79079127400001,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":153.79080267,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.790807712,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":153.792746373,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":153.792763594,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.792768668,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":153.792773376,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.792905594,"data":"\n"}
,{"stream_name":"stdout","time":154.027814091,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":154.027838668,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.027844324,"data":"  Original dt: 5.770019e-01 s\n"}
,{"stream_name":"stdout","time":154.027848939,"data":"  Corrected dt: 3.606262e-01 s\n"}
,{"stream_name":"stdout","time":154.027852937,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.027857243,"data":"  Max wave speed detected: 13.86 m/s\n"}
,{"stream_name":"stderr","time":154.06564567,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.065672585,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.065644824,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stdout","time":154.065854622,"data":"\n"}
,{"stream_name":"stdout","time":154.06586865,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":154.065873346,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stderr","time":154.065880982,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.01s/s]\n"}
,{"stream_name":"stdout","time":154.067653971,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.067982037,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":154.06799358,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.06799824,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":154.068002387,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.068152952,"data":"\n"}
,{"stream_name":"stdout","time":154.285215286,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":154.555354117,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":154.555376526,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.55539887,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.55562467,"data":"\n"}
,{"stream_name":"stdout","time":154.555639277,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":154.555644277,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":154.555651204,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":154.55734811,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":154.557641007,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":154.557652236,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.557656734,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":154.557661334,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.557829476,"data":"\n"}
,{"stream_name":"stdout","time":154.781961897,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":155.022410499,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":155.022440865,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.022447068,"data":"  Original dt: 4.559731e-01 s\n"}
,{"stream_name":"stdout","time":155.022451653,"data":"  Corrected dt: 2.849832e-01 s\n"}
,{"stream_name":"stdout","time":155.022456304,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.02246043,"data":"  Max wave speed detected: 17.54 m/s\n"}
,{"stream_name":"stderr","time":155.083608923,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.083635157,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.083608946,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stdout","time":155.083908761,"data":"\n"}
,{"stream_name":"stdout","time":155.083918229,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":155.083922947,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":155.083950804,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.53s/s]\n"}
,{"stream_name":"stdout","time":155.085729174,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":155.086053261,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":155.08606041,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.08607652,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":155.086080682,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.086278968,"data":"\n"}
,{"stream_name":"stdout","time":155.287215694,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":155.611205987,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.611237094,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.611205343,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stdout","time":155.611531926,"data":"\n"}
,{"stream_name":"stdout","time":155.611541323,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stderr","time":155.61153947,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.57s/s]\n"}
,{"stream_name":"stdout","time":155.611546324,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":155.613474652,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":155.613935875,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":155.613947481,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.613952404,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":155.613956842,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.614160519,"data":"\n"}
,{"stream_name":"stdout","time":155.781220365,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":156.024772557,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":156.024798842,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.02480314,"data":"  Original dt: 4.539152e-01 s\n"}
,{"stream_name":"stdout","time":156.024806927,"data":"  Corrected dt: 2.836970e-01 s\n"}
,{"stream_name":"stdout","time":156.024812699,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.024816864,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stdout","time":156.144132579,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":156.144138291,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.144185988,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.144497592,"data":"\n"}
,{"stream_name":"stdout","time":156.144514091,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":156.144519803,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":156.144524931,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.30s/s]\n"}
,{"stream_name":"stdout","time":156.146339794,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.146672361,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":156.146681679,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.146686413,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":156.146690354,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.14691786,"data":"\n"}
,{"stream_name":"stdout","time":156.289099931,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":156.672844378,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":156.672844283,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.672896815,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.673334042,"data":"\n"}
,{"stream_name":"stderr","time":156.673341732,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.52s/s]\n"}
,{"stream_name":"stdout","time":156.673352825,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":156.673364669,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":156.675311481,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.675621442,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":156.67562849,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.675632597,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":156.675636575,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.675833565,"data":"\n"}
,{"stream_name":"stdout","time":156.790098084,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":157.041678874,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":157.041706509,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.041712357,"data":"  Original dt: 4.538321e-01 s\n"}
,{"stream_name":"stdout","time":157.041716298,"data":"  Corrected dt: 2.836450e-01 s\n"}
,{"stream_name":"stdout","time":157.041720376,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.041724784,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":157.220488112,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":157.220530844,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.220559836,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.220773178,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 27.54s/s]\n"}
,{"stream_name":"stdout","time":157.220782751,"data":"\n"}
,{"stream_name":"stdout","time":157.220794146,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":157.220798801,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":157.222619087,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.223011081,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":157.223023486,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.22302916,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":157.223034069,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.223190247,"data":"\n"}
,{"stream_name":"stdout","time":157.303556543,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":157.737060037,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.737092785,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.737059426,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":157.737224379,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.20s/s]\n"}
,{"stream_name":"stdout","time":157.73723938,"data":"\n"}
,{"stream_name":"stdout","time":157.737252421,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":157.737256953,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":157.738983686,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.738998977,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":157.739003896,"data":"\n"}
,{"stream_name":"stdout","time":157.739008357,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":157.739012543,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.07 | Avg Reward/Step: 0.009\n"}
,{"stream_name":"stdout","time":157.739017016,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":157.739020917,"data":"\n"}
,{"stream_name":"stdout","time":157.739037967,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":157.739041083,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":157.746405055,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":157.746942747,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":157.746956819,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":157.746962265,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":157.747042434,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":157.747273319,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":157.747288034,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":157.747292566,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":157.747296679,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":157.747345894,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":157.747354092,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":157.747358536,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":157.748041336,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":157.748048252,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":157.748309164,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":157.748559427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":157.748565581,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.748569669,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":157.75059905,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":157.750612498,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.750616884,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":157.750620733,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.750805295,"data":"\n"}
,{"stream_name":"stdout","time":158.021010904,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":158.021010847,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.02104132,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.021379043,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.49s/s]\n"}
,{"stream_name":"stdout","time":158.021387691,"data":"\n"}
,{"stream_name":"stdout","time":158.021399495,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":158.021417432,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stdout","time":158.023089114,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.023422308,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":158.023434029,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.023438628,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":158.023444135,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.023609338,"data":"\n"}
,{"stream_name":"stdout","time":158.035723968,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":158.03574011,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.035743581,"data":"  Original dt: 5.511261e-01 s\n"}
,{"stream_name":"stdout","time":158.035746308,"data":"  Corrected dt: 3.444538e-01 s\n"}
,{"stream_name":"stdout","time":158.035748755,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.035751513,"data":"  Max wave speed detected: 14.52 m/s\n"}
,{"stream_name":"stdout","time":158.263987478,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":158.550834671,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":158.5508351,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.550870012,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.550983874,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 28.45s/s]\n"}
,{"stream_name":"stdout","time":158.551005935,"data":"\n"}
,{"stream_name":"stdout","time":158.551011427,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":158.551016321,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":158.553266536,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.574080665,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":158.574216103,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":158.57422927,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.574234552,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":158.574238594,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.574461909,"data":"\n"}
,{"stream_name":"stdout","time":158.79966949,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":159.078681032,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":159.078708517,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.078713882,"data":"  Original dt: 4.556398e-01 s\n"}
,{"stream_name":"stdout","time":159.078718677,"data":"  Corrected dt: 2.847749e-01 s\n"}
,{"stream_name":"stdout","time":159.078728563,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.078733829,"data":"  Max wave speed detected: 17.56 m/s\n"}
,{"stream_name":"stderr","time":159.087525,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.087562984,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.087525306,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stdout","time":159.087841072,"data":"\n"}
,{"stream_name":"stdout","time":159.087867793,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":159.087873118,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":159.087884248,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.23s/s]\n"}
,{"stream_name":"stdout","time":159.089668862,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.090000038,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":159.090011434,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.09001616,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":159.090020533,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.090180205,"data":"\n"}
,{"stream_name":"stdout","time":159.290236431,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":159.614413231,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.614444109,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.614413251,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":159.614695531,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.63s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.62s/s]\n"}
,{"stream_name":"stdout","time":159.614694428,"data":"\n"}
,{"stream_name":"stdout","time":159.614718242,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":159.614723481,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":159.616453147,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":159.616883572,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":159.616892217,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.616897131,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":159.61690099,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.61707383,"data":"\n"}
,{"stream_name":"stdout","time":159.779352436,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":160.066064458,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":160.066103983,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.066109524,"data":"  Original dt: 4.539012e-01 s\n"}
,{"stream_name":"stdout","time":160.066114264,"data":"  Corrected dt: 2.836883e-01 s\n"}
,{"stream_name":"stdout","time":160.066136579,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.066140661,"data":"  Max wave speed detected: 17.62 m/s\n"}
,{"stream_name":"stdout","time":160.136171789,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":160.136206147,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.136225977,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.136460193,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.89s/s]\n"}
,{"stream_name":"stdout","time":160.136486787,"data":"\n"}
,{"stream_name":"stdout","time":160.136491841,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":160.13649606,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":160.138154835,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.138480119,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":160.138487924,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.138492998,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":160.138497063,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.138677744,"data":"\n"}
,{"stream_name":"stdout","time":160.277031065,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":160.6623074,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":160.662305818,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.662338675,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":160.662620866,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.64s/s]\n"}
,{"stream_name":"stdout","time":160.662639336,"data":"\n"}
,{"stream_name":"stdout","time":160.662665009,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":160.662670808,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":160.664380147,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.664723567,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":160.664736069,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.664741873,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":160.664746918,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.664953913,"data":"\n"}
,{"stream_name":"stdout","time":160.78167571,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":161.094508789,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":161.094553123,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.094559105,"data":"  Original dt: 4.538314e-01 s\n"}
,{"stream_name":"stdout","time":161.094563809,"data":"  Corrected dt: 2.836446e-01 s\n"}
,{"stream_name":"stdout","time":161.094568187,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.094572787,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":161.221368791,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.221404757,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.221371698,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":161.221555379,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 26.96s/s]\n"}
,{"stream_name":"stdout","time":161.221585212,"data":"\n"}
,{"stream_name":"stdout","time":161.22159795,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":161.221602175,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":161.22320013,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.223534478,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":161.223546034,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.223551214,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":161.223555102,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.223717162,"data":"\n"}
,{"stream_name":"stdout","time":161.302676772,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":161.740951849,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":161.741009731,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.741028798,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":161.741207568,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.00s/s]\n"}
,{"stream_name":"stdout","time":161.741213568,"data":"\n"}
,{"stream_name":"stdout","time":161.741240534,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":161.74124564,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":161.742961391,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.742978809,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":161.742983621,"data":"\n"}
,{"stream_name":"stdout","time":161.742987557,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":161.742991654,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":161.742995792,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":161.74300244,"data":"\n"}
,{"stream_name":"stdout","time":161.743006517,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":161.743010751,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":161.751074696,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":161.751091354,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":161.75109631,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":161.751100273,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":161.751104637,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":161.751211322,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":161.751219299,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":161.751223371,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":161.751227683,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":161.751279579,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":161.751284723,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":161.751288562,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":161.751885319,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":161.751908127,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":161.752141251,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":161.752366194,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":161.75237647,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.752380931,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":161.75428528,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":161.754301942,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.754307214,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":161.754311667,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.754472255,"data":"\n"}
,{"stream_name":"stdout","time":162.023377982,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":162.023384295,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.02341185,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":162.023685167,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.76s/s]\n"}
,{"stream_name":"stdout","time":162.023725031,"data":"\n"}
,{"stream_name":"stdout","time":162.023739345,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":162.023744123,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stdout","time":162.025574778,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.025950719,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":162.025961575,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.025974003,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":162.025978638,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.026154703,"data":"\n"}
,{"stream_name":"stdout","time":162.083564174,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":162.083589303,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.08359555,"data":"  Original dt: 5.336109e-01 s\n"}
,{"stream_name":"stdout","time":162.083600183,"data":"  Corrected dt: 3.335068e-01 s\n"}
,{"stream_name":"stdout","time":162.083604194,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.083608844,"data":"  Max wave speed detected: 14.99 m/s\n"}
,{"stream_name":"stdout","time":162.240776886,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":162.505595246,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.505624029,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.505647156,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":162.505963965,"data":"\n"}
,{"stream_name":"stdout","time":162.50597405,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":162.505979216,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":162.506014508,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.28s/s]\n"}
,{"stream_name":"stdout","time":162.507813325,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.508153091,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":162.508165029,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.508169502,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":162.508173463,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.508390006,"data":"\n"}
,{"stream_name":"stdout","time":162.723313879,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":163.003716549,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":163.003750373,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.00375697,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.003966855,"data":"\n"}
,{"stream_name":"stdout","time":163.003988504,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":163.003993888,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":163.003965426,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.28s/s]\n"}
,{"stream_name":"stdout","time":163.005761354,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.006089537,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":163.006101254,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.006126329,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":163.006131882,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.006275549,"data":"\n"}
,{"stream_name":"stdout","time":163.046876873,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":163.046900709,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.046906181,"data":"  Original dt: 4.554259e-01 s\n"}
,{"stream_name":"stdout","time":163.046910401,"data":"  Corrected dt: 2.846412e-01 s\n"}
,{"stream_name":"stdout","time":163.046914771,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.04691847,"data":"  Max wave speed detected: 17.57 m/s\n"}
,{"stream_name":"stdout","time":163.215558208,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":163.53044091,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":163.530440826,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":163.530469481,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.530541404,"data":"\n"}
,{"stream_name":"stdout","time":163.5305518,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stderr","time":163.530556358,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.63s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.62s/s]\n"}
,{"stream_name":"stdout","time":163.530556443,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":163.532255505,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.532703275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":163.532711731,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.532716107,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":163.532719914,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.532922325,"data":"\n"}
,{"stream_name":"stdout","time":163.715845164,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":164.041784293,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":164.041810408,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.041816501,"data":"  Original dt: 4.538904e-01 s\n"}
,{"stream_name":"stdout","time":164.041820926,"data":"  Corrected dt: 2.836815e-01 s\n"}
,{"stream_name":"stdout","time":164.041824941,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.041829163,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":164.060015053,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":164.060022457,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.060043996,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.060337125,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.45s/s]\n"}
,{"stream_name":"stdout","time":164.060360388,"data":"\n"}
,{"stream_name":"stdout","time":164.060372894,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":164.060377378,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":164.062073101,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.062443757,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":164.062454211,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.062458822,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":164.06246432,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.062636523,"data":"\n"}
,{"stream_name":"stdout","time":164.199190732,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":164.573838667,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":164.573838664,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.573897215,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.574019873,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.35s/s]\n"}
,{"stream_name":"stdout","time":164.574030299,"data":"\n"}
,{"stream_name":"stdout","time":164.57404856,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":164.574053086,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":164.576044239,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.576445699,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":164.576457387,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.576462302,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":164.576466566,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.576661382,"data":"\n"}
,{"stream_name":"stdout","time":164.682193284,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":165.009033191,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":165.009072825,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.009078837,"data":"  Original dt: 4.538309e-01 s\n"}
,{"stream_name":"stdout","time":165.009083733,"data":"  Corrected dt: 2.836443e-01 s\n"}
,{"stream_name":"stdout","time":165.009101865,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.009152938,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":165.088331236,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":165.088341305,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.088373525,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.08864924,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.31s/s]\n"}
,{"stream_name":"stdout","time":165.088662627,"data":"\n"}
,{"stream_name":"stdout","time":165.088674924,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":165.088679625,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":165.090330092,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":165.090666814,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":165.090683649,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.090689056,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":165.090693106,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.090875229,"data":"\n"}
,{"stream_name":"stdout","time":165.168516418,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":165.598817273,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.598843333,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.598830862,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stdout","time":165.599222286,"data":"\n"}
,{"stream_name":"stdout","time":165.599238775,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":165.599243425,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":165.599238801,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.53s/s]\n"}
,{"stream_name":"stdout","time":165.601063536,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.601083758,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":165.601089122,"data":"\n"}
,{"stream_name":"stdout","time":165.601093316,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":165.601098022,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":165.601141379,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":165.601150049,"data":"\n"}
,{"stream_name":"stdout","time":165.601153975,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":165.60115804,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":165.608880646,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":165.608899238,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":165.608904454,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":165.608908984,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":165.60895455,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":165.609096316,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":165.609104551,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":165.609109886,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":165.609146886,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":165.609156789,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":165.609188657,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":165.609199975,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":165.609822103,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":165.609829621,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":165.610146598,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":165.610792774,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":165.610799349,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.610804162,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":165.612767017,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":165.612779295,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":165.612783957,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":165.612788063,"data":"|    ep_rew_mean      | 0.0938   |\n"}
,{"stream_name":"stdout","time":165.612792076,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":165.61279569,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":165.612799211,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":165.612802771,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":165.612807927,"data":"|    time_elapsed     | 33       |\n"}
,{"stream_name":"stdout","time":165.612813402,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":165.612817038,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":165.613925723,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":165.613962702,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.613968902,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":165.613972672,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.614091159,"data":"\n"}
,{"stream_name":"stdout","time":165.882568819,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":165.882568816,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.882604976,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.882740815,"data":"\n"}
,{"stream_name":"stdout","time":165.882748987,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":165.882754412,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stderr","time":165.88277784,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 55.88s/s]\n"}
,{"stream_name":"stdout","time":165.884541356,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.884814177,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":165.884824439,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.884829515,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":165.884834101,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.884998585,"data":"\n"}
,{"stream_name":"stdout","time":166.000258798,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":166.000286672,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.000292569,"data":"  Original dt: 5.128472e-01 s\n"}
,{"stream_name":"stdout","time":166.000296765,"data":"  Corrected dt: 3.205295e-01 s\n"}
,{"stream_name":"stdout","time":166.000300718,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.000304485,"data":"  Max wave speed detected: 15.60 m/s\n"}
,{"stream_name":"stdout","time":166.107027186,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":166.364917502,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":166.364941075,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":166.364945152,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.365162294,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.26s/s]\n"}
,{"stream_name":"stdout","time":166.365185036,"data":"\n"}
,{"stream_name":"stdout","time":166.365196528,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":166.365232013,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":166.367018926,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.367362143,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":166.367373341,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.367377705,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":166.367381677,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.367559716,"data":"\n"}
,{"stream_name":"stdout","time":166.584046028,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stderr","time":166.865432018,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":166.865448838,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":166.865465383,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.865723722,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.13s/s]\n"}
,{"stream_name":"stdout","time":166.865733247,"data":"\n"}
,{"stream_name":"stdout","time":166.865755465,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":166.865762563,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":166.867496533,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.867818617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":166.867834785,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.867841113,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":166.867846939,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.867992796,"data":"\n"}
,{"stream_name":"stdout","time":166.956819576,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":166.956841658,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.956848444,"data":"  Original dt: 4.552161e-01 s\n"}
,{"stream_name":"stdout","time":166.956854146,"data":"  Corrected dt: 2.845101e-01 s\n"}
,{"stream_name":"stdout","time":166.956859634,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.956865313,"data":"  Max wave speed detected: 17.57 m/s\n"}
,{"stream_name":"stdout","time":167.061914674,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":167.382129903,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.382173454,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.382153592,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":167.382208232,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.18s/s]\n"}
,{"stream_name":"stdout","time":167.382246134,"data":"\n"}
,{"stream_name":"stdout","time":167.382259358,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":167.382264093,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":167.38393687,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.384372542,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":167.384389605,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.384394647,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":167.384398905,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.384551713,"data":"\n"}
,{"stream_name":"stdout","time":167.548845787,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stderr","time":167.895951676,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.895980635,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.895950865,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":167.896228798,"data":"\n"}
,{"stream_name":"stdout","time":167.896252642,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":167.896258948,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":167.896227091,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.33s/s]\n"}
,{"stream_name":"stdout","time":167.898052229,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.898298401,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":167.898315003,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.898320803,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":167.898325383,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.898490523,"data":"\n"}
,{"stream_name":"stdout","time":167.930042032,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":167.930086254,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.930091762,"data":"  Original dt: 4.538820e-01 s\n"}
,{"stream_name":"stdout","time":167.930095358,"data":"  Corrected dt: 2.836763e-01 s\n"}
,{"stream_name":"stdout","time":167.930100534,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.930104452,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":168.036187611,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stderr","time":168.424553576,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.424581651,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.424537809,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":168.424860709,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.52s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.51s/s]\n"}
,{"stream_name":"stdout","time":168.424862435,"data":"\n"}
,{"stream_name":"stdout","time":168.424887716,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":168.424892388,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":168.42667319,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.427031375,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":168.427039207,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.42704342,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":168.427047248,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.42725594,"data":"\n"}
,{"stream_name":"stdout","time":168.534067704,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":168.907221915,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":168.907250899,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.907255834,"data":"  Original dt: 4.538305e-01 s\n"}
,{"stream_name":"stdout","time":168.907258458,"data":"  Corrected dt: 2.836441e-01 s\n"}
,{"stream_name":"stdout","time":168.907261091,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.907263772,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":168.935397918,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":168.935445395,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.935463982,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":168.935719648,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.51s/s]\n"}
,{"stream_name":"stdout","time":168.935730606,"data":"\n"}
,{"stream_name":"stdout","time":168.935757358,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":168.935762698,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":168.937459266,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.937756149,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":168.937766406,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.937770426,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":168.937774301,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.937929616,"data":"\n"}
,{"stream_name":"stdout","time":169.012859363,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":169.442848339,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":169.442920782,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.442929985,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.442935042,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.72s/s]\n"}
,{"stream_name":"stdout","time":169.442938357,"data":"\n"}
,{"stream_name":"stdout","time":169.442953542,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":169.442957944,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":169.444549408,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.44456512,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":169.444585163,"data":"\n"}
,{"stream_name":"stdout","time":169.444589723,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":169.444594332,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.017\n"}
,{"stream_name":"stdout","time":169.44459877,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":169.444603372,"data":"\n"}
,{"stream_name":"stdout","time":169.444607381,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":169.444612946,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":169.452410401,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":169.452428827,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":169.452434122,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":169.452455328,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":169.452460165,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":169.452464667,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":169.452469141,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":169.452473303,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":169.452478517,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":169.452483013,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":169.452524468,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":169.452529393,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":169.453127615,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":169.453140636,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":169.453366872,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":169.453633299,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":169.453651334,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.453655939,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":169.455613584,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":169.455631356,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.455636417,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":169.455640958,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.455835353,"data":"\n"}
,{"stream_name":"stderr","time":169.719725221,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.71975419,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.719785804,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":169.719996784,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.84s/s]\n"}
,{"stream_name":"stdout","time":169.720003377,"data":"\n"}
,{"stream_name":"stdout","time":169.72001435,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":169.720018975,"data":"Total runtime: 0.26 seconds.\n"}
,{"stream_name":"stdout","time":169.721669546,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.721990066,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":169.722021243,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.722027016,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":169.722031213,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.72220224,"data":"\n"}
,{"stream_name":"stdout","time":169.878189338,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":169.878218036,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.878224075,"data":"  Original dt: 4.995799e-01 s\n"}
,{"stream_name":"stdout","time":169.878228405,"data":"  Corrected dt: 3.122374e-01 s\n"}
,{"stream_name":"stdout","time":169.878232305,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.878236066,"data":"  Max wave speed detected: 16.01 m/s\n"}
,{"stream_name":"stdout","time":169.932534198,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":170.189906752,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":170.189957985,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.189976568,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.190141346,"data":"\n"}
,{"stream_name":"stdout","time":170.190156429,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":170.190161755,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":170.190192928,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.08s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.07s/s]\n"}
,{"stream_name":"stdout","time":170.191794614,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.192081433,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":170.192091292,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.192095719,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":170.192100236,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.192258075,"data":"\n"}
,{"stream_name":"stdout","time":170.411348075,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stderr","time":170.698656918,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.698683337,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.698736532,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":170.698944462,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.63s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.62s/s]\n"}
,{"stream_name":"stdout","time":170.698947579,"data":"\n"}
,{"stream_name":"stdout","time":170.698993905,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":170.698998921,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":170.700504202,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":170.700827133,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":170.700840549,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.700845278,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":170.700849649,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.701012095,"data":"\n"}
,{"stream_name":"stdout","time":170.862608583,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":170.862636269,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.862641651,"data":"  Original dt: 4.549509e-01 s\n"}
,{"stream_name":"stdout","time":170.862646042,"data":"  Corrected dt: 2.843443e-01 s\n"}
,{"stream_name":"stdout","time":170.862650136,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.862654416,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":170.920284672,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":171.251794819,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":171.251801091,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":171.251821961,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.252057889,"data":"\n"}
,{"stream_name":"stdout","time":171.252067665,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":171.252071957,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stderr","time":171.252072826,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 27.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 27.23s/s]\n"}
,{"stream_name":"stdout","time":171.253699647,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":171.254139836,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":171.254157435,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.254162765,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":171.254166892,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.254337343,"data":"\n"}
,{"stream_name":"stdout","time":171.414220483,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stderr","time":171.750200893,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.750230989,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.750240505,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":171.750459075,"data":"\n"}
,{"stream_name":"stdout","time":171.750470172,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":171.750474898,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":171.750511809,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.25s/s]\n"}
,{"stream_name":"stdout","time":171.752226044,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.752532966,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":171.752540584,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.752545549,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":171.752549495,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.752720961,"data":"\n"}
,{"stream_name":"stdout","time":171.841681296,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":171.841709026,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.841715352,"data":"  Original dt: 4.538752e-01 s\n"}
,{"stream_name":"stdout","time":171.841720476,"data":"  Corrected dt: 2.836720e-01 s\n"}
,{"stream_name":"stdout","time":171.841725225,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.841729997,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":171.909507793,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":172.294877566,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":172.294875948,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.294911629,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":172.295088443,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 27.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 27.67s/s]\n"}
,{"stream_name":"stdout","time":172.295123648,"data":"\n"}
,{"stream_name":"stdout","time":172.295134758,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":172.295139408,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":172.296902052,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.297199436,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":172.29721026,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.29721434,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":172.297218097,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.297398727,"data":"\n"}
,{"stream_name":"stdout","time":172.400096914,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":172.798927676,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":172.798945044,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.798967583,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.799254834,"data":"\n"}
,{"stream_name":"stdout","time":172.799268014,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":172.799273175,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":172.799276367,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.90s/s]\n"}
,{"stream_name":"stdout","time":172.801032851,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.80139326,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":172.801404017,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.801408291,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":172.801412065,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.801592826,"data":"\n"}
,{"stream_name":"stdout","time":172.821856331,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":172.821876349,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.821882048,"data":"  Original dt: 4.538301e-01 s\n"}
,{"stream_name":"stdout","time":172.821886256,"data":"  Corrected dt: 2.836438e-01 s\n"}
,{"stream_name":"stdout","time":172.821890788,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.821894796,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":172.878146638,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":173.295856905,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.295885839,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.295862038,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":173.296150162,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.35s/s]\n"}
,{"stream_name":"stdout","time":173.296154008,"data":"\n"}
,{"stream_name":"stdout","time":173.296192385,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":173.296197874,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":173.29773322,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.297751584,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":173.297776985,"data":"\n"}
,{"stream_name":"stdout","time":173.297785042,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.297789589,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":173.297793837,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":173.297798136,"data":"\n"}
,{"stream_name":"stdout","time":173.297802143,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":173.29781193,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":173.304840788,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":173.304854726,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":173.304859609,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":173.304864079,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":173.304912843,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":173.305016585,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":173.3050255,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":173.305029994,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":173.30503436,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":173.305043305,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":173.305088623,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":173.305097027,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":173.305713166,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":173.305724261,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":173.306000861,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":173.30629339,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":173.306303962,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.306308596,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":173.3082992,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":173.308317318,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.308322384,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":173.308326502,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.308433976,"data":"\n"}
,{"stream_name":"stderr","time":173.569056675,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.569078619,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.569051463,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stdout","time":173.56944567,"data":"\n"}
,{"stream_name":"stdout","time":173.569462061,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":173.569467707,"data":"Total runtime: 0.26 seconds.\n"}
,{"stream_name":"stderr","time":173.56948593,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 57.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 57.52s/s]\n"}
,{"stream_name":"stdout","time":173.571076049,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.571405671,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":173.571419156,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.571423434,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":173.571427669,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.571585858,"data":"\n"}
,{"stream_name":"stdout","time":173.767788912,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":173.767832651,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.767836704,"data":"  Original dt: 4.907898e-01 s\n"}
,{"stream_name":"stdout","time":173.76783974,"data":"  Corrected dt: 3.067436e-01 s\n"}
,{"stream_name":"stdout","time":173.767842382,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.767845218,"data":"  Max wave speed detected: 16.30 m/s\n"}
,{"stream_name":"stdout","time":173.776758847,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stderr","time":174.036890007,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.036918816,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.036971473,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":174.037205504,"data":"\n"}
,{"stream_name":"stderr","time":174.037213239,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.24s/s]\n"}
,{"stream_name":"stdout","time":174.037220955,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":174.037255139,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":174.038866708,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":174.039224831,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":174.039235476,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.039239811,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":174.039243786,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.039424926,"data":"\n"}
,{"stream_name":"stdout","time":174.257417197,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":174.542939481,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":174.542927241,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.542981053,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":174.543166666,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.80s/s]\n"}
,{"stream_name":"stdout","time":174.543177625,"data":"\n"}
,{"stream_name":"stdout","time":174.543192371,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":174.54320942,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":174.544790647,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.545161921,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":174.545173401,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.545177879,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":174.545181873,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.545322947,"data":"\n"}
,{"stream_name":"stdout","time":174.742705147,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":174.742735547,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.742741423,"data":"  Original dt: 4.547531e-01 s\n"}
,{"stream_name":"stdout","time":174.742745846,"data":"  Corrected dt: 2.842207e-01 s\n"}
,{"stream_name":"stdout","time":174.742752293,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.742755842,"data":"  Max wave speed detected: 17.59 m/s\n"}
,{"stream_name":"stdout","time":174.752861279,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":175.068900694,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":175.068933723,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.068943609,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.069251196,"data":"\n"}
,{"stream_name":"stdout","time":175.069271813,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":175.069277622,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":175.069251059,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.64s/s]\n"}
,{"stream_name":"stdout","time":175.070900205,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.071414113,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":175.071425372,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.071430224,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":175.071436018,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.071616107,"data":"\n"}
,{"stream_name":"stdout","time":175.234620733,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stderr","time":175.571910533,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.57194034,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.571915093,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":175.57215658,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.98s/s]\n"}
,{"stream_name":"stdout","time":175.572178306,"data":"\n"}
,{"stream_name":"stdout","time":175.572185896,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":175.572190683,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":175.57369267,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.574048875,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":175.574056491,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.574060561,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":175.574067651,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.57424181,"data":"\n"}
,{"stream_name":"stdout","time":175.694223596,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":175.694249193,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.694255026,"data":"  Original dt: 4.538697e-01 s\n"}
,{"stream_name":"stdout","time":175.694258947,"data":"  Corrected dt: 2.836685e-01 s\n"}
,{"stream_name":"stdout","time":175.694262565,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.694266138,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":175.70361535,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":176.081079927,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":176.08108992,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.081139632,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.081404956,"data":"\n"}
,{"stream_name":"stdout","time":176.081414701,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":176.081419394,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":176.081427703,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.59s/s]\n"}
,{"stream_name":"stdout","time":176.08313922,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.083489917,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":176.083497109,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.08350202,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":176.083506263,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.083676092,"data":"\n"}
,{"stream_name":"stdout","time":176.188088859,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":176.594486717,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":176.594486714,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.594520852,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.594765561,"data":"\n"}
,{"stream_name":"stdout","time":176.594774792,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":176.594779953,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":176.594790737,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.36s/s]\n"}
,{"stream_name":"stdout","time":176.596635413,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":176.597030058,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":176.597039692,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":176.597044381,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":176.597048819,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.597368413,"data":"\n"}
,{"stream_name":"stdout","time":176.6656952,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":176.665723307,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.665730347,"data":"  Original dt: 4.538297e-01 s\n"}
,{"stream_name":"stdout","time":176.665735708,"data":"  Corrected dt: 2.836436e-01 s\n"}
,{"stream_name":"stdout","time":176.665740904,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.665745746,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":176.674714826,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stderr","time":177.112613205,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.112638556,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.112656925,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stdout","time":177.112885186,"data":"\n"}
,{"stream_name":"stdout","time":177.112895573,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":177.112900493,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":177.112906306,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.11s/s]\n"}
,{"stream_name":"stdout","time":177.114459317,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.114476998,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":177.114504123,"data":"\n"}
,{"stream_name":"stdout","time":177.11452942,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.114534208,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":177.114539472,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.114543766,"data":"\n"}
,{"stream_name":"stdout","time":177.114547679,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.114552382,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.122305388,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.12233672,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.122341303,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.122345167,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.122350487,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.122354079,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.122358503,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.122362887,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.122402982,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.122414588,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":177.122419213,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.12242285,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.123051145,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.123059106,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":177.123352488,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.123601271,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":177.123608151,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.123612776,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":177.125517883,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":177.125529291,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.12553408,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":177.125538784,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.125696398,"data":"\n"}
,{"stream_name":"stdout","time":177.398855809,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":177.398855807,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.398909206,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.399018918,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.93s/s]\n"}
,{"stream_name":"stdout","time":177.399045984,"data":"\n"}
,{"stream_name":"stdout","time":177.399071386,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":177.399076778,"data":"Total runtime: 0.27 seconds.\n"}
,{"stream_name":"stdout","time":177.400709428,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.401050905,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":177.401058435,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.401062673,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":177.401066669,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.4012583,"data":"\n"}
,{"stream_name":"stdout","time":177.606909747,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":177.645380359,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":177.645408205,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.64541351,"data":"  Original dt: 4.848245e-01 s\n"}
,{"stream_name":"stdout","time":177.645418804,"data":"  Corrected dt: 3.030153e-01 s\n"}
,{"stream_name":"stdout","time":177.645422598,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.645425356,"data":"  Max wave speed detected: 16.50 m/s\n"}
,{"stream_name":"stdout","time":177.86801984,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":177.868091731,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.868123824,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.868312357,"data":"\n"}
,{"stream_name":"stderr","time":177.868311674,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.14s/s]\n"}
,{"stream_name":"stdout","time":177.868324008,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":177.868333048,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":177.869975065,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.870307798,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":177.870317945,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.870322383,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":177.870326423,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.870498146,"data":"\n"}
,{"stream_name":"stdout","time":178.088044438,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stderr","time":178.379961279,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.37998901,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.379996742,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":178.380168112,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.45s/s]\n"}
,{"stream_name":"stdout","time":178.380174745,"data":"\n"}
,{"stream_name":"stdout","time":178.380226044,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":178.380231119,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":178.381931088,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.382310699,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":178.382327431,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.382332524,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":178.382378438,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.382575752,"data":"\n"}
,{"stream_name":"stdout","time":178.571365811,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":178.609137863,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":178.609160605,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.60916556,"data":"  Original dt: 4.546052e-01 s\n"}
,{"stream_name":"stdout","time":178.609169265,"data":"  Corrected dt: 2.841283e-01 s\n"}
,{"stream_name":"stdout","time":178.609174598,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.609178931,"data":"  Max wave speed detected: 17.60 m/s\n"}
,{"stream_name":"stderr","time":178.879580116,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.879609846,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.879638107,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stdout","time":178.879819419,"data":"\n"}
,{"stream_name":"stderr","time":178.879819516,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.18s/s]\n"}
,{"stream_name":"stdout","time":178.879828244,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":178.879837216,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":178.881912578,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.882349079,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":178.882367561,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.882372816,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":178.882377287,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.882545421,"data":"\n"}
,{"stream_name":"stdout","time":179.049493167,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":179.417265753,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stderr","time":179.417337817,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.41734831,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.41760932,"data":"\n"}
,{"stream_name":"stderr","time":179.417606128,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.05s/s]\n"}
,{"stream_name":"stdout","time":179.41761941,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":179.417636845,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":179.419449339,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.419765018,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":179.419773963,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.419778453,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":179.419782758,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.419990729,"data":"\n"}
,{"stream_name":"stdout","time":179.559435556,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":179.600203136,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":179.600230646,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.600236566,"data":"  Original dt: 4.538641e-01 s\n"}
,{"stream_name":"stdout","time":179.600241053,"data":"  Corrected dt: 2.836650e-01 s\n"}
,{"stream_name":"stdout","time":179.600245401,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.600249681,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":179.937501416,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.937529277,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.937587466,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stdout","time":179.937794122,"data":"\n"}
,{"stream_name":"stderr","time":179.937794432,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 28.98s/s]\n"}
,{"stream_name":"stdout","time":179.937803935,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":179.937815333,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":179.939456338,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.939793696,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":179.939807315,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.939813531,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":179.939817729,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.93999504,"data":"\n"}
,{"stream_name":"stdout","time":180.043743287,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":180.453719585,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":180.453756203,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.45376298,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":180.45409674,"data":"\n"}
,{"stream_name":"stdout","time":180.454143987,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":180.454150699,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":180.454098313,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.19s/s]\n"}
,{"stream_name":"stdout","time":180.456047289,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":180.456445606,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":180.456458169,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.456464482,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":180.456469609,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":180.456672711,"data":"\n"}
,{"stream_name":"stdout","time":180.533170624,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":180.571767484,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":180.571789274,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.571793682,"data":"  Original dt: 4.538294e-01 s\n"}
,{"stream_name":"stdout","time":180.571796299,"data":"  Corrected dt: 2.836434e-01 s\n"}
,{"stream_name":"stdout","time":180.571799183,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.571802599,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":181.007867134,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":181.007867129,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.007917212,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":181.008098938,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 27.21s/s]\n"}
,{"stream_name":"stdout","time":181.008148428,"data":"\n"}
,{"stream_name":"stdout","time":181.008158039,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":181.008162765,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stdout","time":181.009861061,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":181.009878538,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":181.009883548,"data":"\n"}
,{"stream_name":"stdout","time":181.009887286,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":181.009891568,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":181.009896051,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":181.009900551,"data":"\n"}
,{"stream_name":"stdout","time":181.009907318,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":181.009911896,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":181.017764712,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":181.01779012,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":181.017795357,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":181.017799231,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":181.017802995,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":181.017849038,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":181.017856949,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":181.017861646,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":181.017903602,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":181.017909981,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":181.017914654,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":181.017929382,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":181.018719528,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":181.018736662,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":181.019030509,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":181.019354635,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":181.019374901,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.019400802,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":181.021434991,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":181.021448686,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":181.021452673,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":181.021456332,"data":"|    ep_rew_mean      | 0.102    |\n"}
,{"stream_name":"stdout","time":181.021461488,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":181.021464761,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":181.02146721,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":181.021469586,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":181.021471939,"data":"|    time_elapsed     | 49       |\n"}
,{"stream_name":"stdout","time":181.02147431,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":181.021476757,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":181.02247982,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":181.022494734,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.022499384,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":181.022504979,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.022704176,"data":"\n"}
,{"stream_name":"stderr","time":181.300458808,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.300493189,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.300462666,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":181.300580139,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 54.04s/s]\n"}
,{"stream_name":"stdout","time":181.300626047,"data":"\n"}
,{"stream_name":"stdout","time":181.300638081,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":181.300643188,"data":"Total runtime: 0.28 seconds.\n"}
,{"stream_name":"stdout","time":181.302392311,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":181.30271332,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":181.302725238,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.302730243,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":181.302734773,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.302910033,"data":"\n"}
,{"stream_name":"stdout","time":181.520883718,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":181.606966929,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":181.606995788,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.607001721,"data":"  Original dt: 4.798343e-01 s\n"}
,{"stream_name":"stdout","time":181.607006595,"data":"  Corrected dt: 2.998965e-01 s\n"}
,{"stream_name":"stdout","time":181.607011202,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.607015391,"data":"  Max wave speed detected: 16.67 m/s\n"}
,{"stream_name":"stderr","time":181.776573937,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":181.776603182,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":181.776570075,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":181.776915146,"data":"\n"}
,{"stream_name":"stdout","time":181.77692642,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":181.776931009,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":181.776918717,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.66s/s]\n"}
,{"stream_name":"stdout","time":181.778573568,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":181.778900627,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":181.778912026,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.778916637,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":181.778920941,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":181.77905369,"data":"\n"}
,{"stream_name":"stdout","time":181.999343524,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stderr","time":182.292065131,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.292094766,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":182.292148618,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":182.29235429,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.24s/s]\n"}
,{"stream_name":"stdout","time":182.292383993,"data":"\n"}
,{"stream_name":"stdout","time":182.292397514,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":182.292402882,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":182.294226486,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.294564685,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.294593997,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.294598667,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":182.294604272,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":182.294789256,"data":"\n"}
,{"stream_name":"stdout","time":182.488158329,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":182.574849085,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":182.574895301,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.574902696,"data":"  Original dt: 4.544945e-01 s\n"}
,{"stream_name":"stdout","time":182.574906765,"data":"  Corrected dt: 2.840590e-01 s\n"}
,{"stream_name":"stdout","time":182.574910447,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.574914267,"data":"  Max wave speed detected: 17.60 m/s\n"}
,{"stream_name":"stdout","time":182.801907504,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":182.801941647,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":182.8019523,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":182.802214668,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.57s/s]\n"}
,{"stream_name":"stdout","time":182.802234404,"data":"\n"}
,{"stream_name":"stdout","time":182.802241658,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":182.80224613,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":182.804023677,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":182.818482202,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":182.818660312,"data":"\n"}
,{"stream_name":"stdout","time":182.818669344,"data":"✅ Training completed in 0.8 minutes (50.9s)\n"}
,{"stream_name":"stdout","time":182.822061478,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:50 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":182.82207931,"data":"\n"}
,{"stream_name":"stdout","time":182.822083603,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.822087683,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":182.8220915,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.822095478,"data":"\n"}
,{"stream_name":"stdout","time":182.826464722,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":182.826677024,"data":"2025-10-15 18:59:49 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":182.82688809,"data":"2025-10-15 18:59:49 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":182.827130173,"data":"2025-10-15 18:59:49 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 515c5ce5\n"}
,{"stream_name":"stdout","time":182.827377904,"data":"2025-10-15 18:59:49 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_515c5ce5_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":182.827389086,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_515c5ce5_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":182.827623194,"data":"\n"}
,{"stream_name":"stdout","time":182.827633441,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":182.827638452,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":182.827642852,"data":"\n"}
,{"stream_name":"stdout","time":182.827647106,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":182.827697762,"data":"2025-10-15 18:59:49 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.827838017,"data":"2025-10-15 18:59:49 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":182.827906212,"data":"2025-10-15 18:59:49 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":182.828002866,"data":"2025-10-15 18:59:49 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.832461355,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.832541711,"data":"2025-10-15 18:59:49 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.83267073,"data":"2025-10-15 18:59:49 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":182.832802762,"data":"2025-10-15 18:59:49 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":182.832953873,"data":"2025-10-15 18:59:49 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":182.832966562,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":182.832972311,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":182.833137914,"data":"2025-10-15 18:59:49 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":182.833300116,"data":"2025-10-15 18:59:49 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":182.833722639,"data":"2025-10-15 18:59:49 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":182.833776893,"data":"2025-10-15 18:59:49 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":182.833880017,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":182.833900921,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":182.833906122,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":182.833910712,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":182.833961816,"data":"2025-10-15 18:59:49 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":182.834003304,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":182.834010107,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":182.834014578,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":182.834026585,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":182.834147508,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.834274366,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":182.834332858,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.834418994,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":182.834503956,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":182.834572674,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":182.834687071,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":182.834752674,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":182.834953751,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.834966717,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":182.834972126,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":182.835312425,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.835325228,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":182.843447569,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.843465284,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.843470917,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.843475349,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.843492814,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":182.843642312,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":182.843649099,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":182.843664509,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":182.843668651,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":182.843688448,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.843695385,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":182.843699659,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":182.844401514,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":182.844411666,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":182.844747298,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":182.844753532,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":182.844757741,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":182.844761957,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":182.844766277,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":182.844807555,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":182.844813622,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":182.844950864,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":182.84503354,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":182.845082119,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":182.845166572,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":182.845243754,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.845251496,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":182.853349012,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.85336672,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.853371736,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.853376611,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.853381087,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":182.853451261,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":182.853458333,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":182.853463758,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":182.853468411,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":182.853475832,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.853525708,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":182.853538516,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":182.854215262,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":182.854244241,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":182.854516168,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":182.854772104,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.854782721,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.854787548,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":182.856460779,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":182.856476328,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":182.85649845,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":182.857090792,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":182.857337218,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":182.857636029,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":182.857646446,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":182.857735871,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":182.857784175,"data":"\n"}
,{"stream_name":"stdout","time":182.857795147,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":182.857800549,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":182.857805425,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":182.857809523,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":182.857813463,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":182.857817369,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":182.857834866,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":182.857838398,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":182.85784212,"data":"\n"}
,{"stream_name":"stdout","time":182.857905262,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":182.857910895,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":182.85791467,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":182.857918904,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":182.857923074,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":182.85792725,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":182.857931439,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":182.857935902,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":182.857940112,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":182.857955494,"data":"\n"}
,{"stream_name":"stdout","time":182.858012625,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":182.858201478,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":182.858349809,"data":"2025-10-15 18:59:49 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":182.858632639,"data":"2025-10-15 18:59:49 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":182.859317193,"data":"2025-10-15 18:59:49 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":182.859333558,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":182.859558256,"data":"2025-10-15 18:59:49 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":182.859614516,"data":"2025-10-15 18:59:49 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=722901529013054613, last=-2410148979638507267\n"}
,{"stream_name":"stdout","time":182.860164038,"data":"2025-10-15 18:59:49 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":182.865676297,"data":"2025-10-15 18:59:49 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":182.865988162,"data":"2025-10-15 18:59:49 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":182.866021678,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":182.866083493,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":182.866092542,"data":"\n"}
,{"stream_name":"stdout","time":182.866098012,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.866103232,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":182.866129145,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":182.866134743,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":182.866139876,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":182.866144597,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":182.866149484,"data":"\n"}
,{"stream_name":"stdout","time":182.866223381,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":182.874270621,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.874284646,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.874288736,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.874304987,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.875185631,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":182.881594459,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":182.881607286,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":182.885514357,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":182.885531649,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":182.885536718,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.885540899,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":182.885660622,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.885713293,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":182.885827224,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":182.885879447,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":182.885985253,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":182.886046962,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":182.886148056,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.886169875,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":182.88625913,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":182.886548853,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.886556501,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":182.893963022,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.893980772,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.893986217,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.893989994,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.893993572,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":182.894043234,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":182.894056388,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":182.894060804,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":182.894064403,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":182.894092312,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.894096754,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":182.894100364,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":182.894678619,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":182.894694455,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":182.894963054,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":182.894974033,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":182.894978477,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":182.894982097,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":182.894985539,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":182.89498966,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":182.894993147,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":182.895098045,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":182.895189012,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":182.895198359,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":182.895315189,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":182.895324806,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":182.895329467,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":182.902530495,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":182.902544911,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":182.902547986,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":182.902550593,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":182.902592428,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":182.90271834,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":182.902727907,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":182.902732334,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":182.902736495,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":182.902740769,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.90275606,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":182.902762819,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":182.903402501,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":182.903415238,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.125, 5.333333333333333, 0.06, 4.666666666666666]\n"}
,{"stream_name":"stdout","time":182.903647123,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":182.903867734,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.903874378,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.90387837,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":182.905545841,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":182.905783252,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":182.905789973,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":182.905876222,"data":"2025-10-15 18:59:49 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":182.999480948,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.999504559,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.999528169,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":182.999680429,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.99976506,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.999803332,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":182.9999154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":182.999923229,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.999933738,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.4, rho_c=0.0960, w_c=0.3\n"}
,{"stream_name":"stdout","time":182.999938192,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.264670393,"data":"  Stored output at t = 15.0000 s (Step 28)\n"}
,{"stream_name":"stderr","time":183.264841308,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.77s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 56.73s/s]\n"}
,{"stream_name":"stdout","time":183.264862771,"data":"\n"}
,{"stream_name":"stdout","time":183.264884886,"data":"Simulation finished at t = 15.0000 s after 28 steps.\n"}
,{"stream_name":"stdout","time":183.264890003,"data":"Total runtime: 0.26 seconds.\n"}
,{"stream_name":"stdout","time":183.266807655,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.266965927,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.267086036,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.267578936,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.267650502,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.267837383,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.423261e-01, max=9.186702e+00, std=1.166874e+00\n"}
,{"stream_name":"stdout","time":183.268035766,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.122180, rho_c=0.058346\n"}
,{"stream_name":"stdout","time":183.268131393,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=7.355384, w_c=6.159319\n"}
,{"stream_name":"stdout","time":183.268305887,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:887 -   State hash: -8450236761292825907\n"}
,{"stream_name":"stdout","time":183.268359997,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.26858062,"data":"    [RL] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=9.423261e-01\n"}
,{"stream_name":"stdout","time":183.269656267,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.269741312,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.269868768,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":183.269987832,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.270067022,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.270178303,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":183.270239695,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":183.270247505,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.270253193,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":183.270295811,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.481263039,"data":"[PROGRESS] Step 50: t=22.13/30.00s (73.8%) | dt=0.3067s\n"}
,{"stream_name":"stdout","time":183.724169948,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":183.724198847,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.724202878,"data":"  Original dt: 4.663219e-01 s\n"}
,{"stream_name":"stdout","time":183.724205478,"data":"  Corrected dt: 2.914512e-01 s\n"}
,{"stream_name":"stdout","time":183.724208131,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.724210616,"data":"  Max wave speed detected: 17.16 m/s\n"}
,{"stream_name":"stdout","time":183.73295658,"data":"  Stored output at t = 30.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":183.733172214,"data":"\n"}
,{"stream_name":"stderr","time":183.733174742,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.45s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.43s/s]\n"}
,{"stream_name":"stdout","time":183.733189756,"data":"Simulation finished at t = 30.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":183.733235001,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":183.734839352,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":183.734882049,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":183.735077604,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.735451777,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.735488353,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.735635877,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.165084e-01, max=9.358189e+00, std=1.120659e+00\n"}
,{"stream_name":"stdout","time":183.735814234,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.116965, rho_c=0.055366\n"}
,{"stream_name":"stdout","time":183.735883723,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=7.946882, w_c=6.825239\n"}
,{"stream_name":"stdout","time":183.735975332,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:887 -   State hash: 5665729739155219298\n"}
,{"stream_name":"stdout","time":183.736050892,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.736258803,"data":"    [RL] [STEP 2/41] action=1.0000, reward=-0.0100, t=30.0s, state_diff=3.165084e-01\n"}
,{"stream_name":"stdout","time":183.737340521,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.737400812,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.737549852,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":183.73762575,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.737764618,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.737874609,"data":"2025-10-15 18:59:50 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":183.737949579,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":183.737957984,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.737963254,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":183.73796717,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.956480704,"data":"[PROGRESS] Step 100: t=36.65/45.00s (81.4%) | dt=0.2870s\n"}
,{"stream_name":"stdout","time":184.246586863,"data":"  Stored output at t = 45.0000 s (Step 130)\n"}
,{"stream_name":"stderr","time":184.246827682,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.52s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.51s/s]\n"}
,{"stream_name":"stdout","time":184.246838429,"data":"\n"}
,{"stream_name":"stdout","time":184.246854268,"data":"Simulation finished at t = 45.0000 s after 130 steps.\n"}
,{"stream_name":"stdout","time":184.246859216,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":184.24852933,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.248641005,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.24879794,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.249162082,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.249250666,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.249390568,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.594746e-01, max=9.102839e+00, std=1.146491e+00\n"}
,{"stream_name":"stdout","time":184.249570871,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.111707, rho_c=0.052242\n"}
,{"stream_name":"stdout","time":184.249650941,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=8.489833, w_c=7.311284\n"}
,{"stream_name":"stdout","time":184.249779528,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:887 -   State hash: 8944713084272247874\n"}
,{"stream_name":"stdout","time":184.249863719,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.250060961,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=2.594746e-01\n"}
,{"stream_name":"stdout","time":184.251030377,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.251128889,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.251259834,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":184.251339192,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.251414267,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.251527796,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":184.251547626,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":184.251566793,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.251581675,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":184.251593043,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.440803544,"data":"[PROGRESS] Step 150: t=50.69/60.00s (84.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":184.68654662,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":184.686570483,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.686575692,"data":"  Original dt: 4.542037e-01 s\n"}
,{"stream_name":"stdout","time":184.686579648,"data":"  Corrected dt: 2.838773e-01 s\n"}
,{"stream_name":"stdout","time":184.686583743,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.686587488,"data":"  Max wave speed detected: 17.61 m/s\n"}
,{"stream_name":"stdout","time":184.75209279,"data":"  Stored output at t = 60.0000 s (Step 183)\n"}
,{"stream_name":"stderr","time":184.75236332,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.99s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.98s/s]\n"}
,{"stream_name":"stdout","time":184.752366924,"data":"\n"}
,{"stream_name":"stdout","time":184.752386713,"data":"Simulation finished at t = 60.0000 s after 183 steps.\n"}
,{"stream_name":"stdout","time":184.752391701,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":184.753950927,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.754046025,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.754162221,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.754548061,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.754590817,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.754710948,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.517357e-01, max=9.243434e+00, std=1.148654e+00\n"}
,{"stream_name":"stdout","time":184.754876622,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.106447, rho_c=0.049086\n"}
,{"stream_name":"stdout","time":184.754968883,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=9.035101, w_c=7.763366\n"}
,{"stream_name":"stdout","time":184.755089636,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:887 -   State hash: 8703281418514310563\n"}
,{"stream_name":"stdout","time":184.755198745,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.755397309,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=2.517357e-01\n"}
,{"stream_name":"stdout","time":184.756404906,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.75650167,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.756634047,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":184.756724085,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.756859987,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.756950006,"data":"2025-10-15 18:59:51 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":184.757020222,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":184.757030563,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.757035769,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":184.757056651,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.918875952,"data":"[PROGRESS] Step 200: t=64.82/75.00s (86.4%) | dt=0.2838s\n"}
,{"stream_name":"stdout","time":185.263058191,"data":"  Stored output at t = 75.0000 s (Step 236)\n"}
,{"stream_name":"stdout","time":185.2632891,"data":"\n"}
,{"stream_name":"stdout","time":185.263302405,"data":"Simulation finished at t = 75.0000 s after 236 steps.\n"}
,{"stream_name":"stdout","time":185.263306952,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":185.263308601,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.67s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.66s/s]\n"}
,{"stream_name":"stdout","time":185.265028065,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":185.265046397,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.020000\n"}
,{"stream_name":"stdout","time":185.265172735,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.265523932,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.265640887,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.265683932,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.507991e-01, max=9.115961e+00, std=1.149333e+00\n"}
,{"stream_name":"stdout","time":185.265878393,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.101187, rho_c=0.045923\n"}
,{"stream_name":"stdout","time":185.265938438,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=9.581356, w_c=8.208826\n"}
,{"stream_name":"stdout","time":185.266057893,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:887 -   State hash: 7360418821105971408\n"}
,{"stream_name":"stdout","time":185.266163839,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.266365858,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0200, t=75.0s, state_diff=2.507991e-01\n"}
,{"stream_name":"stdout","time":185.267475665,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.267596155,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.26774707,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":185.267861495,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.267986902,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.268069473,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":185.268155189,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":185.26816545,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.268169847,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":185.268173656,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.402061925,"data":"[PROGRESS] Step 250: t=78.97/90.00s (87.7%) | dt=0.2837s\n"}
,{"stream_name":"stdout","time":185.64743074,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":185.6474592,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.647465527,"data":"  Original dt: 4.538465e-01 s\n"}
,{"stream_name":"stdout","time":185.647469921,"data":"  Corrected dt: 2.836541e-01 s\n"}
,{"stream_name":"stdout","time":185.647474322,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.647478689,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":185.76551632,"data":"  Stored output at t = 90.0000 s (Step 289)\n"}
,{"stream_name":"stderr","time":185.765757406,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.18s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.17s/s]\n"}
,{"stream_name":"stdout","time":185.765761822,"data":"\n"}
,{"stream_name":"stdout","time":185.765775477,"data":"Simulation finished at t = 90.0000 s after 289 steps.\n"}
,{"stream_name":"stdout","time":185.765779867,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":185.767613866,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.76767546600001,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.767869797,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.768256044,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.768308734,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.768459693,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.509420e-01, max=9.245561e+00, std=1.149839e+00\n"}
,{"stream_name":"stdout","time":185.768633992,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.095927, rho_c=0.042758\n"}
,{"stream_name":"stdout","time":185.768693359,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=10.127837, w_c=8.653005\n"}
,{"stream_name":"stdout","time":185.768833246,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:887 -   State hash: 6337555429611207620\n"}
,{"stream_name":"stdout","time":185.768888062,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.769103366,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=2.509420e-01\n"}
,{"stream_name":"stdout","time":185.770101303,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.770163908,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.77032868,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":185.770346252,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.770495609,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.770568792,"data":"2025-10-15 18:59:52 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":185.770590662,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":185.770596601,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.770620331,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":185.770700988,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.877838053,"data":"[PROGRESS] Step 300: t=93.12/105.00s (88.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":186.290751395,"data":"  Stored output at t = 105.0000 s (Step 342)\n"}
,{"stream_name":"stderr","time":186.291143064,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.86s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.84s/s]\n"}
,{"stream_name":"stdout","time":186.291176825,"data":"\n"}
,{"stream_name":"stdout","time":186.291182323,"data":"Simulation finished at t = 105.0000 s after 342 steps.\n"}
,{"stream_name":"stdout","time":186.29118668,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":186.292707414,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.292839971,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.292966745,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.293396775,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.293411788,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.293550972,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.512276e-01, max=9.122792e+00, std=1.150213e+00\n"}
,{"stream_name":"stdout","time":186.293718792,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.090667, rho_c=0.039593\n"}
,{"stream_name":"stdout","time":186.293798001,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:883 -     Mean velocities: w_m=10.674372, w_c=9.096939\n"}
,{"stream_name":"stdout","time":186.293926295,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:887 -   State hash: 2180766241741099162\n"}
,{"stream_name":"stdout","time":186.293985519,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.294179138,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.512276e-01\n"}
,{"stream_name":"stdout","time":186.295299575,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.295402023,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.295521065,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":186.295589005,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.295694604,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.295779881,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":186.295842699,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":186.295851268,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.295856623,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":186.295869195,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.372050681,"data":"[PROGRESS] Step 350: t=107.27/120.00s (89.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":186.619308319,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":186.619334446,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.619340998,"data":"  Original dt: 4.538281e-01 s\n"}
,{"stream_name":"stdout","time":186.619345011,"data":"  Corrected dt: 2.836426e-01 s\n"}
,{"stream_name":"stdout","time":186.619361493,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.619364524,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":186.800210835,"data":"  Stored output at t = 120.0000 s (Step 395)\n"}
,{"stream_name":"stderr","time":186.800425641,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.77s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.75s/s]\n"}
,{"stream_name":"stdout","time":186.800435949,"data":"\n"}
,{"stream_name":"stdout","time":186.800451564,"data":"Simulation finished at t = 120.0000 s after 395 steps.\n"}
,{"stream_name":"stdout","time":186.800456735,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":186.802143974,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.802251692,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.802367473,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.80277212,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.802823894,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.802990008,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.514583e-01, max=9.244258e+00, std=1.150482e+00\n"}
,{"stream_name":"stdout","time":186.803177978,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.085406, rho_c=0.036428\n"}
,{"stream_name":"stdout","time":186.803280406,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:883 -     Mean velocities: w_m=11.220919, w_c=9.540828\n"}
,{"stream_name":"stdout","time":186.803405617,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:887 -   State hash: -3776111414798177488\n"}
,{"stream_name":"stdout","time":186.803488351,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.803702684,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=2.514583e-01\n"}
,{"stream_name":"stdout","time":186.804707385,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.804787137,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.804928598,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":186.80502238,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.805156211,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.805253029,"data":"2025-10-15 18:59:53 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":186.805296523,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":186.805314277,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.805327734,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":186.805361905,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.852925651,"data":"[PROGRESS] Step 400: t=121.42/135.00s (89.9%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":187.327916973,"data":"  Stored output at t = 135.0000 s (Step 448)\n"}
,{"stream_name":"stderr","time":187.328098103,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 28.73s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 28.72s/s]\n"}
,{"stream_name":"stdout","time":187.328166957,"data":"\n"}
,{"stream_name":"stdout","time":187.328172836,"data":"Simulation finished at t = 135.0000 s after 448 steps.\n"}
,{"stream_name":"stdout","time":187.328176849,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":187.329812188,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.329906873,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.32998765,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.330382987,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.330460756,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.330571545,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.516393e-01, max=9.128442e+00, std=1.150666e+00\n"}
,{"stream_name":"stdout","time":187.330754451,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.080146, rho_c=0.033263\n"}
,{"stream_name":"stdout","time":187.330887105,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:883 -     Mean velocities: w_m=11.767469, w_c=9.984707\n"}
,{"stream_name":"stdout","time":187.330972699,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:887 -   State hash: -4547060572206764093\n"}
,{"stream_name":"stdout","time":187.331049778,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.331248639,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=2.516393e-01\n"}
,{"stream_name":"stdout","time":187.332247815,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.33234242,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.332451529,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":187.332568286,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.332648285,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.332776025,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":187.332802352,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":187.33280676,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.332817235,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":187.332883581,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.352541814,"data":"[PROGRESS] Step 450: t=135.57/150.00s (90.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":187.601028734,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":187.601054664,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.601059867,"data":"  Original dt: 4.538269e-01 s\n"}
,{"stream_name":"stdout","time":187.601063863,"data":"  Corrected dt: 2.836418e-01 s\n"}
,{"stream_name":"stdout","time":187.601067613,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.601071463,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":187.82373369,"data":"[PROGRESS] Step 500: t=149.75/150.00s (99.8%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":187.833337551,"data":"  Stored output at t = 150.0000 s (Step 501)\n"}
,{"stream_name":"stdout","time":187.833461458,"data":"\n"}
,{"stream_name":"stdout","time":187.833475699,"data":"Simulation finished at t = 150.0000 s after 501 steps.\n"}
,{"stream_name":"stdout","time":187.833480894,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":187.833489324,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 30.00s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 29.99s/s]\n"}
,{"stream_name":"stdout","time":187.835271944,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.835292029,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=    0.01\n"}
,{"stream_name":"stdout","time":187.835297155,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.8354307,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.835785374,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.835884542,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.836030539,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.517641e-01, max=9.242102e+00, std=1.150794e+00\n"}
,{"stream_name":"stdout","time":187.836220472,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.074886, rho_c=0.030097\n"}
,{"stream_name":"stdout","time":187.836363324,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:883 -     Mean velocities: w_m=12.314021, w_c=10.428584\n"}
,{"stream_name":"stdout","time":187.836417357,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:887 -   State hash: -9182797397909336125\n"}
,{"stream_name":"stdout","time":187.836543166,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.836738185,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=2.517641e-01\n"}
,{"stream_name":"stdout","time":187.837822736,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.837955774,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.838083922,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":187.838192506,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.838335511,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.838453067,"data":"2025-10-15 18:59:54 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":187.838474375,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":187.838480086,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.838501268,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":187.838526591,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.30913314,"data":"[PROGRESS] Step 550: t=163.90/165.00s (99.3%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":188.34820065,"data":"  Stored output at t = 165.0000 s (Step 554)\n"}
,{"stream_name":"stdout","time":188.348455382,"data":"\n"}
,{"stream_name":"stderr","time":188.348456131,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 29.45s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 29.44s/s]\n"}
,{"stream_name":"stdout","time":188.348464998,"data":"Simulation finished at t = 165.0000 s after 554 steps.\n"}
,{"stream_name":"stdout","time":188.348473104,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":188.350141637,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.350272406,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.350416709,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.350795695,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.350838903,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.350974306,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.518777e-01, max=9.134140e+00, std=1.150876e+00\n"}
,{"stream_name":"stdout","time":188.351144632,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.069627, rho_c=0.026931\n"}
,{"stream_name":"stdout","time":188.351247977,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:883 -     Mean velocities: w_m=12.860571, w_c=10.872457\n"}
,{"stream_name":"stdout","time":188.351357671,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:887 -   State hash: -5705632541120988535\n"}
,{"stream_name":"stdout","time":188.35143325,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.351645014,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=2.518777e-01\n"}
,{"stream_name":"stdout","time":188.352629663,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.35276701,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.352869931,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":188.353011248,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.353133921,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.35321856,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":188.353268487,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":188.353278437,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.353283475,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":188.353289905,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.560896133,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":188.560925962,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.560931667,"data":"  Original dt: 4.538266e-01 s\n"}
,{"stream_name":"stdout","time":188.560935993,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":188.560949615,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.560953676,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":188.785899208,"data":"[PROGRESS] Step 600: t=178.05/180.00s (98.9%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":188.85343883,"data":"  Stored output at t = 180.0000 s (Step 607)\n"}
,{"stream_name":"stdout","time":188.853586323,"data":"\n"}
,{"stream_name":"stderr","time":188.853594469,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.02s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.00s/s]\n"}
,{"stream_name":"stdout","time":188.853599989,"data":"Simulation finished at t = 180.0000 s after 607 steps.\n"}
,{"stream_name":"stdout","time":188.853624919,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":188.855144487,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.855267789,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.855393965,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.855753778,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.855805672,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.855928313,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.519104e-01, max=9.239906e+00, std=1.150943e+00\n"}
,{"stream_name":"stdout","time":188.856141189,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.064375, rho_c=0.023759\n"}
,{"stream_name":"stdout","time":188.856274612,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:883 -     Mean velocities: w_m=13.407110, w_c=11.316305\n"}
,{"stream_name":"stdout","time":188.856377306,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:887 -   State hash: -2977365450325852975\n"}
,{"stream_name":"stdout","time":188.856497006,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.856667818,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=2.519104e-01\n"}
,{"stream_name":"stdout","time":188.857784279,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.857799255,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.857978177,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":188.857990488,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.858120597,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.858227891,"data":"2025-10-15 18:59:55 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":188.858307701,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":188.858319484,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.858325162,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":188.858342331,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.273891323,"data":"[PROGRESS] Step 650: t=192.20/195.00s (98.6%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":189.375872654,"data":"  Stored output at t = 195.0000 s (Step 660)\n"}
,{"stream_name":"stdout","time":189.376181117,"data":"\n"}
,{"stream_name":"stdout","time":189.376208799,"data":"Simulation finished at t = 195.0000 s after 660 steps.\n"}
,{"stream_name":"stdout","time":189.376214051,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":189.376176839,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 29.00s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 28.99s/s]\n"}
,{"stream_name":"stdout","time":189.377869477,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.378019995,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.378293499,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.378675485,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.378755311,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.378872012,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.519969e-01, max=9.140230e+00, std=1.150965e+00\n"}
,{"stream_name":"stdout","time":189.379046383,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.059131, rho_c=0.020579\n"}
,{"stream_name":"stdout","time":189.379133907,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:883 -     Mean velocities: w_m=13.953642, w_c=11.760101\n"}
,{"stream_name":"stdout","time":189.379261944,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:887 -   State hash: -6421689744609885356\n"}
,{"stream_name":"stdout","time":189.37932751,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.379524915,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=2.519969e-01\n"}
,{"stream_name":"stdout","time":189.380526501,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.380622994,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.380761737,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":189.380845357,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.380914507,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.381029686,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":189.381072262,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":189.38109115,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.381095846,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":189.381100159,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.546939882,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":189.546967533,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.546973916,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":189.546978376,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":189.546982112,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.546985872,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":189.775974604,"data":"[PROGRESS] Step 700: t=206.35/210.00s (98.3%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":189.903828757,"data":"  Stored output at t = 210.0000 s (Step 713)\n"}
,{"stream_name":"stdout","time":189.904175932,"data":"\n"}
,{"stream_name":"stderr","time":189.904190355,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 28.72s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 28.70s/s]\n"}
,{"stream_name":"stdout","time":189.904194397,"data":"Simulation finished at t = 210.0000 s after 713 steps.\n"}
,{"stream_name":"stdout","time":189.904216169,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":189.906156644,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.906278399,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.906428238,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.906878149,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.906901658,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.907130757,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.519692e-01, max=9.235638e+00, std=1.151000e+00\n"}
,{"stream_name":"stdout","time":189.907410764,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.053824, rho_c=0.017453\n"}
,{"stream_name":"stdout","time":189.907522652,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:883 -     Mean velocities: w_m=14.500288, w_c=12.204068\n"}
,{"stream_name":"stdout","time":189.907637577,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:887 -   State hash: -1602545586083505279\n"}
,{"stream_name":"stdout","time":189.907759232,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.908048057,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=2.519692e-01\n"}
,{"stream_name":"stdout","time":189.909148291,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.909270088,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.90941104,"data":"2025-10-15 18:59:56 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":189.909548514,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.909661363,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.909819025,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":189.909864919,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":189.909872448,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.909877981,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":189.909884894,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.289228641,"data":"[PROGRESS] Step 750: t=220.49/225.00s (98.0%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":190.440848798,"data":"  Stored output at t = 225.0000 s (Step 766)\n"}
,{"stream_name":"stdout","time":190.44116486,"data":"\n"}
,{"stream_name":"stdout","time":190.441184238,"data":"Simulation finished at t = 225.0000 s after 766 steps.\n"}
,{"stream_name":"stdout","time":190.441204865,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":190.441165018,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 28.28s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 28.26s/s]\n"}
,{"stream_name":"stdout","time":190.442903142,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.44302185,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.443170664,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.443555757,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.443663282,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.443802916,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.522049e-01, max=9.140611e+00, std=1.151223e+00\n"}
,{"stream_name":"stdout","time":190.443995451,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.048324, rho_c=0.014494\n"}
,{"stream_name":"stdout","time":190.444071249,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.047181, w_c=12.648817\n"}
,{"stream_name":"stdout","time":190.444233288,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:887 -   State hash: -8848210731237596277\n"}
,{"stream_name":"stdout","time":190.444353356,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.444550375,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=2.522049e-01\n"}
,{"stream_name":"stdout","time":190.445653877,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.445774939,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.445905114,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":190.446007101,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.446124844,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.446239349,"data":"2025-10-15 18:59:57 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":190.446301209,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":190.44630771,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.446313035,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":190.446350291,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.552073711,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":190.552101339,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.552132244,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":190.55213721,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":190.552141399,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.552147428,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":190.814943621,"data":"[PROGRESS] Step 800: t=234.64/240.00s (97.8%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":191.002988199,"data":"  Stored output at t = 240.0000 s (Step 819)\n"}
,{"stream_name":"stderr","time":191.003058201,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 26.97s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 26.96s/s]\n"}
,{"stream_name":"stdout","time":191.003143591,"data":"\n"}
,{"stream_name":"stdout","time":191.003156428,"data":"Simulation finished at t = 240.0000 s after 819 steps.\n"}
,{"stream_name":"stdout","time":191.003160494,"data":"Total runtime: 0.56 seconds.\n"}
,{"stream_name":"stdout","time":191.004792595,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.004943522,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.005048295,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.005441728,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.005556774,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.005654638,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.569436e-01, max=9.300519e+00, std=1.152789e+00\n"}
,{"stream_name":"stdout","time":191.005862662,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.042586, rho_c=0.011729\n"}
,{"stream_name":"stdout","time":191.005943428,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.594420, w_c=13.095032\n"}
,{"stream_name":"stdout","time":191.006052382,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:887 -   State hash: 2898564057196171145\n"}
,{"stream_name":"stdout","time":191.006150849,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.006365053,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=2.569436e-01\n"}
,{"stream_name":"stdout","time":191.007460768,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.007578842,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.007721241,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":191.007824591,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.007916966,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.008076875,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":191.008084597,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":191.008089656,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.008094499,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":191.008152042,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.309672521,"data":"[PROGRESS] Step 850: t=248.79/255.00s (97.6%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":191.515272097,"data":"  Stored output at t = 255.0000 s (Step 872)\n"}
,{"stream_name":"stdout","time":191.515447578,"data":"\n"}
,{"stream_name":"stderr","time":191.515448614,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 29.60s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 29.59s/s]\n"}
,{"stream_name":"stdout","time":191.515457453,"data":"Simulation finished at t = 255.0000 s after 872 steps.\n"}
,{"stream_name":"stdout","time":191.515465684,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":191.517053228,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.517187797,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.517361199,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.517744628,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.51787341,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.517974532,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.726213e-01, max=9.851823e+00, std=1.149252e+00\n"}
,{"stream_name":"stdout","time":191.518181393,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036267, rho_c=0.008853\n"}
,{"stream_name":"stdout","time":191.518310486,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.162410, w_c=13.554808\n"}
,{"stream_name":"stdout","time":191.518399791,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:887 -   State hash: 7052939221835637706\n"}
,{"stream_name":"stdout","time":191.51853117,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.518773084,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=2.726213e-01\n"}
,{"stream_name":"stdout","time":191.519747456,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.519868263,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.520008423,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":191.520152878,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.520229859,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.52031491,"data":"2025-10-15 18:59:58 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":191.520368864,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":191.520374764,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.520394283,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":191.520431725,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.559020827,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":191.559041281,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.559046932,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":191.559051146,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":191.5590552,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.559072067,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":191.783867676,"data":"[PROGRESS] Step 900: t=262.94/270.00s (97.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":192.014903381,"data":"  Stored output at t = 270.0000 s (Step 925)\n"}
,{"stream_name":"stdout","time":192.015082327,"data":"\n"}
,{"stream_name":"stdout","time":192.01509344,"data":"Simulation finished at t = 270.0000 s after 925 steps.\n"}
,{"stream_name":"stdout","time":192.015102054,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":192.015150836,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.36s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.35s/s]\n"}
,{"stream_name":"stdout","time":192.01689642,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.016974973,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.017155278,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.017544329,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.017566101,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.017739018,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.544684e-01, max=1.032834e+01, std=1.111710e+00\n"}
,{"stream_name":"stdout","time":192.017953141,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029959, rho_c=0.006302\n"}
,{"stream_name":"stdout","time":192.018021123,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.719968, w_c=14.006264\n"}
,{"stream_name":"stdout","time":192.018179091,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:887 -   State hash: 3251043462964396561\n"}
,{"stream_name":"stdout","time":192.01830428,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.018582896,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=2.544684e-01\n"}
,{"stream_name":"stdout","time":192.019555297,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.019631563,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.019826595,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":192.019837179,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.019961783,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.020066576,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":192.020099595,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":192.020118809,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.020129084,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":192.020134289,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.262156171,"data":"[PROGRESS] Step 950: t=277.09/285.00s (97.2%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":192.509690635,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":192.509734576,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.509741103,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":192.50974512,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":192.509748755,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.509752416,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":192.528524944,"data":"  Stored output at t = 285.0000 s (Step 978)\n"}
,{"stream_name":"stderr","time":192.528615838,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 29.53s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 29.52s/s]\n"}
,{"stream_name":"stdout","time":192.528633737,"data":"\n"}
,{"stream_name":"stdout","time":192.528643033,"data":"Simulation finished at t = 285.0000 s after 978 steps.\n"}
,{"stream_name":"stdout","time":192.528660571,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":192.530394606,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.530412446,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.5304522,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.530854929,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.530882973,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.531074926,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.021380e-01, max=8.582096e+00, std=1.011640e+00\n"}
,{"stream_name":"stdout","time":192.531271888,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026951, rho_c=0.004889\n"}
,{"stream_name":"stdout","time":192.531334848,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.139428, w_c=14.390935\n"}
,{"stream_name":"stdout","time":192.53146136,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:887 -   State hash: 4176875015655505635\n"}
,{"stream_name":"stdout","time":192.531546473,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.53174328,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=2.021380e-01\n"}
,{"stream_name":"stdout","time":192.532736977,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.53284787,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.532974702,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":192.533035427,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.53315997,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.53323163,"data":"2025-10-15 18:59:59 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":192.533287957,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":192.533294344,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.533300027,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":192.533329912,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.734882598,"data":"[PROGRESS] Step 1000: t=291.24/300.00s (97.1%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":193.026311532,"data":"  Stored output at t = 300.0000 s (Step 1031)\n"}
,{"stream_name":"stderr","time":193.026463112,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.45s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.44s/s]\n"}
,{"stream_name":"stdout","time":193.026482621,"data":"\n"}
,{"stream_name":"stdout","time":193.026491037,"data":"Simulation finished at t = 300.0000 s after 1031 steps.\n"}
,{"stream_name":"stdout","time":193.026496223,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":193.028284424,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.028301428,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=    0.01\n"}
,{"stream_name":"stdout","time":193.02843597,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.02856255,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.028939874,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.029036489,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.029173169,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.482568e-02, max=1.866318e+00, std=2.020253e-01\n"}
,{"stream_name":"stdout","time":193.029378072,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026874, rho_c=0.004858\n"}
,{"stream_name":"stdout","time":193.029470309,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.179381, w_c=14.490176\n"}
,{"stream_name":"stdout","time":193.029596303,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:887 -   State hash: -2289235491750285745\n"}
,{"stream_name":"stdout","time":193.029687241,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.029898362,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=3.482568e-02\n"}
,{"stream_name":"stdout","time":193.030909806,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.030941118,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.031066908,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":193.031207055,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.03131327,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.031396199,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":193.03144789,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":193.031456463,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.031461635,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":193.031484299,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.214917893,"data":"[PROGRESS] Step 1050: t=305.39/315.00s (96.9%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":193.463958217,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":193.463987102,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.463993214,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":193.463997915,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":193.464001712,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.464006087,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":193.536503945,"data":"  Stored output at t = 315.0000 s (Step 1084)\n"}
,{"stream_name":"stdout","time":193.536530373,"data":"\n"}
,{"stream_name":"stdout","time":193.536535662,"data":"Simulation finished at t = 315.0000 s after 1084 steps.\n"}
,{"stream_name":"stdout","time":193.536540208,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":193.53651622,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 29.73s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 29.72s/s]\n"}
,{"stream_name":"stdout","time":193.538165085,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.538243796,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.538458401,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.538824052,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.53884611,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.538999643,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.400452e-03, max=3.080072e-01, std=2.970349e-02\n"}
,{"stream_name":"stdout","time":193.539161262,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004854\n"}
,{"stream_name":"stdout","time":193.539288021,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181429, w_c=14.505722\n"}
,{"stream_name":"stdout","time":193.539380466,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:887 -   State hash: 38763976604940670\n"}
,{"stream_name":"stdout","time":193.539484364,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.53968923,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=4.400452e-03\n"}
,{"stream_name":"stdout","time":193.540796296,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.540862606,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.54097329,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":193.541083981,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.541137926,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.541263574,"data":"2025-10-15 19:00:00 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":193.541291101,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":193.54129705,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.541309881,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":193.541342084,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.70813898,"data":"[PROGRESS] Step 1100: t=319.54/330.00s (96.8%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":194.077605646,"data":"  Stored output at t = 330.0000 s (Step 1137)\n"}
,{"stream_name":"stderr","time":194.077808439,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 27.99s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 27.98s/s]\n"}
,{"stream_name":"stdout","time":194.077810293,"data":"\n"}
,{"stream_name":"stdout","time":194.077844266,"data":"Simulation finished at t = 330.0000 s after 1137 steps.\n"}
,{"stream_name":"stdout","time":194.07784977,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":194.07952569,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.079622154,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.079748154,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.080154799,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.08024496,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.0803807,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.079642e-04, max=4.557739e-02, std=4.350220e-03\n"}
,{"stream_name":"stdout","time":194.080559025,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":194.080624224,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181577, w_c=14.508005\n"}
,{"stream_name":"stdout","time":194.080828267,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:887 -   State hash: -3695706085909934836\n"}
,{"stream_name":"stdout","time":194.080855842,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.081082206,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=6.079642e-04\n"}
,{"stream_name":"stdout","time":194.082057277,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.082147247,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.08229922,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":194.082430086,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.082500501,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.08258664,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":194.082634997,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":194.082641552,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.082676684,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":194.08268549,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.208594176,"data":"[PROGRESS] Step 1150: t=333.69/345.00s (96.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":194.473095849,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":194.47314559,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.473152264,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":194.473157857,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":194.473161966,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.473165829,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":194.607231941,"data":"  Stored output at t = 345.0000 s (Step 1190)\n"}
,{"stream_name":"stdout","time":194.607479049,"data":"\n"}
,{"stream_name":"stderr","time":194.607479069,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 28.62s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 28.61s/s]\n"}
,{"stream_name":"stdout","time":194.607492261,"data":"Simulation finished at t = 345.0000 s after 1190 steps.\n"}
,{"stream_name":"stdout","time":194.607500461,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":194.609296379,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.609391017,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.609524413,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.60987170800001,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.609910874,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.610169364,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.701222e-05, max=6.659915e-03, std=6.339998e-04\n"}
,{"stream_name":"stdout","time":194.610393752,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":194.610498249,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181594, w_c=14.508337\n"}
,{"stream_name":"stdout","time":194.610591203,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:887 -   State hash: 80213982614673626\n"}
,{"stream_name":"stdout","time":194.610677993,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.610919579,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=8.701222e-05\n"}
,{"stream_name":"stdout","time":194.611859872,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.611910724,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.612041979,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":194.612172909,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.612259369,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.612341353,"data":"2025-10-15 19:00:01 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":194.612409064,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":194.612414974,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.612419734,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":194.612424474,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.706169465,"data":"[PROGRESS] Step 1200: t=347.84/360.00s (96.6%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":195.131301301,"data":"  Stored output at t = 360.0000 s (Step 1243)\n"}
,{"stream_name":"stdout","time":195.131599047,"data":"\n"}
,{"stream_name":"stdout","time":195.131614485,"data":"Simulation finished at t = 360.0000 s after 1243 steps.\n"}
,{"stream_name":"stdout","time":195.131619658,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":195.131619637,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 28.93s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 28.92s/s]\n"}
,{"stream_name":"stdout","time":195.133644546,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.133666008,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.133791338,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.134168048,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.134343565,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.134475734,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.252912e-05, max=9.686283e-04, std=9.189389e-05\n"}
,{"stream_name":"stdout","time":195.134652278,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":195.134762804,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508385\n"}
,{"stream_name":"stdout","time":195.134892499,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:887 -   State hash: 6771606842137436230\n"}
,{"stream_name":"stdout","time":195.135011582,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.135252676,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=1.252912e-05\n"}
,{"stream_name":"stdout","time":195.136255016,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.136316999,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.136465703,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":195.136568266,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.136656201,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.136800685,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":195.136859082,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":195.136865743,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.136871166,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":195.136875726,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.207084701,"data":"[PROGRESS] Step 1250: t=361.99/375.00s (96.5%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":195.467381932,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":195.467408303,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.46741344,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":195.467419225,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":195.467423654,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.467428129,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":195.660416783,"data":"  Stored output at t = 375.0000 s (Step 1296)\n"}
,{"stream_name":"stdout","time":195.660468783,"data":"\n"}
,{"stream_name":"stdout","time":195.660477244,"data":"Simulation finished at t = 375.0000 s after 1296 steps.\n"}
,{"stream_name":"stdout","time":195.660481916,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":195.660491246,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 28.68s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 28.67s/s]\n"}
,{"stream_name":"stdout","time":195.662151138,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.662167563,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.662203047,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.662686631,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.662698765,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.662834666,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.798332e-06, max=1.395992e-04, std=1.320942e-05\n"}
,{"stream_name":"stdout","time":195.663034987,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":195.663099261,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508392\n"}
,{"stream_name":"stdout","time":195.663276199,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:887 -   State hash: 5865042698938517211\n"}
,{"stream_name":"stdout","time":195.663361381,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.663584194,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=1.798332e-06\n"}
,{"stream_name":"stdout","time":195.664617193,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.664682493,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.664841624,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":195.66493049,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.665019181,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.665152857,"data":"2025-10-15 19:00:02 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":195.665172087,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":195.665176391,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.665250037,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":195.665262085,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.704180003,"data":"[PROGRESS] Step 1300: t=376.13/390.00s (96.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":196.192264783,"data":"  Stored output at t = 390.0000 s (Step 1349)\n"}
,{"stream_name":"stderr","time":196.1926003,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 28.48s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 28.47s/s]\n"}
,{"stream_name":"stdout","time":196.192615803,"data":"\n"}
,{"stream_name":"stdout","time":196.192632324,"data":"Simulation finished at t = 390.0000 s after 1349 steps.\n"}
,{"stream_name":"stdout","time":196.192637775,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":196.194471757,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.194627592,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.194816501,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.19518706,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.195307754,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.195444536,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.573881e-07, max=1.996130e-05, std=1.887462e-06\n"}
,{"stream_name":"stdout","time":196.195657856,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":196.195795768,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":196.195873886,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:887 -   State hash: 1649021683755545075\n"}
,{"stream_name":"stdout","time":196.196023447,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.196226384,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=2.573881e-07\n"}
,{"stream_name":"stdout","time":196.19725023,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.197374783,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.197549983,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":196.197561873,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.197709298,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.19783037,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":196.197919625,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":196.197927345,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.197941381,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":196.197945642,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.209021921,"data":"[PROGRESS] Step 1350: t=390.28/405.00s (96.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":196.468407223,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":196.468436494,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.468442794,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":196.468447033,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":196.46845157,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.468457539,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":196.704695588,"data":"[PROGRESS] Step 1400: t=404.47/405.00s (99.9%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":196.724072272,"data":"  Stored output at t = 405.0000 s (Step 1402)\n"}
,{"stream_name":"stderr","time":196.724510215,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 28.53s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 28.52s/s]\n"}
,{"stream_name":"stdout","time":196.724536987,"data":"\n"}
,{"stream_name":"stdout","time":196.724556196,"data":"Simulation finished at t = 405.0000 s after 1402 steps.\n"}
,{"stream_name":"stdout","time":196.724561101,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":196.726219656,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.726346949,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.726497331,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.726968591,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.727068074,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.727203985,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.685327e-08, max=2.845965e-06, std=2.693519e-07\n"}
,{"stream_name":"stdout","time":196.727406399,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":196.72752807,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":196.727637254,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:887 -   State hash: 2966552620183736019\n"}
,{"stream_name":"stdout","time":196.727750038,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.727991378,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=3.685327e-08\n"}
,{"stream_name":"stdout","time":196.729017023,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.729121135,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.729262386,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":196.729348901,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.729427575,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.729520967,"data":"2025-10-15 19:00:03 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":196.729574406,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":196.72959321,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.729611635,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":196.729616077,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.201173203,"data":"[PROGRESS] Step 1450: t=418.61/420.00s (99.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":197.250805157,"data":"  Stored output at t = 420.0000 s (Step 1455)\n"}
,{"stream_name":"stdout","time":197.251023463,"data":"\n"}
,{"stream_name":"stdout","time":197.251034623,"data":"Simulation finished at t = 420.0000 s after 1455 steps.\n"}
,{"stream_name":"stderr","time":197.251029196,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 28.80s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 28.79s/s]\n"}
,{"stream_name":"stdout","time":197.251039216,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":197.252910141,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.253019333,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.253156385,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.25359512,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.253689058,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.25382957,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.292872e-09, max=4.064782e-07, std=3.854035e-08\n"}
,{"stream_name":"stdout","time":197.254030788,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":197.254140961,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":197.254266653,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:887 -   State hash: -8278689154733527640\n"}
,{"stream_name":"stdout","time":197.254354091,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.254554763,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=5.292872e-09\n"}
,{"stream_name":"stdout","time":197.255599294,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.255798659,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.255829486,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":197.255921576,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.256017337,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.256152824,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":197.256201486,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":197.256208066,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.256213232,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":197.256235166,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.457059948,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":197.457087443,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.457093466,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":197.457097816,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":197.45710193,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.457125224,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":197.697973268,"data":"[PROGRESS] Step 1500: t=432.76/435.00s (99.5%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":197.784570274,"data":"  Stored output at t = 435.0000 s (Step 1508)\n"}
,{"stream_name":"stdout","time":197.784827448,"data":"\n"}
,{"stream_name":"stdout","time":197.78484595,"data":"Simulation finished at t = 435.0000 s after 1508 steps.\n"}
,{"stream_name":"stdout","time":197.7848516,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":197.784848904,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 28.41s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 28.40s/s]\n"}
,{"stream_name":"stdout","time":197.786618155,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.786799449,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.786902023,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.787406558,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.787482383,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.787650461,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.633734e-10, max=5.831271e-08, std=5.540047e-09\n"}
,{"stream_name":"stdout","time":197.787858799,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":197.788017848,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":197.788153765,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:887 -   State hash: 7163296428372007661\n"}
,{"stream_name":"stdout","time":197.788274022,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.788505759,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=7.633734e-10\n"}
,{"stream_name":"stdout","time":197.789626478,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.789750586,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.789912911,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":197.790004518,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.790156803,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.790308879,"data":"2025-10-15 19:00:04 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":197.790363833,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":197.790372123,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.790381894,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":197.790438033,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.220490817,"data":"[PROGRESS] Step 1550: t=446.91/450.00s (99.3%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":198.327666271,"data":"  Stored output at t = 450.0000 s (Step 1561)\n"}
,{"stream_name":"stdout","time":198.327886325,"data":"\n"}
,{"stream_name":"stdout","time":198.327906795,"data":"Simulation finished at t = 450.0000 s after 1561 steps.\n"}
,{"stream_name":"stdout","time":198.327913854,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stderr","time":198.327908634,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 27.95s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 27.93s/s]\n"}
,{"stream_name":"stdout","time":198.329647878,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.329665762,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=    0.01\n"}
,{"stream_name":"stdout","time":198.329802289,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.329919017,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.330343442,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.330438543,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.330552341,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.105553e-10, max=8.408177e-09, std=8.002430e-10\n"}
,{"stream_name":"stdout","time":198.330718375,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":198.330832907,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":198.330916649,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:887 -   State hash: -5088038584273326586\n"}
,{"stream_name":"stdout","time":198.331004088,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.33122079,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=1.105553e-10\n"}
,{"stream_name":"stdout","time":198.332204414,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.332292416,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.332425546,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":198.332533902,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.332610622,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.332742961,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":198.332750304,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":198.332755472,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.332762695,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":198.332822645,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.476096936,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":198.47614202,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.476148362,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":198.476152682,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":198.476156352,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.47615995,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":198.704603374,"data":"[PROGRESS] Step 1600: t=461.06/465.00s (99.2%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":198.83636308,"data":"  Stored output at t = 465.0000 s (Step 1614)\n"}
,{"stream_name":"stderr","time":198.836565967,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 29.81s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 29.80s/s]\n"}
,{"stream_name":"stdout","time":198.836593767,"data":"\n"}
,{"stream_name":"stdout","time":198.836605224,"data":"Simulation finished at t = 465.0000 s after 1614 steps.\n"}
,{"stream_name":"stdout","time":198.836609696,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":198.838174615,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.838257236,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.83843309,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.838839127,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.838890359,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.839069673,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.606587e-11, max=1.217924e-09, std=1.160742e-10\n"}
,{"stream_name":"stdout","time":198.83929663,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":198.839346136,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":198.839478979,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:887 -   State hash: 4873972459911682966\n"}
,{"stream_name":"stdout","time":198.839533757,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.83970810900001,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=1.606587e-11\n"}
,{"stream_name":"stdout","time":198.840655633,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.840801332,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.840909742,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":198.84096732,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.841103703,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.841185718,"data":"2025-10-15 19:00:05 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":198.841242422,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":198.841248721,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.84125379,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":198.841276442,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.188938558,"data":"[PROGRESS] Step 1650: t=475.21/480.00s (99.0%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":199.356216237,"data":"  Stored output at t = 480.0000 s (Step 1667)\n"}
,{"stream_name":"stdout","time":199.356470069,"data":"\n"}
,{"stream_name":"stdout","time":199.356482678,"data":"Simulation finished at t = 480.0000 s after 1667 steps.\n"}
,{"stream_name":"stdout","time":199.356487349,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":199.35649187,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 29.15s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 29.14s/s]\n"}
,{"stream_name":"stdout","time":199.358215581,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.358369823,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.358499075,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.358937184,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.358999573,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.359164967,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.340930e-12, max=1.770495e-10, std=1.689021e-11\n"}
,{"stream_name":"stdout","time":199.359383752,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":199.359452986,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":199.35955946,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:887 -   State hash: 731011255954268156\n"}
,{"stream_name":"stdout","time":199.359647684,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.359883118,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=2.340930e-12\n"}
,{"stream_name":"stdout","time":199.360836256,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.360909507,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.361035861,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":199.361084948,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.36119646,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.361307866,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":199.361329349,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":199.361334773,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.361340278,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":199.361347605,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.450917986,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":199.450954396,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":199.450959902,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":199.450963718,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":199.450967656,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":199.450971323,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":199.679207299,"data":"[PROGRESS] Step 1700: t=489.36/495.00s (98.9%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":199.867277121,"data":"  Stored output at t = 495.0000 s (Step 1720)\n"}
,{"stream_name":"stdout","time":199.86753674,"data":"\n"}
,{"stream_name":"stderr","time":199.867539786,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 29.67s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 29.66s/s]\n"}
,{"stream_name":"stdout","time":199.867545917,"data":"Simulation finished at t = 495.0000 s after 1720 steps.\n"}
,{"stream_name":"stdout","time":199.867553831,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":199.869307615,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.869455961,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.869588504,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.869960813,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.870046313,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.870182525,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.414805e-13, max=2.579625e-11, std=2.462568e-12\n"}
,{"stream_name":"stdout","time":199.87036093,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":199.870440198,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":199.870528151,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:887 -   State hash: -6919228290082761808\n"}
,{"stream_name":"stdout","time":199.870615721,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.870802941,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=3.414805e-13\n"}
,{"stream_name":"stdout","time":199.871794743,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.871922233,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.872018697,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":199.872144747,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.872260999,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.872340973,"data":"2025-10-15 19:00:06 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":199.872393889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":199.87240251,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.872407448,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":199.872412523,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.171214373,"data":"[PROGRESS] Step 1750: t=503.51/510.00s (98.7%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":200.398450786,"data":"  Stored output at t = 510.0000 s (Step 1773)\n"}
,{"stream_name":"stdout","time":200.398677112,"data":"\n"}
,{"stream_name":"stderr","time":200.398672676,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 28.54s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 28.53s/s]\n"}
,{"stream_name":"stdout","time":200.398705582,"data":"Simulation finished at t = 510.0000 s after 1773 steps.\n"}
,{"stream_name":"stdout","time":200.398715897,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":200.400693587,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.400731613,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.400821115,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.401235005,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.401361621,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.401473321,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.974527e-14, max=3.765876e-12, std=3.596467e-13\n"}
,{"stream_name":"stdout","time":200.401677366,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":200.401773006,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":200.401910197,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:887 -   State hash: 89315603297154568\n"}
,{"stream_name":"stdout","time":200.402002249,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.402201154,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=4.974527e-14\n"}
,{"stream_name":"stdout","time":200.403194418,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.40329812,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.403418487,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":200.403548032,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.403627453,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.403764438,"data":"2025-10-15 19:00:07 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":200.403770787,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":200.403774952,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.40378627,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":200.403798419,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":200.434604748,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":200.434623138,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":200.434629033,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":200.434638119,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":200.434642795,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":200.43464757,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":200.667658678,"data":"[PROGRESS] Step 1800: t=517.66/525.00s (98.6%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":200.943957699,"data":"  Stored output at t = 525.0000 s (Step 1826)\n"}
,{"stream_name":"stdout","time":200.944185968,"data":"\n"}
,{"stream_name":"stderr","time":200.944190529,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 27.79s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 27.78s/s]\n"}
,{"stream_name":"stdout","time":200.944199928,"data":"Simulation finished at t = 525.0000 s after 1826 steps.\n"}
,{"stream_name":"stdout","time":200.944209066,"data":"Total runtime: 0.54 seconds.\n"}
,{"stream_name":"stdout","time":200.945845205,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":200.945962535,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":200.94608483,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":200.946454387,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":200.946569247,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":200.946684946,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.210253e-15, max=5.506706e-13, std=5.230083e-14\n"}
,{"stream_name":"stdout","time":200.946953767,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":200.947022748,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":200.947169397,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:887 -   State hash: -1515551605167722428\n"}
,{"stream_name":"stdout","time":200.947286247,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.947474652,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=7.210253e-15\n"}
,{"stream_name":"stdout","time":200.94856153,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":200.948689322,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":200.948834805,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":200.948945881,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":200.949048487,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":200.949159541,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":200.949245822,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":200.949256248,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":200.949261834,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":200.949266214,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.191173065,"data":"[PROGRESS] Step 1850: t=531.81/540.00s (98.5%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":201.443937168,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":201.443964824,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":201.443970073,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":201.443974273,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":201.443979674,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":201.443982883,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":201.472181393,"data":"  Stored output at t = 540.0000 s (Step 1879)\n"}
,{"stream_name":"stdout","time":201.472380977,"data":"\n"}
,{"stream_name":"stdout","time":201.472394625,"data":"Simulation finished at t = 540.0000 s after 1879 steps.\n"}
,{"stream_name":"stdout","time":201.472399967,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":201.472403455,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 28.71s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 28.70s/s]\n"}
,{"stream_name":"stdout","time":201.474134774,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":201.474262667,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":201.474365912,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":201.474720765,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":201.474821655,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":201.474924594,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.144839e-15, max=7.993606e-14, std=7.865043e-15\n"}
,{"stream_name":"stdout","time":201.47513255,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":201.475264873,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":201.475341514,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:887 -   State hash: -6373784780891760046\n"}
,{"stream_name":"stdout","time":201.475427754,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.475631129,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=1.144839e-15\n"}
,{"stream_name":"stdout","time":201.476666055,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":201.476786025,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":201.476916539,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":201.47699164,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":201.477102894,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":201.477205838,"data":"2025-10-15 19:00:08 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":201.477293771,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":201.477305414,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":201.477310611,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":201.477314959,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":201.683214239,"data":"[PROGRESS] Step 1900: t=545.96/555.00s (98.4%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":202.023088335,"data":"  Stored output at t = 555.0000 s (Step 1932)\n"}
,{"stream_name":"stdout","time":202.023294934,"data":"\n"}
,{"stream_name":"stdout","time":202.023315019,"data":"Simulation finished at t = 555.0000 s after 1932 steps.\n"}
,{"stream_name":"stdout","time":202.023320595,"data":"Total runtime: 0.55 seconds.\n"}
,{"stream_name":"stderr","time":202.02332734,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 27.51s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 27.50s/s]\n"}
,{"stream_name":"stdout","time":202.025092941,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.025214372,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.025402368,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.025777519,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.025890815,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.02610168,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.922687e-16, max=1.598721e-14, std=1.513833e-15\n"}
,{"stream_name":"stdout","time":202.026275925,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":202.026359193,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":202.026475535,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:887 -   State hash: 3899498357892111577\n"}
,{"stream_name":"stdout","time":202.02657006,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.026814405,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=1.922687e-16\n"}
,{"stream_name":"stdout","time":202.027871078,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.028020458,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.028097468,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":202.028249398,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.028356835,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.028480831,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":202.028489759,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":202.028495066,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.028532809,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":202.028557177,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.203132494,"data":"[PROGRESS] Step 1950: t=560.11/570.00s (98.3%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":202.460731409,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":202.460756881,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":202.460762751,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":202.460766992,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":202.460771246,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":202.460775359,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":202.547546977,"data":"  Stored output at t = 570.0000 s (Step 1985)\n"}
,{"stream_name":"stdout","time":202.547862132,"data":"\n"}
,{"stream_name":"stderr","time":202.547861488,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 28.92s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 28.91s/s]\n"}
,{"stream_name":"stdout","time":202.547872102,"data":"Simulation finished at t = 570.0000 s after 1985 steps.\n"}
,{"stream_name":"stdout","time":202.547881005,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":202.549741876,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":202.549771751,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":202.549930706,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":202.550437982,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":202.550540879,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":202.550641628,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.576656e-17, max=7.105427e-15, std=5.268246e-16\n"}
,{"stream_name":"stdout","time":202.55086456,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":202.550922512,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":202.551035323,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:887 -   State hash: 4985251868012488507\n"}
,{"stream_name":"stdout","time":202.551122807,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.55133796,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=5.576656e-17\n"}
,{"stream_name":"stdout","time":202.552307034,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":202.552382268,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":202.552525745,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":202.552593124,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":202.552701747,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":202.552795814,"data":"2025-10-15 19:00:09 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":202.552822051,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":202.552826494,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":202.552837471,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":202.552908954,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":202.694176802,"data":"[PROGRESS] Step 2000: t=574.25/585.00s (98.2%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":203.061835755,"data":"  Stored output at t = 585.0000 s (Step 2038)\n"}
,{"stream_name":"stderr","time":203.061998575,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 29.50s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 29.49s/s]\n"}
,{"stream_name":"stdout","time":203.062028835,"data":"\n"}
,{"stream_name":"stdout","time":203.06203667,"data":"Simulation finished at t = 585.0000 s after 2038 steps.\n"}
,{"stream_name":"stdout","time":203.062040704,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":203.063724674,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.063744069,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.063792834,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":203.064156552,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.064184607,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.064334385,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.901773e-17, max=5.329071e-15, std=3.972044e-16\n"}
,{"stream_name":"stdout","time":203.064534447,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":203.06462741,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":203.064736316,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:887 -   State hash: -3095213976375883694\n"}
,{"stream_name":"stdout","time":203.064831041,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.065051593,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=3.901773e-17\n"}
,{"stream_name":"stdout","time":203.066021493,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":203.066101247,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.06625174,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":203.066298523,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":203.066405479,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":203.066489095,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":203.066536078,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.7407407407407407, 0.096, 0.6481481481481481]\n"}
,{"stream_name":"stdout","time":203.066541983,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":203.06654624,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.7, rho_c=0.0960, w_c=0.6\n"}
,{"stream_name":"stdout","time":203.066551617,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":203.185897015,"data":"[PROGRESS] Step 2050: t=588.40/600.00s (98.1%) | dt=0.2836s\n"}
,{"stream_name":"stdout","time":203.442310572,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":203.442338052,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":203.442343341,"data":"  Original dt: 4.538265e-01 s\n"}
,{"stream_name":"stdout","time":203.442347076,"data":"  Corrected dt: 2.836416e-01 s\n"}
,{"stream_name":"stdout","time":203.442350707,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":203.442354376,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":203.583678262,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 29.04s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 29.03s/s]\n"}
,{"stream_name":"stdout","time":203.583701039,"data":"  Stored output at t = 600.0000 s (Step 2091)\n"}
,{"stream_name":"stdout","time":203.583738417,"data":"\n"}
,{"stream_name":"stdout","time":203.583744385,"data":"Simulation finished at t = 600.0000 s after 2091 steps.\n"}
,{"stream_name":"stdout","time":203.583749517,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":203.585504062,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":203.585523428,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=    0.01\n"}
,{"stream_name":"stdout","time":203.585529352,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":203.585533717,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":203.585691432,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":203.586065833,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":203.586167265,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":203.586326936,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.627627e-17, max=5.329071e-15, std=3.248201e-16\n"}
,{"stream_name":"stdout","time":203.58650771,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026870, rho_c=0.004853\n"}
,{"stream_name":"stdout","time":203.586594511,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.181596, w_c=14.508393\n"}
,{"stream_name":"stdout","time":203.586715711,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:887 -   State hash: -1795261609485468797\n"}
,{"stream_name":"stdout","time":203.587014286,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":203.587212963,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=2.627627e-17\n"}
,{"stream_name":"stdout","time":203.587269356,"data":"\n"}
,{"stream_name":"stdout","time":203.587274789,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":203.587279147,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":203.587282778,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":203.587286437,"data":"    - Total reward: 0.01\n"}
,{"stream_name":"stdout","time":203.587290056,"data":"    - Avg step time: 0.517s (device=gpu)\n"}
,{"stream_name":"stdout","time":203.587293666,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":203.587297324,"data":"    - Wallclock time: 20.7s\n"}
,{"stream_name":"stdout","time":203.587300873,"data":"    - Speed ratio: 29.02x real-time\n"}
,{"stream_name":"stdout","time":203.587304515,"data":"\n"}
,{"stream_name":"stdout","time":203.587421578,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":203.587426845,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":203.587430518,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":203.587434038,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":203.587437506,"data":"    - Total reward: 0.01\n"}
,{"stream_name":"stdout","time":203.587440949,"data":"    - Avg step time: 0.517s (device=gpu)\n"}
,{"stream_name":"stdout","time":203.587444477,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":203.587448019,"data":"    - Wallclock time: 20.7s\n"}
,{"stream_name":"stdout","time":203.587451515,"data":"    - Speed ratio: 29.02x real-time\n"}
,{"stream_name":"stdout","time":203.58745573,"data":"\n"}
,{"stream_name":"stdout","time":203.587540401,"data":"2025-10-15 19:00:10 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":203.587884326,"data":"\n"}
,{"stream_name":"stdout","time":203.587894916,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.587899616,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":203.5879194,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.587923869,"data":"\n"}
,{"stream_name":"stdout","time":203.588039661,"data":"2025-10-15 19:00:10 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":203.588088741,"data":"2025-10-15 19:00:10 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-8450236761292825907, last=-1795261609485468797\n"}
,{"stream_name":"stdout","time":203.588642659,"data":"2025-10-15 19:00:10 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12116422 0.12260441 0.12365734 0.12430561 0.12466706], w_m[10:15]=[7.28335681 7.27859072 7.27441404 7.27215462 7.27099872]\n"}
,{"stream_name":"stdout","time":203.593596474,"data":"2025-10-15 19:00:10 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02245411 0.02245049 0.02244905 0.02244846 0.0224482 ], w_m[10:15]=[17.70334276 17.70616789 17.70728436 17.70773958 17.70793165]\n"}
,{"stream_name":"stdout","time":203.593649002,"data":"2025-10-15 19:00:10 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.262967, efficiency=4.522075, delay=-174.04s\n"}
,{"stream_name":"stdout","time":203.59382502,"data":"2025-10-15 19:00:10 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":203.59384743,"data":"2025-10-15 19:00:10 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 28.262966687772366, 'avg_speed': 859.2211561360048, 'avg_density': 0.060128354877257054, 'efficiency': 4.522074670043578, 'delay': -174.0368915421376, 'throughput': 141314.83343886182}\n"}
,{"stream_name":"stdout","time":203.593995325,"data":"2025-10-15 19:00:10 - INFO - run_performance_comparison:1430 - Flow improvement: -0.096%\n"}
,{"stream_name":"stdout","time":203.594052372,"data":"2025-10-15 19:00:10 - INFO - run_performance_comparison:1431 - Efficiency improvement: -0.096%\n"}
,{"stream_name":"stdout","time":203.594145531,"data":"2025-10-15 19:00:10 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":203.594237313,"data":"  Flow improvement: -0.1%\n"}
,{"stream_name":"stdout","time":203.594246689,"data":"  Efficiency improvement: -0.1%\n"}
,{"stream_name":"stdout","time":203.594251137,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":203.594254969,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":203.59480158,"data":"\n"}
,{"stream_name":"stdout","time":203.594811478,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":204.194366858,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":204.756868994,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":204.756899269,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":204.756904262,"data":"\n"}
,{"stream_name":"stdout","time":204.756907914,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":204.766077714,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":204.766095494,"data":"\n"}
,{"stream_name":"stdout","time":204.766129252,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":204.766307914,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":204.766315281,"data":"\n"}
,{"stream_name":"stdout","time":204.766325306,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":204.766329189,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":204.76633287,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":204.766337279,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":204.766341785,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":204.766346515,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":204.767368845,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":207.510557321,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":207.510786847,"data":"\n"}
,{"stream_name":"stdout","time":207.510800969,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":207.511035958,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":207.515165601,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":207.516307428,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":207.516399439,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":207.516527999,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":207.516573433,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":207.516659944,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":207.516735393,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":207.51681023,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":207.516867652,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":207.51699683,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":207.582856555,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":207.582958019,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":207.583446758,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":207.583532423,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":207.583642435,"data":"\n"}
,{"stream_name":"stdout","time":207.583650411,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":207.583663212,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":207.583827259,"data":"\n"}
,{"stream_name":"stdout","time":207.583833634,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":207.583838308,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":207.583842645,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":207.583847115,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":211.288531974,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":211.288584989,"data":"  warn(\n"}
,{"stream_name":"stderr","time":211.332813977,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":212.096493282,"data":"[NbConvertApp] Writing 322230 bytes to __results__.html\n"}
]