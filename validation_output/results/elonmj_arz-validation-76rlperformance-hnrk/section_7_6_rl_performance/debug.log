2025-10-09 13:50:12 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-09 13:50:12 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-09 13:50:12 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-09 13:50:12 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-09 13:50:12 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-09 13:50:12 - INFO - train_rl_agent:513 - ================================================================================
2025-10-09 13:50:12 - INFO - train_rl_agent:514 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-09 13:50:12 - INFO - train_rl_agent:515 -   - Device: gpu
2025-10-09 13:50:12 - INFO - train_rl_agent:516 -   - Total timesteps: 100
2025-10-09 13:50:12 - INFO - train_rl_agent:517 -   - Episode max time: 120.0s
2025-10-09 13:50:12 - INFO - train_rl_agent:518 -   - Checkpoint frequency: 50
2025-10-09 13:50:12 - INFO - train_rl_agent:519 - ================================================================================
2025-10-09 13:50:12 - INFO - _create_scenario_config:172 - Created scenario config: traffic_light_control.yml
2025-10-09 13:50:12 - INFO - _create_scenario_config:173 -   Initial densities: rho_m=0.0450 veh/m, rho_c=0.0500 veh/m
2025-10-09 13:50:12 - INFO - _create_scenario_config:174 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 13:51:51 - INFO - run_performance_comparison:650 - ================================================================================
2025-10-09 13:51:51 - INFO - run_performance_comparison:651 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 13:51:51 - INFO - run_performance_comparison:652 - Device: gpu
2025-10-09 13:51:51 - INFO - run_performance_comparison:653 - ================================================================================
2025-10-09 13:51:51 - INFO - run_performance_comparison:654 - ================================================================================
2025-10-09 13:51:51 - INFO - run_performance_comparison:655 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 13:51:51 - INFO - run_performance_comparison:656 - Device: gpu
2025-10-09 13:51:51 - INFO - run_performance_comparison:657 - ================================================================================
2025-10-09 13:51:51 - INFO - _create_scenario_config:172 - Created scenario config: traffic_light_control.yml
2025-10-09 13:51:51 - INFO - _create_scenario_config:173 -   Initial densities: rho_m=0.0450 veh/m, rho_c=0.0500 veh/m
2025-10-09 13:51:51 - INFO - _create_scenario_config:174 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 13:51:51 - INFO - run_control_simulation:253 - ================================================================================
2025-10-09 13:51:51 - INFO - run_control_simulation:254 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 13:51:51 - INFO - run_control_simulation:255 - Starting run_control_simulation:
2025-10-09 13:51:51 - INFO - run_control_simulation:256 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 13:51:51 - INFO - run_control_simulation:257 -   - duration: 600.0s
2025-10-09 13:51:51 - INFO - run_control_simulation:258 -   - control_interval: 60.0s
2025-10-09 13:51:51 - INFO - run_control_simulation:259 -   - device: gpu
2025-10-09 13:51:51 - INFO - run_control_simulation:260 -   - controller: BaselineController
2025-10-09 13:51:51 - INFO - run_control_simulation:261 - ================================================================================
2025-10-09 13:51:51 - INFO - run_control_simulation:266 - Creating TrafficSignalEnvDirect instance...
2025-10-09 13:51:51 - INFO - run_control_simulation:276 - TrafficSignalEnvDirect created successfully
2025-10-09 13:51:51 - INFO - run_control_simulation:292 - Calling env.reset()...
2025-10-09 13:51:51 - INFO - run_control_simulation:294 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 13:51:51 - INFO - run_control_simulation:298 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 13:51:51 - INFO - run_control_simulation:299 - INITIAL STATE statistics: mean=9.024506e+00, std=9.077720e+00, min=4.500000e-05, max=1.943759e+01
2025-10-09 13:51:51 - INFO - run_control_simulation:315 - Starting simulation loop - max 10 steps
2025-10-09 13:51:51 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:51 - INFO - run_control_simulation:330 - STEP 0 START:
2025-10-09 13:51:51 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:51 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:51 - INFO - run_control_simulation:333 -   Simulation time: 0.00s
2025-10-09 13:51:52 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:52 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:52 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:52 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:52 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:52 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:52 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:52 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:52 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:52 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:52 - INFO - run_control_simulation:330 - STEP 1 START:
2025-10-09 13:51:52 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:52 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:52 - INFO - run_control_simulation:333 -   Simulation time: 60.00s
2025-10-09 13:51:52 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:52 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:52 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:52 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:52 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:52 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:52 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:52 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:52 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:52 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:52 - INFO - run_control_simulation:330 - STEP 2 START:
2025-10-09 13:51:52 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:52 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:52 - INFO - run_control_simulation:333 -   Simulation time: 120.00s
2025-10-09 13:51:53 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:53 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:53 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:53 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:53 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:53 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:53 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:53 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:53 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:53 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:53 - INFO - run_control_simulation:330 - STEP 3 START:
2025-10-09 13:51:53 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:53 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:53 - INFO - run_control_simulation:333 -   Simulation time: 180.00s
2025-10-09 13:51:54 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:54 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:54 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:54 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:54 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:54 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:54 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:54 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:54 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:54 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:54 - INFO - run_control_simulation:330 - STEP 4 START:
2025-10-09 13:51:54 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:54 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:54 - INFO - run_control_simulation:333 -   Simulation time: 240.00s
2025-10-09 13:51:55 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:55 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:55 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:55 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:55 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:55 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:55 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:55 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:55 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:55 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:55 - INFO - run_control_simulation:330 - STEP 5 START:
2025-10-09 13:51:55 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:55 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:55 - INFO - run_control_simulation:333 -   Simulation time: 300.00s
2025-10-09 13:51:56 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:56 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:56 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:56 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:56 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:56 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:56 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:56 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:56 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:56 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:56 - INFO - run_control_simulation:330 - STEP 6 START:
2025-10-09 13:51:56 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:56 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:56 - INFO - run_control_simulation:333 -   Simulation time: 360.00s
2025-10-09 13:51:57 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:57 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:57 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:57 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:57 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:57 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:57 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:57 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:57 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:57 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:57 - INFO - run_control_simulation:330 - STEP 7 START:
2025-10-09 13:51:57 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:57 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:57 - INFO - run_control_simulation:333 -   Simulation time: 420.00s
2025-10-09 13:51:58 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:58 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:58 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:58 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:58 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:58 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:58 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:58 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:58 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:58 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:58 - INFO - run_control_simulation:330 - STEP 8 START:
2025-10-09 13:51:58 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:58 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:58 - INFO - run_control_simulation:333 -   Simulation time: 480.00s
2025-10-09 13:51:59 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:51:59 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:51:59 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:51:59 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:51:59 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:51:59 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:51:59 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:51:59 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:51:59 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:51:59 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:51:59 - INFO - run_control_simulation:330 - STEP 9 START:
2025-10-09 13:51:59 - INFO - run_control_simulation:331 -   Controller: BaselineController
2025-10-09 13:51:59 - INFO - run_control_simulation:332 -   Action: 1.000000
2025-10-09 13:51:59 - INFO - run_control_simulation:333 -   Simulation time: 540.00s
2025-10-09 13:52:00 - INFO - run_control_simulation:345 -   Reward: -0.024667
2025-10-09 13:52:00 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: True
2025-10-09 13:52:00 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:00 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:00 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:00 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:00 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:00 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:00 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:00 - INFO - run_control_simulation:413 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: -0.25
    - Avg step time: 0.915s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 9.1s
    - Speed ratio: 65.60x real-time

2025-10-09 13:52:00 - INFO - run_control_simulation:414 - Returning 10 state snapshots
2025-10-09 13:52:00 - INFO - evaluate_traffic_performance:425 - Evaluating performance with 10 state snapshots
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 0: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - INFO - evaluate_traffic_performance:433 - First state sample - rho_m[10:15]=[4.5e-05 4.5e-05 4.5e-05 4.5e-05 4.5e-05], w_m[10:15]=[19.43759498 19.43759498 19.43759498 19.43759498 19.43759498]
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 1: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 2: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 3: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 4: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 5: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 6: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 7: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 8: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - DEBUG - evaluate_traffic_performance:430 - State 9: shape=(4, 204), dtype=float64
2025-10-09 13:52:00 - INFO - evaluate_traffic_performance:487 - Calculated metrics: flow=36.097929, efficiency=5.775669, delay=-179.84s
2025-10-09 13:52:00 - INFO - run_control_simulation:253 - ================================================================================
2025-10-09 13:52:00 - INFO - run_control_simulation:254 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 13:52:00 - INFO - run_control_simulation:255 - Starting run_control_simulation:
2025-10-09 13:52:00 - INFO - run_control_simulation:256 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 13:52:00 - INFO - run_control_simulation:257 -   - duration: 600.0s
2025-10-09 13:52:00 - INFO - run_control_simulation:258 -   - control_interval: 60.0s
2025-10-09 13:52:00 - INFO - run_control_simulation:259 -   - device: gpu
2025-10-09 13:52:00 - INFO - run_control_simulation:260 -   - controller: RLController
2025-10-09 13:52:00 - INFO - run_control_simulation:261 - ================================================================================
2025-10-09 13:52:00 - INFO - run_control_simulation:266 - Creating TrafficSignalEnvDirect instance...
2025-10-09 13:52:00 - INFO - run_control_simulation:276 - TrafficSignalEnvDirect created successfully
2025-10-09 13:52:00 - INFO - run_control_simulation:292 - Calling env.reset()...
2025-10-09 13:52:00 - INFO - run_control_simulation:294 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 13:52:00 - INFO - run_control_simulation:298 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 13:52:00 - INFO - run_control_simulation:299 - INITIAL STATE statistics: mean=9.024506e+00, std=9.077720e+00, min=4.500000e-05, max=1.943759e+01
2025-10-09 13:52:00 - INFO - run_control_simulation:315 - Starting simulation loop - max 10 steps
2025-10-09 13:52:00 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:00 - INFO - run_control_simulation:330 - STEP 0 START:
2025-10-09 13:52:00 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:00 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:00 - INFO - run_control_simulation:333 -   Simulation time: 0.00s
2025-10-09 13:52:01 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:01 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:01 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:01 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:01 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:01 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:01 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:01 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:01 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:01 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:01 - INFO - run_control_simulation:330 - STEP 1 START:
2025-10-09 13:52:01 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:01 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:01 - INFO - run_control_simulation:333 -   Simulation time: 60.00s
2025-10-09 13:52:02 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:02 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:02 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:02 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:02 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:02 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:02 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:02 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:02 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:02 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:02 - INFO - run_control_simulation:330 - STEP 2 START:
2025-10-09 13:52:02 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:02 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:02 - INFO - run_control_simulation:333 -   Simulation time: 120.00s
2025-10-09 13:52:03 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:03 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:03 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:03 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:03 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:03 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:03 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:03 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:03 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:03 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:03 - INFO - run_control_simulation:330 - STEP 3 START:
2025-10-09 13:52:03 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:03 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:03 - INFO - run_control_simulation:333 -   Simulation time: 180.00s
2025-10-09 13:52:03 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:03 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:03 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:03 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:03 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:03 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:03 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:03 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:03 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:03 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:03 - INFO - run_control_simulation:330 - STEP 4 START:
2025-10-09 13:52:03 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:03 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:03 - INFO - run_control_simulation:333 -   Simulation time: 240.00s
2025-10-09 13:52:04 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:04 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:04 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:04 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:04 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:04 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:04 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:04 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:04 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:04 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:04 - INFO - run_control_simulation:330 - STEP 5 START:
2025-10-09 13:52:04 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:04 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:04 - INFO - run_control_simulation:333 -   Simulation time: 300.00s
2025-10-09 13:52:05 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:05 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:05 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:05 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:05 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:05 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:05 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:05 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:05 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:05 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:05 - INFO - run_control_simulation:330 - STEP 6 START:
2025-10-09 13:52:05 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:05 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:05 - INFO - run_control_simulation:333 -   Simulation time: 360.00s
2025-10-09 13:52:06 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:06 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:06 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:06 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:06 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:06 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:06 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:06 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:06 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:06 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:06 - INFO - run_control_simulation:330 - STEP 7 START:
2025-10-09 13:52:06 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:06 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:06 - INFO - run_control_simulation:333 -   Simulation time: 420.00s
2025-10-09 13:52:07 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:07 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:07 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:07 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:07 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:07 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:07 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:07 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:07 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:07 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:07 - INFO - run_control_simulation:330 - STEP 8 START:
2025-10-09 13:52:07 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:07 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:07 - INFO - run_control_simulation:333 -   Simulation time: 480.00s
2025-10-09 13:52:08 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:08 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: False
2025-10-09 13:52:08 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:08 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:08 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:08 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:08 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:08 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:08 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:08 - INFO - run_control_simulation:329 - ================================================================================
2025-10-09 13:52:08 - INFO - run_control_simulation:330 - STEP 9 START:
2025-10-09 13:52:08 - INFO - run_control_simulation:331 -   Controller: RLController
2025-10-09 13:52:08 - INFO - run_control_simulation:332 -   Action: 0.000000
2025-10-09 13:52:08 - INFO - run_control_simulation:333 -   Simulation time: 540.00s
2025-10-09 13:52:09 - INFO - run_control_simulation:345 -   Reward: 0.075333
2025-10-09 13:52:09 - INFO - run_control_simulation:346 -   Terminated: False, Truncated: True
2025-10-09 13:52:09 - INFO - run_control_simulation:362 -   STATE EVOLUTION:
2025-10-09 13:52:09 - INFO - run_control_simulation:363 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 13:52:09 - INFO - run_control_simulation:364 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-09 13:52:09 - INFO - run_control_simulation:374 -     Mean densities: rho_m=0.000045, rho_c=0.000050
2025-10-09 13:52:09 - INFO - run_control_simulation:375 -     Mean velocities: w_m=19.437595, w_c=16.660334
2025-10-09 13:52:09 - INFO - run_control_simulation:379 -   State hash: 699348316847863851
2025-10-09 13:52:09 - INFO - run_control_simulation:381 - ================================================================================
2025-10-09 13:52:09 - INFO - run_control_simulation:413 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: 0.75
    - Avg step time: 0.870s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 8.7s
    - Speed ratio: 68.95x real-time

2025-10-09 13:52:09 - INFO - run_control_simulation:414 - Returning 10 state snapshots
2025-10-09 13:52:09 - INFO - evaluate_traffic_performance:425 - Evaluating performance with 10 state snapshots
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 0: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - INFO - evaluate_traffic_performance:433 - First state sample - rho_m[10:15]=[4.5e-05 4.5e-05 4.5e-05 4.5e-05 4.5e-05], w_m[10:15]=[19.43759498 19.43759498 19.43759498 19.43759498 19.43759498]
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 1: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 2: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 3: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 4: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 5: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 6: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 7: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 8: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - DEBUG - evaluate_traffic_performance:430 - State 9: shape=(4, 204), dtype=float64
2025-10-09 13:52:09 - INFO - evaluate_traffic_performance:487 - Calculated metrics: flow=36.097929, efficiency=5.775669, delay=-179.84s
2025-10-09 13:52:09 - WARNING - run_performance_comparison:708 - States comparison - Identical: True, baseline_hash=699348316847863851, rl_hash=699348316847863851
2025-10-09 13:52:09 - INFO - run_performance_comparison:711 - Baseline performance: {'total_flow': 36.09792891381675, 'avg_speed': 379978.19909280783, 'avg_density': 9.5e-05, 'efficiency': 5.77566862621068, 'delay': -179.84295645825446, 'throughput': 180489.64456908376}
2025-10-09 13:52:09 - INFO - run_performance_comparison:712 - RL performance: {'total_flow': 36.09792891381675, 'avg_speed': 379978.19909280783, 'avg_density': 9.5e-05, 'efficiency': 5.77566862621068, 'delay': -179.84295645825446, 'throughput': 180489.64456908376}
2025-10-09 13:52:09 - INFO - run_performance_comparison:720 - Flow improvement: 0.000%
2025-10-09 13:52:09 - INFO - run_performance_comparison:721 - Efficiency improvement: 0.000%
2025-10-09 13:52:09 - INFO - run_performance_comparison:722 - Delay reduction: -0.000%
