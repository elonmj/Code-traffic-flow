2025-10-11 08:01:09 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-11 08:01:09 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-11 08:01:09 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-11 08:01:09 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-11 08:01:09 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-11 08:01:10 - INFO - train_rl_agent:580 - ================================================================================
2025-10-11 08:01:10 - INFO - train_rl_agent:581 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-11 08:01:10 - INFO - train_rl_agent:582 -   - Device: gpu
2025-10-11 08:01:10 - INFO - train_rl_agent:583 -   - Total timesteps: 100
2025-10-11 08:01:10 - INFO - train_rl_agent:584 -   - Episode max time: 120.0s
2025-10-11 08:01:10 - INFO - train_rl_agent:585 -   - Checkpoint frequency: 50
2025-10-11 08:01:10 - INFO - train_rl_agent:586 - ================================================================================
2025-10-11 08:01:10 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
2025-10-11 08:01:10 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-11 08:01:10 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
2025-10-11 08:01:10 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
2025-10-11 08:01:10 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
2025-10-11 08:04:56 - INFO - run_performance_comparison:718 - ================================================================================
2025-10-11 08:04:56 - INFO - run_performance_comparison:719 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-11 08:04:56 - INFO - run_performance_comparison:720 - Device: gpu
2025-10-11 08:04:56 - INFO - run_performance_comparison:721 - ================================================================================
2025-10-11 08:04:56 - INFO - run_performance_comparison:722 - ================================================================================
2025-10-11 08:04:56 - INFO - run_performance_comparison:723 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-11 08:04:56 - INFO - run_performance_comparison:724 - Device: gpu
2025-10-11 08:04:56 - INFO - run_performance_comparison:725 - ================================================================================
2025-10-11 08:04:56 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
2025-10-11 08:04:56 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
2025-10-11 08:04:56 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
2025-10-11 08:04:56 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
2025-10-11 08:04:56 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
2025-10-11 08:04:56 - INFO - run_control_simulation:298 - ================================================================================
2025-10-11 08:04:56 - INFO - run_control_simulation:299 - Starting run_control_simulation:
2025-10-11 08:04:56 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-11 08:04:56 - INFO - run_control_simulation:301 -   - duration: 600.0s
2025-10-11 08:04:56 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
2025-10-11 08:04:56 - INFO - run_control_simulation:303 -   - device: gpu
2025-10-11 08:04:56 - INFO - run_control_simulation:304 -   - controller: BaselineController
2025-10-11 08:04:56 - INFO - run_control_simulation:305 -   - max_control_steps: 11
2025-10-11 08:04:56 - INFO - run_control_simulation:306 - ================================================================================
2025-10-11 08:04:56 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
2025-10-11 08:04:56 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
2025-10-11 08:04:56 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
2025-10-11 08:04:56 - INFO - run_control_simulation:343 - Calling env.reset()...
2025-10-11 08:04:56 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-11 08:04:56 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-11 08:04:56 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.906150e+00, std=6.996354e+00, min=1.200000e-04, max=1.500000e+01
2025-10-11 08:04:56 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
2025-10-11 08:04:56 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:04:56 - INFO - run_control_simulation:381 - STEP 0 START:
2025-10-11 08:04:56 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:04:56 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 08:04:56 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
2025-10-11 08:04:59 - INFO - run_control_simulation:396 -   Reward: -0.090339
2025-10-11 08:04:59 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:04:59 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:04:59 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:04:59 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.493036e+00, max=1.277778e+01, std=1.949885e+00
2025-10-11 08:04:59 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.009817, rho_c=0.018391
2025-10-11 08:04:59 - INFO - run_control_simulation:426 -     Mean velocities: w_m=17.132964, w_c=14.278037
2025-10-11 08:04:59 - INFO - run_control_simulation:430 -   State hash: 7233457399854534813
2025-10-11 08:04:59 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:04:59 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:04:59 - INFO - run_control_simulation:381 - STEP 1 START:
2025-10-11 08:04:59 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:04:59 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:04:59 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
2025-10-11 08:05:01 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:01 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:01 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:01 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:01 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.148430e+00, max=7.500000e+00, std=2.126971e+00
2025-10-11 08:05:01 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:01 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130606, w_c=16.309175
2025-10-11 08:05:01 - INFO - run_control_simulation:430 -   State hash: 617382081176525097
2025-10-11 08:05:01 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:01 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:01 - INFO - run_control_simulation:381 - STEP 2 START:
2025-10-11 08:05:01 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:01 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 08:05:01 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
2025-10-11 08:05:03 - INFO - run_control_simulation:396 -   Reward: -0.090339
2025-10-11 08:05:03 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:03 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:03 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:03 - INFO - run_control_simulation:415 -     Diff statistics: mean=7.159265e-02, max=7.500000e+00, std=6.846686e-01
2025-10-11 08:05:03 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:03 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.275200, w_c=16.450951
2025-10-11 08:05:03 - INFO - run_control_simulation:430 -   State hash: 6185321297768348732
2025-10-11 08:05:03 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:03 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:03 - INFO - run_control_simulation:381 - STEP 3 START:
2025-10-11 08:05:03 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:03 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:03 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
2025-10-11 08:05:05 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:05 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:05 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:05 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:05 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.731348e-02, max=7.500000e+00, std=6.848552e-01
2025-10-11 08:05:05 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:05 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:05 - INFO - run_control_simulation:430 -   State hash: 4994012744349796249
2025-10-11 08:05:05 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:05 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:05 - INFO - run_control_simulation:381 - STEP 4 START:
2025-10-11 08:05:05 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:05 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 08:05:05 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
2025-10-11 08:05:07 - INFO - run_control_simulation:396 -   Reward: -0.090339
2025-10-11 08:05:07 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:07 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:07 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:07 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730770e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:07 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:07 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.275200, w_c=16.450974
2025-10-11 08:05:07 - INFO - run_control_simulation:430 -   State hash: 1910210895940754197
2025-10-11 08:05:07 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:07 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:07 - INFO - run_control_simulation:381 - STEP 5 START:
2025-10-11 08:05:07 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:07 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:07 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
2025-10-11 08:05:09 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:09 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:09 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:09 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:09 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730769e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:09 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:09 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:09 - INFO - run_control_simulation:430 -   State hash: -1974179515474722373
2025-10-11 08:05:09 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:09 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:09 - INFO - run_control_simulation:381 - STEP 6 START:
2025-10-11 08:05:09 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:09 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 08:05:09 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
2025-10-11 08:05:12 - INFO - run_control_simulation:396 -   Reward: -0.090339
2025-10-11 08:05:12 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:12 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:12 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:12 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730769e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:12 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:12 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.275200, w_c=16.450974
2025-10-11 08:05:12 - INFO - run_control_simulation:430 -   State hash: 7202360424796895722
2025-10-11 08:05:12 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:12 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:12 - INFO - run_control_simulation:381 - STEP 7 START:
2025-10-11 08:05:12 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:12 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:12 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
2025-10-11 08:05:14 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:14 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:14 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:14 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:14 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730769e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:14 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:14 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:14 - INFO - run_control_simulation:430 -   State hash: 7753725482633448421
2025-10-11 08:05:14 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:14 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:14 - INFO - run_control_simulation:381 - STEP 8 START:
2025-10-11 08:05:14 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:14 - INFO - run_control_simulation:383 -   Action: 1.000000
2025-10-11 08:05:14 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
2025-10-11 08:05:16 - INFO - run_control_simulation:396 -   Reward: -0.090339
2025-10-11 08:05:16 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:16 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:16 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:16 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730769e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:16 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:16 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.275200, w_c=16.450974
2025-10-11 08:05:16 - INFO - run_control_simulation:430 -   State hash: 9066391114304239830
2025-10-11 08:05:16 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:16 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:16 - INFO - run_control_simulation:381 - STEP 9 START:
2025-10-11 08:05:16 - INFO - run_control_simulation:382 -   Controller: BaselineController
2025-10-11 08:05:16 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:16 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
2025-10-11 08:05:18 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:18 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
2025-10-11 08:05:18 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:18 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:18 - INFO - run_control_simulation:415 -     Diff statistics: mean=6.730769e-02, max=7.500000e+00, std=6.848557e-01
2025-10-11 08:05:18 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:18 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:18 - INFO - run_control_simulation:430 -   State hash: 3678210868265989060
2025-10-11 08:05:18 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:18 - INFO - run_control_simulation:469 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: -0.40
    - Avg step time: 2.167s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 21.7s
    - Speed ratio: 27.69x real-time

2025-10-11 08:05:18 - INFO - run_control_simulation:470 - Returning 10 state snapshots
2025-10-11 08:05:18 - INFO - run_performance_comparison:743 - Baseline states copied: 10 snapshots
2025-10-11 08:05:18 - INFO - run_performance_comparison:744 - Baseline FIRST state hash: 7233457399854534813
2025-10-11 08:05:18 - INFO - run_performance_comparison:745 - Baseline LAST state hash: 3678210868265989060
2025-10-11 08:05:18 - INFO - run_performance_comparison:746 - Baseline first state sample: rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
 1.37155700e-05]
2025-10-11 08:05:18 - INFO - run_performance_comparison:747 - Baseline last state sample: rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
 1.37154244e-05]
2025-10-11 08:05:18 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
2025-10-11 08:05:18 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=7233457399854534813, last=3678210868265989060
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 0: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
 1.37155700e-05], w_m[10:15]=[19.4415143  19.44204273 19.44220534 19.44224507 19.44224166]
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 1: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 2: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 3: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 4: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 5: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 6: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 7: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 8: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - DEBUG - evaluate_traffic_performance:495 - State 9: shape=(4, 104), dtype=float64
2025-10-11 08:05:18 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
 1.37154244e-05], w_m[10:15]=[19.44155914 19.44210302 19.44228306 19.44234271 19.4423625 ]
2025-10-11 08:05:18 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=35.578899, efficiency=5.692624, delay=-179.85s
2025-10-11 08:05:18 - INFO - run_control_simulation:298 - ================================================================================
2025-10-11 08:05:18 - INFO - run_control_simulation:299 - Starting run_control_simulation:
2025-10-11 08:05:18 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-11 08:05:18 - INFO - run_control_simulation:301 -   - duration: 600.0s
2025-10-11 08:05:18 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
2025-10-11 08:05:18 - INFO - run_control_simulation:303 -   - device: gpu
2025-10-11 08:05:18 - INFO - run_control_simulation:304 -   - controller: RLController
2025-10-11 08:05:18 - INFO - run_control_simulation:305 -   - max_control_steps: 11
2025-10-11 08:05:18 - INFO - run_control_simulation:306 - ================================================================================
2025-10-11 08:05:18 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
2025-10-11 08:05:18 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
2025-10-11 08:05:18 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
2025-10-11 08:05:18 - INFO - run_control_simulation:343 - Calling env.reset()...
2025-10-11 08:05:18 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-11 08:05:18 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
2025-10-11 08:05:18 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.906150e+00, std=6.996354e+00, min=1.200000e-04, max=1.500000e+01
2025-10-11 08:05:18 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
2025-10-11 08:05:18 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:18 - INFO - run_control_simulation:381 - STEP 0 START:
2025-10-11 08:05:18 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:18 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:18 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
2025-10-11 08:05:20 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:20 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:20 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:20 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:20 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.425728e+00, max=5.277778e+00, std=1.685899e+00
2025-10-11 08:05:20 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.009817, rho_c=0.018391
2025-10-11 08:05:20 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.988733, w_c=14.153037
2025-10-11 08:05:20 - INFO - run_control_simulation:430 -   State hash: 3080599035686371198
2025-10-11 08:05:20 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:20 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:20 - INFO - run_control_simulation:381 - STEP 1 START:
2025-10-11 08:05:20 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:20 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:20 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
2025-10-11 08:05:22 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:22 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:22 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:22 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:22 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.081123e+00, max=6.165583e+00, std=2.049516e+00
2025-10-11 08:05:22 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:22 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130606, w_c=16.309175
2025-10-11 08:05:22 - INFO - run_control_simulation:430 -   State hash: 617382081176525097
2025-10-11 08:05:22 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:22 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:22 - INFO - run_control_simulation:381 - STEP 2 START:
2025-10-11 08:05:22 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:22 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:22 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
2025-10-11 08:05:25 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:25 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:25 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:25 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:25 - INFO - run_control_simulation:415 -     Diff statistics: mean=4.284956e-03, max=1.358010e-01, std=1.790408e-02
2025-10-11 08:05:25 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:25 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325951
2025-10-11 08:05:25 - INFO - run_control_simulation:430 -   State hash: -3650508192352739064
2025-10-11 08:05:25 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:25 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:25 - INFO - run_control_simulation:381 - STEP 3 START:
2025-10-11 08:05:25 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:25 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:25 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
2025-10-11 08:05:27 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:27 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:27 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:27 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:27 - INFO - run_control_simulation:415 -     Diff statistics: mean=5.787770e-06, max=1.874293e-04, std=2.472638e-05
2025-10-11 08:05:27 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:27 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:27 - INFO - run_control_simulation:430 -   State hash: 4994012744349796249
2025-10-11 08:05:27 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:27 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:27 - INFO - run_control_simulation:381 - STEP 4 START:
2025-10-11 08:05:27 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:27 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:27 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
2025-10-11 08:05:29 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:29 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:29 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:29 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:29 - INFO - run_control_simulation:415 -     Diff statistics: mean=7.979977e-09, max=2.586392e-07, std=3.411733e-08
2025-10-11 08:05:29 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:29 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:29 - INFO - run_control_simulation:430 -   State hash: -3829702731279142748
2025-10-11 08:05:29 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:29 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:29 - INFO - run_control_simulation:381 - STEP 5 START:
2025-10-11 08:05:29 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:29 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:29 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
2025-10-11 08:05:31 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:31 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:31 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:31 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:31 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.099719e-11, max=3.568310e-10, std=4.706481e-11
2025-10-11 08:05:31 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:31 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:31 - INFO - run_control_simulation:430 -   State hash: -1974179515474722373
2025-10-11 08:05:31 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:31 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:31 - INFO - run_control_simulation:381 - STEP 6 START:
2025-10-11 08:05:31 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:31 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:31 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
2025-10-11 08:05:33 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:33 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:33 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:33 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:33 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.504783e-14, max=5.044853e-13, std=6.487746e-14
2025-10-11 08:05:33 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:33 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:33 - INFO - run_control_simulation:430 -   State hash: 7753725482633448421
2025-10-11 08:05:33 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:33 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:33 - INFO - run_control_simulation:381 - STEP 7 START:
2025-10-11 08:05:33 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:33 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:33 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
2025-10-11 08:05:35 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:35 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:35 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:35 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:35 - INFO - run_control_simulation:415 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
2025-10-11 08:05:35 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:35 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:35 - INFO - run_control_simulation:430 -   State hash: 7753725482633448421
2025-10-11 08:05:35 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:35 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:35 - INFO - run_control_simulation:381 - STEP 8 START:
2025-10-11 08:05:35 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:35 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:35 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
2025-10-11 08:05:38 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:38 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
2025-10-11 08:05:38 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:38 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:38 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.110223e-16, max=7.105427e-15, std=7.409311e-16
2025-10-11 08:05:38 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:38 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:38 - INFO - run_control_simulation:430 -   State hash: -2319108513245619474
2025-10-11 08:05:38 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:38 - INFO - run_control_simulation:380 - ================================================================================
2025-10-11 08:05:38 - INFO - run_control_simulation:381 - STEP 9 START:
2025-10-11 08:05:38 - INFO - run_control_simulation:382 -   Controller: RLController
2025-10-11 08:05:38 - INFO - run_control_simulation:383 -   Action: 0.000000
2025-10-11 08:05:38 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
2025-10-11 08:05:40 - INFO - run_control_simulation:396 -   Reward: 0.009661
2025-10-11 08:05:40 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
2025-10-11 08:05:40 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
2025-10-11 08:05:40 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
2025-10-11 08:05:40 - INFO - run_control_simulation:415 -     Diff statistics: mean=8.967209e-17, max=7.105427e-15, std=6.030205e-16
2025-10-11 08:05:40 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000783, rho_c=0.000976
2025-10-11 08:05:40 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.130969, w_c=16.325974
2025-10-11 08:05:40 - INFO - run_control_simulation:430 -   State hash: 3678210868265989060
2025-10-11 08:05:40 - INFO - run_control_simulation:432 - ================================================================================
2025-10-11 08:05:40 - INFO - run_control_simulation:469 - 
  [SIMULATION COMPLETED] Summary:
    - Total control steps: 10
    - Total reward: 0.10
    - Avg step time: 2.149s (device=gpu)
    - Simulated time: 600.0s / 600.0s
    - Wallclock time: 21.5s
    - Speed ratio: 27.91x real-time

2025-10-11 08:05:40 - INFO - run_control_simulation:470 - Returning 10 state snapshots
2025-10-11 08:05:40 - INFO - run_performance_comparison:780 - RL states copied: 10 snapshots
2025-10-11 08:05:40 - INFO - run_performance_comparison:781 - RL FIRST state hash: 3080599035686371198
2025-10-11 08:05:40 - INFO - run_performance_comparison:782 - RL LAST state hash: 3678210868265989060
2025-10-11 08:05:40 - INFO - run_performance_comparison:783 - RL first state sample: rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
 1.37155700e-05]
2025-10-11 08:05:40 - INFO - run_performance_comparison:784 - RL last state sample: rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
 1.37154244e-05]
2025-10-11 08:05:40 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
2025-10-11 08:05:40 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=3080599035686371198, last=3678210868265989060
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 0: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
 1.37155700e-05], w_m[10:15]=[19.4415143  19.44204273 19.44220534 19.44224507 19.44224166]
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 1: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 2: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 3: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 4: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 5: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 6: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 7: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 8: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - DEBUG - evaluate_traffic_performance:495 - State 9: shape=(4, 104), dtype=float64
2025-10-11 08:05:40 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
 1.37154244e-05], w_m[10:15]=[19.44155914 19.44210302 19.44228306 19.44234271 19.4423625 ]
2025-10-11 08:05:40 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=35.578899, efficiency=5.692624, delay=-179.85s
2025-10-11 08:05:40 - WARNING - run_performance_comparison:792 - States comparison - Identical: False, baseline_hash=7233457399854534813, rl_hash=3080599035686371198
2025-10-11 08:05:40 - INFO - run_performance_comparison:801 - Baseline performance: {'total_flow': 35.578899437823694, 'avg_speed': 1124213.2450093578, 'avg_density': 0.002560426914248977, 'efficiency': 5.692623910051789, 'delay': -179.8516675531262, 'throughput': 177894.49718911847}
2025-10-11 08:05:40 - INFO - run_performance_comparison:802 - RL performance: {'total_flow': 35.578899437823694, 'avg_speed': 1124213.2450093578, 'avg_density': 0.002560426914248977, 'efficiency': 5.692623910051789, 'delay': -179.8516675531262, 'throughput': 177894.49718911847}
2025-10-11 08:05:40 - INFO - run_performance_comparison:810 - Flow improvement: 0.000%
2025-10-11 08:05:40 - INFO - run_performance_comparison:811 - Efficiency improvement: 0.000%
2025-10-11 08:05:40 - INFO - run_performance_comparison:812 - Delay reduction: -0.000%
