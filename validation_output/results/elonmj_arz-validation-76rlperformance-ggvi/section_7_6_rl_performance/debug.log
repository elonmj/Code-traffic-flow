2025-10-09 14:23:04 - INFO - _setup_debug_logging:119 - ================================================================================
2025-10-09 14:23:04 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
2025-10-09 14:23:04 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
2025-10-09 14:23:04 - INFO - _setup_debug_logging:122 - Quick test mode: True
2025-10-09 14:23:04 - INFO - _setup_debug_logging:123 - ================================================================================
2025-10-09 14:23:05 - INFO - train_rl_agent:522 - ================================================================================
2025-10-09 14:23:05 - INFO - train_rl_agent:523 - Starting train_rl_agent for scenario: traffic_light_control
2025-10-09 14:23:05 - INFO - train_rl_agent:524 -   - Device: gpu
2025-10-09 14:23:05 - INFO - train_rl_agent:525 -   - Total timesteps: 100
2025-10-09 14:23:05 - INFO - train_rl_agent:526 -   - Episode max time: 120.0s
2025-10-09 14:23:05 - INFO - train_rl_agent:527 -   - Checkpoint frequency: 50
2025-10-09 14:23:05 - INFO - train_rl_agent:528 - ================================================================================
2025-10-09 14:23:05 - INFO - _create_scenario_config:180 - Created scenario config: traffic_light_control.yml
2025-10-09 14:23:05 - INFO - _create_scenario_config:181 -   Initial densities (veh/km): rho_m=80.0, rho_c=100.0
2025-10-09 14:23:05 - INFO - _create_scenario_config:182 -   Initial densities (veh/m): rho_m=0.0800, rho_c=0.1000
2025-10-09 14:23:05 - INFO - _create_scenario_config:183 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 14:24:39 - INFO - run_performance_comparison:659 - ================================================================================
2025-10-09 14:24:39 - INFO - run_performance_comparison:660 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 14:24:39 - INFO - run_performance_comparison:661 - Device: gpu
2025-10-09 14:24:39 - INFO - run_performance_comparison:662 - ================================================================================
2025-10-09 14:24:39 - INFO - run_performance_comparison:663 - ================================================================================
2025-10-09 14:24:39 - INFO - run_performance_comparison:664 - Starting run_performance_comparison for scenario: traffic_light_control
2025-10-09 14:24:39 - INFO - run_performance_comparison:665 - Device: gpu
2025-10-09 14:24:39 - INFO - run_performance_comparison:666 - ================================================================================
2025-10-09 14:24:39 - INFO - _create_scenario_config:180 - Created scenario config: traffic_light_control.yml
2025-10-09 14:24:39 - INFO - _create_scenario_config:181 -   Initial densities (veh/km): rho_m=80.0, rho_c=100.0
2025-10-09 14:24:39 - INFO - _create_scenario_config:182 -   Initial densities (veh/m): rho_m=0.0800, rho_c=0.1000
2025-10-09 14:24:39 - INFO - _create_scenario_config:183 -   Initial velocities: w_m=15.0 m/s, w_c=12.0 m/s
2025-10-09 14:24:39 - INFO - run_control_simulation:262 - ================================================================================
2025-10-09 14:24:39 - INFO - run_control_simulation:263 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 14:24:39 - INFO - run_control_simulation:264 - Starting run_control_simulation:
2025-10-09 14:24:39 - INFO - run_control_simulation:265 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 14:24:39 - INFO - run_control_simulation:266 -   - duration: 600.0s
2025-10-09 14:24:39 - INFO - run_control_simulation:267 -   - control_interval: 60.0s
2025-10-09 14:24:39 - INFO - run_control_simulation:268 -   - device: gpu
2025-10-09 14:24:39 - INFO - run_control_simulation:269 -   - controller: BaselineController
2025-10-09 14:24:39 - INFO - run_control_simulation:270 - ================================================================================
2025-10-09 14:24:39 - INFO - run_control_simulation:275 - Creating TrafficSignalEnvDirect instance...
2025-10-09 14:24:39 - INFO - run_control_simulation:285 - TrafficSignalEnvDirect created successfully
2025-10-09 14:24:39 - INFO - run_control_simulation:301 - Calling env.reset()...
2025-10-09 14:24:39 - INFO - run_control_simulation:303 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 14:24:39 - INFO - run_control_simulation:307 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 14:24:39 - INFO - run_control_simulation:308 - INITIAL STATE statistics: mean=3.593277e+00, std=3.509398e+00, min=8.000000e-05, max=7.368205e+00
2025-10-09 14:24:39 - INFO - run_control_simulation:324 - Starting simulation loop - max 10 steps
2025-10-09 14:24:39 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:39 - INFO - run_control_simulation:339 - STEP 0 START:
2025-10-09 14:24:39 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:39 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:39 - INFO - run_control_simulation:342 -   Simulation time: 0.00s
2025-10-09 14:24:39 - INFO - run_control_simulation:354 -   Reward: 1.678158
2025-10-09 14:24:39 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:39 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:39 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:39 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.708669e-01, max=1.206315e+01, std=1.915861e+00
2025-10-09 14:24:39 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.073951, rho_c=0.094527
2025-10-09 14:24:39 - INFO - run_control_simulation:384 -     Mean velocities: w_m=8.201912, w_c=7.461910
2025-10-09 14:24:39 - INFO - run_control_simulation:388 -   State hash: -4449030417545156229
2025-10-09 14:24:39 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:39 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:39 - INFO - run_control_simulation:339 - STEP 1 START:
2025-10-09 14:24:39 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:39 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:39 - INFO - run_control_simulation:342 -   Simulation time: 60.00s
2025-10-09 14:24:40 - INFO - run_control_simulation:354 -   Reward: 0.043846
2025-10-09 14:24:40 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:40 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:40 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:40 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.527734e-01, max=1.202397e+01, std=1.781692e+00
2025-10-09 14:24:40 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.067121, rho_c=0.088077
2025-10-09 14:24:40 - INFO - run_control_simulation:384 -     Mean velocities: w_m=8.968519, w_c=8.090219
2025-10-09 14:24:40 - INFO - run_control_simulation:388 -   State hash: -7358342153101075282
2025-10-09 14:24:40 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:40 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:40 - INFO - run_control_simulation:339 - STEP 2 START:
2025-10-09 14:24:40 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:40 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:40 - INFO - run_control_simulation:342 -   Simulation time: 120.00s
2025-10-09 14:24:41 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:41 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:41 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:41 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:41 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.530946e-01, max=1.195553e+01, std=1.768874e+00
2025-10-09 14:24:41 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.061857, rho_c=0.083586
2025-10-09 14:24:41 - INFO - run_control_simulation:384 -     Mean velocities: w_m=9.735159, w_c=8.718118
2025-10-09 14:24:41 - INFO - run_control_simulation:388 -   State hash: 498014371997454520
2025-10-09 14:24:41 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:41 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:41 - INFO - run_control_simulation:339 - STEP 3 START:
2025-10-09 14:24:41 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:41 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:41 - INFO - run_control_simulation:342 -   Simulation time: 180.00s
2025-10-09 14:24:42 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:42 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:42 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:42 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:42 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.535047e-01, max=1.187429e+01, std=1.757506e+00
2025-10-09 14:24:42 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.055027, rho_c=0.077136
2025-10-09 14:24:42 - INFO - run_control_simulation:384 -     Mean velocities: w_m=10.501830, w_c=9.346060
2025-10-09 14:24:42 - INFO - run_control_simulation:388 -   State hash: 3250878700158952183
2025-10-09 14:24:42 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:42 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:42 - INFO - run_control_simulation:339 - STEP 4 START:
2025-10-09 14:24:42 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:42 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:42 - INFO - run_control_simulation:342 -   Simulation time: 240.00s
2025-10-09 14:24:43 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:43 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:43 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:43 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:43 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.538553e-01, max=1.181872e+01, std=1.748320e+00
2025-10-09 14:24:43 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.049763, rho_c=0.072644
2025-10-09 14:24:43 - INFO - run_control_simulation:384 -     Mean velocities: w_m=11.268524, w_c=9.974021
2025-10-09 14:24:43 - INFO - run_control_simulation:388 -   State hash: 4738117969430099933
2025-10-09 14:24:43 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:43 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:43 - INFO - run_control_simulation:339 - STEP 5 START:
2025-10-09 14:24:43 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:43 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:43 - INFO - run_control_simulation:342 -   Simulation time: 300.00s
2025-10-09 14:24:44 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:44 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:44 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:44 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:44 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.541276e-01, max=1.180743e+01, std=1.741813e+00
2025-10-09 14:24:44 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.042932, rho_c=0.066194
2025-10-09 14:24:44 - INFO - run_control_simulation:384 -     Mean velocities: w_m=12.035234, w_c=10.601990
2025-10-09 14:24:44 - INFO - run_control_simulation:388 -   State hash: -6174186295206523221
2025-10-09 14:24:44 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:44 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:44 - INFO - run_control_simulation:339 - STEP 6 START:
2025-10-09 14:24:44 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:44 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:44 - INFO - run_control_simulation:342 -   Simulation time: 360.00s
2025-10-09 14:24:45 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:45 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:45 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:45 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:45 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.543184e-01, max=1.180849e+01, std=1.737858e+00
2025-10-09 14:24:45 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.037669, rho_c=0.061703
2025-10-09 14:24:45 - INFO - run_control_simulation:384 -     Mean velocities: w_m=12.801956, w_c=11.229966
2025-10-09 14:24:45 - INFO - run_control_simulation:388 -   State hash: 4986530627653672685
2025-10-09 14:24:45 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:45 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:45 - INFO - run_control_simulation:339 - STEP 7 START:
2025-10-09 14:24:45 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:45 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:45 - INFO - run_control_simulation:342 -   Simulation time: 420.00s
2025-10-09 14:24:45 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:45 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:45 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:45 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:45 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.568704e-01, max=1.187372e+01, std=1.735071e+00
2025-10-09 14:24:45 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.030838, rho_c=0.055253
2025-10-09 14:24:45 - INFO - run_control_simulation:384 -     Mean velocities: w_m=13.568704, w_c=11.858233
2025-10-09 14:24:45 - INFO - run_control_simulation:388 -   State hash: -5532946028577643693
2025-10-09 14:24:45 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:45 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:45 - INFO - run_control_simulation:339 - STEP 8 START:
2025-10-09 14:24:45 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:45 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:45 - INFO - run_control_simulation:342 -   Simulation time: 480.00s
2025-10-09 14:24:46 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:46 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:46 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:46 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:46 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.736125e-01, max=1.241849e+01, std=1.728501e+00
2025-10-09 14:24:46 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.025575, rho_c=0.050762
2025-10-09 14:24:46 - INFO - run_control_simulation:384 -     Mean velocities: w_m=14.335558, w_c=12.487808
2025-10-09 14:24:46 - INFO - run_control_simulation:388 -   State hash: -4360516952524821246
2025-10-09 14:24:46 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:46 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:46 - INFO - run_control_simulation:339 - STEP 9 START:
2025-10-09 14:24:46 - INFO - run_control_simulation:340 -   Controller: BaselineController
2025-10-09 14:24:46 - INFO - run_control_simulation:341 -   Action: 1.000000
2025-10-09 14:24:46 - INFO - run_control_simulation:342 -   Simulation time: 540.00s
2025-10-09 14:24:47 - INFO - run_control_simulation:354 -   Reward: 0.043833
2025-10-09 14:24:47 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: True
2025-10-09 14:24:47 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:47 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:47 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.854644e-01, max=1.275820e+01, std=1.717031e+00
2025-10-09 14:24:47 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.018744, rho_c=0.044312
2025-10-09 14:24:47 - INFO - run_control_simulation:384 -     Mean velocities: w_m=15.102412, w_c=13.117654
2025-10-09 14:24:47 - INFO - run_control_simulation:388 -   State hash: -7776614393129569184
2025-10-09 14:24:47 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:47 - INFO - run_control_simulation:422 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: 2.07
    - Avg step time: 0.847s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 8.5s
    - Speed ratio: 70.81x real-time

2025-10-09 14:24:47 - INFO - run_control_simulation:423 - Returning 10 state snapshots
2025-10-09 14:24:47 - INFO - evaluate_traffic_performance:434 - Evaluating performance with 10 state snapshots
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 0: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - INFO - evaluate_traffic_performance:442 - First state sample - rho_m[10:15]=[8.12325972e-05 8.46301546e-05 1.16545552e-04 6.02009536e-04
 5.13019688e-03], w_m[10:15]=[19.27428847 18.9703803  18.11241806 15.9759423  12.15478141]
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 1: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 2: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 3: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 4: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 5: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 6: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 7: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 8: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - DEBUG - evaluate_traffic_performance:439 - State 9: shape=(4, 204), dtype=float64
2025-10-09 14:24:47 - INFO - evaluate_traffic_performance:496 - Calculated metrics: flow=21.843663, efficiency=3.494986, delay=-157.22s
2025-10-09 14:24:47 - INFO - run_control_simulation:262 - ================================================================================
2025-10-09 14:24:47 - INFO - run_control_simulation:263 - DIAGNOSTIC MODE: MAX 10 STEPS
2025-10-09 14:24:47 - INFO - run_control_simulation:264 - Starting run_control_simulation:
2025-10-09 14:24:47 - INFO - run_control_simulation:265 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
2025-10-09 14:24:47 - INFO - run_control_simulation:266 -   - duration: 600.0s
2025-10-09 14:24:47 - INFO - run_control_simulation:267 -   - control_interval: 60.0s
2025-10-09 14:24:47 - INFO - run_control_simulation:268 -   - device: gpu
2025-10-09 14:24:47 - INFO - run_control_simulation:269 -   - controller: RLController
2025-10-09 14:24:47 - INFO - run_control_simulation:270 - ================================================================================
2025-10-09 14:24:47 - INFO - run_control_simulation:275 - Creating TrafficSignalEnvDirect instance...
2025-10-09 14:24:47 - INFO - run_control_simulation:285 - TrafficSignalEnvDirect created successfully
2025-10-09 14:24:47 - INFO - run_control_simulation:301 - Calling env.reset()...
2025-10-09 14:24:47 - INFO - run_control_simulation:303 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
2025-10-09 14:24:47 - INFO - run_control_simulation:307 - INITIAL STATE shape: (4, 204), dtype: float64
2025-10-09 14:24:47 - INFO - run_control_simulation:308 - INITIAL STATE statistics: mean=3.593277e+00, std=3.509398e+00, min=8.000000e-05, max=7.368205e+00
2025-10-09 14:24:47 - INFO - run_control_simulation:324 - Starting simulation loop - max 10 steps
2025-10-09 14:24:47 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:47 - INFO - run_control_simulation:339 - STEP 0 START:
2025-10-09 14:24:47 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:47 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:47 - INFO - run_control_simulation:342 -   Simulation time: 0.00s
2025-10-09 14:24:48 - INFO - run_control_simulation:354 -   Reward: 1.778158
2025-10-09 14:24:48 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:48 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:48 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:48 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.704261e-01, max=1.206315e+01, std=1.915936e+00
2025-10-09 14:24:48 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.073168, rho_c=0.093547
2025-10-09 14:24:48 - INFO - run_control_simulation:384 -     Mean velocities: w_m=8.201912, w_c=7.461910
2025-10-09 14:24:48 - INFO - run_control_simulation:388 -   State hash: 4033053026550702233
2025-10-09 14:24:48 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:48 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:48 - INFO - run_control_simulation:339 - STEP 1 START:
2025-10-09 14:24:48 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:48 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:48 - INFO - run_control_simulation:342 -   Simulation time: 60.00s
2025-10-09 14:24:49 - INFO - run_control_simulation:354 -   Reward: 0.143846
2025-10-09 14:24:49 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:49 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:49 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:49 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.523327e-01, max=1.202397e+01, std=1.781768e+00
2025-10-09 14:24:49 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.067121, rho_c=0.088077
2025-10-09 14:24:49 - INFO - run_control_simulation:384 -     Mean velocities: w_m=8.968519, w_c=8.090219
2025-10-09 14:24:49 - INFO - run_control_simulation:388 -   State hash: -7358342153101075282
2025-10-09 14:24:49 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:49 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:49 - INFO - run_control_simulation:339 - STEP 2 START:
2025-10-09 14:24:49 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:49 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:49 - INFO - run_control_simulation:342 -   Simulation time: 120.00s
2025-10-09 14:24:50 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:50 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:50 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:50 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:50 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.526539e-01, max=1.195553e+01, std=1.768951e+00
2025-10-09 14:24:50 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.061074, rho_c=0.082606
2025-10-09 14:24:50 - INFO - run_control_simulation:384 -     Mean velocities: w_m=9.735159, w_c=8.718118
2025-10-09 14:24:50 - INFO - run_control_simulation:388 -   State hash: 6825226092709364134
2025-10-09 14:24:50 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:50 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:50 - INFO - run_control_simulation:339 - STEP 3 START:
2025-10-09 14:24:50 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:50 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:50 - INFO - run_control_simulation:342 -   Simulation time: 180.00s
2025-10-09 14:24:51 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:51 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:51 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:51 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:51 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.530640e-01, max=1.187429e+01, std=1.757583e+00
2025-10-09 14:24:51 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.055027, rho_c=0.077136
2025-10-09 14:24:51 - INFO - run_control_simulation:384 -     Mean velocities: w_m=10.501830, w_c=9.346060
2025-10-09 14:24:51 - INFO - run_control_simulation:388 -   State hash: 3250878700158952183
2025-10-09 14:24:51 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:51 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:51 - INFO - run_control_simulation:339 - STEP 4 START:
2025-10-09 14:24:51 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:51 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:51 - INFO - run_control_simulation:342 -   Simulation time: 240.00s
2025-10-09 14:24:52 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:52 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:52 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:52 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:52 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.534146e-01, max=1.181872e+01, std=1.748398e+00
2025-10-09 14:24:52 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.048980, rho_c=0.071665
2025-10-09 14:24:52 - INFO - run_control_simulation:384 -     Mean velocities: w_m=11.268524, w_c=9.974021
2025-10-09 14:24:52 - INFO - run_control_simulation:388 -   State hash: -6665251938632153287
2025-10-09 14:24:52 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:52 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:52 - INFO - run_control_simulation:339 - STEP 5 START:
2025-10-09 14:24:52 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:52 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:52 - INFO - run_control_simulation:342 -   Simulation time: 300.00s
2025-10-09 14:24:53 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:53 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:53 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:53 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:53 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.536868e-01, max=1.180743e+01, std=1.741891e+00
2025-10-09 14:24:53 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.042932, rho_c=0.066194
2025-10-09 14:24:53 - INFO - run_control_simulation:384 -     Mean velocities: w_m=12.035234, w_c=10.601990
2025-10-09 14:24:53 - INFO - run_control_simulation:388 -   State hash: -6174186295206523221
2025-10-09 14:24:53 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:53 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:53 - INFO - run_control_simulation:339 - STEP 6 START:
2025-10-09 14:24:53 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:53 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:53 - INFO - run_control_simulation:342 -   Simulation time: 360.00s
2025-10-09 14:24:54 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:54 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:54 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:54 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:54 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.538776e-01, max=1.180849e+01, std=1.737936e+00
2025-10-09 14:24:54 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.036885, rho_c=0.060724
2025-10-09 14:24:54 - INFO - run_control_simulation:384 -     Mean velocities: w_m=12.801956, w_c=11.229966
2025-10-09 14:24:54 - INFO - run_control_simulation:388 -   State hash: 1409334729192071604
2025-10-09 14:24:54 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:54 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:54 - INFO - run_control_simulation:339 - STEP 7 START:
2025-10-09 14:24:54 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:54 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:54 - INFO - run_control_simulation:342 -   Simulation time: 420.00s
2025-10-09 14:24:54 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:54 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:54 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:54 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:54 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.564296e-01, max=1.187372e+01, std=1.735150e+00
2025-10-09 14:24:54 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.030838, rho_c=0.055253
2025-10-09 14:24:54 - INFO - run_control_simulation:384 -     Mean velocities: w_m=13.568704, w_c=11.858233
2025-10-09 14:24:54 - INFO - run_control_simulation:388 -   State hash: -5532946028577643693
2025-10-09 14:24:54 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:54 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:54 - INFO - run_control_simulation:339 - STEP 8 START:
2025-10-09 14:24:54 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:54 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:54 - INFO - run_control_simulation:342 -   Simulation time: 480.00s
2025-10-09 14:24:55 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:55 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: False
2025-10-09 14:24:55 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:55 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:55 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.731717e-01, max=1.241849e+01, std=1.728585e+00
2025-10-09 14:24:55 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.024791, rho_c=0.049783
2025-10-09 14:24:55 - INFO - run_control_simulation:384 -     Mean velocities: w_m=14.335558, w_c=12.487808
2025-10-09 14:24:55 - INFO - run_control_simulation:388 -   State hash: -6378798772532864009
2025-10-09 14:24:55 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:55 - INFO - run_control_simulation:338 - ================================================================================
2025-10-09 14:24:55 - INFO - run_control_simulation:339 - STEP 9 START:
2025-10-09 14:24:55 - INFO - run_control_simulation:340 -   Controller: RLController
2025-10-09 14:24:55 - INFO - run_control_simulation:341 -   Action: 0.000000
2025-10-09 14:24:55 - INFO - run_control_simulation:342 -   Simulation time: 540.00s
2025-10-09 14:24:56 - INFO - run_control_simulation:354 -   Reward: 0.143833
2025-10-09 14:24:56 - INFO - run_control_simulation:355 -   Terminated: False, Truncated: True
2025-10-09 14:24:56 - INFO - run_control_simulation:371 -   STATE EVOLUTION:
2025-10-09 14:24:56 - INFO - run_control_simulation:372 -     Before shape: (4, 204), After shape: (4, 204)
2025-10-09 14:24:56 - INFO - run_control_simulation:373 -     Diff statistics: mean=3.850237e-01, max=1.275820e+01, std=1.717118e+00
2025-10-09 14:24:56 - INFO - run_control_simulation:383 -     Mean densities: rho_m=0.018744, rho_c=0.044312
2025-10-09 14:24:56 - INFO - run_control_simulation:384 -     Mean velocities: w_m=15.102412, w_c=13.117654
2025-10-09 14:24:56 - INFO - run_control_simulation:388 -   State hash: -7776614393129569184
2025-10-09 14:24:56 - INFO - run_control_simulation:390 - ================================================================================
2025-10-09 14:24:56 - INFO - run_control_simulation:422 - 
  [DIAGNOSTIC COMPLETED] Simulation summary:
    - Total steps: 10 (limited to 10 for diagnosis)
    - Total reward: 3.07
    - Avg step time: 0.894s (device=gpu)
    - Simulated time: 600.0s
    - Wallclock time: 8.9s
    - Speed ratio: 67.13x real-time

2025-10-09 14:24:56 - INFO - run_control_simulation:423 - Returning 10 state snapshots
2025-10-09 14:24:56 - INFO - evaluate_traffic_performance:434 - Evaluating performance with 10 state snapshots
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 0: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - INFO - evaluate_traffic_performance:442 - First state sample - rho_m[10:15]=[8.12325972e-05 8.46301546e-05 1.16545552e-04 6.02009536e-04
 5.13019688e-03], w_m[10:15]=[19.27428847 18.9703803  18.11241806 15.9759423  12.15478141]
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 1: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 2: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 3: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 4: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 5: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 6: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 7: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 8: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - DEBUG - evaluate_traffic_performance:439 - State 9: shape=(4, 204), dtype=float64
2025-10-09 14:24:56 - INFO - evaluate_traffic_performance:496 - Calculated metrics: flow=21.843663, efficiency=3.494986, delay=-157.22s
2025-10-09 14:24:56 - WARNING - run_performance_comparison:717 - States comparison - Identical: False, baseline_hash=-4449030417545156229, rl_hash=4033053026550702233
2025-10-09 14:24:56 - INFO - run_performance_comparison:720 - Baseline performance: {'total_flow': 21.8436633772703, 'avg_speed': 220.92539881376564, 'avg_density': 0.11563708034632188, 'efficiency': 3.494986140363248, 'delay': -157.22404099218525, 'throughput': 109218.3168863515}
2025-10-09 14:24:56 - INFO - run_performance_comparison:721 - RL performance: {'total_flow': 21.8436633772703, 'avg_speed': 220.92539881376564, 'avg_density': 0.11563708034632188, 'efficiency': 3.494986140363248, 'delay': -157.22404099218525, 'throughput': 109218.3168863515}
2025-10-09 14:24:56 - INFO - run_performance_comparison:729 - Flow improvement: 0.000%
2025-10-09 14:24:56 - INFO - run_performance_comparison:730 - Efficiency improvement: 0.000%
2025-10-09 14:24:56 - INFO - run_performance_comparison:731 - Delay reduction: -0.000%
