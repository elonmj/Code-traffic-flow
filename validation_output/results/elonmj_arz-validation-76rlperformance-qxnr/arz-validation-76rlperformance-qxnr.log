[{"stream_name":"stdout","time":0.63882988,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.638877099,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.638884254,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.638888156,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.638893324,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.639092877,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.545386827,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.545454484,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.592387776,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.613213968,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.613303608,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.613383247,"data":"\n"}
,{"stream_name":"stdout","time":5.613391376,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.613529014,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.24389089,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.24396589,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.24407428,"data":"\n"}
,{"stream_name":"stdout","time":9.2440875,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.244145106,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":13.114064479,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":16.076878874,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":19.040745555,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":22.029011261,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":24.932627639,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":27.930973029,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":95.356319619,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":95.356445192,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":95.35654893,"data":"\n"}
,{"stream_name":"stdout","time":95.356572588,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":95.356949155,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":95.357047762,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":95.357133163,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":95.357206995,"data":"============================================================\n"}
,{"stream_name":"stderr","time":107.278724335,"data":"2025-10-25 11:22:23.683986: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":107.533135294,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":107.533195339,"data":"E0000 00:00:1761391343.938308     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":107.586471019,"data":"E0000 00:00:1761391343.991717     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":119.227888762,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":119.227933866,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":119.227997236,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":119.228012602,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":119.228016782,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":119.228020614,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":119.228024431,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":119.228109792,"data":"[ARCHITECTURE] Structure créée: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":119.228119906,"data":"  - Figures:   /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":119.228125847,"data":"  - NPZ:       /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":119.228131172,"data":"  - Scenarios: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":119.228136417,"data":"  - Metrics:   /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":119.228141746,"data":"  - LaTeX:     /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":119.228696486,"data":"2025-10-25 11:22:35 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":119.228871931,"data":"2025-10-25 11:22:35 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":119.228914356,"data":"2025-10-25 11:22:35 - INFO - _setup_debug_logging:157 - Log file: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":119.22903952,"data":"2025-10-25 11:22:35 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":119.229117664,"data":"2025-10-25 11:22:35 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":119.229182191,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":119.229205047,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":119.229211478,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":119.340023505,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":119.436697443,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":119.436726006,"data":"\n"}
,{"stream_name":"stdout","time":119.436748853,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":119.436753018,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":119.436756817,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":119.436760599,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":119.436824611,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1152 - ================================================================================\n"}
,{"stream_name":"stdout","time":119.436926261,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1153 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":119.437003588,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1154 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":119.437076458,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1155 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":119.437151212,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1156 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":119.437242313,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1157 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":119.437329411,"data":"2025-10-25 11:22:35 - INFO - train_rl_agent:1158 - ================================================================================\n"}
,{"stream_name":"stdout","time":119.437337658,"data":"\n"}
,{"stream_name":"stdout","time":119.437341682,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":119.437345395,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":119.437349077,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":119.437353125,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":119.437582117,"data":"2025-10-25 11:22:35 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":119.437739897,"data":"2025-10-25 11:22:35 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":119.437815173,"data":"2025-10-25 11:22:35 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":119.438212435,"data":"2025-10-25 11:22:35 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":119.44953832,"data":"[LAGOS CONFIG] Saved NetworkConfig:\n"}
,{"stream_name":"stdout","time":119.449554607,"data":"  - Network: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":119.449560328,"data":"  - Traffic: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control_traffic_control.yml\n"}
,{"stream_name":"stdout","time":119.449630255,"data":"2025-10-25 11:22:35 - INFO - _create_scenario_config:614 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":119.449758105,"data":"2025-10-25 11:22:35 - INFO - _create_scenario_config:615 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":119.449822958,"data":"2025-10-25 11:22:35 - INFO - _create_scenario_config:616 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":119.449908107,"data":"2025-10-25 11:22:35 - INFO - _create_scenario_config:617 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":119.449928775,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":119.449943047,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":119.450057102,"data":"2025-10-25 11:22:35 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":119.450219348,"data":"2025-10-25 11:22:35 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":119.45039802,"data":"2025-10-25 11:22:35 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 5303a227\n"}
,{"stream_name":"stdout","time":119.450524168,"data":"2025-10-25 11:22:35 - INFO - _load_rl_cache:548 - [CACHE RL] No cache found for traffic_light_control with config 5303a227\n"}
,{"stream_name":"stdout","time":119.450532869,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":119.455433443,"data":"[NORMALIZATION] Using scenario V0 speeds: v_m=32.0 km/h, v_c=28.0 km/h\n"}
,{"stream_name":"stdout","time":119.455865717,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":119.455882087,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":119.465307592,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":119.465324041,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":119.465328658,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":119.465333005,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":119.470014932,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":119.470029981,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":119.470034656,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":119.470038291,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":119.470137783,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":119.47014611,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":119.470149914,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":119.470189816,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":119.470215109,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":119.470241028,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":119.470246455,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":119.473668735,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":119.473685732,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stderr","time":119.474164372,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":119.474177312,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":120.91956078,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":120.919588808,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":120.919593773,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":120.919622873,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":120.919630169,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":120.919634281,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":120.919638313,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":120.919645285,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":120.92011075,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":120.921070025,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":120.921161452,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":120.921169922,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":125.431198277,"data":"2025-10-25 11:22:41 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 5303a227\n"}
,{"stream_name":"stdout","time":125.431534191,"data":"\n"}
,{"stream_name":"stdout","time":125.431545409,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 3 checkpoints (2 latest + 1 best)\n"}
,{"stream_name":"stdout","time":125.431551412,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":125.431557386,"data":"\n"}
,{"stream_name":"stdout","time":125.431569241,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":125.431575604,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":125.431581374,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":125.431587054,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":125.43159294,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":125.431612092,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":125.431624766,"data":"\n"}
,{"stream_name":"stdout","time":125.431633822,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":125.43164051,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":125.443729805,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":125.443753493,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":125.443772778,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":125.443778974,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":125.448434085,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":125.448454267,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":125.448460715,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":125.448466555,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":125.448556619,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":125.44861026,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":125.448627904,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":125.448632382,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":125.448639925,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":125.448644867,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":125.448649193,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":125.449426358,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":125.449434472,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":125.450545623,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":125.450899651,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":125.450911924,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":125.450916456,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":125.455576583,"data":"Logging to /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":125.455775035,"data":"\n"}
,{"stream_name":"stdout","time":125.4557882,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":125.457424981,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":125.457441425,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":125.457446256,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":125.457452049,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":125.457872587,"data":"\n"}
,{"stream_name":"stderr","time":125.49506922,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":125.495098401,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":126.223768422,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":126.223794148,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":126.223800108,"data":"  Original dt: 8.243556e-01 s\n"}
,{"stream_name":"stdout","time":126.223804716,"data":"  Corrected dt: 5.152222e-01 s\n"}
,{"stream_name":"stdout","time":126.223808554,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":126.22381244,"data":"  Max wave speed detected: 9.70 m/s\n"}
,{"stream_name":"stderr","time":126.401777069,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":126.401836601,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":126.65596809,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":126.655996187,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":126.714755523,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":126.71478416,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":126.774661491,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":126.774689605,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.191894067,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.191925849,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.266564059,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.266592588,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.352087374,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.352117879,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.449531098,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.449562548,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.547378943,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.547411192,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.606514877,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.606545939,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.664871582,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.664902977,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":127.85703304,"data":"\n"}
,{"stream_name":"stdout","time":127.857041249,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":127.857063013,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":127.857315801,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  6.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  6.25s/s]\n"}
,{"stream_name":"stdout","time":127.857316686,"data":"\n"}
,{"stream_name":"stdout","time":127.857331275,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":127.857336317,"data":"Total runtime: 2.40 seconds.\n"}
,{"stream_name":"stdout","time":127.859021157,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":127.85903514,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":127.859284723,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.65673774 1.         0.6746973  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":127.859291629,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":127.859507737,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":127.859722283,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":127.859899599,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19702134 0.2072735  0.21115741 0.21222052 0.21245109 0.21249263]\n"}
,{"stream_name":"stdout","time":127.860096284,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.1012046  0.10238536 0.10217475 0.10204492 0.1020088  0.10200143]\n"}
,{"stream_name":"stdout","time":127.860102512,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":127.860106394,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":127.860319897,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":127.860341686,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":127.860424031,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":127.860483286,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":127.86051413,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":127.860543801,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":127.860580285,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":127.861009769,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":127.861027174,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":127.861031768,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":127.861035814,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":127.861187594,"data":"\n"}
,{"stream_name":"stderr","time":127.996292507,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":127.996332652,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":127.996315932,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stdout","time":127.996648262,"data":"\n"}
,{"stream_name":"stdout","time":127.996666024,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":127.996671701,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":127.996688791,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.00s/s]\n"}
,{"stream_name":"stdout","time":127.998270878,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":127.998283492,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":127.998488007,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.56791335 1.         0.5838354  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":127.998495134,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":127.998714966,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":127.998911871,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":127.999089898,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.170374   0.17915949 0.19161028 0.20160468 0.2076184  0.21058042]\n"}
,{"stream_name":"stdout","time":127.999279255,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.08757532 0.09818336 0.10221734 0.10289621 0.10261706 0.10229924]\n"}
,{"stream_name":"stdout","time":127.999289779,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":127.999294194,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":127.999455274,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":127.999497197,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":127.999567213,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":127.999629604,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":127.999671458,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":127.999693489,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":127.999733118,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":128.000149955,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.000160361,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.00016473,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.000168779,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.000340512,"data":"\n"}
,{"stream_name":"stdout","time":128.11967717,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stderr","time":128.129003893,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":128.129013202,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":128.129026828,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":128.129215047,"data":"\n"}
,{"stream_name":"stderr","time":128.129211583,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 116.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 116.59s/s]\n"}
,{"stream_name":"stdout","time":128.129223991,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":128.129234405,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":128.130707444,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":128.130722759,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":128.130953819,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.5801493  1.         0.47444236 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":128.130961379,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":128.131140112,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.13131079,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":128.131477683,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17404479 0.17933069 0.17872809 0.18354408 0.19157577 0.19936845]\n"}
,{"stream_name":"stdout","time":128.131651828,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.07116636 0.07880426 0.08973877 0.09806652 0.10190859 0.10298044]\n"}
,{"stream_name":"stdout","time":128.131664011,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.131668714,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.131870904,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.131908364,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.131995154,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.132000916,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.132051539,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.132080984,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.132132896,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":128.132547788,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.132587978,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.132593573,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.132613959,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.132779509,"data":"\n"}
,{"stream_name":"stderr","time":128.251787217,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":128.251787215,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":128.251814958,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":128.252020371,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 126.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 126.08s/s]\n"}
,{"stream_name":"stdout","time":128.252020692,"data":"\n"}
,{"stream_name":"stdout","time":128.252039512,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":128.252044465,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":128.253761256,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":128.253777043,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":128.254082072,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.60060745 1.         0.42981133 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":128.254095692,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":128.254263313,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.254422545,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":128.254595624,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.18018225 0.19219498 0.18881907 0.18455216 0.18382338 0.1870331 ]\n"}
,{"stream_name":"stdout","time":128.254834842,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.0644717  0.06514522 0.07250427 0.08328256 0.09245455 0.09858901]\n"}
,{"stream_name":"stdout","time":128.254841337,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.254845387,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.255024801,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.255055934,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.255123532,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.255160809,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.255242864,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.255266571,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.255327324,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":128.255963615,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.255982033,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":128.255987478,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":128.255991797,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.256178713,"data":"\n"}
,{"stream_name":"stdout","time":128.376440554,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":128.376474978,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":128.376493398,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":128.376702891,"data":"\n"}
,{"stream_name":"stdout","time":128.376716973,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":128.376721906,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":128.376703392,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 124.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 124.73s/s]\n"}
,{"stream_name":"stdout","time":128.378408061,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":128.378426896,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":128.378638829,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.63846874 1.         0.38411903 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":128.37865525,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":128.37886465,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.37904493,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":128.379220462,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19154063 0.19569014 0.19595532 0.19276194 0.18864013 0.18603149]\n"}
,{"stream_name":"stdout","time":128.379390994,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.05761786 0.06004804 0.06554849 0.07314575 0.08151548 0.08931608]\n"}
,{"stream_name":"stdout","time":128.379400874,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.379404897,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.379586182,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.379620488,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.379712096,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.37974938,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.379776153,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.379858293,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.379866703,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":128.380267098,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.380275051,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.380279487,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.380283526,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.380475644,"data":"\n"}
,{"stream_name":"stdout","time":128.503692879,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":128.503728275,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":128.503746704,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":128.503972877,"data":"\n"}
,{"stream_name":"stderr","time":128.503972404,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 121.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 121.66s/s]\n"}
,{"stream_name":"stdout","time":128.503982393,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":128.503990626,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":128.505562635,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.505584851,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.505838173,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.505861676,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.505941276,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.505990335,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.505996321,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.506070985,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.506132624,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":128.506554484,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.506565806,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":128.50657059,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":128.506574976,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.506768741,"data":"\n"}
,{"stream_name":"stdout","time":128.590934717,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":128.590979457,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":128.590985897,"data":"  Original dt: 1.870305e+00 s\n"}
,{"stream_name":"stdout","time":128.590990173,"data":"  Corrected dt: 1.168941e+00 s\n"}
,{"stream_name":"stdout","time":128.590994321,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":128.59099844,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":128.598956926,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stderr","time":128.627719531,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":128.62774794,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":128.627747233,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stdout","time":128.627776173,"data":"\n"}
,{"stream_name":"stdout","time":128.627781382,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":128.627786018,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":128.627788831,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 124.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 124.17s/s]\n"}
,{"stream_name":"stdout","time":128.629291763,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.629305943,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.629528185,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.629552178,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.629657703,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.629677892,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.629778864,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.629784834,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.629813092,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":128.63022414900001,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.630233134,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.630237847,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.630242863,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.630411432,"data":"\n"}
,{"stream_name":"stderr","time":128.747324568,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":128.747328378,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":128.747354195,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":128.747384889,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.47s/s]\n"}
,{"stream_name":"stdout","time":128.747388703,"data":"\n"}
,{"stream_name":"stdout","time":128.747396984,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":128.747401379,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":128.748988648,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.749007873,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.749053539,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.749073728,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.749216272,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.749225477,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.749230117,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.749319935,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.749330862,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":128.749335653,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":128.749440253,"data":"\n"}
,{"stream_name":"stdout","time":128.74944779,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":128.749456267,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.02 | Avg Reward/Step: 0.003\n"}
,{"stream_name":"stdout","time":128.749460152,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":128.749463925,"data":"\n"}
,{"stream_name":"stdout","time":128.749467643,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":128.7494717,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":128.7599203,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":128.759936928,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":128.759941356,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":128.759945463,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":128.764876463,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":128.764892544,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":128.764897133,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":128.764900862,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":128.764914961,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":128.764919095,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":128.76492275,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":128.764926366,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":128.764930059,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.764933978,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":128.764937541,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":128.765495408,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":128.765506049,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":128.765816641,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":128.766381272,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.766392393,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.766397106,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stderr","time":128.768330897,"data":"\n"}
,{"stream_name":"stdout","time":128.768353449,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.76835894,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.768364084,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.768367984,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.96956435,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":128.969632551,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":128.96958309,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stdout","time":128.96980913,"data":"\n"}
,{"stream_name":"stderr","time":128.96982017,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.55s/s]\n"}
,{"stream_name":"stdout","time":128.969825867,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":128.96983415,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":128.971400682,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":128.971418848,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":128.971648918,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":128.971665822,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":128.971870527,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.972045115,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":128.972217793,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":128.97239484,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":128.972404619,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":128.972409015,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":128.972595355,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":128.97265194,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.972728774,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":128.972770225,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.972811494,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":128.972852795,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":128.972919955,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":128.97326808,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":128.973275828,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":128.973280713,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":128.97328468,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":128.973472026,"data":"\n"}
,{"stream_name":"stdout","time":129.11419055,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":129.114266775,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.114286515,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":129.114501765,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 106.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 106.59s/s]\n"}
,{"stream_name":"stdout","time":129.114513169,"data":"\n"}
,{"stream_name":"stdout","time":129.114523304,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":129.114527878,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":129.116554095,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":129.11688613,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.116915599,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":129.116920333,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":129.116924129,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.117060186,"data":"\n"}
,{"stream_name":"stdout","time":129.234999872,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":129.244669972,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":129.244678788,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.244699647,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.244968298,"data":"\n"}
,{"stream_name":"stderr","time":129.244969713,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 117.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 117.48s/s]\n"}
,{"stream_name":"stdout","time":129.244977133,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":129.244984986,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":129.24662839,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":129.246977056,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.246985062,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":129.246989526,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":129.246993587,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.247167996,"data":"\n"}
,{"stream_name":"stderr","time":129.366170892,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.366196572,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.366170809,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stdout","time":129.366407332,"data":"\n"}
,{"stream_name":"stdout","time":129.366421984,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stderr","time":129.366421259,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 126.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 126.03s/s]\n"}
,{"stream_name":"stdout","time":129.366427014,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":129.367949513,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":129.368355558,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.368382666,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.368387625,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.368391693,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.368489249,"data":"\n"}
,{"stream_name":"stdout","time":129.487314332,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":129.487314515,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.487349436,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.487530849,"data":"\n"}
,{"stream_name":"stdout","time":129.487542509,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":129.487547526,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":129.487531249,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 126.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 126.25s/s]\n"}
,{"stream_name":"stdout","time":129.48907965,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":129.48940911,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.489417338,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.489421472,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.489425274,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.489626114,"data":"\n"}
,{"stream_name":"stdout","time":129.546134089,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":129.546157608,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":129.546163278,"data":"  Original dt: 1.869861e+00 s\n"}
,{"stream_name":"stdout","time":129.546167289,"data":"  Corrected dt: 1.168663e+00 s\n"}
,{"stream_name":"stdout","time":129.546170891,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":129.546174729,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":129.608703433,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":129.608742405,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.608759062,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":129.60896899,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 126.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 125.95s/s]\n"}
,{"stream_name":"stdout","time":129.60897469,"data":"\n"}
,{"stream_name":"stdout","time":129.608984384,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":129.60900469,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":129.610440576,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":129.610760329,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.610772388,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.610776659,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.610780718,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.610933078,"data":"\n"}
,{"stream_name":"stdout","time":129.702723089,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stderr","time":129.730487748,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.730516005,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.7304906,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stdout","time":129.730557963,"data":"\n"}
,{"stream_name":"stdout","time":129.73056735,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":129.730582787,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":129.730618799,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 125.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 125.60s/s]\n"}
,{"stream_name":"stdout","time":129.732182527,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":129.732476419,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.732484056,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.73248814,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.732491987,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.732653159,"data":"\n"}
,{"stream_name":"stderr","time":129.852491852,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":129.85252467,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.852491906,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":129.852623934,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 125.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 125.29s/s]\n"}
,{"stream_name":"stdout","time":129.85266059,"data":"\n"}
,{"stream_name":"stdout","time":129.852669038,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":129.852692818,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":129.854248914,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":129.854267489,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":129.854272844,"data":"\n"}
,{"stream_name":"stdout","time":129.85427675,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":129.854280905,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.018\n"}
,{"stream_name":"stdout","time":129.854284957,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":129.854289972,"data":"\n"}
,{"stream_name":"stdout","time":129.854294409,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":129.854299481,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":129.865239171,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":129.865260704,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":129.865265368,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":129.865269674,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":129.870318291,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":129.870335589,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":129.870339908,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":129.870343893,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":129.870347789,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":129.87035154,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":129.870355234,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":129.87035886,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":129.870362759,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.870366703,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":129.870370318,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":129.871028492,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":129.871044594,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":129.871292673,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":129.871942183,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.87196314,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.871969082,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.873826026,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":129.873843615,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.873849147,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":129.873853652,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.874005179,"data":"\n"}
,{"stream_name":"stdout","time":130.033345212,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #1000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":130.033385202,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":130.033390262,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":130.033394871,"data":"[PERIODIC:1000] BC_GPU [Call #1000] About to launch kernel\n"}
,{"stream_name":"stdout","time":130.033399234,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":130.033403842,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":130.033408298,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stderr","time":130.082692948,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.082721086,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.082737865,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":130.082927496,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 71.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 71.87s/s]\n"}
,{"stream_name":"stdout","time":130.082936489,"data":"\n"}
,{"stream_name":"stdout","time":130.082944873,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":130.082949891,"data":"Total runtime: 0.21 seconds.\n"}
,{"stream_name":"stdout","time":130.084556484,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":130.084582102,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":130.084810837,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":130.084827268,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":130.085003503,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":130.085169265,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":130.085371516,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":130.08552448,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":130.085531298,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":130.085553971,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":130.08576073,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":130.085781886,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.085890667,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":130.085897285,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.085952146,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":130.085996879,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":130.086021096,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.086401087,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.086409723,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.086414706,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.086419182,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.086594462,"data":"\n"}
,{"stream_name":"stdout","time":130.222082135,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":130.222133809,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.22214041,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":130.222318542,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 110.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 110.74s/s]\n"}
,{"stream_name":"stdout","time":130.222341224,"data":"\n"}
,{"stream_name":"stdout","time":130.222346333,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":130.22235078,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":130.224350004,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.224671871,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.224706539,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.224711462,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.224715839,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.224889733,"data":"\n"}
,{"stream_name":"stdout","time":130.343378135,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stderr","time":130.352860204,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.352885252,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.352894072,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stdout","time":130.353110859,"data":"\n"}
,{"stream_name":"stderr","time":130.353114082,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 117.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 117.17s/s]\n"}
,{"stream_name":"stdout","time":130.353124475,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":130.353137789,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":130.354871379,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.355152426,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.355165327,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.355170072,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.35517411,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.355312317,"data":"\n"}
,{"stream_name":"stdout","time":130.474678183,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":130.474713466,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.474737367,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.474962858,"data":"\n"}
,{"stream_name":"stderr","time":130.474971574,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 125.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 125.62s/s]\n"}
,{"stream_name":"stdout","time":130.474976093,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":130.474985183,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":130.476972785,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.477414976,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.477428449,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":130.477433949,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":130.477438306,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.477580375,"data":"\n"}
,{"stream_name":"stdout","time":130.511676418,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":130.511715501,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":130.511722658,"data":"  Original dt: 1.866875e+00 s\n"}
,{"stream_name":"stdout","time":130.511727629,"data":"  Corrected dt: 1.166797e+00 s\n"}
,{"stream_name":"stdout","time":130.511732932,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":130.511737775,"data":"  Max wave speed detected: 4.29 m/s\n"}
,{"stream_name":"stderr","time":130.610837217,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.610866514,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.610872777,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":130.610967346,"data":"\n"}
,{"stream_name":"stdout","time":130.610975894,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":130.610980168,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":130.610990452,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 112.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 112.66s/s]\n"}
,{"stream_name":"stdout","time":130.61273308,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":130.612949169,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.612959704,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.612963923,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.612967694,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.613119356,"data":"\n"}
,{"stream_name":"stdout","time":130.757508926,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":130.757502266,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.757538428,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.757788586,"data":"\n"}
,{"stream_name":"stdout","time":130.757822454,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":130.757828374,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":130.757825767,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 104.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 103.87s/s]\n"}
,{"stream_name":"stdout","time":130.759650125,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":130.759915084,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.759924401,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.759944289,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.759948284,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.760083639,"data":"\n"}
,{"stream_name":"stdout","time":130.854956592,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":130.88728483,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":130.887318515,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.887336425,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.887664207,"data":"\n"}
,{"stream_name":"stdout","time":130.887680467,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":130.887685266,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":130.887700114,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 118.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 117.85s/s]\n"}
,{"stream_name":"stdout","time":130.889426841,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":130.889764569,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":130.889780732,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.889786877,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":130.889791024,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.88995872,"data":"\n"}
,{"stream_name":"stdout","time":131.026566342,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":131.026631425,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.026713921,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.026861973,"data":"\n"}
,{"stream_name":"stdout","time":131.0268756,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":131.026881408,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":131.026888531,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 109.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 109.79s/s]\n"}
,{"stream_name":"stdout","time":131.028739863,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":131.028761264,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":131.028796095,"data":"\n"}
,{"stream_name":"stdout","time":131.028836428,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":131.02884207,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.06 | Avg Reward/Step: 0.007\n"}
,{"stream_name":"stdout","time":131.028846043,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":131.028851467,"data":"\n"}
,{"stream_name":"stdout","time":131.028854923,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":131.028858156,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":131.041027083,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":131.041043943,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":131.041048231,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":131.041052352,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":131.046093649,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":131.046110892,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":131.046116089,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":131.046120891,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":131.046166959,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":131.046173544,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":131.046178367,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":131.046231496,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":131.046244404,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.046286658,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":131.046294414,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":131.046969108,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":131.046986207,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":131.047270894,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":131.047508058,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.047518231,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.047522927,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":131.049305115,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.049322205,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.049326993,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":131.049331069,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.049474799,"data":"\n"}
,{"stream_name":"stdout","time":131.250385464,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":131.250449684,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.25046708,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":131.250650616,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.65s/s]\n"}
,{"stream_name":"stdout","time":131.250652489,"data":"\n"}
,{"stream_name":"stdout","time":131.25067855,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":131.250683696,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":131.252417488,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":131.252436312,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":131.252664836,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":131.252681089,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":131.252867165,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":131.253035359,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":131.2531992,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":131.253365132,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":131.253374147,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":131.25337834,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":131.253558289,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":131.253622832,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.253684565,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":131.25375046,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.25375789,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":131.253832491,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":131.253840787,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":131.254211718,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.254223383,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.254227777,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":131.254250209,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.254407031,"data":"\n"}
,{"stream_name":"stdout","time":131.389411971,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":131.389434631,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.389461067,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.389688888,"data":"\n"}
,{"stream_name":"stdout","time":131.389709276,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":131.38971417,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":131.38973327,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.09s/s]\n"}
,{"stream_name":"stdout","time":131.391298403,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":131.391618835,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.391637113,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.391642422,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":131.3916467,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.391821611,"data":"\n"}
,{"stream_name":"stdout","time":131.518151235,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stderr","time":131.527968594,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.527997582,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.527977641,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stdout","time":131.528107122,"data":"\n"}
,{"stream_name":"stdout","time":131.528116024,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":131.528120262,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":131.528115877,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 110.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 110.21s/s]\n"}
,{"stream_name":"stdout","time":131.52990039,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":131.530219895,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.530226665,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.530230958,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":131.530251473,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.530421802,"data":"\n"}
,{"stream_name":"stdout","time":131.532066717,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":131.532084058,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":131.532089352,"data":"  Original dt: 1.847050e+00 s\n"}
,{"stream_name":"stdout","time":131.532093516,"data":"  Corrected dt: 1.154406e+00 s\n"}
,{"stream_name":"stdout","time":131.532098036,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":131.532102214,"data":"  Max wave speed detected: 4.33 m/s\n"}
,{"stream_name":"stderr","time":131.653429039,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.653458373,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.653465149,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stdout","time":131.653627364,"data":"\n"}
,{"stream_name":"stdout","time":131.653645,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":131.653650666,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":131.653629345,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 122.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 122.03s/s]\n"}
,{"stream_name":"stdout","time":131.655442892,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":131.655886113,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.65589899,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.65590385,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":131.655907681,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.656094435,"data":"\n"}
,{"stream_name":"stderr","time":131.773719811,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":131.773739585,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":131.773749229,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":131.773893075,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 127.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 127.56s/s]\n"}
,{"stream_name":"stdout","time":131.773926236,"data":"\n"}
,{"stream_name":"stdout","time":131.773935893,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":131.773940622,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":131.775568808,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":131.775867284,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.775878607,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.775883094,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":131.775886983,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.776039194,"data":"\n"}
,{"stream_name":"stdout","time":131.892181365,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":131.89218074,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.892218086,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.892432734,"data":"\n"}
,{"stream_name":"stderr","time":131.892432965,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 129.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 129.12s/s]\n"}
,{"stream_name":"stdout","time":131.89244092,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":131.892448847,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":131.894097429,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":131.894390857,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":131.894397507,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":131.894401612,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":131.894405627,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.894612809,"data":"\n"}
,{"stream_name":"stdout","time":131.985771746,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":132.012059906,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":132.012113927,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.012131221,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.012342617,"data":"\n"}
,{"stream_name":"stdout","time":132.012351791,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stderr","time":132.012348046,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 127.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 127.66s/s]\n"}
,{"stream_name":"stdout","time":132.012356879,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":132.013930854,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":132.014244691,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.014253577,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.014258252,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":132.014262396,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.014434295,"data":"\n"}
,{"stream_name":"stderr","time":132.131017337,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.131046112,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.131050507,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stdout","time":132.131272042,"data":"\n"}
,{"stream_name":"stderr","time":132.131277526,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.66s/s]\n"}
,{"stream_name":"stdout","time":132.131281606,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":132.131304627,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":132.132821591,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":132.132845613,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":132.132850283,"data":"\n"}
,{"stream_name":"stdout","time":132.132854107,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":132.132858325,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":132.132862515,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":132.132866569,"data":"\n"}
,{"stream_name":"stdout","time":132.132870517,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":132.132875214,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":132.143503051,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":132.143519719,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":132.143524694,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":132.143528793,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":132.148306606,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":132.148322981,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":132.14832821,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":132.148332534,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":132.148373994,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":132.148387227,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":132.148391444,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":132.148478321,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":132.148487384,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.148491619,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":132.148495092,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":132.149083723,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":132.149099379,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":132.149334902,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":132.149553818,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.149564044,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.149568539,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.151329735,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":132.151344984,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":132.151349117,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":132.151352926,"data":"|    ep_rew_mean      | 0.0825   |\n"}
,{"stream_name":"stdout","time":132.151356518,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":132.151360147,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":132.151364089,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":132.151367962,"data":"|    fps              | 4        |\n"}
,{"stream_name":"stdout","time":132.151371781,"data":"|    time_elapsed     | 6        |\n"}
,{"stream_name":"stdout","time":132.15137523,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":132.151379022,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":132.152467542,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.152483433,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.152488326,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.15249202,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.15265986,"data":"\n"}
,{"stream_name":"stdout","time":132.352529397,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":132.352530218,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.352577329,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.352813803,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.04s/s]\n"}
,{"stream_name":"stdout","time":132.352821413,"data":"\n"}
,{"stream_name":"stdout","time":132.352853056,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":132.352859514,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":132.354374704,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":132.354388995,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":132.354635053,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":132.35464571,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":132.354840476,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":132.355019989,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":132.355194915,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":132.355369014,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":132.355374704,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":132.355378398,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":132.355571218,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":132.355578191,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.355686771,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":132.355718449,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.355736837,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":132.355802861,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":132.355859257,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":132.356158731,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.356167016,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.356171667,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.356176377,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.356330834,"data":"\n"}
,{"stream_name":"stdout","time":132.465846192,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #2000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":132.46587601,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":132.465897631,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":132.46590208,"data":"[PERIODIC:1000] BC_GPU [Call #2000] About to launch kernel\n"}
,{"stream_name":"stdout","time":132.46590589,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":132.465910375,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":132.465914998,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":132.472653297,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":132.472673592,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.472678744,"data":"  Original dt: 1.745096e+00 s\n"}
,{"stream_name":"stdout","time":132.472684074,"data":"  Corrected dt: 1.090685e+00 s\n"}
,{"stream_name":"stdout","time":132.47268771,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.472691622,"data":"  Max wave speed detected: 4.58 m/s\n"}
,{"stream_name":"stderr","time":132.489950454,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":132.489955669,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":132.48996712,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.490236916,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 112.39s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 112.22s/s]\n"}
,{"stream_name":"stdout","time":132.490241654,"data":"\n"}
,{"stream_name":"stdout","time":132.490256679,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":132.490261289,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":132.491829049,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":132.492122003,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.49213434,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.492139558,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":132.492143576,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.492278888,"data":"\n"}
,{"stream_name":"stdout","time":132.608389392,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":132.617817831,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":132.617827331,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.617837823,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.61810474,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 119.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 119.38s/s]\n"}
,{"stream_name":"stdout","time":132.618135416,"data":"\n"}
,{"stream_name":"stdout","time":132.618144398,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":132.618148486,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":132.61967761,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":132.619983944,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.619992424,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.619996908,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":132.620002256,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.620173265,"data":"\n"}
,{"stream_name":"stderr","time":132.736182146,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.736212475,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.736192667,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stdout","time":132.736224401,"data":"\n"}
,{"stream_name":"stdout","time":132.73622849,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":132.736232313,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":132.736227848,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.47s/s]\n"}
,{"stream_name":"stdout","time":132.738026295,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":132.738353204,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.738363772,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.738368577,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":132.738373095,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.738534039,"data":"\n"}
,{"stream_name":"stdout","time":132.8568976,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":132.856931466,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.85695123,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.857207825,"data":"\n"}
,{"stream_name":"stderr","time":132.857210196,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 126.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 126.66s/s]\n"}
,{"stream_name":"stdout","time":132.857218907,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":132.857251586,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":132.8589358,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":132.859236949,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.859244783,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.859249685,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.859254163,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.859398378,"data":"\n"}
,{"stream_name":"stderr","time":132.98219955,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.982226786,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.98224088,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stdout","time":132.982441719,"data":"\n"}
,{"stream_name":"stderr","time":132.982451085,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 122.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 122.16s/s]\n"}
,{"stream_name":"stdout","time":132.982457038,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":132.982479076,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":132.984024953,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":132.984337485,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":132.98434673,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.98435193,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.984356023,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.984515013,"data":"\n"}
,{"stream_name":"stdout","time":133.076086374,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":133.103632465,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":133.103632416,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.103674294,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.103884224,"data":"\n"}
,{"stream_name":"stdout","time":133.103892219,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":133.103896867,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":133.103891742,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 126.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 125.92s/s]\n"}
,{"stream_name":"stdout","time":133.10558371,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":133.105913679,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.105928069,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.105932864,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.105937333,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.10609363,"data":"\n"}
,{"stream_name":"stdout","time":133.221824461,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":133.221850243,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.221872354,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.222004053,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.62s/s]\n"}
,{"stream_name":"stdout","time":133.222048502,"data":"\n"}
,{"stream_name":"stdout","time":133.222058432,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":133.222062742,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":133.223551294,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.223568367,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":133.223573667,"data":"\n"}
,{"stream_name":"stdout","time":133.22357805,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.223582425,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":133.223586409,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.223595397,"data":"\n"}
,{"stream_name":"stdout","time":133.2236244,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":133.223629752,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":133.234398994,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":133.234416494,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":133.234421393,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":133.234425877,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":133.239268312,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":133.239281398,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":133.239286288,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":133.239290365,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":133.239378633,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":133.239386881,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":133.239391739,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":133.239398196,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":133.239410112,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.239483459,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":133.239490859,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":133.240149555,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":133.240162333,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":133.240464782,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":133.240767548,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.24078726,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.240791934,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.242616107,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.242628202,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.242633396,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.242638111,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.242820022,"data":"\n"}
,{"stream_name":"stdout","time":133.414634659,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":133.414663214,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":133.414668471,"data":"  Original dt: 1.391179e+00 s\n"}
,{"stream_name":"stdout","time":133.414673883,"data":"  Corrected dt: 8.694871e-01 s\n"}
,{"stream_name":"stdout","time":133.414677592,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":133.414680584,"data":"  Max wave speed detected: 5.75 m/s\n"}
,{"stream_name":"stderr","time":133.440990137,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.441016065,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.440991457,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":133.441220937,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.69s/s]\n"}
,{"stream_name":"stdout","time":133.441221979,"data":"\n"}
,{"stream_name":"stdout","time":133.441261797,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":133.441266677,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":133.442660254,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":133.442677977,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":133.442885029,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.65673774 1.         0.6746973  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":133.442895117,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":133.443047961,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":133.443199928,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":133.443374865,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19702134 0.2072735  0.21115741 0.21222052 0.21245109 0.21249263]\n"}
,{"stream_name":"stdout","time":133.443540181,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.1012046  0.10238536 0.10217475 0.10204492 0.1020088  0.10200143]\n"}
,{"stream_name":"stdout","time":133.443548885,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":133.443552639,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":133.443794821,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":133.443829334,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.443926318,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":133.443935215,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.443980474,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":133.44402419,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":133.444063684,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.444423655,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.444434144,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.444438935,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.444443422,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.4446268,"data":"\n"}
,{"stream_name":"stdout","time":133.578255855,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":133.578304274,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.578349874,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.578499796,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 112.41s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 112.26s/s]\n"}
,{"stream_name":"stdout","time":133.578509826,"data":"\n"}
,{"stream_name":"stdout","time":133.578521686,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":133.578526091,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":133.580116607,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":133.580459957,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.580472761,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.580478196,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":133.580482745,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.580548963,"data":"\n"}
,{"stream_name":"stdout","time":133.696466126,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":133.70559625,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":133.705596249,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.70565048,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.705852393,"data":"\n"}
,{"stream_name":"stdout","time":133.705861572,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":133.705866397,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":133.705861371,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.00s/s]\n"}
,{"stream_name":"stdout","time":133.707412609,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.707693603,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.707710731,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.70771544,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.707719364,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.707890778,"data":"\n"}
,{"stream_name":"stderr","time":133.822216283,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":133.822237979,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":133.822246326,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.822449153,"data":"\n"}
,{"stream_name":"stderr","time":133.822456514,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 131.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 131.18s/s]\n"}
,{"stream_name":"stdout","time":133.822463166,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":133.822473912,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":133.824054263,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.824451688,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.824464236,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.824469148,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.824473392,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.824635192,"data":"\n"}
,{"stream_name":"stdout","time":133.941931993,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":133.9419317,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.941965822,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.94213628400001,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 127.94s/s]\n"}
,{"stream_name":"stdout","time":133.942136559,"data":"\n"}
,{"stream_name":"stdout","time":133.942148811,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":133.942153731,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":133.943771504,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":133.944087002,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":133.944095852,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.944101232,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":133.9441055,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.944276997,"data":"\n"}
,{"stream_name":"stdout","time":134.06416079,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":134.064187368,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.064204459,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.064409684,"data":"\n"}
,{"stream_name":"stdout","time":134.064420609,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":134.064425233,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":134.064428587,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 125.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 125.09s/s]\n"}
,{"stream_name":"stdout","time":134.065961377,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.066243384,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.066250975,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.066255186,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.066259071,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.066406227,"data":"\n"}
,{"stream_name":"stdout","time":134.15524923,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":134.182137366,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":134.182159581,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.182189839,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.182411568,"data":"\n"}
,{"stream_name":"stderr","time":134.182412245,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 129.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 129.55s/s]\n"}
,{"stream_name":"stdout","time":134.182420989,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":134.182430482,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":134.183950107,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":134.184241269,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.184248989,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.184253251,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.18425722,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.184431682,"data":"\n"}
,{"stream_name":"stderr","time":134.30068769,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.300726815,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.300698772,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":134.300917815,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.06s/s]\n"}
,{"stream_name":"stdout","time":134.300929654,"data":"\n"}
,{"stream_name":"stdout","time":134.30094219,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":134.300946405,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":134.302497526,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.302512183,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":134.302517101,"data":"\n"}
,{"stream_name":"stdout","time":134.302520714,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":134.302526174,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":134.302530077,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":134.302535536,"data":"\n"}
,{"stream_name":"stdout","time":134.302579725,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":134.30258715,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":134.313620437,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":134.313639368,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":134.313644586,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":134.31364882,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":134.318786748,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":134.318798514,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":134.318803032,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":134.318806773,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":134.318884516,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":134.318891595,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":134.318895992,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":134.318996703,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":134.319010154,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.319015156,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":134.319034999,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":134.319617315,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":134.319633675,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":134.319942896,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":134.320165607,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.32017495,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.32017924,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.321978217,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.32199321,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.321998142,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.322001939,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.322135653,"data":"\n"}
,{"stream_name":"stdout","time":134.351021556,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":134.351045893,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.351050014,"data":"  Original dt: 8.992703e-01 s\n"}
,{"stream_name":"stdout","time":134.351052749,"data":"  Corrected dt: 5.620439e-01 s\n"}
,{"stream_name":"stdout","time":134.351055209,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.351058109,"data":"  Max wave speed detected: 8.90 m/s\n"}
,{"stream_name":"stderr","time":134.521498316,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.521528277,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.521509847,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":134.521771396,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.26s/s]\n"}
,{"stream_name":"stdout","time":134.521779861,"data":"\n"}
,{"stream_name":"stdout","time":134.521807504,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":134.521812419,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":134.523339983,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":134.523357128,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":134.52355099,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":134.523560694,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":134.523741238,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":134.523934885,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":134.524110555,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":134.524293258,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":134.524317735,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":134.524322645,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":134.524498338,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":134.524551117,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":134.524633329,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":134.524677514,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":134.524746072,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":134.524754037,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":134.524813808,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.525190779,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.525201573,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.525206242,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.525209889,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.525368097,"data":"\n"}
,{"stream_name":"stderr","time":134.660523448,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.660560895,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.660587889,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stdout","time":134.660805106,"data":"\n"}
,{"stream_name":"stderr","time":134.6608145,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 110.99s/s]\n"}
,{"stream_name":"stdout","time":134.660834934,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":134.66084061,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":134.662358344,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.680815076,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.2 min | Speed: 5.4 steps/s\n"}
,{"stream_name":"stdout","time":134.680994197,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.681002578,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.681006811,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.68101075,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.68120942,"data":"\n"}
,{"stream_name":"stdout","time":134.797105706,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":134.806060337,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":134.806076686,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.806087165,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":134.806372057,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.05s/s]\n"}
,{"stream_name":"stdout","time":134.806385315,"data":"\n"}
,{"stream_name":"stdout","time":134.806393842,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":134.806413738,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":134.808116341,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":134.808431559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.808440431,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.808445295,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.808449196,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.808622174,"data":"\n"}
,{"stream_name":"stdout","time":134.81505961,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #3000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":134.815075393,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":134.815078835,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":134.81508179,"data":"[PERIODIC:1000] BC_GPU [Call #3000] About to launch kernel\n"}
,{"stream_name":"stdout","time":134.815084551,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":134.815087203,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":134.81508973,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stderr","time":134.926075223,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.92610412,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.926087638,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":134.926237134,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 127.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 127.72s/s]\n"}
,{"stream_name":"stdout","time":134.926264804,"data":"\n"}
,{"stream_name":"stdout","time":134.926275102,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":134.926292654,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":134.927836901,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":134.928218035,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":134.928229714,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.928233978,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":134.928237851,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.92839207,"data":"\n"}
,{"stream_name":"stderr","time":135.056115294,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.056142176,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.056112282,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":135.056392155,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 117.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 117.35s/s]\n"}
,{"stream_name":"stdout","time":135.056419823,"data":"\n"}
,{"stream_name":"stdout","time":135.056424932,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":135.056429462,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":135.058184424,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.058501096,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.058508682,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.058514493,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.058519027,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.058738493,"data":"\n"}
,{"stream_name":"stderr","time":135.194166233,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.194198917,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.194194297,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stdout","time":135.194423616,"data":"\n"}
,{"stream_name":"stdout","time":135.194433562,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":135.194438235,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stderr","time":135.194447722,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 111.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 111.01s/s]\n"}
,{"stream_name":"stdout","time":135.196009057,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.196307874,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.19631842,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.196322695,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.19632665,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.19650691,"data":"\n"}
,{"stream_name":"stdout","time":135.286685095,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":135.313716054,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":135.313776029,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.313791866,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.313956027,"data":"\n"}
,{"stream_name":"stderr","time":135.313956614,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.03s/s]\n"}
,{"stream_name":"stdout","time":135.313966,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":135.313974784,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":135.315658019,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.315980721,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.315987994,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.315992004,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.315995892,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.316171675,"data":"\n"}
,{"stream_name":"stdout","time":135.317377061,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":135.317396014,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.317401111,"data":"  Original dt: 1.870334e+00 s\n"}
,{"stream_name":"stdout","time":135.31740524,"data":"  Corrected dt: 1.168958e+00 s\n"}
,{"stream_name":"stdout","time":135.317409266,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.317413325,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stderr","time":135.433506329,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.433537224,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.433521555,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":135.433619964,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 128.02s/s]\n"}
,{"stream_name":"stdout","time":135.433624591,"data":"\n"}
,{"stream_name":"stdout","time":135.433643659,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":135.433648241,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":135.435384013,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":135.435402422,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":135.435407437,"data":"\n"}
,{"stream_name":"stdout","time":135.435413018,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.435416459,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.04 | Avg Reward/Step: 0.005\n"}
,{"stream_name":"stdout","time":135.43541901,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.435421557,"data":"\n"}
,{"stream_name":"stdout","time":135.435423962,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":135.435426753,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":135.445781504,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":135.445801074,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":135.445806146,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":135.445810236,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":135.450633162,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":135.450650919,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":135.450656322,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":135.450660649,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":135.450665027,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":135.450669327,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":135.4506734,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":135.450678003,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":135.450681802,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.450685626,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":135.450689157,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":135.451220629,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":135.451227666,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":135.451492559,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":135.451781081,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.451792824,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.451797259,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.453567646,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.453579816,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.453584304,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":135.453588136,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.453769523,"data":"\n"}
,{"stream_name":"stderr","time":135.649616515,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.649643827,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":135.649667073,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.66s/s]\n"}
,{"stream_name":"stdout","time":135.649666729,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stdout","time":135.649722953,"data":"\n"}
,{"stream_name":"stdout","time":135.649728263,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":135.649732097,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":135.651144623,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":135.651161159,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":135.651381664,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.65673774 1.         0.6746973  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":135.651389322,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":135.651554182,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":135.651736017,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":135.651909869,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19702134 0.2072735  0.21115741 0.21222052 0.21245109 0.21249263]\n"}
,{"stream_name":"stdout","time":135.652077511,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.1012046  0.10238536 0.10217475 0.10204492 0.1020088  0.10200143]\n"}
,{"stream_name":"stdout","time":135.652085073,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":135.652089529,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":135.652257747,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":135.652299364,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":135.652379082,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":135.652403304,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":135.652451852,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":135.652458882,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":135.652509968,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.652874303,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.652886796,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.652891526,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":135.652895428,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.653047678,"data":"\n"}
,{"stream_name":"stderr","time":135.788779057,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.788817757,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.788852941,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stdout","time":135.788861682,"data":"\n"}
,{"stream_name":"stdout","time":135.788865746,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stderr","time":135.788861744,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 110.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 110.62s/s]\n"}
,{"stream_name":"stdout","time":135.788869808,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":135.790494758,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":135.790670162,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.790686039,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.790690913,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":135.790694787,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.79086995,"data":"\n"}
,{"stream_name":"stdout","time":135.922832821,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":135.931668476,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":135.931700013,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.931717606,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":135.931868067,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 106.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 106.56s/s]\n"}
,{"stream_name":"stdout","time":135.931874842,"data":"\n"}
,{"stream_name":"stdout","time":135.931888185,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":135.931892352,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":135.933393007,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":135.933695451,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":135.933712287,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.933717263,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":135.933721053,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.933943296,"data":"\n"}
,{"stream_name":"stderr","time":136.049115411,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.049149269,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.049113025,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stdout","time":136.04945012,"data":"\n"}
,{"stream_name":"stdout","time":136.049457899,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":136.049462427,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":136.049469116,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.03s/s]\n"}
,{"stream_name":"stdout","time":136.051132027,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.051543532,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.051551595,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.051556582,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":136.051561205,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.051760537,"data":"\n"}
,{"stream_name":"stdout","time":136.169679094,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":136.169739623,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.169758461,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.169967788,"data":"\n"}
,{"stream_name":"stderr","time":136.169975027,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 127.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 127.15s/s]\n"}
,{"stream_name":"stdout","time":136.169978665,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":136.170004447,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":136.171613781,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":136.171916648,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.171925157,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.171929308,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":136.171933163,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.172107022,"data":"\n"}
,{"stream_name":"stdout","time":136.263477437,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":136.2635093,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.263522834,"data":"  Original dt: 1.870060e+00 s\n"}
,{"stream_name":"stdout","time":136.263527205,"data":"  Corrected dt: 1.168788e+00 s\n"}
,{"stream_name":"stdout","time":136.263531377,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.263535523,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stderr","time":136.290005387,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.29003581,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.290015603,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stdout","time":136.290206851,"data":"\n"}
,{"stream_name":"stdout","time":136.290221394,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":136.290225761,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":136.290237119,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 127.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 127.27s/s]\n"}
,{"stream_name":"stdout","time":136.29183464,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":136.292115493,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.292127035,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.292132041,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.292135959,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.292284858,"data":"\n"}
,{"stream_name":"stdout","time":136.382586463,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stderr","time":136.410146774,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.410185761,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.410155166,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stdout","time":136.41036291,"data":"\n"}
,{"stream_name":"stdout","time":136.41037693,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":136.410381496,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":136.410361953,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 127.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 127.28s/s]\n"}
,{"stream_name":"stdout","time":136.41194891,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.412240679,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.412253709,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.412258175,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.412262276,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.412420851,"data":"\n"}
,{"stream_name":"stderr","time":136.535089339,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.535129452,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.535094878,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":136.5353178,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 122.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 122.27s/s]\n"}
,{"stream_name":"stdout","time":136.535323828,"data":"\n"}
,{"stream_name":"stdout","time":136.535340572,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":136.535345887,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":136.537093488,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.537113592,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":136.537119047,"data":"\n"}
,{"stream_name":"stdout","time":136.537123939,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.537128316,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":136.537132891,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":136.537151128,"data":"\n"}
,{"stream_name":"stdout","time":136.537156187,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":136.537161536,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":136.548340152,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":136.54835951,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":136.54836449,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":136.548369491,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":136.553498291,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":136.553516584,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":136.553521801,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":136.553526829,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":136.553556101,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":136.55357901,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":136.553584497,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":136.553631658,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":136.553643054,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.553722527,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":136.553729232,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":136.554404044,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":136.554417131,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":136.554736529,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":136.555025652,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.555037184,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.555042984,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.557077398,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":136.557094246,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":136.557099534,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":136.557103653,"data":"|    ep_rew_mean      | 0.09     |\n"}
,{"stream_name":"stdout","time":136.55710788,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":136.557111827,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":136.557116023,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":136.557120043,"data":"|    fps              | 5        |\n"}
,{"stream_name":"stdout","time":136.557123945,"data":"|    time_elapsed     | 11       |\n"}
,{"stream_name":"stdout","time":136.557127594,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":136.557144963,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":136.55830596,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.558320732,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.558326148,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.558330718,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.558496157,"data":"\n"}
,{"stream_name":"stderr","time":136.757581683,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.757629948,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.757582142,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stdout","time":136.757849956,"data":"\n"}
,{"stream_name":"stderr","time":136.757847848,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 75.34s/s]\n"}
,{"stream_name":"stdout","time":136.757857791,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":136.757867343,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":136.759360395,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":136.759375803,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":136.75959246,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":136.75961545,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":136.759823252,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":136.759987501,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":136.760161925,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":136.760309798,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":136.760325425,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":136.760330295,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":136.760516235,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":136.760558492,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":136.760654394,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":136.760716613,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":136.760729851,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":136.760742736,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":136.760803898,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.761138742,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.761149002,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.761153319,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":136.761157271,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.761312001,"data":"\n"}
,{"stream_name":"stdout","time":136.898514811,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":136.898550032,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.898557064,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.898760968,"data":"\n"}
,{"stream_name":"stdout","time":136.898779214,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stderr","time":136.898760106,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 109.46s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 109.31s/s]\n"}
,{"stream_name":"stdout","time":136.898783845,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":136.900360306,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.900652643,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":136.900670588,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.900675826,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":136.900680717,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.900870482,"data":"\n"}
,{"stream_name":"stdout","time":137.020241261,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":137.029407872,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":137.029450011,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.029468026,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.029739868,"data":"\n"}
,{"stream_name":"stdout","time":137.029757881,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":137.029762669,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":137.029764305,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 116.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 116.61s/s]\n"}
,{"stream_name":"stdout","time":137.031307719,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.031725978,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.03174521,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.031751361,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":137.031756268,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.031788688,"data":"\n"}
,{"stream_name":"stderr","time":137.150978829,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.151013284,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.151020138,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":137.151239308,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 126.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 125.88s/s]\n"}
,{"stream_name":"stdout","time":137.1512461,"data":"\n"}
,{"stream_name":"stdout","time":137.151261578,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":137.151266312,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":137.152934137,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.153359448,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.15336765,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.153372228,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":137.153377756,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.153569543,"data":"\n"}
,{"stream_name":"stdout","time":137.206936099,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #4000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":137.206964111,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":137.20697005,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.206974313,"data":"[PERIODIC:1000] BC_GPU [Call #4000] About to launch kernel\n"}
,{"stream_name":"stdout","time":137.206978453,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.206982508,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":137.206986671,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":137.2233631,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":137.223401334,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.223407565,"data":"  Original dt: 1.868212e+00 s\n"}
,{"stream_name":"stdout","time":137.223411793,"data":"  Corrected dt: 1.167633e+00 s\n"}
,{"stream_name":"stdout","time":137.223415743,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.223419796,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":137.278867647,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":137.27890254,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.278920631,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.27909774,"data":"\n"}
,{"stream_name":"stderr","time":137.279103149,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 119.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 119.75s/s]\n"}
,{"stream_name":"stdout","time":137.2791094,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":137.279119034,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":137.280768566,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.281046182,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.281057541,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.281062545,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.281067162,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.281230359,"data":"\n"}
,{"stream_name":"stdout","time":137.401342369,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":137.401370726,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.401390716,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.401538038,"data":"\n"}
,{"stream_name":"stdout","time":137.401546191,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":137.401550226,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":137.401563705,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 125.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 124.87s/s]\n"}
,{"stream_name":"stdout","time":137.403125663,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.403435503,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.403458753,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.403463273,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.403467007,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.40361235,"data":"\n"}
,{"stream_name":"stdout","time":137.493560102,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":137.520916275,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":137.520927518,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.520946648,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.521209349,"data":"\n"}
,{"stream_name":"stdout","time":137.521218464,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stderr","time":137.52121494,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 127.83s/s]\n"}
,{"stream_name":"stdout","time":137.521222978,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":137.522809029,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.523100532,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.52311223,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.523116639,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.523120426,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.523264161,"data":"\n"}
,{"stream_name":"stderr","time":137.6385952,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.638641849,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.638651621,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":137.638837793,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 130.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 130.02s/s]\n"}
,{"stream_name":"stdout","time":137.638839969,"data":"\n"}
,{"stream_name":"stdout","time":137.638856118,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":137.638860528,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":137.640389757,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.640406183,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":137.640431422,"data":"\n"}
,{"stream_name":"stdout","time":137.640436437,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.640441004,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.018\n"}
,{"stream_name":"stdout","time":137.640444945,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.640448705,"data":"\n"}
,{"stream_name":"stdout","time":137.640452201,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":137.640457993,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":137.651044718,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":137.651060767,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":137.651064896,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":137.651070813,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":137.655919453,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":137.655936399,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":137.655941193,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":137.655944874,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":137.655972506,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":137.6559882,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":137.655992831,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":137.656032575,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":137.656040824,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.656064027,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":137.656067205,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":137.656693528,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":137.656706273,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":137.656994908,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":137.657245068,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.657251878,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.65725685,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.659090092,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.659101548,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.659106457,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":137.659110761,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.659252376,"data":"\n"}
,{"stream_name":"stdout","time":137.855835659,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":137.85583633,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.855875612,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":137.85613039,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.27s/s]\n"}
,{"stream_name":"stdout","time":137.856150823,"data":"\n"}
,{"stream_name":"stdout","time":137.856167584,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":137.856172749,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":137.857840252,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":137.857857608,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":137.85803601,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.65673774 1.         0.6746973  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":137.858046425,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":137.85821216,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":137.858371846,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":137.858554428,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19702134 0.2072735  0.21115741 0.21222052 0.21245109 0.21249263]\n"}
,{"stream_name":"stdout","time":137.858756818,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.1012046  0.10238536 0.10217475 0.10204492 0.1020088  0.10200143]\n"}
,{"stream_name":"stdout","time":137.858772619,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":137.858777365,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":137.858969505,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":137.85901574,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":137.859102577,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":137.859111273,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":137.859162679,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":137.859205742,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":137.859235447,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.859619774,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.859636736,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.859666672,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":137.859670835,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.85978751,"data":"\n"}
,{"stream_name":"stdout","time":137.994089224,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":137.994136345,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.994153916,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":137.99436759,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.64s/s]\n"}
,{"stream_name":"stdout","time":137.994367571,"data":"\n"}
,{"stream_name":"stdout","time":137.994380413,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":137.99438505,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":137.995980112,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.996276694,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":137.996285231,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.996289449,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":137.99629342,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.996435886,"data":"\n"}
,{"stream_name":"stdout","time":138.112929709,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":138.12204056,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":138.122069762,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.122086908,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.122242663,"data":"\n"}
,{"stream_name":"stdout","time":138.122252167,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":138.122256324,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":138.122272125,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 119.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 119.45s/s]\n"}
,{"stream_name":"stdout","time":138.123815516,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.124087977,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.124099336,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.124122555,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.124126972,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.124255532,"data":"\n"}
,{"stream_name":"stdout","time":138.16130356,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":138.161329705,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.161333851,"data":"  Original dt: 1.855826e+00 s\n"}
,{"stream_name":"stdout","time":138.161336902,"data":"  Corrected dt: 1.159891e+00 s\n"}
,{"stream_name":"stdout","time":138.161339398,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.161342028,"data":"  Max wave speed detected: 4.31 m/s\n"}
,{"stream_name":"stdout","time":138.240305699,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":138.240353211,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.240370512,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.240533105,"data":"\n"}
,{"stream_name":"stdout","time":138.240542351,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":138.240547428,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":138.240550074,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.21s/s]\n"}
,{"stream_name":"stdout","time":138.242203184,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.242637532,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.24265027,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.242654766,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":138.242658626,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.2428403,"data":"\n"}
,{"stream_name":"stderr","time":138.359771983,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":138.359785375,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":138.359804598,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.360004186,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.29s/s]\n"}
,{"stream_name":"stdout","time":138.360007116,"data":"\n"}
,{"stream_name":"stdout","time":138.360022306,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":138.360026748,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":138.361557657,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.361885979,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.361897522,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.361901756,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.361905742,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.362065,"data":"\n"}
,{"stream_name":"stderr","time":138.480615133,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":138.480632789,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":138.480646332,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.480840484,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 126.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 126.52s/s]\n"}
,{"stream_name":"stdout","time":138.480850879,"data":"\n"}
,{"stream_name":"stdout","time":138.48085931,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":138.480863832,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":138.482523252,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.482873342,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.482884861,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.482889286,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.482893363,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.483052744,"data":"\n"}
,{"stream_name":"stdout","time":138.571814025,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stderr","time":138.599617434,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.59965525,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.599623354,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":138.59973521,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 129.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.86s/s]\n"}
,{"stream_name":"stdout","time":138.599758084,"data":"\n"}
,{"stream_name":"stdout","time":138.599765629,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":138.599769939,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":138.601333062,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.60158616,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.601594624,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.601618464,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":138.601623561,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.601781348,"data":"\n"}
,{"stream_name":"stdout","time":138.716635132,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":138.716640715,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.71667026,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.716780465,"data":"\n"}
,{"stream_name":"stderr","time":138.71678024,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 130.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 130.71s/s]\n"}
,{"stream_name":"stdout","time":138.716787966,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":138.716804318,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":138.718417401,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.71843616,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":138.718440838,"data":"\n"}
,{"stream_name":"stdout","time":138.718444664,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.718448709,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":138.718452803,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.718456803,"data":"\n"}
,{"stream_name":"stdout","time":138.718460565,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":138.718464886,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":138.728653576,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":138.728670889,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":138.72867516,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":138.728679132,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":138.733301707,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":138.733319923,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":138.733324537,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":138.7333473,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":138.733357182,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":138.733361653,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":138.733365807,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":138.733369886,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":138.733428227,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.733441021,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":138.733447491,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":138.73413738,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":138.734156133,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":138.734436217,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":138.734717742,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.734733927,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.734739483,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.736575374,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.736592082,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.73659687,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.736620707,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.736769954,"data":"\n"}
,{"stream_name":"stderr","time":138.932743806,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.932779567,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.932750238,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stdout","time":138.932858264,"data":"\n"}
,{"stream_name":"stderr","time":138.932864828,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.59s/s]\n"}
,{"stream_name":"stdout","time":138.932871843,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":138.932881376,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":138.934488743,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":138.934507348,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":138.93458864,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":138.934618341,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":138.934873894,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":138.935039436,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":138.935240108,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":138.93541196,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":138.935421733,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":138.935426036,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":138.935649852,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":138.935696844,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":138.935772293,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":138.935846891,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":138.935856277,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":138.935881358,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":138.93591358,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.93624392,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":138.936252023,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.936257035,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.936260857,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.936431407,"data":"\n"}
,{"stream_name":"stdout","time":139.071493075,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":139.071517066,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.07153333,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.071734883,"data":"\n"}
,{"stream_name":"stderr","time":139.071742629,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.08s/s]\n"}
,{"stream_name":"stdout","time":139.071750935,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":139.071761409,"data":"Total runtime: 0.14 seconds.\n"}
,{"stream_name":"stdout","time":139.073353927,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.073564696,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.073577022,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.073582153,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.073586611,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.073768213,"data":"\n"}
,{"stream_name":"stdout","time":139.09351355,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":139.093533734,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.093537631,"data":"  Original dt: 1.786271e+00 s\n"}
,{"stream_name":"stdout","time":139.093540258,"data":"  Corrected dt: 1.116419e+00 s\n"}
,{"stream_name":"stdout","time":139.093542844,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.093545308,"data":"  Max wave speed detected: 4.48 m/s\n"}
,{"stream_name":"stdout","time":139.189534219,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stderr","time":139.198581873,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.198623275,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.19858905,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stdout","time":139.198902258,"data":"\n"}
,{"stream_name":"stderr","time":139.198902796,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.11s/s]\n"}
,{"stream_name":"stdout","time":139.198913081,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":139.198923615,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":139.200474465,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.200836187,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.200847759,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.200852711,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.20085673,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.201022637,"data":"\n"}
,{"stream_name":"stderr","time":139.317285108,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.317310708,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.317283848,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":139.317479736,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 129.03s/s]\n"}
,{"stream_name":"stdout","time":139.317503269,"data":"\n"}
,{"stream_name":"stdout","time":139.317512621,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":139.317517414,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":139.319129202,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.319523381,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.319531173,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.319536099,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":139.319540632,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.319720652,"data":"\n"}
,{"stream_name":"stderr","time":139.436280929,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.436317727,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.436289516,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stdout","time":139.436415733,"data":"\n"}
,{"stream_name":"stdout","time":139.43642329,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":139.436427724,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":139.436449033,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.77s/s]\n"}
,{"stream_name":"stdout","time":139.438006056,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.438315179,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.438322729,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.43832779,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.438332668,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.438497914,"data":"\n"}
,{"stream_name":"stdout","time":139.524627165,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #5000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":139.524655972,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":139.52466146,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":139.524665759,"data":"[PERIODIC:1000] BC_GPU [Call #5000] About to launch kernel\n"}
,{"stream_name":"stdout","time":139.524669978,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 0.2951388888888889, 0.10200000000000001, 0.14166666666666666]\n"}
,{"stream_name":"stdout","time":139.524674033,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":139.524694715,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":139.554723374,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":139.55472337,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.55476812,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.554938325,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 129.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 129.08s/s]\n"}
,{"stream_name":"stdout","time":139.554955769,"data":"\n"}
,{"stream_name":"stdout","time":139.55496499,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":139.554969704,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":139.556636393,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.557007549,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.557014908,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.557019611,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.557024082,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.557193376,"data":"\n"}
,{"stream_name":"stdout","time":139.646111724,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":139.673276702,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":139.673276504,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.673308791,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.673529241,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 129.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 129.20s/s]\n"}
,{"stream_name":"stdout","time":139.673549867,"data":"\n"}
,{"stream_name":"stdout","time":139.673557132,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":139.673561646,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":139.675355404,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.675679078,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.675690107,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.675694289,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":139.675711125,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.675910064,"data":"\n"}
,{"stream_name":"stdout","time":139.794061367,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":139.794079755,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.794095894,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.794370606,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 127.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 126.92s/s]\n"}
,{"stream_name":"stdout","time":139.794370715,"data":"\n"}
,{"stream_name":"stdout","time":139.794392993,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":139.794397904,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":139.79604019,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.796059645,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":139.796064619,"data":"\n"}
,{"stream_name":"stdout","time":139.796068214,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.796071733,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":139.796075912,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.796079808,"data":"\n"}
,{"stream_name":"stdout","time":139.79608384,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.796088467,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":139.806473438,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":139.80649235,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":139.806497008,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":139.80650111,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":139.811478641,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":139.811496904,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":139.811502053,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":139.811506692,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":139.811542821,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":139.811556867,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":139.811562084,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":139.811618968,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":139.811631307,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.811650177,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":139.811655712,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":139.812211528,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":139.812218745,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":139.812518464,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":139.812833401,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.812845836,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.812850837,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.814736156,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":139.814747193,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.814752125,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.81475667,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.814910392,"data":"\n"}
,{"stream_name":"stdout","time":140.019055463,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":140.019055239,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.019102006,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.019245538,"data":"\n"}
,{"stream_name":"stdout","time":140.019256524,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":140.019261296,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stderr","time":140.019260439,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 73.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 73.51s/s]\n"}
,{"stream_name":"stdout","time":140.02088533,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":140.020904658,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":140.020978363,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":140.020985968,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":140.021173572,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":140.021327027,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":140.02148468,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":140.021682427,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":140.021707522,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":140.02171169,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":140.021865028,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":140.021899873,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.021991997,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":140.02199766,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.022039913,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":140.022079966,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":140.022130012,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.02249275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.022499609,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.022504227,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":140.022508846,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.022671355,"data":"\n"}
,{"stream_name":"stdout","time":140.032809534,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":140.032829427,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.032834655,"data":"  Original dt: 1.495243e+00 s\n"}
,{"stream_name":"stdout","time":140.032839027,"data":"  Corrected dt: 9.345270e-01 s\n"}
,{"stream_name":"stdout","time":140.032842832,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.032846893,"data":"  Max wave speed detected: 5.35 m/s\n"}
,{"stream_name":"stderr","time":140.172078218,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.172109693,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.172120355,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":140.172384408,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 100.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 100.36s/s]\n"}
,{"stream_name":"stdout","time":140.172391123,"data":"\n"}
,{"stream_name":"stdout","time":140.172408211,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":140.172412886,"data":"Total runtime: 0.15 seconds.\n"}
,{"stream_name":"stdout","time":140.173981828,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.174308482,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.174331664,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.174335983,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.174339907,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.1745034,"data":"\n"}
,{"stream_name":"stdout","time":140.290690578,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":140.300845567,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":140.30084557,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.300880554,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":140.301078947,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 118.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 118.76s/s]\n"}
,{"stream_name":"stdout","time":140.301090932,"data":"\n"}
,{"stream_name":"stdout","time":140.301104992,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":140.301109249,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":140.302617009,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.302917023,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.302927999,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.302932669,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":140.30293696,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.303075523,"data":"\n"}
,{"stream_name":"stdout","time":140.418466706,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":140.418466739,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.418507751,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":140.41868383,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.02s/s]\n"}
,{"stream_name":"stdout","time":140.418690309,"data":"\n"}
,{"stream_name":"stdout","time":140.418709945,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":140.418714569,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":140.420271466,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.420675294,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.420709033,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.420714091,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":140.420718071,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.420893094,"data":"\n"}
,{"stream_name":"stdout","time":140.53708603,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":140.537129045,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.537140023,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.537324639,"data":"\n"}
,{"stream_name":"stdout","time":140.537334455,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":140.537339357,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":140.537346203,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 129.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 129.03s/s]\n"}
,{"stream_name":"stdout","time":140.538900823,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.539233588,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.539241211,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.539245834,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.539250291,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.539419334,"data":"\n"}
,{"stream_name":"stdout","time":140.658687438,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":140.65868738,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.658724884,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.65897342,"data":"\n"}
,{"stream_name":"stdout","time":140.658981384,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":140.658986478,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":140.658985528,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 126.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 125.70s/s]\n"}
,{"stream_name":"stdout","time":140.660526369,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.660860503,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.660885253,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.660889722,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.660893635,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.661032682,"data":"\n"}
,{"stream_name":"stdout","time":140.754746439,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stderr","time":140.782224797,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.782257102,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.782224776,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stdout","time":140.782463452,"data":"\n"}
,{"stream_name":"stderr","time":140.782465021,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 123.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 123.76s/s]\n"}
,{"stream_name":"stdout","time":140.782471755,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":140.782480931,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":140.784137288,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.784452055,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.78445985,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.78446417,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":140.784468284,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.784653345,"data":"\n"}
,{"stream_name":"stderr","time":140.918862269,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.918900522,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.91890361,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stderr","time":140.919180188,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 111.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 111.68s/s]\n"}
,{"stream_name":"stdout","time":140.919205954,"data":"\n"}
,{"stream_name":"stdout","time":140.919217135,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":140.919222551,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":140.921166576,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.92118433,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":140.92120293,"data":"\n"}
,{"stream_name":"stdout","time":140.921223492,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":140.921227576,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":140.921231183,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":140.92123542,"data":"\n"}
,{"stream_name":"stdout","time":140.9212389,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":140.921243258,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":140.935670911,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":140.93568812,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":140.935691278,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":140.935693886,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":140.945271804,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":140.945291039,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":140.945867128,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":140.945884879,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":140.946005891,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":140.946014651,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":140.946019434,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":140.946028857,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":140.946033171,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.946037697,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":140.946041916,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":140.946496943,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":140.946508931,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":140.947089151,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":140.947878522,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.947894151,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.947899283,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.951080247,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":140.951097223,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":140.951101925,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":140.951105967,"data":"|    ep_rew_mean      | 0.101    |\n"}
,{"stream_name":"stdout","time":140.951110154,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":140.951145336,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":140.951150042,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":140.951153954,"data":"|    fps              | 6        |\n"}
,{"stream_name":"stdout","time":140.951157952,"data":"|    time_elapsed     | 15       |\n"}
,{"stream_name":"stdout","time":140.9511618,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":140.951165674,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":140.952248384,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":140.952265874,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.952270582,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.952274342,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.952456958,"data":"\n"}
,{"stream_name":"stdout","time":141.019223845,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":141.019253313,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.019258125,"data":"  Original dt: 1.010626e+00 s\n"}
,{"stream_name":"stdout","time":141.019260731,"data":"  Corrected dt: 6.316414e-01 s\n"}
,{"stream_name":"stdout","time":141.019263385,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.019265855,"data":"  Max wave speed detected: 7.92 m/s\n"}
,{"stream_name":"stdout","time":141.153162945,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stderr","time":141.153183878,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.153204134,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.153437038,"data":"\n"}
,{"stream_name":"stderr","time":141.153440413,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 74.73s/s]\n"}
,{"stream_name":"stdout","time":141.153447278,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":141.153491514,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stdout","time":141.154920238,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":141.154936015,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":141.155167294,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59275806 1.         0.6950427  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":141.155174636,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":141.155378786,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":141.155572528,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":141.155762653,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17782742 0.2000807  0.20915891 0.21177708 0.21236913 0.21247967]\n"}
,{"stream_name":"stdout","time":141.15593012,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.10425641 0.10413142 0.10272242 0.10217141 0.10203256 0.10200522]\n"}
,{"stream_name":"stdout","time":141.155951086,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":141.155955423,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":141.156116192,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":141.156179934,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.156223985,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.15627558,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.156288698,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.156358042,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":141.156363877,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.156789556,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.156812234,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.156817822,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":141.156821856,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.156972264,"data":"\n"}
,{"stream_name":"stdout","time":141.291156171,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stderr","time":141.291188859,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.29120731,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.291435838,"data":"\n"}
,{"stream_name":"stderr","time":141.29143919,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.78s/s]\n"}
,{"stream_name":"stdout","time":141.29144441,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":141.291455432,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":141.292948746,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.293236147,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.293248108,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.293252727,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.293256452,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.293401704,"data":"\n"}
,{"stream_name":"stdout","time":141.411148884,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stderr","time":141.420322508,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":141.420336275,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":141.420346845,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.420677797,"data":"\n"}
,{"stream_name":"stdout","time":141.420698125,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":141.420703738,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":141.420676328,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 118.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 118.14s/s]\n"}
,{"stream_name":"stdout","time":141.422429441,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.422767973,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.422797138,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.422802164,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":141.422806517,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.422937466,"data":"\n"}
,{"stream_name":"stderr","time":141.54767771,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.547710676,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.547677714,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stdout","time":141.54785079,"data":"\n"}
,{"stream_name":"stderr","time":141.547847475,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 120.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 120.40s/s]\n"}
,{"stream_name":"stdout","time":141.547858421,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":141.547867433,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":141.549509173,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.562702421,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 6.2 steps/s\n"}
,{"stream_name":"stdout","time":141.562781922,"data":"\n"}
,{"stream_name":"stdout","time":141.562796248,"data":"✅ Training completed in 0.3 minutes (16.1s)\n"}
,{"stream_name":"stdout","time":141.565957218,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:16 \u003c 0:00:00 , 7 it/s ]\n"}
,{"stream_name":"stdout","time":141.565975469,"data":"\n"}
,{"stream_name":"stdout","time":141.565993543,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.565997543,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":141.566001485,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.566005029,"data":"\n"}
,{"stream_name":"stdout","time":141.570174388,"data":"  [SUCCESS] Final model saved to /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":141.570301539,"data":"2025-10-25 11:22:57 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":141.570471436,"data":"2025-10-25 11:22:57 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":141.570661466,"data":"2025-10-25 11:22:57 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 5303a227\n"}
,{"stream_name":"stdout","time":141.570902798,"data":"2025-10-25 11:22:57 - INFO - _save_rl_cache:528 - [CACHE RL] Saved metadata to traffic_light_control_5303a227_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":141.570912782,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_5303a227_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":141.571124095,"data":"\n"}
,{"stream_name":"stdout","time":141.571133016,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":141.571137278,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":141.571141011,"data":"\n"}
,{"stream_name":"stdout","time":141.571144861,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":141.571179506,"data":"2025-10-25 11:22:57 - INFO - run_performance_comparison:1384 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.571262491,"data":"2025-10-25 11:22:57 - INFO - run_performance_comparison:1385 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":141.571345247,"data":"2025-10-25 11:22:57 - INFO - run_performance_comparison:1386 - Device: gpu\n"}
,{"stream_name":"stdout","time":141.571409717,"data":"2025-10-25 11:22:57 - INFO - run_performance_comparison:1387 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.583144577,"data":"[LAGOS CONFIG] Saved NetworkConfig:\n"}
,{"stream_name":"stdout","time":141.583161711,"data":"  - Network: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.583167296,"data":"  - Traffic: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control_traffic_control.yml\n"}
,{"stream_name":"stdout","time":141.583213332,"data":"2025-10-25 11:22:57 - INFO - _create_scenario_config:614 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.583369319,"data":"2025-10-25 11:22:57 - INFO - _create_scenario_config:615 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":141.583423521,"data":"2025-10-25 11:22:57 - INFO - _create_scenario_config:616 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":141.583531297,"data":"2025-10-25 11:22:57 - INFO - _create_scenario_config:617 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":141.58355396,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":141.583577348,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":141.583755639,"data":"2025-10-25 11:22:57 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":141.583882449,"data":"2025-10-25 11:22:57 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":141.584284299,"data":"2025-10-25 11:22:57 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 41 steps (duration=615.0s)\n"}
,{"stream_name":"stdout","time":141.584379311,"data":"2025-10-25 11:22:57 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":141.584451738,"data":"  [CACHE BASELINE] ✅ Using universal cache (41 steps ≥ 41 required)\n"}
,{"stream_name":"stdout","time":141.584458657,"data":"  [CACHE] ✅ Using 41 cached baseline states\n"}
,{"stream_name":"stdout","time":141.589698116,"data":"2025-10-25 11:22:57 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 1000.0m\n"}
,{"stream_name":"stdout","time":141.589711234,"data":"2025-10-25 11:22:57 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 41 state snapshots (domain_length=1000.0m)\n"}
,{"stream_name":"stdout","time":141.589817594,"data":"2025-10-25 11:22:57 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=-1815168533733216377, last=1540218264692775415\n"}
,{"stream_name":"stdout","time":141.590315619,"data":"2025-10-25 11:22:57 - INFO - evaluate_traffic_performance:1028 - First state sample - rho_m[10:15]=[0.17499626 0.17499933 0.17499989 0.17499998 0.175     ], w_m[10:15]=[3.48514802 3.48518542 3.48519217 3.48519327 3.48519343]\n"}
,{"stream_name":"stdout","time":141.595433683,"data":"2025-10-25 11:22:58 - INFO - evaluate_traffic_performance:1030 - Last state sample - rho_m[10:15]=[0.02730707 0.0270858  0.02690225 0.02673511 0.02656182], w_m[10:15]=[21.12058005 21.32109107 21.47910277 21.60764979 21.71902219]\n"}
,{"stream_name":"stdout","time":141.595721429,"data":"2025-10-25 11:22:58 - INFO - evaluate_traffic_performance:1087 - Boundary flow: 13.133499 (RED should be ~0, GREEN should be \u003e0)\n"}
,{"stream_name":"stdout","time":141.595824175,"data":"2025-10-25 11:22:58 - INFO - evaluate_traffic_performance:1110 - Calculated metrics: flow=13.133499, efficiency=1.783586, delay=-57.72s\n"}
,{"stream_name":"stdout","time":141.595871841,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":141.595941279,"data":"  [INFO] Loading existing model from /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":141.595947804,"data":"\n"}
,{"stream_name":"stdout","time":141.595952634,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.595957692,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":141.595962333,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":141.59596688,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":141.595971116,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":141.595992352,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.595997355,"data":"\n"}
,{"stream_name":"stdout","time":141.596016602,"data":"  [INFO] Chargement du modèle DQN depuis : /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":141.612047294,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.612067066,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.612077465,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.61208347,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.618543605,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":141.624615313,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":141.624649663,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":141.628506902,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":141.628522743,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":141.628669234,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:779 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.62879914,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:780 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":141.628903458,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:781 -   - scenario_path: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.628981346,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:782 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":141.629071013,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:783 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":141.629167733,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:784 -   - device: gpu\n"}
,{"stream_name":"stdout","time":141.629232871,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:785 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":141.629344558,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:786 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":141.629430122,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:787 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.629458744,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":141.629510025,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:792 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":141.635074938,"data":"[NORMALIZATION] Using scenario V0 speeds: v_m=32.0 km/h, v_c=28.0 km/h\n"}
,{"stream_name":"stdout","time":141.635344234,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.635356289,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.645618345,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.645652986,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.645658605,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.645662932,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.650417948,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":141.650435219,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":141.650440531,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":141.650445157,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":141.650471386,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.650484791,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.650489583,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":141.650558554,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.650573868,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.650577776,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.650581296,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.651340733,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.651354365,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":141.65173145,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.651742258,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":141.651746395,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":141.65175004,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":141.65175355,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":141.651757163,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":141.651764798,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":141.651957035,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:807 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":141.652084753,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:808 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":141.652090705,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":141.652165145,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:824 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":141.652187882,"data":"Initializing simulation from scenario: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.652193755,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.662408941,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.662426456,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.662431931,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.662436726,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.667336585,"data":"[NETWORK V0 OVERRIDE] Loaded from segment 'upstream':\n"}
,{"stream_name":"stdout","time":141.667368262,"data":"  V0_m = 8.889 m/s (32.0 km/h)\n"}
,{"stream_name":"stdout","time":141.667373816,"data":"  V0_c = 7.778 m/s (28.0 km/h)\n"}
,{"stream_name":"stdout","time":141.667379144,"data":"Parameters loaded for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":141.667413452,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.667424992,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.66742996,"data":"  Uniform road quality value: 1\n"}
,{"stream_name":"stdout","time":141.667459137,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.667466991,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.667517497,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.667523546,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.66819623,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.668209548,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.2125, 1.8433333333333337, 0.10200000000000001, 1.1666666666666667]\n"}
,{"stream_name":"stdout","time":141.668482563,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.66876749,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.668778678,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.668783582,"data":"  └─ Inflow state: rho_m=0.2125, w_m=0.3, rho_c=0.1020, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.670395034,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:826 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":141.67063524,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:845 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":141.670646729,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":141.670767808,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:865 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":141.758166425,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":141.758217758,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.758376854,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":141.758420447,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":141.75854601,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":141.758647607,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":141.758705545,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.758722104,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.758742482,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":141.758747789,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":141.95493235,"data":"  Stored output at t = 15.0000 s (Step 22)\n"}
,{"stream_name":"stdout","time":141.955115039,"data":"\n"}
,{"stream_name":"stdout","time":141.95512509,"data":"Simulation finished at t = 15.0000 s after 22 steps.\n"}
,{"stream_name":"stdout","time":141.955129784,"data":"Total runtime: 0.20 seconds.\n"}
,{"stream_name":"stderr","time":141.955123366,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.62s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 76.55s/s]\n"}
,{"stream_name":"stdout","time":141.956595597,"data":"[QUEUE_DIAGNOSTIC] ===== Step 0 t=15.0s =====\n"}
,{"stream_name":"stdout","time":141.956629615,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":141.956851154,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.65673774 1.         0.6746973  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":141.956858334,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":141.957031971,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":141.957196884,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":141.957357655,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19702134 0.2072735  0.21115741 0.21222052 0.21245109 0.21249263]\n"}
,{"stream_name":"stdout","time":141.957516809,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.1012046  0.10238536 0.10217475 0.10204492 0.1020088  0.10200143]\n"}
,{"stream_name":"stdout","time":141.957523666,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":141.957528162,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":141.957724296,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":141.957796032,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.957854706,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":141.957887408,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.957908174,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":141.95796969,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":141.95799431,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":141.958175541,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":141.95825468,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":141.958671657,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":141.958802333,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":141.958912725,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.590326e+00, max=4.248708e+00, std=1.762884e+00\n"}
,{"stream_name":"stdout","time":141.959084568,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.211999, rho_c=0.101898\n"}
,{"stream_name":"stdout","time":141.959156761,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.073319, w_c=5.328518\n"}
,{"stream_name":"stdout","time":141.95928495,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: 7000422941581491000\n"}
,{"stream_name":"stdout","time":141.959362498,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.95957021,"data":"    [RL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=1.590326e+00\n"}
,{"stream_name":"stdout","time":141.960512412,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":141.960566779,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":141.960744628,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":141.960796113,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":141.960937632,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":141.9610562,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":141.961068038,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":141.961072822,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.961077164,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":141.961089046,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.095498301,"data":"  Stored output at t = 30.0000 s (Step 37)\n"}
,{"stream_name":"stdout","time":142.0957204,"data":"\n"}
,{"stream_name":"stdout","time":142.095735777,"data":"Simulation finished at t = 30.0000 s after 37 steps.\n"}
,{"stream_name":"stdout","time":142.095741107,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stderr","time":142.095757512,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.90s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 111.74s/s]\n"}
,{"stream_name":"stdout","time":142.097383603,"data":"[QUEUE_DIAGNOSTIC] ===== Step 1 t=30.0s =====\n"}
,{"stream_name":"stdout","time":142.097400943,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":142.097601976,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.56791335 1.         0.5838354  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":142.097643243,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":142.097819176,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.097988813,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":142.098155044,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.170374   0.17915949 0.19161028 0.20160468 0.2076184  0.21058042]\n"}
,{"stream_name":"stdout","time":142.098336064,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.08757532 0.09818336 0.10221734 0.10289621 0.10261706 0.10229924]\n"}
,{"stream_name":"stdout","time":142.098345891,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.098349926,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.098532456,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.098549644,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.098658624,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.098680164,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.098743501,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.098788199,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.098793604,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.098967531,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.099071081,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.099411853,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.099475133,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.099630323,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.470144e-01, max=9.563474e-01, std=3.794665e-01\n"}
,{"stream_name":"stdout","time":142.099814206,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.210997, rho_c=0.101544\n"}
,{"stream_name":"stdout","time":142.09992631,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.157568, w_c=6.182121\n"}
,{"stream_name":"stdout","time":142.10002294,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: -5465851999711830667\n"}
,{"stream_name":"stdout","time":142.100088445,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.100280655,"data":"    [RL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=2.470144e-01\n"}
,{"stream_name":"stdout","time":142.10124137,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.101351443,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.101451025,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":142.101513735,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.10161093,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.101744575,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":142.10175283,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.10175748,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.101771325,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.101776115,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.123794518,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #6000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":142.123824702,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":142.123830143,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.123834575,"data":"[PERIODIC:1000] BC_GPU [Call #6000] About to launch kernel\n"}
,{"stream_name":"stdout","time":142.12383837,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.123842302,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":142.123848092,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":142.156531913,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":142.156566776,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.156572775,"data":"  Original dt: 1.816534e+00 s\n"}
,{"stream_name":"stdout","time":142.156577287,"data":"  Corrected dt: 1.135334e+00 s\n"}
,{"stream_name":"stdout","time":142.156581704,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.156585414,"data":"  Max wave speed detected: 4.40 m/s\n"}
,{"stream_name":"stdout","time":142.21814445,"data":"[PROGRESS] Step 50: t=44.72/45.00s (99.4%) | dt=1.1521s\n"}
,{"stream_name":"stdout","time":142.227120334,"data":"  Stored output at t = 45.0000 s (Step 51)\n"}
,{"stream_name":"stderr","time":142.227333044,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 120.00s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 119.83s/s]\n"}
,{"stream_name":"stdout","time":142.227343439,"data":"\n"}
,{"stream_name":"stdout","time":142.227355512,"data":"Simulation finished at t = 45.0000 s after 51 steps.\n"}
,{"stream_name":"stdout","time":142.227359985,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":142.228805819,"data":"[QUEUE_DIAGNOSTIC] ===== Step 2 t=45.0s =====\n"}
,{"stream_name":"stdout","time":142.228823454,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":142.229026333,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.59862816 1.         0.46667105 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":142.229033776,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":142.229209054,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.229387707,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":142.229558368,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.17958845 0.17625493 0.17739242 0.1834085  0.19168465 0.19944133]\n"}
,{"stream_name":"stdout","time":142.229732764,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.07000066 0.08166873 0.09213122 0.09891284 0.10210317 0.10300765]\n"}
,{"stream_name":"stdout","time":142.229744811,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.229748971,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.229935523,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.229978452,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.230063392,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.230070093,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.230122002,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.230153822,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.230201813,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.230347661,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.23045682,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.230836645,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.230922265,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.231057896,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=5.721255e-02, max=7.821839e-01, std=1.041166e-01\n"}
,{"stream_name":"stdout","time":142.231218085,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.210441, rho_c=0.101006\n"}
,{"stream_name":"stdout","time":142.231307022,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.150380, w_c=6.329601\n"}
,{"stream_name":"stdout","time":142.231389377,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: 6130790639290231502\n"}
,{"stream_name":"stdout","time":142.231475138,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.231647105,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=5.721255e-02\n"}
,{"stream_name":"stdout","time":142.232580845,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.232700167,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.232811957,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":142.232860427,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.232974834,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.233064609,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":142.233114165,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.233132696,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.233137549,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.233143678,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.348475927,"data":"  Stored output at t = 60.0000 s (Step 64)\n"}
,{"stream_name":"stderr","time":142.34870012,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.54s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 130.35s/s]\n"}
,{"stream_name":"stdout","time":142.348706351,"data":"\n"}
,{"stream_name":"stdout","time":142.348731824,"data":"Simulation finished at t = 60.0000 s after 64 steps.\n"}
,{"stream_name":"stdout","time":142.348736289,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":142.350126585,"data":"[QUEUE_DIAGNOSTIC] ===== Step 3 t=60.0s =====\n"}
,{"stream_name":"stdout","time":142.35014328,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":142.350323897,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.6264792  1.         0.41196603 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":142.350333512,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":142.350492924,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.350652044,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":142.350826292,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.18794377 0.18503565 0.18082486 0.17893633 0.18070327 0.18562163]\n"}
,{"stream_name":"stdout","time":142.351000149,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.06179491 0.0696948  0.07942434 0.08850038 0.09559497 0.10017047]\n"}
,{"stream_name":"stdout","time":142.351009255,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.351026114,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.351204583,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.351258127,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.351330782,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.351344885,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.351398947,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.351486296,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.351500263,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.351671554,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.351786779,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.352145667,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.35220561,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.352331529,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=2.166784e-02, max=6.563219e-01, std=6.821317e-02\n"}
,{"stream_name":"stdout","time":142.352474486,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.210005, rho_c=0.100489\n"}
,{"stream_name":"stdout","time":142.352566733,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.140294, w_c=6.330631\n"}
,{"stream_name":"stdout","time":142.352659654,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: -8383738575858013863\n"}
,{"stream_name":"stdout","time":142.35278872,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.352961162,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=2.166784e-02\n"}
,{"stream_name":"stdout","time":142.353922199,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.353966388,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.354102423,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":142.354158438,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.354296025,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.354350918,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":142.354438678,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.354456956,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.354461506,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.354465381,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.471629741,"data":"  Stored output at t = 75.0000 s (Step 77)\n"}
,{"stream_name":"stderr","time":142.471811743,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.50s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 128.28s/s]\n"}
,{"stream_name":"stdout","time":142.471834662,"data":"\n"}
,{"stream_name":"stdout","time":142.471864118,"data":"Simulation finished at t = 75.0000 s after 77 steps.\n"}
,{"stream_name":"stdout","time":142.471868973,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":142.47325986,"data":"[QUEUE_DIAGNOSTIC] ===== Step 4 t=75.0s =====\n"}
,{"stream_name":"stdout","time":142.47327422,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":142.473483416,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.64109004 1.         0.3831981  1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":142.473490654,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":142.47369529,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.473857815,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":142.474014487,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.19232702 0.19152355 0.18794003 0.18390901 0.18104997 0.18050684]\n"}
,{"stream_name":"stdout","time":142.474172355,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.05747972 0.06330945 0.07124726 0.07931557 0.08684409 0.09328809]\n"}
,{"stream_name":"stdout","time":142.474178258,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.474182088,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.474359898,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.474437738,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.474488815,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.474532278,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.474560239,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.474647497,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.474676136,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.474859897,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.474967241,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.475330094,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.475380142,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.475515954,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.398856e-02, max=5.383055e-01, std=5.952113e-02\n"}
,{"stream_name":"stdout","time":142.475732502,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.209619, rho_c=0.100022\n"}
,{"stream_name":"stdout","time":142.475817444,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.130838, w_c=6.303708\n"}
,{"stream_name":"stdout","time":142.475909401,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: -3451434585404283481\n"}
,{"stream_name":"stdout","time":142.476018688,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.476177466,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=1.398856e-02\n"}
,{"stream_name":"stdout","time":142.477166652,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.477261723,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.477363286,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:880 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":142.477416815,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.477574367,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.477629955,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:883 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":142.477699999,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.477707901,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.477720778,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.477725163,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.590296737,"data":"  Stored output at t = 90.0000 s (Step 90)\n"}
,{"stream_name":"stderr","time":142.590487016,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 133.72s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 133.50s/s]\n"}
,{"stream_name":"stdout","time":142.590496603,"data":"\n"}
,{"stream_name":"stdout","time":142.59051027,"data":"Simulation finished at t = 90.0000 s after 90 steps.\n"}
,{"stream_name":"stdout","time":142.590514989,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":142.592031486,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.592060524,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.592228549,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.592255707,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.592346875,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.592376657,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.592413654,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.592457781,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.592497201,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.592682389,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.592945708,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.593322951,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.593438542,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.593547144,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.185434e-02, max=4.515793e-01, std=5.273151e-02\n"}
,{"stream_name":"stdout","time":142.593749599,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.209273, rho_c=0.099602\n"}
,{"stream_name":"stdout","time":142.593832333,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.122373, w_c=6.273510\n"}
,{"stream_name":"stdout","time":142.593929597,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:932 -   State hash: -2687938157384036758\n"}
,{"stream_name":"stdout","time":142.594017968,"data":"2025-10-25 11:22:58 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.594186529,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=1.185434e-02\n"}
,{"stream_name":"stdout","time":142.595310578,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.595339093,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.595526285,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":142.595578565,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.595771726,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.59583049,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":142.595887769,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.595905746,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.595910113,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.595913954,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.685861689,"data":"[PROGRESS] Step 100: t=101.69/105.00s (96.8%) | dt=1.1689s\n"}
,{"stream_name":"stdout","time":142.712586199,"data":"  Stored output at t = 105.0000 s (Step 103)\n"}
,{"stream_name":"stderr","time":142.712866214,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.96s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 128.72s/s]\n"}
,{"stream_name":"stdout","time":142.712885557,"data":"\n"}
,{"stream_name":"stdout","time":142.712899875,"data":"Simulation finished at t = 105.0000 s after 103 steps.\n"}
,{"stream_name":"stdout","time":142.712904567,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":142.714385372,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.714417972,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.714611591,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.714720054,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.714790626,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.714798926,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.714838944,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.714920963,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.714938389,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.715129937,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.715230689,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.715623535,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.71567879,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.715875863,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.103416e-02, max=3.896074e-01, std=4.737474e-02\n"}
,{"stream_name":"stdout","time":142.716029872,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.208964, rho_c=0.099218\n"}
,{"stream_name":"stdout","time":142.7161153,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.114783, w_c=6.244886\n"}
,{"stream_name":"stdout","time":142.716216388,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: -7268728758697738801\n"}
,{"stream_name":"stdout","time":142.716291929,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.716477331,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=1.103416e-02\n"}
,{"stream_name":"stdout","time":142.71754006,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.717624376,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.717768408,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":142.717853287,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.71792189,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.718039956,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":142.718047276,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.718052676,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.718096997,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.718105059,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.83421155,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.71s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 129.58s/s]\n"}
,{"stream_name":"stdout","time":142.834230293,"data":"  Stored output at t = 120.0000 s (Step 116)\n"}
,{"stream_name":"stdout","time":142.8342486,"data":"\n"}
,{"stream_name":"stdout","time":142.834253455,"data":"Simulation finished at t = 120.0000 s after 116 steps.\n"}
,{"stream_name":"stdout","time":142.834257954,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":142.835952734,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.835970362,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.835985157,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.836110122,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.836123041,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.836203398,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.836213466,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.836238639,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.836285147,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.836470391,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.836565959,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.836992217,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.837061637,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.837202676,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.062379e-02, max=3.443696e-01, std=4.329332e-02\n"}
,{"stream_name":"stdout","time":142.837388146,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.208690, rho_c=0.098862\n"}
,{"stream_name":"stdout","time":142.837450413,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.107932, w_c=6.218505\n"}
,{"stream_name":"stdout","time":142.837580802,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: -5678632383964445150\n"}
,{"stream_name":"stdout","time":142.837687481,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.837872673,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=1.062379e-02\n"}
,{"stream_name":"stdout","time":142.838952175,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.839091071,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.839179868,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":142.839298976,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.839423416,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.839533018,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":142.839631755,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.839642819,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.839647343,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.839651244,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":142.952660085,"data":"  Stored output at t = 135.0000 s (Step 129)\n"}
,{"stream_name":"stdout","time":142.952894478,"data":"\n"}
,{"stream_name":"stdout","time":142.952926483,"data":"Simulation finished at t = 135.0000 s after 129 steps.\n"}
,{"stream_name":"stdout","time":142.952932072,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":142.952893168,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 133.18s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 132.93s/s]\n"}
,{"stream_name":"stdout","time":142.954384816,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":142.954404489,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":142.954656887,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":142.954684014,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.954808621,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":142.954818071,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.954875342,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":142.954938918,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":142.954955051,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.955142611,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":142.955223162,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":142.955583707,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":142.95569315,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":142.955859139,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.039232e-02, max=3.117487e-01, std=4.019059e-02\n"}
,{"stream_name":"stdout","time":142.956008931,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.208444, rho_c=0.098528\n"}
,{"stream_name":"stdout","time":142.956085731,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.101707, w_c=6.194217\n"}
,{"stream_name":"stdout","time":142.956207787,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: 6521430915556617731\n"}
,{"stream_name":"stdout","time":142.956282152,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.956498824,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.039232e-02\n"}
,{"stream_name":"stdout","time":142.957485401,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":142.957533765,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":142.957723235,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":142.957787832,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":142.957873537,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":142.95798442,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":142.958012557,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":142.958018657,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.958022815,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":142.958039355,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.072397541,"data":"  Stored output at t = 150.0000 s (Step 142)\n"}
,{"stream_name":"stderr","time":143.07267251,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 131.54s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 131.30s/s]\n"}
,{"stream_name":"stdout","time":143.072692139,"data":"\n"}
,{"stream_name":"stdout","time":143.072701094,"data":"Simulation finished at t = 150.0000 s after 142 steps.\n"}
,{"stream_name":"stdout","time":143.072705272,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":143.07426036,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":143.07427259,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":143.074511582,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":143.074583214,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":143.074673357,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":143.074727264,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":143.074732885,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":143.074784788,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":143.074857856,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.074864827,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":143.075031825,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.07512061,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.075481376,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.075579643,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.07572347,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.028081e-02, max=2.871693e-01, std=3.781076e-02\n"}
,{"stream_name":"stdout","time":143.07590453,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.208225, rho_c=0.098213\n"}
,{"stream_name":"stdout","time":143.076031055,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.096014, w_c=6.171761\n"}
,{"stream_name":"stdout","time":143.076104927,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: 4074934249862447765\n"}
,{"stream_name":"stdout","time":143.076215304,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.076398277,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=1.028081e-02\n"}
,{"stream_name":"stdout","time":143.077385397,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.077490689,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.077642435,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":143.077738395,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.077862843,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.07793547,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":143.077993033,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.077999129,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.078003687,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.07800769,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.088749164,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":143.088772395,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.088777632,"data":"  Original dt: 1.870382e+00 s\n"}
,{"stream_name":"stdout","time":143.08878142,"data":"  Corrected dt: 1.168989e+00 s\n"}
,{"stream_name":"stdout","time":143.088785119,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.088790607,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":143.148341086,"data":"[PROGRESS] Step 150: t=159.35/165.00s (96.6%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":143.192390785,"data":"  Stored output at t = 165.0000 s (Step 155)\n"}
,{"stream_name":"stdout","time":143.192631289,"data":"\n"}
,{"stream_name":"stdout","time":143.192653169,"data":"Simulation finished at t = 165.0000 s after 155 steps.\n"}
,{"stream_name":"stdout","time":143.192671482,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":143.192631168,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 131.53s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 131.33s/s]\n"}
,{"stream_name":"stdout","time":143.19417186,"data":"[QUEUE_DIAGNOSTIC] ===== Step 10 t=165.0s =====\n"}
,{"stream_name":"stdout","time":143.194200396,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":143.194369768,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.6692104  1.         0.32499248 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":143.194378469,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":143.194559234,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":143.194769516,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":143.194935374,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.20076312 0.20396146 0.20397906 0.20333609 0.2025501  0.20169319]\n"}
,{"stream_name":"stdout","time":143.195123474,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.04874887 0.05051555 0.05576676 0.06138111 0.06657944 0.07124121]\n"}
,{"stream_name":"stdout","time":143.195130697,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":143.195135279,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":143.195336567,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":143.195388674,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":143.19547681,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":143.195538945,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":143.195545674,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":143.195625249,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":143.195643031,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.195819365,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.195898107,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.196260413,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.196301028,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.19644448,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.025823e-02, max=2.674810e-01, std=3.596654e-02\n"}
,{"stream_name":"stdout","time":143.196651465,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.208028, rho_c=0.097914\n"}
,{"stream_name":"stdout","time":143.196755978,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.090784, w_c=6.150896\n"}
,{"stream_name":"stdout","time":143.19686811,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: 7136558937918434895\n"}
,{"stream_name":"stdout","time":143.196943594,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.197141191,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=1.025823e-02\n"}
,{"stream_name":"stdout","time":143.198097191,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.198143335,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.198288448,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":143.198325745,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.198460446,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.198536123,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":143.198616841,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.198630602,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.198636001,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.198641889,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.312927372,"data":"  Stored output at t = 180.0000 s (Step 168)\n"}
,{"stream_name":"stdout","time":143.313176572,"data":"\n"}
,{"stream_name":"stdout","time":143.313200349,"data":"Simulation finished at t = 180.0000 s after 168 steps.\n"}
,{"stream_name":"stdout","time":143.313205344,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":143.313216306,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 131.69s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 131.53s/s]\n"}
,{"stream_name":"stdout","time":143.314743188,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.314878071,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.315008868,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.315334286,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.315419437,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.315531781,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.029147e-02, max=2.513579e-01, std=3.452511e-02\n"}
,{"stream_name":"stdout","time":143.315738759,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207850, rho_c=0.097629\n"}
,{"stream_name":"stdout","time":143.315862092,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.085959, w_c=6.131426\n"}
,{"stream_name":"stdout","time":143.315940909,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: 5197711690194364370\n"}
,{"stream_name":"stdout","time":143.316025304,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.316204475,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.029147e-02\n"}
,{"stream_name":"stdout","time":143.317161926,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.317265252,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.317388443,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":143.317479921,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.31756601,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.317711883,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":143.317733174,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.317754542,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.317782128,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.31779047,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.433304533,"data":"  Stored output at t = 195.0000 s (Step 181)\n"}
,{"stream_name":"stdout","time":143.433432941,"data":"\n"}
,{"stream_name":"stderr","time":143.433430896,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 130.32s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 130.14s/s]\n"}
,{"stream_name":"stdout","time":143.433443905,"data":"Simulation finished at t = 195.0000 s after 181 steps.\n"}
,{"stream_name":"stdout","time":143.433460606,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":143.435145498,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.435245074,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.435379887,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.4357769,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.435865908,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.436007072,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.035736e-02, max=2.378963e-01, std=3.338829e-02\n"}
,{"stream_name":"stdout","time":143.436155245,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207690, rho_c=0.097356\n"}
,{"stream_name":"stdout","time":143.43623775,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.081495, w_c=6.113191\n"}
,{"stream_name":"stdout","time":143.436333707,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: -4036030030491556820\n"}
,{"stream_name":"stdout","time":143.436416937,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.43663423,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=1.035736e-02\n"}
,{"stream_name":"stdout","time":143.437539959,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.437623743,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.437764828,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":143.437848384,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.437904166,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.438000372,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":143.438058992,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.438065531,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.438071164,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.438107679,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.553346668,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 130.69s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 130.56s/s]\n"}
,{"stream_name":"stdout","time":143.553346378,"data":"  Stored output at t = 210.0000 s (Step 194)\n"}
,{"stream_name":"stdout","time":143.553382432,"data":"\n"}
,{"stream_name":"stdout","time":143.55338749,"data":"Simulation finished at t = 210.0000 s after 194 steps.\n"}
,{"stream_name":"stdout","time":143.553391837,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":143.554875985,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.554970995,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.555096166,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.555433015,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.555546946,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.555669506,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.044514e-02, max=2.264638e-01, std=3.248069e-02\n"}
,{"stream_name":"stdout","time":143.555855625,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207546, rho_c=0.097093\n"}
,{"stream_name":"stdout","time":143.555935275,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.077354, w_c=6.096061\n"}
,{"stream_name":"stdout","time":143.556018131,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:932 -   State hash: -727777581803637325\n"}
,{"stream_name":"stdout","time":143.556101034,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.556259241,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=1.044514e-02\n"}
,{"stream_name":"stdout","time":143.557263311,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.557365822,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.557473681,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:880 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":143.55757685,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.557682346,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.557770849,"data":"2025-10-25 11:22:59 - INFO - run_control_simulation:883 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":143.557847096,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.557857066,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.557861797,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.557865754,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.61048228,"data":"[PROGRESS] Step 200: t=217.01/225.00s (96.5%) | dt=1.1690s\n"}
,{"stream_name":"stderr","time":143.671583307,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 132.47s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 132.32s/s]\n"}
,{"stream_name":"stdout","time":143.671644278,"data":"  Stored output at t = 225.0000 s (Step 207)\n"}
,{"stream_name":"stdout","time":143.671661554,"data":"\n"}
,{"stream_name":"stdout","time":143.671666538,"data":"Simulation finished at t = 225.0000 s after 207 steps.\n"}
,{"stream_name":"stdout","time":143.671670415,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":143.673144857,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.673202279,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.673354408,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.673668503,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.6737651,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.673884193,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.054861e-02, max=2.166070e-01, std=3.174489e-02\n"}
,{"stream_name":"stdout","time":143.674055952,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207415, rho_c=0.096840\n"}
,{"stream_name":"stdout","time":143.674099448,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.073510, w_c=6.079931\n"}
,{"stream_name":"stdout","time":143.674217446,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: 7640253196384222108\n"}
,{"stream_name":"stdout","time":143.674305767,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.674517846,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.054861e-02\n"}
,{"stream_name":"stdout","time":143.675525771,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.675638058,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.675768731,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":143.675854859,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.675938186,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.676032681,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":143.676096472,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.676102749,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.676108848,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.676136779,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.790005511,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 132.31s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 132.19s/s]\n"}
,{"stream_name":"stdout","time":143.790005509,"data":"  Stored output at t = 240.0000 s (Step 220)\n"}
,{"stream_name":"stdout","time":143.790036185,"data":"\n"}
,{"stream_name":"stdout","time":143.790041434,"data":"Simulation finished at t = 240.0000 s after 220 steps.\n"}
,{"stream_name":"stdout","time":143.790059339,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":143.79166396,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.791683134,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.791811617,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.792133867,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.792219082,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.79230387,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.065521e-02, max=2.079943e-01, std=3.113979e-02\n"}
,{"stream_name":"stdout","time":143.792469197,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207298, rho_c=0.096595\n"}
,{"stream_name":"stdout","time":143.792530869,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.069935, w_c=6.064711\n"}
,{"stream_name":"stdout","time":143.79264881,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: 3276321339372778243\n"}
,{"stream_name":"stdout","time":143.792749971,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.792917536,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=1.065521e-02\n"}
,{"stream_name":"stdout","time":143.793844792,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.793945834,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.794045019,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":143.794122966,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.794228362,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.794297697,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":143.794379159,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.794388613,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.79439336,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.794397294,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":143.911767084,"data":"  Stored output at t = 255.0000 s (Step 233)\n"}
,{"stream_name":"stderr","time":143.911906033,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 128.32s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 128.09s/s]\n"}
,{"stream_name":"stdout","time":143.911928046,"data":"\n"}
,{"stream_name":"stdout","time":143.911956266,"data":"Simulation finished at t = 255.0000 s after 233 steps.\n"}
,{"stream_name":"stdout","time":143.911961417,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":143.913435549,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":143.913534149,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":143.913628318,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":143.914005846,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":143.914064346,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":143.914140448,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.076129e-02, max=2.003784e-01, std=3.063287e-02\n"}
,{"stream_name":"stdout","time":143.914296571,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207192, rho_c=0.096359\n"}
,{"stream_name":"stdout","time":143.914396984,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.066607, w_c=6.050322\n"}
,{"stream_name":"stdout","time":143.914467514,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: -979828211218285492\n"}
,{"stream_name":"stdout","time":143.914587738,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.914793636,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=1.076129e-02\n"}
,{"stream_name":"stdout","time":143.915719626,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":143.915843015,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":143.915935443,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":143.915988157,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":143.916081645,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":143.916168124,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":143.916230248,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":143.916238775,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.916243055,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":143.916246898,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.004951943,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":144.004977457,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.004984512,"data":"  Original dt: 1.870382e+00 s\n"}
,{"stream_name":"stdout","time":144.004988926,"data":"  Corrected dt: 1.168989e+00 s\n"}
,{"stream_name":"stdout","time":144.004993033,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.004997464,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":144.03079104,"data":"  Stored output at t = 270.0000 s (Step 246)\n"}
,{"stream_name":"stderr","time":144.030932437,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 131.44s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 131.27s/s]\n"}
,{"stream_name":"stdout","time":144.030941853,"data":"\n"}
,{"stream_name":"stdout","time":144.030954428,"data":"Simulation finished at t = 270.0000 s after 246 steps.\n"}
,{"stream_name":"stdout","time":144.030959208,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":144.032468942,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.032489016,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.032507311,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.032892677,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.03295412,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.03310977,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.086530e-02, max=1.935724e-01, std=3.019937e-02\n"}
,{"stream_name":"stdout","time":144.033255586,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207098, rho_c=0.096129\n"}
,{"stream_name":"stdout","time":144.033341259,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.063504, w_c=6.036694\n"}
,{"stream_name":"stdout","time":144.033417984,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: 1001371191605066202\n"}
,{"stream_name":"stdout","time":144.03350127,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.03370678,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.086530e-02\n"}
,{"stream_name":"stdout","time":144.034557897,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.034694844,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.034841392,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":144.034928831,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.035053363,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.035120362,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":144.03517317,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.035180091,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.03518484,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.035190422,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.071658858,"data":"[PROGRESS] Step 250: t=274.68/285.00s (96.4%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":144.150702703,"data":"  Stored output at t = 285.0000 s (Step 259)\n"}
,{"stream_name":"stdout","time":144.150885508,"data":"\n"}
,{"stream_name":"stderr","time":144.150882066,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 130.42s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 130.17s/s]\n"}
,{"stream_name":"stdout","time":144.150894173,"data":"Simulation finished at t = 285.0000 s after 259 steps.\n"}
,{"stream_name":"stdout","time":144.150902293,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":144.152413492,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.152509818,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.152653602,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.153000117,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.153055641,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.1531634,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.096555e-02, max=1.874326e-01, std=2.982077e-02\n"}
,{"stream_name":"stdout","time":144.153296923,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.207013, rho_c=0.095906\n"}
,{"stream_name":"stdout","time":144.153368655,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.060606, w_c=6.023763\n"}
,{"stream_name":"stdout","time":144.153477453,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: -8589672156131892295\n"}
,{"stream_name":"stdout","time":144.153535632,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.153756512,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=1.096555e-02\n"}
,{"stream_name":"stdout","time":144.154684184,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.154814292,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.154920773,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":144.155033717,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.155100911,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.15521277,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":144.155236985,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.155241912,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.155283743,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.155289729,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.269913057,"data":"  Stored output at t = 300.0000 s (Step 272)\n"}
,{"stream_name":"stderr","time":144.269944917,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 131.36s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 131.19s/s]\n"}
,{"stream_name":"stdout","time":144.269957284,"data":"\n"}
,{"stream_name":"stdout","time":144.269967494,"data":"Simulation finished at t = 300.0000 s after 272 steps.\n"}
,{"stream_name":"stdout","time":144.26997204,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":144.271537797,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.271552977,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":144.271665186,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.271819502,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.272149919,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.272217329,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.27236235,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.106116e-02, max=1.818472e-01, std=2.948329e-02\n"}
,{"stream_name":"stdout","time":144.272529729,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206938, rho_c=0.095689\n"}
,{"stream_name":"stdout","time":144.272672448,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.057898, w_c=6.011476\n"}
,{"stream_name":"stdout","time":144.272778839,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: -6518143758955573753\n"}
,{"stream_name":"stdout","time":144.272855658,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.273022186,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=1.106116e-02\n"}
,{"stream_name":"stdout","time":144.274006503,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.274127896,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.274238424,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":144.274302442,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.274406315,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.274511177,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":144.274547371,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.274557266,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.274563997,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.274624335,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.390568619,"data":"  Stored output at t = 315.0000 s (Step 285)\n"}
,{"stream_name":"stderr","time":144.390769503,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 129.81s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 129.59s/s]\n"}
,{"stream_name":"stdout","time":144.390771788,"data":"\n"}
,{"stream_name":"stdout","time":144.390800904,"data":"Simulation finished at t = 315.0000 s after 285 steps.\n"}
,{"stream_name":"stdout","time":144.390815879,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":144.39228866,"data":"[QUEUE_DIAGNOSTIC] ===== Step 20 t=315.0s =====\n"}
,{"stream_name":"stdout","time":144.392305792,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":144.392497718,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.68374246 1.         0.29392102 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":144.392507351,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":144.392691438,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":144.392874004,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":144.393039978,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.20512275 0.21005428 0.21072946 0.21057074 0.21021499 0.20983094]\n"}
,{"stream_name":"stdout","time":144.393201103,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.04408816 0.04309706 0.0467373  0.05145678 0.05603065 0.06027172]\n"}
,{"stream_name":"stdout","time":144.393224941,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":144.393229563,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":144.393391626,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":144.393442699,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.393509726,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":144.393531793,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.393550692,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":144.393665043,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":144.393679781,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.393835549,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.393909713,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.394254382,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.394315818,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.394450968,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.115188e-02, max=1.771528e-01, std=2.917638e-02\n"}
,{"stream_name":"stdout","time":144.394674243,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206870, rho_c=0.095478\n"}
,{"stream_name":"stdout","time":144.394735837,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.055366, w_c=5.999785\n"}
,{"stream_name":"stdout","time":144.394874376,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: -301438025690331840\n"}
,{"stream_name":"stdout","time":144.394944606,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.395141312,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=1.115188e-02\n"}
,{"stream_name":"stdout","time":144.396127157,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.396238812,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.396379112,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":144.396431304,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.396555159,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.396714946,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":144.396747143,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.396753616,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.396758281,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.396763917,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.436878839,"data":"[PERIODIC:1000] BC_DISPATCHER [Call #7000] current_bc_params: \u003cclass 'dict'\u003e\n"}
,{"stream_name":"stdout","time":144.43690295,"data":"[PERIODIC:1000] BC_DISPATCHER Using current_bc_params (dynamic)\n"}
,{"stream_name":"stdout","time":144.436908467,"data":"[PERIODIC:1000] BC_DISPATCHER Left inflow: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.43691673,"data":"[PERIODIC:1000] BC_GPU [Call #7000] About to launch kernel\n"}
,{"stream_name":"stdout","time":144.436920629,"data":"[PERIODIC:1000] BC_GPU Inflow.L: [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.436926061,"data":"[PERIODIC:1000] BC_GPU Inflow.R: [0.0, 0.0, 0.0, 0.0]\n"}
,{"stream_name":"stdout","time":144.436931862,"data":"[PERIODIC:1000] BC_GPU BC Types: L=0, R=1\n"}
,{"stream_name":"stdout","time":144.511324787,"data":"  Stored output at t = 330.0000 s (Step 298)\n"}
,{"stream_name":"stdout","time":144.511500272,"data":"\n"}
,{"stream_name":"stdout","time":144.511510972,"data":"Simulation finished at t = 330.0000 s after 298 steps.\n"}
,{"stream_name":"stdout","time":144.51151624,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":144.511574285,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 131.33s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 131.14s/s]\n"}
,{"stream_name":"stdout","time":144.513048799,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.513098795,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.513241475,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.513561096,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.513624219,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.513763811,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.123777e-02, max=1.729262e-01, std=2.889219e-02\n"}
,{"stream_name":"stdout","time":144.513919557,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206811, rho_c=0.095272\n"}
,{"stream_name":"stdout","time":144.514002326,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.052999, w_c=5.988649\n"}
,{"stream_name":"stdout","time":144.51410743899999,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:932 -   State hash: -441085796845825566\n"}
,{"stream_name":"stdout","time":144.514169654,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.51437104,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=1.123777e-02\n"}
,{"stream_name":"stdout","time":144.515336385,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.515414865,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.515545786,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:880 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":144.515674298,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.515786076,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.515904123,"data":"2025-10-25 11:23:00 - INFO - run_control_simulation:883 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":144.515911897,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.515926259,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.515931454,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.51596994,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.533550376,"data":"[PROGRESS] Step 300: t=332.34/345.00s (96.3%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":144.628916252,"data":"  Stored output at t = 345.0000 s (Step 311)\n"}
,{"stream_name":"stdout","time":144.628946448,"data":"\n"}
,{"stream_name":"stdout","time":144.628951223,"data":"Simulation finished at t = 345.0000 s after 311 steps.\n"}
,{"stream_name":"stdout","time":144.628954953,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":144.628954577,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 133.31s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 133.16s/s]\n"}
,{"stream_name":"stdout","time":144.630436842,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.630514412,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.63066361,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.630985887,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.631059592,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.631156315,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.131931e-02, max=1.689859e-01, std=2.862473e-02\n"}
,{"stream_name":"stdout","time":144.631306663,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206759, rho_c=0.095071\n"}
,{"stream_name":"stdout","time":144.631375855,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.050785, w_c=5.978030\n"}
,{"stream_name":"stdout","time":144.631480751,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: 4746686473604306770\n"}
,{"stream_name":"stdout","time":144.63156166,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.631751533,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=1.131931e-02\n"}
,{"stream_name":"stdout","time":144.63259187,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.632726907,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.632832286,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":144.632898429,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.632968842,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.633092095,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":144.633099885,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.633112854,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.633118503,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.63312978,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.746726303,"data":"  Stored output at t = 360.0000 s (Step 324)\n"}
,{"stream_name":"stdout","time":144.746876632,"data":"\n"}
,{"stream_name":"stdout","time":144.746887745,"data":"Simulation finished at t = 360.0000 s after 324 steps.\n"}
,{"stream_name":"stdout","time":144.746892615,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":144.746898933,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 132.52s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 132.30s/s]\n"}
,{"stream_name":"stdout","time":144.748429311,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.748457638,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.748638568,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.748960348,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.748996618,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.749135019,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.139636e-02, max=1.652949e-01, std=2.836981e-02\n"}
,{"stream_name":"stdout","time":144.749299872,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206714, rho_c=0.094874\n"}
,{"stream_name":"stdout","time":144.749363636,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.048715, w_c=5.967894\n"}
,{"stream_name":"stdout","time":144.749464965,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: 2091452018593603060\n"}
,{"stream_name":"stdout","time":144.749529593,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.749751687,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=1.139636e-02\n"}
,{"stream_name":"stdout","time":144.750640876,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.750691544,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.750840859,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":144.750889704,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.751011496,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.751098689,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":144.751159361,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.751167952,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.751172688,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.751177572,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.867356377,"data":"  Stored output at t = 375.0000 s (Step 337)\n"}
,{"stream_name":"stderr","time":144.867565114,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 129.47s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 129.27s/s]\n"}
,{"stream_name":"stdout","time":144.867569899,"data":"\n"}
,{"stream_name":"stdout","time":144.867590701,"data":"Simulation finished at t = 375.0000 s after 337 steps.\n"}
,{"stream_name":"stdout","time":144.867595525,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":144.869113194,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.869241104,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.869357516,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.869724878,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.869835655,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.86993849,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.146921e-02, max=1.618225e-01, std=2.812435e-02\n"}
,{"stream_name":"stdout","time":144.870119003,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206675, rho_c=0.094681\n"}
,{"stream_name":"stdout","time":144.87018123000001,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.046781, w_c=5.958213\n"}
,{"stream_name":"stdout","time":144.870295725,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -1176479626566481227\n"}
,{"stream_name":"stdout","time":144.870356991,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.870562981,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=1.146921e-02\n"}
,{"stream_name":"stdout","time":144.871475321,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.871581643,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.87175693,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":144.871832405,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.871915375,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.872017875,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":144.87208217,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.872088818,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.872093478,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.872098413,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":144.927220622,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":144.927245543,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.927250613,"data":"  Original dt: 1.870382e+00 s\n"}
,{"stream_name":"stdout","time":144.92725439,"data":"  Corrected dt: 1.168989e+00 s\n"}
,{"stream_name":"stdout","time":144.927258141,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.927261854,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":144.988283578,"data":"[PROGRESS] Step 350: t=390.00/390.00s (100.0%) | dt=0.9721s\n"}
,{"stream_name":"stdout","time":144.988615166,"data":"  Stored output at t = 390.0000 s (Step 350)\n"}
,{"stream_name":"stdout","time":144.988891928,"data":"\n"}
,{"stream_name":"stdout","time":144.988902919,"data":"Simulation finished at t = 390.0000 s after 350 steps.\n"}
,{"stream_name":"stderr","time":144.988900677,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 129.08s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 128.86s/s]\n"}
,{"stream_name":"stdout","time":144.98890778,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":144.990493164,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":144.990651031,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":144.990797556,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":144.991130586,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":144.991236788,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":144.991334505,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.154116e-02, max=1.585434e-01, std=2.788489e-02\n"}
,{"stream_name":"stdout","time":144.991507135,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206643, rho_c=0.094493\n"}
,{"stream_name":"stdout","time":144.991628845,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.044974, w_c=5.948960\n"}
,{"stream_name":"stdout","time":144.991734299,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -1401436506455972953\n"}
,{"stream_name":"stdout","time":144.991842142,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.992017449,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=1.154116e-02\n"}
,{"stream_name":"stdout","time":144.992975479,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":144.993060674,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":144.993175063,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":144.993209041,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":144.993333647,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":144.993413783,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":144.99346281,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":144.993468988,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.993483924,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":144.993489387,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.111198014,"data":"  Stored output at t = 405.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":145.111393294,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 127.86s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 127.64s/s]\n"}
,{"stream_name":"stdout","time":145.111422207,"data":"\n"}
,{"stream_name":"stdout","time":145.111437311,"data":"Simulation finished at t = 405.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":145.111441741,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":145.112997132,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.113080159,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.113251961,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.113580528,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.113666953,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.113851811,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.161031e-02, max=1.554362e-01, std=2.765079e-02\n"}
,{"stream_name":"stdout","time":145.114038128,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206616, rho_c=0.094308\n"}
,{"stream_name":"stdout","time":145.114090532,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.043288, w_c=5.940110\n"}
,{"stream_name":"stdout","time":145.11420762,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -6264147969419402564\n"}
,{"stream_name":"stdout","time":145.114279372,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.114475575,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=1.161031e-02\n"}
,{"stream_name":"stdout","time":145.115436072,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.115488349,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.115644763,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":145.115737727,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.115870282,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.115885289,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":145.115970448,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.115977234,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.115981924,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.116026846,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.231716027,"data":"  Stored output at t = 420.0000 s (Step 376)\n"}
,{"stream_name":"stderr","time":145.231863693,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 130.13s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 129.92s/s]\n"}
,{"stream_name":"stdout","time":145.231871616,"data":"\n"}
,{"stream_name":"stdout","time":145.23188673,"data":"Simulation finished at t = 420.0000 s after 376 steps.\n"}
,{"stream_name":"stdout","time":145.231890563,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":145.23342297,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.233476948,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.233649486,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.233985832,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.234031787,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.234146099,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.167792e-02, max=1.524829e-01, std=2.742053e-02\n"}
,{"stream_name":"stdout","time":145.234336494,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206594, rho_c=0.094127\n"}
,{"stream_name":"stdout","time":145.234394551,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.041715, w_c=5.931640\n"}
,{"stream_name":"stdout","time":145.234503232,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -6830799481750722058\n"}
,{"stream_name":"stdout","time":145.234580436,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.234860617,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=1.167792e-02\n"}
,{"stream_name":"stdout","time":145.235836827,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.235861995,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.236063789,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":145.236126484,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.236266621,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.236353823,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":145.236380707,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.236387002,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.236392386,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.236404392,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.369676686,"data":"  Stored output at t = 435.0000 s (Step 389)\n"}
,{"stream_name":"stderr","time":145.369834814,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 112.99s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 112.89s/s]\n"}
,{"stream_name":"stdout","time":145.369845925,"data":"\n"}
,{"stream_name":"stdout","time":145.369861299,"data":"Simulation finished at t = 435.0000 s after 389 steps.\n"}
,{"stream_name":"stdout","time":145.369866589,"data":"Total runtime: 0.13 seconds.\n"}
,{"stream_name":"stdout","time":145.371466446,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.371488674,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.371532202,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.371878643,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.37193692,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.372029336,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.174281e-02, max=1.496681e-01, std=2.719396e-02\n"}
,{"stream_name":"stdout","time":145.372187105,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206578, rho_c=0.093949\n"}
,{"stream_name":"stdout","time":145.372267811,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.040252, w_c=5.923532\n"}
,{"stream_name":"stdout","time":145.372400798,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -3293322861706073200\n"}
,{"stream_name":"stdout","time":145.372446393,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.372629343,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=1.174281e-02\n"}
,{"stream_name":"stdout","time":145.373522893,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.373623421,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.373746688,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":145.373816479,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.373890713,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.373977848,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":145.374043316,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.374049917,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.374054544,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.374058492,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.470995512,"data":"[PROGRESS] Step 400: t=447.86/450.00s (99.5%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":145.489464154,"data":"  Stored output at t = 450.0000 s (Step 402)\n"}
,{"stream_name":"stdout","time":145.489647684,"data":"\n"}
,{"stream_name":"stderr","time":145.489655425,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 130.42s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 130.25s/s]\n"}
,{"stream_name":"stdout","time":145.489669438,"data":"Simulation finished at t = 450.0000 s after 402 steps.\n"}
,{"stream_name":"stdout","time":145.489681101,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":145.491186854,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.491202529,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":145.491282204,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.49141746,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.491823386,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.491854943,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.491980391,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.180309e-02, max=1.469787e-01, std=2.697149e-02\n"}
,{"stream_name":"stdout","time":145.492123668,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206567, rho_c=0.093775\n"}
,{"stream_name":"stdout","time":145.492231551,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.038892, w_c=5.915767\n"}
,{"stream_name":"stdout","time":145.492332017,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:932 -   State hash: -345171135220380620\n"}
,{"stream_name":"stdout","time":145.492445437,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.492635431,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=1.180309e-02\n"}
,{"stream_name":"stdout","time":145.493533871,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.493591372,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.493756741,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:880 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":145.493809977,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.493907103,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.493979515,"data":"2025-10-25 11:23:01 - INFO - run_control_simulation:883 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":145.494035215,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.494041269,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.494045759,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.494049976,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.607521478,"data":"  Stored output at t = 465.0000 s (Step 415)\n"}
,{"stream_name":"stderr","time":145.60770573,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 132.62s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 132.44s/s]\n"}
,{"stream_name":"stdout","time":145.607709536,"data":"\n"}
,{"stream_name":"stdout","time":145.60773377,"data":"Simulation finished at t = 465.0000 s after 415 steps.\n"}
,{"stream_name":"stdout","time":145.607738496,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":145.609163688,"data":"[QUEUE_DIAGNOSTIC] ===== Step 30 t=465.0s =====\n"}
,{"stream_name":"stdout","time":145.609180296,"data":"[QUEUE_DIAGNOSTIC] Observation shape: (26,), n_segments: 6\n"}
,{"stream_name":"stdout","time":145.609368153,"data":"[QUEUE_DIAGNOSTIC] Normalized obs[0:4]: [0.69058836 1.         0.27925193 1.        ] (rho_m, v_m, rho_c, v_c)\n"}
,{"stream_name":"stdout","time":145.609374943,"data":"[QUEUE_DIAGNOSTIC] Denorm factors: rho_max_m=0.300, v_free_m=8.89\n"}
,{"stream_name":"stdout","time":145.609582133,"data":"[QUEUE_DIAGNOSTIC] velocities_m (m/s): [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":145.609790546,"data":"[QUEUE_DIAGNOSTIC] velocities_c (m/s): [7.7777777 7.7777777 7.7777777 7.7777777 7.7777777 7.7777777]\n"}
,{"stream_name":"stdout","time":145.609952325,"data":"[QUEUE_DIAGNOSTIC] densities_m (veh/m): [0.20717652 0.21274716 0.21365796 0.21369378 0.2134975  0.21324755]\n"}
,{"stream_name":"stdout","time":145.61015056,"data":"[QUEUE_DIAGNOSTIC] densities_c (veh/m): [0.04188779 0.03962514 0.04231902 0.04635865 0.05048343 0.05440459]\n"}
,{"stream_name":"stdout","time":145.610176427,"data":"[QUEUE_DIAGNOSTIC] Threshold: 4.44 m/s (16.0 km/h)\n"}
,{"stream_name":"stdout","time":145.610181877,"data":"[QUEUE_DIAGNOSTIC] v_free_m=8.89 m/s → Threshold=0.5*v_free_m\n"}
,{"stream_name":"stdout","time":145.61036139,"data":"[QUEUE_DIAGNOSTIC] velocities_m: [8.888889 8.888889 8.888889 8.888889 8.888889 8.888889]\n"}
,{"stream_name":"stdout","time":145.610381749,"data":"[QUEUE_DIAGNOSTIC] Below threshold (m): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.610472214,"data":"[QUEUE_DIAGNOSTIC] Below threshold (c): [False False False False False False]\n"}
,{"stream_name":"stdout","time":145.610498301,"data":"[QUEUE_DIAGNOSTIC] queued_m densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.610550642,"data":"[QUEUE_DIAGNOSTIC] queued_c densities: [] (sum=0.0000)\n"}
,{"stream_name":"stdout","time":145.610565613,"data":"[QUEUE_DIAGNOSTIC] dx=10.00m, queue_length=0.00 vehicles\n"}
,{"stream_name":"stdout","time":145.610651903,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.610773392,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.61090021,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.611215588,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.611273821,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.611372691,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.185918e-02, max=1.444034e-01, std=2.675279e-02\n"}
,{"stream_name":"stdout","time":145.611536015,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206560, rho_c=0.093603\n"}
,{"stream_name":"stdout","time":145.611662325,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.037631, w_c=5.908329\n"}
,{"stream_name":"stdout","time":145.611746187,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: -8557146718619008071\n"}
,{"stream_name":"stdout","time":145.61182963,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.611995719,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=1.185918e-02\n"}
,{"stream_name":"stdout","time":145.612991035,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.61308403499999,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.613199359,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":145.613273199,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.613351352,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.613438797,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":145.613485653,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.613493656,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.613499274,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.613506556,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.731078561,"data":"  Stored output at t = 480.0000 s (Step 428)\n"}
,{"stream_name":"stdout","time":145.731271727,"data":"\n"}
,{"stream_name":"stdout","time":145.731284171,"data":"Simulation finished at t = 480.0000 s after 428 steps.\n"}
,{"stream_name":"stdout","time":145.731289134,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":145.731314065,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 128.00s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 127.81s/s]\n"}
,{"stream_name":"stdout","time":145.732846286,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.7329671,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.733076101,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.733393875,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.733438417,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.733535353,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.191233e-02, max=1.419323e-01, std=2.653728e-02\n"}
,{"stream_name":"stdout","time":145.733732353,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206558, rho_c=0.093435\n"}
,{"stream_name":"stdout","time":145.733817955,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.036463, w_c=5.901202\n"}
,{"stream_name":"stdout","time":145.733899832,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: 8369167477425245612\n"}
,{"stream_name":"stdout","time":145.733995018,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.734180373,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=1.191233e-02\n"}
,{"stream_name":"stdout","time":145.735129128,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.735240257,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.735350127,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":145.73544608,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.735523885,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.735660577,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":145.735731638,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.735739287,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.735744315,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.735748396,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.849611572,"data":"  Stored output at t = 495.0000 s (Step 441)\n"}
,{"stream_name":"stderr","time":145.849850227,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 132.12s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 131.88s/s]\n"}
,{"stream_name":"stdout","time":145.849871126,"data":"\n"}
,{"stream_name":"stdout","time":145.849876336,"data":"Simulation finished at t = 495.0000 s after 441 steps.\n"}
,{"stream_name":"stdout","time":145.849881283,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":145.851445916,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.85152827,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.851667618,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.851998505,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.852060171,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.852158424,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.196211e-02, max=1.395566e-01, std=2.632522e-02\n"}
,{"stream_name":"stdout","time":145.852310476,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206560, rho_c=0.093269\n"}
,{"stream_name":"stdout","time":145.85237781,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.035384, w_c=5.894371\n"}
,{"stream_name":"stdout","time":145.852468915,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: -3721588113832209754\n"}
,{"stream_name":"stdout","time":145.852539466,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.852788457,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=1.196211e-02\n"}
,{"stream_name":"stdout","time":145.853628566,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.853738147,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.853828164,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":145.853943559,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.854017554,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.854106634,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":145.854164926,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.85417058,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.854175304,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.854188494,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":145.872965252,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":145.872987906,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.872992407,"data":"  Original dt: 1.870383e+00 s\n"}
,{"stream_name":"stdout","time":145.87299526,"data":"  Corrected dt: 1.168989e+00 s\n"}
,{"stream_name":"stdout","time":145.872998794,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.873004158,"data":"  Max wave speed detected: 4.28 m/s\n"}
,{"stream_name":"stdout","time":145.934336621,"data":"[PROGRESS] Step 450: t=505.52/510.00s (99.1%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":145.968299906,"data":"  Stored output at t = 510.0000 s (Step 454)\n"}
,{"stream_name":"stdout","time":145.968503782,"data":"\n"}
,{"stream_name":"stderr","time":145.968508328,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 131.90s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 131.68s/s]\n"}
,{"stream_name":"stdout","time":145.968517826,"data":"Simulation finished at t = 510.0000 s after 454 steps.\n"}
,{"stream_name":"stdout","time":145.968544224,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stdout","time":145.970383448,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":145.970423853,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":145.97058643,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":145.970919217,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":145.970960799,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":145.971108783,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.200831e-02, max=1.372690e-01, std=2.611677e-02\n"}
,{"stream_name":"stdout","time":145.971257052,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206566, rho_c=0.093106\n"}
,{"stream_name":"stdout","time":145.97137009,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.034391, w_c=5.887823\n"}
,{"stream_name":"stdout","time":145.971433561,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: 5935711085613162931\n"}
,{"stream_name":"stdout","time":145.971520322,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.971730372,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=1.200831e-02\n"}
,{"stream_name":"stdout","time":145.972589518,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":145.972740777,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":145.972822341,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":145.972892924,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":145.972977912,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":145.97313035,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":145.973143907,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":145.973148897,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.973198344,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":145.973206205,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.088115996,"data":"  Stored output at t = 525.0000 s (Step 467)\n"}
,{"stream_name":"stderr","time":146.088344297,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 130.86s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 130.66s/s]\n"}
,{"stream_name":"stdout","time":146.08836505,"data":"\n"}
,{"stream_name":"stdout","time":146.088379096,"data":"Simulation finished at t = 525.0000 s after 467 steps.\n"}
,{"stream_name":"stdout","time":146.08838366,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":146.089876518,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.089962544,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.090076077,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":146.090386767,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.090481173,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.090568444,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.205112e-02, max=1.353381e-01, std=2.591193e-02\n"}
,{"stream_name":"stdout","time":146.090764601,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206576, rho_c=0.092945\n"}
,{"stream_name":"stdout","time":146.090833902,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.033479, w_c=5.881545\n"}
,{"stream_name":"stdout","time":146.090920338,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: 4217200330141691474\n"}
,{"stream_name":"stdout","time":146.091011074,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.091182949,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=1.205112e-02\n"}
,{"stream_name":"stdout","time":146.092116036,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":146.092215749,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.092317086,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":146.09242113,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":146.092480028,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":146.092587384,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":146.092625229,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":146.092638868,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.092646688,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":146.092652008,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.20564916,"data":"  Stored output at t = 540.0000 s (Step 480)\n"}
,{"stream_name":"stdout","time":146.205885903,"data":"\n"}
,{"stream_name":"stdout","time":146.205897326,"data":"Simulation finished at t = 540.0000 s after 480 steps.\n"}
,{"stream_name":"stdout","time":146.205901488,"data":"Total runtime: 0.11 seconds.\n"}
,{"stream_name":"stderr","time":146.205907287,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 133.19s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 132.94s/s]\n"}
,{"stream_name":"stdout","time":146.207442464,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.207508357,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.207666395,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":146.207999765,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.208065079,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.208177314,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.209057e-02, max=1.334820e-01, std=2.571081e-02\n"}
,{"stream_name":"stdout","time":146.208334222,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206589, rho_c=0.092787\n"}
,{"stream_name":"stdout","time":146.208405252,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.032645, w_c=5.875526\n"}
,{"stream_name":"stdout","time":146.208510447,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: -5121474022389166009\n"}
,{"stream_name":"stdout","time":146.208576153,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.2087812,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=1.209057e-02\n"}
,{"stream_name":"stdout","time":146.209664532,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":146.209769165,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.20987585,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":146.209972778,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":146.210046086,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":146.210134192,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":146.210192896,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":146.210199188,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.210203661,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":146.210208266,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.327313429,"data":"  Stored output at t = 555.0000 s (Step 493)\n"}
,{"stream_name":"stdout","time":146.327451619,"data":"\n"}
,{"stream_name":"stdout","time":146.327464873,"data":"Simulation finished at t = 555.0000 s after 493 steps.\n"}
,{"stream_name":"stdout","time":146.32746944,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":146.327474684,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 128.52s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 128.35s/s]\n"}
,{"stream_name":"stdout","time":146.328974075,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.329069701,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.329189673,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":146.329506147,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.329583213,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.32972869,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.212735e-02, max=1.316805e-01, std=2.551317e-02\n"}
,{"stream_name":"stdout","time":146.329909783,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206607, rho_c=0.092631\n"}
,{"stream_name":"stdout","time":146.329967518,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.031888, w_c=5.869757\n"}
,{"stream_name":"stdout","time":146.330061543,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: -8088300252895714868\n"}
,{"stream_name":"stdout","time":146.330155451,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.330333131,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=1.212735e-02\n"}
,{"stream_name":"stdout","time":146.331274787,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":146.331322314,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.331463977,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":146.331531617,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":146.331673864,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":146.331800045,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":146.331814968,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":146.331820882,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.331842661,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":146.331863664,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.396291258,"data":"[PROGRESS] Step 500: t=563.18/570.00s (98.8%) | dt=1.1690s\n"}
,{"stream_name":"stdout","time":146.453037747,"data":"  Stored output at t = 570.0000 s (Step 506)\n"}
,{"stream_name":"stderr","time":146.453157605,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 124.19s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 124.02s/s]\n"}
,{"stream_name":"stdout","time":146.453179072,"data":"\n"}
,{"stream_name":"stdout","time":146.453213972,"data":"Simulation finished at t = 570.0000 s after 506 steps.\n"}
,{"stream_name":"stdout","time":146.453220149,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stdout","time":146.45482355,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.454881139,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.455056969,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":146.455379948,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.455428475,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.455559131,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.216064e-02, max=1.299298e-01, std=2.531942e-02\n"}
,{"stream_name":"stdout","time":146.455758673,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206627, rho_c=0.092477\n"}
,{"stream_name":"stdout","time":146.45586289,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.031204, w_c=5.864230\n"}
,{"stream_name":"stdout","time":146.455965417,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: -7086590042684976484\n"}
,{"stream_name":"stdout","time":146.456041546,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.456242946,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=1.216064e-02\n"}
,{"stream_name":"stdout","time":146.457282871,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":146.457365764,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.457489365,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":146.457621843,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":146.457745412,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":146.45789107,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":146.457898297,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":146.457903107,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.457948871,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":146.457959805,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.578387507,"data":"  Stored output at t = 585.0000 s (Step 519)\n"}
,{"stream_name":"stdout","time":146.578575788,"data":"\n"}
,{"stream_name":"stdout","time":146.578586544,"data":"Simulation finished at t = 585.0000 s after 519 steps.\n"}
,{"stream_name":"stdout","time":146.578591894,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":146.578618495,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 124.93s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 124.76s/s]\n"}
,{"stream_name":"stdout","time":146.580142733,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.580203998,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.580348469,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":146.580677143,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.580759295,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.580900332,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.218838e-02, max=1.282264e-01, std=2.513042e-02\n"}
,{"stream_name":"stdout","time":146.581060738,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206652, rho_c=0.092325\n"}
,{"stream_name":"stdout","time":146.581128595,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.030595, w_c=5.858945\n"}
,{"stream_name":"stdout","time":146.58123442,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:932 -   State hash: 4865896734142565207\n"}
,{"stream_name":"stdout","time":146.58130144,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.581513147,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=1.218838e-02\n"}
,{"stream_name":"stdout","time":146.582439707,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":146.582504255,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:879 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.582646065,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:880 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":146.582734771,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:881 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":146.582825655,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:882 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":146.58291977,"data":"2025-10-25 11:23:02 - INFO - run_control_simulation:883 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":146.58297524,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2125, 2.469135802469136, 0.10200000000000001, 2.160493827160494]\n"}
,{"stream_name":"stdout","time":146.582981859,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.583003175,"data":"  └─ Inflow state: rho_m=0.2125, w_m=2.5, rho_c=0.1020, w_c=2.2\n"}
,{"stream_name":"stdout","time":146.583009327,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":146.698101392,"data":"  Stored output at t = 600.0000 s (Step 532)\n"}
,{"stream_name":"stdout","time":146.698132828,"data":"\n"}
,{"stream_name":"stdout","time":146.698138512,"data":"Simulation finished at t = 600.0000 s after 532 steps.\n"}
,{"stream_name":"stdout","time":146.698143165,"data":"Total runtime: 0.12 seconds.\n"}
,{"stream_name":"stderr","time":146.698146523,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 130.83s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 130.70s/s]\n"}
,{"stream_name":"stdout","time":146.699856059,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":146.699875934,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":146.699881243,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":146.699885814,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:898 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":146.69996966,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:899 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":146.700320815,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:915 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":146.70039334,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:916 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":146.700521807,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:917 -     Diff statistics: mean=1.220699e-02, max=1.265655e-01, std=2.494723e-02\n"}
,{"stream_name":"stdout","time":146.70073507,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:927 -     Mean densities: rho_m=0.206680, rho_c=0.092176\n"}
,{"stream_name":"stdout","time":146.700821263,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:928 -     Mean velocities: w_m=4.030065, w_c=5.853910\n"}
,{"stream_name":"stdout","time":146.700949598,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:932 -   State hash: -4323773809443393909\n"}
,{"stream_name":"stdout","time":146.701039002,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:934 - ================================================================================\n"}
,{"stream_name":"stdout","time":146.701232308,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=1.220699e-02\n"}
,{"stream_name":"stdout","time":146.701252789,"data":"\n"}
,{"stream_name":"stdout","time":146.701273601,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":146.701278181,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":146.701282506,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":146.701286633,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":146.701290923,"data":"    - Avg step time: 0.126s (device=gpu)\n"}
,{"stream_name":"stdout","time":146.701308412,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":146.701312511,"data":"    - Wallclock time: 5.0s\n"}
,{"stream_name":"stdout","time":146.701316087,"data":"    - Speed ratio: 119.41x real-time\n"}
,{"stream_name":"stdout","time":146.701319719,"data":"\n"}
,{"stream_name":"stdout","time":146.70137108,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:974 - \n"}
,{"stream_name":"stdout","time":146.701376752,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":146.701381117,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":146.701384801,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":146.701388271,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":146.701391826,"data":"    - Avg step time: 0.126s (device=gpu)\n"}
,{"stream_name":"stdout","time":146.701395351,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":146.701398863,"data":"    - Wallclock time: 5.0s\n"}
,{"stream_name":"stdout","time":146.701402414,"data":"    - Speed ratio: 119.41x real-time\n"}
,{"stream_name":"stdout","time":146.701406091,"data":"\n"}
,{"stream_name":"stdout","time":146.701515161,"data":"2025-10-25 11:23:03 - INFO - run_control_simulation:975 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":146.701919924,"data":"\n"}
,{"stream_name":"stdout","time":146.701932066,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":146.701936346,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":146.701940105,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":146.701951237,"data":"\n"}
,{"stream_name":"stdout","time":146.707655499,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1010 - ✅ Loaded domain_length from config: 1000.0m\n"}
,{"stream_name":"stdout","time":146.707675104,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1017 - Evaluating performance with 40 state snapshots (domain_length=1000.0m)\n"}
,{"stream_name":"stdout","time":146.707698021,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1018 -   HASH CHECK - first=7000422941581491000, last=-4323773809443393909\n"}
,{"stream_name":"stdout","time":146.708175594,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1028 - First state sample - rho_m[10:15]=[0.21249989 0.21249999 0.2125     0.2125     0.2125    ], w_m[10:15]=[4.11588321 4.1158847  4.11588486 4.11588488 4.11588488]\n"}
,{"stream_name":"stdout","time":146.713799419,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1030 - Last state sample - rho_m[10:15]=[0.21468176 0.21450438 0.21433411 0.21416905 0.214008  ], w_m[10:15]=[3.95509078 3.97220545 3.98814934 4.00301987 4.0168975 ]\n"}
,{"stream_name":"stdout","time":146.713965492,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1087 - Boundary flow: 7.515436 (RED should be ~0, GREEN should be \u003e0)\n"}
,{"stream_name":"stdout","time":146.714085502,"data":"2025-10-25 11:23:03 - INFO - evaluate_traffic_performance:1110 - Calculated metrics: flow=7.515436, efficiency=1.632981, delay=-31.05s\n"}
,{"stream_name":"stdout","time":146.714231401,"data":"2025-10-25 11:23:03 - INFO - run_performance_comparison:1503 - Baseline performance: {'total_flow': 13.133499135176526, 'avg_speed': 40.939382943714186, 'avg_density': 0.2707034894236502, 'efficiency': 1.783586354305774, 'delay': -57.72432804912269, 'throughput': 65667.49567588263}\n"}
,{"stream_name":"stdout","time":146.714317776,"data":"2025-10-25 11:23:03 - INFO - run_performance_comparison:1504 - RL performance: {'total_flow': 7.515435925903345, 'avg_speed': 33.60030566205515, 'avg_density': 0.3037576460504656, 'efficiency': 1.632981456705696, 'delay': -31.047945018958075, 'throughput': 37577.17962951672}\n"}
,{"stream_name":"stdout","time":146.71444807,"data":"2025-10-25 11:23:03 - INFO - run_performance_comparison:1524 - Flow improvement: -42.777%\n"}
,{"stream_name":"stdout","time":146.714522221,"data":"2025-10-25 11:23:03 - INFO - run_performance_comparison:1525 - Efficiency improvement: -8.444%\n"}
,{"stream_name":"stdout","time":146.714629228,"data":"2025-10-25 11:23:03 - INFO - run_performance_comparison:1526 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":146.714726399,"data":"  Flow improvement: -42.8%\n"}
,{"stream_name":"stdout","time":146.714736098,"data":"  Efficiency improvement: -8.4%\n"}
,{"stream_name":"stdout","time":146.714740303,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":146.71474404,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":146.715278081,"data":"\n"}
,{"stream_name":"stdout","time":146.715288647,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":147.311563893,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":147.833279495,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":147.833310527,"data":"[FIGURES] Generated 2 figures in /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":147.833316853,"data":"\n"}
,{"stream_name":"stdout","time":147.833321552,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":147.842026749,"data":"  [OK] Saved 1 scenarios to /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":147.842046944,"data":"\n"}
,{"stream_name":"stdout","time":147.842052057,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":147.842174386,"data":"  [OK] /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":147.842182753,"data":"\n"}
,{"stream_name":"stdout","time":147.842187199,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":147.842191161,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":147.842194794,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":147.842198534,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":147.842202414,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":147.84220773,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":147.84314453,"data":"[SUMMARY] Created: /kaggle/working/Code-traffic-flow/validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":150.468036477,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":150.468280096,"data":"\n"}
,{"stream_name":"stdout","time":150.468294978,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":150.468351424,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":150.471903402,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":150.473257894,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":150.473356057,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":150.473467439,"data":"[ARTIFACTS] YAML scenarios: 2\n"}
,{"stream_name":"stdout","time":150.473546846,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":150.473615393,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":150.473720676,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":150.47391047,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":150.474004156,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":150.474014781,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":150.554405763,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":150.554439092,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":150.554884104,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":150.554994022,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":150.555090391,"data":"\n"}
,{"stream_name":"stdout","time":150.555097052,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":150.555157042,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":150.555263704,"data":"\n"}
,{"stream_name":"stdout","time":150.555268989,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":150.555273094,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":150.555276838,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":150.555280597,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":154.090438723,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":154.090480306,"data":"  warn(\n"}
,{"stream_name":"stderr","time":154.162814062,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":154.934286809,"data":"[NbConvertApp] Writing 322008 bytes to __results__.html\n"}
]