[{"stream_name":"stdout","time":0.668171471,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.668284864,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.66831118,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.668316217,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.668320699,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.668325056,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.624503636,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.624920159,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.674958814,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.696219376,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.6963805,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.696449705,"data":"\n"}
,{"stream_name":"stdout","time":5.696474078,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.696607359,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.756788646,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.756912397,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.756996903,"data":"\n"}
,{"stream_name":"stdout","time":9.757007595,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.757091391,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":13.580305629,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":16.562916674,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":19.524900192,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":22.558728340000002,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":25.497735727,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":28.475777506,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":97.786177533,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":97.786406978,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":97.7864798,"data":"\n"}
,{"stream_name":"stdout","time":97.786491633,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":97.786862682,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":97.786979345,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":97.787074248,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":97.787124861,"data":"============================================================\n"}
,{"stream_name":"stderr","time":109.067611956,"data":"2025-10-15 22:03:53.297458: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":109.250604885,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":109.250671462,"data":"E0000 00:00:1760565833.480454     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":109.313229841,"data":"E0000 00:00:1760565833.543117     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":120.976508465,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":120.976536781,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":120.976542261,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":120.976546402,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":120.976550778,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":120.976554498,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":120.976558368,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":120.976658031,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":120.976670662,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":120.976674062,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":120.976676912,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":120.976679618,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":120.976682119,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":120.977212341,"data":"2025-10-15 22:04:05 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":120.977347199,"data":"2025-10-15 22:04:05 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":120.977466794,"data":"2025-10-15 22:04:05 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":120.977534877,"data":"2025-10-15 22:04:05 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":120.977636979,"data":"2025-10-15 22:04:05 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":120.977643817,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":120.977647724,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":120.977651482,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":121.093186724,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":121.193211897,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":121.193245749,"data":"\n"}
,{"stream_name":"stdout","time":121.193251207,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":121.193255504,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.193279054,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":121.193282287,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":121.193381522,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.193502251,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.193601917,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":121.19364444,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":121.193756134,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":121.193840989,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":121.193908089,"data":"2025-10-15 22:04:05 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":121.193950614,"data":"\n"}
,{"stream_name":"stdout","time":121.193956412,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":121.193960809,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":121.19396493,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":121.193968459,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":121.194174987,"data":"2025-10-15 22:04:05 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":121.194309088,"data":"2025-10-15 22:04:05 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":121.19438722699999,"data":"2025-10-15 22:04:05 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":121.194785158,"data":"2025-10-15 22:04:05 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":121.199192232,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.199258027,"data":"2025-10-15 22:04:05 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.199398261,"data":"2025-10-15 22:04:05 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":121.199500786,"data":"2025-10-15 22:04:05 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":121.199598662,"data":"2025-10-15 22:04:05 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":121.199610256,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":121.199615452,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":121.199743626,"data":"2025-10-15 22:04:05 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":121.199905658,"data":"2025-10-15 22:04:05 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":121.200085831,"data":"2025-10-15 22:04:05 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":121.200221951,"data":"2025-10-15 22:04:05 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config a6721e38\n"}
,{"stream_name":"stdout","time":121.200229561,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":121.200726726,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":121.20074229,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":121.207749975,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":121.207766172,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":121.207771083,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":121.207775434,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":121.207778786,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":121.207782639,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":121.207786433,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":121.207790719,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":121.207836818,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":121.207850043,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":121.207923829,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":121.207929464,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":121.21140552,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":121.211421492,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":121.211952084,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":121.211961397,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":122.630317055,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":122.6303453,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":122.63034957,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":122.630352949,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":122.630356707,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":122.630360074,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":122.630363584,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":122.630367457,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":122.63069677,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":122.631529423,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":122.631558303,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":122.63161518,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":127.151760314,"data":"2025-10-15 22:04:11 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":127.152172829,"data":"\n"}
,{"stream_name":"stdout","time":127.152183965,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":127.152191315,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":127.152198035,"data":"\n"}
,{"stream_name":"stdout","time":127.152203293,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":127.152208929,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":127.152214978,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":127.152226829,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":127.152232094,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":127.152238094,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":127.152243321,"data":"\n"}
,{"stream_name":"stdout","time":127.152281616,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":127.152289675,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":127.16202244,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":127.162052235,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":127.162059407,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":127.162064369,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":127.162070477,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":127.162103386,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":127.162129767,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":127.162135707,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":127.162154751,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":127.162164286,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":127.162233081,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":127.162243657,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":127.163113982,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":127.163131775,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":127.164260817,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":127.164272776,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":127.164278486,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":127.164286103,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":127.169652288,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":127.169909401,"data":"\n"}
,{"stream_name":"stdout","time":127.169920445,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":127.171676455,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":127.171692568,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":127.171697975,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":127.171719609,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":127.172167374,"data":"\n"}
,{"stream_name":"stderr","time":127.218767249,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":127.218796129,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":127.99975743,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":127.999783846,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":127.999799128,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":127.999802957,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":127.99980686,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":127.999810475,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":128.193149948,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.193182978,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.450912657,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.450942662,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.511496188,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.511528037,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":128.57068238,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":128.570728297,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.020095167,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.020126219,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.094807807,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.094831269,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.182512099,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.18254041,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.282202492,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.282247778,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.381091878,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.381120333,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.440154593,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.440181146,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.496980612,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.497007819,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":129.875143977,"data":"\n"}
,{"stream_name":"stderr","time":129.875173828,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":129.875143971,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":129.875459041,"data":"\n"}
,{"stream_name":"stdout","time":129.875477999,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":129.875482988,"data":"Total runtime: 2.70 seconds.\n"}
,{"stream_name":"stderr","time":129.875462512,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.55s/s]\n"}
,{"stream_name":"stdout","time":129.877295612,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":129.87759907,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":129.877607419,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.877611741,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":129.877615932,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.877864144,"data":"\n"}
,{"stream_name":"stdout","time":129.955127715,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":130.356576005,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.356607463,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":130.35660373,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":130.356816058,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.34s/s]\n"}
,{"stream_name":"stdout","time":130.356837796,"data":"\n"}
,{"stream_name":"stdout","time":130.356846396,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":130.356852021,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":130.358388766,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.358746275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":130.358760949,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.358767108,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":130.358770684,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.358965714,"data":"\n"}
,{"stream_name":"stdout","time":130.405618866,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":130.405642008,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":130.405647811,"data":"  Original dt: 4.547586e-01 s\n"}
,{"stream_name":"stdout","time":130.40565157,"data":"  Corrected dt: 2.842241e-01 s\n"}
,{"stream_name":"stdout","time":130.405655307,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":130.405660722,"data":"  Max wave speed detected: 17.59 m/s\n"}
,{"stream_name":"stdout","time":130.414122369,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":130.872804544,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":130.872855142,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":130.87290214,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":130.873213112,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.18s/s]\n"}
,{"stream_name":"stdout","time":130.873244649,"data":"\n"}
,{"stream_name":"stdout","time":130.873249935,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":130.873254209,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":130.876117472,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":130.876505934,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":130.876517886,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":130.876522985,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":130.8765274,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":130.876721231,"data":"\n"}
,{"stream_name":"stdout","time":130.905666048,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":131.359560605,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":131.359589224,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":131.35959483,"data":"  Original dt: 4.525311e-01 s\n"}
,{"stream_name":"stdout","time":131.359599002,"data":"  Corrected dt: 2.828319e-01 s\n"}
,{"stream_name":"stdout","time":131.359603173,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":131.359608084,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":131.368079604,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":131.37787352,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":131.377911909,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.377928839,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":131.378137795,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.93s/s]\n"}
,{"stream_name":"stdout","time":131.378185274,"data":"\n"}
,{"stream_name":"stdout","time":131.378198569,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":131.378203768,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":131.379861205,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":131.380385362,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":131.380394012,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.380399023,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":131.380403315,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.380600114,"data":"\n"}
,{"stream_name":"stdout","time":131.820345133,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":131.865786545,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":131.865815778,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":131.865817372,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":131.866136521,"data":"\n"}
,{"stream_name":"stdout","time":131.86614543,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":131.866149309,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":131.86614701,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.91s/s]\n"}
,{"stream_name":"stdout","time":131.867752254,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":131.868085729,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":131.868098211,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":131.868118604,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":131.868122887,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":131.868302805,"data":"\n"}
,{"stream_name":"stdout","time":132.288599781,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":132.288635994,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.288640996,"data":"  Original dt: 4.524790e-01 s\n"}
,{"stream_name":"stdout","time":132.288643678,"data":"  Corrected dt: 2.827993e-01 s\n"}
,{"stream_name":"stdout","time":132.288646174,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.28864873,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":132.296441603,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":132.376251486,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.376289638,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.37628838,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":132.376463337,"data":"\n"}
,{"stream_name":"stdout","time":132.376478744,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stderr","time":132.376479516,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.53s/s]\n"}
,{"stream_name":"stdout","time":132.376483711,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":132.378276394,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":132.378559257,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":132.378569432,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.378574654,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":132.378596555,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.378819727,"data":"\n"}
,{"stream_name":"stdout","time":132.7415178,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":132.859881156,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":132.859888792,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.859916835,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.860224051,"data":"\n"}
,{"stream_name":"stdout","time":132.860232247,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":132.860236807,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":132.860242573,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.17s/s]\n"}
,{"stream_name":"stdout","time":132.861990425,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":132.862394404,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":132.862402283,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.862407403,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":132.862411537,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.862636839,"data":"\n"}
,{"stream_name":"stdout","time":133.190308464,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":133.190336435,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":133.190341754,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":133.190346978,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":133.190350886,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":133.190354459,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":133.198934168,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":133.353318463,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":133.353318457,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.353364662,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.353524862,"data":"\n"}
,{"stream_name":"stdout","time":133.353534187,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":133.353538957,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":133.353557541,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.57s/s]\n"}
,{"stream_name":"stdout","time":133.355203422,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":133.355231168,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":133.355236254,"data":"\n"}
,{"stream_name":"stdout","time":133.35523878,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.355241423,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.01 | Avg Reward/Step: 0.001\n"}
,{"stream_name":"stdout","time":133.355243933,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":133.355246784,"data":"\n"}
,{"stream_name":"stdout","time":133.355249263,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":133.355251977,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":133.362388947,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":133.362407279,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":133.362412312,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":133.36241701,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":133.362421291,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":133.362519222,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":133.362527134,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":133.362531347,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":133.362535621,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":133.362554165,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.362579353,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":133.362586532,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":133.363177887,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":133.363189911,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":133.363414803,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":133.363665469,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.363672877,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.363677938,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.36550256,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.365514742,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.365519498,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.365536837,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.365692296,"data":"\n"}
,{"stream_name":"stderr","time":133.744884898,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":133.744892927,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":133.744913183,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":133.745011681,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.56s/s]\n"}
,{"stream_name":"stdout","time":133.745031232,"data":"\n"}
,{"stream_name":"stdout","time":133.745035807,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":133.745039449,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":133.746688177,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":133.746900737,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.746915666,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":133.746920104,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":133.74692382,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.747068669,"data":"\n"}
,{"stream_name":"stdout","time":133.819793154,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":134.125646815,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":134.125672866,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.125677834,"data":"  Original dt: 4.571011e-01 s\n"}
,{"stream_name":"stdout","time":134.125681632,"data":"  Corrected dt: 2.856882e-01 s\n"}
,{"stream_name":"stdout","time":134.125685294,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.125688975,"data":"  Max wave speed detected: 17.50 m/s\n"}
,{"stream_name":"stderr","time":134.23765375,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.237719145,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.23766645,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":134.237760626,"data":"\n"}
,{"stream_name":"stdout","time":134.237772996,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":134.237777481,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":134.237776917,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":134.239315834,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":134.239633752,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.239641454,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":134.239645627,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":134.239649359,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.239830417,"data":"\n"}
,{"stream_name":"stdout","time":134.294615467,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":134.71961996,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":134.719633075,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.719654104,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.719941081,"data":"\n"}
,{"stream_name":"stderr","time":134.719939859,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.26s/s]\n"}
,{"stream_name":"stdout","time":134.719955938,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":134.719983629,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":134.721676332,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.721980639,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.721991714,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":134.721996554,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":134.722001008,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.722171349,"data":"\n"}
,{"stream_name":"stdout","time":134.750067152,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":135.044353795,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":135.04438253,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.044388072,"data":"  Original dt: 4.525738e-01 s\n"}
,{"stream_name":"stdout","time":135.04439224,"data":"  Corrected dt: 2.828586e-01 s\n"}
,{"stream_name":"stdout","time":135.044396283,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.044400194,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":135.214518372,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":135.224113642,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.224139088,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.224111464,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":135.22440879,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.89s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.88s/s]\n"}
,{"stream_name":"stdout","time":135.224426448,"data":"\n"}
,{"stream_name":"stdout","time":135.224435463,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":135.224440133,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":135.226255758,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.22665492,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.22666785,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.226672655,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":135.226676787,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.226875631,"data":"\n"}
,{"stream_name":"stdout","time":135.671803814,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":135.716062798,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":135.716083327,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.716094006,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.716372111,"data":"\n"}
,{"stream_name":"stdout","time":135.716386414,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":135.716390839,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":135.716402712,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.66s/s]\n"}
,{"stream_name":"stdout","time":135.717912987,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":135.718233682,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.718242614,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.718246995,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":135.718251097,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.718417531,"data":"\n"}
,{"stream_name":"stdout","time":135.966055228,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":135.966085303,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.966107609,"data":"  Original dt: 4.524808e-01 s\n"}
,{"stream_name":"stdout","time":135.966111902,"data":"  Corrected dt: 2.828005e-01 s\n"}
,{"stream_name":"stdout","time":135.966115481,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.966118966,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":136.127469689,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":136.207798653,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.207835803,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.207798656,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":136.207922694,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.66s/s]\n"}
,{"stream_name":"stdout","time":136.207951797,"data":"\n"}
,{"stream_name":"stdout","time":136.207969349,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":136.207974337,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":136.209619045,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.209961412,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.209971973,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.209976265,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":136.209980308,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.210189246,"data":"\n"}
,{"stream_name":"stdout","time":136.585500325,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":136.703382027,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.703407991,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.703381891,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":136.703655553,"data":"\n"}
,{"stream_name":"stderr","time":136.70365281,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":136.703662652,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":136.703671707,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":136.705412788,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":136.705626753,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.705648362,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.705653301,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":136.705657708,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.705839369,"data":"\n"}
,{"stream_name":"stdout","time":136.883614903,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":136.883640553,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.883645823,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":136.883649621,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":136.883653242,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.883658531,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":137.051364496,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":137.217976447,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.218013416,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.217978283,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":137.218170923,"data":"\n"}
,{"stream_name":"stdout","time":137.218180531,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":137.218185049,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":137.218200839,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.29s/s]\n"}
,{"stream_name":"stdout","time":137.220020468,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.22004071,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":137.220047246,"data":"\n"}
,{"stream_name":"stdout","time":137.220050978,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.220054684,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":137.220059034,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":137.220063086,"data":"\n"}
,{"stream_name":"stdout","time":137.220067401,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":137.220071504,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":137.228133996,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":137.228155638,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":137.228161666,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":137.228165703,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":137.228192132,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":137.2282793,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":137.228288179,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":137.228293117,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":137.22829782,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":137.228400129,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.228406735,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":137.228410605,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":137.22911995,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":137.22913212,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":137.229455205,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":137.229738395,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.229750237,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.229754851,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":137.231759094,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.231769695,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.231772811,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":137.231775605,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.231986343,"data":"\n"}
,{"stream_name":"stderr","time":137.61674816,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.616777271,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.616756511,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":137.617051533,"data":"\n"}
,{"stream_name":"stderr","time":137.617052256,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.99s/s]\n"}
,{"stream_name":"stdout","time":137.617064101,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":137.61707543,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":137.619196335,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.619429754,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.619439134,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.619457851,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":137.6194622,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.619736102,"data":"\n"}
,{"stream_name":"stdout","time":137.693205372,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":137.831229828,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":137.831259964,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.831265885,"data":"  Original dt: 4.622455e-01 s\n"}
,{"stream_name":"stdout","time":137.831270604,"data":"  Corrected dt: 2.889034e-01 s\n"}
,{"stream_name":"stdout","time":137.831274361,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.831278007,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stderr","time":138.106081401,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":138.106100821,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":138.106110524,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":138.106214553,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.84s/s]\n"}
,{"stream_name":"stdout","time":138.1062142,"data":"\n"}
,{"stream_name":"stdout","time":138.106232681,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":138.10623724,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":138.108050129,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.108366844,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.108374437,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.108378421,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":138.108382248,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.108572447,"data":"\n"}
,{"stream_name":"stdout","time":138.166502294,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":138.606837171,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":138.606862031,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":138.606867695,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.607079462,"data":"\n"}
,{"stream_name":"stderr","time":138.607080609,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.11s/s]\n"}
,{"stream_name":"stdout","time":138.607087967,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":138.607116858,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":138.608758314,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.609079751,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.609087302,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.609091951,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":138.609096241,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.609319369,"data":"\n"}
,{"stream_name":"stdout","time":138.636673901,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":138.773683022,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":138.773726326,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.773735569,"data":"  Original dt: 4.526561e-01 s\n"}
,{"stream_name":"stdout","time":138.773739656,"data":"  Corrected dt: 2.829101e-01 s\n"}
,{"stream_name":"stdout","time":138.773743223,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.773746841,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":139.102988799,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":139.113041595,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.113074092,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.11304649,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":139.113397791,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.77s/s]\n"}
,{"stream_name":"stdout","time":139.113412433,"data":"\n"}
,{"stream_name":"stdout","time":139.113426725,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":139.113432136,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":139.115038283,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.115447641,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.115458814,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.115463585,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":139.115467478,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.115606603,"data":"\n"}
,{"stream_name":"stdout","time":139.583594815,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":139.630306378,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.630337437,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.630324461,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":139.630434356,"data":"\n"}
,{"stream_name":"stdout","time":139.630464213,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":139.630470761,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":139.630442695,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.15s/s]\n"}
,{"stream_name":"stdout","time":139.632160593,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.632462528,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.632474028,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.632478558,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.632482789,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.632646928,"data":"\n"}
,{"stream_name":"stdout","time":139.725340297,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":139.725366547,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.725372407,"data":"  Original dt: 4.524838e-01 s\n"}
,{"stream_name":"stdout","time":139.725376494,"data":"  Corrected dt: 2.828024e-01 s\n"}
,{"stream_name":"stdout","time":139.725380632,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.725384842,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":140.044344264,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":140.127196136,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.127232624,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.127196133,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":140.127386092,"data":"\n"}
,{"stream_name":"stderr","time":140.127385395,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.34s/s]\n"}
,{"stream_name":"stdout","time":140.127394245,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":140.127403163,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":140.129024757,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.129226521,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.129255094,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.12926001,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":140.129263892,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.129424709,"data":"\n"}
,{"stream_name":"stdout","time":140.510943987,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":140.636544046,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.636570544,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.636582886,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":140.636933067,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.57s/s]\n"}
,{"stream_name":"stdout","time":140.636975502,"data":"\n"}
,{"stream_name":"stdout","time":140.63699121,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":140.636995993,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":140.638726005,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.639036451,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.639043301,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.639047849,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":140.639051864,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.639232776,"data":"\n"}
,{"stream_name":"stdout","time":140.660881935,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":140.660908293,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.660914809,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":140.660919188,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":140.660923386,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.660927575,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":141.005914637,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":141.163188178,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":141.163198235,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.163237901,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":141.163537001,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.64s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.63s/s]\n"}
,{"stream_name":"stdout","time":141.163544261,"data":"\n"}
,{"stream_name":"stdout","time":141.163574794,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":141.163580208,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":141.165317226,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.165336751,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":141.165342133,"data":"\n"}
,{"stream_name":"stdout","time":141.165346241,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.165351006,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":141.165354887,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":141.165358599,"data":"\n"}
,{"stream_name":"stdout","time":141.165362037,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":141.165366452,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":141.173084063,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":141.173103605,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":141.173107328,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":141.173110183,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":141.173113027,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":141.173244289,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":141.173261397,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":141.173267011,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":141.173289185,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":141.173295288,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.173368555,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":141.173375702,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":141.174073062,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":141.174092884,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":141.174367675,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":141.174601444,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.174611673,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.174617193,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":141.176537315,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.176570693,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.176576784,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":141.176581113,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.176728456,"data":"\n"}
,{"stream_name":"stdout","time":141.561852131,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":141.561920416,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.56193877,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.561973273,"data":"\n"}
,{"stream_name":"stdout","time":141.561983183,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":141.561987686,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":141.561984994,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.96s/s]\n"}
,{"stream_name":"stdout","time":141.563818245,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.564158209,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.564171069,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.564176564,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":141.564180659,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.564362426,"data":"\n"}
,{"stream_name":"stdout","time":141.623017385,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":141.623044662,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.623050477,"data":"  Original dt: 4.733134e-01 s\n"}
,{"stream_name":"stdout","time":141.623055006,"data":"  Corrected dt: 2.958209e-01 s\n"}
,{"stream_name":"stdout","time":141.623059603,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.623064728,"data":"  Max wave speed detected: 16.90 m/s\n"}
,{"stream_name":"stdout","time":141.641093515,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":142.050669091,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":142.050732695,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.050749701,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.050918851,"data":"\n"}
,{"stream_name":"stdout","time":142.050924995,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stderr","time":142.050924715,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.84s/s]\n"}
,{"stream_name":"stdout","time":142.05092901,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":142.052737113,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.053090279,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.053098561,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.05310362,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":142.053108239,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.053318736,"data":"\n"}
,{"stream_name":"stdout","time":142.108283443,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":142.53764703,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":142.537644744,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.537675858,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":142.537880901,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.97s/s]\n"}
,{"stream_name":"stdout","time":142.537904933,"data":"\n"}
,{"stream_name":"stdout","time":142.537912215,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":142.53791615,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":142.539431254,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.539730632,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.539741296,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.539745622,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":142.539749571,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.539908806,"data":"\n"}
,{"stream_name":"stdout","time":142.549872334,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":142.549910024,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.549915329,"data":"  Original dt: 4.528082e-01 s\n"}
,{"stream_name":"stdout","time":142.549919353,"data":"  Corrected dt: 2.830051e-01 s\n"}
,{"stream_name":"stdout","time":142.549923089,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.549926815,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":142.56684583,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":143.013747781,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":143.022952783,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":143.022955625,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.022984275,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.023306173,"data":"\n"}
,{"stream_name":"stdout","time":143.023320365,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":143.023325437,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":143.023330673,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.05s/s]\n"}
,{"stream_name":"stdout","time":143.025152911,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":143.025535465,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.025548008,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.025552948,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":143.02556876,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.025748263,"data":"\n"}
,{"stream_name":"stdout","time":143.449967519,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":143.449995898,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.450000944,"data":"  Original dt: 4.524884e-01 s\n"}
,{"stream_name":"stdout","time":143.450004512,"data":"  Corrected dt: 2.828052e-01 s\n"}
,{"stream_name":"stdout","time":143.4500081,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.450011773,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":143.466879453,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":143.513465708,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":143.513465565,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.513511594,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.513726281,"data":"\n"}
,{"stream_name":"stdout","time":143.513742846,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":143.513747766,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":143.513771363,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":143.515331616,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.515626559,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.515637986,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.515642441,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":143.515646318,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.515817609,"data":"\n"}
,{"stream_name":"stdout","time":143.920118651,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":144.003142287,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.003164613,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.003221063,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":144.003500254,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.77s/s]\n"}
,{"stream_name":"stdout","time":144.003519698,"data":"\n"}
,{"stream_name":"stdout","time":144.003540275,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":144.003545557,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":144.005166125,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.005462519,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.00546988,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.005474664,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":144.005478893,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.005643015,"data":"\n"}
,{"stream_name":"stdout","time":144.378382174,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":144.378413257,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.378418579,"data":"  Original dt: 4.524768e-01 s\n"}
,{"stream_name":"stdout","time":144.378422448,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":144.378425819,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.378429148,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":144.395780143,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":144.512995765,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":144.51301844,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":144.513028739,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":144.513114226,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.57s/s]\n"}
,{"stream_name":"stdout","time":144.513145675,"data":"\n"}
,{"stream_name":"stdout","time":144.513157183,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":144.513161819,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":144.514867856,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.515105339,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.515114515,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.515120092,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":144.515124661,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.515299668,"data":"\n"}
,{"stream_name":"stdout","time":144.848644346,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":145.00374752,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":145.003779935,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":145.003791726,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":145.004114612,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.70s/s]\n"}
,{"stream_name":"stdout","time":145.004144808,"data":"\n"}
,{"stream_name":"stdout","time":145.004175103,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":145.004179653,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":145.005903575,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.005922303,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":145.005933515,"data":"\n"}
,{"stream_name":"stdout","time":145.005937555,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.00594143,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":145.005945007,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.005948535,"data":"\n"}
,{"stream_name":"stdout","time":145.005954705,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.005958692,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.013507039,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.013544465,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.013550299,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.013554797,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.01356024,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.013661027,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.013667992,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.013672612,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.01368584,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.013698302,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.013771832,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.013779487,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.014366463,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.01437372,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":145.01464079,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.01535246,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.015370903,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.015376329,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":145.01740684,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":145.017424224,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":145.017428755,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":145.017432495,"data":"|    ep_rew_mean      | 0.0825   |\n"}
,{"stream_name":"stdout","time":145.017436183,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":145.01743903,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":145.017441583,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":145.017444077,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":145.017446588,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":145.017449012,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":145.017451401,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":145.018449112,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.018472044,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":145.018476981,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":145.018479957,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.018626931,"data":"\n"}
,{"stream_name":"stdout","time":145.301727613,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":145.301770164,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.301774694,"data":"  Original dt: 4.993670e-01 s\n"}
,{"stream_name":"stdout","time":145.301777353,"data":"  Corrected dt: 3.121044e-01 s\n"}
,{"stream_name":"stdout","time":145.301779773,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.301782282,"data":"  Max wave speed detected: 16.02 m/s\n"}
,{"stream_name":"stdout","time":145.404256188,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":145.40426666,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.404291063,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.4045203,"data":"\n"}
,{"stream_name":"stderr","time":145.404527213,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.89s/s]\n"}
,{"stream_name":"stdout","time":145.40453414,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":145.404544822,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":145.406281334,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.406600154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.406611969,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.406621003,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":145.406626923,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.406772568,"data":"\n"}
,{"stream_name":"stdout","time":145.479882651,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":145.88176217,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":145.881843864,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.88186148,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.882006163,"data":"\n"}
,{"stream_name":"stdout","time":145.88201731,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":145.882022236,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":145.882024483,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.58s/s]\n"}
,{"stream_name":"stdout","time":145.883778752,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.88412473099999,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.884154475,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.884159486,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":145.884163629,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.884307944,"data":"\n"}
,{"stream_name":"stdout","time":145.94041915,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":146.224493158,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":146.224517789,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.22452297,"data":"  Original dt: 4.531092e-01 s\n"}
,{"stream_name":"stdout","time":146.224527342,"data":"  Corrected dt: 2.831933e-01 s\n"}
,{"stream_name":"stdout","time":146.224531613,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.224535704,"data":"  Max wave speed detected: 17.66 m/s\n"}
,{"stream_name":"stdout","time":146.368181301,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":146.368182932,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.368215558,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.368390882,"data":"\n"}
,{"stream_name":"stdout","time":146.36840055,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":146.368404759,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":146.36839935,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.00s/s]\n"}
,{"stream_name":"stdout","time":146.370016961,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.370238219,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.37024679,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":146.370252144,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":146.370256724,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.370423275,"data":"\n"}
,{"stream_name":"stdout","time":146.397995493,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":146.858201857,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":146.867898416,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":146.867910201,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.867930832,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.868243801,"data":"\n"}
,{"stream_name":"stdout","time":146.868252434,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stderr","time":146.868263856,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.15s/s]\n"}
,{"stream_name":"stdout","time":146.868273352,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":146.869910396,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.870339124,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.870347547,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":146.870352096,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":146.870356447,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.870545224,"data":"\n"}
,{"stream_name":"stdout","time":147.161013607,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":147.161047556,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.161054679,"data":"  Original dt: 4.524965e-01 s\n"}
,{"stream_name":"stdout","time":147.161059362,"data":"  Corrected dt: 2.828103e-01 s\n"}
,{"stream_name":"stdout","time":147.161063734,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.161070103,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":147.342841774,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":147.388305607,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.388332035,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.388311,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":147.388495296,"data":"\n"}
,{"stream_name":"stdout","time":147.388503114,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stderr","time":147.388500086,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.97s/s]\n"}
,{"stream_name":"stdout","time":147.388507214,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":147.390288739,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.390524419,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.390533081,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.390538259,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":147.390542214,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.390721729,"data":"\n"}
,{"stream_name":"stdout","time":147.800239663,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":147.883987814,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":147.884029416,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.884052256,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":147.884280091,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":147.884284567,"data":"\n"}
,{"stream_name":"stdout","time":147.884304592,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":147.884311076,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":147.88596495,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.886297791,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.886308296,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.886313934,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":147.886319035,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.886525088,"data":"\n"}
,{"stream_name":"stdout","time":148.089578402,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":148.089607306,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.089615055,"data":"  Original dt: 4.524774e-01 s\n"}
,{"stream_name":"stdout","time":148.08962077,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":148.08962629,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.089631565,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":148.260357087,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":148.377880074,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.377913962,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.377896049,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":148.378084284,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.53s/s]\n"}
,{"stream_name":"stdout","time":148.378089223,"data":"\n"}
,{"stream_name":"stdout","time":148.378106199,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":148.378111756,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":148.379771189,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.380080427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.380091544,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.380096405,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":148.380100111,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.380262527,"data":"\n"}
,{"stream_name":"stdout","time":148.714469892,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":148.86596929,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.865998514,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.866057253,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":148.866066685,"data":"\n"}
,{"stream_name":"stdout","time":148.866071006,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":148.866075531,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":148.866085163,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.89s/s]\n"}
,{"stream_name":"stdout","time":148.867848002,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.867867881,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":148.867872283,"data":"\n"}
,{"stream_name":"stdout","time":148.867875954,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":148.867880055,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":148.86788363,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":148.867886911,"data":"\n"}
,{"stream_name":"stdout","time":148.867890112,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":148.867894378,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":148.875575332,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":148.875593007,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":148.875597695,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":148.875601733,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":148.875605643,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":148.87561,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":148.875614861,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":148.875634062,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":148.875643599,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":148.87564737,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.875722862,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":148.875743207,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":148.876251774,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":148.876259647,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":148.876536773,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":148.876809552,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.876820989,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.876825262,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":148.878698936,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.878725016,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.878729998,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":148.878734244,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.878880354,"data":"\n"}
,{"stream_name":"stdout","time":149.01134527,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":149.011366685,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.011370801,"data":"  Original dt: 5.619376e-01 s\n"}
,{"stream_name":"stdout","time":149.011373384,"data":"  Corrected dt: 3.512110e-01 s\n"}
,{"stream_name":"stdout","time":149.011376065,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.011378829,"data":"  Max wave speed detected: 14.24 m/s\n"}
,{"stream_name":"stderr","time":149.288928105,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.288958188,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":149.288963735,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.60s/s]\n"}
,{"stream_name":"stdout","time":149.28896985,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":149.288986991,"data":"\n"}
,{"stream_name":"stdout","time":149.288991645,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":149.288995999,"data":"Total runtime: 0.41 seconds.\n"}
,{"stream_name":"stdout","time":149.290667828,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.290946506,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.290975186,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.290980365,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":149.290984085,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.29112659,"data":"\n"}
,{"stream_name":"stdout","time":149.36220213000001,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":149.757100978,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":149.757110456,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.757146631,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.757336387,"data":"\n"}
,{"stream_name":"stderr","time":149.757333947,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.19s/s]\n"}
,{"stream_name":"stdout","time":149.757344562,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":149.757352399,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":149.758864759,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.759159364,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.759167556,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.75917556,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":149.759179473,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.759359686,"data":"\n"}
,{"stream_name":"stdout","time":149.813041804,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":149.938098773,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":149.938127337,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.938133533,"data":"  Original dt: 4.537314e-01 s\n"}
,{"stream_name":"stdout","time":149.938137685,"data":"  Corrected dt: 2.835821e-01 s\n"}
,{"stream_name":"stdout","time":149.93814156,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.938145521,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":150.239604112,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":150.239604114,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":150.239633398,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.239958085,"data":"\n"}
,{"stream_name":"stdout","time":150.239992222,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":150.240017604,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":150.239993008,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.25s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.23s/s]\n"}
,{"stream_name":"stdout","time":150.241547431,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.241871239,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.241882992,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.24188775,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":150.241891652,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.242059052,"data":"\n"}
,{"stream_name":"stdout","time":150.26873991,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":150.727452857,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":150.73776552,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.737786895,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.737795941,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":150.738024064,"data":"\n"}
,{"stream_name":"stdout","time":150.738035057,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":150.738039492,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":150.738031157,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":150.739737336,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.740260261,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.740268516,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.740273544,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":150.740278179,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.740478297,"data":"\n"}
,{"stream_name":"stdout","time":150.886798971,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":150.886823473,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.886828536,"data":"  Original dt: 4.525114e-01 s\n"}
,{"stream_name":"stdout","time":150.886832511,"data":"  Corrected dt: 2.828196e-01 s\n"}
,{"stream_name":"stdout","time":150.886836423,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.886853376,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":151.212304669,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":151.257340668,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.257368208,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.257340665,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":151.25768178,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 29.02s/s]\n"}
,{"stream_name":"stdout","time":151.257690958,"data":"\n"}
,{"stream_name":"stdout","time":151.257734382,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":151.257740412,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":151.259324472,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.259621118,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.259632593,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.259637131,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":151.259641227,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.259831113,"data":"\n"}
,{"stream_name":"stdout","time":151.66699894,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":151.74888729,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.748922509,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.748889486,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":151.749076594,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.67s/s]\n"}
,{"stream_name":"stdout","time":151.749108026,"data":"\n"}
,{"stream_name":"stdout","time":151.749117497,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":151.749122408,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":151.750641075,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.750966571,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.75097753,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.750981925,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":151.751002795,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.751174224,"data":"\n"}
,{"stream_name":"stdout","time":151.798305574,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":151.798339503,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.798343241,"data":"  Original dt: 4.524781e-01 s\n"}
,{"stream_name":"stdout","time":151.798345842,"data":"  Corrected dt: 2.827988e-01 s\n"}
,{"stream_name":"stdout","time":151.798348504,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.798350987,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":152.138221166,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":152.27859294,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":152.27859602,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.278632812,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.278927406,"data":"\n"}
,{"stream_name":"stdout","time":152.278942981,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":152.278949686,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stderr","time":152.278927691,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 28.44s/s]\n"}
,{"stream_name":"stdout","time":152.281028213,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.281370485,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.281378526,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.281382866,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":152.281386936,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.281578856,"data":"\n"}
,{"stream_name":"stdout","time":152.623297104,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":152.750366673,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":152.750392832,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.750399126,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":152.750403478,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":152.750407423,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.750411732,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":152.776244835,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":152.776244437,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.776310485,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.776371921,"data":"\n"}
,{"stream_name":"stdout","time":152.776398718,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":152.776403428,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":152.776417199,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.33s/s]\n"}
,{"stream_name":"stdout","time":152.77794885,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.777969527,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":152.777975146,"data":"\n"}
,{"stream_name":"stdout","time":152.777979397,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.777983607,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":152.777988854,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.777993229,"data":"\n"}
,{"stream_name":"stdout","time":152.778050608,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":152.778068017,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":152.785764417,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":152.785781651,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":152.785786434,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":152.785791189,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":152.785872115,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":152.785974429,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":152.785981245,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":152.7859857,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":152.786000686,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":152.786048376,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.786072816,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":152.786078583,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":152.786722111,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":152.786740869,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":152.787022799,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":152.787297393,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.787304583,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.787322934,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":152.789090023,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.789101335,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.789105889,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":152.789111532,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.789247493,"data":"\n"}
,{"stream_name":"stderr","time":153.184535361,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.184565255,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.184547018,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":153.184958646,"data":"\n"}
,{"stream_name":"stderr","time":153.184959541,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.95s/s]\n"}
,{"stream_name":"stdout","time":153.184969675,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":153.184977511,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":153.186946642,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.187311445,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.187320135,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.187325163,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":153.187329582,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.187528082,"data":"\n"}
,{"stream_name":"stdout","time":153.260828877,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":153.677133868,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.677163737,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.677164619,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":153.677276243,"data":"\n"}
,{"stream_name":"stdout","time":153.677285419,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":153.677290008,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":153.677302765,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.65s/s]\n"}
,{"stream_name":"stdout","time":153.678984613,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.69808285,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":153.698124062,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.698129884,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.698134139,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":153.698137785,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.698393839,"data":"\n"}
,{"stream_name":"stdout","time":153.727766135,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":153.727793865,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.727799616,"data":"  Original dt: 4.549596e-01 s\n"}
,{"stream_name":"stdout","time":153.727803832,"data":"  Corrected dt: 2.843498e-01 s\n"}
,{"stream_name":"stdout","time":153.72780788,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.727811901,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":153.754301721,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":154.188908891,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":154.188931391,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":154.188938791,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.189149222,"data":"\n"}
,{"stream_name":"stdout","time":154.189158709,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stderr","time":154.189158975,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":154.189162664,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":154.190843267,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.191148668,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.191155826,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.191164165,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":154.191167972,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.191373113,"data":"\n"}
,{"stream_name":"stdout","time":154.219480678,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":154.66617415,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":154.666206518,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.666234973,"data":"  Original dt: 4.525349e-01 s\n"}
,{"stream_name":"stdout","time":154.666240193,"data":"  Corrected dt: 2.828343e-01 s\n"}
,{"stream_name":"stdout","time":154.666244698,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.666248789,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":154.691358738,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":154.700654756,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":154.700656702,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.700720781,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.700808419,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.46s/s]\n"}
,{"stream_name":"stdout","time":154.700840403,"data":"\n"}
,{"stream_name":"stdout","time":154.700845752,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":154.700849528,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":154.702468656,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.702948673,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.702965856,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.702971166,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":154.702975131,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.7031306,"data":"\n"}
,{"stream_name":"stdout","time":155.156858436,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":155.202608952,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":155.202654974,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.202662715,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.202818864,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.04s/s]\n"}
,{"stream_name":"stdout","time":155.202816043,"data":"\n"}
,{"stream_name":"stdout","time":155.20286012,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":155.202865342,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":155.20450462,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.204857384,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.204883569,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.204888144,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.204892007,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.205085956,"data":"\n"}
,{"stream_name":"stdout","time":155.586484294,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":155.586512282,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.58652288,"data":"  Original dt: 4.524791e-01 s\n"}
,{"stream_name":"stdout","time":155.586527144,"data":"  Corrected dt: 2.827995e-01 s\n"}
,{"stream_name":"stdout","time":155.586532044,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.5865361,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":155.613689267,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":155.695209851,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":155.695209847,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.695242221,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.695447398,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.60s/s]\n"}
,{"stream_name":"stdout","time":155.695476485,"data":"\n"}
,{"stream_name":"stdout","time":155.695501054,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":155.695505014,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":155.697135133,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.697365474,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.697375063,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.697379524,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":155.697383343,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.697534916,"data":"\n"}
,{"stream_name":"stdout","time":156.079625582,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":156.197155803,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.197188474,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.197155806,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":156.197373213,"data":"\n"}
,{"stream_name":"stderr","time":156.197373498,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.02s/s]\n"}
,{"stream_name":"stdout","time":156.197383289,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":156.197410921,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":156.19893532,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.199248874,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.199256946,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.199261055,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":156.199264767,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.199419172,"data":"\n"}
,{"stream_name":"stdout","time":156.507443828,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":156.507470148,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.507475845,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":156.507480463,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":156.507484365,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.507488732,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":156.533798831,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":156.686969546,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.686998219,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.686969547,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":156.687167744,"data":"\n"}
,{"stream_name":"stderr","time":156.687167615,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.78s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.77s/s]\n"}
,{"stream_name":"stdout","time":156.687176431,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":156.687199658,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":156.688979879,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.688998523,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":156.689005547,"data":"\n"}
,{"stream_name":"stdout","time":156.689009571,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.689012367,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":156.689015111,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.689017694,"data":"\n"}
,{"stream_name":"stdout","time":156.689032104,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":156.689035072,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":156.696782074,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":156.696803066,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":156.696808637,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":156.696813481,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":156.696818556,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":156.696823477,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":156.696828241,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":156.696832453,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":156.696856554,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":156.696865058,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.696869497,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":156.696873944,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":156.69741789,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":156.697425125,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":156.697732681,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":156.697945266,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.697952541,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.697960321,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":156.699725069,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.699737072,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.699741659,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":156.699745476,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.699928306,"data":"\n"}
,{"stream_name":"stdout","time":157.088440319,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":157.088458507,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.088479575,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.088738234,"data":"\n"}
,{"stream_name":"stdout","time":157.088755811,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":157.088760921,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":157.088764509,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.60s/s]\n"}
,{"stream_name":"stdout","time":157.090463095,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.090780951,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.090797537,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.090802875,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":157.090807211,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.090990555,"data":"\n"}
,{"stream_name":"stdout","time":157.166823479,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":157.447073064,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":157.447100281,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.447105439,"data":"  Original dt: 4.575046e-01 s\n"}
,{"stream_name":"stdout","time":157.447109355,"data":"  Corrected dt: 2.859404e-01 s\n"}
,{"stream_name":"stdout","time":157.447112969,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.44711709,"data":"  Max wave speed detected: 17.49 m/s\n"}
,{"stream_name":"stdout","time":157.571384521,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":157.571416095,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.571433917,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.571573864,"data":"\n"}
,{"stream_name":"stdout","time":157.571581302,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stderr","time":157.571579017,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.22s/s]\n"}
,{"stream_name":"stdout","time":157.571585294,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":157.573308828,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.573522375,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.573533763,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.573932162,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":157.573949641,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.574128613,"data":"\n"}
,{"stream_name":"stdout","time":157.626906162,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":158.047953053,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":158.047985578,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.048001594,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":158.048207953,"data":"\n"}
,{"stream_name":"stderr","time":158.048219378,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.65s/s]\n"}
,{"stream_name":"stdout","time":158.048224886,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":158.048234154,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":158.049850003,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.050072616,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.050080968,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.050085258,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":158.050089091,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.050246153,"data":"\n"}
,{"stream_name":"stdout","time":158.076383193,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":158.345433355,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":158.345461214,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.345466157,"data":"  Original dt: 4.525806e-01 s\n"}
,{"stream_name":"stdout","time":158.345471533,"data":"  Corrected dt: 2.828629e-01 s\n"}
,{"stream_name":"stdout","time":158.345475241,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.345479199,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":158.522662251,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":158.531670725,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":158.531670722,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.531773126,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.531934018,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.16s/s]\n"}
,{"stream_name":"stdout","time":158.531939306,"data":"\n"}
,{"stream_name":"stdout","time":158.53195472,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":158.531959514,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.53363608,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":158.534148463,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.534184125,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.534190337,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":158.534195044,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.534363223,"data":"\n"}
,{"stream_name":"stdout","time":158.969058261,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":159.014669323,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":159.01469158,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":159.014699333,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.014936665,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.23s/s]\n"}
,{"stream_name":"stdout","time":159.014952573,"data":"\n"}
,{"stream_name":"stdout","time":159.01496545,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":159.014970379,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":159.016620471,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.017003237,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.017014943,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.017019112,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.017023,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.017203922,"data":"\n"}
,{"stream_name":"stdout","time":159.243659796,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":159.243687642,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.243693918,"data":"  Original dt: 4.524811e-01 s\n"}
,{"stream_name":"stdout","time":159.243697816,"data":"  Corrected dt: 2.828007e-01 s\n"}
,{"stream_name":"stdout","time":159.243722212,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.243730358,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":159.420796058,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":159.518404447,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":159.518402556,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.518449583,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.518556988,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.93s/s]\n"}
,{"stream_name":"stdout","time":159.518585155,"data":"\n"}
,{"stream_name":"stdout","time":159.518594305,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":159.518598815,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":159.520257925,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.520570563,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.520578812,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.520582922,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.520586802,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.520768208,"data":"\n"}
,{"stream_name":"stdout","time":159.886520239,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":160.006446942,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.006490831,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.006470354,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":160.006601342,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.89s/s]\n"}
,{"stream_name":"stdout","time":160.006605786,"data":"\n"}
,{"stream_name":"stdout","time":160.006615701,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":160.006620264,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":160.008212253,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.008582789,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.008591007,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.008595225,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":160.008599127,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.008791282,"data":"\n"}
,{"stream_name":"stdout","time":160.164863557,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":160.16489422,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.164899985,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":160.164904445,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":160.1649089,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.164912718,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":160.341560588,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":160.495645403,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.495677001,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.495660417,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":160.495912719,"data":"\n"}
,{"stream_name":"stderr","time":160.495916289,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.82s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":160.495926051,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":160.49594134,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":160.497629164,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.497642293,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":160.497670157,"data":"\n"}
,{"stream_name":"stdout","time":160.497674695,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.497679024,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.018\n"}
,{"stream_name":"stdout","time":160.497683279,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.497687668,"data":"\n"}
,{"stream_name":"stdout","time":160.497691247,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":160.49769533,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":160.505086965,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":160.505104522,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":160.505109804,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":160.505113839,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":160.505201731,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":160.505240351,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":160.505248246,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":160.505252464,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":160.505294364,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":160.505301879,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.505317773,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":160.505321497,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":160.505944411,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":160.505969402,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":160.506252257,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":160.506870355,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.506881331,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.506886088,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":160.508858828,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":160.508868273,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":160.508872736,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":160.508876818,"data":"|    ep_rew_mean      | 0.0988   |\n"}
,{"stream_name":"stdout","time":160.50888111,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":160.508884685,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":160.508888157,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":160.508892125,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":160.508896083,"data":"|    time_elapsed     | 33       |\n"}
,{"stream_name":"stdout","time":160.508900203,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":160.508904019,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":160.509966092,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.509980472,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.509985481,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":160.50998992,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.510134726,"data":"\n"}
,{"stream_name":"stdout","time":160.917340968,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":160.917364741,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.917374067,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.91752526,"data":"\n"}
,{"stream_name":"stdout","time":160.917533391,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stderr","time":160.91753286,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.84s/s]\n"}
,{"stream_name":"stdout","time":160.917537536,"data":"Total runtime: 0.41 seconds.\n"}
,{"stream_name":"stdout","time":160.919185221,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.919475667,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.919484994,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":160.919502133,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":160.919506278,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.919676307,"data":"\n"}
,{"stream_name":"stdout","time":160.992076845,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":161.112501113,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":161.112529796,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.112535395,"data":"  Original dt: 4.631167e-01 s\n"}
,{"stream_name":"stdout","time":161.112539598,"data":"  Corrected dt: 2.894480e-01 s\n"}
,{"stream_name":"stdout","time":161.112543669,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.112547796,"data":"  Max wave speed detected: 17.27 m/s\n"}
,{"stream_name":"stderr","time":161.388195781,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.388232939,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.388219694,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":161.38837502,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":161.388380084,"data":"\n"}
,{"stream_name":"stdout","time":161.38839556,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":161.388399954,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":161.39000072,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.390237035,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.390245256,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.390250441,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":161.390254799,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.390426641,"data":"\n"}
,{"stream_name":"stdout","time":161.446507505,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":161.877517338,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":161.877601733,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.877620314,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.877651124,"data":"\n"}
,{"stream_name":"stdout","time":161.877661052,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":161.877665279,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":161.877666969,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.80s/s]\n"}
,{"stream_name":"stdout","time":161.879372259,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":161.87972878,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.879739676,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.879743831,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":161.879747729,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.879929608,"data":"\n"}
,{"stream_name":"stdout","time":161.912261154,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":162.031225594,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":162.031252514,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.031257699,"data":"  Original dt: 4.526702e-01 s\n"}
,{"stream_name":"stdout","time":162.031263209,"data":"  Corrected dt: 2.829189e-01 s\n"}
,{"stream_name":"stdout","time":162.031266785,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.031269589,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":162.363619185,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.372852248,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.372874917,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.372862233,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":162.373006765,"data":"\n"}
,{"stream_name":"stdout","time":162.373016353,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":162.37302131,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":162.373024986,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.44s/s]\n"}
,{"stream_name":"stdout","time":162.374611353,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.375063894,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.375081629,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.375086818,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.375091149,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.375254162,"data":"\n"}
,{"stream_name":"stdout","time":162.809498578,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.853854723,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.853886006,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.853854721,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":162.85405501,"data":"\n"}
,{"stream_name":"stderr","time":162.854064043,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.34s/s]\n"}
,{"stream_name":"stdout","time":162.854070265,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":162.85408013,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":162.85588624,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.85612373,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.856132473,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.856137426,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.856141513,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.856338345,"data":"\n"}
,{"stream_name":"stdout","time":162.928489758,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":162.928518615,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.92852483,"data":"  Original dt: 4.524843e-01 s\n"}
,{"stream_name":"stdout","time":162.928528996,"data":"  Corrected dt: 2.828027e-01 s\n"}
,{"stream_name":"stdout","time":162.928533471,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.928537583,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":163.2562619,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":163.336014918,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":163.33607508,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.336083246,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":163.336087302,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.28s/s]\n"}
,{"stream_name":"stdout","time":163.33611068,"data":"\n"}
,{"stream_name":"stdout","time":163.33612676,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":163.336131398,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":163.337839801,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.338058639,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.338069041,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.338074298,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":163.338077738,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.338244335,"data":"\n"}
,{"stream_name":"stdout","time":163.714158328,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":163.831259633,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.831288212,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.83126551,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":163.831321958,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":163.831330207,"data":"\n"}
,{"stream_name":"stdout","time":163.831338563,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":163.831342839,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":163.832884019,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.833210824,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.833225882,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.833230011,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":163.833233777,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.833412949,"data":"\n"}
,{"stream_name":"stdout","time":163.834572834,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":163.834585399,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.834590223,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":163.83459399,"data":"  Corrected dt: 2.827979e-01 s\n"}
,{"stream_name":"stdout","time":163.834597593,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.834601309,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":164.164317895,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":164.324515457,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":164.324515459,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.324596767,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.3248226,"data":"\n"}
,{"stream_name":"stdout","time":164.324835719,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":164.324857924,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":164.32482251,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.54s/s]\n"}
,{"stream_name":"stdout","time":164.326561273,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":164.326574137,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":164.326593962,"data":"\n"}
,{"stream_name":"stdout","time":164.326598747,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.326603168,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.13 | Avg Reward/Step: 0.016\n"}
,{"stream_name":"stdout","time":164.326607383,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":164.326611593,"data":"\n"}
,{"stream_name":"stdout","time":164.32661532,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":164.326620802,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":164.334187695,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":164.334205874,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":164.334211354,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":164.334226677,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":164.334232182,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":164.334368966,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":164.334376767,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":164.334381408,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":164.334385069,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":164.334388803,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.334444359,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":164.334451294,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":164.335118738,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":164.335130195,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":164.335462337,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":164.335730478,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.335742347,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.335747901,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":164.33759586,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.337605766,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.337610641,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":164.337614808,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.337759804,"data":"\n"}
,{"stream_name":"stderr","time":164.738686253,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.738735273,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.738686215,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":164.738994321,"data":"\n"}
,{"stream_name":"stderr","time":164.738994235,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.41s/s]\n"}
,{"stream_name":"stdout","time":164.739003257,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":164.739013003,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":164.740779599,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":164.741139376,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.741146996,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.741151369,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":164.741155358,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.741349043,"data":"\n"}
,{"stream_name":"stdout","time":164.784340643,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":164.784358283,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.784363448,"data":"  Original dt: 4.753954e-01 s\n"}
,{"stream_name":"stdout","time":164.784369568,"data":"  Corrected dt: 2.971221e-01 s\n"}
,{"stream_name":"stdout","time":164.784372894,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.784375763,"data":"  Max wave speed detected: 16.83 m/s\n"}
,{"stream_name":"stdout","time":164.822291464,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":165.226349705,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":165.226349703,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.226382219,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.226556464,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.93s/s]\n"}
,{"stream_name":"stdout","time":165.226578118,"data":"\n"}
,{"stream_name":"stdout","time":165.226596736,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":165.226600746,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":165.228543128,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":165.228872412,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.228884253,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.228888733,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":165.228894517,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.229079866,"data":"\n"}
,{"stream_name":"stdout","time":165.287820467,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":165.706836151,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":165.706862782,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.706868648,"data":"  Original dt: 4.528333e-01 s\n"}
,{"stream_name":"stdout","time":165.706872813,"data":"  Corrected dt: 2.830208e-01 s\n"}
,{"stream_name":"stdout","time":165.706876905,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.70688137,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":165.715126511,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":165.71515923,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.715171368,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.715480581,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.87s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.86s/s]\n"}
,{"stream_name":"stdout","time":165.715497749,"data":"\n"}
,{"stream_name":"stdout","time":165.715510899,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":165.715516044,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":165.717181888,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":165.717503705,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.717515561,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.717520729,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":165.717524628,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.717671232,"data":"\n"}
,{"stream_name":"stdout","time":165.745142866,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":166.193395004,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":166.202837929,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":166.202839934,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.202889603,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.203002114,"data":"\n"}
,{"stream_name":"stdout","time":166.203010618,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stderr","time":166.202998721,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.92s/s]\n"}
,{"stream_name":"stdout","time":166.203015137,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":166.204807913,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":166.205272938,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.205285393,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.20529047,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.205295037,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.205475278,"data":"\n"}
,{"stream_name":"stdout","time":166.606645676,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":166.60667484,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.606680403,"data":"  Original dt: 4.524892e-01 s\n"}
,{"stream_name":"stdout","time":166.606684819,"data":"  Corrected dt: 2.828057e-01 s\n"}
,{"stream_name":"stdout","time":166.606689018,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.606693252,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":166.642747567,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":166.6869957,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.687030889,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.686995173,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":166.687081207,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.16s/s]\n"}
,{"stream_name":"stdout","time":166.68710198,"data":"\n"}
,{"stream_name":"stdout","time":166.687107863,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":166.687111821,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":166.688761328,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.688977566,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.688985841,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.688990053,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.688993878,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.689157212,"data":"\n"}
,{"stream_name":"stdout","time":167.093168366,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":167.174783337,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.174817702,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.174783688,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":167.175083086,"data":"\n"}
,{"stream_name":"stdout","time":167.17509402,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":167.175098594,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":167.17509651,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.89s/s]\n"}
,{"stream_name":"stdout","time":167.176723184,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.177021727,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.177032234,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.177036566,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":167.177040486,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.177195412,"data":"\n"}
,{"stream_name":"stdout","time":167.510009956,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":167.510036127,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.510044004,"data":"  Original dt: 4.524769e-01 s\n"}
,{"stream_name":"stdout","time":167.51004783,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":167.510051579,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.510055264,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":167.544385483,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":167.659792443,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.65982443,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.659798847,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":167.659992002,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.08s/s]\n"}
,{"stream_name":"stdout","time":167.65999954,"data":"\n"}
,{"stream_name":"stdout","time":167.660011142,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":167.660015354,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":167.661577968,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.661919391,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.66193487,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.661939226,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":167.661943317,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.662107863,"data":"\n"}
,{"stream_name":"stdout","time":168.010847964,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":168.182512244,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":168.182512242,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.182545534,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":168.182694636,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.83s/s]\n"}
,{"stream_name":"stdout","time":168.182699259,"data":"\n"}
,{"stream_name":"stdout","time":168.182746114,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":168.182751079,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":168.184477896,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.184497045,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":168.184502203,"data":"\n"}
,{"stream_name":"stdout","time":168.184506621,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.184510381,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.04 | Avg Reward/Step: 0.005\n"}
,{"stream_name":"stdout","time":168.18451478,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":168.184523746,"data":"\n"}
,{"stream_name":"stdout","time":168.184527435,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":168.184532041,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":168.192126581,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":168.192159535,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":168.192163951,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":168.192167037,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":168.192170497,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":168.192254425,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":168.192262745,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":168.192267057,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":168.192271302,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":168.192289042,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.192307586,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":168.192326068,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":168.192936578,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":168.192949131,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":168.19321193,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":168.193450026,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.193463278,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.19346749,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":168.195553427,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.1955653,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.19556943,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":168.195574862,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.195760126,"data":"\n"}
,{"stream_name":"stdout","time":168.461896058,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":168.461925166,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.461929078,"data":"  Original dt: 5.044045e-01 s\n"}
,{"stream_name":"stdout","time":168.461932123,"data":"  Corrected dt: 3.152528e-01 s\n"}
,{"stream_name":"stdout","time":168.461934769,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.461937313,"data":"  Max wave speed detected: 15.86 m/s\n"}
,{"stream_name":"stderr","time":168.577883051,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.577919296,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.577887235,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":168.578104994,"data":"\n"}
,{"stream_name":"stdout","time":168.578113282,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":168.57813024,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":168.578112602,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.26s/s]\n"}
,{"stream_name":"stdout","time":168.579675298,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.580006385,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.58001783,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.58002251,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":168.580026731,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.58019194,"data":"\n"}
,{"stream_name":"stdout","time":168.656039097,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":169.065401834,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.065429889,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.065457725,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":169.065857052,"data":"\n"}
,{"stream_name":"stdout","time":169.065897272,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":169.065904208,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":169.065855663,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.91s/s]\n"}
,{"stream_name":"stdout","time":169.067543604,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.067905177,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.067917265,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":169.06792355,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":169.067929229,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.068109848,"data":"\n"}
,{"stream_name":"stdout","time":169.123584367,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":169.394636771,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":169.394676701,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.394684109,"data":"  Original dt: 4.531593e-01 s\n"}
,{"stream_name":"stdout","time":169.394689581,"data":"  Corrected dt: 2.832246e-01 s\n"}
,{"stream_name":"stdout","time":169.394694758,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.394750521,"data":"  Max wave speed detected: 17.65 m/s\n"}
,{"stream_name":"stderr","time":169.561072027,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":169.56109197,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":169.561102222,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.561238459,"data":"\n"}
,{"stream_name":"stderr","time":169.561240703,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":169.56124854,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":169.561257891,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":169.5630227,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.563292597,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.563302283,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.563307378,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":169.563311297,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.56350011,"data":"\n"}
,{"stream_name":"stdout","time":169.590656742,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":170.052281809,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":170.06321688,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.063243873,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.063244619,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":170.063520114,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.01s/s]\n"}
,{"stream_name":"stdout","time":170.063541756,"data":"\n"}
,{"stream_name":"stdout","time":170.063546803,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":170.063551237,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":170.065370472,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.065829524,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.065849547,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.065855207,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.06587216,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.066045649,"data":"\n"}
,{"stream_name":"stdout","time":170.327840684,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":170.327866323,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.327871766,"data":"  Original dt: 4.524978e-01 s\n"}
,{"stream_name":"stdout","time":170.327875988,"data":"  Corrected dt: 2.828112e-01 s\n"}
,{"stream_name":"stdout","time":170.327880167,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.327883695,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":170.517170984,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":170.561315821,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.561338947,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.561339588,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":170.561566859,"data":"\n"}
,{"stream_name":"stderr","time":170.561569507,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.28s/s]\n"}
,{"stream_name":"stdout","time":170.561576668,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":170.561584499,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":170.563109526,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.563421046,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.563436075,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.563440418,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.563444225,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.563650999,"data":"\n"}
,{"stream_name":"stdout","time":170.994802023,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":171.07735424,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":171.07735898,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.077385014,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.077667265,"data":"\n"}
,{"stream_name":"stdout","time":171.077676025,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":171.077680229,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":171.07772403,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.22s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.21s/s]\n"}
,{"stream_name":"stdout","time":171.079413303,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.079769718,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.07978329,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.079787854,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":171.0797916,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.079992475,"data":"\n"}
,{"stream_name":"stdout","time":171.260956136,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":171.260987323,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.260993135,"data":"  Original dt: 4.524775e-01 s\n"}
,{"stream_name":"stdout","time":171.260997569,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":171.261001923,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.261005574,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":171.45229317,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":171.57021985,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.570533025,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.570534255,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":171.570865326,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.57s/s]\n"}
,{"stream_name":"stdout","time":171.570896211,"data":"\n"}
,{"stream_name":"stdout","time":171.570904672,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":171.570923274,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":171.572547142,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.572908301,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.572919436,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.572924533,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":171.572928438,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.573097167,"data":"\n"}
,{"stream_name":"stdout","time":171.91206418,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":172.06547309,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.0655037,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.065486123,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":172.065681236,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.47s/s]\n"}
,{"stream_name":"stdout","time":172.065741328,"data":"\n"}
,{"stream_name":"stdout","time":172.065763035,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":172.065768423,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":172.067864289,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.067884777,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":172.067938118,"data":"\n"}
,{"stream_name":"stdout","time":172.067944603,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":172.067949417,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.017\n"}
,{"stream_name":"stdout","time":172.067953344,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":172.067957421,"data":"\n"}
,{"stream_name":"stdout","time":172.067961708,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":172.067967005,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":172.076698956,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":172.076730394,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":172.076735033,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":172.076738931,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":172.076742635,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":172.076848411,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":172.076857252,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":172.076861083,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":172.076864585,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":172.07686786,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.076893291,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":172.076906614,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":172.077491084,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":172.077499337,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":172.077806732,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":172.078067945,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.078087196,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.07809176,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.079954365,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.079967607,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.079972502,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.079976427,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.080130465,"data":"\n"}
,{"stream_name":"stdout","time":172.196276362,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":172.196305752,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.196311796,"data":"  Original dt: 5.781369e-01 s\n"}
,{"stream_name":"stdout","time":172.196315822,"data":"  Corrected dt: 3.613356e-01 s\n"}
,{"stream_name":"stdout","time":172.196320109,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.19632389,"data":"  Max wave speed detected: 13.84 m/s\n"}
,{"stream_name":"stderr","time":172.464921519,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.464952525,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.464932942,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":172.465134868,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.98s/s]\n"}
,{"stream_name":"stdout","time":172.465158441,"data":"\n"}
,{"stream_name":"stdout","time":172.465163295,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":172.465167364,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":172.466940237,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.467246428,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.46725807,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.467262692,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.467266792,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.46739454,"data":"\n"}
,{"stream_name":"stdout","time":172.539658658,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":172.937521213,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.937552886,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.93752122,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":172.937883801,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.90s/s]\n"}
,{"stream_name":"stdout","time":172.937878664,"data":"\n"}
,{"stream_name":"stdout","time":172.937919071,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":172.93792432,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":172.939416654,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.939721723,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.939738734,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.939743999,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.939747643,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.939889832,"data":"\n"}
,{"stream_name":"stdout","time":172.995607429,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":173.112872549,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":173.112900208,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.112907435,"data":"  Original dt: 4.538353e-01 s\n"}
,{"stream_name":"stdout","time":173.112912063,"data":"  Corrected dt: 2.836471e-01 s\n"}
,{"stream_name":"stdout","time":173.112916587,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.112920263,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":173.443917469,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":173.443935477,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.443950578,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.444223334,"data":"\n"}
,{"stream_name":"stderr","time":173.444224273,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 29.75s/s]\n"}
,{"stream_name":"stdout","time":173.444231175,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":173.444238946,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":173.446291769,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":173.446694395,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.446730978,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.446741442,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":173.44676426,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.44696944,"data":"\n"}
,{"stream_name":"stdout","time":173.475220998,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":173.943418895,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":173.952742893,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":173.9527627,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.952781915,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.95303487,"data":"\n"}
,{"stream_name":"stdout","time":173.953044785,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":173.953049242,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":173.953059174,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.65s/s]\n"}
,{"stream_name":"stdout","time":173.954666357,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.955131425,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.955144565,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.955149216,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":173.955153176,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.955339776,"data":"\n"}
,{"stream_name":"stdout","time":174.056109668,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":174.056138922,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.056144226,"data":"  Original dt: 4.525136e-01 s\n"}
,{"stream_name":"stdout","time":174.056148429,"data":"  Corrected dt: 2.828210e-01 s\n"}
,{"stream_name":"stdout","time":174.056152379,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.056156849,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":174.406058085,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":174.451837036,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.451867312,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.451874309,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":174.452087941,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.21s/s]\n"}
,{"stream_name":"stdout","time":174.452123231,"data":"\n"}
,{"stream_name":"stdout","time":174.452134325,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":174.452160989,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":174.453798725,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.45415128,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.454164018,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.454168645,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":174.454189994,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.454383579,"data":"\n"}
,{"stream_name":"stdout","time":174.879099673,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":174.961235582,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":174.961277888,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.961296884,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.961495434,"data":"\n"}
,{"stream_name":"stderr","time":174.961500266,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.59s/s]\n"}
,{"stream_name":"stdout","time":174.961507519,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":174.961517872,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":174.963070678,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.963409286,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.963420406,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.963425166,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":174.963429231,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.96359132,"data":"\n"}
,{"stream_name":"stdout","time":174.993455942,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":174.993472396,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.993477536,"data":"  Original dt: 4.524782e-01 s\n"}
,{"stream_name":"stdout","time":174.993481593,"data":"  Corrected dt: 2.827989e-01 s\n"}
,{"stream_name":"stdout","time":174.993485411,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.993489585,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":175.341787591,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":175.458732249,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.458777422,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.458732253,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":175.459053454,"data":"\n"}
,{"stream_name":"stdout","time":175.45907073,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":175.459075579,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":175.45907202,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.29s/s]\n"}
,{"stream_name":"stdout","time":175.460761283,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":175.461055215,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.461065533,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.461070208,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":175.461074311,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.461231986,"data":"\n"}
,{"stream_name":"stdout","time":175.788590391,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":175.895491508,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":175.895518245,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.895523484,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":175.895527668,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":175.895531689,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.895535837,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":175.938749333,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":175.938751547,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.938785733,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.939026639,"data":"\n"}
,{"stream_name":"stdout","time":175.939041087,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":175.939045822,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":175.93904942,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.41s/s]\n"}
,{"stream_name":"stdout","time":175.940634043,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.940652081,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":175.940674207,"data":"\n"}
,{"stream_name":"stdout","time":175.940678672,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.940682708,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.08 | Avg Reward/Step: 0.010\n"}
,{"stream_name":"stdout","time":175.940686817,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":175.940690922,"data":"\n"}
,{"stream_name":"stdout","time":175.9406948,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":175.940698798,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":175.947868548,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":175.947886837,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":175.947890111,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":175.947893237,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":175.94789577,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":175.947999375,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":175.94800634,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":175.94801151,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":175.948016071,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":175.94803054,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.948035275,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":175.948039705,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":175.948599714,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":175.948607634,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":175.948896579,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":175.949122445,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.949128938,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.94913328,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":175.951039203,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":175.951053518,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":175.951057625,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":175.951061429,"data":"|    ep_rew_mean      | 0.0983   |\n"}
,{"stream_name":"stdout","time":175.95106713,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":175.951069863,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":175.951072312,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":175.951074696,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":175.951077183,"data":"|    time_elapsed     | 48       |\n"}
,{"stream_name":"stdout","time":175.951088873,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":175.951091464,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":175.951981798,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.95199575,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.95200166,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":175.952004821,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.952150286,"data":"\n"}
,{"stream_name":"stderr","time":176.335632704,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":176.335655769,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":176.33566037,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":176.335915491,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.12s/s]\n"}
,{"stream_name":"stdout","time":176.335922736,"data":"\n"}
,{"stream_name":"stdout","time":176.335941261,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":176.335946372,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":176.337639085,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":176.337975192,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.33799172,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.337996741,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":176.338000552,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.338194986,"data":"\n"}
,{"stream_name":"stdout","time":176.410230227,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":176.807725279,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":176.807752632,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.807771435,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":176.80796997,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.96s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.94s/s]\n"}
,{"stream_name":"stdout","time":176.80797837,"data":"\n"}
,{"stream_name":"stdout","time":176.8079898,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":176.807993792,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":176.809806772,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":176.810153615,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.81016593,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":176.810170567,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":176.810174691,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.810352197,"data":"\n"}
,{"stream_name":"stdout","time":176.820421265,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":176.820443853,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.820448833,"data":"  Original dt: 4.551811e-01 s\n"}
,{"stream_name":"stdout","time":176.820452751,"data":"  Corrected dt: 2.844882e-01 s\n"}
,{"stream_name":"stdout","time":176.820456248,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.820459646,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":176.864390584,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":177.293749589,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.293779443,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.293750655,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":177.294035904,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.03s/s]\n"}
,{"stream_name":"stdout","time":177.294048571,"data":"\n"}
,{"stream_name":"stdout","time":177.29406333,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":177.294067639,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":177.295734836,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.296063357,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.296075347,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.296080703,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":177.29608469,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.296254217,"data":"\n"}
,{"stream_name":"stdout","time":177.323937645,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":177.746428559,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":177.746468169,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.746473358,"data":"  Original dt: 4.525391e-01 s\n"}
,{"stream_name":"stdout","time":177.746493381,"data":"  Corrected dt: 2.828370e-01 s\n"}
,{"stream_name":"stdout","time":177.746497671,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.746501825,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":177.790106284,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":177.799848354,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":177.799873044,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.79988994,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.800175402,"data":"\n"}
,{"stream_name":"stdout","time":177.800196715,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":177.8002025,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":177.800178607,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.79s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.78s/s]\n"}
,{"stream_name":"stdout","time":177.801750421,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":177.815237008,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":177.815390587,"data":"\n"}
,{"stream_name":"stdout","time":177.815400204,"data":"✅ Training completed in 0.8 minutes (50.6s)\n"}
,{"stream_name":"stdout","time":177.818622825,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:50 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":177.818639845,"data":"\n"}
,{"stream_name":"stdout","time":177.818644002,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.818648067,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":177.818651649,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.818655606,"data":"\n"}
,{"stream_name":"stdout","time":177.82274182,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":177.822959752,"data":"2025-10-15 22:05:02 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":177.823142618,"data":"2025-10-15 22:05:02 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":177.823328579,"data":"2025-10-15 22:05:02 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":177.823560495,"data":"2025-10-15 22:05:02 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_a6721e38_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":177.823569866,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_a6721e38_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":177.823772941,"data":"\n"}
,{"stream_name":"stdout","time":177.823788506,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":177.823805269,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":177.823809732,"data":"\n"}
,{"stream_name":"stdout","time":177.82381362,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":177.823857511,"data":"2025-10-15 22:05:02 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.823960989,"data":"2025-10-15 22:05:02 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":177.824025314,"data":"2025-10-15 22:05:02 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":177.824113897,"data":"2025-10-15 22:05:02 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.828213219,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.82836126,"data":"2025-10-15 22:05:02 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.828434946,"data":"2025-10-15 22:05:02 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":177.828547967,"data":"2025-10-15 22:05:02 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":177.82866022299999,"data":"2025-10-15 22:05:02 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":177.828669329,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":177.828674169,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":177.828843554,"data":"2025-10-15 22:05:02 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":177.82900524,"data":"2025-10-15 22:05:02 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":177.829424178,"data":"2025-10-15 22:05:02 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":177.829458269,"data":"2025-10-15 22:05:02 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":177.829536991,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":177.829544296,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":177.829548499,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":177.829552638,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":177.829675927,"data":"2025-10-15 22:05:02 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":177.829683557,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":177.82968834,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":177.829700265,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":177.829737099,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":177.829857872,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.829902473,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":177.830009833,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.830067327,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":177.830149707,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":177.830233237,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":177.830309473,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":177.830397835,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":177.830514759,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.830521943,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":177.830585564,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":177.830956328,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.830968988,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.838613514,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.838629797,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.838634419,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.83863819,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.838642052,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.838772806,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.838783916,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.838788365,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.838793034,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.838813058,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.838861778,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.838868264,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.83943671,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.839444168,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.839736159,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.8397617,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":177.839766789,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":177.839770714,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":177.839775939,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":177.839780129,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":177.839784215,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":177.839928791,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":177.839977276,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":177.84002676,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":177.840090031,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":177.840170538,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.840181954,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.847107444,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.847123549,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.847127939,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.847131508,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.847135222,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.847139088,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.847142768,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.847146218,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.847149672,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.847153129,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.847156783,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.847160418,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.847721205,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.847737107,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.84794882,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.848160692,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.848170039,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.848174352,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":177.849693558,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":177.849721064,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":177.849765393,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":177.850300114,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":177.850479806,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":177.850774149,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":177.850787934,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":177.850888616,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":177.850895245,"data":"\n"}
,{"stream_name":"stdout","time":177.850899133,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":177.850903084,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":177.850906687,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":177.850910623,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":177.850914005,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":177.85091794,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":177.850921488,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":177.850925201,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":177.850928977,"data":"\n"}
,{"stream_name":"stdout","time":177.851001695,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":177.851007633,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":177.851011438,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":177.851015066,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":177.851018624,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":177.851022598,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":177.851026269,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":177.851030161,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":177.851033904,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":177.851037615,"data":"\n"}
,{"stream_name":"stdout","time":177.851114784,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":177.851334573,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":177.851402414,"data":"2025-10-15 22:05:02 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":177.851560693,"data":"2025-10-15 22:05:02 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":177.852216364,"data":"2025-10-15 22:05:02 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":177.852239672,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":177.852480281,"data":"2025-10-15 22:05:02 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":177.852571433,"data":"2025-10-15 22:05:02 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-241335000709889361, last=-5555293101664453164\n"}
,{"stream_name":"stdout","time":177.853044009,"data":"2025-10-15 22:05:02 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":177.858092368,"data":"2025-10-15 22:05:02 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":177.858367691,"data":"2025-10-15 22:05:02 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":177.858375603,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":177.858486451,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":177.858498063,"data":"\n"}
,{"stream_name":"stdout","time":177.85850256,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.858506213,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":177.858509695,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":177.858513606,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":177.858517204,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":177.858520968,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":177.858524688,"data":"\n"}
,{"stream_name":"stdout","time":177.85853024,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":177.8654627,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.865480462,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.865485624,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.865489569,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.866295903,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":177.871788927,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":177.87180598,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":177.87541168,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":177.875426157,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":177.87543116,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.875584145,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":177.875637882,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.875731699,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":177.875844187,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":177.87590971,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":177.876032019,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":177.87609216,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":177.876182861,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.876229321,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":177.876303419,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":177.876612893,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.876624015,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.883563364,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.883581814,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.883586929,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.883591412,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.883595983,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.883684656,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.88369245,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.883697408,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.883716729,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.883738235,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.883743256,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.883747569,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.884370835,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.884381823,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.884688324,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.8846956,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":177.884699938,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":177.884727227,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":177.884743397,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":177.88474824,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":177.884753349,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":177.884866754,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":177.884952102,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":177.884973847,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":177.885029358,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":177.885074105,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":177.885081043,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":177.892114148,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":177.892131195,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":177.892136225,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":177.892140495,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":177.89214425,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":177.892245067,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":177.892253591,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":177.892258896,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":177.892262971,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":177.892266862,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.892279865,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":177.892284255,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":177.892891569,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":177.892907889,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":177.893130321,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":177.893690253,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.89370056,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.893728116,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":177.895392045,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":177.895628321,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":177.895638143,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":177.895687969,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":177.982653413,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":177.982680772,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":177.982742214,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":177.982869449,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":177.982950468,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":177.983017971,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":177.983076147,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.983083095,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.98308765,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":177.983098544,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":178.363417376,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":178.363508528,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.50s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.48s/s]\n"}
,{"stream_name":"stdout","time":178.363510481,"data":"\n"}
,{"stream_name":"stdout","time":178.363531043,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":178.36353598,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":178.364956356,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":178.36507336,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":178.365204537,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":178.365583119,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":178.36564673,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":178.365803108,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.415185e+00, max=8.689480e+00, std=3.626462e+00\n"}
,{"stream_name":"stdout","time":178.365981507,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029864, rho_c=0.012787\n"}
,{"stream_name":"stdout","time":178.366081597,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.005645, w_c=12.288487\n"}
,{"stream_name":"stdout","time":178.36620337,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:887 -   State hash: -7507336089097447101\n"}
,{"stream_name":"stdout","time":178.366282659,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.366491881,"data":"    [RL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=3.415185e+00\n"}
,{"stream_name":"stdout","time":178.367431482,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":178.367464,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.367594959,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":178.367684009,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":178.367827038,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":178.367896538,"data":"2025-10-15 22:05:02 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":178.367951783,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.367959531,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.367964358,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":178.367968114,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":178.440374424,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":178.833279116,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":178.833522136,"data":"\n"}
,{"stream_name":"stdout","time":178.833532738,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":178.833537384,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":178.833529015,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.26s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.25s/s]\n"}
,{"stream_name":"stdout","time":178.835238059,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":178.835253339,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":178.835269969,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":178.835721413,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":178.83574848,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":178.835929956,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.426928e-01, max=1.817399e+00, std=5.601639e-01\n"}
,{"stream_name":"stdout","time":178.836125485,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029531, rho_c=0.010996\n"}
,{"stream_name":"stdout","time":178.836196775,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.506404, w_c=13.553405\n"}
,{"stream_name":"stdout","time":178.836347684,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:887 -   State hash: -5937790976132121502\n"}
,{"stream_name":"stdout","time":178.836414672,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.836640972,"data":"    [RL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=4.426928e-01\n"}
,{"stream_name":"stdout","time":178.837663109,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":178.837759085,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":178.83788954,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":178.837964535,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":178.838090994,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":178.838162686,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":178.838236653,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.838243092,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.838247425,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":178.838251216,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":178.839581203,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":178.839594419,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.839599454,"data":"  Original dt: 4.553001e-01 s\n"}
,{"stream_name":"stdout","time":178.839603553,"data":"  Corrected dt: 2.845625e-01 s\n"}
,{"stream_name":"stdout","time":178.839607173,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.839614018,"data":"  Max wave speed detected: 17.57 m/s\n"}
,{"stream_name":"stdout","time":178.89157019,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":179.31844172,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":179.318603994,"data":"\n"}
,{"stream_name":"stdout","time":179.318617405,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":179.318621974,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":179.31861879,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.26s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.25s/s]\n"}
,{"stream_name":"stdout","time":179.320294773,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":179.320331925,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":179.320411038,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":179.320761166,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":179.320877382,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":179.320982061,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.477755e-01, max=7.978900e-01, std=2.282541e-01\n"}
,{"stream_name":"stdout","time":179.321135903,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029120, rho_c=0.009077\n"}
,{"stream_name":"stdout","time":179.321211836,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.682327, w_c=13.940073\n"}
,{"stream_name":"stdout","time":179.321338881,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:887 -   State hash: -3855252589601445841\n"}
,{"stream_name":"stdout","time":179.321392663,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.321574369,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=1.477755e-01\n"}
,{"stream_name":"stdout","time":179.322524909,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":179.322634992,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.322737421,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":179.322864576,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":179.322936838,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":179.323015805,"data":"2025-10-15 22:05:03 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":179.323073318,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.323079583,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.323084678,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":179.323135844,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":179.350015818,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":179.745105987,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":179.745132525,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.745137924,"data":"  Original dt: 4.525414e-01 s\n"}
,{"stream_name":"stdout","time":179.745141689,"data":"  Corrected dt: 2.828383e-01 s\n"}
,{"stream_name":"stdout","time":179.745145588,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.745165732,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":179.798138025,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":179.807360414,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.01s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.00s/s]\n"}
,{"stream_name":"stdout","time":179.807361474,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":179.807393222,"data":"\n"}
,{"stream_name":"stdout","time":179.807397547,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":179.807401911,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":179.808907988,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":179.808980019,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":179.809142102,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":179.809488602,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":179.809572153,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":179.809656485,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.011433e-01, max=6.602001e-01, std=1.740564e-01\n"}
,{"stream_name":"stdout","time":179.809892947,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.028651, rho_c=0.007139\n"}
,{"stream_name":"stdout","time":179.809949922,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.847790, w_c=14.139928\n"}
,{"stream_name":"stdout","time":179.81004679,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:887 -   State hash: 3672747774618444611\n"}
,{"stream_name":"stdout","time":179.810136489,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.810319653,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=1.011433e-01\n"}
,{"stream_name":"stdout","time":179.811309285,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":179.811358192,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":179.811488532,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":179.811583258,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":179.81163985,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":179.811758041,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":179.811811057,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.811820355,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.81182526,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":179.811868451,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.259948108,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":180.306190028,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":180.306563291,"data":"\n"}
,{"stream_name":"stdout","time":180.306578755,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":180.306584688,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":180.306598212,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.37s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.36s/s]\n"}
,{"stream_name":"stdout","time":180.308449845,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.308469836,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.308572154,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.308997198,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.309101247,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.309241645,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.036117e-02, max=6.122320e-01, std=1.605183e-01\n"}
,{"stream_name":"stdout","time":180.309421308,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.027675, rho_c=0.005389\n"}
,{"stream_name":"stdout","time":180.309482253,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.030610, w_c=14.311898\n"}
,{"stream_name":"stdout","time":180.309605398,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:887 -   State hash: 5970094610018840420\n"}
,{"stream_name":"stdout","time":180.309678141,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.30988594,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=9.036117e-02\n"}
,{"stream_name":"stdout","time":180.311009114,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.311119247,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.311242874,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":180.311322625,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.31144076,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":180.311497343,"data":"2025-10-15 22:05:04 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":180.311577484,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.311586043,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.311590348,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":180.31159427,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.682288091,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":180.68231706,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.682323032,"data":"  Original dt: 4.524794e-01 s\n"}
,{"stream_name":"stdout","time":180.682327706,"data":"  Corrected dt: 2.827996e-01 s\n"}
,{"stream_name":"stdout","time":180.682332124,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.682336427,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":180.735915713,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":180.828168663,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":180.82842598,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.05s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.04s/s]\n"}
,{"stream_name":"stdout","time":180.828496823,"data":"\n"}
,{"stream_name":"stdout","time":180.828504562,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":180.828509227,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":180.830441873,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.83055585,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.830673093,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.831060797,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.831207239,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.831361453,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.248062e-02, max=5.779055e-01, std=1.479756e-01\n"}
,{"stream_name":"stdout","time":180.831547995,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026795, rho_c=0.004615\n"}
,{"stream_name":"stdout","time":180.831719808,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.174047, w_c=14.456729\n"}
,{"stream_name":"stdout","time":180.831871279,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:887 -   State hash: -5587567349440478768\n"}
,{"stream_name":"stdout","time":180.831940282,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.832101046,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=7.248062e-02\n"}
,{"stream_name":"stdout","time":180.833159348,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.8333152,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.833386418,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":180.833445853,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.83355059,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":180.83363239,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":180.833724617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.833740826,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.833746103,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":180.833750769,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.217329622,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":181.337455516,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":181.337615763,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.80s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.79s/s]\n"}
,{"stream_name":"stdout","time":181.337628119,"data":"\n"}
,{"stream_name":"stdout","time":181.337638792,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":181.337643649,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":181.339155265,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.339183961,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.339389138,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.339785466,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.339837167,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.340008925,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.716801e-02, max=3.347270e-01, std=6.831511e-02\n"}
,{"stream_name":"stdout","time":181.340147135,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026564, rho_c=0.004510\n"}
,{"stream_name":"stdout","time":181.340232032,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.217842, w_c=14.521270\n"}
,{"stream_name":"stdout","time":181.340368172,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:887 -   State hash: -3801558029429417354\n"}
,{"stream_name":"stdout","time":181.340424252,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.340632046,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.716801e-02\n"}
,{"stream_name":"stdout","time":181.341668138,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.341768844,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.341902913,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":181.341968049,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.342109311,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":181.342172962,"data":"2025-10-15 22:05:05 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":181.342240669,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.342246904,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.342264048,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":181.342284315,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.627939682,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":181.627968832,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.627974982,"data":"  Original dt: 4.524764e-01 s\n"}
,{"stream_name":"stdout","time":181.627978774,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":181.627982534,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.627987887,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":181.685760354,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":181.838254283,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":181.838468565,"data":"\n"}
,{"stream_name":"stdout","time":181.838483573,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":181.838488371,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":181.838468425,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.27s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":181.840151259,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.840171872,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.840305896,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.840646464,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.8407409,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.840878037,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.694845e-03, max=1.151665e-01, std=1.868427e-02\n"}
,{"stream_name":"stdout","time":181.841063906,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026527, rho_c=0.004492\n"}
,{"stream_name":"stdout","time":181.841121639,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.225807, w_c=14.540029\n"}
,{"stream_name":"stdout","time":181.841240307,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:887 -   State hash: 280380787983739470\n"}
,{"stream_name":"stdout","time":181.84133851,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.841533878,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=6.694845e-03\n"}
,{"stream_name":"stdout","time":181.842520873,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.842593864,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.842732642,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":181.842825149,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.842902617,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":181.842998321,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":181.84303819,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.843046676,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.843052015,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":181.843070651,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.143587135,"data":"[PROGRESS] Step 450: t=129.33/135.00s (95.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.342307472,"data":"  Stored output at t = 135.0000 s (Step 471)\n"}
,{"stream_name":"stderr","time":182.342374646,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 30.08s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 30.06s/s]\n"}
,{"stream_name":"stdout","time":182.342409786,"data":"\n"}
,{"stream_name":"stdout","time":182.342426325,"data":"Simulation finished at t = 135.0000 s after 471 steps.\n"}
,{"stream_name":"stdout","time":182.342430847,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":182.344088856,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.344192182,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.344337405,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.344734312,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.344787588,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.344915848,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.531779e-03, max=3.087735e-02, std=4.623905e-03\n"}
,{"stream_name":"stdout","time":182.34513612,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026522, rho_c=0.004488\n"}
,{"stream_name":"stdout","time":182.345207642,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227208, w_c=14.544746\n"}
,{"stream_name":"stdout","time":182.345341886,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:887 -   State hash: 844824214852455009\n"}
,{"stream_name":"stdout","time":182.345421265,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.345627394,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.531779e-03\n"}
,{"stream_name":"stdout","time":182.346695392,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.346814174,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.346962171,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":182.347051755,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.347157588,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":182.347243611,"data":"2025-10-15 22:05:06 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":182.347306706,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.34731414,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.347319002,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":182.347343304,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.555598316,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":182.555640059,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.555645932,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":182.555650018,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":182.555654423,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.555659191,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":182.609062156,"data":"[PROGRESS] Step 500: t=143.20/150.00s (95.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.83214663,"data":"  Stored output at t = 150.0000 s (Step 525)\n"}
,{"stream_name":"stderr","time":182.832299345,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 30.97s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 30.96s/s]\n"}
,{"stream_name":"stdout","time":182.832333822,"data":"\n"}
,{"stream_name":"stdout","time":182.832346991,"data":"Simulation finished at t = 150.0000 s after 525 steps.\n"}
,{"stream_name":"stdout","time":182.832351824,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":182.833973653,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.833991347,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":182.834062808,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.834253947,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.834596904,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.834681715,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.834830659,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.452806e-04, max=7.575118e-03, std=1.097898e-03\n"}
,{"stream_name":"stdout","time":182.835035545,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":182.835110968,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227470, w_c=14.545864\n"}
,{"stream_name":"stdout","time":182.835222427,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:887 -   State hash: -6902641430640410117\n"}
,{"stream_name":"stdout","time":182.835302436,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.835506078,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=3.452806e-04\n"}
,{"stream_name":"stdout","time":182.836566763,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.836601317,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.836755408,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":182.836828527,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.836975965,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":182.837051108,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":182.837117001,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.837123378,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.837128378,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":182.837161605,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.062152791,"data":"[PROGRESS] Step 550: t=157.07/165.00s (95.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.328038573,"data":"  Stored output at t = 165.0000 s (Step 579)\n"}
,{"stream_name":"stdout","time":183.328067212,"data":"\n"}
,{"stream_name":"stdout","time":183.328072573,"data":"Simulation finished at t = 165.0000 s after 579 steps.\n"}
,{"stream_name":"stdout","time":183.328077601,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":183.328095554,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 30.59s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":183.329797614,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.329812117,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.329896018,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.330262242,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.330302768,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.330457033,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.730641e-05, max=1.782899e-03, std=2.541467e-04\n"}
,{"stream_name":"stdout","time":183.330594741,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":183.330682307,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227521, w_c=14.546121\n"}
,{"stream_name":"stdout","time":183.330822854,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:887 -   State hash: -1946610506443974649\n"}
,{"stream_name":"stdout","time":183.330894474,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.331080343,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=7.730641e-05\n"}
,{"stream_name":"stdout","time":183.33215126,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.332290974,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.332399052,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":183.332498887,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.332609232,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.332693022,"data":"2025-10-15 22:05:07 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":183.332783044,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.332797262,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.332801612,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":183.332805335,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.469669148,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":183.4696966,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.469720434,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":183.469728923,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":183.469733344,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.469737074,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":183.521519541,"data":"[PROGRESS] Step 600: t=170.94/180.00s (95.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.829286223,"data":"  Stored output at t = 180.0000 s (Step 633)\n"}
,{"stream_name":"stdout","time":183.82936421,"data":"\n"}
,{"stream_name":"stdout","time":183.829372705,"data":"Simulation finished at t = 180.0000 s after 633 steps.\n"}
,{"stream_name":"stderr","time":183.829369823,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.24s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 30.24s/s]\n"}
,{"stream_name":"stdout","time":183.829377579,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":183.830926953,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.831067172,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.831195039,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.831561159,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.831639473,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.831767968,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.720545e-05, max=4.102117e-04, std=5.786927e-05\n"}
,{"stream_name":"stdout","time":183.831920526,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":183.832030486,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227532, w_c=14.546179\n"}
,{"stream_name":"stdout","time":183.832133297,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:887 -   State hash: 8891238951267088843\n"}
,{"stream_name":"stdout","time":183.832241237,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.83243341,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.720545e-05\n"}
,{"stream_name":"stdout","time":183.833390055,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.833498448,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.833605942,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":183.833675319,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.833811189,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.833888485,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":183.83395383,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.833960562,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.833964932,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":183.833968929,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.988888757,"data":"[PROGRESS] Step 650: t=184.81/195.00s (94.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":184.318484775,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.99s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.98s/s]\n"}
,{"stream_name":"stdout","time":184.318525333,"data":"  Stored output at t = 195.0000 s (Step 687)\n"}
,{"stream_name":"stdout","time":184.31853097,"data":"\n"}
,{"stream_name":"stdout","time":184.318534748,"data":"Simulation finished at t = 195.0000 s after 687 steps.\n"}
,{"stream_name":"stdout","time":184.318538803,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":184.320065469,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.320121735,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.320267646,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.320588489,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.320633516,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.320758754,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.806005e-06, max=9.303081e-05, std=1.302380e-05\n"}
,{"stream_name":"stdout","time":184.32094135,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":184.321027167,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227534, w_c=14.546192\n"}
,{"stream_name":"stdout","time":184.321142277,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:887 -   State hash: -3697319549132542218\n"}
,{"stream_name":"stdout","time":184.321206665,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.321398799,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=3.806005e-06\n"}
,{"stream_name":"stdout","time":184.322385325,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.322427548,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.322581527,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":184.322623414,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.322783023,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.322802888,"data":"2025-10-15 22:05:08 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":184.322880001,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.32288755,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.322891926,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":184.322943904,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.386468738,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":184.386489615,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.386494806,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":184.386498955,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":184.386503053,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.38650704,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":184.439362055,"data":"[PROGRESS] Step 700: t=198.68/210.00s (94.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":184.803016294,"data":"  Stored output at t = 210.0000 s (Step 741)\n"}
,{"stream_name":"stderr","time":184.803141885,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 31.27s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 31.26s/s]\n"}
,{"stream_name":"stdout","time":184.803172033,"data":"\n"}
,{"stream_name":"stdout","time":184.803180544,"data":"Simulation finished at t = 210.0000 s after 741 steps.\n"}
,{"stream_name":"stdout","time":184.803185191,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":184.804849104,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.804865718,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.804994347,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.805346811,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.805385207,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.805524368,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.368694e-07, max=2.087843e-05, std=2.904567e-06\n"}
,{"stream_name":"stdout","time":184.805698719,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":184.805775625,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":184.805954058,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:887 -   State hash: -2598205160262111748\n"}
,{"stream_name":"stdout","time":184.805983009,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.806204127,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=8.368694e-07\n"}
,{"stream_name":"stdout","time":184.807241741,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.807331781,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.80747443,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":184.80756063,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.807679141,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.80776141,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":184.807835596,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.807854898,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.807860498,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":184.807865675,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.888898685,"data":"[PROGRESS] Step 750: t=212.55/225.00s (94.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.283943547,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":185.283972858,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.283977451,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":185.283980308,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":185.283982807,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.283985403,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":185.292008363,"data":"  Stored output at t = 225.0000 s (Step 795)\n"}
,{"stream_name":"stdout","time":185.292234051,"data":"\n"}
,{"stream_name":"stdout","time":185.292244872,"data":"Simulation finished at t = 225.0000 s after 795 steps.\n"}
,{"stream_name":"stderr","time":185.292239042,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 31.01s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 30.99s/s]\n"}
,{"stream_name":"stdout","time":185.292250059,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":185.293784571,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.29392332,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.293997412,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.294398406,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.294437955,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.29459529,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.829616e-07, max=4.646584e-06, std=6.429022e-07\n"}
,{"stream_name":"stdout","time":185.294755286,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":185.29487779,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":185.294959847,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:887 -   State hash: -1743666512905310104\n"}
,{"stream_name":"stdout","time":185.295053302,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.295239447,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.829616e-07\n"}
,{"stream_name":"stdout","time":185.296286413,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.296378932,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.29651665,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":185.296629722,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.296693531,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.296871762,"data":"2025-10-15 22:05:09 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":185.296887202,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.296892818,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.296920765,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":185.29694415,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.342391991,"data":"[PROGRESS] Step 800: t=226.41/240.00s (94.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.78476276,"data":"  Stored output at t = 240.0000 s (Step 849)\n"}
,{"stream_name":"stdout","time":185.784789617,"data":"\n"}
,{"stream_name":"stdout","time":185.784794248,"data":"Simulation finished at t = 240.0000 s after 849 steps.\n"}
,{"stream_name":"stdout","time":185.784798262,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":185.78481588,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 30.78s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 30.77s/s]\n"}
,{"stream_name":"stdout","time":185.786547854,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.786622398,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.78681372,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.787193824,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.787237543,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.787388099,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.978507e-08, max=1.026794e-06, std=1.413697e-07\n"}
,{"stream_name":"stdout","time":185.787567464,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":185.787643059,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":185.787753287,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:887 -   State hash: 751798979352426594\n"}
,{"stream_name":"stdout","time":185.787863339,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.78804369,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=3.978507e-08\n"}
,{"stream_name":"stdout","time":185.789123882,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.789237509,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.789364374,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":185.789496393,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.789575963,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.789756129,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":185.789770075,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.789816186,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.78984015,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":185.789844495,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.799680906,"data":"[PROGRESS] Step 850: t=240.28/255.00s (94.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.200964437,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":186.200992109,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.200997186,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":186.201001522,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":186.201005316,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.201009041,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":186.254696445,"data":"[PROGRESS] Step 900: t=254.42/255.00s (99.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.281666656,"data":"  Stored output at t = 255.0000 s (Step 903)\n"}
,{"stream_name":"stderr","time":186.281833904,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 30.53s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 30.51s/s]\n"}
,{"stream_name":"stdout","time":186.281839767,"data":"\n"}
,{"stream_name":"stdout","time":186.281863062,"data":"Simulation finished at t = 255.0000 s after 903 steps.\n"}
,{"stream_name":"stdout","time":186.281868426,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":186.283543765,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.283705528,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.283884413,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.284248072,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.284301973,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.284464654,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.607088e-09, max=2.254755e-07, std=3.090290e-08\n"}
,{"stream_name":"stdout","time":186.2848298,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":186.284947104,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":186.285092574,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:887 -   State hash: -2513471752693836224\n"}
,{"stream_name":"stdout","time":186.285150907,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.285400042,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=8.607088e-09\n"}
,{"stream_name":"stdout","time":186.28653962,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.286582247,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.28675788,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":186.286880096,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.286984182,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.287064204,"data":"2025-10-15 22:05:10 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":186.287145565,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.287156878,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.287161511,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":186.287165347,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.713048264,"data":"[PROGRESS] Step 950: t=268.29/270.00s (99.4%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":186.77743856,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.63s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.62s/s]\n"}
,{"stream_name":"stdout","time":186.777462079,"data":"  Stored output at t = 270.0000 s (Step 957)\n"}
,{"stream_name":"stdout","time":186.777496887,"data":"\n"}
,{"stream_name":"stdout","time":186.777501457,"data":"Simulation finished at t = 270.0000 s after 957 steps.\n"}
,{"stream_name":"stdout","time":186.777522804,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":186.779308466,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.779326864,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.779344871,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.779753824,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.779779479,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.779948299,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.852997e-09, max=4.922894e-08, std=6.718483e-09\n"}
,{"stream_name":"stdout","time":186.780121035,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":186.780252219,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":186.780335063,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:887 -   State hash: 7400299829831084019\n"}
,{"stream_name":"stdout","time":186.780454495,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.780630911,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.852997e-09\n"}
,{"stream_name":"stdout","time":186.781644434,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.781728514,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.78189899,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":186.781914952,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.782058238,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.782123238,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":186.782187931,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.782196276,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.782201071,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":186.782205013,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.118348188,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":187.118377262,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.118382942,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":187.118400106,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":187.118403096,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.118405637,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":187.170499805,"data":"[PROGRESS] Step 1000: t=282.16/285.00s (99.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":187.268722124,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.87s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.86s/s]\n"}
,{"stream_name":"stdout","time":187.268750309,"data":"  Stored output at t = 285.0000 s (Step 1011)\n"}
,{"stream_name":"stdout","time":187.26876638,"data":"\n"}
,{"stream_name":"stdout","time":187.268771143,"data":"Simulation finished at t = 285.0000 s after 1011 steps.\n"}
,{"stream_name":"stdout","time":187.268775076,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":187.27028127,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.27037077,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.27051224,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.270934312,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.270959332,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.271112456,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.970844e-10, max=1.069122e-08, std=1.453212e-09\n"}
,{"stream_name":"stdout","time":187.271341368,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.271386802,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":187.271513047,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:887 -   State hash: 1297355356402696690\n"}
,{"stream_name":"stdout","time":187.271621024,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.271848013,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=3.970844e-10\n"}
,{"stream_name":"stdout","time":187.272825756,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.272883188,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.273043528,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":187.273151574,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.273232337,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.273365324,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":187.273373658,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.273391176,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.273410948,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":187.273422836,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.621080216,"data":"[PROGRESS] Step 1050: t=296.03/300.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":187.763989306,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.61s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.60s/s]\n"}
,{"stream_name":"stdout","time":187.763996269,"data":"  Stored output at t = 300.0000 s (Step 1065)\n"}
,{"stream_name":"stdout","time":187.764034118,"data":"\n"}
,{"stream_name":"stdout","time":187.764039445,"data":"Simulation finished at t = 300.0000 s after 1065 steps.\n"}
,{"stream_name":"stdout","time":187.764043917,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":187.765620142,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.76564032,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":187.765645524,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.765689842,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.766104797,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.766160281,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.766314937,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.472035e-11, max=2.310315e-09, std=3.128290e-10\n"}
,{"stream_name":"stdout","time":187.766496385,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.766578966,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":187.766734152,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:887 -   State hash: -2759238306709583421\n"}
,{"stream_name":"stdout","time":187.766785754,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.767014257,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=8.472035e-11\n"}
,{"stream_name":"stdout","time":187.767964531,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.768006942,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.768132836,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":187.768231861,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.768365928,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.768421563,"data":"2025-10-15 22:05:11 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":187.768491382,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.768499873,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.76850454,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":187.768508063,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.042854943,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":188.042884021,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.042889246,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":188.042892881,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":188.042896691,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.042900687,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":188.095890826,"data":"[PROGRESS] Step 1100: t=309.90/315.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.265954954,"data":"  Stored output at t = 315.0000 s (Step 1119)\n"}
,{"stream_name":"stderr","time":188.26606918,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 30.18s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 30.17s/s]\n"}
,{"stream_name":"stdout","time":188.266104778,"data":"\n"}
,{"stream_name":"stdout","time":188.266115394,"data":"Simulation finished at t = 315.0000 s after 1119 steps.\n"}
,{"stream_name":"stdout","time":188.266120341,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":188.267877767,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.267894184,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.268032861,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.268399371,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.268477104,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.268628023,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.800023e-11, max=4.969092e-10, std=6.703790e-11\n"}
,{"stream_name":"stdout","time":188.268791162,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.268890544,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":188.268961701,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:887 -   State hash: 8947334744294200338\n"}
,{"stream_name":"stdout","time":188.269065932,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.269243355,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=1.800023e-11\n"}
,{"stream_name":"stdout","time":188.270197256,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.270292581,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.270382641,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":188.270477195,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.270536068,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.270637653,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":188.270653165,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.270658365,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.270686245,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":188.27069732,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.542616397,"data":"[PROGRESS] Step 1150: t=323.77/330.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.753435115,"data":"  Stored output at t = 330.0000 s (Step 1173)\n"}
,{"stream_name":"stdout","time":188.753521605,"data":"\n"}
,{"stream_name":"stdout","time":188.753531981,"data":"Simulation finished at t = 330.0000 s after 1173 steps.\n"}
,{"stream_name":"stdout","time":188.753576898,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":188.753527254,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.10s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 31.09s/s]\n"}
,{"stream_name":"stdout","time":188.755249703,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.755372325,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.755527147,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.755939673,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.75600495,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.756168358,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.809539e-12, max=1.064127e-10, std=1.430516e-11\n"}
,{"stream_name":"stdout","time":188.756386632,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.75644576,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":188.756615718,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:887 -   State hash: -4627689392388707396\n"}
,{"stream_name":"stdout","time":188.756681213,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.756890494,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=3.809539e-12\n"}
,{"stream_name":"stdout","time":188.757919121,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.758050034,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.758145454,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":188.75826138,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.758344513,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.758473284,"data":"2025-10-15 22:05:12 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":188.758510096,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.758517385,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.758522639,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":188.758542674,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.949731738,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":188.949759106,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.949764353,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":188.949768065,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":188.949771588,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.949776769,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":189.002552907,"data":"[PROGRESS] Step 1200: t=337.64/345.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":189.248225858,"data":"  Stored output at t = 345.0000 s (Step 1227)\n"}
,{"stream_name":"stdout","time":189.248427368,"data":"\n"}
,{"stream_name":"stdout","time":189.248438959,"data":"Simulation finished at t = 345.0000 s after 1227 steps.\n"}
,{"stream_name":"stdout","time":189.248468464,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":189.248473747,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.66s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.65s/s]\n"}
,{"stream_name":"stdout","time":189.250172145,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.250187766,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.250220838,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.250554987,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.250622883,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.250756211,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.033112e-13, max=2.269473e-11, std=3.040188e-12\n"}
,{"stream_name":"stdout","time":189.250925837,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.251008945,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":189.251118043,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:887 -   State hash: 4655085203859509369\n"}
,{"stream_name":"stdout","time":189.251208965,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.251428646,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=8.033112e-13\n"}
,{"stream_name":"stdout","time":189.252410307,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.25252436,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.252652217,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":189.252742219,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.252876261,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.252947243,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":189.252980762,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.252986644,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.253000394,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":189.253044348,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.460327212,"data":"[PROGRESS] Step 1250: t=351.50/360.00s (97.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":189.735037538,"data":"  Stored output at t = 360.0000 s (Step 1281)\n"}
,{"stream_name":"stdout","time":189.735065172,"data":"\n"}
,{"stream_name":"stdout","time":189.735070332,"data":"Simulation finished at t = 360.0000 s after 1281 steps.\n"}
,{"stream_name":"stdout","time":189.735074882,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":189.735038295,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 31.16s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 31.15s/s]\n"}
,{"stream_name":"stdout","time":189.736604167,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.736776252,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.736815949,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.737181438,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.73730632,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.737422756,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.687630e-13, max=4.812151e-12, std=6.429026e-13\n"}
,{"stream_name":"stdout","time":189.737577933,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.737654366,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":189.737785299,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:887 -   State hash: -8692693466215731060\n"}
,{"stream_name":"stdout","time":189.737876849,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.738080836,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=1.687630e-13\n"}
,{"stream_name":"stdout","time":189.739035378,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.739077201,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.739224431,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":189.739287562,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.739415337,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.739532711,"data":"2025-10-15 22:05:13 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":189.739561116,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.739566285,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.73957299,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":189.739577041,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.857008762,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":189.857036188,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.85704221,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":189.857046722,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":189.857050956,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.857055295,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":189.909731665,"data":"[PROGRESS] Step 1300: t=365.37/375.00s (97.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.221029149,"data":"  Stored output at t = 375.0000 s (Step 1335)\n"}
,{"stream_name":"stderr","time":190.221151903,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.19s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.18s/s]\n"}
,{"stream_name":"stdout","time":190.221164793,"data":"\n"}
,{"stream_name":"stdout","time":190.221181033,"data":"Simulation finished at t = 375.0000 s after 1335 steps.\n"}
,{"stream_name":"stdout","time":190.221185867,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":190.222825342,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.22296742,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.223094064,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.223462467,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.223554785,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.223693406,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.531257e-14, max=1.024958e-12, std=1.363964e-13\n"}
,{"stream_name":"stdout","time":190.223911489,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.223981218,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":190.224118717,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:887 -   State hash: -813260378196791541\n"}
,{"stream_name":"stdout","time":190.224177777,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.224411148,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=3.531257e-14\n"}
,{"stream_name":"stdout","time":190.22541495,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.22551415,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.225665202,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":190.225729685,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.225871595,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.225937269,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":190.226006259,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.226012695,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.22601736,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":190.22602161,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.368772874,"data":"[PROGRESS] Step 1350: t=379.24/390.00s (97.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.724224801,"data":"  Stored output at t = 390.0000 s (Step 1389)\n"}
,{"stream_name":"stdout","time":190.7244098,"data":"\n"}
,{"stream_name":"stderr","time":190.724410951,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 30.13s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 30.12s/s]\n"}
,{"stream_name":"stdout","time":190.724420995,"data":"Simulation finished at t = 390.0000 s after 1389 steps.\n"}
,{"stream_name":"stdout","time":190.724435888,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":190.726026932,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.726177865,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.726339773,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.726736982,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.726764362,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.726928189,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.431160e-15, max=2.113865e-13, std=2.849219e-14\n"}
,{"stream_name":"stdout","time":190.727086305,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.727206129,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":190.727316266,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:887 -   State hash: 3872615528008165082\n"}
,{"stream_name":"stdout","time":190.727414795,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.727596599,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=7.431160e-15\n"}
,{"stream_name":"stdout","time":190.728601293,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.728734439,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.7288945,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":190.728966468,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.729043888,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.729199553,"data":"2025-10-15 22:05:14 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":190.729206853,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.72921102,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.729215246,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":190.729249125,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.778403037,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":190.778431821,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.778437911,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":190.778442074,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":190.778446479,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.778451085,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":190.84727218,"data":"[PROGRESS] Step 1400: t=393.11/405.00s (97.1%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":191.242119128,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 29.27s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 29.27s/s]\n"}
,{"stream_name":"stdout","time":191.242134297,"data":"  Stored output at t = 405.0000 s (Step 1443)\n"}
,{"stream_name":"stdout","time":191.242164128,"data":"\n"}
,{"stream_name":"stdout","time":191.242169702,"data":"Simulation finished at t = 405.0000 s after 1443 steps.\n"}
,{"stream_name":"stdout","time":191.242174477,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":191.243778327,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.243814397,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.243948244,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.244301991,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.244398239,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.244509868,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.380187e-15, max=4.796163e-14, std=5.884982e-15\n"}
,{"stream_name":"stdout","time":191.244669118,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.244766741,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":191.244906085,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:887 -   State hash: -5087349317401764755\n"}
,{"stream_name":"stdout","time":191.244966905,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.245164103,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=1.380187e-15\n"}
,{"stream_name":"stdout","time":191.246149059,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.24622104,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.246406861,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":191.246489983,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.246598899,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.246729349,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":191.246788044,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.24679582,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.246800861,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":191.246804996,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.309543631,"data":"[PROGRESS] Step 1450: t=406.98/420.00s (96.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":191.708380431,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":191.708409381,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.708414966,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":191.708419652,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":191.708423753,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.708441973,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":191.734155156,"data":"  Stored output at t = 420.0000 s (Step 1497)\n"}
,{"stream_name":"stderr","time":191.734193072,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 30.81s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 30.80s/s]\n"}
,{"stream_name":"stdout","time":191.734214818,"data":"\n"}
,{"stream_name":"stdout","time":191.734220507,"data":"Simulation finished at t = 420.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":191.734224587,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":191.736016424,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.736037666,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.736163148,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.73658269,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.736649586,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.73680905,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.481687e-16, max=1.065814e-14, std=1.348906e-15\n"}
,{"stream_name":"stdout","time":191.737028502,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.73708619,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":191.737208394,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:887 -   State hash: -2327991379629599775\n"}
,{"stream_name":"stdout","time":191.737292842,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.737499315,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=2.481687e-16\n"}
,{"stream_name":"stdout","time":191.738474036,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.738528776,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.738662667,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":191.738719048,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.738861004,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.73894733,"data":"2025-10-15 22:05:15 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":191.738974519,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.73898344,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.739005281,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":191.739024985,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.76637779,"data":"[PROGRESS] Step 1500: t=420.85/435.00s (96.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.21722111,"data":"[PROGRESS] Step 1550: t=434.99/435.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.226509702,"data":"  Stored output at t = 435.0000 s (Step 1551)\n"}
,{"stream_name":"stderr","time":192.226768234,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.79s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.78s/s]\n"}
,{"stream_name":"stdout","time":192.226794237,"data":"\n"}
,{"stream_name":"stdout","time":192.22680407,"data":"Simulation finished at t = 435.0000 s after 1551 steps.\n"}
,{"stream_name":"stdout","time":192.226808545,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":192.228467055,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.228616492,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.228767278,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.229107302,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.229190588,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.229279134,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.153883e-16, max=7.105427e-15, std=8.319311e-16\n"}
,{"stream_name":"stdout","time":192.229426558,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.229501479,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":192.229598047,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:887 -   State hash: -1036382967346671196\n"}
,{"stream_name":"stdout","time":192.229732776,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.229893416,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=1.153883e-16\n"}
,{"stream_name":"stdout","time":192.230857423,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.230929327,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.231052976,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":192.23116454,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.231266542,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.231387304,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":192.231452019,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.231462397,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.231467429,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":192.231512309,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.613264541,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":192.613294068,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.61330029,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":192.613304481,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":192.613308421,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.613312254,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":192.665545386,"data":"[PROGRESS] Step 1600: t=448.86/450.00s (99.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.709247135,"data":"  Stored output at t = 450.0000 s (Step 1605)\n"}
,{"stream_name":"stderr","time":192.70944936,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 31.42s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 31.41s/s]\n"}
,{"stream_name":"stdout","time":192.709467575,"data":"\n"}
,{"stream_name":"stdout","time":192.709472195,"data":"Simulation finished at t = 450.0000 s after 1605 steps.\n"}
,{"stream_name":"stdout","time":192.709476597,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":192.71097609,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.710990688,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":192.711134682,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.711280813,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.711625749,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.711696111,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.711829318,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.135774e-17, max=5.329071e-15, std=2.880643e-16\n"}
,{"stream_name":"stdout","time":192.711992843,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.712073128,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":192.712184916,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:887 -   State hash: -4905179473273595169\n"}
,{"stream_name":"stdout","time":192.712288148,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.712463265,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=2.135774e-17\n"}
,{"stream_name":"stdout","time":192.713422714,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.713505554,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.713618842,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":192.713754334,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.713818262,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.713955729,"data":"2025-10-15 22:05:16 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":192.713965759,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.713970525,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.713984205,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":192.714014534,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.116329323,"data":"[PROGRESS] Step 1650: t=462.73/465.00s (99.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.19658442,"data":"  Stored output at t = 465.0000 s (Step 1659)\n"}
,{"stream_name":"stderr","time":193.196646802,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 31.11s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":193.19665697,"data":"\n"}
,{"stream_name":"stdout","time":193.19666515,"data":"Simulation finished at t = 465.0000 s after 1659 steps.\n"}
,{"stream_name":"stdout","time":193.196669705,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":193.198352681,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.198369134,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.198487523,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.198849818,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.198879096,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.199039981,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":193.199199425,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.199275097,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":193.199401247,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:887 -   State hash: -4905179473273595169\n"}
,{"stream_name":"stdout","time":193.199469594,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.199644123,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":193.200565823,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.200675652,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.200809893,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":193.200892777,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.200984208,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.201099505,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":193.20110644,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.201111253,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.201125093,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":193.201130037,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.513088356,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":193.513114688,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.513121889,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":193.513126283,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":193.513130408,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.513134904,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":193.564337848,"data":"[PROGRESS] Step 1700: t=476.59/480.00s (99.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.679016901,"data":"  Stored output at t = 480.0000 s (Step 1713)\n"}
,{"stream_name":"stdout","time":193.679075536,"data":"\n"}
,{"stream_name":"stdout","time":193.679093705,"data":"Simulation finished at t = 480.0000 s after 1713 steps.\n"}
,{"stream_name":"stdout","time":193.679100537,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":193.679077834,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 31.42s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 31.41s/s]\n"}
,{"stream_name":"stdout","time":193.680666717,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.680692846,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.680892752,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.681199564,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.681242023,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.681392532,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":193.681546717,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.681608677,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":193.681698869,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:887 -   State hash: -4905179473273595169\n"}
,{"stream_name":"stdout","time":193.681829813,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.681985145,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":193.682949358,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.683063103,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.683174125,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":193.683274464,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.683354352,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.683450792,"data":"2025-10-15 22:05:17 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":193.683498591,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.683504884,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.683509704,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":193.683513647,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.012530689,"data":"[PROGRESS] Step 1750: t=490.46/495.00s (99.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.164347247,"data":"  Stored output at t = 495.0000 s (Step 1767)\n"}
,{"stream_name":"stdout","time":194.164569562,"data":"\n"}
,{"stream_name":"stderr","time":194.164570654,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.22s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.21s/s]\n"}
,{"stream_name":"stdout","time":194.164583268,"data":"Simulation finished at t = 495.0000 s after 1767 steps.\n"}
,{"stream_name":"stdout","time":194.164594034,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":194.166142264,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.166208385,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.166387794,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.166780701,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.166857824,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.167035215,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.167225725,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.167330877,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":194.167432725,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:887 -   State hash: -4905179473273595169\n"}
,{"stream_name":"stdout","time":194.167539942,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.167758287,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.168698682,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.168799228,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.168926166,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":194.16899982,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.169104483,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.169182094,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":194.169245499,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.169253254,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.169265204,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":194.169286035,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.409314334,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":194.409340971,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.409346671,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":194.409350884,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":194.409355152,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.409359346,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":194.461757995,"data":"[PROGRESS] Step 1800: t=504.33/510.00s (98.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.64979035,"data":"  Stored output at t = 510.0000 s (Step 1821)\n"}
,{"stream_name":"stderr","time":194.64995540500001,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.25s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.24s/s]\n"}
,{"stream_name":"stdout","time":194.649964496,"data":"\n"}
,{"stream_name":"stdout","time":194.649983411,"data":"Simulation finished at t = 510.0000 s after 1821 steps.\n"}
,{"stream_name":"stdout","time":194.649988052,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":194.651600783,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.651665654,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.651865028,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.652209537,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.652324258,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.652440787,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.652625515,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.652723561,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":194.652847538,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:887 -   State hash: -4905179473273595169\n"}
,{"stream_name":"stdout","time":194.6529356,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.653117089,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.65413081,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.654218947,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.654373577,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":194.654438607,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.654537406,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.654619488,"data":"2025-10-15 22:05:18 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":194.654655124,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.654660682,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.654664788,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":194.65467733,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.911744622,"data":"[PROGRESS] Step 1850: t=518.20/525.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.1365548,"data":"  Stored output at t = 525.0000 s (Step 1875)\n"}
,{"stream_name":"stderr","time":195.136876603,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.15s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":195.136881991,"data":"\n"}
,{"stream_name":"stdout","time":195.136900598,"data":"Simulation finished at t = 525.0000 s after 1875 steps.\n"}
,{"stream_name":"stdout","time":195.136905514,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":195.138511649,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.138629457,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.13875037,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.139097581,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.139204512,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.139316556,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.931605e-17, max=7.105427e-15, std=6.503592e-16\n"}
,{"stream_name":"stdout","time":195.139504265,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.139584024,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":195.139670717,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:887 -   State hash: 6502389724230642639\n"}
,{"stream_name":"stdout","time":195.139754847,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.139957071,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=9.931605e-17\n"}
,{"stream_name":"stdout","time":195.140908909,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.141030758,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.141116031,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":195.141210321,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.141293475,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.14139248,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":195.141429696,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.141451692,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.141458068,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":195.1414624,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.314540569,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":195.314570756,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.314576267,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":195.314580411,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":195.314584526,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.31458922,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":195.367247351,"data":"[PROGRESS] Step 1900: t=532.07/540.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.626621649,"data":"  Stored output at t = 540.0000 s (Step 1929)\n"}
,{"stream_name":"stdout","time":195.626807935,"data":"\n"}
,{"stream_name":"stdout","time":195.626823696,"data":"Simulation finished at t = 540.0000 s after 1929 steps.\n"}
,{"stream_name":"stderr","time":195.626816031,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 30.95s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 30.93s/s]\n"}
,{"stream_name":"stdout","time":195.62682896,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":195.628493174,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.62854449,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.628684753,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.629027694,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.629067474,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.629196007,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.728573e-17, max=7.105427e-15, std=3.479448e-16\n"}
,{"stream_name":"stdout","time":195.629357584,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.629425459,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":195.629543133,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:887 -   State hash: 4575526918289234759\n"}
,{"stream_name":"stdout","time":195.62960006,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.62980906,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=1.728573e-17\n"}
,{"stream_name":"stdout","time":195.630741877,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.630819549,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.63094339,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":195.630999006,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.631093167,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.631173654,"data":"2025-10-15 22:05:19 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":195.631287471,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.63129515,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.631299587,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":195.631303664,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.819616018,"data":"[PROGRESS] Step 1950: t=545.94/555.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.109428159,"data":"  Stored output at t = 555.0000 s (Step 1983)\n"}
,{"stream_name":"stdout","time":196.109512843,"data":"\n"}
,{"stream_name":"stdout","time":196.109522488,"data":"Simulation finished at t = 555.0000 s after 1983 steps.\n"}
,{"stream_name":"stdout","time":196.109527325,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":196.109510276,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.41s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.40s/s]\n"}
,{"stream_name":"stdout","time":196.111288381,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.111322051,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.111424347,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.11182588,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.111889818,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.112042075,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.310008e-17, max=3.552714e-15, std=1.943100e-16\n"}
,{"stream_name":"stdout","time":196.112190866,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.11233533,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":196.112413772,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:887 -   State hash: -1937670630310555133\n"}
,{"stream_name":"stdout","time":196.112527208,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.112748331,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=1.310008e-17\n"}
,{"stream_name":"stdout","time":196.11366747,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.113726941,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.113894751,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":196.113946865,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.114064095,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.11412609,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":196.114190035,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.114198461,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.114203683,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":196.114213554,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.215516662,"data":"[WARNING] Automatic CFL correction applied (count: 7200):\n"}
,{"stream_name":"stdout","time":196.215546232,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.215551899,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":196.215555938,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":196.215560224,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.215563896,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":196.267458397,"data":"[PROGRESS] Step 2000: t=559.81/570.00s (98.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.597837135,"data":"  Stored output at t = 570.0000 s (Step 2037)\n"}
,{"stream_name":"stderr","time":196.598077866,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.04s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.03s/s]\n"}
,{"stream_name":"stdout","time":196.598085737,"data":"\n"}
,{"stream_name":"stdout","time":196.598104246,"data":"Simulation finished at t = 570.0000 s after 2037 steps.\n"}
,{"stream_name":"stdout","time":196.598109974,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":196.599775912,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.599878245,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.600008492,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.600374661,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.600509484,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.600571633,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.308966e-17, max=3.552714e-15, std=1.943104e-16\n"}
,{"stream_name":"stdout","time":196.600770805,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.600874606,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":196.600998447,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:887 -   State hash: 3230967479424243840\n"}
,{"stream_name":"stdout","time":196.601054311,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.6012742,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=1.308966e-17\n"}
,{"stream_name":"stdout","time":196.602263502,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.602414822,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.602527834,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":196.602649479,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.602749998,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.602883527,"data":"2025-10-15 22:05:20 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":196.60291158,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.6029361,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.602942211,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":196.60297139,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.72878526,"data":"[PROGRESS] Step 2050: t=573.68/585.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.098984161,"data":"  Stored output at t = 585.0000 s (Step 2091)\n"}
,{"stream_name":"stdout","time":197.099018405,"data":"\n"}
,{"stream_name":"stdout","time":197.099023855,"data":"Simulation finished at t = 585.0000 s after 2091 steps.\n"}
,{"stream_name":"stderr","time":197.099014729,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 30.27s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":197.099028281,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":197.10088067,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.101010283,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.101137944,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.101507228,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.101582061,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.101699624,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.657578e-19, max=1.040834e-17, std=1.004599e-18\n"}
,{"stream_name":"stdout","time":197.101892476,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.101996703,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":197.102107181,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:887 -   State hash: 8833583509174074804\n"}
,{"stream_name":"stdout","time":197.102188181,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.102388901,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=1.657578e-19\n"}
,{"stream_name":"stdout","time":197.103355474,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.10351586,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.103636426,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":197.103722187,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.103831037,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.103949249,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":197.103971366,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":197.10397879,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.104006352,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":197.104014165,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.13492466,"data":"[WARNING] Automatic CFL correction applied (count: 7300):\n"}
,{"stream_name":"stdout","time":197.134947556,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.134952723,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":197.134956898,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":197.134961531,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.134965938,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":197.190528119,"data":"[PROGRESS] Step 2100: t=587.55/600.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.592108185,"data":"  Stored output at t = 600.0000 s (Step 2145)\n"}
,{"stream_name":"stdout","time":197.59230587,"data":"\n"}
,{"stream_name":"stderr","time":197.592310338,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.76s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.75s/s]\n"}
,{"stream_name":"stdout","time":197.59231581,"data":"Simulation finished at t = 600.0000 s after 2145 steps.\n"}
,{"stream_name":"stdout","time":197.592353453,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":197.594049808,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.594071213,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":197.594076514,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":197.594090835,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.594270292,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":197.594592393,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.594720059,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.594810283,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":197.595003775,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.59509942,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":197.595165245,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:887 -   State hash: 8833583509174074804\n"}
,{"stream_name":"stdout","time":197.595295566,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.59548814,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":197.595497776,"data":"\n"}
,{"stream_name":"stdout","time":197.595501685,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":197.595505584,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":197.595509135,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":197.595512611,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":197.595515895,"data":"    - Avg step time: 0.492s (device=gpu)\n"}
,{"stream_name":"stdout","time":197.595519337,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":197.595522888,"data":"    - Wallclock time: 19.7s\n"}
,{"stream_name":"stdout","time":197.595526342,"data":"    - Speed ratio: 30.47x real-time\n"}
,{"stream_name":"stdout","time":197.595529838,"data":"\n"}
,{"stream_name":"stdout","time":197.595606296,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":197.595612313,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":197.595616079,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":197.595619749,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":197.595623461,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":197.595627005,"data":"    - Avg step time: 0.492s (device=gpu)\n"}
,{"stream_name":"stdout","time":197.595630605,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":197.595634242,"data":"    - Wallclock time: 19.7s\n"}
,{"stream_name":"stdout","time":197.595638209,"data":"    - Speed ratio: 30.47x real-time\n"}
,{"stream_name":"stdout","time":197.595641956,"data":"\n"}
,{"stream_name":"stdout","time":197.595738005,"data":"2025-10-15 22:05:21 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":197.59607346,"data":"\n"}
,{"stream_name":"stdout","time":197.596082695,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":197.596086635,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":197.596090139,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":197.596094289,"data":"\n"}
,{"stream_name":"stdout","time":197.596199619,"data":"2025-10-15 22:05:21 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":197.596282554,"data":"2025-10-15 22:05:21 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-7507336089097447101, last=8833583509174074804\n"}
,{"stream_name":"stdout","time":197.596888728,"data":"2025-10-15 22:05:21 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.02598921 0.02656696 0.02717803 0.02779986 0.02840156], w_m[10:15]=[16.58094357 16.52130442 16.46653825 16.4189181  16.3802789 ]\n"}
,{"stream_name":"stdout","time":197.602062862,"data":"2025-10-15 22:05:21 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02209535 0.02209194 0.02209061 0.02209007 0.02208984], w_m[10:15]=[17.75361676 17.7563278  17.75738546 17.75781042 17.75798681]\n"}
,{"stream_name":"stdout","time":197.602216385,"data":"2025-10-15 22:05:21 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=32.425207, efficiency=5.188033, delay=-175.97s\n"}
,{"stream_name":"stdout","time":197.602329514,"data":"2025-10-15 22:05:21 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":197.6024628,"data":"2025-10-15 22:05:21 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 32.42520699763865, 'avg_speed': 1285.401091376977, 'avg_density': 0.025475069317121752, 'efficiency': 5.188033119622183, 'delay': -175.96627867200107, 'throughput': 162126.03498819322}\n"}
,{"stream_name":"stdout","time":197.602527422,"data":"2025-10-15 22:05:21 - INFO - run_performance_comparison:1430 - Flow improvement: 14.616%\n"}
,{"stream_name":"stdout","time":197.602601922,"data":"2025-10-15 22:05:21 - INFO - run_performance_comparison:1431 - Efficiency improvement: 14.616%\n"}
,{"stream_name":"stdout","time":197.602672125,"data":"2025-10-15 22:05:21 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":197.602761545,"data":"  Flow improvement: 14.6%\n"}
,{"stream_name":"stdout","time":197.602773358,"data":"  Efficiency improvement: 14.6%\n"}
,{"stream_name":"stdout","time":197.602777845,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":197.602782285,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":197.603274711,"data":"\n"}
,{"stream_name":"stdout","time":197.603281853,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":198.241866296,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":198.758493209,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":198.758520313,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":198.758523883,"data":"\n"}
,{"stream_name":"stdout","time":198.758526399,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":198.767155083,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":198.767172296,"data":"\n"}
,{"stream_name":"stdout","time":198.767175372,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":198.767295775,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":198.767303856,"data":"\n"}
,{"stream_name":"stdout","time":198.767308132,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":198.7673126,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":198.767333914,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":198.767338302,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":198.767342741,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":198.767357176,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":198.768328105,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":201.541195447,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":201.54127497,"data":"\n"}
,{"stream_name":"stdout","time":201.541283797,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":201.541438282,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":201.544844478,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":201.545757067,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":201.545795997,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":201.545880863,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":201.546025428,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":201.546038329,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":201.546090777,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":201.546162033,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":201.546233181,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":201.546349338,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":201.617114446,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":201.61718526,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":201.617731299,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":201.617749712,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":201.617804533,"data":"\n"}
,{"stream_name":"stdout","time":201.617812842,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":201.617917326,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":201.618059214,"data":"\n"}
,{"stream_name":"stdout","time":201.618083097,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":201.618088826,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":201.618093774,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":201.618101413,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":205.127480975,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":205.127524652,"data":"  warn(\n"}
,{"stream_name":"stderr","time":205.169759823,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":205.925499223,"data":"[NbConvertApp] Writing 322209 bytes to __results__.html\n"}
]