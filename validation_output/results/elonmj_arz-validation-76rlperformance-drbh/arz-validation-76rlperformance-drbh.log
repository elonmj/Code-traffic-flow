[{"stream_name":"stdout","time":0.598868044,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.598987525,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.598993539,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.598997347,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.59900669,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.599290179,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.477565229,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.477762035,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.529334868,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.550021415,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.5500971230000005,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.550239985,"data":"\n"}
,{"stream_name":"stdout","time":5.550249142,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.550372875,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.434335316,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.434359467,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.434364583,"data":"\n"}
,{"stream_name":"stdout","time":9.434368895,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.434372871,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":13.216079427,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":16.139739463,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":19.094656707,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":22.083188354,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":24.977353795,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":27.876308473,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":103.323142719,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":103.323266003,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":103.323361518,"data":"\n"}
,{"stream_name":"stdout","time":103.323375299,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":103.323773138,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":103.323844122,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":103.323952651,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":103.324014526,"data":"============================================================\n"}
,{"stream_name":"stderr","time":115.051930285,"data":"2025-10-15 22:18:05.783297: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":115.232227916,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":115.232278009,"data":"E0000 00:00:1760566685.963648     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":115.309572692,"data":"E0000 00:00:1760566686.041081     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":126.440737339,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":126.44076741,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":126.440773811,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":126.440779552,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":126.440784041,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":126.440788741,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":126.440792948,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":126.44092606,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":126.440957273,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":126.44096223,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":126.440966114,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":126.440970056,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":126.440974066,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":126.441543229,"data":"2025-10-15 22:18:17 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":126.441667342,"data":"2025-10-15 22:18:17 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":126.441789012,"data":"2025-10-15 22:18:17 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":126.441878098,"data":"2025-10-15 22:18:17 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":126.441958702,"data":"2025-10-15 22:18:17 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":126.441977313,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":126.441982159,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":126.441986586,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":126.55983689,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":126.657521752,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":126.657553691,"data":"\n"}
,{"stream_name":"stdout","time":126.657558315,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":126.657562363,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":126.657585109,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":126.657589604,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":126.657667089,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":126.657805883,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":126.657865147,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":126.657942361,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":126.65801593,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":126.658134024,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":126.658240413,"data":"2025-10-15 22:18:17 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":126.658301053,"data":"\n"}
,{"stream_name":"stdout","time":126.658306397,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":126.658310443,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":126.658314175,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":126.658317953,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":126.658529616,"data":"2025-10-15 22:18:17 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":126.658667958,"data":"2025-10-15 22:18:17 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":126.658745783,"data":"2025-10-15 22:18:17 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":126.65917506,"data":"2025-10-15 22:18:17 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":126.663775549,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":126.663833843,"data":"2025-10-15 22:18:17 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":126.663951405,"data":"2025-10-15 22:18:17 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":126.663984986,"data":"2025-10-15 22:18:17 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":126.664099671,"data":"2025-10-15 22:18:17 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":126.664131461,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":126.664140985,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":126.664274712,"data":"2025-10-15 22:18:17 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":126.664434694,"data":"2025-10-15 22:18:17 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":126.664623026,"data":"2025-10-15 22:18:17 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":126.664751582,"data":"2025-10-15 22:18:17 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config 25b78b90\n"}
,{"stream_name":"stdout","time":126.664759155,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":126.665271263,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":126.665282774,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":126.672365007,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":126.672383282,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":126.672388369,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":126.672392572,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":126.672396263,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":126.672507733,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":126.672515141,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":126.672519485,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":126.672523693,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":126.672536573,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":126.672583108,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":126.672589107,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":126.675855502,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":126.675867128,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":126.676385009,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":126.676396741,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":128.106205637,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":128.106233569,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":128.106238103,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":128.106241661,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":128.106245359,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":128.106249007,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":128.106252671,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":128.106256273,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":128.106593973,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":128.107371358,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":128.107432338,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":128.107449946,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":132.430310473,"data":"2025-10-15 22:18:23 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":132.430684002,"data":"\n"}
,{"stream_name":"stdout","time":132.430693184,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":132.430697754,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":132.430701953,"data":"\n"}
,{"stream_name":"stdout","time":132.43070571,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":132.430709919,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":132.430714268,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":132.430717643,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":132.430721526,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":132.430725506,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":132.430729233,"data":"\n"}
,{"stream_name":"stdout","time":132.430771842,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":132.430787529,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":132.439844707,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":132.439864152,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":132.439868779,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":132.439874434,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":132.439878295,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":132.440008127,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":132.44002118,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":132.440053343,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":132.440057219,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":132.440060852,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.440084714,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":132.440094567,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":132.440858705,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":132.44087037,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":132.441960066,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":132.442288004,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.442302794,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.442307996,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.4473321,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":132.447526148,"data":"\n"}
,{"stream_name":"stdout","time":132.447536085,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":132.449145432,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":132.449162055,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":132.449167283,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":132.449170751,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.449562606,"data":"\n"}
,{"stream_name":"stderr","time":132.486447309,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":132.486470846,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":132.88083105,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":132.880859538,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.880864584,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":132.880868403,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":132.880872023,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.880875587,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":133.438971189,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.438997539,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.691438846,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.691469903,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.749049992,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.749078298,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":133.807104509,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":133.807131487,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.219506096,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.219540986,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.292878054,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.292903381,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.375212648,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.375238653,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.471344858,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.47137255,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.56707427,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.567101582,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.623755659,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.623780371,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":134.679928742,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":134.679956542,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":135.050419822,"data":"\n"}
,{"stream_name":"stderr","time":135.050446724,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.050428194,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":135.050629559,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.77s/s]\n"}
,{"stream_name":"stdout","time":135.050650889,"data":"\n"}
,{"stream_name":"stdout","time":135.050662202,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":135.050666651,"data":"Total runtime: 2.60 seconds.\n"}
,{"stream_name":"stdout","time":135.052322598,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":135.052565527,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.052575736,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.052580423,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.052584634,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.052759081,"data":"\n"}
,{"stream_name":"stdout","time":135.124075794,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":135.507393269,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":135.507423499,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.507444872,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.507689965,"data":"\n"}
,{"stream_name":"stdout","time":135.507699523,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stderr","time":135.507697732,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.99s/s]\n"}
,{"stream_name":"stdout","time":135.507704293,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":135.509368134,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":135.509721567,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.509732761,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.509737439,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.509741423,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.509922155,"data":"\n"}
,{"stream_name":"stdout","time":135.566513905,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":135.566531252,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.56653592,"data":"  Original dt: 4.633756e-01 s\n"}
,{"stream_name":"stdout","time":135.566539803,"data":"  Corrected dt: 2.896098e-01 s\n"}
,{"stream_name":"stdout","time":135.566543566,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.566547152,"data":"  Max wave speed detected: 17.26 m/s\n"}
,{"stream_name":"stdout","time":135.57436629,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":135.977844143,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":135.977844142,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.97787666,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.97817166,"data":"\n"}
,{"stream_name":"stdout","time":135.978184148,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":135.978188713,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":135.978173083,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.05s/s]\n"}
,{"stream_name":"stdout","time":135.979863554,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":135.980130356,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":135.98014312,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.980148408,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":135.98015304,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.980336439,"data":"\n"}
,{"stream_name":"stdout","time":136.024876294,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":136.444952549,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":136.444978702,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.444999425,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":136.44525017,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.30s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.28s/s]\n"}
,{"stream_name":"stdout","time":136.445295526,"data":"\n"}
,{"stream_name":"stdout","time":136.445317753,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":136.445322299,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":136.44685065,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":136.447340565,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.447351894,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.447357026,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.447361304,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.447663979,"data":"\n"}
,{"stream_name":"stdout","time":136.467510704,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":136.467530851,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.467535986,"data":"  Original dt: 4.617817e-01 s\n"}
,{"stream_name":"stdout","time":136.46754009,"data":"  Corrected dt: 2.886135e-01 s\n"}
,{"stream_name":"stdout","time":136.467544126,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.467548119,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":136.475660066,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":136.914742299,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.914771074,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.914804253,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":136.915054305,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.11s/s]\n"}
,{"stream_name":"stdout","time":136.915056307,"data":"\n"}
,{"stream_name":"stdout","time":136.915090113,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":136.915094755,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":136.916688878,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.917012893,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":136.917038537,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.917048773,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":136.917052782,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.917220562,"data":"\n"}
,{"stream_name":"stdout","time":136.926008214,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":137.365531118,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":137.365559323,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.36556446,"data":"  Original dt: 4.617543e-01 s\n"}
,{"stream_name":"stdout","time":137.365568343,"data":"  Corrected dt: 2.885965e-01 s\n"}
,{"stream_name":"stdout","time":137.36557197,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.365575406,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":137.373534924,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":137.382672951,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":137.38269256,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.382709115,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":137.383137207,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.21s/s]\n"}
,{"stream_name":"stdout","time":137.383151323,"data":"\n"}
,{"stream_name":"stdout","time":137.383163115,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":137.383167434,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":137.384778462,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.385120829,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.385135131,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.385140622,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.385161443,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.385362088,"data":"\n"}
,{"stream_name":"stdout","time":137.823972881,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":137.853536799,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":137.853559318,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":137.853564694,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":137.85366457,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.05s/s]\n"}
,{"stream_name":"stdout","time":137.853699169,"data":"\n"}
,{"stream_name":"stdout","time":137.853704065,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":137.853708835,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":137.855462396,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.855838308,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":137.855846101,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":137.855850197,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":137.855853974,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.856053809,"data":"\n"}
,{"stream_name":"stdout","time":138.318562599,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":138.318594957,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.318600772,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":138.318606637,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":138.318610339,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.318613567,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":138.327116422,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":138.373858248,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":138.373881357,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.373891053,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.374233064,"data":"\n"}
,{"stream_name":"stdout","time":138.374256474,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stderr","time":138.374253707,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.96s/s]\n"}
,{"stream_name":"stdout","time":138.374261694,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":138.376146711,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.376172964,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":138.376178304,"data":"\n"}
,{"stream_name":"stdout","time":138.376183221,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.376187846,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.02 | Avg Reward/Step: 0.003\n"}
,{"stream_name":"stdout","time":138.376191742,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":138.376195508,"data":"\n"}
,{"stream_name":"stdout","time":138.376198919,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":138.376205025,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":138.383949788,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":138.383967335,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":138.38397184,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":138.38397595,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":138.384057703,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":138.38420721,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":138.384215004,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":138.384220061,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":138.38422494,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":138.38423807,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.384278708,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":138.384284533,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":138.384960469,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":138.384969557,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":138.385299651,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":138.385642564,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.385650214,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.385654554,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.387741307,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.387754705,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.387759087,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.38777649,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.387934334,"data":"\n"}
,{"stream_name":"stdout","time":138.778090667,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":138.778105372,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.778129664,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.778321721,"data":"\n"}
,{"stream_name":"stdout","time":138.778330839,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stderr","time":138.778327095,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.45s/s]\n"}
,{"stream_name":"stdout","time":138.778335069,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":138.779927247,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":138.780255533,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":138.780266698,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.780271748,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":138.780276407,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.780451563,"data":"\n"}
,{"stream_name":"stdout","time":138.850732576,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":139.232047875,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":139.232052502,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.232085966,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.232253168,"data":"\n"}
,{"stream_name":"stdout","time":139.232264454,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":139.232269587,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":139.232291802,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.22s/s]\n"}
,{"stream_name":"stdout","time":139.23388481,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.234185745,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.234202068,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.234207297,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.234225142,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.234362933,"data":"\n"}
,{"stream_name":"stdout","time":139.24497875,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":139.244995344,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.245000612,"data":"  Original dt: 4.637575e-01 s\n"}
,{"stream_name":"stdout","time":139.245004744,"data":"  Corrected dt: 2.898484e-01 s\n"}
,{"stream_name":"stdout","time":139.245008738,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.24501303,"data":"  Max wave speed detected: 17.25 m/s\n"}
,{"stream_name":"stdout","time":139.297000092,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":139.696381445,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":139.696406047,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":139.696417433,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.696457998,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.48s/s]\n"}
,{"stream_name":"stdout","time":139.696510759,"data":"\n"}
,{"stream_name":"stdout","time":139.696519166,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":139.696523505,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":139.698114466,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.698298338,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":139.698308458,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":139.698312781,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":139.698316559,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.698489903,"data":"\n"}
,{"stream_name":"stdout","time":139.743214965,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":140.132963096,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":140.132983947,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.13298888,"data":"  Original dt: 4.617872e-01 s\n"}
,{"stream_name":"stdout","time":140.132992878,"data":"  Corrected dt: 2.886170e-01 s\n"}
,{"stream_name":"stdout","time":140.132996726,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.133000639,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":140.158897586,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":140.158904398,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.158927781,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.159061198,"data":"\n"}
,{"stream_name":"stdout","time":140.15907545,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":140.159080595,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":140.159087856,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.58s/s]\n"}
,{"stream_name":"stdout","time":140.160719369,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.161016993,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.161044409,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.161050265,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.161054482,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.161194338,"data":"\n"}
,{"stream_name":"stdout","time":140.188456224,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":140.625990795,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":140.626000554,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.6260361,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.626354237,"data":"\n"}
,{"stream_name":"stdout","time":140.626361471,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":140.626366155,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":140.626370379,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.26s/s]\n"}
,{"stream_name":"stdout","time":140.628095388,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.628393808,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":140.628400416,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":140.628405295,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":140.628409891,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.62857827,"data":"\n"}
,{"stream_name":"stdout","time":140.637936928,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":141.053675058,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":141.053703202,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.05372039,"data":"  Original dt: 4.617545e-01 s\n"}
,{"stream_name":"stdout","time":141.053724715,"data":"  Corrected dt: 2.885966e-01 s\n"}
,{"stream_name":"stdout","time":141.053728211,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.053731876,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":141.10616827,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":141.115641785,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":141.11564186,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.115680807,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.115995005,"data":"\n"}
,{"stream_name":"stderr","time":141.115990981,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":141.116003834,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":141.116021228,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":141.1175997,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":141.117885564,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.117896188,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.117900585,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.117904364,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.118068181,"data":"\n"}
,{"stream_name":"stdout","time":141.553868758,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":141.580925577,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":141.580963846,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.580982265,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.581190396,"data":"\n"}
,{"stream_name":"stdout","time":141.581211552,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":141.581216347,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":141.581226136,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.40s/s]\n"}
,{"stream_name":"stdout","time":141.582744621,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.583056878,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":141.583079641,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":141.583084226,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":141.583088049,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.583245568,"data":"\n"}
,{"stream_name":"stdout","time":141.952902981,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":141.952932183,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.952938674,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":141.95294292,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":141.952946989,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.952951743,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":142.008307627,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":142.052190109,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.052216146,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.052190159,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":142.052364068,"data":"\n"}
,{"stream_name":"stdout","time":142.052378174,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":142.052382798,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":142.052387563,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.99s/s]\n"}
,{"stream_name":"stdout","time":142.053919075,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.053932582,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":142.053965746,"data":"\n"}
,{"stream_name":"stdout","time":142.053991272,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":142.05399616,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":142.054000564,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":142.054004442,"data":"\n"}
,{"stream_name":"stdout","time":142.054008117,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":142.054016112,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":142.06149058,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":142.061507662,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":142.061512129,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":142.061515843,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":142.061531655,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":142.061536629,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":142.06154027,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":142.061544028,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":142.061550399,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":142.061554073,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.061557746,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":142.06156121,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":142.062105248,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":142.062184084,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":142.062425765,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":142.062695846,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.06270361,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.062707866,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.064552617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.064565351,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.064570117,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.064574048,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.06473308,"data":"\n"}
,{"stream_name":"stdout","time":142.438639657,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":142.438677805,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.438745433,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.438766513,"data":"\n"}
,{"stream_name":"stdout","time":142.43877151,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":142.438775957,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":142.438777483,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.13s/s]\n"}
,{"stream_name":"stdout","time":142.440292161,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":142.440567308,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.440575655,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.440595406,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.440599459,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.440747348,"data":"\n"}
,{"stream_name":"stdout","time":142.512428748,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":142.85965544,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":142.859685659,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.859691316,"data":"  Original dt: 4.642550e-01 s\n"}
,{"stream_name":"stdout","time":142.859695016,"data":"  Corrected dt: 2.901594e-01 s\n"}
,{"stream_name":"stdout","time":142.859699402,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.859703056,"data":"  Max wave speed detected: 17.23 m/s\n"}
,{"stream_name":"stdout","time":142.893910799,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":142.893916994,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.893940342,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":142.894169299,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.10s/s]\n"}
,{"stream_name":"stdout","time":142.894169507,"data":"\n"}
,{"stream_name":"stdout","time":142.894190027,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":142.894195469,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":142.895785931,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.896110205,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":142.896122196,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.896130409,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":142.896134302,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.896293833,"data":"\n"}
,{"stream_name":"stdout","time":142.957521254,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":143.364903393,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":143.364903853,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.364942339,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.365070265,"data":"\n"}
,{"stream_name":"stderr","time":143.365078616,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.02s/s]\n"}
,{"stream_name":"stdout","time":143.365086068,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":143.365111102,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":143.366696829,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.366993807,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.36700157799999,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.367005833,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.367009586,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.367196608,"data":"\n"}
,{"stream_name":"stdout","time":143.412696061,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":143.763215044,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":143.763244202,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.763249548,"data":"  Original dt: 4.617937e-01 s\n"}
,{"stream_name":"stdout","time":143.763253407,"data":"  Corrected dt: 2.886210e-01 s\n"}
,{"stream_name":"stdout","time":143.76325712,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.763261008,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":143.834193595,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":143.834213471,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":143.834219948,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":143.834452792,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.12s/s]\n"}
,{"stream_name":"stdout","time":143.834460013,"data":"\n"}
,{"stream_name":"stdout","time":143.834472461,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":143.834476573,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":143.836177702,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":143.836519918,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":143.836531807,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.836536217,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":143.836539995,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.83669734,"data":"\n"}
,{"stream_name":"stdout","time":143.863191706,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":144.316836753,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.316886478,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.316836758,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":144.317004863,"data":"\n"}
,{"stream_name":"stderr","time":144.317009927,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.24s/s]\n"}
,{"stream_name":"stdout","time":144.317014465,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":144.317038788,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":144.3186941,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.319100773,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.319112292,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.319117403,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.319121674,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.319313376,"data":"\n"}
,{"stream_name":"stdout","time":144.329251039,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":144.679559463,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":144.679590349,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.679595894,"data":"  Original dt: 4.617547e-01 s\n"}
,{"stream_name":"stdout","time":144.679600261,"data":"  Corrected dt: 2.885967e-01 s\n"}
,{"stream_name":"stdout","time":144.679603907,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.67960747,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":144.776903868,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":144.785747775,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":144.78575366,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.785800367,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":144.786116023,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.17s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.15s/s]\n"}
,{"stream_name":"stdout","time":144.786119288,"data":"\n"}
,{"stream_name":"stdout","time":144.78613875,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":144.786143602,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":144.787669028,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.787940446,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":144.787951373,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.787955736,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":144.787959858,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.788119983,"data":"\n"}
,{"stream_name":"stdout","time":145.222529244,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":145.249819442,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.249848275,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.24981944,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":145.249890691,"data":"\n"}
,{"stream_name":"stdout","time":145.249897784,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":145.249902025,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":145.249896852,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.50s/s]\n"}
,{"stream_name":"stdout","time":145.251600147,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.251779241,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.251790388,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.251795344,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.251799232,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.251975527,"data":"\n"}
,{"stream_name":"stdout","time":145.576857785,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":145.576885816,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.576892067,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":145.576896411,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":145.576900391,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.576904569,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":145.673754798,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":145.718852133,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":145.71888678,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.718905216,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.719089463,"data":"\n"}
,{"stream_name":"stdout","time":145.719104414,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":145.719123045,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":145.719091171,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.13s/s]\n"}
,{"stream_name":"stdout","time":145.720715083,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":145.720730265,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":145.720735088,"data":"\n"}
,{"stream_name":"stdout","time":145.720739116,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.720743778,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":145.720757786,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":145.720762329,"data":"\n"}
,{"stream_name":"stdout","time":145.720766289,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":145.720771082,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":145.728208066,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":145.728226441,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":145.728232261,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":145.728236718,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":145.728241218,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":145.728298333,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":145.728309903,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":145.728314081,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":145.728317898,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":145.728321561,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.72832533,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":145.728328915,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":145.728922288,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":145.728933159,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":145.729208072,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":145.72975095,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.72976155,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.729766033,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.731605105,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":145.731630291,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.731642103,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":145.731646161,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.731761926,"data":"\n"}
,{"stream_name":"stdout","time":146.1022158,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":146.102215801,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.102243554,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.102465515,"data":"\n"}
,{"stream_name":"stdout","time":146.102475462,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":146.102480385,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":146.102509621,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.49s/s]\n"}
,{"stream_name":"stdout","time":146.103964654,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.104298549,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.104308642,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.104313165,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.104317078,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.104503543,"data":"\n"}
,{"stream_name":"stdout","time":146.176005057,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":146.478758245,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":146.478787152,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.478792879,"data":"  Original dt: 4.649032e-01 s\n"}
,{"stream_name":"stdout","time":146.478797192,"data":"  Corrected dt: 2.905645e-01 s\n"}
,{"stream_name":"stdout","time":146.478801275,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.478805509,"data":"  Max wave speed detected: 17.21 m/s\n"}
,{"stream_name":"stdout","time":146.558559818,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":146.5585737,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.558583891,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.558823279,"data":"\n"}
,{"stream_name":"stdout","time":146.558831134,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":146.558835361,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":146.558832931,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.03s/s]\n"}
,{"stream_name":"stdout","time":146.560341308,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":146.560648343,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":146.560663492,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.560667649,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":146.560671328,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.560813781,"data":"\n"}
,{"stream_name":"stdout","time":146.621877639,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":147.019354978,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.019380667,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.019365959,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":147.019515781,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.72s/s]\n"}
,{"stream_name":"stdout","time":147.019538305,"data":"\n"}
,{"stream_name":"stdout","time":147.019550361,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":147.019554869,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":147.021186152,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.02140455,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.021412949,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.021417979,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.021422187,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.021587027,"data":"\n"}
,{"stream_name":"stdout","time":147.066667868,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":147.365118353,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":147.365141887,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.36514745,"data":"  Original dt: 4.618018e-01 s\n"}
,{"stream_name":"stdout","time":147.365152246,"data":"  Corrected dt: 2.886261e-01 s\n"}
,{"stream_name":"stdout","time":147.365156493,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.365160522,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":147.478341889,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":147.478341883,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.478387238,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.478521324,"data":"\n"}
,{"stream_name":"stdout","time":147.478537064,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":147.47854184,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":147.478521011,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.84s/s]\n"}
,{"stream_name":"stdout","time":147.480125927,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.48047108,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.48047998,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.48048497,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.480489282,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.480645773,"data":"\n"}
,{"stream_name":"stdout","time":147.507105639,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":147.939248583,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":147.93928416400001,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.939288935,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.939372719,"data":"\n"}
,{"stream_name":"stdout","time":147.939386269,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":147.939390611,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":147.939396459,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.72s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.71s/s]\n"}
,{"stream_name":"stdout","time":147.940982864,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.941176134,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":147.941190935,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.941195785,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":147.941199589,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.941353244,"data":"\n"}
,{"stream_name":"stdout","time":147.950112684,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.2507837,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":148.250802393,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.25080611,"data":"  Original dt: 4.617549e-01 s\n"}
,{"stream_name":"stdout","time":148.250808958,"data":"  Corrected dt: 2.885968e-01 s\n"}
,{"stream_name":"stdout","time":148.250811828,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.250827805,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":148.391196293,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":148.400155971,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":148.400185622,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.400200523,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":148.400340663,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.69s/s]\n"}
,{"stream_name":"stdout","time":148.400369324,"data":"\n"}
,{"stream_name":"stdout","time":148.400390866,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":148.400395663,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":148.401933076,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.402215445,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.402229922,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.402234488,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.402238436,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.402378452,"data":"\n"}
,{"stream_name":"stdout","time":148.854368198,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":148.881634532,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.881668119,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.881642751,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":148.881790312,"data":"\n"}
,{"stream_name":"stderr","time":148.88179595,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.30s/s]\n"}
,{"stream_name":"stdout","time":148.88180045,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":148.881809795,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":148.883419365,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.883614587,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":148.883630869,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.883636119,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":148.883640037,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.883781091,"data":"\n"}
,{"stream_name":"stdout","time":149.158403959,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":149.158425763,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.158431011,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":149.158435193,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":149.158439205,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.158444396,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":149.297980308,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":149.342170978,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.34219153,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.342173804,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":149.342373383,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.72s/s]\n"}
,{"stream_name":"stdout","time":149.342378274,"data":"\n"}
,{"stream_name":"stdout","time":149.342392375,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":149.342396844,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":149.344063419,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.344080256,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":149.344084811,"data":"\n"}
,{"stream_name":"stdout","time":149.344088582,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.344092566,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":149.344096701,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":149.344100659,"data":"\n"}
,{"stream_name":"stdout","time":149.344104205,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":149.344108291,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":149.351388072,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":149.351413786,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":149.351418227,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":149.351422058,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":149.351425705,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":149.351429286,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":149.351433087,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":149.351436394,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":149.351439715,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":149.35144329,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.351447185,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":149.351450876,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":149.35196709,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":149.351977363,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":149.352246025,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":149.352478866,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.352489196,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.352493672,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.354316986,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":149.354332574,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":149.354336979,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":149.354340546,"data":"|    ep_rew_mean      | 0.095    |\n"}
,{"stream_name":"stdout","time":149.354344207,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":149.354347926,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":149.354352044,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":149.354355476,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":149.354358986,"data":"|    time_elapsed     | 16       |\n"}
,{"stream_name":"stdout","time":149.354362576,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":149.354366197,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":149.35552134,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.355538199,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.355543864,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.355547939,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.355725203,"data":"\n"}
,{"stream_name":"stdout","time":149.725948218,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":149.725952605,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.725998345,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.726237193,"data":"\n"}
,{"stream_name":"stdout","time":149.726249289,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":149.72625439,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stderr","time":149.726277117,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.51s/s]\n"}
,{"stream_name":"stdout","time":149.727793491,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.728099633,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":149.728111829,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.728116473,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":149.728120786,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.728269881,"data":"\n"}
,{"stream_name":"stdout","time":149.799944948,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":150.056455288,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":150.056477678,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.056483088,"data":"  Original dt: 4.657469e-01 s\n"}
,{"stream_name":"stdout","time":150.056486772,"data":"  Corrected dt: 2.910918e-01 s\n"}
,{"stream_name":"stdout","time":150.056490308,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.05649465,"data":"  Max wave speed detected: 17.18 m/s\n"}
,{"stream_name":"stderr","time":150.179152479,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.179181468,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.179153223,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":150.179371227,"data":"\n"}
,{"stream_name":"stderr","time":150.179369228,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.27s/s]\n"}
,{"stream_name":"stdout","time":150.179380609,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":150.17939198,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":150.180894332,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.181200763,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.181223817,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.18122845,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.181232205,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.181375915,"data":"\n"}
,{"stream_name":"stdout","time":150.24410816,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":150.650323803,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":150.650352165,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.650362207,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":150.650613312,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.98s/s]\n"}
,{"stream_name":"stdout","time":150.65064638,"data":"\n"}
,{"stream_name":"stdout","time":150.650666312,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":150.650671235,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":150.652166735,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.652425781,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":150.652432307,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.652436465,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":150.652440226,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.652603015,"data":"\n"}
,{"stream_name":"stdout","time":150.696077458,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":150.970813509,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":150.970839304,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.970843094,"data":"  Original dt: 4.618121e-01 s\n"}
,{"stream_name":"stdout","time":150.970845687,"data":"  Corrected dt: 2.886326e-01 s\n"}
,{"stream_name":"stdout","time":150.970848061,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.970850599,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":151.12838865,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":151.128394059,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.128432267,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.128679397,"data":"\n"}
,{"stream_name":"stdout","time":151.128687658,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":151.128691814,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":151.1286796,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.53s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.52s/s]\n"}
,{"stream_name":"stdout","time":151.130279639,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.13070106,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.13071076,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.130715163,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.130719145,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.130873758,"data":"\n"}
,{"stream_name":"stdout","time":151.157735975,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":151.583340411,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":151.583349793,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.583377247,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":151.583645118,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.16s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.15s/s]\n"}
,{"stream_name":"stdout","time":151.583634262,"data":"\n"}
,{"stream_name":"stdout","time":151.583673066,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":151.583677756,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":151.585130696,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.58547578,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":151.585484399,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.58548908,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":151.58549362,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.585658608,"data":"\n"}
,{"stream_name":"stdout","time":151.594334144,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":151.848882835,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":151.848906258,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.848911467,"data":"  Original dt: 4.617553e-01 s\n"}
,{"stream_name":"stdout","time":151.848915373,"data":"  Corrected dt: 2.885970e-01 s\n"}
,{"stream_name":"stdout","time":151.84891897,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.848922749,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":152.034595666,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":152.044085652,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":152.044124184,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.04414102,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.044404272,"data":"\n"}
,{"stream_name":"stdout","time":152.044412883,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":152.044418039,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":152.044439176,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.71s/s]\n"}
,{"stream_name":"stdout","time":152.046080973,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.04638677,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.046398176,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.046402847,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.046415152,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.046563352,"data":"\n"}
,{"stream_name":"stdout","time":152.477536143,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":152.50392183,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":152.503920703,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.503951163,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.504082125,"data":"\n"}
,{"stream_name":"stdout","time":152.504098365,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":152.504103535,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":152.504083703,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.81s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.80s/s]\n"}
,{"stream_name":"stdout","time":152.50561957,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.505931397,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":152.505939404,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.505943654,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":152.505947454,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.506153186,"data":"\n"}
,{"stream_name":"stdout","time":152.750466875,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":152.750493478,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.750497314,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":152.750499962,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":152.750505434,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.75050935,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":152.95022883,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":152.994293815,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.99431364,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":152.994320706,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":152.994590071,"data":"\n"}
,{"stream_name":"stdout","time":152.994597911,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":152.994602667,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":152.994624355,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.72s/s]\n"}
,{"stream_name":"stdout","time":152.996179358,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.996193127,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":152.996267541,"data":"\n"}
,{"stream_name":"stdout","time":152.996278554,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.996283756,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":152.996287898,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":152.996292113,"data":"\n"}
,{"stream_name":"stdout","time":152.996295845,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":152.996300001,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":153.004549107,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":153.004566229,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":153.004571382,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":153.004575978,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":153.004608065,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":153.004735289,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":153.004742084,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":153.004765748,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":153.004779303,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":153.004783764,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.004827156,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":153.004832758,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":153.005472384,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":153.00548559,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":153.00577051,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":153.0060202,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.006045596,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.006050706,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.007847646,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.00785874,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.00786311,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.007866829,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.008033851,"data":"\n"}
,{"stream_name":"stderr","time":153.375391984,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.375415628,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.375467595,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":153.375727255,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.83s/s]\n"}
,{"stream_name":"stdout","time":153.375730068,"data":"\n"}
,{"stream_name":"stdout","time":153.375746328,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":153.375750444,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":153.37736271,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.377645785,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.377653738,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.37765794,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.377662243,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.377814465,"data":"\n"}
,{"stream_name":"stdout","time":153.448846053,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":153.687674067,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":153.687696475,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.68770179,"data":"  Original dt: 4.667575e-01 s\n"}
,{"stream_name":"stdout","time":153.687706138,"data":"  Corrected dt: 2.917234e-01 s\n"}
,{"stream_name":"stdout","time":153.687710554,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.68771466,"data":"  Max wave speed detected: 17.14 m/s\n"}
,{"stream_name":"stderr","time":153.854598749,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.85462389,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.854598747,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":153.854844981,"data":"\n"}
,{"stream_name":"stdout","time":153.854855344,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":153.854859831,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":153.854880663,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.46s/s]\n"}
,{"stream_name":"stdout","time":153.856435985,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.856750866,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":153.856757937,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.856762078,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":153.856765947,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.856930709,"data":"\n"}
,{"stream_name":"stdout","time":153.919513085,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":154.317157781,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.31719154500001,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.317167194,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":154.317264385,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.60s/s]\n"}
,{"stream_name":"stdout","time":154.317291062,"data":"\n"}
,{"stream_name":"stdout","time":154.317296184,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":154.317300329,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":154.318811823,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":154.319101963,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.319116798,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.319121145,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.319125286,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.319271204,"data":"\n"}
,{"stream_name":"stdout","time":154.362754305,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":154.575827164,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":154.575849265,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.575854605,"data":"  Original dt: 4.618253e-01 s\n"}
,{"stream_name":"stdout","time":154.575858769,"data":"  Corrected dt: 2.886408e-01 s\n"}
,{"stream_name":"stdout","time":154.575862756,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.575867226,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":154.777081514,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":154.777109301,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.777125579,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.777366767,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.76s/s]\n"}
,{"stream_name":"stdout","time":154.777379445,"data":"\n"}
,{"stream_name":"stdout","time":154.777390772,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":154.777395187,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":154.778966302,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.779361811,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":154.779378125,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":154.779382936,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":154.779387228,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.779533123,"data":"\n"}
,{"stream_name":"stdout","time":154.805788072,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":155.237667488,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.237690828,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.237674384,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":155.237775554,"data":"\n"}
,{"stream_name":"stdout","time":155.237795474,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":155.237800432,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":155.237774868,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.75s/s]\n"}
,{"stream_name":"stdout","time":155.239452994,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":155.23962796,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.239636528,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.239641468,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.239645755,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.239827823,"data":"\n"}
,{"stream_name":"stdout","time":155.248938644,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":155.460443158,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":155.460466878,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.460471097,"data":"  Original dt: 4.617556e-01 s\n"}
,{"stream_name":"stdout","time":155.460473663,"data":"  Corrected dt: 2.885973e-01 s\n"}
,{"stream_name":"stdout","time":155.460476473,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.460478895,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":155.689460612,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":155.698791792,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":155.69879553,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.698818229,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.698946717,"data":"\n"}
,{"stream_name":"stdout","time":155.698957919,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stderr","time":155.698953664,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.69s/s]\n"}
,{"stream_name":"stdout","time":155.698962101,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":155.700494868,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.700775498,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":155.700786185,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.700790821,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":155.700809625,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.700939808,"data":"\n"}
,{"stream_name":"stdout","time":156.127570137,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":156.154198164,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.154220884,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.154198236,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":156.15446566,"data":"\n"}
,{"stream_name":"stderr","time":156.154466502,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.09s/s]\n"}
,{"stream_name":"stdout","time":156.154473069,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":156.154482672,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":156.15597616,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.156276154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.156286518,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.1562906,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.156296984,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.156457848,"data":"\n"}
,{"stream_name":"stdout","time":156.339758275,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":156.339779944,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.339784725,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":156.339788575,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":156.339792262,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.339795826,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":156.565830161,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":156.609316799,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":156.60932209999999,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.60934344,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":156.609458338,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.13s/s]\n"}
,{"stream_name":"stdout","time":156.609486563,"data":"\n"}
,{"stream_name":"stdout","time":156.609496111,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":156.609500133,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":156.611077775,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.611096331,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":156.611099933,"data":"\n"}
,{"stream_name":"stdout","time":156.611102422,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.611104923,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":156.611107372,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":156.611109875,"data":"\n"}
,{"stream_name":"stdout","time":156.611112193,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":156.611114772,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":156.618168345,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":156.618185273,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":156.618190429,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":156.618198688,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":156.618202858,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":156.618206991,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":156.618211301,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":156.618215371,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":156.618260033,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":156.618266929,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.618271358,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":156.618275493,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":156.618872681,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":156.618879296,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":156.619203816,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":156.619420694,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.619427171,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.619432024,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.621203773,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.6212143,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":156.621219222,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.621236412,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.621353358,"data":"\n"}
,{"stream_name":"stdout","time":156.988589781,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":156.988608897,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.988618843,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.988878423,"data":"\n"}
,{"stream_name":"stderr","time":156.988875515,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.84s/s]\n"}
,{"stream_name":"stdout","time":156.98888795,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":156.988903651,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":156.99032716,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.99061581,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":156.990623977,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.990628187,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":156.990632571,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.990782623,"data":"\n"}
,{"stream_name":"stdout","time":157.061697086,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":157.229204026,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":157.22922668,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.229232444,"data":"  Original dt: 4.680303e-01 s\n"}
,{"stream_name":"stdout","time":157.229236736,"data":"  Corrected dt: 2.925189e-01 s\n"}
,{"stream_name":"stdout","time":157.229241578,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.229245409,"data":"  Max wave speed detected: 17.09 m/s\n"}
,{"stream_name":"stdout","time":157.438385605,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":157.438387751,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.438426549,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.438655898,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.52s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.51s/s]\n"}
,{"stream_name":"stdout","time":157.438674387,"data":"\n"}
,{"stream_name":"stdout","time":157.438682246,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":157.438686919,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":157.440322423,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":157.459644567,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":157.459720882,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.459729494,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.459734524,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.459739984,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.459933382,"data":"\n"}
,{"stream_name":"stdout","time":157.521138112,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":157.915911757,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":157.915919806,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.915949112,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":157.916238005,"data":"\n"}
,{"stream_name":"stderr","time":157.916244601,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.89s/s]\n"}
,{"stream_name":"stdout","time":157.916252917,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":157.916289819,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":157.917872209,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.918141423,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":157.918156158,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":157.918161253,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":157.918164984,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.918322567,"data":"\n"}
,{"stream_name":"stdout","time":157.962591267,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":158.130681945,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":158.130708883,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.13071374,"data":"  Original dt: 4.618406e-01 s\n"}
,{"stream_name":"stdout","time":158.130718196,"data":"  Corrected dt: 2.886504e-01 s\n"}
,{"stream_name":"stdout","time":158.130726248,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.130730541,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":158.377897232,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":158.377927115,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.377948864,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":158.378226538,"data":"\n"}
,{"stream_name":"stdout","time":158.378240526,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":158.37824473,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":158.378240475,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.63s/s]\n"}
,{"stream_name":"stdout","time":158.379802577,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.380262507,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.38027356,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.380278801,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.380283307,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.38041391,"data":"\n"}
,{"stream_name":"stdout","time":158.407077363,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":158.861597583,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":158.861596186,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.861647932,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.861679949,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.19s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.18s/s]\n"}
,{"stream_name":"stdout","time":158.861717791,"data":"\n"}
,{"stream_name":"stdout","time":158.861725392,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":158.861730267,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":158.863372512,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.863523004,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":158.863535474,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":158.863540114,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":158.863544066,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.863701539,"data":"\n"}
,{"stream_name":"stdout","time":158.873090531,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":159.042994051,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":159.043046397,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.043055578,"data":"  Original dt: 4.617560e-01 s\n"}
,{"stream_name":"stdout","time":159.043060221,"data":"  Corrected dt: 2.885975e-01 s\n"}
,{"stream_name":"stdout","time":159.043064165,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.043068319,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":159.314982343,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":159.323868815,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":159.32390346,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.323917886,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.324048834,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.60s/s]\n"}
,{"stream_name":"stdout","time":159.324072447,"data":"\n"}
,{"stream_name":"stdout","time":159.324080031,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":159.324084618,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":159.325741667,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.32613467,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.32614697,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.326151936,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.326156342,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.326318947,"data":"\n"}
,{"stream_name":"stdout","time":159.75720035,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":159.784464465,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":159.784479402,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.78448859,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":159.784804341,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.75s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.73s/s]\n"}
,{"stream_name":"stdout","time":159.784818194,"data":"\n"}
,{"stream_name":"stdout","time":159.784822674,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":159.784827126,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":159.786416554,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.786731262,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":159.78675178700001,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.786755968,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":159.786759625,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.786904057,"data":"\n"}
,{"stream_name":"stdout","time":159.929380266,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":159.929400461,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.929407581,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":159.929410524,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":159.929413652,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.929416265,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":160.205597699,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":160.249528063,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":160.249546389,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.249555785,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.24983031,"data":"\n"}
,{"stream_name":"stdout","time":160.249838862,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":160.249843584,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":160.249857309,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.43s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.42s/s]\n"}
,{"stream_name":"stdout","time":160.251425135,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":160.251439669,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":160.251497583,"data":"\n"}
,{"stream_name":"stdout","time":160.251503393,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.251507768,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":160.251512161,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":160.251516781,"data":"\n"}
,{"stream_name":"stdout","time":160.251520366,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":160.251524544,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":160.258532824,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":160.258545511,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":160.258550306,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":160.258569381,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":160.258576206,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":160.258722482,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":160.258729618,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":160.258733557,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":160.25873884,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":160.258742038,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.258750497,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":160.258753135,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":160.259371637,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":160.259383615,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":160.2596428,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":160.260264744,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.260275787,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.260281067,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.262113889,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.262126555,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.262131176,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.262135683,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.262261691,"data":"\n"}
,{"stream_name":"stderr","time":160.637872428,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.637897276,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.637875131,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":160.638287753,"data":"\n"}
,{"stream_name":"stdout","time":160.63830261,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":160.638307105,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":160.638285981,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.94s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.92s/s]\n"}
,{"stream_name":"stdout","time":160.639938771,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.640266913,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":160.640286964,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.640291613,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":160.640295413,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.640438946,"data":"\n"}
,{"stream_name":"stdout","time":160.710585705,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":160.855425806,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":160.855445864,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.855450608,"data":"  Original dt: 4.697057e-01 s\n"}
,{"stream_name":"stdout","time":160.855454724,"data":"  Corrected dt: 2.935661e-01 s\n"}
,{"stream_name":"stdout","time":160.855460657,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.855464164,"data":"  Max wave speed detected: 17.03 m/s\n"}
,{"stream_name":"stderr","time":161.110093805,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.11011983,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.110097546,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":161.110267291,"data":"\n"}
,{"stream_name":"stdout","time":161.110279005,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":161.110283741,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":161.110297205,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.94s/s]\n"}
,{"stream_name":"stdout","time":161.111774745,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.112059469,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.112070601,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.112075534,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.112080352,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.112253664,"data":"\n"}
,{"stream_name":"stdout","time":161.173157383,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":161.570396775,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.570421131,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.570445242,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":161.570533471,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.76s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.75s/s]\n"}
,{"stream_name":"stdout","time":161.570539335,"data":"\n"}
,{"stream_name":"stdout","time":161.570571793,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":161.570577268,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":161.572112557,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.572320783,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":161.572331435,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.572335961,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":161.572339712,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.572490038,"data":"\n"}
,{"stream_name":"stdout","time":161.617850747,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":161.741888921,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":161.7419076,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.741912386,"data":"  Original dt: 4.618586e-01 s\n"}
,{"stream_name":"stdout","time":161.741916108,"data":"  Corrected dt: 2.886616e-01 s\n"}
,{"stream_name":"stdout","time":161.741921646,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.741924565,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stderr","time":162.032444624,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.032464688,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.032477838,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stdout","time":162.032749902,"data":"\n"}
,{"stream_name":"stdout","time":162.032758526,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":162.032763524,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":162.032770528,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.60s/s]\n"}
,{"stream_name":"stdout","time":162.034383277,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":162.034788058,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.03479641,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.03480038,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.034806043,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.034979408,"data":"\n"}
,{"stream_name":"stdout","time":162.062538248,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":162.49996915,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":162.499996002,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":162.500007636,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.500063894,"data":"\n"}
,{"stream_name":"stdout","time":162.500073234,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":162.500077835,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":162.500118966,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.27s/s]\n"}
,{"stream_name":"stdout","time":162.501647545,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":162.501929916,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.501941081,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.501945657,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.501949342,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.502092365,"data":"\n"}
,{"stream_name":"stdout","time":162.511711121,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":162.636279556,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":162.636295931,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.63630098,"data":"  Original dt: 4.617565e-01 s\n"}
,{"stream_name":"stdout","time":162.636305755,"data":"  Corrected dt: 2.885978e-01 s\n"}
,{"stream_name":"stdout","time":162.636309705,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.636313644,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":162.952786173,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":162.961699743,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":162.96173229,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.961741803,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.961882891,"data":"\n"}
,{"stream_name":"stdout","time":162.961891406,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":162.961896341,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":162.961891936,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.64s/s]\n"}
,{"stream_name":"stdout","time":162.963480126,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.963774862,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":162.963781465,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.963785436,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":162.963789231,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.963952848,"data":"\n"}
,{"stream_name":"stdout","time":163.394735198,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":163.422829341,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":163.422829116,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.422858108,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.422990787,"data":"\n"}
,{"stream_name":"stdout","time":163.422998004,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":163.423002356,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":163.423015354,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.70s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.69s/s]\n"}
,{"stream_name":"stdout","time":163.424560257,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.424878637,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.424887277,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.424892026,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.424896363,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.425075222,"data":"\n"}
,{"stream_name":"stdout","time":163.528816756,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":163.528840969,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.528846995,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":163.52885132,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":163.528856097,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.528859874,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":163.854843924,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":163.898709264,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.898732362,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.898722354,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":163.898850394,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.68s/s]\n"}
,{"stream_name":"stdout","time":163.898854564,"data":"\n"}
,{"stream_name":"stdout","time":163.898893059,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":163.898897959,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":163.90048684,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.900503051,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":163.900507626,"data":"\n"}
,{"stream_name":"stdout","time":163.900511582,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":163.900515487,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.09 | Avg Reward/Step: 0.011\n"}
,{"stream_name":"stdout","time":163.900519382,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":163.900523206,"data":"\n"}
,{"stream_name":"stdout","time":163.900526729,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":163.900530509,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":163.907677307,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":163.907692344,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":163.907696919,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":163.907700766,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":163.907704256,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":163.907816929,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":163.907830946,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":163.907835915,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":163.907840329,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":163.907844335,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.90786371,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":163.907870121,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":163.908454048,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":163.908469309,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":163.908690333,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":163.908912765,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.908922826,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.908927304,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.910701792,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":163.91071711,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":163.91072135,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":163.910725105,"data":"|    ep_rew_mean      | 0.101    |\n"}
,{"stream_name":"stdout","time":163.910728577,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":163.910731942,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":163.910735756,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":163.910739572,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":163.910742954,"data":"|    time_elapsed     | 31       |\n"}
,{"stream_name":"stdout","time":163.910746546,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":163.910750295,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":163.911772334,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":163.911787278,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.911792249,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":163.911796268,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.91191285,"data":"\n"}
,{"stream_name":"stdout","time":164.278182244,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":164.278212056,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.278221525,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":164.278293944,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.96s/s]\n"}
,{"stream_name":"stdout","time":164.278309179,"data":"\n"}
,{"stream_name":"stdout","time":164.278336552,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":164.278341318,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":164.27982751,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.280133608,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.280144278,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.280148535,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.280152334,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.280294921,"data":"\n"}
,{"stream_name":"stdout","time":164.349996815,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":164.429506406,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":164.4295441,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.429550448,"data":"  Original dt: 4.719124e-01 s\n"}
,{"stream_name":"stdout","time":164.429554863,"data":"  Corrected dt: 2.949452e-01 s\n"}
,{"stream_name":"stdout","time":164.429558586,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.429562091,"data":"  Max wave speed detected: 16.95 m/s\n"}
,{"stream_name":"stdout","time":164.725928915,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":164.725978173,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.725993515,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.726239051,"data":"\n"}
,{"stream_name":"stdout","time":164.72625712,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":164.726261661,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":164.72624048,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.66s/s]\n"}
,{"stream_name":"stdout","time":164.727800317,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":164.728083095,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":164.72809826,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.728103616,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":164.72810746,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.72825563,"data":"\n"}
,{"stream_name":"stdout","time":164.789095237,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":165.181992118,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.182021075,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.181993547,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":165.182194998,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.06s/s]\n"}
,{"stream_name":"stdout","time":165.182200269,"data":"\n"}
,{"stream_name":"stdout","time":165.182216128,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":165.18222041799999,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":165.183740971,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.184058227,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.184080986,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.184085342,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.184089028,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.184233867,"data":"\n"}
,{"stream_name":"stdout","time":165.227896563,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":165.307321335,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":165.307341477,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.307346861,"data":"  Original dt: 4.618816e-01 s\n"}
,{"stream_name":"stdout","time":165.307351127,"data":"  Corrected dt: 2.886760e-01 s\n"}
,{"stream_name":"stdout","time":165.307355269,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.30735932,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":165.638499394,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":165.63851263,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.63853486,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":165.638734259,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.03s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.02s/s]\n"}
,{"stream_name":"stdout","time":165.638738298,"data":"\n"}
,{"stream_name":"stdout","time":165.638760523,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":165.638766616,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":165.640319141,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":165.640649136,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":165.640668829,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.640675903,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":165.640682229,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.640813602,"data":"\n"}
,{"stream_name":"stdout","time":165.666826899,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":166.092803849,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.092833359,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.092808695,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":166.092918236,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.19s/s]\n"}
,{"stream_name":"stdout","time":166.09293456,"data":"\n"}
,{"stream_name":"stdout","time":166.092962794,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":166.092968004,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":166.09447077,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.09474838,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.094759163,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.094764059,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.094768763,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.094913171,"data":"\n"}
,{"stream_name":"stdout","time":166.104373066,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":166.182853062,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":166.182868595,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.182873109,"data":"  Original dt: 4.617570e-01 s\n"}
,{"stream_name":"stdout","time":166.182877125,"data":"  Corrected dt: 2.885981e-01 s\n"}
,{"stream_name":"stdout","time":166.182880785,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.182884781,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":166.539506209,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":166.548706468,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.548732332,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.548711189,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":166.548825691,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 33.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 33.06s/s]\n"}
,{"stream_name":"stdout","time":166.548853307,"data":"\n"}
,{"stream_name":"stdout","time":166.548860759,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":166.548864727,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":166.550382199,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":166.550675075,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":166.550685701,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.550690476,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":166.550694241,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.550808347,"data":"\n"}
,{"stream_name":"stdout","time":166.975663213,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":167.002056443,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":167.002068266,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.002084552,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.002214971,"data":"\n"}
,{"stream_name":"stdout","time":167.002224403,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":167.002229448,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":167.00223947,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.25s/s]\n"}
,{"stream_name":"stdout","time":167.003758549,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":167.004048383,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.004063409,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.004068369,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.00407219,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.004209193,"data":"\n"}
,{"stream_name":"stdout","time":167.058715635,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":167.058733701,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.058739137,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":167.058743178,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":167.058747027,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.058751695,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":167.415917274,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":167.460329011,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.460348651,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.460331058,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":167.460498149,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 32.89s/s]\n"}
,{"stream_name":"stdout","time":167.460564265,"data":"\n"}
,{"stream_name":"stdout","time":167.460578656,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":167.46058313,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":167.462064108,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.462093178,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":167.462097722,"data":"\n"}
,{"stream_name":"stdout","time":167.462101291,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":167.462104907,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":167.462108694,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":167.462112662,"data":"\n"}
,{"stream_name":"stdout","time":167.462116143,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":167.462119683,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":167.468990594,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":167.469005898,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":167.469010518,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":167.469014588,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":167.469018465,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":167.469147691,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":167.469160133,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":167.469163987,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":167.469167546,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":167.469170957,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.469195365,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":167.469206776,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":167.469754837,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":167.469765852,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":167.469974102,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":167.470199988,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.470214073,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.470218513,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.471952351,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.471967916,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.471972626,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.471976743,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.472125376,"data":"\n"}
,{"stream_name":"stderr","time":167.838348043,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.838374043,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":167.838350688,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":167.838502158,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.97s/s]\n"}
,{"stream_name":"stdout","time":167.838506833,"data":"\n"}
,{"stream_name":"stdout","time":167.838519976,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":167.838524118,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":167.840132317,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.840288734,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":167.840298199,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.840302346,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":167.840306191,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.84050406,"data":"\n"}
,{"stream_name":"stdout","time":167.911506298,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":167.946954916,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":167.946972488,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.94697757,"data":"  Original dt: 4.747258e-01 s\n"}
,{"stream_name":"stdout","time":167.946983275,"data":"  Corrected dt: 2.967036e-01 s\n"}
,{"stream_name":"stdout","time":167.946985919,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.946988756,"data":"  Max wave speed detected: 16.85 m/s\n"}
,{"stream_name":"stdout","time":168.289850379,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":168.289851397,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.289891407,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.2900837,"data":"\n"}
,{"stream_name":"stdout","time":168.29009722199999,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":168.290102504,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":168.290083706,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.40s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.38s/s]\n"}
,{"stream_name":"stdout","time":168.291674747,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.291973711,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.292002834,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":168.292008887,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.292013642,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.292163197,"data":"\n"}
,{"stream_name":"stdout","time":168.354102501,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":168.760906388,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.760952971,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.760906391,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":168.761073436,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.00s/s]\n"}
,{"stream_name":"stdout","time":168.761116907,"data":"\n"}
,{"stream_name":"stdout","time":168.761130149,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":168.76113473,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":168.762635628,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.762948885,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":168.76295617,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.762960698,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":168.762965149,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.763137193,"data":"\n"}
,{"stream_name":"stdout","time":168.807040127,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":168.843271268,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":168.843291893,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.843297918,"data":"  Original dt: 4.619107e-01 s\n"}
,{"stream_name":"stdout","time":168.84330169,"data":"  Corrected dt: 2.886942e-01 s\n"}
,{"stream_name":"stdout","time":168.843305767,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.843310012,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":169.224839888,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":169.224846946,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.224868631,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.225001598,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.49s/s]\n"}
,{"stream_name":"stdout","time":169.225062456,"data":"\n"}
,{"stream_name":"stdout","time":169.225077751,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":169.225081744,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":169.226557602,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":169.22695121,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.226963133,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.226968031,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.226972046,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.22713442,"data":"\n"}
,{"stream_name":"stdout","time":169.252863502,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":169.681021461,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":169.681053956,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":169.681062221,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.681153249,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.05s/s]\n"}
,{"stream_name":"stdout","time":169.681169235,"data":"\n"}
,{"stream_name":"stdout","time":169.681173389,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":169.681177191,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":169.682783908,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.683099792,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":169.683110583,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.683113782,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":169.683116501,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.683300852,"data":"\n"}
,{"stream_name":"stdout","time":169.692884292,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":169.728347002,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":169.728364193,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.728369047,"data":"  Original dt: 4.617577e-01 s\n"}
,{"stream_name":"stdout","time":169.728372952,"data":"  Corrected dt: 2.885985e-01 s\n"}
,{"stream_name":"stdout","time":169.728376835,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.728390148,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":170.130139291,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":170.139292239,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.139309669,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.139293226,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":170.139423562,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.90s/s]\n"}
,{"stream_name":"stdout","time":170.139454438,"data":"\n"}
,{"stream_name":"stdout","time":170.139467264,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":170.139471621,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":170.141151582,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.141353403,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.141361939,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.141366174,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.141370064,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.141540677,"data":"\n"}
,{"stream_name":"stdout","time":170.568962766,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":170.595340166,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":170.595363988,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.595373729,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.595602954,"data":"\n"}
,{"stream_name":"stdout","time":170.595610563,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":170.595615183,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":170.59561978,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 33.05s/s]\n"}
,{"stream_name":"stdout","time":170.597370154,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.597719981,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":170.597727882,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":170.597732594,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":170.597747029,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.59792358,"data":"\n"}
,{"stream_name":"stdout","time":170.607995759,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":170.608010862,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.608015605,"data":"  Original dt: 4.617534e-01 s\n"}
,{"stream_name":"stdout","time":170.608019145,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":170.608022712,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.608111675,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":171.029727136,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":171.074371083,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":171.07436944,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.074396657,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.074666588,"data":"\n"}
,{"stream_name":"stdout","time":171.074678994,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":171.074683386,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":171.074686325,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.48s/s]\n"}
,{"stream_name":"stdout","time":171.076212535,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":171.076227671,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":171.076232394,"data":"\n"}
,{"stream_name":"stdout","time":171.076236391,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.076240849,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":171.076245339,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":171.076249968,"data":"\n"}
,{"stream_name":"stdout","time":171.076254295,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":171.076259686,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":171.083256516,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":171.083275093,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":171.083280273,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":171.083284565,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":171.083288542,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":171.083336025,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":171.083358097,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":171.083362875,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":171.083397958,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":171.083403782,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.083415693,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":171.083419245,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":171.083975083,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":171.083981003,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":171.084233043,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":171.084487223,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.08449445,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.084499258,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.086280829,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.086291913,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":171.086296667,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.086301235,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.086441537,"data":"\n"}
,{"stream_name":"stdout","time":171.44946599,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":171.449490923,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.449506653,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.449758926,"data":"\n"}
,{"stream_name":"stderr","time":171.449755998,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 41.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 41.31s/s]\n"}
,{"stream_name":"stdout","time":171.449766701,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":171.449774722,"data":"Total runtime: 0.36 seconds.\n"}
,{"stream_name":"stdout","time":171.451362783,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":171.45159428,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.451602837,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.45160772,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.451612242,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.451769328,"data":"\n"}
,{"stream_name":"stdout","time":171.513843067,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":171.513861099,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.513866666,"data":"  Original dt: 4.782068e-01 s\n"}
,{"stream_name":"stdout","time":171.513870841,"data":"  Corrected dt: 2.988793e-01 s\n"}
,{"stream_name":"stdout","time":171.513874801,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.5138792,"data":"  Max wave speed detected: 16.73 m/s\n"}
,{"stream_name":"stdout","time":171.521576671,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stderr","time":171.899628085,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.899669486,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.899628087,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":171.899852482,"data":"\n"}
,{"stream_name":"stdout","time":171.899860913,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":171.899865482,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":171.899900344,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.49s/s]\n"}
,{"stream_name":"stdout","time":171.901546559,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":171.901828179,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":171.901835793,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.901840111,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":171.901844053,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.901992099,"data":"\n"}
,{"stream_name":"stdout","time":171.963468541,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stderr","time":172.356225673,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.356251007,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.356259346,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":172.356406711,"data":"\n"}
,{"stream_name":"stdout","time":172.356428718,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":172.356434425,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":172.356413184,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.04s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.03s/s]\n"}
,{"stream_name":"stdout","time":172.358126177,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":172.358360766,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.358369683,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.35837471,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.358379305,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.358540548,"data":"\n"}
,{"stream_name":"stdout","time":172.395289198,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":172.395308064,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.39531352,"data":"  Original dt: 4.619479e-01 s\n"}
,{"stream_name":"stdout","time":172.395317796,"data":"  Corrected dt: 2.887174e-01 s\n"}
,{"stream_name":"stdout","time":172.395321804,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.395325356,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":172.403500198,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":172.833919803,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":172.83392419,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.833956323,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.834160989,"data":"\n"}
,{"stream_name":"stdout","time":172.834180152,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":172.83418566,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":172.834194988,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.55s/s]\n"}
,{"stream_name":"stdout","time":172.835709413,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":172.836087125,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":172.836103013,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":172.836107998,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":172.836112401,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.836263279,"data":"\n"}
,{"stream_name":"stdout","time":172.86264244,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":173.289755877,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.28978129,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.289762175,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":173.289876747,"data":"\n"}
,{"stream_name":"stderr","time":173.28988042,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.09s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 33.08s/s]\n"}
,{"stream_name":"stdout","time":173.289888128,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":173.289896293,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":173.291482317,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.291688523,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.291697109,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.291701988,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.291706488,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.291869023,"data":"\n"}
,{"stream_name":"stdout","time":173.29291107,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":173.292925386,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.292929872,"data":"  Original dt: 4.617584e-01 s\n"}
,{"stream_name":"stdout","time":173.292933431,"data":"  Corrected dt: 2.885990e-01 s\n"}
,{"stream_name":"stdout","time":173.292937039,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.29294253,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":173.300615048,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":173.742649617,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":173.751878501,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.751899529,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.751881431,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":173.752064411,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.62s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.61s/s]\n"}
,{"stream_name":"stdout","time":173.752084956,"data":"\n"}
,{"stream_name":"stdout","time":173.752089583,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":173.752094093,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":173.753720619,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":173.754008049,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":173.754015481,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.754051352,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":173.754059584,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.754194086,"data":"\n"}
,{"stream_name":"stdout","time":174.175206956,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":174.175231564,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.175237334,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":174.175241992,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":174.175246399,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.175255855,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":174.184841885,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":174.211864787,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":174.211892809,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.211909241,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.212180671,"data":"\n"}
,{"stream_name":"stdout","time":174.212195809,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":174.21220121,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":174.212183665,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.78s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.77s/s]\n"}
,{"stream_name":"stdout","time":174.213787199,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.214067703,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.214080472,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.214085709,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.214089774,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.214262298,"data":"\n"}
,{"stream_name":"stdout","time":174.625106282,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stderr","time":174.668851517,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.668874693,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.668851939,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":174.669020171,"data":"\n"}
,{"stream_name":"stdout","time":174.669056151,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":174.669061576,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":174.669021712,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.00s/s]\n"}
,{"stream_name":"stdout","time":174.670557193,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":174.670573805,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":174.67057868,"data":"\n"}
,{"stream_name":"stdout","time":174.670582742,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":174.670586647,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":174.67059061,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":174.670594804,"data":"\n"}
,{"stream_name":"stdout","time":174.670598509,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":174.670602691,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":174.677595072,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":174.677611978,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":174.677617652,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":174.677622091,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":174.677626559,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":174.677730026,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":174.677737469,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":174.677741391,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":174.677745319,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":174.677749421,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.677753944,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":174.677758048,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":174.678377395,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":174.678392663,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":174.678613248,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":174.678812941,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.67882274,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.678827324,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.680626238,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":174.680647618,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.680662005,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":174.680666577,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.680767964,"data":"\n"}
,{"stream_name":"stdout","time":175.047859253,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":175.047890652,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.047896945,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.048075656,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.86s/s]\n"}
,{"stream_name":"stdout","time":175.048104441,"data":"\n"}
,{"stream_name":"stdout","time":175.048113774,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":175.048117799,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":175.049693608,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.049960832,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.049968241,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.049972336,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.049976249,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.050150442,"data":"\n"}
,{"stream_name":"stdout","time":175.069545735,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":175.069562589,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.069567339,"data":"  Original dt: 4.828960e-01 s\n"}
,{"stream_name":"stdout","time":175.069573195,"data":"  Corrected dt: 3.018100e-01 s\n"}
,{"stream_name":"stdout","time":175.069576969,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.069579525,"data":"  Max wave speed detected: 16.57 m/s\n"}
,{"stream_name":"stdout","time":175.120703846,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":175.496929027,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stderr","time":175.496929617,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.496956442,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":175.497060456,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.58s/s]\n"}
,{"stream_name":"stdout","time":175.497061021,"data":"\n"}
,{"stream_name":"stdout","time":175.49707583,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":175.497080414,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":175.498573788,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.498870965,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.498878685,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.498882732,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.498886785,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.499044613,"data":"\n"}
,{"stream_name":"stdout","time":175.560154004,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":175.94328934,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":175.943313604,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.94331833,"data":"  Original dt: 4.619895e-01 s\n"}
,{"stream_name":"stdout","time":175.943323796,"data":"  Corrected dt: 2.887434e-01 s\n"}
,{"stream_name":"stdout","time":175.943327946,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.943332048,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":175.951699262,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stderr","time":175.951709844,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.951725129,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.952052173,"data":"\n"}
,{"stream_name":"stdout","time":175.952068228,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":175.952073412,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":175.952077516,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.15s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.13s/s]\n"}
,{"stream_name":"stdout","time":175.953634515,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":175.953897311,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":175.953908081,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":175.953913226,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":175.953917132,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.954061015,"data":"\n"}
,{"stream_name":"stdout","time":175.998109241,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":176.406111558,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":176.406180526,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":176.406216751,"data":"\n"}
,{"stream_name":"stderr","time":176.406218216,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.40622541,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stderr","time":176.406229796,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.20s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.19s/s]\n"}
,{"stream_name":"stdout","time":176.406233611,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":176.40795673,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":176.408393607,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.408404624,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.408408929,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.408412893,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.408575947,"data":"\n"}
,{"stream_name":"stdout","time":176.435217648,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":176.824370069,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":176.824398207,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.824404507,"data":"  Original dt: 4.617593e-01 s\n"}
,{"stream_name":"stdout","time":176.82440854,"data":"  Corrected dt: 2.885996e-01 s\n"}
,{"stream_name":"stdout","time":176.824412661,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.824417004,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stderr","time":176.870129108,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.870154001,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.870154519,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stderr","time":176.870332353,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 32.50s/s]\n"}
,{"stream_name":"stdout","time":176.870371976,"data":"\n"}
,{"stream_name":"stdout","time":176.870383832,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stdout","time":176.870388551,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":176.872059634,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":176.872371666,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":176.872379441,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":176.872398249,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":176.872402261,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.872573139,"data":"\n"}
,{"stream_name":"stdout","time":176.882432313,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":177.331041434,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":177.340117563,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stderr","time":177.340142488,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.340149559,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":177.340334128,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.10s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 32.08s/s]\n"}
,{"stream_name":"stdout","time":177.340366093,"data":"\n"}
,{"stream_name":"stdout","time":177.340380643,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":177.340385302,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":177.341870178,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.342189401,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.342201614,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.342206424,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.342210288,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.342337849,"data":"\n"}
,{"stream_name":"stdout","time":177.724783779,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":177.724810131,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.724816186,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":177.724820396,"data":"  Corrected dt: 2.885959e-01 s\n"}
,{"stream_name":"stdout","time":177.724824551,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.724831778,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":177.775971018,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":177.803372445,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stderr","time":177.803402062,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.803409055,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.803616756,"data":"\n"}
,{"stream_name":"stdout","time":177.803625341,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stdout","time":177.803629344,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":177.803618216,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.54s/s]\n"}
,{"stream_name":"stdout","time":177.805253474,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.805462766,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":177.805476209,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":177.805481974,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":177.805486335,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.805637049,"data":"\n"}
,{"stream_name":"stdout","time":178.216303063,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":178.260074789,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stderr","time":178.260122958,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.260137178,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.260291432,"data":"\n"}
,{"stream_name":"stdout","time":178.260300426,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":178.260305117,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":178.260325459,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 33.01s/s]\n"}
,{"stream_name":"stdout","time":178.261831703,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.261843147,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":178.261849173,"data":"\n"}
,{"stream_name":"stdout","time":178.261852829,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.26185605,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.08 | Avg Reward/Step: 0.010\n"}
,{"stream_name":"stdout","time":178.261859955,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.261865371,"data":"\n"}
,{"stream_name":"stdout","time":178.261915419,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.261927374,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":178.26884743,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":178.268865824,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":178.268871368,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":178.268889427,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":178.268894217,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":178.26892478,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":178.268930388,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":178.268934424,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":178.268938799,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":178.268998126,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.269010097,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":178.269014246,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":178.269580724,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":178.269593614,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":178.269843642,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":178.270065647,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.270075398,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.27007951,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.271881228,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":178.271890464,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":178.271895101,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":178.271898776,"data":"|    ep_rew_mean      | 0.102    |\n"}
,{"stream_name":"stdout","time":178.271903008,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":178.271906607,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":178.271911689,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":178.271915264,"data":"|    fps              | 2        |\n"}
,{"stream_name":"stdout","time":178.271919268,"data":"|    time_elapsed     | 45       |\n"}
,{"stream_name":"stdout","time":178.271923614,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":178.271927689,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":178.272873911,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.272887492,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":178.272892108,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.272896584,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.27304061,"data":"\n"}
,{"stream_name":"stdout","time":178.615836753,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":178.615859326,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.615864298,"data":"  Original dt: 4.888611e-01 s\n"}
,{"stream_name":"stdout","time":178.615868314,"data":"  Corrected dt: 3.055382e-01 s\n"}
,{"stream_name":"stdout","time":178.615884268,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.615888461,"data":"  Max wave speed detected: 16.36 m/s\n"}
,{"stream_name":"stdout","time":178.641552574,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":178.641553697,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.641582728,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.641721579,"data":"\n"}
,{"stream_name":"stderr","time":178.641721563,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.71s/s]\n"}
,{"stream_name":"stdout","time":178.641728954,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":178.641738128,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":178.643316731,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":178.643510203,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":178.643518488,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.643523071,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":178.643527433,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.643676868,"data":"\n"}
,{"stream_name":"stdout","time":178.713384637,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stderr","time":179.089135033,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.089156272,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.089170749,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":179.089443827,"data":"\n"}
,{"stream_name":"stdout","time":179.089453837,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stdout","time":179.089458181,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":179.089472567,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.68s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 33.67s/s]\n"}
,{"stream_name":"stdout","time":179.091057735,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":179.09135724,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.09136585,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":179.091370159,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.091385887,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.091529157,"data":"\n"}
,{"stream_name":"stdout","time":179.152249569,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":179.492634534,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":179.492672192,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.492678348,"data":"  Original dt: 4.620409e-01 s\n"}
,{"stream_name":"stdout","time":179.49268236,"data":"  Corrected dt: 2.887756e-01 s\n"}
,{"stream_name":"stdout","time":179.492686581,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.492691154,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stderr","time":179.544837347,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.544855938,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.54486481,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":179.544963797,"data":"\n"}
,{"stream_name":"stdout","time":179.544971632,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stdout","time":179.544975767,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":179.544993657,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 33.10s/s]\n"}
,{"stream_name":"stdout","time":179.546497386,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.546802031,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":179.546822641,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.546827357,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.3, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":179.546831541,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.546969349,"data":"\n"}
,{"stream_name":"stdout","time":179.591258754,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stderr","time":180.002663204,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.002682139,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":180.002715734,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":180.002952402,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.93s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 32.91s/s]\n"}
,{"stream_name":"stdout","time":180.002956366,"data":"\n"}
,{"stream_name":"stdout","time":180.002971111,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":180.002975526,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":180.004492737,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":180.017211272,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.1 steps/s\n"}
,{"stream_name":"stdout","time":180.017305433,"data":"\n"}
,{"stream_name":"stdout","time":180.017313322,"data":"✅ Training completed in 0.8 minutes (47.6s)\n"}
,{"stream_name":"stdout","time":180.020130141,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:47 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":180.020146907,"data":"\n"}
,{"stream_name":"stdout","time":180.020290971,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.020302545,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":180.020306926,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.020310907,"data":"\n"}
,{"stream_name":"stdout","time":180.024361796,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.024504392,"data":"2025-10-15 22:19:10 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.024671791,"data":"2025-10-15 22:19:10 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.024874814,"data":"2025-10-15 22:19:10 - INFO - _compute_config_hash:258 - [CACHE] Config hash: 25b78b90\n"}
,{"stream_name":"stdout","time":180.025106297,"data":"2025-10-15 22:19:10 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_25b78b90_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":180.025118108,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_25b78b90_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":180.025347419,"data":"\n"}
,{"stream_name":"stdout","time":180.025353461,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":180.025358102,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":180.02536225,"data":"\n"}
,{"stream_name":"stdout","time":180.025366128,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":180.025435975,"data":"2025-10-15 22:19:10 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.025486435,"data":"2025-10-15 22:19:10 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":180.025579259,"data":"2025-10-15 22:19:10 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":180.025641518,"data":"2025-10-15 22:19:10 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.02962349,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.029701841,"data":"2025-10-15 22:19:10 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.029837066,"data":"2025-10-15 22:19:10 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":180.02992627,"data":"2025-10-15 22:19:10 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":180.030010322,"data":"2025-10-15 22:19:10 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":180.030019327,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":180.030046826,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":180.030177299,"data":"2025-10-15 22:19:10 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.03032033,"data":"2025-10-15 22:19:10 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.030696177,"data":"2025-10-15 22:19:10 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":180.030744521,"data":"2025-10-15 22:19:10 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":180.030828842,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":180.030839121,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":180.030843823,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":180.030847841,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":180.030935987,"data":"2025-10-15 22:19:10 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":180.030944118,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":180.030948853,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":180.030964337,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":180.030983572,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":180.031094963,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.031174967,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":180.031274167,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.031338136,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":180.031419227,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.031478043,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":180.031558343,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":180.03163839,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":180.031693288,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.031750473,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":180.031807042,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":180.03216659,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.032178993,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.039358941,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.039376417,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.039381296,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.039386251,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.039391027,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.039411501,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.039424089,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.039429029,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.039443972,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.039449937,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.039454106,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.039457684,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.040075229,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.040090802,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.040347503,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.040357605,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":180.040361886,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.04036556,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":180.040368871,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":180.040372613,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":180.040392539,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":180.040499485,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":180.040580846,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":180.040598905,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.040699052,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.040721715,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.04073992,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.04753084,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.047546631,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.047552191,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.047556457,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.047559944,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.047608842,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.047621446,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.047626637,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.047653431,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.047662134,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.047667267,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.047671617,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.048259939,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.048276,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.048487124,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.048665876,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.048675227,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.048679621,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.050167077,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":180.050180975,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":180.050194471,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":180.050714451,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":180.050893696,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":180.051193012,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":180.051206465,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":180.051247859,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":180.051327794,"data":"\n"}
,{"stream_name":"stdout","time":180.051334509,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":180.051338354,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":180.051351863,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":180.051356028,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":180.051360289,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":180.051364292,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":180.051368573,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":180.051372504,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":180.051376979,"data":"\n"}
,{"stream_name":"stdout","time":180.051416211,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":180.051425067,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":180.051429115,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":180.051433117,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":180.051437111,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":180.051440796,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":180.051444803,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":180.051448912,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":180.051452876,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":180.051457209,"data":"\n"}
,{"stream_name":"stdout","time":180.051501091,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":180.051694405,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":180.051767743,"data":"2025-10-15 22:19:10 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.051936706,"data":"2025-10-15 22:19:10 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.052533399,"data":"2025-10-15 22:19:10 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":180.052548316,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":180.052733889,"data":"2025-10-15 22:19:10 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":180.052789085,"data":"2025-10-15 22:19:10 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-9198004247106614985, last=-3675109104449223677\n"}
,{"stream_name":"stdout","time":180.053277545,"data":"2025-10-15 22:19:10 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":180.058190761,"data":"2025-10-15 22:19:10 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":180.058514237,"data":"2025-10-15 22:19:10 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":180.058521512,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":180.05859516,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.058612489,"data":"\n"}
,{"stream_name":"stdout","time":180.058617023,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.058620998,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":180.058625083,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":180.058629549,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":180.058634958,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":180.05863903,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.05864277,"data":"\n"}
,{"stream_name":"stdout","time":180.058685017,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.065542602,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.065560734,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.065565985,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.065570302,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.066307801,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":180.072792296,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":180.072807787,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":180.076268085,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":180.076282674,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":180.076296348,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.076451762,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":180.076470428,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.076618286,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":180.076652179,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.076768728,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":180.07682655,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":180.076905372,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":180.077006242,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.07703706,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":180.077097773,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":180.077364934,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.077380607,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.084223106,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.084238814,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.084243366,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.084247106,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.084250773,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.084254573,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.084258317,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.08426205,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.084265592,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.084269164,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.084272852,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.084276609,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.084817809,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.084828042,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.085065772,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.085080498,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":180.085084736,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.085088309,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":180.085091952,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":180.085095349,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":180.085098791,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":180.085231376,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":180.085317907,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":180.08533616,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.085432672,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.08544074,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.085445257,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.092105814,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.092121327,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.092134517,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.092138443,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.092142369,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.092257461,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.092264902,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.092268778,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.092272381,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.092275876,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.092279661,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.092283124,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.092825153,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.092835719,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.093068458,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.093265092,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.093274752,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.093279155,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.094751218,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":180.094958952,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":180.094968185,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":180.095053262,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":180.179672677,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.179693509,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.179698635,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":180.179804303,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.179892944,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.179977887,"data":"2025-10-15 22:19:10 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":180.180046931,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.180057759,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.180062019,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.180076625,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.549135387,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":180.549219432,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.69s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 40.68s/s]\n"}
,{"stream_name":"stdout","time":180.549249509,"data":"\n"}
,{"stream_name":"stdout","time":180.549263448,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":180.549268161,"data":"Total runtime: 0.37 seconds.\n"}
,{"stream_name":"stdout","time":180.550879312,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":180.550984053,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":180.551122258,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.551487432,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.551561914,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.551680105,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.398545e+00, max=8.547104e+00, std=3.614567e+00\n"}
,{"stream_name":"stdout","time":180.551919571,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.033390, rho_c=0.012308\n"}
,{"stream_name":"stdout","time":180.551931698,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=15.951404, w_c=12.250077\n"}
,{"stream_name":"stdout","time":180.552071857,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:887 -   State hash: 2521329801023128842\n"}
,{"stream_name":"stdout","time":180.55215873,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.552331221,"data":"    [RL] [STEP 1/41] action=0.0000, reward=0.0000, t=15.0s, state_diff=3.398545e+00\n"}
,{"stream_name":"stdout","time":180.553250829,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.553341371,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.553467536,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":180.553559591,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.553636477,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":180.553732925,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":180.553780126,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":180.553799939,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.553804316,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":180.553808107,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.555385638,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":180.555397857,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.555404187,"data":"  Original dt: 4.852056e-01 s\n"}
,{"stream_name":"stdout","time":180.555406985,"data":"  Corrected dt: 3.032535e-01 s\n"}
,{"stream_name":"stdout","time":180.555409368,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.555411862,"data":"  Max wave speed detected: 16.49 m/s\n"}
,{"stream_name":"stdout","time":180.636056855,"data":"[PROGRESS] Step 50: t=17.41/30.00s (58.0%) | dt=0.2989s\n"}
,{"stream_name":"stdout","time":181.036042784,"data":"  Stored output at t = 30.0000 s (Step 93)\n"}
,{"stream_name":"stdout","time":181.036095454,"data":"\n"}
,{"stream_name":"stdout","time":181.036109268,"data":"Simulation finished at t = 30.0000 s after 93 steps.\n"}
,{"stream_name":"stderr","time":181.036105892,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.13s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.12s/s]\n"}
,{"stream_name":"stdout","time":181.036113699,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":181.037631644,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.037770868,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.037880342,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.038311455,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.038365185,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.038529041,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.121422e-01, max=1.677267e+00, std=5.314570e-01\n"}
,{"stream_name":"stdout","time":181.038686143,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.034444, rho_c=0.010223\n"}
,{"stream_name":"stdout","time":181.03877647,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.384410, w_c=13.457637\n"}
,{"stream_name":"stdout","time":181.038858581,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:887 -   State hash: -2168101016278072712\n"}
,{"stream_name":"stdout","time":181.038954416,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.039149512,"data":"    [RL] [STEP 2/41] action=0.0000, reward=0.0000, t=30.0s, state_diff=4.121422e-01\n"}
,{"stream_name":"stdout","time":181.040095934,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.040209062,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.040319262,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":181.040386555,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.040493391,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.040567041,"data":"2025-10-15 22:19:11 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":181.04063151,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.040637842,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.040642051,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.040645872,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.103929545,"data":"[PROGRESS] Step 100: t=32.03/45.00s (71.2%) | dt=0.2896s\n"}
,{"stream_name":"stdout","time":181.46948212,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":181.469509209,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.469514949,"data":"  Original dt: 4.620085e-01 s\n"}
,{"stream_name":"stdout","time":181.469519164,"data":"  Corrected dt: 2.887553e-01 s\n"}
,{"stream_name":"stdout","time":181.469523113,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.469527102,"data":"  Max wave speed detected: 17.32 m/s\n"}
,{"stream_name":"stdout","time":181.495822792,"data":"  Stored output at t = 45.0000 s (Step 145)\n"}
,{"stream_name":"stdout","time":181.495942653,"data":"\n"}
,{"stream_name":"stdout","time":181.495950877,"data":"Simulation finished at t = 45.0000 s after 145 steps.\n"}
,{"stream_name":"stderr","time":181.49594823,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.99s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 32.97s/s]\n"}
,{"stream_name":"stdout","time":181.495954908,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":181.497510836,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.497629523,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.497756746,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.49814166,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.49824791,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.498389891,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.251041e-01, max=6.802830e-01, std=1.885268e-01\n"}
,{"stream_name":"stdout","time":181.498569821,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035459, rho_c=0.008026\n"}
,{"stream_name":"stdout","time":181.49864232,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.485134, w_c=13.775694\n"}
,{"stream_name":"stdout","time":181.498768315,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:887 -   State hash: -504887018134808937\n"}
,{"stream_name":"stdout","time":181.498830065,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.499045849,"data":"    [RL] [STEP 3/41] action=0.0000, reward=0.0000, t=45.0s, state_diff=1.251041e-01\n"}
,{"stream_name":"stdout","time":181.49995979,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.500035957,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.500162837,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":181.500258203,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.500319732,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.500434892,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":181.500491946,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.500500817,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.500505851,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.500510397,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.544568787,"data":"[PROGRESS] Step 150: t=46.44/60.00s (77.4%) | dt=0.2887s\n"}
,{"stream_name":"stdout","time":181.954123965,"data":"  Stored output at t = 60.0000 s (Step 197)\n"}
,{"stream_name":"stderr","time":181.954351894,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.09s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 33.08s/s]\n"}
,{"stream_name":"stdout","time":181.954383696,"data":"\n"}
,{"stream_name":"stdout","time":181.954399593,"data":"Simulation finished at t = 60.0000 s after 197 steps.\n"}
,{"stream_name":"stdout","time":181.954404106,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":181.955936136,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.956038416,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.956222855,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.956573962,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.956656624,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.956810705,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.833548e-02, max=5.610049e-01, std=1.405242e-01\n"}
,{"stream_name":"stdout","time":181.95698573,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036376, rho_c=0.005816\n"}
,{"stream_name":"stdout","time":181.957078073,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.575713, w_c=13.904601\n"}
,{"stream_name":"stdout","time":181.957220058,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:887 -   State hash: 1491942454441776441\n"}
,{"stream_name":"stdout","time":181.957304876,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.957532303,"data":"    [RL] [STEP 4/41] action=0.0000, reward=0.0000, t=60.0s, state_diff=8.833548e-02\n"}
,{"stream_name":"stdout","time":181.958570307,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.958662739,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.958780008,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":181.958863781,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.958949871,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":181.959063018,"data":"2025-10-15 22:19:12 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":181.959111412,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":181.959121511,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":181.959126705,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":181.95913284,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.987579583,"data":"[PROGRESS] Step 200: t=60.87/75.00s (81.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":182.416107832,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":182.416135233,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.416140619,"data":"  Original dt: 4.617597e-01 s\n"}
,{"stream_name":"stdout","time":182.416144327,"data":"  Corrected dt: 2.885998e-01 s\n"}
,{"stream_name":"stdout","time":182.41614833,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.416152127,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":182.489348257,"data":"  Stored output at t = 75.0000 s (Step 249)\n"}
,{"stream_name":"stdout","time":182.489627586,"data":"\n"}
,{"stream_name":"stdout","time":182.489672939,"data":"Simulation finished at t = 75.0000 s after 249 steps.\n"}
,{"stream_name":"stderr","time":182.489668962,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.31s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.30s/s]\n"}
,{"stream_name":"stdout","time":182.489679559,"data":"Total runtime: 0.53 seconds.\n"}
,{"stream_name":"stdout","time":182.491619148,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.491710706,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.491910589,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.492382334,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.492495719,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.49264987,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.478507e-02, max=5.273854e-01, std=1.305134e-01\n"}
,{"stream_name":"stdout","time":182.492875777,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.036222, rho_c=0.003917\n"}
,{"stream_name":"stdout","time":182.493009762,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.702825, w_c=14.017828\n"}
,{"stream_name":"stdout","time":182.49316193,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:887 -   State hash: 1438548242651005314\n"}
,{"stream_name":"stdout","time":182.493277191,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.493519733,"data":"    [RL] [STEP 5/41] action=0.0000, reward=0.0000, t=75.0s, state_diff=7.478507e-02\n"}
,{"stream_name":"stdout","time":182.494649725,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.494730579,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.494876821,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":182.495046662,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.49514413,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.495260071,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":182.495333656,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.495342612,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.495348003,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.495368105,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.506722485,"data":"[PROGRESS] Step 250: t=75.29/90.00s (83.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":182.962097916,"data":"[PROGRESS] Step 300: t=89.72/90.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":182.970865915,"data":"  Stored output at t = 90.0000 s (Step 301)\n"}
,{"stream_name":"stdout","time":182.971046607,"data":"\n"}
,{"stream_name":"stdout","time":182.971059497,"data":"Simulation finished at t = 90.0000 s after 301 steps.\n"}
,{"stream_name":"stdout","time":182.971064486,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":182.971069817,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.57s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.56s/s]\n"}
,{"stream_name":"stdout","time":182.972606894,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.972741376,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.972847456,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.973270488,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.97332842,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.973504774,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.167747e-02, max=5.048404e-01, std=1.259331e-01\n"}
,{"stream_name":"stdout","time":182.973681325,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035351, rho_c=0.003229\n"}
,{"stream_name":"stdout","time":182.973739732,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.829459, w_c=14.136344\n"}
,{"stream_name":"stdout","time":182.973837292,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:887 -   State hash: -7593471001432380173\n"}
,{"stream_name":"stdout","time":182.973931939,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.974129951,"data":"    [RL] [STEP 6/41] action=0.0000, reward=0.0000, t=90.0s, state_diff=6.167747e-02\n"}
,{"stream_name":"stdout","time":182.975114305,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.975187037,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.975334582,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":182.975415219,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.97555744,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":182.975655295,"data":"2025-10-15 22:19:13 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":182.975696938,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":182.975704257,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":182.975709043,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":182.975726953,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.337273774,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":183.337295848,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.337300822,"data":"  Original dt: 4.617535e-01 s\n"}
,{"stream_name":"stdout","time":183.337304583,"data":"  Corrected dt: 2.885960e-01 s\n"}
,{"stream_name":"stdout","time":183.337308345,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.33731201,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":183.405269669,"data":"[PROGRESS] Step 350: t=104.14/105.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":183.432121364,"data":"  Stored output at t = 105.0000 s (Step 353)\n"}
,{"stream_name":"stdout","time":183.43217915,"data":"\n"}
,{"stream_name":"stdout","time":183.432192784,"data":"Simulation finished at t = 105.0000 s after 353 steps.\n"}
,{"stream_name":"stderr","time":183.432190057,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.90s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 32.89s/s]\n"}
,{"stream_name":"stdout","time":183.432198197,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":183.433735639,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.433793805,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.433956908,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.43439481,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.434475565,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.43455536,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.521459e-02, max=3.120188e-01, std=6.417648e-02\n"}
,{"stream_name":"stdout","time":183.434729952,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035068, rho_c=0.003175\n"}
,{"stream_name":"stdout","time":183.434811144,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.871710, w_c=14.194615\n"}
,{"stream_name":"stdout","time":183.434939904,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:887 -   State hash: 5509308847268387673\n"}
,{"stream_name":"stdout","time":183.435001858,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.435239959,"data":"    [RL] [STEP 7/41] action=0.0000, reward=0.0000, t=105.0s, state_diff=2.521459e-02\n"}
,{"stream_name":"stdout","time":183.436331767,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.43641414,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.43654793,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":183.436609185,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.436706777,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.436778615,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":183.436849144,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.436855575,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.43686028,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.43686486000001,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.875471589,"data":"[PROGRESS] Step 400: t=118.56/120.00s (98.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":183.919438052,"data":"  Stored output at t = 120.0000 s (Step 405)\n"}
,{"stream_name":"stdout","time":183.919714952,"data":"\n"}
,{"stream_name":"stderr","time":183.919714869,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.11s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":183.919727163,"data":"Simulation finished at t = 120.0000 s after 405 steps.\n"}
,{"stream_name":"stdout","time":183.919735292,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":183.921334777,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.92135576,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.921511494,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.921838061,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.921873968,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.922009926,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.296586e-03, max=1.122077e-01, std=1.794181e-02\n"}
,{"stream_name":"stdout","time":183.92223703,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035023, rho_c=0.003167\n"}
,{"stream_name":"stdout","time":183.922291381,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.879452, w_c=14.212006\n"}
,{"stream_name":"stdout","time":183.922432271,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:887 -   State hash: -935453842933675106\n"}
,{"stream_name":"stdout","time":183.922498137,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.922729369,"data":"    [RL] [STEP 8/41] action=0.0000, reward=0.0000, t=120.0s, state_diff=6.296586e-03\n"}
,{"stream_name":"stdout","time":183.923700211,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.923750169,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.923864392,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":183.923951115,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.924062334,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":183.924152389,"data":"2025-10-15 22:19:14 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":183.924170929,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":183.924175717,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":183.92423579,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":183.924244725,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.25110775,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":184.251135563,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.251142013,"data":"  Original dt: 4.617533e-01 s\n"}
,{"stream_name":"stdout","time":184.251146071,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":184.251150366,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.251154341,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":184.320943006,"data":"[PROGRESS] Step 450: t=132.99/135.00s (98.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":184.382874435,"data":"  Stored output at t = 135.0000 s (Step 457)\n"}
,{"stream_name":"stderr","time":184.383078485,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 32.74s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 32.72s/s]\n"}
,{"stream_name":"stdout","time":184.383097362,"data":"\n"}
,{"stream_name":"stdout","time":184.383111288,"data":"Simulation finished at t = 135.0000 s after 457 steps.\n"}
,{"stream_name":"stdout","time":184.383115572,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":184.384588665,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.384631631,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.384806623,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.38516353,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.385263283,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.385388696,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.408427e-03, max=3.036733e-02, std=4.401753e-03\n"}
,{"stream_name":"stdout","time":184.385574465,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035016, rho_c=0.003165\n"}
,{"stream_name":"stdout","time":184.385641156,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880730, w_c=14.216353\n"}
,{"stream_name":"stdout","time":184.385765679,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:887 -   State hash: 8627363760355435204\n"}
,{"stream_name":"stdout","time":184.385838447,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.386082052,"data":"    [RL] [STEP 9/41] action=0.0000, reward=0.0000, t=135.0s, state_diff=1.408427e-03\n"}
,{"stream_name":"stdout","time":184.386995939,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.387067294,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.387241591,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":184.387294501,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.387431594,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.38751444,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":184.387565481,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.387572083,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.387577149,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.387599594,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.775342105,"data":"[PROGRESS] Step 500: t=147.41/150.00s (98.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":184.856780292,"data":"  Stored output at t = 150.0000 s (Step 509)\n"}
,{"stream_name":"stdout","time":184.857069184,"data":"\n"}
,{"stream_name":"stdout","time":184.857085527,"data":"Simulation finished at t = 150.0000 s after 509 steps.\n"}
,{"stream_name":"stdout","time":184.857089888,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":184.857103163,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 31.99s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 31.98s/s]\n"}
,{"stream_name":"stdout","time":184.858594812,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.858610842,"data":"[STEP   10] t=  150.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":184.858718225,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.858816034,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.859216795,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.859315721,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.859443021,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.039691e-04, max=7.310802e-03, std=1.016559e-03\n"}
,{"stream_name":"stdout","time":184.85958165,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":184.859662557,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880942, w_c=14.217356\n"}
,{"stream_name":"stdout","time":184.859777485,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:887 -   State hash: 6253465645873381031\n"}
,{"stream_name":"stdout","time":184.859860137,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.860050343,"data":"    [RL] [STEP 10/41] action=0.0000, reward=0.0000, t=150.0s, state_diff=3.039691e-04\n"}
,{"stream_name":"stdout","time":184.860939535,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.861010668,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.861164744,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":184.861225557,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.861321028,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":184.861422018,"data":"2025-10-15 22:19:15 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":184.86147789,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":184.861484555,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":184.861488602,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":184.861492386,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.150816876,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":185.150851231,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.150856636,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":185.150860762,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":185.150864394,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.150868127,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":185.219152617,"data":"[PROGRESS] Step 550: t=161.83/165.00s (98.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":185.315876207,"data":"  Stored output at t = 165.0000 s (Step 561)\n"}
,{"stream_name":"stdout","time":185.315938567,"data":"\n"}
,{"stream_name":"stdout","time":185.315951894,"data":"Simulation finished at t = 165.0000 s after 561 steps.\n"}
,{"stream_name":"stdout","time":185.315956859,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":185.315985058,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 33.04s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 33.03s/s]\n"}
,{"stream_name":"stdout","time":185.317431989,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.31755406,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.317650099,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.318133705,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.318238278,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.318338041,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.460893e-05, max=1.659553e-03, std=2.261282e-04\n"}
,{"stream_name":"stdout","time":185.318523074,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":185.31858913,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880978, w_c=14.217577\n"}
,{"stream_name":"stdout","time":185.318677325,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:887 -   State hash: 2622854361818630682\n"}
,{"stream_name":"stdout","time":185.318768434,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.318946462,"data":"    [RL] [STEP 11/41] action=0.0000, reward=0.0000, t=165.0s, state_diff=6.460893e-05\n"}
,{"stream_name":"stdout","time":185.319883858,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.319906477,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.32005817,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":185.320176047,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.320223603,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.320353471,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":185.320361503,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.320365744,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.320369725,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.32038189,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.661766839,"data":"[PROGRESS] Step 600: t=176.26/180.00s (97.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":185.777081908,"data":"  Stored output at t = 180.0000 s (Step 613)\n"}
,{"stream_name":"stdout","time":185.777233658,"data":"\n"}
,{"stream_name":"stdout","time":185.777253658,"data":"Simulation finished at t = 180.0000 s after 613 steps.\n"}
,{"stream_name":"stdout","time":185.777258736,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":185.777235764,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 32.87s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 32.86s/s]\n"}
,{"stream_name":"stdout","time":185.7789946,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.779089445,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.779260457,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.779635933,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.779656674,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.779790809,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.363054e-05, max=3.647833e-04, std=4.914669e-05\n"}
,{"stream_name":"stdout","time":185.779963162,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":185.780088597,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880985, w_c=14.217625\n"}
,{"stream_name":"stdout","time":185.780231444,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:887 -   State hash: -9197281615761219688\n"}
,{"stream_name":"stdout","time":185.780304628,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.780504072,"data":"    [RL] [STEP 12/41] action=0.0000, reward=0.0000, t=180.0s, state_diff=1.363054e-05\n"}
,{"stream_name":"stdout","time":185.781513542,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.781612607,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.781757508,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":185.781879803,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.781949083,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":185.782090353,"data":"2025-10-15 22:19:16 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":185.782162293,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":185.782173847,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":185.782178881,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":185.782183279,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.065900163,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":186.065923579,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.065929083,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":186.065933409,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":186.06593742,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.065941668,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":186.13806236,"data":"[PROGRESS] Step 650: t=190.68/195.00s (97.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":186.271941895,"data":"  Stored output at t = 195.0000 s (Step 665)\n"}
,{"stream_name":"stderr","time":186.272102485,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.65s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 30.64s/s]\n"}
,{"stream_name":"stdout","time":186.272125587,"data":"\n"}
,{"stream_name":"stdout","time":186.272135067,"data":"Simulation finished at t = 195.0000 s after 665 steps.\n"}
,{"stream_name":"stdout","time":186.272140068,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":186.273708295,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.273732672,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.273896259,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.27424993,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.274291728,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.274435818,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.862432e-06, max=7.870081e-05, std=1.052756e-05\n"}
,{"stream_name":"stdout","time":186.274591772,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":186.274653606,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217636\n"}
,{"stream_name":"stdout","time":186.274756956,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:887 -   State hash: 3047568907754315262\n"}
,{"stream_name":"stdout","time":186.274820716,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.275017127,"data":"    [RL] [STEP 13/41] action=0.0000, reward=0.0000, t=195.0s, state_diff=2.862432e-06\n"}
,{"stream_name":"stdout","time":186.275973155,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.276091122,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.276236485,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":186.276322427,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.276401217,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.276503195,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":186.276559212,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.27658197,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.276588855,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.276593338,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.588098449,"data":"[PROGRESS] Step 700: t=205.10/210.00s (97.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":186.739121836,"data":"  Stored output at t = 210.0000 s (Step 717)\n"}
,{"stream_name":"stderr","time":186.739341446,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.46s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 32.44s/s]\n"}
,{"stream_name":"stdout","time":186.739344246,"data":"\n"}
,{"stream_name":"stdout","time":186.73936299,"data":"Simulation finished at t = 210.0000 s after 717 steps.\n"}
,{"stream_name":"stdout","time":186.73936791,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":186.740900119,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.740964712,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.741128466,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.741458341,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.741505471,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.741657827,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.988992e-07, max=1.678477e-05, std=2.233747e-06\n"}
,{"stream_name":"stdout","time":186.741811505,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":186.741877813,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":186.741977045,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:887 -   State hash: -5520189790850468560\n"}
,{"stream_name":"stdout","time":186.74207911,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.742266649,"data":"    [RL] [STEP 14/41] action=0.0000, reward=0.0000, t=210.0s, state_diff=5.988992e-07\n"}
,{"stream_name":"stdout","time":186.743198497,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.743252551,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.743378156,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":186.743443533,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.743570601,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":186.743682392,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":186.743704342,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":186.743710942,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":186.743716344,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":186.743741082,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.96506747,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":186.965085336,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.965090113,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":186.96509398,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":186.965097924,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.965101625,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":187.034153213,"data":"[PROGRESS] Step 750: t=219.52/225.00s (97.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":187.20277759,"data":"  Stored output at t = 225.0000 s (Step 769)\n"}
,{"stream_name":"stdout","time":187.202844201,"data":"\n"}
,{"stream_name":"stderr","time":187.202857572,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 32.71s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 32.70s/s]\n"}
,{"stream_name":"stdout","time":187.20286265,"data":"Simulation finished at t = 225.0000 s after 769 steps.\n"}
,{"stream_name":"stdout","time":187.202871963,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":187.204452274,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.204470755,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.204548246,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.204888827,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.204962243,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.205086625,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.248735e-07, max=3.551999e-06, std=4.707803e-07\n"}
,{"stream_name":"stdout","time":187.20527653,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":187.205345567,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":187.205464022,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:887 -   State hash: 8365412597796646527\n"}
,{"stream_name":"stdout","time":187.205545252,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.20574293,"data":"    [RL] [STEP 15/41] action=0.0000, reward=0.0000, t=225.0s, state_diff=1.248735e-07\n"}
,{"stream_name":"stdout","time":187.206703658,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.206753232,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.206907024,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":187.207010753,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.207102349,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.207233367,"data":"2025-10-15 22:19:17 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":187.207244182,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.207252182,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.207256531,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.207303752,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.478421482,"data":"[PROGRESS] Step 800: t=233.95/240.00s (97.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":187.662092458,"data":"  Stored output at t = 240.0000 s (Step 821)\n"}
,{"stream_name":"stderr","time":187.662164309,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 33.01s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 33.01s/s]\n"}
,{"stream_name":"stdout","time":187.662175243,"data":"\n"}
,{"stream_name":"stdout","time":187.662186249,"data":"Simulation finished at t = 240.0000 s after 821 steps.\n"}
,{"stream_name":"stdout","time":187.662190265,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":187.663668102,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.66377119,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.663892242,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.664240683,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.664285168,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.664399715,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.594896e-08, max=7.473341e-07, std=9.870491e-08\n"}
,{"stream_name":"stdout","time":187.664577841,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":187.664656988,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":187.664767154,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:887 -   State hash: 1504456737988086450\n"}
,{"stream_name":"stdout","time":187.664841151,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.665039647,"data":"    [RL] [STEP 16/41] action=0.0000, reward=0.0000, t=240.0s, state_diff=2.594896e-08\n"}
,{"stream_name":"stdout","time":187.665922458,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.666053377,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.666181323,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":187.666256868,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.666328914,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":187.666462735,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":187.666484966,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":187.666502584,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":187.666509442,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":187.666513973,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.850328955,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":187.85034846,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.850353879,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":187.850358141,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":187.850362112,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.850366401,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":187.918511479,"data":"[PROGRESS] Step 850: t=248.37/255.00s (97.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":188.119421665,"data":"  Stored output at t = 255.0000 s (Step 873)\n"}
,{"stream_name":"stdout","time":188.119499992,"data":"\n"}
,{"stream_name":"stdout","time":188.119508781,"data":"Simulation finished at t = 255.0000 s after 873 steps.\n"}
,{"stream_name":"stdout","time":188.11951399,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":188.119520824,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 33.15s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 33.14s/s]\n"}
,{"stream_name":"stdout","time":188.121110233,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.121129969,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.121239419,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.121595967,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.121699303,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.121758249,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.374553e-09, max=1.564994e-07, std=2.060470e-08\n"}
,{"stream_name":"stdout","time":188.121939652,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":188.122019647,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":188.122128614,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:887 -   State hash: -9180111442366441027\n"}
,{"stream_name":"stdout","time":188.122208578,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.122386571,"data":"    [RL] [STEP 17/41] action=0.0000, reward=0.0000, t=255.0s, state_diff=5.374553e-09\n"}
,{"stream_name":"stdout","time":188.123295308,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.123406343,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.123524718,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":188.12359825,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.123669735,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.123798903,"data":"2025-10-15 22:19:18 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":188.123806932,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.12381196,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.123824552,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.123835813,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.357584044,"data":"[PROGRESS] Step 900: t=262.79/270.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":188.577159927,"data":"  Stored output at t = 270.0000 s (Step 925)\n"}
,{"stream_name":"stderr","time":188.577399669,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 33.11s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 33.10s/s]\n"}
,{"stream_name":"stdout","time":188.577408172,"data":"\n"}
,{"stream_name":"stdout","time":188.577421151,"data":"Simulation finished at t = 270.0000 s after 925 steps.\n"}
,{"stream_name":"stdout","time":188.577425746,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":188.579039719,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.579164573,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.57932362,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.579671475,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.579681438,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.579827362,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.109661e-09, max=3.263938e-08, std=4.284751e-09\n"}
,{"stream_name":"stdout","time":188.579960996,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":188.580021519,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":188.580179345,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:887 -   State hash: -8795565612553806548\n"}
,{"stream_name":"stdout","time":188.580240913,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.580401795,"data":"    [RL] [STEP 18/41] action=0.0000, reward=0.0000, t=270.0s, state_diff=1.109661e-09\n"}
,{"stream_name":"stdout","time":188.581629046,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.581749095,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.581873591,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":188.581971651,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.582094372,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":188.582225674,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":188.582232649,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":188.582237568,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":188.582253897,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":188.582258916,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.731548923,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":188.731567381,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.731572293,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":188.731576129,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":188.73157986,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.731583579,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":188.800121383,"data":"[PROGRESS] Step 950: t=277.21/285.00s (97.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":189.03548115,"data":"  Stored output at t = 285.0000 s (Step 977)\n"}
,{"stream_name":"stdout","time":189.035571142,"data":"\n"}
,{"stream_name":"stdout","time":189.035580197,"data":"Simulation finished at t = 285.0000 s after 977 steps.\n"}
,{"stream_name":"stdout","time":189.035584947,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":189.035586795,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 33.13s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 33.12s/s]\n"}
,{"stream_name":"stdout","time":189.037255973,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.037281368,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.037399774,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.037748313,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.037790598,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.037928966,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.284143e-10, max=6.782328e-09, std=8.879027e-10\n"}
,{"stream_name":"stdout","time":189.038124686,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":189.038204471,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":189.038325612,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:887 -   State hash: -99830602128828888\n"}
,{"stream_name":"stdout","time":189.038410913,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.038588511,"data":"    [RL] [STEP 19/41] action=0.0000, reward=0.0000, t=285.0s, state_diff=2.284143e-10\n"}
,{"stream_name":"stdout","time":189.03951184,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.039560714,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.039701222,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":189.03976469,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.039870345,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.039945534,"data":"2025-10-15 22:19:19 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":189.039991572,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.03999935,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.040004735,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.040010299,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.241691742,"data":"[PROGRESS] Step 1000: t=291.64/300.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":189.496613968,"data":"  Stored output at t = 300.0000 s (Step 1029)\n"}
,{"stream_name":"stderr","time":189.496824466,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.88s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 32.86s/s]\n"}
,{"stream_name":"stdout","time":189.496832732,"data":"\n"}
,{"stream_name":"stdout","time":189.496876083,"data":"Simulation finished at t = 300.0000 s after 1029 steps.\n"}
,{"stream_name":"stdout","time":189.49688192,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":189.498365534,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.498377582,"data":"[STEP   20] t=  300.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":189.498528768,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.498610161,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.498986903,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.499086042,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.499210898,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.688165e-11, max=1.404574e-09, std=1.833974e-10\n"}
,{"stream_name":"stdout","time":189.499405372,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":189.499462932,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":189.499586984,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:887 -   State hash: -1386598388720957421\n"}
,{"stream_name":"stdout","time":189.499667392,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.499848147,"data":"    [RL] [STEP 20/41] action=0.0000, reward=0.0000, t=300.0s, state_diff=4.688165e-11\n"}
,{"stream_name":"stdout","time":189.500785549,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.500861897,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.500973582,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":189.501081052,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.501188701,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.501294864,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":189.50130085,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.501311709,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.501323368,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.501363439,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.618001247,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":189.618057671,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.618066495,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":189.618070247,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":189.618075309,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.618089638,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":189.68718176,"data":"[PROGRESS] Step 1050: t=306.06/315.00s (97.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":189.95741017,"data":"  Stored output at t = 315.0000 s (Step 1081)\n"}
,{"stream_name":"stdout","time":189.957676142,"data":"\n"}
,{"stream_name":"stdout","time":189.95768705,"data":"Simulation finished at t = 315.0000 s after 1081 steps.\n"}
,{"stream_name":"stdout","time":189.957691462,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stderr","time":189.95769881,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.91s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 32.90s/s]\n"}
,{"stream_name":"stdout","time":189.959492741,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.959510802,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.959515587,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.959771973,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.959842144,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.959960004,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.595821e-12, max=2.899601e-10, std=3.776549e-11\n"}
,{"stream_name":"stdout","time":189.9601488,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":189.960227011,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":189.960310387,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:887 -   State hash: 6099090098704751817\n"}
,{"stream_name":"stdout","time":189.96039255,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.960577897,"data":"    [RL] [STEP 21/41] action=0.0000, reward=0.0000, t=315.0s, state_diff=9.595821e-12\n"}
,{"stream_name":"stdout","time":189.961515588,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.961581808,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.96172423,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":189.961766239,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.96187958,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":189.961986666,"data":"2025-10-15 22:19:20 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":189.961992945,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":189.961997663,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":189.962002983,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":189.962015187,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.128487292,"data":"[PROGRESS] Step 1100: t=320.48/330.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":190.417132217,"data":"  Stored output at t = 330.0000 s (Step 1133)\n"}
,{"stream_name":"stderr","time":190.417301171,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 32.99s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 32.97s/s]\n"}
,{"stream_name":"stdout","time":190.417327101,"data":"\n"}
,{"stream_name":"stdout","time":190.417334125,"data":"Simulation finished at t = 330.0000 s after 1133 steps.\n"}
,{"stream_name":"stdout","time":190.417338032,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":190.418838969,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.418949849,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.419082494,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.419439699,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.419524954,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.419639533,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.958695e-12, max=5.968026e-11, std=7.754176e-12\n"}
,{"stream_name":"stdout","time":190.419806915,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":190.419881624,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":190.420003438,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:887 -   State hash: -167787446417256109\n"}
,{"stream_name":"stdout","time":190.420092224,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.420291888,"data":"    [RL] [STEP 22/41] action=0.0000, reward=0.0000, t=330.0s, state_diff=1.958695e-12\n"}
,{"stream_name":"stdout","time":190.42125714,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.421347914,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.42146022,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":190.421524165,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.421642572,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.421697637,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":190.421760098,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.42176716,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.421772107,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.421777191,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.501843579,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":190.501863042,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.501868346,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":190.501872718,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":190.501876912,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.501881095,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":190.571696238,"data":"[PROGRESS] Step 1150: t=334.91/345.00s (97.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":190.913320872,"data":"  Stored output at t = 345.0000 s (Step 1185)\n"}
,{"stream_name":"stdout","time":190.913602697,"data":"\n"}
,{"stream_name":"stderr","time":190.913604803,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.54s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.52s/s]\n"}
,{"stream_name":"stdout","time":190.913612152,"data":"Simulation finished at t = 345.0000 s after 1185 steps.\n"}
,{"stream_name":"stdout","time":190.913620095,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":190.915167071,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.915272824,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.915391332,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.915726195,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.915801605,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.91593785,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.990405e-13, max=1.225509e-11, std=1.588785e-12\n"}
,{"stream_name":"stdout","time":190.916088259,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":190.916202232,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":190.916306723,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:887 -   State hash: -3639785677594272105\n"}
,{"stream_name":"stdout","time":190.916368589,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.916580793,"data":"    [RL] [STEP 23/41] action=0.0000, reward=0.0000, t=345.0s, state_diff=3.990405e-13\n"}
,{"stream_name":"stdout","time":190.917567729,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.917667314,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.917807105,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":190.917848951,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.917962664,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":190.918055055,"data":"2025-10-15 22:19:21 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":190.918100674,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":190.918109267,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":190.918126859,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":190.91813335,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.048974662,"data":"[PROGRESS] Step 1200: t=349.33/360.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":191.373005228,"data":"  Stored output at t = 360.0000 s (Step 1237)\n"}
,{"stream_name":"stdout","time":191.373199467,"data":"\n"}
,{"stream_name":"stderr","time":191.373207732,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 33.00s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 32.99s/s]\n"}
,{"stream_name":"stdout","time":191.373218065,"data":"Simulation finished at t = 360.0000 s after 1237 steps.\n"}
,{"stream_name":"stdout","time":191.373226046,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":191.37473327,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.374825062,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.374960203,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.375327924,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.375351342,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.375497858,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.093729e-14, max=2.506440e-12, std=3.239125e-13\n"}
,{"stream_name":"stdout","time":191.37564258,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":191.375739937,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":191.375826707,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:887 -   State hash: -4645737264980088329\n"}
,{"stream_name":"stdout","time":191.375906805,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.376088089,"data":"    [RL] [STEP 24/41] action=0.0000, reward=0.0000, t=360.0s, state_diff=8.093729e-14\n"}
,{"stream_name":"stdout","time":191.376987183,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.377101135,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.377231295,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":191.377304483,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.377378481,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.377495969,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":191.377514955,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.377523624,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.377546801,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.377552407,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.422157699,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":191.422174276,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.422179049,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":191.422182891,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":191.422186659,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.422190728,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":191.490888858,"data":"[PROGRESS] Step 1250: t=363.75/375.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":191.829159106,"data":"  Stored output at t = 375.0000 s (Step 1289)\n"}
,{"stream_name":"stdout","time":191.829443632,"data":"\n"}
,{"stream_name":"stdout","time":191.829453452,"data":"Simulation finished at t = 375.0000 s after 1289 steps.\n"}
,{"stream_name":"stdout","time":191.829473125,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":191.829475433,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 33.24s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 33.22s/s]\n"}
,{"stream_name":"stdout","time":191.830945832,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.83107744,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.831192061,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.831529858,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.831575236,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.831698745,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.630333e-14, max=5.098144e-13, std=6.574957e-14\n"}
,{"stream_name":"stdout","time":191.831849581,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":191.831965623,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":191.832059591,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:887 -   State hash: -7086177105855906497\n"}
,{"stream_name":"stdout","time":191.83216633,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.832342848,"data":"    [RL] [STEP 25/41] action=0.0000, reward=0.0000, t=375.0s, state_diff=1.630333e-14\n"}
,{"stream_name":"stdout","time":191.833265334,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.833401433,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.833483684,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":191.833613059,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.833666264,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":191.83375549,"data":"2025-10-15 22:19:22 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":191.83381175,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":191.833818106,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":191.833822343,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":191.833840441,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.930040627,"data":"[PROGRESS] Step 1300: t=378.17/390.00s (97.0%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":192.28831331,"data":"  Stored output at t = 390.0000 s (Step 1341)\n"}
,{"stream_name":"stdout","time":192.288507558,"data":"\n"}
,{"stream_name":"stdout","time":192.288518594,"data":"Simulation finished at t = 390.0000 s after 1341 steps.\n"}
,{"stream_name":"stdout","time":192.288523428,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":192.288524934,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 33.03s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 33.02s/s]\n"}
,{"stream_name":"stdout","time":192.290041374,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.290148343,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.290232145,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.290583032,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.290676521,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.290784651,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.204002e-15, max=1.030287e-13, std=1.371947e-14\n"}
,{"stream_name":"stdout","time":192.290970699,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":192.291032994,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":192.291177354,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:887 -   State hash: 6961392850584473380\n"}
,{"stream_name":"stdout","time":192.291232193,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.291431208,"data":"    [RL] [STEP 26/41] action=0.0000, reward=0.0000, t=390.0s, state_diff=3.204002e-15\n"}
,{"stream_name":"stdout","time":192.292389085,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.292522948,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.292640702,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":192.292721391,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.292796499,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.292905983,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":192.292939665,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.292944709,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.292949713,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.292961618,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.302861238,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":192.302878522,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.302883489,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":192.302887354,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":192.302892616,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.302896487,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":192.372190599,"data":"[PROGRESS] Step 1350: t=392.60/405.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":192.747798996,"data":"  Stored output at t = 405.0000 s (Step 1393)\n"}
,{"stream_name":"stdout","time":192.74782122,"data":"\n"}
,{"stream_name":"stdout","time":192.747826527,"data":"Simulation finished at t = 405.0000 s after 1393 steps.\n"}
,{"stream_name":"stdout","time":192.747830283,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":192.74783604,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 33.01s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 33.01s/s]\n"}
,{"stream_name":"stdout","time":192.749350926,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.749413665,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.749572478,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.74988285,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.749931577,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.750060354,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.179905e-16, max=2.309264e-14, std=3.049549e-15\n"}
,{"stream_name":"stdout","time":192.750234634,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":192.750298704,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":192.750403299,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:887 -   State hash: 6935079076316736431\n"}
,{"stream_name":"stdout","time":192.75047478,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.750664492,"data":"    [RL] [STEP 27/41] action=0.0000, reward=0.0000, t=405.0s, state_diff=7.179905e-16\n"}
,{"stream_name":"stdout","time":192.751606444,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.751723842,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.751846954,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":192.751928672,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.751993962,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":192.752099921,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":192.752151776,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":192.752159638,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":192.752164744,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":192.752170748,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.813390449,"data":"[PROGRESS] Step 1400: t=407.02/420.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.185193769,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":193.185216414,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.185220254,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":193.185222911,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":193.185225669,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.18522822,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":193.210686118,"data":"  Stored output at t = 420.0000 s (Step 1445)\n"}
,{"stream_name":"stderr","time":193.21073628,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.75s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 32.74s/s]\n"}
,{"stream_name":"stdout","time":193.210774041,"data":"\n"}
,{"stream_name":"stdout","time":193.210782971,"data":"Simulation finished at t = 420.0000 s after 1445 steps.\n"}
,{"stream_name":"stdout","time":193.210787089,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":193.212256681,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.212341985,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.212468623,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.212798691,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.212851852,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.212962633,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.409432e-16, max=1.065814e-14, std=8.725885e-16\n"}
,{"stream_name":"stdout","time":193.213159915,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":193.213221076,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":193.213338886,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:887 -   State hash: -6509641969870493348\n"}
,{"stream_name":"stdout","time":193.213413101,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.21359929,"data":"    [RL] [STEP 28/41] action=0.0000, reward=0.0000, t=420.0s, state_diff=1.409432e-16\n"}
,{"stream_name":"stdout","time":193.214517655,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.214552281,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.214681544,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":193.214739731,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.214845014,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.214940234,"data":"2025-10-15 22:19:23 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":193.214948018,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.214952692,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.214994429,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.215002857,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.258873713,"data":"[PROGRESS] Step 1450: t=421.44/435.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":193.668319157,"data":"  Stored output at t = 435.0000 s (Step 1497)\n"}
,{"stream_name":"stderr","time":193.668443904,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 33.12s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 33.11s/s]\n"}
,{"stream_name":"stdout","time":193.668456176,"data":"\n"}
,{"stream_name":"stdout","time":193.66846566,"data":"Simulation finished at t = 435.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":193.668470424,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":193.670012066,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.670070663,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.670194323,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.670537456,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.670584623,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.670730829,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.281035e-18, max=1.776357e-15, std=8.698780e-17\n"}
,{"stream_name":"stdout","time":193.670862041,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":193.670951774,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":193.671045314,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":193.671143671,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.671309961,"data":"    [RL] [STEP 29/41] action=0.0000, reward=0.0000, t=435.0s, state_diff=4.281035e-18\n"}
,{"stream_name":"stdout","time":193.672297361,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.672398447,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.672534515,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":193.672612095,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.672698227,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":193.672777577,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":193.672849146,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":193.672856512,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":193.672860705,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":193.67286449,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.699399247,"data":"[PROGRESS] Step 1500: t=435.87/450.00s (96.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.065797274,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":194.065819227,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.06582308,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":194.065825722,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":194.065828833,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.065831422,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":194.126484966,"data":"  Stored output at t = 450.0000 s (Step 1549)\n"}
,{"stream_name":"stderr","time":194.126582422,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 33.10s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 33.09s/s]\n"}
,{"stream_name":"stdout","time":194.126605066,"data":"\n"}
,{"stream_name":"stdout","time":194.126614355,"data":"Simulation finished at t = 450.0000 s after 1549 steps.\n"}
,{"stream_name":"stdout","time":194.126617532,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":194.128146759,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.12816119,"data":"[STEP   30] t=  450.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":194.128166421,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.128272545,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.128588607,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.128632535,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.128741468,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.128908705,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":194.128977376,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":194.12911983,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":194.129193953,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.129368525,"data":"    [RL] [STEP 30/41] action=0.0000, reward=0.0000, t=450.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.130269658,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.130370099,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.130499227,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":194.130554868,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.130671668,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":194.130738393,"data":"2025-10-15 22:19:24 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":194.130805242,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.130826434,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.130831245,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.130834938,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.140080464,"data":"[PROGRESS] Step 1550: t=450.29/465.00s (96.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.57680346,"data":"[PROGRESS] Step 1600: t=464.72/465.00s (99.9%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":194.585629346,"data":"  Stored output at t = 465.0000 s (Step 1601)\n"}
,{"stream_name":"stdout","time":194.585736655,"data":"\n"}
,{"stream_name":"stdout","time":194.585748584,"data":"Simulation finished at t = 465.0000 s after 1601 steps.\n"}
,{"stream_name":"stderr","time":194.585746098,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 33.01s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 33.00s/s]\n"}
,{"stream_name":"stdout","time":194.585753114,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":194.587418477,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.587434752,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.587467324,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.587831139,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.587865012,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.588053604,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.588221514,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":194.588286783,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":194.5884203,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":194.588516803,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.58869274,"data":"    [RL] [STEP 31/41] action=0.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":194.58968833,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.58973851,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.589865409,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":194.589958967,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.590056307,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":194.590171257,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":194.590187188,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":194.590191475,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":194.590203697,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":194.590253824,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.946997819,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":194.947020483,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.947052197,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":194.947056943,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":194.947061459,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.947065621,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":195.015259432,"data":"[PROGRESS] Step 1650: t=479.14/480.00s (99.8%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.041794846,"data":"  Stored output at t = 480.0000 s (Step 1653)\n"}
,{"stream_name":"stdout","time":195.041841208,"data":"\n"}
,{"stream_name":"stderr","time":195.041854827,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 33.25s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 33.24s/s]\n"}
,{"stream_name":"stdout","time":195.04186591,"data":"Simulation finished at t = 480.0000 s after 1653 steps.\n"}
,{"stream_name":"stdout","time":195.041875084,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":195.043418284,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.043437241,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.043473048,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.043815834,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.043834561,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.043992196,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.044155988,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.044228388,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":195.044348923,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":195.044425613,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.044594871,"data":"    [RL] [STEP 32/41] action=0.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.045476306,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.045575311,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.045669105,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":195.045759042,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.045832508,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.045906768,"data":"2025-10-15 22:19:25 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":195.045958847,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.045966704,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.04597169,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.045976429,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.453833602,"data":"[PROGRESS] Step 1700: t=493.56/495.00s (99.7%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.498470108,"data":"  Stored output at t = 495.0000 s (Step 1705)\n"}
,{"stream_name":"stderr","time":195.498644061,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 33.18s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 33.17s/s]\n"}
,{"stream_name":"stdout","time":195.498675795,"data":"\n"}
,{"stream_name":"stdout","time":195.498690836,"data":"Simulation finished at t = 495.0000 s after 1705 steps.\n"}
,{"stream_name":"stdout","time":195.498696052,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":195.500214658,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.500294635,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.500403775,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.500734661,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.500815069,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.500906762,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.501044251,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.501158179,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":195.501238157,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":195.501318014,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.501494494,"data":"    [RL] [STEP 33/41] action=0.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.502442383,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.502533742,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.502640313,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":195.502717345,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.50279223,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.502884398,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":195.502914667,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.502920354,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.502932475,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.502939953,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.825942797,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":195.825963519,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.825968491,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":195.825971771,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":195.825974249,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.825976777,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":195.893893579,"data":"[PROGRESS] Step 1750: t=507.99/510.00s (99.6%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":195.955748596,"data":"  Stored output at t = 510.0000 s (Step 1757)\n"}
,{"stream_name":"stdout","time":195.955805882,"data":"\n"}
,{"stream_name":"stdout","time":195.955818128,"data":"Simulation finished at t = 510.0000 s after 1757 steps.\n"}
,{"stream_name":"stdout","time":195.955822945,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":195.955822103,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 33.16s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 33.15s/s]\n"}
,{"stream_name":"stdout","time":195.957372719,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.957387278,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.957408627,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.957767345,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.957822705,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.957952863,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.95808736,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":195.958215934,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":195.958276867,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:887 -   State hash: 3366959841869450880\n"}
,{"stream_name":"stdout","time":195.958387964,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.958548532,"data":"    [RL] [STEP 34/41] action=0.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.959516884,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.959605524,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.959719391,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":195.959788533,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.959891361,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":195.959955301,"data":"2025-10-15 22:19:26 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":195.960012085,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":195.960019541,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":195.960036692,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":195.960065488,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.332325397,"data":"[PROGRESS] Step 1800: t=522.41/525.00s (99.5%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.409900422,"data":"  Stored output at t = 525.0000 s (Step 1809)\n"}
,{"stream_name":"stderr","time":196.410077327,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 33.37s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 33.36s/s]\n"}
,{"stream_name":"stdout","time":196.41010185,"data":"\n"}
,{"stream_name":"stdout","time":196.410112904,"data":"Simulation finished at t = 525.0000 s after 1809 steps.\n"}
,{"stream_name":"stdout","time":196.410118084,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":196.411601048,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.411717921,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.411807512,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.412139607,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.412259544,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.412345059,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.059243e-17, max=3.552714e-15, std=3.144142e-16\n"}
,{"stream_name":"stdout","time":196.412539849,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.412636526,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":196.412746701,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:887 -   State hash: -7034310877417695067\n"}
,{"stream_name":"stdout","time":196.412830564,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.41304711,"data":"    [RL] [STEP 35/41] action=0.0000, reward=0.0000, t=525.0s, state_diff=4.059243e-17\n"}
,{"stream_name":"stdout","time":196.413933888,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.4140371,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.414150723,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":196.414223438,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.414305813,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.414379756,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":196.414447808,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.414454229,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.414459368,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.414485213,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.702515138,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":196.702539017,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.702545796,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":196.702551342,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":196.70255685,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.702562374,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":196.770567338,"data":"[PROGRESS] Step 1850: t=536.83/540.00s (99.4%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":196.866456169,"data":"  Stored output at t = 540.0000 s (Step 1861)\n"}
,{"stream_name":"stderr","time":196.866507383,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 33.22s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 33.21s/s]\n"}
,{"stream_name":"stdout","time":196.866529636,"data":"\n"}
,{"stream_name":"stdout","time":196.866542231,"data":"Simulation finished at t = 540.0000 s after 1861 steps.\n"}
,{"stream_name":"stdout","time":196.866547935,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":196.868098748,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.868113597,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.868205198,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.868535166,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.868596902,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.868706018,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.299632e-17, max=3.552714e-15, std=4.247902e-16\n"}
,{"stream_name":"stdout","time":196.86885382,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":196.86893029,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":196.869045665,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:887 -   State hash: -1802529139288489639\n"}
,{"stream_name":"stdout","time":196.869155613,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.869324483,"data":"    [RL] [STEP 36/41] action=0.0000, reward=0.0000, t=540.0s, state_diff=6.299632e-17\n"}
,{"stream_name":"stdout","time":196.870205373,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.87030276,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.870391902,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":196.870509569,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.87059669799999,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":196.870708338,"data":"2025-10-15 22:19:27 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":196.870716571,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":196.87072153,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":196.870740958,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":196.870792886,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.212315472,"data":"[PROGRESS] Step 1900: t=551.26/555.00s (99.3%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.325446707,"data":"  Stored output at t = 555.0000 s (Step 1913)\n"}
,{"stream_name":"stderr","time":197.325519177,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 33.02s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 33.01s/s]\n"}
,{"stream_name":"stdout","time":197.325541641,"data":"\n"}
,{"stream_name":"stdout","time":197.325557882,"data":"Simulation finished at t = 555.0000 s after 1913 steps.\n"}
,{"stream_name":"stdout","time":197.325562564,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":197.327078292,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.327096277,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.327170468,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.327498394,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.327578442,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.327702749,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=5.576083e-17, max=7.105427e-15, std=5.815726e-16\n"}
,{"stream_name":"stdout","time":197.327999825,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.328125766,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":197.328237278,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:887 -   State hash: -3117907431282759618\n"}
,{"stream_name":"stdout","time":197.328315316,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.328505566,"data":"    [RL] [STEP 37/41] action=0.0000, reward=0.0000, t=555.0s, state_diff=5.576083e-17\n"}
,{"stream_name":"stdout","time":197.329464589,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.329553913,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.329687264,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":197.329747595,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.329847172,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.329918995,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":197.329989075,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.329996272,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.330000953,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.330004732,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.582351678,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":197.582372957,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.58237738,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":197.582380167,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":197.58238273,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.582386097,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":197.650544057,"data":"[PROGRESS] Step 1950: t=565.68/570.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":197.780282826,"data":"  Stored output at t = 570.0000 s (Step 1965)\n"}
,{"stream_name":"stdout","time":197.780328084,"data":"\n"}
,{"stream_name":"stderr","time":197.780337617,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 33.34s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 33.33s/s]\n"}
,{"stream_name":"stdout","time":197.780342035,"data":"Simulation finished at t = 570.0000 s after 1965 steps.\n"}
,{"stream_name":"stdout","time":197.780357599,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stdout","time":197.781914084,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.781932444,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.781971472,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.782304682,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.782399777,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.782505947,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.194820e-17, max=7.105427e-15, std=4.696656e-16\n"}
,{"stream_name":"stdout","time":197.782668559,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":197.782718618,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":197.782830445,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:887 -   State hash: 5036953372656524484\n"}
,{"stream_name":"stdout","time":197.782913599,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.783081089,"data":"    [RL] [STEP 38/41] action=0.0000, reward=0.0000, t=570.0s, state_diff=4.194820e-17\n"}
,{"stream_name":"stdout","time":197.783951637,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.784063051,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.784178644,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":197.784264115,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.784367246,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":197.784457626,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":197.784508875,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":197.78451552,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":197.784520528,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":197.784548138,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.08811991,"data":"[PROGRESS] Step 2000: t=580.10/585.00s (99.2%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.237409085,"data":"  Stored output at t = 585.0000 s (Step 2017)\n"}
,{"stream_name":"stdout","time":198.237519651,"data":"\n"}
,{"stream_name":"stdout","time":198.237529916,"data":"Simulation finished at t = 585.0000 s after 2017 steps.\n"}
,{"stream_name":"stdout","time":198.237534436,"data":"Total runtime: 0.45 seconds.\n"}
,{"stream_name":"stderr","time":198.23755624,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 33.15s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 33.14s/s]\n"}
,{"stream_name":"stdout","time":198.239140162,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.239268937,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.239384017,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.239743824,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.239830296,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.239952251,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.673216e-19, max=1.040834e-17, std=8.253824e-19\n"}
,{"stream_name":"stdout","time":198.240151411,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.240231463,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":198.240318529,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:887 -   State hash: 6847651026134402616\n"}
,{"stream_name":"stdout","time":198.240394676,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.240593539,"data":"    [RL] [STEP 39/41] action=0.0000, reward=0.0000, t=585.0s, state_diff=1.673216e-19\n"}
,{"stream_name":"stdout","time":198.241526122,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=0.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.241641157,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.241727637,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":198.241813542,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.241876922,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:837 -   Action: 0.000000\n"}
,{"stream_name":"stdout","time":198.241975863,"data":"2025-10-15 22:19:28 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":198.242038853,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.3, 0.2817901234567903, 0.096, 0.1080246913580248]\n"}
,{"stream_name":"stdout","time":198.242051266,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":198.242056652,"data":"  └─ Inflow state: rho_m=0.3000, w_m=0.1, rho_c=0.0960, w_c=0.1\n"}
,{"stream_name":"stdout","time":198.242061985,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.461141006,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":198.461935757,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.461941964,"data":"  Original dt: 4.617532e-01 s\n"}
,{"stream_name":"stdout","time":198.461944489,"data":"  Corrected dt: 2.885958e-01 s\n"}
,{"stream_name":"stdout","time":198.461947239,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.461949651,"data":"  Max wave speed detected: 17.33 m/s\n"}
,{"stream_name":"stdout","time":198.532630334,"data":"[PROGRESS] Step 2050: t=594.52/600.00s (99.1%) | dt=0.2886s\n"}
,{"stream_name":"stdout","time":198.698396317,"data":"  Stored output at t = 600.0000 s (Step 2069)\n"}
,{"stream_name":"stderr","time":198.698639676,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.89s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 32.88s/s]\n"}
,{"stream_name":"stdout","time":198.698679008,"data":"\n"}
,{"stream_name":"stdout","time":198.698691897,"data":"Simulation finished at t = 600.0000 s after 2069 steps.\n"}
,{"stream_name":"stdout","time":198.698696439,"data":"Total runtime: 0.46 seconds.\n"}
,{"stream_name":"stdout","time":198.700257293,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.700272503,"data":"[STEP   40] t=  600.0s | phase=0 | reward=   0.00 | total_reward=    0.00\n"}
,{"stream_name":"stdout","time":198.700277008,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":198.70038224,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.700499715,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":198.700862405,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.700871989,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.701016278,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.916869e-17, max=5.329071e-15, std=3.282021e-16\n"}
,{"stream_name":"stdout","time":198.701195698,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.035015, rho_c=0.003164\n"}
,{"stream_name":"stdout","time":198.70128568,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.880986, w_c=14.217638\n"}
,{"stream_name":"stdout","time":198.701357152,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:887 -   State hash: -4729733624740665882\n"}
,{"stream_name":"stdout","time":198.701453341,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.701653789,"data":"    [RL] [STEP 40/41] action=0.0000, reward=0.0000, t=600.0s, state_diff=2.916869e-17\n"}
,{"stream_name":"stdout","time":198.701672689,"data":"\n"}
,{"stream_name":"stdout","time":198.701676733,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":198.701680421,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":198.70168402,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":198.701687814,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":198.701691364,"data":"    - Avg step time: 0.465s (device=gpu)\n"}
,{"stream_name":"stdout","time":198.701695138,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":198.701698714,"data":"    - Wallclock time: 18.6s\n"}
,{"stream_name":"stdout","time":198.701714155,"data":"    - Speed ratio: 32.26x real-time\n"}
,{"stream_name":"stdout","time":198.701718343,"data":"\n"}
,{"stream_name":"stdout","time":198.701790136,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":198.701796222,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":198.701800054,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":198.701803684,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":198.701807302,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":198.701826915,"data":"    - Avg step time: 0.465s (device=gpu)\n"}
,{"stream_name":"stdout","time":198.701830877,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":198.701834893,"data":"    - Wallclock time: 18.6s\n"}
,{"stream_name":"stdout","time":198.701838728,"data":"    - Speed ratio: 32.26x real-time\n"}
,{"stream_name":"stdout","time":198.701842493,"data":"\n"}
,{"stream_name":"stdout","time":198.701913424,"data":"2025-10-15 22:19:29 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":198.702228929,"data":"\n"}
,{"stream_name":"stdout","time":198.702239637,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.702243749,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":198.70224742,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":198.702251267,"data":"\n"}
,{"stream_name":"stdout","time":198.702404152,"data":"2025-10-15 22:19:29 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":198.702517005,"data":"2025-10-15 22:19:29 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=2521329801023128842, last=-4729733624740665882\n"}
,{"stream_name":"stdout","time":198.702987747,"data":"2025-10-15 22:19:29 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.03122336 0.03168972 0.03217945 0.03267153 0.03313596], w_m[10:15]=[16.46560214 16.40817721 16.35330629 16.30413114 16.26362536]\n"}
,{"stream_name":"stdout","time":198.707997845,"data":"2025-10-15 22:19:29 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02826931 0.02826386 0.02826182 0.02826104 0.02826073], w_m[10:15]=[17.42793983 17.43125511 17.43249708 17.43297014 17.43315409]\n"}
,{"stream_name":"stdout","time":198.7081339,"data":"2025-10-15 22:19:29 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=31.787073, efficiency=5.085932, delay=-175.12s\n"}
,{"stream_name":"stdout","time":198.708271312,"data":"2025-10-15 22:19:29 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":198.708354997,"data":"2025-10-15 22:19:29 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 31.787073312784855, 'avg_speed': 1055.4375174172515, 'avg_density': 0.03023631435669528, 'efficiency': 5.085931730045576, 'delay': -175.118743243177, 'throughput': 158935.36656392427}\n"}
,{"stream_name":"stdout","time":198.708462844,"data":"2025-10-15 22:19:29 - INFO - run_performance_comparison:1430 - Flow improvement: 12.361%\n"}
,{"stream_name":"stdout","time":198.708531798,"data":"2025-10-15 22:19:29 - INFO - run_performance_comparison:1431 - Efficiency improvement: 12.361%\n"}
,{"stream_name":"stdout","time":198.708610574,"data":"2025-10-15 22:19:29 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":198.708697631,"data":"  Flow improvement: 12.4%\n"}
,{"stream_name":"stdout","time":198.708705572,"data":"  Efficiency improvement: 12.4%\n"}
,{"stream_name":"stdout","time":198.708709465,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":198.708712937,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":198.709235416,"data":"\n"}
,{"stream_name":"stdout","time":198.709251046,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":199.322850518,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":199.829847656,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":199.829872166,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":199.829877384,"data":"\n"}
,{"stream_name":"stdout","time":199.829881449,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":199.838082828,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":199.838102231,"data":"\n"}
,{"stream_name":"stdout","time":199.838106931,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":199.838166727,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":199.838174147,"data":"\n"}
,{"stream_name":"stdout","time":199.838178273,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":199.838181888,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":199.838185356,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":199.838189124,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":199.8382291,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":199.838245137,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":199.839093925,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":202.272347038,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":202.272557725,"data":"\n"}
,{"stream_name":"stdout","time":202.27256571,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":202.272635578,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":202.276136291,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":202.277012154,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":202.277151205,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":202.277236895,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":202.277358892,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":202.277424139,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":202.277483936,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":202.277558453,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":202.277633074,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":202.277705354,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":202.349080399,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":202.349117719,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":202.349451606,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":202.349553628,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":202.349644011,"data":"\n"}
,{"stream_name":"stdout","time":202.349655093,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":202.349711891,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":202.349960967,"data":"\n"}
,{"stream_name":"stdout","time":202.349973182,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":202.349977781,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":202.349981788,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":202.349985401,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":205.707748834,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":205.707782046,"data":"  warn(\n"}
,{"stream_name":"stderr","time":205.743374198,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":206.47336492,"data":"[NbConvertApp] Writing 322209 bytes to __results__.html\n"}
]